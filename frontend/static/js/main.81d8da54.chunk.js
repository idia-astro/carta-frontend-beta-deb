(this["webpackJsonpcarta-frontend"]=this["webpackJsonpcarta-frontend"]||[]).push([[0],{10:function(e,t,i){"use strict";var n=i(282);i.o(n,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return n.CARTA_INFO})),i.o(n,"CHANNEL_TYPES")&&i.d(t,"CHANNEL_TYPES",(function(){return n.CHANNEL_TYPES})),i.o(n,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return n.CompressionQuality})),i.o(n,"ControlMap")&&i.d(t,"ControlMap",(function(){return n.ControlMap})),i.o(n,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return n.CursorPosition})),i.o(n,"Event")&&i.d(t,"Event",(function(){return n.Event})),i.o(n,"GenCoordinateLabel")&&i.d(t,"GenCoordinateLabel",(function(){return n.GenCoordinateLabel})),i.o(n,"IsSpectralSystemSupported")&&i.d(t,"IsSpectralSystemSupported",(function(){return n.IsSpectralSystemSupported})),i.o(n,"IsSpectralTypeSupported")&&i.d(t,"IsSpectralTypeSupported",(function(){return n.IsSpectralTypeSupported})),i.o(n,"IsSpectralUnitSupported")&&i.d(t,"IsSpectralUnitSupported",(function(){return n.IsSpectralUnitSupported})),i.o(n,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return n.LayoutConfig})),i.o(n,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return n.MOMENT_TEXT})),i.o(n,"Point2D")&&i.d(t,"Point2D",(function(){return n.Point2D})),i.o(n,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return n.PresetLayout})),i.o(n,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return n.ProtobufProcessing})),i.o(n,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return n.RegionCreationMode})),i.o(n,"SPECTRAL_COORDS_SUPPORTED")&&i.d(t,"SPECTRAL_COORDS_SUPPORTED",(function(){return n.SPECTRAL_COORDS_SUPPORTED})),i.o(n,"SPECTRAL_DEFAULT_UNIT")&&i.d(t,"SPECTRAL_DEFAULT_UNIT",(function(){return n.SPECTRAL_DEFAULT_UNIT})),i.o(n,"SPECTRAL_MATCHING_TYPES")&&i.d(t,"SPECTRAL_MATCHING_TYPES",(function(){return n.SPECTRAL_MATCHING_TYPES})),i.o(n,"SPECTRAL_TYPE_STRING")&&i.d(t,"SPECTRAL_TYPE_STRING",(function(){return n.SPECTRAL_TYPE_STRING})),i.o(n,"SpectralSystem")&&i.d(t,"SpectralSystem",(function(){return n.SpectralSystem})),i.o(n,"SpectralType")&&i.d(t,"SpectralType",(function(){return n.SpectralType})),i.o(n,"SpectralUnit")&&i.d(t,"SpectralUnit",(function(){return n.SpectralUnit})),i.o(n,"Theme")&&i.d(t,"Theme",(function(){return n.Theme})),i.o(n,"TileCache")&&i.d(t,"TileCache",(function(){return n.TileCache})),i.o(n,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return n.TileCoordinate})),i.o(n,"Transform2D")&&i.d(t,"Transform2D",(function(){return n.Transform2D})),i.o(n,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return n.WCSMatchingType})),i.o(n,"WCSPoint2D")&&i.d(t,"WCSPoint2D",(function(){return n.WCSPoint2D})),i.o(n,"WCSType")&&i.d(t,"WCSType",(function(){return n.WCSType})),i.o(n,"Zoom")&&i.d(t,"Zoom",(function(){return n.Zoom})),i.o(n,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return n.ZoomPoint}));var r=i(283);i.o(r,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return r.CARTA_INFO})),i.o(r,"CHANNEL_TYPES")&&i.d(t,"CHANNEL_TYPES",(function(){return r.CHANNEL_TYPES})),i.o(r,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return r.CompressionQuality})),i.o(r,"ControlMap")&&i.d(t,"ControlMap",(function(){return r.ControlMap})),i.o(r,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return r.CursorPosition})),i.o(r,"Event")&&i.d(t,"Event",(function(){return r.Event})),i.o(r,"GenCoordinateLabel")&&i.d(t,"GenCoordinateLabel",(function(){return r.GenCoordinateLabel})),i.o(r,"IsSpectralSystemSupported")&&i.d(t,"IsSpectralSystemSupported",(function(){return r.IsSpectralSystemSupported})),i.o(r,"IsSpectralTypeSupported")&&i.d(t,"IsSpectralTypeSupported",(function(){return r.IsSpectralTypeSupported})),i.o(r,"IsSpectralUnitSupported")&&i.d(t,"IsSpectralUnitSupported",(function(){return r.IsSpectralUnitSupported})),i.o(r,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return r.LayoutConfig})),i.o(r,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return r.MOMENT_TEXT})),i.o(r,"Point2D")&&i.d(t,"Point2D",(function(){return r.Point2D})),i.o(r,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return r.PresetLayout})),i.o(r,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return r.ProtobufProcessing})),i.o(r,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return r.RegionCreationMode})),i.o(r,"SPECTRAL_COORDS_SUPPORTED")&&i.d(t,"SPECTRAL_COORDS_SUPPORTED",(function(){return r.SPECTRAL_COORDS_SUPPORTED})),i.o(r,"SPECTRAL_DEFAULT_UNIT")&&i.d(t,"SPECTRAL_DEFAULT_UNIT",(function(){return r.SPECTRAL_DEFAULT_UNIT})),i.o(r,"SPECTRAL_MATCHING_TYPES")&&i.d(t,"SPECTRAL_MATCHING_TYPES",(function(){return r.SPECTRAL_MATCHING_TYPES})),i.o(r,"SPECTRAL_TYPE_STRING")&&i.d(t,"SPECTRAL_TYPE_STRING",(function(){return r.SPECTRAL_TYPE_STRING})),i.o(r,"SpectralSystem")&&i.d(t,"SpectralSystem",(function(){return r.SpectralSystem})),i.o(r,"SpectralType")&&i.d(t,"SpectralType",(function(){return r.SpectralType})),i.o(r,"SpectralUnit")&&i.d(t,"SpectralUnit",(function(){return r.SpectralUnit})),i.o(r,"Theme")&&i.d(t,"Theme",(function(){return r.Theme})),i.o(r,"TileCache")&&i.d(t,"TileCache",(function(){return r.TileCache})),i.o(r,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return r.TileCoordinate})),i.o(r,"Transform2D")&&i.d(t,"Transform2D",(function(){return r.Transform2D})),i.o(r,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return r.WCSMatchingType})),i.o(r,"WCSPoint2D")&&i.d(t,"WCSPoint2D",(function(){return r.WCSPoint2D})),i.o(r,"WCSType")&&i.d(t,"WCSType",(function(){return r.WCSType})),i.o(r,"Zoom")&&i.d(t,"Zoom",(function(){return r.Zoom})),i.o(r,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return r.ZoomPoint}));var o=i(284);i.d(t,"CHANNEL_TYPES",(function(){return o.a})),i.d(t,"GenCoordinateLabel",(function(){return o.b})),i.d(t,"IsSpectralSystemSupported",(function(){return o.c})),i.d(t,"IsSpectralTypeSupported",(function(){return o.d})),i.d(t,"IsSpectralUnitSupported",(function(){return o.e})),i.d(t,"SPECTRAL_COORDS_SUPPORTED",(function(){return o.f})),i.d(t,"SPECTRAL_DEFAULT_UNIT",(function(){return o.g})),i.d(t,"SPECTRAL_MATCHING_TYPES",(function(){return o.h})),i.d(t,"SPECTRAL_TYPE_STRING",(function(){return o.i})),i.d(t,"SpectralSystem",(function(){return o.j})),i.d(t,"SpectralType",(function(){return o.k})),i.d(t,"SpectralUnit",(function(){return o.l}));var a=i(285);i.o(a,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return a.CARTA_INFO})),i.o(a,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return a.CompressionQuality})),i.o(a,"ControlMap")&&i.d(t,"ControlMap",(function(){return a.ControlMap})),i.o(a,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return a.CursorPosition})),i.o(a,"Event")&&i.d(t,"Event",(function(){return a.Event})),i.o(a,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return a.LayoutConfig})),i.o(a,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return a.MOMENT_TEXT})),i.o(a,"Point2D")&&i.d(t,"Point2D",(function(){return a.Point2D})),i.o(a,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return a.PresetLayout})),i.o(a,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return a.ProtobufProcessing})),i.o(a,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return a.RegionCreationMode})),i.o(a,"Theme")&&i.d(t,"Theme",(function(){return a.Theme})),i.o(a,"TileCache")&&i.d(t,"TileCache",(function(){return a.TileCache})),i.o(a,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return a.TileCoordinate})),i.o(a,"Transform2D")&&i.d(t,"Transform2D",(function(){return a.Transform2D})),i.o(a,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return a.WCSMatchingType})),i.o(a,"WCSPoint2D")&&i.d(t,"WCSPoint2D",(function(){return a.WCSPoint2D})),i.o(a,"WCSType")&&i.d(t,"WCSType",(function(){return a.WCSType})),i.o(a,"Zoom")&&i.d(t,"Zoom",(function(){return a.Zoom})),i.o(a,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return a.ZoomPoint}));var s=i(286);i.d(t,"Point2D",(function(){return s.a})),i.d(t,"WCSPoint2D",(function(){return s.b}));var l=i(287);i.d(t,"Transform2D",(function(){return l.a}));var c=i(288);i.o(c,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return c.CARTA_INFO})),i.o(c,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return c.CompressionQuality})),i.o(c,"ControlMap")&&i.d(t,"ControlMap",(function(){return c.ControlMap})),i.o(c,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return c.CursorPosition})),i.o(c,"Event")&&i.d(t,"Event",(function(){return c.Event})),i.o(c,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return c.LayoutConfig})),i.o(c,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return c.MOMENT_TEXT})),i.o(c,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return c.PresetLayout})),i.o(c,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return c.ProtobufProcessing})),i.o(c,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return c.RegionCreationMode})),i.o(c,"Theme")&&i.d(t,"Theme",(function(){return c.Theme})),i.o(c,"TileCache")&&i.d(t,"TileCache",(function(){return c.TileCache})),i.o(c,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return c.TileCoordinate})),i.o(c,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return c.WCSMatchingType})),i.o(c,"WCSType")&&i.d(t,"WCSType",(function(){return c.WCSType})),i.o(c,"Zoom")&&i.d(t,"Zoom",(function(){return c.Zoom})),i.o(c,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return c.ZoomPoint}));var u=i(289);i.d(t,"TileCoordinate",(function(){return u.a}));var p=i(290);i.d(t,"Theme",(function(){return p.a}));var d=i(291);i.d(t,"PresetLayout",(function(){return d.a}));var h=i(292);i.d(t,"CursorPosition",(function(){return h.a}));var g=i(293);i.d(t,"Zoom",(function(){return g.a}));var m=i(294);i.d(t,"ZoomPoint",(function(){return m.a}));var f=i(295);i.d(t,"WCSType",(function(){return f.a}));var y=i(296);i.d(t,"RegionCreationMode",(function(){return y.a}));var b=i(297);i.d(t,"CompressionQuality",(function(){return b.a}));var O=i(298);i.d(t,"TileCache",(function(){return O.a}));var S=i(299);i.d(t,"ProtobufProcessing",(function(){return S.a}));var C=i(300);i.d(t,"Event",(function(){return C.a}));var E=i(301);i.d(t,"CARTA_INFO",(function(){return E.a}));var I=i(302);i.d(t,"LayoutConfig",(function(){return I.a}));var w=i(311);i.d(t,"ControlMap",(function(){return w.a}));var T=i(364);i.d(t,"WCSMatchingType",(function(){return T.a}));var v=i(365);i.d(t,"MOMENT_TEXT",(function(){return v.a}))},1e3:function(e,t,i){},1001:function(e,t,i){},1002:function(e,t,i){},1003:function(e,t,i){},1004:function(e,t,i){},1005:function(e,t,i){},1006:function(e,t,i){},1007:function(e,t,i){},1008:function(e,t,i){},1009:function(e,t,i){},1010:function(e,t,i){},1011:function(e,t,i){},1012:function(e,t,i){},1014:function(e,t,i){"use strict";i.r(t);var n,r,o,a=i(0),s=i(32),l=i(185),c=i.n(l),u=i(1026),p=i(14),d=i(42),h=i(47),g=i(91),m=i(13),f=i(63),y=i(4),b=i(8);let O=Object(p.a)((o=r=class e extends a.Component{render(){const t=y.e.Instance;let i="bp3-hotkey-dialog";return t.darkTheme&&(i+=" bp3-dark"),a.createElement(h.l,{isOpen:t.dialogStore.hotkeyDialogVisible,className:i,canEscapeKeyClose:!0,canOutsideClickClose:!0,onClose:t.dialogStore.hideHotkeyDialog},a.createElement("div",{className:b.a.DIALOG_BODY},e.RenderHotkeys()))}static RenderHotkeys(){const t=y.e.Instance,i=t.modifierString,n=[a.createElement(h.t,{key:0,group:"1) Navigation",global:!0,combo:"click",label:"Pan image"}),a.createElement(h.t,{key:1,group:"1) Navigation",global:!0,combo:"middle-click",label:"Pan image (inside region)"}),a.createElement(h.t,{key:2,group:"1) Navigation",global:!0,combo:"mod+click",label:"Pan image (inside region)"}),a.createElement(h.t,{key:3,group:"1) Navigation",global:!0,combo:"mouse-wheel",label:"Zoom image"})],r=[a.createElement(h.t,{key:0,group:"2) Regions",global:!0,combo:"c",label:"Toggle region creation mode",onKeyDown:e.ToggleCreateMode}),a.createElement(h.t,{key:1,group:"2) Regions",global:!0,combo:"l",label:"Toggle current region lock",onKeyDown:e.ToggleRegionLock}),a.createElement(h.t,{key:2,group:"2) Regions",global:!0,combo:"shift + l",label:"Unlock all regions",onKeyDown:e.UnlockAllRegions}),a.createElement(h.t,{key:3,group:"2) Regions",global:!0,combo:"del",label:"Delete selected region",onKeyDown:t.deleteSelectedRegion}),a.createElement(h.t,{key:4,group:"2) Regions",global:!0,combo:"backspace",label:"Delete selected region",onKeyDown:t.deleteSelectedRegion}),a.createElement(h.t,{key:5,group:"2) Regions",global:!0,combo:"esc",label:"Deselect region/Cancel region creation",onKeyDown:e.HandleRegionEsc}),a.createElement(h.t,{key:6,group:"2) Regions",global:!0,combo:"mod",label:"Switch region creation mode"}),a.createElement(h.t,{key:7,group:"2) Regions",global:!0,combo:"shift",label:"Symmetric region creation"}),a.createElement(h.t,{key:8,group:"2) Regions",global:!0,combo:"double-click",label:"Region properties"})],o=[a.createElement(h.t,{key:0,group:"3) Frame controls",global:!0,combo:i+"]",label:"Next image",onKeyDown:t.nextFrame}),a.createElement(h.t,{key:1,group:"3) Frame controls",global:!0,combo:i+"[",label:"Previous image",onKeyDown:t.prevFrame}),a.createElement(h.t,{key:2,group:"3) Frame controls",global:!0,combo:i+"up",label:"Next channel",onKeyDown:e.NextChannel}),a.createElement(h.t,{key:3,group:"3) Frame controls",global:!0,combo:i+"down",label:"Previous channel",onKeyDown:e.PrevChannel}),a.createElement(h.t,{key:4,group:"3) Frame controls",global:!0,combo:i+"shift + up",label:"Next Stokes cube",onKeyDown:e.NextStokes}),a.createElement(h.t,{key:5,group:"3) Frame controls",global:!0,combo:i+"shift + down",label:"Previous Stokes cube",onKeyDown:e.PrevStokes})],s=[a.createElement(h.t,{key:0,group:"4) File controls",global:!0,combo:i+"O",label:"Open image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(y.g.File)}),a.createElement(h.t,{key:1,group:"4) File controls",global:!0,combo:i+"L",label:"Append image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(y.g.File,!0)}),a.createElement(h.t,{key:2,group:"4) File controls",global:!0,combo:i+"W",label:"Close image",onKeyDown:()=>t.closeCurrentFile(!0)}),a.createElement(h.t,{key:3,group:"4) File controls",global:!0,combo:i+"S",label:"Save image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(y.g.SaveFile,!1)}),a.createElement(h.t,{key:4,group:"4) File controls",global:!0,combo:i+"G",label:"Import catalog",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(y.g.Catalog,!1)}),a.createElement(h.t,{key:5,group:"4) File controls",global:!0,combo:i+"E",label:"Export image",onKeyDown:t.exportImage})],l=[a.createElement(h.t,{key:0,group:"5) Other",global:!0,combo:"shift + D",label:"Toggle light/dark theme",onKeyDown:e.ToggleDarkTheme}),a.createElement(h.t,{key:1,group:"5) Other",global:!0,combo:"F",label:"Freeze/unfreeze cursor position",onKeyDown:t.toggleCursorFrozen})];return a.createElement(h.u,null,r,n,o,s,l)}},r.NextChannel=()=>{const e=y.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(1,0)},r.PrevChannel=()=>{const e=y.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(-1,0)},r.NextStokes=()=>{const e=y.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(0,1)},r.PrevStokes=()=>{const e=y.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(0,-1)},r.ToggleDarkTheme=()=>{const e=y.e.Instance;e.darkTheme?e.setLightTheme():e.setDarkTheme()},r.ToggleCreateMode=()=>{const e=y.e.Instance;e.activeFrame&&e.activeFrame.regionSet.toggleMode()},r.ToggleRegionLock=()=>{const e=y.e.Instance;if(e.activeFrame){const t=e.activeFrame.regionSet;t.selectedRegion&&t.selectedRegion.toggleLock()}},r.UnlockAllRegions=()=>{const e=y.e.Instance;if(e.activeFrame){const t=e.activeFrame.regionSet;for(const e of t.regions)e.setLocked(!1)}},r.HandleRegionEsc=()=>{const e=y.e.Instance;if(e.activeFrame&&e.activeFrame.regionSet){const t=e.activeFrame.regionSet;t.selectedRegion?t.deselectRegion():t.mode===y.L.CREATING&&t.setMode(y.L.MOVING)}},n=o))||n;function S(){}S.prototype=Object.create(O.prototype),S.prototype.renderHotkeys=O.RenderHotkeys;const C=Object(h.v)(S);var E;i(1009),i(1010),i(1011);let I=Object(p.a)(E=class extends a.Component{constructor(...e){super(...e),this.onContainerResize=(e,t)=>{const i=y.e.Instance;i.layoutStore.dockedLayout&&i.layoutStore.dockedLayout.updateSize(e,t)}}render(){const e=y.e.Instance;let t="App",i="gl-container-app";return e.darkTheme&&(t+=" bp3-dark",i+=" dark-theme"),a.createElement("div",{className:t},a.createElement(m.I,null),a.createElement(h.a,{icon:e.alertStore.alertIcon,className:e.darkTheme?"bp3-dark":"",isOpen:e.alertStore.alertVisible,onClose:e.alertStore.dismissAlert,canEscapeKeyCancel:!0},a.createElement("p",null,e.alertStore.alertText)),a.createElement(h.a,{icon:e.alertStore.alertIcon,className:e.darkTheme?"bp3-dark":"",isOpen:e.alertStore.interactiveAlertVisible,confirmButtonText:"OK",cancelButtonText:"Cancel",intent:g.a.DANGER,onClose:e.alertStore.handleInteractiveAlertClosed,canEscapeKeyCancel:!0},a.createElement("p",null,e.alertStore.interactiveAlertText)),a.createElement(f.k,{progress:void 0,timeRemaining:0,isOpen:e.resumingSession,cancellable:!1,text:"Resuming session..."}),a.createElement("div",{className:i,ref:t=>e.setAppContainer(t)},a.createElement(d.a,{handleWidth:!0,handleHeight:!0,onResize:this.onContainerResize,refreshMode:"throttle",refreshRate:200})),a.createElement(C,null),a.createElement(m.g,null))}})||E;var w=i(28),T=(i(1012),i(79)),v=i.n(T),A=i(195),x=i.n(A),R=i(196),P=i.n(R),j=i(197),k=i.n(j),F=i(198),M=i.n(F),D=i(199),N=i.n(D),L=i(200),_=i.n(L);for(const z of[v.a,x.a,P.a,k.a,M.a,N.a,_.a])(new Image).src=z;u.a.onlyShowFocusOnTabs(),window.React=a,window.ReactDOM=s,async function(){const e=window.location.href.replace(window.location.search,""),t=e+(e.endsWith("/")?"":"/")+"config";try{const e=await c.a.get(t);w.a.SetRuntimeConfig(null===e||void 0===e?void 0:e.data)}catch(i){console.log("No runtime config provided. Using default configuration"),w.a.SetRuntimeConfig({})}if(w.a.RuntimeConfig.googleClientId){const e=document.createElement("script");e.src="https://apis.google.com/js/client.js",e.onload=()=>{s.render(a.createElement(I,null),document.getElementById("root"))},document.body.appendChild(e)}else s.render(a.createElement(I,null),document.getElementById("root"))}().then(()=>{console.log("Configuration complete. Rendering frontend")})},12:function(e,t,i){"use strict";i.d(t,"n",(function(){return _})),i.d(t,"o",(function(){return xe})),i.d(t,"p",(function(){return dt})),i.d(t,"q",(function(){return ht})),i.d(t,"j",(function(){return yt})),i.d(t,"r",(function(){return bt})),i.d(t,"i",(function(){return ki})),i.d(t,"s",(function(){return Fi})),i.d(t,"a",(function(){return ct.a})),i.d(t,"k",(function(){return ct.b})),i.d(t,"m",(function(){return ct.d})),i.d(t,"l",(function(){return ct.c})),i.d(t,"t",(function(){return Mi})),i.d(t,"h",(function(){return ln})),i.d(t,"g",(function(){return cn})),i.d(t,"v",(function(){return xn.b})),i.d(t,"u",(function(){return xn.a})),i.d(t,"c",(function(){return Pn})),i.d(t,"b",(function(){return jn})),i.d(t,"e",(function(){return kn})),i.d(t,"f",(function(){return Mn})),i.d(t,"d",(function(){return Hn}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S,C,E,I,w,T,v,A,x,R,P,j=i(3),k=i(2),F=(i(29),i(1)),M=i(76),D=i(43),N=i.n(D),L=i(7);let _=(n=class{constructor(){Object(j.a)(this,"minX",r,this),Object(j.a)(this,"maxX",o,this),Object(j.a)(this,"minY",a,this),Object(j.a)(this,"maxY",s,this),Object(j.a)(this,"cursorX",l,this),Object(j.a)(this,"plotType",c,this),Object(j.a)(this,"primaryLineColor",u,this),Object(j.a)(this,"lineWidth",p,this),Object(j.a)(this,"linePlotPointSize",d,this),Object(j.a)(this,"logScaleY",h,this),Object(j.a)(this,"markerTextVisible",g,this),Object(j.a)(this,"meanRmsVisible",m,this),Object(j.a)(this,"linePlotInitXYBoundaries",f,this),Object(j.a)(this,"setXBounds",y,this),Object(j.a)(this,"clearXBounds",b,this),Object(j.a)(this,"setYBounds",O,this),Object(j.a)(this,"clearYBounds",S,this),Object(j.a)(this,"setXYBounds",C,this),Object(j.a)(this,"clearXYBounds",E,this),Object(j.a)(this,"setMarkerTextVisible",I,this),Object(j.a)(this,"setMeanRmsVisible",w,this),Object(j.a)(this,"setLogScale",T,this),Object(j.a)(this,"setPlotType",v,this),Object(j.a)(this,"setCursor",A,this),Object(j.a)(this,"setPrimaryLineColor",x,this),Object(j.a)(this,"setLineWidth",R,this),Object(j.a)(this,"setLinePlotPointSize",P,this),this.init=e=>{if(!e)return;const t=N()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=L.i.MIN_WIDTH&&e.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=L.i.MIN_POINT_SIZE&&e.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.logScaleY&&(this.logScaleY=e.logScaleY),"boolean"===typeof e.markerTextVisible&&(this.markerTextVisible=e.markerTextVisible),"boolean"===typeof e.meanRmsVisible&&(this.meanRmsVisible=e.meanRmsVisible),"string"!==typeof e.plotType||e.plotType!==L.j.STEPS&&e.plotType!==L.j.LINES&&e.plotType!==L.j.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,logScaleY:this.logScaleY,markerTextVisible:this.markerTextVisible,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(F.p)(this),this.logScaleY=!0,this.plotType=L.j.STEPS,this.markerTextVisible=!0,this.meanRmsVisible=!0,this.primaryLineColor={colorHex:M.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0}}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},r=Object(k.a)(n.prototype,"minX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(k.a)(n.prototype,"maxX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(k.a)(n.prototype,"minY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(k.a)(n.prototype,"maxY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(k.a)(n.prototype,"cursorX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(k.a)(n.prototype,"plotType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(k.a)(n.prototype,"primaryLineColor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(k.a)(n.prototype,"lineWidth",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(k.a)(n.prototype,"linePlotPointSize",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(k.a)(n.prototype,"logScaleY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(k.a)(n.prototype,"markerTextVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(k.a)(n.prototype,"meanRmsVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(k.a)(n.prototype,"linePlotInitXYBoundaries",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(k.a)(n.prototype,"setXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),b=Object(k.a)(n.prototype,"clearXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),O=Object(k.a)(n.prototype,"setYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),S=Object(k.a)(n.prototype,"clearYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),C=Object(k.a)(n.prototype,"setXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),E=Object(k.a)(n.prototype,"clearXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),I=Object(k.a)(n.prototype,"setMarkerTextVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),w=Object(k.a)(n.prototype,"setMeanRmsVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),T=Object(k.a)(n.prototype,"setLogScale",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logScaleY=e}}}),v=Object(k.a)(n.prototype,"setPlotType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),A=Object(k.a)(n.prototype,"setCursor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Object(k.a)(n.prototype,"isAutoScaledX",[F.i],Object.getOwnPropertyDescriptor(n.prototype,"isAutoScaledX"),n.prototype),Object(k.a)(n.prototype,"isAutoScaledY",[F.i],Object.getOwnPropertyDescriptor(n.prototype,"isAutoScaledY"),n.prototype),x=Object(k.a)(n.prototype,"setPrimaryLineColor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),R=Object(k.a)(n.prototype,"setLineWidth",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),P=Object(k.a)(n.prototype,"setLinePlotPointSize",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(k.a)(n.prototype,"initXYBoundaries",[F.g],Object.getOwnPropertyDescriptor(n.prototype,"initXYBoundaries"),n.prototype),n);var z,W,G,V,B,q,H,U,Y,X,K,Q,Z,$,J,ee,te,ie,ne,re,oe,ae,se,le,ce,ue,pe,de,he,ge,me,fe,ye,be,Oe,Se,Ce,Ee,Ie,we,Te=i(4),ve=i(5),Ae=i(13);let xe=(we=Ie=class e{constructor(t="x",i=-1,n=0){Object(j.a)(this,"fileId",W,this),Object(j.a)(this,"regionId",G,this),Object(j.a)(this,"coordinate",V,this),Object(j.a)(this,"minX",B,this),Object(j.a)(this,"maxX",q,this),Object(j.a)(this,"minY",H,this),Object(j.a)(this,"maxY",U,this),Object(j.a)(this,"cursorX",Y,this),Object(j.a)(this,"markerTextVisible",X,this),Object(j.a)(this,"isMouseMoveIntoLinePlots",K,this),Object(j.a)(this,"wcsAxisVisible",Q,this),Object(j.a)(this,"plotType",Z,this),Object(j.a)(this,"meanRmsVisible",$,this),Object(j.a)(this,"primaryLineColor",J,this),Object(j.a)(this,"lineWidth",ee,this),Object(j.a)(this,"linePlotPointSize",te,this),Object(j.a)(this,"linePlotInitXYBoundaries",ie,this),this.smoothingStore=void 0,Object(j.a)(this,"settingsTabId",ne,this),Object(j.a)(this,"setFileId",re,this),Object(j.a)(this,"setRegionId",oe,this),Object(j.a)(this,"setCoordinate",ae,this),Object(j.a)(this,"setXBounds",se,this),Object(j.a)(this,"clearXBounds",le,this),Object(j.a)(this,"setYBounds",ce,this),Object(j.a)(this,"clearYBounds",ue,this),Object(j.a)(this,"setXYBounds",pe,this),Object(j.a)(this,"clearXYBounds",de,this),Object(j.a)(this,"setMarkerTextVisible",he,this),Object(j.a)(this,"setMeanRmsVisible",ge,this),Object(j.a)(this,"setWcsAxisVisible",me,this),Object(j.a)(this,"setPlotType",fe,this),Object(j.a)(this,"setCursor",ye,this),Object(j.a)(this,"setMouseMoveIntoLinePlots",be,this),Object(j.a)(this,"setSettingsTabId",Oe,this),Object(j.a)(this,"setPrimaryLineColor",Se,this),Object(j.a)(this,"setLineWidth",Ce,this),Object(j.a)(this,"setLinePlotPointSize",Ee,this),this.init=t=>{if(!t)return;"string"===typeof t.coordinate&&e.ValidCoordinates.includes(t.coordinate)&&(this.coordinate=t.coordinate);const i=N()(t.primaryLineColor);i.isValid()&&(this.primaryLineColor.colorHex=i.toHexString()),"number"===typeof t.lineWidth&&t.lineWidth>=L.i.MIN_WIDTH&&t.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=t.lineWidth),"number"===typeof t.linePlotPointSize&&t.linePlotPointSize>=L.i.MIN_POINT_SIZE&&t.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=t.linePlotPointSize),"boolean"===typeof t.wcsAxisVisible&&(this.wcsAxisVisible=t.wcsAxisVisible),"boolean"===typeof t.meanRmsVisible&&(this.meanRmsVisible=t.meanRmsVisible),"string"!==typeof t.plotType||t.plotType!==L.j.STEPS&&t.plotType!==L.j.LINES&&t.plotType!==L.j.POINTS||(this.plotType=t.plotType),"number"===typeof t.minXVal&&(this.linePlotInitXYBoundaries.minXVal=t.minXVal),"number"===typeof t.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=t.maxXVal),"number"===typeof t.minYVal&&(this.linePlotInitXYBoundaries.minYVal=t.minYVal),"number"===typeof t.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=t.maxYVal)},this.toConfig=()=>({coordinate:this.coordinate,primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,wcsAxisVisible:this.wcsAxisVisible,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(F.p)(this),this.coordinate=t,this.fileId=i,this.regionId=n,this.plotType=L.j.STEPS,this.meanRmsVisible=!1,this.markerTextVisible=!1,this.wcsAxisVisible=!0,this.primaryLineColor={colorHex:M.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.smoothingStore=new Te.I,this.settingsTabId=Ae.x.STYLING}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}static CalculateRequirementsMap(e,t){const i=new Map;return t.forEach(t=>{const n=e.frameInfo.fileId,r=t.coordinate;if(!e.regionSet)return;if(e.regionSet.regions.find(e=>0===e.regionId)){let e=i.get(n);e||(e=new Map,i.set(n,e));let t=e.get(0);t||(t=new ve.a.SetSpatialRequirements({regionId:0,fileId:n}),e.set(0,t)),t.spatialProfiles||(t.spatialProfiles=[]),-1===t.spatialProfiles.indexOf(r)&&t.spatialProfiles.push(r)}}),i}static DiffSpatialRequirements(e,t){const i=[];return e.forEach((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach((e,t)=>{let r=n.get(t);r||(r=new ve.a.SetSpatialRequirements({fileId:i,regionId:t,spatialProfiles:[]}),n.set(t,r))})}),t.forEach((t,n)=>{let r=e.get(n);r?t.forEach((e,t)=>{let n=r.get(t);if(n){const t=n.spatialProfiles?n.spatialProfiles.length:0,r=e.spatialProfiles?e.spatialProfiles.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.spatialProfiles.sort(),a=n.spatialProfiles.sort();for(let n=0;n<r;n++){if(o[n]!==a[n])return void i.push(e)}}else i.push(e)}):t.forEach(e=>i.push(e))}),i.sort((e,t)=>e.spatialProfiles.length>t.spatialProfiles.length?1:-1)}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ie.ValidCoordinates=["x","y","Ix","Iy","Qx","Qy","Ux","Uy","Vx","Vy"],z=we,W=Object(k.a)(z.prototype,"fileId",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=Object(k.a)(z.prototype,"regionId",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(k.a)(z.prototype,"coordinate",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=Object(k.a)(z.prototype,"minX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=Object(k.a)(z.prototype,"maxX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=Object(k.a)(z.prototype,"minY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Object(k.a)(z.prototype,"maxY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=Object(k.a)(z.prototype,"cursorX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=Object(k.a)(z.prototype,"markerTextVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(k.a)(z.prototype,"isMouseMoveIntoLinePlots",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=Object(k.a)(z.prototype,"wcsAxisVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(k.a)(z.prototype,"plotType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Object(k.a)(z.prototype,"meanRmsVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(k.a)(z.prototype,"primaryLineColor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Object(k.a)(z.prototype,"lineWidth",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Object(k.a)(z.prototype,"linePlotPointSize",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Object(k.a)(z.prototype,"linePlotInitXYBoundaries",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(k.a)(z.prototype,"settingsTabId",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(k.a)(z.prototype,"setFileId",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearXYBounds(),this.fileId=e}}}),oe=Object(k.a)(z.prototype,"setRegionId",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearXYBounds(),this.regionId=e}}}),ae=Object(k.a)(z.prototype,"setCoordinate",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{xe.ValidCoordinates.includes(e)&&(this.clearXYBounds(),this.coordinate=e)}}}),se=Object(k.a)(z.prototype,"setXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),le=Object(k.a)(z.prototype,"clearXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),ce=Object(k.a)(z.prototype,"setYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),ue=Object(k.a)(z.prototype,"clearYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),pe=Object(k.a)(z.prototype,"setXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),de=Object(k.a)(z.prototype,"clearXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),he=Object(k.a)(z.prototype,"setMarkerTextVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),ge=Object(k.a)(z.prototype,"setMeanRmsVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),me=Object(k.a)(z.prototype,"setWcsAxisVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.wcsAxisVisible=e}}}),fe=Object(k.a)(z.prototype,"setPlotType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),ye=Object(k.a)(z.prototype,"setCursor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),be=Object(k.a)(z.prototype,"setMouseMoveIntoLinePlots",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),Oe=Object(k.a)(z.prototype,"setSettingsTabId",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(k.a)(z.prototype,"isAutoScaledX",[F.i],Object.getOwnPropertyDescriptor(z.prototype,"isAutoScaledX"),z.prototype),Object(k.a)(z.prototype,"isAutoScaledY",[F.i],Object.getOwnPropertyDescriptor(z.prototype,"isAutoScaledY"),z.prototype),Se=Object(k.a)(z.prototype,"setPrimaryLineColor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),Ce=Object(k.a)(z.prototype,"setLineWidth",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),Ee=Object(k.a)(z.prototype,"setLinePlotPointSize",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(k.a)(z.prototype,"initXYBoundaries",[F.g],Object.getOwnPropertyDescriptor(z.prototype,"initXYBoundaries"),z.prototype),z);var Re,Pe,je,ke,Fe,Me,De,Ne,Le,_e,ze,We,Ge,Ve,Be,qe,He,Ue,Ye,Xe,Ke,Qe,Ze,$e,Je,et,tt,it,nt,rt,ot,at,st,lt=i(28),ct=i(64),ut=i(10),pt=i(6);let dt,ht,gt;!function(e){e.Range="Range",e.Center="Center"}(dt||(dt={})),function(e){e.GHz="GHz",e.MHz="MHz",e.CM="cm",e.MM="mm"}(ht||(ht={})),function(e){e.Species="Species",e.ChemicalName="Chemical Name",e.ShiftedFrequency="Shifted Frequency",e.RestFrequencySPLA="Freq-MHz(rest frame,redshifted)",e.RestFrequency="Rest Frequency",e.RestFrequencyErrSPLA="Freq Err(rest frame,redshifted)",e.RestFrequencyErr="Rest Frequency Error",e.MeasuredFrequencySPLA="Meas Freq-MHz(rest frame,redshifted)",e.MeasuredFrequency="Measured Frequency",e.MeasuredFrequencyErrSPLA="Meas Freq Err(rest frame,redshifted)",e.MeasuredFrequencyErr="Measured Frequency Error",e.ResolvedQN="Resolved QNs",e.UnresolvedQN="Unresolved QNs",e.IntensityCDMS="CDMS/JPL Intensity",e.IntensitySijm2SPLA="S<sub>ij</sub>&#956;<sup>2</sup> (D<sup>2</sup>)",e.IntensitySijm2="Sij \u03bc^2",e.IntensitySijSPLA="S<sub>ij</sub>",e.IntensitySij="Sij",e.IntensityAijSPLA="Log<sub>10</sub> (A<sub>ij</sub>)",e.IntensityAij="Log10(Aij)",e.IntensityLovas="Lovas/AST Intensity",e.EnergyLowerCM="E_L (cm^-1)",e.EnergyLowerK="E_L (K)",e.EnergyUpperCM="E_U (cm^-1)",e.EnergyUpperK="E_U (K)",e.LineList="Linelist"}(gt||(gt={}));const mt=new Map([[gt.RestFrequencySPLA,gt.RestFrequency],[gt.RestFrequencyErrSPLA,gt.RestFrequencyErr],[gt.MeasuredFrequencySPLA,gt.MeasuredFrequency],[gt.MeasuredFrequencyErrSPLA,gt.MeasuredFrequencyErr],[gt.IntensitySijm2SPLA,gt.IntensitySijm2],[gt.IntensitySijSPLA,gt.IntensitySij],[gt.IntensityAijSPLA,gt.IntensityAij]]),ft=new Map([[gt.Species,"Descriptive formula of molecular species"],[gt.ChemicalName,"Common chemical name for species"],[gt.ShiftedFrequency,"Shifted frequency according to the input velocity or redshift"],[gt.RestFrequency,"Frequency at the rest frame"],[gt.RestFrequencyErr,"Frequency error at the rest frame"],[gt.MeasuredFrequency,"Frequency measured from laboratories"],[gt.MeasuredFrequencyErr,"Frequency error measured from laboratories"],[gt.ResolvedQN,"Rotational/rovibrational quantum numbers associated with the transition"],[gt.IntensityCDMS,"Boltzmann-weighted logarithmic intensity of transition, given at 300 K"],[gt.IntensitySijm2,"Dipole-weighted transition dipole matrix elements (Debye^2)"],[gt.IntensitySij,"Line strength"],[gt.IntensityAij,"Base-10 logarithm of the Einstein A coefficient (s^-1)"],[gt.IntensityLovas,"Observed astronomical intensity for given transition"],[gt.EnergyLowerCM,"Lower level energy in wave number"],[gt.EnergyLowerK,"Lower level energy in K"],[gt.EnergyUpperCM,"Upper level energy in wave number"],[gt.EnergyUpperK,"Upper level energy in K"],[gt.LineList,"Originated catalogue"]]);let yt;!function(e){e.V="Velocity (km/s)",e.Z="Redshift"}(yt||(yt={}));let bt=(Re=class extends ct.c{setQueryResultTableRef(e){this.queryResultTableRef=e}clearData(){this.queryResult.clear()}get formalizedHeaders(){let e=[];return this.columnHeaders.forEach(t=>{Object.values(gt).includes(t.name)&&e.push({name:t.name,desc:ft.get(t.name)})}),e}get redshiftFactor(){return this.redshiftType===yt.V?Math.sqrt((1-1e3*this.redshiftInput/pt.d)/(1+1e3*this.redshiftInput/pt.d)):1/(this.redshiftInput+1)}get displayedColumnHeaders(){let e=[];return this.columnHeaders.forEach(t=>{this.headerDisplay.get(t.name)&&e.push(t)}),e}get isSelectingAllLines(){let e=!0;if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0)for(let t=0;t<this.isLineSelectedArray.length;t++)e=e&&this.isLineSelectedArray[t];return e}get isSelectingIndeterminatedLines(){let e=!1;if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0)for(let t=0;t<this.isLineSelectedArray.length;t++)e=e||this.isLineSelectedArray[t];return e&&!this.isSelectingAllLines}get manualSelectionData(){return this.isLineSelectedArray&&this.isLineSelectedArray.length>0?[...this.isLineSelectedArray]:[]}get selectedLines(){const e=[];if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0)for(let t=0;t<this.isLineSelectedArray.length;t++)if(this.isLineSelectedArray[t]){const i=this.queryResult.get(0),n=this.queryResult.get(2),r=this.queryResult.get(7);e.push({species:i.data[t],value:n.data[t],qn:r.data[t]})}return e}constructor(){super(ct.d.CLOSED),Object(j.a)(this,"queryRangeType",Pe,this),Object(j.a)(this,"queryRange",je,this),Object(j.a)(this,"queryRangeByCenter",ke,this),Object(j.a)(this,"queryUnit",Fe,this),Object(j.a)(this,"intensityLimitEnabled",Me,this),Object(j.a)(this,"intensityLimitValue",De,this),Object(j.a)(this,"isQuerying",Ne,this),Object(j.a)(this,"columnHeaders",Le,this),Object(j.a)(this,"headerDisplay",_e,this),Object(j.a)(this,"redshiftType",ze,this),Object(j.a)(this,"redshiftInput",We,this),Object(j.a)(this,"queryResultTableRef",Ge,this),Object(j.a)(this,"queryResult",Ve,this),Object(j.a)(this,"isLineSelectedArray",Be,this),Object(j.a)(this,"restFreqColumn",qe,this),Object(j.a)(this,"measuredFreqColumn",He,this),Object(j.a)(this,"sortingInfo",Ue,this),Object(j.a)(this,"numDataRows",Ye,this),Object(j.a)(this,"selectedSpectralProfilerID",Xe,this),Object(j.a)(this,"setQueryRangeType",Ke,this),Object(j.a)(this,"setQueryRange",Qe,this),Object(j.a)(this,"setQueryRangeByCenter",Ze,this),Object(j.a)(this,"setQueryUnit",$e,this),Object(j.a)(this,"toggleIntensityLimit",Je,this),Object(j.a)(this,"setIntensityLimitValue",et,this),Object(j.a)(this,"setHeaderDisplay",tt,this),Object(j.a)(this,"setRedshiftType",it,this),Object(j.a)(this,"setRedshiftInput",nt,this),Object(j.a)(this,"selectAllLines",rt,this),Object(j.a)(this,"selectSingleLine",ot,this),Object(j.a)(this,"setSelectedSpectralProfiler",at,this),Object(j.a)(this,"query",st,this),this.calculateFreqMHz=(e,t)=>{if(isFinite(e)&&null!==e&&!(e<0)&&t)return t===ht.CM?Object(pt.nb)(e/100)/1e6:t===ht.MM?Object(pt.nb)(e/1e3)/1e6:t===ht.GHz?1e3*e:t===ht.MHz?e:void 0},Object(F.p)(this),this.queryRangeType=dt.Range,this.queryRange=[0,0],this.queryRangeByCenter=[0,0],this.queryUnit=ht.MHz,this.intensityLimitEnabled=!0,this.intensityLimitValue=-5,this.isQuerying=!1,this.columnHeaders=[],this.headerDisplay=new Map,Object.values(gt).forEach(e=>this.headerDisplay.set(e,!0)),this.redshiftType=yt.V,this.redshiftInput=0,this.queryResultTableRef=void 0,this.queryResult=new Map,this.restFreqColumn=void 0,this.measuredFreqColumn=void 0,this.numDataRows=0,this.isLineSelectedArray=[],this.selectedSpectralProfilerID=Te.e.Instance.widgetsStore.spectralProfilerList.length>0?Te.e.Instance.widgetsStore.spectralProfilerList[0]:void 0,this.sortingInfo={columnName:null,sortingType:null},Object(F.h)(()=>{var e,t;if(this.queryResult.size>0&&(null===(e=this.restFreqColumn)||void 0===e?void 0:e.data)&&(null===(t=this.measuredFreqColumn)||void 0===t?void 0:t.data)){const e=this.restFreqColumn.data.map((e,t)=>{let i=parseFloat(e);return!isFinite(i)&&t<this.measuredFreqColumn.data.length&&(i=parseFloat(this.measuredFreqColumn.data[t])),isFinite(i)?i*this.redshiftFactor:void 0});this.queryResult.set(2,{dataType:ve.a.ColumnType.Double,data:e})}}),Object(F.h)(()=>{Te.e.Instance.widgetsStore.getSpectralWidgetStoreByID(this.selectedSpectralProfilerID)||(this.selectedSpectralProfilerID=Te.e.Instance.widgetsStore.spectralProfilerList.length>0?Te.e.Instance.widgetsStore.spectralProfilerList[0]:void 0)})}},Pe=Object(k.a)(Re.prototype,"queryRangeType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=Object(k.a)(Re.prototype,"queryRange",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke=Object(k.a)(Re.prototype,"queryRangeByCenter",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=Object(k.a)(Re.prototype,"queryUnit",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Object(k.a)(Re.prototype,"intensityLimitEnabled",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=Object(k.a)(Re.prototype,"intensityLimitValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ne=Object(k.a)(Re.prototype,"isQuerying",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Object(k.a)(Re.prototype,"columnHeaders",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(k.a)(Re.prototype,"headerDisplay",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Object(k.a)(Re.prototype,"redshiftType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=Object(k.a)(Re.prototype,"redshiftInput",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=Object(k.a)(Re.prototype,"queryResultTableRef",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Object(k.a)(Re.prototype,"queryResult",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=Object(k.a)(Re.prototype,"isLineSelectedArray",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qe=Object(k.a)(Re.prototype,"restFreqColumn",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=Object(k.a)(Re.prototype,"measuredFreqColumn",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue=Object(k.a)(Re.prototype,"sortingInfo",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye=Object(k.a)(Re.prototype,"numDataRows",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Object(k.a)(Re.prototype,"selectedSpectralProfilerID",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=Object(k.a)(Re.prototype,"setQueryRangeType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRangeType=e}}}),Qe=Object(k.a)(Re.prototype,"setQueryRange",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRange=e}}}),Ze=Object(k.a)(Re.prototype,"setQueryRangeByCenter",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRangeByCenter=e}}}),$e=Object(k.a)(Re.prototype,"setQueryUnit",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryUnit=e}}}),Je=Object(k.a)(Re.prototype,"toggleIntensityLimit",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.intensityLimitEnabled=!this.intensityLimitEnabled}}}),et=Object(k.a)(Re.prototype,"setIntensityLimitValue",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.intensityLimitValue=e}}}),tt=Object(k.a)(Re.prototype,"setHeaderDisplay",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.headerDisplay.set(e,!this.headerDisplay.get(e))}}}),it=Object(k.a)(Re.prototype,"setRedshiftType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.redshiftType=e,e===yt.Z&&this.redshiftInput<0&&(this.redshiftInput=0)}}}),nt=Object(k.a)(Re.prototype,"setRedshiftInput",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{isFinite(e)&&(this.redshiftInput=e)}}}),Object(k.a)(Re.prototype,"setQueryResultTableRef",[F.g],Object.getOwnPropertyDescriptor(Re.prototype,"setQueryResultTableRef"),Re.prototype),rt=Object(k.a)(Re.prototype,"selectAllLines",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0){const e=this.isSelectingAllLines;for(let t=0;t<this.isLineSelectedArray.length;t++)this.isLineSelectedArray[t]=!e}}}}),ot=Object(k.a)(Re.prototype,"selectSingleLine",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isLineSelectedArray&&this.isLineSelectedArray.length>0&&isFinite(e)&&e>=0&&e<this.isLineSelectedArray.length&&(this.isLineSelectedArray[e]=!this.isLineSelectedArray[e])}}}),at=Object(k.a)(Re.prototype,"setSelectedSpectralProfiler",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedSpectralProfilerID=e}}}),st=Object(k.a)(Re.prototype,"query",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e=0,t=0;this.queryRangeType===dt.Range?(e=this.queryRange[0],t=this.queryRange[1]):(e=this.queryRangeByCenter[0]-this.queryRangeByCenter[1],t=this.queryRangeByCenter[0]+this.queryRangeByCenter[1]);const i=this.calculateFreqMHz(e,this.queryUnit),n=this.calculateFreqMHz(t,this.queryUnit);if(!isFinite(i)||!isFinite(n)||i<0||n<0)Te.e.Instance.alertStore.showAlert("Invalid frequency range.");else if(i===n)Te.e.Instance.alertStore.showAlert("Please specify a frequency range.");else if(Math.abs(n-i)>2e4)Te.e.Instance.alertStore.showAlert(`Frequency range ${i<=n?i:n} MHz to ${i<=n?n:i} MHz is too wide.Please specify a frequency range within 20 GHz.`);else{this.isQuerying=!0;lt.b.Instance.requestSpectralLine(new ve.a.DoubleBounds({min:i,max:n}),this.intensityLimitEnabled?this.intensityLimitValue:NaN).subscribe(e=>{this.isQuerying=!1,e.success&&e.dataSize>=0?(e.dataSize>0?(this.numDataRows=e.dataSize,this.isLineSelectedArray=new Array(this.numDataRows).fill(!1),this.queryResult=ut.ProtobufProcessing.ProcessCatalogData(e.spectralLineData),this.restFreqColumn=this.queryResult.get(3),this.measuredFreqColumn=this.queryResult.get(5)):(this.numDataRows=0,this.isLineSelectedArray=[],this.queryResult=new Map,this.restFreqColumn=void 0,this.measuredFreqColumn=void 0),e.headers.forEach(e=>{mt.has(e.name)&&(e.name=mt.get(e.name))}),this.columnHeaders=e.headers.sort((e,t)=>e.columnIndex-t.columnIndex)):Te.e.Instance.alertStore.showAlert(e.message)},e=>{this.isQuerying=!1,console.error(e),Te.e.Instance.alertStore.showAlert(e)})}}}}),Object(k.a)(Re.prototype,"clearData",[F.g],Object.getOwnPropertyDescriptor(Re.prototype,"clearData"),Re.prototype),Object(k.a)(Re.prototype,"formalizedHeaders",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"formalizedHeaders"),Re.prototype),Object(k.a)(Re.prototype,"redshiftFactor",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"redshiftFactor"),Re.prototype),Object(k.a)(Re.prototype,"displayedColumnHeaders",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"displayedColumnHeaders"),Re.prototype),Object(k.a)(Re.prototype,"isSelectingAllLines",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"isSelectingAllLines"),Re.prototype),Object(k.a)(Re.prototype,"isSelectingIndeterminatedLines",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"isSelectingIndeterminatedLines"),Re.prototype),Object(k.a)(Re.prototype,"manualSelectionData",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"manualSelectionData"),Re.prototype),Object(k.a)(Re.prototype,"selectedLines",[F.i],Object.getOwnPropertyDescriptor(Re.prototype,"selectedLines"),Re.prototype),Re);var Ot,St,Ct,Et,It,wt,Tt,vt,At,xt,Rt,Pt,jt,kt,Ft,Mt,Dt,Nt,Lt,_t,zt,Wt,Gt,Vt,Bt,qt,Ht,Ut,Yt,Xt,Kt,Qt,Zt,$t,Jt,ei,ti,ii,ni,ri,oi,ai,si,li,ci,ui,pi,di,hi,gi,mi,fi,yi,bi,Oi,Si,Ci,Ei,Ii,wi,Ti,vi,Ai,xi,Ri,Pi,ji=i(127);let ki;!function(e){e[e.NONE=1]="NONE",e[e.CHANNEL=2]="CHANNEL",e[e.MASK=3]="MASK"}(ki||(ki={}));let Fi=(Pi=Ri=class extends ct.c{static StatsTypeString(e){switch(e){case ve.a.StatsType.Sum:return"Sum";case ve.a.StatsType.FluxDensity:return"FluxDensity";case ve.a.StatsType.Mean:return"Mean";case ve.a.StatsType.Sigma:return"StdDev";case ve.a.StatsType.Min:return"Min";case ve.a.StatsType.Max:return"Max";case ve.a.StatsType.Extrema:return"Extrema";case ve.a.StatsType.RMS:return"RMS";case ve.a.StatsType.SumSq:return"SumSq";default:return"Not Implemented"}}constructor(e="z"){super(ct.d.CLOSED_AND_POINT),Object(j.a)(this,"coordinate",St,this),Object(j.a)(this,"statsType",Ct,this),Object(j.a)(this,"minX",Et,this),Object(j.a)(this,"maxX",It,this),Object(j.a)(this,"minY",wt,this),Object(j.a)(this,"maxY",Tt,this),Object(j.a)(this,"cursorX",vt,this),Object(j.a)(this,"channel",At,this),Object(j.a)(this,"markerTextVisible",xt,this),Object(j.a)(this,"isMouseMoveIntoLinePlots",Rt,this),Object(j.a)(this,"isStreamingData",Pt,this),Object(j.a)(this,"isHighlighted",jt,this),Object(j.a)(this,"spectralLinesMHz",kt,this),Object(j.a)(this,"plotType",Ft,this),Object(j.a)(this,"meanRmsVisible",Mt,this),Object(j.a)(this,"primaryLineColor",Dt,this),Object(j.a)(this,"lineWidth",Nt,this),Object(j.a)(this,"linePlotPointSize",Lt,this),Object(j.a)(this,"linePlotInitXYBoundaries",_t,this),this.smoothingStore=void 0,Object(j.a)(this,"settingsTabId",zt,this),Object(j.a)(this,"selectingMode",Wt,this),Object(j.a)(this,"channelValueRange",Gt,this),Object(j.a)(this,"momentMask",Vt,this),Object(j.a)(this,"maskRange",Bt,this),Object(j.a)(this,"selectedMoments",qt,this),Object(j.a)(this,"setRegionId",Ht,this),Object(j.a)(this,"setStatsType",Ut,this),Object(j.a)(this,"setCoordinate",Yt,this),Object(j.a)(this,"setSpectralCoordinate",Xt,this),Object(j.a)(this,"setSpectralSystem",Kt,this),Object(j.a)(this,"setMomentRangeSelectingMode",Qt,this),Object(j.a)(this,"clearMomentRangeSelectingMode",Zt,this),Object(j.a)(this,"setSelectedChannelRange",$t,this),Object(j.a)(this,"setSelectedMaskRange",Jt,this),Object(j.a)(this,"updateRanges",ei,this),Object(j.a)(this,"setMomentMask",ti,this),Object(j.a)(this,"selectMoment",ii,this),Object(j.a)(this,"deselectMoment",ni,this),Object(j.a)(this,"removeMomentByIndex",ri,this),Object(j.a)(this,"clearSelectedMoments",oi,this),Object(j.a)(this,"isMomentSelected",ai,this),Object(j.a)(this,"requestMoment",si,this),Object(j.a)(this,"requestingMomentCancelled",li,this),Object(j.a)(this,"setHighlighted",ci,this),Object(j.a)(this,"addSpectralLines",ui,this),Object(j.a)(this,"clearSpectralLines",pi,this),Object(j.a)(this,"setXBounds",di,this),Object(j.a)(this,"clearXBounds",hi,this),Object(j.a)(this,"setYBounds",gi,this),Object(j.a)(this,"clearYBounds",mi,this),Object(j.a)(this,"setXYBounds",fi,this),Object(j.a)(this,"clearXYBounds",yi,this),Object(j.a)(this,"setMarkerTextVisible",bi,this),Object(j.a)(this,"setMeanRmsVisible",Oi,this),Object(j.a)(this,"setPlotType",Si,this),Object(j.a)(this,"setChannel",Ci,this),Object(j.a)(this,"setCursor",Ei,this),Object(j.a)(this,"setMouseMoveIntoLinePlots",Ii,this),Object(j.a)(this,"updateStreamingDataStatus",wi,this),Object(j.a)(this,"setSettingsTabId",Ti,this),Object(j.a)(this,"setPrimaryLineColor",vi,this),Object(j.a)(this,"setLineWidth",Ai,this),Object(j.a)(this,"setLinePlotPointSize",xi,this),this.init=e=>{if(!e)return;const t=N()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=L.i.MIN_WIDTH&&e.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=L.i.MIN_POINT_SIZE&&e.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.meanRmsVisible&&(this.meanRmsVisible=e.meanRmsVisible),"string"!==typeof e.plotType||e.plotType!==L.j.STEPS&&e.plotType!==L.j.LINES&&e.plotType!==L.j.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(F.p)(this),this.coordinate=e,this.statsType=ve.a.StatsType.Mean,this.isStreamingData=!1,this.isHighlighted=!1,this.spectralLinesMHz=[],this.plotType=L.j.STEPS,this.meanRmsVisible=!1,this.markerTextVisible=!1,this.primaryLineColor={colorHex:M.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.smoothingStore=new ji.a,this.selectingMode=ki.NONE,this.channelValueRange=[0,0],this.momentMask=ve.a.MomentMask.None,this.maskRange=[0,1],this.selectedMoments=[ve.a.Moment.INTEGRATED_OF_THE_SPECTRUM],this.settingsTabId=Ae.B.CONVERSION,Object(F.h)(()=>{this.effectiveFrame&&this.updateRanges()})}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}get isSelectingMomentChannelRange(){return this.selectingMode===ki.CHANNEL}get isSelectingMomentMaskRange(){return this.selectingMode===ki.MASK}get selectedRange(){return this.isSelectingMomentChannelRange?{isHorizontal:!1,center:(this.channelValueRange[0]+this.channelValueRange[1])/2,width:Math.abs(this.channelValueRange[0]-this.channelValueRange[1])}:this.isSelectingMomentMaskRange?{isHorizontal:!0,center:(this.maskRange[0]+this.maskRange[1])/2,width:Math.abs(this.maskRange[0]-this.maskRange[1])}:null}get transformedSpectralLines(){let e=[];const t=this.effectiveFrame;return t&&this.spectralLinesMHz&&this.spectralLinesMHz.forEach(i=>{const n=t.convertFreqMHzToSettingWCS(i.value);isFinite(n)&&e.push({species:i.species,value:n,qn:i.qn})}),e}static CalculateRequirementsMap(e){const t=new Map;return e.forEach(e=>{const i=e.effectiveFrame;if(!i||!i.regionSet)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=e.coordinate;let a=e.statsType;const s=i.regionSet.regions.find(e=>e.regionId===r);if(s){s.regionType===ve.a.RegionType.POINT&&(a=ve.a.StatsType.Sum);let e=t.get(n);e||(e=new Map,t.set(n,e));let i=e.get(r);i||(i=new ve.a.SetSpectralRequirements({regionId:r,fileId:n}),e.set(r,i)),i.spectralProfiles||(i.spectralProfiles=[]);let l=i.spectralProfiles.find(e=>e.coordinate===o);l?-1===l.statsTypes.indexOf(a)&&l.statsTypes.push(a):i.spectralProfiles.push({coordinate:o,statsTypes:[a]})}}),t}static DiffSpectralRequirements(e,t){const i=[];return e.forEach((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach((e,t)=>{let r=n.get(t);r||(r=new ve.a.SetSpectralRequirements({fileId:i,regionId:t,spectralProfiles:[]}),n.set(t,r))})}),t.forEach((t,n)=>{let r=e.get(n);r?t.forEach((e,t)=>{let n=r.get(t);if(n){const t=n.spectralProfiles?n.spectralProfiles.length:0,r=e.spectralProfiles?e.spectralProfiles.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.spectralProfiles.sort((e,t)=>e.coordinate>t.coordinate?1:-1),a=n.spectralProfiles.sort((e,t)=>e.coordinate>t.coordinate?1:-1);for(let n=0;n<r;n++){const t=o[n],r=a[n];if(t.coordinate!==r.coordinate)return void i.push(e);const s=r.statsTypes?r.statsTypes.length:0,l=t.statsTypes?t.statsTypes.length:0;if(s!==l)return void i.push(e);if(0===s)return;const c=t.statsTypes.sort(),u=r.statsTypes.sort();for(let n=0;n<l;n++)if(c[n]!==u[n])return void i.push(e)}}else i.push(e)}):t.forEach(e=>i.push(e))}),i.sort((e,t)=>e.spectralProfiles.length>t.spectralProfiles.length?1:-1)}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ri.ValidCoordinates=["z","Iz","Qz","Uz","Vz"],Ri.ValidStatsTypes=[ve.a.StatsType.Sum,ve.a.StatsType.FluxDensity,ve.a.StatsType.Mean,ve.a.StatsType.Sigma,ve.a.StatsType.Min,ve.a.StatsType.Max,ve.a.StatsType.Extrema,ve.a.StatsType.RMS,ve.a.StatsType.SumSq],Ot=Pi,St=Object(k.a)(Ot.prototype,"coordinate",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=Object(k.a)(Ot.prototype,"statsType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=Object(k.a)(Ot.prototype,"minX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=Object(k.a)(Ot.prototype,"maxX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=Object(k.a)(Ot.prototype,"minY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=Object(k.a)(Ot.prototype,"maxY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Object(k.a)(Ot.prototype,"cursorX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Object(k.a)(Ot.prototype,"channel",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Object(k.a)(Ot.prototype,"markerTextVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=Object(k.a)(Ot.prototype,"isMouseMoveIntoLinePlots",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=Object(k.a)(Ot.prototype,"isStreamingData",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt=Object(k.a)(Ot.prototype,"isHighlighted",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=Object(k.a)(Ot.prototype,"spectralLinesMHz",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=Object(k.a)(Ot.prototype,"plotType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=Object(k.a)(Ot.prototype,"meanRmsVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=Object(k.a)(Ot.prototype,"primaryLineColor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(k.a)(Ot.prototype,"lineWidth",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=Object(k.a)(Ot.prototype,"linePlotPointSize",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=Object(k.a)(Ot.prototype,"linePlotInitXYBoundaries",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=Object(k.a)(Ot.prototype,"settingsTabId",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=Object(k.a)(Ot.prototype,"selectingMode",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=Object(k.a)(Ot.prototype,"channelValueRange",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=Object(k.a)(Ot.prototype,"momentMask",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt=Object(k.a)(Ot.prototype,"maskRange",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Object(k.a)(Ot.prototype,"selectedMoments",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=Object(k.a)(Ot.prototype,"setRegionId",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.regionIdMap.set(e,t),this.clearXYBounds()}}}),Ut=Object(k.a)(Ot.prototype,"setStatsType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==Fi.ValidStatsTypes.indexOf(e)&&(this.statsType=e)}}}),Yt=Object(k.a)(Ot.prototype,"setCoordinate",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==Fi.ValidCoordinates.indexOf(e)&&(this.clearXYBounds(),this.coordinate=e)}}}),Xt=Object(k.a)(Ot.prototype,"setSpectralCoordinate",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;if(t&&t.spectralCoordsSupported&&t.spectralCoordsSupported.has(e)){const i=t.spectralCoordsSupported.get(e);t.spectralType=i.type,t.spectralUnit=i.unit,this.clearXBounds()}}}}),Kt=Object(k.a)(Ot.prototype,"setSpectralSystem",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;t&&t.spectralSystemsSupported&&t.spectralSystemsSupported.includes(e)&&(t.spectralSystem=e,this.clearXBounds())}}}),Qt=Object(k.a)(Ot.prototype,"setMomentRangeSelectingMode",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.selectingMode=e)}}}),Zt=Object(k.a)(Ot.prototype,"clearMomentRangeSelectingMode",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectingMode=ki.NONE}}}),$t=Object(k.a)(Ot.prototype,"setSelectedChannelRange",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{isFinite(e)&&isFinite(t)&&(this.channelValueRange[0]=e,this.channelValueRange[1]=t),this.selectingMode=ki.NONE}}}),Jt=Object(k.a)(Ot.prototype,"setSelectedMaskRange",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{isFinite(e)&&isFinite(t)&&(this.maskRange[0]=e,this.maskRange[1]=t),this.selectingMode=ki.NONE}}}),ei=Object(k.a)(Ot.prototype,"updateRanges",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&e.channelValueBounds&&(this.channelValueRange[0]=e.channelValueBounds.min,this.channelValueRange[1]=e.channelValueBounds.max,this.maskRange[0]=0,this.maskRange[1]=1)}}}),ti=Object(k.a)(Ot.prototype,"setMomentMask",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.momentMask=e}}}),ii=Object(k.a)(Ot.prototype,"selectMoment",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedMoments.includes(e)||this.selectedMoments.push(e)}}}),ni=Object(k.a)(Ot.prototype,"deselectMoment",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedMoments.includes(e)&&(this.selectedMoments=this.selectedMoments.filter(t=>t!==e))}}}),ri=Object(k.a)(Ot.prototype,"removeMomentByIndex",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=0&&e<this.selectedMoments.length&&(this.selectedMoments=this.selectedMoments.filter((t,i)=>i!==e))}}}),oi=Object(k.a)(Ot.prototype,"clearSelectedMoments",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedMoments=[]}}}),ai=Object(k.a)(Ot.prototype,"isMomentSelected",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>this.selectedMoments.includes(e)}}),si=Object(k.a)(Ot.prototype,"requestMoment",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame,t=e.findChannelIndexByValue(this.channelValueRange[0]),i=e.findChannelIndexByValue(this.channelValueRange[1]);if(e&&isFinite(t)&&isFinite(i)){const n={min:t<=i?t:i,max:t<=i?i:t},r={fileId:e.frameInfo.fileId,moments:this.selectedMoments,axis:ve.a.MomentAxis.SPECTRAL,regionId:this.fileId===ct.a&&0===this.effectiveRegionId?-1:this.effectiveRegionId,spectralRange:n,mask:this.momentMask,pixelRange:new ve.a.FloatBounds({min:this.maskRange[0],max:this.maskRange[1]})};e.resetMomentRequestState(),e.setIsRequestingMoments(!0),Te.e.Instance.requestMoment(r,e)}}}}),li=Object(k.a)(Ot.prototype,"requestingMomentCancelled",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&Te.e.Instance.cancelRequestingMoment(e.frameInfo.fileId)}}}),ci=Object(k.a)(Ot.prototype,"setHighlighted",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isHighlighted=e}}}),ui=Object(k.a)(Ot.prototype,"addSpectralLines",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.spectralLinesMHz=e)}}}),pi=Object(k.a)(Ot.prototype,"clearSpectralLines",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralLinesMHz=[]}}}),di=Object(k.a)(Ot.prototype,"setXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),hi=Object(k.a)(Ot.prototype,"clearXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),gi=Object(k.a)(Ot.prototype,"setYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),mi=Object(k.a)(Ot.prototype,"clearYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),fi=Object(k.a)(Ot.prototype,"setXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),yi=Object(k.a)(Ot.prototype,"clearXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),bi=Object(k.a)(Ot.prototype,"setMarkerTextVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),Oi=Object(k.a)(Ot.prototype,"setMeanRmsVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),Si=Object(k.a)(Ot.prototype,"setPlotType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),Ci=Object(k.a)(Ot.prototype,"setChannel",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channel=e}}}),Ei=Object(k.a)(Ot.prototype,"setCursor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Ii=Object(k.a)(Ot.prototype,"setMouseMoveIntoLinePlots",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),wi=Object(k.a)(Ot.prototype,"updateStreamingDataStatus",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isStreamingData=e}}}),Ti=Object(k.a)(Ot.prototype,"setSettingsTabId",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(k.a)(Ot.prototype,"isAutoScaledX",[F.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isAutoScaledX"),Ot.prototype),Object(k.a)(Ot.prototype,"isAutoScaledY",[F.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isAutoScaledY"),Ot.prototype),Object(k.a)(Ot.prototype,"isSelectingMomentChannelRange",[F.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isSelectingMomentChannelRange"),Ot.prototype),Object(k.a)(Ot.prototype,"isSelectingMomentMaskRange",[F.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isSelectingMomentMaskRange"),Ot.prototype),Object(k.a)(Ot.prototype,"selectedRange",[F.i],Object.getOwnPropertyDescriptor(Ot.prototype,"selectedRange"),Ot.prototype),Object(k.a)(Ot.prototype,"transformedSpectralLines",[F.i],Object.getOwnPropertyDescriptor(Ot.prototype,"transformedSpectralLines"),Ot.prototype),vi=Object(k.a)(Ot.prototype,"setPrimaryLineColor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),Ai=Object(k.a)(Ot.prototype,"setLineWidth",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),xi=Object(k.a)(Ot.prototype,"setLinePlotPointSize",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(k.a)(Ot.prototype,"initXYBoundaries",[F.g],Object.getOwnPropertyDescriptor(Ot.prototype,"initXYBoundaries"),Ot.prototype),Ot);class Mi extends ct.c{constructor(){super(ct.d.CLOSED)}static DiffRequirementsArray(e,t){const i=[];return e.forEach((e,n)=>{const r=t.get(n);if(r){for(const t of e)-1===r.indexOf(t)&&i.push(ve.a.SetStatsRequirements.create({fileId:n,regionId:t,stats:[]}));for(const t of r)-1===e.indexOf(t)&&i.push(ve.a.SetStatsRequirements.create({fileId:n,regionId:t,stats:Te.e.DEFAULT_STATS_TYPES}))}else for(const t of e)i.push(ve.a.SetStatsRequirements.create({fileId:n,regionId:t,stats:[]}))}),t.forEach((t,n)=>{if(!e.get(n))for(const e of t)i.push(ve.a.SetStatsRequirements.create({fileId:n,regionId:e,stats:Te.e.DEFAULT_STATS_TYPES}))}),i}}var Di,Ni,Li,_i,zi,Wi,Gi,Vi,Bi,qi,Hi,Ui,Yi,Xi,Ki,Qi,Zi,$i,Ji,en,tn,nn,rn,on,an,sn;let ln=(Di=class extends ct.c{get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}static DiffRequirementsArray(e,t){const i=[];return e.forEach((e,n)=>{const r=t.get(n);if(r){for(const t of e)-1===r.indexOf(t)&&i.push({fileId:n,regionId:t,histograms:[]});for(const t of r)-1===e.indexOf(t)&&i.push({fileId:n,regionId:t,histograms:[{channel:-1,numBins:-1}]})}else for(const t of e)i.push({fileId:n,regionId:t,histograms:[]})}),t.forEach((t,n)=>{if(!e.get(n))for(const e of t)i.push({fileId:n,regionId:e,histograms:[{channel:-1,numBins:-1}]})}),i}constructor(){super(ct.d.CLOSED),Object(j.a)(this,"minX",Ni,this),Object(j.a)(this,"maxX",Li,this),Object(j.a)(this,"minY",_i,this),Object(j.a)(this,"maxY",zi,this),Object(j.a)(this,"cursorX",Wi,this),Object(j.a)(this,"logScaleY",Gi,this),Object(j.a)(this,"plotType",Vi,this),Object(j.a)(this,"primaryLineColor",Bi,this),Object(j.a)(this,"lineWidth",qi,this),Object(j.a)(this,"linePlotPointSize",Hi,this),Object(j.a)(this,"meanRmsVisible",Ui,this),Object(j.a)(this,"linePlotInitXYBoundaries",Yi,this),Object(j.a)(this,"setXBounds",Xi,this),Object(j.a)(this,"clearXBounds",Ki,this),Object(j.a)(this,"setYBounds",Qi,this),Object(j.a)(this,"clearYBounds",Zi,this),Object(j.a)(this,"setXYBounds",$i,this),Object(j.a)(this,"clearXYBounds",Ji,this),Object(j.a)(this,"setLogScale",en,this),Object(j.a)(this,"setPlotType",tn,this),Object(j.a)(this,"setCursor",nn,this),Object(j.a)(this,"setPrimaryLineColor",rn,this),Object(j.a)(this,"setLineWidth",on,this),Object(j.a)(this,"setLinePlotPointSize",an,this),Object(j.a)(this,"setMeanRmsVisible",sn,this),this.init=e=>{if(!e)return;const t=N()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=L.i.MIN_WIDTH&&e.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=L.i.MIN_POINT_SIZE&&e.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.logScaleY&&(this.logScaleY=e.logScaleY),"string"!==typeof e.plotType||e.plotType!==L.j.STEPS&&e.plotType!==L.j.LINES&&e.plotType!==L.j.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,logScaleY:this.logScaleY,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(F.p)(this),this.logScaleY=!0,this.plotType=L.j.STEPS,this.primaryLineColor={colorHex:M.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0}}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ni=Object(k.a)(Di.prototype,"minX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=Object(k.a)(Di.prototype,"maxX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i=Object(k.a)(Di.prototype,"minY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zi=Object(k.a)(Di.prototype,"maxY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wi=Object(k.a)(Di.prototype,"cursorX",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gi=Object(k.a)(Di.prototype,"logScaleY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vi=Object(k.a)(Di.prototype,"plotType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=Object(k.a)(Di.prototype,"primaryLineColor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qi=Object(k.a)(Di.prototype,"lineWidth",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi=Object(k.a)(Di.prototype,"linePlotPointSize",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui=Object(k.a)(Di.prototype,"meanRmsVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yi=Object(k.a)(Di.prototype,"linePlotInitXYBoundaries",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=Object(k.a)(Di.prototype,"setXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),Ki=Object(k.a)(Di.prototype,"clearXBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Qi=Object(k.a)(Di.prototype,"setYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),Zi=Object(k.a)(Di.prototype,"clearYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),$i=Object(k.a)(Di.prototype,"setXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),Ji=Object(k.a)(Di.prototype,"clearXYBounds",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),en=Object(k.a)(Di.prototype,"setLogScale",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logScaleY=e}}}),tn=Object(k.a)(Di.prototype,"setPlotType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),nn=Object(k.a)(Di.prototype,"setCursor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Object(k.a)(Di.prototype,"isAutoScaledX",[F.i],Object.getOwnPropertyDescriptor(Di.prototype,"isAutoScaledX"),Di.prototype),Object(k.a)(Di.prototype,"isAutoScaledY",[F.i],Object.getOwnPropertyDescriptor(Di.prototype,"isAutoScaledY"),Di.prototype),rn=Object(k.a)(Di.prototype,"setPrimaryLineColor",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),on=Object(k.a)(Di.prototype,"setLineWidth",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),an=Object(k.a)(Di.prototype,"setLinePlotPointSize",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),sn=Object(k.a)(Di.prototype,"setMeanRmsVisible",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),Object(k.a)(Di.prototype,"initXYBoundaries",[F.g],Object.getOwnPropertyDescriptor(Di.prototype,"initXYBoundaries"),Di.prototype),Di);class cn{}var un,pn,dn,hn,gn,mn,fn,yn,bn,On,Sn,Cn,En,In,wn,Tn,vn,An,xn=i(160),Rn=i(161);let Pn,jn,kn;!function(e){e.ImageOverlay="Image Overlay",e.Histogram="Histogram",e.D2Scatter="2D Scatter"}(Pn||(Pn={})),function(e){e.Circle="circle-open",e.FullCircle="circle",e.Star="star-open",e.FullStar="star",e.Square="square-open",e.Plus="cross-thin-open",e.Cross="x-thin-open",e.TriangleUp="triangle-up-open",e.TriangleDown="triangle-down-open",e.Diamond="diamond-open",e.hexagon2="hexagon2-open",e.hexagon="hexagon-open"}(jn||(jn={})),function(e){e[e.GLOBAL=0]="GLOBAL",e[e.IMAGE_OVERLAY=1]="IMAGE_OVERLAY",e[e.COLOR=2]="COLOR"}(kn||(kn={}));const Fn={headerTableColumnWidts:[150,75,65,100,230],showSelectedData:!1,catalogTableAutoScroll:!1,catalogPlotType:Pn.ImageOverlay,catalogColor:M.a.TURQUOISE3,catalogSize:10,catalogShape:jn.Circle,xAxis:Rn.a.NONE,yAxis:Rn.a.NONE,highlightColor:M.a.RED2,settingsTabId:kn.GLOBAL};let Mn=(An=vn=class e{constructor(t){Object(j.a)(this,"catalogFileId",pn,this),Object(j.a)(this,"headerTableColumnWidts",dn,this),Object(j.a)(this,"dataTableColumnWidts",hn,this),Object(j.a)(this,"showSelectedData",gn,this),Object(j.a)(this,"catalogTableAutoScroll",mn,this),Object(j.a)(this,"catalogPlotType",fn,this),Object(j.a)(this,"catalogSize",yn,this),Object(j.a)(this,"catalogColor",bn,this),Object(j.a)(this,"catalogShape",On,this),Object(j.a)(this,"xAxis",Sn,this),Object(j.a)(this,"yAxis",Cn,this),Object(j.a)(this,"tableSeparatorPosition",En,this),Object(j.a)(this,"highlightColor",In,this),Object(j.a)(this,"settingsTabId",wn,this),Object(j.a)(this,"setSettingsTabId",Tn,this),this.init=t=>{if(!t)return;const i=t.catalogFileId;"number"===typeof i&&i>0&&(this.catalogFileId=i);const n=t.catalogSize;"number"===typeof n&&n>=e.MinOverlaySize&&n<=e.MaxOverlaySize&&(this.catalogSize=n),this.catalogShape=t.catalogShape,this.catalogColor=t.catalogColor,this.highlightColor=t.highlightColor,this.tableSeparatorPosition=t.tableSeparatorPosition},this.toConfig=()=>({catalogFileId:this.catalogFileId,catalogColor:this.catalogColor,highlightColor:this.highlightColor,catalogSize:this.catalogSize,catalogShape:this.catalogShape,tableSeparatorPosition:this.tableSeparatorPosition}),Object(F.p)(this),this.catalogFileId=t,this.headerTableColumnWidts=Fn.headerTableColumnWidts,this.showSelectedData=Fn.showSelectedData,this.catalogTableAutoScroll=Fn.catalogTableAutoScroll,this.catalogPlotType=Fn.catalogPlotType,this.catalogColor=Fn.catalogColor,this.catalogSize=Fn.catalogSize,this.catalogShape=Fn.catalogShape,this.xAxis=Fn.xAxis,this.yAxis=Fn.yAxis,this.tableSeparatorPosition=Te.H.Instance.catalogTableSeparatorPosition,this.highlightColor=Fn.highlightColor,this.settingsTabId=Fn.settingsTabId}setHeaderTableColumnWidts(e){this.headerTableColumnWidts=e}setDataTableColumnWidts(e){this.dataTableColumnWidts=e}setShowSelectedData(e){this.showSelectedData=e}setCatalogTableAutoScroll(e){this.catalogTableAutoScroll=e}setCatalogPlotType(e){this.catalogPlotType=e}setCatalogSize(e){this.catalogSize=e}setCatalogColor(e){this.catalogColor=e}setCatalogShape(e){this.catalogShape=e}setxAxis(e){this.xAxis=e}setyAxis(e){this.yAxis=e}setTableSeparatorPosition(e){this.tableSeparatorPosition=e}setHighlightColor(e){this.highlightColor=e}},vn.MinOverlaySize=1,vn.MaxOverlaySize=100,vn.MinTableSeparatorPosition=5,vn.MaxTableSeparatorPosition=95,un=An,pn=Object(k.a)(un.prototype,"catalogFileId",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=Object(k.a)(un.prototype,"headerTableColumnWidts",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=Object(k.a)(un.prototype,"dataTableColumnWidts",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=Object(k.a)(un.prototype,"showSelectedData",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=Object(k.a)(un.prototype,"catalogTableAutoScroll",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=Object(k.a)(un.prototype,"catalogPlotType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(k.a)(un.prototype,"catalogSize",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=Object(k.a)(un.prototype,"catalogColor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),On=Object(k.a)(un.prototype,"catalogShape",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=Object(k.a)(un.prototype,"xAxis",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=Object(k.a)(un.prototype,"yAxis",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),En=Object(k.a)(un.prototype,"tableSeparatorPosition",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Object(k.a)(un.prototype,"highlightColor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wn=Object(k.a)(un.prototype,"settingsTabId",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(k.a)(un.prototype,"setHeaderTableColumnWidts",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setHeaderTableColumnWidts"),un.prototype),Object(k.a)(un.prototype,"setDataTableColumnWidts",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setDataTableColumnWidts"),un.prototype),Object(k.a)(un.prototype,"setShowSelectedData",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setShowSelectedData"),un.prototype),Object(k.a)(un.prototype,"setCatalogTableAutoScroll",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setCatalogTableAutoScroll"),un.prototype),Object(k.a)(un.prototype,"setCatalogPlotType",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setCatalogPlotType"),un.prototype),Object(k.a)(un.prototype,"setCatalogSize",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setCatalogSize"),un.prototype),Object(k.a)(un.prototype,"setCatalogColor",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setCatalogColor"),un.prototype),Object(k.a)(un.prototype,"setCatalogShape",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setCatalogShape"),un.prototype),Object(k.a)(un.prototype,"setxAxis",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setxAxis"),un.prototype),Object(k.a)(un.prototype,"setyAxis",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setyAxis"),un.prototype),Object(k.a)(un.prototype,"setTableSeparatorPosition",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setTableSeparatorPosition"),un.prototype),Object(k.a)(un.prototype,"setHighlightColor",[F.g],Object.getOwnPropertyDescriptor(un.prototype,"setHighlightColor"),un.prototype),Tn=Object(k.a)(un.prototype,"setSettingsTabId",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),un);var Dn,Nn,Ln,_n,zn,Wn,Gn,Vn,Bn,qn;let Hn=(Dn=class{constructor(e){Object(j.a)(this,"indicatorInfo",Nn,this),Object(j.a)(this,"scatterborder",Ln,this),Object(j.a)(this,"dragmode",_n,this),Object(j.a)(this,"plotType",zn,this),Object(j.a)(this,"histogramBorder",Wn,this),Object(j.a)(this,"logScaleY",Gn,this),Object(j.a)(this,"nBinx",Vn,this),Object(j.a)(this,"xColumnName",Bn,this),Object(j.a)(this,"yColumnName",qn,this),Object(F.p)(this),this.indicatorInfo=void 0,this.dragmode="select",this.plotType=e.plotType,this.logScaleY=!0,this.scatterborder=void 0,this.histogramBorder=void 0,this.nBinx=void 0,this.xColumnName=e.xColumnName,this.yColumnName=e.yColumnName}setColumnX(e){this.xColumnName=e}setColumnY(e){this.yColumnName=e}setIndicator(e){this.indicatorInfo=e}setScatterborder(e){this.scatterborder=e}setHistogramXBorder(e){this.histogramBorder=e}setDragmode(e){this.dragmode=e}setLogScaleY(e){this.logScaleY=e}setNumBinsX(e){this.nBinx=e}get isScatterAutoScaled(){return void 0===this.scatterborder}get isHistogramAutoScaledX(){return void 0===this.histogramBorder}},Nn=Object(k.a)(Dn.prototype,"indicatorInfo",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Object(k.a)(Dn.prototype,"scatterborder",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Object(k.a)(Dn.prototype,"dragmode",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Object(k.a)(Dn.prototype,"plotType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wn=Object(k.a)(Dn.prototype,"histogramBorder",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=Object(k.a)(Dn.prototype,"logScaleY",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vn=Object(k.a)(Dn.prototype,"nBinx",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bn=Object(k.a)(Dn.prototype,"xColumnName",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qn=Object(k.a)(Dn.prototype,"yColumnName",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(k.a)(Dn.prototype,"setColumnX",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setColumnX"),Dn.prototype),Object(k.a)(Dn.prototype,"setColumnY",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setColumnY"),Dn.prototype),Object(k.a)(Dn.prototype,"setIndicator",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setIndicator"),Dn.prototype),Object(k.a)(Dn.prototype,"setScatterborder",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setScatterborder"),Dn.prototype),Object(k.a)(Dn.prototype,"setHistogramXBorder",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setHistogramXBorder"),Dn.prototype),Object(k.a)(Dn.prototype,"setDragmode",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setDragmode"),Dn.prototype),Object(k.a)(Dn.prototype,"setLogScaleY",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setLogScaleY"),Dn.prototype),Object(k.a)(Dn.prototype,"setNumBinsX",[F.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setNumBinsX"),Dn.prototype),Object(k.a)(Dn.prototype,"isScatterAutoScaled",[F.i],Object.getOwnPropertyDescriptor(Dn.prototype,"isScatterAutoScaled"),Dn.prototype),Object(k.a)(Dn.prototype,"isHistogramAutoScaledX",[F.i],Object.getOwnPropertyDescriptor(Dn.prototype,"isHistogramAutoScaledX"),Dn.prototype),Dn)},127:function(e,t,i){"use strict";i.d(t,"a",(function(){return W}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S,C,E,I,w,T,v,A,x,R,P,j,k,F,M=i(3),D=i(2),N=(i(29),i(1)),L=i(76),_=i(7),z=i(62);let W=(n=class{constructor(){Object(M.a)(this,"type",r,this),Object(M.a)(this,"lineColor",o,this),Object(M.a)(this,"selectedLine",a,this),Object(M.a)(this,"lineType",s,this),Object(M.a)(this,"lineWidth",l,this),Object(M.a)(this,"pointRadius",c,this),Object(M.a)(this,"isOverlayOn",u,this),Object(M.a)(this,"boxcarSize",p,this),Object(M.a)(this,"gaussianSigma",d,this),Object(M.a)(this,"hanningSize",h,this),Object(M.a)(this,"decimationWidth",g,this),Object(M.a)(this,"binWidth",m,this),Object(M.a)(this,"savitzkyGolaySize",f,this),Object(M.a)(this,"savitzkyGolayOrder",y,this),Object(M.a)(this,"colorMap",b,this),Object(M.a)(this,"setType",O,this),Object(M.a)(this,"setLineColor",S,this),Object(M.a)(this,"setSelectedLine",C,this),Object(M.a)(this,"setLineType",E,this),Object(M.a)(this,"setLineWidth",I,this),Object(M.a)(this,"setPointRadius",w,this),Object(M.a)(this,"setIsOverlayOn",T,this),Object(M.a)(this,"setBoxcarSize",v,this),Object(M.a)(this,"setGaussianSigma",A,this),Object(M.a)(this,"setHanningSize",x,this),Object(M.a)(this,"setDecimationWidth",R,this),Object(M.a)(this,"setBinWidth",P,this),Object(M.a)(this,"setSavitzkyGolaySize",j,this),Object(M.a)(this,"setSavitzkyGolayOrder",k,this),Object(M.a)(this,"setColorMap",F,this),Object(N.p)(this),this.type=_.t.NONE,this.lineColor={colorHex:L.a.ROSE3,fixed:!1},this.lineType=_.j.STEPS,this.lineWidth=1,this.pointRadius=1,this.isOverlayOn=!1,this.boxcarSize=2,this.gaussianSigma=1,this.hanningSize=3,this.decimationWidth=3,this.binWidth=2,this.savitzkyGolaySize=5,this.savitzkyGolayOrder=0,this.colorMap=new Map}get exportData(){let e=new Map;return e.set("smooth",this.type),this.type===_.t.BOXCAR?e.set("kernel",String(this.boxcarSize)):this.type===_.t.GAUSSIAN?e.set("sigma",String(this.gaussianSigma)):this.type===_.t.HANNING?e.set("kernel",String(this.hanningSize)):this.type===_.t.DECIMATION?e.set("decimation width",String(this.decimationWidth)):this.type===_.t.BINNING?e.set("bin width",String(this.binWidth)):this.type===_.t.SAVITZKY_GOLAY&&(e.set("kernel",String(this.savitzkyGolaySize)),e.set("order",String(this.savitzkyGolayOrder))),e}get comments(){let e=[];return this.exportData&&this.exportData.forEach((t,i)=>{e.push(`${i}: ${t}`)}),e}get gaussianKernel(){if(this.gaussianSigma<3)return 3;const e=Math.ceil(this.gaussianSigma);return e%2===0?e+1:e}get gaussianAlpha(){return(this.gaussianKernel-1)/(2*this.gaussianSigma)}getLocalStartEndIndexes(e,t,i,n){let r,o;n%2===1?(r=(n-1)/2,o=(n-1)/2):(r=n/2-1,o=n/2);const a=t<r?t:r;return{startSmoothing:t<r?0:t-r,endSmoothing:i+o>e-1?e-1:i+o,smoothedStart:a,smoothedEnd:a+i-t}}getLocalGroupStartEndIndexes(e,t,i,n){let r=i%n===n-1?i:i-i%n+(n-1);return r>e-1&&(r=e-1),{firstIndex:t%n===0?t:t-t%n,lastIndex:r}}getSmoothingValues(e,t,i,n){let r,o=e;if(this.type===_.t.BOXCAR)if((i||0===n)&&n){const a=this.getLocalStartEndIndexes(e.length,i,n,this.boxcarSize),s=t.subarray(a.startSmoothing,a.endSmoothing+1);r=z.boxcarSmooth(s,this.boxcarSize).subarray(a.smoothedStart,a.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.boxcarSmooth(t,this.boxcarSize);else if(this.type===_.t.GAUSSIAN){if(this.gaussianSigma&&this.gaussianSigma>=1)if((i||0===n)&&n){const a=this.getLocalStartEndIndexes(e.length,i,n,this.gaussianKernel),s=t.subarray(a.startSmoothing,a.endSmoothing+1);r=z.gaussianSmooth(s,this.gaussianKernel,this.gaussianAlpha).subarray(a.smoothedStart,a.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.gaussianSmooth(t,this.gaussianKernel,this.gaussianAlpha)}else if(this.type===_.t.HANNING)if((i||0===n)&&n){const a=this.getLocalStartEndIndexes(e.length,i,n,this.hanningSize),s=t.subarray(a.startSmoothing,a.endSmoothing+1);r=z.hanningSmooth(s,this.hanningSize).subarray(a.smoothedStart,a.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.hanningSmooth(t,this.hanningSize);else if(this.type===_.t.DECIMATION)if((i||0===n)&&n){const a=this.getLocalGroupStartEndIndexes(e.length,i,n,this.decimationWidth),s=t.subarray(a.firstIndex,a.lastIndex+1),l=e.slice(a.firstIndex,a.lastIndex+1);let c=z.decimation(l,s,this.decimationWidth);o=c.x,r=c.y}else{let i=z.decimation(e,t,this.decimationWidth);o=i.x,r=i.y}else if(this.type===_.t.BINNING)if((i||0===n)&&n){const a=this.getLocalGroupStartEndIndexes(e.length,i,n,this.binWidth),s=t.subarray(a.firstIndex,a.lastIndex+1),l=e.slice(a.firstIndex,a.lastIndex+1);o=z.binning(l,this.binWidth),r=z.binning(s,this.binWidth)}else o=z.binning(e,this.binWidth),r=z.binning(t,this.binWidth);else if(this.type===_.t.SAVITZKY_GOLAY)if((i||0===n)&&n){const a=this.getLocalStartEndIndexes(e.length,i,n,this.savitzkyGolaySize),s=t.subarray(a.startSmoothing,a.endSmoothing+1);r=z.savitzkyGolaySmooth(e,s,this.savitzkyGolaySize,this.savitzkyGolayOrder).subarray(a.smoothedStart,a.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.savitzkyGolaySmooth(e,t,this.savitzkyGolaySize,this.savitzkyGolayOrder);return{x:o,y:r}}getSmoothingPoint2DArray(e,t,i,n){if(this.type===_.t.NONE)return[];const r=this.getSmoothingValues(e,t,i,n);let o=new Array(r.x.length);for(let a=0;a<r.x.length;a++)o[a]={x:r.x[a],y:r.y[a]};return o}getDecimatedPoint2DArray(e,t,i,n,r){if(!e||!t||e.length!==t.length)return[];let o;if((n||0===r)&&r){const a=this.getLocalGroupStartEndIndexes(e.length,n,r,i),s=t.subarray(a.firstIndex,a.lastIndex+1),l=e.slice(a.firstIndex,a.lastIndex+1);o=z.decimation(l,s,i)}else o=z.decimation(e,t,i);let a=new Array(o.x.length);for(let s=0;s<o.x.length;s++)a[s]={x:o.x[s],y:o.y[s]};return a}},r=Object(D.a)(n.prototype,"type",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(D.a)(n.prototype,"lineColor",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(D.a)(n.prototype,"selectedLine",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(D.a)(n.prototype,"lineType",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(D.a)(n.prototype,"lineWidth",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(D.a)(n.prototype,"pointRadius",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(D.a)(n.prototype,"isOverlayOn",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(D.a)(n.prototype,"boxcarSize",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(D.a)(n.prototype,"gaussianSigma",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(D.a)(n.prototype,"hanningSize",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(D.a)(n.prototype,"decimationWidth",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(D.a)(n.prototype,"binWidth",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(D.a)(n.prototype,"savitzkyGolaySize",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(D.a)(n.prototype,"savitzkyGolayOrder",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(D.a)(n.prototype,"colorMap",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(D.a)(n.prototype,"setType",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.type=e}}}),S=Object(D.a)(n.prototype,"setLineColor",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.lineColor={colorHex:e,fixed:t}}}}),C=Object(D.a)(n.prototype,"setSelectedLine",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedLine=e}}}),E=Object(D.a)(n.prototype,"setLineType",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineType=e}}}),I=Object(D.a)(n.prototype,"setLineWidth",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=_.i.MIN_WIDTH&&e<=_.i.MAX_WIDTH&&(this.lineWidth=e)}}}),w=Object(D.a)(n.prototype,"setPointRadius",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=_.i.MIN_POINT_SIZE&&e<=_.i.MAX_POINT_SIZE&&(this.pointRadius=e)}}}),T=Object(D.a)(n.prototype,"setIsOverlayOn",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isOverlayOn=e}}}),v=Object(D.a)(n.prototype,"setBoxcarSize",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.boxcarSize=e}}}),A=Object(D.a)(n.prototype,"setGaussianSigma",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.gaussianSigma=e}}}),x=Object(D.a)(n.prototype,"setHanningSize",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hanningSize=e}}}),R=Object(D.a)(n.prototype,"setDecimationWidth",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.decimationWidth=e}}}),P=Object(D.a)(n.prototype,"setBinWidth",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.binWidth=e}}}),j=Object(D.a)(n.prototype,"setSavitzkyGolaySize",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.savitzkyGolaySize=e}}}),k=Object(D.a)(n.prototype,"setSavitzkyGolayOrder",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.savitzkyGolayOrder=e}}}),F=Object(D.a)(n.prototype,"setColorMap",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.colorMap.set(e,t)}}}),Object(D.a)(n.prototype,"exportData",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"exportData"),n.prototype),Object(D.a)(n.prototype,"comments",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"comments"),n.prototype),Object(D.a)(n.prototype,"gaussianKernel",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"gaussianKernel"),n.prototype),Object(D.a)(n.prototype,"gaussianAlpha",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"gaussianAlpha"),n.prototype),n)},128:function(e,t,i){(function(t,n){var r="undefined"!==typeof r?r:{};r.locateFile=function(e,t){return"./"+e};var o,a={};for(o in r)r.hasOwnProperty(o)&&(a[o]=r[o]);var s=[],l=!1,c=!1,u=!1,p=!1;l="object"===typeof window,c="function"===typeof importScripts,u="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,p=!l&&!u&&!c;var d,h,g,m,f="";function y(e){return r.locateFile?r.locateFile(e,f):f+e}u?(f=c?i(119).dirname(f)+"/":n+"/",d=function(e,t){return g||(g=i(210)),m||(m=i(119)),e=m.normalize(e),g.readFileSync(e,t?null:"utf8")},h=function(e){var t=d(e,!0);return t.buffer||(t=new Uint8Array(t)),w(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),s=t.argv.slice(2),e.exports=r,t.on("uncaughtException",(function(e){if(!(e instanceof ve))throw e})),t.on("unhandledRejection",ae),function(e){t.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(d=function(e){return read(e)}),h=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(w("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?s=scriptArgs:"undefined"!=typeof arguments&&(s=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(l||c)&&(c?f=self.location.href:document.currentScript&&(f=document.currentScript.src),f=0!==f.indexOf("blob:")?f.substr(0,f.lastIndexOf("/")+1):"",d=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var b,O,S=r.print||console.log.bind(console),C=r.printErr||console.warn.bind(console);for(o in a)a.hasOwnProperty(o)&&(r[o]=a[o]);a=null,r.arguments&&(s=r.arguments),r.thisProgram&&r.thisProgram,r.quit&&r.quit,r.wasmBinary&&(b=r.wasmBinary),r.noExitRuntime&&r.noExitRuntime,"object"!==typeof WebAssembly&&C("no native wasm support detected");var E=new WebAssembly.Table({initial:1,maximum:1,element:"anyfunc"}),I=!1;function w(e,t){e||ae("Assertion failed: "+t)}function T(e){var t=r["_"+e];return w(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function v(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);k(e,t=Te(i),i)}return t},array:function(e){var t=Te(e.length);return F(e,t),t}};var a=T(e),s=[],l=0;if(n)for(var c=0;c<n.length;c++){var u=o[i[c]];u?(0===l&&(l=Ie()),s[c]=u(n[c])):s[c]=n[c]}var p=a.apply(null,s);return p=function(e){return"string"===t?P(e):"boolean"===t?Boolean(e):e}(p),0!==l&&we(l),p}function A(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?T(e):function(){return v(e,t,i,arguments)}}var x="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function R(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&x)return x.decode(e.subarray(t,r));for(var o="";t<r;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}function P(e,t){return e?R(N,e,t):""}function j(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a);if(s<=127){if(i>=o)break;t[i++]=s}else if(s<=2047){if(i+1>=o)break;t[i++]=192|s>>6,t[i++]=128|63&s}else if(s<=65535){if(i+2>=o)break;t[i++]=224|s>>12,t[i++]=128|s>>6&63,t[i++]=128|63&s}else{if(i+3>=o)break;t[i++]=240|s>>18,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}}return t[i]=0,i-r}function k(e,t,i){return j(e,N,t,i)}function F(e,t){D.set(e,t)}var M,D,N,L,_=65536;function z(e,t){return e%t>0&&(e+=t-e%t),e}function W(e){M=e,r.HEAP8=D=new Int8Array(e),r.HEAP16=new Int16Array(e),r.HEAP32=L=new Int32Array(e),r.HEAPU8=N=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=new Float32Array(e),r.HEAPF64=new Float64Array(e)}var G=5247520,V=4480,B=r.INITIAL_MEMORY||16777216;function q(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?r.dynCall_v(i):r.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t(r)}}(O=r.wasmMemory?r.wasmMemory:new WebAssembly.Memory({initial:B/_,maximum:2147483648/_}))&&(M=O.buffer),B=M.byteLength,W(M),L[V>>2]=G;var H=[],U=[],Y=[],X=[];function K(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)J(r.preRun.shift());q(H)}function Q(){!0,q(U)}function Z(){q(Y)}function $(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)ee(r.postRun.shift());q(X)}function J(e){H.unshift(e)}function ee(e){X.unshift(e)}var te=0,ie=null,ne=null;function re(e){te++,r.monitorRunDependencies&&r.monitorRunDependencies(te)}function oe(e){if(te--,r.monitorRunDependencies&&r.monitorRunDependencies(te),0==te&&(null!==ie&&(clearInterval(ie),ie=null),ne)){var t=ne;ne=null,t()}}function ae(e){throw r.onAbort&&r.onAbort(e),S(e+=""),C(e),I=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function se(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}r.preloadedImages={},r.preloadedAudios={};var le="data:application/octet-stream;base64,";function ce(e){return se(e,le)}var ue="file://";function pe(e){return se(e,ue)}var de="carta_computation.wasm";function he(){try{if(b)return new Uint8Array(b);if(h)return h(de);throw"both async and sync fetching of the wasm failed"}catch(C){ae(C)}}function ge(){return b||!l&&!c||"function"!==typeof fetch||pe(de)?new Promise((function(e,t){e(he())})):fetch(de,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+de+"'";return e.arrayBuffer()})).catch((function(){return he()}))}function me(){var e={a:Ce};function t(e,t){var i=e.exports;r.asm=i,oe()}function i(e){t(e.instance)}function n(t){return ge().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){C("failed to asynchronously prepare wasm: "+e),ae(e)}))}if(re(),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(o){return C("Module.instantiateWasm callback failed with error: "+o),!1}return function(){if(b||"function"!==typeof WebAssembly.instantiateStreaming||ce(de)||pe(de)||"function"!==typeof fetch)return n(i);fetch(de,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return C("wasm streaming compile failed: "+e),C("falling back to ArrayBuffer instantiation"),n(i)}))}))}(),{}}function fe(e,t,i){N.copyWithin(e,t,t+i)}function ye(){return N.length}function be(e){try{return O.grow(e-M.byteLength+65535>>>16),W(O.buffer),1}catch(t){}}function Oe(e){e>>>=0;var t=ye();if(e>2147483648)return!1;for(var i=1;i<=4;i*=2){var n=t*(1+.2/i);if(n=Math.min(n,e+100663296),be(Math.min(2147483648,z(Math.max(16777216,e,n),65536))))return!0}return!1}ce(de)||(de=y(de)),U.push({func:function(){Ee()}});var Se,Ce={a:fe,b:Oe,memory:O,table:E},Ee=(me(),r.___wasm_call_ctors=function(){return(Ee=r.___wasm_call_ctors=r.asm.c).apply(null,arguments)}),Ie=(r._decodeArray=function(){return(r._decodeArray=r.asm.d).apply(null,arguments)},r._generateVertexData=function(){return(r._generateVertexData=r.asm.e).apply(null,arguments)},r._malloc=function(){return(r._malloc=r.asm.f).apply(null,arguments)},r._free=function(){return(r._free=r.asm.g).apply(null,arguments)},r._ZSTD_decompress=function(){return(r._ZSTD_decompress=r.asm.h).apply(null,arguments)},r.stackSave=function(){return(Ie=r.stackSave=r.asm.i).apply(null,arguments)}),we=r.stackRestore=function(){return(we=r.stackRestore=r.asm.j).apply(null,arguments)},Te=r.stackAlloc=function(){return(Te=r.stackAlloc=r.asm.k).apply(null,arguments)};function ve(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Ae(e){function t(){Se||(Se=!0,r.calledRun=!0,I||(Q(),Z(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),$()))}e=e||s,te>0||(K(),te>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}if(r.ccall=v,r.cwrap=A,ne=function e(){Se||Ae(),Se||(ne=e)},r.run=Ae,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();Ae();var xe=r.cwrap("ZSTD_decompress","number",["number","number","number","number"]),Re=r.cwrap("decodeArray","number",["number","number","number"]),Pe=r.cwrap("generateVertexData","number",["number","number","number","number","number","number"]),je=8;function ke(e,t){var i=e.byteLength;i>r.srcAllocated&&(r._free(r.srcPtr),r.srcPtr=r._malloc(i),r.srcAllocated=i),t>r.destAllocated&&(r._free(r.destPtr),r.destPtr=r._malloc(t),r.destAllocated=t),new Uint8Array(r.HEAPU8.buffer,r.srcPtr,i).set(e)}r.srcAllocated=0,r.srcPtr=0,r.destAllocated=0,r.destPtr=0,ee((function(){console.log("Zstd WebAssembly module loaded")})),r.ZstdReady=!1,r.onReady=new Promise((function(e){if(r.calledRun)e(r);else{var t=r.onRuntimeInitialized;r.onRuntimeInitialized=function(){t&&t(),e(r)}}r.ZstdReady=!0})),r.Decompress=function(e,t){var i=e.byteLength;ke(e,t);var n=new Uint8Array(r.HEAPU8.buffer,r.destPtr,t);xe(r.destPtr,t,r.srcPtr,i);return n.slice()},r.Decode=function(e,t,i){var n=e.byteLength;ke(e,t);xe(r.destPtr,t,r.srcPtr,n);var o=new Float32Array(r.HEAPU8.buffer,r.destPtr,t/4);return Re(r.destPtr,t,i),o.slice()},r.GenerateVertexData=function(e,t){var i=t.length,n=e.length/2,o=(n+i-1)*je*4;ke(new Uint8Array(e.buffer),o);var a=t.byteLength,s=r._malloc(a);new Int32Array(r.HEAPU8.buffer,s,t.length).set(t);var l=new Float32Array(r.HEAPU8.buffer,r.destPtr,o/4);return Pe(r.destPtr,o/4,r.srcPtr,n,s,i),r._free(s),l},e.exports=r}).call(this,i(44),"/")},13:function(e,t,i){"use strict";i.d(t,"a",(function(){return C})),i.d(t,"f",(function(){return w})),i.d(t,"g",(function(){return G})),i.d(t,"J",(function(){return tt})),i.d(t,"l",(function(){return it})),i.d(t,"k",(function(){return nt})),i.d(t,"m",(function(){return z})),i.d(t,"o",(function(){return st})),i.d(t,"n",(function(){return Ct})),i.d(t,"u",(function(){return xt})),i.d(t,"H",(function(){return wt})),i.d(t,"p",(function(){return Pt})),i.d(t,"s",(function(){return Vt})),i.d(t,"q",(function(){return Zt})),i.d(t,"v",(function(){return li})),i.d(t,"y",(function(){return Ci})),i.d(t,"z",(function(){return Ri})),i.d(t,"D",(function(){return Li})),i.d(t,"i",(function(){return Hi})),i.d(t,"E",(function(){return tn})),i.d(t,"b",(function(){return bn})),i.d(t,"G",(function(){return Cn})),i.d(t,"F",(function(){return En})),i.d(t,"B",(function(){return Rn})),i.d(t,"A",(function(){return Pn})),i.d(t,"x",(function(){return Fn})),i.d(t,"w",(function(){return Mn})),i.d(t,"t",(function(){return Ln})),i.d(t,"j",(function(){return Wn})),i.d(t,"C",(function(){return Bn})),i.d(t,"e",(function(){return Hn.b})),i.d(t,"I",(function(){return Un})),i.d(t,"r",(function(){return Xn})),i.d(t,"h",(function(){return Wo})),i.d(t,"d",(function(){return $o})),i.d(t,"c",(function(){return la}));var n,r,o,a,s,l,c,u,p=i(3),d=i(2),h=(i(29),i(0)),g=i(14),m=i(1),f=i(47),y=i(45),b=i(42),O=i(4),S=i(7);i(924);!function(e){e.FrameRate="Frame Rate",e.Step="Step"}(u||(u={}));let C=Object(g.a)((r=class extends h.Component{static get WIDGET_CONFIG(){return{id:"animator",type:"animator",minWidth:250,minHeight:200,defaultWidth:650,defaultHeight:200,title:"Animator",isCloseable:!0,helpType:O.x.ANIMATOR}}constructor(e){super(e),Object(p.a)(this,"width",o,this),Object(p.a)(this,"height",a,this),Object(p.a)(this,"numericInputType",s,this),Object(p.a)(this,"onResize",l,this),Object(p.a)(this,"onNumericInputTypeChange",c,this),this.onChannelChanged=e=>{const t=O.e.Instance.activeFrame;t&&(e<0&&(e+=t.frameInfo.fileInfoExtended.depth),e>=t.frameInfo.fileInfoExtended.depth&&(e=0),t.setChannels(e,t.requiredStokes,!0))},this.onRangeChanged=e=>{const t=O.e.Instance.activeFrame;e&&2===e.length&&t&&e[0]>=0&&e[0]<e[1]&&e[1]<t.frameInfo.fileInfoExtended.depth&&t.setAnimationRange(e)},this.onStokesChanged=e=>{const t=O.e.Instance.activeFrame;t&&(e<0&&(e+=t.frameInfo.fileInfoExtended.stokes),e>=t.frameInfo.fileInfoExtended.stokes&&(e=0),t.setChannels(t.requiredChannel,e,!0))},this.onFrameChanged=e=>{const t=O.e.Instance;e<0&&(e+=t.frames.length),e>=t.frames.length&&(e=0),t.setActiveFrameByIndex(e)},this.onAnimationModeChanged=e=>{const t=parseInt(e.currentTarget.value);O.d.Instance.setAnimationMode(t)},this.onFirstClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.setActiveFrameByIndex(0);break;case O.c.CHANNEL:t.setChannels(0,t.stokes,!0);break;case O.c.STOKES:t.setChannels(t.channel,0,!0)}},this.onLastClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.setActiveFrameByIndex(e.frames.length-1);break;case O.c.CHANNEL:t.setChannels(t.frameInfo.fileInfoExtended.depth-1,t.stokes,!0);break;case O.c.STOKES:t.setChannels(t.channel,t.frameInfo.fileInfoExtended.stokes-1,!0)}},this.onNextClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.nextFrame();break;case O.c.CHANNEL:t.incrementChannels(1,0);break;case O.c.STOKES:t.incrementChannels(0,1)}},this.onPrevClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.prevFrame();break;case O.c.CHANNEL:t.incrementChannels(-1,0);break;case O.c.STOKES:t.incrementChannels(0,-1)}},this.getPlayModeIcon=()=>{switch(O.d.Instance.playMode){case O.F.FORWARD:default:return"arrow-right";case O.F.BACKWARD:return"arrow-left";case O.F.BOUNCING:return"swap-horizontal";case O.F.BLINK:return"exchange"}},Object(m.p)(this),this.numericInputType=u.FrameRate}roundToClosestPreferredStep(e){const t=Math.floor(Math.log10(e)),i=e/Math.pow(10,t);return i<1.5?1*Math.pow(10,t):i<3.5?2*Math.pow(10,t):5*Math.pow(10,t)}render(){const e=O.e.Instance,t=e.activeFrame,i=t?t.frameInfo.fileInfoExtended.depth:0,n=t?t.frameInfo.fileInfoExtended.stokes:0,r=this.width<625,o=this.width<450;let a,s,l,c;if(e.frames.length>1){const i=e.frames.findIndex(e=>e.frameInfo.fileId===t.frameInfo.fileId);c=h.createElement("div",{className:"animator-slider"},h.createElement(f.K,{value:O.c.FRAME,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===O.c.FRAME,onChange:this.onAnimationModeChanged,label:"Image"}),o&&h.createElement(S.n,{value:i,min:-1,max:e.frames.length,stepSize:1,onValueChange:this.onFrameChanged,fill:!0,disabled:e.animatorStore.animationActive}),!o&&h.createElement(h.Fragment,null,h.createElement(f.N,{value:i,min:0,max:e.frames.length-1,showTrackFill:!1,stepSize:1,onChange:this.onFrameChanged,disabled:e.animatorStore.animationActive}),h.createElement("div",{className:"slider-info"},t.filename)))}if(i>1){const n=5,r=i>10?(i-1)/(n-1):1;a=h.createElement("div",{className:"animator-slider"},h.createElement(f.K,{value:O.c.CHANNEL,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===O.c.CHANNEL,onChange:this.onAnimationModeChanged,label:"Channel"}),o&&h.createElement(S.n,{value:t.requiredChannel,min:-1,max:i,stepSize:1,onValueChange:this.onChannelChanged,fill:!0,disabled:e.animatorStore.animationActive}),!o&&h.createElement(h.Fragment,null,h.createElement(f.N,{className:"channel-slider",value:t.requiredChannel,min:0,max:i-1,labelStepSize:r,labelPrecision:0,showTrackFill:!1,onChange:this.onChannelChanged,disabled:e.animatorStore.animationActive}),h.createElement("div",{className:"slider-info"},h.createElement("pre",null,t.simpleSpectralInfo)))),s=h.createElement("div",{className:"animator-slider range-slider"},h.createElement("div",{className:"range-label"}),!o&&h.createElement(h.Fragment,null,h.createElement(f.M,{value:t.animationChannelRange,min:0,max:i-1,labelStepSize:r,labelPrecision:0,onChange:this.onRangeChanged,disabled:e.animatorStore.animationActive}),h.createElement("div",{className:"slider-info"})))}n>1&&(l=h.createElement("div",{className:"animator-slider"},h.createElement(f.K,{value:O.c.STOKES,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===O.c.STOKES,onChange:this.onAnimationModeChanged,label:"Stokes"}),o&&h.createElement(S.n,{value:t.requiredStokes,min:-1,max:t.frameInfo.fileInfoExtended.stokes,stepSize:1,onValueChange:this.onStokesChanged,disabled:e.animatorStore.animationActive,fill:!0}),!o&&h.createElement(h.Fragment,null,h.createElement(f.N,{value:t.requiredStokes,min:0,showTrackFill:!1,max:t.frameInfo.fileInfoExtended.stokes-1,onChange:this.onStokesChanged,disabled:e.animatorStore.animationActive}),h.createElement("div",{className:"slider-info"}))));let p="animator-playback";o&&(p+=" wrap");const d=h.createElement(f.F,{className:"playback-mode",content:h.createElement(f.z,null,h.createElement(f.B,{icon:"arrow-right",text:"Play Forward",active:e.animatorStore.playMode===O.F.FORWARD,onClick:()=>e.animatorStore.playMode=O.F.FORWARD}),h.createElement(f.B,{icon:"arrow-left",text:"Play Backwards",active:e.animatorStore.playMode===O.F.BACKWARD,onClick:()=>e.animatorStore.playMode=O.F.BACKWARD}),h.createElement(f.B,{icon:"swap-horizontal",text:"Bouncing",active:e.animatorStore.playMode===O.F.BOUNCING,onClick:()=>e.animatorStore.playMode=O.F.BOUNCING}),h.createElement(f.B,{icon:"exchange",text:"Blink",active:e.animatorStore.playMode===O.F.BLINK,onClick:()=>e.animatorStore.playMode=O.F.BLINK})),position:y.a.TOP},h.createElement(f.W,{content:"Playback Mode",position:y.a.TOP},h.createElement(f.b,{icon:this.getPlayModeIcon(),disabled:e.animatorStore.animationActive},!r&&"Mode"))),g=h.createElement(f.f,{fill:!0,className:"playback-buttons"},h.createElement(f.e,{icon:"chevron-backward",onClick:this.onFirstClicked},!r&&"First"),h.createElement(f.e,{icon:"step-backward",onClick:this.onPrevClicked},!r&&"Prev"),e.animatorStore.animationActive&&h.createElement(f.e,{icon:"stop",onClick:e.animatorStore.stopAnimation},!r&&"Stop"),!e.animatorStore.animationActive&&h.createElement(f.e,{icon:"play",onClick:e.animatorStore.startAnimation},!r&&"Play"),h.createElement(f.e,{icon:"step-forward",onClick:this.onNextClicked},!r&&"Next"),h.createElement(f.e,{icon:"chevron-forward",onClick:this.onLastClicked},!r&&"Last")),m=h.createElement(f.k,{className:"playback-numeric-control"},h.createElement(f.r,{options:[u.FrameRate,u.Step],onChange:e=>this.onNumericInputTypeChange(e.currentTarget.value)}),this.numericInputType===u.FrameRate?h.createElement(S.n,{value:e.animatorStore.frameRate,min:e.animatorStore.minFrameRate,max:e.animatorStore.maxFrameRate,stepSize:1,minorStepSize:1,majorStepSize:1,onValueChange:e.animatorStore.setFrameRate,disabled:e.animatorStore.animationActive}):h.createElement(S.n,{value:e.animatorStore.step,min:e.animatorStore.minStep,max:e.animatorStore.maxStep,stepSize:1,minorStepSize:1,majorStepSize:1,onValueChange:e.animatorStore.setStep,disabled:e.animatorStore.animationActive}));return h.createElement("div",{className:"animator-widget"},!t&&h.createElement(f.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),t&&h.createElement("div",{className:p},g,d,m),t&&this.width>0&&h.createElement("div",{className:"animator-sliders"},c,a,s,l),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},o=Object(d.a)(r.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(d.a)(r.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(d.a)(r.prototype,"numericInputType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(d.a)(r.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),c=Object(d.a)(r.prototype,"onNumericInputTypeChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numericInputType=e}}}),n=r))||n;var E,I=i(201);i(928);let w=Object(g.a)(E=class extends h.Component{constructor(...e){super(...e),this.pinElementRef=void 0,this.rnd=void 0,this.onClickHelpButton=()=>{const e=this.rnd.draggable.state.x+.5*this.rnd.resizable.size.width;if(Array.isArray(this.props.widgetConfig.helpType)){const t=O.e.Instance.widgetsStore,i=this.props.widgetConfig.parentType,n=t.floatingSettingsWidgets.get(this.props.widgetConfig.id);let r;switch(i){case"spatial-profiler":r=t.spatialProfileWidgets.get(n).settingsTabId;break;case"spectral-profiler":r=t.spectralProfileWidgets.get(n).settingsTabId;break;case"catalog-overlay":const e=O.k.Instance,i=e.catalogProfiles.get(n);if(i){const n=e.catalogWidgets.get(i);r=t.catalogWidgets.get(n).settingsTabId}break;case"stokes":default:r=t.stokesAnalysisWidgets.get(n).settingsTabId}O.w.Instance.showHelpDrawer(this.props.widgetConfig.helpType[r],e)}else O.w.Instance.showHelpDrawer(this.props.widgetConfig.helpType,e)}}componentDidMount(){this.updateDragSource(),this.rnd.updateSize({width:this.props.widgetConfig.defaultWidth,height:this.props.widgetConfig.defaultHeight}),this.rnd.updatePosition({x:this.props.widgetConfig.defaultX,y:this.props.widgetConfig.defaultY})}componentDidUpdate(){this.updateDragSource(),this.rnd.updateSize({width:this.props.widgetConfig.defaultWidth,height:this.props.widgetConfig.defaultHeight}),this.rnd.updatePosition({x:this.props.widgetConfig.defaultX,y:this.props.widgetConfig.defaultY})}updateDragSource(){const e=O.z.Instance;if(e.dockedLayout&&this.pinElementRef){const t=e.dockedLayout;if(t._dragSources.filter(e=>e._itemConfig.id===this.props.widgetConfig.id).find(e=>e._element[0]===this.pinElementRef))return;let i;i={type:"react-component",component:this.props.widgetConfig.type,title:this.props.widgetConfig.title,id:this.props.widgetConfig.id,isClosable:this.props.widgetConfig.isCloseable,props:{id:this.props.widgetConfig.id,docked:!0}},this.props.widgetConfig.type===Pt.WIDGET_CONFIG.type&&(i.props.label=this.props.widgetConfig.title),this.pinElementRef&&i&&t.createDragSource(this.pinElementRef,i)}}render(){const e=O.e.Instance;let t="floating-widget",i="floating-content",n=this.props.isSelected?"floating-header selected":"floating-header",r="floating-header-button";e.darkTheme&&(t+=" bp3-dark",n+=" bp3-dark",r+=" bp3-dark"),this.props.showPinButton||(i="floating-settings-content");const o=this.props.widgetConfig;return h.createElement(I.a,{ref:e=>this.rnd=e,className:t,style:{zIndex:this.props.zIndex},default:{x:o.defaultX,y:o.defaultY,width:o.defaultWidth,height:o.defaultHeight+25},resizeGrid:[25,25],dragGrid:[25,25],minWidth:o.minWidth,minHeight:o.minHeight+25,bounds:".gl-container-app",dragHandleClassName:"floating-title",onMouseDown:this.props.onSelected,onDragStop:(e,t)=>{o.setDefaultPosition(t.lastX,t.lastY)},onResizeStop:(e,t,i,n,r)=>{o.setDefaultPosition(r.x,r.y),o.setDefaultSize(o.defaultWidth+n.width,o.defaultHeight+n.height)}},h.createElement("div",{className:n},h.createElement("div",{className:"floating-title"},o.title),this.props.showFloatingSettingsButton&&h.createElement("div",{className:r,onClick:()=>e.widgetsStore.createFloatingSettingsWidget(o.title,o.id,o.type)},h.createElement(f.W,{content:"Settings",position:y.a.BOTTOM_RIGHT},h.createElement(f.w,{icon:"cog"}))),o.helpType&&h.createElement("div",{className:r,onClick:this.onClickHelpButton},h.createElement(f.W,{content:"Help",position:y.a.BOTTOM_RIGHT},h.createElement(f.w,{icon:"help"}))),this.props.showPinButton&&h.createElement("div",{className:r,ref:e=>this.pinElementRef=e,onClick:()=>console.log("pin!")},h.createElement(f.W,{content:"Drag pin to dock this widget",position:y.a.BOTTOM_RIGHT},h.createElement(f.w,{icon:"pin"}))),o.isCloseable&&h.createElement("div",{onMouseDown:this.props.onClosed,className:r},h.createElement(f.w,{icon:"cross"}))),h.createElement("div",{className:i},this.props.children))}})||E;var T,v,A,x,R=i(22),P=i(43),j=i.n(P),k=i(491),F=i(77),M=i(6);i(930);class D{constructor(e,t){this.name=void 0,this.id=void 0,this.style=void 0,this.weight=void 0,this.family=void 0,this.name=e.replace("{size} ",""),this.id=t;let i=this.name;0===i.indexOf("bold")?(i=i.replace("bold ",""),this.weight=700):this.weight=400,0===i.indexOf("italic")?(i=i.replace("italic ",""),this.style="italic"):this.style="",this.family=i}}const N=R.fonts.map((e,t)=>new D(e,t)),L=k.a.ofType(),_=(e,{handleClick:t,modifiers:i,query:n})=>h.createElement(f.B,{active:i.active,disabled:i.disabled,key:e.id,onClick:t,text:h.createElement("span",{style:{fontFamily:e.family,fontWeight:e.weight,fontStyle:e.style}},e.name)});let z=Object(g.a)((v=class extends h.Component{constructor(e){super(e),Object(p.a)(this,"selectedTab",A,this),Object(p.a)(this,"setSelectedTab",x,this),Object(m.p)(this)}fontSelect(e,t,i){let n=N[t];return"undefined"===typeof n&&(n=N[0]),h.createElement(L,{activeItem:n,itemRenderer:_,items:N,disabled:!e,filterable:!1,popoverProps:{minimal:!0,position:"auto-end",popoverClassName:"fontselect"},onItemSelect:e=>i(e.id)},h.createElement(f.e,{text:h.createElement("span",{style:{fontFamily:n.family,fontWeight:n.weight,fontStyle:n.style}},n.name),disabled:!e,rightIcon:"double-caret-vertical"}))}static get WIDGET_CONFIG(){return{id:"image-view-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:550,defaultHeight:420,title:"image-view-settings",isCloseable:!0,parentId:"image-view",parentType:"image-view",helpType:O.x.IMAGE_VIEW_SETTINGS}}render(){const e=O.e.Instance,t=e.overlayStore,i=t.global,n=t.title,r=t.grid,o=t.border,a=t.ticks,s=t.axes,l=t.numbers,c=t.labels,u=t.beam,p=u.settingsForDisplay,d=i.labelType===O.y.Interior,g=d&&"Does not apply to interior labelling.",m=!d&&"Does not apply to exterior labelling.",y=!i.validWcs&&"This image has no valid WCS data.",b=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Color"},h.createElement(F.a,{selectedItem:i.color,onItemSelect:i.setColor})),h.createElement(f.p,{inline:!0,label:"Tolerance",labelInfo:"(%)"},h.createElement(S.n,{placeholder:"Tolerance",min:.1,value:i.tolerance,stepSize:.1,minorStepSize:null,majorStepSize:10,onValueChange:e=>i.setTolerance(e)})),h.createElement(f.p,{inline:!0,label:"Labelling"},h.createElement(f.r,{options:Object.keys(O.y).map(e=>({label:e,value:O.y[e]})),value:i.labelType,onChange:e=>i.setLabelType(e.currentTarget.value)})),h.createElement(f.p,{inline:!0,label:"Coordinate system",disabled:!i.validWcs,helperText:y},h.createElement(f.r,{options:Object.keys(O.R).map(e=>({label:e,value:O.R[e]})),value:i.system,disabled:!i.validWcs,onChange:e=>i.setSystem(e.currentTarget.value)}))),C=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Visible"},h.createElement(f.P,{checked:n.visible,onChange:e=>n.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,className:"font-group",label:"Font",disabled:!n.visible},this.fontSelect(n.visible,n.font,n.setFont),h.createElement(S.n,{min:7,placeholder:"Font size",value:n.fontSize,disabled:!n.visible,onValueChange:e=>n.setFontSize(e)})),h.createElement(f.p,{inline:!0,label:"Custom text",disabled:!n.visible},h.createElement(f.P,{checked:n.customText,disabled:!n.visible,onChange:e=>n.setCustomText(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:n.customText},h.createElement(f.p,{inline:!0,label:"Title Text",disabled:!n.visible},h.createElement(f.x,{disabled:!n.visible,value:n.customTitleString,placeholder:"Enter title text",onChange:e=>n.setCustomTitleString(e.currentTarget.value)}))),h.createElement(f.p,{inline:!0,label:"Custom color",disabled:!n.visible},h.createElement(f.P,{checked:n.customColor,disabled:!n.visible,onChange:e=>n.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:n.customColor},h.createElement(f.p,{inline:!0,label:"Color",disabled:!n.visible},n.visible&&h.createElement(F.a,{selectedItem:n.color,onItemSelect:n.setColor})))),E=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Draw on all edges",disabled:d,helperText:g},h.createElement(f.P,{checked:a.drawAll,disabled:d,onChange:e=>a.setDrawAll(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,label:"Custom density"},h.createElement(f.P,{checked:a.customDensity,onChange:e=>a.setCustomDensity(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:a.customDensity},h.createElement(f.p,{inline:!0,label:"Density",labelInfo:"(X)"},h.createElement(S.n,{placeholder:"Density",min:0,value:a.densityX,onValueChange:e=>a.setDensityX(e)})),h.createElement(f.p,{inline:!0,label:"Density",labelInfo:"(Y)"},h.createElement(S.n,{placeholder:"Density",min:0,value:a.densityY,onValueChange:e=>a.setDensityY(e)}))),h.createElement(f.p,{inline:!0,label:"Custom color"},h.createElement(f.P,{checked:a.customColor,onChange:e=>a.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:a.customColor},h.createElement(f.p,{inline:!0,label:"Color"},h.createElement(F.a,{selectedItem:a.color,onItemSelect:a.setColor}))),h.createElement(f.p,{inline:!0,label:"Width",labelInfo:"(px)"},h.createElement(S.n,{placeholder:"Width",min:.001,value:a.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>a.setWidth(e)})),h.createElement(f.p,{inline:!0,label:"Minor length",labelInfo:"(%)"},h.createElement(S.n,{placeholder:"Length",min:0,max:100,value:a.length,stepSize:1,minorStepSize:null,majorStepSize:10,onValueChange:e=>a.setLength(e)})),h.createElement(f.p,{inline:!0,label:"Major length",labelInfo:"(%)"},h.createElement(S.n,{placeholder:"Length",min:0,max:100,value:a.majorLength,stepSize:1,minorStepSize:null,majorStepSize:10,onValueChange:e=>a.setMajorLength(e)}))),I=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Visible"},h.createElement(f.P,{checked:r.visible,onChange:e=>r.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,label:"Custom color",disabled:!r.visible},h.createElement(f.P,{checked:r.customColor,disabled:!r.visible,onChange:e=>r.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:r.customColor},h.createElement(f.p,{inline:!0,label:"Color",disabled:!r.visible},r.visible&&h.createElement(F.a,{selectedItem:r.color,onItemSelect:r.setColor}))),h.createElement(f.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!r.visible},h.createElement(S.n,{placeholder:"Width",min:.001,value:r.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!r.visible,onValueChange:e=>r.setWidth(e)})),h.createElement(f.p,{inline:!0,label:"Custom gap",disabled:!r.visible},h.createElement(f.P,{checked:r.customGap,disabled:!r.visible,onChange:e=>r.setCustomGap(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:r.customGap},h.createElement(f.p,{inline:!0,label:"Gap",labelInfo:"(X)",disabled:!r.visible},h.createElement(S.n,{placeholder:"Gap",min:.001,stepSize:.01,minorStepSize:.001,majorStepSize:.1,value:r.gapX,disabled:!r.visible,onValueChange:e=>r.setGapX(e)})),h.createElement(f.p,{inline:!0,label:"Gap",labelInfo:"(Y)",disabled:!r.visible},h.createElement(S.n,{placeholder:"Gap",min:.001,stepSize:.01,minorStepSize:.001,majorStepSize:.1,value:r.gapY,disabled:!r.visible,onValueChange:e=>r.setGapY(e)})))),w=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Visible"},h.createElement(f.P,{checked:o.visible,onChange:e=>o.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,label:"Custom color",disabled:!o.visible},h.createElement(f.P,{checked:o.customColor,disabled:!o.visible,onChange:e=>o.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:o.customColor},h.createElement(f.p,{inline:!0,label:"Color",disabled:!o.visible},o.visible&&h.createElement(F.a,{selectedItem:o.color,onItemSelect:o.setColor}))),h.createElement(f.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!o.visible},h.createElement(S.n,{placeholder:"Width",min:.001,value:o.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!o.visible,onValueChange:e=>o.setWidth(e)}))),T=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Visible",disabled:!d,helperText:m},h.createElement(f.P,{checked:s.visible,disabled:!d,onChange:e=>s.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,label:"Custom color",disabled:!d||!s.visible},h.createElement(f.P,{checked:s.customColor,disabled:!d||!s.visible,onChange:e=>s.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:s.customColor},h.createElement(f.p,{inline:!0,label:"Color",disabled:!d||!s.visible,helperText:m},d&&s.visible&&h.createElement(F.a,{selectedItem:s.color,onItemSelect:s.setColor}))),h.createElement(f.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!d||!s.visible,helperText:m},h.createElement(S.n,{placeholder:"Width",min:.001,value:s.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!d||!s.visible,onValueChange:e=>s.setWidth(e)}))),v=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Visible"},h.createElement(f.P,{checked:l.visible,onChange:e=>l.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,className:"font-group",label:"Font",disabled:!l.visible},this.fontSelect(l.visible,l.font,l.setFont),h.createElement(S.n,{min:7,placeholder:"Font size",value:l.fontSize,disabled:!l.visible,onValueChange:e=>l.setFontSize(e)})),h.createElement(f.p,{inline:!0,label:"Custom color",disabled:!l.visible},h.createElement(f.P,{checked:l.customColor,disabled:!l.visible,onChange:e=>l.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:l.customColor},h.createElement(f.p,{inline:!0,label:"Color",disabled:!l.visible},l.visible&&h.createElement(F.a,{selectedItem:l.color,onItemSelect:l.setColor}))),h.createElement(f.p,{inline:!0,label:"Custom format",disabled:!l.validWcs,helperText:y},h.createElement(f.P,{checked:l.customFormat,disabled:!l.validWcs,onChange:e=>l.setCustomFormat(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:l.customFormat&&l.validWcs},h.createElement(f.p,{inline:!0,label:"Format",labelInfo:"(X)"},h.createElement(f.r,{options:[{label:O.B.get(O.C.HMS),value:O.C.HMS},{label:O.B.get(O.C.DMS),value:O.C.DMS},{label:O.B.get(O.C.Degrees),value:O.C.Degrees}],value:l.formatX,onChange:e=>l.setFormatX(e.currentTarget.value)})),h.createElement(f.p,{inline:!0,label:"Format",labelInfo:"(Y)"},h.createElement(f.r,{options:[{label:O.B.get(O.C.HMS),value:O.C.HMS},{label:O.B.get(O.C.DMS),value:O.C.DMS},{label:O.B.get(O.C.Degrees),value:O.C.Degrees}],value:l.formatY,onChange:e=>l.setFormatY(e.currentTarget.value)}))),h.createElement(f.p,{inline:!0,label:"Custom precision",disabled:!l.validWcs,helperText:y},h.createElement(f.P,{checked:l.customPrecision,disabled:!l.validWcs,onChange:e=>l.setCustomPrecision(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:l.customPrecision&&l.validWcs},h.createElement(f.p,{inline:!0,label:"Precision"},h.createElement(S.n,{placeholder:"Precision",min:0,value:l.precision,onValueChange:e=>l.setPrecision(e)})))),A=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Visible"},h.createElement(f.P,{checked:c.visible,onChange:e=>c.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,className:"font-group",label:"Font",disabled:!c.visible},this.fontSelect(c.visible,c.font,c.setFont),h.createElement(S.n,{min:7,placeholder:"Font size",value:c.fontSize,disabled:!c.visible,onValueChange:e=>c.setFontSize(e)})),h.createElement(f.p,{inline:!0,label:"Custom text",disabled:!c.visible},h.createElement(f.P,{checked:c.customText,disabled:!c.visible,onChange:e=>c.setCustomText(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:c.customText},h.createElement(f.p,{inline:!0,label:"Label Text (X)",disabled:!c.visible},h.createElement(f.x,{disabled:!c.visible,value:c.customLabelX,placeholder:"Enter label text",onChange:e=>c.setCustomLabelX(e.currentTarget.value)})),h.createElement(f.p,{inline:!0,label:"Label Text (Y)",disabled:!c.visible},h.createElement(f.x,{disabled:!c.visible,value:c.customLabelY,placeholder:"Enter label text",onChange:e=>c.setCustomLabelY(e.currentTarget.value)}))),h.createElement(f.p,{inline:!0,label:"Custom color",disabled:!c.visible},h.createElement(f.P,{checked:c.customColor,disabled:!c.visible,onChange:e=>c.setCustomColor(e.currentTarget.checked)})),h.createElement(f.i,{isOpen:c.customColor},h.createElement(f.p,{inline:!0,label:"Color",disabled:!c.visible},c.visible&&h.createElement(F.a,{selectedItem:c.color,onItemSelect:c.setColor})))),x=u.isSelectedFrameValid?h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Image"},h.createElement(f.r,{options:e.frameNames,value:u.selectedFileId,onChange:e=>u.setSelectedFrame(parseInt(e.currentTarget.value))})),h.createElement(f.p,{inline:!0,label:"Visible"},h.createElement(f.P,{checked:p.visible,onChange:e=>p.setVisible(e.currentTarget.checked)})),h.createElement(f.p,{inline:!0,label:"Color"},h.createElement(S.c,{color:j()(p.color).toHexString(),presetColors:M.e,setColor:e=>p.setColor(e.hex),disableAlpha:!0,darkTheme:e.darkTheme})),h.createElement(f.p,{inline:!0,label:"Type"},h.createElement(f.r,{options:Object.keys(O.f).map(e=>({label:e,value:O.f[e]})),value:p.type,onChange:e=>p.setType(e.currentTarget.value)})),h.createElement(f.p,{inline:!0,label:"Width",labelInfo:"(px)"},h.createElement(S.n,{placeholder:"Width",min:.5,max:10,value:p.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>p.setWidth(e)})),h.createElement(f.p,{inline:!0,label:"Position (X)",labelInfo:"(px)"},h.createElement(S.n,{placeholder:"Position (X)",min:0,max:t.renderWidth,value:p.shiftX,stepSize:5,minorStepSize:1,majorStepSize:10,onValueChange:e=>p.setShiftX(e)})),h.createElement(f.p,{inline:!0,label:"Position (Y)",labelInfo:"(px)"},h.createElement(S.n,{placeholder:"Position (Y)",min:0,max:t.renderHeight,value:p.shiftY,stepSize:5,minorStepSize:1,majorStepSize:10,onValueChange:e=>p.setShiftY(e)}))):null;let R="image-view-settings";return e.darkTheme&&(R+=" bp3-dark"),h.createElement("div",{className:R},h.createElement(f.R,{id:"imageViewSettingsTabs",vertical:!0,selectedTabId:this.selectedTab,onChange:this.setSelectedTab},h.createElement(f.Q,{id:"global",title:"Global",panel:b}),h.createElement(f.Q,{id:"title",title:"Title",panel:C}),h.createElement(f.Q,{id:"ticks",title:"Ticks",panel:E}),h.createElement(f.Q,{id:"grid",title:"Grid",panel:I}),h.createElement(f.Q,{id:"border",title:"Border",panel:w}),h.createElement(f.Q,{id:"axes",title:"Axes",panel:T}),h.createElement(f.Q,{id:"numbers",title:"Numbers",panel:v}),h.createElement(f.Q,{id:"labels",title:"Labels",panel:A}),h.createElement(f.Q,{id:"beam",title:"Beam",panel:x,disabled:e.frameNum<=0})))}},A=Object(d.a)(v.prototype,"selectedTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global"}}),x=Object(d.a)(v.prototype,"setSelectedTab",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTab=e}}}),T=v))||T;var W;let G=Object(g.a)(W=class extends h.Component{constructor(...e){super(...e),this.floatingSettingType="floating-settings",this.onFloatingWidgetSelected=e=>{O.U.Instance.updateSelectFloatingWidgetzIndex(e.id)},this.onFloatingWidgetClosed=e=>{const t=O.U.Instance;switch(e.type){case bn.WIDGET_CONFIG.type:t.removeFloatingWidgetComponent(e.componentId),O.k.Instance.catalogProfiles.delete(e.componentId);break;case $o.WIDGET_CONFIG.type:t.removeFloatingWidgetComponent(e.componentId),O.k.Instance.clearCatalogPlotsByComponentId(e.componentId);break;default:t.removeFloatingWidget(e.id)}}}getWidgetContent(e){switch(e.type){case nt.WIDGET_CONFIG.type:return h.createElement(nt,{id:e.id,docked:!1});case Ct.WIDGET_CONFIG.type:return h.createElement(Ct,{id:e.id,docked:!1});case st.WIDGET_CONFIG.type:return h.createElement(st,{id:e.id,docked:!1});case Vt.WIDGET_CONFIG.type:return h.createElement(Vt,{id:e.id,docked:!1});case C.WIDGET_CONFIG.type:return h.createElement(C,{id:e.id,docked:!1});case li.WIDGET_CONFIG.type:return h.createElement(li,{id:e.id,docked:!1});case Ri.WIDGET_CONFIG.type:return h.createElement(Ri,{id:e.id,docked:!1});case Ci.WIDGET_CONFIG.type:return h.createElement(Ci,{id:e.id,docked:!1});case Li.WIDGET_CONFIG.type:return h.createElement(Li,{id:e.id,docked:!1});case Hi.WIDGET_CONFIG.type:return h.createElement(Hi,{id:e.id,docked:!1});case Zt.WIDGET_CONFIG.type:return h.createElement(Zt,{id:e.id,docked:!1});case tn.WIDGET_CONFIG.type:return h.createElement(tn,{id:e.id,docked:!1});case bn.WIDGET_CONFIG.type:return h.createElement(bn,{id:e.componentId,docked:!1});case $o.WIDGET_CONFIG.type:return h.createElement($o,{id:e.id,docked:!1});default:return h.createElement(Pt,{id:e.id,docked:!1,label:e.title})}}getWidgetSettings(e){if(e.parentId)switch(e.parentType){case nt.WIDGET_CONFIG.type:return h.createElement(z,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case tn.WIDGET_CONFIG.type:return h.createElement(En,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Ri.WIDGET_CONFIG.type:return h.createElement(Pn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case li.WIDGET_CONFIG.type:return h.createElement(Mn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Vt.WIDGET_CONFIG.type:return h.createElement(Ln,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Hi.WIDGET_CONFIG.type:return h.createElement(Wn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case bn.WIDGET_CONFIG.type:return h.createElement(la,{id:e.parentId,docked:!1,floatingSettingsId:e.id});default:return null}return null}showPin(e){return!e.type||e.type!==this.floatingSettingType}showFloatingSettingsButton(e){switch(e.type){case tn.WIDGET_CONFIG.type:case Ri.WIDGET_CONFIG.type:case li.WIDGET_CONFIG.type:case Vt.WIDGET_CONFIG.type:case Hi.WIDGET_CONFIG.type:case bn.WIDGET_CONFIG.type:return!0;default:return!1}}render(){const e=O.U.Instance.floatingWidgets;return h.createElement("div",null,e.map(t=>{const i=this.showPin(t),n=t.componentId?t.componentId:t.id;return h.createElement("div",{key:n},h.createElement(w,{isSelected:t.zIndex===e.length,key:n,widgetConfig:t,zIndex:t.zIndex,showPinButton:i,onSelected:()=>this.onFloatingWidgetSelected(t),onClosed:()=>this.onFloatingWidgetClosed(t),showFloatingSettingsButton:this.showFloatingSettingsButton(t),floatingWidgets:e.length},i?this.getWidgetContent(t):this.getWidgetSettings(t)))}))}})||W;var V,B=i(80),q=i.n(B),H=i(36);i(931);let U=Object(g.a)(V=class extends h.Component{constructor(...e){super(...e),this.canvas=void 0,this.renderCanvas=H.throttle(()=>{const e=this.props.overlaySettings,t=this.props.frame,i=devicePixelRatio;if(t.wcsInfo){const n=t.spatialReference?t.transformedWcsInfo:t.wcsInfo,r=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView;this.updateImageDimensions(),R.setCanvas(this.canvas);const o=t=>{R.plot(n,r.xMin,r.xMax,r.yMin,r.yMax,e.viewWidth*i,e.viewHeight*i,e.padding.left*i,e.padding.right*i,e.padding.top*i,e.padding.bottom*i,t)};let a=e.styleString;if(t.moving){a+=", Tol="+Math.max(2*e.global.tolerance/100,.1)}o(a),/No grid curves can be drawn for axis/.test(R.getLastErrorMessage())&&o(a.replace(/Gap\(\d\)=[^,]+, ?/g,"").replace("Grid=1","Grid=0")),R.clearLastErrorMessage()}},50)}componentDidMount(){this.canvas&&this.renderCanvas()}componentDidUpdate(){this.canvas&&this.renderCanvas()}updateImageDimensions(){this.canvas.width=this.props.overlaySettings.viewWidth*devicePixelRatio,this.canvas.height=this.props.overlaySettings.viewHeight*devicePixelRatio}render(){const e=this.props.overlaySettings.styleString;(this.props.frame.spatialReference||this.props.frame).requiredFrameView,this.props.overlaySettings.padding,this.props.overlaySettings.viewWidth,this.props.overlaySettings.viewHeight,this.props.frame.moving;let t="overlay-canvas";return this.props.docked&&(t+=" docked"),h.createElement("canvas",{className:t,id:"overlay-canvas",key:e,ref:e=>this.canvas=e})}})||V;var Y;i(932);let X=Object(g.a)(Y=class extends h.Component{render(){const e=this.props.cursorInfo;let t=[];if(this.props.showWCS&&e.infoWCS&&t.push(`WCS:\xa0(${e.infoWCS.x},\xa0${e.infoWCS.y})`),this.props.showImage&&t.push(`Image:\xa0(${Object(M.kb)(e.posImageSpace.x)},\xa0${Object(M.kb)(e.posImageSpace.y)})`),this.props.showValue&&void 0!==this.props.cursorValue){let e="Value:\xa0"+Object(M.u)(this.props.cursorValue,5,this.props.unit,!0,!0);isNaN(this.props.cursorValue)&&(e="NaN"),this.props.isValueCurrent?e+=" ":e+="*",t.push(e)}this.props.showChannel&&void 0!==this.props.spectralInfo.channel&&t.push("Channel:\xa0"+this.props.spectralInfo.channel),this.props.showSpectral&&this.props.spectralInfo.spectralString&&(t.push(this.props.spectralInfo.spectralString.replace(/\s/g,"\xa0")),this.props.spectralInfo.freqString&&t.push(this.props.spectralInfo.freqString.replace(/\s/g,"\xa0")),this.props.spectralInfo.velocityString&&t.push(this.props.spectralInfo.velocityString.replace(/\s/g,"\xa0"))),this.props.showStokes&&this.props.currentStokes&&t.push("Stokes:\xa0"+this.props.currentStokes);let i={lineHeight:(void 0!==this.props.height&&this.props.height>=0?this.props.height:20)+"px"};(this.props.left>0||this.props.right>0)&&(i.width=this.props.width-this.props.left-this.props.right),void 0!==this.props.top?i.top=this.props.top:void 0!==this.props.bottom&&(i.bottom=this.props.bottom),void 0!==this.props.left&&(i.left=this.props.left);let n="cursor-overlay-div";return this.props.docked&&(n+=" docked"),h.createElement("div",{className:n,style:i},t.join("; "))}})||Y;var K,Q=i(10),Z=i(28);i(933);let $=Object(g.a)(K=class extends h.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.updateCanvas=()=>{const e=O.e.Instance.activeFrame,t=Z.i.Instance;if(e&&this.canvas&&this.gl&&t.cmapTexture){const t=e.renderConfig.stokes,i=e.renderConfig.histogram?e.renderConfig.histogram.channel:void 0;!e.renderConfig.useCubeHistogram&&e.channel!==i||e.stokes!==t||(this.updateCanvasSize(),this.updateUniforms(),this.renderCanvas());const n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),n.drawImage(this.gl.canvas,0,0,this.canvas.width,this.canvas.height)}}}componentDidMount(){this.gl=Z.i.Instance.gl,this.canvas&&this.updateCanvas(),Z.h.Instance.tileStream.subscribe(()=>{requestAnimationFrame(this.updateCanvas)})}componentDidUpdate(){requestAnimationFrame(this.updateCanvas)}updateUniforms(){const e=O.e.Instance,t=Z.i.Instance.shaderUniforms,i=e.activeFrame,n=i.renderConfig;if(n&&t){this.gl.uniform1f(t.MinVal,n.scaleMinVal),this.gl.uniform1f(t.MaxVal,n.scaleMaxVal),this.gl.uniform1i(t.CmapIndex,n.colorMapIndex),this.gl.uniform1i(t.ScaleType,n.scaling),this.gl.uniform1i(t.Inverted,n.inverted?1:0),this.gl.uniform1f(t.Bias,n.bias),this.gl.uniform1f(t.Contrast,n.contrast),this.gl.uniform1f(t.Gamma,n.gamma),this.gl.uniform1f(t.Alpha,n.alpha),this.gl.uniform1f(t.CanvasWidth,i.renderWidth*devicePixelRatio),this.gl.uniform1f(t.CanvasHeight,i.renderHeight*devicePixelRatio);const r=j()(e.preferenceStore.nanColorHex).setAlpha(e.preferenceStore.nanAlpha);if(r.isValid()){const e=r.toRgb();this.gl.uniform4f(t.NaNColor,e.r/255,e.g/255,e.b/255,e.a)}}}updateCanvasSize(){const e=O.e.Instance.activeFrame,t=Z.i.Instance;e&&e.isRenderable&&(this.canvas.width!==e.renderWidth*devicePixelRatio||this.canvas.height!==e.renderHeight*devicePixelRatio)&&(this.canvas.width=e.renderWidth*devicePixelRatio,this.canvas.height=e.renderHeight*devicePixelRatio,t.setCanvasSize(e.renderWidth*devicePixelRatio,e.renderHeight*devicePixelRatio))}renderCanvas(){const e=O.e.Instance.activeFrame;if(e&&e.isRenderable&&e.renderType!==O.J.NONE){if(this.gl.viewport(0,0,e.renderWidth*devicePixelRatio,e.renderHeight*devicePixelRatio),this.gl.enable(WebGLRenderingContext.DEPTH_TEST),this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT),!e.renderConfig.visible)return;e.renderType===O.J.TILED&&this.renderTiledCanvas()}}renderTiledCanvas(){const e=O.e.Instance.activeFrame,t=Z.i.Instance;this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,t.vertexUVBuffer),this.gl.vertexAttribPointer(t.vertexUVAttribute,2,WebGLRenderingContext.FLOAT,!1,0,0),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,t.vertexPositionBuffer),this.gl.vertexAttribPointer(t.vertexPositionAttribute,3,WebGLRenderingContext.FLOAT,!1,0,0);const i={x:e.frameInfo.fileInfoExtended.width,y:e.frameInfo.fileInfoExtended.height},n={xMin:Math.max(0,e.requiredFrameView.xMin),xMax:Math.min(e.requiredFrameView.xMax,i.x),yMin:Math.max(0,e.requiredFrameView.yMin),yMax:Math.min(e.requiredFrameView.yMax,i.y),mip:e.requiredFrameView.mip};this.gl.activeTexture(WebGLRenderingContext.TEXTURE0);const r=Object(M.b)(n,i,{x:Z.g,y:Z.g});if(1===r.length&&0===r[0].layer){const e=Object(M.c)(0,i,{x:Z.g,y:Z.g});this.renderTiles(r,e,!1,3,!0)}else this.renderTiles(r,n.mip,!1,3,!0)}renderTiles(e,t,i=!1,n,r){const o=Z.h.Instance,a=O.e.Instance.activeFrame;if(!o)return;const s=new Map,l=[];for(const c of e){const e=Q.TileCoordinate.EncodeCoordinate(c),u=o.getTile(e,a.frameInfo.fileId,a.channel,a.stokes,i);if(u)this.renderTile(c,u,t);else if(n>0&&t>=2&&(l.push({layer:c.layer+1,x:2*c.x,y:2*c.y}),l.push({layer:c.layer+1,x:2*c.x+1,y:2*c.y}),l.push({layer:c.layer+1,x:2*c.x,y:2*c.y+1}),l.push({layer:c.layer+1,x:2*c.x+1,y:2*c.y+1})),c.layer>0&&r){const e={layer:c.layer-1,x:Math.floor(c.x/2),y:Math.floor(c.y/2)};s.set(Q.TileCoordinate.EncodeCoordinate(e),!0)}}if(n>0&&l.length&&this.renderTiles(l,t/2,!0,n-1,!1),r){const e=[];s.forEach((t,i)=>e.push(Q.TileCoordinate.Decode(i))),e.length&&this.renderTiles(e,2*t,!0,0,!0)}}renderTile(e,t,i){const n=O.e.Instance.activeFrame,r=Z.i.Instance,o=Z.h.Instance;if(!t)return;t.data&&(o.uploadTileToGPU(t),delete t.data);const a=o.getTileTextureParameters(t);a&&(this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,a.texture),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MIN_FILTER,M.a.NEAREST),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MAG_FILTER,M.a.NEAREST),this.gl.uniform2f(r.shaderUniforms.TileTextureOffset,a.offset.x,a.offset.y));const s=n.spatialReference||n,l=s.requiredFrameView,c=i*Z.g,u=e.x*c,p=e.y*c;e.x,e.y;let d={x:u-l.xMin-.5,y:p-l.yMin-.5},h=Object(M.cb)({x:1,y:1},i*s.zoomLevel);if(n.spatialReference&&n.spatialTransform){d=Object(M.f)(d,n.spatialTransform.translation);const e=Object(M.f)(n.spatialTransform.origin,n.spatialTransform.translation),t={x:s.zoomLevel*(e.x-l.xMin),y:s.zoomLevel*(e.y-l.yMin)};this.gl.uniform2f(r.shaderUniforms.RotationOrigin,t.x,t.y),this.gl.uniform1f(r.shaderUniforms.RotationAngle,-n.spatialTransform.rotation),this.gl.uniform1f(r.shaderUniforms.ScaleAdjustment,n.spatialTransform.scale)}else this.gl.uniform1f(r.shaderUniforms.RotationAngle,0),this.gl.uniform1f(r.shaderUniforms.ScaleAdjustment,1);d=Object(M.cb)(d,s.zoomLevel),this.gl.uniform2f(r.shaderUniforms.TileSize,t.width,t.height),this.gl.uniform2f(r.shaderUniforms.TileOffset,d.x,d.y),this.gl.uniform2f(r.shaderUniforms.TileScaling,h.x,h.y),this.gl.drawArrays(WebGLRenderingContext.TRIANGLE_STRIP,0,4)}render(){const e=O.e.Instance,t=e.activeFrame;if(t){const i=t.spatialReference||t;i.requiredFrameView,i.currentFrameView,t.renderType,t.renderConfig.scaleMinVal,t.renderConfig.scaleMaxVal,t.renderConfig.colorMapIndex,t.renderConfig.contrast,t.renderConfig.bias,t.renderConfig.scaling,t.renderConfig.gamma,t.renderConfig.alpha,t.renderConfig.inverted,t.renderConfig.visible,e.preferenceStore.nanColorHex,e.preferenceStore.nanAlpha}const i=e.overlayStore.padding;let n="raster-div";return this.props.docked&&(n+=" docked"),h.createElement("div",{className:n},h.createElement("canvas",{className:"raster-canvas",id:"raster-canvas",ref:e=>this.canvas=e,style:{top:i.top,left:i.left,width:t&&t.isRenderable&&t.renderWidth||1,height:t&&t.isRenderable&&t.renderHeight||1}}))}})||K;var J,ee,te,ie=i(5);i(934);let ne=Object(g.a)((te=ee=class e extends h.Component{constructor(...e){super(...e),this.handleZoomToActualSizeClicked=()=>{O.e.Instance.activeFrame.setZoom(1)},this.handleZoomInClicked=()=>{const e=O.e.Instance,t=e.activeFrame.spatialReference||e.activeFrame;t.setZoom(2*t.zoomLevel,!0)},this.handleZoomOutClicked=()=>{const e=O.e.Instance,t=e.activeFrame.spatialReference||e.activeFrame;t.setZoom(t.zoomLevel/2,!0)},this.handleRegionTypeClicked=e=>{const t=O.e.Instance;t.activeFrame.regionSet.setNewRegionType(e),t.activeFrame.regionSet.setMode(O.L.CREATING)},this.handleCoordinateSystemClicked=e=>{O.E.Instance.global.setSystem(e)},this.handelActiveLayerClicked=e=>{this.props.onActiveLayerChange(e),e===it.RegionMoving&&O.e.Instance.activeFrame.regionSet.setMode(O.L.MOVING)}}render(){const t=O.e.Instance,i=t.preferenceStore,n=t.overlayStore,r=t.activeFrame,o=n.grid;let a={bottom:n.padding.bottom,right:n.padding.right,opacity:this.props.visible?1:0},s="image-toolbar";t.darkTheme&&(s+=" bp3-dark"),this.props.docked&&(s+=" docked");const l=r.spatialReference&&r.spatialTransform?r.spatialReference.zoomLevel*r.spatialTransform.scale:r.zoomLevel,c=h.createElement("span",null,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Current: ",Object(M.kb)(l,2),"x"))),u=this.props.vertical?"left":"bottom",p=h.createElement(f.z,null,h.createElement(f.B,{icon:"symbol-square",text:"Point",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.POINT)}),h.createElement(f.B,{icon:"square",text:"Rectangle",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.RECTANGLE)}),h.createElement(f.B,{icon:"circle",text:"Ellipse",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.ELLIPSE)}),h.createElement(f.B,{icon:"polygon-filter",text:"Polygon",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.POLYGON)}));let d=n.global.system;const g=h.createElement(f.z,null,h.createElement(f.B,{text:e.CoordinateSystemName.get(O.R.Auto),onClick:()=>this.handleCoordinateSystemClicked(O.R.Auto)}),h.createElement(f.B,{text:e.CoordinateSystemName.get(O.R.FK5),onClick:()=>this.handleCoordinateSystemClicked(O.R.FK5)}),h.createElement(f.B,{text:e.CoordinateSystemName.get(O.R.FK4),onClick:()=>this.handleCoordinateSystemClicked(O.R.FK4)}),h.createElement(f.B,{text:e.CoordinateSystemName.get(O.R.Galactic),onClick:()=>this.handleCoordinateSystemClicked(O.R.Galactic)}),h.createElement(f.B,{text:e.CoordinateSystemName.get(O.R.Ecliptic),onClick:()=>this.handleCoordinateSystemClicked(O.R.Ecliptic)}),h.createElement(f.B,{text:e.CoordinateSystemName.get(O.R.ICRS),onClick:()=>this.handleCoordinateSystemClicked(O.R.ICRS)}));let m;switch(r.regionSet.newRegionType){case ie.a.RegionType.POINT:m="symbol-square";break;case ie.a.RegionType.RECTANGLE:m="square";break;case ie.a.RegionType.ELLIPSE:m="circle";break;case ie.a.RegionType.POLYGON:m="polygon-filter";break;default:m="error"}const b=!!r.spatialReference,S=!!r.spectralReference,C=t.spatialReference!==r,E=t.spectralReference&&t.spectralReference!==r&&r.frameInfo.fileInfoExtended.depth>1,I=(b?"x":"")+(S?"z":""),w=[];S&&w.push(`Spectral (${i.spectralMatchingType})`),b&&w.push("Spatial");const T=w.join(" and ")||"None",v=h.createElement(f.z,null,h.createElement(f.B,{text:`Spectral (${i.spectralMatchingType}) and Spatial`,disabled:!C||!E,active:S&&b,onClick:()=>t.setMatchingEnabled(!0,!0)}),h.createElement(f.B,{text:`Spectral (${i.spectralMatchingType})  only`,disabled:!E,active:S&&!b,onClick:()=>t.setMatchingEnabled(!1,!0)}),h.createElement(f.B,{text:"Spatial only",disabled:!C,active:!S&&b,onClick:()=>t.setMatchingEnabled(!0,!1)}),h.createElement(f.B,{text:"None",disabled:!C,active:!S&&!b,onClick:()=>t.setMatchingEnabled(!1,!1)})),A=t.activeLayer===it.Catalog,x=0===t.catalogNum;return h.createElement(f.f,{className:s,style:a,vertical:this.props.vertical},h.createElement(f.W,{position:u,content:h.createElement("span",null,"Catalog selection",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Click to select single catalog source")))},h.createElement(f.b,{icon:"locate",active:A,onClick:()=>this.handelActiveLayerClicked(it.Catalog),disabled:x})),r.regionSet.mode===O.L.CREATING&&h.createElement(f.W,{position:u,content:h.createElement("span",null,"Create region",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Click to select region type")))},h.createElement(f.F,{content:p,position:y.a.TOP,minimal:!0},h.createElement(f.b,{icon:m,active:!A,onClick:()=>this.handelActiveLayerClicked(it.RegionCreating)}))),r.regionSet.mode===O.L.MOVING&&h.createElement(f.W,{position:u,content:h.createElement("span",null,"Create region",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Double-click to select region type.",h.createElement("br",null),"Press C to enter creation mode.")))},h.createElement(f.b,{icon:m,onClick:()=>r.regionSet.setMode(O.L.CREATING)})),h.createElement(f.W,{position:u,content:"Select and pan mode"},h.createElement(f.b,{icon:"hand",onClick:()=>this.handelActiveLayerClicked(it.RegionMoving),active:r.regionSet.mode===O.L.MOVING&&!A})),h.createElement(f.W,{position:u,content:h.createElement("span",null,"Zoom in (Scroll wheel up)",c)},h.createElement(f.b,{icon:"zoom-in",onClick:this.handleZoomInClicked})),h.createElement(f.W,{position:u,content:h.createElement("span",null,"Zoom out (Scroll wheel down)",c)},h.createElement(f.b,{icon:"zoom-out",onClick:this.handleZoomOutClicked})),h.createElement(f.W,{position:u,content:h.createElement("span",null,"Zoom to 1.0x",c)},h.createElement(f.b,{className:"full-zoom-button",onClick:this.handleZoomToActualSizeClicked},"1.0x")),h.createElement(f.W,{position:u,content:h.createElement("span",null,"Zoom to fit",c)},h.createElement(f.b,{icon:"zoom-to-fit",onClick:r.fitZoom})),h.createElement(f.W,{position:u,content:h.createElement("span",null,"WCS Matching ",h.createElement("br",null),h.createElement("small",null,h.createElement("i",null,"Current: ",T)))},h.createElement(f.F,{content:v,position:y.a.TOP,minimal:!0},h.createElement(f.b,{icon:"link",className:"link-button"},I))),h.createElement(f.W,{position:u,content:h.createElement("span",null,"Overlay Coordinate ",h.createElement("br",null),h.createElement("small",null,h.createElement("i",null,"Current: ",e.CoordinateSystemTooltip.get(d))))},h.createElement(f.F,{content:g,position:y.a.TOP,minimal:!0},h.createElement(f.b,{disabled:!r.validWcs,text:e.CoordinateSystemName.get(d)}))),h.createElement(f.W,{position:u,content:"Toggle grid"},h.createElement(f.b,{icon:"grid",active:o.visible,onClick:()=>o.setVisible(!o.visible)})),h.createElement(f.W,{position:u,content:"Toggle labels"},h.createElement(f.b,{icon:"numerical",active:!n.labelsHidden,onClick:n.toggleLabels})),h.createElement(f.W,{position:u,content:`Export image (${t.modifierString}E)`},h.createElement(f.b,{icon:"floppy-disk",onClick:t.exportImage})))}},ee.CoordinateSystemName=new Map([[O.R.Auto,"WCS"],[O.R.FK5,"FK5"],[O.R.FK4,"FK4"],[O.R.Galactic,"GAL"],[O.R.Ecliptic,"ECL"],[O.R.ICRS,"ICRS"]]),ee.CoordinateSystemTooltip=new Map([[O.R.Auto,"Automatically select the coordinate system based on file headers"],[O.R.FK5,"FK5 coordinates, J2000.0 equinox"],[O.R.FK4,"FK4 coordinates, B1950.0 equinox"],[O.R.Galactic,"Galactic coordinates"],[O.R.Ecliptic,"Ecliptic coordinates"],[O.R.ICRS,"International Celestial Reference System"]]),J=te))||J;var re,oe=i(25),ae=i(76);i(935);let se=Object(g.a)(re=class extends h.Component{constructor(...e){super(...e),this.getPlotProps=(e,t)=>{if(!e.hasVisibleBeam)return null;const i=e.frameInfo.fileId,n=e.spatialReference?e.spatialReference.zoomLevel*e.spatialTransform.scale:e.zoomLevel,r=e.overlayBeamSettings,o=r.color,a=r.type===O.f.Solid?ae.a.WHITE:o,s=r.type,l=r.width,c=this.props.padding?this.props.padding*devicePixelRatio:0,u=r.shiftX,p=r.shiftY,d=e.beamProperties.x/2*n/devicePixelRatio,h=e.beamProperties.y/2*n/devicePixelRatio;let g=(90-e.beamProperties.angle)*Math.PI/180;e.spatialTransform&&(g-=e.spatialTransform.rotation);const m=Math.sin(g),f=Math.cos(g),y=2*Math.sqrt(d*d*f*f+h*h*m*m),b=2*Math.sqrt(d*d*m*m+h*h*f*f),S=e.renderWidth-y/2;let C=t?t.x:y/2+c+u;C>S&&(C=S);const E=b/2;let I=t?t.y:e.renderHeight-b/2-c-p;return I<E&&(I=E),{id:i,position:{x:C,y:I},a:d,b:h,theta:g,type:s,color:o,axisColor:a,strokeWidth:l}}}plotBeam(e){if(!e)return null;let t;switch(e.type){case O.f.Open:default:t=h.createElement(oe.Ellipse,{radiusX:e.a,radiusY:e.b,stroke:e.color,strokeWidth:e.strokeWidth});break;case O.f.Solid:t=h.createElement(oe.Ellipse,{radiusX:e.a,radiusY:e.b,fill:e.color,stroke:e.color,strokeWidth:e.strokeWidth})}return h.createElement(oe.Group,{x:e.position.x,y:e.position.y,rotation:180*e.theta/Math.PI,key:e.id},e.a>0&&e.b>0&&t,h.createElement(oe.Line,{points:[-e.a,0,e.a,0],stroke:e.axisColor,strokeWidth:e.strokeWidth}),h.createElement(oe.Line,{points:[0,-e.b,0,e.b],stroke:e.axisColor,strokeWidth:e.strokeWidth}))}render(){let e="beam-profile-stage";this.props.docked&&(e+=" docked");const t=O.e.Instance,i=t.activeFrame,n=t.contourFrames.filter(e=>e.frameInfo.fileId!==t.activeFrame.frameInfo.fileId&&e.hasVisibleBeam);if(!i.hasVisibleBeam&&!n.length)return null;let r;i.hasVisibleBeam&&(r=this.getPlotProps(i));const o=[];return n.forEach(e=>{const t=this.getPlotProps(e,r?r.position:null);o.push(this.plotBeam(t))}),h.createElement(oe.Stage,{className:e,width:i.renderWidth,height:i.renderHeight,style:{left:this.props.left,top:this.props.top}},h.createElement(oe.Layer,{listening:!1},this.plotBeam(r),o))}})||re;function le(e,t,i,n,r,o=null){let a={x:0,y:0};return o&&(a=Object(M.cb)(Object(M.ab)(a,o.rotation),o.scale)),{x:e/n*(i.xMax-i.xMin)+i.xMin-a.x,y:t/r*(i.yMin-i.yMax)+i.yMax-a.y}}function ce(e,t,i,n,r,o=null){const a=i.xMax-i.xMin,s=i.yMax-i.yMin;return{x:(e-i.xMin)/a*n,y:r-(t-i.yMin)/s*r}}function ue(e,t,i,n,r){let o=le(e,t,i.spatialReference?i.spatialReference.requiredFrameView:i.requiredFrameView,n,r,i.spatialTransform);return i.spatialReference&&(o=i.spatialTransform.transformCoordinate(o,!1)),o}function pe(e,t,i,n,r){let o={x:e,y:t};return i.spatialReference?(o=i.spatialTransform.transformCoordinate(o,!0),ce(o.x,o.y,i.spatialReference.requiredFrameView,n,r,i.spatialTransform)):ce(o.x,o.y,i.requiredFrameView,n,r,i.spatialTransform)}var de,he,ge,me,fe;let ye=Object(g.a)((fe=me=class e extends h.Component{constructor(...t){super(...t),this.editAnchor=void 0,this.editOppositeAnchorPoint=void 0,this.editStartCenterPoint=void 0,this.previousCursorStyle=void 0,this.handleContextMenu=e=>{e.evt.preventDefault(),console.log("context click!")},this.handleDoubleClick=()=>{this.props.onDoubleClick&&this.props.onDoubleClick(this.props.region)},this.handleClick=e=>{const t=e.evt;0!==t.button||t.ctrlKey||t.metaKey||this.props.onSelect&&this.props.onSelect(this.props.region)},this.startEditing=e=>{this.editAnchor=e;const t=this.props.region;let i,n;this.props.region.regionType===ie.a.RegionType.RECTANGLE?(i=t.size.x,n=t.size.y):(i=t.size.y,n=t.size.x),this.editStartCenterPoint={x:t.center.x,y:t.center.y};const r={x:0,y:0},o=this.props.region.regionType===ie.a.RegionType.RECTANGLE?.5:1;this.editAnchor.includes("left")?r.x=+i*o:this.editAnchor.includes("right")&&(r.x=-i*o),this.editAnchor.includes("top")?r.y=-n*o:this.editAnchor.includes("bottom")&&(r.y=+n*o);const a=Object(M.ab)(r,this.props.region.rotation*Math.PI/180);this.editOppositeAnchorPoint=Object(M.f)(this.editStartCenterPoint,a),this.props.region.beginEditing()},this.handleAnchorDragEnd=()=>{this.props.region.endEditing()},this.applyCornerScaling=(e,t,i,n)=>{const r=this.props.frame;let o,a,s,l=ue(t,i,r,this.props.layerWidth,this.props.layerHeight);r.spatialReference&&(l=Object(M.lb)(r.spatialTransformAST,l,!0)),e.regionType===ie.a.RegionType.RECTANGLE?(s=1,o=e.size.x,a=e.size.y):(s=.5,o=e.size.y,a=e.size.x);let c=Object(M.ib)(l,this.editOppositeAnchorPoint);const u=Object(M.ab)(c,-e.rotation*Math.PI/180);n.includes("left")||n.includes("right")?o=Math.abs(u.x)*s:u.x=0,n.includes("top")||n.includes("bottom")?a=Math.abs(u.y)*s:u.y=0,c=Object(M.ab)(u,e.rotation*Math.PI/180);const p=Object(M.f)(this.editOppositeAnchorPoint,Object(M.cb)(c,.5));e.regionType===ie.a.RegionType.RECTANGLE?e.setControlPoints([p,{x:Math.max(.001,o),y:Math.max(.001,a)}]):e.setControlPoints([p,{y:Math.max(.001,o),x:Math.max(.001,a)}])},this.applyCenterScaling=(e,t,i,n,r)=>{const o=this.props.frame;let a=ue(t,i,o,this.props.layerWidth,this.props.layerHeight);o.spatialReference&&(a=Object(M.lb)(o.spatialTransformAST,a,!0));const s=e.center;let l,c,u;e.regionType===ie.a.RegionType.RECTANGLE?(u=2,l=e.size.x,c=e.size.y):(u=1,l=e.size.y,c=e.size.x);let p=Object(M.ib)(a,s);const d=Object(M.ab)(p,-e.rotation*Math.PI/180);if((n.includes("left")||n.includes("right"))&&(l=Math.abs(d.x)*u),(n.includes("top")||n.includes("bottom"))&&(c=Math.abs(d.y)*u),r){const e=Math.max(l,c);l=e,c=e}e.regionType===ie.a.RegionType.RECTANGLE?e.setControlPoints([this.editStartCenterPoint,{x:Math.max(.001,l),y:Math.max(.001,c)}]):e.setControlPoints([this.editStartCenterPoint,{y:Math.max(.001,l),x:Math.max(.001,c)}])},this.handleDragStart=()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing()},this.handleDragEnd=()=>{this.props.region.endEditing()},this.handleDrag=e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame;let r=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(r=Object(M.lb)(n.spatialTransformAST,r,!0)),i.setCenter(r)}},this.handleAnchorMouseEnter=t=>{const i=t.target,n=null===i||void 0===i?void 0:i.getStage();n&&(this.previousCursorStyle=n.container().style.cursor,n.container().style.cursor=e.GetCursor(i.id(),this.props.region.rotation))},this.handleAnchorMouseOut=e=>{e.target&&e.target.getStage()&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)},this.handleAnchorDragStart=e=>{if(e.target){const t=e.target.id();this.startEditing(t)}},Object(p.a)(this,"handleAnchorDrag",ge,this)}static GetCursor(e,t){let i;switch(e){case"rotator":return"all-scroll";case"top":case"bottom":i=0;break;case"left":case"right":i=90;break;case"top-left":case"bottom-right":i=45;break;default:i=135}for(i+=t,i=45*Math.round(i/45);i<0;)i+=180;for(;i>=180;)i-=180;switch(i){case 45:return"nwse-resize";case 90:return"ew-resize";case 135:return"nesw-resize";default:return"ns-resize"}}anchorNode(t,i,n,r=0){const o={x:t,y:i,rotation:r,fill:"white",strokeWidth:1,stroke:"black",draggable:!0,key:n,id:n,onMouseEnter:this.handleAnchorMouseEnter,onMouseOut:this.handleAnchorMouseOut,onDragStart:this.handleAnchorDragStart,onDragEnd:this.handleAnchorDragEnd,onDragMove:this.handleAnchorDrag};if("rotator"===n)return h.createElement(oe.Circle,Object.assign({},o,{radius:e.AnchorWidth/Math.sqrt(2)}));const a=e.AnchorWidth/2;return h.createElement(oe.Rect,Object.assign({},o,{offsetX:a,offsetY:a,width:2*a,height:2*a}))}render(){const e=this.props.region,t=this.props.frame;let i;const n=e.center;if(t.spatialReference){const r=Object(M.lb)(t.spatialTransformAST,n,!1),o=pe(r.x,r.y,t,this.props.layerWidth,this.props.layerHeight),a=e.getRegionApproximation(t.spatialTransformAST),s=a.length,l=new Array(2*s);for(let e=0;e<s;e++){const i=pe(a[e].x,a[e].y,t,this.props.layerWidth,this.props.layerHeight);l[2*e]=i.x-o.x,l[2*e+1]=i.y-o.y}i=h.createElement(oe.Line,{x:o.x,y:o.y,stroke:e.color,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],closed:!0,listening:this.props.listening&&!e.locked,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,perfectDrawEnabled:!1,lineJoin:"round",draggable:!0,points:l})}else{const r=e.rotation,o=t.zoomLevel,a=pe(n.x,n.y,t,this.props.layerWidth,this.props.layerHeight);let s=e.size.x*o/devicePixelRatio,l=e.size.y*o/devicePixelRatio;const c={rotation:-r,x:a.x,y:a.y,stroke:e.color,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],draggable:!0,listening:this.props.listening&&!e.locked,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,perfectDrawEnabled:!1};i=e.regionType===ie.a.RegionType.RECTANGLE?h.createElement(oe.Rect,Object.assign({},c,{width:s,height:l,offsetX:s/2,offsetY:l/2})):h.createElement(oe.Ellipse,Object.assign({},c,{radiusY:s,radiusX:l}))}let r;if(this.props.selected&&this.props.listening&&!e.locked){var o;let i,a;e.regionType===ie.a.RegionType.RECTANGLE?(i=e.size.x/2,a=e.size.y/2):(i=e.size.y,a=e.size.x);r=[{anchor:"rotator",offset:{x:0,y:a+15/(null!==(o=t.spatialReference)&&void 0!==o?o:t).zoomLevel*devicePixelRatio}},{anchor:"top",offset:{x:0,y:a}},{anchor:"bottom",offset:{x:0,y:-a}},{anchor:"left",offset:{x:-i,y:0}},{anchor:"right",offset:{x:i,y:0}},{anchor:"top-left",offset:{x:-i,y:a}},{anchor:"bottom-left",offset:{x:-i,y:-a}},{anchor:"top-right",offset:{x:i,y:a}},{anchor:"bottom-right",offset:{x:i,y:-a}}].map(i=>{let r=Object(M.f)(n,Object(M.ab)(i.offset,e.rotation*Math.PI/180));t.spatialReference&&(r=Object(M.lb)(t.spatialTransformAST,r,!1));const o=pe(r.x,r.y,t,this.props.layerWidth,this.props.layerHeight);return this.anchorNode(o.x,o.y,i.anchor,-e.rotation)})}return h.createElement(oe.Group,null,i,r)}},me.AnchorWidth=7,he=fe,ge=Object(d.a)(he.prototype,"handleAnchorDrag",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.currentTarget){const t=e.target.id(),i=this.props.region,n=this.props.frame,r=e.evt,o={x:r.offsetX,y:r.offsetY};if(t.includes("rotator")){let e=ue(o.x,o.y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Object(M.lb)(n.spatialTransformAST,e,!0));const t=Object(M.ib)(e,i.center),r=Object(M.ab)({x:0,y:1},i.rotation*Math.PI/180),a=180/Math.PI*Object(M.g)(r,t);i.setRotation(i.rotation+a)}else{const e=r.ctrlKey||r.metaKey;this.props.isRegionCornerMode&&!e||!this.props.isRegionCornerMode&&e?this.applyCornerScaling(i,r.offsetX,r.offsetY,t):this.applyCenterScaling(i,r.offsetX,r.offsetY,t,r.shiftKey)}}}}}),de=he))||de;var be,Oe,Se,Ce,Ee,Ie,we,Te,ve,Ae,xe,Re;const Pe=ae.a.ROSE4;let je=Object(g.a)((Oe=class extends h.Component{constructor(e){super(e),Object(p.a)(this,"hoverIndex",Se,this),Object(p.a)(this,"hoverIntersection",Ce,this),this.previousCursorStyle=void 0,this.handleContextMenu=e=>{e.evt.preventDefault(),console.log("context click!")},this.handleDoubleClick=()=>{this.props.onDoubleClick&&this.props.onDoubleClick(this.props.region)},Object(p.a)(this,"handleClick",Ee,this),this.handleAnchorDragStart=()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing()},this.handleAnchorDragEnd=()=>{this.props.region.endEditing()},Object(p.a)(this,"handleAnchorDrag",Ie,this),this.handleAnchorDoubleClick=e=>{const t=e.target;if(t){const e=t.index,i=this.props.region;if(e>=0&&e<i.controlPoints.length&&i.controlPoints.length>=4){const t=i.controlPoints.slice(0);t.splice(e,1),i.setControlPoints(t)}}},Object(p.a)(this,"handleStrokeMouseEnter",we,this),Object(p.a)(this,"handleStrokeMouseLeave",Te,this),Object(p.a)(this,"handleMouseMove",ve,this),this.handleAnchorMouseEnter=e=>{e.target&&e.target.getStage()&&(this.previousCursorStyle=e.target.getStage().container().style.cursor,e.target.getStage().container().style.cursor="move")},this.handleAnchorMouseOut=e=>{e.target&&e.target.getStage()&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)},Object(p.a)(this,"handleDragStart",Ae,this),Object(p.a)(this,"handleDragEnd",xe,this),Object(p.a)(this,"handleDrag",Re,this),Object(m.p)(this)}getCanvasPointArray(e){if(!e||!e.length)return null;const t=this.props.frame,i=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView,n=i.xMax-i.xMin,r=i.yMax-i.yMin;let o={x:1,y:1};t.spatialReference&&(o=Object(M.cb)(Object(M.ab)(o,t.spatialTransform.rotation),t.spatialTransform.scale));const a=new Array(2*e.length);for(let s=0;s<e.length;s++){const t=(e[s].x+o.x-i.xMin)/n*this.props.layerWidth,l=this.props.layerHeight-(e[s].y+o.y-i.yMin)/r*this.props.layerHeight;a[2*s]=t,a[2*s+1]=l}return a}anchorNode(e,t,i=0,n,r=!1){let o={x:e,y:t,offsetX:3.5,offsetY:3.5,width:7,height:7,fill:"white",strokeWidth:1,stroke:"black",rotation:i};return r?o={...o,draggable:!0,key:n,onMouseEnter:this.handleAnchorMouseEnter,onMouseOut:this.handleAnchorMouseOut,onDragStart:this.handleAnchorDragStart,onDragEnd:this.handleAnchorDragEnd,onDragMove:this.handleAnchorDrag,onDblClick:this.handleAnchorDoubleClick}:(o.opacity=.5,o.listening=!1),h.createElement(oe.Rect,o)}render(){const e=this.props.region,t=this.props.frame,i=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView;let n,r,o=0,a=e.controlPoints,s=null,l=null;if(t.spatialReference){const i=Object(M.h)(a),c=Object(M.lb)(t.spatialTransformAST,i,!1);n=pe(c.x,c.y,t,this.props.layerWidth,this.props.layerHeight);const u=e.getRegionApproximation(t.spatialTransformAST),p=u.length;r=new Array(2*p);for(let e=0;e<p;e++){const i=pe(u[e].x,u[e].y,t,this.props.layerWidth,this.props.layerHeight);r[2*e]=i.x-n.x,r[2*e+1]=i.y-n.y}if(this.props.selected&&!e.locked&&(s=a.map((e,i)=>{const n=Object(M.lb)(t.spatialTransformAST,e,!1),r=pe(n.x,n.y,t,this.props.layerWidth,this.props.layerHeight);return this.anchorNode(r.x,r.y,o,i,!0)})),this.hoverIntersection&&!e.locked){const e=Object(M.lb)(t.spatialTransformAST,this.hoverIntersection,!1),i=pe(e.x,e.y,t,this.props.layerWidth,this.props.layerHeight);l=this.anchorNode(i.x,i.y,o)}o=180*-t.spatialTransform.rotation/Math.PI}else{if(o=0,a=a.map(e=>ce(e.x,e.y,i,this.props.layerWidth,this.props.layerHeight,t.spatialTransform)),n=Object(M.h)(a),this.props.selected&&!e.locked){s=new Array(a.length);for(let e=0;e<a.length;e++)s[e]=this.anchorNode(a[e].x,a[e].y,o,e,!0)}if(this.hoverIntersection&&!e.locked){const e=pe(this.hoverIntersection.x,this.hoverIntersection.y,t,this.props.layerWidth,this.props.layerHeight);l=this.anchorNode(e.x,e.y,o)}r=new Array(2*a.length);for(let e=0;e<r.length/2;e++)r[2*e]=a[e].x-n.x,r[2*e+1]=a[e].y-n.y}return h.createElement(oe.Group,null,h.createElement(oe.Line,{x:n.x,y:n.y,stroke:e.isSimplePolygon?e.color:Pe,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],closed:!e.creating,listening:this.props.listening&&!e.locked,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onMouseEnter:this.handleStrokeMouseEnter,onMouseLeave:this.handleStrokeMouseLeave,onMouseMove:this.handleMouseMove,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,perfectDrawEnabled:!1,lineJoin:"round",draggable:!0,points:r,hitStrokeWidth:32}),h.createElement(oe.Group,null,s,l))}},Se=Object(d.a)(Oe.prototype,"hoverIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=Object(d.a)(Oe.prototype,"hoverIntersection",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ee=Object(d.a)(Oe.prototype,"handleClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.evt;if(0===t.button&&!t.ctrlKey&&!t.metaKey){const e=this.props.region;if(this.props.onSelect&&this.props.onSelect(e),this.hoverIntersection&&this.hoverIndex>=0&&this.hoverIndex<e.controlPoints.length){const t=e.controlPoints.slice(0);t.splice(this.hoverIndex+1,0,this.hoverIntersection),e.setControlPoints(t,!0,!1),this.hoverIntersection=null}}}}}),Ie=Object(d.a)(Oe.prototype,"handleAnchorDrag",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame,r=t.index;if(r>=0&&r<i.controlPoints.length){let e=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Object(M.lb)(n.spatialTransformAST,e,!0)),i.setControlPoint(r,e),this.hoverIntersection=null}}}}}),we=Object(d.a)(Oe.prototype,"handleStrokeMouseEnter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.handleMouseMove(e)}}}),Te=Object(d.a)(Oe.prototype,"handleStrokeMouseLeave",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hoverIntersection=null}}}),ve=Object(d.a)(Oe.prototype,"handleMouseMove",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.evt,i=this.props.region,n=this.props.frame;if(this.props.selected&&i.controlPoints.length>=2){let e=ue(t.offsetX,t.offsetY,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Object(M.lb)(n.spatialTransformAST,e,!0));let r=Number.MAX_VALUE,o=-1,a=null;for(let t=0;t<i.controlPoints.length;t++){const n=Object(M.n)(e,i.controlPoints[t],i.controlPoints[(t+1)%i.controlPoints.length]);n.bounded&&n.distance<r&&(r=n.distance,a=n.point,o=t)}o>=0&&r<=16?(this.hoverIntersection=a,this.hoverIndex=o):this.hoverIntersection=null}}}}),Ae=Object(d.a)(Oe.prototype,"handleDragStart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing(),this.hoverIntersection=null}}}),xe=Object(d.a)(Oe.prototype,"handleDragEnd",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.props.region.endEditing()}}}),Re=Object(d.a)(Oe.prototype,"handleDrag",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame,r=Object(M.h)(i.controlPoints);let o=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(o=Object(M.lb)(n.spatialTransformAST,o,!0));const a=Object(M.ib)(o,r),s=i.controlPoints.map(e=>Object(M.f)(e,a));i.setControlPoints(s,!1,!1)}}}}),be=Oe))||be;var ke;let Fe=Object(g.a)(ke=class extends h.Component{constructor(...e){super(...e),this.handleDoubleClick=()=>{this.props.onDoubleClick&&this.props.onDoubleClick(this.props.region)},this.handleClick=e=>{const t=e.evt;0!==t.button||t.ctrlKey||t.metaKey||this.props.onSelect&&this.props.onSelect(this.props.region)},this.handleDragStart=()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing()},this.handleDragEnd=()=>{this.props.region.endEditing()},this.handleDrag=e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame;let r=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(r=Object(M.lb)(n.spatialTransformAST,r,!0)),i.setCenter(r)}}}render(){const e=this.props.region,t=this.props.frame;let i,n;if(t.spatialReference){const r=e.center,o=Object(M.lb)(t.spatialTransformAST,r,!1);i=pe(o.x,o.y,t,this.props.layerWidth,this.props.layerHeight),n=180*-t.spatialTransform.rotation/Math.PI}else i=pe(e.center.x,e.center.y,t,this.props.layerWidth,this.props.layerHeight),n=0;return h.createElement(oe.Group,null,h.createElement(oe.Rect,{rotation:n,x:i.x,y:i.y,width:6,height:6,offsetX:3,offsetY:3,fill:e.color}),h.createElement(oe.Rect,{rotation:n,x:i.x,y:i.y,width:13,stroke:"white",strokeWidth:1,height:13,offsetX:6.5,offsetY:6.5,opacity:this.props.selected?1:0,draggable:!0,listening:!e.locked,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,onClick:this.handleClick,onDblClick:this.handleDoubleClick}))}})||ke;var Me,De,Ne,Le,_e,ze,We,Ge,Ve;i(936);let Be=Object(g.a)((De=class extends h.Component{constructor(e){super(e),Object(p.a)(this,"creatingRegion",Ne,this),Object(p.a)(this,"currentCursorPos",Le,this),this.regionStartPoint=void 0,this.mousePreviousClick={x:-1e3,y:-1e3},this.mouseClickDistance=0,this.dragPanning=void 0,this.dragOffset=void 0,this.initialDragPointCanvasSpace=void 0,this.initialDragCenter=void 0,this.initialPinchZoom=void 0,this.initialPinchDistance=void 0,this.updateCursorPos=H.throttle((e,t)=>{const i=this.props.frame;if(i.wcsInfo){const n=ue(e,t,i,this.props.width,this.props.height);this.props.frame.setCursorPosition(n)}},100),Object(p.a)(this,"regionCreationStart",_e,this),this.regionCreationEnd=e=>{this.dragPanning=!1;switch(this.props.frame.regionSet.newRegionType){case ie.a.RegionType.RECTANGLE:case ie.a.RegionType.ELLIPSE:case ie.a.RegionType.POINT:this.handleMouseUpRegularRegion();break;case ie.a.RegionType.POLYGON:this.handleMouseUpPolygonRegion(e.evt)}},this.handleDragStart=e=>{if(e.target===e.currentTarget&&this.props.dragPanningEnabled){this.dragPanning=!0;let t=e.target.getStage().getPointerPosition();if(this.props.frame){const e=this.props.frame.spatialReference||this.props.frame;this.initialDragPointCanvasSpace=t,this.initialDragCenter=e.center,e.startMoving()}}},this.handleDragMove=e=>{if(e.target===e.currentTarget){let t=e.target.getStage().getPointerPosition(),i=!0;if("touchmove"===e.evt.type){const t=e.evt;if(t.touches.length>1&&t.target){i=!1;const e=t.target.getBoundingClientRect(),n={x:t.touches[0].pageX-e.left,y:t.touches[0].pageY-e.top},r={x:t.touches[1].pageX-e.left,y:t.touches[1].pageY-e.top};this.handlePinch(n,r)}else this.initialPinchDistance=-1,this.initialPinchZoom=-1}i&&this.handlePan(t),e.target.x(0),e.target.y(0)}},this.handleDragEnd=e=>{if(e.target===e.currentTarget){this.dragPanning=!1,this.dragOffset=null;const e=this.props.frame;e&&e.endMoving()}this.initialPinchDistance=-1,this.initialPinchZoom=-1},this.handlePinch=(e,t)=>{const i=this.props.frame;if(!i||!e||!t)return;const n=Object(M.ib)(t,e),r=Object(M.N)(n),o=Object(M.h)([e,t]);if(isFinite(r)&&!(r<=0))if(this.initialPinchDistance>0){const e=r/this.initialPinchDistance,t=le(o.x,o.y,i.requiredFrameView,this.props.width,this.props.height);i.zoomToPoint(t.x,t.y,this.initialPinchZoom*e)}else this.initialPinchDistance=r,this.initialPinchZoom=i.zoomLevel},this.handlePan=e=>{if(e&&isFinite(e.x)&&isFinite(e.y)&&this.props.frame){const t=this.props.frame.spatialReference||this.props.frame;if(this.dragOffset){this.dragOffset=Object(M.ib)(e,this.initialDragPointCanvasSpace);const i=ce(this.initialDragCenter.x,this.initialDragCenter.y,t.requiredFrameView,this.props.width,this.props.height),n=Object(M.ib)(i,this.dragOffset),r=le(n.x,n.y,t.requiredFrameView,this.props.width,this.props.height);t.setCenter(r.x,r.y)}else this.dragOffset={x:0,y:0}}},Object(p.a)(this,"handleMouseUpPolygonRegion",ze,this),this.handleClick=e=>{const t=e.evt,i=this.props.frame,n=0!==t.button||t.ctrlKey||t.metaKey;if(this.mouseClickDistance=Object(M.X)(t,this.mousePreviousClick),this.mousePreviousClick={x:t.x,y:t.y},(e.target===e.currentTarget||n)&&(this.props.frame.regionSet.mode!==O.L.CREATING||0!==t.button)&&(this.props.dragPanningEnabled&&!n&&this.props.frame.regionSet.deselectRegion(),this.props.frame.wcsInfo&&this.props.onClicked&&(!this.props.dragPanningEnabled||n))){const e=ue(t.offsetX,t.offsetY,i,this.props.width,this.props.height);this.props.onClicked(this.props.frame.getCursorInfo(e))}},this.handleWheel=e=>{const t=e.evt,i=this.props.frame,n=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:15*t.deltaY;if(this.props.frame.wcsInfo&&this.props.onZoomed){const e=ue(t.offsetX,t.offsetY,i,this.props.width,this.props.height);this.props.onZoomed(this.props.frame.getCursorInfo(e),-n)}},this.handleMove=e=>{const t=e.evt;if(this.props.dragPanningEnabled&&this.dragPanning)return;if(this.props.frame.regionSet.mode===O.L.CREATING&&this.creatingRegion)switch(this.creatingRegion.regionType){case ie.a.RegionType.RECTANGLE:case ie.a.RegionType.ELLIPSE:this.handleRegularRegionMouseMove(t);break;case ie.a.RegionType.POLYGON:this.handlePolygonRegionMouseMove(t)}else this.props.cursorFrozen||this.updateCursorPos(t.offsetX,t.offsetY)},Object(p.a)(this,"handlePolygonRegionMouseMove",We,this),this.handleRegionDoubleClick=e=>{this.props.onRegionDoubleClicked&&this.props.onRegionDoubleClicked(e)},Object(p.a)(this,"handleStageDoubleClick",Ge,this),Object(p.a)(this,"onKeyDown",Ve,this),Object(m.p)(this)}getCursorCanvasPos(e,t){const i=pe(e,t,this.props.frame,this.props.width,this.props.height),n=this.props.width,r=this.props.height;return i.x<0||i.x>n||i.y<0||i.y>r?null:i}handleMouseUpRegularRegion(){const e=this.props.frame.spatialReference||this.props.frame;if(this.creatingRegion){if(this.creatingRegion.controlPoints.length>1&&0===Object(M.N)(this.creatingRegion.size)){const t=O.H.Instance.regionSize*(this.creatingRegion.regionType===ie.a.RegionType.RECTANGLE?1:.5)/e.zoomLevel;this.creatingRegion.setSize(Object(M.cb)({x:1,y:1},t))}this.creatingRegion.isValid?(this.creatingRegion.endCreating(),e.regionSet.selectRegion(this.creatingRegion)):e.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null}setTimeout(()=>this.props.frame.regionSet.setMode(O.L.MOVING),1)}handleRegularRegionMouseMove(e){const t=this.props.frame;let i=ue(e.offsetX,e.offsetY,t,this.props.width,this.props.height);t.spatialReference&&(i=Object(M.lb)(t.spatialTransformAST,i,!0));let n=i.x-this.regionStartPoint.x,r=i.y-this.regionStartPoint.y;if(e.shiftKey){const e=Math.max(Math.abs(n),Math.abs(r));n=Math.sign(n)*e,r=Math.sign(r)*e}const o=e.ctrlKey||e.metaKey;if(this.props.isRegionCornerMode&&!o||!this.props.isRegionCornerMode&&o){const e={x:this.regionStartPoint.x+n,y:this.regionStartPoint.y+r},t={x:(this.regionStartPoint.x+e.x)/2,y:(this.regionStartPoint.y+e.y)/2};switch(this.creatingRegion.regionType){case ie.a.RegionType.RECTANGLE:this.creatingRegion.setControlPoints([t,{x:Math.abs(n),y:Math.abs(r)}]);break;case ie.a.RegionType.ELLIPSE:this.creatingRegion.setControlPoints([t,{y:Math.abs(n)/2,x:Math.abs(r)/2}])}}else switch(this.creatingRegion.regionType){case ie.a.RegionType.RECTANGLE:this.creatingRegion.setControlPoints([this.regionStartPoint,{x:2*Math.abs(n),y:2*Math.abs(r)}]);break;case ie.a.RegionType.ELLIPSE:this.creatingRegion.setControlPoints([this.regionStartPoint,{y:Math.abs(n),x:Math.abs(r)}])}}render(){const e=this.props.frame,t=e.regionSet;let i="region-stage";this.props.docked&&(i+=" docked");let n=null;t&&t.regions.length&&(n=t.regions.filter(e=>e.isValid&&0!==e.regionId).sort((e,t)=>e.boundingBoxArea>t.boundingBoxArea?-1:1).map(i=>i.regionType===ie.a.RegionType.POLYGON?h.createElement(je,{key:i.regionId,region:i,frame:e,layerWidth:this.props.width,layerHeight:this.props.height,selected:i===t.selectedRegion,onSelect:t.selectRegion,onDoubleClick:this.handleRegionDoubleClick,listening:t.mode!==O.L.CREATING}):i.regionType===ie.a.RegionType.POINT?h.createElement(Fe,{key:i.regionId,region:i,frame:e,layerWidth:this.props.width,layerHeight:this.props.height,selected:i===t.selectedRegion,onSelect:t.selectRegion,onDoubleClick:this.handleRegionDoubleClick}):h.createElement(ye,{key:i.regionId,region:i,frame:e,layerWidth:this.props.width,layerHeight:this.props.height,selected:i===t.selectedRegion,onSelect:t.selectRegion,onDoubleClick:this.handleRegionDoubleClick,listening:t.mode!==O.L.CREATING,isRegionCornerMode:this.props.isRegionCornerMode})));let r=null;if(this.props.cursorFrozen&&this.props.cursorPoint){const t=this.getCursorCanvasPos(this.props.cursorPoint.x,this.props.cursorPoint.y),i=e.spatialReference?180*e.spatialTransform.rotation/Math.PI:0;if(t){const e=20,n=3,o=1,a=7;r=h.createElement(oe.Group,{x:Math.floor(t.x)+.5,y:Math.floor(t.y)+.5,rotation:-i},h.createElement(oe.Line,{listening:!1,points:[-e/2-n/2,0,-a/2,0],strokeWidth:n,stroke:"black"}),h.createElement(oe.Line,{listening:!1,points:[a/2,0,e/2+n/2,0],strokeWidth:n,stroke:"black"}),h.createElement(oe.Line,{listening:!1,points:[0,-e/2-n/2,0,-a/2],strokeWidth:n,stroke:"black"}),h.createElement(oe.Line,{listening:!1,points:[0,a/2,0,e/2+n/2],strokeWidth:n,stroke:"black"}),h.createElement(oe.Rect,{listening:!1,width:a-1,height:a-1,offsetX:a/2-.5,offsetY:a/2-.5,strokeWidth:1,stroke:"black"}),h.createElement(oe.Line,{listening:!1,points:[-e/2-o/2,0,-a/2,0],strokeWidth:o,stroke:"white"}),h.createElement(oe.Line,{listening:!1,points:[a/2,0,e/2+o/2,0],strokeWidth:o,stroke:"white"}),h.createElement(oe.Line,{listening:!1,points:[0,-e/2-o/2,0,-a/2],strokeWidth:o,stroke:"white"}),h.createElement(oe.Line,{listening:!1,points:[0,a/2,0,e/2+o/2],strokeWidth:o,stroke:"white"}))}}let o,a=null;if(this.currentCursorPos&&this.creatingRegion&&this.creatingRegion.regionType===ie.a.RegionType.POLYGON&&this.creatingRegion.isValid){let t=this.creatingRegion.center,i=this.creatingRegion.controlPoints[this.creatingRegion.controlPoints.length-1];e.spatialReference&&(t=Object(M.lb)(e.spatialTransformAST,t,!1),i=Object(M.lb)(e.spatialTransformAST,i,!1));const n=this.getCursorCanvasPos(t.x,t.y),r=this.getCursorCanvasPos(i.x,i.y);let o;o=this.creatingRegion.controlPoints.length>1?[n.x,n.y,this.currentCursorPos.x,this.currentCursorPos.y,r.x,r.y]:[n.x,n.y,this.currentCursorPos.x,this.currentCursorPos.y],a=h.createElement(oe.Line,{points:o,dash:[5],stroke:this.creatingRegion.color,strokeWidth:this.creatingRegion.lineWidth,opacity:.5,lineJoin:"round",listening:!1,perfectDrawEnabled:!1})}return e.regionSet.mode===O.L.CREATING?o="crosshair":e.regionSet.selectedRegion&&e.regionSet.selectedRegion.editing&&(o="move"),h.createElement("div",{onKeyDown:this.onKeyDown,tabIndex:0},h.createElement(oe.Stage,{className:i,width:this.props.width,height:this.props.height,style:{left:this.props.left,top:this.props.top,cursor:o},onClick:this.handleClick,onWheel:this.handleWheel,onMouseMove:this.handleMove,onDblClick:this.handleStageDoubleClick,onMouseDown:t.mode===O.L.CREATING?this.regionCreationStart:null,onMouseUp:t.mode===O.L.CREATING?this.regionCreationEnd:null,draggable:t.mode!==O.L.CREATING&&this.props.dragPanningEnabled,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd,x:0,y:0},h.createElement(oe.Layer,null,n,a,r)))}},Ne=Object(d.a)(De.prototype,"creatingRegion",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Object(d.a)(De.prototype,"currentCursorPos",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(d.a)(De.prototype,"regionCreationStart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.creatingRegion)return;const t=e.evt,i=this.props.frame,n=i.regionSet.newRegionType;let r=ue(t.offsetX,t.offsetY,i,this.props.width,this.props.height);switch(i.spatialReference&&(r=Object(M.lb)(i.spatialTransformAST,r,!0)),n){case ie.a.RegionType.POINT:this.creatingRegion=i.regionSet.addPointRegion(r,!1);break;case ie.a.RegionType.RECTANGLE:this.creatingRegion=i.regionSet.addRectangularRegion(r,0,0,!0);break;case ie.a.RegionType.ELLIPSE:this.creatingRegion=i.regionSet.addEllipticalRegion(r,0,0,!0);break;default:return}this.regionStartPoint=r,this.creatingRegion.beginCreating()}}}),Object(d.a)(De.prototype,"handleMouseUpRegularRegion",[m.g],Object.getOwnPropertyDescriptor(De.prototype,"handleMouseUpRegularRegion"),De.prototype),ze=Object(d.a)(De.prototype,"handleMouseUpPolygonRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;let i=ue(e.offsetX,e.offsetY,t,this.props.width,this.props.height);if(t.spatialReference&&(i=Object(M.lb)(t.spatialTransformAST,i,!0)),this.creatingRegion&&this.creatingRegion.regionType===ie.a.RegionType.POLYGON){if(this.creatingRegion.controlPoints.length){const e=this.creatingRegion.controlPoints[this.creatingRegion.controlPoints.length-1];(Math.abs(e.x-i.x)>.01||Math.abs(e.y-i.y)>.01)&&this.creatingRegion.setControlPoints([...this.creatingRegion.controlPoints,i])}}else this.creatingRegion=t.regionSet.addPolygonalRegion([i],!0),this.creatingRegion.beginCreating();this.handlePolygonRegionMouseMove(e)}}}),We=Object(d.a)(De.prototype,"handlePolygonRegionMouseMove",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.currentCursorPos={x:e.offsetX,y:e.offsetY}}}}),Ge=Object(d.a)(De.prototype,"handleStageDoubleClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;this.mouseClickDistance>25||t.regionSet.mode===O.L.CREATING&&this.creatingRegion&&this.creatingRegion.regionType===ie.a.RegionType.POLYGON&&(this.creatingRegion.isValid&&this.creatingRegion.controlPoints.length>2?(this.creatingRegion.endCreating(),t.regionSet.selectRegion(this.creatingRegion),this.creatingRegion=null):(t.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null),setTimeout(()=>this.props.frame.regionSet.setMode(O.L.MOVING),1))}}}),Ve=Object(d.a)(De.prototype,"onKeyDown",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;t&&t.regionSet.mode===O.L.CREATING&&this.creatingRegion&&27===e.keyCode&&(t.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null,t.regionSet.setMode(O.L.MOVING))}}}),Me=De))||Me;var qe;i(937);let He=Object(g.a)(qe=class extends h.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.contourWebGLService=void 0,this.updateCanvas=()=>{const e=O.e.Instance,t=e.activeFrame,i=e.contourFrames;if(t&&this.canvas&&this.gl&&this.contourWebGLService.shaderUniforms){this.resizeAndClearCanvas();for(let n=i.length-1;n>=0;--n)this.renderFrameContours(i[n],t);const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.drawImage(this.gl.canvas,0,0,this.canvas.width,this.canvas.height)}},this.renderFrameContours=(e,t)=>{const i=e===t;let n,r;if(t.spatialReference){let i=t.spatialTransform.origin;const o=t.spatialReference.requiredFrameView,a={x:1/(o.xMax-o.xMin),y:1/(o.yMax-o.yMin)},s=Object(M.ib)(t.spatialTransform.origin,Object(M.cb)(Object(M.ab)(t.spatialTransform.origin,t.spatialTransform.rotation),t.spatialTransform.scale)),l={x:(t.spatialTransform.translation.x-o.xMin+s.x)*a.x,y:(t.spatialTransform.translation.y-o.yMin+s.y)*a.y};this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeScale,a.x,a.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeOffset,l.x,l.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RotationOrigin,i.x,i.y),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.RotationAngle,-t.spatialTransform.rotation),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.ScaleAdjustment,t.spatialTransform.scale),n=devicePixelRatio*e.contourConfig.thickness/(t.spatialReference.zoomLevel*t.spatialTransform.scale),r=Object(M.j)(1/t.spatialReference.zoomLevel,3)}else{const i=t.requiredFrameView,o={x:1/(i.xMax-i.xMin),y:1/(i.yMax-i.yMin)},a={x:-i.xMin*o.x,y:-i.yMin*o.y};this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeOffset,a.x,a.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeScale,o.x,o.y),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.RotationAngle,0),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.ScaleAdjustment,1),n=devicePixelRatio*e.contourConfig.thickness/t.zoomLevel,r=Object(M.j)(1/t.zoomLevel,3)}if(i)this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapEnabled,0),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapTexture,0);else{const i=e.getControlMap(t);i?(this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapEnabled,1),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapMin,i.minPoint.x,i.minPoint.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapMax,i.maxPoint.x,i.maxPoint.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapSize,i.width,i.height)):console.error("Could not generate control map for contours"),this.gl.activeTexture(M.a.TEXTURE1),this.gl.bindTexture(M.a.TEXTURE_2D,i.getTextureX(this.gl)),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapTexture,1)}if(this.gl.uniform1f(this.contourWebGLService.shaderUniforms.LineThickness,n),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.CmapEnabled,e.contourConfig.colormapEnabled?1:0),e.contourConfig.colormapEnabled&&(this.gl.uniform1i(this.contourWebGLService.shaderUniforms.CmapIndex,O.O.COLOR_MAPS_ALL.indexOf(e.contourConfig.colormap)),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.Bias,e.contourConfig.colormapBias),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.Contrast,e.contourConfig.colormapContrast)),e.contourStores){const t=[];e.contourStores.forEach((e,i)=>t.push(i));const i=Math.min(...t),n=Math.max(...t),o=e.contourConfig.color;o?this.gl.uniform4f(this.contourWebGLService.shaderUniforms.LineColor,o.r/255,o.g/255,o.b/255,o.a||1):this.gl.uniform4f(this.contourWebGLService.shaderUniforms.LineColor,1,1,1,1),e.contourStores.forEach((t,o)=>{if(e.contourConfig.colormapEnabled){let e;e=i!==n?(o-i)/(n-i):1,this.gl.uniform1f(this.contourWebGLService.shaderUniforms.CmapValue,e)}const a=e.contourConfig.dashMode,s=a===O.o.Dashed||a===O.o.NegativeOnly&&o<0?8:0;this.gl.uniform1f(this.contourWebGLService.shaderUniforms.DashLength,devicePixelRatio*s*r);for(let e=0;e<t.chunkCount;e++){t.bindBuffer(e);const i=t.numGeneratedVertices[e];this.gl.vertexAttribPointer(this.contourWebGLService.vertexPositionAttribute,3,WebGLRenderingContext.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.contourWebGLService.vertexNormalAttribute,2,WebGLRenderingContext.SHORT,!1,16,12),this.gl.drawArrays(WebGLRenderingContext.TRIANGLE_STRIP,0,i)}})}}}componentDidMount(){this.contourWebGLService=Z.d.Instance,this.gl=this.contourWebGLService.gl,this.canvas&&this.updateCanvas()}componentDidUpdate(){requestAnimationFrame(this.updateCanvas)}resizeAndClearCanvas(){const e=O.e.Instance.activeFrame;if(!e)return;const t=Math.round(Math.max(1,e.renderWidth*devicePixelRatio)),i=Math.round(Math.max(1,e.renderHeight*devicePixelRatio));this.canvas.width===t&&this.canvas.height===i||(this.canvas.width=t,this.canvas.height=i,this.contourWebGLService.setCanvasSize(t,i)),this.gl.clearColor(0,0,0,0);const n=WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT|WebGLRenderingContext.STENCIL_BUFFER_BIT;this.gl.clear(n)}render(){const e=O.e.Instance,t=e.activeFrame;if(t){t.requiredFrameView}const i=e.contourFrames;for(const o of i){const e=o.contourConfig;e.thickness,e.colormapEnabled?e.colormap:e.color,e.dashMode,e.colormapBias,e.colormapContrast;o.contourStores.forEach(e=>{e.vertexCount})}const n=e.overlayStore.padding;let r="contour-div";return this.props.docked&&(r+=" docked"),h.createElement("div",{className:r},h.createElement("canvas",{id:"contour-canvas",className:"contour-canvas",ref:e=>this.canvas=e,style:{top:n.top,left:n.left,width:t&&t.renderWidth||1,height:t&&t.renderHeight||1}}))}})||qe;var Ue,Ye,Xe=i(202),Ke=i.n(Xe),Qe=i(12);i(940);let Ze=Object(g.a)((Ye=class extends h.Component{constructor(...e){super(...e),this.onClick=e=>{if(e&&e.points&&e.points.length>0){const t=O.k.Instance,i=Number(e.points[0].data.name),n=t.catalogProfileStores.get(i),r=t.catalogWidgets.get(i),o=O.U.Instance.catalogWidgets.get(r);if(i&&!o.showSelectedData){t.updateCatalogProfiles(i);let r=[];const a=e.points[0];r.push(a.pointIndex),n.setSelectedPointIndices(r,!1),o.setCatalogTableAutoScroll(!0)}}},this.onWheelCaptured=e=>{if(e&&e.nativeEvent&&"wheel"===e.nativeEvent.type){const t=e.nativeEvent,i=O.e.Instance.activeFrame,n=15,r=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n;if(i.wcsInfo&&this.props.onZoomed){const e=ue(t.offsetX,t.offsetY,i,2*this.props.width,2*this.props.height);this.props.onZoomed(i.getCursorInfo(e),-r)}}}}get unSelectedData(){const e=O.k.Instance;let t=new Map;return e.catalogData.forEach((e,i)=>{if(!e.showSelectedData){let n={type:"scattergl",mode:"markers",hoverinfo:"none"};n.visible=e.displayed,n.marker={},n.marker.line={},n.x=e.xImageCoords.slice(0),n.y=e.yImageCoords.slice(0),n.name=i.toString(),t.set(i,n)}}),t}get selectedData(){const e=O.k.Instance;let t=new Map;return e.catalogProfileStores.forEach(i=>{const n=i.selectedPointIndices.length,r=i.catalogFileId;let o={};if(n>0){var a;o.type="scattergl",o.mode="markers",o.hoverinfo="none";const i=e.catalogData.get(r);o.visible=i.displayed,(null===i||void 0===i||null===(a=i.xImageCoords)||void 0===a?void 0:a.length)&&(o.x=i.xSelectedCoords.slice(0),o.y=i.ySelectedCoords.slice(0),o.name=r.toString(),o.marker={},o.marker.line={},t.set(r,o))}}),t}onDoubleClick(){const e=O.k.Instance;e.catalogData.size&&e.catalogProfileStores.forEach(e=>{var t;const i=O.k.Instance.catalogWidgets.get(e.catalogFileId);e.setSelectedPointIndices([],!1),null===(t=O.U.Instance.catalogWidgets.get(i))||void 0===t||t.setCatalogTableAutoScroll(!1)})}render(){const e=O.e.Instance,t=e.activeFrame,i=2*this.props.width,n=2*this.props.height,r=e.overlayStore.padding,o=O.k.Instance;let a="catalog-div";this.props.docked&&(a+=" docked");let s={width:i,height:n,hovermode:"closest",xaxis:{autorange:!1,showgrid:!1,zeroline:!1,showline:!1,showticklabels:!1},yaxis:{autorange:!1,showgrid:!1,zeroline:!1,showline:!1,showticklabels:!1},margin:{l:0,r:0,b:0,t:0,pad:0},showlegend:!1,dragmode:!1};if(t){const e=t.requiredFrameView;s.xaxis.range=[e.xMin,e.xMax],s.yaxis.range=[e.yMin,e.yMax]}let l=[];const c=this.unSelectedData,u=this.selectedData;return c.forEach((e,t)=>{const i=o.getCatalogWidgetStore(t),n=i.catalogColor;e.marker.color=n,e.marker.line.color=n,e.marker.line.width=4,e.marker.size=2*i.catalogSize,e.marker.symbol=i.catalogShape,l.push(e)}),u&&u.forEach((e,t)=>{const i=o.getCatalogWidgetStore(t);e.marker.color=i.highlightColor,e.marker.line.color=i.highlightColor,e.marker.line.width=4,e.marker.size=2*i.catalogSize+5;let n=i.catalogShape;n===Qe.b.FullCircle?n=Qe.b.Circle:n===Qe.b.FullStar?n=Qe.b.Star:n===Qe.b.Plus?n="cross-open":n===Qe.b.Cross&&(n="x-open"),e.marker.symbol=n,l.push(e)}),h.createElement("div",{className:a,style:{left:r.left,top:r.top},onWheelCapture:this.onWheelCaptured},h.createElement(Ke.a,{className:"catalog-plotly",data:l,layout:s,config:{displayModeBar:!1,showTips:!1,doubleClick:!1,displaylogo:!1,scrollZoom:!1,showAxisDragHandles:!1,setBackground:()=>"transparent"},onClick:this.onClick,onDoubleClick:this.onDoubleClick,style:{transform:"scale(0.5)",transformOrigin:"top left"}}))}},Object(d.a)(Ye.prototype,"unSelectedData",[m.i],Object.getOwnPropertyDescriptor(Ye.prototype,"unSelectedData"),Ye.prototype),Object(d.a)(Ye.prototype,"selectedData",[m.i],Object.getOwnPropertyDescriptor(Ye.prototype,"selectedData"),Ye.prototype),Ue=Ye))||Ue;var $e,Je,et;i(941);const tt=(e,t="rgba(255, 255, 255, 0)")=>{var i,n,r,o;const a=document.getElementById("raster-canvas"),s=document.getElementById("contour-canvas"),l=document.getElementById("overlay-canvas");if(!a||!s||!l)return null;let c,u,p;const d=q()(".beam-profile-stage").children().children("canvas");d&&d.length&&(u=d[0]);const h=q()(".region-stage").children().children("canvas");h&&h.length&&(c=h[0]);const g=null===(i=q()(".catalog-plotly"))||void 0===i||null===(n=i.children())||void 0===n||null===(r=n.children())||void 0===r||null===(o=r.children(".gl-container"))||void 0===o?void 0:o.children(".gl-canvas-context");g&&g.length&&(p=g[0]);const m=document.createElement("canvas");m.width=l.width,m.height=l.height;const f=m.getContext("2d");return f.fillStyle=t,f.fillRect(0,0,m.width,m.height),f.drawImage(a,e.left*devicePixelRatio,e.top*devicePixelRatio),f.drawImage(s,e.left*devicePixelRatio,e.top*devicePixelRatio),u&&f.drawImage(u,e.left*devicePixelRatio,e.top*devicePixelRatio),c&&f.drawImage(c,e.left*devicePixelRatio,e.top*devicePixelRatio),p&&(1===devicePixelRatio?f.drawImage(p,e.left*devicePixelRatio,e.top*devicePixelRatio,p.width/2,p.height/2):f.drawImage(p,e.left*devicePixelRatio,e.top*devicePixelRatio)),f.setTransform(1,0,0,1,0,0),f.drawImage(l,0,0),m};let it;!function(e){e.RegionCreating="regionCreating",e.Catalog="catalog",e.RegionMoving="regionMoving"}(it||(it={}));let nt=Object(g.a)((Je=class extends h.Component{static get WIDGET_CONFIG(){return{id:"image-view",type:"image-view",minWidth:500,minHeight:500,defaultWidth:600,defaultHeight:600,title:"Image view",isCloseable:!1,helpType:O.x.IMAGE_VIEW}}constructor(e){super(e),this.ratioIndicatorTimeoutHandle=void 0,this.cachedImageSize=void 0,Object(p.a)(this,"showRatioIndicator",et,this),this.activeLayer=void 0,this.onResize=(e,t)=>{e>0&&t>0&&O.e.Instance.setImageViewDimensions(e,t)},this.onClicked=e=>{const t=O.e.Instance.activeFrame;t&&t.setCenter(e.posImageSpace.x,e.posImageSpace.y)},this.onZoomed=(e,t)=>{const i=O.e.Instance.activeFrame;if(i){const n=1+Math.abs(t/750);if(i.spatialReference){const r=i.spatialReference.zoomLevel*(t>0?n:1/n);i.zoomToPoint(e.posImageSpace.x,e.posImageSpace.y,r,!0)}else{const r=i.zoomLevel*(t>0?n:1/n);i.zoomToPoint(e.posImageSpace.x,e.posImageSpace.y,r,!0)}}},this.onMouseEnter=()=>{O.e.Instance.showImageToolbar()},this.onMouseLeave=()=>{O.e.Instance.hideImageToolbar()},this.handleRegionDoubleClicked=e=>{const t=O.e.Instance;if(e){const i=t.getFrame(e.fileId);i&&(i.regionSet.selectRegion(e),t.dialogStore.showRegionDialog())}},Object(m.p)(this),this.activeLayer=O.e.Instance.activeLayer,Object(m.h)(()=>{const e=O.e.Instance.activeFrame;if(e){const t={x:e.renderWidth,y:e.renderHeight};this.cachedImageSize&&this.cachedImageSize.x===t.x&&this.cachedImageSize.y===t.y||(this.cachedImageSize=t,clearTimeout(this.ratioIndicatorTimeoutHandle),Object(m.r)(()=>this.showRatioIndicator=!0),this.ratioIndicatorTimeoutHandle=setTimeout(()=>Object(m.r)(()=>{this.showRatioIndicator=!1}),1e3))}})}render(){const e=O.e.Instance,t=e.overlayStore;let i;if(e.activeFrame&&e.activeFrame.isRenderable&&e.astReady){const n=e.activeFrame.renderWidth*(e.activeFrame.renderHiDPI?devicePixelRatio:1),r=e.activeFrame.renderHeight*(e.activeFrame.renderHiDPI?devicePixelRatio:1),o={x:t.padding.left+t.viewWidth/2,y:t.padding.top+t.viewHeight/2};i=h.createElement(h.Fragment,null,e.activeFrame.valid&&h.createElement(U,{frame:e.activeFrame,overlaySettings:t,docked:this.props.docked}),e.activeFrame.cursorInfo&&h.createElement(X,{cursorInfo:e.activeFrame.cursorInfo,cursorValue:e.activeFrame.cursorInfo.isInsideImage?e.activeFrame.cursorValue.value:void 0,isValueCurrent:e.activeFrame.isCursorValueCurrent,spectralInfo:e.activeFrame.spectralInfo,width:t.viewWidth,left:t.padding.left,right:t.padding.right,docked:this.props.docked,unit:e.activeFrame.unit,top:t.padding.top,currentStokes:e.activeFrame.hasStokes?e.activeFrame.stokesInfo[e.activeFrame.requiredStokes]:"",showImage:!0,showWCS:!0,showValue:!0,showChannel:!1,showSpectral:!0,showStokes:!0}),e.activeFrame&&h.createElement(se,{top:t.padding.top,left:t.padding.left,docked:this.props.docked,padding:10}),e.activeFrame&&h.createElement(Be,{frame:e.activeFrame,width:e.activeFrame.renderWidth,height:e.activeFrame.renderHeight,top:t.padding.top,left:t.padding.left,onClicked:this.onClicked,onRegionDoubleClicked:this.handleRegionDoubleClicked,onZoomed:this.onZoomed,overlaySettings:t,isRegionCornerMode:e.preferenceStore.isRegionCornerMode,dragPanningEnabled:e.preferenceStore.dragPanning,cursorFrozen:e.cursorFrozen,cursorPoint:e.activeFrame.cursorInfo.posImageSpace,docked:this.props.docked&&(this.activeLayer===it.RegionMoving||this.activeLayer===it.RegionCreating)}),e.activeFrame&&h.createElement(Ze,{width:e.activeFrame.renderWidth,height:e.activeFrame.renderHeight,activeLayer:this.activeLayer,docked:this.props.docked&&e.activeLayer===it.Catalog,onClicked:this.onClicked,onZoomed:this.onZoomed}),h.createElement(ne,{docked:this.props.docked,visible:e.imageToolbarVisible,vertical:!1,onActiveLayerChange:e.updateActiveLayer,activeLayer:this.activeLayer}),h.createElement("div",{style:{opacity:this.showRatioIndicator?1:0,left:o.x,top:o.y},className:"tag-image-ratio"},h.createElement(f.S,{large:!0},n," x ",r," (",Object(M.kb)(n/r,2),")")))}else i=e.astReady?h.createElement(f.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}):h.createElement(f.C,{icon:h.createElement(f.O,{className:"astLoadingSpinner"}),title:"Loading AST Library"});return h.createElement("div",{className:"image-view-div",onMouseOver:this.onMouseEnter,onMouseLeave:this.onMouseLeave},h.createElement($,{docked:this.props.docked}),h.createElement(He,{docked:this.props.docked}),i,h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},et=Object(d.a)(Je.prototype,"showRatioIndicator",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Je))||$e;var rt,ot=i(438),at=i.n(ot);i(962);let st=Object(g.a)(rt=class extends h.Component{constructor(...e){super(...e),this.onClearClicked=()=>{O.A.Instance.clearLog()},this.onTagClicked=e=>{O.A.Instance.toggleTag(e)},this.onLogLevelChanged=e=>{O.A.Instance.setLevel(parseInt(e.currentTarget.value))},this.isTagHidden=e=>-1!==O.A.Instance.hiddenTags.indexOf(e)}static get WIDGET_CONFIG(){return{id:"log",type:"log",minWidth:300,minHeight:150,defaultWidth:425,defaultHeight:200,title:"Log",isCloseable:!0,helpType:O.x.LOG}}colorFromSeverity(e){switch(e){case ie.a.ErrorSeverity.WARNING:return ae.a.ORANGE3;case ie.a.ErrorSeverity.ERROR:case ie.a.ErrorSeverity.CRITICAL:return ae.a.RED3;default:return ae.a.GRAY1}}intentFromSeverity(e){switch(e){case ie.a.ErrorSeverity.WARNING:return"warning";case ie.a.ErrorSeverity.ERROR:case ie.a.ErrorSeverity.CRITICAL:return"danger";default:return"none"}}render(){const e=O.A.Instance,t=e.logEntries,i=e.hiddenTags;let n=[],r=[];for(let a=0;a<t.length;a++){const o=t[a];if(o.level<e.logLevel)continue;let s=[],l=o.tags.filter(e=>-1===i.indexOf(e));for(let e=0;e<o.tags.length;e++){const t=o.tags[e];s.push(h.createElement(f.S,{key:e,intent:this.intentFromSeverity(o.level)},o.tags[e])),-1===n.indexOf(t)&&n.push(t)}l.length&&r.push(h.createElement("div",{key:a},s,h.createElement(f.h,{style:{color:this.colorFromSeverity(o.level)}},o.message)))}const o=n.map((e,t)=>h.createElement(f.S,{interactive:!0,minimal:this.isTagHidden(e),intent:this.isTagHidden(e)?"none":"primary",className:this.isTagHidden(e)?"tag-hidden":"",key:t,onClick:()=>this.onTagClicked(e)},e));return h.createElement("div",{className:"log"},r.length?h.createElement(at.a,{className:"log-entry-list",followButtonClassName:"log-entry-follow"},r):h.createElement(f.C,{className:"log-entry-list",icon:"application",title:"No log entries"}),h.createElement("div",{className:"log-footer"},h.createElement(f.p,{inline:!0,label:"Log level:",className:"log-level"},h.createElement(f.r,{value:e.logLevel,onChange:this.onLogLevelChanged,style:{color:this.colorFromSeverity(e.logLevel)}},h.createElement("option",{value:ie.a.ErrorSeverity.DEBUG,style:{color:this.colorFromSeverity(ie.a.ErrorSeverity.DEBUG)}},"Debug"),h.createElement("option",{value:ie.a.ErrorSeverity.INFO,style:{color:this.colorFromSeverity(ie.a.ErrorSeverity.INFO)}},"Info"),h.createElement("option",{value:ie.a.ErrorSeverity.WARNING,style:{color:this.colorFromSeverity(ie.a.ErrorSeverity.WARNING)}},"Warning"),h.createElement("option",{value:ie.a.ErrorSeverity.ERROR,style:{color:this.colorFromSeverity(ie.a.ErrorSeverity.ERROR)}},"Error"),h.createElement("option",{value:ie.a.ErrorSeverity.CRITICAL,style:{color:this.colorFromSeverity(ie.a.ErrorSeverity.CRITICAL)}},"Critical"))),h.createElement(f.p,{inline:!0,label:"Visible tags:",className:"tag-list"},h.createElement("div",null,o.length>0?o:"None")),h.createElement("div",{className:"log-footer-right"},h.createElement(f.e,{minimal:!0,intent:"warning",icon:"trash",onClick:this.onClearClicked}))))}})||rt;var lt,ct,ut,pt,dt,ht,gt,mt=i(270),ft=i(208),yt=i(163),bt=i(1024),Ot=i(20),St=i(435);i(963);let Ct=Object(g.a)((ct=class extends h.Component{static get WIDGET_CONFIG(){return{id:"layer-list",type:"layer-list",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Image List",isCloseable:!0,helpType:O.x.LAYER_LIST}}constructor(e){super(e),Object(p.a)(this,"width",ut,this),Object(p.a)(this,"height",pt,this),Object(p.a)(this,"columnWidths",dt,this),Object(p.a)(this,"onColumnWidthsChange",ht,this),Object(p.a)(this,"onResize",gt,this),this.handleFileReordered=(e,t,i)=>{e!==t&&O.e.Instance.reorderFrame(e,t,i)},this.rowHeaderCellRenderer=e=>h.createElement(mt.a,{name:e.toString(),className:e===O.e.Instance.activeFrameIndex?"active-row-cell":""}),this.onFileSelected=(e,t)=>{const i=t.frameInfo.fileId;e.setActiveFrame(i)},this.fileNameRenderer=e=>{const t=O.e.Instance;if(e<0||e>=t.frames.length)return h.createElement(ft.a,null);const i=t.frames[e];return h.createElement(ft.a,{className:e===t.activeFrameIndex?"active-row-cell":""},h.createElement(h.Fragment,null,h.createElement("div",{className:"name-cell",onClick:()=>this.onFileSelected(t,i)},i.filename)))},this.channelRenderer=e=>{const t=O.e.Instance;return e<0||e>=t.frames.length?h.createElement(ft.a,null):h.createElement(ft.a,{className:e===t.activeFrameIndex?"active-row-cell":""},t.frames[e].requiredChannel)},this.stokesRenderer=e=>{const t=O.e.Instance;return e<0||e>=t.frames.length?h.createElement(ft.a,null):h.createElement(ft.a,{className:e===t.activeFrameIndex?"active-row-cell":""},t.frames[e].requiredStokes)},this.typeRenderer=e=>{const t=O.e.Instance;if(e<0||e>=t.frames.length)return h.createElement(ft.a,null);const i=t.frames[e];return h.createElement(ft.a,{className:e===t.activeFrameIndex?"active-row-cell":""},h.createElement(h.Fragment,null,h.createElement(f.W,{position:"bottom",content:h.createElement("span",null,"Raster layer",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Click to ",i.renderConfig.visible?"hide":"show")))},h.createElement(f.b,{minimal:!0,small:!0,active:i.renderConfig.visible,intent:i.renderConfig.visible?"success":"none",onClick:i.renderConfig.toggleVisibility},"R")),i.contourConfig.enabled&&h.createElement(f.W,{position:"bottom",content:h.createElement("span",null,"Contour layer",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Click to ",i.contourConfig.visible?"hide":"show")))},h.createElement(f.b,{minimal:!0,small:!0,active:i.contourConfig.visible,intent:i.contourConfig.visible?"success":"none",onClick:i.contourConfig.toggleVisibility},"C"))))},this.matchingRenderer=e=>{const t=O.e.Instance;if(e<0||e>=t.frames.length)return h.createElement(ft.a,null);const i=t.frames[e];let n,r,o;if(t.spatialReference){let e;e=i===t.spatialReference?i.filename+" is the current spatial reference":`Click to ${i.spatialReference?"disable":"enable"} matching to ${t.spatialReference.filename}`,n=h.createElement(f.W,{position:"bottom",content:h.createElement("span",null,"Spatial matching",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,e)))},h.createElement(f.b,{className:i===t.spatialReference?"outlined":"",minimal:!0,small:!0,active:!!i.spatialReference,intent:i.spatialReference?"success":"none",onClick:()=>t.toggleSpatialMatching(i)},"XY"))}if(i.frameInfo.fileInfoExtended.depth>1&&t.spectralReference){let e;e=i===t.spectralReference?i.filename+" is the current spectral reference":`Click to ${i.spectralReference?"disable":"enable"} matching to ${t.spectralReference.filename}`,r=h.createElement(f.W,{position:"bottom",content:h.createElement("span",null,"Spectral matching",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,e)))},h.createElement(f.b,{className:i===t.spectralReference?"outlined":"",minimal:!0,small:!0,active:!!i.spectralReference,intent:i.spectralReference?"success":"none",onClick:()=>t.toggleSpectralMatching(i)},"Z"))}if(t.rasterScalingReference){let e;e=i===t.rasterScalingReference?i.filename+" is the current raster scaling reference":`Click to ${i.rasterScalingReference?"disable":"enable"} matching to ${t.rasterScalingReference.filename}`,o=h.createElement(f.W,{position:"bottom",content:h.createElement("span",null,"Raster scaling matching",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,e)))},h.createElement(f.b,{className:i===t.rasterScalingReference?"outlined":"",minimal:!0,small:!0,active:!!i.rasterScalingReference,intent:i.rasterScalingReference?"success":"none",onClick:()=>t.toggleRasterScalingMatching(i)},"R"))}return h.createElement(ft.a,{className:e===t.activeFrameIndex?"active-row-cell":""},h.createElement(h.Fragment,null,n,r,o))},this.columnHeaderRenderer=e=>{let t;switch(e){case 0:t="Image";break;case 1:t="Layers";break;case 2:t="Matching";break;case 3:t="Channel";break;case 4:t="Stokes"}return h.createElement(yt.a,{name:t,style:{fontSize:"12",fontWeight:"bold"}})},this.contextMenuRenderer=e=>{const t=e.getTarget().rows,i=O.e.Instance;if(t&&t.length&&i.frames[t[0]]){const e=i.frames[t[0]];var n,r;if(e)return h.createElement(f.z,null,h.createElement(f.A,{title:e.filename}),h.createElement(f.B,{disabled:i.spatialReference===e,text:"Set as spatial reference",onClick:()=>i.setSpatialReference(e)}),h.createElement(f.B,{disabled:i.spectralReference===e||e.frameInfo.fileInfoExtended.depth<=1,text:"Set as spectral reference",onClick:()=>i.setSpectralReference(e)}),h.createElement(f.B,{disabled:i.rasterScalingReference===e,text:"Set as raster scaling reference",onClick:()=>i.setRasterScalingReference(e)}),h.createElement(f.A,null),h.createElement(f.B,{text:"Close image",onClick:()=>i.closeFile(e)}),h.createElement(f.B,{text:"Close other images",disabled:(null===(n=i.frames)||void 0===n?void 0:n.length)<=1,onClick:()=>i.closeOtherFiles(e)}),h.createElement(f.B,{text:"Close all images",disabled:(null===(r=i.frames)||void 0===r?void 0:r.length)<=1,onClick:()=>i.closeOtherFiles(null,!1)}))}return null},Object(m.p)(this)}render(){const e=O.e.Instance,t=e.frameNum;if(t<=0)return h.createElement("div",{className:"layer-list-widget"},h.createElement(f.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),";",h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}));e.frameChannels,e.frameStokes,e.activeFrameIndex,e.frames.map(e=>e.renderConfig.visible),e.frames.map(e=>e.contourConfig.visible&&e.contourConfig.enabled),e.frames.map(e=>e.spatialReference),e.frames.map(e=>e.spectralReference),e.frames.map(e=>e.rasterScalingReference),e.spectralReference,e.spatialReference,e.rasterScalingReference;return h.createElement("div",{className:"layer-list-widget"},this.width>0&&h.createElement(bt.a,{numRows:t,rowHeaderCellRenderer:this.rowHeaderCellRenderer,enableRowHeader:!0,enableRowReordering:!0,enableRowResizing:!1,selectionModes:Ot.d.ROWS_ONLY,enableMultipleSelection:!0,onRowsReordered:this.handleFileReordered,columnWidths:this.columnWidths,enableColumnResizing:!0,onColumnWidthChanged:this.onColumnWidthsChange,bodyContextMenuRenderer:this.contextMenuRenderer},h.createElement(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.fileNameRenderer}),h.createElement(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.typeRenderer}),h.createElement(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.matchingRenderer}),h.createElement(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.channelRenderer}),h.createElement(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.stokesRenderer})),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}},ut=Object(d.a)(ct.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pt=Object(d.a)(ct.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),dt=Object(d.a)(ct.prototype,"columnWidths",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[132,70,110,75,67]}}),ht=Object(d.a)(ct.prototype,"onColumnWidthsChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{!Number.isInteger(e)||e<0||e>=this.columnWidths.length||t<=0||(this.columnWidths[e]=t,this.forceUpdate())}}}),gt=Object(d.a)(ct.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),lt=ct))||lt;var Et,It=i(55);i(965);let wt=Object(g.a)(Et=class extends h.Component{constructor(...e){super(...e),this.handleRegionTypeClicked=e=>{const t=O.e.Instance;t.activeFrame.regionSet.setNewRegionType(e),t.activeFrame.regionSet.setMode(O.L.CREATING)},this.regionTooltip=e=>{const t=O.e.Instance.preferenceStore.regionCreationMode===Q.RegionCreationMode.CENTER;return h.createElement("span",null,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Click-and-drag to define a region (",t?"center to corner":"corner to corner",").",h.createElement("br",null),"Hold Ctrl to define a region (",t?"corner to corner":"center to corner",").",h.createElement("br",null),"Change the default creation mode in Preferences.",h.createElement("br",null),"Hold shift key to create a ",e,".")))}}static get DRAGSOURCE_WIDGETCONFIG_MAP(){return new Map([["renderConfigButton",Vt.WIDGET_CONFIG],["layerListButton",Ct.WIDGET_CONFIG],["logButton",st.WIDGET_CONFIG],["animatorButton",C.WIDGET_CONFIG],["regionListButton",Zt.WIDGET_CONFIG],["spatialProfilerButton",li.WIDGET_CONFIG],["spectralProfilerButton",Ri.WIDGET_CONFIG],["spectralLineQueryButton",Ci.WIDGET_CONFIG],["statsButton",Li.WIDGET_CONFIG],["histogramButton",Hi.WIDGET_CONFIG],["stokesAnalysisButton",tn.WIDGET_CONFIG],["catalogOverlayButton",bn.WIDGET_CONFIG]])}render(){const e=O.e.Instance,t=e.dialogStore;let i="toolbar-menu",n="dialog-toolbar-menu",r="actions-toolbar-menu";e.darkTheme&&(i+=" bp3-dark",n+=" bp3-dark",r+=" bp3-dark");const o=!!e.activeFrame&&e.activeFrame.regionSet.mode===O.L.CREATING,a=e.activeFrame?e.activeFrame.regionSet.newRegionType:ie.a.RegionType.RECTANGLE,s=!e.activeFrame||e.activeLayer===it.Catalog,l=h.createElement("span",null,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Drag to place docked widget",h.createElement("br",null),"Click to place a floating widget")));return h.createElement(h.Fragment,null,h.createElement(f.f,{className:r},h.createElement(f.W,{content:h.createElement("span",null,"Point")},h.createElement(f.b,{icon:"symbol-square",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.POINT),active:o&&a===ie.a.RegionType.POINT,disabled:s})),h.createElement(f.W,{content:h.createElement("span",null,"Rectangle",this.regionTooltip("square"))},h.createElement(f.b,{icon:"square",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.RECTANGLE),active:o&&a===ie.a.RegionType.RECTANGLE,disabled:s})),h.createElement(f.W,{content:h.createElement("span",null,"Ellipse",this.regionTooltip("circle"))},h.createElement(f.b,{icon:"circle",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.ELLIPSE),active:o&&a===ie.a.RegionType.ELLIPSE,disabled:s})),h.createElement(f.W,{content:h.createElement("span",null,"Polygon",h.createElement("span",null,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Define control points with a series of clicks.",h.createElement("br",null),"Double-click to close the loop and finish polygon creation.",h.createElement("br",null),"Double-click on a control point to delete it.",h.createElement("br",null),"Click on a side to create a new control point."))))},h.createElement(f.b,{icon:"polygon-filter",onClick:()=>this.handleRegionTypeClicked(ie.a.RegionType.POLYGON),active:o&&a===ie.a.RegionType.POLYGON,disabled:s}))),h.createElement(f.f,{className:i},Array.from(O.U.Instance.CARTAWidgets.keys()).map(e=>{const t=O.U.Instance.CARTAWidgets.get(e),i=e.trim();return h.createElement(f.W,{key:i+"Tooltip",content:h.createElement("span",null,e,l)},h.createElement(f.b,{icon:t.isCustomIcon?h.createElement(It.a,{icon:t.icon}):t.icon,id:i+"Button",onClick:t.onClick}))})),h.createElement(f.f,{className:n},h.createElement(f.W,{content:h.createElement("span",null,"File Header")},h.createElement(f.b,{icon:"app-header",onClick:t.showFileInfoDialog,active:t.fileInfoDialogVisible})),h.createElement(f.W,{content:h.createElement("span",null,"Preferences")},h.createElement(f.b,{icon:"wrench",onClick:t.showPreferenceDialog,active:t.preferenceDialogVisible})),h.createElement(f.W,{content:h.createElement("span",null,"Contours")},h.createElement(f.b,{icon:h.createElement(It.a,{icon:"contour"}),onClick:t.showContourDialog,active:t.contourDialogVisible}))))}})||Et;var Tt,vt,At;i(966);let xt=Object(g.a)((vt=class extends h.Component{constructor(e){super(e),Object(p.a)(this,"documentationAlertVisible",At,this),this.documentationAlertTimeoutHandle=void 0,this.handleDashboardClicked=()=>{window.open(Z.a.RuntimeConfig.dashboardAddress,"_blank")},this.genWidgetsMenu=()=>{const e=O.U.Instance.CARTAWidgets.get(O.T.Region),t=O.U.Instance.CARTAWidgets.get(O.T.ImageList),i=O.U.Instance.CARTAWidgets.get(O.T.Log),n=O.U.Instance.CARTAWidgets.get(O.T.SpatialProfiler),r=O.U.Instance.CARTAWidgets.get(O.T.SpectralProfiler),o=Array.from(O.U.Instance.CARTAWidgets.keys()).filter(e=>![O.T.Region,O.T.ImageList,O.T.Log,O.T.SpatialProfiler,O.T.SpectralProfiler].includes(e));return h.createElement(f.z,{className:"widgets-menu"},h.createElement(f.z.Item,{text:"Info Panels",icon:"panel-stats"},h.createElement(f.z.Item,{text:O.T.Region,icon:h.createElement(It.a,{icon:e.icon}),onClick:e.onClick}),h.createElement(f.z.Item,{text:O.T.ImageList,icon:t.icon,onClick:t.onClick}),h.createElement(f.z.Item,{text:O.T.Log,icon:i.icon,onClick:i.onClick})),h.createElement(f.z.Item,{text:"Profiles",icon:"pulse"},h.createElement(f.z.Item,{text:O.T.SpatialProfiler,icon:h.createElement(It.a,{icon:n.icon}),onClick:n.onClick}),h.createElement(f.z.Item,{text:O.T.SpectralProfiler,icon:h.createElement(It.a,{icon:r.icon}),onClick:r.onClick})),o.map(e=>{const t=O.U.Instance.CARTAWidgets.get(e),i=e.trim();return h.createElement(f.z.Item,{key:i+"Menu",text:e,icon:t.isCustomIcon?h.createElement(It.a,{icon:t.icon}):t.icon,onClick:t.onClick})}))},this.handleDocumentationClicked=()=>{window.open("https://carta.readthedocs.io/en/1.4","_blank","width=1024"),"linux"!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET&&"darwin"!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET&&(this.documentationAlertVisible=!0,clearTimeout(this.documentationAlertTimeoutHandle),this.documentationAlertTimeoutHandle=setTimeout(()=>this.documentationAlertVisible=!1,1e4))},this.handleAlertDismissed=()=>{this.documentationAlertVisible=!1},this.handleFrameSelect=e=>{const t=O.e.Instance;t.activeFrame&&t.activeFrame.frameInfo.fileId===e||t.setActiveFrame(e)},Object(m.p)(this)}render(){const e=O.e.Instance,t=e.modifierString,i=e.backendService.connectionStatus;let n=[];let r;e.apiService.authenticated&&Z.a.RuntimeConfig.apiAddress&&n.push(h.createElement(f.z.Item,{key:"restart",text:"Restart Service",disabled:!e.apiService.authenticated,onClick:e.apiService.stopServer})),(Z.a.RuntimeConfig.logoutAddress||Z.a.RuntimeConfig.googleClientId)&&n.push(h.createElement(f.z.Item,{key:"logout",text:"Logout",disabled:!e.apiService.authenticated,onClick:e.apiService.logout})),Z.a.RuntimeConfig.dashboardAddress&&n.push(h.createElement(f.z.Item,{key:"dashboard",text:"Dashboard",onClick:this.handleDashboardClicked})),n.length&&(r=h.createElement(h.Fragment,null,h.createElement(f.z.Divider,null),h.createElement(f.z.Item,{text:"Server"},n)));const o=h.createElement(f.z,null,h.createElement(f.z.Item,{text:"Open image",label:t+"O",disabled:i!==Z.c.ACTIVE||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.File,!1)}),h.createElement(f.z.Item,{text:"Append image",label:t+"L",disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.File,!0)}),h.createElement(f.z.Item,{text:"Save image",label:t+"S",disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.SaveFile,!1)}),h.createElement(f.z.Item,{text:"Close image",label:t+"W",disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.closeCurrentFile(!0)}),h.createElement(f.z.Divider,null),h.createElement(f.z.Item,{text:"Import regions",disabled:!e.activeFrame,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.RegionImport,!1)}),h.createElement(f.z.Item,{text:"Export regions",disabled:!e.activeFrame||!e.activeFrame.regionSet.regions||e.activeFrame.regionSet.regions.length<=1,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.RegionExport,!1)}),h.createElement(f.z.Divider,null),h.createElement(f.z.Item,{text:"Import catalog",label:t+"G",disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.Catalog,!1)}),h.createElement(f.z.Divider,null),h.createElement(f.z.Item,{text:"Export image",label:t+"E",disabled:!e.activeFrame,onClick:e.exportImage}),h.createElement(f.z.Item,{text:"Preferences",onClick:e.dialogStore.showPreferenceDialog,disabled:e.preferenceStore.supportsServer&&i!==Z.c.ACTIVE}),r);let a=e.frames.slice().sort((e,t)=>e.frameInfo.fileId<=t.frameInfo.fileId?-1:1).map(t=>h.createElement(f.z.Item,{text:t.filename,active:e.activeFrame&&e.activeFrame.frameInfo.fileId===t.frameInfo.fileId,key:t.frameInfo.fileId,onClick:()=>this.handleFrameSelect(t.frameInfo.fileId)}));const s=Q.PresetLayout.PRESETS,l=e.layoutStore,c=l.userLayoutNames,u=h.createElement(f.z,null,h.createElement(f.z.Item,{text:"Theme",icon:"media"},h.createElement(f.z.Item,{text:"Automatic",icon:"contrast",onClick:e.setAutoTheme}),h.createElement(f.z.Item,{text:"Light",icon:"flash",onClick:e.setLightTheme}),h.createElement(f.z.Item,{text:"Dark",icon:"moon",onClick:e.setDarkTheme})),h.createElement(f.z.Item,{text:"Layouts",icon:"page-layout",disabled:l.supportsServer&&i!==Z.c.ACTIVE},h.createElement(f.z.Item,{text:"Existing Layouts",disabled:!s&&!c},s&&s.length>0&&s.map(t=>h.createElement(f.z.Item,{key:t,text:t,active:t===e.layoutStore.currentLayoutName,onClick:()=>e.layoutStore.applyLayout(t)})),c&&c.length>0&&h.createElement(h.Fragment,null,h.createElement(f.A,null),c.map(t=>h.createElement(f.z.Item,{key:t,text:t,active:t===e.layoutStore.currentLayoutName,onClick:()=>e.layoutStore.applyLayout(t)})))),h.createElement(f.z.Item,{text:"Save Layout",onClick:e.dialogStore.showSaveLayoutDialog}),h.createElement(f.z.Item,{text:"Delete Layout",disabled:!c||c.length<=0},c&&c.length>0&&c.map(t=>h.createElement(f.z.Item,{key:t,text:t,active:t===e.layoutStore.currentLayoutName,onClick:()=>{e.layoutStore.deleteLayout(t),t===e.preferenceStore.layout&&e.preferenceStore.setPreference(O.G.GLOBAL_LAYOUT,Q.PresetLayout.DEFAULT)}})))),a.length>0&&h.createElement(f.z.Item,{text:"Images",icon:"multi-select"},a,h.createElement(f.z.Divider,null),h.createElement(f.z.Item,{text:"Previous image",icon:"step-backward",disabled:a.length<2,onClick:e.prevFrame}),h.createElement(f.z.Item,{text:"Next image",icon:"step-forward",disabled:a.length<2,onClick:e.nextFrame})),h.createElement(f.z.Item,{text:"File header",icon:"app-header",disabled:!e.activeFrame,onClick:e.dialogStore.showFileInfoDialog}),h.createElement(f.z.Item,{text:"Contours",icon:h.createElement(It.a,{icon:"contour"}),onClick:e.dialogStore.showContourDialog})),p=h.createElement(f.z,null,h.createElement(f.z.Item,{text:"Online Manual",icon:"manual",onClick:this.handleDocumentationClicked}),h.createElement(f.z.Item,{text:"Controls and Shortcuts",icon:"key-control",label:"Shift + ?",onClick:e.dialogStore.showHotkeyDialog}),h.createElement(f.z.Item,{text:"Debug Execution",icon:"console",onClick:e.dialogStore.showDebugExecutionDialog}),h.createElement(f.z.Item,{text:"About",icon:"info-sign",onClick:e.dialogStore.showAboutDialog}));let d,g="connectivity-icon";const m=isFinite(e.backendService.endToEndPing)?Object(M.kb)(e.backendService.endToEndPing,1)+" ms":"Unknown",b=e.username?" as "+e.username:"";switch(i){case Z.c.PENDING:d=h.createElement("span",null,"Connecting to server",b),g+=" warning";break;case Z.c.ACTIVE:e.backendService.connectionDropped?(d=h.createElement("span",null,"Reconnected to server ",b," after disconnect. Some errors may occur",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Latency: ",m))),g+=" warning"):(d=h.createElement("span",null,"Connected to server ",b,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Latency: ",m,h.createElement("br",null),"Session ID: ",e.backendService.sessionId,h.createElement("br",null),e.backendService.grpcPort>0&&h.createElement("span",null,"GRPC Port: ",e.backendService.grpcPort)))),g+=" online");break;case Z.c.CLOSED:default:d=h.createElement("span",null,"Disconnected from server"),g+=" offline"}const S=e.tileService.remainingTiles>0,C=e.activeFrame&&e.activeFrame.contourProgress>=0&&e.activeFrame.contourProgress<1;let E,I,w="contour-loading-icon";if(S||C){let t,i;S&&(t=h.createElement("span",null,"Streaming image tiles. ",e.tileService.remainingTiles," remaining")),C&&(i=h.createElement("span",null,"Streaming contours. ",Object(M.kb)(100*e.activeFrame.contourProgress,1),"% complete")),E=h.createElement(h.Fragment,null,t,C&&S&&h.createElement("br",null),i),w+=" icon-visible"}return I=E?h.createElement(f.W,{content:E},h.createElement(f.w,{icon:"cloud-download",className:w})):h.createElement(f.w,{icon:"cloud-download",className:w}),h.createElement("div",{className:"root-menu"},h.createElement(f.F,{autoFocus:!1,minimal:!0,content:o,position:y.a.BOTTOM_LEFT},h.createElement(f.z,{className:"root-menu-entry"},h.createElement(f.z.Item,{text:"File"}))),h.createElement(f.F,{autoFocus:!1,minimal:!0,content:u,position:y.a.BOTTOM_LEFT},h.createElement(f.z,{className:"root-menu-entry"},h.createElement(f.z.Item,{text:"View"}))),h.createElement(f.F,{autoFocus:!1,minimal:!0,content:this.genWidgetsMenu(),position:y.a.BOTTOM_LEFT},h.createElement(f.z,{className:"root-menu-entry"},h.createElement(f.z.Item,{text:"Widgets"}))),h.createElement(f.F,{autoFocus:!1,minimal:!0,content:p,position:y.a.BOTTOM_LEFT},h.createElement(f.z,{className:"root-menu-entry"},h.createElement(f.z.Item,{text:"Help"}))),h.createElement(wt,null),h.createElement(f.a,{className:e.darkTheme?"bp3-dark":"",isOpen:this.documentationAlertVisible,onClose:this.handleAlertDismissed,canEscapeKeyCancel:!0,canOutsideClickCancel:!0,confirmButtonText:"Dismiss"},"Documentation will open in a new tab. Please ensure any popup blockers are disabled."),I,e.preferenceStore.lowBandwidthMode&&h.createElement(f.W,{content:h.createElement("span",null,"CARTA is running in low bandwidth mode",h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Image resolution and cursor responsiveness will be reduced")))},h.createElement(f.w,{icon:"feed",className:"connectivity-icon warning"})),h.createElement(f.W,{content:d},h.createElement(f.w,{icon:"symbol-circle",className:g})),h.createElement("div",{id:"hidden-status-info"},h.createElement("span",{id:"info-session-id"},e.backendService.sessionId),h.createElement("span",{id:"info-grpc-port"},e.backendService.grpcPort),h.createElement("span",{id:"info-server-url"},e.backendService.serverUrl)))}},At=Object(d.a)(vt.prototype,"documentationAlertVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=vt))||Tt;var Rt;i(967);let Pt=Object(g.a)(Rt=class extends h.Component{static get WIDGET_CONFIG(){return{id:"placeholder",type:"placeholder",minWidth:225,minHeight:225,defaultWidth:300,defaultHeight:225,title:"Placeholder",isCloseable:!0,helpType:O.x.PLACEHOLDER}}render(){return h.createElement("div",{className:"placeholder-container"},h.createElement("h1",null,this.props.label))}})||Rt;var jt,kt,Ft;const Mt=k.a.ofType();let Dt=Object(g.a)((kt=class extends h.Component{constructor(e){super(e),Object(p.a)(this,"showCubeHistogramAlert",Ft,this),this.renderHistogramSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>h.createElement(f.B,{text:e?"Per-Cube":"Per-Channel",onClick:t,key:e?"cube":"channel"}),this.handleInvertedChanged=e=>{this.props.renderConfig.setInverted(e.currentTarget.checked)},this.handleHistogramChange=e=>{e&&!this.props.renderConfig.cubeHistogram?this.props.warnOnCubeHistogram?this.showCubeHistogramAlert=!0:this.handleAlertConfirm():this.props.renderConfig.setUseCubeHistogram(e)},this.handleAlertConfirm=()=>{this.props.onCubeHistogramSelected(),this.showCubeHistogramAlert=!1},this.handleAlertCancel=()=>{this.showCubeHistogramAlert=!1},Object(m.p)(this)}render(){if(!this.props.renderConfig)return null;const e=this.props.renderConfig;return h.createElement(h.Fragment,null,this.props.showHistogramSelect&&h.createElement(f.p,{label:"Histogram",inline:!0,disabled:this.props.disableHistogramSelect},h.createElement(Mt,{activeItem:e.useCubeHistogram,popoverProps:S.m,filterable:!1,items:[!0,!1],onItemSelect:this.handleHistogramChange,itemRenderer:this.renderHistogramSelectItem,disabled:this.props.disableHistogramSelect},h.createElement(f.e,{text:e.useCubeHistogram?"Per-Cube":"Per-Channel",rightIcon:"double-caret-vertical",alignText:"right",disabled:this.props.disableHistogramSelect}))),h.createElement(f.p,{label:"Scaling",inline:!0},h.createElement(S.o,{selectedItem:e.scaling,onItemSelect:e.setScaling})),h.createElement(f.p,{label:"Color map",inline:!0},h.createElement(S.d,{inverted:e.inverted,selectedItem:e.colorMap,onItemSelect:e.setColorMap})),h.createElement(f.p,{label:"Invert color map",inline:!0},h.createElement(f.P,{checked:e.inverted,onChange:this.handleInvertedChanged})),(e.scaling===O.u.LOG||e.scaling===O.u.POWER)&&h.createElement(f.p,{label:"Alpha",inline:!0},h.createElement(S.n,{buttonPosition:"none",value:e.alpha,onValueChange:e.setAlpha})),e.scaling===O.u.GAMMA&&h.createElement(f.p,{label:"Gamma",inline:!0},h.createElement(S.n,{min:O.O.GAMMA_MIN,max:O.O.GAMMA_MAX,stepSize:.1,minorStepSize:.01,majorStepSize:.5,value:e.gamma,onValueChange:e.setGamma})),h.createElement(f.a,{className:O.e.Instance.darkTheme?"bp3-dark":"",icon:"time",isOpen:this.showCubeHistogramAlert,onCancel:this.handleAlertCancel,onConfirm:this.handleAlertConfirm,cancelButtonText:"Cancel"},h.createElement("p",null,"Calculating a cube histogram may take a long time, depending on the size of the file. Are you sure you want to continue?")))}},Ft=Object(d.a)(kt.prototype,"showCubeHistogramAlert",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt=kt))||jt;var Nt,Lt,_t,zt,Wt,Gt=i(63);i(988);let Vt=Object(g.a)((Lt=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"render-config",type:"render-config",minWidth:250,minHeight:225,defaultWidth:650,defaultHeight:225,title:"Render Configuration",isCloseable:!0,helpType:O.x.RENDER_CONFIG}}get widgetStore(){const e=O.U.Instance;if(e.renderConfigWidgets){const t=e.renderConfigWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.n}get plotData(){const e=O.e.Instance.activeFrame;if(e&&e.renderConfig.histogram&&e.renderConfig.histogram.bins&&e.renderConfig.histogram.bins.length){const t=e.renderConfig.histogram;let i=0,n=t.bins.length-1;this.widgetStore.isAutoScaledX||(i=Math.floor((this.widgetStore.minX-t.firstBinCenter)/t.binWidth),i=Object(M.k)(i,0,t.bins.length-1),n=Math.ceil((this.widgetStore.maxX-t.firstBinCenter)/t.binWidth),n=Object(M.k)(n,0,t.bins.length-1));let r,o=t.firstBinCenter+t.binWidth*i,a=t.firstBinCenter+t.binWidth*n,s=t.bins[i],l=s;const c=n-i;if(c>0&&!isNaN(c)){r=new Array(n-i);for(let e=i;e<=n;e++)r[e-i]={x:t.firstBinCenter+t.binWidth*e,y:t.bins[e]},s=Math.min(s,t.bins[e]),l=Math.max(l,t.bins[e])}return{values:r,xMin:o,xMax:a,yMin:s,yMax:l}}return null}constructor(t){super(t),this.cachedFrame=void 0,this.cachedHistogram=void 0,Object(p.a)(this,"width",_t,this),Object(p.a)(this,"height",zt,this),this.handleScaleMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=O.e.Instance.activeFrame;i&&isFinite(t)&&t!==i.renderConfig.scaleMinVal&&i.renderConfig.setCustomScale(t,i.renderConfig.scaleMaxVal)},this.handleScaleMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=O.e.Instance.activeFrame;i&&isFinite(t)&&t!==i.renderConfig.scaleMaxVal&&i.renderConfig.setCustomScale(i.renderConfig.scaleMinVal,t)},Object(p.a)(this,"onResize",Wt,this),this.handlePercentileRankClick=e=>{const t=O.e.Instance;t.activeFrame.renderConfig.setPercentileRank(e)||(t.alertStore.showAlert(`Couldn't set percentile of rank ${e}%`),t.logStore.addError(`Couldn't set percentile of rank ${e}%`,["render"]))},this.handlePercentileRankSelectChanged=e=>{O.e.Instance.activeFrame.renderConfig.setPercentileRank(+e.currentTarget.value)},this.setCustomPercentileRank=()=>{O.e.Instance.activeFrame.renderConfig.setPercentileRank(-1)},this.handleCubeHistogramSelected=()=>{const e=O.e.Instance,t=e.activeFrame;t&&t.renderConfig&&(t.renderConfig.setUseCubeHistogram(!0),t.renderConfig.cubeHistogramProgress<1&&e.requestCubeHistogram())},this.handleCubeHistogramCancelled=()=>{const e=O.e.Instance,t=e.activeFrame;t&&t.renderConfig&&t.renderConfig.setUseCubeHistogram(!1),e.cancelCubeHistogramRequest()},this.onMinMoved=e=>{const t=O.e.Instance.activeFrame;t&&t.renderConfig&&e<t.renderConfig.scaleMaxVal&&t.renderConfig.setCustomScale(e,t.renderConfig.scaleMaxVal)},this.onMaxMoved=e=>{const t=O.e.Instance.activeFrame;t&&t.renderConfig&&e>t.renderConfig.scaleMinVal&&t.renderConfig.setCustomScale(t.renderConfig.scaleMinVal,e)},this.onGraphCursorMoved=H.throttle(e=>{this.widgetStore.setCursor(e)},100),this.genProfilerInfo=()=>{let e=[];if(void 0!==this.widgetStore.cursorX){let t;t=this.widgetStore.cursorX<.01?Object(M.jb)(this.widgetStore.cursorX,2):Object(M.kb)(this.widgetStore.cursorX,2);const i=O.e.Instance.activeFrame;i.unit&&(t+=" "+i.unit),e.push("Cursor: "+t)}return e},Object(m.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.renderConfigWidgets.has(this.props.id)||(console.log("can't find store for widget with id="+this.props.id),i.widgetsStore.renderConfigWidgets.set(this.props.id,new Qe.n));else{const e=i.widgetsStore.addRenderConfigWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)(()=>{if(i.activeFrame){const e=i.activeFrame.renderConfig.histogram;e!==this.cachedHistogram&&(this.cachedHistogram=e,this.widgetStore.clearXYBounds())}const e=this.widgetStore;if(e){const t=this.plotData;t&&e.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}})}componentDidUpdate(){const e=O.e.Instance.activeFrame;e!==this.cachedFrame&&(this.cachedFrame=e,this.widgetStore.clearXYBounds())}render(){const e=O.e.Instance,t=e.activeFrame;if(!t||!this.widgetStore)return h.createElement("div",{className:"render-config-container"},h.createElement(f.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}));let i="Value";t&&t.unit&&(i=`Value (${t.unit})`);const n=t.filename,r=`channel ${t.channel} histogram`;let o={xLabel:i,darkMode:e.darkTheme,imageName:n,plotName:r,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,showYAxisTicks:!1,showYAxisLabel:!1,graphClicked:this.onMinMoved,graphRightClicked:this.onMaxMoved,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2};if(t.renderConfig.histogram&&t.renderConfig.histogram.bins&&t.renderConfig.histogram.bins.length){const t=this.plotData;if(t){o.data=t.values;let i=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(i=ae.a.BLUE4)),o.lineColor=i,this.widgetStore.isAutoScaledX?(o.xMin=t.xMin,o.xMax=t.xMax):(o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(o.yMin=t.yMin,o.yMax=t.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5)}}t.renderConfig&&(o.markers=[{value:t.renderConfig.scaleMinVal,id:"marker-min",label:this.widgetStore.markerTextVisible?"Min":void 0,draggable:!0,dragCustomBoundary:{xMax:t.renderConfig.scaleMaxVal},dragMove:this.onMinMoved,horizontal:!1},{value:t.renderConfig.scaleMaxVal,id:"marker-max",label:this.widgetStore.markerTextVisible?"Max":void 0,draggable:!0,dragCustomBoundary:{xMin:t.renderConfig.scaleMinVal},dragMove:this.onMaxMoved,horizontal:!1}],this.widgetStore.meanRmsVisible&&t.renderConfig.histogram&&t.renderConfig.histogram.stdDev>0&&(o.markers.push({value:t.renderConfig.histogram.mean,id:"marker-mean",draggable:!1,horizontal:!1,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2,dash:[5]}),o.markers.push({value:t.renderConfig.histogram.mean,id:"marker-rms",draggable:!1,horizontal:!1,width:t.renderConfig.histogram.stdDev,opacity:.2,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2})));const a=this.width>600;let s,l;if(a){const e=O.O.PERCENTILE_RANKS.map(e=>h.createElement(f.e,{small:!0,key:e,onClick:()=>this.handlePercentileRankClick(e),active:t.renderConfig.selectedPercentileVal===e},e+"%"));e.push(h.createElement(f.e,{small:!0,key:-1,onClick:this.setCustomPercentileRank,active:-1===t.renderConfig.selectedPercentileVal},"Custom")),s=h.createElement("div",{className:"percentile-buttons"},h.createElement(f.f,{fill:!0},e))}else{const e=O.O.PERCENTILE_RANKS.map(e=>({label:e+"%",value:e}));e.push({label:"Custom",value:-1}),l=h.createElement("div",{className:"percentile-select"},h.createElement(f.p,{label:"Clip Percentile",inline:!0},h.createElement(f.r,{options:e,value:t.renderConfig.selectedPercentileVal,onChange:this.handlePercentileRankSelectChanged})))}return h.createElement("div",{className:"render-config-container"},this.width>430&&h.createElement("div",{className:"histogram-container"},a?s:l,h.createElement("div",{className:"histogram-plot"},h.createElement(S.f,o),this.width>=430&&h.createElement(S.l,{info:this.genProfilerInfo()}))),h.createElement("div",{className:"colormap-config"},h.createElement(Dt,{darkTheme:e.darkTheme,renderConfig:t.renderConfig,onCubeHistogramSelected:this.handleCubeHistogramSelected,showHistogramSelect:t.frameInfo.fileInfoExtended.depth>1,disableHistogramSelect:e.animatorStore.animationActive,warnOnCubeHistogram:0===(t.frameInfo.fileFeatureFlags&ie.a.FileFeatureFlags.CUBE_HISTOGRAMS)}),h.createElement(f.p,{label:"Clip Min",inline:!0},h.createElement(S.n,{value:t.renderConfig.scaleMinVal,selectAllOnFocus:!0,buttonPosition:"none",onBlur:this.handleScaleMinChange,onKeyDown:this.handleScaleMinChange})),h.createElement(f.p,{label:"Clip Max",inline:!0},h.createElement(S.n,{value:t.renderConfig.scaleMaxVal,selectAllOnFocus:!0,buttonPosition:"none",onBlur:this.handleScaleMaxChange,onKeyDown:this.handleScaleMaxChange})),this.width<430&&l),h.createElement(Gt.k,{isOpen:t.renderConfig.useCubeHistogram&&t.renderConfig.cubeHistogramProgress<1,progress:t.renderConfig.cubeHistogramProgress,timeRemaining:e.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleCubeHistogramCancelled,text:"Calculating cube histogram"}),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle"}))}},_t=Object(d.a)(Lt.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=Object(d.a)(Lt.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(Lt.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Lt.prototype,"widgetStore"),Lt.prototype),Object(d.a)(Lt.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(Lt.prototype,"plotData"),Lt.prototype),Wt=Object(d.a)(Lt.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Nt=Lt))||Nt;var Bt,qt,Ht,Ut,Yt,Xt,Kt,Qt;i(989);let Zt=Object(g.a)((Kt=Xt=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"region-list",type:"region-list",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Region List",isCloseable:!0,helpType:O.x.REGION_LIST}}get validRegions(){const e=O.e.Instance.activeFrame;return e?e.regionSet.regions.filter(e=>!e.isTemporary):[]}constructor(e){super(e),Object(p.a)(this,"width",Ht,this),Object(p.a)(this,"height",Ut,this),Object(p.a)(this,"onResize",Yt,this),this.handleRegionLockClicked=(e,t)=>{t.toggleLock(),e.stopPropagation()},this.handleFocusClicked=(e,t)=>{t.focusCenter(),e.stopPropagation()},this.handleRegionListDoubleClick=()=>{O.r.Instance.showRegionDialog()},Object(m.p)(this)}render(){const t=O.e.Instance,i=t.activeFrame;if(!i)return h.createElement("div",{className:"region-list-widget"},h.createElement(f.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),";",h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}));const n=11+41*(this.validRegions.length+1),r=isFinite(this.height)?Math.min(n,this.height):n;let o=e.NAME_COLUMN_DEFAULT_WIDTH;const a=this.width-10;let s=2*e.ACTION_COLUMN_DEFAULT_WIDTH+e.TYPE_COLUMN_DEFAULT_WIDTH+e.CENTER_COLUMN_DEFAULT_WIDTH+e.SIZE_COLUMN_DEFAULT_WIDTH+e.ROTATION_COLUMN_DEFAULT_WIDTH;o=a-s;let l=!0,c=!0;o<e.NAME_COLUMN_MIN_WIDTH&&(l=!1,s-=e.SIZE_COLUMN_DEFAULT_WIDTH,a>s&&(o=a-s),o<e.NAME_COLUMN_MIN_WIDTH&&(c=!1,s-=e.ROTATION_COLUMN_DEFAULT_WIDTH,o=a>s?a-s:e.NAME_COLUMN_MIN_WIDTH));const u=i.regionSet.selectedRegion,p=this.validRegions.map(t=>{let n;n=isFinite(t.center.x)&&isFinite(t.center.y)?i.validWcs?h.createElement($t,{region:t,frame:i}):`(${Object(M.kb)(t.center.x,1)}, ${Object(M.kb)(t.center.y,1)})`:"Invalid";const r=h.createElement("td",{style:{width:e.CENTER_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick},n);let a,s,p;if(l){let n;t.size&&(n=i.validWcs?h.createElement(h.Fragment,null,Object(M.t)(t.wcsSize.x,O.S),h.createElement("br",null),Object(M.t)(t.wcsSize.y,O.S)):`(${Object(M.kb)(t.size.x,1)}, ${Object(M.kb)(t.size.y,1)})`),a=h.createElement("td",{style:{width:e.SIZE_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick},t.regionType!==ie.a.RegionType.POINT&&h.createElement(f.W,{content:t.regionType===ie.a.RegionType.ELLIPSE?"Semi-major and semi-minor axes":"Width and height",position:y.a.BOTTOM},n))}return s=t.regionId?h.createElement("td",{style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleRegionLockClicked(e,t)},h.createElement(f.w,{icon:t.locked?"lock":"unlock"})):h.createElement("td",{colSpan:2,style:{width:2*e.ACTION_COLUMN_DEFAULT_WIDTH}},h.createElement(f.w,{icon:"blank"}),h.createElement(f.w,{icon:"blank"})),t.regionId&&(p=h.createElement("td",{style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleFocusClicked(e,t)},h.createElement(It.a,{icon:"center"}))),h.createElement("tr",{className:u&&u.regionId===t.regionId?"selected":"",key:t.regionId,onClick:()=>i.regionSet.selectRegion(t)},s,p,h.createElement("td",{style:{width:o},onDoubleClick:this.handleRegionListDoubleClick},t.nameString),h.createElement("td",{style:{width:e.TYPE_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick},O.N.RegionTypeString(t.regionType)),r,l&&a,c&&h.createElement("td",{style:{width:e.ROTATION_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick},Object(M.kb)(t.rotation,1)))});return h.createElement("div",{className:"region-list-widget"},h.createElement(f.s,{style:{height:r}},h.createElement("thead",{className:t.darkTheme?"dark-theme":""},h.createElement("tr",null,h.createElement("th",{style:{width:2*e.ACTION_COLUMN_DEFAULT_WIDTH}},h.createElement(f.w,{icon:"blank"}),h.createElement(f.w,{icon:"blank"})),h.createElement("th",{style:{width:o}},"Name"),h.createElement("th",{style:{width:e.TYPE_COLUMN_DEFAULT_WIDTH}},"Type"),h.createElement("th",{style:{width:e.CENTER_COLUMN_DEFAULT_WIDTH}},i.validWcs?"Center":"Pixel Center"),l&&h.createElement("th",{style:{width:e.SIZE_COLUMN_DEFAULT_WIDTH}},i.validWcs?"Size":"Size (px)"),c&&h.createElement("th",{style:{width:e.ROTATION_COLUMN_DEFAULT_WIDTH}},"P.A. (deg)"))),h.createElement("tbody",{className:t.darkTheme?"dark-theme":""},p)),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}},Xt.ACTION_COLUMN_DEFAULT_WIDTH=25,Xt.NAME_COLUMN_MIN_WIDTH=50,Xt.NAME_COLUMN_DEFAULT_WIDTH=150,Xt.TYPE_COLUMN_DEFAULT_WIDTH=90,Xt.CENTER_COLUMN_DEFAULT_WIDTH=140,Xt.SIZE_COLUMN_DEFAULT_WIDTH=160,Xt.ROTATION_COLUMN_DEFAULT_WIDTH=80,qt=Kt,Object(d.a)(qt.prototype,"validRegions",[m.i],Object.getOwnPropertyDescriptor(qt.prototype,"validRegions"),qt.prototype),Ht=Object(d.a)(qt.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ut=Object(d.a)(qt.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Yt=Object(d.a)(qt.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Bt=qt))||Bt,$t=Object(g.a)(Qt=class extends h.Component{render(){var e;O.e.Instance.overlayStore.global.explicitSystem,O.e.Instance.overlayStore.numbers.formatTypeX,O.e.Instance.overlayStore.numbers.formatTypeY;const t=this.props.frame,i=this.props.region;if(!i||!i.center||!(isFinite(i.center.x)&&isFinite(i.center.y)&&this.props.frame.validWcs))return null;if(0===i.regionId&&(null===(e=t.cursorInfo)||void 0===e?void 0:e.infoWCS))return h.createElement(h.Fragment,null,t.cursorInfo.infoWCS.x,h.createElement("br",null),t.cursorInfo.infoWCS.y);const n=Object(M.B)(this.props.frame.wcsInfoForTransformation,i.center);return n?h.createElement(h.Fragment,null,n.x,h.createElement("br",null),n.y):null}})||Qt;var Jt,ei,ti,ii,ni,ri,oi,ai,si=i(59);i(990);let li=Object(g.a)((ei=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"spatial-profiler",type:"spatial-profiler",minWidth:250,minHeight:225,defaultWidth:650,defaultHeight:225,title:"X Profile: Cursor",isCloseable:!0,helpType:O.x.SPATIAL_PROFILER}}get widgetStore(){const e=O.U.Instance;if(e.spatialProfileWidgets){const t=e.spatialProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.o}get profileStore(){const e=O.e.Instance;if(e.activeFrame){let t={fileId:this.widgetStore.fileId,regionId:this.widgetStore.regionId};-1===this.widgetStore.fileId&&(t.fileId=e.activeFrame.frameInfo.fileId);const i=`${t.fileId}-${t.regionId}`;return e.spatialProfiles.get(i)}}get frame(){return this.widgetStore?O.e.Instance.getFrame(this.widgetStore.fileId):void 0}get plotData(){const e=this.widgetStore.coordinate.indexOf("x")>=0;if(!this.frame||!this.width||!this.profileStore)return null;const t=this.profileStore.profiles.get(this.widgetStore.coordinate);if(t&&t.values&&t.values.length){let i,n;this.widgetStore.isAutoScaledX?(i=this.autoScaleHorizontalMin,n=this.autoScaleHorizontalMax):(i=Object(M.k)(this.widgetStore.minX,0,this.frame.frameInfo.fileInfoExtended.width),n=e?Object(M.k)(this.widgetStore.maxX,0,this.frame.frameInfo.fileInfoExtended.width):Object(M.k)(this.widgetStore.maxX,0,this.frame.frameInfo.fileInfoExtended.height)),i=Math.floor(i),n=Math.floor(n);let r,o,a=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=0,c=0,u=0;const p=Math.floor(Math.min(n-i+1,t.values.length)),d=this.width,h=Math.round(p/d);let g,m;if(p>0){let e=new Array(t.values.length);for(let i=0;i<t.values.length;i++)e[i]=i;if(h<=1||this.widgetStore.plotType===S.j.POINTS){g=new Array(p);for(let e=0;e<p;e++){const r=t.values[e+i],o=t.start+e+i;o>=i&&o<=n&&isFinite(r)&&(a=Math.min(a,r),s=Math.max(s,r),u++,l+=r,c+=r*r),g[e]={x:o,y:r}}}else{for(let e=0;e<p;e++){const n=t.values[e+i];isFinite(n)&&(a=Math.min(a,n),s=Math.max(s,n),u++,l+=n,c+=n*n)}g=this.widgetStore.smoothingStore.getDecimatedPoint2DArray(e,t.values,h,i,n)}m=this.widgetStore.smoothingStore.getSmoothingPoint2DArray(e,t.values,i,n)}if(u>0&&(r=l/u,o=Math.sqrt(c/u-r*r)),a===Number.MAX_VALUE)a=void 0,s=void 0;else{const e=s-a;a-=e*S.y,s+=e*S.y}return{values:g,smoothingValues:m,xMin:i,xMax:n,yMin:a,yMax:s,yMean:r,yRms:o}}return null}get exportHeader(){const e=O.e.Instance,t=[];return t.push(`region (pixel): Point[${Object(M.kb)(e.activeFrame.cursorInfo.posImageSpace.x)}, ${Object(M.kb)(e.activeFrame.cursorInfo.posImageSpace.y)}]`),e.activeFrame.cursorInfo.infoWCS&&t.push(`region (world): Point[${e.activeFrame.cursorInfo.infoWCS.x}, ${e.activeFrame.cursorInfo.infoWCS.y}]`),t}constructor(t){super(t),this.cachedFormattedCoordinates=void 0,Object(p.a)(this,"width",ti,this),Object(p.a)(this,"height",ii,this),Object(p.a)(this,"autoScaleHorizontalMin",ni,this),Object(p.a)(this,"autoScaleHorizontalMax",ri,this),Object(p.a)(this,"setAutoScaleBounds",oi,this),Object(p.a)(this,"onResize",ai,this),this.formatProfileAst=(e,t,i)=>this.frame&&this.profileStore?(0===t&&this.calculateFormattedValues(i),this.cachedFormattedCoordinates[t]):e,this.genProfilerInfo=()=>{let e=[];if(this.plotData){const i=this.widgetStore.coordinate.indexOf("x")>=0;if(this.widgetStore.isMouseMoveIntoLinePlots){const t=Object(M.i)(this.plotData.values,this.widgetStore.cursorX);if(null===t||void 0===t?void 0:t.point){const n=i?{x:t.point.x,y:this.profileStore.y}:{x:this.profileStore.x,y:t.point.x},r=this.frame.getCursorInfo(n),o=(null===r||void 0===r?void 0:r.infoWCS)?`WCS: ${i?r.infoWCS.x:r.infoWCS.y}, `:"",a=`Image: ${t.point.x} px, `,s=""+(void 0!==t.point.y?Object(M.u)(t.point.y,5):"");e.push("Cursor: ("+o+a+s+")")}}else{var t;const n=this.frame.cursorInfo,r=null===(t=this.frame.cursorValue)||void 0===t?void 0:t.value;if(null===n||void 0===n?void 0:n.posImageSpace){const t=(null===n||void 0===n?void 0:n.infoWCS)?`WCS: ${i?n.infoWCS.x:n.infoWCS.y}, `:"",o=`Image: ${Object(M.kb)(i?n.posImageSpace.x:n.posImageSpace.y)} px, `,a=""+(void 0!==r?Object(M.u)(r,5):"");e.push("Data: ("+t+o+a+")")}}this.widgetStore.meanRmsVisible&&e.push("Mean/RMS: "+(Object(M.u)(this.plotData.yMean,2)+" / "+Object(M.u)(this.plotData.yRms,2)))}return e},this.onGraphCursorMoved=H.throttle(e=>{this.widgetStore.setCursor(e)},33),Object(m.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.spatialProfileWidgets.has(this.props.id)||(console.log("can't find store for widget with id="+this.props.id),i.widgetsStore.spatialProfileWidgets.set(this.props.id,new Qe.o));else{const e=i.widgetsStore.addSpatialProfileWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)(()=>{if(this.widgetStore){const e=this.widgetStore.coordinate,t=this.plotData;if(i&&e){const t=e.toUpperCase()+" Profile",n=0===this.widgetStore.regionId?"Cursor":"Region #"+this.widgetStore.regionId;i.widgetsStore.setWidgetTitle(this.props.id,`${t}: ${n}`)}t&&this.widgetStore.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}else i.widgetsStore.setWidgetTitle(this.props.id,"X Profile: Cursor")}),Object(m.h)(()=>{const e=this.widgetStore.coordinate.indexOf("x")>=0;if(!this.frame||!this.width)return null;e?this.setAutoScaleBounds(Object(M.k)(this.frame.requiredFrameView.xMin,0,this.frame.frameInfo.fileInfoExtended.width),Object(M.k)(this.frame.requiredFrameView.xMax,0,this.frame.frameInfo.fileInfoExtended.width)):this.setAutoScaleBounds(Object(M.k)(this.frame.requiredFrameView.yMin,0,this.frame.frameInfo.fileInfoExtended.height),Object(M.k)(this.frame.requiredFrameView.yMax,0,this.frame.frameInfo.fileInfoExtended.height))},{delay:100})}calculateFormattedValues(e){if(this.cachedFormattedCoordinates&&this.cachedFormattedCoordinates.length===e.length||(this.cachedFormattedCoordinates=new Array(e.length)),!this.frame||!this.profileStore||!this.widgetStore)return;const t=this.widgetStore.coordinate.indexOf("x")>=0;let i=new O.a;if(i.add("System",O.E.Instance.global.explicitSystem),t)for(let n=0;n<e.length;n++){const t=Object(M.lb)(this.frame.wcsInfo,{x:e[n],y:this.profileStore.y}),r=R.normalizeCoordinates(this.frame.wcsInfo,t.x,t.y);this.cachedFormattedCoordinates[n]=R.getFormattedCoordinates(this.frame.wcsInfo,r.x,void 0,i.toString(),!0).x}else for(let n=0;n<e.length;n++){const t=Object(M.lb)(this.frame.wcsInfo,{x:this.profileStore.x,y:e[n]}),r=R.normalizeCoordinates(this.frame.wcsInfo,t.x,t.y);this.cachedFormattedCoordinates[n]=R.getFormattedCoordinates(this.frame.wcsInfo,void 0,r.y,i.toString(),!0).y}this.trimDecimals()}trimDecimals(){if(!this.cachedFormattedCoordinates||!this.cachedFormattedCoordinates.length)return;if(e.hasRepeats(this.cachedFormattedCoordinates))return;const t=this.cachedFormattedCoordinates[0].indexOf(".");if(-1===t)return;const i=this.cachedFormattedCoordinates[0].length-t;for(let n=i;n>0;n--){let t=this.cachedFormattedCoordinates.slice();for(let e=0;e<t.length;e++)t[e]=t[e].slice(0,-n);if(!e.hasRepeats(t))return void(this.cachedFormattedCoordinates=t);n===i&&n--}}static hasRepeats(e){if(!e||e.length<2)return!1;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];if(t===n)return!0;t=n}return!1}render(){const e=O.e.Instance;if(!this.widgetStore)return h.createElement(f.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const t=this.widgetStore.coordinate.indexOf("x")>=0,i=e.activeFrame?e.activeFrame.filename:void 0;let n={xLabel:(t?"X":"Y")+" coordinate",yLabel:"Value",darkMode:e.darkTheme,imageName:i,plotName:(t?"X":"Y")+" profile",plotType:this.widgetStore.plotType,tickTypeY:si.b.Scientific,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,zeroLineWidth:2,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1};if(e.activeFrame&&this.profileStore&&this.frame){this.frame.unit&&(n.yLabel=`Value (${this.frame.unit})`),this.frame.validWcs&&this.widgetStore.wcsAxisVisible?(n.showTopAxis=!0,n.topAxisTickFormatter=this.formatProfileAst):n.showTopAxis=!1;const i=this.plotData;if(i){n.data=i.values;let t=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(t=ae.a.BLUE4)),n.lineColor=t;const r=this.widgetStore.smoothingStore;if(r.type!==S.t.NONE){r.isOverlayOn||(n.lineColor="#00000000");let e={data:i.smoothingValues,type:r.lineType,borderColor:r.lineColor.colorHex,borderWidth:r.lineWidth,pointRadius:r.pointRadius,order:0,exportData:r.exportData};n.multiPlotPropsMap.set("smoothed",e)}this.widgetStore.isAutoScaledX?(n.xMin=i.xMin,n.xMax=i.xMax):(n.xMin=this.widgetStore.minX,n.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(n.yMin=i.yMin,n.yMax=i.yMax):(n.yMin=this.widgetStore.minY,n.yMax=this.widgetStore.maxY),i.values&&i.values.length>1.5*this.width&&(n.plotType=S.j.LINES)}const r={profiler:this.widgetStore.cursorX,image:t?this.profileStore.x:this.profileStore.y,unit:"px"};n.markers=[{value:r.image,id:"marker-image-cursor",draggable:!1,horizontal:!1}],n.markers.push({value:r.profiler,id:"marker-profiler-cursor",draggable:!1,horizontal:!1,color:e.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!0}),this.widgetStore.meanRmsVisible&&i&&isFinite(i.yMean)&&isFinite(i.yRms)&&(n.markers.push({value:i.yMean,id:"marker-mean",draggable:!1,horizontal:!0,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2,dash:[5]}),n.markers.push({value:i.yMean,id:"marker-rms",draggable:!1,horizontal:!0,width:i.yRms,opacity:.2,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2})),e.activeFrame.cursorInfo&&(n.comments=this.exportHeader)}return h.createElement("div",{className:"spatial-profiler-widget"},h.createElement("div",{className:"profile-container"},h.createElement("div",{className:"profile-plot"},h.createElement(S.f,n)),h.createElement(S.l,{info:this.genProfilerInfo()})),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},ti=Object(d.a)(ei.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=Object(d.a)(ei.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Object(d.a)(ei.prototype,"autoScaleHorizontalMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri=Object(d.a)(ei.prototype,"autoScaleHorizontalMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(ei.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(ei.prototype,"widgetStore"),ei.prototype),Object(d.a)(ei.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(ei.prototype,"profileStore"),ei.prototype),Object(d.a)(ei.prototype,"frame",[m.i],Object.getOwnPropertyDescriptor(ei.prototype,"frame"),ei.prototype),Object(d.a)(ei.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(ei.prototype,"plotData"),ei.prototype),Object(d.a)(ei.prototype,"exportHeader",[m.i],Object.getOwnPropertyDescriptor(ei.prototype,"exportHeader"),ei.prototype),oi=Object(d.a)(ei.prototype,"setAutoScaleBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.autoScaleHorizontalMin=e,this.autoScaleHorizontalMax=t}}}),ai=Object(d.a)(ei.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Jt=ei))||Jt;var ci,ui,pi,di,hi,gi,mi,fi,yi=i(91),bi=i(8),Oi=i(69),Si=i(99);i(992);!function(e){e.Name="Name",e.Description="Description",e.Display="Display"}(fi||(fi={}));let Ci=Object(g.a)((ui=class extends h.Component{static get WIDGET_CONFIG(){return{id:"spectral-line-query",type:"spectral-line-query",minWidth:500,minHeight:400,defaultWidth:750,defaultHeight:600,title:"Spectral Line Query",isCloseable:!0,helpType:O.x.SPECTRAL_LINE_QUERY}}constructor(e){super(e),Object(p.a)(this,"width",pi,this),Object(p.a)(this,"height",di,this),Object(p.a)(this,"widgetId",hi,this),Object(p.a)(this,"headerTableColumnWidths",gi,this),this.headerTableRef=void 0,this.resultTableRef=void 0,Object(p.a)(this,"onResize",mi,this),this.onTableResize=()=>{this.headerTableRef&&this.updateTableSize(this.headerTableRef,!1),this.resultTableRef&&this.updateTableSize(this.resultTableRef,!1)},this.handleRedshiftChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.widgetStore.redshiftInput;isFinite(i)&&i!==n&&(this.widgetStore.redshiftType===Qe.j.Z&&i>=0||this.widgetStore.redshiftType===Qe.j.V)?this.widgetStore.setRedshiftInput(i):e.currentTarget.value=n},this.updateHeaderTableColumnSize=(e,t)=>{this.headerTableColumnWidths&&(this.headerTableColumnWidths[e]=t)},this.handleEnterWidgetOption=(e,t)=>{if(t){const i=O.e.Instance.widgetsStore.getSpectralWidgetStoreByID(t);i&&i.setHighlighted(e)}},this.handlePlot=()=>{const e=this.widgetStore,t=O.e.Instance,i=t.activeFrame;if(e.selectedSpectralProfilerID&&i){const i=t.widgetsStore.getSpectralWidgetStoreByID(e.selectedSpectralProfilerID);i&&i.addSpectralLines(e.selectedLines)}},this.handleClear=()=>{const e=this.widgetStore,t=O.e.Instance;if(e.selectedSpectralProfilerID){const i=t.widgetsStore.getSpectralWidgetStoreByID(e.selectedSpectralProfilerID);i&&i.clearSpectralLines()}},Object(m.p)(this),this.headerTableColumnWidths=[150,70,300]}get widgetStore(){const e=O.U.Instance;if(e.spectralLineQueryWidgets){const t=e.spectralLineQueryWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.r}updateTableSize(e,t){const i=e.locator.getViewportRect();e.updateViewportRect(i),t&&e.scrollToRegion(Ot.c.column(0))}setHeaderTableColumnWidts(e){this.headerTableColumnWidths=e}renderDataColumn(e,t){return h.createElement(St.a,{key:e,name:e,cellRenderer:(e,i)=>h.createElement(ft.a,{className:"header-table-cell",key:`cell_${i}_${e}`,interactive:!0},t[e])})}renderSwitchButtonCell(e,t){const i=this.widgetStore,n=i.headerDisplay.get(t);return h.createElement(ft.a,{className:"header-table-cell",key:"cell_switch_"+e},h.createElement(h.Fragment,null,h.createElement(f.P,{className:"cell-switch-button",key:"cell_switch_button_"+e,checked:n,onChange:()=>i.setHeaderDisplay(t)})))}renderButtonColumns(e,t){return h.createElement(St.a,{key:e,name:e,cellRenderer:e=>this.renderSwitchButtonCell(e,t[e])})}createHeaderTable(){const e=[],t=[];this.widgetStore.formalizedHeaders.forEach(i=>{e.push(i.name),t.push(i.desc)});const i=[],n=this.renderDataColumn(fi.Name,e);i.push(n);const r=this.renderButtonColumns(fi.Display,e);i.push(r);const o=this.renderDataColumn(fi.Description,t);return i.push(o),h.createElement(bt.a,{ref:e=>this.headerTableRef=e,numRows:this.widgetStore.formalizedHeaders.length,enableRowReordering:!1,renderMode:Oi.a.BATCH,selectionModes:Ot.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,enableGhostCells:!0,numFrozenColumns:1,columnWidths:this.headerTableColumnWidths,onColumnWidthChanged:this.updateHeaderTableColumnSize,enableRowResizing:!1},i)}render(){var e,t;const i=O.e.Instance,n=this.widgetStore,r=h.createElement(h.Fragment,null,h.createElement(f.p,{label:"From",inline:!0},h.createElement(S.n,{value:n.queryRange[0],buttonPosition:"none",onValueChange:e=>n.setQueryRange([e,n.queryRange[1]])})),h.createElement(f.p,{label:"To",inline:!0},h.createElement(S.n,{value:n.queryRange[1],buttonPosition:"none",onValueChange:e=>n.setQueryRange([n.queryRange[0],e])}))),o=h.createElement(h.Fragment,null,h.createElement(f.p,{inline:!0},h.createElement(S.n,{value:n.queryRangeByCenter[0],buttonPosition:"none",onValueChange:e=>n.setQueryRangeByCenter([e,n.queryRangeByCenter[1]])})),h.createElement(f.p,{label:"\xb1",inline:!0},h.createElement(S.n,{value:n.queryRangeByCenter[1],buttonPosition:"none",onValueChange:e=>n.setQueryRangeByCenter([n.queryRangeByCenter[0],e])}))),a=h.createElement("div",{className:"query-panel"},h.createElement("div",{className:"query-panel-input"},h.createElement(f.p,{inline:!0},h.createElement(f.r,{options:[Qe.p.Range,Qe.p.Center],value:n.queryRangeType,onChange:e=>n.setQueryRangeType(e.currentTarget.value)})),n.queryRangeType===Qe.p.Range?r:o,h.createElement(f.p,{inline:!0},h.createElement(f.r,{options:Object.values(Qe.q),value:n.queryUnit,onChange:e=>n.setQueryUnit(e.currentTarget.value)})),h.createElement(f.k,{className:"intensity-limit"},h.createElement(f.p,{label:"Intensity Limit",inline:!0},h.createElement(f.P,{checked:n.intensityLimitEnabled,onChange:()=>n.toggleIntensityLimit()})),n.intensityLimitEnabled&&h.createElement(f.W,{content:"CDMS/JPL intensity (log)",position:y.a.BOTTOM},h.createElement(S.n,{value:n.intensityLimitValue,buttonPosition:"none",onValueChange:e=>n.setIntensityLimitValue(e)})))),h.createElement("div",null,h.createElement(f.e,{intent:yi.a.PRIMARY,onClick:n.query},"Query"))),s=h.createElement("div",{className:"redshift-panel"},h.createElement(f.p,{inline:!0},h.createElement(f.r,{options:[Qe.j.V,Qe.j.Z],value:n.redshiftType,onChange:e=>n.setRedshiftType(e.currentTarget.value)})),h.createElement(f.p,{inline:!0},h.createElement(S.n,{value:n.redshiftInput,buttonPosition:"none",onBlur:this.handleRedshiftChange,onKeyDown:this.handleRedshiftChange}))),l=n.selectedSpectralProfilerID&&O.e.Instance.widgetsStore.getSpectralWidgetStoreByID(n.selectedSpectralProfilerID),c=h.createElement(f.F,{content:h.createElement(f.z,null,O.e.Instance.widgetsStore.spectralProfilerList.map(e=>h.createElement(f.B,{key:e,text:e,onMouseEnter:()=>this.handleEnterWidgetOption(!0,e),onMouseLeave:()=>this.handleEnterWidgetOption(!1,e),onClick:()=>{this.handleEnterWidgetOption(!1,e),n.setSelectedSpectralProfiler(e)}}))),position:y.a.BOTTOM,minimal:!0},h.createElement(f.e,{disabled:O.e.Instance.widgetsStore.spectralProfilerList.length<=0,rightIcon:"caret-down"},l?n.selectedSpectralProfilerID:"----")),u={type:S.x.Normal,dataset:n.queryResult,columnHeaders:n.displayedColumnHeaders,numVisibleRows:n.numDataRows,manualSelectionProps:{isSelectingAll:n.isSelectingAllLines,isSelectingIndeterminate:n.isSelectingIndeterminatedLines,selectAllLines:n.selectAllLines,selectSingleLine:n.selectSingleLine},manualSelectionData:n.manualSelectionData,sortingInfo:n.sortingInfo,updateTableRef:e=>{this.resultTableRef=e}};let p="spectral-line-query-widget";i.darkTheme&&(p+=" dark-theme");const d=(null===(e=n.selectedLines)||void 0===e?void 0:e.length)<1e3,g=h.createElement("span",null,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,d?"":"Please select fewer than 1000 lines.",d||l?"":h.createElement("br",null),l?"":"Please select one spectral profiler."))),m=h.createElement("span",null,"Plot lines to selected profiler",g);return h.createElement("div",{className:p},h.createElement("div",{className:"bp3-dialog-body"},a,h.createElement(Si.b,{className:"body-split-pane",split:"horizontal",primary:"second",defaultSize:"60%",minSize:"5%",onChange:this.onTableResize},h.createElement(Si.a,{className:"header-table-container"},this.width>0&&this.createHeaderTable()),h.createElement(Si.a,{className:"result-table-container"},s,h.createElement("div",{className:"result-table"},this.width>0&&h.createElement(S.w,u))))),h.createElement("div",{className:"bp3-dialog-footer"},h.createElement("div",{className:"result-table-info"},h.createElement("pre",null,"Showing ",n.numDataRows," entries.",(null===(t=n.selectedLines)||void 0===t?void 0:t.length)>0?` Selected ${n.selectedLines.length} lines.`:"")),h.createElement("div",{className:"bp3-dialog-footer-actions"},h.createElement(f.p,{inline:!0,label:this.width<450?"":"Spectral Profiler"},c),h.createElement(f.W,{content:m,position:y.a.BOTTOM},h.createElement(f.b,{text:"Plot",intent:yi.a.PRIMARY,disabled:!i.activeFrame||n.queryResult.size<=0||!l||!d,onClick:this.handlePlot})),h.createElement(f.W,{content:"Clear plotted lines",position:y.a.BOTTOM},h.createElement(f.b,{text:"Clear",intent:yi.a.PRIMARY,disabled:!i.activeFrame||!l||n.queryResult.size<=0,onClick:this.handleClear})))),h.createElement(f.E,{className:bi.a.OVERLAY_SCROLL_CONTAINER,autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:n.isQuerying,usePortal:!1},h.createElement("div",{className:"query-loading-overlay"},h.createElement(f.O,{intent:yi.a.PRIMARY,size:30,value:null}))),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},pi=Object(d.a)(ui.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),di=Object(d.a)(ui.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hi=Object(d.a)(ui.prototype,"widgetId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gi=Object(d.a)(ui.prototype,"headerTableColumnWidths",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(ui.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(ui.prototype,"widgetStore"),ui.prototype),mi=Object(d.a)(ui.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t,this.headerTableRef&&this.updateTableSize(this.headerTableRef,this.props.docked),this.resultTableRef&&this.updateTableSize(this.resultTableRef,this.props.docked)}}}),Object(d.a)(ui.prototype,"setHeaderTableColumnWidts",[m.g],Object.getOwnPropertyDescriptor(ui.prototype,"setHeaderTableColumnWidts"),ui.prototype),ci=ui))||ci;var Ei;i(993);let Ii=Object(g.a)(Ei=class extends h.Component{constructor(...e){super(...e),this.handleStatsChanged=e=>{this.props.widgetStore.setStatsType(parseInt(e.target.value))},this.handleCoordinateChanged=e=>{this.props.widgetStore.setCoordinate(e.target.value)},this.smoothingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(Rn.SMOOTHING),O.e.Instance.widgetsStore.createFloatingSettingsWidget(Ri.WIDGET_CONFIG.title,this.props.id,Ri.WIDGET_CONFIG.type)},this.momentsShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(Rn.MOMENTS),O.e.Instance.widgetsStore.createFloatingSettingsWidget(Ri.WIDGET_CONFIG.title,this.props.id,Ri.WIDGET_CONFIG.type)},this.handleFrameChanged=e=>{e&&!e.stokesInfo.includes(this.props.widgetStore.coordinate)&&this.props.widgetStore.setCoordinate("z")}}render(){const e=this.props.widgetStore;let t=!1,i=!1,n="unlinked-to-selected",r=0;const o=[{value:"z",label:"Current"}];if(e.effectiveFrame&&e.effectiveFrame.regionSet){r=e.effectiveRegionId;const a=e.effectiveFrame.regionSet.regions.find(e=>e.regionId===r);t=a&&a.isClosedRegion,i=e.effectiveFrame.hasStokes;const s=e.effectiveFrame.stokesInfo;s.forEach(e=>o.push({value:e+"z",label:e}));const l="linked-to-selected-stokes";i&&e.matchActiveFrame&&e.coordinate===s[e.effectiveFrame.requiredStokes]+"z"&&(n=O.e.Instance.darkTheme?l+" dark-theme":l)}const a=[{value:ie.a.StatsType.Sum,label:Qe.s.StatsTypeString(ie.a.StatsType.Sum)},{value:ie.a.StatsType.Mean,label:Qe.s.StatsTypeString(ie.a.StatsType.Mean)},{value:ie.a.StatsType.FluxDensity,label:Qe.s.StatsTypeString(ie.a.StatsType.FluxDensity)},{value:ie.a.StatsType.Sigma,label:Qe.s.StatsTypeString(ie.a.StatsType.Sigma)},{value:ie.a.StatsType.Min,label:Qe.s.StatsTypeString(ie.a.StatsType.Min)},{value:ie.a.StatsType.Max,label:Qe.s.StatsTypeString(ie.a.StatsType.Max)},{value:ie.a.StatsType.Extrema,label:Qe.s.StatsTypeString(ie.a.StatsType.Extrema)},{value:ie.a.StatsType.RMS,label:Qe.s.StatsTypeString(ie.a.StatsType.RMS)},{value:ie.a.StatsType.SumSq,label:Qe.s.StatsTypeString(ie.a.StatsType.SumSq)}];return h.createElement("div",{className:"spectral-profiler-toolbar"},h.createElement(Xn,{widgetStore:e,onFrameChanged:this.handleFrameChanged}),h.createElement(f.p,{label:"Statistic",inline:!0,disabled:!t},h.createElement(f.r,{value:t?e.statsType:ie.a.StatsType.Mean,options:a,onChange:this.handleStatsChanged,disabled:!t})),h.createElement(f.p,{label:"Stokes",inline:!0,disabled:!i},h.createElement(f.r,{className:n,value:e.coordinate,options:o,onChange:this.handleCoordinateChanged,disabled:!i})),h.createElement(f.f,{className:"profile-buttons"},h.createElement(f.W,{content:"Smoothing"},h.createElement(f.b,{icon:h.createElement(It.a,{icon:"smoothing"}),onClick:this.smoothingShortcutClick})),h.createElement(f.W,{content:"Moments"},h.createElement(f.b,{icon:h.createElement(It.a,{icon:"moments"}),onClick:this.momentsShortcutClick}))))}})||Ei;var wi,Ti,vi,Ai,xi;i(994);let Ri=Object(g.a)((Ti=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"spectral-profiler",type:"spectral-profiler",minWidth:250,minHeight:225,defaultWidth:720,defaultHeight:275,title:"Z Profile: Cursor",isCloseable:!0,helpType:O.x.SPECTRAL_PROFILER}}get widgetStore(){const e=O.U.Instance;if(e.spectralProfileWidgets){const t=e.spectralProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.s}get profileStore(){if(this.widgetStore.effectiveFrame){let e=this.widgetStore.effectiveFrame.frameInfo.fileId;const t=this.widgetStore.effectiveRegionId,i=O.e.Instance.spectralProfiles.get(e);if(i)return i.get(t)}return null}get plotData(){const e=this.widgetStore.effectiveFrame;if(!e)return null;let t,i=this.widgetStore.effectiveRegionId;if(e.regionSet){const n=e.regionSet.regions.find(e=>e.regionId===i);n&&this.profileStore&&(t=this.profileStore.getProfile(this.widgetStore.coordinate,n.isClosedRegion?this.widgetStore.statsType:ie.a.StatsType.Sum))}if(t&&t.values&&t.values.length&&e.channelValues&&e.channelValues.length&&t.values.length===e.channelValues.length){const i=e.channelValues;let n=Math.min(i[0],i[i.length-1]),r=Math.max(i[0],i[i.length-1]);if(!this.widgetStore.isAutoScaledX){const e=Object(M.k)(this.widgetStore.minX,n,r),t=Object(M.k)(this.widgetStore.maxX,n,r);n=e,r=t}let o,a,s=Number.MAX_VALUE,l=-Number.MAX_VALUE,c=0,u=0,p=0,d=[];for(let e=0;e<i.length;e++){const o=i[e],a=t.values[e];if(o<n||o>r){if(d.length)break}else d.push({x:o,y:a}),isNaN(a)||(s=Math.min(s,a),l=Math.max(l,a),p++,c+=a,u+=a*a)}let h=this.widgetStore.smoothingStore.getSmoothingPoint2DArray(i,t.values);if(p>0&&(o=c/p,a=Math.sqrt(u/p-o*o)),s===Number.MAX_VALUE)s=void 0,l=void 0;else{const e=l-s;s-=e*S.y,l+=e*S.y}return{values:d,smoothingValues:h,xMin:n,xMax:r,yMin:s,yMax:l,yMean:o,yRms:a,progress:t.progress}}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find(e=>e.regionId===i);0!==i&&e.push("statistic: "+Qe.s.StatsTypeString(this.widgetStore.statsType)),n&&(e.push(n.regionProperties),t.validWcs&&e.push(t.getRegionWcsProperties(n)))}return e}constructor(t){super(t),Object(p.a)(this,"width",vi,this),Object(p.a)(this,"height",Ai,this),Object(p.a)(this,"onResize",xi,this),this.onChannelChanged=e=>{const t=this.widgetStore.effectiveFrame;if(null===e||void 0===e||!isFinite(e)||O.d.Instance.animationActive)return;const i=t.findChannelIndexByValue(e);t&&isFinite(i)&&i>=0&&i<t.numChannels&&t.setChannels(i,t.requiredStokes,!0)},this.onGraphCursorMoved=H.throttle(e=>{this.widgetStore.setCursor(e)},33),this.genProfilerInfo=()=>{let e=[];const t=this.widgetStore.effectiveFrame;if(t&&this.plotData){const i={profiler:this.widgetStore.cursorX,image:this.currentChannelValue,unit:t.spectralUnitStr},n=this.plotData.values,r=Object(M.i)(n,this.widgetStore.isMouseMoveIntoLinePlots?i.profiler:i.image);let o="";if(r&&r.point&&r.index>=0&&r.index<n.length){let e="";const t=r.index-1>=0?Math.abs(r.point.x-n[r.index-1].x):0;e=t>0&&t<1e-6?Object(M.w)(r.point.x):t>=1e-6&&t<.001?Object(M.kb)(r.point.x,6):Object(M.kb)(r.point.x,3);o="("+("Channel"===i.unit?"Channel "+Object(M.kb)(r.point.x):e+" "+i.unit)+", "+Object(M.jb)(r.point.y,2)+")"}e.push(`${this.widgetStore.isMouseMoveIntoLinePlots?"Cursor:":"Data:"} ${o}`),this.widgetStore.meanRmsVisible&&e.push("Mean/RMS: "+(Object(M.u)(this.plotData.yMean,2)+" / "+Object(M.u)(this.plotData.yRms,2)))}return e},this.setSelectedRange=(e,t)=>{isFinite(e)&&isFinite(t)&&(this.widgetStore.isSelectingMomentChannelRange?this.widgetStore.setSelectedChannelRange(e,t):this.widgetStore.isSelectingMomentMaskRange&&this.widgetStore.setSelectedMaskRange(e,t))},this.fillVisibleSpectralLines=()=>{let e=[];const t=this.widgetStore.transformedSpectralLines;if((null===t||void 0===t?void 0:t.length)>0){let i,n;this.plotData&&(i=this.widgetStore.isAutoScaledX?this.plotData.xMin:this.widgetStore.minX,n=this.widgetStore.isAutoScaledX?this.plotData.xMax:this.widgetStore.maxX);for(let r=0;r<t.length;r++){const o=t[r];isFinite(i)&&isFinite(n)&&o&&isFinite(o.value)&&o.value>=i&&o.value<=n&&e.push({value:o.value,id:"spectral-line-"+r,label:`${o.species} ${o.qn}`,draggable:!1,horizontal:!1,color:O.e.Instance.darkTheme?ae.a.GREEN4:ae.a.GREEN2})}}return e},Object(m.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.spectralProfileWidgets.has(this.props.id)||(console.log("can't find store for widget with id="+this.props.id),i.widgetsStore.addSpectralProfileWidget(this.props.id));else{const e=i.widgetsStore.addSpectralProfileWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)(()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){const e=this.widgetStore.coordinate,t=this.widgetStore.effectiveFrame;let n="";const r=this.plotData;if(r&&isFinite(r.progress)&&(r.progress<1?(n=`[${Object(M.kb)(100*r.progress)}% complete]`,this.widgetStore.updateStreamingDataStatus(!0)):this.widgetStore.updateStreamingDataStatus(!1)),t&&e){let t;t=2===e.length?`Z Profile (Stokes ${e[0]})`:"Z Profile";const r=this.widgetStore.effectiveRegionId,o=0===r?"Cursor":"Region #"+r,a=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`${t}: ${o} ${a} ${n}`)}r&&this.widgetStore.initXYBoundaries(r.xMin,r.xMax,r.yMin,r.yMax)}else i.widgetsStore.setWidgetTitle(this.props.id,"Z Profile: Cursor")})}get currentChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.channel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get requiredChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.requiredChannel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get linePlotSelectingMode(){return this.widgetStore.isSelectingMomentChannelRange?S.g.HORIZONTAL:this.widgetStore.isSelectingMomentMaskRange?S.g.VERTICAL:S.g.BOX}render(){const e=O.e.Instance;if(!this.widgetStore)return h.createElement(f.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const t=this.widgetStore.effectiveFrame,i=t?t.filename:void 0;let n={xLabel:"Channel",yLabel:"Value",darkMode:e.darkTheme,imageName:i,plotName:"Z profile",plotType:this.widgetStore.plotType,tickTypeY:si.b.Scientific,graphClicked:this.onChannelChanged,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,markers:this.fillVisibleSpectralLines(),mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,selectingMode:this.linePlotSelectingMode,setSelectedRange:this.setSelectedRange,zeroLineWidth:2,order:1,multiPlotPropsMap:new Map};if(this.profileStore&&t){if(t.spectralAxis&&!t.isCoordChannel){const e=t.isSpectralSystemConvertible?t.spectralSystem:""+t.spectralInfo.specsys;n.xLabel=`${e&&""!==e?e+", ":""}${t.spectralCoordinate}`}if(t.unit){let e,i="Value",r=`(${t.unit})`;t.regionSet&&(e=t.regionSet.regions.find(e=>e.regionId===this.widgetStore.effectiveRegionId),e&&e.regionType!==ie.a.RegionType.POINT&&(i=Qe.s.StatsTypeString(this.widgetStore.statsType),this.widgetStore.statsType===ie.a.StatsType.FluxDensity?r="(Jy)":this.widgetStore.statsType===ie.a.StatsType.SumSq&&(r=`(${t.unit})^2`))),n.yLabel=`${i} ${r}`}const i=this.plotData;if(i){n.data=i.values,n.opacity=i.progress<1?.15+i.progress/4:1;let t=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(t=ae.a.BLUE4)),n.lineColor=t;const r=this.widgetStore.smoothingStore;if(r.type!==S.t.NONE){r.isOverlayOn||(n.lineColor="#00000000");let e={data:i.smoothingValues,type:r.lineType,borderColor:r.lineColor.colorHex,borderWidth:r.lineWidth,pointRadius:r.pointRadius,order:0,exportData:r.exportData};n.multiPlotPropsMap.set("smoothed",e)}this.widgetStore.isAutoScaledX?(n.xMin=i.xMin,n.xMax=i.xMax):(n.xMin=this.widgetStore.minX,n.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(n.yMin=i.yMin,n.yMax=i.yMax):(n.yMin=this.widgetStore.minY,n.yMax=this.widgetStore.maxY)}isNaN(this.widgetStore.cursorX)||n.markers.push({value:this.widgetStore.cursorX,id:"marker-profiler-cursor",draggable:!1,horizontal:!1,color:e.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!0}),isNaN(this.currentChannelValue)||n.markers.push({value:this.currentChannelValue,id:"marker-channel-current",opacity:.4,draggable:!1,horizontal:!1}),isNaN(this.requiredChannelValue)||n.markers.push({value:this.requiredChannelValue,id:"marker-channel-required",draggable:!O.d.Instance.animationActive,dragMove:this.onChannelChanged,horizontal:!1}),this.widgetStore.meanRmsVisible&&i&&isFinite(i.yMean)&&isFinite(i.yRms)&&(n.markers.push({value:i.yMean,id:"marker-mean",draggable:!1,horizontal:!0,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2,dash:[5]}),n.markers.push({value:i.yMean,id:"marker-rms",draggable:!1,horizontal:!0,width:i.yRms,opacity:.2,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2}));const r=this.widgetStore.selectedRange;r&&isFinite(r.center)&&isFinite(r.width)&&n.markers.push({value:r.center,id:"marker-range",draggable:!1,horizontal:r.isHorizontal,width:r.width/2,opacity:.2,color:e.darkTheme?ae.a.GRAY4:ae.a.GRAY2}),n.comments=this.exportHeaders}let r="spectral-profiler-widget";return this.widgetStore.isHighlighted&&(r+=" linked-to-widget-highlighted"),e.darkTheme&&(r+=" dark-theme"),h.createElement("div",{className:r},h.createElement("div",{className:"profile-container"},h.createElement("div",{className:"profile-toolbar"},h.createElement(Ii,{widgetStore:this.widgetStore,id:this.props.id})),h.createElement("div",{className:"profile-plot"},h.createElement(S.f,n)),h.createElement(S.l,{info:this.genProfilerInfo()})),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},vi=Object(d.a)(Ti.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=Object(d.a)(Ti.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(Ti.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"widgetStore"),Ti.prototype),Object(d.a)(Ti.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"profileStore"),Ti.prototype),Object(d.a)(Ti.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"plotData"),Ti.prototype),Object(d.a)(Ti.prototype,"exportHeaders",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"exportHeaders"),Ti.prototype),xi=Object(d.a)(Ti.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Object(d.a)(Ti.prototype,"currentChannelValue",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"currentChannelValue"),Ti.prototype),Object(d.a)(Ti.prototype,"requiredChannelValue",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"requiredChannelValue"),Ti.prototype),Object(d.a)(Ti.prototype,"linePlotSelectingMode",[m.i],Object.getOwnPropertyDescriptor(Ti.prototype,"linePlotSelectingMode"),Ti.prototype),wi=Ti))||wi;var Pi,ji,ki,Fi,Mi,Di,Ni;i(995);let Li=Object(g.a)((Ni=Di=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"stats",type:"stats",minWidth:300,minHeight:200,defaultWidth:325,defaultHeight:250,title:"Statistics",isCloseable:!0,helpType:O.x.STATS}}get widgetStore(){const e=O.U.Instance;if(e.statsWidgets){const t=e.statsWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.t}get statsData(){const e=O.e.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId,i=this.widgetStore.effectiveRegionId;const n=e.regionStats.get(t);return n?n.get(i):null}return null}constructor(t){super(t),Object(p.a)(this,"width",ki,this),Object(p.a)(this,"height",Fi,this),Object(p.a)(this,"onResize",Mi,this),Object(m.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.statsWidgets.has(this.props.id)||(console.log("can't find store for widget with id="+this.props.id),i.widgetsStore.statsWidgets.set(this.props.id,new Qe.t));else{const e=i.widgetsStore.addStatsWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)(()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){let e="Unknown";const t=this.widgetStore.effectiveRegionId,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";if(-1===t)e="Image";else if(this.widgetStore.effectiveFrame.regionSet){const i=this.widgetStore.effectiveFrame.regionSet.regions.find(e=>e.regionId===t);i&&(e=i.nameString)}i.widgetsStore.setWidgetTitle(this.props.id,`Statistics: ${e} ${n}`)}else i.widgetsStore.setWidgetTitle(this.props.id,"Statistics")})}render(){const t=O.e.Instance;let i;if(this.statsData){const n=Math.max(0,this.width-e.NAME_COLUMN_WIDTH);let r=[];e.STATS_NAME_MAP.forEach((t,i)=>{const o=this.statsData.statistics.findIndex(e=>e.statsType===i);if(o>=0){let a="";const s=this.widgetStore.effectiveFrame;if(s&&s.unit){const e=s.unit;if(i===ie.a.StatsType.NumPixels)a="pixel(s)";else if(i===ie.a.StatsType.SumSq)a=`(${e})^2`;else if(i===ie.a.StatsType.FluxDensity){if("Jy/beam"!==e)return;a="Jy"}else a=e}const l=this.statsData.statistics[o].value,c=isFinite(l)?`${i===ie.a.StatsType.NumPixels?l:Object(M.jb)(l,4)} ${a}`:""+l;r.push(h.createElement("tr",{key:i},h.createElement("td",{style:{width:e.NAME_COLUMN_WIDTH}},t),h.createElement("td",{style:{width:n}},c)))}}),i=h.createElement(f.s,null,h.createElement("thead",{className:t.darkTheme?"dark-theme":""},h.createElement("tr",null,h.createElement("th",{style:{width:e.NAME_COLUMN_WIDTH}},"Statistic"),h.createElement("th",{style:{width:n}},"Value"))),h.createElement("tbody",{className:t.darkTheme?"dark-theme":""},r))}else i=h.createElement(f.C,{icon:"folder-open",title:"No stats data",description:"Select a valid region from the dropdown"});let n="stats-widget";return t.darkTheme&&(n+=" dark-theme"),h.createElement("div",{className:n},h.createElement("div",{className:"stats-toolbar"},h.createElement(Xn,{widgetStore:this.widgetStore})),h.createElement("div",{className:"stats-display"},i),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}},Di.STATS_NAME_MAP=new Map([[ie.a.StatsType.NumPixels,"NumPixels"],[ie.a.StatsType.Sum,"Sum"],[ie.a.StatsType.FluxDensity,"FluxDensity"],[ie.a.StatsType.Mean,"Mean"],[ie.a.StatsType.Sigma,"StdDev"],[ie.a.StatsType.Min,"Min"],[ie.a.StatsType.Max,"Max"],[ie.a.StatsType.Extrema,"Extrema"],[ie.a.StatsType.RMS,"RMS"],[ie.a.StatsType.SumSq,"SumSq"]]),Di.NAME_COLUMN_WIDTH=70,ji=Ni,ki=Object(d.a)(ji.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Fi=Object(d.a)(ji.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(d.a)(ji.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(ji.prototype,"widgetStore"),ji.prototype),Object(d.a)(ji.prototype,"statsData",[m.i],Object.getOwnPropertyDescriptor(ji.prototype,"statsData"),ji.prototype),Mi=Object(d.a)(ji.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Pi=ji))||Pi;var _i;i(996);let zi=Object(g.a)(_i=class extends h.Component{render(){return h.createElement("div",{className:"spectral-profiler-toolbar"},h.createElement(Xn,{widgetStore:this.props.widgetStore}))}})||_i;var Wi,Gi,Vi,Bi,qi;i(997);let Hi=Object(g.a)((Gi=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"histogram",type:"histogram",minWidth:400,minHeight:225,defaultWidth:650,defaultHeight:225,title:"Histogram",isCloseable:!0,helpType:O.x.HISTOGRAM}}get widgetStore(){const e=O.U.Instance;if(e.histogramWidgets){const t=e.histogramWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.h}get histogramData(){const e=O.e.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId,i=this.widgetStore.effectiveRegionId;const n=e.regionHistograms.get(t);if(!n)return null;const r=n.get(i);if(r&&r.histograms&&r.histograms.length)return r.histograms[0]}return null}get plotData(){const e=this.histogramData;if(e){let t=0,i=e.bins.length-1;this.widgetStore.isAutoScaledX||(t=Math.floor((this.widgetStore.minX-e.firstBinCenter)/e.binWidth),t=Object(M.k)(t,0,e.bins.length-1),i=Math.ceil((this.widgetStore.maxX-e.firstBinCenter)/e.binWidth),i=Object(M.k)(i,0,e.bins.length-1));let n,r=e.firstBinCenter+e.binWidth*t,o=e.firstBinCenter+e.binWidth*i,a=e.bins[t],s=a;const l=i-t;if(l>0&&!isNaN(l)){n=new Array(i-t);for(let r=t;r<=i;r++)n[r-t]={x:e.firstBinCenter+e.binWidth*r,y:e.bins[r]},a=Math.min(a,e.bins[r]),s=Math.max(s,e.bins[r])}return{values:n,xMin:r,xMax:o,yMin:a,yMax:s}}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find(e=>e.regionId===i);n&&e.push(n.regionProperties)}return e}constructor(t){super(t),this.cachedFrame=void 0,Object(p.a)(this,"width",Vi,this),Object(p.a)(this,"height",Bi,this),Object(p.a)(this,"onResize",qi,this),this.onGraphCursorMoved=H.throttle(e=>{this.widgetStore.setCursor(e)},100),Object(m.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.histogramWidgets.has(this.props.id)||(console.log("can't find store for widget with id="+this.props.id),i.widgetsStore.histogramWidgets.set(this.props.id,new Qe.h));else{const e=i.widgetsStore.addHistogramWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)(()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){let e="Unknown";const t=this.widgetStore.effectiveRegionId;if(-1===t)e="Image";else if(this.widgetStore.effectiveFrame.regionSet){const i=this.widgetStore.effectiveFrame.regionSet.regions.find(e=>e.regionId===t);i&&(e=i.nameString)}const n=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`Histogram: ${e} ${n}`)}else i.widgetsStore.setWidgetTitle(this.props.id,"Histogram");const e=this.widgetStore;if(e){const t=this.plotData;t&&e.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}})}componentDidUpdate(){const e=this.widgetStore.effectiveFrame;e!==this.cachedFrame&&(this.cachedFrame=e,this.widgetStore.clearXYBounds())}render(){const e=O.e.Instance,t=this.widgetStore.effectiveFrame;if(!t||!this.widgetStore)return h.createElement("div",{className:"histogram-widget"},h.createElement(f.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}));let i="Value";t&&t.unit&&(i=`Value (${t.unit})`);const n=t.filename,r=`channel ${t.channel} histogram`;let o={xLabel:i,yLabel:"Count",darkMode:e.darkTheme,imageName:n,plotName:r,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,tickTypeY:si.b.Scientific,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2};if(t.renderConfig.histogram&&t.renderConfig.histogram.bins&&t.renderConfig.histogram.bins.length){const t=this.plotData;if(t){o.data=t.values;let i=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(i=ae.a.BLUE4)),o.lineColor=i,this.widgetStore.isAutoScaledX?(o.xMin=t.xMin,o.xMax=t.xMax):(o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(o.yMin=t.yMin,o.yMax=t.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5)}o.comments=this.exportHeaders}let a="histogram-widget";return e.darkTheme&&(a+=" dark-theme"),h.createElement("div",{className:a},h.createElement("div",{className:"histogram-container"},h.createElement(zi,{widgetStore:this.widgetStore}),h.createElement("div",{className:"histogram-plot"},h.createElement(S.f,o))),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle"}))}},Vi=Object(d.a)(Gi.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=Object(d.a)(Gi.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(Gi.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Gi.prototype,"widgetStore"),Gi.prototype),Object(d.a)(Gi.prototype,"histogramData",[m.i],Object.getOwnPropertyDescriptor(Gi.prototype,"histogramData"),Gi.prototype),Object(d.a)(Gi.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(Gi.prototype,"plotData"),Gi.prototype),Object(d.a)(Gi.prototype,"exportHeaders",[m.i],Object.getOwnPropertyDescriptor(Gi.prototype,"exportHeaders"),Gi.prototype),qi=Object(d.a)(Gi.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Wi=Gi))||Wi;var Ui;i(998);let Yi=Object(g.a)(Ui=class extends h.Component{constructor(...e){super(...e),this.handleFractionalPolChanged=e=>{this.props.widgetStore.setFractionalPolVisible(e.target.checked)},this.smoothingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(Cn.SMOOTHING),O.e.Instance.widgetsStore.createFloatingSettingsWidget(tn.WIDGET_CONFIG.title,this.props.id,tn.WIDGET_CONFIG.type)},this.handleFrameChanged=e=>{!e||!e.regionSet||e.frameInfo.fileInfoExtended.stokes>1||this.props.widgetStore.setFractionalPolVisible(!1)}}render(){const e=this.props.widgetStore;let t=!1;return e.effectiveFrame&&e.effectiveFrame.regionSet&&(t=e.effectiveFrame.frameInfo.fileInfoExtended.stokes>1),h.createElement("div",{className:"stokes-analysis-toolbar"},h.createElement(Xn,{widgetStore:this.props.widgetStore,onFrameChanged:this.handleFrameChanged}),h.createElement(f.p,{label:"Frac. Pol.",inline:!0,disabled:!t},h.createElement(f.P,{checked:e.fractionalPolVisible,onChange:this.handleFractionalPolChanged,disabled:!t})),h.createElement(f.f,{className:"profile-buttons"},h.createElement(f.W,{content:"Smoothing"},h.createElement(f.b,{icon:h.createElement(It.a,{icon:"smoothing"}),onClick:this.smoothingShortcutClick}))))}})||Ui;var Xi,Ki,Qi,Zi,$i,Ji,en;i(999);let tn=Object(g.a)((en=Ji=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"stokes",type:"stokes",minWidth:320,minHeight:400,defaultWidth:520,defaultHeight:650,title:"Stokes Analysis",isCloseable:!0,helpType:O.x.STOKES_ANALYSIS}}get widgetStore(){const e=O.U.Instance;if(e.stokesAnalysisWidgets){const t=e.stokesAnalysisWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.u}get profileStore(){const e=O.e.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId;const i=this.widgetStore.effectiveRegionId,n=e.spectralProfiles.get(t);if(n)return n.get(i)}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find(e=>e.regionId===i);n&&(e.push(n.regionProperties),t.validWcs&&e.push(t.getRegionWcsProperties(n)))}return e}get exportQUScatterHeaders(){return this.widgetStore.smoothingStore.type===S.t.NONE?this.exportHeaders:this.exportHeaders.concat(this.widgetStore.smoothingStore.comments)}constructor(t){super(t),this.pointDefaultColor=ae.a.GRAY2,this.opacityOutRange=.1,this.channelBorder=void 0,this.minProgress=0,this.cursorInfo=void 0,this.multicolorLineColorOutRange="hsla(0, 0%, 50%, 0.5)",Object(p.a)(this,"width",Qi,this),Object(p.a)(this,"height",Zi,this),Object(p.a)(this,"onResize",$i,this),this.onChannelChanged=e=>{const t=this.widgetStore.effectiveFrame;if(!O.d.Instance.animationActive&&t&&t.channelInfo){let i,n=t.channelInfo;if(t.isCoordChannel)i=n.getChannelIndexSimple(e);else if(t.spectralAxis&&!t.spectralAxis.valid||t.isSpectralPropsEqual)i=n.getChannelIndexWCS(e);else{const r=t.convertToNativeWCS(e);isFinite(r)&&(i=n.getChannelIndexWCS(r))}null!==i&&void 0!==i&&t.setChannels(i,t.requiredStokes,!0)}},this.onScatterChannelChanged=(e,t,i)=>{const n=this.widgetStore.effectiveFrame;if(!O.d.Instance.animationActive&&i.length>0&&n&&n.channelInfo){let r=n.channelInfo;const o=this.matchZindex(e,t,i);let a;if(n.isCoordChannel)a=r.getChannelIndexSimple(o);else if(n.isSpectralPropsEqual)a=r.getChannelIndexWCS(o);else{const t=n.convertToNativeWCS(e);isFinite(t)&&(a=r.getChannelIndexWCS(t))}null!==a&&void 0!==a&&n.setChannels(a,n.requiredStokes,!0)}},this.onGraphCursorMoved=H.throttle(e=>{this.widgetStore.setlinePlotCursorX(e)},33),this.onScatterGraphCursorMoved=H.throttle((e,t)=>{this.widgetStore.setScatterPlotCursor({x:e,y:t})},33),this.fillProfilerDataInLinePlots=(e,t,i,n,r)=>{const o=Object(M.i)(t,n),a=Object(M.i)(i,n);if(o&&o.point&&a&&a.point){const t=this.matchXYindex(o.point.x,e);r.q=t.x,r.u=t.y,r.channel=t.z,r.pi=o.point.y,r.pa=a.point.y}},this.fillProfilerDataInScatterPlots=(e,t,i,n,r)=>{const o=Object(M.m)(n,e);if(o>=0){const n=e[o];if(n){const e=Object(M.i)(t,n.z),o=Object(M.i)(i,n.z);r.q=n.x,r.u=n.y,e&&e.point&&o&&o.point&&(r.channel=e.point.x,r.pi=e.point.y,r.pa=o.point.y)}}},this.getCursorInfo=(e,t,i,n,r,o,a)=>{let s=null;const l=this.widgetStore.isMouseMoveIntoLinePlots||this.widgetStore.isMouseMoveIntoScatterPlots,c=this.widgetStore.effectiveFrame?this.widgetStore.effectiveFrame.spectralUnitStr:"Channel";if(l){let o={q:NaN,u:NaN,pi:NaN,pa:NaN,channel:NaN};this.widgetStore.isMouseMoveIntoLinePlots&&this.fillProfilerDataInLinePlots(e,t,i,r,o),this.widgetStore.isMouseMoveIntoScatterPlots&&this.fillProfilerDataInScatterPlots(e,t,i,n,o),s={isMouseEntered:l,quValue:{x:o.q,y:o.u},channel:o.channel,pi:o.pi,pa:o.pa,xUnit:c}}else{const e=Object(M.i)(t,a),n=Object(M.i)(i,a);s={isMouseEntered:l,quValue:{x:o?o.x:NaN,y:o?o.y:NaN},channel:a,pi:e&&e.point?e.point.y:NaN,pa:n&&n.point?n.point.y:NaN,xUnit:c}}return s},this.genProfilerInfo=()=>{let e=[];if(!this.cursorInfo||null===this.cursorInfo.quValue.x||null===this.cursorInfo.quValue.y||isNaN(this.cursorInfo.quValue.x)||isNaN(this.cursorInfo.quValue.y))return e;if(this.widgetStore.effectiveFrame&&this.plotData){const t="Channel"===this.cursorInfo.xUnit?"Channel "+Object(M.kb)(this.cursorInfo.channel):Object(M.w)(this.cursorInfo.channel)+" "+this.cursorInfo.xUnit,i=this.widgetStore.fractionalPolVisible,n=i?", U/I: ":", U: ",r=i?", PI/I: ":", PI: ",o="("+t+(i?", Q/I: ":", Q: ")+Object(M.jb)(this.cursorInfo.quValue.x,2)+n+Object(M.jb)(this.cursorInfo.quValue.y,2)+r+Object(M.jb)(this.cursorInfo.pi,2)+", PA: "+Object(M.kb)(this.cursorInfo.pa,2)+")";e.push(`${this.cursorInfo.isMouseEntered?"Cursor:":"Data:"} ${o}`)}return e},Object(m.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.stokesAnalysisWidgets.has(this.props.id)||(console.log("can't find store for widget with id="+this.props.id),i.widgetsStore.stokesAnalysisWidgets.set(this.props.id,new Qe.u));else{const e=i.widgetsStore.addStokesWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)(()=>{if(this.widgetStore){const e=this.widgetStore.effectiveFrame;let t="";const n=this.plotData;if(n&&isFinite(n.qProgress)&&isFinite(n.uProgress)){const e=Math.min(n.qProgress,n.uProgress,n.iProgress);e<1&&(t=`[${Object(M.kb)(100*e)}% complete]`),this.minProgress=e}if(e){const e=this.widgetStore.effectiveRegionId,n=0===e?"Cursor":"Region #"+e,r=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`Stokes Analysis : ${n} ${r} ${t}`)}}else i.widgetsStore.setWidgetTitle(this.props.id,"Stokes Analysis: Cursor")})}get currentChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.channel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get requiredChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.requiredChannel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}matchZindex(e,t,i){let n=0;for(let r=0;r<i.length;r++){const o=i[r];if(o.x===e&&o.y===t){n=o.z;break}}return n}matchXYindex(e,t){let i=t[0];for(let n=0;n<t.length;n++){const r=t[n];if(r.z===e){i=r;break}}return i}static calculatePA(e,t){let i=[];if(e&&t&&e.length===t.length)for(let n=0;n<e.length;n++)i[n]=Object(M.Y)(e[n],t[n]);return i}static calculatePI(e,t){let i=[];if(e&&t&&e.length===t.length)for(let n=0;n<e.length;n++)i[n]=Object(M.Z)(e[n],t[n]);return i}static calculateFractionalPol(e,t){let i=[];if(e&&t&&e.length===t.length)for(let n=0;n<e.length;n++)i[n]=Object(M.U)(e[n],t[n]);return i}calculateCompositeProfile(t){if(this.profileStore){let i=this.profileStore.getProfile(Qe.v.LinearPolarizationQ,t),n=this.profileStore.getProfile(Qe.v.LinearPolarizationU,t);if(i&&n&&i.values&&n.values){let r=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,i.values),o=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,n.values),a=[],s=[],l=[],c=[],u=[],p=[],d=[],h=[],g=[],m=[];if(a=Array.prototype.slice.call(i.values),s=Array.prototype.slice.call(n.values),l=e.calculatePI(i.values,n.values),c=e.calculatePA(i.values,n.values),this.widgetStore.smoothingStore.type!==S.t.NONE&&(u=Array.prototype.slice.call(r.y),p=Array.prototype.slice.call(o.y),d=r.x,h=o.x,g=e.calculatePI(r.y,o.y),m=e.calculatePA(r.y,o.y)),this.widgetStore.fractionalPolVisible){let r=this.profileStore.getProfile(Qe.v.TotalIntensity,t);if(r&&r.values){if(l=e.calculateFractionalPol(l,r.values),a=e.calculateFractionalPol(a,r.values),s=e.calculateFractionalPol(s,r.values),this.widgetStore.smoothingStore.type!==S.t.NONE){let t=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,r.values);g=e.calculateFractionalPol(g,t.y),u=e.calculateFractionalPol(u,t.y),p=e.calculateFractionalPol(p,t.y)}return{qProfile:a,qProfileSmoothed:u,qSmoothedX:d,uProfile:s,uProfileSmoothed:p,uSmoothedX:h,piProfile:l,piProfileSmoothed:g,paProfile:c,paProfileSmoothed:m,qProgress:i.progress,uProgress:n.progress,iProgress:r.progress}}}return{qProfile:a,qProfileSmoothed:u,qSmoothedX:d,uProfile:s,uProfileSmoothed:p,uSmoothedX:h,piProfile:l,piProfileSmoothed:g,paProfile:c,paProfileSmoothed:m,qProgress:i.progress,uProgress:n.progress,iProgress:1}}}return null}getChartAreaWH(e){return e&&e.right&&e.bottom?{width:Math.abs(e.right-e.left),height:Math.abs(e.bottom-e.top)}:{width:0,height:0}}resizeScatterData(e,t,i,n){if(!this.widgetStore.equalAxes)return{xMin:e,xMax:t,yMin:i,yMax:n};let r=Math.max(Math.abs(e),Math.abs(t)),o=Math.max(Math.abs(i),Math.abs(n));if(this.widgetStore.scatterChartArea){let e=this.getChartAreaWH(this.widgetStore.scatterChartArea);if(0!==e.width&&0!==e.height){let t=e.width/e.height;t<1&&(o*=1/t),t>1&&(r*=t)}}return{xMin:-r,xMax:r,yMin:-o,yMax:o}}calculateXYborder(e,t,i,n){const r=Object(M.S)(e),o=Object(M.S)(t);let a=r.minVal,s=r.maxVal,l=o.minVal,c=o.maxVal;if(!this.widgetStore.isLinePlotsAutoScaledX&&i){const e=Object(M.k)(this.widgetStore.sharedMinX,a,s),t=Object(M.k)(this.widgetStore.sharedMaxX,a,s);a=e,s=t}if(!this.widgetStore.isQUScatterPlotAutoScaledX&&!i&&n===Qe.v.PolarizationQU){const e=Object(M.k)(this.widgetStore.quScatterMinX,a,s),t=Object(M.k)(this.widgetStore.quScatterMaxX,a,s);a=e,s=t}if(!this.widgetStore.isQUScatterPlotAutoScaledY&&!i&&n===Qe.v.PolarizationQU){const e=Object(M.k)(this.widgetStore.quScatterMinY,l,c),t=Object(M.k)(this.widgetStore.quScatterMaxY,l,c);l=e,c=t}if(l===Number.MAX_VALUE&&(l=void 0,c=void 0),!this.widgetStore.isPolAngleAutoScaledY&&i&&n===Qe.v.PolarizationAngle){const e=Object(M.k)(this.widgetStore.polAngleMinY,l,c),t=Object(M.k)(this.widgetStore.polAngleMaxY,l,c);l=e,c=t}if(!this.widgetStore.isPolIntensityAutoScaledY&&i&&n===Qe.v.PolarizedIntensity){const e=Object(M.k)(this.widgetStore.polIntensityMinY,l,c),t=Object(M.k)(this.widgetStore.polIntensityMaxY,l,c);l=e,c=t}if(this.widgetStore.isQULinePlotAutoScaledY||!i||n!==Qe.v.LinearPolarizationQ&&n!==Qe.v.LinearPolarizationU){if(i){const e=c-l;l-=e*S.y,c+=e*S.y}}else{const e=Object(M.k)(this.widgetStore.quMinY,l,c),t=Object(M.k)(this.widgetStore.quMaxY,l,c);l=e,c=t}return{xMin:a,xMax:s,yMin:l,yMax:c}}assembleLinePlotData(e,t,i){if(e&&e.length&&t&&e.length===t.length){let n=this.calculateXYborder(t,e,!0,i),r=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i];o<n.xMin||o>n.xMax||a<n.yMin||a>n.yMax?r.push({x:o,y:NaN}):r.push({x:o,y:a})}return{dataset:r,border:n}}return null}assembleScatterPlotData(e,t,i){const n=this.widgetStore.effectiveFrame;if(e&&e.length&&t&&t.length&&n.channelValues&&n.channelValues.length&&e.length===t.length&&(e.length===n.channelValues.length||this.widgetStore.smoothingStore.type===S.t.BINNING)){const r=n.channelValues;let o=this.calculateXYborder(e,t,!1,i),a=[],s=this.resizeScatterData(o.xMin,o.xMax,o.yMin,o.yMax);this.widgetStore.scatterOutRangePointsZIndex=[];for(let i=0;i<r.length;i++){const n=e[i],s=t[i],l=r[i];a.push({x:n,y:s,z:l}),(n<o.xMin||n>o.xMax||s<o.yMin||s>o.yMax)&&this.widgetStore.scatterOutRangePointsZIndex.push(l)}return{dataset:a,border:s}}return null}compareVariable(e,t,i,n){return e===t&&e===i&&e===n&&null!==e}getScatterColor(e,t){const i=this.widgetStore.colorPixel.color,n=this.widgetStore.colorPixel.size;t||(e=1-e);const r=4*Math.round(e*n),o=this.widgetStore.pointTransparency?this.widgetStore.pointTransparency:1;return`rgba(${i[r]}, ${i[r+1]}, ${i[r+2]}, ${o})`}frequencyIncreases(e){return!(e[0].z>e[e.length-1].z)}fillScatterColor(e,t,i){let n=[];if(e&&e.length&&i&&t){let i=t;const r=`hsla(0, 0%, 50%, ${this.opacityOutRange})`,o=this.frequencyIncreases(e),a=[];for(let t=0;t<e.length;t++){const n=e[t];n.z>=i.xMin&&n.z<=i.xMax&&a.push(n)}const s=Object(M.T)(a);for(let t=0;t<e.length;t++){const a=e[t];let l=this.pointDefaultColor,c=!0;a.z>=i.xMin&&a.z<=i.xMax&&(c=!1);const u=(a.z-s.minVal)/(s.maxVal-s.minVal);l=c?r:this.getScatterColor(u,o),n.push(l)}}return n}fillLineColor(e,t){let i=[];if(this.widgetStore.plotType!==S.j.POINTS&&i.push(""),e&&e.length&&t)for(let n=0;n<e.length;n++){const r=e[n];this.widgetStore.scatterOutRangePointsZIndex&&this.widgetStore.scatterOutRangePointsZIndex.indexOf(r.x)>=0?i.push(this.multicolorLineColorOutRange):i.push(t)}return i}closestChannel(e,t){for(var i,n=0,r=t.length-1;r-n>1;)t[i=Math.floor((n+r)/2)].z<e?n=i:r=i;return e-t[n].z<=t[r].z-e?t[n].z:t[r].z}getScatterChannel(e,t,i){let n={currentChannel:e[0],hoveredChannel:e[0]};if(e&&e.length&&i&&t){let i=t.channelCurrent,r=t.channelHovered;if(i){let t=i;r&&(t=this.closestChannel(r,e),this.channelBorder&&0!==this.channelBorder.xMin&&(t>this.channelBorder.xMax||t<this.channelBorder.xMin||!this.widgetStore.isMouseMoveIntoLinePlots)&&(t=i));for(let r=0;r<e.length;r++){const o=e[r];o.z===t&&(n.hoveredChannel=o),o.z===i&&(n.currentChannel=o)}}}return n}get plotData(){const e=this.widgetStore.effectiveFrame;if(!e)return null;let t,i=this.widgetStore.effectiveRegionId;if(e.regionSet){const n=e.regionSet.regions.find(e=>e.regionId===i);n&&(t=this.calculateCompositeProfile(n.isClosedRegion?this.widgetStore.statsType:ie.a.StatsType.Sum))}let n=e.channelInfo;if(t&&n){let i=this.assembleScatterPlotData(t.qProfile,t.uProfile,Qe.v.PolarizationQU),n=this.assembleScatterPlotData(t.qProfileSmoothed,t.uProfileSmoothed,Qe.v.PolarizationQU),r=this.assembleLinePlotData(t.piProfile,e.channelValues,Qe.v.PolarizedIntensity),o=this.assembleLinePlotData(t.paProfile,e.channelValues,Qe.v.PolarizationAngle),a=this.assembleLinePlotData(t.qProfile,e.channelValues,Qe.v.LinearPolarizationQ),s=this.assembleLinePlotData(t.uProfile,e.channelValues,Qe.v.LinearPolarizationU),l=this.assembleLinePlotData(t.piProfileSmoothed,t.qSmoothedX,Qe.v.PolarizedIntensity),c=this.assembleLinePlotData(t.paProfileSmoothed,t.qSmoothedX,Qe.v.PolarizationAngle);return{qValues:a,uValues:s,piValues:r,paValues:o,qSmoothedValues:this.assembleLinePlotData(t.qProfileSmoothed,t.qSmoothedX,Qe.v.LinearPolarizationQ),uSmoothedValues:this.assembleLinePlotData(t.uProfileSmoothed,t.uSmoothedX,Qe.v.LinearPolarizationU),piSmoothedValues:l,paSmoothedValues:c,quValues:i,quSmoothedValues:n,qProgress:t.qProgress,uProgress:t.uProgress,iProgress:t.iProgress}}return null}render(){const t=O.e.Instance;if(!this.widgetStore)return h.createElement(f.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const i=this.widgetStore.effectiveFrame,n=this.widgetStore.effectiveFrame?this.widgetStore.effectiveFrame.filename:void 0;let r={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeY:si.b.Scientific,showXAxisTicks:!1,showXAxisLabel:!1,showLegend:!0,xTickMarkLength:0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setQULinePlotYBounds,graphZoomedXY:this.widgetStore.setQULinePlotsXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,multiColorMultiLinesColors:new Map,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map},o={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeY:si.b.Scientific,showXAxisTicks:!1,showXAxisLabel:!1,xTickMarkLength:0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setPolIntensityYBounds,graphZoomedXY:this.widgetStore.setPolIntensityXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1},a={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeY:si.b.Integer,showXAxisTicks:!0,showXAxisLabel:!0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setPolAngleYBounds,graphZoomedXY:this.widgetStore.setPolAngleXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1},s={xLabel:"Channel",yLabel:"Channel",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeX:si.b.Scientific,tickTypeY:si.b.Scientific,showXAxisTicks:!0,showXAxisLabel:!0,plotType:S.j.POINTS,zeroLineWidth:2,isGroupSubPlot:!0,colorRangeEnd:240,zIndex:!0,graphCursorMoved:this.onScatterGraphCursorMoved,graphClicked:this.onScatterChannelChanged,graphZoomReset:this.widgetStore.clearScatterPlotXYBounds,mouseEntered:this.widgetStore.setMouseMoveIntoScatterPlots,scrollZoom:!0,graphZoomedXY:this.widgetStore.setQUScatterPlotXYBounds,updateChartArea:this.widgetStore.setScatterChartAres,pointRadius:this.widgetStore.scatterPlotPointSize},l="profile-container-"+e.calculateLayout(this.width,this.height),c={xMin:0,xMax:0};if(this.profileStore&&i){const e={profiler:this.widgetStore.linePlotcursorX,image:this.currentChannelValue,unit:i.spectralUnitStr},n=this.plotData;let l={channelCurrent:0,channelHovered:0};if(n&&n.piValues&&n.paValues&&n.qValues&&n.uValues&&n.quValues){o.data=n.piValues.dataset,a.data=n.paValues.dataset,s.data=this.widgetStore.smoothingStore.type===S.t.NONE?n.quValues.dataset:n.quSmoothedValues.dataset;const l=this.minProgress<1?.15+this.minProgress/4:1;r.opacity=l,o.opacity=l,a.opacity=l,r.opacity=l;let u=this.widgetStore.primaryLineColor.colorHex,p=this.widgetStore.secondaryLineColor.colorHex;t.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(u=ae.a.BLUE4),this.widgetStore.secondaryLineColor.fixed||(p=ae.a.ORANGE4)),o.lineColor=u,a.lineColor=u;let d={data:n.qValues.dataset,type:this.widgetStore.plotType,borderColor:u,order:1},h={data:n.uValues.dataset,type:this.widgetStore.plotType,borderColor:p,order:1};r.multiPlotPropsMap.set(Qe.v.LinearPolarizationQ,d),r.multiPlotPropsMap.set(Qe.v.LinearPolarizationU,h);const g=this.widgetStore.smoothingStore;if(g.type!==S.t.NONE&&n.qSmoothedValues&&n.uSmoothedValues&&n.piSmoothedValues&&n.piSmoothedValues){let e={data:n.qSmoothedValues.dataset,type:g.lineType,borderColor:u,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},t={data:n.uSmoothedValues.dataset,type:g.lineType,borderColor:p,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},i={data:n.piSmoothedValues.dataset,type:g.lineType,borderColor:u,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},s={data:n.paSmoothedValues.dataset,type:g.lineType,borderColor:g.colorMap.get(Qe.v.PolarizationAngle)?g.colorMap.get(Qe.v.PolarizationAngle).colorHex:u,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1};r.multiPlotPropsMap.set(Qe.v.LinearPolarizationQ+"_smoothed",e),r.multiPlotPropsMap.set(Qe.v.LinearPolarizationU+"_smoothed",t),o.multiPlotPropsMap.set("smoothed",i),a.multiPlotPropsMap.set("smoothed",s)}const m=1===n.qProgress&&1===n.uProgress&&1===n.iProgress;let f,y;g.type===S.t.NONE||g.isOverlayOn?(f=m?this.fillLineColor(n.qValues.dataset,u):[],y=m?this.fillLineColor(n.uValues.dataset,p):[],o.multiColorSingleLineColors=m?this.fillLineColor(n.piValues.dataset,u):[],a.multiColorSingleLineColors=m?this.fillLineColor(n.paValues.dataset,u):[]):(f=m?this.fillLineColor(n.qValues.dataset,"#00000000"):[],y=m?this.fillLineColor(n.uValues.dataset,"#00000000"):[],o.multiColorSingleLineColors=m?this.fillLineColor(n.piValues.dataset,"#00000000"):[],a.multiColorSingleLineColors=m?this.fillLineColor(n.paValues.dataset,"#00000000"):[]),r.multiColorMultiLinesColors.set(Qe.v.LinearPolarizationQ,f),r.multiColorMultiLinesColors.set(Qe.v.LinearPolarizationU,y);let b=n.qValues.border,O=n.uValues.border,C=n.piValues.border,E=n.paValues.border,I=n.quValues.border;if(this.compareVariable(b.xMin,O.xMin,C.xMin,E.xMin)&&this.compareVariable(b.xMax,O.xMax,C.xMax,E.xMax)){c={xMin:E.xMin,xMax:E.xMax},this.channelBorder={xMin:E.xMin,xMax:E.xMax},this.widgetStore.isLinePlotsAutoScaledX?(r.xMin=b.xMin,r.xMax=b.xMax,o.xMin=C.xMin,o.xMax=C.xMax,a.xMin=E.xMin,a.xMax=E.xMax):(r.xMin=this.widgetStore.sharedMinX,r.xMax=this.widgetStore.sharedMaxX,o.xMin=this.widgetStore.sharedMinX,o.xMax=this.widgetStore.sharedMaxX,a.xMin=this.widgetStore.sharedMinX,a.xMax=this.widgetStore.sharedMaxX,c={xMin:this.widgetStore.sharedMinX,xMax:this.widgetStore.sharedMaxX});let e=this.fillScatterColor(s.data,c,!0);s.dataBackgroundColor=e,this.widgetStore.isQULinePlotAutoScaledY?(r.yMin=b.yMin<O.yMin?b.yMin:O.yMin,r.yMax=b.yMax>O.yMax?b.yMax:O.yMax):(r.yMin=this.widgetStore.quMinY,r.yMax=this.widgetStore.quMaxY),this.widgetStore.isPolIntensityAutoScaledY?(o.yMin=C.yMin,o.yMax=C.yMax):(o.yMin=this.widgetStore.polIntensityMinY,o.yMax=this.widgetStore.polIntensityMaxY),this.widgetStore.isPolAngleAutoScaledY?(a.yMin=E.yMin,a.yMax=E.yMax):(a.yMin=this.widgetStore.polAngleMinY,a.yMax=this.widgetStore.polAngleMaxY)}this.widgetStore.isQUScatterPlotAutoScaledX?(s.xMin=I.xMin,s.xMax=I.xMax):(s.xMin=this.widgetStore.quScatterMinX,s.xMax=this.widgetStore.quScatterMaxX),this.widgetStore.isQUScatterPlotAutoScaledY?(s.yMin=I.yMin,s.yMax=I.yMax):(s.yMin=this.widgetStore.quScatterMinY,s.yMax=this.widgetStore.quScatterMaxY);let w={profiler:{x:this.widgetStore.scatterPlotCursorX,y:this.widgetStore.scatterPlotCursorY},image:this.matchXYindex(e.image,s.data),unit:i.spectralUnitStr};s.cursorXY=w,this.cursorInfo=this.getCursorInfo(s.data,this.widgetStore.smoothingStore.type===S.t.NONE?n.piValues.dataset:n.piSmoothedValues.dataset,this.widgetStore.smoothingStore.type===S.t.NONE?n.paValues.dataset:n.paSmoothedValues.dataset,w.profiler,e.profiler,w.image,e.image),this.cursorInfo&&this.cursorInfo.quValue&&(s.cursorNearestPoint=this.cursorInfo.quValue)}if(a.yLabel="PA (Degrees)",this.widgetStore.fractionalPolVisible?(r.yLabel="Value (%)",o.yLabel="PI/I (%)",s.xLabel="Q/I (%)",s.yLabel="U/I (%)"):(r.yLabel="Value ("+i.unit+")",o.yLabel="PI ("+i.unit+")",s.xLabel="Stokes Q ("+i.unit+")",s.yLabel="Stokes U ("+i.unit+")"),i.spectralAxis&&!i.isCoordChannel){const e=i.isSpectralSystemConvertible?i.spectralSystem:""+i.spectralInfo.specsys;a.xLabel=o.xLabel=r.xLabel=`${e&&""!==e?e+", ":""}${i.spectralCoordinate}`}if(a.markers=[],o.markers=[],r.markers=[],this.cursorInfo&&this.cursorInfo.channel&&this.widgetStore.isMouseMoveIntoScatterPlots){let e={value:this.cursorInfo.channel,id:"marker-profiler-cursor-stokes2",draggable:!1,horizontal:!1,color:t.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!this.widgetStore.isMouseMoveIntoLinePlots,interactionMarker:!0};a.markers.push(e),o.markers.push(e),r.markers.push(e)}if(null!==e.profiler){let i={value:e.profiler,id:"marker-profiler-cursor-stokes",draggable:!1,horizontal:!1,color:t.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!this.widgetStore.isMouseMoveIntoLinePlots};a.markers.push(i),o.markers.push(i),r.markers.push(i),i&&i.value&&void 0!==typeof i.value&&(l.channelHovered=i.value)}if(null!==e.image){let t={value:e.image,id:"marker-channel-current",opacity:.4,draggable:!1,horizontal:!1},i={value:this.requiredChannelValue,id:"marker-channel-required",draggable:!O.d.Instance.animationActive,dragMove:this.onChannelChanged,horizontal:!1};a.markers.push(t,i),o.markers.push(t,i),r.markers.push(t,i),t&&t.value&&void 0!==typeof t.value&&(l.channelCurrent=t.value)}if(s.data&&s.data.length&&c){const e=this.getScatterChannel(s.data,l,!0);s.indicatorInteractionChannel={currentChannel:e.currentChannel,hoveredChannel:e.hoveredChannel,start:this.widgetStore.isMouseMoveIntoLinePlots}}a.comments=this.exportHeaders,o.comments=this.exportHeaders,r.comments=this.exportHeaders,s.comments=this.exportQUScatterHeaders}return h.createElement("div",{className:"stokes-widget"},h.createElement("div",{className:l},h.createElement("div",{className:"profile-plot-toolbar"},h.createElement(Yi,{widgetStore:this.widgetStore,id:this.props.id})),h.createElement("div",{className:"profile-plot-qup"},h.createElement("div",{className:"profile-plot-qu"},h.createElement(S.f,r)),h.createElement("div",{className:"profile-plot-pi"},h.createElement(S.f,o)),h.createElement("div",{className:"profile-plot-pa"},h.createElement(S.f,a))),h.createElement("div",{className:"profile-plot-qvsu"},h.createElement(S.p,s)),h.createElement(S.l,{info:this.genProfilerInfo()})),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},Ji.layoutRatioCutoffs={vertical:.5,horizontal:2},Ji.calculateLayout=(e,t)=>{if(e&&t){let i=e/t,n=Math.abs(i-tn.layoutRatioCutoffs.vertical),r=Math.abs(i-tn.layoutRatioCutoffs.horizontal),o=Math.min(n,r);return o===n?"vertical":o===r?"horizontal":null}return null},Ki=en,Qi=Object(d.a)(Ki.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zi=Object(d.a)(Ki.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(Ki.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"widgetStore"),Ki.prototype),Object(d.a)(Ki.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"profileStore"),Ki.prototype),Object(d.a)(Ki.prototype,"exportHeaders",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"exportHeaders"),Ki.prototype),Object(d.a)(Ki.prototype,"exportQUScatterHeaders",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"exportQUScatterHeaders"),Ki.prototype),$i=Object(d.a)(Ki.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t,this.widgetStore.clearScatterPlotXYBounds()}}}),Object(d.a)(Ki.prototype,"currentChannelValue",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"currentChannelValue"),Ki.prototype),Object(d.a)(Ki.prototype,"requiredChannelValue",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"requiredChannelValue"),Ki.prototype),Object(d.a)(Ki.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(Ki.prototype,"plotData"),Ki.prototype),Xi=Ki))||Xi;var nn,rn,on,an,sn,ln,cn,un,pn,dn,hn,gn,mn,fn=i(112),yn=i(114);i(1e3);!function(e){e.Name="Name",e.Unit="Unit",e.Type="Type",e.Display="Display",e.Description="Description"}(gn||(gn={})),function(e){e.Equal="==",e.NotEqual="!=",e.LessorOrEqual="<=",e.Lesser="<",e.GreaterOrEqual=">=",e.Greater=">",e.RangeClosed="...",e.RangeOpen=".."}(mn||(mn={}));let bn=Object(g.a)((hn=dn=class e extends h.Component{get catalogFileId(){var e;return null===(e=O.k.Instance.catalogProfiles)||void 0===e?void 0:e.get(this.props.id)}static get WIDGET_CONFIG(){return{id:"catalog-overlay",type:"catalog-overlay",minWidth:620,minHeight:400,defaultWidth:620,defaultHeight:400,title:"Catalog",isCloseable:!0,helpType:O.x.CATALOG_OVERLAY,componentId:"catalog-overlay-component"}}get widgetStore(){const e=O.k.Instance.catalogWidgets.get(this.catalogFileId);return O.U.Instance.catalogWidgets.get(e)}get profileStore(){return O.k.Instance.catalogProfileStores.get(this.catalogFileId)}get catalogDataInfo(){const e=this.profileStore,t=this.widgetStore;let i,n=0;return e&&t&&(i=e.catalogData,n=e.numVisibleRows,e.regionSelected&&(t.showSelectedData?(i=e.selectedData,n=e.regionSelected,this.catalogTableRef&&this.scrollToRegion(this.catalogTableRef,Ot.c.row(0))):this.catalogTableRef&&t.catalogTableAutoScroll&&this.scrollToRegion(this.catalogTableRef,e.autoScrollRowNumber))),{dataset:i,numVisibleRows:n}}get enablePlotButton(){const e=this.profileStore,t=this.widgetStore;return t.catalogPlotType===Qe.c.Histogram?t.xAxis!==O.i.NONE&&!e.loadingData&&!e.updatingDataStream:t.xAxis!==O.i.NONE&&t.yAxis!==O.i.NONE&&!e.loadingData&&!e.updatingDataStream}constructor(e){super(e),Object(p.a)(this,"catalogTableRef",on,this),Object(p.a)(this,"height",an,this),Object(p.a)(this,"width",sn,this),this.catalogHeaderTableRef=void 0,this.catalogFileNames=void 0,Object(p.a)(this,"handleCatalogFileChange",ln,this),Object(p.a)(this,"handleFileCloseClick",cn,this),this.scrollToRegion=(e,t)=>{var i,n;const r=e.state,o=null===r||void 0===r?void 0:r.numFrozenColumnsClamped,a=null===r||void 0===r?void 0:r.numFrozenRowsClamped;let s=e.state.viewportRect;s||(s=e.locator.getViewportRect());const l=null===(i=s)||void 0===i?void 0:i.left,c=null===(n=s)||void 0===n?void 0:n.top,{scrollLeft:u,scrollTop:p}=fn.a(t,l,c,e.grid.getCumulativeWidthBefore,e.grid.getCumulativeHeightBefore,a,o),d=e.shouldDisableHorizontalScroll()?0:u,h=e.shouldDisableVerticalScroll()?0:p;e.quadrantStackInstance.scrollToPosition(d,h)},Object(p.a)(this,"onCatalogDataTableRefUpdated",un,this),this.onControlHeaderTableRef=e=>{this.catalogHeaderTableRef=e},Object(p.a)(this,"onResize",pn,this),this.renderAxisPopOver=(e,t)=>h.createElement(f.B,{key:e,text:e,onClick:t.handleClick}),this.filterColumn=(e,t)=>new yn.a([t]).search(e).length>0,this.updateHeaderTableColumnSize=(e,t)=>{const i=this.widgetStore;i.headerTableColumnWidts&&(i.headerTableColumnWidts[e]=t)},this.resetSelectedPointIndices=()=>{const e=this.profileStore,t=this.widgetStore;e.setSelectedPointIndices([],!1),t.setCatalogTableAutoScroll(!1),t.setShowSelectedData(!1)},this.handleFilterRequest=()=>{const e=this.profileStore,t=this.widgetStore,i=O.e.Instance;if(e&&i){e.updateTableStatus(!1),e.resetFilterRequestControlParams(),this.resetSelectedPointIndices(),i.catalogStore.clearImageCoordsData(this.catalogFileId);let n=e.updateRequestDataSize;n.imageBounds.xColumnName=t.xAxis,n.imageBounds.yColumnName=t.yAxis,n.fileId=e.catalogInfo.fileId,n.filterConfigs=this.getUserFilters(),n.columnIndices=e.displayedColumnHeaders.map(e=>e.columnIndex),i.sendCatalogFilter(n)}},this.updateSortRequest=(e,t)=>{const i=this.profileStore,n=O.e.Instance;if(i&&n){i.resetFilterRequestControlParams(),this.resetSelectedPointIndices(),n.catalogStore.clearImageCoordsData(this.catalogFileId);let r=i.updateRequestDataSize;r.sortColumn=e,r.sortingType=t,i.setSortingInfo(e,t),n.sendCatalogFilter(r)}},this.updateByInfiniteScroll=()=>{const e=this.profileStore,t=this.widgetStore.showSelectedData;if(!1===e.loadingData&&e.updateMode===O.m.TableUpdate&&e.shouldUpdateData&&!t){e.setUpdateMode(O.m.TableUpdate);const t=this.profileStore.updateRequestDataSize;t.columnIndices=e.displayedColumnHeaders.map(e=>e.columnIndex),O.e.Instance.sendCatalogFilter(t),e.setLoadingDataStatus(!0)}},this.handleResetClick=()=>{const e=this.profileStore,t=O.e.Instance;e&&(e.resetCatalogFilterRequest(),this.resetSelectedPointIndices(),t.catalogStore.clearImageCoordsData(this.catalogFileId),t.sendCatalogFilter(e.catalogFilterRequest))},this.handlePlotClick=()=>{const e=this.profileStore,t=O.e.Instance,i=t.activeFrame,n=O.k.Instance,r=this.widgetStore;switch(r.catalogPlotType){case Qe.c.ImageOverlay:if(e.setUpdateMode(O.m.ViewUpdate),i){const t=e.get2DPlotData(r.xAxis,r.yAxis,e.catalogData),o=i.validWcs?i.wcsInfo:0,a=this.catalogFileId;n.clearImageCoordsData(a),n.updateCatalogData(a,t.wcsX,t.wcsY,o,t.xHeaderInfo.units,t.yHeaderInfo.units,e.catalogCoordinateSystem.system),e.setSelectedPointIndices(e.selectedPointIndices,!1),r.setCatalogTableAutoScroll(!1)}if(e.shouldUpdateData){e.setUpdatingDataStream(!0);let i=e.updateRequestDataSize;t.sendCatalogFilter(i)}break;case Qe.c.D2Scatter:const o={xColumnName:r.xAxis,yColumnName:r.yAxis,plotType:r.catalogPlotType},a=t.widgetsStore.createFloatingCatalogPlotWidget(o);n.setCatalogPlots(a.widgetComponentId,this.catalogFileId,a.widgetStoreId);break;case Qe.c.Histogram:const s={xColumnName:r.xAxis,plotType:r.catalogPlotType},l=t.widgetsStore.createFloatingCatalogPlotWidget(s);n.setCatalogPlots(l.widgetComponentId,this.catalogFileId,l.widgetStoreId)}},this.handlePlotTypeChange=e=>{this.widgetStore.setCatalogPlotType(e)},this.onCatalogTableDataSelected=e=>{const t=this.profileStore,i=this.widgetStore;if(!i.showSelectedData)if(1===e.length){const n=t.selectedPointIndices;let r=!1;1===n.length&&(r=n.includes(e[0])),r?(t.setSelectedPointIndices([],!1),i.setCatalogTableAutoScroll(!1)):(t.setSelectedPointIndices(e,!0),i.setCatalogTableAutoScroll(!1))}else t.setSelectedPointIndices(e,!0),i.setCatalogTableAutoScroll(!1)},this.renderFileIdPopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return h.createElement(f.B,{key:e,text:i,onClick:t.handleClick,active:t.modifiers.active})},this.renderPlotTypePopOver=(e,t)=>h.createElement(f.B,{key:e,text:e,onClick:t.handleClick,active:t.modifiers.active}),this.onTableResize=e=>{const t=Math.floor(e/(this.height-130)*100);t<=Qe.f.MaxTableSeparatorPosition&&t>=Qe.f.MinTableSeparatorPosition&&(this.widgetStore.setTableSeparatorPosition(t+"%"),O.H.Instance.setPreference(O.G.CATALOG_TABLE_SEPARATOR_POSITION,t+"%"));const i=this.profileStore;i&&this.catalogHeaderTableRef&&this.updateTableSize(this.catalogHeaderTableRef,!1),i&&this.catalogTableRef&&this.updateTableSize(this.catalogTableRef,!1)},this.renderSystemPopOver=(e,t)=>{const i=h.createElement(f.B,{key:e,text:this.profileStore.CoordinateSystemName.get(e),onClick:t.handleClick,active:t.modifiers.active});switch(e){case O.l.Pixel0:return h.createElement("div",{key:e},h.createElement(f.W,{position:"auto-end",content:h.createElement("small",null,"PIX0: 0-based image coordinates")},i));case O.l.Pixel1:return h.createElement("div",{key:e},h.createElement(f.W,{position:"auto-end",content:h.createElement("small",null,"PIX1:  1-based image coordinates")},i));default:return i}},Object(m.p)(this),O.k.Instance.catalogProfiles.has(this.props.id)||O.k.Instance.catalogProfiles.set(this.props.id,1),this.catalogFileNames=new Map,Object(m.h)(()=>{const e=O.e.Instance.activeFrame,t=O.k.Instance.activeCatalogFiles,i=this.profileStore;if(i){let n="";const r=i.catalogInfo.fileInfo.name,o=i.progress;o&&isFinite(o)&&o<1&&(n=`[${Object(M.kb)(100*o)}% complete]`),e&&(null===t||void 0===t?void 0:t.length)?O.U.Instance.setWidgetComponentTitle(this.props.id,`Catalog : ${r} ${n}`):O.U.Instance.setWidgetComponentTitle(this.props.id,"Catalog")}else O.U.Instance.setWidgetComponentTitle(this.props.id,"Catalog")})}updateTableSize(e,t){const i=e.locator.getViewportRect();e.updateViewportRect(i),t&&e.scrollToRegion(Ot.c.column(0))}handleHeaderDisplayChange(e,t){const i=this.profileStore,n=this.widgetStore,r=e.target.checked,o=i.catalogControlHeader.get(t);i.setHeaderDisplay(r,t),(!0===r||""!==o.filter&&!1===r)&&this.handleFilterRequest(),n.xAxis===t&&n.setxAxis(O.i.NONE),n.yAxis===t&&n.setyAxis(O.i.NONE)}renderDataColumn(e,t){return h.createElement(St.a,{key:e,name:e,cellRenderer:(e,i)=>h.createElement(ft.a,{className:"header-table-cell",key:`cell_${i}_${e}`,interactive:!0},t[e])})}renderSwitchButtonCell(e,t){const i=this.profileStore,n=i.catalogControlHeader.get(t).display;let r=i.loadingData;return h.createElement(ft.a,{className:"header-table-cell",key:"cell_switch_"+e},h.createElement(h.Fragment,null,h.createElement(f.P,{className:"cell-switch-button",key:"cell_switch_button_"+e,disabled:r,checked:n,onChange:e=>this.handleHeaderDisplayChange(e,t)})))}get axisOption(){const t=this.profileStore;let i=[];return t.catalogControlHeader.forEach((n,r)=>{const o=t.catalogHeader[n.dataIndex].dataType;e.axisDataType.includes(o)&&n.display&&i.push(r)}),i}get xAxisLable(){switch(this.widgetStore.catalogPlotType){case Qe.c.ImageOverlay:return this.profileStore.activedSystem.x;default:return O.i.X}}get yAxisLable(){switch(this.widgetStore.catalogPlotType){case Qe.c.ImageOverlay:return this.profileStore.activedSystem.y;default:return O.i.Y}}renderButtonColumns(e,t){switch(e){case gn.Display:return h.createElement(St.a,{key:e,name:e,cellRenderer:e=>this.renderSwitchButtonCell(e,t[e])});default:return h.createElement(St.a,{key:e,name:e})}}getDataType(e){switch(e){case ie.a.ColumnType.Bool:return"bool";case ie.a.ColumnType.Int8:case ie.a.ColumnType.Int16:case ie.a.ColumnType.Int32:case ie.a.ColumnType.Int64:return"int";case ie.a.ColumnType.Uint8:case ie.a.ColumnType.Uint16:case ie.a.ColumnType.Uint32:case ie.a.ColumnType.Uint64:return"unsigned int";case ie.a.ColumnType.Double:return"double";case ie.a.ColumnType.Float:return"float";case ie.a.ColumnType.String:return"string";default:return"unsupported"}}createHeaderTable(){const e=[],t=[],i=[],n=[],r=[],o=this.profileStore.catalogHeader,a=o.length;for(let d=0;d<o.length;d++){const e=o[d];t.push(e.name),i.push(e.description),n.push(e.units),r.push(this.getDataType(e.dataType))}const s=this.renderDataColumn(gn.Name,t);e.push(s);const l=this.renderDataColumn(gn.Unit,n);e.push(l);const c=this.renderDataColumn(gn.Type,r);e.push(c);const u=this.renderButtonColumns(gn.Display,t);e.push(u);const p=this.renderDataColumn(gn.Description,i);return e.push(p),h.createElement(bt.a,{ref:e=>this.onControlHeaderTableRef(e),numRows:a,enableRowReordering:!1,renderMode:Oi.a.BATCH,selectionModes:Ot.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,enableGhostCells:!0,numFrozenColumns:1,columnWidths:this.widgetStore.headerTableColumnWidts,onColumnWidthChanged:this.updateHeaderTableColumnSize,enableRowResizing:!1},e)}getUserFilters(){let t=[];return this.profileStore.catalogControlHeader.forEach((i,n)=>{if(void 0!==i.filter&&i.display){let r=new ie.a.FilterConfig;const o=this.profileStore.catalogHeader[i.dataIndex].dataType;if(r.columnName=n,o===ie.a.ColumnType.String)r.subString=i.filter,t.push(r);else{const n=e.GetComparisonOperatorAndValue(i.filter);-1!==n.operator&&n.values.length>0&&(r.comparisonOperator=n.operator,n.values.length>1?(r.value=Math.min(n.values[0],n.values[1]),r.secondaryValue=Math.max(n.values[0],n.values[1])):r.value=n.values[0],t.push(r))}}}),t}static GetNumberFromFilter(e){return Number(e.replace(/[^0-9.+-.]+/g,""))}static GetComparisonOperatorAndValue(t){const i=t.replace(/\s/g,"");let n={operator:-1,values:[]};for(const r of Object.keys(mn)){const t=mn[r];if(i.includes(t)){if(t===mn.Equal){const t=e.GetNumberFromFilter(i);return n.operator=ie.a.ComparisonOperator.Equal,n.values.push(t),n}if(t===mn.NotEqual){const t=e.GetNumberFromFilter(i);return n.operator=ie.a.ComparisonOperator.NotEqual,n.values.push(t),n}if(t===mn.Lesser){const t=e.GetNumberFromFilter(i);return n.operator=ie.a.ComparisonOperator.Lesser,n.values.push(t),n}if(t===mn.LessorOrEqual){const t=e.GetNumberFromFilter(i);return n.values.push(t),n.operator=ie.a.ComparisonOperator.LessorOrEqual,n}if(t===mn.Greater){const t=e.GetNumberFromFilter(i);return n.operator=ie.a.ComparisonOperator.Greater,n.values.push(t),n}if(t===mn.GreaterOrEqual){const t=e.GetNumberFromFilter(i);return n.values.push(t),n.operator=ie.a.ComparisonOperator.GreaterOrEqual,n}if(t===mn.RangeOpen){const e=i.split(mn.RangeOpen,2);return n.values.push(Number(e[0])),n.values.push(Number(e[1])),n.operator=ie.a.ComparisonOperator.RangeOpen,n}if(t===mn.RangeClosed){const e=i.split(mn.RangeClosed,2);return n.values.push(Number(e[0])),n.values.push(Number(e[1])),n.operator=ie.a.ComparisonOperator.RangeClosed,n}}}return n}render(){const e=this.widgetStore,t=this.profileStore,i=O.k.Instance.activeCatalogFiles;if(!t||void 0===i||0===(null===i||void 0===i?void 0:i.length)||!e)return h.createElement("div",{className:"catalog-overlay"},h.createElement(f.C,{icon:"folder-open",title:"No catalog file loaded",description:"Load a catalog file using the menu"}),";");const n=this.catalogDataInfo,r={type:S.x.ColumnFilter,dataset:n.dataset,filter:t.catalogControlHeader,columnHeaders:t.displayedColumnHeaders,numVisibleRows:n.numVisibleRows,columnWidths:t.tableColumnWidts,loadingCell:t.loadingData,selectedDataIndex:t.selectedPointIndices,showSelectedData:e.showSelectedData,updateTableRef:this.onCatalogDataTableRefUpdated,updateColumnFilter:t.setColumnFilter,updateByInfiniteScroll:this.updateByInfiniteScroll,updateTableColumnWidth:t.setTableColumnWidth,updateSelectedRow:this.onCatalogTableDataSelected,updateSortRequest:this.updateSortRequest,sortingInfo:t.sortingInfo,disable:t.loadOntoImage,darkTheme:O.e.Instance.darkTheme,tableHeaders:t.catalogHeader};let o=0;t.numVisibleRows&&(o=1);const a=t.catalogInfo.dataSize,s=t.maxRows,l=n.numVisibleRows;let c=`Showing ${o} to ${l} of total ${a} entries`;t.hasFilter&&isFinite(t.filterDataSize)&&(c=`Showing ${o} to ${l} of ${t.filterDataSize} filtered entries. Total ${a} entries`),s<a&&s>0&&(c=`Showing ${o} to ${l} of top ${s} entries. Total ${a} entries`),s<a&&s>0&&t.hasFilter&&isFinite(t.filterDataSize)&&(c=t.filterDataSize>=s?`Showing ${o} to ${l} of top ${s} entries. Total ${t.filterDataSize} filtered entries. Total ${a} entries`:`Showing ${o} to ${l} of ${t.filterDataSize} filtered entries. Total ${a} entries`);const u=a?h.createElement("tr",null,h.createElement("td",{className:"td-label"},h.createElement("pre",null,c))):null;let p=[];i.forEach(e=>{p.push(e)}),this.catalogFileNames=O.k.Instance.getCatalogFileNames(i);let d=[];t.CoordinateSystemName.forEach((e,t)=>{d.push(t)});const g=t.CoordinateSystemName.get(t.catalogCoordinateSystem.system),m=e.catalogPlotType===Qe.c.ImageOverlay,y=e.catalogPlotType===Qe.c.Histogram,C=t.loadOntoImage;let E="footer-action-large";this.width<=600&&(E="footer-action-small");const I=h.createElement(f.B,{disabled:!0,text:"No results"});return h.createElement("div",{className:"catalog-overlay"},h.createElement("div",{className:"catalog-overlay-filter-settings"},h.createElement(f.p,{inline:!0,label:"File"},h.createElement(k.a,{className:"bp3-fill",filterable:!1,items:p,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFileIdPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END}},h.createElement(f.e,{text:this.catalogFileId,rightIcon:"double-caret-vertical"}))),h.createElement(f.p,{className:"catalog-system",disabled:!m,inline:!0,label:"System"},h.createElement(k.a,{filterable:!1,items:d,activeItem:t.catalogCoordinateSystem.system,onItemSelect:e=>t.setCatalogCoordinateSystem(e),itemRenderer:this.renderSystemPopOver,disabled:!m,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END}},h.createElement(f.e,{text:g,disabled:!m,rightIcon:"double-caret-vertical"})))),h.createElement(Si.b,{className:"catalog-table",split:"horizontal",primary:"second",minSize:Qe.f.MinTableSeparatorPosition+"%",maxSize:Qe.f.MaxTableSeparatorPosition+"%",size:e.tableSeparatorPosition,onChange:this.onTableResize},h.createElement(Si.a,{className:"catalog-overlay-column-header-container"},this.createHeaderTable()),h.createElement(Si.a,{className:"catalog-overlay-data-container"},h.createElement(S.w,r))),h.createElement("div",{className:"bp3-dialog-footer"},h.createElement("div",{className:"table-info"},h.createElement("table",{className:"info-display"},h.createElement("tbody",null,u))),h.createElement("div",{className:"footer-action-container"},h.createElement("div",{className:E},h.createElement(k.a,{className:"catalog-type-button",filterable:!1,items:Object.values(Qe.c),activeItem:e.catalogPlotType,onItemSelect:this.handlePlotTypeChange,itemRenderer:this.renderPlotTypePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END}},h.createElement(f.e,{className:"bp3",text:e.catalogPlotType,rightIcon:"double-caret-vertical"})),h.createElement(f.p,{className:"catalog-xaxis",inline:!0,label:this.xAxisLable,disabled:C},h.createElement(k.a,{className:"catalog-xaxis-select",items:this.axisOption,activeItem:null,onItemSelect:t=>e.setxAxis(t),itemRenderer:this.renderAxisPopOver,disabled:C,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END},filterable:!0,noResults:I,itemPredicate:this.filterColumn,resetOnSelect:!0},h.createElement(f.e,{className:"catalog-xaxis-button",text:e.xAxis,disabled:C,rightIcon:"double-caret-vertical"}))),h.createElement(f.p,{className:"catalog-yaxis",inline:!0,label:this.yAxisLable,disabled:y||C},h.createElement(k.a,{className:"catalog-yaxis-select",items:this.axisOption,activeItem:null,onItemSelect:t=>e.setyAxis(t),itemRenderer:this.renderAxisPopOver,disabled:y||C,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END},filterable:!0,noResults:I,itemPredicate:this.filterColumn,resetOnSelect:!0},h.createElement(f.e,{className:"catalog-yaxis-button",text:e.yAxis,disabled:y||C,rightIcon:"double-caret-vertical"}))),h.createElement(S.b,{className:"catalog-max-rows",label:"Max Rows",value:t.maxRows,onValueChanged:e=>t.setMaxRows(e),onValueCleared:()=>t.setMaxRows(t.catalogInfo.dataSize),displayExponential:!1,updateValueOnKeyDown:!0,disabled:C}))),h.createElement("div",{className:"footer-button-container"},h.createElement("div",{className:"footer-button"},h.createElement(f.W,{content:"Apply filter"},h.createElement(f.b,{intent:yi.a.PRIMARY,text:"Update",onClick:this.handleFilterRequest,disabled:C||!t.updateTableView})),h.createElement(f.W,{content:"Reset view"},h.createElement(f.b,{intent:yi.a.PRIMARY,text:"Reset",onClick:this.handleResetClick,disabled:C})),h.createElement(f.W,{content:"Close file"},h.createElement(f.b,{intent:yi.a.PRIMARY,text:"Close",onClick:this.handleFileCloseClick,disabled:C})),h.createElement(f.W,{content:"Plot data"},h.createElement(f.b,{intent:yi.a.PRIMARY,text:"Plot",onClick:this.handlePlotClick,disabled:!this.enablePlotButton}))))),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},dn.axisDataType=[ie.a.ColumnType.Double,ie.a.ColumnType.Float,ie.a.ColumnType.Int8,ie.a.ColumnType.Uint8,ie.a.ColumnType.Int16,ie.a.ColumnType.Uint16,ie.a.ColumnType.Int32,ie.a.ColumnType.Uint32,ie.a.ColumnType.Int64,ie.a.ColumnType.Uint64],rn=hn,Object(d.a)(rn.prototype,"catalogFileId",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"catalogFileId"),rn.prototype),on=Object(d.a)(rn.prototype,"catalogTableRef",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),an=Object(d.a)(rn.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sn=Object(d.a)(rn.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(rn.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"widgetStore"),rn.prototype),Object(d.a)(rn.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"profileStore"),rn.prototype),ln=Object(d.a)(rn.prototype,"handleCatalogFileChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{O.k.Instance.catalogProfiles.set(this.props.id,e)}}}),cn=Object(d.a)(rn.prototype,"handleFileCloseClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=O.e.Instance,t=O.k.Instance.catalogWidgets.get(this.catalogFileId);e.removeCatalog(this.catalogFileId,t,this.props.id)}}}),Object(d.a)(rn.prototype,"catalogDataInfo",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"catalogDataInfo"),rn.prototype),Object(d.a)(rn.prototype,"enablePlotButton",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"enablePlotButton"),rn.prototype),un=Object(d.a)(rn.prototype,"onCatalogDataTableRefUpdated",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogTableRef=e}}}),pn=Object(d.a)(rn.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=this.profileStore,n=this.widgetStore;if(this.height=t,this.width=e,i&&this.catalogHeaderTableRef&&(this.updateTableSize(this.catalogHeaderTableRef,this.props.docked),1===i.progress||void 0===i.progress)){const e=i.catalogInfo.fileInfo.name;O.U.Instance.setWidgetComponentTitle(this.props.id,"Catalog : "+e)}i&&this.catalogTableRef&&n&&(this.updateTableSize(this.catalogTableRef,this.props.docked),i.regionSelected&&n.catalogTableAutoScroll&&!n.showSelectedData&&this.scrollToRegion(this.catalogTableRef,i.autoScrollRowNumber))}}}),Object(d.a)(rn.prototype,"axisOption",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"axisOption"),rn.prototype),Object(d.a)(rn.prototype,"xAxisLable",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"xAxisLable"),rn.prototype),Object(d.a)(rn.prototype,"yAxisLable",[m.i],Object.getOwnPropertyDescriptor(rn.prototype,"yAxisLable"),rn.prototype),nn=rn))||nn;var On,Sn;i(1001);let Cn;!function(e){e[e.CONVERSION=0]="CONVERSION",e[e.LINE_PLOT_STYLING=1]="LINE_PLOT_STYLING",e[e.SCATTER_PLOT_STYLING=2]="SCATTER_PLOT_STYLING",e[e.SMOOTHING=3]="SMOOTHING"}(Cn||(Cn={}));let En=Object(g.a)((Sn=class extends h.Component{static get WIDGET_CONFIG(){return{id:"stokes-floating-settings",type:"floating-settings",minWidth:350,minHeight:300,defaultWidth:550,defaultHeight:450,title:"stokes-settings",isCloseable:!0,parentId:"stokes",parentType:"stokes",helpType:[O.x.STOKES_ANALYSIS_SETTINGS_CONVERSION,O.x.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING,O.x.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING,O.x.STOKES_ANALYSIS_SETTINGS_SMOOTHING]}}get widgetStore(){const e=O.U.Instance;if(e.stokesAnalysisWidgets){const t=e.stokesAnalysisWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleEqualAxesValuesChanged=e=>{this.widgetStore.setEqualAxesValue(e.target.checked)},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=O.e.Instance;Object(m.h)(()=>{if(this.widgetStore){if(this.widgetStore.effectiveFrame){const e=this.widgetStore.effectiveRegionId,i=0===e?"Cursor":"Region #"+e,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Stokes Analysis Settings: ${i} ${n}`)}}})}render(){const e=O.e.Instance,t=this.widgetStore,i={darkMode:e.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:t.primaryLineColor,lineWidth:t.lineWidth,plotType:t.plotType,linePlotPointSize:t.linePlotPointSize,setPrimaryLineColor:t.setPrimaryLineColor,setLineWidth:t.setLineWidth,setLinePlotPointSize:t.setLinePlotPointSize,setPlotType:t.setPlotType,secondaryDarkModeLineColor:ae.a.ORANGE4,secondaryLineColor:t.secondaryLineColor,setSecondaryLineColor:t.setSecondaryLineColor},n={colorMap:t.colorMap,scatterPlotPointSize:t.scatterPlotPointSize,pointTransparency:t.pointTransparency,equalAxes:t.equalAxes,setPointTransparency:t.setPointTransparency,setScatterPlotPointSize:t.setScatterPlotPointSize,setColormap:t.setColormap,handleEqualAxesValuesChanged:this.handleEqualAxesValuesChanged},r=t.effectiveFrame&&t.effectiveFrame.hasStokes;return h.createElement("div",{className:"stokes-settings"},h.createElement(f.R,{id:"spectralSettingTabs",selectedTabId:t.settingsTabId,onChange:this.handleSelectedTabChanged},h.createElement(f.Q,{id:Cn.CONVERSION,title:"Conversion",panel:h.createElement(S.u,{widgetStore:t,disable:!r})}),h.createElement(f.Q,{id:Cn.LINE_PLOT_STYLING,title:"Line Plot Styling",panel:h.createElement(S.h,i)}),h.createElement(f.Q,{id:Cn.SCATTER_PLOT_STYLING,title:"Scatter Plot Styling",panel:h.createElement(S.q,n)}),h.createElement(f.Q,{id:Cn.SMOOTHING,title:"Smoothing",panel:h.createElement(S.s,{smoothingStore:t.smoothingStore,diableStyle:!0,diableDecimation:!0})})))}},Object(d.a)(Sn.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Sn.prototype,"widgetStore"),Sn.prototype),On=Sn))||On;var In,wn=i(1023);i(1002);const Tn=wn.a.ofType();let vn=Object(g.a)(In=class extends h.Component{constructor(...e){super(...e),this.onChannelFromChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedChannelRange(e,t.channelValueRange[1])},this.onChannelToChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedChannelRange(t.channelValueRange[0],e)},this.handleChannelSelectionClicked=()=>{const e=this.props.widgetStore;e.setMomentRangeSelectingMode(e.isSelectingMomentChannelRange?Qe.i.NONE:Qe.i.CHANNEL)},this.onMaskFromChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedMaskRange(e,t.maskRange[1])},this.onMaskToChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedMaskRange(t.maskRange[0],e)},this.handleMaskSelectionClicked=()=>{const e=this.props.widgetStore;e.setMomentRangeSelectingMode(e.isSelectingMomentMaskRange?Qe.i.NONE:Qe.i.MASK)},this.filterMoment=(e,t,i,n)=>{const r=Q.MOMENT_TEXT.get(t),o=r.tag.toLowerCase(),a=e.toLowerCase();return n?o===a:r.tag.indexOf(a)>=0},this.renderMomentTag=e=>{const t=Q.MOMENT_TEXT.get(e);return t?t.tag:void 0},this.renderMomentSelectItem=(e,{modifiers:t,handleClick:i})=>{const n=Q.MOMENT_TEXT.get(e);return n?h.createElement(f.B,{text:`${n.tag}: ${n.text}`,onClick:i,key:e,icon:this.props.widgetStore.isMomentSelected(e)?"tick":"blank"}):void 0},this.handleMomentTagRemove=(e,t)=>{this.props.widgetStore.removeMomentByIndex(t)},this.handleMomentsClear=()=>{this.props.widgetStore.clearSelectedMoments()},this.handleRequestMoment=()=>{this.props.widgetStore.requestMoment()},this.handleRequestingMomentCancelled=()=>{this.props.widgetStore.requestingMomentCancelled()}}render(){var e;const t=O.e.Instance,i=this.props.widgetStore,n=i.effectiveFrame,r=h.createElement(Xn,{widgetStore:this.props.widgetStore,nonClosedDisabled:!0}),o=h.createElement(h.Fragment,null,h.createElement(S.u,{widgetStore:this.props.widgetStore,disable:!1}),n&&n.numChannels>1&&h.createElement(f.p,{label:"Range",inline:!0,labelInfo:(null===n||void 0===n?void 0:n.spectralUnit)?`(${n.spectralUnit})`:""},h.createElement("div",{className:"range-select"},h.createElement(f.p,{label:"From",inline:!0},h.createElement(S.n,{value:i.channelValueRange[0],buttonPosition:"none",onValueChange:e=>this.onChannelFromChanged(e)})),h.createElement(f.p,{label:"To",inline:!0},h.createElement(S.n,{value:i.channelValueRange[1],buttonPosition:"none",onValueChange:e=>this.onChannelToChanged(e)})),h.createElement("div",{className:"cursor-select"},h.createElement(f.W,{content:"Use cursor to select channel range in profiler",position:y.a.BOTTOM},h.createElement(f.b,{className:i.isSelectingMomentChannelRange?"bp3-active":"",icon:"select",onClick:this.handleChannelSelectionClicked})))))),a=h.createElement(h.Fragment,null,h.createElement(f.p,{label:"Mask",inline:!0,disabled:!n},h.createElement(f.r,{value:i.momentMask,options:Object.keys(ie.a.MomentMask).map(e=>({label:e,value:ie.a.MomentMask[e]})),onChange:e=>i.setMomentMask(parseInt(e.currentTarget.value)),disabled:!n})),n&&n.numChannels>1&&h.createElement(f.p,{label:"Range",inline:!0,labelInfo:`(${n.unit})`},h.createElement("div",{className:"range-select"},h.createElement(f.p,{label:"From",inline:!0},h.createElement(S.n,{value:i.maskRange[0],buttonPosition:"none",onValueChange:e=>this.onMaskFromChanged(e)})),h.createElement(f.p,{label:"To",inline:!0},h.createElement(S.n,{value:i.maskRange[1],buttonPosition:"none",onValueChange:e=>this.onMaskToChanged(e)})),h.createElement("div",{className:"cursor-select"},h.createElement(f.W,{content:"Use cursor to select mask range in profiler",position:y.a.BOTTOM},h.createElement(f.b,{className:i.isSelectingMomentMaskRange?"bp3-active":"",icon:"select",onClick:this.handleMaskSelectionClicked})))))),s=(null===n||void 0===n||null===(e=n.regionSet)||void 0===e?void 0:e.regions)?n.regionSet.regions.find(e=>e.regionId===i.effectiveRegionId):null,l=s&&s.isClosedRegion,c=i.regionIdMap.get(i.fileId)!==Qe.k.CURSOR&&0===i.effectiveRegionId,u=n&&n.numChannels>1&&!t.animatorStore.animationActive&&!t.widgetsStore.isSpectralWidgetStreamingData&&(l||c),p=h.createElement("span",null,h.createElement("br",null),h.createElement("i",null,h.createElement("small",null,"Please ensure",h.createElement("br",null),"1. Animation playback is stopped.",h.createElement("br",null),"2. Spectral profile generation is complete.",h.createElement("br",null),"3. Cursor or point region is not selected."))),d=h.createElement("span",null,"Unable to generate moment images",p),g=h.createElement(h.Fragment,null,h.createElement(f.p,{label:"Moments",inline:!0},h.createElement(Tn,{placeholder:"Select...",items:Object.values(ie.a.Moment),itemPredicate:this.filterMoment,itemRenderer:this.renderMomentSelectItem,onItemSelect:e=>i.isMomentSelected(e)?i.deselectMoment(e):i.selectMoment(e),selectedItems:i.selectedMoments,resetOnSelect:!0,fill:!0,popoverProps:{minimal:!0,position:"bottom"},tagRenderer:this.renderMomentTag,tagInputProps:{onRemove:this.handleMomentTagRemove,tagProps:{minimal:!0},rightElement:h.createElement(f.e,{icon:"cross",minimal:!0,onClick:this.handleMomentsClear})}})),h.createElement("div",{className:"moment-generate"},h.createElement(f.W,{disabled:u,content:d,position:y.a.BOTTOM},h.createElement(f.b,{intent:"success",onClick:this.handleRequestMoment,disabled:!u},"Generate"))));return h.createElement("div",{className:"moment-generator"},h.createElement("div",{className:"moment-panel"},r,h.createElement(f.m,null),o,h.createElement(f.m,null),a,h.createElement(f.m,null),g),h.createElement(Gt.k,{isOpen:n&&n.isRequestingMoments&&n.requestingMomentsProgress<1,progress:n?n.requestingMomentsProgress:0,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleRequestingMomentCancelled,text:"Generating moments"}))}})||In;var An,xn;i(1003);let Rn;!function(e){e[e.CONVERSION=0]="CONVERSION",e[e.STYLING=1]="STYLING",e[e.SMOOTHING=2]="SMOOTHING",e[e.MOMENTS=3]="MOMENTS"}(Rn||(Rn={}));let Pn=Object(g.a)((xn=class extends h.Component{static get WIDGET_CONFIG(){return{id:"spectral-profiler-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:480,defaultHeight:575,title:"spectral-profiler-settings",isCloseable:!0,parentId:"spectal-profiler",parentType:"spectral-profiler",helpType:[O.x.SPECTRAL_PROFILER_SETTINGS_CONVERSION,O.x.SPECTRAL_PROFILER_SETTINGS_STYLING,O.x.SPECTRAL_PROFILER_SETTINGS_SMOOTHING,O.x.SPECTRAL_PROFILER_SETTINGS_MOMENTS]}}get widgetStore(){const e=O.U.Instance;if(e.spectralProfileWidgets){const t=e.spectralProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=O.e.Instance;Object(m.h)(()=>{if(this.widgetStore){const e=this.widgetStore.effectiveFrame,i=this.widgetStore.coordinate;if(e&&i){let e;e=2===i.length?`Z Profile (Stokes ${i[0]})`:"Z Profile";const n=this.widgetStore.effectiveRegionId,r=0===n?"Cursor":"Region #"+n,o=this.widgetStore.matchesSelectedRegion?"(Active)":"";t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`${e} Settings: ${r} ${o}`)}}})}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,xMinVal:Object(M.W)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(M.W)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(M.W)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(M.W)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return h.createElement("div",{className:"spectral-settings"},h.createElement(f.R,{id:"spectralSettingTabs",selectedTabId:e.settingsTabId,onChange:this.handleSelectedTabChanged},h.createElement(f.Q,{id:Rn.CONVERSION,panelClassName:"conversion-tab-panel",title:"Conversion",panel:h.createElement(S.u,{widgetStore:e,disable:!1})}),h.createElement(f.Q,{id:Rn.STYLING,panelClassName:"styling-tab-panel",title:"Styling",panel:h.createElement(S.h,t)}),h.createElement(f.Q,{id:Rn.SMOOTHING,title:"Smoothing",panel:h.createElement(S.s,{smoothingStore:e.smoothingStore})}),h.createElement(f.Q,{id:Rn.MOMENTS,panelClassName:"moment-tab-panel",title:"Moments",panel:h.createElement(vn,{widgetStore:e})})))}},Object(d.a)(xn.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(xn.prototype,"widgetStore"),xn.prototype),An=xn))||An;var jn,kn;i(1004);let Fn;!function(e){e[e.STYLING=0]="STYLING",e[e.SMOOTHING=1]="SMOOTHING"}(Fn||(Fn={}));let Mn=Object(g.a)((kn=class extends h.Component{static get WIDGET_CONFIG(){return{id:"spatial-profiler-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:400,defaultHeight:450,title:"spatial-profiler-settings",isCloseable:!0,parentId:"spatial-profiler",parentType:"spatial-profiler",helpType:[O.x.SPATIAL_PROFILER_SETTINGS_STYLING,O.x.SPATIAL_PROFILER_SETTINGS_SMOOTHING]}}get widgetStore(){const e=O.U.Instance;if(e.spatialProfileWidgets){const t=e.spatialProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleWcsAxisChanged=e=>{this.widgetStore.setWcsAxisVisible(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleCoordinateChanged=e=>{this.widgetStore.setCoordinate(e.target.value)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=O.e.Instance;Object(m.h)(()=>{if(this.widgetStore){const e=this.widgetStore.coordinate;if(t&&e){const i=e.toUpperCase()+" Profile",n=0===this.widgetStore.regionId?"Cursor":"Region #"+this.widgetStore.regionId;t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`${i} Settings: ${n}`)}}else t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"X Profile Settings: Cursor")})}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,showWCSAxis:e.wcsAxisVisible,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,handleWcsAxisChanged:this.handleWcsAxisChanged,setPlotType:e.setPlotType,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,userSelectedCoordinate:e.coordinate,handleCoordinateChanged:this.handleCoordinateChanged,profileCoordinateOptions:[{value:"x",label:"X"},{value:"y",label:"Y"}],xMinVal:Object(M.W)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(M.W)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(M.W)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(M.W)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return h.createElement("div",{className:"spatial-profiler-settings"},h.createElement(f.R,{id:"spatialSettingTabs",selectedTabId:e.settingsTabId,onChange:this.handleSelectedTabChanged},h.createElement(f.Q,{id:Fn.STYLING,title:"Styling",panel:h.createElement(S.h,t)}),h.createElement(f.Q,{id:Fn.SMOOTHING,title:"Smoothing",panel:h.createElement(S.s,{smoothingStore:e.smoothingStore})})))}},Object(d.a)(kn.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(kn.prototype,"widgetStore"),kn.prototype),jn=kn))||jn;var Dn,Nn;let Ln=Object(g.a)((Nn=class extends h.Component{constructor(...e){super(...e),this.handleLogScaleChanged=e=>{this.widgetStore.setLogScale(e.target.checked)},this.handleMarkerTextChanged=e=>{this.widgetStore.setMarkerTextVisible(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()}}static get WIDGET_CONFIG(){return{id:"render-config-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:300,defaultHeight:375,title:"render-config-settings",isCloseable:!0,parentId:"render-config",parentType:"render-config",helpType:O.x.RENDER_CONFIG_SETTINGS}}get widgetStore(){const e=O.U.Instance;if(e.renderConfigWidgets){const t=e.renderConfigWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,logScaleY:e.logScaleY,handleLogScaleChanged:this.handleLogScaleChanged,markerTextVisible:e.markerTextVisible,handleMarkerTextChanged:this.handleMarkerTextChanged,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,xMinVal:Object(M.W)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(M.W)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(M.W)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(M.W)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return h.createElement(S.h,t)}},Object(d.a)(Nn.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Nn.prototype,"widgetStore"),Nn.prototype),Dn=Nn))||Dn;var _n,zn;let Wn=Object(g.a)((zn=class extends h.Component{static get WIDGET_CONFIG(){return{id:"histogram-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:300,defaultHeight:320,title:"histogram-settings",isCloseable:!0,parentId:"histogram",parentType:"histogram",helpType:O.x.HISTOGRAM_SETTINGS}}get widgetStore(){const e=O.U.Instance;if(e.histogramWidgets){const t=e.histogramWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleLogScaleChanged=e=>{this.widgetStore.setLogScale(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(M.W)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(M.W)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(M.W)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},Object(m.h)(()=>{const e=O.e.Instance;if(this.widgetStore&&this.widgetStore.effectiveFrame){let t="Unknown";const i=this.widgetStore.effectiveRegionId;if(-1===i)t="Image";else if(this.widgetStore.effectiveFrame.regionSet){const e=this.widgetStore.effectiveFrame.regionSet.regions.find(e=>e.regionId===i);e&&(t=e.nameString)}const n=this.widgetStore.matchesSelectedRegion?"(Active)":"";e.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Histogram Settings: ${t} ${n}`)}else e.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Histogram Settings")})}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,logScaleY:e.logScaleY,handleLogScaleChanged:this.handleLogScaleChanged,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,xMinVal:Object(M.W)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(M.W)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(M.W)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(M.W)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return h.createElement(S.h,t)}},Object(d.a)(zn.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(zn.prototype,"widgetStore"),zn.prototype),_n=zn))||_n;var Gn,Vn=i(203);i(1005);let Bn=Object(g.a)(Gn=class extends h.Component{render(){const e=O.e.Instance;let t="splash-screen";return e.darkTheme&&(t+=" bp3-dark"),h.createElement(f.E,{className:bi.a.OVERLAY_SCROLL_CONTAINER,autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:e.splashScreenVisible,usePortal:!0},h.createElement("div",{className:t},h.createElement("div",{className:"image-div"},h.createElement("img",{src:Vn,width:150})),h.createElement("div",{className:"appInfo-div"},h.createElement("h1",null,Q.CARTA_INFO.acronym," ",Q.CARTA_INFO.version," (",Q.CARTA_INFO.date,")"),h.createElement("p",null,Q.CARTA_INFO.fullName)),h.createElement(f.O,{intent:yi.a.PRIMARY,size:30,value:null}),h.createElement("div",{className:"loadingInfo-div"},h.createElement("p",null,e.logStore.newestMsg))))}})||Gn;var qn,Hn=i(68);let Un=Object(g.a)(qn=class extends h.Component{render(){return h.createElement(h.Fragment,null,h.createElement(Bn,null),h.createElement(xt,null),h.createElement(Gt.f,null),h.createElement(Gt.a,null),h.createElement(Gt.i,null),h.createElement(Gt.h,null),h.createElement(Gt.j,null),h.createElement(Gt.b,null),h.createElement(Gt.g,null),h.createElement(Gt.c,null),h.createElement(Gt.e,null),h.createElement(Wo,null))}})||qn;var Yn;i(1006);let Xn=Object(g.a)(Yn=class extends h.Component{constructor(...e){super(...e),this.handleFrameChanged=e=>{const t=O.e.Instance,i=this.props.widgetStore;if(t.activeFrame){const t=parseInt(e.target.value);i.setFileId(t),i.setRegionId(i.effectiveFrame.frameInfo.fileId,Qe.k.ACTIVE),this.props.onFrameChanged&&this.props.onFrameChanged(i.effectiveFrame)}},this.handleRegionChanged=e=>{const t=O.e.Instance,i=this.props.widgetStore;if(t.activeFrame){const t=i.effectiveFrame.frameInfo.fileId;i.setFileId(t),i.setRegionId(t,parseInt(e.target.value))}}}render(){const e=O.e.Instance,t=this.props.widgetStore;let i=!1,n=Qe.a,r=[{value:Qe.a,label:"Active"}];e.activeFrame&&(r=r.concat(e.frameNames),n=t.fileId,i=!0);let o=!1,a=Qe.k.ACTIVE,s=[{value:Qe.k.ACTIVE,label:"Active"}];if(t.effectiveFrame&&t.effectiveFrame.regionSet){let e;t.type===Qe.m.CLOSED&&(s=s.concat([{value:Qe.k.IMAGE,label:"Image"}]));let i=t.effectiveFrame.regionSet.regions;switch(t.type){case Qe.m.CLOSED:e=i.filter(e=>!e.isTemporary&&e.isClosedRegion);break;case Qe.m.CLOSED_AND_POINT:e=i.filter(e=>!e.isTemporary&&(e.isClosedRegion||e.regionType===ie.a.RegionType.POINT));break;default:e=i}s=s.concat(e.map(e=>({value:e.regionId,label:e.nameString,disabled:!!this.props.nonClosedDisabled&&!e.isClosedRegion}))),t.type===Qe.m.CLOSED_AND_POINT&&1===s.length&&(s=s.concat([{value:Qe.k.CURSOR,label:"Cursor"}])),a=t.regionIdMap.get(t.effectiveFrame.frameInfo.fileId),o=!0}let l="unlinked-to-selected",c="unlinked-to-selected";const u="linked-to-selected";return t.matchActiveFrame&&t.fileId!==Qe.a&&(l=O.e.Instance.darkTheme?u+" dark-theme":u),t.matchesSelectedRegion&&void 0!==a&&a!==Qe.k.ACTIVE&&(c=O.e.Instance.darkTheme?u+" dark-theme":u),h.createElement(h.Fragment,null,h.createElement(f.p,{label:"Image",inline:!0,disabled:!i},h.createElement(f.r,{className:l,value:n,options:r,onChange:this.handleFrameChanged,disabled:!i,style:{width:"100px"}})),h.createElement(f.p,{label:"Region",inline:!0,disabled:!o},h.createElement(f.r,{className:c,value:a,options:s,onChange:this.handleRegionChanged,disabled:!o})))}})||Yn;class Kn extends h.Component{render(){const e=O.e.Instance;return h.createElement("img",{src:e.darkTheme?this.props.dark:this.props.light,style:{width:this.props.width,height:"auto"}})}}var Qn=i(442),Zn=i(443);class $n extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Qn,dark:Zn,width:"90%"})),h.createElement("p",null,'Contour configuration dialogue allows users to generate a contour layer on top of a raster image in the image viewer. Steps to create a contour layer with the "Levels" tab are:'),h.createElement("ol",null,h.createElement("li",null,h.createElement("p",null,'Select an image from the "Data source" dropdown. A per-channel histogram of the current channel and current Stokes as indicated in the animator will be displayed with visualization of mean (in dashed line) and mean +/- one standard deviation (in shaded area). Optionally, users can request per-cube histogram if necessary.')),h.createElement("li",null,h.createElement("p",null,"Define a set of contour levels to be calculated and rendered. There are various ways to define levels:"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"Click")," on the histogram plot to create a level. \xa0",h.createElement("code",null,"Right-Click"),' on a line to remove a level. Numerical values of levels are displayed in the "Levels" field.'),h.createElement("li",null,'Use the level generator. There are four preset generators. The generator will create a set of levels based on the control parameters by clicking the "Generate" button.'),h.createElement("li",null,'Manually input levels in the "Levels" field. Note that this field can be modified at any time, for example, after using the level generator.'))),h.createElement("li",null,h.createElement("p",null,'When a set of levels is defined, clicking the "Apply" button will trigger the contour calculations and render in the image viewer.'))),h.createElement("p",null,'To remove a contour layer, click the "Clear" button.'),h.createElement("p",null,"Users may use the lock button next to the data source dropdown to disable or enable synchronization of data source with the image slider in the animator."),h.createElement("h3",{id:"contour-smoothness"},"Contour smoothness"),h.createElement("p",null,'By default, image is Gaussian-smoothed with a kernel size of four pixels before calculating contour vertices. This can be customized in the "Configuration" tab. Smoothing mode includes:'),h.createElement("ul",null,h.createElement("li",null,"No smoothing"),h.createElement("li",null,"Block (faster, not ideal for compact objects)"),h.createElement("li",null,"Gaussian (default, slower, better appearance)")),h.createElement("h3",{id:"contour-cosmetics"},"Contour styling"),h.createElement("p",null,'The styling of contours can be customized with the "Styling" tab. Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"Line thickness"),h.createElement("li",null,"Representation of dashed line"),h.createElement("li",null,"Color as constant color or color-mapped"),h.createElement("li",null,"Bias"),h.createElement("li",null,"Contrast")),h.createElement("p",null,"Note that changes in styling will be applied immediately if the contour levels set does not change."),h.createElement("h3",{id:"customizing-the-contour-configuration-dialogue"},"Customizing the contour configuration dialogue"),h.createElement("p",null,'The defaults of many options in the contour configuration dialogue are customizable via the "Contour configuration" tab in the preference dialogue.'),h.createElement("p",null,'Performance related options are included in the "Performance" tab of the preference dialogue. ',h.createElement("em",null,"Note that we do not recommend to modify the factory defaults. Change with cautions.")))}}class Jn extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"File browser allows users to"),h.createElement("ul",null,h.createElement("li",null,"Load images in CASA, FITS, MIRIAD, or HDF5-IDIA schema formats as raster"),h.createElement("li",null,"Save images in CASA or FITS formats"),h.createElement("li",null,"Import and export region text files in CASA (.crtf) or ds9 (.reg) formats"),h.createElement("li",null,"Import catalogue files in VOTable or FITS formats")),h.createElement("h3",{id:"fileFiltering"},"File filtering"),h.createElement("p",null,"A file filter can be applied to the current directory. Three methods are provided:"),h.createElement("ul",null,h.createElement("li",null,"Fuzzy search: free typing"),h.createElement("li",null,"Unix-style search: e.g., *.fits"),h.createElement("li",null,"Regular expression search: e.g., colou?r")),h.createElement("h3",{id:"images"},"Images"),h.createElement("p",null,"Images can be loaded as raster via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Load image"),", or appended as raster via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Append image"),". All loaded images will be closed if users load an image with ",h.createElement("strong",null,"Load image"),". Image shown in the image viewer can be closed via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Close image"),". Images can be saved in CASA or FITS format via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Save image"),". Note that when saving an image, the server side needs to provide write permission (not a problem for the Desktop release)."),h.createElement("p",null,'When an image file is selected, its basic image properties are summarized in the "File Information" tab on the right-hand side. Full image header is shown in the "Header" tab.'),h.createElement("h3",{id:"regions"},"Regions"),h.createElement("p",null,"Region files can be imported via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Import regions"),'. When a region file is selected, its content is shown in the "Region Information" tab. Regions can be exported as region text files via ',h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Export regions"),". CASA and ds9 region text file definitions in world or image coordinates are supported. Note that when exporting a region text file, the server side needs to provide write permission (not a problem for the Desktop release)."),h.createElement("h3",{id:"catalogs"},"Catalogs"),h.createElement("p",null,"Catalogs can be loaded and visualized as tables via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Import catalog"),'. When a catalog file is selected, its basic catalog properties are summarized in the "Catalog Information" tab on the right-hand side. Full catalog column header is shown in the "Catalog Header" tab.'))}}var er=i(444),tr=i(445);class ir extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:er,dark:tr,width:"90%"})),h.createElement("p",null,"File header dialogue provides full image header and a summary of the properties of the image in the current image view. To switch to other images, use the image slider in the animator widget, or use the image list widget."))}}class nr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"With this dialogue, the current layout can be saved and re-used in the future. The widgets in a layout can be either docked or undocked."),h.createElement("h3",{id:"layout-management"},"Layout management"),h.createElement("p",null,"Load a preset layout or a custom layout: ",h.createElement("strong",null,"View")," -> ",h.createElement("strong",null,"Layouts")," -> ",h.createElement("strong",null,"Existing layouts")),h.createElement("p",null,"Set a layout as the default layout: ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Preferences")," -> ",h.createElement("strong",null,"Global")," tab -> ",h.createElement("strong",null,"Initial layout"),"."),h.createElement("p",null,"Delete a custom layout: ",h.createElement("strong",null,"View")," -> ",h.createElement("strong",null,"Layouts")," -> ",h.createElement("strong",null,"Delete layout"),"."))}}var rr=i(446),or=i(447);class ar extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:rr,dark:or,width:"90%"})),h.createElement("p",null,"The preferences dialogue provides a centralized place to customize the entire graphical user interface and performance control parameters. All settings are recorded and applied to new CARTA sessions. Some settings are effective immediately."),h.createElement("h3",{id:"global"},"Global"),h.createElement("p",null,"This section provides usability customization."),h.createElement("ul",null,h.createElement("li",null,"Theme: the color theme of the graphical user interface (effective immediately)"),h.createElement("li",null,"Auto-launch file browser: launch file browser when CARTA is initialized"),h.createElement("li",null,"Initial layout: the default layout for a new CARTA session"),h.createElement("li",null,"Initial cursor position: fix cursor at the image center or have cursor free to move"),h.createElement("li",null,"Initial zoom level: view full image or view image with one image pixel to one screen pixel ratio"),h.createElement("li",null,"Zoom to: control the focus of zooming with scrolling wheel"),h.createElement("li",null,"Enable drag-to-pan: when enabled, pan action is achieved by click-and-dragging. When disabled, pan action is achieved by a click where the clicked pixel will be centered in the image viewer."),h.createElement("li",null,"WCS matching on append: trigger WCS matching automatically for newly appended images"),h.createElement("li",null,"Spectral matching: spectral convention to be used for spectral matching of image cubes")),h.createElement("h3",{id:"render-configuration"},"Render configuration"),h.createElement("p",null,"This section provides customization of how a raster image is rendered by default."),h.createElement("ul",null,h.createElement("li",null,"Default scaling: scaling function to be applied to a colormap"),h.createElement("li",null,"Default colormap: colormap for rendering a raster image"),h.createElement("li",null,"Default percentile ranks: clip level to be applied to the pixel value-to-color mapping"),h.createElement("li",null,"NaN color: color to render a NaN (not a number) pixel")),h.createElement("h3",{id:"contour-configuration"},"Contour configuration"),h.createElement("p",null,"This section provides customization of how a contour layer is calculated and rendered by default."),h.createElement("ul",null,h.createElement("li",null,"Generator type: default level generator type"),h.createElement("li",null,"Smoothing mode: smoothing method to be applied before calculating contour vertices"),h.createElement("li",null,"Default smoothing factor: kernel size of the selected smoothing mode"),h.createElement("li",null,"Default contour levels: number of contour levels to be generated"),h.createElement("li",null,"Thickness: contour line thickness"),h.createElement("li",null,"Default color mode: to render contours with constant color or to render color-mapped contours"),h.createElement("li",null,"Default color map: colormap for rendering color-mapped contours"),h.createElement("li",null,"Default color: color for rendering contours with constant color")),h.createElement("h3",{id:"overlay-configuration"},"Overlay configuration"),h.createElement("p",null,"This section provides customization of the image overlay in the image viewer."),h.createElement("ul",null,h.createElement("li",null,"AST color: the default color theme of the grid layers including the coordinate bound box"),h.createElement("li",null,"AST grid visible: grid line rendering"),h.createElement("li",null,"AST label visible: grid x and y labels rendering"),h.createElement("li",null,"WCS format: show world coordinates in degrees or sexagesimal or auto-formatted"),h.createElement("li",null,"Beam visible: beam rendering at the bottom-left corner of the image viewer"),h.createElement("li",null,"Beam color: the color to render a beam element"),h.createElement("li",null,"Beam type: render a beam as open shape or filled shape"),h.createElement("li",null,"Beam width: line width to render an open-shape beam")),h.createElement("h3",{id:"region"},"Region"),h.createElement("p",null,"This section provides customization of region rendering properties and region creation interactivity."),h.createElement("ul",null,h.createElement("li",null,"Color: default color to render a region"),h.createElement("li",null,"Line width: default line width to render a region"),h.createElement("li",null,"Dash length: when greater than zero, region is rendered in dashed line"),h.createElement("li",null,"Region type: default region type"),h.createElement("li",null,"Creation mode: the way how rectangle and ellipse regions are created with cursor")),h.createElement("h3",{id:"performance"},"Performance"),h.createElement("p",null,'Performance related control parameters are included here. We do not recommend users to change the settings here. If the bandwidth connecting to a CARTA server is limited, users may enable the "low bandwidth mode" which reduces displayed image resolution and cursor responsiveness.'),h.createElement("h3",{id:"log-events"},"Log events"),h.createElement("p",null,"This is for development and debugging purpose. General users should not enable anything here."))}}class sr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"The region configuration dialogue allows users to change the appearance of a region, such as"),h.createElement("ul",null,h.createElement("li",null,"color"),h.createElement("li",null,"linewidth"),h.createElement("li",null,"line style (solid or dashed)")),h.createElement("p",null,"and region properties, such as"),h.createElement("ul",null,h.createElement("li",null,"region name"),h.createElement("li",null,"region location and shape properties in image or world coordinate")),h.createElement("p",null,"Region properties can be defined in world coordinate. If the coordinate reference system is FK4, FK5, or ICRS, the coordinate format is sexagesimal. If the coordinate system is Galactic or Ecliptic, the coordinate format is decimal degree. Region size can be defined in arcsecond with ",h.createElement("code",null,'"'),", in arcminute with ",h.createElement("code",null,"'"),", or in degree with ",h.createElement("code",null,"deg"),"."),h.createElement("br",null),h.createElement("h4",{id:"note"},"NOTE"),h.createElement("p",null,"The displayed image coordinates refer to the spatial reference image as indicated in the title of the dialogue."),h.createElement("h4",{id:"tip"},"TIP"),h.createElement("p",null,h.createElement("code",null,"Double-Click")," on a region in the image viewer or on an entry in the region list widget will bring up this region configuration dialogue."))}}var lr=i(448),cr=i(449);class ur extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:lr,dark:cr,width:"90%"})),h.createElement("p",null,'The animator widget controls which im\bage, which channel (if exists per image file), and which Stokes (if exists per image file) to view in the image viewer. Users may also enable animation playback for image, channel, or Stokes, via the "Play" button. The radio buttons control which one to animate. Playback mode includes'),h.createElement("ul",null,h.createElement("li",null,"Forward: with index increasing"),h.createElement("li",null,"Backward: with index decreasing"),h.createElement("li",null,"Bouncing: with index increasing and decreasing so on and so forth between the boundary"),h.createElement("li",null,"Blink: with index jumping between the boundary")),h.createElement("p",null,"For channel, users may limit a channel range for animation playback via the double slider."),h.createElement("p",null,"A desired frame rate per second (fps) can be defined in the frame rate spinbox. Note that the real fps depends on computer performance and network performance."),h.createElement("p",null,'For performance concern and resource management, animation playback will be automatically stopped after 5 minutes by default. This can be customized in the "Performance" tab of the preferences dialogue (',h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Preferences"),"). Maximum playback time is 30 mins."))}}var pr=i(450),dr=i(451);class hr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:pr,dark:dr,width:"90%"})),h.createElement("p",null,"Histogram widget displays a histogram plot derived from a 2D region. When no region is created or selected, it displays a histogram derived from the current full image in the image viewer."),h.createElement("h3",{id:"images"},"Images"),h.createElement("p",null,'The image dropdown defaults to "Active" image which means the current image in the image viewer.'),h.createElement("h3",{id:"regions"},"Regions"),h.createElement("p",null,'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one in the image viewer, or by clicking a region entry on the region list widget. Histogram plot of the selected region will be updated accordingly.'),h.createElement("h3",{id:"interactivity-zoom-and-pan"},"Interactivity: zoom and pan"),h.createElement("p",null,"The x and y ranges of the histogram plot can be modified by"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"scrolling wheel")," (up to zoom in and down to zoom out with respect to the cursor position)"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," horizontally to zoom in x"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," vertically to zoom in y"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," diagonally to zoom in both x and y"),h.createElement("li",null,h.createElement("code",null,"double-click")," to reset x and y ranges"),h.createElement("li",null,h.createElement("code",null,"shift + click-and-drag")," to pan in x")),h.createElement("p",null,"In addition, the x and y ranges can be explicitly set in the histogram settings dialogue."),h.createElement("h3",{id:"exports"},"Exports"),h.createElement("p",null,"The histogram plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."),h.createElement("h3",{id:"plot-cosmetics"},"Plot cosmetics"),h.createElement("p",null,"The appearance of the histogram plot is customizable via the histogram settings dialogue (the cog icon). Supported options are:"),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots"),h.createElement("li",null,"display y in logarithmic scale (default)")),h.createElement("br",null),h.createElement("h4",{id:"note"},"Note"),h.createElement("p",null,"In the current release, the number of histogram bins is automatically derived as the square root of the product of region bound box sizes in x and y. The development team will improve this in future releases."),h.createElement("h4",{id:"tip"},"TIP"),h.createElement("p",null,"Multiple histogram widgets can be created to show histograms for different images with different regions."))}}class gr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"Histogram settings dialogue allows users to customize the appearance of the histogram plot, and set x and y ranges of the plot explicitly."),h.createElement("p",null,"Supported options are:"),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots"),h.createElement("li",null,"display y in logarithmic scale (default)")))}}var mr=i(452),fr=i(453),yr=i(454),br=i(455),Or=i(456),Sr=i(457),Cr=i(458),Er=i(459),Ir=i(460),wr=i(461),Tr=i(462),vr=i(463),Ar=i(464),xr=i(465),Rr=i(466),Pr=i(467),jr=i(204),kr=i(205);class Fr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"The image viewer widget serves as the core component of CARTA. It allows users to visualize images in rasters and in contours. Region of interests can be defined interactively with the image viewer and subsequent image analysis can be performed with other widgets. Catalogue files can be loaded and visualized in the image viewer with the Catalogue widget."),h.createElement("p",null,"Images can be loaded via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Open image")," (will close all loaded image first). Users may load multiple images via ",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Append image"),". All images are loaded as raster by default. Contour layers can be further generated via the contour configuration dialogue."),h.createElement("p",null,"Information of world coordinates and image coordinates at the cursor position is shown at the top of the image viewer. To freeze/unfreeze the cursor position, press ",h.createElement("code",null,"F")," key."),h.createElement("h3",{id:"image-tool-buttons"},"Image tool buttons"),h.createElement("p",null,"A set of tool buttons is provided at the bottom-right corner when hovering over the image viewer. Users may use these buttons to"),h.createElement("ul",null,h.createElement("li",null,"Select a source from catalog overlay"),h.createElement("li",null,"Create regions"),h.createElement("li",null,"Change image zoom scale"),h.createElement("li",null,"Trigger WCS matching"),h.createElement("li",null,"Change grid overlay reference frame"),h.createElement("li",null,"Enable/disable grid lines and coordinate labels"),h.createElement("li",null,"Export image")),h.createElement("p",null,h.createElement(Kn,{light:Ir,dark:wr,width:"90%"})),h.createElement("h3",{id:"zoom-and-pan"},"Zoom and pan"),h.createElement("p",null,"Zoom actions can be triggered in different ways. The most common one is to use mouse and scroll wheel. By scrolling up, image is zoomed in, while by scrolling down, image is zoomed out. Alternatively, users may use the tool buttons at the bottom-right corner of the image viewer to zoom in, zoom out, zoom to fit screen resolution, or zoom to fit image view."),h.createElement("p",null,h.createElement(Kn,{light:Rr,dark:Pr,width:"70%"})),h.createElement("p",null,"Pan action is achieved by ",h.createElement("code",null,"Click-and-drag")," as default. This default can be changed via the preferences dialogue (",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Preferences")," -> ",h.createElement("strong",null,"Global"),"). The alternative mode is ",h.createElement("code",null,"Click")," and the clicked pixel will be centered in the image viewer."),h.createElement("h3",{id:"matching-image-spatially-and-spectrally"},"Matching image spatially and spectrally"),h.createElement("p",null,'Appended images may be matched in world coordinate spatially and/or spectrally. This can be triggered by the "WCS matching" button. Matching WCS on appending can be enabled in the preferences dialogue.'),h.createElement("p",null,h.createElement(Kn,{light:Ar,dark:xr,width:"70%"})),h.createElement("p",null,"CARTA supports the following matching schemes:"),h.createElement("ul",null,h.createElement("li",null,"None: zoom levels of different images are independent. No matching in the spectral domain."),h.createElement("li",null,"Spatial only: images are matched to the reference image in the spatial domain by translation, rotation, and scaling."),h.createElement("li",null,"Spectral only: images are matched to the reference image in the spectral domain with nearest interpolation."),h.createElement("li",null,"Spatial and spectral: images are matched to the reference image both in the spatial domain and spectral domain.")),h.createElement("p",null,"Note that images are spatially matched by applying translation, rotation, and scaling. Inconsistency may be prominent when attempting to match wide field images or images with different projection types. However, grid lines are still accurate per image. If contour layers exist, they will match the raster image in the current image view with high position accuracy. Spectral matching is performed with nearest interpolation."),h.createElement("h3",{id:"contour-layers"},"Contour layers"),h.createElement("p",null,"A contour layer can be generated via the contour configuration dialogue. Contours of spatially matched image are re-projected to other spatially matched raster image."),h.createElement("p",null,h.createElement(Kn,{light:yr,dark:br,width:"85%"})),h.createElement("h3",{id:"region-of-interest"},"Region of interest"),h.createElement("p",null,"Four types of region of interest are supported, including:"),h.createElement("ul",null,h.createElement("li",null,"Point"),h.createElement("li",null,"Rectangle (rotatable)"),h.createElement("li",null,"Ellipse (rotatable)"),h.createElement("li",null,"Polygon")),h.createElement("p",null,h.createElement(Kn,{light:Tr,dark:vr,width:"70%"})),h.createElement("p",null,"The default region type and the default region creation mode are customizable in the preferences dialogue. Region shortcut buttons are available at the top of the CARTA GUI. The tooltip of a region shortcut button provides instructions to create a region."),h.createElement("h3",{id:"catalogue-layers"},"Catalog overlay"),h.createElement("p",null,"A catalog overlay can be generated via the Catalog widget."),h.createElement("p",null,h.createElement(Kn,{light:jr,dark:kr,width:"85%"})),h.createElement("p",null,"To select a source, use the Catalog selection button. The selected source will be highlighted in the table of the Catalog widget."),h.createElement("p",null,h.createElement(Kn,{light:mr,dark:fr,width:"70%"})),h.createElement("h3",{id:"customizing-the-image-plot"},"Customizing the image plot"),h.createElement("p",null," The image overlay can be customized via the image view settings dialogue. Plenty amounts of options are provided."),h.createElement("h3",{id:"exports"},"Exports"),h.createElement("p",null,'What users see in the current image view can be exported as a PNG file with the "Export image" button in the image tool bar.'),h.createElement("p",null,h.createElement(Kn,{light:Or,dark:Sr,width:"70%"})),h.createElement("h3",{id:"image-information-and-header"},"Image information and header"),h.createElement("p",null,"Basic image information and full image headers are displayed in the file header dialogue."),h.createElement("p",null,h.createElement(Kn,{light:Cr,dark:Er,width:"85%"})))}}var Mr=i(468),Dr=i(469);class Nr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"The image view settings dialogue allows users to customize coordinate grid related properties in the image viewer."),h.createElement("h3",{id:"global"},"Global"),h.createElement("p",null,"This section allows users to"),h.createElement("ul",null,h.createElement("li",null,"set a global color theme for the grid overlay"),h.createElement("li",null,"configure grid line rendering accuracy"),h.createElement("li",null,"put coordinate labels inside or outside the image"),h.createElement("li",null,"select a coordinate reference frame to generate the grid overlay")),h.createElement("h3",{id:"title"},"Title"),h.createElement("p",null,"A custom title can be added in the image view. Its font type, font size, and color are configurable."),h.createElement("h3",{id:"ticks"},"Ticks"),h.createElement("p",null,"This section allows users to changes the ticks properties, including location, density, color, line width, and length of major and minor ticks"),h.createElement("h3",{id:"grid"},"Grid"),h.createElement("p",null,"The appearance of the coordinate grid lines is customizable, including visibility, color, and line width."),h.createElement("h3",{id:"border"},"Border"),h.createElement("p",null,"This section allows users to change the style of the axis border, including visibility, color, and width."),h.createElement("h3",{id:"axes"},"Axes"),h.createElement("p",null,"This section allows users to adjust the appearance of an interior axis overlay, including visibility, color, and line width."),h.createElement("h3",{id:"numbers"},"Numbers"),h.createElement("p",null,"This sections allows users to customize the appearance of tick values, including:"),h.createElement("ul",null,h.createElement("li",null,"visibility"),h.createElement("li",null,"font type"),h.createElement("li",null,"font size"),h.createElement("li",null,"color"),h.createElement("li",null,"format as sexagesimal or decimal degree"),h.createElement("li",null,"coordinate precision")),h.createElement("h3",{id:"labels"},"Labels"),h.createElement("p",null,"This section allows users to modify the styles of the x and y labels, such as font type, font size, and color. A custom label can be defined."),h.createElement("h3",{id:"beam"},"Beam"),h.createElement("p",null,"This section allows users to change the appearance of a beam overlay (color, type, and line width) and adjust its position in the image viewer."),h.createElement("h4",null,"EXAMPLE"),h.createElement("p",null,h.createElement(Kn,{light:Mr,dark:Dr,width:"90%"})))}}var Lr=i(470),_r=i(471);class zr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Lr,dark:_r,width:"90%"})),h.createElement("p",null,"The image list widget displays loaded images as a list, which includes image name, rendering layers (R as raster and C as contours) and layer visibility state, WCS matching state, channel index, and Stokes index. The channel index and Stokes index are synchronized with the animator."),h.createElement("p",null,'Users may click "R" and/or "C" to hide/show a layer. For example, if users want to generate an image with contours only, users can hide raster layers by clicking "R".'),h.createElement("p",null,'Per image, users can click the "XY" button to enable/disable spatial matching and click "Z" button to enable/disable spectral matching.'),h.createElement("p",null,"To change reference image, ",h.createElement("code",null,"right-click")," on a row to bring up the menu."),h.createElement("p",null,"To close an image (or images), ",h.createElement("code",null,"right-click")," on a row to bring up the menu."),h.createElement("p",null,"The list order reflects the order of the image slider in the animator. The order may be modified by selecting an entry by ",h.createElement("code",null,"clicking")," then ",h.createElement("code",null,"click-and-dragging")," to form a desired order."))}}var Wr=i(472),Gr=i(473);class Vr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Wr,dark:Gr,width:"90%"})),h.createElement("p",null,"Log widget provides information for diagnostics when something went wrong. The log levels include:"),h.createElement("ul",null,h.createElement("li",null,"Debug"),h.createElement("li",null,"Info (default)"),h.createElement("li",null,"Warning"),h.createElement("li",null,"Error"),h.createElement("li",null,"Critical")),h.createElement("p",null,"When users believe there is something wrong, please contact the ",h.createElement("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw"},"helpdesk")," or file an issue on ",h.createElement("a",{href:"https://github.com/CARTAvis/carta/issues"},"Github")," (recommended)."))}}var Br=i(474);class qr extends h.Component{render(){return h.createElement(h.Fragment,null,h.createElement("p",null,"To be added."),h.createElement("img",{src:Br,style:{width:"20%",height:"auto"}}))}}var Hr=i(475),Ur=i(476);class Yr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Hr,dark:Ur,width:"90%"})),h.createElement("p",null,"Region list widget provides users a list of region created via the graphical user interface and/or via region import (",h.createElement("strong",null,"File")," -> ",h.createElement("strong",null,"Import regions"),"). Basic information of a region is shown in an entry in the list. The current active region is highlighted in the list and region control anchors are shown in the image viewer. To unselect a region, press ",h.createElement("code",null,"esc")," key."),h.createElement("p",null,h.createElement("code",null,"Double-Click")," on a list entry or on a region in the image viewer will bring up the region configuration dialogue, where users can adjust region appearance and region properties."),h.createElement("p",null,'The "lock" button for each region entry is to prevent editing a region accidentally. Locked regions will appear slightly dimmer in the image viewer. The "center" button is to center a region in the current field of view of the image viewer.'),h.createElement("p",null,"To delete an active (selected) region, press ",h.createElement("code",null,"delete")," key."))}}var Xr=i(477),Kr=i(478);class Qr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Xr,dark:Kr,width:"90%"})),h.createElement("p",null,'Render configuration widget controls how a raster image is rendered in color space. The widget equips with a set of clip levels as buttons on the top. The clip boundaries are displayed in the "Clip Min" and "Clip Max" fields. These fields can be manually edited and the clip level will switch to "Custom". The clip boundaries are visualized as two vertical lines (also draggable) in red in the histogram.'),h.createElement("p",null,'As default, a per-channel histogram is shown, and optionally a per-cube histogram can be displayed via the "Histogram" dropdown. Different scaling functions and colormaps can be chosen via the "Scaling" and "Color map" dropdowns, respectively. A color map might be inverted via the "Invert color map" toggle.'),h.createElement("p",null,"The appearance of the histogram plot can be configured through the render configuration settings dialogue, including:"),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots"),h.createElement("li",null,"display y in logarithmic scale (default)"),h.createElement("li",null,"display mean and RMS"),h.createElement("li",null,"display clip labels")),h.createElement("h3",{id:"interactivity-zoom-and-pan"},"Interactivity: zoom and pan"),h.createElement("p",null,"The x and y ranges of the histogram plot can be modified by"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"scrolling wheel")," (up to zoom in and down to zoom out with respect to the cursor position)"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," horizontally to zoom in x"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," vertically to zoom in y"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," diagonally to zoom in both x and y"),h.createElement("li",null,h.createElement("code",null,"double-click")," to reset x and y ranges"),h.createElement("li",null,h.createElement("code",null,"shift + click-and-drag")," to pan in x")),h.createElement("p",null,"In addition, the x and y ranges can be explicitly set in the render configuration settings dialogue."))}}class Zr extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,"The appearance of the histogram plot in the render configuration widget can be customized through this settings dialogue, including:"),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots"),h.createElement("li",null,"display y in logarithmic scale (default)"),h.createElement("li",null,"display mean and RMS"),h.createElement("li",null,"display clip labels")))}}var $r=i(479),Jr=i(480);class eo extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:$r,dark:Jr,width:"90%"})),h.createElement("p",null,"Spatial profiler widget allows users to view a profile from a horizontal cut or a vertical cut at the cursor position in the image viewer. The cursor position may be fixed in the image viewer by pressing ",h.createElement("code",null,"F")," key. Pressing again will unfreeze the cursor."),h.createElement("p",null,"The cursor position in the image viewer is displayed as a red vertical line in the spatial profile plot."),h.createElement("p",null,"When cursor is in the image viewer, the cursor position and pointed pixel value in image and world coordinates are reported at the bottom-left corner of the spatial profiler widget. When cursor moves into the spatial profile plot, numerical values of the profile at the cursor position (displayed as a grey vertical line) will be reported instead."),h.createElement("h3",{id:"profile-mean-and-rms"},"Profile mean and RMS"),h.createElement("p",null,'As an option in the "Styling" tab of the spatial profiler settings dialogue, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too.'),h.createElement("h3",{id:"profile-smoothing"},"Profile smoothing"),h.createElement("p",null,'The displayed profile can be smoothed via the "Smoothing" tab of the spatial profiler settings dialogue (the cog icon).'),h.createElement("h3",{id:"interactivity-zoom-and-pan"},"Interactivity: zoom and pan"),h.createElement("p",null,"The x and y ranges of the spatial profile plot can be modified by"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"scrolling wheel")," (up to zoom in and down to zoom out with respect to the cursor position)"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," horizontally to zoom in x"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," vertically to zoom in y"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," diagonally to zoom in both x and y"),h.createElement("li",null,h.createElement("code",null,"double-click")," to reset x and y ranges"),h.createElement("li",null,h.createElement("code",null,"shift + click-and-drag")," to pan in x")),h.createElement("p",null,"In addition, the x and y ranges can be explicitly set in the spatial profiler settings dialogue."),h.createElement("h3",{id:"exports"},"Exports"),h.createElement("p",null,"The spatial profile plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."),h.createElement("h3",{id:"plot-cosmetics"},"Plot cosmetics"),h.createElement("p",null,'The appearance of the spatial profile plot is customizable via the "Styling" tab of the spatial profiler settings dialogue (the cog icon). Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots"),h.createElement("li",null,"display alternative horizontal axis in world coordinate")),h.createElement("br",null),h.createElement("h4",{id:"note"},"NOTE"),h.createElement("p",null,'For performance concerns, a profile is decimated before rendering if the number of points of the profile is greater than the screen resolution of the spatial profiler widget. The kernel size of profile decimation is dynamically adjusted so that profile features are mostly preserved. When decimation is applied, the line style of the profile plot is switched to "line", regardless the setting in the spatial profiler settings dialogue. When no decimation is applied (e.g., at higher profile zoom level, or profile has fewer points than the screen resolution), the line style becomes "step" (as default in the "Styling" tab of the settings dialogue).'))}}class to extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Styling"),h.createElement("p",null,"The Styling tab allows users to adjust the appearance of the profile plot, and set x and y ranges of the plot explicitly. In addition, users can select which cut (horizontal or vertical) at cursor to use to generate a spatial profile. Users may also enable visualization of mean and RMS values of the current profile in the plot."),h.createElement("p",null,"Supported options for plot appearance are:"),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots"),h.createElement("li",null,"display alternative horizontal axis in world coordinate")))}}var io=i(133),no=i(134),ro=i(135),oo=i(136),ao=i(137),so=i(206),lo=i(138),co=i(139),uo=i(140),po=i(141),ho=i(142),go=i(207);class mo extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Smoothing"),h.createElement("p",null,"Smoothing may be applied to profiles to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"),h.createElement("ul",null,h.createElement("li",null,h.createElement("b",null,"Boxcar"),": convolution with a boxcar function"),h.createElement("li",null,h.createElement("b",null,"Gaussian"),": convolution with a Gaussian function"),h.createElement("li",null,h.createElement("b",null,"Hanning"),": convolution with a Hanning function"),h.createElement("li",null,h.createElement("b",null,"Binning"),": averaging channels with a given width"),h.createElement("li",null,h.createElement("b",null,"Savitzky-Golay"),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"),h.createElement("li",null,h.createElement("b",null,"Decimation"),": min-max decimation with a given width")),h.createElement("p",null,"Optionally, the original profile can be overplotted with the smoothed profile. The appearance of the smoothed profile, including color, style, width, and size, can be customized."),h.createElement("p",null,"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied."),h.createElement("h3",null,"Examples"),h.createElement("p",null,"Boxcar: Kernel = 2"),h.createElement("p",null,h.createElement(Kn,{light:io,dark:lo,width:"90%"})),h.createElement("p",null,"Gaussian: Sigma = 1"),h.createElement("p",null,h.createElement(Kn,{light:no,dark:co,width:"90%"})),h.createElement("p",null,"Hanning: Kernel = 5"),h.createElement("p",null,h.createElement(Kn,{light:ro,dark:uo,width:"90%"})),h.createElement("p",null,"Binning: Binning width = 3"),h.createElement("p",null,h.createElement(Kn,{light:oo,dark:po,width:"90%"})),h.createElement("p",null,"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"),h.createElement("p",null,h.createElement(Kn,{light:ao,dark:ho,width:"90%"})),h.createElement("p",null,"Decimation: Decimation width = 3"),h.createElement("p",null,h.createElement(Kn,{light:so,dark:go,width:"90%"})))}}var fo=i(481),yo=i(482);class bo extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:fo,dark:yo,width:"90%"})),h.createElement("p",null,'The spectral profiler widget allows users to view a region spectral profile of an image cube with a specific statistic (via the "Statistic" dropdown; default as mean). If Stokes axis exists, users may view a specific Stokes via the "Stokes" dropdown.'),h.createElement("h3",{id:"images"},"Images"),h.createElement("p",null,'The image dropdown defaults to "Active" image which means the current image in the image viewer.'),h.createElement("h3",{id:"regions"},"Regions"),h.createElement("p",null,'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Spectral profile plot of the selected region will be updated accordingly. If no region is selected, "Active" region defaults to cursor.'),h.createElement("h3",{id:"responsive-and-progressive-profile-update"},"Responsive and progressive profile update"),h.createElement("p",null,"When a region spectral profile is requested, depending on the performance of the server, users may see profiles are updated piece by piece in regular interval. This feature provides a visual progress update for better user experience. In addition, if users move a region while its spectral profile is being updating, the old calculations will be terminated immediately and calculations of the new region spectral profile will start and users will see a partial profile in seconds."),h.createElement("h3",{id:"spectral-conventions-and-reference-frame"},"Spectral conventions and reference frame"),h.createElement("p",null,'With the "Conversion" tab of the spectral profiler settings dialogue, users can change the spectral convention, including:'),h.createElement("ul",null,h.createElement("li",null,"Radio velocity (km/s, m/s)"),h.createElement("li",null,"Optical velocity (km/s, m/s)"),h.createElement("li",null,"Frequency (GHz, MHz, kHz, Hz)"),h.createElement("li",null,"Wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Air wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Channel")),h.createElement("p",null,"and spectral reference frame, including:"),h.createElement("ul",null,h.createElement("li",null,"LSRK: the rest-frame of the kinematical local standard of rest"),h.createElement("li",null,"LSRD: the rest-frame of the dynamical local standard of rest"),h.createElement("li",null,"BARY: barycentric, the rest-frame of the solar-system barycenter"),h.createElement("li",null,"TOPO: topocentric, the observer's rest-frame on Earth")),h.createElement("p",null,"Note that depending on the integrity of image headers, some conversions may not be possible."),h.createElement("h3",{id:"profile-smoothing"},"Profile smoothing"),h.createElement("p",null,'The displayed profile can be smoothed via the "Smoothing" tab of the spectral profiler settings dialogue (the cog icon). A shortcut button of the "Smoothing" tab can be found at the top-right corner of the widget.'),h.createElement("h3",{id:"profile-mean-and-rms"},"Profile mean and RMS"),h.createElement("p",null,'As an option in the "Styling" tab of the spectral profiler settings dialogue, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too.'),h.createElement("h3",{id:"moment-image-generator"},"Moment image generator"),h.createElement("p",null,'Moment images can be generated via the "Moments" tab of the spectral profiler settings dialogue (the cog icon). A shortcut button of the "Moments" tab can be found at the top-right corner of the widget.'),h.createElement("h3",{id:"interactivity-zoom-pan-changing-channel"},"Interactivity: zoom, pan, changing channel"),h.createElement("p",null,"The x and y ranges of the spectral profile plot can be modified by"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"scrolling wheel")," (up to zoom in and down to zoom out with respect to the cursor position)"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," horizontally to zoom in x"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," vertically to zoom in y"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," diagonally to zoom in both x and y"),h.createElement("li",null,h.createElement("code",null,"double-click")," to reset x and y ranges"),h.createElement("li",null,h.createElement("code",null,"shift + click-and-drag")," to pan in x")),h.createElement("p",null,'In addition, the x and y ranges can be explicitly set in the "Styling" tab of the spectral profile settings dialogue.'),h.createElement("p",null,"Users may click on the spectral profile plot to switch to a channel (as indicated by a red vertical line) and view the image in the image viewer. The red line is draggable and acts equivalently like the channel slider in the animator widget."),h.createElement("h3",{id:"exports"},"Exports"),h.createElement("p",null,"The spectral profile plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."),h.createElement("h3",{id:"plot-cosmetics"},"Plot cosmetics"),h.createElement("p",null,'The appearance of the spectral profile plot is customizable via the "Styling" tab of the spectral profile settings dialogue (the cog icon). Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots")),h.createElement("br",null),h.createElement("h4",{id:"note"},"NOTE"),h.createElement("p",null,'For performance concerns, a profile is decimated before rendering if the number of points of the profile is greater than the screen resolution of the spectral profiler widget. The kernel size of profile decimation is dynamically adjusted so that profile features are mostly preserved. When decimation is applied, the line style of the profile plot is switched to "line", regardless the setting in the spectral profiler settings dialogue. When no decimation is applied (e.g., at higher profile zoom level, or profile has fewer points than the screen resolution), the line style becomes "step" (as default in the "Styling" tab of the settings dialogue).'))}}class Oo extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Conversion"),h.createElement("p",null,'With the "Conversion" tab, users can change the spectral convention, including:'),h.createElement("ul",null,h.createElement("li",null,"Radio velocity (km/s, m/s)"),h.createElement("li",null,"Optical velocity (km/s, m/s)"),h.createElement("li",null,"Frequency (GHz, MHz, kHz, Hz)"),h.createElement("li",null,"Wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Air wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Channel")),h.createElement("p",null,"and spectral reference frame, including:"),h.createElement("ul",null,h.createElement("li",null,"LSRK: the rest-frame of the kinematical local standard of rest"),h.createElement("li",null,"LSRD: the rest-frame of the dynamical local standard of rest"),h.createElement("li",null,"BARY: barycentric, the rest-frame of the solar-system barycenter"),h.createElement("li",null,"TOPO: topocentric, the observer's rest-frame on Earth")),h.createElement("p",null,"Note that depending on the integrity of image headers, some conversions may not be possible."))}}class So extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Styling"),h.createElement("p",null,'The appearance of a spectral profile plot is customizable via the "Styling" tab. Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots")),h.createElement("h4",null,"Profile mean and RMS"),h.createElement("p",null,"As an option in the spectral profiler settings dialogue, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too."))}}class Co extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Smoothing"),h.createElement("p",null,"Smoothing may be applied to profiles to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"),h.createElement("ul",null,h.createElement("li",null,h.createElement("b",null,"Boxcar"),": convolution with a boxcar function"),h.createElement("li",null,h.createElement("b",null,"Gaussian"),": convolution with a Gaussian function"),h.createElement("li",null,h.createElement("b",null,"Hanning"),": convolution with a Hanning function"),h.createElement("li",null,h.createElement("b",null,"Binning"),": averaging channels with a given width"),h.createElement("li",null,h.createElement("b",null,"Savitzky-Golay"),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"),h.createElement("li",null,h.createElement("b",null,"Decimation"),": min-max decimation with a given width")),h.createElement("p",null,"Optionally, the original profile can be overplotted with the smoothed profile. The appearance of the smoothed profile, including color, style, width, and size, can be customized."),h.createElement("p",null,"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied."),h.createElement("h3",null,"Examples"),h.createElement("p",null,"Boxcar: Kernel = 2"),h.createElement("p",null,h.createElement(Kn,{light:io,dark:lo,width:"90%"})),h.createElement("p",null,"Gaussian: Sigma = 1"),h.createElement("p",null,h.createElement(Kn,{light:no,dark:co,width:"90%"})),h.createElement("p",null,"Hanning: Kernel = 5"),h.createElement("p",null,h.createElement(Kn,{light:ro,dark:uo,width:"90%"})),h.createElement("p",null,"Binning: Binning width = 3"),h.createElement("p",null,h.createElement(Kn,{light:oo,dark:po,width:"90%"})),h.createElement("p",null,"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"),h.createElement("p",null,h.createElement(Kn,{light:ao,dark:ho,width:"90%"})),h.createElement("p",null,"Decimation: Decimation width = 3"),h.createElement("p",null,h.createElement(Kn,{light:so,dark:go,width:"90%"})))}}class Eo extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Moments"),h.createElement("p",null,'Moment images can be generated and viewed with CARTA. The "Moments" tab provides several control parameters to define how moment images are calculated, including:'),h.createElement("ul",null,h.createElement("li",null,h.createElement("b",null,"Image"),': the image file for moment calculations. "Active" refers to the image displayed in the image viewer.'),h.createElement("li",null,h.createElement("b",null,"Region"),': a region can be selected so that moment calculations are limited inside the region. "Active" refers to the selected region in the image viewer. If no region is selected, full image is included in the moment calculations.'),h.createElement("li",null,h.createElement("b",null,"Coordinate, System, and Range"),": the spectral range (e.g., velocity range) used for moment calculations is defined with these options. The range can be defined either via the text input fields, or via the cursor by dragging horizontally in the spectral profiler widget."),h.createElement("li",null,h.createElement("b",null,"Mask and Range"),': these options define a pixel value range used for moment calculations. If mask is "None", all pixels are included. If mask is "Include" or "Exclude", the pixel value range defined in the text input fields is included or excluded, respectively. Alternatively, the pixel value range can be defined via the cursor by dragging vertically in the spectral profiler widget.'),h.createElement("li",null,h.createElement("b",null,"Moments"),": which moment images to be calculated are defined here. Supported options are:",h.createElement("ul",null,h.createElement("li",null,"-1: Mean value of the spectrum"),h.createElement("li",null,"0: Integrated value of the spectrum"),h.createElement("li",null,"1: Intensity weighted coordinate"),h.createElement("li",null,"2: Intensity weighted dispersion of the coordinate"),h.createElement("li",null,"3: Median value of the spectrum"),h.createElement("li",null,"4: Median coordinate"),h.createElement("li",null,"5: Standard deviation about the mean of the spectrum"),h.createElement("li",null,"6: Root mean square of the spectrum"),h.createElement("li",null,"7: Absolute mean deviation of the spectrum"),h.createElement("li",null,"8: Maximum value of the spectrum"),h.createElement("li",null,"9: Coordinate of the maximum value of the spectrum"),h.createElement("li",null,"10: Minimum value of the spectrum"),h.createElement("li",null,"11: Coordinate of the minimum value of the spectrum")))),h.createElement("p",null,'When all the parameters are defined, by clicking the "Generate" button moment calculations will begin. Depending on the file size, moment calculations may take a while. If that happens, users may consider to cancel the calculations and re-define a proper region and/or spectral range.'),h.createElement("p",null,'Once moment images are generated, they will be loaded and displayed in the image viewer. They are named as $image_filename.moment.$keyword. For example, if moment 0, 1 and 2 images are generated from the image M51.fits, they will be named as M51.fits.moment.integrated, M51.fits.moment.weighted_coord, and M51.fits.moment.weighted_dispersion_coord, respectively. These images are kept in RAM per session and if there is a new request of moment calculations, these images will be deleted first. Optionally, calculated moment images can be exported in CASA or FITS format via "File" -> "Save image".'),h.createElement("h4",null,"NOTE"),h.createElement("p",null,'Due to a CASA issue, image of "Median coordinate" cannot be generated. The request of "Median coordinate" is ignored automatically.'))}}var Io=i(483),wo=i(484);class To extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Io,dark:wo,width:"90%"})),h.createElement("p",null,"Statistics widget allows users to view statistical quantities over a 2D region. When no region is created or selected, it displays statistical quantities of the full image in the image viewer."),h.createElement("h3",{id:"images"},"Images"),h.createElement("p",null,'The image dropdown defaults to "Active" image which means the current image in the image viewer.'),h.createElement("h3",{id:"regions"},"Regions"),h.createElement("p",null,'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Statistics of the selected region will be updated accordingly.'),h.createElement("h3",{id:"statistic"},"Statistic"),h.createElement("p",null,"CARTA provides the following statistical quantities:"),h.createElement("ul",null,h.createElement("li",null,"NumPixels: number of pixels in a region"),h.createElement("li",null,"Sum: summation of pixel values in a region"),h.createElement("li",null,"FluxDensity: total flux density in a region"),h.createElement("li",null,"Mean: average of pixel values in a region"),h.createElement("li",null,"StdDev: standard deviation of pixel values in a region"),h.createElement("li",null,"Min: minimum pixel value in a region"),h.createElement("li",null,"Max: maximum pixel value in a region"),h.createElement("li",null,"RMS: root mean square of pixel values in a region"),h.createElement("li",null,"SumSq: summation of squared pixel values in a region")),h.createElement("br",null),h.createElement("h4",{id:"tip"},"TIP"),h.createElement("p",null,"Multiple statistics widgets can be created to show statistics for different images and different regions."))}}var vo=i(485),Ao=i(486);class xo extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:vo,dark:Ao,width:"90%"})),h.createElement("p",null,"The Stokes analysis widget is specifically made for efficient visualization of a Stokes cube. The widget includes plots, such as:"),h.createElement("ul",null,h.createElement("li",null,"Region spectral profiles for Stokes Q and Stokes U, as absolute or fractional values"),h.createElement("li",null,"Polarized intensity spectral profile, as absolute or fractional values"),h.createElement("li",null,"Linearly polarized angle spectral profile"),h.createElement("li",null,"Stokes Q vs Stokes U scatter plot")),h.createElement("p",null,"All these plots are inter-linked so that when zooming profiles, data in the visible range will be highlighted in the scatter plot, and vice versa."),h.createElement("h3",{id:"images"},"Images"),h.createElement("p",null,'The image dropdown defaults to "Active" image which means the current image in the image viewer.'),h.createElement("h3",{id:"regions"},"Regions"),h.createElement("p",null,'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Stokes profile plot of the selected region will be updated accordingly. If no region is selected, "Active" region defaults to cursor.'),h.createElement("h3",{id:"responsive-and-progressive-profile-update"},"Responsive and progressive profile update"),h.createElement("p",null,"When region Stokes profiles are requested, depending on the performance of the server, users may see profiles are updated piece by piece in regular interval. This feature provides a visual progress update for better user experience. In addition, if users move a region while profiles are being updating, the old calculations will be terminated immediately and calculations of the new region Stokes profiles will start and users will see partial profiles in seconds."),h.createElement("h3",{id:"spectral-conventions-and-reference-frame"},"Spectral conventions and reference frame"),h.createElement("p",null,'With the "Conversion" tab of the Stokes analysis settings dialogue, users can change the spectral convention, including:'),h.createElement("ul",null,h.createElement("li",null,"Radio velocity (km/s, m/s)"),h.createElement("li",null,"Optical velocity (km/s, m/s)"),h.createElement("li",null,"Frequency (GHz, MHz, kHz, Hz)"),h.createElement("li",null,"Wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Air wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Channel")),h.createElement("p",null,"and spectral reference frame, including:"),h.createElement("ul",null,h.createElement("li",null,"LSRK: the rest-frame of the kinematical local standard of rest"),h.createElement("li",null,"LSRD: the rest-frame of the dynamical local standard of rest"),h.createElement("li",null,"BARY: barycentric, the rest-frame of the solar-system barycenter"),h.createElement("li",null,"TOPO: topocentric, the observer's rest-frame on Earth")),h.createElement("p",null,"Note that depending on the integrity of image headers, some conversions may not be possible."),h.createElement("h3",{id:"data-smoothing"},"Data smoothing"),h.createElement("p",null,'The displayed profiles and the scatter plot can be smoothed via the "Smoothing" tab of the Stokes analysis settings dialogue (the cog icon). A shortcut button of the "Smoothing" tab can be found at the top-right corner of the widget.'),h.createElement("h3",{id:"interactivity-zoom-pan-changing-channel"},"Interactivity: zoom, pan, changing channel"),h.createElement("p",null,"The x and y ranges of the Stokes profile plot can be modified by"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"scrolling wheel")," (up to zoom in and down to zoom out with respect to the cursor position)"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," horizontally to zoom in x"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," vertically to zoom in y"),h.createElement("li",null,h.createElement("code",null,"click-and-drag")," diagonally to zoom in both x and y"),h.createElement("li",null,h.createElement("code",null,"double-click")," to reset x and y ranges"),h.createElement("li",null,h.createElement("code",null,"shift + click-and-drag")," to pan in x")),h.createElement("p",null,"Users may click on the Stokes profile plot to switch to a channel (as indicated by a red vertical line) and view the image in the image viewer. The red line is draggable and acts equivalently like the channel slider in the animator widget."),h.createElement("h3",{id:"exports"},"Exports"),h.createElement("p",null,"The Stokes profile plots can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."),h.createElement("h3",{id:"plot-cosmetics"},"Plot cosmetics"),h.createElement("p",null,'The appearance of the Stokes profile plot is customizable via the "Line Plot Styling" tab of the Stokes analysis settings dialogue (the cog icon). Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"colors of Stokes Q and Stokes U profiles"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots")),h.createElement("p",null,'In addition, the appearance of the scatter plot can be customized with the "Scatter Plot Styling" tab too, including:'),h.createElement("ul",null,h.createElement("li",null,"Colormap"),h.createElement("li",null,"Symbol size"),h.createElement("li",null,"Symbol transparency"),h.createElement("li",null,"Q-to-U scale ratio as unity")))}}class Ro extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Conversion"),h.createElement("p",null,'With the "Conversion" tab, users can change the spectral convention, including:'),h.createElement("ul",null,h.createElement("li",null,"Radio velocity (km/s, m/s)"),h.createElement("li",null,"Optical velocity (km/s, m/s)"),h.createElement("li",null,"Frequency (GHz, MHz, kHz, Hz)"),h.createElement("li",null,"Wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Air wavelength (m, mm, um, Angstrom)"),h.createElement("li",null,"Channel")),h.createElement("p",null,"and spectral reference frame, including:"),h.createElement("ul",null,h.createElement("li",null,"LSRK: the rest-frame of the kinematical local standard of rest"),h.createElement("li",null,"LSRD: the rest-frame of the dynamical local standard of rest"),h.createElement("li",null,"BARY: barycentric, the rest-frame of the solar-system barycenter"),h.createElement("li",null,"TOPO: topocentric, the observer's rest-frame on Earth")),h.createElement("p",null,"Note that depending on the integrity of image headers, some conversions may not be possible."))}}class Po extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Line Plot Styling"),h.createElement("p",null,'The appearance of the spectral profile plot is customizable via the "Line Plot Styling" tab. Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"color of the plot"),h.createElement("li",null,"plot styles including steps (default), lines, and dots"),h.createElement("li",null,"line width for steps or lines"),h.createElement("li",null,"point size for dots")))}}class jo extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Scatter Plot Styling"),h.createElement("p",null,'The appearance of the scatter plot is customizable via the "Scatter Plot Styling" tab. Supported options are:'),h.createElement("ul",null,h.createElement("li",null,"Colormap"),h.createElement("li",null,"Symbol size"),h.createElement("li",null,"Symbol transparency"),h.createElement("li",null,"Q-to-U scale ratio as unity")))}}class ko extends h.Component{render(){return h.createElement("div",null,h.createElement("h3",null,"Smoothing"),h.createElement("p",null,"Smoothing may be applied to profiles and the scatter plot to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"),h.createElement("ul",null,h.createElement("li",null,h.createElement("b",null,"Boxcar"),": convolution with a boxcar function"),h.createElement("li",null,h.createElement("b",null,"Gaussian"),": convolution with a Gaussian function"),h.createElement("li",null,h.createElement("b",null,"Hanning"),": convolution with a Hanning function"),h.createElement("li",null,h.createElement("b",null,"Binning"),": averaging channels with a given width"),h.createElement("li",null,h.createElement("b",null,"Savitzky-Golay"),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares")),h.createElement("p",null,"Optionally, the original profile can be overplotted with the smoothed profile. "),h.createElement("p",null,"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied. The tsv file of the scatter plot only contains the smoothed data if smoothing is applied."),h.createElement("h3",null,"Examples"),h.createElement("p",null,"Boxcar: Kernel = 2"),h.createElement("p",null,h.createElement(Kn,{light:io,dark:lo,width:"90%"})),h.createElement("p",null,"Gaussian: Sigma = 1"),h.createElement("p",null,h.createElement(Kn,{light:no,dark:co,width:"90%"})),h.createElement("p",null,"Hanning: Kernel = 5"),h.createElement("p",null,h.createElement(Kn,{light:ro,dark:uo,width:"90%"})),h.createElement("p",null,"Binning: Binning width = 3"),h.createElement("p",null,h.createElement(Kn,{light:oo,dark:po,width:"90%"})),h.createElement("p",null,"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"),h.createElement("p",null,h.createElement(Kn,{light:ao,dark:ho,width:"90%"})))}}class Fo extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:jr,dark:kr,width:"90%"})),h.createElement("p",null,'Source catalogue files in the VOTable or FITS format can be loaded in CARTA (via "File"-> "Import catalog") for visualization as an image overlay, or a 2D scatter plot, or a histogram.'),h.createElement("p",null,"Once a source catalogue file is loaded, the information of each column will be shown in the upper table, while the actual catalogue entries are displayed in the lower table. By default, only the first 10 columns are enabled and displayed. Users may configure it to show or hide certain columns to be displayed in the lower table."),h.createElement("p",null,'Depending on the rendering type defined (via a dropdown) in the top bar, the "Represent As" column allows users to set which columns are used for visualization. If the rendering type is "Image overlay", the content of the dropdown of the "Represent As" column is determined by the "System" dropdown. Users need to tell CARTA which coordinate system the source catalogue file refers to. Source catalogue defined in image coordinate (0-based or 1-based) is also supported. Two numeric columns are required to render the source catalogue as an "Image overlay". If the rendering type is "Histogram", one numeric column is required. If the rendering type is "2D scatter", two numeric columns are needed.'),h.createElement("p",null,"The source catalogue table accepts sub-filters such as partial string match or value range. For numeric columns, supported operators are:"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,">")," greater than"),h.createElement("li",null,h.createElement("code",null,">=")," greater than or equal to"),h.createElement("li",null,h.createElement("code",null,"<")," less than"),h.createElement("li",null,h.createElement("code",null,"<=")," less than or equal to"),h.createElement("li",null,h.createElement("code",null,"==")," equal to"),h.createElement("li",null,h.createElement("code",null,"!=")," not equal to"),h.createElement("li",null,h.createElement("code",null,"..")," between (exclusive)"),h.createElement("li",null,h.createElement("code",null,"...")," between (inclusive)")),h.createElement("p",null,"Examples:"),h.createElement("ul",null,h.createElement("li",null,h.createElement("code",null,"< 10")," (everything less than 10)"),h.createElement("li",null,h.createElement("code",null,"== 1.23")," (entries equal to 1.23)"),h.createElement("li",null,h.createElement("code",null,"10..50")," (everything between 10 and 50, exclusive)"),h.createElement("li",null,h.createElement("code",null,"10...50")," (everything between 10 and 50, inclusive)")),h.createElement("p",null,"For string columns, partial match is adopted. For example, ",h.createElement("code",null,"gal"),' (no quotation) will return entries containing the "gal" string.'),h.createElement("p",null,'Once filters are set, by clicking the "Update" the filters will be applied and a filtered source catalogue will be displayed up to a number of entries defined in the "Max Rows" text input field. When the "Reset" button is clicked, all filters will be removed and the image overlay (if exists) will be removed too. For the histogram plot or the 2D scatter plot, the plot will be reset so that only the first 50 entries are rendered.'),h.createElement("p",null,"The source catalogue table, the image overlay, the 2D scatter plot, and the histogram plot are inter-linked or cross-referenced. This means, for example, selecting a source or a set of source in the catalogue table will trigger source highlight in other places. Or, selecting a source or a set of sources in the 2D scatter plot will trigger source highlight in other plots and in the catalogue table."),h.createElement("p",null,'Multiple catalogue files can be loaded and users may use the "File" dropdown at the top of the widget to switch in between. Multiple catalogue widgets may be launched to display different catalogue files. The "Close" button at the bottom of the widget will close the selected catalogue file in the "File" dropdown.'))}}class Mo extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,'The Catalog histogram plot widget shows a histogram of one numeric column of a catalog file. The available numeric columns are determined by the "Display" column of the upper table in the Catalog widget.'),h.createElement("p",null,'The data used for plotting the histogram is determined by the lower table in the Catalog widget. The table may not show all entries due to the dynamic loading feature. Thus, the histogram plot may not include all entries (after filtering). The "Plot All" button will request a full download of all entries and the histogram plot will then include all entries (after filtering). The number of bins and the scale of the y-axis can be customized.'),h.createElement("p",null,'By clicking on a certain histogram bin, source entries of that bin will be highlighted in the source catalog table, in the 2D scatter plot (if exists), and in the image viewer (if the catalog overlay is enabled). A certain histogram bin will be highlighted if source entries of that bin are selected in the source catalog table, in the 2D scatter plot (if exists), and in the image viewer (if the catalog overlay is enabled). The "Show only selected sources" toggle will update the source catalog table to show only the selected sources.'))}}class Do extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,'The Catalog 2D scatter plot widget shows a 2D scatter plot of two numeric columns of a catalog file. The available numeric columns are determined by the "Display" column of the upper table in the Catalog widget.'),h.createElement("p",null,'The data used for plotting the 2D scatter is determined by the lower table in the Catalog widget. The table may not show all entries due to the dynamic loading feature. Thus, the histogram plot may not include all entries (after filtering). The "Plot All" button will request a full download of all entries and the histogram plot will then include all entries (after filtering).'),h.createElement("p",null,'By clicking on a point or using the selection tools from the top-right corner of the plot, selected sources will be highlighted in the source catalog table, in the histogram plot (if exists), and in the image viewer (if the catalog overlay is enabled). Points on the plot will be highlighted if sources are selected in the source catalog table, in the histogram plot (if exists), and in the image viewer (if the catalog overlay is enabled). The "Show only selected sources" toggle will update the source catalog table to show only the selected sources.'))}}var No,Lo=i(487),_o=i(488);class zo extends h.Component{render(){return h.createElement("div",null,h.createElement("p",null,h.createElement(Kn,{light:Lo,dark:_o,width:"90%"})),h.createElement("p",null,"CARTA supports an initial implementation of spectral line ID overlay on a spectral profiler widget with a query to the Splatalogue service (https://splatalogue.online). The query is made by defining a spectral range in frequency or wavelength and optionally a lower limit of CDMS/JPL line intensity (log). The spectral range can be defined as from-to or a center with a width."),h.createElement("h4",null,"QUERY LIMITATION"),h.createElement("ul",null,h.createElement("li",null,"The allowed maximum query range, equivalent in frequency, is 20 GHz."),h.createElement("li",null,"The actual query is made with a frequency range in MHz rounded to integer."),h.createElement("li",null,"When an intensity limit is applied, only the lines from CDMS and JPL catalogues will be returned."),h.createElement("li",null,"Up to 100000 lines are displayed.")),h.createElement("h4",null,"IMPORTANT NOTE"),h.createElement("p",null,"Currently, the Splatalogue query service is under active development. Unexpected query results might happen. When users believe there is something wrong, please contact the ",h.createElement("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw"},"helpdesk")," or file an issue on ",h.createElement("a",{href:"https://github.com/CARTAvis/carta/issues"},"Github")," (recommended)."),h.createElement("br",null),h.createElement("p",null,"Once a query is successfully made, the line catalogue will be displayed in the tables. The upper table shows the column information in the catalogue with options to show or hide a specific column. The actual line catalogue is displayed in the lower table."),h.createElement("p",null,'The "Shifted Frequency" column is computed based on the user input of a velocity or a redshift. This "Shifted Frequency" is adopted for line ID overlay on a spectral profiler widget.'),h.createElement("p",null,"Users can use the checkbox to select a set of lines to be overplotted on a spectral profiler widget. The maximum number of line ID overlay is 1000."),h.createElement("p",null,"The sorting and filtering functions in the line table will be available in a future release."),h.createElement("p",null,'The text labels of the line ID overlay are shown dynamically based on the zoom level of a profile. Different line ID overlays (with different velocity shifts) can be created on different spectral profilers widgets via the "Spectral Profiler" dropdown. By clicking the "Clear" button, the line ID overlay on the selected "Spectral Profiler" will be removed.'))}}let Wo=Object(g.a)(No=class extends h.Component{constructor(...e){super(...e),this.HELP_MAP=new Map([[O.x.CONTOUR,{title:"Contour Configuration",content:h.createElement($n,null)}],[O.x.FILE_Browser,{title:"File Browser",content:h.createElement(Jn,null)}],[O.x.FILE_INFO,{title:"File Header",content:h.createElement(ir,null)}],[O.x.SAVE_LAYOUT,{title:"Save Layout",content:h.createElement(nr,null)}],[O.x.PREFERENCES,{title:"Preferences",content:h.createElement(ar,null)}],[O.x.REGION_DIALOG,{title:"Region Dialog",content:h.createElement(sr,null)}],[O.x.ANIMATOR,{title:"Animator",content:h.createElement(ur,null)}],[O.x.HISTOGRAM,{title:"Histogram",content:h.createElement(hr,null)}],[O.x.HISTOGRAM_SETTINGS,{title:"Histogram Settings",content:h.createElement(gr,null)}],[O.x.IMAGE_VIEW,{title:"Image View",content:h.createElement(Fr,null)}],[O.x.IMAGE_VIEW_SETTINGS,{title:"Image View Settings",content:h.createElement(Nr,null)}],[O.x.LAYER_LIST,{title:"Image List",content:h.createElement(zr,null)}],[O.x.LOG,{title:"Log",content:h.createElement(Vr,null)}],[O.x.PLACEHOLDER,{title:"Placeholder",content:h.createElement(qr,null)}],[O.x.REGION_LIST,{title:"Region List",content:h.createElement(Yr,null)}],[O.x.RENDER_CONFIG,{title:"Render Configuration",content:h.createElement(Qr,null)}],[O.x.RENDER_CONFIG_SETTINGS,{title:"Render Configuration Settings",content:h.createElement(Zr,null)}],[O.x.SPATIAL_PROFILER,{title:"Spatial Profiler",content:h.createElement(eo,null)}],[O.x.SPATIAL_PROFILER_SETTINGS_STYLING,{title:"Spatial Profiler Settings",content:h.createElement(to,null)}],[O.x.SPATIAL_PROFILER_SETTINGS_SMOOTHING,{title:"Spatial Profiler Settings",content:h.createElement(mo,null)}],[O.x.SPECTRAL_PROFILER,{title:"Spectral Profiler",content:h.createElement(bo,null)}],[O.x.SPECTRAL_PROFILER_SETTINGS_CONVERSION,{title:"Spectral Profiler Settings",content:h.createElement(Oo,null)}],[O.x.SPECTRAL_PROFILER_SETTINGS_STYLING,{title:"Spectral Profiler Settings",content:h.createElement(So,null)}],[O.x.SPECTRAL_PROFILER_SETTINGS_SMOOTHING,{title:"Spectral Profiler Settings",content:h.createElement(Co,null)}],[O.x.SPECTRAL_PROFILER_SETTINGS_MOMENTS,{title:"Spectral Profiler Settings",content:h.createElement(Eo,null)}],[O.x.STATS,{title:"Statistics",content:h.createElement(To,null)}],[O.x.STOKES_ANALYSIS,{title:"Stokes Analysis",content:h.createElement(xo,null)}],[O.x.STOKES_ANALYSIS_SETTINGS_CONVERSION,{title:"Stokes Settings",content:h.createElement(Ro,null)}],[O.x.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING,{title:"Stokes Settings",content:h.createElement(Po,null)}],[O.x.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING,{title:"Stokes Settings",content:h.createElement(jo,null)}],[O.x.STOKES_ANALYSIS_SETTINGS_SMOOTHING,{title:"Stokes Settings",content:h.createElement(ko,null)}],[O.x.CATALOG_OVERLAY,{title:"Catalog Overlay",content:h.createElement(Fo,null)}],[O.x.CATALOG_HISTOGRAM_PLOT,{title:"Catalog Histogram Plot",content:h.createElement(Mo,null)}],[O.x.CATALOG_SCATTER_PLOT,{title:"Catalog Scatter Plot",content:h.createElement(Do,null)}],[O.x.CATALOG_SETTINGS_GOLBAL,{title:"Catalog Settings",content:""}],[O.x.CATALOG_SETTINGS_OVERLAY,{title:"Catalog Settings",content:""}],[O.x.CATALOG_SETTINGS_COLOR,{title:"Catalog Settings",content:""}],[O.x.SPECTRAL_LINE_QUERY,{title:"Spectral Line Query",content:h.createElement(zo,null)}]])}render(){let e="help-drawer";O.e.Instance.darkTheme&&(e+=" bp3-dark");const t=O.w.Instance,i={icon:"help",className:e,lazy:!0,isOpen:t.helpVisible,onClose:t.hideHelpDrawer,title:this.HELP_MAP.get(t.type)?this.HELP_MAP.get(t.type).title:"",position:t.position,size:"33%",hasBackdrop:!1};return h.createElement(f.n,i,h.createElement("div",{className:bi.a.DRAWER_BODY},h.createElement("div",{className:bi.a.DIALOG_BODY},this.HELP_MAP.get(t.type)?this.HELP_MAP.get(t.type).content:"")))}})||No;var Go,Vo,Bo,qo,Ho,Uo,Yo,Xo,Ko,Qo,Zo;i(1007);let $o=Object(g.a)((Zo=Qo=class e extends h.Component{static get WIDGET_CONFIG(){return{id:"catalog-plot",type:"catalog-plot",minWidth:320,minHeight:400,defaultWidth:600,defaultHeight:350,title:"Catalog Plot",isCloseable:!0,componentId:"catalog-plot-component"}}constructor(t){super(t),Object(p.a)(this,"width",Bo,this),Object(p.a)(this,"height",qo,this),Object(p.a)(this,"profileId",Ho,this),Object(p.a)(this,"catalogFileId",Uo,this),Object(p.a)(this,"componentId",Yo,this),this.plotType=void 0,this.histogramY=void 0,this.catalogFileNames=void 0,Object(p.a)(this,"onResize",Xo,this),Object(p.a)(this,"handleCatalogFileChange",Ko,this),this.addNewWidgetStore=()=>{const t=O.e.Instance,i=O.k.Instance;switch(this.plotType){case Qe.c.D2Scatter:const n={xColumnName:e.emptyColumn,yColumnName:e.emptyColumn,plotType:this.plotType},r=t.widgetsStore.addCatalogPlotWidget(n);return i.setCatalogPlots(this.componentId,this.catalogFileId,r),r;case Qe.c.Histogram:const o={xColumnName:e.emptyColumn,plotType:this.plotType},a=t.widgetsStore.addCatalogPlotWidget(o);return i.setCatalogPlots(this.componentId,this.catalogFileId,a),a;default:return}},this.handleColumnNameChange=(t,i)=>{const n=this.widgetStore;if("x"===t?n.setColumnX(i):"y"===t&&n.setColumnY(i),n.plotType===Qe.c.D2Scatter){if(n.xColumnName===e.emptyColumn||n.yColumnName===e.emptyColumn)return;n.setScatterborder(this.initScatterBorder)}else if(n.plotType===Qe.c.Histogram){if(i===e.emptyColumn)return;n.setHistogramXBorder(this.initHistogramXBorder)}},this.handleShowSelectedDataChanged=e=>{const t=this.widgetStore,i=this.catalogWidgetStore,n=e.target.checked;t&&i&&(i.setShowSelectedData(n),O.k.Instance.updateShowSelectedData(this.catalogFileId,n))},this.handleLogScaleYChanged=e=>{const t=e.target.checked;this.widgetStore.setLogScaleY(t)},this.onHover=e=>{const t=this.widgetStore,i=e.points;if(i.length&&t){const e=i[0];t.setIndicator({x:e.x,y:e.y})}},this.onDoubleClick=()=>{const e=this.widgetStore;e.plotType===Qe.c.D2Scatter?e.setScatterborder(this.initScatterBorder):e.setHistogramXBorder(this.initHistogramXBorder)},this.onRelayout=e=>{const t=this.widgetStore;if(t){if(e.dragmode&&t.setDragmode(e.dragmode),t.plotType===Qe.c.D2Scatter){const i=e["xaxis.range[0]"],n=e["xaxis.range[1]"],r=e["yaxis.range[0]"],o=e["yaxis.range[1]"];if(isFinite(i)||isFinite(r)){const e={xMin:isFinite(i)?i:t.scatterborder.xMin,xMax:isFinite(n)?n:t.scatterborder.xMax,yMin:isFinite(r)?r:t.scatterborder.yMin,yMax:isFinite(o)?o:t.scatterborder.yMax};t.setScatterborder(e)}e["xaxis.autorange"]&&e["yaxis.autorange"]&&t.setScatterborder(this.initScatterBorder)}if(t.plotType===Qe.c.Histogram){const i=e["xaxis.range[0]"],n=e["xaxis.range[1]"];if(isFinite(i)||isFinite(n)){const e={xMin:isFinite(i)?i:t.histogramBorder.xMin,xMax:isFinite(n)?n:t.histogramBorder.xMax};this.widgetStore.setHistogramXBorder(e)}e["xaxis.autorange"]&&t.setHistogramXBorder(this.initHistogramXBorder)}}},this.handlePlotClick=()=>{const e=O.e.Instance,t=this.profileStore;if(null===t||void 0===t?void 0:t.shouldUpdateData){t.setUpdateMode(O.m.PlotsUpdate),t.setUpdatingDataStream(!0);let i=t.updateRequestDataSize;e.sendCatalogFilter(i)}},this.onLassoSelected=e=>{if(e&&e.points&&e.points.length>0){var t;const i=O.k.Instance,n=this.profileStore,r=n.catalogInfo.fileId,o=this.catalogWidgetStore;let a;if(i.updateCatalogProfiles(r),this.widgetStore.plotType===Qe.c.D2Scatter){const t=e.points;a=Array(t.length);for(let e=0;e<t.length;e++)a[e]=t[e].pointIndex}else if(this.widgetStore.plotType===Qe.c.Histogram){const t=e.points;let i=0;for(let e=0;e<t.length;e++){i+=t[e].pointIndices.length}a=Array(i);for(let e=0;e<t.length;e++){const i=t[e].pointIndices,n=i.length;for(let t=0;t<n;t++)a[e*n+t]=i[t]}}(null===(t=a)||void 0===t?void 0:t.length)&&(n.setSelectedPointIndices(a,!0),o.setCatalogTableAutoScroll(!0))}},this.onDeselect=()=>{const e=O.k.Instance,t=this.profileStore,i=this.catalogWidgetStore;e.updateCatalogProfiles(this.catalogFileId),t.setSelectedPointIndices([],!1),i.setCatalogTableAutoScroll(!1),i.setShowSelectedData(!1),e.updateShowSelectedData(this.catalogFileId,!1)},this.onSingleSourceClick=e=>{var t;const i=["select","lasso"].includes(this.widgetStore.dragmode),n=this.profileStore,r=this.catalogWidgetStore;if((null===e||void 0===e||null===(t=e.points)||void 0===t?void 0:t.length)>0&&i){const t=O.k.Instance,i=n.catalogInfo.fileId;t.updateCatalogProfiles(i);let o=[];const a=e.points[0];this.widgetStore.plotType===Qe.c.D2Scatter?o.push(a.pointIndex):this.widgetStore.plotType===Qe.c.Histogram&&a.pointIndices.length&&(o=a.pointIndices),n.setSelectedPointIndices(o,!0),r.setCatalogTableAutoScroll(!0)}},this.renderColumnNamePopOver=(e,t)=>h.createElement(f.B,{key:e,text:e,onClick:t.handleClick,active:t.modifiers.active}),this.filterColumn=(e,t)=>new yn.a([t]).search(e).length>0,this.updateHistogramYrange=(e,t)=>{if(this.widgetStore.plotType===Qe.c.Histogram){const t=e.layout.yaxis.range;this.histogramY={yMin:t[0],yMax:t[1]}}},this.onNumBinChange=e=>{this.widgetStore.setNumBinsX(e),this.onDeselect()},this.renderFilePopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return h.createElement(f.B,{key:e,text:i,onClick:t.handleClick,active:t.modifiers.active})},Object(m.p)(this),this.histogramY={yMin:void 0,yMax:void 0};const i=O.k.Instance.getAssociatedIdByWidgetId(this.props.id);this.componentId=i.catalogPlotComponentId,this.catalogFileId=i.catalogFileId,this.catalogFileNames=new Map,Object(m.h)(()=>{const e=this.profileStore,t=this.widgetStore,i=O.k.Instance.activeCatalogFiles;if(!(null===i||void 0===i?void 0:i.includes(this.catalogFileId))&&(null===i||void 0===i?void 0:i.length)>0&&(this.catalogFileId=i[0]),t&&(this.plotType=t.plotType),e){let t="";const n=e.catalogInfo.fileInfo.name||"",r=O.e.Instance.activeFrame,o=e.progress;o&&isFinite(o)&&o<1&&(t=`[${Object(M.kb)(100*o)}% complete]`),r&&(null===i||void 0===i?void 0:i.length)?O.U.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType} : ${n} ${t}`):O.U.Instance.setWidgetTitle(this.props.id,"Catalog "+this.plotType)}else O.U.Instance.setWidgetTitle(this.props.id,"Catalog "+this.plotType)})}get widgetStore(){const e=O.k.Instance.catalogPlots.get(this.componentId);if(!e)return;let t=e.get(this.catalogFileId);t||(t=this.addNewWidgetStore());return O.U.Instance.catalogPlotWidgets.get(t)}get profileStore(){return O.k.Instance.catalogProfileStores.get(this.catalogFileId)}get catalogWidgetStore(){const e=O.k.Instance.catalogWidgets.get(this.catalogFileId);return O.U.Instance.catalogWidgets.get(e)}getScatterBorder(e,t){const i=Object(M.S)(e),n=Object(M.S)(t);return{xMin:i.minVal,xMax:i.maxVal,yMin:n.minVal,yMax:n.maxVal}}getHistogramXBorder(e){const t=Object(M.S)(e);return{xMin:t.minVal,xMax:t.maxVal}}get initScatterBorder(){const e=this.widgetStore,t=this.profileStore,i=t.get2DPlotData(e.xColumnName,e.yColumnName,t.catalogData);return this.getScatterBorder(i.wcsX,i.wcsY)}get initHistogramXBorder(){const e=this.widgetStore,t=this.profileStore.get1DPlotData(e.xColumnName);return this.getHistogramXBorder(t.wcsData)}get scatterData(){var e,t;const i=this.widgetStore,n=this.profileStore,r=n.get2DPlotData(i.xColumnName,i.yColumnName,n.catalogData);let o=[],a={type:"scattergl",mode:"markers"};a.marker={symbol:"circle",color:ae.a.BLUE2,opacity:1},a.hoverinfo="none",a.x=null===(e=r.wcsX)||void 0===e?void 0:e.slice(0),a.y=null===(t=r.wcsY)||void 0===t?void 0:t.slice(0),o.push(a);return{data:o,border:this.getScatterBorder(r.wcsX,r.wcsY)}}get histogramData(){var e;const t=this.widgetStore,i=this.profileStore.get1DPlotData(t.xColumnName);let n=[],r={};const o=this.getHistogramXBorder(i.wcsData),a=o.xMin,s=t.nBinx?t.nBinx:this.numBinsX,l=a+1.001*(o.xMax-o.xMin),c=(l-a)/s;return r.type="histogram",r.hoverinfo="none",r.x=null===(e=i.wcsData)||void 0===e?void 0:e.slice(0),r.marker={color:ae.a.BLUE2},r.xbins={start:a,size:c,end:l},n.push(r),{data:n,border:o}}get enablePlotButton(){const t=e.emptyColumn,i=this.profileStore,n=this.widgetStore;return(null===n||void 0===n?void 0:n.plotType)===Qe.c.Histogram?n.xColumnName!==t&&!i.loadingData&&!i.updatingDataStream:(null===n||void 0===n?void 0:n.plotType)===Qe.c.D2Scatter&&(n.xColumnName!==t&&n.yColumnName!==t&&!i.loadingData&&!i.updatingDataStream)}get genProfilerInfo(){let e=[];const t=this.widgetStore,i=t.indicatorInfo;return i&&(t.plotType===Qe.c.D2Scatter?e.push(`${t.xColumnName}: ${i.x}, ${t.yColumnName}: ${i.y}`):t.plotType===Qe.c.Histogram&&e.push(`${t.xColumnName}: ${i.x}, Count: ${i.y}`)),e}get numBinsX(){var e;const t=this.widgetStore,i=this.profileStore.get1DPlotData(t.xColumnName);return Math.ceil(Math.sqrt(null===(e=i.wcsData)||void 0===e?void 0:e.length))}render(){const t=this.profileStore,i=this.widgetStore,n=this.catalogWidgetStore,r=O.k.Instance.activeCatalogFiles,o=1/devicePixelRatio;if(!i||!t||!n||void 0===r||0===(null===r||void 0===r?void 0:r.length))return h.createElement("div",{className:"catalog-plot"},h.createElement(f.C,{icon:"folder-open",title:"No catalog file loaded",description:"Load a catalog file using the menu"}),";");const a=t.displayedColumnHeaders,s=[e.emptyColumn],l=!this.enablePlotButton,c=this.plotType===Qe.c.D2Scatter,u=this.plotType===Qe.c.Histogram,p=c?devicePixelRatio:1,d="'Helvetica Neue', 'Helvetica', 'Arial', sans-serif";let g=ae.a.LIGHT_GRAY5,m=ae.a.GRAY1,y=ae.a.LIGHT_GRAY1,C=ae.a.GRAY2,E="catalog-plotly",I=[];r.forEach(e=>{I.push(e)}),this.catalogFileNames=O.k.Instance.getCatalogFileNames(r);for(let h=0;h<a.length;h++){const t=a[h];e.UnsupportedDataTypes.includes(t.dataType)||s.push(t.name)}const w=h.createElement(f.B,{disabled:!0,text:"No results"}),T=h.createElement(f.p,{inline:!0,label:"File"},h.createElement(k.a,{className:"bp3-fill",filterable:!1,items:I,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFilePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END}},h.createElement(f.e,{text:this.catalogFileId,rightIcon:"double-caret-vertical"}))),v=h.createElement(f.p,{inline:!0,label:"X"},h.createElement(k.a,{className:"bp3-fill",items:s,activeItem:i.xColumnName,onItemSelect:e=>this.handleColumnNameChange("x",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END},filterable:!0,noResults:w,itemPredicate:this.filterColumn,resetOnSelect:!0},h.createElement(f.e,{text:i.xColumnName,rightIcon:"double-caret-vertical"}))),A=h.createElement(f.p,{label:"Log Scale",inline:!0,disabled:l},h.createElement(f.P,{checked:i.logScaleY,onChange:this.handleLogScaleYChanged,disabled:l})),x=h.createElement(f.p,{inline:!0,label:"Y"},h.createElement(k.a,{className:"bp3-fill",items:s,activeItem:i.yColumnName,onItemSelect:e=>this.handleColumnNameChange("y",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END},filterable:!0,noResults:w,itemPredicate:this.filterColumn,resetOnSelect:!0},h.createElement(f.e,{text:i.yColumnName,rightIcon:"double-caret-vertical"})));if(i.xColumnName===e.emptyColumn||i.yColumnName===e.emptyColumn)return h.createElement("div",{className:"catalog-plot"},h.createElement("div",{className:"catalog-plot-option"},T,v,c&&x),h.createElement(f.C,{className:"non-ideal-state",icon:"folder-open",title:"No column selected",description:"Please select columns"}),";");O.e.Instance.darkTheme&&(y=ae.a.DARK_GRAY5,m=ae.a.LIGHT_GRAY5,g=ae.a.DARK_GRAY3,C=ae.a.GRAY4,E="catalog-plotly-dark");let R,P={width:this.width*p,height:(this.height-85)*p,paper_bgcolor:g,plot_bgcolor:g,hovermode:"closest",xaxis:{title:i.xColumnName,titlefont:{family:d,size:12*p,color:m},showticklabels:!0,tickfont:{family:d,size:12*p,color:m},tickcolor:y,gridcolor:y,zerolinecolor:y,zerolinewidth:2*p,mirror:!0,linecolor:y,showline:!0,spikemode:"across",spikedash:"solid",spikecolor:C,spikethickness:1*p,tickformat:".2e"},yaxis:{titlefont:{family:d,size:12*p,color:m},showticklabels:!0,tickfont:{family:d,size:12*p,color:m},tickcolor:y,gridcolor:y,zerolinecolor:y,zerolinewidth:2*p,mirror:!0,linecolor:y,showline:!0,spikemode:"across",spikedash:"solid",spikecolor:C,spikethickness:1*p},margin:{t:5*p,b:40*p,l:80*p,r:5*p,pad:0},showlegend:!1,dragmode:i.dragmode};if(i.plotType===Qe.c.D2Scatter){let e;R=this.scatterData.data,R[0].marker.size=5*p,e=i.isScatterAutoScaled?this.scatterData.border:i.scatterborder,P.xaxis.range=[e.xMin,e.xMax],P.yaxis.range=[e.yMin,e.yMax],P.yaxis.title=i.yColumnName,P.yaxis.tickformat=".2e",P.hoverdistance=5}else{var j,F;let e;R=this.histogramData.data,e=i.isHistogramAutoScaledX?this.histogramData.border:i.histogramBorder,P.xaxis.range=[e.xMin,e.xMax],P.yaxis.range=[null===(j=this.histogramY)||void 0===j?void 0:j.yMin,null===(F=this.histogramY)||void 0===F?void 0:F.yMax],P.yaxis.fixedrange=!0,P.yaxis.autorange=!0,P.yaxis.rangemode="tozero",P.yaxis.title="Count",i.logScaleY&&(P.yaxis.type="log")}const M=t.selectedPointIndices;let D=R[0].marker;M.length>0?(R[0].selectedpoints=M,R[0].selected={marker:{color:ae.a.RED2}},R[0].unselected={marker:{opacity:.5}}):(R[0].selectedpoints=[],D.color=ae.a.BLUE2,R[0].unselected={marker:{opacity:1}});const N=h.createElement(S.b,{className:"catalog-bins",label:"Bins",min:1,integerOnly:!0,value:i.nBinx?i.nBinx:this.numBinsX,onValueChanged:e=>this.onNumBinChange(e),onValueCleared:()=>this.onNumBinChange(this.numBinsX),displayExponential:!1,updateValueOnKeyDown:!0,disabled:l});return h.createElement("div",{className:"catalog-plot"},h.createElement("div",{className:"catalog-plot-option"},T,v,u&&N,u&&A,c&&x),h.createElement("div",{className:`${E} ${c&&devicePixelRatio>1?"catalog-scatter":""}`},h.createElement(Ke.a,{data:R,layout:P,config:{displaylogo:!1,scrollZoom:!0,showTips:!1,doubleClick:!1,showAxisDragHandles:!1,modeBarButtonsToRemove:["zoomIn2d","zoomOut2d","resetScale2d","toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]},onHover:this.onHover,onDoubleClick:this.onDoubleClick,onRelayout:this.onRelayout,onSelected:this.onLassoSelected,onDeselect:this.onDeselect,onClick:this.onSingleSourceClick,onInitialized:this.updateHistogramYrange,onUpdate:this.updateHistogramYrange,style:{transform:c?`scale(${o})`:"scale(1)",transformOrigin:"top left"}})),h.createElement("div",{className:"catalog-plot-footer"},h.createElement("div",{className:"scatter-info"},h.createElement(S.l,{info:this.genProfilerInfo})),h.createElement("div",{className:"actions"},h.createElement(f.p,{label:"Show only selected sources",inline:!0,disabled:l},h.createElement(f.P,{checked:n.showSelectedData,onChange:this.handleShowSelectedDataChanged,disabled:l})),h.createElement(f.W,{className:"plot-button",content:"Update plots with data"},h.createElement(f.b,{intent:yi.a.PRIMARY,text:"Plot All",onClick:this.handlePlotClick,disabled:l})))),h.createElement(b.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}))}},Qo.emptyColumn="None",Qo.UnsupportedDataTypes=[ie.a.ColumnType.String,ie.a.ColumnType.Bool,ie.a.ColumnType.UnsupportedType],Vo=Zo,Bo=Object(d.a)(Vo.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qo=Object(d.a)(Vo.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=Object(d.a)(Vo.prototype,"profileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uo=Object(d.a)(Vo.prototype,"catalogFileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Object(d.a)(Vo.prototype,"componentId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xo=Object(d.a)(Vo.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Object(d.a)(Vo.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"widgetStore"),Vo.prototype),Object(d.a)(Vo.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"profileStore"),Vo.prototype),Object(d.a)(Vo.prototype,"catalogWidgetStore",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"catalogWidgetStore"),Vo.prototype),Ko=Object(d.a)(Vo.prototype,"handleCatalogFileChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogFileId=e;const t=O.U.Instance,i=O.k.Instance,n=i.catalogPlots.get(this.componentId).get(e);if(n){const e=t.catalogPlotWidgets.get(n),r=i.catalogProfileStores.get(this.catalogFileId),o=e.xColumnName===$o.emptyColumn,a=e.yColumnName===$o.emptyColumn;switch(e.plotType){case Qe.c.D2Scatter:if(!o&&!a&&void 0===e.scatterborder){const t=r.get2DPlotData(e.xColumnName,e.yColumnName,r.catalogData),i=this.getScatterBorder(t.wcsX,t.wcsY);e.setScatterborder(i)}break;case Qe.c.Histogram:if(!o&&void 0===e.histogramBorder){const t=r.get1DPlotData(e.xColumnName),i=this.getHistogramXBorder(t.wcsData);e.setHistogramXBorder(i)}}}else this.addNewWidgetStore()}}}),Object(d.a)(Vo.prototype,"initScatterBorder",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"initScatterBorder"),Vo.prototype),Object(d.a)(Vo.prototype,"initHistogramXBorder",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"initHistogramXBorder"),Vo.prototype),Object(d.a)(Vo.prototype,"scatterData",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"scatterData"),Vo.prototype),Object(d.a)(Vo.prototype,"histogramData",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"histogramData"),Vo.prototype),Object(d.a)(Vo.prototype,"enablePlotButton",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"enablePlotButton"),Vo.prototype),Object(d.a)(Vo.prototype,"genProfilerInfo",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"genProfilerInfo"),Vo.prototype),Object(d.a)(Vo.prototype,"numBinsX",[m.i],Object.getOwnPropertyDescriptor(Vo.prototype,"numBinsX"),Vo.prototype),Go=Vo))||Go;var Jo,ea,ta;i(1008);const ia=(e,t,i,n=2,r=16)=>{let o=t;return i||(o="none"),h.createElement("span",{className:"bp3-icon"},h.createElement("svg",{"data-icon":"triangle-up-open",width:"16",height:"16",viewBox:`0 0 ${r} ${r}`,style:{stroke:t,fill:o,strokeWidth:n}},e))},na=h.createElement("path",{d:"M 2 14 L 14 14 L 8 3 Z"}),ra=h.createElement("path",{d:"M 2 2 L 14 2 L 8 13 Z"}),oa=h.createElement("path",{d:"M 8 14 L 14 8 L 8 2 L 2 8 Z"}),aa=h.createElement("path",{d:"M 12.33 5.5 L 12.33 10.5 L 8 13 L 3.67 10.5 L 3.67 5.5 L 8 3 Z"}),sa=h.createElement("path",{d:"M 3 8 L 5.5 3.67 L 10.5 3.67 L 13 8 L 10.5 12.33 L 5.5 12.33 Z"});let la=Object(g.a)((ea=class extends h.Component{static get WIDGET_CONFIG(){return{id:"catalog-overlay-floating-settings",type:"floating-settings",minWidth:350,minHeight:225,defaultWidth:375,defaultHeight:375,title:"catalog-overlay-settings",isCloseable:!0,parentId:"catalog-overlay",parentType:"catalog-overlay",helpType:[O.x.CATALOG_SETTINGS_GOLBAL,O.x.CATALOG_SETTINGS_OVERLAY,O.x.CATALOG_SETTINGS_COLOR]}}get widgetStore(){const e=O.k.Instance.catalogWidgets.get(this.catalogFileId);return O.U.Instance.catalogWidgets.get(e)}get catalogFileId(){var e;return null===(e=O.k.Instance.catalogProfiles)||void 0===e?void 0:e.get(this.props.id)}constructor(e){super(e),this.catalogFileNames=void 0,Object(p.a)(this,"handleCatalogFileChange",ta,this),this.renderFileIdPopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return h.createElement(f.B,{key:e,text:i,onClick:t.handleClick,active:t.modifiers.active})},this.renderShapePopOver=(e,t)=>{const i=this.getCatalogShape(e);return h.createElement(f.B,{icon:i,key:e,onClick:t.handleClick,active:t.modifiers.active})},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))},this.getCatalogShape=e=>{let t=this.widgetStore.catalogColor;switch(e){case Qe.b.Circle:return h.createElement(f.w,{icon:"circle",color:t});case Qe.b.FullCircle:return h.createElement(f.w,{icon:"full-circle",color:t});case Qe.b.Star:return h.createElement(f.w,{icon:"star-empty",color:t});case Qe.b.FullStar:return h.createElement(f.w,{icon:"star",color:t});case Qe.b.Square:return h.createElement(f.w,{icon:"square",color:t});case Qe.b.Plus:return h.createElement(f.w,{icon:"plus",color:t});case Qe.b.Cross:return h.createElement(f.w,{icon:"cross",color:t});case Qe.b.TriangleUp:return ia(na,t,!1);case Qe.b.TriangleDown:return ia(ra,t,!1);case Qe.b.Diamond:return ia(oa,t,!1);case Qe.b.hexagon:return ia(aa,t,!1);case Qe.b.hexagon2:return ia(sa,t,!1);default:return h.createElement(f.w,{icon:"circle",color:t})}},Object(m.p)(this);const t=O.e.Instance;this.catalogFileNames=new Map,Object(m.h)(()=>{const e=O.k.Instance,i=e.catalogWidgets.get(this.catalogFileId),n=e.activeCatalogFiles;if(i||O.U.Instance.addCatalogWidget(this.catalogFileId),null===n||void 0===n?void 0:n.includes(this.catalogFileId)){const i=e.getCatalogFileNames([this.catalogFileId]).get(this.catalogFileId);i&&t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Catalog Settings: "+i)}else t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Catalog Settings")})}render(){const e=O.e.Instance,t=this.widgetStore,i=O.k.Instance.activeCatalogFiles;let n=[];i.forEach(e=>{n.push(e)}),this.catalogFileNames=O.k.Instance.getCatalogFileNames(i);const r=this.catalogFileNames.get(this.catalogFileId);let o="";void 0!==r&&(o=`${this.catalogFileId}: ${r}`);const a=i.length<=0,s=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{inline:!0,label:"Displayed columns"},h.createElement(S.n,{placeholder:"Default Displayed Columns",min:1,value:O.H.Instance.catalogDisplayedColumnSize,stepSize:1,onValueChange:e=>O.H.Instance.setPreference(O.G.CATALOG_DISPLAYED_COLUMN_SIZE,e)}))),l=h.createElement("div",{className:"panel-container"},h.createElement(f.p,{className:"file-menu",inline:!0,label:"File",disabled:a},h.createElement(k.a,{className:"bp3-fill",disabled:a,filterable:!1,items:n,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFileIdPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END}},h.createElement(f.e,{text:o,rightIcon:"double-caret-vertical",disabled:a}))),h.createElement(f.p,{label:"Color",inline:!0,disabled:a},h.createElement(S.c,{color:t.catalogColor,presetColors:[...M.e,"transparent"],setColor:e=>{t.setCatalogColor("transparent"===e.hex?"#000000":e.hex)},disableAlpha:!0,darkTheme:e.darkTheme,disabled:a})),h.createElement(f.p,{label:"Overlay Highlight",inline:!0,disabled:a},h.createElement(S.c,{color:t.highlightColor,presetColors:[...M.e,"transparent"],setColor:e=>{t.setHighlightColor("transparent"===e.hex?"#000000":e.hex)},disableAlpha:!0,darkTheme:e.darkTheme,disabled:a})),h.createElement(f.p,{inline:!0,label:"Shape",disabled:a},h.createElement(k.a,{className:"bp3-fill",disabled:a,filterable:!1,items:Object.values(Qe.b),activeItem:t.catalogShape,onItemSelect:e=>t.setCatalogShape(e),itemRenderer:this.renderShapePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:f.H.AUTO_END}},h.createElement(f.e,{icon:this.getCatalogShape(t.catalogShape),rightIcon:"double-caret-vertical",disabled:a}))),h.createElement(f.p,{inline:!0,label:"Size",labelInfo:"(px)",disabled:a},h.createElement(S.n,{placeholder:"Catalog Size",disabled:a,min:Qe.f.MinOverlaySize,max:Qe.f.MaxOverlaySize,value:t.catalogSize,stepSize:1,onValueChange:e=>t.setCatalogSize(e)})));let c="catalog-settings";return e.darkTheme&&(c+=" bp3-dark"),h.createElement("div",{className:c},h.createElement(f.R,{id:"catalogSettings",vertical:!1,selectedTabId:t.settingsTabId,onChange:e=>this.handleSelectedTabChanged(e)},h.createElement(f.Q,{id:Qe.e.GLOBAL,title:"Global",panel:s}),h.createElement(f.Q,{id:Qe.e.IMAGE_OVERLAY,title:"Image Overlay",panel:l,disabled:a})))}},Object(d.a)(ea.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(ea.prototype,"widgetStore"),ea.prototype),Object(d.a)(ea.prototype,"catalogFileId",[m.i],Object.getOwnPropertyDescriptor(ea.prototype,"catalogFileId"),ea.prototype),ta=Object(d.a)(ea.prototype,"handleCatalogFileChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{O.k.Instance.catalogProfiles.set(this.props.id,e)}}}),Jo=ea))||Jo},133:function(e,t,i){e.exports=i.p+"static/media/smoothing_boxcar.72848bf8.png"},134:function(e,t,i){e.exports=i.p+"static/media/smoothing_gaussian.3582f38f.png"},135:function(e,t,i){e.exports=i.p+"static/media/smoothing_hanning.d302ca27.png"},136:function(e,t,i){e.exports=i.p+"static/media/smoothing_binning.a81d6e4b.png"},137:function(e,t,i){e.exports=i.p+"static/media/smoothing_SG.211665a8.png"},138:function(e,t,i){e.exports=i.p+"static/media/smoothing_boxcar_d.fd868049.png"},139:function(e,t,i){e.exports=i.p+"static/media/smoothing_gaussian_d.1c43664b.png"},140:function(e,t,i){e.exports=i.p+"static/media/smoothing_hanning_d.571c4d11.png"},141:function(e,t,i){e.exports=i.p+"static/media/smoothing_binning_d.01a8b3c8.png"},142:function(e,t,i){e.exports=i.p+"static/media/smoothing_SG_d.76926cfc.png"},160:function(e,t,i){"use strict";i.d(t,"b",(function(){return je})),i.d(t,"a",(function(){return Fe}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S,C,E,I,w,T,v,A,x,R,P,j,k,F,M,D,N,L,_,z,W,G,V,B,q,H,U,Y,X,K,Q,Z,$,J,ee,te,ie,ne,re,oe,ae,se,le,ce,ue,pe,de,he,ge,me,fe,ye,be,Oe=i(3),Se=i(2),Ce=(i(29),i(1)),Ee=i(76),Ie=i(5),we=i(7),Te=i(64),ve=i(6),Ae=i(43),xe=i.n(Ae),Re=i(127),Pe=i(13);let je;!function(e){e.CurrentZ="z",e.TotalIntensity="Iz",e.LinearPolarizationQ="Qz",e.LinearPolarizationU="Uz",e.CircularPolarization="Vz",e.PolarizedIntensity="PIz",e.PolarizationAngle="PAz",e.PolarizationQU="QvsU"}(je||(je={}));const ke={fractionalPolVisible:!1,scatterOutRangePointsZIndex:[],primaryLineColor:{colorHex:Ee.a.BLUE2,fixed:!1},secondaryLineColor:{colorHex:Ee.a.ORANGE2,fixed:!1},lineWidth:1,linePlotPointSize:1.5,scatterPlotPointSize:3,equalAxes:!0,colorMap:"jet",pointTransparency:1};let Fe=(be=ye=class e extends Te.c{static requiredCoordinate(t){let i=e.requestDataType,n=i.indexOf(je.TotalIntensity);return t.fractionalPolVisible&&n<0&&i.push(je.TotalIntensity),i}static addToRequirementsMap(t,i){return i.forEach(i=>{const n=i.effectiveFrame;if(n&&n.hasStokes){const r=n.frameInfo.fileId,o=i.effectiveRegionId,a=e.requiredCoordinate(i);let s=i.statsType;if(!n.regionSet)return;const l=n.regionSet.regions.find(e=>e.regionId===o);if(l){l.regionType===Ie.a.RegionType.POINT&&(s=Ie.a.StatsType.Sum);let e=t.get(r);e||(e=new Map,t.set(r,e));let i=e.get(o);i||(i=new Ie.a.SetSpectralRequirements({regionId:o,fileId:r}),e.set(o,i)),i.spectralProfiles||(i.spectralProfiles=[]),a.forEach(e=>{let t=i.spectralProfiles.find(t=>t.coordinate===e);t?-1===t.statsTypes.indexOf(s)&&t.statsTypes.push(s):i.spectralProfiles.push({coordinate:e,statsTypes:[s]})})}}}),t}constructor(){super(Te.d.CLOSED_AND_POINT),Object(Oe.a)(this,"sharedMinX",r,this),Object(Oe.a)(this,"sharedMaxX",o,this),Object(Oe.a)(this,"quMinY",a,this),Object(Oe.a)(this,"quMaxY",s,this),Object(Oe.a)(this,"polIntensityMinY",l,this),Object(Oe.a)(this,"polIntensityMaxY",c,this),Object(Oe.a)(this,"polAngleMinY",u,this),Object(Oe.a)(this,"polAngleMaxY",p,this),Object(Oe.a)(this,"quScatterMinX",d,this),Object(Oe.a)(this,"quScatterMaxX",h,this),Object(Oe.a)(this,"quScatterMinY",g,this),Object(Oe.a)(this,"quScatterMaxY",m,this),Object(Oe.a)(this,"linePlotcursorX",f,this),Object(Oe.a)(this,"channel",y,this),Object(Oe.a)(this,"scatterPlotCursorX",b,this),Object(Oe.a)(this,"scatterPlotCursorY",O,this),Object(Oe.a)(this,"isMouseMoveIntoScatterPlots",S,this),Object(Oe.a)(this,"isMouseMoveIntoLinePlots",C,this),Object(Oe.a)(this,"scatterChartArea",E,this),Object(Oe.a)(this,"statsType",I,this),Object(Oe.a)(this,"fractionalPolVisible",w,this),this.scatterOutRangePointsZIndex=void 0,Object(Oe.a)(this,"plotType",T,this),Object(Oe.a)(this,"primaryLineColor",v,this),Object(Oe.a)(this,"secondaryLineColor",A,this),Object(Oe.a)(this,"lineWidth",x,this),Object(Oe.a)(this,"linePlotPointSize",R,this),Object(Oe.a)(this,"scatterPlotPointSize",P,this),Object(Oe.a)(this,"equalAxes",j,this),Object(Oe.a)(this,"colorMap",k,this),Object(Oe.a)(this,"colorPixel",F,this),Object(Oe.a)(this,"pointTransparency",M,this),this.smoothingStore=void 0,Object(Oe.a)(this,"settingsTabId",D,this),Object(Oe.a)(this,"setScatterChartAres",N,this),Object(Oe.a)(this,"setMouseMoveIntoScatterPlots",L,this),Object(Oe.a)(this,"setMouseMoveIntoLinePlots",_,this),Object(Oe.a)(this,"setStatsType",z,this),Object(Oe.a)(this,"setSpectralCoordinate",W,this),Object(Oe.a)(this,"setSpectralSystem",G,this),Object(Oe.a)(this,"setSharedXBounds",V,this),Object(Oe.a)(this,"clearSharedXBounds",B,this),Object(Oe.a)(this,"setPolIntensityYBounds",q,this),Object(Oe.a)(this,"clearPolIntensityYBounds",H,this),Object(Oe.a)(this,"setChannel",U,this),Object(Oe.a)(this,"setlinePlotCursorX",Y,this),Object(Oe.a)(this,"setScatterPlotCursor",X,this),Object(Oe.a)(this,"setFractionalPolVisible",K,this),Object(Oe.a)(this,"setRegionId",Q,this),Object(Oe.a)(this,"setQUScatterPlotXBounds",Z,this),Object(Oe.a)(this,"setPolAngleYBounds",$,this),Object(Oe.a)(this,"setQULinePlotYBounds",J,this),Object(Oe.a)(this,"setQUScatterPlotYBounds",ee,this),Object(Oe.a)(this,"clearLinePlotsXYBounds",te,this),Object(Oe.a)(this,"clearScatterPlotXYBounds",ie,this),Object(Oe.a)(this,"setQULinePlotsXYBounds",ne,this),Object(Oe.a)(this,"setPolIntensityXYBounds",re,this),Object(Oe.a)(this,"setPolAngleXYBounds",oe,this),Object(Oe.a)(this,"setQUScatterPlotXYBounds",ae,this),Object(Oe.a)(this,"setPlotType",se,this),Object(Oe.a)(this,"setPrimaryLineColor",le,this),Object(Oe.a)(this,"setSecondaryLineColor",ce,this),Object(Oe.a)(this,"setLineWidth",ue,this),Object(Oe.a)(this,"setLinePlotPointSize",pe,this),Object(Oe.a)(this,"setScatterPlotPointSize",de,this),Object(Oe.a)(this,"setEqualAxesValue",he,this),Object(Oe.a)(this,"setColormap",ge,this),Object(Oe.a)(this,"setPointTransparency",me,this),Object(Oe.a)(this,"setSettingsTabId",fe,this),this.init=e=>{if(!e)return;const t=xe()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString());const i=xe()(e.secondaryLineColor);i.isValid()&&(this.secondaryLineColor.colorHex=i.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=we.i.MIN_WIDTH&&e.lineWidth<=we.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=we.i.MIN_POINT_SIZE&&e.linePlotPointSize<=we.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"string"!==typeof e.plotType||e.plotType!==we.j.STEPS&&e.plotType!==we.j.LINES&&e.plotType!==we.j.POINTS||(this.plotType=e.plotType),"string"===typeof e.colorMap&&(this.colorMap=e.colorMap),"number"===typeof e.scatterPlotPointSize&&e.scatterPlotPointSize>=we.r.MIN_POINT_SIZE&&e.scatterPlotPointSize<=we.r.MAX_POINT_SIZE&&(this.scatterPlotPointSize=e.scatterPlotPointSize),"number"===typeof e.pointTransparency&&e.pointTransparency>=we.r.MIN_TRANSPARENCY&&e.pointTransparency<=we.r.MAX_TRANSPARENCY&&(this.pointTransparency=e.pointTransparency),"boolean"===typeof e.equalAxes&&(this.equalAxes=e.equalAxes)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,secondaryLineColor:this.secondaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,plotType:this.plotType,colorMap:this.colorMap,scatterPlotPointSize:this.scatterPlotPointSize,pointTransparency:this.pointTransparency,equalAxes:this.equalAxes}),Object(Ce.p)(this),this.colorMap=ke.colorMap,this.colorPixel=Object(ve.z)(ke.colorMap),this.statsType=Ie.a.StatsType.Mean,this.plotType=we.j.STEPS,this.fractionalPolVisible=ke.fractionalPolVisible,this.scatterOutRangePointsZIndex=ke.scatterOutRangePointsZIndex,this.primaryLineColor=ke.primaryLineColor,this.secondaryLineColor=ke.secondaryLineColor,this.lineWidth=ke.lineWidth,this.linePlotPointSize=ke.linePlotPointSize,this.scatterPlotPointSize=ke.scatterPlotPointSize,this.equalAxes=ke.equalAxes,this.pointTransparency=ke.pointTransparency,this.smoothingStore=new Re.a,this.settingsTabId=Pe.G.CONVERSION}get isLinePlotsAutoScaledX(){return void 0===this.sharedMinX||void 0===this.sharedMaxX}get isQUScatterPlotAutoScaledX(){return void 0===this.quScatterMinX||void 0===this.quScatterMaxX}get isQUScatterPlotAutoScaledY(){return void 0===this.quScatterMinY||void 0===this.quScatterMaxY}get isQULinePlotAutoScaledY(){return void 0===this.quMinY||void 0===this.quMaxY}get isPolIntensityAutoScaledY(){return void 0===this.polIntensityMinY||void 0===this.polIntensityMaxY}get isPolAngleAutoScaledY(){return void 0===this.polAngleMinY||void 0===this.polAngleMaxY}},ye.requestDataType=[je.LinearPolarizationQ,je.LinearPolarizationU],ye.ValidStatsTypes=[Ie.a.StatsType.Mean],n=be,r=Object(Se.a)(n.prototype,"sharedMinX",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(Se.a)(n.prototype,"sharedMaxX",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(Se.a)(n.prototype,"quMinY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(Se.a)(n.prototype,"quMaxY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(Se.a)(n.prototype,"polIntensityMinY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(Se.a)(n.prototype,"polIntensityMaxY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(Se.a)(n.prototype,"polAngleMinY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(Se.a)(n.prototype,"polAngleMaxY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(Se.a)(n.prototype,"quScatterMinX",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(Se.a)(n.prototype,"quScatterMaxX",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(Se.a)(n.prototype,"quScatterMinY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(Se.a)(n.prototype,"quScatterMaxY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(Se.a)(n.prototype,"linePlotcursorX",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(Se.a)(n.prototype,"channel",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(Se.a)(n.prototype,"scatterPlotCursorX",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(Se.a)(n.prototype,"scatterPlotCursorY",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Object(Se.a)(n.prototype,"isMouseMoveIntoScatterPlots",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(Se.a)(n.prototype,"isMouseMoveIntoLinePlots",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(Se.a)(n.prototype,"scatterChartArea",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(Se.a)(n.prototype,"statsType",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Object(Se.a)(n.prototype,"fractionalPolVisible",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(Se.a)(n.prototype,"plotType",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Object(Se.a)(n.prototype,"primaryLineColor",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(Se.a)(n.prototype,"secondaryLineColor",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=Object(Se.a)(n.prototype,"lineWidth",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(Se.a)(n.prototype,"linePlotPointSize",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(Se.a)(n.prototype,"scatterPlotPointSize",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(Se.a)(n.prototype,"equalAxes",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(Se.a)(n.prototype,"colorMap",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(Se.a)(n.prototype,"colorPixel",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(Se.a)(n.prototype,"pointTransparency",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(Se.a)(n.prototype,"settingsTabId",[Ce.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(Se.a)(n.prototype,"setScatterChartAres",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scatterChartArea=e}}}),L=Object(Se.a)(n.prototype,"setMouseMoveIntoScatterPlots",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoScatterPlots=e}}}),_=Object(Se.a)(n.prototype,"setMouseMoveIntoLinePlots",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),z=Object(Se.a)(n.prototype,"setStatsType",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==Fe.ValidStatsTypes.indexOf(e)&&(this.statsType=e)}}}),W=Object(Se.a)(n.prototype,"setSpectralCoordinate",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;if(t&&t.spectralCoordsSupported&&t.spectralCoordsSupported.has(e)){const i=t.spectralCoordsSupported.get(e);t.spectralType=i.type,t.spectralUnit=i.unit,this.clearSharedXBounds()}}}}),G=Object(Se.a)(n.prototype,"setSpectralSystem",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;t&&t.spectralSystemsSupported&&t.spectralSystemsSupported.includes(e)&&(t.spectralSystem=e,this.clearSharedXBounds())}}}),V=Object(Se.a)(n.prototype,"setSharedXBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.sharedMinX=e,this.sharedMaxX=t}}}),B=Object(Se.a)(n.prototype,"clearSharedXBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sharedMinX=void 0,this.sharedMaxX=void 0}}}),q=Object(Se.a)(n.prototype,"setPolIntensityYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.polIntensityMinY=e,this.polIntensityMaxY=t}}}),H=Object(Se.a)(n.prototype,"clearPolIntensityYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.polIntensityMinY=void 0,this.polIntensityMaxY=void 0}}}),U=Object(Se.a)(n.prototype,"setChannel",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channel=e}}}),Y=Object(Se.a)(n.prototype,"setlinePlotCursorX",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.linePlotcursorX=e}}}),X=Object(Se.a)(n.prototype,"setScatterPlotCursor",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scatterPlotCursorX=e.x,this.scatterPlotCursorY=e.y}}}),K=Object(Se.a)(n.prototype,"setFractionalPolVisible",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fractionalPolVisible=e,this.clearScatterPlotXYBounds()}}}),Q=Object(Se.a)(n.prototype,"setRegionId",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.regionIdMap.set(e,t),this.clearLinePlotsXYBounds(),this.clearScatterPlotXYBounds()}}}),Z=Object(Se.a)(n.prototype,"setQUScatterPlotXBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quScatterMinX=e,this.quScatterMaxX=t}}}),$=Object(Se.a)(n.prototype,"setPolAngleYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.polAngleMinY=e,this.polAngleMaxY=t}}}),J=Object(Se.a)(n.prototype,"setQULinePlotYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quMinY=e,this.quMaxY=t}}}),ee=Object(Se.a)(n.prototype,"setQUScatterPlotYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quScatterMinY=e,this.quScatterMaxY=t}}}),te=Object(Se.a)(n.prototype,"clearLinePlotsXYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sharedMinX=void 0,this.sharedMaxX=void 0,this.quMinY=void 0,this.quMaxY=void 0,this.polIntensityMinY=void 0,this.polIntensityMaxY=void 0,this.polAngleMinY=void 0,this.polAngleMaxY=void 0}}}),ie=Object(Se.a)(n.prototype,"clearScatterPlotXYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.quScatterMinX=void 0,this.quScatterMaxX=void 0,this.quScatterMinY=void 0,this.quScatterMaxY=void 0,this.scatterOutRangePointsZIndex=[]}}}),ne=Object(Se.a)(n.prototype,"setQULinePlotsXYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.quMinY=i,this.quMaxY=n}}}),re=Object(Se.a)(n.prototype,"setPolIntensityXYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.polIntensityMinY=i,this.polIntensityMaxY=n}}}),oe=Object(Se.a)(n.prototype,"setPolAngleXYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.polAngleMinY=i,this.polAngleMaxY=n}}}),ae=Object(Se.a)(n.prototype,"setQUScatterPlotXYBounds",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.quScatterMinX=e,this.quScatterMaxX=t,this.quScatterMinY=i,this.quScatterMaxY=n}}}),se=Object(Se.a)(n.prototype,"setPlotType",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),le=Object(Se.a)(n.prototype,"setPrimaryLineColor",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),ce=Object(Se.a)(n.prototype,"setSecondaryLineColor",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.secondaryLineColor={colorHex:e,fixed:t}}}}),ue=Object(Se.a)(n.prototype,"setLineWidth",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.i.MIN_WIDTH&&e<=we.i.MAX_WIDTH&&(this.lineWidth=e)}}}),pe=Object(Se.a)(n.prototype,"setLinePlotPointSize",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.i.MIN_POINT_SIZE&&e<=we.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),de=Object(Se.a)(n.prototype,"setScatterPlotPointSize",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.r.MIN_POINT_SIZE&&e<=we.r.MAX_POINT_SIZE&&(this.scatterPlotPointSize=e)}}}),he=Object(Se.a)(n.prototype,"setEqualAxesValue",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.equalAxes=e}}}),ge=Object(Se.a)(n.prototype,"setColormap",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorMap=e,this.colorPixel=Object(ve.z)(e)}}}),me=Object(Se.a)(n.prototype,"setPointTransparency",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.r.MIN_TRANSPARENCY&&e<=we.r.MAX_TRANSPARENCY&&(this.pointTransparency=e)}}}),fe=Object(Se.a)(n.prototype,"setSettingsTabId",[Ce.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(Se.a)(n.prototype,"isLinePlotsAutoScaledX",[Ce.i],Object.getOwnPropertyDescriptor(n.prototype,"isLinePlotsAutoScaledX"),n.prototype),Object(Se.a)(n.prototype,"isQUScatterPlotAutoScaledX",[Ce.i],Object.getOwnPropertyDescriptor(n.prototype,"isQUScatterPlotAutoScaledX"),n.prototype),Object(Se.a)(n.prototype,"isQUScatterPlotAutoScaledY",[Ce.i],Object.getOwnPropertyDescriptor(n.prototype,"isQUScatterPlotAutoScaledY"),n.prototype),Object(Se.a)(n.prototype,"isQULinePlotAutoScaledY",[Ce.i],Object.getOwnPropertyDescriptor(n.prototype,"isQULinePlotAutoScaledY"),n.prototype),Object(Se.a)(n.prototype,"isPolIntensityAutoScaledY",[Ce.i],Object.getOwnPropertyDescriptor(n.prototype,"isPolIntensityAutoScaledY"),n.prototype),Object(Se.a)(n.prototype,"isPolAngleAutoScaledY",[Ce.i],Object.getOwnPropertyDescriptor(n.prototype,"isPolAngleAutoScaledY"),n.prototype),n)},161:function(e,t,i){"use strict";i.d(t,"a",(function(){return N})),i.d(t,"d",(function(){return L})),i.d(t,"c",(function(){return _})),i.d(t,"b",(function(){return z}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S,C,E,I,w,T,v,A,x=i(3),R=i(2),P=(i(29),i(1)),j=i(20),k=i(5),F=i(4),M=i(6);let D,N,L,_;!function(e){e.X="X",e.Y="Y",e.PlotSize="Size",e.PlotShape="Shape",e.NONE="None"}(D||(D={})),function(e){e.X="X",e.Y="Y",e.NONE="None",e.RA="RA",e.DEC="DEC",e.GLAT="GLAT",e.GLON="GLON",e.ELON="ELON",e.ELAT="ELAT",e.X0="X0",e.Y0="Y0",e.X1="X1",e.Y1="Y1"}(N||(N={})),function(e){e.TableUpdate="TableUpdate",e.ViewUpdate="ViewUpdate",e.PlotsUpdate="PlotsUpdate"}(L||(L={})),function(e){e.Ecliptic="ECLIPTIC",e.FK4="FK4",e.FK5="FK5",e.Galactic="GALACTIC",e.ICRS="ICRS",e.Pixel0="Pixel0",e.Pixel1="Pixel1"}(_||(_={}));let z=(n=P.g.bound,r=P.g.bound,A=v=class e{constructor(t,i,n){this.CoordinateSystemName=new Map([[_.FK5,"FK5"],[_.FK4,"FK4"],[_.Galactic,"GAL"],[_.Ecliptic,"ECL"],[_.ICRS,"ICRS"],[_.Pixel0,"PIX0"],[_.Pixel1,"PIX1"]]),this.systemCoordinateMap=new Map([[_.FK4,{x:N.RA,y:N.DEC}],[_.FK5,{x:N.RA,y:N.DEC}],[_.ICRS,{x:N.RA,y:N.DEC}],[_.Galactic,{x:N.GLON,y:N.GLAT}],[_.Ecliptic,{x:N.ELON,y:N.ELAT}],[_.Pixel0,{x:N.X0,y:N.Y0}],[_.Pixel1,{x:N.X1,y:N.Y1}]]),this.InitialedColumnsKeyWords=["ANGULAR DISTANCE","MAIN IDENTIFIER","RADIAL VELOCITY","REDSHIFT"],this.InitialedExcludeColumnsKeyWords=["PROPER MOTION","SIGMA"],this.InitialedRAColumnsKeyWords=["RIGHT ASCENSION","RA","R.A"],this.InitialedDECColumnsKeyWords=["DECLINATION","DEC","Dec."],Object(x.a)(this,"progress",a,this),Object(x.a)(this,"catalogInfo",s,this),Object(x.a)(this,"catalogControlHeader",l,this),Object(x.a)(this,"catalogHeader",c,this),Object(x.a)(this,"catalogData",u,this),Object(x.a)(this,"loadingData",p,this),Object(x.a)(this,"numVisibleRows",d,this),Object(x.a)(this,"subsetEndIndex",h,this),Object(x.a)(this,"updatingDataStream",g,this),Object(x.a)(this,"updateMode",m,this),Object(x.a)(this,"catalogFilterRequest",f,this),Object(x.a)(this,"catalogCoordinateSystem",y,this),Object(x.a)(this,"selectedPointIndices",b,this),Object(x.a)(this,"filterDataSize",O,this),Object(x.a)(this,"updateTableView",S,this),Object(x.a)(this,"sortingInfo",C,this),Object(x.a)(this,"maxRows",E,this),Object(x.a)(this,"setColumnFilter",I,this),Object(x.a)(this,"resetCatalogFilterRequest",w,this),Object(x.a)(this,"setSelectedPointIndices",T,this),Object(P.p)(this),this.catalogInfo=t,this.catalogHeader=i.sort((e,t)=>e.columnIndex-t.columnIndex),this.catalogData=n,this.catalogControlHeader=this.initCatalogControlHeader,this.loadingData=!1,this.catalogFilterRequest=this.initCatalogFilterRequest,this.updatingDataStream=!1,this.updateMode=L.TableUpdate,this.selectedPointIndices=[],this.filterDataSize=void 0,this.updateTableView=!1,this.sortingInfo={columnName:null,sortingType:null},this.maxRows=t.dataSize;const r=t.fileInfo.coosys[0];if(r){const e=this.getCatalogSystem(r.system);this.catalogCoordinateSystem={system:e,equinox:r.equinox,epoch:r.epoch,coordinate:this.systemCoordinateMap.get(_.ICRS)}}else this.catalogCoordinateSystem={system:_.ICRS,equinox:null,epoch:null,coordinate:this.systemCoordinateMap.get(_.ICRS)};const o=e.InitTableRows;t.dataSize<o?(this.numVisibleRows=t.dataSize,this.subsetEndIndex=t.dataSize):(this.numVisibleRows=o,this.subsetEndIndex=o)}setCatalogCoordinateSystem(e){const t=this.catalogCoordinateSystem;this.catalogCoordinateSystem={system:e,equinox:t.equinox,epoch:t.epoch,coordinate:this.systemCoordinateMap.get(e)}}get activedSystem(){return this.systemCoordinateMap.get(this.catalogCoordinateSystem.system)}setUserFilter(e){this.catalogFilterRequest=e}setProgress(e){this.progress=e}setCatalogHeader(e){this.catalogHeader=e}setUpdateMode(e){this.updateMode=e}setSortingInfo(e,t){this.sortingInfo={columnName:e,sortingType:t}}static FillAllocatedArray(e,t,i,n){const r=t.length;let o;if(e.length===n){o=e;for(let e=0;e<r;e++)o[e+i]=t[e]}else{o=new Array(n);for(let t=0;t<i;t++)o[t]=e[t];for(let e=0;e<r;e++)o[e+i]=t[e]}return o}updateCatalogData(t,i){let n=t.subsetDataSize;const r=t.subsetEndIndex,o=r-n,a=t.requestEndIndex;if(this.filterDataSize=t.filterDataSize,this.subsetEndIndex<=this.filterDataSize){let t=this.numVisibleRows+n;i.forEach((t,i)=>{let n=this.catalogData.get(i);if(n)if(n.dataType===k.a.ColumnType.String){const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,a)}else if(n.dataType===k.a.ColumnType.Bool){const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,a)}else{if(n.dataType===k.a.ColumnType.UnsupportedType)return;{const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,a)}}else this.catalogData.set(i,t)}),this.setNumVisibleRows(t),this.subsetEndIndex=r}}clearData(){this.catalogData.clear()}setHeaderDisplay(e,t){this.catalogControlHeader.get(t).display=e}setTableColumnWidth(e,t){this.catalogControlHeader.get(t).columnWidth=e}updateTableStatus(e){this.updateTableView=e}setNumVisibleRows(e){this.numVisibleRows=e}setSubsetEndIndex(e){this.subsetEndIndex=e}setLoadingDataStatus(e){this.loadingData=e}setUpdatingDataStream(e){this.updatingDataStream=e}resetFilterRequestControlParams(){this.setUpdateMode(L.TableUpdate),this.clearData(),this.setNumVisibleRows(0),this.setSubsetEndIndex(0),this.setLoadingDataStatus(!0)}get loadOntoImage(){return this.loadingData||this.updatingDataStream}get initCatalogControlHeader(){const e=new Map,t=this.catalogHeader;if(t.length)for(let i=0;i<t.length;i++){const n=t[i];let r=!1;i<F.H.Instance.catalogDisplayedColumnSize&&(r=!0);let o={columnIndex:n.columnIndex,dataIndex:i,display:r,filter:"",columnWidth:null};e.set(n.name,o)}return e}resetUserFilters(){this.catalogControlHeader.forEach((e,t)=>{e.filter=""}),this.filterDataSize=void 0}setMaxRows(e){this.updateTableStatus(!0),this.maxRows=e}get displayedColumnHeaders(){let e=[];return this.catalogControlHeader.forEach((t,i)=>{t.display&&this.catalogHeader&&e.push(this.catalogHeader[t.dataIndex])}),e}get tableColumnWidts(){const e=[];return this.catalogControlHeader.forEach((t,i)=>{t.display&&e.push(t.columnWidth)}),e}get initCatalogFilterRequest(){let t=new k.a.CatalogFilterRequest,i=new k.a.CatalogImageBounds,n=e.InitTableRows;return t.fileId=this.catalogInfo.fileId,t.filterConfigs=null,t.columnIndices=this.columnIndices,t.subsetStartIndex=0,t.imageBounds=i,t.regionId=null,t.sortColumn=null,t.sortingType=null,n>this.maxRows&&(n=this.maxRows),this.catalogInfo.dataSize<n?t.subsetDataSize=this.catalogInfo.dataSize:t.subsetDataSize=n,t}get updateRequestDataSize(){if(this.catalogFilterRequest.subsetStartIndex=this.subsetEndIndex,this.maxRows<=this.numVisibleRows)return this.catalogFilterRequest.subsetStartIndex=0,this.catalogFilterRequest.subsetDataSize=this.maxRows,this.catalogFilterRequest;const t=this.maxRows-this.numVisibleRows;if(this.updateMode===L.TableUpdate){let i=e.DataChunkSize;t<i&&t>0&&(i=t),this.catalogFilterRequest.subsetDataSize=i}else this.catalogFilterRequest.subsetDataSize=t;return this.catalogFilterRequest}get shouldUpdateData(){return isFinite(this.filterDataSize)?this.subsetEndIndex<this.filterDataSize&&this.subsetEndIndex<this.maxRows:this.subsetEndIndex<this.catalogInfo.dataSize&&this.subsetEndIndex<this.maxRows}get columnIndices(){let e=[];return this.catalogControlHeader.forEach((t,i)=>{t.display&&e.push(t.columnIndex)}),e}get hasFilter(){let e=[];return this.catalogControlHeader.forEach((t,i)=>{t.filter&&e.push(t)}),e.length>0}get selectedData(){let e=this.catalogData;const t=this.selectedPointIndices,i=this.displayedColumnHeaders.map(e=>e.columnIndex);if(t.length>0){const e=new Map;return this.catalogData.forEach((n,r)=>{i.includes(r)&&e.set(r,Object(M.r)(n,t))}),e}return e}get regionSelected(){return this.selectedPointIndices.length}get autoScrollRowNumber(){let e=j.c.row(0);return this.selectedPointIndices.length>0&&(e=j.c.row(this.selectedPointIndices[0])),e}get catalogFileId(){return this.catalogInfo.fileId}get2DPlotData(e,t,i){const n=this.catalogControlHeader,r=n.get(e),o=n.get(t),a=this.catalogHeader[r.dataIndex],s=this.catalogHeader[o.dataIndex],l=i.get(a.columnIndex),c=i.get(s.columnIndex);if(l&&l.dataType!==k.a.ColumnType.String&&l.dataType!==k.a.ColumnType.Bool&&c&&c.dataType!==k.a.ColumnType.String&&c.dataType!==k.a.ColumnType.Bool){return{wcsX:l.data,wcsY:c.data,xHeaderInfo:a,yHeaderInfo:s}}return{xHeaderInfo:a,yHeaderInfo:s}}get1DPlotData(e){const t=this.catalogControlHeader.get(e),i=this.catalogHeader[t.dataIndex],n=this.catalogData.get(i.columnIndex);if(n&&n.dataType!==k.a.ColumnType.String&&n.dataType!==k.a.ColumnType.Bool){return{wcsData:n.data,headerInfo:i}}return{headerInfo:i}}findKeywords(e){const t=this.InitialedColumnsKeyWords,i=this.InitialedRAColumnsKeyWords,n=this.InitialedDECColumnsKeyWords,r=this.InitialedExcludeColumnsKeyWords,o=e.toUpperCase();for(let a=0;a<t.length;a++){const e=t[a];if(o.includes(e))return!0}if(o.includes(r[0])||o.includes(r[1]))return!1;for(let a=0;a<i.length;a++){const e=i[a];if(o.includes(e))return!0}for(let a=0;a<n.length;a++){const e=n[a];if(o.includes(e))return!0}return!1}getCatalogSystem(e){let t=_.ICRS;return this.CoordinateSystemName.forEach((i,n)=>{e.toUpperCase().includes(i.toUpperCase())&&(t=n)}),t}isInfinite(t){return!isFinite(t)||t===e.NEGATIVE_INFINITY||t===e.POSITIVE_INFINITY}},v.InitTableRows=50,v.DataChunkSize=50,v.NEGATIVE_INFINITY=-17976931348623157e292,v.POSITIVE_INFINITY=17976931348623157e292,o=A,a=Object(R.a)(o.prototype,"progress",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(R.a)(o.prototype,"catalogInfo",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(R.a)(o.prototype,"catalogControlHeader",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(R.a)(o.prototype,"catalogHeader",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(R.a)(o.prototype,"catalogData",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(R.a)(o.prototype,"loadingData",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(R.a)(o.prototype,"numVisibleRows",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(R.a)(o.prototype,"subsetEndIndex",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(R.a)(o.prototype,"updatingDataStream",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(R.a)(o.prototype,"updateMode",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(R.a)(o.prototype,"catalogFilterRequest",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(R.a)(o.prototype,"catalogCoordinateSystem",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(R.a)(o.prototype,"selectedPointIndices",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(R.a)(o.prototype,"filterDataSize",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Object(R.a)(o.prototype,"updateTableView",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(R.a)(o.prototype,"sortingInfo",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(R.a)(o.prototype,"maxRows",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(R.a)(o.prototype,"setCatalogCoordinateSystem",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setCatalogCoordinateSystem"),o.prototype),Object(R.a)(o.prototype,"activedSystem",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"activedSystem"),o.prototype),Object(R.a)(o.prototype,"setUserFilter",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setUserFilter"),o.prototype),Object(R.a)(o.prototype,"setProgress",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setProgress"),o.prototype),Object(R.a)(o.prototype,"setCatalogHeader",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setCatalogHeader"),o.prototype),Object(R.a)(o.prototype,"setUpdateMode",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setUpdateMode"),o.prototype),Object(R.a)(o.prototype,"setSortingInfo",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setSortingInfo"),o.prototype),Object(R.a)(o.prototype,"updateCatalogData",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"updateCatalogData"),o.prototype),Object(R.a)(o.prototype,"clearData",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"clearData"),o.prototype),Object(R.a)(o.prototype,"setHeaderDisplay",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setHeaderDisplay"),o.prototype),Object(R.a)(o.prototype,"setTableColumnWidth",[n],Object.getOwnPropertyDescriptor(o.prototype,"setTableColumnWidth"),o.prototype),I=Object(R.a)(o.prototype,"setColumnFilter",[P.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=this.catalogControlHeader.get(t),n={columnIndex:i.columnIndex,dataIndex:i.dataIndex,display:i.display,filter:e,columnWidth:i.columnWidth};this.catalogControlHeader.set(t,n),this.updateTableStatus(!0)}}}),Object(R.a)(o.prototype,"updateTableStatus",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"updateTableStatus"),o.prototype),Object(R.a)(o.prototype,"setNumVisibleRows",[r],Object.getOwnPropertyDescriptor(o.prototype,"setNumVisibleRows"),o.prototype),Object(R.a)(o.prototype,"setSubsetEndIndex",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setSubsetEndIndex"),o.prototype),Object(R.a)(o.prototype,"setLoadingDataStatus",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setLoadingDataStatus"),o.prototype),Object(R.a)(o.prototype,"setUpdatingDataStream",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setUpdatingDataStream"),o.prototype),w=Object(R.a)(o.prototype,"resetCatalogFilterRequest",[P.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.resetFilterRequestControlParams(),this.resetUserFilters(),this.loadingData=!1,this.catalogFilterRequest=this.initCatalogFilterRequest,this.updatingDataStream=!1,this.sortingInfo.columnName=null,this.sortingInfo.sortingType=null,this.maxRows=this.catalogInfo.dataSize}}}),Object(R.a)(o.prototype,"resetFilterRequestControlParams",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"resetFilterRequestControlParams"),o.prototype),Object(R.a)(o.prototype,"loadOntoImage",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"loadOntoImage"),o.prototype),Object(R.a)(o.prototype,"initCatalogControlHeader",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"initCatalogControlHeader"),o.prototype),Object(R.a)(o.prototype,"resetUserFilters",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"resetUserFilters"),o.prototype),T=Object(R.a)(o.prototype,"setSelectedPointIndices",[P.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i;this.selectedPointIndices=e;const n=F.k.Instance.catalogData.get(this.catalogFileId);if(null===n||void 0===n||null===(i=n.xImageCoords)||void 0===i?void 0:i.length){let i=[],r=[],o=n.xImageCoords,a=n.yImageCoords;for(let t=0;t<e.length;t++){const n=e[t],s=o[n],l=a[n];this.isInfinite(s)||this.isInfinite(l)||(i.push(s),r.push(l))}if(F.k.Instance.updateSelectedPoints(this.catalogFileId,i,r),t){const e=i.length;if(1===e){const e=i[0],t=r[0];F.e.Instance.activeFrame.setCenter(e,t)}if(e>1){const e=Object(M.S)(i),t=Object(M.S)(r),n=e.maxVal-e.minVal,o=t.maxVal-t.minVal;F.e.Instance.activeFrame.setCenter(n/2+e.minVal,o/2+t.minVal);const a=Math.min(F.e.Instance.activeFrame.renderWidth/n,F.e.Instance.activeFrame.renderHeight/o);F.e.Instance.activeFrame.setZoom(a)}}}}}}),Object(R.a)(o.prototype,"setMaxRows",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setMaxRows"),o.prototype),Object(R.a)(o.prototype,"displayedColumnHeaders",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"displayedColumnHeaders"),o.prototype),Object(R.a)(o.prototype,"tableColumnWidts",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"tableColumnWidts"),o.prototype),Object(R.a)(o.prototype,"initCatalogFilterRequest",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"initCatalogFilterRequest"),o.prototype),Object(R.a)(o.prototype,"updateRequestDataSize",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"updateRequestDataSize"),o.prototype),Object(R.a)(o.prototype,"shouldUpdateData",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"shouldUpdateData"),o.prototype),Object(R.a)(o.prototype,"columnIndices",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"columnIndices"),o.prototype),Object(R.a)(o.prototype,"hasFilter",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"hasFilter"),o.prototype),Object(R.a)(o.prototype,"selectedData",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"selectedData"),o.prototype),Object(R.a)(o.prototype,"regionSelected",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"regionSelected"),o.prototype),Object(R.a)(o.prototype,"autoScrollRowNumber",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"autoScrollRowNumber"),o.prototype),Object(R.a)(o.prototype,"catalogFileId",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"catalogFileId"),o.prototype),o)},183:function(e,t,i){"use strict";i.d(t,"a",(function(){return E})),i.d(t,"b",(function(){return I}));var n=i(0),r=i(47),o=i(491),a=i(61),s=i(195),l=i.n(s),c=i(196),u=i.n(c),p=i(197),d=i.n(p),h=i(198),g=i.n(h),m=i(199),f=i.n(m),y=i(200),b=i.n(y);const O=new Map([[a.a.LINEAR,l.a],[a.a.LOG,u.a],[a.a.SQRT,d.a],[a.a.SQUARE,g.a],[a.a.GAMMA,f.a],[a.a.POWER,b.a]]),S=o.a.ofType(),C=Array.from(a.b.SCALING_TYPES.keys()),E={minimal:!0,position:"auto-end",popoverClassName:"colormap-select-popover"},I=e=>n.createElement(S,{activeItem:e.selectedItem,onItemSelect:e.onItemSelect,popoverProps:E,filterable:!1,items:C,itemRenderer:(e,{handleClick:t,modifiers:i,query:o})=>i.matchesPredicate&&a.b.SCALING_TYPES.has(e)?n.createElement(r.B,{active:i.active,disabled:i.disabled,label:a.b.SCALING_TYPES.get(e),key:e,onClick:t,text:n.createElement("div",{className:"equation-div",style:{backgroundImage:"url("+O.get(e)}})}):null},n.createElement(r.e,{text:a.b.SCALING_TYPES.get(e.selectedItem),rightIcon:"double-caret-vertical",alignText:"right"}))},184:function(e,t,i){"use strict";i.d(t,"a",(function(){return nt}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S,C,E,I,w,T,v,A,x,R,P,j,k,F,M,D,N,L,_,z,W,G,V,B,q,H,U,Y,X,K,Q,Z,$,J,ee,te,ie,ne,re,oe,ae,se,le,ce,ue,pe,de,he,ge,me,fe,ye,be,Oe,Se,Ce,Ee,Ie,we,Te,ve,Ae,xe,Re,Pe,je,ke,Fe,Me,De,Ne,Le=i(3),_e=i(2),ze=(i(29),i(36)),We=i(1),Ge=i(427),Ve=i(76),Be=i(8),qe=i(47),He=i(34),Ue=i(22),Ye=i(128),Xe=i(5),Ke=i(4),Qe=i(6),Ze=i(28),$e=i(10),Je=i(12),et=i(13),tt=i(7),it="2e1e55bf change import catalog shortcut to G (#1314)";let nt=(Ne=De=class e{static get Instance(){return e.staticInstance||new e}get estimatedTaskRemainingTime(){if(this.taskProgress<=0||this.taskProgress>=1)return;const e=this.taskCurrentTime-this.taskStartTime;return e/this.taskProgress-e}get modifierString(){return"linux"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET?"ctrl + ":"darwin"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET?"cmd +":"alt + "}get darkTheme(){return this.preferenceStore.theme===$e.Theme.AUTO?this.systemTheme===$e.Theme.DARK:this.preferenceStore.theme===$e.Theme.DARK}get activeFrameIndex(){return this.activeFrame?this.frames.findIndex(e=>e.frameInfo.fileId===this.activeFrame.frameInfo.fileId):-1}get frameNum(){return this.frames.length}get frameMap(){const e=new Map;for(const t of this.frames)e.set(t.frameInfo.fileId,t);return e}get catalogNum(){return this.catalogStore.catalogProfileStores.size}get frameNames(){let e=[];return this.frames.forEach((t,i)=>e.push({label:i+": "+t.filename,value:t.frameInfo.fileId})),e}get frameChannels(){return this.frames.map(e=>e.requiredChannel)}get frameStokes(){return this.frames.map(e=>e.requiredStokes)}get spatialGroup(){if(!this.frames||!this.frames.length||!this.activeFrame)return[];const e=[];for(const t of this.frames){(t===this.activeFrame||t===this.activeFrame.spatialReference||t.spatialReference===this.activeFrame||t.spatialReference&&t.spatialReference===this.activeFrame.spatialReference)&&e.push(t)}return e}get contourFrames(){return this.spatialGroup.filter(e=>e.contourConfig.enabled&&e.contourConfig.visible)}removeCatalog(t,i,n){if(t>-1&&this.backendService.closeCatalogFile(t)){const r=Ke.k.Instance;if(r.clearCatalogPlotsByFileId(t),this.catalogStore.catalogWidgets.delete(t),this.widgetsStore.catalogWidgets.delete(i),r.removeCatalog(t),r.catalogProfileStores.delete(t),!this.activeFrame)return;const o=r.activeCatalogFiles,a=e.Instance.activeFrame.frameInfo.fileId;let s=[];o&&(s=o.filter(e=>e!==t),r.updateImageAssociatedCatalogId(a,s)),n&&s.length&&r.catalogProfiles.forEach((e,i)=>{e===t&&r.catalogProfiles.set(i,s[0])})}}sendCatalogFilter(e){this.activeFrame&&this.backendService.setCatalogFilterRequest(e)}constructor(){this.backendService=void 0,this.tileService=void 0,this.scriptingService=void 0,this.apiService=void 0,this.alertStore=void 0,this.animatorStore=void 0,this.catalogStore=void 0,this.dialogStore=void 0,this.fileBrowserStore=void 0,this.helpStore=void 0,this.layoutStore=void 0,this.logStore=void 0,this.overlayStore=void 0,this.preferenceStore=void 0,this.widgetsStore=void 0,Object(Le.a)(this,"astReady",r,this),Object(Le.a)(this,"cartaComputeReady",o,this),Object(Le.a)(this,"frames",a,this),Object(Le.a)(this,"activeFrame",s,this),Object(Le.a)(this,"contourDataSource",l,this),Object(Le.a)(this,"syncContourToFrame",c,this),Object(Le.a)(this,"syncFrameToContour",u,this),Object(Le.a)(this,"spatialProfiles",p,this),Object(Le.a)(this,"spectralProfiles",d,this),Object(Le.a)(this,"regionStats",h,this),Object(Le.a)(this,"regionHistograms",g,this),Object(Le.a)(this,"spatialReference",m,this),Object(Le.a)(this,"spectralReference",f,this),Object(Le.a)(this,"rasterScalingReference",y,this),Object(Le.a)(this,"activeLayer",b,this),Object(Le.a)(this,"cursorFrozen",O,this),this.appContainer=void 0,this.fileCounter=0,this.previousConnectionStatus=void 0,this.getAppContainer=()=>this.appContainer,this.setAppContainer=e=>{this.appContainer=e},Object(Le.a)(this,"splashScreenVisible",S,this),Object(Le.a)(this,"showSplashScreen",C,this),Object(Le.a)(this,"hideSplashScreen",E,this),Object(Le.a)(this,"setImageViewDimensions",I,this),Object(Le.a)(this,"imageToolbarVisible",w,this),Object(Le.a)(this,"showImageToolbar",T,this),Object(Le.a)(this,"hideImageToolbar",v,this),Object(Le.a)(this,"username",A,this),Object(Le.a)(this,"setUsername",x,this),Object(Le.a)(this,"connectToServer",R,this),Object(Le.a)(this,"handleThemeChange",P,this),Object(Le.a)(this,"taskProgress",j,this),Object(Le.a)(this,"taskStartTime",k,this),Object(Le.a)(this,"taskCurrentTime",F,this),Object(Le.a)(this,"fileLoading",M,this),Object(Le.a)(this,"resumingSession",D,this),Object(Le.a)(this,"restartTaskProgress",N,this),Object(Le.a)(this,"updateTaskProgress",L,this),Object(Le.a)(this,"startFileLoading",_,this),Object(Le.a)(this,"endFileLoading",z,this),Object(Le.a)(this,"systemTheme",W,this),Object(Le.a)(this,"addFrame",G,this),Object(Le.a)(this,"loadFile",V,this),Object(Le.a)(this,"appendFile",B,this),Object(Le.a)(this,"openFile",q,this),Object(Le.a)(this,"saveFile",H,this),Object(Le.a)(this,"closeFile",U,this),Object(Le.a)(this,"closeCurrentFile",Y,this),Object(Le.a)(this,"closeOtherFiles",X,this),Object(Le.a)(this,"removeFrame",K,this),Object(Le.a)(this,"removeAllFrames",Q,this),Object(Le.a)(this,"shiftFrame",Z,this),Object(Le.a)(this,"nextFrame",$,this),Object(Le.a)(this,"prevFrame",J,this),Object(Le.a)(this,"appendCatalog",ee,this),Object(Le.a)(this,"reorderFrame",te,this),Object(Le.a)(this,"importRegion",ie,this),Object(Le.a)(this,"exportRegions",ne,this),Object(Le.a)(this,"requestCubeHistogram",re,this),Object(Le.a)(this,"cancelCubeHistogramRequest",oe,this),Object(Le.a)(this,"requestMoment",ae,this),Object(Le.a)(this,"cancelRequestingMoment",se,this),Object(Le.a)(this,"setDarkTheme",le,this),Object(Le.a)(this,"setLightTheme",ce,this),Object(Le.a)(this,"setAutoTheme",ue,this),Object(Le.a)(this,"toggleCursorFrozen",pe,this),Object(Le.a)(this,"updateActiveLayer",de,this),this.spectralRequirements=void 0,this.spatialRequirements=void 0,this.statsRequirements=void 0,this.histogramRequirements=void 0,this.pendingChannelHistograms=void 0,this.throttledSetChannels=ze.throttle(e=>{e&&e.length&&e.forEach(e=>{const t=e.frame;if(t)if(t.channel=e.channel,t.stokes=e.stokes,t===this.activeFrame){const e=t.requiredFrameView,i={xMin:Math.max(0,e.xMin),xMax:Math.min(t.frameInfo.fileInfoExtended.width,e.xMax),yMin:Math.max(0,e.yMin),yMax:Math.min(t.frameInfo.fileInfoExtended.height,e.yMax),mip:e.mip},n={x:t.frameInfo.fileInfoExtended.width,y:t.frameInfo.fileInfoExtended.height},r=Object(Qe.b)(i,n,{x:256,y:256}),o={x:(e.xMax+e.xMin)/2,y:(e.yMin+e.yMax)/2},a=256*e.mip,s={x:o.x/a-.5,y:o.y/a-.5};this.tileService.requestTiles(r,t.frameInfo.fileId,t.channel,t.stokes,s,this.preferenceStore.imageCompressionQuality,!0)}else this.tileService.updateInactiveFileChannel(t.frameInfo.fileId,t.channel,t.stokes)})},e.ImageChannelThrottleTime),this.throttledSetView=ze.throttle((e,t,i,n,r)=>{this.animatorStore.serverAnimationActive?this.backendService.addRequiredTiles(t,e.map(e=>e.encode()),this.preferenceStore.animationCompressionQuality):this.tileService.requestTiles(e,t,i,n,r,this.preferenceStore.imageCompressionQuality)},e.ImageChannelThrottleTime),Object(Le.a)(this,"handleSpatialProfileStream",he,this),this.handleSpectralProfileStream=e=>{if(this.frames.find(t=>t.frameInfo.fileId===e.fileId)){let t=this.spectralProfiles.get(e.fileId);t||(t=new We.b,this.spectralProfiles.set(e.fileId,t));let i=t.get(e.regionId);i||(i=new Ke.Q(e.fileId,e.regionId),t.set(e.regionId,i)),i.stokes=e.stokes;for(let n of e.profiles)i.setProfile($e.ProtobufProcessing.ProcessSpectralProfile(n,e.progress))}},this.handleRegionHistogramStream=e=>{if(!e)return;let t=this.regionHistograms.get(e.fileId);if(t||(t=new We.b,this.regionHistograms.set(e.fileId,t)),t.set(e.regionId,e),-1===e.regionId)e.histograms.forEach(t=>{const i=`${e.fileId}_${e.stokes}_${t.channel}`;this.pendingChannelHistograms.set(i,e)});else if(-2===e.regionId){const t=this.getFrame(e.fileId);if(t){const i=e.histograms[0];i&&(t.renderConfig.useCubeHistogram||t.renderConfig.useCubeHistogramContours)&&(t.renderConfig.updateCubeHistogram(i,e.progress),this.updateTaskProgress(e.progress))}}},Object(Le.a)(this,"handleTileStream",ge,this),this.handleRegionStatsStream=e=>{if(!e)return;let t=this.regionStats.get(e.fileId);t||(t=new We.b,this.regionStats.set(e.fileId,t)),t.set(e.regionId,e)},this.handleContourImageStream=e=>{const t=this.getFrame(e.fileId);t&&t.updateFromContourData(e)},Object(Le.a)(this,"handleCatalogFilterStream",me,this),this.handleMomentProgressStream=e=>{if(!e)return;const t=this.getFrame(e.fileId);t&&(t.updateRequestingMomentsProgress(e.progress),this.updateTaskProgress(e.progress))},this.handleErrorStream=e=>{if(e){const t={level:e.severity,message:e.message,tags:e.tags.concat(["server-sent"]),title:null};this.logStore.addLog(t)}},this.handleReconnectStream=()=>{this.alertStore.showInteractiveAlert("You have reconnected to the CARTA server. Do you want to resume your session?",this.onResumeAlertClosed)},this.handleScriptingRequest=e=>{this.scriptingService.handleScriptingRequest(e).then(this.backendService.sendScriptingResponse)},Object(Le.a)(this,"onResumeAlertClosed",fe,this),Object(Le.a)(this,"onSessionResumed",ye,this),Object(Le.a)(this,"setContourDataSource",be,this),Object(Le.a)(this,"toggleFrameContourLock",Oe,this),Object(Le.a)(this,"deleteSelectedRegion",Se,this),Object(Le.a)(this,"deleteRegion",Ce,this),this.setCursor=(e,t)=>{const i=this.getFrame(e);null===i||void 0===i||i.updateCursorRegion(t)},Object(Le.a)(this,"setSpatialReference",Ee,this),Object(Le.a)(this,"clearSpatialReference",Ie,this),Object(Le.a)(this,"setSpatialMatchingEnabled",we,this),Object(Le.a)(this,"toggleSpatialMatching",Te,this),Object(Le.a)(this,"setSpectralReference",ve,this),Object(Le.a)(this,"clearSpectralReference",Ae,this),Object(Le.a)(this,"setSpectralMatchingEnabled",xe,this),Object(Le.a)(this,"toggleSpectralMatching",Re,this),Object(Le.a)(this,"setRasterScalingReference",Pe,this),Object(Le.a)(this,"clearRasterScalingReference",je,this),Object(Le.a)(this,"setRasterScalingMatchingEnabled",ke,this),Object(Le.a)(this,"toggleRasterScalingMatching",Fe,this),Object(Le.a)(this,"setMatchingEnabled",Me,this),this.exportImage=()=>{if(this.activeFrame){const e=Object(et.J)(this.overlayStore.padding);if(e)return e.toBlob(e=>{const t=new Date,i=`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}-${t.getHours()}-${t.getMinutes()}-${t.getSeconds()}`,n=document.createElement("a");n.download=`${this.activeFrame.filename}-image-${i}.png`,n.href=URL.createObjectURL(e),n.dispatchEvent(new MouseEvent("click"))},"image/png"),!0}return!1},this.getImageDataUrl=e=>{if(this.activeFrame){const t=Object(et.J)(this.overlayStore.padding,e);if(t)return t.toDataURL()}return null},this.waitForImageData=async()=>(await this.delay(25),new Promise(e=>{Object(We.t)(()=>{const e=this.tileService.remainingTiles>0,t=this.activeFrame&&this.activeFrame.contourProgress>=0&&this.activeFrame.contourProgress<1;return!e&&!t},async()=>{await this.delay(25),e()})})),this.fetchParameter=e=>{if(e&&e instanceof Map){const t={},i=e;for(let[e,n]of i)t[e]=n;return t}return e},this.initRequirements=()=>{this.spectralRequirements=new Map,this.spatialRequirements=new Map,this.statsRequirements=new Map,this.histogramRequirements=new Map},this.recalculateRequirements=()=>{this.recalculateSpatialRequirements(),this.recalculateSpectralRequirements(),this.recalculateStatsRequirements(),this.recalculateHistogramRequirements()},Object(We.p)(this),e.staticInstance=this,this.backendService=Ze.b.Instance,this.tileService=Ze.h.Instance,this.scriptingService=Ze.f.Instance,this.apiService=Ze.a.Instance,this.alertStore=Ke.b.Instance,this.animatorStore=Ke.d.Instance,this.catalogStore=Ke.k.Instance,this.dialogStore=Ke.r.Instance,this.fileBrowserStore=Ke.s.Instance,this.helpStore=Ke.w.Instance,this.layoutStore=Ke.z.Instance,this.logStore=Ke.A.Instance,this.overlayStore=Ke.E.Instance,this.preferenceStore=Ke.H.Instance,this.widgetsStore=Ke.U.Instance,this.astReady=!1,this.cartaComputeReady=!1,this.spatialProfiles=new Map,this.spectralProfiles=new Map,this.regionStats=new Map,this.regionHistograms=new Map,this.pendingChannelHistograms=new Map,this.frames=[],this.activeFrame=null,this.contourDataSource=null,this.syncFrameToContour=!0,this.syncContourToFrame=!0,this.initRequirements(),this.activeLayer=et.l.RegionMoving,Ue.onReady.then(Object(We.r)(()=>{Ue.setPalette(this.darkTheme?Ke.W:Ke.V),this.astReady=!0,this.logStore.addInfo("AST library loaded",["ast"])})),Ye.onReady.then(Object(We.g)(()=>{this.cartaComputeReady=!0,this.logStore.addInfo("Compute module loaded",["compute"])})),this.logStore.addDebug("Current frontend version: "+it,["version"]),this.previousConnectionStatus=Ze.c.CLOSED,Object(We.h)(()=>{document.body.style.backgroundColor=this.darkTheme?Ve.a.DARK_GRAY4:Ve.a.WHITE;const e=this.darkTheme?Be.a.DARK:"";Object(qe.X)({className:e})});const t=window.matchMedia("(prefers-color-scheme: dark)");t&&(t.addEventListener?t.addEventListener("change",e=>this.handleThemeChange(e.matches)):t.addListener&&t.addListener(e=>handleThemeChange(e.matches))),this.handleThemeChange(t.matches),Object(We.h)(()=>{const e=this.backendService.connectionStatus,t=this.username?" as "+this.username:"";switch(e){case Ze.c.ACTIVE:this.backendService.connectionDropped?tt.a.show(Object(tt.z)(`Reconnected to server${t}. Some errors may occur`)):tt.a.show(Object(tt.v)("swap-vertical","Connected to CARTA server"+t));break;case Ze.c.CLOSED:this.previousConnectionStatus===Ze.c.ACTIVE&&tt.a.show(Object(tt.e)("Disconnected from server"))}this.previousConnectionStatus=e});const i=ze.throttle(this.setCursor,e.CursorThrottleTimeRotated),n=ze.throttle(this.setCursor,e.CursorThrottleTime),De=ze.throttle(this.setCursor,2*e.CursorThrottleTime);Object(We.h)(()=>{if(this.activeFrame&&(this.preferenceStore.streamContoursWhileZooming||!this.activeFrame.zooming)){this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout);const e=this.activeFrame.requiredFrameView;let t={xMin:Math.max(0,e.xMin),xMax:Math.min(this.activeFrame.frameInfo.fileInfoExtended.width,e.xMax),yMin:Math.max(0,e.yMin),yMax:Math.min(this.activeFrame.frameInfo.fileInfoExtended.height,e.yMax),mip:e.mip};const i={x:this.activeFrame.frameInfo.fileInfoExtended.width,y:this.activeFrame.frameInfo.fileInfoExtended.height},n=Object(Qe.b)(t,i,{x:256,y:256}),r={x:(e.xMax+e.xMin)/2,y:(e.yMin+e.yMax)/2},o=256*e.mip,a={x:r.x/o-.5,y:r.y/o-.5};this.throttledSetView(n,this.activeFrame.frameInfo.fileId,this.activeFrame.channel,this.activeFrame.stokes,a)}this.activeFrame||this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout)}),Object(We.h)(()=>{if(this.activeFrame){const e=[],t=this.activeFrame.requiredChannel!==this.activeFrame.channel||this.activeFrame.requiredStokes!==this.activeFrame.stokes;!this.animatorStore.animationActive&&t&&e.push({frame:this.activeFrame,channel:this.activeFrame.requiredChannel,stokes:this.activeFrame.requiredStokes}),this.activeFrame.spectralSiblings.forEach(t=>{(t.requiredChannel!==t.channel||t.requiredStokes!==t.stokes)&&e.push({frame:t,channel:t.requiredChannel,stokes:t.requiredStokes})}),e.length&&this.throttledSetChannels(e)}}),Object(We.h)(()=>{var e,t;if(null===(e=this.activeFrame)||void 0===e||null===(t=e.cursorInfo)||void 0===t?void 0:t.posImageSpace){const e={x:Math.round(this.activeFrame.cursorInfo.posImageSpace.x),y:Math.round(this.activeFrame.cursorInfo.posImageSpace.y)};e.x>=0&&e.x<=this.activeFrame.frameInfo.fileInfoExtended.width-1&&e.y>=0&&e.y<=this.activeFrame.frameInfo.fileInfoExtended.height-1&&(this.preferenceStore.lowBandwidthMode?De(this.activeFrame.frameInfo.fileId,e):this.activeFrame.frameInfo.fileFeatureFlags&Xe.a.FileFeatureFlags.ROTATED_DATASET?i(this.activeFrame.frameInfo.fileId,e):n(this.activeFrame.frameInfo.fileId,e))}}),Object(We.h)(()=>{this.activeFrame&&this.overlayStore.setDefaultsFromAST(this.activeFrame)}),Object(We.h)(()=>{Ue.setPalette(this.darkTheme?Ke.W:Ke.V)}),setInterval(this.recalculateRequirements,e.RequirementsCheckInterval),this.backendService.spatialProfileStream.subscribe(this.handleSpatialProfileStream),this.backendService.spectralProfileStream.subscribe(this.handleSpectralProfileStream),this.backendService.histogramStream.subscribe(this.handleRegionHistogramStream),this.backendService.contourStream.subscribe(this.handleContourImageStream),this.backendService.catalogStream.subscribe(this.handleCatalogFilterStream),this.backendService.errorStream.subscribe(this.handleErrorStream),this.backendService.statsStream.subscribe(this.handleRegionStatsStream),this.backendService.momentProgressStream.subscribe(this.handleMomentProgressStream),this.backendService.reconnectStream.subscribe(this.handleReconnectStream),this.backendService.scriptingStream.subscribe(this.handleScriptingRequest),this.tileService.tileStream.subscribe(this.handleTileStream),Object(We.h)(()=>{this.astReady&&this.zfpReady&&this.cartaComputeReady&&this.apiService.authenticated&&this.preferenceStore.fetchPreferences().then(()=>{this.layoutStore.fetchLayouts().then(()=>{this.tileService.setCache(this.preferenceStore.gpuTileCache,this.preferenceStore.systemTileCache),this.layoutStore.applyLayout(this.preferenceStore.layout),this.cursorFrozen=this.preferenceStore.isCursorFrozen,this.connectToServer()})})}),Object(We.h)(()=>{this.backendService.connectionStatus===Ze.c.ACTIVE?setTimeout(this.hideSplashScreen,500):this.showSplashScreen()})}get zfpReady(){return this.tileService&&this.tileService.workersReady}setActiveFrame(e){if(this.animatorStore.serverAnimationActive)return;this.activeFrame&&this.activeFrame.frameInfo.fileId!==e&&(this.activeFrame.renderType=Ke.J.NONE);const t=this.getFrame(e);t?this.changeActiveFrame(t):console.log("Can't find required frame "+e)}setActiveFrameByIndex(e){this.animatorStore.serverAnimationActive||(e>=0&&this.frames.length>e?this.changeActiveFrame(this.frames[e]):console.log("Invalid frame index "+e))}changeActiveFrame(e){e!==this.activeFrame&&(this.tileService.clearGPUCache(),this.tileService.clearRequestQueue()),this.activeFrame=e,this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout),this.catalogStore.resetActiveCatalogFile(e.frameInfo.fileId),this.syncContourToFrame&&(this.contourDataSource=e)}get frameLockedToContour(){return this.syncFrameToContour&&this.syncContourToFrame}getFrame(e){return-1===e?this.activeFrame:this.frames.find(t=>t.frameInfo.fileId===e)}get selectedRegion(){return this.activeFrame&&this.activeFrame.regionSet&&this.activeFrame.regionSet.selectedRegion&&0!==this.activeFrame.regionSet.selectedRegion.regionId?this.activeFrame.regionSet.selectedRegion:null}delay(e){return new Promise(t=>{setTimeout(t,e)})}recalculateStatsRequirements(){if(!this.activeFrame)return;const e=Je.l.CalculateRequirementsArray(this.widgetsStore.statsWidgets),t=Je.t.DiffRequirementsArray(this.statsRequirements,e);if(this.statsRequirements=e,t.length)for(const i of t)this.backendService.setStatsRequirements(i)}recalculateHistogramRequirements(){if(!this.activeFrame)return;const e=Je.l.CalculateRequirementsArray(this.widgetsStore.histogramWidgets),t=Je.h.DiffRequirementsArray(this.histogramRequirements,e);if(this.histogramRequirements=e,t.length)for(const i of t)this.backendService.setHistogramRequirements(i)}recalculateSpectralRequirements(){if(!this.activeFrame)return;const e=Je.s.CalculateRequirementsMap(this.widgetsStore.spectralProfileWidgets);this.widgetsStore.stokesAnalysisWidgets.size>0&&Je.u.addToRequirementsMap(e,this.widgetsStore.stokesAnalysisWidgets);const t=Je.s.DiffSpectralRequirements(this.spectralRequirements,e);this.spectralRequirements=e,t.length&&t.forEach(e=>this.backendService.setSpectralRequirements(e))}recalculateSpatialRequirements(){if(!this.activeFrame)return;const e=Je.o.CalculateRequirementsMap(this.activeFrame,this.widgetsStore.spatialProfileWidgets),t=Je.o.DiffSpatialRequirements(this.spatialRequirements,e);this.spatialRequirements=e,t.length&&t.forEach(e=>this.backendService.setSpatialRequirements(e))}},De.staticInstance=void 0,De.DEFAULT_STATS_TYPES=[Xe.a.StatsType.NumPixels,Xe.a.StatsType.Sum,Xe.a.StatsType.FluxDensity,Xe.a.StatsType.Mean,Xe.a.StatsType.RMS,Xe.a.StatsType.Sigma,Xe.a.StatsType.SumSq,Xe.a.StatsType.Min,Xe.a.StatsType.Max,Xe.a.StatsType.Extrema],De.CursorThrottleTime=200,De.CursorThrottleTimeRotated=100,De.ImageChannelThrottleTime=500,De.RequirementsCheckInterval=200,n=Ne,r=Object(_e.a)(n.prototype,"astReady",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(_e.a)(n.prototype,"cartaComputeReady",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(_e.a)(n.prototype,"frames",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(_e.a)(n.prototype,"activeFrame",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(_e.a)(n.prototype,"contourDataSource",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(_e.a)(n.prototype,"syncContourToFrame",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(_e.a)(n.prototype,"syncFrameToContour",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(_e.a)(n.prototype,"spatialProfiles",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(_e.a)(n.prototype,"spectralProfiles",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(_e.a)(n.prototype,"regionStats",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(_e.a)(n.prototype,"regionHistograms",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(_e.a)(n.prototype,"spatialReference",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(_e.a)(n.prototype,"spectralReference",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(_e.a)(n.prototype,"rasterScalingReference",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(_e.a)(n.prototype,"activeLayer",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(_e.a)(n.prototype,"cursorFrozen",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Object(_e.a)(n.prototype,"splashScreenVisible",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),C=Object(_e.a)(n.prototype,"showSplashScreen",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.splashScreenVisible=!0}}}),E=Object(_e.a)(n.prototype,"hideSplashScreen",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.splashScreenVisible=!1}}}),I=Object(_e.a)(n.prototype,"setImageViewDimensions",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.overlayStore.setViewDimension(e,t)}}}),w=Object(_e.a)(n.prototype,"imageToolbarVisible",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(_e.a)(n.prototype,"showImageToolbar",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageToolbarVisible=!0}}}),v=Object(_e.a)(n.prototype,"hideImageToolbar",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageToolbarVisible=!1}}}),A=Object(_e.a)(n.prototype,"username",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),x=Object(_e.a)(n.prototype,"setUsername",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.username=e}}}),R=Object(_e.a)(n.prototype,"connectToServer",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e=window.location.href.replace(window.location.search,"").replace(/^http/,"ws").replace(/\/$/,"");e=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_DEFAULT_ADDRESS_PROD?Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_DEFAULT_ADDRESS_PROD:e;const t=new URL(window.location.href),i=t.searchParams.get("socketUrl");i?(e=i,console.log("Connecting to override URL: "+e)):console.log("Connecting to default URL: "+e);const n=t.searchParams.get("folder"),r=t.searchParams.get("file");let o=!1;Ue.onReady.then(Object(We.r)(()=>{Ue.setPalette(this.darkTheme?Ke.W:Ke.V),this.astReady=!0,this.backendService.connectionStatus===Ze.c.ACTIVE&&!o&&r&&this.loadFile(n,r,"")}));const a=t.searchParams.get("token");a&&Ze.a.Instance.setToken(a),this.backendService.connect(e).subscribe(t=>{console.log("Connected with session ID "+t.sessionId),this.logStore.addInfo(`Connected to server ${e} with session ID ${t.sessionId}`,["network"]),this.astReady&&r&&(o=!0,this.loadFile(n,r,"")),this.preferenceStore.autoLaunch&&!r&&this.fileBrowserStore.showFileBrowser(Ke.g.File)},e=>console.log(e))}}}),P=Object(_e.a)(n.prototype,"handleThemeChange",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.systemTheme=e?"dark":"light"}}}),j=Object(_e.a)(n.prototype,"taskProgress",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(_e.a)(n.prototype,"taskStartTime",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(_e.a)(n.prototype,"taskCurrentTime",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(_e.a)(n.prototype,"fileLoading",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(_e.a)(n.prototype,"resumingSession",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(_e.a)(n.prototype,"restartTaskProgress",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.taskProgress=0,this.taskStartTime=performance.now()}}}),L=Object(_e.a)(n.prototype,"updateTaskProgress",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.taskProgress=e,this.taskCurrentTime=performance.now()}}}),Object(_e.a)(n.prototype,"estimatedTaskRemainingTime",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"estimatedTaskRemainingTime"),n.prototype),_=Object(_e.a)(n.prototype,"startFileLoading",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileLoading=!0}}}),z=Object(_e.a)(n.prototype,"endFileLoading",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileLoading=!1}}}),Object(_e.a)(n.prototype,"modifierString",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"modifierString"),n.prototype),W=Object(_e.a)(n.prototype,"systemTheme",[We.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(_e.a)(n.prototype,"darkTheme",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"darkTheme"),n.prototype),Object(_e.a)(n.prototype,"activeFrameIndex",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"activeFrameIndex"),n.prototype),Object(_e.a)(n.prototype,"frameNum",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"frameNum"),n.prototype),Object(_e.a)(n.prototype,"frameMap",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"frameMap"),n.prototype),Object(_e.a)(n.prototype,"catalogNum",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"catalogNum"),n.prototype),Object(_e.a)(n.prototype,"frameNames",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"frameNames"),n.prototype),Object(_e.a)(n.prototype,"frameChannels",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"frameChannels"),n.prototype),Object(_e.a)(n.prototype,"frameStokes",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"frameStokes"),n.prototype),Object(_e.a)(n.prototype,"spatialGroup",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"spatialGroup"),n.prototype),Object(_e.a)(n.prototype,"contourFrames",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"contourFrames"),n.prototype),G=Object(_e.a)(n.prototype,"addFrame",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(!e)return!1;let n=`${e.fileInfoExtended.width}\xd7${e.fileInfoExtended.height}`;e.fileInfoExtended.dimensions>2&&(n+="\xd7"+e.fileInfoExtended.depth,e.fileInfoExtended.dimensions>3&&(n+=` (${e.fileInfoExtended.stokes} Stokes cubes)`)),this.logStore.addInfo(`Loaded file ${e.fileInfo.name} with dimensions ${n}`,["file"]);const r={fileId:e.fileId,directory:t,hdu:i,fileInfo:new Xe.a.FileInfo(e.fileInfo),fileInfoExtended:new Xe.a.FileInfoExtended(e.fileInfoExtended),fileFeatureFlags:e.fileFeatureFlags,renderMode:Xe.a.RenderMode.RASTER,beamTable:e.beamTable};let o=new Ke.v(r);const a=this.frames.findIndex(t=>t.frameInfo.fileId===e.fileId);-1!==a?(this.frames[a].clearContours(!1),this.frames[a]=o):this.frames.push(o),1===this.frames.length&&(this.setSpatialReference(this.frames[0]),this.setRasterScalingReference(this.frames[0]),this.setContourDataSource(this.frames[0])),o.frameInfo.fileInfoExtended.depth>1&&(1===this.frames.length||!this.spectralReference)&&this.setSpectralReference(o);const s=o.frameInfo.fileId;return this.setActiveFrame(s),this.catalogStore.updateImageAssociatedCatalogId(s,[]),o.frameInfo.fileInfoExtended.depth<=1&&o.frameInfo.fileInfoExtended.stokes<=1?this.animatorStore.setAnimationMode(Ke.c.FRAME):o.frameInfo.fileInfoExtended.depth>1?this.animatorStore.setAnimationMode(Ke.c.CHANNEL):o.frameInfo.fileInfoExtended.stokes>1&&this.animatorStore.setAnimationMode(Ke.c.STOKES),this.frames.length>1&&(this.preferenceStore.autoWCSMatching&$e.WCSMatchingType.SPATIAL&&this.spatialReference!==o&&this.setSpatialMatchingEnabled(o,!0),this.preferenceStore.autoWCSMatching&$e.WCSMatchingType.SPECTRAL&&this.spectralReference!==o&&o.frameInfo.fileInfoExtended.depth>1&&this.setSpectralMatchingEnabled(o,!0)),this.fileBrowserStore.saveStartingDirectory(o.frameInfo.directory),!0}}}),V=Object(_e.a)(n.prototype,"loadFile",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>new Promise((n,r)=>{if(this.startFileLoading(),t){if(!e&&t.includes("/")){const i=t.lastIndexOf("/");i>=0&&(e=t.substring(0,i),t=t.substring(i+1))}}else{const i=e.lastIndexOf("/");i>=0&&(t=e.substring(i+1),e=e.substring(0,i))}this.backendService.loadFile(e,t,i,this.fileCounter,Xe.a.RenderMode.RASTER).subscribe(t=>{this.addFrame(t,e,i)||tt.a.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3}),this.endFileLoading(),this.fileBrowserStore.hideFileBrowser(),n(t.fileId)},e=>{this.alertStore.showAlert("Error loading file: "+e),this.endFileLoading(),r(e)}),this.fileCounter++})}}),B=Object(_e.a)(n.prototype,"appendFile",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>(this.animatorStore.stopAnimation(),this.catalogNum&&Ke.k.Instance.resetDisplayedData([]),this.loadFile(e,t,i))}}),q=Object(_e.a)(n.prototype,"openFile",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>(this.removeAllFrames(),this.loadFile(e,t,i))}}),H=Object(_e.a)(n.prototype,"saveFile",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(!this.activeFrame)return;const n=this.activeFrame.frameInfo.fileId;this.backendService.saveFile(n,e,t,i).subscribe(()=>{tt.a.show({icon:"saved",message:t+" saved.",intent:"success",timeout:3e3}),this.fileBrowserStore.hideFileBrowser()},e=>{console.error(e),tt.a.show({icon:"warning-sign",message:e,intent:"danger",timeout:3e3})})}}}),U=Object(_e.a)(n.prototype,"closeFile",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{if(!e)return;const i=e.secondarySpatialImages.concat(e.secondarySpectralImages).filter(Qe.q).length;t&&i?this.alertStore.showInteractiveAlert(`${i} image${i>1?"s that are":" that is"} matched to this image will be unmatched.`,t=>{t&&this.removeFrame(e)}):this.removeFrame(e)}}}),Y=Object(_e.a)(n.prototype,"closeCurrentFile",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!0)=>{this.closeFile(this.activeFrame,e)}}}),X=Object(_e.a)(n.prototype,"closeOtherFiles",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{const i=this.frames.filter(t=>t!==e);for(const n of i)this.closeFile(n,t)}}}),K=Object(_e.a)(n.prototype,"removeFrame",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){this.animatorStore.stopAnimation();const t=e.secondarySpatialImages.slice();for(const e of t)e.clearSpatialReference();const i=e.secondarySpectralImages.slice();for(const e of i)e.clearSpectralReference();const n=e===this.spatialReference,r=e===this.spectralReference,o=e===this.rasterScalingReference,a=e.frameInfo.fileId;if(Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.statsWidgets,a),Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.histogramWidgets,a),Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.spectralProfileWidgets,a),Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets,a),this.spectralRequirements.delete(a),this.spatialRequirements.delete(a),this.statsRequirements.delete(a),this.histogramRequirements.delete(a),this.tileService.handleFileClosed(a),this.backendService.closeFile(a)){e.clearSpatialReference(),e.clearSpectralReference(),e.clearContours(!1),this.frames=this.frames.filter(e=>e.frameInfo.fileId!==a);const t=this.frames.length?this.frames[0]:null;if(this.activeFrame.frameInfo.fileId===a&&(this.activeFrame=t),this.contourDataSource.frameInfo.fileId===a&&(this.contourDataSource=t),n){const e=t;e?this.setSpatialReference(e):this.clearSpatialReference()}if(r){const e=this.frames.filter(e=>e.frameInfo.fileInfoExtended.depth>1),t=e.length?e[0]:null;t?this.setSpectralReference(t):this.clearSpectralReference()}if(o){const e=t;e?this.setRasterScalingReference(e):this.clearRasterScalingReference()}this.catalogNum&&(Ke.k.Instance.closeAssociatedCatalog(a),t&&Ke.k.Instance.resetActiveCatalogFile(t.frameInfo.fileId))}}}}}),Q=Object(_e.a)(n.prototype,"removeAllFrames",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.animatorStore.stopAnimation(),this.backendService.closeFile(-1)&&(this.activeFrame=null,this.tileService.clearCompressedCache(-1),this.frames.forEach(e=>{e.clearContours(!1);const t=e.frameInfo.fileId;this.tileService.handleFileClosed(t),this.catalogNum&&Ke.k.Instance.closeAssociatedCatalog(t)}),this.frames=[],Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.statsWidgets),Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.histogramWidgets),Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.spectralProfileWidgets),Ke.U.RemoveFrameFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets))}}}),Z=Object(_e.a)(n.prototype,"shiftFrame",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.activeFrame&&this.frames.length>1){const t=this.frames.map(e=>e.frameInfo.fileId).sort((e,t)=>e-t),i=t.indexOf(this.activeFrame.frameInfo.fileId),n=(this.frames.length+i+e)%this.frames.length;this.setActiveFrame(t[n])}}}}),$=Object(_e.a)(n.prototype,"nextFrame",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.shiftFrame(1)}}}),J=Object(_e.a)(n.prototype,"prevFrame",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.shiftFrame(-1)}}}),ee=Object(_e.a)(n.prototype,"appendCatalog",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>new Promise((r,o)=>{this.activeFrame||(tt.a.show(Object(tt.e)("Please load the image file")),o()),n!==Xe.a.CatalogFileType.VOTable&&(tt.a.show(Object(tt.e)("`Catalog type not supported")),o()),this.startFileLoading();const a=this.activeFrame,s=this.catalogNum+1;this.backendService.loadCatalogFile(e,t,s,i).subscribe(t=>Object(We.r)(()=>{if(this.endFileLoading(),a&&t.success&&t.dataSize){let i,n={fileId:s,directory:e,fileInfo:t.fileInfo,dataSize:t.dataSize};const a=$e.ProtobufProcessing.ProcessCatalogData(t.previewData);let l=[];const c=Ke.k.Instance,u=c.catalogProfiles.size;let p=c.activeCatalogFiles;if((null===p||void 0===p?void 0:p.length)?l=p:c.catalogProfiles.forEach((e,t)=>{c.catalogProfiles.set(t,s)}),l.push(s),c.updateImageAssociatedCatalogId(nt.Instance.activeFrame.frameInfo.fileId,l),0===u){const e=this.widgetsStore.createFloatingCatalogWidget(s);i=e.widgetStoreId,c.catalogProfiles.set(e.widgetComponentId,s)}else{i=this.widgetsStore.addCatalogWidget(s);const e=c.catalogProfiles.keys().next().value;c.catalogProfiles.set(e,s)}if(i){this.catalogStore.catalogWidgets.set(s,i),this.catalogStore.addCatalog(s),this.fileBrowserStore.hideFileBrowser();const e=new Ke.j(n,t.headers,a);c.catalogProfileStores.set(s,e),r(s)}else o()}else o()}),e=>{console.error(e),tt.a.show(Object(tt.e)(e)),this.endFileLoading(),o(e)})})}}),Object(_e.a)(n.prototype,"removeCatalog",[We.g],Object.getOwnPropertyDescriptor(n.prototype,"removeCatalog"),n.prototype),Object(_e.a)(n.prototype,"sendCatalogFilter",[We.g],Object.getOwnPropertyDescriptor(n.prototype,"sendCatalogFilter"),n.prototype),te=Object(_e.a)(n.prototype,"reorderFrame",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{!Number.isInteger(e)||e<0||e>=this.frameNum||!Number.isInteger(t)||t<0||t>=this.frameNum||!Number.isInteger(i)||i<=0||i>=this.frameNum||e===t||(this.frames=He.a.reorderArray(this.frames,e,t,i))}}}),ie=Object(_e.a)(n.prototype,"importRegion",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(!this.activeFrame||i!==Xe.a.FileType.CRTF&&i!==Xe.a.FileType.DS9_REG)return void tt.a.show(Object(tt.e)("Region type not supported"));const n=this.activeFrame;this.backendService.importRegion(e,t,i,n.frameInfo.fileId).subscribe(e=>{if(n&&e.success&&e.regions){const t=new Map(Object.entries(e.regions)),i=new Map(Object.entries(e.regionStyles));t.forEach((e,t)=>{const r=i.get(t);n.regionSet.addExistingRegion(e.controlPoints,e.rotation,e.regionType,parseInt(t),null===r||void 0===r?void 0:r.name,null===r||void 0===r?void 0:r.color,null===r||void 0===r?void 0:r.lineWidth,null===r||void 0===r?void 0:r.dashList)})}this.fileBrowserStore.hideFileBrowser()},e=>{console.error(e),tt.a.show(Object(tt.e)(e))})}}}),ne=Object(_e.a)(n.prototype,"exportRegions",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{const r=this.activeFrame;if(!r.regionSet.regions||r.regionSet.regions.length<=1)return;const o=new Map;for(const a of r.regionSet.regions)o.set(a.regionId,{name:a.name,color:a.color,lineWidth:a.lineWidth,dashList:a.dashLength?[a.dashLength]:[]});this.backendService.exportRegion(e,t,n,i,r.frameInfo.fileId,o).subscribe(()=>{tt.a.show(Object(tt.v)("saved",`Exported regions for ${r.filename} using ${i===Xe.a.CoordinateType.WORLD?"world":"pixel"} coordinates`)),this.fileBrowserStore.hideFileBrowser()},e=>{console.error(e),tt.a.show(Object(tt.e)(e))})}}}),re=Object(_e.a)(n.prototype,"requestCubeHistogram",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.renderConfig.cubeHistogramProgress<1&&(this.backendService.setHistogramRequirements({fileId:t.frameInfo.fileId,regionId:-2,histograms:[{channel:-2,numBins:-1}]}),this.restartTaskProgress())}}}),oe=Object(_e.a)(n.prototype,"cancelCubeHistogramRequest",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.renderConfig.cubeHistogramProgress<1&&(t.renderConfig.updateCubeHistogram(null,0),this.backendService.setHistogramRequirements({fileId:t.frameInfo.fileId,regionId:-2,histograms:[]}))}}}),ae=Object(_e.a)(n.prototype,"requestMoment",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&t&&(this.startFileLoading(),t.momentImages&&t.momentImages.length>0&&t.momentImages.forEach(e=>this.closeFile(e)),t.removeMomentImage(),this.backendService.requestMoment(e).subscribe(e=>{e.success?!e.cancel&&e.openFileAcks&&e.openFileAcks.forEach(e=>{this.addFrame(Xe.a.OpenFileAck.create(e),this.fileBrowserStore.startingDirectory,"")?(this.fileCounter++,t.addMomentImage(this.frames.find(t=>t.frameInfo.fileId===e.fileId))):tt.a.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3})}):tt.a.show({icon:"warning-sign",message:"Moment generation failed. "+(null===e||void 0===e?void 0:e.message),intent:"danger",timeout:3e3}),t.resetMomentRequestState(),this.endFileLoading()},e=>{t.resetMomentRequestState(),this.endFileLoading(),console.error(e)}),this.restartTaskProgress())}}}),se=Object(_e.a)(n.prototype,"cancelRequestingMoment",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.requestingMomentsProgress<1&&this.backendService.cancelRequestingMoment(e)}}}),le=Object(_e.a)(n.prototype,"setDarkTheme",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceStore.setPreference(Ke.G.GLOBAL_THEME,$e.Theme.DARK)}}}),ce=Object(_e.a)(n.prototype,"setLightTheme",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceStore.setPreference(Ke.G.GLOBAL_THEME,$e.Theme.LIGHT)}}}),ue=Object(_e.a)(n.prototype,"setAutoTheme",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceStore.setPreference(Ke.G.GLOBAL_THEME,$e.Theme.AUTO)}}}),pe=Object(_e.a)(n.prototype,"toggleCursorFrozen",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.cursorFrozen=!this.cursorFrozen}}}),de=Object(_e.a)(n.prototype,"updateActiveLayer",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.activeLayer=e}}}),he=Object(_e.a)(n.prototype,"handleSpatialProfileStream",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.frames.find(t=>t.frameInfo.fileId===e.fileId)){const t=`${e.fileId}-${e.regionId}`;let i=this.spatialProfiles.get(t);i||(i=new Ke.P(e.fileId,e.regionId),this.spatialProfiles.set(t,i)),i.updateFromStream(e),this.activeFrame&&this.activeFrame.frameInfo.fileId===e.fileId&&0===e.regionId&&this.activeFrame.setCursorValue({x:e.x,y:e.y},e.channel,e.value)}}}}),ge=Object(_e.a)(n.prototype,"handleTileStream",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.animatorStore.serverAnimationActive){const t={fileId:e.fileId,animationId:0,receivedFrame:{channel:e.channel,stokes:e.stokes},timestamp:Ge.fromNumber(Date.now())};this.backendService.sendAnimationFlowControl(t);const i=this.getFrame(e.fileId);i&&(i.setChannels(e.channel,e.stokes,!1),i.channel=e.channel,i.stokes=e.stokes)}const t=`${e.fileId}_${e.stokes}_${e.channel}`,i=this.pendingChannelHistograms.get(t);if(i&&i.histograms&&i.histograms.length){const n=this.getFrame(i.fileId),r=i.histograms.find(e=>e.channel===n.channel);n&&r&&(n.renderConfig.setStokes(i.stokes),n.renderConfig.updateChannelHistogram(r),n.channel=e.channel,n.stokes=e.stokes),this.pendingChannelHistograms.delete(t)}this.activeFrame&&(this.activeFrame.renderType=Ke.J.TILED)}}}),me=Object(_e.a)(n.prototype,"handleCatalogFilterStream",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.fileId,i=this.catalogStore.catalogProfileStores.get(t),n=this.catalogStore.catalogWidgets.get(t),r=e.progress;if(i){const o=$e.ProtobufProcessing.ProcessCatalogData(e.columns);if(i.updateCatalogData(e,o),i.setProgress(r),1===r&&(i.setLoadingDataStatus(!1),i.setUpdatingDataStream(!1)),i.updateMode===Ke.m.ViewUpdate){const e=this.widgetsStore.catalogWidgets.get(n),r=e.xAxis,a=e.yAxis;if(r&&a){const e=i.get2DPlotData(r,a,o),n=this.activeFrame.validWcs?this.activeFrame.wcsInfo:0;this.catalogStore.updateCatalogData(t,e.wcsX,e.wcsY,n,e.xHeaderInfo.units,e.yHeaderInfo.units,i.catalogCoordinateSystem.system)}}}}}}),fe=Object(_e.a)(n.prototype,"onResumeAlertClosed",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!e)return;this.animatorStore.stopAnimation(),this.tileService.clearRequestQueue();const t=this.frames.map(e=>{const t=e.frameInfo;let i,n=new Map;if(!e.spatialReference){n=new Map;for(const t of e.regionSet.regions)n.set(t.regionId.toFixed(),{regionType:t.regionType,controlPoints:t.controlPoints,rotation:t.rotation})}return e.contourConfig.enabled&&(i={fileId:e.frameInfo.fileId,levels:e.contourConfig.levels,smoothingMode:e.contourConfig.smoothingMode,smoothingFactor:e.contourConfig.smoothingFactor,decimationFactor:this.preferenceStore.contourDecimation,compressionLevel:this.preferenceStore.contourCompressionLevel,contourChunkSize:this.preferenceStore.contourChunkSize}),{file:t.fileInfo.name,directory:t.directory,hdu:t.hdu,fileId:t.fileId,renderMode:t.renderMode,channel:e.requiredChannel,stokes:e.requiredStokes,regions:Object(Qe.P)(n),contourSettings:i}}),i=[];this.catalogStore.catalogProfileStores.forEach(e=>{const t=e.catalogInfo;i.find(e=>e.fileId===t.fileId)||i.push({fileId:t.fileId,name:t.fileInfo.name,directory:t.directory})}),this.resumingSession=!0,this.backendService.resumeSession({images:t,catalogFiles:i}).subscribe(this.onSessionResumed,e=>{console.error(e),this.alertStore.showAlert("Error resuming session")})}}}),ye=Object(_e.a)(n.prototype,"onSessionResumed",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{console.log("Resumed successfully"),this.initRequirements(),this.resumingSession=!1,this.backendService.connectionDropped=!1}}}),Object(_e.a)(n.prototype,"zfpReady",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"zfpReady"),n.prototype),Object(_e.a)(n.prototype,"setActiveFrame",[We.g],Object.getOwnPropertyDescriptor(n.prototype,"setActiveFrame"),n.prototype),Object(_e.a)(n.prototype,"setActiveFrameByIndex",[We.g],Object.getOwnPropertyDescriptor(n.prototype,"setActiveFrameByIndex"),n.prototype),be=Object(_e.a)(n.prototype,"setContourDataSource",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.contourDataSource=e,this.syncFrameToContour&&this.setActiveFrame(e.frameInfo.fileId)}}}),Object(_e.a)(n.prototype,"frameLockedToContour",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"frameLockedToContour"),n.prototype),Oe=Object(_e.a)(n.prototype,"toggleFrameContourLock",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.frameLockedToContour?(this.syncFrameToContour=!1,this.syncContourToFrame=!1):(this.syncContourToFrame=!0,this.syncFrameToContour=!0,this.contourDataSource=this.activeFrame)}}}),Object(_e.a)(n.prototype,"selectedRegion",[We.i],Object.getOwnPropertyDescriptor(n.prototype,"selectedRegion"),n.prototype),Se=Object(_e.a)(n.prototype,"deleteSelectedRegion",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.activeFrame&&this.activeFrame.regionSet&&this.activeFrame.regionSet.selectedRegion&&!this.activeFrame.regionSet.selectedRegion.locked&&this.deleteRegion(this.activeFrame.regionSet.selectedRegion)}}}),Ce=Object(_e.a)(n.prototype,"deleteRegion",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){const t=this.getFrame(e.fileId),i=e.regionId;Ke.U.RemoveRegionFromRegionWidgets(this.widgetsStore.statsWidgets,e.fileId,i),Ke.U.RemoveRegionFromRegionWidgets(this.widgetsStore.histogramWidgets,e.fileId,i),Ke.U.RemoveRegionFromRegionWidgets(this.widgetsStore.spectralProfileWidgets,e.fileId,i),Ke.U.RemoveRegionFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets,e.fileId,i),t&&t.regionSet.deleteRegion(e)}}}}),Ee=Object(_e.a)(n.prototype,"setSpatialReference",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.spatialReference,i=t&&t.secondarySpatialImages.includes(e);this.spatialReference=e,i&&t.setSpatialReference(e);for(const n of this.frames)n===e?n.clearSpatialReference():n.spatialReference&&n.setSpatialReference(e)}}}),Ie=Object(_e.a)(n.prototype,"clearSpatialReference",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spatialReference=null;for(const e of this.frames)e.clearSpatialReference()}}}),we=Object(_e.a)(n.prototype,"setSpatialMatchingEnabled",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.spatialReference&&(t?e.setSpatialReference(this.spatialReference)||tt.a.show(Object(tt.z)(`Could not enable spatial matching of ${e.filename} to reference image ${this.spatialReference.filename}. No valid transform was found`)):e.clearSpatialReference())}}}),Te=Object(_e.a)(n.prototype,"toggleSpatialMatching",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.spatialReference&&this.setSpatialMatchingEnabled(e,!e.spatialReference)}}}),ve=Object(_e.a)(n.prototype,"setSpectralReference",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.spectralReference,i=t&&t.secondarySpectralImages.includes(e);this.spectralReference=e,i&&t.setSpectralReference(e);for(const n of this.frames)n===e?n.clearSpectralReference():n.spectralReference&&n.setSpectralReference(e)}}}),Ae=Object(_e.a)(n.prototype,"clearSpectralReference",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralReference=null;for(const e of this.frames)e.clearSpectralReference()}}}),xe=Object(_e.a)(n.prototype,"setSpectralMatchingEnabled",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.spectralReference&&(t?e.setSpectralReference(this.spectralReference)||tt.a.show(Object(tt.z)(`Could not enable spectral matching (velocity system) of ${e.filename} to reference image ${this.spectralReference.filename}. No valid transform was found`)):e.clearSpectralReference())}}}),Re=Object(_e.a)(n.prototype,"toggleSpectralMatching",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.spectralReference&&this.setSpectralMatchingEnabled(e,!e.spectralReference)}}}),Pe=Object(_e.a)(n.prototype,"setRasterScalingReference",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.rasterScalingReference,i=t&&t.secondaryRasterScalingImages.includes(e);this.rasterScalingReference=e,i&&t.setRasterScalingReference(e);for(const n of this.frames)n===e?n.clearRasterScalingReference():n.rasterScalingReference&&n.setRasterScalingReference(e)}}}),je=Object(_e.a)(n.prototype,"clearRasterScalingReference",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.rasterScalingReference=null;for(const e of this.frames)e.clearRasterScalingReference()}}}),ke=Object(_e.a)(n.prototype,"setRasterScalingMatchingEnabled",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.rasterScalingReference&&(t?e.setRasterScalingReference(this.rasterScalingReference):e.clearRasterScalingReference())}}}),Fe=Object(_e.a)(n.prototype,"toggleRasterScalingMatching",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.rasterScalingReference&&this.setRasterScalingMatchingEnabled(e,!e.rasterScalingReference)}}}),Me=Object(_e.a)(n.prototype,"setMatchingEnabled",[We.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.setSpatialMatchingEnabled(this.activeFrame,e),this.setSpectralMatchingEnabled(this.activeFrame,t)}}}),n)},195:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAA2CAYAAAAWCr1AAAAABHNCSVQICAgIfAhkiAAAA0JJREFUeJztm+Fx2kAQRl8yLkBJCUoH1EA6oAalA1JChnTgtEA6ICWYdIBLMO6A/DhttFwO3QkEwfC9GWawdBJwq91vd+8MQgghhBBCCCGEEEIIIYQQQgghhBBCCCHuiimwBnbABngceH0NNEA18ve6ZSpgTjfvO2AFzBJja2AJbOlstODAfC/aAdN2QOMuKqF2X2hZeM29MyEYZ9m+t2NmXO9Qs3bsnDDXEGy1aV97Rm0SB72BmoIvt0AGHcKUMFfTxLmKbi5ndIafRGM2btzcTpjh/GDav4cYyIeMkgfgnqkJBkqFVWNFmMs1wXDxnM7p5ntHcCgguHVKKxs3uERL/c3jh+NY7Ifv/tNry3nygSXOAAcwg9r3iIkNWj3QaeWnxAVf3Pt15sN92HgFfmfGl/ICPNFpxqV5PsM9p+3rQ2ac/80/Eue/E+a6An6272lIG8vr5478U+r1c5UZe++UeCccEfHeEwz1LXHOx/a/1u/Be6gM2k9FXsJiA54c8Xz21CfcsJ+Rjamf94zXx5MdJA63OWYDx4s8PiE6uWLwT0dJufKI9HNsvIOcnBD6ejJV9MYki1txNL7+T5UrgxgabqWf43N0x+0hccwnQL8K7hF78Fj1p1ERftRHLt/wfyXUwZ8v/LmjVgxeD0vC57n181Y7RX0M0c8aN+8pD/U3KOmSnLv+fCbfUbkl4o5bzgZfc2N8QpTTw1hvpZ95akLkO1TbD4l4lr/0zruvf3IG8uKt+jNP7AApSfPykkuIFhQsmvgatK9D5FNr1Z9lxA4QNwwWhAhpUbJvTm2xO6vvFd1TcuiGE/5NVFR/5vHOEm8msDmt6Tpvh2pQM2axxNlK+o7g0vbBk/ZvW5iVfg7DnMW2+UCnqVv2EyLz5lU7pmrP236iwfNtG5d8F2hD54l+8Vv6WU5Ft3fLvHBJujyZEgxq0XDNGSPhEunnTeE1NLe8Jq4cr7EKt1dKQ/C6NXnB9bWqstsrJK4p+4pV752lG7DFhYm3A/Zpos96VapcKVbzbOnfjeb7jNpIfcVY56EP78Uy5htgTboZbAvM5sEKs28EM5x1Lh7psln7jydx5bxLHKsJXlgTFlifGH9biTgTfwDNQH5tiO194AAAAABJRU5ErkJggg=="},196:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWMAAAA2CAYAAAAS9vgRAAAABHNCSVQICAgIfAhkiAAAC3hJREFUeJztnf1xGzkSxd9tOYBZZ3C8DHR7GfAyoNcRnJyBXI5gi86AVgR7cgZ0Bms5AymDk5SB7w/Mq3kDYWYADOaDZP+qWPrgzBAEGo1Go9EADMMwDMMwDMMwDMMwDMMwDMMwDLJbugDG2VEB2C5dCMM4Je4AHJcuhHGW3AM4LF0IwzgFjgAeli6EcbZUcPJ1t3RBDGPN3AF4huswhjEVGzg5Mwt5ZWwA7OEahtPjB7jG2i9YrktjD+AnzKdnzMMWTt6uly6I0bCDa5TQy0bOeWAbWH0bsVxj/AzqDk7ursYXxyhJBdfApozn57l+GUYMVKJjI24qOLmzNYqVcoQp4zk5wKaLRhw7OOXJ/lki/PGmftZNgWcZhaFyMGU8PVdw9WyWiaFUcLKxhRukaQn7r1Kx6FTwr9wevxT6AMNYO3vvp2EATgHfw81SD3CK+TOAf0/0eV/qn7cTPd/IxCzjedigqWcLZVueI9YTe7uBU8AbtGWjwjSWcacsmmVsXAIf659fAbwsWRADgHMJrCWq4BHAj/rnHLLxCOBb/Xtr7cKUsXEJUOj/XLQUhvJ26QIsCGcFH/SfpoyNc0enl986rzKM+aAcbiAbj0wZG+cOF2J+wFwUxjp4rF8A8I7/NGVsnDu/1z/NKjbWxI/652/8R0gZb+FCPRiTmbrKv0GZ7YNGPBXcdPwaLqB8h3ILJJv6eTf18/uey1jNm/q+pdEV8r8m/hz97jtMI/9V/Xz2z59wkQmhlf4NmmRI7Mv7icplpEN57OxPe7hG26K9ZTc2UF7DNtYSurJmxoa26cDJOMk9msD1MQmIrvB6UNbOzedW9XvPUgbet3QiHs0FMsXgwBjVn2hy1+r3Pxb83Cu4Or5D04G1jVR+uHtMB8UtXDs+YHmFTNlcM1OFthEmDwr2k2u8bihVrjFbSJkNy5RxHLnKuEKzlfqI7s7F7ZfPSFOMvK9LCNnOzPPgb+98wDpip1UeS0LFRjkPKVwdCIbqfkg5suOGnqNKgzOiZ7QtLubV5XVLb8c1Zdx+fqs9qHR9k/kKacpVp0+2/3+YHGW8QZqy0zaMaRNNYNR3PQeDZ7xWRldwinBpV4Xm/iiFDlRD9al12efeuUe3wmY+3D5lwO95Dycbfrm0zDqrWQpTxo5g3z/4/6i57rph4OElU8VRGLtST079mjIBeaoyVgvnPuFzYq00FcChzqLTrJSyzAnrqlTH1/aK7Zzqsw1BQ6iLOwwrTx10Qt/VV8bmphhmDmVM2TgCwBs0vuF/BC7WoOShDqed/AXNauFYngB8x3JW1uPwJbNxi6Ye/pNw31e478FFnb8jHOb1SX4fij74Lr9f1a9SbV4K1tVTgWft0VicX+DqNIZvcB2Zi3x+vX7oeda2fv068BnaN74E3v8M194VbBfimnhEsxUbQLMI4aP+4pjRVP1zdsBjHCmWsbobcjKPqXXU9VnqV4yZyuqMZY1uqVKWu84sUute6z3k6uvz58dYxUC7n65lm3EfZhk7Wm60X+oP/SNwoX54zGiqAmXKuDzaKXNiZvWertBD3aL6v4hnqsX5z4wyzcUYy7hCO8NWqr9VZ1a+otzBla2rPRmp0of/zLXNToxI3sBNYUKoi2JoTz9zghILsC+PDnY5lrHvbtni9fT4Cfn+xLVNffV7jCnbJ3nWC8JugD603n1X2yc0SYxCxKRxVLmwfndatOTyTcdFG7QFZ8g/5k+zbHQui1+/OcrFv+c9Xrcr/cpAeA3BRy3pNSdtH2MZa9jRfzPu72orbgyJ9T13oQp7rnDSCt0hfSnPyJWZR0yXb3gxupSx76IYQivGRufy+EJfYkEqZAEf0Cj+3wLv+/frM3IU1drx/YQllF0Fp6D36LeKY1nCMn4LJx9jozJylflbNPV4ykTlM34vv8eEXJm/eFp8oS8hhKGOwKgLwLmd+jrb7/I7V+vXhJYnN13je+/vUspuD1fPY61idQ2+YL7In0e4CI+/Zb5Y3tz7f8X65C0HyuULEFbGzHxPhgSwQrtjm2VcHl/wSsSJdgmzznK6joap0CxkfUMZC29KcutL+0EpRbeFc328G7owAh0srN+dHi25DLkpUvO/Tu0vpn+KU5M5eYFzCSztn/LdEiUSc3cplyd5bwdX9x/r/1Vw7X2Lxt9ZQqlMBWNrc+tLjYxSyvgWrs5KWHY2Iz1tKJdPQFgZ68JNTANP7S8u5Z/KhR16yWmRX685deHf05XF7BbONfUZLgTuA9oLLS91ef7A+hdqGVQ/JkKE95b6rikbRoZImcFu4Np1acPCaGjJVpebgsRYA1OPzmP9U2Nfa/BP+Tsa/5XxDH9Brksh7NB07C9w8cOsB/58h/UrYqDZJZi7UKTyXypaJBTTn4O/43Wor36MuMaYDzUQHoGwMn7rX9SDHwJnfqvp0E6ck5rSn8GE2rZPaS09IOWgCjTHOv4+fMkguS6mDZrcyCHUPTRUTqY8WDqLntGgcvAXEFbGKWFTH7y/T8FaOlW+oqlfJpNPQbcr++3m40cRnCoqj0OheiE0lC1nhyHzDafCzHzMTR1KeanRLEMD5Se4WY71z/UQtTg8lMtWH6Z7t20BIZ3UrG2awS5l2pyS9jEmu9spwe+Tm8OXaWFTcyncoEl9qTkI/O3L13hd15rnJdRm+7pcmsS+CyaaXzpTm2K5Kdo5wXsL0UrtFuAKr9NaLp2w+hTRTho7mGndx2xC0CQ3MXkVeEoIFT47/bF+7w5NylVmMhuTnGZbP0vTXR5RbjCgwsrdsKEDYEz98ZAGTfqvbaCKtSuPuA6e/oEPbH8eh9XXoamI15Y86BSUsaaIjW37FNj3B+VSC3JAIwxXaI7YUQE7lWxRS8MORP+dnzv5UL/HlIt9z9G8xqG6Z5KZ1Kxq/qkQsa/QiR99bNAI5AHN99Vydw1QKYo6ygIZQOtbjz3iezu0j54KtQcHuXs0uVweEK4zGkQ8Ao2fQ2tbvz+/H494Yvghj8haY79ckzKmy0/PkAz1TdYxz4LkPbmLw0kWNw8/1I6pwqOJ539mFujS8AewvldMI+3QtM8DGstVp9aph1D6Sjz1RWXTR+/5XzWqqP3ypXRkTQU7VjHR5UBLmQrzCNcfhjqm9qeug0QJN9bojKErH8TWK9c91j1TXZMy9lMFp75yUseq/BdxH+l01vzF8fg5HVLfD6EnOI85HVoPoGWazVBZuOuSJyKrLPD+LmKPgdLrVAHx81Lg4LT0cUOGY03KGGjkPLbfpV7vo7OZIqjPeIrEy8a8UEByTw/WQ1L7FK1ab0PwWWrl9Z0X1wVnJGvOLHdJrE0Zzw37QJF1Ed+5bZw2aoWOncr3KVuNEogRRJ3Ss5y5CpXlWqMP9dK45IExyjC4hhPYrgUhRS2gNfumjDi4el/CWlF/s48u9sVA9wIV+5CftQ9+x7ly/hrdMDLnEqHu7HTR+THDfTGvahVf6uh2blCBlmhPDctS/AidGCi4jN4Ze5YdLe2lDrc1Lhvq2V459o/y7rM+NLrCpnzngUbGjF3dpQL1BU5lLHY25cc8j1WiHBAu1SozloUzvV69qbGYfSvOOXGrxmmQspGki76QtZue97pQeSu1SEwFb4aEMSf0FQ/OCrlTp4+ULbXG6aE7zXISymgMdcjyVUUdqwj7/M+5cFOLudiMuWBsfLSb7R5hq4jJ3Wk5m0VxvvhtHbNh5BrN9Et3jIWenWLl+lvuS8JAf8tiZswBN+REuwDZEbnT54D2AopFTVwOuu2dSvaIJifFEe21gwPiBmm6w/pcIdx5RpnzN35wh+BYaKmbXBtTQpnPMmJ1N9fYJDDG6aM77fwdfjkLarS8/XwUTBj0jHY+FBoEN2g2lpTaSUeFbJuWjCngwrjpUGO18Gw9P1Mbt2D7HNB2nZQkN+ewYfRRwclVtMHyfxz8UZozq4TzAAAAAElFTkSuQmCC"},197:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAA2CAYAAABA8JJzAAAABHNCSVQICAgIfAhkiAAABLFJREFUeJztnfFx2jAUxr/eZQC3I7gbMIO7ATPQDbjrCHQDugLdIBkhZAMyQskG6R/yix6ybMlGlgj+fndcCDFYyM/f+/QkOwAhhBBCCClIA+AM4D3n40uWr0Y+A2cAVelGkGWygVGkU+mGkGVyggnATemGkOWxhgm+c+mGkGVC9SPFoPqRohxhAnBbuiFkeTSg+pGCUP1IMVawsxEsPpPsPMIE3650Q8jyoPqRolD9SDFqUP1IQQ4wwbcv3RCyPLT61YXbQhbIHp9E/RrYIuUJ4xtcw0xs02PcDhXSqF8FU7iW+HiHGdSsPdvWMClfVlmfYAY+g3Gxazds2g3HLlTUMn+IfA+ZH1G/a47JCiaYDu1zeU2CUQvVut12CxvwDUwcndAThBvPH3VAxSzX2YEBeGukUD+ZN24Cn7+GDdSVs81JbdeZ/pNAWzmv66JlTEBpaeb6sttAROFx4vtrmIDypVlBaotHmEBzj/0WlxcjdWqQe/i9nqTgWPOqd+IG81SkA7JeraUen/liHa1OU4/HAeGitQRg3+oaNwA/+vMB1ut997zxp3p+DDRCy/MbgJfA9rH8A/CMcqWD10L7TcGv9ucTph2Ppn18DWynj80fz99/w8REBeBv+/yDDfzBpf1fTOVc+7+pcr90Nkh7oknmmFP9gCsz3xb+/K5lc6z/4xqzcdSw/Zfq5JXjF8pcQzwifELoccL7FfvqoEctQwYUuPQaKf3fEpDrMlL3n6ifb+SaEi1UyTKfm35DuJ1I4hDborNHihKWDB6vUb9Y9AAkWeVjbPqVQif9XxwVbMmiRjeDxHjuIXKpH3DZ5mT+VZ+RMV9isMhIOqzQ7SdZqdJbK4sk5202tP9LdnHT2PRL/5cG18xPtTIiBiHfnoKrZ74ePK/phj9FfIarkKnqf0IF8+W+IX9B+A2mDvkjw75eYPpb9+cWpoYWyxpGQF5h6m1zo9uazHppPxeTTuf2f0uaCZE516lpLfdtNsb4vxqR8aFHNTEyTv+XFt2fY1Jp7tts6JMlZp99070d9AAk5Odcv0j/dz1uSSu2lCLHLZX61eifpADGZT4ZJ0TFh1bA0Bu0CWX9Lx2u5QhVIlLfZsMVFl9m020MDUB2GLGwWdcAh+TfHbWx/pcOd/VIqG9T32bDFRZXVXftPmOmD2VxarSPrmCju++DV+iepfR/aXEHQ30mf46bDOkTwF2kLMe+Rth3SvCNtmbaYO5VA1bt77JAkf5vPlwV6kthYplSCoCIkFyeAVhPeMalJdALXmVWp4G9HmRyXMgFKHpUdoL9onqxKv1femKm5+a8zUYFe42QqNwBfiVuYAJQsuIRGTKinjqi/5uH0PTcom+zoT1gjmmfJeIO9LTXWvRtNtyKPZkPXRbTI1JRx7tRvw3MGXZE2DjqTuHod17ck12WcN2V+rlSP1Q01B3C/6yTB3d6Tn6/+dtsxOIWPoc8ne4Mll7y4Fu2fzfqB9hazhnDnkLP//HC87y4hf+7UT/AVqyH0CrJ4MuPm6Xu7hZrR/gnlWVBqCgk0245Yif/PyUSaFLx3sOOduVOR6QsG5hjcjfez/cPq2sYlathlqQ/I/0ye0IAAP8BHHRs/vN5DEkAAAAASUVORK5CYII="},198:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAAA2BAMAAADwnfzXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMARM3dmSJmEImrMu+7dlS6miBPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACyElEQVRIDaWWz2sTQRTHX36su12SNNSzFOJBFCRUwXpLDoKCYvYkSG0b9KaI0YNYrCT/QXP0x6G5B0lVRCrIFop4UEwR8Why9xBNtWpT+3wz2yY7+ysbZg7DzPvxycyb78wGQKal1p9flMmnXOXD9UPmlBwkVgS4g20pyDnKVvC3FAOrlL78T4ah4C9Kb+3IMFS+jU5XhgFPDbaOv1IMnixXD46wNiS3lDgW5QCU3fgjjVDNijQjKqUw6+ebaellJF5KI2C9BDAhhxk7Qvmf5RiPWPpxKUa8m8lksj+kGAVkjb1BE5t5TrpE9Rne1E/4EeCyeboEOkfgdwBt6u4mS1X4qzQUUn+sZ/OpN8bBaVvotZLCr40WihGh3Zd36zU1ZxOosk1rqhIzGuoCzrQBEt1TkETbXYvn4QDmiTGONep5m7E22u9f7TsAHtIwgSvEsD3nZWNvBZO9fuTiSbG963siKzSMYQXgptE3wlWAeSzRfGlnYPQdjVXIZVuxFfh1/1XN2orky0iwX2+g25/bJZuK226Pt8Xji6IwlUCK995JDmtzy2EAKnGVbHFcc3l8DPzzJvqimCZDDDdEs+9Mp6N1tnleovJAHs4Ax9xL0FaJOrZiLx4W9HFiTaB4CbrAD7Vgk0eATok2jgb1VwRukx0t2O+Q4HZNLEGfEexZJgwlnDxm2wB8xaqopiabaqHkoSDt22R/FrQ8dYPWYntphJKHhlugZVjlvpUGABrdJ5tuhpJHEqehPkcXPPVaQEAEz+rnO1gTrZ4z9UV69hksvb39xBn9ILe5ccsmD890y3gvt2pA5H3XU9PLNnkEMAJdJhdJYMgwZyTU0fpSbhwjVyLUsfgxdPxJrkn+mfKLGWZPIqtETpTusCSHX+tV2CNWdJhHmqbYo9Ryv5AjQY4CLPRqI6W4ghdWL/Q8ZeeKDDDMfakFeEO4/gOmeAdS5mBkMwAAAABJRU5ErkJggg=="},199:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIkAAAA2CAYAAADzuLppAAAABHNCSVQICAgIfAhkiAAABDFJREFUeJztnEFy2jAUhr+2WXTp5gjOsjumRyA3yBnoDegROvQGdNdt6Q3oEUKX3ZEjBG6QLuQ3fhZCkik2Dn7fDDNJJMaK9fz069cDMAzDMAzDMAzDMAzDuComwArYAS/AFpgl3lMAm47HZQyEOS4wQq9V5H1LYNH56IyLs6AOiC2wrl479fd54H1F1afoZ5jGpZjggmADlIH2B1wg7AJtCyyLjIItbsmIURLOJpZFRsCEcIYIMacpUGekg8u4AkpcoORQ4LKJZI7G8nRz3nEZA+KpRd991f8T8Oy//90ZB2W8bj4C74F74Afw97LDMYbInNpsa/C2/7EYA2WP2xL/9BssSAxBtMiBA2tBYgi3uGzy22+wIDGEOwJLDYSDZIrbJ4vX39ZUKXFmjLl1+RTUhpacp6xxGsGn5PA0d8H/32+Z9ySL6qLT6qIzNZAcxOJNnS4aNeKMrqjNrwl1wOiHVM5a5tRm1xQ3P1tODxQx06apjrPAhfSkp2oPoHniaEGSZsrxyZGJe8EFhwTTxOuzJX6am8MDTcc1iASDb+PKKWLupOt0mRNUY6bETXpoSRHW1Ke4oSIhv07k1FPbJRmrxZKw9pDlxk97x9ADzj03SCE381jRTNevrk5DV6QnVYJExuHjB8mp44xqzxtq7XEXaP+sfk6JGp0y98CfzAGmeAYeCddD9EGbM5BcptXrQ6Kf/p+/B9q/4e51Afyqfm5LUV0nOr+zIx20HsmJUq1H1m1HOjJysgh0k5l9RBcdnd+3VePXQJteK3OiVGcSC5I4Benl2w+Kc2XmEKdmoYZqjokraCrxLqN+TGi9MciHzl9qUsgWKre/kUaL1kHuFHUU52x9lww86l8h+qG7lGiPov2OpAvHeQwdo0b7U7l1qr3SdqkxPXJ+BuVch2pctUg9ODYO4Geac6vwAnejbun/0HCP82nue77u4HeKWl/kLB1d65FrdVxjtNEjJR0HUiiT6EHluI1dR/0TaWfymvCd69QcfMnoc3a0aE3pC1+/mB5JU+Iy9DHvqU1mFj3Y+33X+/PUxbXAMn8kjf9QhZZzvbSmROuCC33STnskMadVb9PMH8nDf6h8k2yBy+SSzWP3VAqQLlIBKF85EBvkhEMxaf5IGv0A+gVeck9Lagf7mEciAXLR5V1OBl9w6Uz+mUn1uxTLmB5phzyAUiIKtUbZ0RStknXWVZ+iapf61kHcbynO1W7qljpj6IIk0yP5FNS1xJItVoS3ulOaXziz4ZVl7BWmR4wEWpOkSgmMEaI1iy01I2KGyw4b0qJIeymvao00Tsf3PGIGjc4iuR/aMq4AvzQ/pjH0bmcQ2zCjH2RPviNexa3PFQZZUmd0hzh4MXS2sQAZKRvCB0pS9COZxpaYESPBIA7gknoXI59kN0bIm8Df5Ps/S1zRyyPdfjDIGDj/AOS5vYXGcUlSAAAAAElFTkSuQmCC"},200:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAA2CAYAAAC2nEDCAAAABHNCSVQICAgIfAhkiAAACEpJREFUeJztnetx20YUhU88LgB2CUoHikuQO6BTAt2BMq4gw3SguIJE7oDuIFE6kEow1YHyY3EGVyuAAPYJQOebwVDiA1xi7969r10AQgghhBBCCCGEEEIIIWqzq90AsWoaAFe1G+FxD2BfuxFi+dwCONZuhFg9dwBuajei5RrAU/soxCBHuJlyDVzDtfWpfTyY1xo4RX5qjyOAi9INfOU0cP1yW7sh6OREMiAGocJoajdkhAbOurhFJ9A7OAGn5XoHpyAbdAPxVLaZAq5/TqhrCV7AycZdxTaIhXOAE5KlxW36uEe/K3OE+w0nPLcGb9vnnwBcZm+d8LmCu/a14m+UbcX/RC+0npYSrznHNYZdKirAJ+/5O3SKUcxnj3ivgJNQjQno1H730j0bUQnGydbACcNxHAq6n8BpoKx2KFRcsdevgeuf0vFlWp9K6olebrAu92ConYzzrOm3LJkdugklhQIE6mRiKd+aAMULLtFlUNcO3XjF+ebRwF2vK7iJw8ZL7ZFKgZR2R/l9QryAMbMtWEyc6dfiyi8FWmU8WE50hTwKkAmJEqUxnBSXUIYjFoZ1GbcQHGadl2I987iAswAv8FwOGuRRgCXljtbsGiobRGFoMW1hdrSDdSi+xEEuppFLAQKd55E7FiiPQAySQ7BLsMPLGJ+N/w3N9vdnXhMvyakA98gfe+Z3rKG0SxTGKow1ub+0Wv123w48T3bQKoC55FSA1g3ONSnRylRCTLyAimRtSsGWZVDRXQ48T7gUSwNhHjkVINDFbHNYaGy73F/RCxXGYeyNC8Mvyr2CG0iXeOnyNO1zJ8j1DSG3AmRf5piEmdlejXxfoVuudI/5s8IF0izXeQ1Y9yNn/O8CXW3ZdftdKfrngE6B3+G5cqOry9nfbpYg5pFbAdrym9RQBlL3fRaZPqALUHPWnhMgtQN6CxnN3Nj4Xw7lsEcngNwP7sY8p22p1kFuBWjrDFNa6NQHKRMs2WR6D9dQq0XnLmliYaUU4DTs9UoJ3VH2Q59ATMnWElnzdcmtAKeULoVA+U5xzqwyTUXnB6e5PGuqQqMW3sqKhtwM7ZgSg3Vnxvpgb957LjHhu7eiLLkVIMy5UyZCqLBiJ9DsMk0z8tzJplwY20mpMn3MHD5VOnJuSkoBSZUhs6UpUwcJr+2Qm8LJUdSjhAIc2r0nFBpPsYmVrDL9Fl2s7+eeN342f4/9EGshPAL4b0pLJ/ADwL+oF6t6yHhu/qYfCc51QDc7/gng28TPfYcTLAaVv3uvf55xLrFeHpB2hQ51R4xFWUSmGVT0sfG/KWasjWdpDeg0eL1iZ0kb+5gbcLbuRV+YQ6Ur9SlhAaYOx8TuNFNEpt+0Dfx9oAHkG5xVdw47SKQA5xFjATYAvpr/59ZbWQu3b1nbD7ycQYU4B6tIvmNcb/RRTKbfAvhj4CTW/f1r5Au5jxnRgBnHzowhQkK+mHM9wrkKc7DC4rs/XwD8FtiuGvi7qOTmEXlDJCWJkUGfWPe3ukz77u8Y1lxVwHwa1q2JiZPY6x5ynqG+3mFdm7PaCoSSR4lqhxIusF3DHUvseYrJ9NuBE/ju7xgfzd+y/srhD4QUtZcN3Kx7wLqsvxsAnwC8L/idTNBtgVSWM2UyNHG2CJm2s+mUADjLOZ6gu73P4Vygdgr+lukh9CW7DlAcd0mUsABT3a2PyZTQxFl1mZ7r/vqdo50+phObNbcTT6i76vc3wxla/bEcSijAFDWpKXZ+KSrTfS6wvbhT3Flf06eq/yMN3KzwHuUH5SOcm/Nx7I0R528Q7rbZAG+qYPxXOFcyZVBcLB/KYExFwq/t498R5ygq030K0BZET7FMcsf/3gP4gHoWCZVUDoXA4tPQ38a2AekmnjkFp2I7pJCjFMXPRWX6Tc9zczVw7vq/BwDvAPxU6XiHfNYQA+ih1fe2f1JlbPtqQsW2sRNwqNXFUrgHxCmuojLdpwCtOzZ2MS7wfPAqAzwP28EhVmCKDKTv8pTMooplYPv8n8BzsBwo1nsoKtN9CnBODOCz93/q+N/WsdfrQ8Dnbfb4l4DPX2J9W/GL9NjEZagFmML9BRYg03Yd3blsk90qS+t/w4ktHwotX7huP7PD83WgfhZ/D60Frk3uLDDX8Ydmb5l1TTWZVpXpBuNb4/g3v1H9Xzjs7NBaQLtd2JQ1k9z49ojO7bYreezKhqF9IkVZ7I7NU/t5DlQWoTKYcuNTYAEybS/4jTnpZfs/tazq/+KJnX0B16l2t9xL77Udun47or+v7I1xGNC+hya2kjRwfbVDd68Lux+e73Fdt+/jZ0KTabGWZezOL31Ul+mmfaNfmMgP281SU6wffK3Yos3YSYSmPwXyhG5m3GN8gNj+PmJ9N2pfO34B79wjZF2yNXZCFBhDYblCYIuVabtkRfG/OOgGr+bWgSIbjTlyvN+HHkjoGKaF+upugWFjgLIU4mA4YU27r4htwHEcmuji518VflBWxENBUixVlCJ24qUe2MQdIPdwg/AO44PQppgVJE8Dy482IUxiFXAch7qvDIOt3gP0a/rOFTNa608uW1oYrNXNykVuUty1LbZ6YTHY4ucxjW6zwnLX0rIpl0IsGibeQscw3eeU9xGuhq1FO5eJtDVJry7rUwi6FZpcRC5SKK/YjU8XxQ7jpuycu7OLcBo4K1vhBZEDrvSKcX1TbHy6OO7Q73pxQ1L+YFkm+WFB7CbcC7EoWFQcs2qDiyA2VbdKRXdqH2/QmbknKNtbGsYDdd1FKhjqijViYuOHi4br7LjOcJM/ciVQCa6+zEBUh1Zb7Himd6IQjSiC9uwTsTRwMpSivIo7tWxiUv4fLSq0kQbIMvwAAAAASUVORK5CYII="},203:function(e,t,i){e.exports=i.p+"static/media/carta_logo.80431284.png"},204:function(e,t,i){e.exports=i.p+"static/media/head_catalogue_button.c658fbe5.png"},205:function(e,t,i){e.exports=i.p+"static/media/head_catalogue_button_d.8b01ac4c.png"},206:function(e,t,i){e.exports=i.p+"static/media/smoothing_decimation.2980294d.png"},207:function(e,t,i){e.exports=i.p+"static/media/smoothing_decimation_d.8c21bf0f.png"},22:function(e,t,i){(function(t,n,r){var o="undefined"!==typeof o?o:{};o.locateFile=function(e,t){return"./"+e};var a,s={};for(a in o)o.hasOwnProperty(a)&&(s[a]=o[a]);var l=[],c="./this.program",u=!1,p=!1,d=!1,h=!1;u="object"===typeof window,p="function"===typeof importScripts,d="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,h=!u&&!d&&!p;var g,m,f,y,b="";function O(e){return o.locateFile?o.locateFile(e,b):b+e}d?(b=p?i(119).dirname(b)+"/":n+"/",g=function(e,t){return f||(f=i(210)),y||(y=i(119)),e=y.normalize(e),f.readFileSync(e,t?null:"utf8")},m=function(e){var t=g(e,!0);return t.buffer||(t=new Uint8Array(t)),A(t.buffer),t},t.argv.length>1&&(c=t.argv[1].replace(/\\/g,"/")),l=t.argv.slice(2),e.exports=o,t.on("uncaughtException",(function(e){if(!(e instanceof _t))throw e})),t.on("unhandledRejection",be),function(e){t.exit(e)},o.inspect=function(){return"[Emscripten Module object]"}):h?("undefined"!=typeof read&&(g=function(e){return read(e)}),m=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(A("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?l=scriptArgs:"undefined"!=typeof arguments&&(l=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(u||p)&&(p?b=self.location.href:document.currentScript&&(b=document.currentScript.src),b=0!==b.indexOf("blob:")?b.substr(0,b.lastIndexOf("/")+1):"",g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},p&&(m=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var S=o.print||console.log.bind(console),C=o.printErr||console.warn.bind(console);for(a in s)s.hasOwnProperty(a)&&(o[a]=s[a]);s=null,o.arguments&&(l=o.arguments),o.thisProgram&&(c=o.thisProgram),o.quit&&o.quit;var E,I,w=function(e){e};o.wasmBinary&&(E=o.wasmBinary),o.noExitRuntime&&o.noExitRuntime,"object"!==typeof WebAssembly&&C("no native wasm support detected");var T=new WebAssembly.Table({initial:3140,maximum:3140,element:"anyfunc"}),v=!1;function A(e,t){e||be("Assertion failed: "+t)}function x(e){var t=o["_"+e];return A(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function R(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);D(e,t=Lt(i),i)}return t},array:function(e){var t=Lt(e.length);return L(e,t),t}};var a=x(e),s=[],l=0;if(n)for(var c=0;c<n.length;c++){var u=o[i[c]];u?(0===l&&(l=Dt()),s[c]=u(n[c])):s[c]=n[c]}var p=a.apply(null,s);return p=function(e){return"string"===t?F(e):"boolean"===t?Boolean(e):e}(p),0!==l&&Nt(l),p}function P(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?x(e):function(){return R(e,t,i,arguments)}}var j="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&j)return j.decode(e.subarray(t,r));for(var o="";t<r;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}function F(e,t){return e?k(G,e,t):""}function M(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a);if(s<=127){if(i>=o)break;t[i++]=s}else if(s<=2047){if(i+1>=o)break;t[i++]=192|s>>6,t[i++]=128|63&s}else if(s<=65535){if(i+2>=o)break;t[i++]=224|s>>12,t[i++]=128|s>>6&63,t[i++]=128|63&s}else{if(i+3>=o)break;t[i++]=240|s>>18,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}}return t[i]=0,i-r}function D(e,t,i){return M(e,G,t,i)}function N(e){for(var t=0,i=0;i<e.length;++i){var n=e.charCodeAt(i);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function L(e,t){W.set(e,t)}function _(e,t,i){for(var n=0;n<e.length;++n)W[t++>>0]=e.charCodeAt(n);i||(W[t>>0]=0)}var z,W,G,V,B,q,H=65536;function U(e,t){return e%t>0&&(e+=t-e%t),e}function Y(e){z=e,o.HEAP8=W=new Int8Array(e),o.HEAP16=V=new Int16Array(e),o.HEAP32=B=new Int32Array(e),o.HEAPU8=G=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=q=new Float64Array(e)}var X=5770880,K=527840,Q=o.INITIAL_MEMORY||16777216;function Z(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?o.dynCall_v(i):o.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t(o)}}(I=o.wasmMemory?o.wasmMemory:new WebAssembly.Memory({initial:Q/H,maximum:2147483648/H}))&&(z=I.buffer),Q=z.byteLength,Y(z),B[K>>2]=X;var $=[],J=[],ee=[],te=[],ie=[];function ne(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)se(o.preRun.shift());Z($)}function re(){!0,o.noFSInit||qe.init.initialized||qe.init(),Ve.init(),Z(J)}function oe(){qe.ignorePermissions=!1,Z(ee)}function ae(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)le(o.postRun.shift());Z(ie)}function se(e){$.unshift(e)}function le(e){ie.unshift(e)}var ce=Math.abs,ue=Math.ceil,pe=Math.floor,de=Math.min,he=0,ge=null,me=null;function fe(e){he++,o.monitorRunDependencies&&o.monitorRunDependencies(he)}function ye(e){if(he--,o.monitorRunDependencies&&o.monitorRunDependencies(he),0==he&&(null!==ge&&(clearInterval(ge),ge=null),me)){var t=me;me=null,t()}}function be(e){throw o.onAbort&&o.onAbort(e),S(e+=""),C(e),v=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function Oe(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}o.preloadedImages={},o.preloadedAudios={};var Se="data:application/octet-stream;base64,";function Ce(e){return Oe(e,Se)}var Ee="file://";function Ie(e){return Oe(e,Ee)}var we,Te,ve="ast_wrapper.wasm";function Ae(){try{if(E)return new Uint8Array(E);if(m)return m(ve);throw"both async and sync fetching of the wasm failed"}catch(C){be(C)}}function xe(){return E||!u&&!p||"function"!==typeof fetch||Ie(ve)?new Promise((function(e,t){e(Ae())})):fetch(ve,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ve+"'";return e.arrayBuffer()})).catch((function(){return Ae()}))}function Re(){var e={env:Pt,wasi_snapshot_preview1:Pt};function t(e,t){var i=e.exports;o.asm=i,ye()}function i(e){t(e.instance)}function n(t){return xe().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){C("failed to asynchronously prepare wasm: "+e),be(e)}))}if(fe(),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(r){return C("Module.instantiateWasm callback failed with error: "+r),!1}return function(){if(E||"function"!==typeof WebAssembly.instantiateStreaming||Ce(ve)||Ie(ve)||"function"!==typeof fetch)return n(i);fetch(ve,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return C("wasm streaming compile failed: "+e),C("falling back to ArrayBuffer instantiation"),n(i)}))}))}(),{}}Ce(ve)||(ve=O(ve));var Pe={1647:function(e){o.gridContext.strokeStyle=o.colors[e],o.gridContext.fillStyle=o.colors[e]},1755:function(e,t){var i=o.fonts[e];i=i.replace("{size}",t*devicePixelRatio+"px"),o.gridContext.font=i},1884:function(e,t){o.gridContext.beginPath(),o.gridContext.moveTo(e,t)},1958:function(e,t){o.gridContext.lineTo(Math.floor(e)+.5,Math.floor(t)+.5)},2027:function(e,t){o.gridContext.lineTo(e,t)},2064:function(){o.gridContext.stroke()},2094:function(){return 2*o.gridContext.measureText("e").width},2148:function(e){o.gridContext.textAlign="center",o.gridContext.textBaseline="middle";var t=Math.max(Math.min(e,o.shapes.length-1),0);o.gridContext.symbolText=o.shapes[t]},2355:function(e,t){o.gridContext.save(),o.gridContext.translate(e,t),o.gridContext.scale(1,-1),o.gridContext.fillText(o.gridContext.symbolText,0,0),o.gridContext.restore()},2553:function(){o.gridContext.textAlign="center"},2594:function(){o.gridContext.textAlign="left"},2633:function(){o.gridContext.textAlign="right"},2705:function(){o.gridContext.textBaseline="top"},2746:function(){o.gridContext.textBaseline="middle"},2790:function(){o.gridContext.textBaseline="bottom"},2834:function(e,t,i,n){o.gridContext.save(),o.gridContext.translate(t,i),o.gridContext.rotate(n),o.gridContext.scale(1,-1),o.gridContext.fillText(F(e),0,0),o.gridContext.restore()},3055:function(e){return o.gridContext.measureText(F(e)).width},3122:function(e){o.gridContext.lineWidth=e},3161:function(){return o.colors.length},3192:function(){return o.fonts.length},3222:function(e){o.gridContext.lineWidth=e*devicePixelRatio,o.gridContext.font=o.fonts[0],o.gridContext.clearRect(0,0,o.gridContext.canvas.width,o.gridContext.canvas.height)}};function je(e,t,i){var n=wt(t,i);return Pe[e].apply(null,n)}function ke(e,t,i){var n=wt(t,i);return Pe[e].apply(null,n)}function Fe(e){return e.replace(/\b_Z[\w\d_]+/g,(function(e){return e===e?e:e+" ["+e+"]"}))}function Me(){var e=new Error;if(!e.stack){try{throw new Error}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function De(){var e=Me();return o.extraStackTrace&&(e+="\n"+o.extraStackTrace()),Fe(e)}function Ne(e,t){te.unshift({func:e,arg:t})}function Le(e,t){return Ne(e,t)}function _e(e){return B[kt()>>2]=e,e}function ze(e,t){return _e(63),-1}J.push({func:function(){jt()}});var We={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var i=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i;i--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),i="/"===e.substr(-1);return(e=We.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=We.splitPath(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},basename:function(e){if("/"===e)return"/";var t=e.lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return We.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return We.normalize(e.join("/"))},join2:function(e,t){return We.normalize(e+"/"+t)}},Ge={resolve:function(){for(var e="",t=!1,i=arguments.length-1;i>=-1&&!t;i--){var n=i>=0?arguments[i]:qe.cwd();if("string"!==typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return(t?"/":"")+(e=We.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."},relative:function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=Ge.resolve(e).substr(1),t=Ge.resolve(t).substr(1);for(var n=i(e.split("/")),r=i(t.split("/")),o=Math.min(n.length,r.length),a=o,s=0;s<o;s++)if(n[s]!==r[s]){a=s;break}var l=[];for(s=a;s<n.length;s++)l.push("..");return(l=l.concat(r.slice(a))).join("/")}},Ve={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Ve.ttys[e]={input:[],output:[],ops:t},qe.registerDevice(e,Ve.stream_ops)},stream_ops:{open:function(e){var t=Ve.ttys[e.node.rdev];if(!t)throw new qe.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,i,n,r){if(!e.tty||!e.tty.ops.get_char)throw new qe.ErrnoError(60);for(var o=0,a=0;a<n;a++){var s;try{s=e.tty.ops.get_char(e.tty)}catch(l){throw new qe.ErrnoError(29)}if(void 0===s&&0===o)throw new qe.ErrnoError(6);if(null===s||void 0===s)break;o++,t[i+a]=s}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,i,n,r){if(!e.tty||!e.tty.ops.put_char)throw new qe.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,t[i+o])}catch(a){throw new qe.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var i=null;if(d){var n=r.alloc?r.alloc(256):new r(256),o=0;try{o=f.readSync(t.stdin.fd,n,0,256,null)}catch(a){if(-1==a.toString().indexOf("EOF"))throw a;o=0}i=o>0?n.slice(0,o).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(i=window.prompt("Input: "))&&(i+="\n"):"function"==typeof readline&&null!==(i=readline())&&(i+="\n");if(!i)return null;e.input=xt(i,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(S(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(S(k(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(C(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(C(k(e.output,0)),e.output=[])}}},Be={ops_table:null,mount:function(e){return Be.createNode(null,"/",16895,0)},createNode:function(e,t,i,n){if(qe.isBlkdev(i)||qe.isFIFO(i))throw new qe.ErrnoError(63);Be.ops_table||(Be.ops_table={dir:{node:{getattr:Be.node_ops.getattr,setattr:Be.node_ops.setattr,lookup:Be.node_ops.lookup,mknod:Be.node_ops.mknod,rename:Be.node_ops.rename,unlink:Be.node_ops.unlink,rmdir:Be.node_ops.rmdir,readdir:Be.node_ops.readdir,symlink:Be.node_ops.symlink},stream:{llseek:Be.stream_ops.llseek}},file:{node:{getattr:Be.node_ops.getattr,setattr:Be.node_ops.setattr},stream:{llseek:Be.stream_ops.llseek,read:Be.stream_ops.read,write:Be.stream_ops.write,allocate:Be.stream_ops.allocate,mmap:Be.stream_ops.mmap,msync:Be.stream_ops.msync}},link:{node:{getattr:Be.node_ops.getattr,setattr:Be.node_ops.setattr,readlink:Be.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Be.node_ops.getattr,setattr:Be.node_ops.setattr},stream:qe.chrdev_stream_ops}});var r=qe.createNode(e,t,i,n);return qe.isDir(r.mode)?(r.node_ops=Be.ops_table.dir.node,r.stream_ops=Be.ops_table.dir.stream,r.contents={}):qe.isFile(r.mode)?(r.node_ops=Be.ops_table.file.node,r.stream_ops=Be.ops_table.file.stream,r.usedBytes=0,r.contents=null):qe.isLink(r.mode)?(r.node_ops=Be.ops_table.link.node,r.stream_ops=Be.ops_table.link.stream):qe.isChrdev(r.mode)&&(r.node_ops=Be.ops_table.chrdev.node,r.stream_ops=Be.ops_table.chrdev.stream),r.timestamp=Date.now(),e&&(e.contents[t]=r),r},getFileDataAsRegularArray:function(e){if(e.contents&&e.contents.subarray){for(var t=[],i=0;i<e.usedBytes;++i)t.push(e.contents[i]);return t}return e.contents},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var i=e.contents?e.contents.length:0;if(!(i>=t)){t=Math.max(t,i*(i<1048576?2:1.125)>>>0),0!=i&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t){if(0==t)return e.contents=null,void(e.usedBytes=0);if(!e.contents||e.contents.subarray){var i=e.contents;return e.contents=new Uint8Array(t),i&&e.contents.set(i.subarray(0,Math.min(t,e.usedBytes))),void(e.usedBytes=t)}if(e.contents||(e.contents=[]),e.contents.length>t)e.contents.length=t;else for(;e.contents.length<t;)e.contents.push(0);e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=qe.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,qe.isDir(e.mode)?t.size=4096:qe.isFile(e.mode)?t.size=e.usedBytes:qe.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Be.resizeFileStorage(e,t.size)},lookup:function(e,t){throw qe.genericErrors[44]},mknod:function(e,t,i,n){return Be.createNode(e,t,i,n)},rename:function(e,t,i){if(qe.isDir(e.mode)){var n;try{n=qe.lookupNode(t,i)}catch(o){}if(n)for(var r in n.contents)throw new qe.ErrnoError(55)}delete e.parent.contents[e.name],e.name=i,t.contents[i]=e,e.parent=t},unlink:function(e,t){delete e.contents[t]},rmdir:function(e,t){var i=qe.lookupNode(e,t);for(var n in i.contents)throw new qe.ErrnoError(55);delete e.contents[t]},readdir:function(e){var t=[".",".."];for(var i in e.contents)e.contents.hasOwnProperty(i)&&t.push(i);return t},symlink:function(e,t,i){var n=Be.createNode(e,t,41471,0);return n.link=i,n},readlink:function(e){if(!qe.isLink(e.mode))throw new qe.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,i,n,r){var o=e.node.contents;if(r>=e.node.usedBytes)return 0;var a=Math.min(e.node.usedBytes-r,n);if(a>8&&o.subarray)t.set(o.subarray(r,r+a),i);else for(var s=0;s<a;s++)t[i+s]=o[r+s];return a},write:function(e,t,i,n,r,o){if(t.buffer===W.buffer&&(o=!1),!n)return 0;var a=e.node;if(a.timestamp=Date.now(),t.subarray&&(!a.contents||a.contents.subarray)){if(o)return a.contents=t.subarray(i,i+n),a.usedBytes=n,n;if(0===a.usedBytes&&0===r)return a.contents=t.slice(i,i+n),a.usedBytes=n,n;if(r+n<=a.usedBytes)return a.contents.set(t.subarray(i,i+n),r),n}if(Be.expandFileStorage(a,r+n),a.contents.subarray&&t.subarray)a.contents.set(t.subarray(i,i+n),r);else for(var s=0;s<n;s++)a.contents[r+s]=t[i+s];return a.usedBytes=Math.max(a.usedBytes,r+n),n},llseek:function(e,t,i){var n=t;if(1===i?n+=e.position:2===i&&qe.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new qe.ErrnoError(28);return n},allocate:function(e,t,i){Be.expandFileStorage(e.node,t+i),e.node.usedBytes=Math.max(e.node.usedBytes,t+i)},mmap:function(e,t,i,n,r,o){if(A(0===t),!qe.isFile(e.node.mode))throw new qe.ErrnoError(43);var a,s,l=e.node.contents;if(2&o||l.buffer!==z){if((n>0||n+i<l.length)&&(l=l.subarray?l.subarray(n,n+i):Array.prototype.slice.call(l,n,n+i)),s=!0,!(a=Mt(i)))throw new qe.ErrnoError(48);W.set(l,a)}else s=!1,a=l.byteOffset;return{ptr:a,allocated:s}},msync:function(e,t,i,n,r){if(!qe.isFile(e.node.mode))throw new qe.ErrnoError(43);if(2&r)return 0;Be.stream_ops.write(e,t,0,n,i,!1);return 0}}},qe={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,handleFSError:function(e){if(!(e instanceof qe.ErrnoError))throw e+" : "+De();return _e(e.errno)},lookupPath:function(e,t){if(t=t||{},!(e=Ge.resolve(qe.cwd(),e)))return{path:"",node:null};var i={follow_mount:!0,recurse_count:0};for(var n in i)void 0===t[n]&&(t[n]=i[n]);if(t.recurse_count>8)throw new qe.ErrnoError(32);for(var r=We.normalizeArray(e.split("/").filter((function(e){return!!e})),!1),o=qe.root,a="/",s=0;s<r.length;s++){var l=s===r.length-1;if(l&&t.parent)break;if(o=qe.lookupNode(o,r[s]),a=We.join2(a,r[s]),qe.isMountpoint(o)&&(!l||l&&t.follow_mount)&&(o=o.mounted.root),!l||t.follow)for(var c=0;qe.isLink(o.mode);){var u=qe.readlink(a);if(a=Ge.resolve(We.dirname(a),u),o=qe.lookupPath(a,{recurse_count:t.recurse_count}).node,c++>40)throw new qe.ErrnoError(32)}}return{path:a,node:o}},getPath:function(e){for(var t;;){if(qe.isRoot(e)){var i=e.mount.mountpoint;return t?"/"!==i[i.length-1]?i+"/"+t:i+t:i}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var i=0,n=0;n<t.length;n++)i=(i<<5)-i+t.charCodeAt(n)|0;return(e+i>>>0)%qe.nameTable.length},hashAddNode:function(e){var t=qe.hashName(e.parent.id,e.name);e.name_next=qe.nameTable[t],qe.nameTable[t]=e},hashRemoveNode:function(e){var t=qe.hashName(e.parent.id,e.name);if(qe.nameTable[t]===e)qe.nameTable[t]=e.name_next;else for(var i=qe.nameTable[t];i;){if(i.name_next===e){i.name_next=e.name_next;break}i=i.name_next}},lookupNode:function(e,t){var i=qe.mayLookup(e);if(i)throw new qe.ErrnoError(i,e);for(var n=qe.hashName(e.id,t),r=qe.nameTable[n];r;r=r.name_next){var o=r.name;if(r.parent.id===e.id&&o===t)return r}return qe.lookup(e,t)},createNode:function(e,t,i,n){var r=new qe.FSNode(e,t,i,n);return qe.hashAddNode(r),r},destroyNode:function(e){qe.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768===(61440&e)},isDir:function(e){return 16384===(61440&e)},isLink:function(e){return 40960===(61440&e)},isChrdev:function(e){return 8192===(61440&e)},isBlkdev:function(e){return 24576===(61440&e)},isFIFO:function(e){return 4096===(61440&e)},isSocket:function(e){return 49152===(49152&e)},flagModes:{r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218},modeStringToFlags:function(e){var t=qe.flagModes[e];if("undefined"===typeof t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return qe.ignorePermissions||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){var t=qe.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{qe.lookupNode(e,t);return 20}catch(i){}return qe.nodePermissions(e,"wx")},mayDelete:function(e,t,i){var n;try{n=qe.lookupNode(e,t)}catch(o){return o.errno}var r=qe.nodePermissions(e,"wx");if(r)return r;if(i){if(!qe.isDir(n.mode))return 54;if(qe.isRoot(n)||qe.getPath(n)===qe.cwd())return 10}else if(qe.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?qe.isLink(e.mode)?32:qe.isDir(e.mode)&&("r"!==qe.flagsToPermissionString(t)||512&t)?31:qe.nodePermissions(e,qe.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||qe.MAX_OPEN_FDS;for(var i=e;i<=t;i++)if(!qe.streams[i])return i;throw new qe.ErrnoError(33)},getStream:function(e){return qe.streams[e]},createStream:function(e,t,i){qe.FSStream||(qe.FSStream=function(){},qe.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!==(2097155&this.flags)}},isWrite:{get:function(){return 0!==(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var n=new qe.FSStream;for(var r in e)n[r]=e[r];e=n;var o=qe.nextfd(t,i);return e.fd=o,qe.streams[o]=e,e},closeStream:function(e){qe.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=qe.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new qe.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){qe.devices[e]={stream_ops:t}},getDevice:function(e){return qe.devices[e]},getMounts:function(e){for(var t=[],i=[e];i.length;){var n=i.pop();t.push(n),i.push.apply(i,n.mounts)}return t},syncfs:function(e,t){"function"===typeof e&&(t=e,e=!1),qe.syncFSRequests++,qe.syncFSRequests>1&&C("warning: "+qe.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var i=qe.getMounts(qe.root.mount),n=0;function r(e){return qe.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,r(e));++n>=i.length&&r(null)}i.forEach((function(t){if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:function(e,t,i){var n,r="/"===i,o=!i;if(r&&qe.root)throw new qe.ErrnoError(10);if(!r&&!o){var a=qe.lookupPath(i,{follow_mount:!1});if(i=a.path,n=a.node,qe.isMountpoint(n))throw new qe.ErrnoError(10);if(!qe.isDir(n.mode))throw new qe.ErrnoError(54)}var s={type:e,opts:t,mountpoint:i,mounts:[]},l=e.mount(s);return l.mount=s,s.root=l,r?qe.root=l:n&&(n.mounted=s,n.mount&&n.mount.mounts.push(s)),l},unmount:function(e){var t=qe.lookupPath(e,{follow_mount:!1});if(!qe.isMountpoint(t.node))throw new qe.ErrnoError(28);var i=t.node,n=i.mounted,r=qe.getMounts(n);Object.keys(qe.nameTable).forEach((function(e){for(var t=qe.nameTable[e];t;){var i=t.name_next;-1!==r.indexOf(t.mount)&&qe.destroyNode(t),t=i}})),i.mounted=null;var o=i.mount.mounts.indexOf(n);i.mount.mounts.splice(o,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,i){var n=qe.lookupPath(e,{parent:!0}).node,r=We.basename(e);if(!r||"."===r||".."===r)throw new qe.ErrnoError(28);var o=qe.mayCreate(n,r);if(o)throw new qe.ErrnoError(o);if(!n.node_ops.mknod)throw new qe.ErrnoError(63);return n.node_ops.mknod(n,r,t,i)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,qe.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,qe.mknod(e,t,0)},mkdirTree:function(e,t){for(var i=e.split("/"),n="",r=0;r<i.length;++r)if(i[r]){n+="/"+i[r];try{qe.mkdir(n,t)}catch(o){if(20!=o.errno)throw o}}},mkdev:function(e,t,i){return"undefined"===typeof i&&(i=t,t=438),t|=8192,qe.mknod(e,t,i)},symlink:function(e,t){if(!Ge.resolve(e))throw new qe.ErrnoError(44);var i=qe.lookupPath(t,{parent:!0}).node;if(!i)throw new qe.ErrnoError(44);var n=We.basename(t),r=qe.mayCreate(i,n);if(r)throw new qe.ErrnoError(r);if(!i.node_ops.symlink)throw new qe.ErrnoError(63);return i.node_ops.symlink(i,n,e)},rename:function(e,t){var i,n,r=We.dirname(e),o=We.dirname(t),a=We.basename(e),s=We.basename(t);try{i=qe.lookupPath(e,{parent:!0}).node,n=qe.lookupPath(t,{parent:!0}).node}catch(h){throw new qe.ErrnoError(10)}if(!i||!n)throw new qe.ErrnoError(44);if(i.mount!==n.mount)throw new qe.ErrnoError(75);var l,c=qe.lookupNode(i,a),u=Ge.relative(e,o);if("."!==u.charAt(0))throw new qe.ErrnoError(28);if("."!==(u=Ge.relative(t,r)).charAt(0))throw new qe.ErrnoError(55);try{l=qe.lookupNode(n,s)}catch(h){}if(c!==l){var p=qe.isDir(c.mode),d=qe.mayDelete(i,a,p);if(d)throw new qe.ErrnoError(d);if(d=l?qe.mayDelete(n,s,p):qe.mayCreate(n,s))throw new qe.ErrnoError(d);if(!i.node_ops.rename)throw new qe.ErrnoError(63);if(qe.isMountpoint(c)||l&&qe.isMountpoint(l))throw new qe.ErrnoError(10);if(n!==i&&(d=qe.nodePermissions(i,"w")))throw new qe.ErrnoError(d);try{qe.trackingDelegate.willMovePath&&qe.trackingDelegate.willMovePath(e,t)}catch(h){C("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+h.message)}qe.hashRemoveNode(c);try{i.node_ops.rename(c,n,s)}catch(h){throw h}finally{qe.hashAddNode(c)}try{qe.trackingDelegate.onMovePath&&qe.trackingDelegate.onMovePath(e,t)}catch(h){C("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+h.message)}}},rmdir:function(e){var t=qe.lookupPath(e,{parent:!0}).node,i=We.basename(e),n=qe.lookupNode(t,i),r=qe.mayDelete(t,i,!0);if(r)throw new qe.ErrnoError(r);if(!t.node_ops.rmdir)throw new qe.ErrnoError(63);if(qe.isMountpoint(n))throw new qe.ErrnoError(10);try{qe.trackingDelegate.willDeletePath&&qe.trackingDelegate.willDeletePath(e)}catch(o){C("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.rmdir(t,i),qe.destroyNode(n);try{qe.trackingDelegate.onDeletePath&&qe.trackingDelegate.onDeletePath(e)}catch(o){C("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readdir:function(e){var t=qe.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new qe.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=qe.lookupPath(e,{parent:!0}).node,i=We.basename(e),n=qe.lookupNode(t,i),r=qe.mayDelete(t,i,!1);if(r)throw new qe.ErrnoError(r);if(!t.node_ops.unlink)throw new qe.ErrnoError(63);if(qe.isMountpoint(n))throw new qe.ErrnoError(10);try{qe.trackingDelegate.willDeletePath&&qe.trackingDelegate.willDeletePath(e)}catch(o){C("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.unlink(t,i),qe.destroyNode(n);try{qe.trackingDelegate.onDeletePath&&qe.trackingDelegate.onDeletePath(e)}catch(o){C("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readlink:function(e){var t=qe.lookupPath(e).node;if(!t)throw new qe.ErrnoError(44);if(!t.node_ops.readlink)throw new qe.ErrnoError(28);return Ge.resolve(qe.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var i=qe.lookupPath(e,{follow:!t}).node;if(!i)throw new qe.ErrnoError(44);if(!i.node_ops.getattr)throw new qe.ErrnoError(63);return i.node_ops.getattr(i)},lstat:function(e){return qe.stat(e,!0)},chmod:function(e,t,i){var n;"string"===typeof e?n=qe.lookupPath(e,{follow:!i}).node:n=e;if(!n.node_ops.setattr)throw new qe.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,t){qe.chmod(e,t,!0)},fchmod:function(e,t){var i=qe.getStream(e);if(!i)throw new qe.ErrnoError(8);qe.chmod(i.node,t)},chown:function(e,t,i,n){var r;"string"===typeof e?r=qe.lookupPath(e,{follow:!n}).node:r=e;if(!r.node_ops.setattr)throw new qe.ErrnoError(63);r.node_ops.setattr(r,{timestamp:Date.now()})},lchown:function(e,t,i){qe.chown(e,t,i,!0)},fchown:function(e,t,i){var n=qe.getStream(e);if(!n)throw new qe.ErrnoError(8);qe.chown(n.node,t,i)},truncate:function(e,t){if(t<0)throw new qe.ErrnoError(28);var i;"string"===typeof e?i=qe.lookupPath(e,{follow:!0}).node:i=e;if(!i.node_ops.setattr)throw new qe.ErrnoError(63);if(qe.isDir(i.mode))throw new qe.ErrnoError(31);if(!qe.isFile(i.mode))throw new qe.ErrnoError(28);var n=qe.nodePermissions(i,"w");if(n)throw new qe.ErrnoError(n);i.node_ops.setattr(i,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var i=qe.getStream(e);if(!i)throw new qe.ErrnoError(8);if(0===(2097155&i.flags))throw new qe.ErrnoError(28);qe.truncate(i.node,t)},utime:function(e,t,i){var n=qe.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,i)})},open:function(e,t,i,n,r){if(""===e)throw new qe.ErrnoError(44);var a;if(i="undefined"===typeof i?438:i,i=64&(t="string"===typeof t?qe.modeStringToFlags(t):t)?4095&i|32768:0,"object"===typeof e)a=e;else{e=We.normalize(e);try{a=qe.lookupPath(e,{follow:!(131072&t)}).node}catch(p){}}var s=!1;if(64&t)if(a){if(128&t)throw new qe.ErrnoError(20)}else a=qe.mknod(e,i,0),s=!0;if(!a)throw new qe.ErrnoError(44);if(qe.isChrdev(a.mode)&&(t&=-513),65536&t&&!qe.isDir(a.mode))throw new qe.ErrnoError(54);if(!s){var l=qe.mayOpen(a,t);if(l)throw new qe.ErrnoError(l)}512&t&&qe.truncate(a,0),t&=-131713;var c=qe.createStream({node:a,path:qe.getPath(a),flags:t,seekable:!0,position:0,stream_ops:a.stream_ops,ungotten:[],error:!1},n,r);c.stream_ops.open&&c.stream_ops.open(c),!o.logReadFiles||1&t||(qe.readFiles||(qe.readFiles={}),e in qe.readFiles||(qe.readFiles[e]=1,C("FS.trackingDelegate error on read file: "+e)));try{if(qe.trackingDelegate.onOpenFile){var u=0;1!==(2097155&t)&&(u|=qe.tracking.openFlags.READ),0!==(2097155&t)&&(u|=qe.tracking.openFlags.WRITE),qe.trackingDelegate.onOpenFile(e,u)}}catch(p){C("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+p.message)}return c},close:function(e){if(qe.isClosed(e))throw new qe.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{qe.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,i){if(qe.isClosed(e))throw new qe.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new qe.ErrnoError(70);if(0!=i&&1!=i&&2!=i)throw new qe.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,i),e.ungotten=[],e.position},read:function(e,t,i,n,r){if(n<0||r<0)throw new qe.ErrnoError(28);if(qe.isClosed(e))throw new qe.ErrnoError(8);if(1===(2097155&e.flags))throw new qe.ErrnoError(8);if(qe.isDir(e.node.mode))throw new qe.ErrnoError(31);if(!e.stream_ops.read)throw new qe.ErrnoError(28);var o="undefined"!==typeof r;if(o){if(!e.seekable)throw new qe.ErrnoError(70)}else r=e.position;var a=e.stream_ops.read(e,t,i,n,r);return o||(e.position+=a),a},write:function(e,t,i,n,r,o){if(n<0||r<0)throw new qe.ErrnoError(28);if(qe.isClosed(e))throw new qe.ErrnoError(8);if(0===(2097155&e.flags))throw new qe.ErrnoError(8);if(qe.isDir(e.node.mode))throw new qe.ErrnoError(31);if(!e.stream_ops.write)throw new qe.ErrnoError(28);e.seekable&&1024&e.flags&&qe.llseek(e,0,2);var a="undefined"!==typeof r;if(a){if(!e.seekable)throw new qe.ErrnoError(70)}else r=e.position;var s=e.stream_ops.write(e,t,i,n,r,o);a||(e.position+=s);try{e.path&&qe.trackingDelegate.onWriteToFile&&qe.trackingDelegate.onWriteToFile(e.path)}catch(l){C("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+l.message)}return s},allocate:function(e,t,i){if(qe.isClosed(e))throw new qe.ErrnoError(8);if(t<0||i<=0)throw new qe.ErrnoError(28);if(0===(2097155&e.flags))throw new qe.ErrnoError(8);if(!qe.isFile(e.node.mode)&&!qe.isDir(e.node.mode))throw new qe.ErrnoError(43);if(!e.stream_ops.allocate)throw new qe.ErrnoError(138);e.stream_ops.allocate(e,t,i)},mmap:function(e,t,i,n,r,o){if(0!==(2&r)&&0===(2&o)&&2!==(2097155&e.flags))throw new qe.ErrnoError(2);if(1===(2097155&e.flags))throw new qe.ErrnoError(2);if(!e.stream_ops.mmap)throw new qe.ErrnoError(43);return e.stream_ops.mmap(e,t,i,n,r,o)},msync:function(e,t,i,n,r){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,i,n,r):0},munmap:function(e){return 0},ioctl:function(e,t,i){if(!e.stream_ops.ioctl)throw new qe.ErrnoError(59);return e.stream_ops.ioctl(e,t,i)},readFile:function(e,t){if((t=t||{}).flags=t.flags||"r",t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var i,n=qe.open(e,t.flags),r=qe.stat(e).size,o=new Uint8Array(r);return qe.read(n,o,0,r,0),"utf8"===t.encoding?i=k(o,0):"binary"===t.encoding&&(i=o),qe.close(n),i},writeFile:function(e,t,i){(i=i||{}).flags=i.flags||"w";var n=qe.open(e,i.flags,i.mode);if("string"===typeof t){var r=new Uint8Array(N(t)+1),o=M(t,r,0,r.length);qe.write(n,r,0,o,void 0,i.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");qe.write(n,t,0,t.byteLength,void 0,i.canOwn)}qe.close(n)},cwd:function(){return qe.currentPath},chdir:function(e){var t=qe.lookupPath(e,{follow:!0});if(null===t.node)throw new qe.ErrnoError(44);if(!qe.isDir(t.node.mode))throw new qe.ErrnoError(54);var i=qe.nodePermissions(t.node,"x");if(i)throw new qe.ErrnoError(i);qe.currentPath=t.path},createDefaultDirectories:function(){qe.mkdir("/tmp"),qe.mkdir("/home"),qe.mkdir("/home/web_user")},createDefaultDevices:function(){var e;if(qe.mkdir("/dev"),qe.registerDevice(qe.makedev(1,3),{read:function(){return 0},write:function(e,t,i,n,r){return n}}),qe.mkdev("/dev/null",qe.makedev(1,3)),Ve.register(qe.makedev(5,0),Ve.default_tty_ops),Ve.register(qe.makedev(6,0),Ve.default_tty1_ops),qe.mkdev("/dev/tty",qe.makedev(5,0)),qe.mkdev("/dev/tty1",qe.makedev(6,0)),"object"===typeof crypto&&"function"===typeof crypto.getRandomValues){var t=new Uint8Array(1);e=function(){return crypto.getRandomValues(t),t[0]}}else if(d)try{var n=i(636);e=function(){return n.randomBytes(1)[0]}}catch(r){}e||(e=function(){be("random_device")}),qe.createDevice("/dev","random",e),qe.createDevice("/dev","urandom",e),qe.mkdir("/dev/shm"),qe.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){qe.mkdir("/proc"),qe.mkdir("/proc/self"),qe.mkdir("/proc/self/fd"),qe.mount({mount:function(){var e=qe.createNode("/proc/self","fd",16895,73);return e.node_ops={lookup:function(e,t){var i=+t,n=qe.getStream(i);if(!n)throw new qe.ErrnoError(8);var r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return r.parent=r,r}},e}},{},"/proc/self/fd")},createStandardStreams:function(){o.stdin?qe.createDevice("/dev","stdin",o.stdin):qe.symlink("/dev/tty","/dev/stdin"),o.stdout?qe.createDevice("/dev","stdout",null,o.stdout):qe.symlink("/dev/tty","/dev/stdout"),o.stderr?qe.createDevice("/dev","stderr",null,o.stderr):qe.symlink("/dev/tty1","/dev/stderr");qe.open("/dev/stdin","r"),qe.open("/dev/stdout","w"),qe.open("/dev/stderr","w")},ensureErrnoError:function(){qe.ErrnoError||(qe.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},qe.ErrnoError.prototype=new Error,qe.ErrnoError.prototype.constructor=qe.ErrnoError,[44].forEach((function(e){qe.genericErrors[e]=new qe.ErrnoError(e),qe.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){qe.ensureErrnoError(),qe.nameTable=new Array(4096),qe.mount(Be,{},"/"),qe.createDefaultDirectories(),qe.createDefaultDevices(),qe.createSpecialDirectories(),qe.filesystems={MEMFS:Be}},init:function(e,t,i){qe.init.initialized=!0,qe.ensureErrnoError(),o.stdin=e||o.stdin,o.stdout=t||o.stdout,o.stderr=i||o.stderr,qe.createStandardStreams()},quit:function(){qe.init.initialized=!1;var e=o._fflush;e&&e(0);for(var t=0;t<qe.streams.length;t++){var i=qe.streams[t];i&&qe.close(i)}},getMode:function(e,t){var i=0;return e&&(i|=365),t&&(i|=146),i},joinPath:function(e,t){var i=We.join.apply(null,e);return t&&"/"==i[0]&&(i=i.substr(1)),i},absolutePath:function(e,t){return Ge.resolve(t,e)},standardizePath:function(e){return We.normalize(e)},findObject:function(e,t){var i=qe.analyzePath(e,t);return i.exists?i.object:(_e(i.error),null)},analyzePath:function(e,t){try{e=(n=qe.lookupPath(e,{follow:!t})).path}catch(r){}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=qe.lookupPath(e,{parent:!0});i.parentExists=!0,i.parentPath=n.path,i.parentObject=n.node,i.name=We.basename(e),n=qe.lookupPath(e,{follow:!t}),i.exists=!0,i.path=n.path,i.object=n.node,i.name=n.node.name,i.isRoot="/"===n.path}catch(r){i.error=r.errno}return i},createFolder:function(e,t,i,n){var r=We.join2("string"===typeof e?e:qe.getPath(e),t),o=qe.getMode(i,n);return qe.mkdir(r,o)},createPath:function(e,t,i,n){e="string"===typeof e?e:qe.getPath(e);for(var r=t.split("/").reverse();r.length;){var o=r.pop();if(o){var a=We.join2(e,o);try{qe.mkdir(a)}catch(s){}e=a}}return a},createFile:function(e,t,i,n,r){var o=We.join2("string"===typeof e?e:qe.getPath(e),t),a=qe.getMode(n,r);return qe.create(o,a)},createDataFile:function(e,t,i,n,r,o){var a=t?We.join2("string"===typeof e?e:qe.getPath(e),t):e,s=qe.getMode(n,r),l=qe.create(a,s);if(i){if("string"===typeof i){for(var c=new Array(i.length),u=0,p=i.length;u<p;++u)c[u]=i.charCodeAt(u);i=c}qe.chmod(l,146|s);var d=qe.open(l,"w");qe.write(d,i,0,i.length,0,o),qe.close(d),qe.chmod(l,s)}return l},createDevice:function(e,t,i,n){var r=We.join2("string"===typeof e?e:qe.getPath(e),t),o=qe.getMode(!!i,!!n);qe.createDevice.major||(qe.createDevice.major=64);var a=qe.makedev(qe.createDevice.major++,0);return qe.registerDevice(a,{open:function(e){e.seekable=!1},close:function(e){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,t,n,r,o){for(var a=0,s=0;s<r;s++){var l;try{l=i()}catch(c){throw new qe.ErrnoError(29)}if(void 0===l&&0===a)throw new qe.ErrnoError(6);if(null===l||void 0===l)break;a++,t[n+s]=l}return a&&(e.node.timestamp=Date.now()),a},write:function(e,t,i,r,o){for(var a=0;a<r;a++)try{n(t[i+a])}catch(s){throw new qe.ErrnoError(29)}return r&&(e.node.timestamp=Date.now()),a}}),qe.mkdev(r,o,a)},createLink:function(e,t,i,n,r){var o=We.join2("string"===typeof e?e:qe.getPath(e),t);return qe.symlink(i,o)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;var t=!0;if("undefined"!==typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!g)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=xt(g(e.url),!0),e.usedBytes=e.contents.length}catch(i){t=!1}return t||_e(29),t},createLazyFile:function(e,t,i,n,r){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,i=e/this.chunkSize|0;return this.getter(i)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",i,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+i+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),r=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,a=1048576;r||(a=n);var s=this;s.setDataGetter((function(e){var t=e*a,r=(e+1)*a-1;if(r=Math.min(r,n-1),"undefined"===typeof s.chunks[e]&&(s.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var r=new XMLHttpRequest;if(r.open("GET",i,!1),n!==a&&r.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(r.responseType="arraybuffer"),r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.send(null),!(r.status>=200&&r.status<300||304===r.status))throw new Error("Couldn't load "+i+". Status: "+r.status);return void 0!==r.response?new Uint8Array(r.response||[]):xt(r.responseText||"",!0)}(t,r)),"undefined"===typeof s.chunks[e])throw new Error("doXHR failed!");return s.chunks[e]})),!o&&n||(a=n=1,n=this.getter(0).length,a=n,S("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=a,this.lengthKnown=!0},"undefined"!==typeof XMLHttpRequest){if(!p)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var a=new o;Object.defineProperties(a,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var s={isDevice:!1,contents:a}}else s={isDevice:!1,url:i};var l=qe.createFile(e,t,s,n,r);s.contents?l.contents=s.contents:s.url&&(l.contents=null,l.url=s.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var c={};return Object.keys(l.stream_ops).forEach((function(e){var t=l.stream_ops[e];c[e]=function(){if(!qe.forceLoadFile(l))throw new qe.ErrnoError(29);return t.apply(null,arguments)}})),c.read=function(e,t,i,n,r){if(!qe.forceLoadFile(l))throw new qe.ErrnoError(29);var o=e.node.contents;if(r>=o.length)return 0;var a=Math.min(o.length-r,n);if(o.slice)for(var s=0;s<a;s++)t[i+s]=o[r+s];else for(s=0;s<a;s++)t[i+s]=o.get(r+s);return a},l.stream_ops=c,l},createPreloadedFile:function(e,t,i,n,r,a,s,l,c,u){Browser.init();var p=t?Ge.resolve(We.join2(e,t)):e;function d(i){function d(i){u&&u(),l||qe.createDataFile(e,t,i,n,r,c),a&&a(),ye()}var h=!1;o.preloadPlugins.forEach((function(e){h||e.canHandle(p)&&(e.handle(i,p,d,(function(){s&&s(),ye()})),h=!0)})),h||d(i)}fe(),"string"==typeof i?Browser.asyncLoad(i,(function(e){d(e)}),s):d(i)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,i){t=t||function(){},i=i||function(){};var n=qe.indexedDB();try{var r=n.open(qe.DB_NAME(),qe.DB_VERSION)}catch(o){return i(o)}r.onupgradeneeded=function(){S("creating db"),r.result.createObjectStore(qe.DB_STORE_NAME)},r.onsuccess=function(){var n=r.result.transaction([qe.DB_STORE_NAME],"readwrite"),o=n.objectStore(qe.DB_STORE_NAME),a=0,s=0,l=e.length;function c(){0==s?t():i()}e.forEach((function(e){var t=o.put(qe.analyzePath(e).object.contents,e);t.onsuccess=function(){++a+s==l&&c()},t.onerror=function(){s++,a+s==l&&c()}})),n.onerror=i},r.onerror=i},loadFilesFromDB:function(e,t,i){t=t||function(){},i=i||function(){};var n=qe.indexedDB();try{var r=n.open(qe.DB_NAME(),qe.DB_VERSION)}catch(o){return i(o)}r.onupgradeneeded=i,r.onsuccess=function(){var n=r.result;try{var a=n.transaction([qe.DB_STORE_NAME],"readonly")}catch(o){return void i(o)}var s=a.objectStore(qe.DB_STORE_NAME),l=0,c=0,u=e.length;function p(){0==c?t():i()}e.forEach((function(e){var t=s.get(e);t.onsuccess=function(){qe.analyzePath(e).exists&&qe.unlink(e),qe.createDataFile(We.dirname(e),We.basename(e),t.result,!0,!0,!0),++l+c==u&&p()},t.onerror=function(){c++,l+c==u&&p()}})),a.onerror=i},r.onerror=i}},He={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t){if("/"!==t[0]){var i;if(-100===e)i=qe.cwd();else{var n=qe.getStream(e);if(!n)throw new qe.ErrnoError(8);i=n.path}t=We.join2(i,t)}return t},doStat:function(e,t,i){try{var n=e(t)}catch(r){if(r&&r.node&&We.normalize(t)!==We.normalize(qe.getPath(r.node)))return-54;throw r}return B[i>>2]=n.dev,B[i+4>>2]=0,B[i+8>>2]=n.ino,B[i+12>>2]=n.mode,B[i+16>>2]=n.nlink,B[i+20>>2]=n.uid,B[i+24>>2]=n.gid,B[i+28>>2]=n.rdev,B[i+32>>2]=0,Te=[n.size>>>0,(we=n.size,+ce(we)>=1?we>0?(0|de(+pe(we/4294967296),4294967295))>>>0:~~+ue((we-+(~~we>>>0))/4294967296)>>>0:0)],B[i+40>>2]=Te[0],B[i+44>>2]=Te[1],B[i+48>>2]=4096,B[i+52>>2]=n.blocks,B[i+56>>2]=n.atime.getTime()/1e3|0,B[i+60>>2]=0,B[i+64>>2]=n.mtime.getTime()/1e3|0,B[i+68>>2]=0,B[i+72>>2]=n.ctime.getTime()/1e3|0,B[i+76>>2]=0,Te=[n.ino>>>0,(we=n.ino,+ce(we)>=1?we>0?(0|de(+pe(we/4294967296),4294967295))>>>0:~~+ue((we-+(~~we>>>0))/4294967296)>>>0:0)],B[i+80>>2]=Te[0],B[i+84>>2]=Te[1],0},doMsync:function(e,t,i,n,r){var o=G.slice(e,e+i);qe.msync(t,o,r,i,n)},doMkdir:function(e,t){return"/"===(e=We.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),qe.mkdir(e,t,0),0},doMknod:function(e,t,i){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return qe.mknod(e,t,i),0},doReadlink:function(e,t,i){if(i<=0)return-28;var n=qe.readlink(e),r=Math.min(i,N(n)),o=W[t+r];return D(n,t,i+1),W[t+r]=o,r},doAccess:function(e,t){if(-8&t)return-28;var i;if(!(i=qe.lookupPath(e,{follow:!0}).node))return-44;var n="";return 4&t&&(n+="r"),2&t&&(n+="w"),1&t&&(n+="x"),n&&qe.nodePermissions(i,n)?-2:0},doDup:function(e,t,i){var n=qe.getStream(i);return n&&qe.close(n),qe.open(e,t,0,i,i).fd},doReadv:function(e,t,i,n){for(var r=0,o=0;o<i;o++){var a=B[t+8*o>>2],s=B[t+(8*o+4)>>2],l=qe.read(e,W,a,s,n);if(l<0)return-1;if(r+=l,l<s)break}return r},doWritev:function(e,t,i,n){for(var r=0,o=0;o<i;o++){var a=B[t+8*o>>2],s=B[t+(8*o+4)>>2],l=qe.write(e,W,a,s,n);if(l<0)return-1;r+=l}return r},varargs:void 0,get:function(){return He.varargs+=4,B[He.varargs-4>>2]},getStr:function(e){return F(e)},getStreamFromFD:function(e){var t=qe.getStream(e);if(!t)throw new qe.ErrnoError(8);return t},get64:function(e,t){return e}};function Ue(e,t,i){He.varargs=i;try{var n=He.getStreamFromFD(e);switch(t){case 0:return(r=He.get())<0?-28:qe.open(n.path,n.flags,0,r).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:var r=He.get();return n.flags|=r,0;case 12:r=He.get();return V[r+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return _e(28),-1;default:return-28}}catch(o){return"undefined"!==typeof qe&&o instanceof qe.ErrnoError||be(o),-o.errno}}function Ye(e,t,i){He.varargs=i;try{var n=He.getStreamFromFD(e);switch(t){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:if(!n.tty)return-59;var r=He.get();return B[r>>2]=0,0;case 21520:return n.tty?-28:-59;case 21531:r=He.get();return qe.ioctl(n,t,r);case 21523:case 21524:return n.tty?0:-59;default:be("bad ioctl syscall "+t)}}catch(o){return"undefined"!==typeof qe&&o instanceof qe.ErrnoError||be(o),-o.errno}}function Xe(e,t){if(-1===(0|e)||0===t)return-28;var i=He.mappings[e];if(!i)return 0;if(t===i.len){var n=qe.getStream(i.fd);2&i.prot&&He.doMsync(e,n,t,i.flags,i.offset),qe.munmap(n),He.mappings[e]=null,i.allocated&&Ft(i.malloc)}return 0}function Ke(e,t){try{return Xe(e,t)}catch(i){return"undefined"!==typeof qe&&i instanceof qe.ErrnoError||be(i),-i.errno}}function Qe(e,t,i){He.varargs=i;try{var n=He.getStr(e),r=He.get();return qe.open(n,t,r).fd}catch(o){return"undefined"!==typeof qe&&o instanceof qe.ErrnoError||be(o),-o.errno}}function Ze(){be()}function $e(){return void 0===$e.start&&($e.start=Date.now()),1e3*(Date.now()-$e.start)|0}function Je(e,t){return e-t}function et(){return 527840}function tt(e,t,i){G.copyWithin(e,t,t+i)}function it(){return G.length}function nt(e){try{return I.grow(e-z.byteLength+65535>>>16),Y(I.buffer),1}catch(t){}}function rt(e){e>>>=0;var t=it();if(e>2147483648)return!1;for(var i=1;i<=4;i*=2){var n=t*(1+.2/i);if(n=Math.min(n,e+100663296),nt(Math.min(2147483648,U(Math.max(16777216,e,n),65536))))return!0}return!1}var ot={};function at(){return c||"./this.program"}function st(){if(!st.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"===typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:at()};for(var t in ot)e[t]=ot[t];var i=[];for(var t in e)i.push(t+"="+e[t]);st.strings=i}return st.strings}function lt(e,t){var i=0;return st().forEach((function(n,r){var o=t+i;B[e+4*r>>2]=o,_(n,o),i+=n.length+1})),0}function ct(e,t){var i=st();B[e>>2]=i.length;var n=0;return i.forEach((function(e){n+=e.length+1})),B[t>>2]=n,0}function ut(e){try{var t=He.getStreamFromFD(e);return qe.close(t),0}catch(i){return"undefined"!==typeof qe&&i instanceof qe.ErrnoError||be(i),i.errno}}function pt(e,t,i,n){try{var r=He.getStreamFromFD(e),o=He.doReadv(r,t,i);return B[n>>2]=o,0}catch(a){return"undefined"!==typeof qe&&a instanceof qe.ErrnoError||be(a),a.errno}}function dt(e,t,i,n,r){try{var o=He.getStreamFromFD(e),a=4294967296*i+(t>>>0);return a<=-9007199254740992||a>=9007199254740992?-61:(qe.llseek(o,a,n),Te=[o.position>>>0,(we=o.position,+ce(we)>=1?we>0?(0|de(+pe(we/4294967296),4294967295))>>>0:~~+ue((we-+(~~we>>>0))/4294967296)>>>0:0)],B[r>>2]=Te[0],B[r+4>>2]=Te[1],o.getdents&&0===a&&0===n&&(o.getdents=null),0)}catch(s){return"undefined"!==typeof qe&&s instanceof qe.ErrnoError||be(s),s.errno}}function ht(e,t,i,n){try{var r=He.getStreamFromFD(e),o=He.doWritev(r,t,i);return B[n>>2]=o,0}catch(a){return"undefined"!==typeof qe&&a instanceof qe.ErrnoError||be(a),a.errno}}function gt(e){w(0|e)}function mt(e){return e%4===0&&(e%100!==0||e%400===0)}function ft(e,t){for(var i=0,n=0;n<=t;i+=e[n++]);return i}var yt=[31,29,31,30,31,30,31,31,30,31,30,31],bt=[31,28,31,30,31,30,31,31,30,31,30,31];function Ot(e,t){for(var i=new Date(e.getTime());t>0;){var n=mt(i.getFullYear()),r=i.getMonth(),o=(n?yt:bt)[r];if(!(t>o-i.getDate()))return i.setDate(i.getDate()+t),i;t-=o-i.getDate()+1,i.setDate(1),r<11?i.setMonth(r+1):(i.setMonth(0),i.setFullYear(i.getFullYear()+1))}return i}function St(e,t,i,n){var r=B[n+40>>2],o={tm_sec:B[n>>2],tm_min:B[n+4>>2],tm_hour:B[n+8>>2],tm_mday:B[n+12>>2],tm_mon:B[n+16>>2],tm_year:B[n+20>>2],tm_wday:B[n+24>>2],tm_yday:B[n+28>>2],tm_isdst:B[n+32>>2],tm_gmtoff:B[n+36>>2],tm_zone:r?F(r):""},a=F(i),s={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in s)a=a.replace(new RegExp(l,"g"),s[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["January","February","March","April","May","June","July","August","September","October","November","December"];function p(e,t,i){for(var n="number"===typeof e?e.toString():e||"";n.length<t;)n=i[0]+n;return n}function d(e,t){return p(e,t,"0")}function h(e,t){function i(e){return e<0?-1:e>0?1:0}var n;return 0===(n=i(e.getFullYear()-t.getFullYear()))&&0===(n=i(e.getMonth()-t.getMonth()))&&(n=i(e.getDate()-t.getDate())),n}function g(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function m(e){var t=Ot(new Date(e.tm_year+1900,0,1),e.tm_yday),i=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),r=g(i),o=g(n);return h(r,t)<=0?h(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var f={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return u[e.tm_mon].substring(0,3)},"%B":function(e){return u[e.tm_mon]},"%C":function(e){return d((e.tm_year+1900)/100|0,2)},"%d":function(e){return d(e.tm_mday,2)},"%e":function(e){return p(e.tm_mday,2," ")},"%g":function(e){return m(e).toString().substring(2)},"%G":function(e){return m(e)},"%H":function(e){return d(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),d(t,2)},"%j":function(e){return d(e.tm_mday+ft(mt(e.tm_year+1900)?yt:bt,e.tm_mon-1),3)},"%m":function(e){return d(e.tm_mon+1,2)},"%M":function(e){return d(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return d(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=new Date(e.tm_year+1900,0,1),i=0===t.getDay()?t:Ot(t,7-t.getDay()),n=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(h(i,n)<0){var r=ft(mt(n.getFullYear())?yt:bt,n.getMonth()-1)-31,o=31-i.getDate()+r+n.getDate();return d(Math.ceil(o/7),2)}return 0===h(i,t)?"01":"00"},"%V":function(e){var t,i=new Date(e.tm_year+1900,0,4),n=new Date(e.tm_year+1901,0,4),r=g(i),o=g(n),a=Ot(new Date(e.tm_year+1900,0,1),e.tm_yday);return h(a,r)<0?"53":h(o,a)<=0?"01":(t=r.getFullYear()<e.tm_year+1900?e.tm_yday+32-r.getDate():e.tm_yday+1-r.getDate(),d(Math.ceil(t/7),2))},"%w":function(e){return e.tm_wday},"%W":function(e){var t=new Date(e.tm_year,0,1),i=1===t.getDay()?t:Ot(t,0===t.getDay()?1:7-t.getDay()+1),n=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(h(i,n)<0){var r=ft(mt(n.getFullYear())?yt:bt,n.getMonth()-1)-31,o=31-i.getDate()+r+n.getDate();return d(Math.ceil(o/7),2)}return 0===h(i,t)?"01":"00"},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,i=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(i?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var l in f)a.indexOf(l)>=0&&(a=a.replace(new RegExp(l,"g"),f[l](o)));var y=xt(a,!1);return y.length>t?0:(L(y,e),y.length-1)}function Ct(e,t,i,n){return St(e,t,i,n)}function Et(e){var t=Date.now()/1e3|0;return e&&(B[e>>2]=t),t}var It=[];function wt(e,t){var i;for(It.length=0,t>>=2;i=G[e++];)It.push(i<105?q[++t>>1]:B[t]),++t;return It}var Tt=function(e,t,i,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=qe.nextInode++,this.name=t,this.mode=i,this.node_ops={},this.stream_ops={},this.rdev=n},vt=365,At=146;Object.defineProperties(Tt.prototype,{read:{get:function(){return(this.mode&vt)===vt},set:function(e){e?this.mode|=vt:this.mode&=~vt}},write:{get:function(){return(this.mode&At)===At},set:function(e){e?this.mode|=At:this.mode&=~At}},isFolder:{get:function(){return qe.isDir(this.mode)}},isDevice:{get:function(){return qe.isChrdev(this.mode)}}}),qe.FSNode=Tt,qe.staticInit();function xt(e,t,i){var n=i>0?i:N(e)+1,r=new Array(n),o=M(e,r,0,r.length);return t&&(r.length=o),r}var Rt,Pt={__cxa_atexit:Le,__map_file:ze,__sys_fcntl64:Ue,__sys_ioctl:Ye,__sys_munmap:Ke,__sys_open:Qe,abort:Ze,clock:$e,difftime:Je,emscripten_asm_const_dii:ke,emscripten_asm_const_iii:je,emscripten_get_sbrk_ptr:et,emscripten_memcpy_big:tt,emscripten_resize_heap:rt,environ_get:lt,environ_sizes_get:ct,fd_close:ut,fd_read:pt,fd_seek:dt,fd_write:ht,memory:I,setTempRet0:gt,strftime_l:Ct,table:T,time:Et},jt=(Re(),o.___wasm_call_ctors=function(){return(jt=o.___wasm_call_ctors=o.asm.__wasm_call_ctors).apply(null,arguments)}),kt=(o._getLastErrorMessage=function(){return(o._getLastErrorMessage=o.asm.getLastErrorMessage).apply(null,arguments)},o._clearLastErrorMessage=function(){return(o._clearLastErrorMessage=o.asm.clearLastErrorMessage).apply(null,arguments)},o._initFrame=function(){return(o._initFrame=o.asm.initFrame).apply(null,arguments)},o._getSpectralFrame=function(){return(o._getSpectralFrame=o.asm.getSpectralFrame).apply(null,arguments)},o._createTransformedFrameset=function(){return(o._createTransformedFrameset=o.asm.createTransformedFrameset).apply(null,arguments)},o._initDummyFrame=function(){return(o._initDummyFrame=o.asm.initDummyFrame).apply(null,arguments)},o._plotGrid=function(){return(o._plotGrid=o.asm.plotGrid).apply(null,arguments)},o._format=function(){return(o._format=o.asm.format).apply(null,arguments)},o._unformat=function(){return(o._unformat=o.asm.unformat).apply(null,arguments)},o._set=function(){return(o._set=o.asm.set).apply(null,arguments)},o._clear=function(){return(o._clear=o.asm.clear).apply(null,arguments)},o._dump=function(){return(o._dump=o.asm.dump).apply(null,arguments)},o._getString=function(){return(o._getString=o.asm.getString).apply(null,arguments)},o._norm=function(){return(o._norm=o.asm.norm).apply(null,arguments)},o._transform=function(){return(o._transform=o.asm.transform).apply(null,arguments)},o._transform3D=function(){return(o._transform3D=o.asm.transform3D).apply(null,arguments)},o._spectralTransform=function(){return(o._spectralTransform=o.asm.spectralTransform).apply(null,arguments)},o._deleteObject=function(){return(o._deleteObject=o.asm.deleteObject).apply(null,arguments)},o._copy=function(){return(o._copy=o.asm.copy).apply(null,arguments)},o._invert=function(){return(o._invert=o.asm.invert).apply(null,arguments)},o._convert=function(){return(o._convert=o.asm.convert).apply(null,arguments)},o._shiftMap2D=function(){return(o._shiftMap2D=o.asm.shiftMap2D).apply(null,arguments)},o._axDistance=function(){return(o._axDistance=o.asm.axDistance).apply(null,arguments)},o._fillTransformGrid=function(){return(o._fillTransformGrid=o.asm.fillTransformGrid).apply(null,arguments)},o.___errno_location=function(){return(kt=o.___errno_location=o.asm.__errno_location).apply(null,arguments)}),Ft=o._free=function(){return(Ft=o._free=o.asm.free).apply(null,arguments)},Mt=o._malloc=function(){return(Mt=o._malloc=o.asm.malloc).apply(null,arguments)},Dt=o.stackSave=function(){return(Dt=o.stackSave=o.asm.stackSave).apply(null,arguments)},Nt=o.stackRestore=function(){return(Nt=o.stackRestore=o.asm.stackRestore).apply(null,arguments)},Lt=o.stackAlloc=function(){return(Lt=o.stackAlloc=o.asm.stackAlloc).apply(null,arguments)};o.__growWasmMemory=function(){return(o.__growWasmMemory=o.asm.__growWasmMemory).apply(null,arguments)},o.dynCall_vii=function(){return(o.dynCall_vii=o.asm.dynCall_vii).apply(null,arguments)},o.dynCall_viiiii=function(){return(o.dynCall_viiiii=o.asm.dynCall_viiiii).apply(null,arguments)},o.dynCall_iii=function(){return(o.dynCall_iii=o.asm.dynCall_iii).apply(null,arguments)},o.dynCall_viii=function(){return(o.dynCall_viii=o.asm.dynCall_viii).apply(null,arguments)},o.dynCall_iiiii=function(){return(o.dynCall_iiiii=o.asm.dynCall_iiiii).apply(null,arguments)},o.dynCall_diidi=function(){return(o.dynCall_diidi=o.asm.dynCall_diidi).apply(null,arguments)},o.dynCall_iiii=function(){return(o.dynCall_iiii=o.asm.dynCall_iiii).apply(null,arguments)},o.dynCall_viiii=function(){return(o.dynCall_viiii=o.asm.dynCall_viiii).apply(null,arguments)},o.dynCall_viiiidii=function(){return(o.dynCall_viiiidii=o.asm.dynCall_viiiidii).apply(null,arguments)},o.dynCall_viiiiiii=function(){return(o.dynCall_viiiiiii=o.asm.dynCall_viiiiiii).apply(null,arguments)},o.dynCall_iiiiiiii=function(){return(o.dynCall_iiiiiiii=o.asm.dynCall_iiiiiiii).apply(null,arguments)},o.dynCall_iiiiii=function(){return(o.dynCall_iiiiii=o.asm.dynCall_iiiiii).apply(null,arguments)},o.dynCall_vidi=function(){return(o.dynCall_vidi=o.asm.dynCall_vidi).apply(null,arguments)},o.dynCall_dii=function(){return(o.dynCall_dii=o.asm.dynCall_dii).apply(null,arguments)},o.dynCall_iiiiiiiii=function(){return(o.dynCall_iiiiiiiii=o.asm.dynCall_iiiiiiiii).apply(null,arguments)},o.dynCall_diiiii=function(){return(o.dynCall_diiiii=o.asm.dynCall_diiiii).apply(null,arguments)},o.dynCall_iiiiiii=function(){return(o.dynCall_iiiiiii=o.asm.dynCall_iiiiiii).apply(null,arguments)},o.dynCall_iiiiiiiiii=function(){return(o.dynCall_iiiiiiiiii=o.asm.dynCall_iiiiiiiiii).apply(null,arguments)},o.dynCall_diiii=function(){return(o.dynCall_diiii=o.asm.dynCall_diiii).apply(null,arguments)},o.dynCall_iiidi=function(){return(o.dynCall_iiidi=o.asm.dynCall_iiidi).apply(null,arguments)},o.dynCall_diidii=function(){return(o.dynCall_diidii=o.asm.dynCall_diidii).apply(null,arguments)},o.dynCall_diiddi=function(){return(o.dynCall_diiddi=o.asm.dynCall_diiddi).apply(null,arguments)},o.dynCall_viiidii=function(){return(o.dynCall_viiidii=o.asm.dynCall_viiidii).apply(null,arguments)},o.dynCall_viiiiiiii=function(){return(o.dynCall_viiiiiiii=o.asm.dynCall_viiiiiiii).apply(null,arguments)},o.dynCall_viiiiii=function(){return(o.dynCall_viiiiii=o.asm.dynCall_viiiiii).apply(null,arguments)},o.dynCall_viidiii=function(){return(o.dynCall_viidiii=o.asm.dynCall_viidiii).apply(null,arguments)},o.dynCall_viifdiiii=function(){return(o.dynCall_viifdiiii=o.asm.dynCall_viifdiiii).apply(null,arguments)},o.dynCall_diddi=function(){return(o.dynCall_diddi=o.asm.dynCall_diddi).apply(null,arguments)},o.dynCall_iidi=function(){return(o.dynCall_iidi=o.asm.dynCall_iidi).apply(null,arguments)},o.dynCall_iidddii=function(){return(o.dynCall_iidddii=o.asm.dynCall_iidddii).apply(null,arguments)},o.dynCall_didii=function(){return(o.dynCall_didii=o.asm.dynCall_didii).apply(null,arguments)},o.dynCall_iiidddii=function(){return(o.dynCall_iiidddii=o.asm.dynCall_iiidddii).apply(null,arguments)},o.dynCall_diiddii=function(){return(o.dynCall_diiddii=o.asm.dynCall_diiddii).apply(null,arguments)},o.dynCall_viiddii=function(){return(o.dynCall_viiddii=o.asm.dynCall_viiddii).apply(null,arguments)},o.dynCall_viidi=function(){return(o.dynCall_viidi=o.asm.dynCall_viidi).apply(null,arguments)},o.dynCall_diii=function(){return(o.dynCall_diii=o.asm.dynCall_diii).apply(null,arguments)},o.dynCall_viiidi=function(){return(o.dynCall_viiidi=o.asm.dynCall_viiidi).apply(null,arguments)},o.dynCall_viiifi=function(){return(o.dynCall_viiifi=o.asm.dynCall_viiifi).apply(null,arguments)},o.dynCall_viifii=function(){return(o.dynCall_viifii=o.asm.dynCall_viifii).apply(null,arguments)},o.dynCall_viidii=function(){return(o.dynCall_viidii=o.asm.dynCall_viidii).apply(null,arguments)},o.dynCall_iiiddiiii=function(){return(o.dynCall_iiiddiiii=o.asm.dynCall_iiiddiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidijjiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidijjiiiiiiiiii=o.asm.dynCall_vidiiiiiiiidijjiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidijjiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidijjiiiiiiii=o.asm.dynCall_vidiiiiiiiidijjiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidiiiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidiiiiiiiiiiii=o.asm.dynCall_vidiiiiiiiidiiiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidiiiiiiiiii=o.asm.dynCall_vidiiiiiiiidiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidifiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidifiiiiiiiiii=o.asm.dynCall_vidiiiiiiiidifiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidifiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidifiiiiiiii=o.asm.dynCall_vidiiiiiiiidifiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiididiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiididiiiiiiiiii=o.asm.dynCall_vidiiiiiiiididiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiididiiiiiiii=function(){return(o.dynCall_vidiiiiiiiididiiiiiiii=o.asm.dynCall_vidiiiiiiiididiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidijjiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidijjiiiiiiii=o.asm.dynCall_jiiiiiiiiiidijjiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidiiiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidiiiiiiiiii=o.asm.dynCall_jiiiiiiiiiidiiiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidijiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidijiiiiiiii=o.asm.dynCall_jiiiiiiiiiidijiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidifiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidifiiiiiiii=o.asm.dynCall_jiiiiiiiiiidifiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiididiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiididiiiiiiii=o.asm.dynCall_jiiiiiiiiiididiiiiiiii).apply(null,arguments)},o.dynCall_iiiidii=function(){return(o.dynCall_iiiidii=o.asm.dynCall_iiiidii).apply(null,arguments)},o.dynCall_viiiiiiiiii=function(){return(o.dynCall_viiiiiiiiii=o.asm.dynCall_viiiiiiiiii).apply(null,arguments)},o.dynCall_vijiiii=function(){return(o.dynCall_vijiiii=o.asm.dynCall_vijiiii).apply(null,arguments)},o.dynCall_vijiiiiii=function(){return(o.dynCall_vijiiiiii=o.asm.dynCall_vijiiiiii).apply(null,arguments)},o.dynCall_viiiidiiijii=function(){return(o.dynCall_viiiidiiijii=o.asm.dynCall_viiiidiiijii).apply(null,arguments)},o.dynCall_vijijiiijii=function(){return(o.dynCall_vijijiiijii=o.asm.dynCall_vijijiiijii).apply(null,arguments)},o.dynCall_vdiiii=function(){return(o.dynCall_vdiiii=o.asm.dynCall_vdiiii).apply(null,arguments)},o.dynCall_viiiiijiiiijjiii=function(){return(o.dynCall_viiiiijiiiijjiii=o.asm.dynCall_viiiiijiiiijjiii).apply(null,arguments)},o.dynCall_viiiiijiiiidiii=function(){return(o.dynCall_viiiiijiiiidiii=o.asm.dynCall_viiiiijiiiidiii).apply(null,arguments)},o.dynCall_viiiiijiiiifiii=function(){return(o.dynCall_viiiiijiiiifiii=o.asm.dynCall_viiiiijiiiifiii).apply(null,arguments)},o.dynCall_viiiiijiiiiiiii=function(){return(o.dynCall_viiiiijiiiiiiii=o.asm.dynCall_viiiiijiiiiiiii).apply(null,arguments)},o.dynCall_viiiiijiiiijiii=function(){return(o.dynCall_viiiiijiiiijiii=o.asm.dynCall_viiiiijiiiijiii).apply(null,arguments)},o.dynCall_iidii=function(){return(o.dynCall_iidii=o.asm.dynCall_iidii).apply(null,arguments)},o.dynCall_iiijii=function(){return(o.dynCall_iiijii=o.asm.dynCall_iiijii).apply(null,arguments)},o.dynCall_viiiji=function(){return(o.dynCall_viiiji=o.asm.dynCall_viiiji).apply(null,arguments)},o.dynCall_viiifiifiii=function(){return(o.dynCall_viiifiifiii=o.asm.dynCall_viiifiifiii).apply(null,arguments)},o.dynCall_viiidiidiii=function(){return(o.dynCall_viiidiidiii=o.asm.dynCall_viiidiidiii).apply(null,arguments)},o.dynCall_viiijjiijjiii=function(){return(o.dynCall_viiijjiijjiii=o.asm.dynCall_viiijjiijjiii).apply(null,arguments)},o.dynCall_iiidiii=function(){return(o.dynCall_iiidiii=o.asm.dynCall_iiidiii).apply(null,arguments)},o.dynCall_iiiffiffi=function(){return(o.dynCall_iiiffiffi=o.asm.dynCall_iiiffiffi).apply(null,arguments)},o.dynCall_iiiffiffiii=function(){return(o.dynCall_iiiffiffiii=o.asm.dynCall_iiiffiffiii).apply(null,arguments)},o.dynCall_iiidii=function(){return(o.dynCall_iiidii=o.asm.dynCall_iiidii).apply(null,arguments)},o.dynCall_ii=function(){return(o.dynCall_ii=o.asm.dynCall_ii).apply(null,arguments)},o.dynCall_iiiffiff=function(){return(o.dynCall_iiiffiff=o.asm.dynCall_iiiffiff).apply(null,arguments)},o.dynCall_iiiffiffii=function(){return(o.dynCall_iiiffiffii=o.asm.dynCall_iiiffiffii).apply(null,arguments)},o.dynCall_jiiiiiiiii=function(){return(o.dynCall_jiiiiiiiii=o.asm.dynCall_jiiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiifi=function(){return(o.dynCall_jiiiiiiifi=o.asm.dynCall_jiiiiiiifi).apply(null,arguments)},o.dynCall_jiiiiiiidi=function(){return(o.dynCall_jiiiiiiidi=o.asm.dynCall_jiiiiiiidi).apply(null,arguments)},o.dynCall_jiiiiiiijji=function(){return(o.dynCall_jiiiiiiijji=o.asm.dynCall_jiiiiiiijji).apply(null,arguments)},o.dynCall_jii=function(){return(o.dynCall_jii=o.asm.dynCall_jii).apply(null,arguments)},o.dynCall_vijiii=function(){return(o.dynCall_vijiii=o.asm.dynCall_vijiii).apply(null,arguments)},o.dynCall_viji=function(){return(o.dynCall_viji=o.asm.dynCall_viji).apply(null,arguments)},o.dynCall_viiddi=function(){return(o.dynCall_viiddi=o.asm.dynCall_viiddi).apply(null,arguments)},o.dynCall_dddii=function(){return(o.dynCall_dddii=o.asm.dynCall_dddii).apply(null,arguments)},o.dynCall_iddiii=function(){return(o.dynCall_iddiii=o.asm.dynCall_iddiii).apply(null,arguments)},o.dynCall_jiji=function(){return(o.dynCall_jiji=o.asm.dynCall_jiji).apply(null,arguments)},o.dynCall_iidiiii=function(){return(o.dynCall_iidiiii=o.asm.dynCall_iidiiii).apply(null,arguments)},o.dynCall_vi=function(){return(o.dynCall_vi=o.asm.dynCall_vi).apply(null,arguments)},o.dynCall_viijii=function(){return(o.dynCall_viijii=o.asm.dynCall_viijii).apply(null,arguments)},o.dynCall_iiiiij=function(){return(o.dynCall_iiiiij=o.asm.dynCall_iiiiij).apply(null,arguments)},o.dynCall_iiiiid=function(){return(o.dynCall_iiiiid=o.asm.dynCall_iiiiid).apply(null,arguments)},o.dynCall_iiiiijj=function(){return(o.dynCall_iiiiijj=o.asm.dynCall_iiiiijj).apply(null,arguments)},o.dynCall_iiiiiijj=function(){return(o.dynCall_iiiiiijj=o.asm.dynCall_iiiiiijj).apply(null,arguments)},o.dynCall_v=function(){return(o.dynCall_v=o.asm.dynCall_v).apply(null,arguments)};function _t(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function zt(e){function t(){Rt||(Rt=!0,o.calledRun=!0,v||(re(),oe(),o.onRuntimeInitialized&&o.onRuntimeInitialized(),ae()))}e=e||l,he>0||(ne(),he>0||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t()))}if(o.ccall=R,o.cwrap=P,o.UTF8ToString=F,me=function e(){Rt||zt(),Rt||(me=e)},o.run=zt,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();zt(),le((function(){o.numArrayCoordinates=1,o.xIn=o._malloc(8*o.numArrayCoordinates),o.yIn=o._malloc(8*o.numArrayCoordinates),o.xOut=o._malloc(8*o.numArrayCoordinates),o.yOut=o._malloc(8*o.numArrayCoordinates),o.zIn=o._malloc(8*o.numArrayCoordinates),o.zOut=o._malloc(8*o.numArrayCoordinates),console.log("AST WebAssembly module loaded")})),o.LABEL_EXTERIOR=0,o.LABEL_INTERIOR=1,o.DEFAULT_TOLERANCE=.01,o.DEFAULT_COLOR=2,o.DEFAULT_FONT="20px Arial",o.SYS_ECLIPTIC=0,o.SYS_FK4=1,o.SYS_FK5=2,o.SYS_GALACTIC=3,o.SYS_ICRS=4,o.SYS_J2000=5,o.fonts=["{size} sans-serif","italic {size} sans-serif","bold {size} sans-serif","bold italic {size} sans-serif","{size} times","italic {size} times","bold {size} times","bold italic {size} times","{size} arial","bold {size} arial","italic {size} arial","bold italic {size} arial","{size} palatino","italic {size} palatino","bold {size} palatino","bold italic {size} palatino","{size} courier new","italic {size} courier new","bold {size} courier new","bold italic {size} courier new"],o.colors=["black","white","red","green","blue","cyan","magenta","yellow","grey"],o.shapes=["\u25a1","\u25e6","+","\u26b9","\u25cb","\u2a09","\u25a1","\u25bd","\u2295","\u25a1","\u25c7","\u2606"],o.setPalette=function(e){o.colors=e},o.setFontList=function(e){o.fonts=e},o.setCanvas=function(e){o.gridContext=e.getContext("2d"),o.gridContext.imageSmoothingEnabled=!1,o.gridContext.scale(1,-1),o.gridContext.translate(0,-e.height),o.gridContext.font=o.font},o.plot=o.cwrap("plotGrid","number",["number","number","number","number","number","number","number","number","number","number","number","string"]),o.initFrame=o.cwrap("initFrame","number",["string"]),o.getSpectralFrame=o.cwrap("getSpectralFrame","number",["number"]),o.initDummyFrame=o.cwrap("initDummyFrame","number",[]),o.set=o.cwrap("set","number",["number","string"]),o.clear=o.cwrap("clear","number",["number","string"]),o.getString=o.cwrap("getString","string",["number","string"]),o.dump=o.cwrap("dump",null,["number"]),o.norm=o.cwrap("norm","number",["number","number"]),o.axDistance=o.cwrap("axDistance","number",["number","number","number","number"]),o.format=o.cwrap("format","string",["number","number","number"]),o.unformat=o.cwrap("unformat","number",["number","number","string","number"]),o.transform=o.cwrap("transform","number",["number","number","number","number","number","number","number"]),o.transform3D=o.cwrap("transform3D","number",["number","number","number","number","number","number"]),o.spectralTransform=o.cwrap("spectralTransform","number",["number","string","string","string","number","number","number","number"]),o.getLastErrorMessage=o.cwrap("getLastErrorMessage","string"),o.clearLastErrorMessage=o.cwrap("clearLastErrorMessage",null),o.copy=o.cwrap("copy",null,["number"]),o.delete=o.cwrap("deleteObject",null,["number"]),o.invert=o.cwrap("invert","number",["number"]),o.convert=o.cwrap("convert","number",["number","number","string"]),o.shiftMap2D=o.cwrap("shiftMap2D","number",["number","number"]),o.createTransformedFrameset=o.cwrap("createTransformedFrameset","number",["number","number","number","number","number","number","number","number"]),o.fillTransformGrid=o.cwrap("fillTransformGrid","number",["number","number","number","number","number","number","number","number"]),o.currentFormatStrings=[],o.getFormattedCoordinates=function(e,t,i,n,r){var a,s,l;return r?(a=o.currentFormatStrings[e],o.set(e,n)):n&&o.currentFormatStrings[e]!==n&&(o.set(e,n),o.currentFormatStrings[e]=n),void 0!==t&&(s=o.format(e,1,t)),void 0!==i&&(l=o.format(e,2,i)),r&&o.set(e,a),{x:s,y:l}},o.getWCSValueFromFormattedString=function(e,t){o.unformat(e,1,t.x,o.xOut),o.unformat(e,2,t.y,o.yOut);var i=new Float64Array(o.HEAPF64.buffer,o.xOut,1),n=new Float64Array(o.HEAPF64.buffer,o.yOut,1);return{x:i[0],y:n[0]}},o.transformPointArrays=function(e,t,i,n){if(!(t instanceof Float64Array)||!(i instanceof Float64Array)||t.length!==i.length)return{x:new Float64Array(1),y:new Float64Array(1)};var r=t.length,a=o._malloc(8*r),s=o._malloc(8*r),l=o._malloc(8*r),c=o._malloc(8*r);o.HEAPF64.set(t,a/8),o.HEAPF64.set(i,s/8),o.transform(e,r,a,s,n,l,c);var u=new Float64Array(o.HEAPF64.buffer,l,r),p=new Float64Array(o.HEAPF64.buffer,c,r),d={x:u.slice(0),y:p.slice(0)};return o._free(a),o._free(s),o._free(l),o._free(c),d},o.transformPoint=function(e,t,i,n){void 0===n&&(n=!0);o.HEAPF64.set(new Float64Array([t]),o.xIn/8),o.HEAPF64.set(new Float64Array([i]),o.yIn/8),o.transform(e,1,o.xIn,o.yIn,n,o.xOut,o.yOut);var r=new Float64Array(o.HEAPF64.buffer,o.xOut,1),a=new Float64Array(o.HEAPF64.buffer,o.yOut,1);return{x:r[0],y:a[0]}},o.transform3DPoint=function(e,t,i,n,r){void 0===r&&(r=!0);var a=o._malloc(24);o.transform3D(e,t,i,n,r,a);var s=new Float64Array(o.HEAPF64.buffer,a,3),l={x:s[0],y:s[1],z:s[2]};return o._free(a),l},o.transformSpectralPoint=function(e,t,i,n,r,a){void 0===a&&(a=!0);return o.HEAPF64.set(new Float64Array([r]),o.zIn/8),o.spectralTransform(e,t,i,n,1,o.zIn,a,o.zOut),new Float64Array(o.HEAPF64.buffer,o.zOut,1)[0]},o.normalizeCoordinates=function(e,t,i){o.HEAPF64.set(new Float64Array([t,i]),o.xIn/8),o.norm(e,o.xIn);var n=new Float64Array(o.HEAPF64.buffer,o.xIn,2);return{x:n[0],y:n[1]}},o.getTransformGrid=function(e,t,i,n,r,a,s,l){var c=o.fillTransformGrid(e,t,i,n,r,a,s,l);if(c){var u=new Float32Array(o.HEAPF32.buffer,c,n*s*2).slice();return o._free(c),u}return null},o.onReady=new Promise((function(e){if(o.calledRun)e(o);else{var t=o.onRuntimeInitialized;o.onRuntimeInitialized=function(){t&&t(),e(o)}}})),e.exports=o}).call(this,i(44),"/",i(56).Buffer)},28:function(e,t,i){"use strict";i.d(t,"a",(function(){return O})),i.d(t,"c",(function(){return fe})),i.d(t,"b",(function(){return ye})),i.d(t,"g",(function(){return Ae})),i.d(t,"h",(function(){return xe})),i.d(t,"i",(function(){return je})),i.d(t,"d",(function(){return ke})),i.d(t,"e",(function(){return Fe})),i.d(t,"f",(function(){return Me}));var n,r,o,a,s,l,c=i(3),u=i(2),p=(i(29),i(185)),d=i.n(p),h=i(186),g=i.n(h),m=i(1),f=i(7),y=i(10);const b=i(921);let O=(l=s=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}static SetRuntimeConfig(t){console.log("Setting runtime config"),e.RuntimeConfig=t||{}}get accessToken(){return this._accessToken}get tokenLifetime(){return this._tokenLifetime}get authenticated(){return this._accessToken&&this._tokenLifetime>0}constructor(){Object(c.a)(this,"_accessToken",r,this),this._tokenLifetime=void 0,this._tokenExpiryHandler=void 0,this.axiosInstance=void 0,this.authInstance=void 0,Object(c.a)(this,"setToken",o,this),Object(c.a)(this,"clearToken",a,this),this.onTokenExpired=async()=>{clearTimeout(this._tokenExpiryHandler);if(await this.refreshAccessToken()){console.log("Authenticated");const e=this.tokenLifetime;this._tokenExpiryHandler=setTimeout(this.onTokenExpired,1e3*(e-10))}else this.handleAuthLost()},this.handleAuthLost=()=>{if(e.RuntimeConfig.dashboardAddress){this.clearToken();const t=btoa(window.location.search);window.open(`${e.RuntimeConfig.dashboardAddress}?redirectParams=${t}`,"_self")}else this.clearToken(),f.a.show({icon:"warning-sign",message:"Could not authenticate with server",intent:"danger",timeout:3e3})},this.refreshAccessToken=async()=>{if(e.RuntimeConfig.googleClientId)try{var t;this.authInstance=gapi.auth2.getAuthInstance();const e=null===(t=this.authInstance)||void 0===t?void 0:t.currentUser.get();if(null===e||void 0===e?void 0:e.isSignedIn()){const t=await e.reloadAuthResponse();return this.setToken(t.id_token,t.expires_in)?(console.log("Authenticated with Google"),!0):(console.log("Error parsing Google access token"),!1)}return console.log("Not authenticated!"),this.clearToken(),!1}catch(n){return!1}else{if(!e.RuntimeConfig.tokenRefreshAddress)return!1;try{var i;const t=await this.axiosInstance.post(e.RuntimeConfig.tokenRefreshAddress);return(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.access_token)?(this.setToken(t.data.access_token,t.data.expires_in||Number.MAX_VALUE),!0):(this.clearToken(),!1)}catch(r){return this.clearToken(),console.log(r),!1}}},this.logout=async()=>{var t;if(this.clearToken(),e.RuntimeConfig.googleClientId)null===(t=this.authInstance)||void 0===t||t.signOut();else if(e.RuntimeConfig.logoutAddress)try{await this.axiosInstance.post(e.RuntimeConfig.logoutAddress)}catch(i){console.log(i)}e.RuntimeConfig.dashboardAddress&&window.open(e.RuntimeConfig.dashboardAddress,"_self")},this.stopServer=async()=>{if(e.RuntimeConfig.apiAddress)try{const t=e.RuntimeConfig.apiAddress+"/server/stop";await this.axiosInstance.post(t)}catch(t){f.a.show({icon:"warning-sign",message:"Could not stop CARTA server",intent:"danger",timeout:3e3}),console.log(t)}},this.getPreferences=async()=>{let t;var i;if(e.RuntimeConfig.apiAddress)try{var n;const i=e.RuntimeConfig.apiAddress+"/database/preferences",r=await this.axiosInstance.get(i);if(!(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.success))return;t=r.data.preferences}catch(r){return void console.log(r)}else t=null!==(i=JSON.parse(localStorage.getItem("preferences")))&&void 0!==i?i:{};if(!e.PreferenceValidator(t))for(const o of e.PreferenceValidator.errors)o.dataPath&&(console.log("Removing invalid preference "+o.dataPath),delete t[o.dataPath.substring(1)]);return t},this.setPreference=async(e,t)=>{const i={};return i[e]=t,this.setPreferences(i)},this.setPreferences=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=e.RuntimeConfig.apiAddress+"/database/preferences",r=await this.axiosInstance.put(n,t);return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const i=null!==(n=JSON.parse(localStorage.getItem("preferences")))&&void 0!==n?n:{};for(const e of Object.keys(t))i[e]=t[e];return e.PreferenceValidator(i)||console.log(e.PreferenceValidator.errors),localStorage.setItem("preferences",JSON.stringify(i)),!0}catch(r){return!1}},this.clearPreferences=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=e.RuntimeConfig.apiAddress+"/database/preferences",r=await this.axiosInstance.delete(n,{data:{keys:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("preferences")))&&void 0!==n?n:{};for(const i of t)delete e[i];return localStorage.setItem("preferences",JSON.stringify(e)),!0}catch(r){return!1}},this.getLayouts=async()=>{let t;if(e.RuntimeConfig.apiAddress)try{var i;const n=e.RuntimeConfig.apiAddress+"/database/layouts",r=await this.axiosInstance.get(n);if(!(null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success))return;t=r.data.layouts}catch(r){return void console.log(r)}else try{var n;t=null!==(n=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==n?n:{}}catch(r){return void console.log(r)}if(t){const e={};for(const i of Object.keys(t)){const n=t[i];y.LayoutConfig.UpgradeLayout(n);y.LayoutConfig.LayoutValidator(n)?e[i]=n:console.log(y.LayoutConfig.LayoutValidator.errors)}return e}},this.setLayout=async(t,i)=>{if(e.RuntimeConfig.apiAddress)try{var n;const r=e.RuntimeConfig.apiAddress+"/database/layout",o=await this.axiosInstance.put(r,{layoutName:t,layout:i});return null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.success}catch(o){return console.log(o),!1}else try{var r;const e=null!==(r=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==r?r:{};return e[t]=i,localStorage.setItem("savedLayouts",JSON.stringify(e)),!0}catch(o){return!1}},this.clearLayout=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=e.RuntimeConfig.apiAddress+"/database/layout",r=await this.axiosInstance.delete(n,{data:{layoutName:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==n?n:{};return delete e[t],localStorage.setItem("savedLayouts",JSON.stringify(e)),!0}catch(r){return!1}},Object(m.p)(this),this.axiosInstance=d.a.create(),e.RuntimeConfig.googleClientId?gapi.load("auth2",()=>{console.log("Google auth loaded");try{gapi.auth2.init({client_id:e.RuntimeConfig.googleClientId,scope:"profile email"}).then(this.onTokenExpired,e=>{console.log(e),this.handleAuthLost()})}catch(t){console.log(t),this.handleAuthLost()}}):e.RuntimeConfig.tokenRefreshAddress?this.onTokenExpired():(this._accessToken="no_auth_configured",this._tokenLifetime=Number.MAX_VALUE)}},s.staticInstance=void 0,s.RuntimeConfig=void 0,s.PreferenceValidator=(new g.a).compile(b),n=l,r=Object(u.a)(n.prototype,"_accessToken",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(u.a)(n.prototype,"setToken",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=Number.MAX_VALUE)=>isFinite(t)&&t>0?(t===Number.MAX_VALUE?document.cookie="carta-auth-token="+e:console.log(`Token updated and valid for ${t.toFixed()} seconds`),this._accessToken=e,this.axiosInstance.defaults.headers.common.Authorization="Bearer "+e,this._tokenLifetime=t,!0):(this.clearToken(),!1)}}),a=Object(u.a)(n.prototype,"clearToken",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this._accessToken=void 0,this._tokenLifetime=-1,delete this.axiosInstance.defaults.headers.common.Authorization}}}),Object(u.a)(n.prototype,"authenticated",[m.i],Object.getOwnPropertyDescriptor(n.prototype,"authenticated"),n.prototype),n);var S,C,E,I,w,T,v,A,x,R,P,j,k,F,M,D,N,L,_,z,W,G,V,B,q,H,U,Y,X,K,Q,Z,$,J,ee,te,ie,ne,re,oe,ae,se,le,ce,ue=i(5),pe=i(1025),de=i(146),he=i(1022),ge=i(4),me=i(6);let fe;!function(e){e[e.CLOSED=0]="CLOSED",e[e.PENDING=1]="PENDING",e[e.ACTIVE=2]="ACTIVE"}(fe||(fe={}));let ye=(S=Object(m.g)("connect"),C=Object(m.g)("file list"),E=Object(m.g)("region list"),I=Object(m.g)("catalog list"),w=Object(m.g)("file info"),T=Object(m.g)("region info"),v=Object(m.g)("catalog info"),A=Object(m.g)("import region"),x=Object(m.g)("export regions"),R=Object(m.g)("load file"),P=Object(m.g)("load catalog file"),j=Object(m.g)("close catalog file"),k=Object(m.g)("save file"),F=Object(m.g)("close file"),M=Object(m.g)("set channels"),D=Object(m.g)("set cursor"),N=Object(m.g)("set region"),L=Object(m.g)("remove region"),_=Object(m.g)("set catalog filter"),z=Object(m.g)("set spatial requirements"),W=Object(m.g)("set spectral requirements"),G=Object(m.g)("set stats requirements"),V=Object(m.g)("set histogram requirements"),B=Object(m.g)("add required tiles"),q=Object(m.g)("remove required tiles"),H=Object(m.g)("start animation"),U=Object(m.g)("stop animation"),Y=Object(m.g)("animation flow control"),X=Object(m.g)("set contour parameters"),K=Object(m.g)("resume session"),Q=Object(m.g)("set auth token"),Z=Object(m.g)("request moment"),$=Object(m.g)("cancel requesting moment"),J=Object(m.g)("request spectral line"),ee=Object(m.g)("send scripting response"),ce=le=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(c.a)(this,"connectionStatus",ie,this),this.loggingEnabled=void 0,Object(c.a)(this,"connectionDropped",ne,this),Object(c.a)(this,"endToEndPing",re,this),this.animationId=void 0,this.sessionId=void 0,this.serverFeatureFlags=void 0,this.grpcPort=void 0,this.serverUrl=void 0,this.connection=void 0,this.lastPingTime=void 0,this.lastPongTime=void 0,this.autoReconnect=void 0,this.observerRequestMap=void 0,this.eventCounter=void 0,this.rasterTileStream=void 0,this.rasterSyncStream=void 0,this.histogramStream=void 0,this.errorStream=void 0,this.spatialProfileStream=void 0,this.spectralProfileStream=void 0,this.statsStream=void 0,this.contourStream=void 0,this.catalogStream=void 0,this.momentProgressStream=void 0,this.reconnectStream=void 0,this.scriptingStream=void 0,this.handlerMap=void 0,this.decoderMap=void 0,this.sendPing=()=>{this.connection&&this.connectionStatus===fe.ACTIVE&&(this.lastPingTime=performance.now(),this.connection.send("PING"))},Object(c.a)(this,"updateEndToEndPing",oe,this),Object(c.a)(this,"setAuthToken",ae,this),Object(c.a)(this,"sendScriptingResponse",se,this),Object(m.p)(this),this.loggingEnabled=!0,this.observerRequestMap=new Map,this.eventCounter=1,this.sessionId=0,this.endToEndPing=NaN,this.animationId=-1,this.connectionStatus=fe.CLOSED,this.rasterTileStream=new pe.a,this.rasterSyncStream=new pe.a,this.histogramStream=new pe.a,this.errorStream=new pe.a,this.spatialProfileStream=new pe.a,this.spectralProfileStream=new pe.a,this.statsStream=new pe.a,this.contourStream=new pe.a,this.scriptingStream=new pe.a,this.catalogStream=new pe.a,this.momentProgressStream=new pe.a,this.reconnectStream=new pe.a,this.handlerMap=new Map([[ue.a.EventType.REGISTER_VIEWER_ACK,this.onRegisterViewerAck],[ue.a.EventType.FILE_LIST_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.REGION_LIST_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.CATALOG_LIST_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.FILE_INFO_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.REGION_FILE_INFO_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.CATALOG_FILE_INFO_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.OPEN_FILE_ACK,this.onSimpleMappedResponse],[ue.a.EventType.SAVE_FILE_ACK,this.onSimpleMappedResponse],[ue.a.EventType.OPEN_CATALOG_FILE_ACK,this.onSimpleMappedResponse],[ue.a.EventType.IMPORT_REGION_ACK,this.onSimpleMappedResponse],[ue.a.EventType.EXPORT_REGION_ACK,this.onSimpleMappedResponse],[ue.a.EventType.SET_REGION_ACK,this.onSimpleMappedResponse],[ue.a.EventType.RESUME_SESSION_ACK,this.onSimpleMappedResponse],[ue.a.EventType.START_ANIMATION_ACK,this.onStartAnimationAck],[ue.a.EventType.RASTER_TILE_DATA,this.onStreamedRasterTileData],[ue.a.EventType.REGION_HISTOGRAM_DATA,this.onStreamedRegionHistogramData],[ue.a.EventType.ERROR_DATA,this.onStreamedErrorData],[ue.a.EventType.SPATIAL_PROFILE_DATA,this.onStreamedSpatialProfileData],[ue.a.EventType.SPECTRAL_PROFILE_DATA,this.onStreamedSpectralProfileData],[ue.a.EventType.REGION_STATS_DATA,this.onStreamedRegionStatsData],[ue.a.EventType.CONTOUR_IMAGE_DATA,this.onStreamedContourData],[ue.a.EventType.CATALOG_FILTER_RESPONSE,this.onStreamedCatalogData],[ue.a.EventType.RASTER_TILE_SYNC,this.onStreamedRasterSync],[ue.a.EventType.MOMENT_PROGRESS,this.onStreamedMomentProgress],[ue.a.EventType.MOMENT_RESPONSE,this.onSimpleMappedResponse],[ue.a.EventType.SCRIPTING_REQUEST,this.onScriptingRequest],[ue.a.EventType.SPECTRAL_LINE_RESPONSE,this.onSimpleMappedResponse]]),this.decoderMap=new Map([[ue.a.EventType.REGISTER_VIEWER_ACK,ue.a.RegisterViewerAck],[ue.a.EventType.FILE_LIST_RESPONSE,ue.a.FileListResponse],[ue.a.EventType.REGION_LIST_RESPONSE,ue.a.RegionListResponse],[ue.a.EventType.CATALOG_LIST_RESPONSE,ue.a.CatalogListResponse],[ue.a.EventType.FILE_INFO_RESPONSE,ue.a.FileInfoResponse],[ue.a.EventType.REGION_FILE_INFO_RESPONSE,ue.a.RegionFileInfoResponse],[ue.a.EventType.CATALOG_FILE_INFO_RESPONSE,ue.a.CatalogFileInfoResponse],[ue.a.EventType.OPEN_FILE_ACK,ue.a.OpenFileAck],[ue.a.EventType.SAVE_FILE_ACK,ue.a.SaveFileAck],[ue.a.EventType.OPEN_CATALOG_FILE_ACK,ue.a.OpenCatalogFileAck],[ue.a.EventType.IMPORT_REGION_ACK,ue.a.ImportRegionAck],[ue.a.EventType.EXPORT_REGION_ACK,ue.a.ExportRegionAck],[ue.a.EventType.SET_REGION_ACK,ue.a.SetRegionAck],[ue.a.EventType.RESUME_SESSION_ACK,ue.a.ResumeSessionAck],[ue.a.EventType.START_ANIMATION_ACK,ue.a.StartAnimationAck],[ue.a.EventType.RASTER_TILE_DATA,ue.a.RasterTileData],[ue.a.EventType.REGION_HISTOGRAM_DATA,ue.a.RegionHistogramData],[ue.a.EventType.ERROR_DATA,ue.a.ErrorData],[ue.a.EventType.SPATIAL_PROFILE_DATA,ue.a.SpatialProfileData],[ue.a.EventType.SPECTRAL_PROFILE_DATA,ue.a.SpectralProfileData],[ue.a.EventType.REGION_STATS_DATA,ue.a.RegionStatsData],[ue.a.EventType.CONTOUR_IMAGE_DATA,ue.a.ContourImageData],[ue.a.EventType.CATALOG_FILTER_RESPONSE,ue.a.CatalogFilterResponse],[ue.a.EventType.RASTER_TILE_SYNC,ue.a.RasterTileSync],[ue.a.EventType.MOMENT_PROGRESS,ue.a.MomentProgress],[ue.a.EventType.MOMENT_RESPONSE,ue.a.MomentResponse],[ue.a.EventType.SCRIPTING_REQUEST,ue.a.ScriptingRequest],[ue.a.EventType.SPECTRAL_LINE_RESPONSE,ue.a.SpectralLineResponse]]),setInterval(this.sendPing,5e3)}connect(t,i=!0){this.connection&&(this.connection.onclose=null,this.connection.close());const n=O.Instance;return this.autoReconnect=i,this.connectionDropped=!1,this.connectionStatus=fe.PENDING,this.serverUrl=t,this.connection=new WebSocket(n.accessToken?t+"?token="+n.accessToken:t),this.connection.binaryType="arraybuffer",this.connection.onmessage=this.messageHandler.bind(this),this.connection.onclose=e=>Object(m.r)(()=>{this.connectionStatus===fe.ACTIVE&&(this.connectionStatus=fe.CLOSED),!e.wasClean&&this.autoReconnect&&setTimeout(()=>{const e=new WebSocket(n.accessToken?t+"?token="+n.accessToken:t);e.binaryType="arraybuffer",e.onopen=this.connection.onopen,e.onerror=this.connection.onerror,e.onclose=this.connection.onclose,e.onmessage=this.connection.onmessage,this.connection=e},1e3)}),new de.a(i=>{this.connection.onopen=Object(m.g)(()=>{this.connectionStatus===fe.CLOSED&&(this.connectionDropped=!0),this.connectionStatus=fe.ACTIVE,this.autoReconnect=!0;const t=ue.a.RegisterViewer.create({sessionId:this.sessionId,clientFeatureFlags:e.DefaultFeatureFlags});this.observerRequestMap.clear(),this.eventCounter=1;const n=this.eventCounter;this.logEvent(ue.a.EventType.REGISTER_VIEWER,n,t,!1),this.sendEvent(ue.a.EventType.REGISTER_VIEWER,ue.a.RegisterViewer.encode(t).finish())&&this.observerRequestMap.set(n,i)}),this.connection.onerror=e=>{ge.e.Instance.logStore.addInfo(`Connecting to server ${t} failed. Retrying...`,["network"]),console.log(e)}})}getFileList(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=ue.a.FileListRequest.create({directory:e}),i=this.eventCounter;return this.logEvent(ue.a.EventType.FILE_LIST_REQUEST,i,t,!1),this.sendEvent(ue.a.EventType.FILE_LIST_REQUEST,ue.a.FileListRequest.encode(t).finish())?new de.a(e=>{this.observerRequestMap.set(i,e)}):Object(he.a)(new Error("Could not send event"))}}getRegionList(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=ue.a.RegionListRequest.create({directory:e}),i=this.eventCounter;return this.logEvent(ue.a.EventType.REGION_LIST_REQUEST,i,t,!1),this.sendEvent(ue.a.EventType.REGION_LIST_REQUEST,ue.a.RegionListRequest.encode(t).finish())?new de.a(e=>{this.observerRequestMap.set(i,e)}):Object(he.a)(new Error("Could not send event"))}}getCatalogList(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=ue.a.CatalogListRequest.create({directory:e}),i=this.eventCounter;return this.logEvent(ue.a.EventType.CATALOG_LIST_REQUEST,i,t,!1),this.sendEvent(ue.a.EventType.CATALOG_LIST_REQUEST,ue.a.CatalogListRequest.encode(t).finish())?new de.a(e=>{this.observerRequestMap.set(i,e)}):Object(he.a)(new Error("Could not send event"))}}getFileInfo(e,t,i){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const n=ue.a.FileInfoRequest.create({directory:e,file:t,hdu:i}),r=this.eventCounter;return this.logEvent(ue.a.EventType.FILE_INFO_REQUEST,r,n,!1),this.sendEvent(ue.a.EventType.FILE_INFO_REQUEST,ue.a.FileInfoRequest.encode(n).finish())?new de.a(e=>{this.observerRequestMap.set(r,e)}):Object(he.a)(new Error("Could not send event"))}}getRegionFileInfo(e,t){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const i=ue.a.RegionFileInfoRequest.create({directory:e,file:t}),n=this.eventCounter;return this.logEvent(ue.a.EventType.REGION_FILE_INFO_REQUEST,n,i,!1),this.sendEvent(ue.a.EventType.REGION_FILE_INFO_REQUEST,ue.a.RegionFileInfoRequest.encode(i).finish())?new de.a(e=>{this.observerRequestMap.set(n,e)}):Object(he.a)(new Error("Could not send event"))}}getCatalogFileInfo(e,t){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const i=ue.a.CatalogFileInfoRequest.create({directory:e,name:t}),n=this.eventCounter;return this.logEvent(ue.a.EventType.CATALOG_FILE_INFO_REQUEST,n,i,!1),this.sendEvent(ue.a.EventType.CATALOG_FILE_INFO_REQUEST,ue.a.CatalogFileInfoRequest.encode(i).finish())?new de.a(e=>{this.observerRequestMap.set(n,e)}):Object(he.a)(new Error("Could not send event"))}}importRegion(e,t,i,n){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const r=ue.a.ImportRegion.create({directory:e,file:t,type:i,groupId:n}),o=this.eventCounter;return this.logEvent(ue.a.EventType.IMPORT_REGION,o,r,!1),this.sendEvent(ue.a.EventType.IMPORT_REGION,ue.a.ImportRegion.encode(r).finish())?new de.a(e=>{this.observerRequestMap.set(o,e)}):Object(he.a)(new Error("Could not send event"))}}exportRegion(e,t,i,n,r,o){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const a=ue.a.ExportRegion.create({directory:e,file:t,type:i,fileId:r,regionStyles:Object(me.P)(o),coordType:n}),s=this.eventCounter;return this.logEvent(ue.a.EventType.EXPORT_REGION,s,a,!1),this.sendEvent(ue.a.EventType.EXPORT_REGION,ue.a.ExportRegion.encode(a).finish())?new de.a(e=>{this.observerRequestMap.set(s,e)}):Object(he.a)(new Error("Could not send event"))}}loadFile(e,t,i,n,r){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const o=ue.a.OpenFile.create({directory:e,file:t,hdu:i,fileId:n,renderMode:r}),a=this.eventCounter;return this.logEvent(ue.a.EventType.OPEN_FILE,a,o,!1),this.sendEvent(ue.a.EventType.OPEN_FILE,ue.a.OpenFile.encode(o).finish())?new de.a(e=>{this.observerRequestMap.set(a,e)}):Object(he.a)(new Error("Could not send event"))}}loadCatalogFile(e,t,i,n){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const r=ue.a.OpenCatalogFile.create({directory:e,name:t,fileId:i,previewDataSize:n}),o=this.eventCounter;return this.logEvent(ue.a.EventType.OPEN_CATALOG_FILE,o,r,!1),this.sendEvent(ue.a.EventType.OPEN_CATALOG_FILE,ue.a.OpenCatalogFile.encode(r).finish())?new de.a(e=>{this.observerRequestMap.set(o,e)}):Object(he.a)(new Error("Could not send event"))}}closeCatalogFile(e){if(this.connectionStatus===fe.ACTIVE){const t=ue.a.CloseCatalogFile.create({fileId:e});if(this.logEvent(ue.a.EventType.CLOSE_CATALOG_FILE,this.eventCounter,t,!1),this.sendEvent(ue.a.EventType.CLOSE_CATALOG_FILE,ue.a.CloseCatalogFile.encode(t).finish()))return!0}return!1}saveFile(e,t,i,n){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const r=ue.a.SaveFile.create({fileId:e,outputFileDirectory:t,outputFileName:i,outputFileType:n}),o=this.eventCounter;return this.logEvent(ue.a.EventType.SAVE_FILE,this.eventCounter,r,!1),this.sendEvent(ue.a.EventType.SAVE_FILE,ue.a.SaveFile.encode(r).finish())?new de.a(e=>{this.observerRequestMap.set(o,e)}):Object(he.a)(new Error("Could not send event"))}}closeFile(e){if(this.connectionStatus===fe.ACTIVE){const t=ue.a.CloseFile.create({fileId:e});if(this.logEvent(ue.a.EventType.CLOSE_FILE,this.eventCounter,t,!1),this.sendEvent(ue.a.EventType.CLOSE_FILE,ue.a.CloseFile.encode(t).finish()))return!0}return!1}setChannels(e,t,i,n){if(this.connectionStatus===fe.ACTIVE){const r=ue.a.SetImageChannels.create({fileId:e,channel:t,stokes:i,requiredTiles:n});if(this.logEvent(ue.a.EventType.SET_IMAGE_CHANNELS,this.eventCounter,r,!1),this.sendEvent(ue.a.EventType.SET_IMAGE_CHANNELS,ue.a.SetImageChannels.encode(r).finish()))return!0}return!1}setCursor(e,t,i){if(this.connectionStatus===fe.ACTIVE){const n=ue.a.SetCursor.create({fileId:e,point:{x:t,y:i}});if(this.logEvent(ue.a.EventType.SET_CURSOR,this.eventCounter,n,!1),this.sendEvent(ue.a.EventType.SET_CURSOR,ue.a.SetCursor.encode(n).finish()))return!0}return!1}setRegion(e,t,i){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const n=ue.a.SetRegion.create({fileId:e,regionId:t,regionInfo:{regionType:i.regionType,rotation:i.rotation,controlPoints:i.controlPoints.slice()}}),r=this.eventCounter;return this.logEvent(ue.a.EventType.SET_REGION,r,n,!1),this.sendEvent(ue.a.EventType.SET_REGION,ue.a.SetRegion.encode(n).finish())?new de.a(e=>{this.observerRequestMap.set(r,e)}):Object(he.a)(new Error("Could not send event"))}}removeRegion(e){if(this.connectionStatus===fe.ACTIVE){const t=ue.a.RemoveRegion.create({regionId:e});if(this.logEvent(ue.a.EventType.REMOVE_REGION,this.eventCounter,t,!1),this.sendEvent(ue.a.EventType.REMOVE_REGION,ue.a.RemoveRegion.encode(t).finish()))return!0}return!1}setCatalogFilterRequest(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.CATALOG_FILTER_REQUEST,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.CATALOG_FILTER_REQUEST,ue.a.CatalogFilterRequest.encode(e).finish())))}setSpatialRequirements(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.SET_SPATIAL_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.SET_SPATIAL_REQUIREMENTS,ue.a.SetSpatialRequirements.encode(e).finish())))}setSpectralRequirements(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.SET_SPECTRAL_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.SET_SPECTRAL_REQUIREMENTS,ue.a.SetSpectralRequirements.encode(e).finish())))}setStatsRequirements(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.SET_STATS_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.SET_STATS_REQUIREMENTS,ue.a.SetStatsRequirements.encode(e).finish())))}setHistogramRequirements(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.SET_HISTOGRAM_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.SET_HISTOGRAM_REQUIREMENTS,ue.a.SetHistogramRequirements.encode(e).finish())))}addRequiredTiles(e,t,i){if(this.connectionStatus===fe.ACTIVE){const n=ue.a.AddRequiredTiles.create({fileId:e,tiles:t,compressionQuality:i,compressionType:ue.a.CompressionType.ZFP});if(this.logEvent(ue.a.EventType.ADD_REQUIRED_TILES,this.eventCounter,n,!1),this.sendEvent(ue.a.EventType.ADD_REQUIRED_TILES,ue.a.AddRequiredTiles.encode(n).finish()))return!0}return!1}removeRequiredTiles(e,t){if(this.connectionStatus===fe.ACTIVE){const i=ue.a.RemoveRequiredTiles.create({fileId:e,tiles:t});if(this.logEvent(ue.a.EventType.REMOVE_REQUIRED_TILES,this.eventCounter,i,!1),this.sendEvent(ue.a.EventType.REMOVE_REQUIRED_TILES,ue.a.RemoveRequiredTiles.encode(i).finish()))return!0}return!1}startAnimation(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=this.eventCounter;return this.logEvent(ue.a.EventType.START_ANIMATION,t,e,!1),this.sendEvent(ue.a.EventType.START_ANIMATION,ue.a.StartAnimation.encode(e).finish())?new de.a(e=>{this.observerRequestMap.set(t,e)}):Object(he.a)(new Error("Could not send event"))}}stopAnimation(e){return this.animationId=-1,!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.STOP_ANIMATION,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.STOP_ANIMATION,ue.a.StopAnimation.encode(e).finish())))}sendAnimationFlowControl(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.ANIMATION_FLOW_CONTROL,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.ANIMATION_FLOW_CONTROL,ue.a.AnimationFlowControl.encode(e).finish())))}setContourParameters(e){return!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.SET_CONTOUR_PARAMETERS,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.SET_CONTOUR_PARAMETERS,ue.a.SetContourParameters.encode(e).finish())))}resumeSession(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=this.eventCounter;return this.logEvent(ue.a.EventType.RESUME_SESSION,t,e,!1),this.sendEvent(ue.a.EventType.RESUME_SESSION,ue.a.ResumeSession.encode(e).finish())?new de.a(e=>{this.observerRequestMap.set(t,e)}):Object(he.a)(new Error("Could not send event"))}}requestMoment(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=this.eventCounter;return this.logEvent(ue.a.EventType.MOMENT_REQUEST,t,e,!1),this.sendEvent(ue.a.EventType.MOMENT_REQUEST,ue.a.MomentRequest.encode(e).finish())?new de.a(e=>{this.observerRequestMap.set(t,e)}):Object(he.a)(new Error("Could not send event"))}}cancelRequestingMoment(e){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const t=ue.a.StopMomentCalc.create({fileId:e});return this.logEvent(ue.a.EventType.STOP_MOMENT_CALC,this.eventCounter,t,!1),!!this.sendEvent(ue.a.EventType.STOP_MOMENT_CALC,ue.a.StopMomentCalc.encode(t).finish())||Object(he.a)(new Error("Could not send event"))}}requestSpectralLine(e,t){if(this.connectionStatus!==fe.ACTIVE)return Object(he.a)(new Error("Not connected"));{const i=ue.a.SpectralLineRequest.create({frequencyRange:e,lineIntensityLowerLimit:t}),n=this.eventCounter;return this.logEvent(ue.a.EventType.SPECTRAL_LINE_REQUEST,n,i,!1),this.sendEvent(ue.a.EventType.SPECTRAL_LINE_REQUEST,ue.a.SpectralLineRequest.encode(i).finish())?new de.a(e=>{this.observerRequestMap.set(n,e)}):Object(he.a)(new Error("Could not send event"))}}serverHasFeature(e){return 0!==(this.serverFeatureFlags&e)}messageHandler(t){if("PONG"===t.data)return this.lastPongTime=performance.now(),void this.updateEndToEndPing();if(t.data.byteLength<8)return void console.log("Unknown event format");const i=new Uint16Array(t.data,0,2),n=new Uint32Array(t.data,4,1),r=new Uint8Array(t.data,8),o=i[0],a=i[1],s=n[0];a!==e.IcdVersion&&console.warn(`Server event has ICD version ${a}, which differs from frontend version ${e.IcdVersion}. Errors may occur`);try{const e=this.decoderMap.get(o);if(e){const t=e.decode(r);if(t){this.logEvent(o,s,t);const e=this.handlerMap.get(o);e?e.call(this,s,t):console.log("Missing handler for event response "+o)}else console.log("Unsupported event response "+o)}}catch(l){console.log(l)}}onSimpleMappedResponse(e,t){const i=this.observerRequestMap.get(e);i?(t.success?i.next(t):i.error(t.message),i.complete(),this.observerRequestMap.delete(e)):console.log("Can't find observable for request "+e)}onRegisterViewerAck(e,t){this.sessionId=t.sessionId,this.serverFeatureFlags=t.serverFeatureFlags,this.grpcPort=t.grpcPort,this.onSimpleMappedResponse(e,t),t.success&&t.sessionType===ue.a.SessionType.RESUMED&&this.reconnectStream.next()}onStartAnimationAck(e,t){this.animationId=t.success?t.animationId:-1,this.onSimpleMappedResponse(e,t)}onStreamedRasterTileData(e,t){this.rasterTileStream.next(t)}onStreamedRasterSync(e,t){this.rasterSyncStream.next(t)}onStreamedRegionHistogramData(e,t){this.histogramStream.next(t)}onStreamedErrorData(e,t){this.errorStream.next(t)}onStreamedSpatialProfileData(e,t){this.spatialProfileStream.next(t)}onStreamedSpectralProfileData(e,t){this.spectralProfileStream.next(t)}onStreamedRegionStatsData(e,t){this.statsStream.next(t)}onStreamedContourData(e,t){this.contourStream.next(t)}onScriptingRequest(e,t){this.scriptingStream.next(t)}onStreamedCatalogData(e,t){this.catalogStream.next(t)}onStreamedMomentProgress(e,t){this.momentProgressStream.next(t)}sendEvent(t,i){if(this.connection.readyState===WebSocket.OPEN){const n=new Uint8Array(8+i.byteLength),r=new Uint16Array(n.buffer,0,2),o=new Uint32Array(n.buffer,4,1);return r[0]=t,r[1]=e.IcdVersion,o[0]=this.eventCounter,n.set(i,8),this.connection.send(n),this.eventCounter++,!0}return console.log("Error sending event"),this.eventCounter++,!1}logEvent(e,t,i,n=!0){const r=ue.a.EventType[e];this.loggingEnabled&&ge.H.Instance.isEventLoggingEnabled(e)&&(n?0===t?console.log(`<== ${r} [Stream]`):console.log(`<== ${r} [${t}]`):console.log(`${r} [${t}] ==>`),console.log(i),console.log("\n"))}},le.staticInstance=void 0,le.IcdVersion=19,le.DefaultFeatureFlags=ue.a.ClientFeatureFlags.WEB_ASSEMBLY|ue.a.ClientFeatureFlags.WEB_GL,te=ce,ie=Object(u.a)(te.prototype,"connectionStatus",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(u.a)(te.prototype,"connectionDropped",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(u.a)(te.prototype,"endToEndPing",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(u.a)(te.prototype,"connect",[S],Object.getOwnPropertyDescriptor(te.prototype,"connect"),te.prototype),oe=Object(u.a)(te.prototype,"updateEndToEndPing",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.endToEndPing=this.lastPongTime-this.lastPingTime}}}),Object(u.a)(te.prototype,"getFileList",[C],Object.getOwnPropertyDescriptor(te.prototype,"getFileList"),te.prototype),Object(u.a)(te.prototype,"getRegionList",[E],Object.getOwnPropertyDescriptor(te.prototype,"getRegionList"),te.prototype),Object(u.a)(te.prototype,"getCatalogList",[I],Object.getOwnPropertyDescriptor(te.prototype,"getCatalogList"),te.prototype),Object(u.a)(te.prototype,"getFileInfo",[w],Object.getOwnPropertyDescriptor(te.prototype,"getFileInfo"),te.prototype),Object(u.a)(te.prototype,"getRegionFileInfo",[T],Object.getOwnPropertyDescriptor(te.prototype,"getRegionFileInfo"),te.prototype),Object(u.a)(te.prototype,"getCatalogFileInfo",[v],Object.getOwnPropertyDescriptor(te.prototype,"getCatalogFileInfo"),te.prototype),Object(u.a)(te.prototype,"importRegion",[A],Object.getOwnPropertyDescriptor(te.prototype,"importRegion"),te.prototype),Object(u.a)(te.prototype,"exportRegion",[x],Object.getOwnPropertyDescriptor(te.prototype,"exportRegion"),te.prototype),Object(u.a)(te.prototype,"loadFile",[R],Object.getOwnPropertyDescriptor(te.prototype,"loadFile"),te.prototype),Object(u.a)(te.prototype,"loadCatalogFile",[P],Object.getOwnPropertyDescriptor(te.prototype,"loadCatalogFile"),te.prototype),Object(u.a)(te.prototype,"closeCatalogFile",[j],Object.getOwnPropertyDescriptor(te.prototype,"closeCatalogFile"),te.prototype),Object(u.a)(te.prototype,"saveFile",[k],Object.getOwnPropertyDescriptor(te.prototype,"saveFile"),te.prototype),Object(u.a)(te.prototype,"closeFile",[F],Object.getOwnPropertyDescriptor(te.prototype,"closeFile"),te.prototype),Object(u.a)(te.prototype,"setChannels",[M],Object.getOwnPropertyDescriptor(te.prototype,"setChannels"),te.prototype),Object(u.a)(te.prototype,"setCursor",[D],Object.getOwnPropertyDescriptor(te.prototype,"setCursor"),te.prototype),Object(u.a)(te.prototype,"setRegion",[N],Object.getOwnPropertyDescriptor(te.prototype,"setRegion"),te.prototype),Object(u.a)(te.prototype,"removeRegion",[L],Object.getOwnPropertyDescriptor(te.prototype,"removeRegion"),te.prototype),Object(u.a)(te.prototype,"setCatalogFilterRequest",[_],Object.getOwnPropertyDescriptor(te.prototype,"setCatalogFilterRequest"),te.prototype),Object(u.a)(te.prototype,"setSpatialRequirements",[z],Object.getOwnPropertyDescriptor(te.prototype,"setSpatialRequirements"),te.prototype),Object(u.a)(te.prototype,"setSpectralRequirements",[W],Object.getOwnPropertyDescriptor(te.prototype,"setSpectralRequirements"),te.prototype),Object(u.a)(te.prototype,"setStatsRequirements",[G],Object.getOwnPropertyDescriptor(te.prototype,"setStatsRequirements"),te.prototype),Object(u.a)(te.prototype,"setHistogramRequirements",[V],Object.getOwnPropertyDescriptor(te.prototype,"setHistogramRequirements"),te.prototype),Object(u.a)(te.prototype,"addRequiredTiles",[B],Object.getOwnPropertyDescriptor(te.prototype,"addRequiredTiles"),te.prototype),Object(u.a)(te.prototype,"removeRequiredTiles",[q],Object.getOwnPropertyDescriptor(te.prototype,"removeRequiredTiles"),te.prototype),Object(u.a)(te.prototype,"startAnimation",[H],Object.getOwnPropertyDescriptor(te.prototype,"startAnimation"),te.prototype),Object(u.a)(te.prototype,"stopAnimation",[U],Object.getOwnPropertyDescriptor(te.prototype,"stopAnimation"),te.prototype),Object(u.a)(te.prototype,"sendAnimationFlowControl",[Y],Object.getOwnPropertyDescriptor(te.prototype,"sendAnimationFlowControl"),te.prototype),Object(u.a)(te.prototype,"setContourParameters",[X],Object.getOwnPropertyDescriptor(te.prototype,"setContourParameters"),te.prototype),Object(u.a)(te.prototype,"resumeSession",[K],Object.getOwnPropertyDescriptor(te.prototype,"resumeSession"),te.prototype),ae=Object(u.a)(te.prototype,"setAuthToken",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{document.cookie=`CARTA-Authorization=${e}; path=/`}}}),Object(u.a)(te.prototype,"requestMoment",[Z],Object.getOwnPropertyDescriptor(te.prototype,"requestMoment"),te.prototype),Object(u.a)(te.prototype,"cancelRequestingMoment",[$],Object.getOwnPropertyDescriptor(te.prototype,"cancelRequestingMoment"),te.prototype),Object(u.a)(te.prototype,"requestSpectralLine",[J],Object.getOwnPropertyDescriptor(te.prototype,"requestSpectralLine"),te.prototype),se=Object(u.a)(te.prototype,"sendScriptingResponse",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>!(this.connectionStatus!==fe.ACTIVE||(this.logEvent(ue.a.EventType.SCRIPTING_RESPONSE,this.eventCounter,e,!1),!this.sendEvent(ue.a.EventType.SCRIPTING_RESPONSE,ue.a.ScriptingResponse.encode(e).finish())))}}),te);var be,Oe,Se,Ce,Ee,Ie,we=i(271),Te=i.n(we),ve=function(){return new Worker(i.p+"static/js/index.a9e7f237.worker.js")};const Ae=256;let xe=(Ie=Ee=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get zfpReady(){return this.workersReady&&this.workersReady.every(e=>e)}GetTileStream(){return this.tileStream}constructor(){this.backendService=void 0,this.persistentTiles=void 0,this.cacheMapCompressedTiles=void 0,this.pendingRequests=void 0,this.pendingDecompressions=void 0,this.channelMap=void 0,this.completedChannels=void 0,this.currentFileId=void 0,this.tileStream=void 0,this.cachedTiles=void 0,this.lruCapacitySystem=void 0,this.textureArray=void 0,this.textureCoordinateQueue=void 0,this.workers=void 0,this.compressionRequestCounter=void 0,this.pendingSynchronisedTiles=void 0,this.receivedSynchronisedTiles=void 0,this.animationEnabled=void 0,this.gl=void 0,Object(c.a)(this,"remainingTiles",Oe,this),Object(c.a)(this,"workersReady",Se,this),this.setAnimationEnabled=e=>{this.animationEnabled=e},this.setCache=(e,t)=>{const i=e+85,n=16777216/(Ae*Ae),r=Math.min(Math.ceil(i/n),8);e=r*n-85,console.log("lruGPU capacity rounded to : "+e),this.textureArray=new Array(r),this.initTextures(),this.resetCoordinateQueue(),this.cachedTiles=new Te.a(Int32Array,null,e),this.lruCapacitySystem=t},Object(c.a)(this,"updateRemainingTileCount",Ce,this),this.clearTile=(e,t)=>{e.data&&delete e.data,this.textureCoordinateQueue.push(e.textureCoordinate)},this.handleStreamSync=e=>{const t=`${e.fileId}_${e.stokes}_${e.channel}`;this.animationEnabled&&e.animationId!==this.backendService.animationId||(this.animationEnabled||0===e.animationId)&&(e.endSync?this.completedChannels.set(t,!0):(this.completedChannels.delete(t),this.pendingDecompressions.set(t,new Map)))},this.handleStreamedTiles=e=>{const t=`${e.fileId}_${e.stokes}_${e.channel}`;e.compressionType!==ue.a.CompressionType.NONE&&e.compressionType!==ue.a.CompressionType.ZFP&&console.error("Unsupported compression type");const i=this.channelMap.get(e.fileId);if(this.currentFileId!==e.fileId||!this.animationEnabled&&(!i||i.channel!==e.channel||i.stokes!==e.stokes))return void console.log(`Ignoring stale tile for channel=${e.channel} (Current channel=${i?i.channel:void 0})`);if(this.animationEnabled&&e.animationId!==this.backendService.animationId)return void console.log(`Skipping stale tile during animation Message animation_id: ${e.animationId}. Service animation_id: ${this.backendService.animationId}`);if(!this.animationEnabled&&0!==e.animationId)return void console.log(`Skipping stale animation tile outside of animation. Message animation_id: ${e.animationId}. Service animation_id: ${this.backendService.animationId}`);if(this.pendingDecompressions.get(t)){this.animationEnabled&&this.channelMap.set(e.fileId,{channel:e.channel,stokes:e.stokes});for(let t of e.tiles){const i=y.TileCoordinate.Encode(t.x,t.y,t.layer);if(this.pendingRequests.has(i)||this.animationEnabled)if(this.pendingRequests.delete(i),this.updateRemainingTileCount(),e.compressionType===ue.a.CompressionType.NONE){const n=new Float32Array(t.imageData.buffer.slice(t.imageData.byteOffset,t.imageData.byteOffset+t.imageData.byteLength));this.updateStream(e.fileId,e.channel,e.stokes,n,t.width,t.height,t.layer,i)}else this.getCompressedCache(e.fileId).set(i,{tile:t,compressionQuality:e.compressionQuality}),this.asyncDecompressTile(e.fileId,e.channel,e.stokes,t,e.compressionQuality,i)}}else console.log("Missing compression map for key="+t)},Object(m.p)(this),this.backendService=ye.Instance,this.gl=je.Instance.gl,this.channelMap=new Map,this.persistentTiles=new Map,this.pendingRequests=new Map,this.cacheMapCompressedTiles=new Map,this.pendingDecompressions=new Map,this.completedChannels=new Map,this.compressionRequestCounter=0,this.remainingTiles=0,this.animationEnabled=!1,this.tileStream=new pe.a,this.backendService.rasterTileStream.subscribe(this.handleStreamedTiles),this.backendService.rasterSyncStream.subscribe(this.handleStreamSync),this.workers=new Array(Math.min(navigator.hardwareConcurrency||4,4)),this.workersReady=new Array(this.workers.length);for(let e=0;e<this.workers.length;e++)this.workers[e]=new ve,this.workers[e].onmessage=t=>{if("ready"===t.data[0])this.workersReady[e]=!0,console.log(`Tile Worker ${e} ready`);else if("decompress"===t.data[0]){const e=t.data[1],i=t.data[2],n=i.width*i.subsetHeight,r=new Float32Array(e,0,n);this.updateStream(i.fileId,i.channel,i.stokes,r,i.width,i.subsetHeight,i.layer,i.tileCoordinate)}}}resetCoordinateQueue(){const e=16777216/(Ae*Ae),t=this.textureArray.length*e;this.textureCoordinateQueue=new Array(t);for(let i=0;i<t;i++)this.textureCoordinateQueue[i]=t-1-i}getCompressedCache(e){const t=this.cacheMapCompressedTiles.get(e);if(t)return t;{const t=new Te.a(Int32Array,null,this.lruCapacitySystem);return this.cacheMapCompressedTiles.set(e,t),t}}getTile(e,t,i,n,r=!1){return y.TileCoordinate.GetLayer(e)<4?this.persistentTiles.get(e):r?this.cachedTiles.peek(e):this.cachedTiles.get(e)}requestTiles(e,t,i,n,r,o,a=!1){let s=this.currentFileId!==t;s&&(this.currentFileId=t,this.pendingSynchronisedTiles=e.map(e=>e.encode()),this.receivedSynchronisedTiles=[],this.clearRequestQueue()),!a&&this.channelMap.has(t)||(this.pendingSynchronisedTiles=e.map(e=>e.encode()),this.receivedSynchronisedTiles=[],this.clearRequestQueue(),this.channelMap.set(t,{channel:i,stokes:n}),this.clearCompressedCache(t));const l=`${t}_${n}_${i}`,c=new Array;for(const u of e){if(u.layer<0)continue;const e=u.encode();if(!(!(a||s)&&(u.layer<4&&this.persistentTiles.has(e)||u.layer>=4&&this.cachedTiles.has(e)))&&!this.pendingRequests.has(e)){const r=!a&&this.getCompressedCache(t).get(e),o=this.pendingDecompressions.get(l),s=o&&o.has(e);r&&!s?(o||this.pendingDecompressions.set(l,new Map),this.asyncDecompressTile(t,i,n,r.tile,r.compressionQuality,e)):r||(this.pendingRequests.set(e,!0),this.updateRemainingTileCount(),c.push(u))}}if(c.length){const e=c.sort((e,t)=>{const i=r.x-e.x,n=r.y-e.y,o=r.x-t.x,a=r.y-t.y;return i*i+n*n-(o*o+a*a)}).map(e=>e.encode());a?this.backendService.setChannels(t,i,n,{fileId:t,compressionQuality:o,compressionType:ue.a.CompressionType.ZFP,tiles:e}):this.backendService.addRequiredTiles(t,e,o)}else this.completedChannels.set(l,!0)}updateInactiveFileChannel(e,t,i){this.clearCompressedCache(e),this.channelMap.set(e,{channel:t,stokes:i}),this.backendService.setChannels(e,t,i,{})}clearGPUCache(){this.cachedTiles.forEach(this.clearTile),this.cachedTiles.clear(),this.persistentTiles.forEach(this.clearTile),this.persistentTiles.clear()}clearCompressedCache(e){-1===e?this.cacheMapCompressedTiles.clear():this.cacheMapCompressedTiles.delete(e)}clearRequestQueue(){this.pendingRequests.clear(),this.updateRemainingTileCount()}handleFileClosed(e){this.clearCompressedCache(e),this.channelMap.delete(e);const t=""+e;this.completedChannels.forEach((e,i)=>{i.startsWith(t)&&this.completedChannels.delete(i)}),this.pendingDecompressions.forEach((e,i)=>{i.startsWith(t)&&this.pendingDecompressions.delete(i)})}initTextures(){console.log(`Creating ${this.textureArray.length} tile textures of size 64 MB each (${64*this.textureArray.length} MB total)`);for(let e=0;e<this.textureArray.length;e++)this.textureArray[e]=Object(me.p)(this.gl,4096,4096,WebGLRenderingContext.TEXTURE0)}uploadTileToGPU(e){const t=16777216/(Ae*Ae),i=e.textureCoordinate%t,n=Math.floor((e.textureCoordinate-i)/t),r=4096/Ae,o=i%r*Ae,a=Math.floor(i/r)*Ae;Object(me.o)(this.gl,this.textureArray[n],e.data,WebGLRenderingContext.TEXTURE0,e.width,e.height,o,a)}getTileTextureParameters(e){const t=16777216/(Ae*Ae),i=e.textureCoordinate%t,n=Math.floor((e.textureCoordinate-i)/t),r=4096/Ae,o=i%r*Ae,a=Math.floor(i/r)*Ae;return{texture:this.textureArray[n],offset:{x:o,y:a}}}asyncDecompressTile(e,t,i,n,r,o){const a=n.imageData,s=this.compressionRequestCounter%this.workers.length,l=new Int32Array(n.nanEncodings.slice(0).buffer);let c=new Uint8Array(n.width*n.height*4);c.set(a);const u=`${e}_${i}_${t}`,p=this.pendingDecompressions.get(u);p?(p.set(o,!0),this.workers[s].postMessage(["decompress",c.buffer,{fileId:e,channel:t,stokes:i,width:n.width,subsetHeight:n.height,subsetLength:a.byteLength,compression:r,nanEncodings:l,tileCoordinate:o,layer:n.layer,requestId:this.compressionRequestCounter}],[c.buffer,l.buffer]),this.compressionRequestCounter++):console.log("Problem decompressing tile!")}updateStream(e,t,i,n,r,o,a,s){var l;const c=`${e}_${i}_${t}`,u=this.pendingDecompressions.get(c);if(u)if(this.animationEnabled||(null===(l=this.pendingSynchronisedTiles)||void 0===l?void 0:l.length)){this.pendingSynchronisedTiles=this.pendingSynchronisedTiles.filter(e=>e!==s);const l={width:r,height:o,textureCoordinate:-1,data:n};if(this.receivedSynchronisedTiles||(this.receivedSynchronisedTiles=[]),this.receivedSynchronisedTiles.push({coordinate:s,tile:l}),u.delete(s),!u.size&&this.completedChannels.get(c)){this.completedChannels.delete(c),this.pendingDecompressions.delete(c);const n=this.receivedSynchronisedTiles.length;this.clearGPUCache(),this.animationEnabled&&this.clearCompressedCache(e),this.resetCoordinateQueue();for(const e of this.receivedSynchronisedTiles)if(e.tile.textureCoordinate=this.textureCoordinateQueue.pop(),a<4)this.persistentTiles.set(e.coordinate,e.tile);else{const t=this.cachedTiles.setpop(e.coordinate,e.tile);t&&this.clearTile(t.value,t.key)}this.receivedSynchronisedTiles=[],this.tileStream.next({tileCount:n,fileId:e,channel:t,stokes:i,flush:!0})}}else{const l={width:r,height:o,textureCoordinate:this.textureCoordinateQueue.pop(),data:n};if(a<4)this.persistentTiles.set(s,l);else{const e=this.cachedTiles.setpop(s,l);e&&this.clearTile(e.value,e.key)}u.delete(s),this.tileStream.next({tileCount:1,fileId:e,channel:t,stokes:i,flush:!1})}else console.log(`Problem decompressing tile. Missing pending decompression map ${c}!`)}},Ee.staticInstance=void 0,be=Ie,Oe=Object(u.a)(be.prototype,"remainingTiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se=Object(u.a)(be.prototype,"workersReady",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(u.a)(be.prototype,"zfpReady",[m.i],Object.getOwnPropertyDescriptor(be.prototype,"zfpReady"),be.prototype),Ce=Object(u.a)(be.prototype,"updateRemainingTileCount",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.remainingTiles=this.pendingRequests.size}}}),be);var Re=i(79),Pe=i.n(Re);class je{static get Instance(){return je.staticInstance||(je.staticInstance=new je),je.staticInstance}initShaders(){this.gl&&(this.shaderProgram=Object(me.G)(this.gl,"precision highp float;\n\n//Data from bufferData\nattribute vec3 aVertexPosition;\nattribute vec2 aVertexUV;\nvarying vec2 vUV;\nuniform float uCanvasWidth;\nuniform float uCanvasHeight;\nuniform vec2 uRotationOrigin;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\n// Tiling parameters\nuniform vec2 uTileSize;\nuniform vec2 uTileScaling;\nuniform vec2 uTileOffset;\nuniform float uTileTextureSize;\n\nvec2 rotate2D(vec2 vector, float theta) {\n    float sinTheta = sin(theta);\n    float cosTheta = cos(theta);\n    return mat2(cosTheta, -sinTheta, sinTheta, cosTheta) * vector;\n}\n\nvec2 rotateAboutPoint2D(vec2 vector, vec2 origin, float theta) {\n    return rotate2D(vector - origin, theta) + origin;\n}\n\nvec2 scaleAboutPoint2D(vec2 vector, vec2 origin, float scale) {\n    return (vector - origin) * scale + origin;\n}\n\nvoid main(void) {\n    vec2 tilePosition = rotateAboutPoint2D(aVertexPosition.xy * uTileScaling * uTileSize + uTileOffset, uRotationOrigin, uRotationAngle);\n    // adjust based on pixel scales\n    tilePosition = scaleAboutPoint2D(tilePosition, uRotationOrigin, uScaleAdjustment);\n    // convert XY from canvas space to [-1, 1]\n    vec2 adjustedPosition = vec2(tilePosition.x / uCanvasWidth, tilePosition.y / uCanvasHeight) * 2.0 - 1.0;\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, aVertexPosition.z, 1.0);\n    vUV = aVertexUV * uTileSize / uTileTextureSize;\n}","precision highp float;\n\n#define LINEAR 0\n#define LOG 1\n#define SQRT 2\n#define SQUARE 3\n#define POWER 4\n#define GAMMA 5\n#define EXP 6\n#define CUSTOM 7\n\n#define FLT_MAX 3.402823466e+38\n\nvarying vec2 vUV;\n// Textures\nuniform sampler2D uDataTexture;\nuniform sampler2D uCmapTexture;\n// Render parameters\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform int uScaleType;\nuniform int uInverted;\nuniform float uMinVal;\nuniform float uMaxVal;\nuniform float uBias;\nuniform float uContrast;\nuniform float uGamma;\nuniform float uAlpha;\nuniform vec4 uNaNColor;\n\n// Tile texture parameters in pixels\nuniform float uTileBorder;\nuniform vec2 uTileTextureOffset;\nuniform float uTextureSize;\nuniform float uTileTextureSize;\n\n// Some shader compilers have trouble with NaN checks, so we instead use a dummy value of -FLT_MAX\nbool isnan(float val) {\n    return val <= -FLT_MAX;\n}\n\nvoid main(void) {\n    // Tile border\n    if (uTileBorder > 0.0 && (vUV.x < uTileBorder || vUV.y < uTileBorder)) {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n        return;\n    }\n    vec2 texCoords;\n\n    // Mimic texel fetch in WebGL1\n    vec2 tileCoordsPixel = vUV * uTileTextureSize;\n    // Prevent edge artefacts\n    vec2 texCoordsPixel = clamp(tileCoordsPixel, 0.5, uTileTextureSize - 0.5) + uTileTextureOffset;\n    texCoords = texCoordsPixel / uTextureSize;\n\n    float range = uMaxVal - uMinVal;\n    float rawVal = texture2D(uDataTexture, texCoords).r;\n\n    // Scaling types\n    // LINEAR (Default: uScaleType == LINEAR)\n    float x = clamp((rawVal - uMinVal) / range, 0.0, 1.0);\n    // Other scaling types\n    if (uScaleType == SQUARE) {\n        x = x * x;\n    }\n    else if (uScaleType == SQRT) {\n        x = sqrt(x);\n    }\n    else if (uScaleType == LOG) {\n        x = clamp(log(uAlpha * x + 1.0) / log(uAlpha), 0.0, 1.0);\n    }\n    else if (uScaleType == POWER) {\n        x = (pow(uAlpha, x) -1.0)/uAlpha;\n    }\n    else if (uScaleType == GAMMA) {\n        x = pow(x, uGamma);\n    }\n\n    // bias mod\n    x = clamp(x - uBias, 0.0, 1.0);\n    // contrast mod\n    x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n    // invert mod\n    if (uInverted > 0) {\n        x = 1.0 - x;\n    }\n\n    float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n    vec2 cmapCoords = vec2(x, cmapYVal);\n    gl_FragColor = isnan(rawVal) ? uNaNColor * uNaNColor.a : texture2D(uCmapTexture, cmapCoords);\n}"),this.gl.useProgram(this.shaderProgram),this.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),this.vertexUVAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexUV"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.gl.enableVertexAttribArray(this.vertexUVAttribute),this.shaderUniforms={MinVal:this.gl.getUniformLocation(this.shaderProgram,"uMinVal"),MaxVal:this.gl.getUniformLocation(this.shaderProgram,"uMaxVal"),NaNColor:this.gl.getUniformLocation(this.shaderProgram,"uNaNColor"),Bias:this.gl.getUniformLocation(this.shaderProgram,"uBias"),Contrast:this.gl.getUniformLocation(this.shaderProgram,"uContrast"),Gamma:this.gl.getUniformLocation(this.shaderProgram,"uGamma"),Alpha:this.gl.getUniformLocation(this.shaderProgram,"uAlpha"),ScaleType:this.gl.getUniformLocation(this.shaderProgram,"uScaleType"),Inverted:this.gl.getUniformLocation(this.shaderProgram,"uInverted"),DataTexture:this.gl.getUniformLocation(this.shaderProgram,"uDataTexture"),CmapTexture:this.gl.getUniformLocation(this.shaderProgram,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(this.shaderProgram,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(this.shaderProgram,"uCmapIndex"),CanvasWidth:this.gl.getUniformLocation(this.shaderProgram,"uCanvasWidth"),CanvasHeight:this.gl.getUniformLocation(this.shaderProgram,"uCanvasHeight"),ScaleAdjustment:this.gl.getUniformLocation(this.shaderProgram,"uScaleAdjustment"),RotationOrigin:this.gl.getUniformLocation(this.shaderProgram,"uRotationOrigin"),RotationAngle:this.gl.getUniformLocation(this.shaderProgram,"uRotationAngle"),TileSize:this.gl.getUniformLocation(this.shaderProgram,"uTileSize"),TileScaling:this.gl.getUniformLocation(this.shaderProgram,"uTileScaling"),TileOffset:this.gl.getUniformLocation(this.shaderProgram,"uTileOffset"),TileTextureOffset:this.gl.getUniformLocation(this.shaderProgram,"uTileTextureOffset"),TextureSize:this.gl.getUniformLocation(this.shaderProgram,"uTextureSize"),TileTextureSize:this.gl.getUniformLocation(this.shaderProgram,"uTileTextureSize"),TileBorder:this.gl.getUniformLocation(this.shaderProgram,"uTileBorder")},this.gl.uniform1i(this.shaderUniforms.DataTexture,0),this.gl.uniform1i(this.shaderUniforms.CmapTexture,1),this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapIndex,2),this.gl.uniform1f(this.shaderUniforms.MinVal,3.4),this.gl.uniform1f(this.shaderUniforms.MaxVal,5.5),this.gl.uniform1f(this.shaderUniforms.Bias,0),this.gl.uniform1f(this.shaderUniforms.Contrast,1),this.gl.uniform1f(this.shaderUniforms.Gamma,1),this.gl.uniform1f(this.shaderUniforms.Alpha,1e3),this.gl.uniform1i(this.shaderUniforms.Inverted,0),this.gl.uniform1f(this.shaderUniforms.TileBorder,0/Ae),this.gl.uniform2f(this.shaderUniforms.TileSize,1,1),this.gl.uniform2f(this.shaderUniforms.TileScaling,1,1),this.gl.uniform2f(this.shaderUniforms.TileOffset,0,0),this.gl.uniform2f(this.shaderUniforms.TileTextureOffset,0,0),this.gl.uniform1f(this.shaderUniforms.TextureSize,4096),this.gl.uniform1f(this.shaderUniforms.TileTextureSize,Ae),this.gl.uniform4f(this.shaderUniforms.NaNColor,0,0,1,1))}initBuffers(){if(!this.gl)return;this.vertexPositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexPositionBuffer);const e=new Float32Array([0,0,0,1,0,0,0,1,0,1,1,0]);this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,e,WebGLRenderingContext.STATIC_DRAW),this.vertexUVBuffer=this.gl.createBuffer(),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexUVBuffer);const t=new Float32Array([0,0,1,0,0,1,1,1]);this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,t,WebGLRenderingContext.STATIC_DRAW)}constructor(){this.gl=void 0,this.cmapTexture=void 0,this.vertexPositionBuffer=void 0,this.vertexUVBuffer=void 0,this.vertexPositionAttribute=void 0,this.vertexUVAttribute=void 0,this.shaderProgram=void 0,this.shaderUniforms=void 0,this.setCanvasSize=(e,t)=>{this.gl&&(this.gl.canvas.width=e,this.gl.canvas.height=t)},this.gl=Object(me.K)(),this.gl&&(this.initShaders(),this.initBuffers(),Object(me.O)(this.gl,Pe.a,WebGLRenderingContext.TEXTURE1).then(e=>{this.cmapTexture=e}))}}je.staticInstance=void 0;class ke{static get Instance(){return ke.staticInstance||(ke.staticInstance=new ke),ke.staticInstance}initShaders(){if(!this.gl)return;let e=Object(me.F)(this.gl,"precision highp float;\n\n//Data from buffers\nattribute vec3 aVertexPosition;\nattribute vec2 aVertexNormal;\n\nuniform vec2 uRangeScale;\nuniform vec2 uRangeOffset;\nuniform vec2 uRotationOrigin;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\nuniform float uLineThickness;\n\n// Control-map based transformation\nuniform int uControlMapEnabled;\nuniform vec2 uControlMapMin;\nuniform vec2 uControlMapMax;\nuniform vec2 uControlMapSize;\nuniform highp sampler2D uControlMapTexture;\n\nvarying float vLinePosition;\nvarying float vLineSide;\n\nvec2 rotate2D(vec2 vector, float theta) {\n    float sinTheta = sin(theta);\n    float cosTheta = cos(theta);\n    return mat2(cosTheta, -sinTheta, sinTheta, cosTheta) * vector;\n}\n\nvec2 scaleAndRotate2D(vec2 vector, float theta, float scale) {\n    return rotate2D(vector, theta) * scale;\n}\n\n// Adapted from https://www.shadertoy.com/view/MllSzX to work with non-square vec4 textures of variable size\n\nvec4 cubic(vec4 A, vec4 B, vec4 C, vec4 D, float t) {\n    float t2 = t * t;\n    float t3 = t * t * t;\n    vec4 a = -A / 2.0 + (3.0 * B) / 2.0 - (3.0 * C) / 2.0 + D / 2.0;\n    vec4 b = A - (5.0 * B) / 2.0 + 2.0 * C - D / 2.0;\n    vec4 c = -A / 2.0 + C / 2.0;\n    vec4 d = B;\n\n    return a * t3 + b * t2 + c * t + d;\n}\n\nvec4 bicubicFilter(sampler2D texture, vec2 P) {\n    // Calculate offset and base pixel coordiante\n    vec2 pixelSize = 1.0 / uControlMapSize;\n    vec2 pixel = P * uControlMapSize + 0.5;\n    vec2 frac = fract(pixel);\n    pixel = floor(pixel) / uControlMapSize - pixelSize / 2.0;\n\n    // Texture lookups\n    vec4 C00 = texture2D(texture, pixel + pixelSize * vec2(-1.0, -1.0));\n    vec4 C10 = texture2D(texture, pixel + pixelSize * vec2(0.0, -1.0));\n    vec4 C20 = texture2D(texture, pixel + pixelSize * vec2(1.0, -1.0));\n    vec4 C30 = texture2D(texture, pixel + pixelSize * vec2(2.0, -1.0));\n\n    vec4 C01 = texture2D(texture, pixel + pixelSize * vec2(-1.0, 0.0));\n    vec4 C11 = texture2D(texture, pixel + pixelSize * vec2(0.0, 0.0));\n    vec4 C21 = texture2D(texture, pixel + pixelSize * vec2(1.0, 0.0));\n    vec4 C31 = texture2D(texture, pixel + pixelSize * vec2(2.0, 0.0));\n\n    vec4 C02 = texture2D(texture, pixel + pixelSize * vec2(-1.0, 1.0));\n    vec4 C12 = texture2D(texture, pixel + pixelSize * vec2(0.0, 1.0));\n    vec4 C22 = texture2D(texture, pixel + pixelSize * vec2(1.0, 1.0));\n    vec4 C32 = texture2D(texture, pixel + pixelSize * vec2(2.0, 1.0));\n\n    vec4 C03 = texture2D(texture, pixel + pixelSize * vec2(-1.0, 2.0));\n    vec4 C13 = texture2D(texture, pixel + pixelSize * vec2(0.0, 2.0));\n    vec4 C23 = texture2D(texture, pixel + pixelSize * vec2(1.0, 2.0));\n    vec4 C33 = texture2D(texture, pixel + pixelSize * vec2(2.0, 2.0));\n\n    // Cubic along x\n    vec4 CP0X = cubic(C00, C10, C20, C30, frac.x);\n    vec4 CP1X = cubic(C01, C11, C21, C31, frac.x);\n    vec4 CP2X = cubic(C02, C12, C22, C32, frac.x);\n    vec4 CP3X = cubic(C03, C13, C23, C33, frac.x);\n\n    // Final cubic along y\n    return cubic(CP0X, CP1X, CP2X, CP3X, frac.y);\n}\n\n// end adapted from https://www.shadertoy.com/view/MllSzX\n\nvec2 controlMapLookup(vec2 pos) {\n    vec2 texScale = 1.0 / uControlMapSize;\n    vec2 range = uControlMapMax - uControlMapMin;\n    vec2 shiftedPoint = pos - uControlMapMin;\n    vec2 index = shiftedPoint / range + 0.5 / uControlMapSize;\n    return bicubicFilter(uControlMapTexture, index).ra;\n}\n\nvoid main(void) {\n\n    // Shift by half a pixel to account for position of pixel center\n    vec2 posImageSpace = aVertexPosition.xy - 0.5;\n\n    // Calculate extrusion vector and distance\n    vec2 extrudeOffet = (aVertexNormal / 16384.0) * uLineThickness * 0.5;\n    float extrudeDistance = length(extrudeOffet);\n\n    // If there's a control map, use it to look up location using bilinear filtering\n    if (uControlMapEnabled > 0) {\n        // Use an offset of 10% of the grid spacing to estimate the direction of the normal\n        vec2 deltaVec = 0.1 * (uControlMapMax - uControlMapMin) / uControlMapSize;\n        // Use a minimum of 10% in X and 10% in Y directions\n        float delta = min(deltaVec.x, deltaVec.y);\n        vec2 extrudedPoint = controlMapLookup(posImageSpace + normalize(extrudeOffet) * delta);\n        posImageSpace = controlMapLookup(posImageSpace);\n        vec2 transformedNormal = extrudedPoint - posImageSpace;\n        // Ensure consistent extrusion distance\n        posImageSpace += extrudeDistance * normalize(transformedNormal);\n    } else {\n        // Extrude point along normal\n        posImageSpace += extrudeOffet;\n    }\n\n    // Scale and rotate\n    vec2 posRefSpace = scaleAndRotate2D(posImageSpace, uRotationAngle, uScaleAdjustment);\n    // Convert from image space to GL space [-1, 1]\n    vec2 adjustedPosition = (posRefSpace * uRangeScale + uRangeOffset) * 2.0 - 1.0;\n\n    vLineSide = sign(aVertexPosition.z);\n    vLinePosition = abs(aVertexPosition.z);\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, 0.0, 1.0);\n}",WebGLRenderingContext.VERTEX_SHADER),t=Object(me.F)(this.gl,"precision highp float;\n\nvarying float vLinePosition;\nvarying float vLineSide;\n\nuniform float uDashLength;\nuniform vec4 uLineColor;\nuniform int uCmapEnabled;\n\nuniform sampler2D uCmapTexture;\nuniform float uCmapValue;\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform float uBias;\nuniform float uContrast;\n\nvoid main(void) {\n    float dashStrength;\n    // Modulate dash strength based on dash length and line position\n    if (uDashLength > 1e-3) {\n        float dashRepeatLength = 2.0 * uDashLength;\n        dashStrength = mod(vLinePosition, dashRepeatLength) / dashRepeatLength <= 0.75 ? 1.0: 0.0;\n        if (dashStrength == 0.0) {\n            discard;\n        }\n    }\n    else {\n        dashStrength = 1.0;\n    }\n\n    vec4 color;\n    if (uCmapEnabled > 0) {\n        // bias mod\n        float x = clamp(uCmapValue - uBias, 0.0, 1.0);\n        // contrast mod\n        x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n        float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n        vec2 cmapCoords = vec2(x, cmapYVal);\n        color = texture2D(uCmapTexture, cmapCoords);\n    } else {\n        color = uLineColor;\n    }\n\n    gl_FragColor = dashStrength * color;\n}",WebGLRenderingContext.FRAGMENT_SHADER),i=this.gl.createProgram();this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),this.gl.getProgramParameter(i,WebGLRenderingContext.LINK_STATUS)||console.log("Could not initialise shaders"),this.gl.useProgram(i),this.vertexPositionAttribute=this.gl.getAttribLocation(i,"aVertexPosition"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexNormalAttribute=this.gl.getAttribLocation(i,"aVertexNormal"),this.gl.enableVertexAttribArray(this.vertexNormalAttribute),this.shaderUniforms={RangeScale:this.gl.getUniformLocation(i,"uRangeScale"),RangeOffset:this.gl.getUniformLocation(i,"uRangeOffset"),ScaleAdjustment:this.gl.getUniformLocation(i,"uScaleAdjustment"),RotationOrigin:this.gl.getUniformLocation(i,"uRotationOrigin"),RotationAngle:this.gl.getUniformLocation(i,"uRotationAngle"),DashLength:this.gl.getUniformLocation(i,"uDashLength"),LineColor:this.gl.getUniformLocation(i,"uLineColor"),LineThickness:this.gl.getUniformLocation(i,"uLineThickness"),CmapEnabled:this.gl.getUniformLocation(i,"uCmapEnabled"),CmapValue:this.gl.getUniformLocation(i,"uCmapValue"),CmapTexture:this.gl.getUniformLocation(i,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(i,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(i,"uCmapIndex"),Contrast:this.gl.getUniformLocation(i,"uContrast"),Bias:this.gl.getUniformLocation(i,"uBias"),ControlMapEnabled:this.gl.getUniformLocation(i,"uControlMapEnabled"),ControlMapSize:this.gl.getUniformLocation(i,"uControlMapSize"),ControlMapMin:this.gl.getUniformLocation(i,"uControlMapMin"),ControlMapMax:this.gl.getUniformLocation(i,"uControlMapMax"),ControlMapTexture:this.gl.getUniformLocation(i,"uControlMapTexture")},this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapTexture,0)}constructor(){this.cmapTexture=void 0,this.gl=void 0,this.shaderUniforms=void 0,this.vertexPositionAttribute=void 0,this.vertexNormalAttribute=void 0,this.setCanvasSize=(e,t)=>{this.gl&&(this.gl.canvas.width=e,this.gl.canvas.height=t,this.gl.viewport(0,0,e,t))},this.gl=Object(me.K)(),this.gl&&(this.initShaders(),Object(me.O)(this.gl,Pe.a,WebGLRenderingContext.TEXTURE0).then(e=>{this.cmapTexture=e}))}}ke.staticInstance=void 0;class Fe{constructor(){this.target=void 0,this.action=void 0,this.parameters=void 0,this.valid=void 0,this.async=void 0,this.mapMacro=e=>{if("object"===typeof e&&e.macroVariable){const t=e.macroTarget?`${e.macroTarget}.${e.macroVariable}`:e.macroVariable;return Fe.GetTargetObject(ge.e.Instance,t)}return e}}static FromString(e){const t=new Fe;e=e.trim();const i=/^(\+?)((?:[\w[\]]+\.)*)(\w+)\(([^)]*)\);?$/gm.exec(e);return i&&5===i.length&&i[3].length?(t.async=i[1].length>0,i[2].length&&(t.target=i[2].substring(0,i[2].length-1)),t.action=i[3],t.valid=t.parseParameters(i[4],!0)):t.valid=!1,t}static FromScriptingRequest(e){const t=new Fe;return t.async=e.async,t.target=e.target,t.action=e.action,t.valid=t.parseParameters(e.parameters,!1),t}parseParameters(e,t){if(!e)return this.parameters=[],!0;try{let i=e.replace(/\$((?:[\w[\]]+\.)*)([\w[\]]+)/gm,(e,t,i)=>`{"macroTarget": "${t.slice(0,-1)}", "macroVariable": "${i}"}`);t&&(i=`[${i}]`),this.parameters=JSON.parse(i)}catch(i){return console.log(i),!1}return!0}async execute(){const e=Fe.GetTargetObject(ge.e.Instance,this.target);if(null==e)throw new Error("Missing target object: "+this.target);const t=this.parameters.map(this.mapMacro);let i,n=e[this.action];if(!n||"function"!==typeof n)throw new Error("Missing action function: "+this.action);return n=n.bind(e),i=this.async?n(...t):await n(...t),i}static GetTargetObject(e,t){if(!t)return e;let i=e;const n=t.split(".");console.log(n);for(const r of n){const e=/(\w+)(?:\[(\d+)])?/gm.exec(r);if(e&&3===e.length&&void 0!==e[2]){if(console.log(i),console.log(e),i=i[e[1]],null==i)return null;if(i instanceof Map){const t=JSON.parse(e[2]);i=i.get(t)}else{if(!Array.isArray(i))return null;i=i[e[2]]}}else i=i[r];if(null==i)return null}return i}}class Me{constructor(){this.handleScriptingRequest=async e=>{const t=Fe.FromScriptingRequest(e);if(!t.valid)return{scriptingRequestId:e.scriptingRequestId,success:!1,message:"Failed to parse scripting request"};try{let i;return i=t.async?t.execute():await t.execute(),{scriptingRequestId:e.scriptingRequestId,success:!0,response:JSON.stringify(i)}}catch(i){return{scriptingRequestId:e.scriptingRequestId,success:!1,message:i}}},this.executeEntries=async e=>{if(e&&e.length)for(const i of e)try{if(i.async){const e=i.execute();console.log(e)}else{const e=await i.execute();console.log(e),await Me.Delay(10)}}catch(t){console.log(t)}}}static get Instance(){return Me.staticInstance||(Me.staticInstance=new Me),Me.staticInstance}static Delay(e){return new Promise(t=>{setTimeout(t,e)})}}Me.staticInstance=void 0},282:function(e,t){},283:function(e,t){},284:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"k",(function(){return r})),i.d(t,"d",(function(){return o})),i.d(t,"h",(function(){return a})),i.d(t,"l",(function(){return s})),i.d(t,"e",(function(){return l})),i.d(t,"j",(function(){return c})),i.d(t,"c",(function(){return u})),i.d(t,"i",(function(){return p})),i.d(t,"g",(function(){return d})),i.d(t,"b",(function(){return h})),i.d(t,"f",(function(){return g}));const n=[{code:"FREQ",name:"Frequency",unit:"Hz"},{code:"ENER",name:"Energy",unit:"J"},{code:"WAVN",name:"Wavenumber",unit:"1/m"},{code:"VRAD",name:"Radio velocity",unit:"m/s"},{code:"WAVE",name:"Vacuum wavelength",unit:"m"},{code:"VOPT",name:"Optical velocity",unit:"m/s"},{code:"ZOPT",name:"Redshift",unit:""},{code:"AWAV",name:"Air wavelength",unit:"m"},{code:"VELO",name:"Apparent radial velocity",unit:"m/s"},{code:"BETA",name:"Beta",unit:""}];let r;!function(e){e.VRAD="VRAD",e.VOPT="VOPT",e.FREQ="FREQ",e.WAVE="WAVE",e.AWAV="AWAV",e.CHANNEL="CHANNEL"}(r||(r={}));const o=e=>e&&e!==r.CHANNEL&&Object.values(r).includes(e),a=[r.VRAD,r.VOPT,r.FREQ,r.CHANNEL];let s;!function(e){e.KMS="km/s",e.MS="m/s",e.GHZ="GHz",e.MHZ="MHz",e.KHZ="kHz",e.HZ="Hz",e.M="m",e.MM="mm",e.UM="um",e.NM="nm",e.ANGSTROM="Angstrom"}(s||(s={}));const l=e=>e&&Object.values(s).includes(e);let c;!function(e){e.LSRK="LSRK",e.LSRD="LSRD",e.BARY="BARYCENT",e.TOPO="TOPOCENT"}(c||(c={}));const u=e=>e&&Object.values(c).includes(e),p=new Map([[r.VRAD,"Radio velocity"],[r.VOPT,"Optical velocity"],[r.FREQ,"Frequency"],[r.WAVE,"Vacuum wavelength"],[r.AWAV,"Air wavelength"],[r.CHANNEL,"Channel"]]),d=new Map([[r.VRAD,s.KMS],[r.VOPT,s.KMS],[r.FREQ,s.GHZ],[r.WAVE,s.MM],[r.AWAV,s.MM]]),h=(e,t)=>`${e?p.get(e):""}${t?" ("+t+")":""}`,g=new Map([[h(r.VRAD,s.KMS),{type:r.VRAD,unit:s.KMS}],[h(r.VRAD,s.MS),{type:r.VRAD,unit:s.MS}],[h(r.VOPT,s.KMS),{type:r.VOPT,unit:s.KMS}],[h(r.VOPT,s.MS),{type:r.VOPT,unit:s.MS}],[h(r.FREQ,s.GHZ),{type:r.FREQ,unit:s.GHZ}],[h(r.FREQ,s.MHZ),{type:r.FREQ,unit:s.MHZ}],[h(r.FREQ,s.KHZ),{type:r.FREQ,unit:s.KHZ}],[h(r.FREQ,s.HZ),{type:r.FREQ,unit:s.HZ}],[h(r.WAVE,s.M),{type:r.WAVE,unit:s.M}],[h(r.WAVE,s.MM),{type:r.WAVE,unit:s.MM}],[h(r.WAVE,s.UM),{type:r.WAVE,unit:s.UM}],[h(r.WAVE,s.NM),{type:r.WAVE,unit:s.NM}],[h(r.WAVE,s.ANGSTROM),{type:r.WAVE,unit:s.ANGSTROM}],[h(r.AWAV,s.M),{type:r.AWAV,unit:s.M}],[h(r.AWAV,s.MM),{type:r.AWAV,unit:s.MM}],[h(r.AWAV,s.UM),{type:r.AWAV,unit:s.UM}],[h(r.AWAV,s.NM),{type:r.AWAV,unit:s.NM}],[h(r.AWAV,s.ANGSTROM),{type:r.AWAV,unit:s.ANGSTROM}],["Channel",{type:r.CHANNEL,unit:null}]])},285:function(e,t){},286:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o}));var n=i(6);class r{constructor(){this.x=void 0,this.y=void 0}static ToString(e,t,i=-1){return e?`(${i<0?e.x:Object(n.kb)(e.x,i)} ${t}, ${i<0?e.y:Object(n.kb)(e.y,i)} ${t})`:""}}class o{constructor(){this.x=void 0,this.y=void 0}static ToString(e){return e?`(${e.x}, ${e.y})`:""}}},287:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(6);class r{constructor(e,t){this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.origin=void 0;const i=Object(n.lb)(e,t,!0),r=Object(n.f)(t,{x:0,y:.5}),o=Object(n.f)(t,{x:0,y:-.5}),a=Object(n.ib)(r,o),s=Object(n.lb)(e,r,!0),l=Object(n.lb)(e,o,!0),c=Object(n.ib)(s,l);this.scale=Object(n.N)(c)/Object(n.N)(a),this.rotation=Math.atan2(c.y,c.x)-Math.atan2(a.y,a.x),this.translation=Object(n.ib)(i,t),this.origin={x:t.x,y:t.y}}transformCoordinate(e,t=!0){if(t){const t=Object(n.db)(e,this.origin,this.scale,this.rotation);return Object(n.f)(t,this.translation)}{const t=Object(n.ib)(e,this.translation);return Object(n.db)(t,this.origin,1/this.scale,-this.rotation)}}}},288:function(e,t){},289:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i){this.layer=void 0,this.x=void 0,this.y=void 0,this.x=e,this.y=t,this.layer=i}encode(){return n.EncodeCoordinate(this)}static EncodeCoordinate(e){return e?n.Encode(e.x,e.y,e.layer):-1}static Encode(e,t,i){const n=1<<i;return e<0||t<0||i<0||i>12||e>=n||t>=n?-1:i<<24|t<<12|e}static Decode(e){return new n(4095&e,e>>12&4095,e>>24&127)}static GetLayer(e){return e>>24&127}}},290:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.LIGHT="light",n.DARK="dark",n.AUTO="auto",n.isValid=e=>e&&(e===n.LIGHT||e===n.DARK||e===n.AUTO)},291:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.DEFAULT="Default",n.CUBEVIEW="Cube View",n.CUBEANALYSIS="Cube Analysis",n.CONTINUUMANALYSIS="Continuum Analysis",n.PRESETS=[n.DEFAULT,n.CUBEVIEW,n.CUBEANALYSIS,n.CONTINUUMANALYSIS],n.PRESET_CONFIGS=new Map([[n.DEFAULT,{leftBottomContent:{type:"stack",content:[{type:"component",id:"render-config"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"stack",content:[{type:"component",id:"layer-list"},{type:"component",id:"animator"},{type:"component",id:"region-list"}]}]}],[n.CUBEVIEW,{leftBottomContent:{type:"stack",content:[{type:"component",id:"animator"},{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"component",id:"spectral-profiler"}]}],[n.CUBEANALYSIS,{leftBottomContent:{type:"stack",content:[{type:"component",id:"animator"},{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spectral-profiler"},{type:"component",id:"stats"}]}],[n.CONTINUUMANALYSIS,{leftBottomContent:{type:"stack",content:[{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"animator"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"component",id:"stats"}]}]]),n.isPreset=e=>e&&n.PRESETS.includes(e)},292:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.FIXED="fixed",n.TRACKING="tracking",n.isValid=e=>e&&(e===n.FIXED||e===n.TRACKING)},293:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.FIT="fit",n.FULL="full",n.isValid=e=>e&&(e===n.FIT||e===n.FULL)},294:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.CURSOR="cursor",n.CENTER="center",n.isValid=e=>e&&(e===n.CURSOR||e===n.CENTER)},295:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.AUTOMATIC="automatic",n.DEGREES="degrees",n.SEXAGESIMAL="sexagesimal",n.isValid=e=>e&&(e===n.AUTOMATIC||e===n.DEGREES||e===n.SEXAGESIMAL)},296:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.CENTER="center",n.CORNER="corner",n.isValid=e=>e&&(e===n.CENTER||e===n.CORNER)},297:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.IMAGE_MIN=1,n.IMAGE_MAX=32,n.IMAGE_STEP=1,n.IMAGE_DEFAULT=11,n.ANIMATION_MIN=1,n.ANIMATION_MAX=32,n.ANIMATION_STEP=1,n.ANIMATION_DEFAULT=9,n.isImageCompressionQualityValid=e=>isFinite(e)&&e>=n.IMAGE_MIN&&e<=n.IMAGE_MAX,n.isAnimationCompressionQualityValid=e=>isFinite(e)&&e>=n.ANIMATION_MIN&&e<=n.ANIMATION_MAX},298:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.GPU_MIN=512,n.GPU_MAX=8192,n.GPU_STEP=128,n.GPU_DEFAULT=512,n.SYSTEM_MIN=1024,n.SYSTEM_MAX=16384,n.SYSTEM_STEP=256,n.SYSTEM_DEFAULT=4096,n.isGPUTileCacheValid=e=>isFinite(e)&&e>=n.GPU_MIN&&e<=n.GPU_MAX,n.isSystemTileCacheValid=e=>isFinite(e)&&e>=n.SYSTEM_MIN&&e<=n.SYSTEM_MAX},299:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(5),r=i(128);class o{static ProcessSpatialProfile(e){return e.rawValuesFp32&&e.rawValuesFp32.length&&e.rawValuesFp32.length%4===0?{coordinate:e.coordinate,start:e.start,end:e.end,values:new Float32Array(e.rawValuesFp32.slice().buffer)}:{coordinate:e.coordinate,start:e.start,end:e.end,values:null}}static ProcessSpectralProfile(e,t){return e.rawValuesFp64&&e.rawValuesFp64.length&&e.rawValuesFp64.length%8===0?{coordinate:e.coordinate,statsType:e.statsType,values:new Float64Array(e.rawValuesFp64.slice().buffer),progress:t}:e.rawValuesFp32&&e.rawValuesFp32.length&&e.rawValuesFp32.length%4===0?{coordinate:e.coordinate,statsType:e.statsType,values:new Float32Array(e.rawValuesFp32.slice().buffer),progress:t}:{coordinate:e.coordinate,statsType:e.statsType,values:null,progress:0}}static ProcessContourSet(e){let t;if(e.decimationFactor>=1)t=r.Decode(e.rawCoordinates,e.uncompressedCoordinatesSize,e.decimationFactor);else{const i=e.rawCoordinates.slice();t=new Float32Array(i.buffer)}const i=new Int32Array(e.rawStartIndices.buffer.slice(e.rawStartIndices.byteOffset,e.rawStartIndices.byteOffset+e.rawStartIndices.byteLength));return{level:e.level,indexOffsets:i,coordinates:t}}static ProcessContourData(e){return{fileId:e.fileId,channel:e.channel,stokes:e.stokes,imageBounds:e.imageBounds,progress:e.progress,contourSets:e.contourSets?e.contourSets.map(e=>this.ProcessContourSet(e)):null}}static GetProcessedData(e){let t;switch(e.dataType){case n.a.ColumnType.Uint8:t=new Uint8Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Int8:t=new Int8Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Uint16:t=new Uint16Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Int16:t=new Int16Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Uint32:t=new Uint32Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Int32:t=new Int32Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Float:t=new Float32Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Double:t=new Float64Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Bool:const i=new Uint8Array(e.binaryData.slice().buffer),r=new Array(i.length);for(let e=r.length-1;e>=0;e--)r[e]=0!==i[e];return{dataType:e.dataType,data:r};case n.a.ColumnType.String:return{dataType:e.dataType,data:e.stringData};default:return{dataType:n.a.ColumnType.UnsupportedType,data:[]}}const i=t.length;let r=new Array(i);for(let n=i-1;n>=0;n--)r[n]=t[n];return{dataType:e.dataType,data:r}}static ProcessCatalogData(e){const t=new Map;return new Map(Object.entries(e)).forEach((e,i)=>{t.set(parseInt(i),o.GetProcessedData(e))}),t}}},300:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(5);class r{}r.EVENT_TYPES=Object.values(n.a.EventType),r.EVENT_NUMBER=r.EVENT_TYPES.length,r.isEventTypeValid=e=>r.EVENT_TYPES.includes(e),r.getEventTypeFromName=e=>n.a.EventType[e],r.getEventNameFromType=e=>n.a.EventType[e]},301:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(129),r=i.n(n);const{version:o}=i(599),a={acronym:"CARTA",version:o,date:r()("2021-02-08T22:41:04.655Z").format("D MMM YYYY"),fullName:"Cube Analysis and Rendering Tool for Astronomy"}},302:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i(186),r=i.n(n),o=i(4),a=i(10),s=i(6),l=i(13);const c=i(633),u=new Map([["image-view",{type:"react-component",component:"image-view",title:"No image loaded",height:Object(s.hb)(window.innerHeight,720,1080,65,75),id:"image-view",isClosable:!1}],["render-config",{type:"react-component",component:"render-config",title:"Render Configuration",id:"render-config"}],["region-list",{type:"react-component",component:"region-list",title:"Region List",id:"region-list"}],["animator",{type:"react-component",component:"animator",title:"Animator",id:"animator"}],["spatial-profiler",{type:"react-component",component:"spatial-profiler",id:"spatial-profiler"}],["spectral-profiler",{type:"react-component",component:"spectral-profiler",id:"spectral-profiler",title:"Z Profile: Cursor"}],["stokes",{type:"react-component",component:"stokes",id:"stokes",title:"Stokes Analysis"}],["histogram",{type:"react-component",component:"histogram",title:"Histogram",id:"histogram"}],["stats",{type:"react-component",component:"stats",title:"Statistics",id:"stats"}],["layer-list",{type:"react-component",component:"layer-list",title:"Image List",id:"layer-list"}],["log",{type:"react-component",component:"log",title:"Log",id:"log"}],["catalog-overlay",{type:"react-component",component:"catalog-overlay",title:"Catalog Overlay",id:"catalog-overlay"}],["catalog-plot",{type:"react-component",component:"catalog-plot",title:"Catalog Plot",id:"catalog-plot"}],["spectral-line-query",{type:"react-component",component:"spectral-line-query",title:"Spectral Line Query",id:"spectral-line-query"}]]);class p{}p.LayoutValidator=new r.a({useDefaults:"empty"}).compile(c),p.CurrentSchemaVersion=2,p.GetPresetConfig=e=>{if(!e)return null;const t=a.PresetLayout.PRESET_CONFIGS.get(e);return t?{layoutVersion:p.CurrentSchemaVersion,docked:{type:"row",content:[{type:"column",width:60,content:[{type:"component",id:"image-view"},t.leftBottomContent]},{type:"column",content:t.rightColumnContent}]},floating:[]}:null},p.UpgradeLayout=e=>{if(1===e.layoutVersion){const t=Object(s.s)(e,e=>"spatial-profiler"===e.id);for(const e of t)e.coord&&(e.widgetSettings||(e.widgetSettings={}),e.widgetSettings.coordinate=e.coord,delete e.coord);e.layoutVersion=2}if(e.floating&&Array.isArray(e.floating))for(const t of e.floating)"component"!==t.type&&(t.id=t.type,t.type="component")},p.IsUserLayoutValid=(e,t)=>{if(!e||!t)return!1;if(a.PresetLayout.isPreset(e))return!1;return!!p.LayoutValidator(t)||(console.log(p.LayoutValidator.errors),!1)},p.CreateConfigToSave=(e,t)=>{if(!e||!t||!("type"in t)||!("content"in t))return null;let i={layoutVersion:p.CurrentSchemaVersion,docked:{type:t.type,content:[]},floating:[]};return p.GenSimpleConfigToSave(e,i.docked.content,t.content),e.widgetsStore.floatingWidgets.forEach(t=>{let n={type:"component",id:t.type,defaultWidth:t.defaultWidth?t.defaultWidth:"",defaultHeight:t.defaultHeight?t.defaultHeight:"",defaultX:t.defaultX?t.defaultX:"",defaultY:t.defaultY?t.defaultY:""},r=void 0;if(t.type===l.b.WIDGET_CONFIG.type){const i=o.k.Instance.catalogProfiles.get(t.id),n=o.k.Instance.catalogWidgets.get(i);r=e.widgetsStore.toWidgetSettingsConfig(t.type,n)}else r=e.widgetsStore.toWidgetSettingsConfig(t.type,t.id);r&&(n.widgetSettings=r);const a=e.widgetsStore.catalogPlotWidgets.get(t.id);a&&(n.plotType=a.plotType),i.floating.push(n)}),i},p.GenSimpleConfigToSave=(e,t,i)=>{e&&t&&Array.isArray(t)&&i&&Array.isArray(i)&&i.forEach(i=>{if(i.type)if("stack"===i.type||"row"===i.type||"column"===i.type){var n;let r={type:i.type,content:[]};"stack"===i.type&&i.activeItemIndex>=0&&i.activeItemIndex<(null===(n=i.content)||void 0===n?void 0:n.length)&&(r.activeItemIndex=i.activeItemIndex),i.width&&(r.width=i.width),i.height&&(r.height=i.height),t.push(r),i.content&&p.GenSimpleConfigToSave(e,r.content,i.content)}else if("component"===i.type&&i.id){const n=i.id.replace(/(-component)?-\d+$/,"");let r={type:i.type,id:n};i.width&&(r.width=i.width),i.height&&(r.height=i.height);let a=void 0;if(n===l.b.WIDGET_CONFIG.type){const t=o.k.Instance.catalogProfiles.get(i.id),r=o.k.Instance.catalogWidgets.get(t);a=e.widgetsStore.toWidgetSettingsConfig(n,r)}else a=e.widgetsStore.toWidgetSettingsConfig(n,i.id);a&&(r.widgetSettings=a);const s=e.widgetsStore.catalogPlotWidgets.get(i.id);s&&(r.plotType=s.plotType),t.push(r)}})},p.CreateConfigToApply=(e,t,i)=>{e&&Array.isArray(e)&&t&&Array.isArray(t)&&t.forEach(t=>{if(t.type)if("stack"===t.type||"row"===t.type||"column"===t.type){var n;let r={type:t.type,content:[]};"stack"===t.type&&t.activeItemIndex>=0&&t.activeItemIndex<(null===(n=t.content)||void 0===n?void 0:n.length)&&(r.activeItemIndex=t.activeItemIndex),t.width&&(r.width=t.width),t.height&&(r.height=t.height),e.push(r),t.content&&p.CreateConfigToApply(r.content,t.content,i)}else if("component"===t.type&&t.id){const n=t.id.replace(/-\d+$/,"");if(u.has(n)){let r=Object.assign({},u.get(n));t.width&&(r.width=t.width),t.height&&(r.height=t.height),"widgetSettings"in t&&(r.widgetSettings=t.widgetSettings),"plotType"in t&&(r.plotType=t.plotType),r.props={appStore:o.e.Instance,id:"",docked:!0},i.push(r),e.push(r)}}})}},311:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(22),r=i(6);class o{constructor(e,t,i,o,a){this.source=void 0,this.destination=void 0,this.width=void 0,this.height=void 0,this.minPoint=void 0,this.maxPoint=void 0,this.grid=void 0,this.texture=void 0,this.gl=void 0,this.getTextureX=e=>(e===this.gl&&this.texture||(this.gl=e,this.texture=this.gl.createTexture(),this.gl.activeTexture(r.a.TEXTURE1),this.gl.bindTexture(r.a.TEXTURE_2D,this.texture),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_MIN_FILTER,r.a.NEAREST),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_MAG_FILTER,r.a.NEAREST),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_WRAP_S,r.a.CLAMP_TO_EDGE),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_WRAP_T,r.a.CLAMP_TO_EDGE),this.gl.texImage2D(r.a.TEXTURE_2D,0,r.a.LUMINANCE_ALPHA,this.width,this.height,0,r.a.LUMINANCE_ALPHA,r.a.FLOAT,this.grid)),this.texture),this.hasTextureForContext=e=>e===this.gl&&this.texture&&e.isTexture(this.texture),this.source=e,this.destination=t,this.width=o,this.height=a;let s=!1;if(i<0){const r=n.copy(e.wcsInfo),o=n.copy(t.wcsInfo);n.invert(r),n.invert(o),i=n.convert(r,o,""),n.delete(r),n.delete(o),s=!0}const l=Math.ceil(e.frameInfo.fileInfoExtended.width/o),c=Math.ceil(e.frameInfo.fileInfoExtended.height/a);this.minPoint={x:-l,y:-c},this.maxPoint={x:l+e.frameInfo.fileInfoExtended.width,y:c+e.frameInfo.fileInfoExtended.height},this.grid=n.getTransformGrid(i,this.minPoint.x,this.maxPoint.x,o,this.minPoint.y,this.maxPoint.y,a,1),s&&n.delete(i)}getTransformedCoordinate(e){const t=Object(r.ib)(this.maxPoint,this.minPoint),i=Object(r.ib)(e,this.minPoint),n={x:this.width*i.x/t.x,y:this.height*i.y/t.y},o=Math.floor(n.x),a=Math.floor(n.y),s=n.x-o,l=n.y-a,c=a*this.width+o,u=(a+1)*this.width+o,p=a*this.width+o+1,d=(a+1)*this.width+o+1,h=this.grid[2*c],g=this.grid[2*c+1],m=this.grid[2*u],f=this.grid[2*u+1],y=this.grid[2*p],b=this.grid[2*p+1];return{x:h*(1-s)*(1-l)+y*s*(1-l)+m*(1-s)*l+this.grid[2*d]*s*l,y:g*(1-s)*(1-l)+b*s*(1-l)+f*(1-s)*l+this.grid[2*d+1]*s*l}}static IsWidthValid(e){return e>=128&&e<=1024}}},364:function(e,t,i){"use strict";let n;i.d(t,"a",(function(){return n})),function(e){e[e.NONE=0]="NONE",e[e.SPATIAL=1]="SPATIAL",e[e.SPECTRAL=2]="SPECTRAL"}(n||(n={}))},365:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(5);const r=new Map([[n.a.Moment.MEAN_OF_THE_SPECTRUM,{tag:"-1",text:"Mean value of the spectrum"}],[n.a.Moment.INTEGRATED_OF_THE_SPECTRUM,{tag:"0",text:"Integrated value of the spectrum"}],[n.a.Moment.INTENSITY_WEIGHTED_COORD,{tag:"1",text:"Intensity weighted coordinate"}],[n.a.Moment.INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD,{tag:"2",text:"Intensity weighted dispersion of the coordinate"}],[n.a.Moment.MEDIAN_OF_THE_SPECTRUM,{tag:"3",text:"Median value of the spectrum"}],[n.a.Moment.MEDIAN_COORDINATE,{tag:"4",text:"Median coordinate"}],[n.a.Moment.STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM,{tag:"5",text:"Standard deviation about the mean of the spectrum"}],[n.a.Moment.RMS_OF_THE_SPECTRUM,{tag:"6",text:"Root mean square of the spectrum"}],[n.a.Moment.ABS_MEAN_DEVIATION_OF_THE_SPECTRUM,{tag:"7",text:"Absolute mean deviation of the spectrum"}],[n.a.Moment.MAX_OF_THE_SPECTRUM,{tag:"8",text:"Maximum value of the spectrum"}],[n.a.Moment.COORD_OF_THE_MAX_OF_THE_SPECTRUM,{tag:"9",text:"Coordinate of the maximum value of the spectrum"}],[n.a.Moment.MIN_OF_THE_SPECTRUM,{tag:"10",text:"Minimum value of the spectrum"}],[n.a.Moment.COORD_OF_THE_MIN_OF_THE_SPECTRUM,{tag:"11",text:"Coordinate of the minimum value of the spectrum"}]])},4:function(e,t,i){"use strict";i.d(t,"b",(function(){return I})),i.d(t,"c",(function(){return q})),i.d(t,"F",(function(){return H})),i.d(t,"d",(function(){return U})),i.d(t,"e",(function(){return ne.a})),i.d(t,"q",(function(){return ae})),i.d(t,"p",(function(){return ke})),i.d(t,"o",(function(){return Fe})),i.d(t,"n",(function(){return Me})),i.d(t,"g",(function(){return Et})),i.d(t,"t",(function(){return It})),i.d(t,"s",(function(){return wt})),i.d(t,"J",(function(){return qi})),i.d(t,"S",(function(){return Hi})),i.d(t,"v",(function(){return Ui})),i.d(t,"A",(function(){return Ji})),i.d(t,"V",(function(){return ho})),i.d(t,"W",(function(){return go})),i.d(t,"y",(function(){return mo})),i.d(t,"R",(function(){return fo})),i.d(t,"C",(function(){return yo})),i.d(t,"B",(function(){return bo})),i.d(t,"f",(function(){return Oo})),i.d(t,"a",(function(){return So})),i.d(t,"D",(function(){return Ro})),i.d(t,"E",(function(){return jo})),i.d(t,"u",(function(){return _o.a})),i.d(t,"O",(function(){return _o.b})),i.d(t,"P",(function(){return zo})),i.d(t,"Q",(function(){return Ho})),i.d(t,"T",(function(){return ja})),i.d(t,"U",(function(){return Fa})),i.d(t,"h",(function(){return fs})),i.d(t,"K",(function(){return ys})),i.d(t,"N",(function(){return bs})),i.d(t,"L",(function(){return Ls})),i.d(t,"M",(function(){return _s})),i.d(t,"G",(function(){return nl})),i.d(t,"H",(function(){return ol})),i.d(t,"z",(function(){return Ol})),i.d(t,"r",(function(){return ac})),i.d(t,"k",(function(){return yc})),i.d(t,"w",(function(){return xc})),i.d(t,"x",(function(){return Ac})),i.d(t,"I",(function(){return Rc.a})),i.d(t,"i",(function(){return Pc.a})),i.d(t,"m",(function(){return Pc.d})),i.d(t,"l",(function(){return Pc.c})),i.d(t,"j",(function(){return Pc.b}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S=i(3),C=i(2),E=(i(29),i(1));let I=(n=Object(E.g)("show_alert"),r=Object(E.g)("dismiss_alert"),o=Object(E.g)("show_alert"),a=Object(E.g)("dismiss_alert"),O=b=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(S.a)(this,"alertVisible",l,this),Object(S.a)(this,"alertText",c,this),Object(S.a)(this,"alertIcon",u,this),Object(S.a)(this,"interactiveAlertVisible",p,this),Object(S.a)(this,"interactiveAlertText",d,this),this.interactiveAlertCallback=void 0,Object(S.a)(this,"showAlert",h,this),Object(S.a)(this,"dismissAlert",g,this),Object(S.a)(this,"showInteractiveAlert",m,this),Object(S.a)(this,"dismissInteractiveAlert",f,this),Object(S.a)(this,"handleInteractiveAlertClosed",y,this),Object(E.p)(this),this.alertVisible=!1,this.interactiveAlertVisible=!1}},b.staticInstance=void 0,s=O,l=Object(C.a)(s.prototype,"alertVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(C.a)(s.prototype,"alertText",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(C.a)(s.prototype,"alertIcon",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(C.a)(s.prototype,"interactiveAlertVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(C.a)(s.prototype,"interactiveAlertText",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(C.a)(s.prototype,"showAlert",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.alertText=e,this.alertIcon=t,this.alertVisible=!0}}}),g=Object(C.a)(s.prototype,"dismissAlert",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.alertVisible=!1}}}),m=Object(C.a)(s.prototype,"showInteractiveAlert",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.interactiveAlertText=e,this.alertIcon=i,this.interactiveAlertVisible=!0,this.interactiveAlertCallback=t}}}),f=Object(C.a)(s.prototype,"dismissInteractiveAlert",[a],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.interactiveAlertVisible=!1}}}),y=Object(C.a)(s.prototype,"handleInteractiveAlertClosed",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.interactiveAlertVisible=!1,this.interactiveAlertCallback&&this.interactiveAlertCallback(e)}}}),s);var w,T,v,A,x,R,P,j,k,F,M,D,N,L,_,z,W,G,V=i(5),B=i(6);let q,H;!function(e){e[e.CHANNEL=0]="CHANNEL",e[e.STOKES=1]="STOKES",e[e.FRAME=2]="FRAME"}(q||(q={})),function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD",e[e.BOUNCING=2]="BOUNCING",e[e.BLINK=3]="BLINK"}(H||(H={}));let U=(G=W=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(S.a)(this,"frameRate",T,this),Object(S.a)(this,"maxFrameRate",v,this),Object(S.a)(this,"minFrameRate",A,this),Object(S.a)(this,"step",x,this),Object(S.a)(this,"maxStep",R,this),Object(S.a)(this,"minStep",P,this),Object(S.a)(this,"animationMode",j,this),Object(S.a)(this,"animationActive",k,this),Object(S.a)(this,"playMode",F,this),Object(S.a)(this,"setAnimationMode",M,this),Object(S.a)(this,"setFrameRate",D,this),Object(S.a)(this,"setStep",N,this),Object(S.a)(this,"startAnimation",L,this),Object(S.a)(this,"stopAnimation",_,this),Object(S.a)(this,"animate",z,this),this.animateHandle=void 0,this.stopHandle=void 0,this.genAnimationFrames=e=>{if(!e)return null;let t,i,n,r={channel:e.channel,stokes:e.stokes};switch(this.animationMode===q.CHANNEL?(t={channel:e.animationChannelRange[0],stokes:e.stokes},i={channel:e.animationChannelRange[1],stokes:e.stokes},n={channel:this.step,stokes:0}):this.animationMode===q.STOKES&&(t={channel:e.channel,stokes:0},i={channel:e.channel,stokes:e.frameInfo.fileInfoExtended.stokes-1},n={channel:0,stokes:this.step}),this.playMode){case H.FORWARD:case H.BOUNCING:default:this.animationMode===q.CHANNEL?(r.channel<t.channel||r.channel>i.channel)&&(r.channel=t.channel):this.animationMode===q.STOKES&&(r.stokes<t.stokes||r.stokes>i.stokes)&&(r.stokes=t.stokes);break;case H.BACKWARD:this.animationMode===q.CHANNEL?((r.channel<t.channel||r.channel>i.channel)&&(r.channel=i.channel),n.channel=-1*this.step):this.animationMode===q.STOKES&&((r.stokes<t.stokes||r.stokes>i.stokes)&&(r.stokes=i.stokes),n.stokes=-1*this.step);break;case H.BLINK:this.animationMode===q.CHANNEL?r.channel=t.channel:this.animationMode===q.STOKES&&(r.stokes=t.stokes),this.animationMode===q.CHANNEL?n.channel=Math.abs(t.channel-i.channel):this.animationMode===q.STOKES&&(n.stokes=Math.abs(t.stokes-i.stokes))}return{startFrame:r,firstFrame:t,lastFrame:i,deltaFrame:n}},Object(E.p)(this),this.frameRate=5,this.maxFrameRate=15,this.minFrameRate=1,this.step=1,this.maxStep=50,this.minStep=1,this.animationMode=q.CHANNEL,this.animationActive=!1,this.animateHandle=null,this.playMode=H.FORWARD}get frameInterval(){return 1e3/Object(B.k)(this.frameRate,this.minFrameRate,this.maxFrameRate)}get serverAnimationActive(){return this.animationActive&&this.animationMode!==q.FRAME}},W.staticInstance=void 0,w=G,T=Object(C.a)(w.prototype,"frameRate",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Object(C.a)(w.prototype,"maxFrameRate",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(C.a)(w.prototype,"minFrameRate",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=Object(C.a)(w.prototype,"step",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(C.a)(w.prototype,"maxStep",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(C.a)(w.prototype,"minStep",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(C.a)(w.prototype,"animationMode",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(C.a)(w.prototype,"animationActive",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(C.a)(w.prototype,"playMode",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(C.a)(w.prototype,"setAnimationMode",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.animationActive||(this.animationMode=e)}}}),D=Object(C.a)(w.prototype,"setFrameRate",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.frameRate=e}}}),N=Object(C.a)(w.prototype,"setStep",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.step=e}}}),L=Object(C.a)(w.prototype,"startAnimation",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=ne.a.Instance,t=ol.Instance,i=e.activeFrame;if(!i)return;if(this.animationMode===q.FRAME)return clearInterval(this.animateHandle),this.animationActive=!1,this.animate(),void(this.animateHandle=setInterval(this.animate,this.frameInterval));const n=this.genAnimationFrames(i);if(!n)return;const r=i.requiredFrameView,o={xMin:Math.max(0,r.xMin),xMax:Math.min(i.frameInfo.fileInfoExtended.width,r.xMax),yMin:Math.max(0,r.yMin),yMax:Math.min(i.frameInfo.fileInfoExtended.height,r.yMax),mip:r.mip},a={x:i.frameInfo.fileInfoExtended.width,y:i.frameInfo.fileInfoExtended.height},s=Object(B.b)(o,a,{x:256,y:256}).map(e=>e.encode()),l={fileId:i.frameInfo.fileId,tiles:s,compressionType:V.a.CompressionType.ZFP,compressionQuality:t.animationCompressionQuality},c=new Map;for(const p of i.spectralSiblings){const e=Object(B.I)(i.fullWcsInfo,p.fullWcsInfo,t.spectralMatchingType,n.firstFrame.channel,n.lastFrame.channel);c.set(p.frameInfo.fileId,{frameNumbers:e})}const u={fileId:i.frameInfo.fileId,startFrame:n.startFrame,firstFrame:n.firstFrame,lastFrame:n.lastFrame,deltaFrame:n.deltaFrame,requiredTiles:l,looping:!0,reverse:this.playMode===H.BOUNCING,frameRate:this.frameRate,matchedFrames:Object(B.P)(c)};e.backendService.startAnimation(u).subscribe(()=>{console.log("Animation started successfully")},t=>{console.log(t),e.tileService.setAnimationEnabled(!1)}),e.tileService.setAnimationEnabled(!0),this.animationActive=!0,clearTimeout(this.stopHandle),this.stopHandle=setTimeout(this.stopAnimation,6e4*t.stopAnimationPlaybackMinutes)}}}),_=Object(C.a)(w.prototype,"stopAnimation",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(!this.animationActive)return;const e=ne.a.Instance,t=e.activeFrame;if(t)if(this.animationActive=!1,e.tileService.setAnimationEnabled(!1),this.animationMode===q.FRAME)clearInterval(this.animateHandle);else{const i={channel:t.channel,stokes:t.stokes},n={fileId:t.frameInfo.fileId,endFrame:i};e.backendService.stopAnimation(n),t.setChannels(t.channel,t.stokes,!0);const r=[{frame:t,channel:t.requiredChannel,stokes:t.requiredStokes}];t.spectralSiblings.forEach(e=>{r.push({frame:e,channel:e.requiredChannel,stokes:e.requiredStokes})}),e.throttledSetChannels(r)}}}}),z=Object(C.a)(w.prototype,"animate",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.animationActive&&this.animationMode===q.FRAME&&ne.a.Instance.nextFrame()}}}),Object(C.a)(w.prototype,"frameInterval",[E.i],Object.getOwnPropertyDescriptor(w.prototype,"frameInterval"),w.prototype),Object(C.a)(w.prototype,"serverAnimationActive",[E.i],Object.getOwnPropertyDescriptor(w.prototype,"serverAnimationActive"),w.prototype),w);var Y,X,K,Q,Z,$,J,ee,te,ie,ne=i(184),re=i(128),oe=i(28);let ae=(ie=te=class{get hasValidData(){return!!this.vertexData&&this.vertexData.length>0}get isComplete(){return this.progress>=1}constructor(){Object(S.a)(this,"progress",X,this),Object(S.a)(this,"numGeneratedVertices",K,this),Object(S.a)(this,"vertexCount",Q,this),Object(S.a)(this,"chunkCount",Z,this),this.indexOffsets=void 0,this.vertexData=void 0,this.vertexBuffers=void 0,this.gl=void 0,Object(S.a)(this,"setContourData",$,this),Object(S.a)(this,"addContourData",J,this),Object(S.a)(this,"clearData",ee,this),Object(E.p)(this),this.gl=oe.d.Instance.gl}generateBuffers(e){this.vertexBuffers||(this.vertexBuffers=[]),this.gl&&this.vertexBuffers.length===e?(this.vertexBuffers.push(this.gl.createBuffer()),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexBuffers[e]),this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,this.vertexData[e],WebGLRenderingContext.STATIC_DRAW),this.vertexData[e]=null):console.log("WebGL buffer index is incorrect!")}bindBuffer(e){!this.vertexBuffers||e>=this.vertexBuffers.length?console.log("WebGL buffer missing"):this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexBuffers[e])}},te.VertexDataElements=8,Y=ie,X=Object(C.a)(Y.prototype,"progress",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(C.a)(Y.prototype,"numGeneratedVertices",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=Object(C.a)(Y.prototype,"vertexCount",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Z=Object(C.a)(Y.prototype,"chunkCount",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(C.a)(Y.prototype,"hasValidData",[E.i],Object.getOwnPropertyDescriptor(Y.prototype,"hasValidData"),Y.prototype),Object(C.a)(Y.prototype,"isComplete",[E.i],Object.getOwnPropertyDescriptor(Y.prototype,"isComplete"),Y.prototype),$=Object(C.a)(Y.prototype,"setContourData",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.clearData(),this.addContourData(e,t,i)}}}),J=Object(C.a)(Y.prototype,"addContourData",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{const n=t.length/2;if(!n)return;this.vertexData||(this.vertexData=[]),this.indexOffsets||(this.indexOffsets=[]),this.numGeneratedVertices||(this.numGeneratedVertices=[]);const r=re.GenerateVertexData(t,e);this.vertexData.push(r),this.indexOffsets.push(e),this.progress=i,this.numGeneratedVertices.push(r.length/(ae.VertexDataElements/2));const o=this.vertexData.length-1;this.generateBuffers(o),this.vertexCount+=n,this.chunkCount++}}}),ee=Object(C.a)(Y.prototype,"clearData",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.indexOffsets=[],this.vertexData=[],this.numGeneratedVertices=[],this.vertexCount=0,this.chunkCount=0,this.gl&&this.vertexBuffers){const e=this.vertexBuffers.length;for(let t=0;t<e;t++)this.gl.deleteBuffer(this.vertexBuffers[t]);this.vertexBuffers=[]}}}}),Y);var se,le,ce,ue,pe,de,he,ge,me,fe,ye,be,Oe,Se,Ce,Ee,Ie,we,Te,ve,Ae,xe,Re,Pe=i(43),je=i.n(Pe);let ke,Fe;!function(e){e.StartStepMultiplier="start-step-multiplier",e.MinMaxNScaling="min-max-scaling",e.PercentagesRefValue="percentages-ref.value",e.MeanSigmaList="mean-sigma-list"}(ke||(ke={})),function(e){e[e.None=0]="None",e[e.Dashed=1]="Dashed",e[e.NegativeOnly=2]="NegativeOnly"}(Fe||(Fe={}));let Me=(se=class{constructor(e){Object(S.a)(this,"enabled",le,this),Object(S.a)(this,"levels",ce,this),Object(S.a)(this,"smoothingMode",ue,this),Object(S.a)(this,"smoothingFactor",pe,this),Object(S.a)(this,"color",de,this),Object(S.a)(this,"colormapEnabled",he,this),Object(S.a)(this,"colormap",ge,this),Object(S.a)(this,"colormapContrast",me,this),Object(S.a)(this,"colormapBias",fe,this),Object(S.a)(this,"dashMode",ye,this),Object(S.a)(this,"thickness",be,this),Object(S.a)(this,"visible",Oe,this),this.preferenceStore=void 0,Object(S.a)(this,"setContourConfiguration",Se,this),Object(S.a)(this,"setColor",Ce,this),Object(S.a)(this,"setDashMode",Ee,this),Object(S.a)(this,"setThickness",Ie,this),Object(S.a)(this,"setColormap",we,this),Object(S.a)(this,"setColormapEnabled",Te,this),Object(S.a)(this,"setColormapBias",ve,this),Object(S.a)(this,"setColormapContrast",Ae,this),Object(S.a)(this,"setVisible",xe,this),Object(S.a)(this,"toggleVisibility",Re,this),Object(E.p)(this),this.preferenceStore=e,this.enabled=!1,this.levels=[],this.smoothingMode=this.preferenceStore.contourSmoothingMode,this.smoothingFactor=this.preferenceStore.contourSmoothingFactor,this.color=je()(this.preferenceStore.contourColor).toRgb(),this.colormapEnabled=this.preferenceStore.contourColormapEnabled,this.colormap=this.preferenceStore.contourColormap,this.colormapBias=0,this.colormapContrast=1,this.thickness=1,this.dashMode=Fe.NegativeOnly,this.visible=!0}setEnabled(e){this.enabled=e}},le=Object(C.a)(se.prototype,"enabled",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=Object(C.a)(se.prototype,"levels",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ue=Object(C.a)(se.prototype,"smoothingMode",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=Object(C.a)(se.prototype,"smoothingFactor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de=Object(C.a)(se.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=Object(C.a)(se.prototype,"colormapEnabled",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ge=Object(C.a)(se.prototype,"colormap",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=Object(C.a)(se.prototype,"colormapContrast",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=Object(C.a)(se.prototype,"colormapBias",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye=Object(C.a)(se.prototype,"dashMode",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be=Object(C.a)(se.prototype,"thickness",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=Object(C.a)(se.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(se.prototype,"setEnabled",[E.g],Object.getOwnPropertyDescriptor(se.prototype,"setEnabled"),se.prototype),Se=Object(C.a)(se.prototype,"setContourConfiguration",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.levels=e,this.smoothingMode=t,this.smoothingFactor=i}}}),Ce=Object(C.a)(se.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=je()(e);t.isValid()&&(this.color=t.toRgb())}}}),Ee=Object(C.a)(se.prototype,"setDashMode",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dashMode=e}}}),Ie=Object(C.a)(se.prototype,"setThickness",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.thickness=e}}}),we=Object(C.a)(se.prototype,"setColormap",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormap=e}}}),Te=Object(C.a)(se.prototype,"setColormapEnabled",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapEnabled=e}}}),ve=Object(C.a)(se.prototype,"setColormapBias",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapBias=e}}}),Ae=Object(C.a)(se.prototype,"setColormapContrast",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapContrast=e}}}),xe=Object(C.a)(se.prototype,"setVisible",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),Re=Object(C.a)(se.prototype,"toggleVisibility",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),se);var De,Ne,Le,_e,ze,We,Ge,Ve,Be,qe,He,Ue,Ye,Xe,Ke,Qe,Ze,$e,Je,et,tt,it,nt,rt,ot,at,st,lt,ct,ut,pt,dt,ht,gt,mt,ft,yt,bt,Ot,St,Ct=i(13);let Et,It;!function(e){e[e.File=0]="File",e[e.SaveFile=1]="SaveFile",e[e.RegionImport=2]="RegionImport",e[e.RegionExport=3]="RegionExport",e[e.Catalog=4]="Catalog"}(Et||(Et={})),function(e){e.Fuzzy="fuzzy",e.Unix="unix",e.Regex="regex"}(It||(It={}));let wt=(St=Ot=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}selectParent(){const e=this.getfileListByMode;e&&e.parent&&this.getFileList(e.parent)}setSelectedTab(e){this.selectedTab=e}saveStartingDirectory(e){void 0!==e?this.startingDirectory=e:this.browserMode===Et.Catalog?this.startingDirectory=this.catalogFileList.directory:this.startingDirectory=this.fileList.directory}get HDUList(){var e;return this.HDUfileInfoExtended?null===(e=Object.keys(this.HDUfileInfoExtended))||void 0===e?void 0:e.map(e=>{var t,i,n,r;return{label:`${e}${(null===(t=this.HDUfileInfoExtended[e])||void 0===t||null===(i=t.computedEntries)||void 0===i?void 0:i.length)>=3&&"Extension name"===(null===(n=this.HDUfileInfoExtended[e].computedEntries[2])||void 0===n?void 0:n.name)?": "+(null===(r=this.HDUfileInfoExtended[e].computedEntries[2])||void 0===r?void 0:r.value):""}`,value:e}}):null}get fileInfoExtended(){return this.HDUfileInfoExtended&&this.selectedHDU in this.HDUfileInfoExtended?this.HDUfileInfoExtended[this.selectedHDU]:null}get fileInfo(){var e;let t="";return(null===(e=this.fileInfoExtended)||void 0===e?void 0:e.computedEntries)&&this.fileInfoExtended.computedEntries.forEach(e=>{t+=`${e.name} = ${e.value}\n`}),t}get headers(){var e;let t="";return(null===(e=this.fileInfoExtended)||void 0===e?void 0:e.headerEntries)&&this.fileInfoExtended.headerEntries.forEach(e=>{"END"===e.name?t+=e.name+"\n":t+=`${e.name} = ${e.value}\n`}),t}get getfileListByMode(){switch(this.browserMode){case Et.Catalog:return this.catalogFileList;default:return this.fileList}}get getBrowserMode(){switch(this.browserMode){case Et.File:case Et.SaveFile:return Ct.e.IMAGE_FILE;case Et.Catalog:return Ct.e.CATALOG_FILE;default:return Ct.e.REGION_FILE}}get catalogHeaderDataset(){let e=new Map;const t=[],i=[],n=[],r=[];for(let a=0;a<this.catalogHeaders.length;a++){const e=this.catalogHeaders[a];t.push(e.name),i.push(e.units),n.push(Object(B.A)(e.dataType)),r.push(e.description)}const o=V.a.ColumnType.String;return e.set(0,{dataType:o,data:t}),e.set(1,{dataType:o,data:i}),e.set(2,{dataType:o,data:n}),e.set(3,{dataType:o,data:r}),{columnHeaders:[new V.a.CatalogHeader({name:"Name",dataType:o,columnIndex:0}),new V.a.CatalogHeader({name:"Unit",dataType:o,columnIndex:1}),new V.a.CatalogHeader({name:"Data Type",dataType:o,columnIndex:2}),new V.a.CatalogHeader({name:"Description",dataType:o,columnIndex:3})],columnsData:e}}constructor(){Object(S.a)(this,"browserMode",Ne,this),Object(S.a)(this,"appendingFrame",Le,this),Object(S.a)(this,"fileList",_e,this),Object(S.a)(this,"selectedFile",ze,this),Object(S.a)(this,"selectedHDU",We,this),Object(S.a)(this,"HDUfileInfoExtended",Ge,this),Object(S.a)(this,"regionFileInfo",Ve,this),Object(S.a)(this,"selectedTab",Be,this),Object(S.a)(this,"loadingList",qe,this),Object(S.a)(this,"loadingInfo",He,this),Object(S.a)(this,"fileInfoResp",Ue,this),Object(S.a)(this,"responseErrorMessage",Ye,this),Object(S.a)(this,"startingDirectory",Xe,this),Object(S.a)(this,"exportFilename",Ke,this),Object(S.a)(this,"exportCoordinateType",Qe,this),Object(S.a)(this,"exportFileType",Ze,this),Object(S.a)(this,"catalogFileList",$e,this),Object(S.a)(this,"selectedCatalogFile",Je,this),Object(S.a)(this,"catalogFileInfo",et,this),Object(S.a)(this,"catalogHeaders",tt,this),Object(S.a)(this,"saveFilename",it,this),Object(S.a)(this,"saveFileType",nt,this),Object(S.a)(this,"showFileBrowser",rt,this),Object(S.a)(this,"hideFileBrowser",ot,this),Object(S.a)(this,"getFileList",at,this),Object(S.a)(this,"getFileInfo",st,this),Object(S.a)(this,"getRegionFileInfo",lt,this),Object(S.a)(this,"getCatalogFileInfo",ct,this),Object(S.a)(this,"selectFile",ut,this),Object(S.a)(this,"selectFolder",pt,this),Object(S.a)(this,"selectHDU",dt,this),Object(S.a)(this,"setExportFilename",ht,this),Object(S.a)(this,"setExportCoordinateType",gt,this),Object(S.a)(this,"setExportFileType",mt,this),Object(S.a)(this,"setSaveFilename",ft,this),Object(S.a)(this,"setSaveFileType",yt,this),Object(S.a)(this,"setSortingConfig",bt,this),Object(E.p)(this),this.exportCoordinateType=V.a.CoordinateType.WORLD,this.exportFileType=V.a.FileType.CRTF}},Ot.staticInstance=void 0,De=St,Ne=Object(C.a)(De.prototype,"browserMode",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Et.File}}),Le=Object(C.a)(De.prototype,"appendingFrame",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_e=Object(C.a)(De.prototype,"fileList",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Object(C.a)(De.prototype,"selectedFile",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=Object(C.a)(De.prototype,"selectedHDU",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=Object(C.a)(De.prototype,"HDUfileInfoExtended",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Object(C.a)(De.prototype,"regionFileInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=Object(C.a)(De.prototype,"selectedTab",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ct.e.IMAGE_FILE}}),qe=Object(C.a)(De.prototype,"loadingList",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),He=Object(C.a)(De.prototype,"loadingInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ue=Object(C.a)(De.prototype,"fileInfoResp",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ye=Object(C.a)(De.prototype,"responseErrorMessage",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Xe=Object(C.a)(De.prototype,"startingDirectory",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$BASE"}}),Ke=Object(C.a)(De.prototype,"exportFilename",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qe=Object(C.a)(De.prototype,"exportCoordinateType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ze=Object(C.a)(De.prototype,"exportFileType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Object(C.a)(De.prototype,"catalogFileList",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Object(C.a)(De.prototype,"selectedCatalogFile",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=Object(C.a)(De.prototype,"catalogFileInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt=Object(C.a)(De.prototype,"catalogHeaders",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=Object(C.a)(De.prototype,"saveFilename",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),nt=Object(C.a)(De.prototype,"saveFileType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return V.a.FileType.CASA}}),rt=Object(C.a)(De.prototype,"showFileBrowser",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.appendingFrame=t,this.browserMode=e,ac.Instance.showFileBrowserDialog(),this.fileList=null,this.selectedTab=this.getBrowserMode,this.responseErrorMessage="",this.exportFilename="",this.catalogFileList=null,this.getFileList(this.startingDirectory),ne.a.Instance.activeFrame&&e===Et.SaveFile&&(this.saveFilename=ne.a.Instance.activeFrame.frameInfo.fileInfo.name)}}}),ot=Object(C.a)(De.prototype,"hideFileBrowser",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{ac.Instance.hideFileBrowserDialog()}}}),at=Object(C.a)(De.prototype,"getFileList",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=oe.b.Instance;this.loadingList=!0,this.selectedFile=null,this.selectedHDU=null,this.HDUfileInfoExtended=null,this.regionFileInfo=null,this.catalogFileInfo=null,this.browserMode===Et.File||this.browserMode===Et.SaveFile?t.getFileList(e).subscribe(e=>Object(E.r)(()=>{this.fileList=e,this.loadingList=!1}),e=>Object(E.r)(()=>{console.log(e),this.loadingList=!1})):this.browserMode===Et.Catalog?t.getCatalogList(e).subscribe(e=>Object(E.r)(()=>{this.catalogFileList=e,this.loadingList=!1}),e=>Object(E.r)(()=>{console.log(e),this.loadingList=!1})):t.getRegionList(e).subscribe(e=>Object(E.r)(()=>{this.fileList=e,this.loadingList=!1}),e=>Object(E.r)(()=>{console.log(e),this.loadingList=!1}))}}}),st=Object(C.a)(De.prototype,"getFileInfo",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{const n=oe.b.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.HDUfileInfoExtended=null,this.responseErrorMessage="",n.getFileInfo(e,t,i).subscribe(e=>Object(E.r)(()=>{if(e.fileInfo&&this.selectedFile&&e.fileInfo.name===this.selectedFile.name){this.HDUfileInfoExtended=e.fileInfoExtended;const t=Object.keys(this.HDUfileInfoExtended);(null===t||void 0===t?void 0:t.length)>=1&&(this.selectedHDU=t[0]),this.loadingInfo=!1}this.fileInfoResp=!0}),e=>Object(E.r)(()=>{console.log(e),this.responseErrorMessage=e,this.fileInfoResp=!1,this.HDUfileInfoExtended=null,this.loadingInfo=!1}))}}}),lt=Object(C.a)(De.prototype,"getRegionFileInfo",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=oe.b.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.regionFileInfo=null,this.responseErrorMessage="",i.getRegionFileInfo(e,t).subscribe(e=>Object(E.r)(()=>{e.fileInfo&&this.selectedFile&&e.fileInfo.name===this.selectedFile.name&&(this.loadingInfo=!1,this.regionFileInfo=e.contents),this.fileInfoResp=!0}),e=>Object(E.r)(()=>{console.log(e),this.responseErrorMessage=e,this.fileInfoResp=!1,this.regionFileInfo=null,this.loadingInfo=!1}))}}}),ct=Object(C.a)(De.prototype,"getCatalogFileInfo",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=oe.b.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.catalogFileInfo=null,this.catalogHeaders=[],this.responseErrorMessage="",i.getCatalogFileInfo(e,t).subscribe(e=>Object(E.r)(()=>{e.fileInfo&&this.selectedFile&&e.fileInfo.name===this.selectedFile.name&&(this.loadingInfo=!1,this.catalogFileInfo=e.fileInfo,this.catalogHeaders=e.headers.sort((e,t)=>e.columnIndex-t.columnIndex)),this.fileInfoResp=!0}),e=>Object(E.r)(()=>{console.log(e),this.responseErrorMessage=e,this.fileInfoResp=!1,this.catalogFileInfo=null,this.loadingInfo=!1}))}}}),ut=Object(C.a)(De.prototype,"selectFile",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.getfileListByMode;this.selectedFile=e.fileInfo,e.hdu&&(this.selectedHDU=e.hdu),this.browserMode===Et.File?this.getFileInfo(t.directory,e.fileInfo.name,e.hdu):this.browserMode===Et.SaveFile?(this.getFileInfo(t.directory,e.fileInfo.name,e.hdu),this.saveFilename=e.fileInfo.name):this.browserMode===Et.Catalog?this.getCatalogFileInfo(t.directory,e.fileInfo.name):(this.setExportFilename(e.fileInfo.name),this.getRegionFileInfo(t.directory,e.fileInfo.name))}}}),pt=Object(C.a)(De.prototype,"selectFolder",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{if(t)return void this.getFileList(e);const i=this.getfileListByMode;if(".."===e)this.selectParent();else if(i){const t=i.directory;let n=e;!t.length||1===t.length&&"/"===t[0]||(n=`${t}/${e}`),this.getFileList(n)}}}}),Object(C.a)(De.prototype,"selectParent",[E.g],Object.getOwnPropertyDescriptor(De.prototype,"selectParent"),De.prototype),dt=Object(C.a)(De.prototype,"selectHDU",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e in this.HDUfileInfoExtended&&(this.selectedHDU=e)}}}),Object(C.a)(De.prototype,"setSelectedTab",[E.g],Object.getOwnPropertyDescriptor(De.prototype,"setSelectedTab"),De.prototype),Object(C.a)(De.prototype,"saveStartingDirectory",[E.g],Object.getOwnPropertyDescriptor(De.prototype,"saveStartingDirectory"),De.prototype),ht=Object(C.a)(De.prototype,"setExportFilename",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportFilename=e}}}),gt=Object(C.a)(De.prototype,"setExportCoordinateType",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportCoordinateType=e}}}),mt=Object(C.a)(De.prototype,"setExportFileType",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportFileType=e}}}),ft=Object(C.a)(De.prototype,"setSaveFilename",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFilename=e}}}),yt=Object(C.a)(De.prototype,"setSaveFileType",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFileType=e}}}),bt=Object(C.a)(De.prototype,"setSortingConfig",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=(t>=0?"+":"-")+e.toLowerCase();ol.Instance.setPreference(nl.SILENT_FILE_SORTING_STRING,i)}}}),Object(C.a)(De.prototype,"HDUList",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"HDUList"),De.prototype),Object(C.a)(De.prototype,"fileInfoExtended",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"fileInfoExtended"),De.prototype),Object(C.a)(De.prototype,"fileInfo",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"fileInfo"),De.prototype),Object(C.a)(De.prototype,"headers",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"headers"),De.prototype),Object(C.a)(De.prototype,"getfileListByMode",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"getfileListByMode"),De.prototype),Object(C.a)(De.prototype,"getBrowserMode",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"getBrowserMode"),De.prototype),Object(C.a)(De.prototype,"catalogHeaderDataset",[E.i],Object.getOwnPropertyDescriptor(De.prototype,"catalogHeaderDataset"),De.prototype),De);var Tt,vt,At,xt,Rt,Pt,jt,kt,Ft,Mt,Dt,Nt,Lt,_t,zt,Wt,Gt,Vt,Bt,qt,Ht,Ut,Yt,Xt,Kt,Qt,Zt,$t,Jt,ei,ti,ii,ni,ri,oi,ai,si,li,ci,ui,pi,di,hi,gi,mi,fi,yi,bi,Oi,Si,Ci,Ei,Ii,wi,Ti,vi,Ai,xi,Ri,Pi,ji,ki,Fi,Mi,Di,Ni,Li,_i,zi,Wi,Gi=i(22),Vi=i(10),Bi=i(12);let qi;!function(e){e[e.NONE=0]="NONE",e[e.TILED=1]="TILED"}(qi||(qi={}));const Hi=10;let Ui=(Wi=zi=class e{get filename(){var e,t,i,n,r,o,a,s,l;const c=(null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t||null===(i=t.computedEntries)||void 0===i?void 0:i.length)>=3&&"Extension name"===(null===(n=this.frameInfo)||void 0===n||null===(r=n.fileInfoExtended)||void 0===r||null===(o=r.computedEntries[2])||void 0===o?void 0:o.name)?"_"+(null===(a=this.frameInfo.fileInfoExtended.computedEntries[2])||void 0===a?void 0:a.value):"";return""!==(null===(s=this.frameInfo)||void 0===s?void 0:s.hdu)&&"0"!==(null===(l=this.frameInfo)||void 0===l?void 0:l.hdu)?`${this.frameInfo.fileInfo.name}.HDU_${this.frameInfo.hdu}${c}`:this.frameInfo.fileInfo.name}get regionSet(){return this.spatialReference?this.spatialReference.regionSet:this.frameRegionSet}get sharedRegions(){return!!this.spatialReference}get requiredFrameView(){if(this.spatialReference){const e=this.spatialReference.requiredFrameView,t=[this.spatialTransform.transformCoordinate({x:e.xMin,y:e.yMin},!1),this.spatialTransform.transformCoordinate({x:e.xMin,y:e.yMax},!1),this.spatialTransform.transformCoordinate({x:e.xMax,y:e.yMax},!1),this.spatialTransform.transformCoordinate({x:e.xMax,y:e.yMin},!1)],{minPoint:i,maxPoint:n}=Object(B.R)(t),r=(ol.Instance.lowBandwidthMode?2:1)/this.spatialTransform.scale,o=Math.max(1,r/this.spatialReference.zoomLevel),a=Math.log2(o),s=Math.round(a);return{xMin:i.x,xMax:n.x,yMin:i.y,yMax:n.y,mip:Math.pow(2,s)}}{if(this.zoomLevel<=0||!this.isRenderable)return{xMin:0,xMax:1,yMin:0,yMax:1,mip:1};const e=this.renderHiDPI?devicePixelRatio:1,t=e*this.renderWidth/this.zoomLevel,i=e*this.renderHeight/this.zoomLevel,n=ol.Instance.lowBandwidthMode?2:1,r=Math.max(1,n/this.zoomLevel),o=Math.log2(r),a=Math.round(o),s=Math.pow(2,a);return{xMin:this.center.x-t/2,xMax:this.center.x+t/2,yMin:this.center.y-i/2,yMax:this.center.y+i/2,mip:s}}}get spatialTransform(){if(this.spatialReference&&this.spatialTransformAST){const e=Object(B.lb)(this.spatialTransformAST,this.spatialReference.center,!1);return Object(B.L)(e)?new Vi.Transform2D(this.spatialTransformAST,{x:this.frameInfo.fileInfoExtended.width/2+.5,y:this.frameInfo.fileInfoExtended.height/2+.5}):new Vi.Transform2D(this.spatialTransformAST,e)}return null}get transformedWcsInfo(){if(this.spatialTransform){let e={x:-this.spatialTransform.translation.x/this.spatialTransform.scale,y:-this.spatialTransform.translation.y/this.spatialTransform.scale};return e=Object(B.ab)(e,-this.spatialTransform.rotation),this.cachedTransformedWcsInfo>=0&&Gi.delete(this.cachedTransformedWcsInfo),this.cachedTransformedWcsInfo=Gi.createTransformedFrameset(this.wcsInfo,e.x,e.y,-this.spatialTransform.rotation,this.spatialTransform.origin.x,this.spatialTransform.origin.y,1/this.spatialTransform.scale,1/this.spatialTransform.scale),this.cachedTransformedWcsInfo}return null}get renderWidth(){return this.overlayStore.renderWidth}get renderHeight(){return this.overlayStore.renderHeight}get isRenderable(){return this.renderWidth>0&&this.renderHeight>0}get unit(){if(this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.headerEntries){const e=this.frameInfo.fileInfoExtended.headerEntries.filter(e=>"BUNIT"===e.name);return e.length?Object(B.mb)(e[0].value):void 0}}get beamProperties(){const e=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CUNIT1")),t=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CDELT1"));if(e&&t){const i=e.value.trim(),n=Object(B.C)(t);if(isFinite(n)&&("deg"===i||"rad"===i)&&this.frameInfo.beamTable&&this.frameInfo.beamTable.length>0){let e;if(1===this.frameInfo.beamTable.length&&-1===this.frameInfo.beamTable[0].channel&&-1===this.frameInfo.beamTable[0].stokes?e=this.frameInfo.beamTable[0]:this.frameInfo.fileInfoExtended.depth>1&&this.frameInfo.fileInfoExtended.stokes>1?e=this.frameInfo.beamTable.find(e=>e.channel===this.requiredChannel&&e.stokes===this.requiredStokes):this.frameInfo.fileInfoExtended.depth>1&&this.frameInfo.fileInfoExtended.stokes<=1?e=this.frameInfo.beamTable.find(e=>e.channel===this.requiredChannel):this.frameInfo.fileInfoExtended.depth<=1&&this.frameInfo.fileInfoExtended.stokes>1&&(e=this.frameInfo.beamTable.find(e=>e.stokes===this.requiredStokes)),e&&isFinite(e.majorAxis)&&e.majorAxis>0&&isFinite(e.minorAxis)&&e.minorAxis>0&&isFinite(e.pa))return{x:e.majorAxis/("deg"===i?3600:648e3/Math.PI)/Math.abs(n),y:e.minorAxis/("deg"===i?3600:648e3/Math.PI)/Math.abs(n),angle:e.pa,overlayBeamSettings:this.overlayBeamSettings}}}return null}get hasVisibleBeam(){var e,t;return null===(e=this.beamProperties)||void 0===e||null===(t=e.overlayBeamSettings)||void 0===t?void 0:t.visible}get channelInfo(){if(!this.frameInfo||!this.frameInfo.fileInfoExtended||this.frameInfo.fileInfoExtended.depth<=1||!this.frameInfo.fileInfoExtended.headerEntries)return;const e=this.frameInfo.fileInfoExtended.depth,t=new Array(e),i=new Array(e),n=new Array(e);let r=t=>{if(!t)return null;if(t<0)return 0;if(t>e-1)return e-1;const i=Math.ceil(t),n=Math.floor(t);return i-t<t-n?i:n};if(this.spectralAxis){const o=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CRPIX"+this.spectralAxis.dimension)),a=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CRVAL"+this.spectralAxis.dimension)),s=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CDELT"+this.spectralAxis.dimension));if(o&&a&&s){const l=Object(B.C)(o)-1,c=Object(B.C)(a),u=Object(B.C)(s);if(isFinite(l)&&isFinite(c)&&isFinite(u)){for(let r=0;r<e;r++){const e=r-l;t[r]=r,n[r]=e*u+c,i[r]=n[r]}return{fromWCS:!0,channelType:this.spectralAxis.type,indexes:t,values:i,rawValues:n,getChannelIndexWCS:e=>{if(!e)return null;const t=(e-c)/u+l;if(t<0)return 0;if(t>i.length-1)return i.length-1;const n=Math.ceil(t),r=Math.floor(t);return Math.abs(i[n]-e)<Math.abs(e-i[r])?n:r},getChannelIndexSimple:r}}}}for(let o=0;o<e;o++)t[o]=o,i[o]=o,n[o]=o;return{fromWCS:!1,channelType:{code:"",name:"Channel",unit:""},indexes:t,values:i,rawValues:n,getChannelIndexWCS:null,getChannelIndexSimple:r}}get spectralInfo(){const e={channel:this.channel,channelType:{code:"",name:"Channel",unit:""},specsys:"",spectralString:""};if(this.frameInfo.fileInfoExtended.depth>1){const t=this.channelInfo;if(e.channelType=t.channelType,t.channelType.code){const i=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("SPECSYS"));if(i&&i.value&&(e.specsys=Object(B.mb)(i.value).toUpperCase()),e.spectralString=`${t.channelType.name} (${e.specsys}): ${Object(B.kb)(t.values[this.channel],4)} ${t.channelType.unit}`,"FREQ"===t.channelType.code){const i=t.rawValues[this.channel];if(this.isSpectralCoordinateConvertible&&t.channelType.unit!==Vi.SPECTRAL_DEFAULT_UNIT.get(Vi.SpectralType.FREQ)){const t=this.astSpectralTransform(Vi.SpectralType.FREQ,Vi.SpectralUnit.GHZ,this.spectralSystem,i);isFinite(t)&&(e.spectralString=`Frequency (${this.spectralSystem}): ${Object(B.v)(t)}`)}const n=this.astSpectralTransform(Vi.SpectralType.VRAD,Vi.SpectralUnit.KMS,this.spectralSystem,i);isFinite(n)&&(e.velocityString=`Velocity: ${Object(B.kb)(n,4)} km/s`)}else if("VRAD"===t.channelType.code){const i=t.rawValues[this.channel];if(this.isSpectralCoordinateConvertible&&t.channelType.unit!==Vi.SPECTRAL_DEFAULT_UNIT.get(Vi.SpectralType.VRAD)){const t=this.astSpectralTransform(Vi.SpectralType.VRAD,Vi.SpectralUnit.KMS,this.spectralSystem,i);isFinite(t)&&(e.spectralString=`Velocity (${this.spectralSystem}): ${Object(B.kb)(t,4)} km/s`)}const n=this.astSpectralTransform(Vi.SpectralType.FREQ,Vi.SpectralUnit.GHZ,this.spectralSystem,i);isFinite(n)&&(e.freqString="Frequency: "+Object(B.v)(n))}}}return e}get simpleSpectralInfo(){var e,t;const i=this.spectralInfo.freqString?this.spectralInfo.freqString:this.spectralInfo.velocityString;return`${null===(e=this.spectralInfo.spectralString)||void 0===e||null===(t=e.replace(/\w+\s\(/,""))||void 0===t?void 0:t.replace(/\):\s/,"\n")}${null===i||void 0===i?void 0:i.replace(/\w+:\s/,"\n")}`}get spectralAxis(){if(!this.frameInfo||!this.frameInfo.fileInfoExtended||this.frameInfo.fileInfoExtended.depth<=1||!this.frameInfo.fileInfoExtended.headerEntries)return;const e=this.frameInfo.fileInfoExtended.headerEntries,t=e.find(e=>e.name.includes("CTYPE3")),i=e.find(e=>e.name.includes("CTYPE4"));if(!(!t&&!i||t&&t.value.match(/stokes/i)&&!i||!t&&i&&i.value.match(/stokes/i)||t&&t.value.match(/stokes/i)&&i&&i.value.match(/stokes/i))){if(t&&!t.value.match(/stokes/i)){const i=t.value.trim().toUpperCase(),n=Vi.CHANNEL_TYPES.find(e=>i===e.code),r=e.find(e=>e.name.includes("CUNIT3"));return n?{valid:!0,dimension:3,type:{name:n.name,code:n.code,unit:r?r.value.trim():n.unit}}:{valid:!1,dimension:3,type:{name:i,code:i,unit:r?r.value.trim():void 0}}}if(i&&!i.value.match(/stokes/i)){const t=i.value.trim().toUpperCase(),n=Vi.CHANNEL_TYPES.find(e=>t===e.code),r=e.find(e=>e.name.includes("CUNIT4"));return n?{valid:!0,dimension:4,type:{name:n.name,code:n.code,unit:r?r.value.trim():n.unit}}:{valid:!1,dimension:4,type:{name:t,code:t,unit:r?r.value.trim():void 0}}}}}get isSpectralCoordinateConvertible(){return!(!this.spectralAxis||this.spectralAxis&&!this.spectralAxis.valid||!this.spectralFrame)&&(Object(Vi.IsSpectralTypeSupported)(this.spectralAxis.type.code)&&Object(Vi.IsSpectralUnitSupported)(this.spectralAxis.type.unit))}get isSpectralSystemConvertible(){return!(!this.spectralInfo||!this.spectralFrame)&&Object(Vi.IsSpectralSystemSupported)(this.spectralInfo.specsys)}get isSpectralPropsEqual(){let e=!1;if(this.spectralInfo&&this.spectralInfo.channelType){const t=this.spectralInfo.channelType.code===this.spectralType,i=this.spectralInfo.channelType.unit===this.spectralUnit,n=this.spectralInfo.specsys===this.spectralSystem;e=t&&i&&n}return e}get isCoordChannel(){return this.spectralType===Vi.SpectralType.CHANNEL}get nativeSpectralCoordinate(){return this.spectralAxis?`${this.spectralAxis.type.name} (${this.spectralAxis.type.unit})`:void 0}get spectralCoordinate(){return this.spectralType||this.spectralUnit?Object(Vi.GenCoordinateLabel)(this.spectralType,this.spectralUnit):this.nativeSpectralCoordinate}get spectralUnitStr(){return!this.spectralAxis||this.spectralType||this.spectralUnit?this.isCoordChannel?Vi.SPECTRAL_TYPE_STRING.get(Vi.SpectralType.CHANNEL):this.spectralUnit:this.spectralAxis.type.unit}get hasStokes(){return this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.stokes>1}get numChannels(){return this.frameInfo.fileInfoExtended.depth}get channelValueBounds(){if(this.numChannels>1&&this.channelValues){const e=this.channelValues[0],t=this.channelValues[this.numChannels-1];return new V.a.FloatBounds(e<=t?{min:e,max:t}:{min:t,max:e})}return null}get spectralSiblings(){if(this.spectralReference){let e=[];return e.push(this.spectralReference),e.push(...this.spectralReference.secondarySpectralImages.slice().filter(e=>e!==this)),e}return this.secondarySpectralImages.slice()}get spatialSiblings(){if(this.spatialReference){let e=[];return e.push(this.spatialReference),e.push(...this.spatialReference.secondarySpatialImages.slice().filter(e=>e!==this)),e}return this.secondarySpatialImages.slice()}get renderConfigSiblings(){if(this.rasterScalingReference){let e=[];return e.push(this.rasterScalingReference),e.push(...this.rasterScalingReference.secondaryRasterScalingImages.slice().filter(e=>e!==this)),e}return this.secondaryRasterScalingImages.slice()}get isCursorValueCurrent(){if(!this.cursorValue||!this.cursorInfo)return!1;const e=Object(B.bb)(this.cursorInfo.posImageSpace),t=Object(B.bb)(this.cursorValue.position);return this.cursorValue.channel===this.channel&&e.x===t.x&&e.y===t.y}get zoomLevelForFit(){return Math.min(this.calculateZoomX,this.calculateZoomY)}get calculateZoomX(){const e=this.frameInfo.fileInfoExtended.width,t=this.renderHiDPI?devicePixelRatio:1;return e<=0?1:this.renderWidth*t/e}get calculateZoomY(){const e=this.frameInfo.fileInfoExtended.height,t=this.renderHiDPI?devicePixelRatio:1;return e<=0?1:this.renderHeight*t/e}get contourProgress(){if(!this.contourConfig.levels||!this.contourConfig.levels.length||!this.contourConfig.enabled)return-1;if(!this.contourStores||!this.contourStores.size)return 0;let e=0;return this.contourStores.forEach((t,i)=>{-1!==this.contourConfig.levels.indexOf(i)&&(e+=t.progress)}),e/(this.contourConfig.levels?this.contourConfig.levels.length:1)}get stokesInfo(){if(this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.headerEntries){const e=this.frameInfo.fileInfoExtended.headerEntries.find(e=>"STOKES"===e.value.toUpperCase());if(e&&-1!==e.name.indexOf("CTYPE")){const t=e.name.substring(5),i=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("NAXIS"+t)),n=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CRPIX"+t)),r=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CRVAL"+t)),o=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CDELT"+t));let a=[];for(let e=0;e<parseInt(i.value);e++){switch(Object(B.C)(r)+(e+1-Object(B.C)(n))*Object(B.C)(o)){case 1:a.push("I");break;case 2:a.push("Q");break;case 3:a.push("U");break;case 4:a.push("V")}}return a}}return[]}getRegionWcsProperties(e){if(!this.validWcs||!isFinite(e.center.x)||!isFinite(e.center.y))return"Invalid";const t=Object(B.B)(this.wcsInfoForTransformation,e.center);if(!t)return"Invalid";const i=e.regionId===Bi.k.CURSOR?`${this.cursorInfo.infoWCS.x}, ${this.cursorInfo.infoWCS.y}`:`${t.x}, ${t.y}`,n=this.getWcsSizeInArcsec(e.size),r=n?{x:Object(B.t)(n.x,Hi),y:Object(B.t)(n.y,Hi)}:null,o=jo.Instance.global.explicitSystem;switch(e.regionType){case V.a.RegionType.POINT:return`Point (wcs:${o}) [${i}]`;case V.a.RegionType.RECTANGLE:return`rotbox(wcs:${o})[[${i}], [${r.x}, ${r.y}], ${Object(B.kb)(e.rotation,1)}deg]`;case V.a.RegionType.ELLIPSE:return`ellipse(wcs:${o})[[${i}], [${r.x}, ${r.y}], ${Object(B.kb)(e.rotation,1)}deg]`;case V.a.RegionType.POLYGON:return`polygon(wcs:${o})[[${i}], [${r.x}, ${r.y}], ${Object(B.kb)(e.rotation,1)}deg]`;default:return"Not Implemented"}}constructor(t){this.astFrameSet=void 0,this.spectralFrame=void 0,this.spectralCoordsSupported=void 0,this.spectralSystemsSupported=void 0,Object(S.a)(this,"frameRegionSet",vt,this),Object(S.a)(this,"frameInfo",At,this),Object(S.a)(this,"renderHiDPI",xt,this),Object(S.a)(this,"wcsInfo",Rt,this),Object(S.a)(this,"wcsInfoForTransformation",Pt,this),Object(S.a)(this,"spectralType",jt,this),Object(S.a)(this,"spectralUnit",kt,this),Object(S.a)(this,"spectralSystem",Ft,this),Object(S.a)(this,"channelValues",Mt,this),Object(S.a)(this,"fullWcsInfo",Dt,this),Object(S.a)(this,"validWcs",Nt,this),Object(S.a)(this,"center",Lt,this),Object(S.a)(this,"cursorInfo",_t,this),Object(S.a)(this,"cursorValue",zt,this),Object(S.a)(this,"zoomLevel",Wt,this),Object(S.a)(this,"stokes",Gt,this),Object(S.a)(this,"channel",Vt,this),Object(S.a)(this,"requiredStokes",Bt,this),Object(S.a)(this,"requiredChannel",qt,this),Object(S.a)(this,"animationChannelRange",Ht,this),Object(S.a)(this,"renderType",Ut,this),Object(S.a)(this,"currentFrameView",Yt,this),Object(S.a)(this,"currentCompressionQuality",Xt,this),Object(S.a)(this,"renderConfig",Kt,this),Object(S.a)(this,"contourConfig",Qt,this),Object(S.a)(this,"contourStores",Zt,this),Object(S.a)(this,"valid",$t,this),Object(S.a)(this,"moving",Jt,this),Object(S.a)(this,"zooming",ei,this),Object(S.a)(this,"overlayBeamSettings",ti,this),Object(S.a)(this,"spatialReference",ii,this),Object(S.a)(this,"spectralReference",ni,this),Object(S.a)(this,"rasterScalingReference",ri,this),Object(S.a)(this,"secondarySpatialImages",oi,this),Object(S.a)(this,"secondarySpectralImages",ai,this),Object(S.a)(this,"secondaryRasterScalingImages",si,this),Object(S.a)(this,"momentImages",li,this),Object(S.a)(this,"isRequestingMoments",ci,this),Object(S.a)(this,"requestingMomentsProgress",ui,this),this.overlayStore=void 0,this.logStore=void 0,this.backendService=void 0,this.controlMaps=void 0,this.spatialTransformAST=void 0,this.spectralTransformAST=void 0,this.cachedTransformedWcsInfo=-1,this.zoomTimeoutHandler=void 0,this.convertSpectral=e=>e&&e.length>0?e.map(e=>this.astSpectralTransform(this.spectralType,this.spectralUnit,this.spectralSystem,e)):null,this.astSpectralTransform=(e,t,i,n)=>{if(this.spectralFrame&&isFinite(n))return Gi.transformSpectralPoint(this.spectralFrame,e,t,i,n)},Object(S.a)(this,"initSkyWCS",pi,this),Object(S.a)(this,"initFullWCS",di,this),this.initFrame=()=>{if(!this.spectralAxis||!this.spectralAxis.valid)return null;let t="";const i=this.frameInfo.fileInfoExtended.headerEntries;for(let n of i){if(!n.value.length)continue;let i=n.name,r=Object(B.mb)(n.value);for(r=n.entryType===V.a.EntryType.STRING?`'${r}'`:e.ShiftASTCoords(n,r);i.length<8;)i+=" ";let o=`${i}=  ${r}`;for(;o.length<80;)o+=" ";t+=o}return Gi.initFrame(t)},Object(S.a)(this,"initSupportedSpectralConversion",hi,this),this.convertToNativeWCS=e=>{if(this.spectralFrame&&isFinite(e))return Gi.transformSpectralPoint(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e,!1)},this.convertFreqMHzToSettingWCS=e=>{if(!this.spectralFrame||!isFinite(e))return;if(this.spectralType===Vi.SpectralType.FREQ&&this.spectralUnit===Vi.SpectralUnit.MHZ)return e;const t=Gi.transformSpectralPoint(this.spectralFrame,Vi.SpectralType.FREQ,Vi.SpectralUnit.MHZ,this.spectralSystem,e,!1);if(!isFinite(t))return;const i=this.astSpectralTransform(this.spectralType,this.spectralUnit,this.spectralSystem,t);return isFinite(i)?i:void 0},this.findChannelIndexByValue=e=>{if(null!==e&&void 0!==e&&isFinite(e)&&this.channelInfo){if(this.isCoordChannel)return this.channelInfo.getChannelIndexSimple(e);if(this.spectralAxis&&!this.spectralAxis.valid||this.isSpectralPropsEqual)return this.channelInfo.getChannelIndexWCS(e);{const t=Gi.transformSpectralPoint(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e,!1);return this.channelInfo.getChannelIndexWCS(t)}}},Object(S.a)(this,"updateCursorRegion",gi,this),this.replaceZoomTimeoutHandler=()=>{this.zoomTimeoutHandler&&clearTimeout(this.zoomTimeoutHandler),this.zoomTimeoutHandler=setTimeout(()=>Object(E.r)(()=>{this.zooming=!1}),e.ZoomInertiaDuration)},Object(S.a)(this,"initCenter",mi,this),Object(S.a)(this,"fitZoom",fi,this),Object(S.a)(this,"setAnimationRange",yi,this),Object(S.a)(this,"setRasterRenderType",bi,this),Object(S.a)(this,"startMoving",Oi,this),Object(S.a)(this,"endMoving",Si,this),Object(S.a)(this,"applyContours",Ci,this),Object(S.a)(this,"clearContours",Ei,this),Object(S.a)(this,"setSpatialReference",Ii,this),Object(S.a)(this,"clearSpatialReference",wi,this),Object(S.a)(this,"addSecondarySpatialImage",Ti,this),Object(S.a)(this,"removeSecondarySpatialImage",vi,this),Object(S.a)(this,"setSpectralReference",Ai,this),Object(S.a)(this,"clearSpectralReference",xi,this),Object(S.a)(this,"addSecondarySpectralImage",Ri,this),Object(S.a)(this,"removeSecondarySpectralImage",Pi,this),Object(S.a)(this,"setRasterScalingReference",ji,this),Object(S.a)(this,"addSecondaryRasterScalingImage",ki,this),Object(S.a)(this,"removeSecondaryRasterScalingImage",Fi,this),Object(S.a)(this,"addMomentImage",Mi,this),Object(S.a)(this,"removeMomentImage",Di,this),Object(S.a)(this,"setIsRequestingMoments",Ni,this),Object(S.a)(this,"updateRequestingMomentsProgress",Li,this),Object(S.a)(this,"resetMomentRequestState",_i,this),Object(E.p)(this),this.overlayStore=jo.Instance,this.logStore=Ji.Instance,this.backendService=oe.b.Instance;const i=ol.Instance;this.astFrameSet=null,this.spectralFrame=null,this.spectralType=null,this.spectralUnit=null,this.spectralSystem=null,this.channelValues=null,this.spectralCoordsSupported=null,this.spectralSystemsSupported=null,this.wcsInfo=null,this.wcsInfoForTransformation=null,this.fullWcsInfo=null,this.validWcs=!1,this.frameInfo=t,this.renderHiDPI=!0,this.center={x:0,y:0},this.stokes=0,this.channel=0,this.requiredStokes=0,this.requiredChannel=0,this.renderConfig=new _o.b(i,this),this.contourConfig=new Me(i),this.contourStores=new Map,this.renderType=qi.NONE,this.moving=!1,this.zooming=!1,this.overlayBeamSettings=new Ro,this.spatialTransformAST=null,this.controlMaps=new Map,this.secondarySpatialImages=[],this.secondarySpectralImages=[],this.secondaryRasterScalingImages=[],this.momentImages=[],this.isRequestingMoments=!1,this.requestingMomentsProgress=0;const n=i.astColor;n!==this.overlayStore.global.color&&this.overlayStore.global.setColor(n);const r=i.astGridVisible;r!==this.overlayStore.grid.visible&&this.overlayStore.grid.setVisible(r);const o=i.astLabelsVisible;o!==this.overlayStore.labels.visible&&this.overlayStore.labels.setVisible(o),this.frameRegionSet=new _s(this,ol.Instance,oe.b.Instance),this.valid=!0,this.currentFrameView={xMin:0,xMax:0,yMin:0,yMax:0,mip:999},this.animationChannelRange=[0,t.fileInfoExtended.depth-1],this.initSkyWCS(),t.fileInfoExtended.depth>1&&this.initFullWCS(),this.astFrameSet=this.initFrame(),this.astFrameSet&&(this.spectralFrame=Gi.getSpectralFrame(this.astFrameSet)),this.initSupportedSpectralConversion(),this.initCenter(),this.zoomLevel=i.isZoomRAWMode?1:this.zoomLevelForFit,this.spectralAxis&&Object(Vi.IsSpectralTypeSupported)(this.spectralAxis.type.code)&&Object(Vi.IsSpectralUnitSupported)(this.spectralAxis.type.unit)&&(this.spectralType=this.spectralAxis.type.code,this.spectralUnit=Vi.SPECTRAL_DEFAULT_UNIT.get(this.spectralType)),this.isSpectralSystemConvertible&&(this.spectralSystem=this.spectralInfo.specsys),this.cursorInfo=this.getCursorInfo(this.center),this.cursorValue={position:{x:NaN,y:NaN},channel:0,value:NaN},Object(E.h)(()=>{this.isRenderable&&this.zoomLevel<=0&&this.setZoom(this.zoomLevelForFit)}),Object(E.h)(()=>{const e=this.spectralType,t=this.spectralUnit;this.spectralSystem;this.channelInfo&&(e||t?this.isCoordChannel?this.channelValues=this.channelInfo.indexes:this.channelValues=this.isSpectralPropsEqual?this.channelInfo.values:this.convertSpectral(this.channelInfo.values):this.channelValues=this.channelInfo.values)})}getCursorInfo(t){let i,n;if(this.validWcs){const r=[[0,0],[1,1],[-1,-1]].map(e=>Object(B.lb)(this.wcsInfo,{x:t.x+e[0],y:t.y+e[1]}));i=r[0];const o=r.map(e=>Gi.normalizeCoordinates(this.wcsInfo,e.x,e.y));let a=0,s=0;for(;a<e.CursorInfoMaxPrecision&&s<e.CursorInfoMaxPrecision;){let e=new So;e.add("Format(1)",this.overlayStore.numbers.cursorFormatStringX(a)),e.add("Format(2)",this.overlayStore.numbers.cursorFormatStringY(s)),e.add("System",this.overlayStore.global.explicitSystem);let t=o.map(t=>Gi.getFormattedCoordinates(this.wcsInfo,t.x,t.y,e.toString()),!0),[i,r,l]=t;if(!i.x||!i.y||"<bad>"===i.x||"<bad>"===i.y){n=null;break}if(i.x!==r.x&&i.x!==l.x&&i.y!==r.y&&i.y!==l.y){n={x:i.x,y:i.y};break}i.x!==r.x&&i.x!==l.x||(a+=1),i.y!==r.y&&i.y!==l.y||(s+=1)}}const r=Math.round(t.x),o=Math.round(t.y),a=r>=0&&r<this.frameInfo.fileInfoExtended.width&&o>=0&&o<this.frameInfo.fileInfoExtended.height;return{posImageSpace:t,isInsideImage:a,posWCS:i,infoWCS:n}}getControlMap(e){const t=ol.Instance;let i=this.controlMaps.get(e);if(!i){const n=performance.now();i=new Vi.ControlMap(this,e,-1,t.contourControlMapWidth,t.contourControlMapWidth),this.controlMaps.set(e,i);const r=performance.now()-n;console.log(`Created ${t.contourControlMapWidth}x${t.contourControlMapWidth} transform grid for ${this.frameInfo.fileId} -> ${e.frameInfo.fileId} in ${r} ms`)}return i}removeControlMap(e){const t=oe.d.Instance.gl,i=this.controlMaps.get(e);if(i&&t&&i.hasTextureForContext(t)){const e=i.getTextureX(t);t.deleteTexture(e)}this.controlMaps.delete(e)}getWcsSizeInArcsec(e){const t=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CDELT1")),i=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CUNIT1"));if(e&&t&&i){const n=Object(B.C)(t),r=i.value.trim();if(isFinite(n)&&("deg"===r||"rad"===r))return{x:e.x*Math.abs(n)*("deg"===r?3600:648e3/Math.PI),y:e.y*Math.abs(n)*("deg"===r?3600:648e3/Math.PI)}}return null}getImageValueFromArcsec(e){const t=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CDELT1")),i=this.frameInfo.fileInfoExtended.headerEntries.find(e=>-1!==e.name.indexOf("CUNIT1"));if(isFinite(e)&&t&&i){const n=Object(B.C)(t),r=i.value.trim();if(isFinite(n)&&0!==n&&("deg"===r||"rad"===r))return e/Math.abs(n)/("deg"===r?3600:648e3/Math.PI)}return null}updateFromContourData(e){const t=Vi.ProtobufProcessing.ProcessContourData(e);this.stokes=t.stokes,this.channel=t.channel;U.Instance.serverAnimationActive&&(this.requiredChannel=t.channel,this.requiredStokes=t.stokes);for(const i of t.contourSets){let e=this.contourStores.get(i.level);e||(e=new ae,this.contourStores.set(i.level,e)),!e.isComplete&&t.progress>0?e.addContourData(i.indexOffsets,i.coordinates,t.progress):e.setContourData(i.indexOffsets,i.coordinates,t.progress)}this.contourStores.forEach((e,t)=>{-1===this.contourConfig.levels.indexOf(t)&&this.contourStores.delete(t)})}setChannels(e,t,i){const n=this.sanitizeChannelNumber(e);this.requiredStokes!==t&&(this.renderConfig.setUseCubeHistogram(!1),this.renderConfig.updateCubeHistogram(null,0)),this.requiredChannel=n,this.requiredStokes=t,i&&this.spectralSiblings.forEach(e=>{const t=Object(B.H)(this.fullWcsInfo,e.fullWcsInfo,ol.Instance.spectralMatchingType,n);e.setChannels(t,e.requiredStokes,!1)})}sanitizeChannelNumber(e){return isFinite(e)?Math.round(Object(B.k)(e,0,this.frameInfo.fileInfoExtended.depth-1)):this.requiredChannel}incrementChannels(e,t,i=!0){const n=Math.max(1,this.frameInfo.fileInfoExtended.depth),r=Math.max(1,this.frameInfo.fileInfoExtended.stokes);let o=this.requiredChannel+e,a=this.requiredStokes+t;i?(o=(o+n)%n,a=(a+r)%r):(o=Object(B.k)(o,0,n-1),a=Object(B.k)(a,0,r-1)),this.setChannels(o,a,!0)}setZoom(e,t=!1){if(this.spatialReference){const i=t?e:e/this.spatialTransform.scale;this.spatialReference.setZoom(i)}else this.zoomLevel=e,this.replaceZoomTimeoutHandler(),this.zooming=!0}setCenter(e,t){if(this.spatialReference){const i=this.spatialTransform.transformCoordinate({x:e,y:t},!0);this.spatialReference.setCenter(i.x,i.y)}else this.center={x:e,y:t}}setCursorPosition(e){if(this.spatialReference)this.spatialReference.setCursorPosition(Object(B.lb)(this.spatialTransformAST,e,!0));else{this.cursorInfo=this.getCursorInfo(e);for(const t of this.secondarySpatialImages){const i=Object(B.lb)(t.spatialTransformAST,e,!1);t.cursorInfo=t.getCursorInfo(i)}}}setCursorValue(e,t,i){this.cursorValue={position:e,channel:t,value:i}}zoomToPoint(e,t,i,n=!1){if(this.spatialReference){const r=n?i:i/this.spatialTransform.scale,o=Object(B.lb)(this.spatialTransformAST,{x:e,y:t},!0);this.spatialReference.zoomToPoint(o.x,o.y,r)}else ol.Instance.zoomPoint===Vi.ZoomPoint.CURSOR&&(this.center={x:e+this.zoomLevel/i*(this.center.x-e),y:t+this.zoomLevel/i*(this.center.y-t)}),this.setZoom(i)}clearRasterScalingReference(){this.rasterScalingReference&&(this.rasterScalingReference.removeSecondaryRasterScalingImage(this),this.rasterScalingReference=null)}},zi.CursorInfoMaxPrecision=25,zi.ZoomInertiaDuration=250,zi.ShiftASTCoords=(e,t)=>{if(e.name.match(/CRPIX\d+/)){const t=parseFloat(e.value);if(isFinite(t))return(t-1).toString()}return t},Tt=Wi,vt=Object(C.a)(Tt.prototype,"frameRegionSet",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Object(C.a)(Tt.prototype,"frameInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Object(C.a)(Tt.prototype,"renderHiDPI",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=Object(C.a)(Tt.prototype,"wcsInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=Object(C.a)(Tt.prototype,"wcsInfoForTransformation",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt=Object(C.a)(Tt.prototype,"spectralType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=Object(C.a)(Tt.prototype,"spectralUnit",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=Object(C.a)(Tt.prototype,"spectralSystem",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=Object(C.a)(Tt.prototype,"channelValues",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=Object(C.a)(Tt.prototype,"fullWcsInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(C.a)(Tt.prototype,"validWcs",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=Object(C.a)(Tt.prototype,"center",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=Object(C.a)(Tt.prototype,"cursorInfo",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=Object(C.a)(Tt.prototype,"cursorValue",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=Object(C.a)(Tt.prototype,"zoomLevel",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=Object(C.a)(Tt.prototype,"stokes",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=Object(C.a)(Tt.prototype,"channel",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt=Object(C.a)(Tt.prototype,"requiredStokes",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Object(C.a)(Tt.prototype,"requiredChannel",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=Object(C.a)(Tt.prototype,"animationChannelRange",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ut=Object(C.a)(Tt.prototype,"renderType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Object(C.a)(Tt.prototype,"currentFrameView",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=Object(C.a)(Tt.prototype,"currentCompressionQuality",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=Object(C.a)(Tt.prototype,"renderConfig",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qt=Object(C.a)(Tt.prototype,"contourConfig",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zt=Object(C.a)(Tt.prototype,"contourStores",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$t=Object(C.a)(Tt.prototype,"valid",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt=Object(C.a)(Tt.prototype,"moving",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ei=Object(C.a)(Tt.prototype,"zooming",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=Object(C.a)(Tt.prototype,"overlayBeamSettings",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=Object(C.a)(Tt.prototype,"spatialReference",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Object(C.a)(Tt.prototype,"spectralReference",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri=Object(C.a)(Tt.prototype,"rasterScalingReference",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=Object(C.a)(Tt.prototype,"secondarySpatialImages",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ai=Object(C.a)(Tt.prototype,"secondarySpectralImages",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),si=Object(C.a)(Tt.prototype,"secondaryRasterScalingImages",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),li=Object(C.a)(Tt.prototype,"momentImages",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ci=Object(C.a)(Tt.prototype,"isRequestingMoments",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ui=Object(C.a)(Tt.prototype,"requestingMomentsProgress",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Tt.prototype,"filename",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"filename"),Tt.prototype),Object(C.a)(Tt.prototype,"regionSet",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"regionSet"),Tt.prototype),Object(C.a)(Tt.prototype,"sharedRegions",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"sharedRegions"),Tt.prototype),Object(C.a)(Tt.prototype,"requiredFrameView",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"requiredFrameView"),Tt.prototype),Object(C.a)(Tt.prototype,"spatialTransform",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spatialTransform"),Tt.prototype),Object(C.a)(Tt.prototype,"transformedWcsInfo",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"transformedWcsInfo"),Tt.prototype),Object(C.a)(Tt.prototype,"renderWidth",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"renderWidth"),Tt.prototype),Object(C.a)(Tt.prototype,"renderHeight",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"renderHeight"),Tt.prototype),Object(C.a)(Tt.prototype,"isRenderable",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"isRenderable"),Tt.prototype),Object(C.a)(Tt.prototype,"unit",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"unit"),Tt.prototype),Object(C.a)(Tt.prototype,"beamProperties",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"beamProperties"),Tt.prototype),Object(C.a)(Tt.prototype,"hasVisibleBeam",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"hasVisibleBeam"),Tt.prototype),Object(C.a)(Tt.prototype,"channelInfo",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"channelInfo"),Tt.prototype),Object(C.a)(Tt.prototype,"spectralInfo",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spectralInfo"),Tt.prototype),Object(C.a)(Tt.prototype,"simpleSpectralInfo",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"simpleSpectralInfo"),Tt.prototype),Object(C.a)(Tt.prototype,"spectralAxis",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spectralAxis"),Tt.prototype),Object(C.a)(Tt.prototype,"isSpectralCoordinateConvertible",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"isSpectralCoordinateConvertible"),Tt.prototype),Object(C.a)(Tt.prototype,"isSpectralSystemConvertible",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"isSpectralSystemConvertible"),Tt.prototype),Object(C.a)(Tt.prototype,"isSpectralPropsEqual",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"isSpectralPropsEqual"),Tt.prototype),Object(C.a)(Tt.prototype,"isCoordChannel",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"isCoordChannel"),Tt.prototype),Object(C.a)(Tt.prototype,"nativeSpectralCoordinate",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"nativeSpectralCoordinate"),Tt.prototype),Object(C.a)(Tt.prototype,"spectralCoordinate",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spectralCoordinate"),Tt.prototype),Object(C.a)(Tt.prototype,"spectralUnitStr",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spectralUnitStr"),Tt.prototype),Object(C.a)(Tt.prototype,"hasStokes",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"hasStokes"),Tt.prototype),Object(C.a)(Tt.prototype,"numChannels",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"numChannels"),Tt.prototype),Object(C.a)(Tt.prototype,"channelValueBounds",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"channelValueBounds"),Tt.prototype),Object(C.a)(Tt.prototype,"spectralSiblings",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spectralSiblings"),Tt.prototype),Object(C.a)(Tt.prototype,"spatialSiblings",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"spatialSiblings"),Tt.prototype),Object(C.a)(Tt.prototype,"renderConfigSiblings",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"renderConfigSiblings"),Tt.prototype),Object(C.a)(Tt.prototype,"isCursorValueCurrent",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"isCursorValueCurrent"),Tt.prototype),Object(C.a)(Tt.prototype,"zoomLevelForFit",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"zoomLevelForFit"),Tt.prototype),Object(C.a)(Tt.prototype,"calculateZoomX",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"calculateZoomX"),Tt.prototype),Object(C.a)(Tt.prototype,"calculateZoomY",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"calculateZoomY"),Tt.prototype),Object(C.a)(Tt.prototype,"contourProgress",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"contourProgress"),Tt.prototype),Object(C.a)(Tt.prototype,"stokesInfo",[E.i],Object.getOwnPropertyDescriptor(Tt.prototype,"stokesInfo"),Tt.prototype),pi=Object(C.a)(Tt.prototype,"initSkyWCS",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e="";for(let i of this.frameInfo.fileInfoExtended.headerEntries){if(!i.value.length)continue;if(i.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[3-9]/))continue;let t=i.value;"NAXIS"===i.name.toUpperCase()&&(t="2"),"WCSAXES"===i.name.toUpperCase()&&(t="2"),t=i.entryType===V.a.EntryType.STRING?`'${t}'`:Ui.ShiftASTCoords(i,t);let n=i.name;for(;n.length<8;)n+=" ";let r=`${n}=  ${t}`;for(;r.length<80;)r+=" ";e+=r}const t=Gi.initFrame(e);t?(this.wcsInfo=t,this.wcsInfoForTransformation=Gi.copy(this.wcsInfo),Gi.set(this.wcsInfoForTransformation,`Format(1)=${ne.a.Instance.overlayStore.numbers.formatTypeX}.${Hi}`),Gi.set(this.wcsInfoForTransformation,`Format(2)=${ne.a.Instance.overlayStore.numbers.formatTypeY}.${Hi}`),this.validWcs=!0,this.overlayStore.setDefaultsFromAST(this),console.log("Initialised WCS info from frame")):(this.logStore.addWarning("Problem processing WCS info in file "+this.filename,["ast"]),this.wcsInfo=Gi.initDummyFrame())}}}),di=Object(C.a)(Tt.prototype,"initFullWCS",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e="";for(let i of this.frameInfo.fileInfoExtended.headerEntries){if(!i.value.length)continue;if(i.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[4-9]/))continue;let t=Object(B.mb)(i.value);"NAXIS"===i.name.toUpperCase()&&(t="3"),"WCSAXES"===i.name.toUpperCase()&&(t="3"),t=i.entryType===V.a.EntryType.STRING?`'${t}'`:Ui.ShiftASTCoords(i,t);let n=i.name;for(;n.length<8;)n+=" ";let r=`${n}=  ${t}`;for(;r.length<80;)r+=" ";e+=r}const t=Gi.initFrame(e);t?(this.fullWcsInfo=t,console.log("Initialised 3D WCS info from frame")):(this.logStore.addWarning("Problem processing WCS info in file "+this.filename,["ast"]),this.fullWcsInfo=null)}}}),hi=Object(C.a)(Tt.prototype,"initSupportedSpectralConversion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.spectralAxis&&!this.spectralAxis.valid)return this.channelValues=this.channelInfo.values,this.spectralCoordsSupported=new Map([[this.nativeSpectralCoordinate,{type:null,unit:null}],[Vi.SPECTRAL_TYPE_STRING.get(Vi.SpectralType.CHANNEL),{type:Vi.SpectralType.CHANNEL,unit:null}]]),void(this.spectralSystemsSupported=[]);if(!this.spectralAxis||!this.spectralFrame)return this.spectralCoordsSupported=null,void(this.spectralSystemsSupported=null);const e=this.frameInfo.fileInfoExtended.headerEntries,t=this.spectralInfo.channelType.code;if(Object(Vi.IsSpectralTypeSupported)(t)){e.find(e=>-1!==e.name.indexOf("RESTFRQ"))?this.spectralCoordsSupported=Vi.SPECTRAL_COORDS_SUPPORTED:(this.spectralCoordsSupported=new Map,Array.from(Vi.SPECTRAL_COORDS_SUPPORTED.keys()).forEach(e=>{const i=Vi.SPECTRAL_COORDS_SUPPORTED.get(e),n=t===Vi.SpectralType.VRAD||t===Vi.SpectralType.VOPT,r=i.type===Vi.SpectralType.VRAD||i.type===Vi.SpectralType.VOPT;n&&r&&this.spectralCoordsSupported.set(e,i),n||r||this.spectralCoordsSupported.set(e,i)}),this.spectralCoordsSupported.set(Vi.SPECTRAL_TYPE_STRING.get(Vi.SpectralType.CHANNEL),{type:Vi.SpectralType.CHANNEL,unit:null}))}else this.spectralCoordsSupported=new Map([[Vi.SPECTRAL_TYPE_STRING.get(Vi.SpectralType.CHANNEL),{type:Vi.SpectralType.CHANNEL,unit:null}]]);const i=this.spectralInfo.specsys;if(Object(Vi.IsSpectralSystemSupported)(i)){const t=e.find(e=>-1!==e.name.indexOf("DATE-OBS")),n=e.find(e=>-1!==e.name.indexOf("OBSGEO-X")),r=e.find(e=>-1!==e.name.indexOf("OBSGEO-Y")),o=e.find(e=>-1!==e.name.indexOf("OBSGEO-Z"));i===Vi.SpectralSystem.LSRK||i===Vi.SpectralSystem.LSRD?this.spectralSystemsSupported=t&&n&&r&&o?[Vi.SpectralSystem.LSRK,Vi.SpectralSystem.LSRD,Vi.SpectralSystem.BARY,Vi.SpectralSystem.TOPO]:!t||n&&r&&o?[Vi.SpectralSystem.LSRK,Vi.SpectralSystem.LSRD]:[Vi.SpectralSystem.LSRK,Vi.SpectralSystem.LSRD,Vi.SpectralSystem.BARY]:i===Vi.SpectralSystem.BARY?this.spectralSystemsSupported=t&&n&&r&&o?[Vi.SpectralSystem.LSRK,Vi.SpectralSystem.LSRD,Vi.SpectralSystem.BARY,Vi.SpectralSystem.TOPO]:!t||n&&r&&o?[Vi.SpectralSystem.BARY]:[Vi.SpectralSystem.LSRK,Vi.SpectralSystem.LSRD,Vi.SpectralSystem.BARY]:this.spectralSystemsSupported=t&&n&&r&&o?[Vi.SpectralSystem.LSRK,Vi.SpectralSystem.LSRD,Vi.SpectralSystem.BARY,Vi.SpectralSystem.TOPO]:[Vi.SpectralSystem.TOPO]}else this.spectralSystemsSupported=[]}}}),Object(C.a)(Tt.prototype,"updateFromContourData",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"updateFromContourData"),Tt.prototype),Object(C.a)(Tt.prototype,"setChannels",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"setChannels"),Tt.prototype),Object(C.a)(Tt.prototype,"incrementChannels",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"incrementChannels"),Tt.prototype),Object(C.a)(Tt.prototype,"setZoom",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"setZoom"),Tt.prototype),Object(C.a)(Tt.prototype,"setCenter",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"setCenter"),Tt.prototype),Object(C.a)(Tt.prototype,"setCursorPosition",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"setCursorPosition"),Tt.prototype),Object(C.a)(Tt.prototype,"setCursorValue",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"setCursorValue"),Tt.prototype),gi=Object(C.a)(Tt.prototype,"updateCursorRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.spatialReference){const t=Object(B.lb)(this.spatialTransformAST,e,!0);this.spatialReference.updateCursorRegion(t)}else{var t;null===(t=this.frameRegionSet.regions)||void 0===t||t[0].setCenter(e)}for(const n of this.secondarySpatialImages){var i;const t=Object(B.lb)(n.spatialTransformAST,e,!1);null===(i=n.frameRegionSet.regions)||void 0===i||i[0].setCenter(t)}}}}),Object(C.a)(Tt.prototype,"zoomToPoint",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"zoomToPoint"),Tt.prototype),mi=Object(C.a)(Tt.prototype,"initCenter",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.center.x=(this.frameInfo.fileInfoExtended.width-1)/2,this.center.y=(this.frameInfo.fileInfoExtended.height-1)/2}}}),fi=Object(C.a)(Tt.prototype,"fitZoom",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.spatialReference){this.initCenter();const e=Object(B.lb)(this.spatialTransformAST,this.center,!0);this.spatialReference.setCenter(e.x,e.y);const t=[this.spatialTransform.transformCoordinate({x:0,y:0},!0),this.spatialTransform.transformCoordinate({x:0,y:this.frameInfo.fileInfoExtended.height},!0),this.spatialTransform.transformCoordinate({x:this.frameInfo.fileInfoExtended.width,y:this.frameInfo.fileInfoExtended.height},!0),this.spatialTransform.transformCoordinate({x:this.frameInfo.fileInfoExtended.width,y:0},!0)],{minPoint:i,maxPoint:n}=Object(B.R)(t),r=n.x-i.x,o=n.y-i.y,a=this.renderHiDPI?devicePixelRatio:1,s=this.spatialReference.renderWidth*a/r,l=this.spatialReference.renderHeight*a/o;this.spatialReference.setZoom(Math.min(s,l),!0)}else this.zoomLevel=this.zoomLevelForFit,this.initCenter()}}}),yi=Object(C.a)(Tt.prototype,"setAnimationRange",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.animationChannelRange=e}}}),bi=Object(C.a)(Tt.prototype,"setRasterRenderType",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.renderType=e}}}),Oi=Object(C.a)(Tt.prototype,"startMoving",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.moving=!0}}}),Si=Object(C.a)(Tt.prototype,"endMoving",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.moving=!1}}}),Ci=Object(C.a)(Tt.prototype,"applyContours",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(!this.contourConfig||!this.renderConfig)return;const e=ol.Instance;this.contourConfig.setEnabled(!0);const t={fileId:this.frameInfo.fileId,referenceFileId:this.frameInfo.fileId,smoothingMode:this.contourConfig.smoothingMode,smoothingFactor:this.contourConfig.smoothingFactor,levels:this.contourConfig.levels,imageBounds:{xMin:0,xMax:this.frameInfo.fileInfoExtended.width,yMin:0,yMax:this.frameInfo.fileInfoExtended.height},decimationFactor:e.contourDecimation,compressionLevel:e.contourCompressionLevel,contourChunkSize:e.contourChunkSize};this.backendService.setContourParameters(t)}}}),Ei=Object(C.a)(Tt.prototype,"clearContours",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!0)=>{if(this.contourStores.forEach(e=>e.clearData()),this.contourStores.clear(),e){const e={fileId:this.frameInfo.fileId,referenceFileId:this.frameInfo.fileId};this.backendService.setContourParameters(e)}this.contourConfig.setEnabled(!1)}}}),Ii=Object(C.a)(Tt.prototype,"setSpatialReference",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;if(e===this)return console.log("Skipping spatial self-reference"),this.clearSpatialReference(),!1;if(this.validWcs!==e.validWcs)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,!1;console.log(`Setting spatial reference for file ${this.frameInfo.fileId} to ${e.frameInfo.fileId}`),this.spatialReference=e;const i=Gi.copy(this.wcsInfo),n=Gi.copy(e.wcsInfo);if(Gi.invert(i),Gi.invert(n),this.spatialTransformAST=Gi.convert(i,n,""),Gi.delete(i),Gi.delete(n),!this.spatialTransformAST)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,!1;this.spatialReference=e;const r=this.spatialTransform;if(!isFinite(r.rotation)||!isFinite(r.scale)||!isFinite(r.translation.x)||!isFinite(r.translation.y)||!isFinite(r.origin.x)||!isFinite(r.origin.y))return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,Gi.delete(this.spatialTransformAST),this.spatialTransformAST=null,!1;this.spatialReference.addSecondarySpatialImage(this);const o=null===(t=this.spatialReference.cursorInfo)||void 0===t?void 0:t.posImageSpace;if(o){const e=Object(B.lb)(this.spatialTransformAST,o,!1);this.cursorInfo=this.getCursorInfo(e)}this.spatialReference.frameRegionSet.migrateRegionsFromExistingSet(this.frameRegionSet,this.spatialTransformAST,!0);for(const a of this.frameRegionSet.regions)this.frameRegionSet.deleteRegion(a);return!0}}}),wi=Object(C.a)(Tt.prototype,"clearSpatialReference",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spatialReference&&(this.frameRegionSet.migrateRegionsFromExistingSet(this.spatialReference.frameRegionSet,this.spatialTransformAST),this.center=this.spatialTransform.transformCoordinate(this.spatialReference.center,!1),this.zoomLevel=this.spatialReference.zoomLevel*this.spatialTransform.scale,this.spatialReference.removeSecondarySpatialImage(this),this.spatialReference=null),this.spatialTransformAST&&Gi.delete(this.spatialTransformAST),this.spatialTransformAST=null;const e=oe.d.Instance.gl;e&&this.controlMaps.forEach(t=>{if(t.hasTextureForContext(e)){const i=t.getTextureX(e);e.deleteTexture(i)}}),this.controlMaps.forEach((e,t)=>{this.removeControlMap(t)}),this.controlMaps.clear()}}}),Ti=Object(C.a)(Tt.prototype,"addSecondarySpatialImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpatialImages.find(t=>t.frameInfo.fileId===e.frameInfo.fileId)||this.secondarySpatialImages.push(e)}}}),vi=Object(C.a)(Tt.prototype,"removeSecondarySpatialImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpatialImages=this.secondarySpatialImages.filter(t=>t.frameInfo.fileId!==e.frameInfo.fileId)}}}),Ai=Object(C.a)(Tt.prototype,"setSpectralReference",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this)return this.clearSpatialReference(),console.log("Skipping spectral self-reference"),!1;if(console.log(`Setting spectral reference for file ${this.frameInfo.fileId} to ${e.frameInfo.fileId}`),!this.fullWcsInfo||!e.fullWcsInfo)return console.log(`Error creating spectral transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}. One of the files is missing spectral information`),this.spectralReference=null,!1;const t=Gi.copy(this.fullWcsInfo),i=Gi.copy(e.fullWcsInfo),n=ol.Instance;if(n.spectralMatchingType!==Vi.SpectralType.CHANNEL&&(Gi.set(t,"AlignSystem="+n.spectralMatchingType),Gi.set(i,"AlignSystem="+n.spectralMatchingType)),Gi.invert(t),Gi.invert(i),this.spectralTransformAST=Gi.convert(t,i,""),Gi.delete(t),Gi.delete(i),!this.spectralTransformAST)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}. Could not create AST transform`),this.spectralReference=null,!1;this.spectralReference=e,this.spectralReference.addSecondarySpectralImage(this);const r=Object(B.H)(e.fullWcsInfo,this.fullWcsInfo,n.spectralMatchingType,e.requiredChannel);return this.setChannels(r,this.requiredStokes,!1),!0}}}),xi=Object(C.a)(Tt.prototype,"clearSpectralReference",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralReference&&(this.spectralReference.removeSecondarySpectralImage(this),this.spectralReference=null),this.spectralTransformAST&&Gi.delete(this.spectralTransformAST),this.spectralTransformAST=null}}}),Ri=Object(C.a)(Tt.prototype,"addSecondarySpectralImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpectralImages.find(t=>t.frameInfo.fileId===e.frameInfo.fileId)||this.secondarySpectralImages.push(e)}}}),Pi=Object(C.a)(Tt.prototype,"removeSecondarySpectralImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpectralImages=this.secondarySpectralImages.filter(t=>t.frameInfo.fileId!==e.frameInfo.fileId)}}}),ji=Object(C.a)(Tt.prototype,"setRasterScalingReference",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this)return this.clearRasterScalingReference(),void console.log("Skipping RenderConfig self-reference");this.rasterScalingReference=e,this.rasterScalingReference.addSecondaryRasterScalingImage(this),this.renderConfig.updateFrom(e.renderConfig)}}}),Object(C.a)(Tt.prototype,"clearRasterScalingReference",[E.g],Object.getOwnPropertyDescriptor(Tt.prototype,"clearRasterScalingReference"),Tt.prototype),ki=Object(C.a)(Tt.prototype,"addSecondaryRasterScalingImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryRasterScalingImages.find(t=>t.frameInfo.fileId===e.frameInfo.fileId)||this.secondaryRasterScalingImages.push(e)}}}),Fi=Object(C.a)(Tt.prototype,"removeSecondaryRasterScalingImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryRasterScalingImages=this.secondaryRasterScalingImages.filter(t=>t.frameInfo.fileId!==e.frameInfo.fileId)}}}),Mi=Object(C.a)(Tt.prototype,"addMomentImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&!this.momentImages.find(t=>t.frameInfo.fileId===e.frameInfo.fileId)&&this.momentImages.push(e)}}}),Di=Object(C.a)(Tt.prototype,"removeMomentImage",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.momentImages=[]}}}),Ni=Object(C.a)(Tt.prototype,"setIsRequestingMoments",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isRequestingMoments=e}}}),Li=Object(C.a)(Tt.prototype,"updateRequestingMomentsProgress",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.requestingMomentsProgress=e}}}),_i=Object(C.a)(Tt.prototype,"resetMomentRequestState",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setIsRequestingMoments(!1),this.updateRequestingMomentsProgress(0)}}}),Tt);var Yi,Xi,Ki,Qi,Zi,$i;let Ji=($i=Zi=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(S.a)(this,"logEntries",Xi,this),Object(S.a)(this,"hiddenTags",Ki,this),Object(S.a)(this,"logLevel",Qi,this),this.logLimit=1e3,Object(E.p)(this),this.logEntries=[],this.hiddenTags=[],this.logLevel=V.a.ErrorSeverity.INFO}get newestMsg(){return this.logEntries.length>0?this.logEntries[this.logEntries.length-1].message:""}addLog(e){this.logEntries.push(e),this.logEntries.length>this.logLimit&&this.logEntries.shift()}addDebug(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.DEBUG})}addInfo(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.INFO})}addWarning(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.WARNING})}addError(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.ERROR})}toggleTag(e){-1===this.hiddenTags.indexOf(e)?this.hiddenTags.push(e):this.hiddenTags=this.hiddenTags.filter(t=>t!==e)}setLevel(e){this.logLevel=e}clearLog(){this.logEntries=[]}},Zi.staticInstance=void 0,Yi=$i,Xi=Object(C.a)(Yi.prototype,"logEntries",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ki=Object(C.a)(Yi.prototype,"hiddenTags",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qi=Object(C.a)(Yi.prototype,"logLevel",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Yi.prototype,"newestMsg",[E.i],Object.getOwnPropertyDescriptor(Yi.prototype,"newestMsg"),Yi.prototype),Object(C.a)(Yi.prototype,"addLog",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"addLog"),Yi.prototype),Object(C.a)(Yi.prototype,"addDebug",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"addDebug"),Yi.prototype),Object(C.a)(Yi.prototype,"addInfo",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"addInfo"),Yi.prototype),Object(C.a)(Yi.prototype,"addWarning",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"addWarning"),Yi.prototype),Object(C.a)(Yi.prototype,"addError",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"addError"),Yi.prototype),Object(C.a)(Yi.prototype,"toggleTag",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"toggleTag"),Yi.prototype),Object(C.a)(Yi.prototype,"setLevel",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"setLevel"),Yi.prototype),Object(C.a)(Yi.prototype,"clearLog",[E.g],Object.getOwnPropertyDescriptor(Yi.prototype,"clearLog"),Yi.prototype),Yi);var en,tn,nn,rn,on,an,sn,ln,cn,un,pn,dn,hn,gn,mn,fn,yn,bn,On,Sn,Cn,En,In,wn,Tn,vn,An,xn,Rn,Pn,jn,kn,Fn,Mn,Dn,Nn,Ln,_n,zn,Wn,Gn,Vn,Bn,qn,Hn,Un,Yn,Xn,Kn,Qn,Zn,$n,Jn,er,tr,ir,nr,rr,or,ar,sr,lr,cr,ur,pr,dr,hr,gr,mr,fr,yr,br,Or,Sr,Cr,Er,Ir,wr,Tr,vr,Ar,xr,Rr,Pr,jr,kr,Fr,Mr,Dr,Nr,Lr,_r,zr,Wr,Gr,Vr,Br,qr,Hr,Ur,Yr,Xr,Kr,Qr,Zr,$r,Jr,eo,to,io,no,ro,oo,ao,so,lo,co,uo,po=i(76);const ho=[po.a.BLACK,po.a.WHITE,po.a.RED2,po.a.FOREST3,po.a.BLUE2,po.a.TURQUOISE2,po.a.VIOLET2,po.a.GOLD2,po.a.GRAY2],go=[po.a.BLACK,po.a.WHITE,po.a.RED4,po.a.FOREST4,po.a.BLUE4,po.a.TURQUOISE4,po.a.VIOLET4,po.a.GOLD4,po.a.GRAY4];let mo,fo,yo;!function(e){e.Interior="Interior",e.Exterior="Exterior"}(mo||(mo={})),function(e){e.Auto="AUTO",e.Ecliptic="ECLIPTIC",e.FK4="FK4",e.FK5="FK5",e.Galactic="GALACTIC",e.ICRS="ICRS"}(fo||(fo={})),function(e){e.HMS="hms",e.DMS="dms",e.Degrees="d"}(yo||(yo={}));const bo=new Map([[yo.HMS,"H:M:S"],[yo.DMS,"D:M:S"],[yo.Degrees,"Degrees"]]);let Oo;!function(e){e.Open="open",e.Solid="solid"}(Oo||(Oo={}));class So{constructor(){this.stringList=void 0,this.stringList=[]}add(e,t,i=!0){if(void 0!==t&&i){let i="boolean"===typeof t?t?1:0:t;this.stringList.push(`${e}=${i}`)}}addSection(e){void 0!==e&&this.stringList.push(e)}toString(){return this.stringList.filter(e=>e.length>0).join(", ")}}let Co=(en=class{get styleString(){let e=new So;return e.add("Labelling",this.labelType),e.add("Color",this.color),e.add("Tol",Object(B.kb)(this.tolerance/100,2),this.tolerance>=.001),e.add("System",this.explicitSystem),e.toString()}get explicitSystem(){if(this.validWcs)return this.system===fo.Auto?this.defaultSystem:this.system}constructor(){Object(S.a)(this,"labelType",tn,this),Object(S.a)(this,"color",nn,this),Object(S.a)(this,"tolerance",rn,this),Object(S.a)(this,"system",on,this),Object(S.a)(this,"defaultSystem",an,this),Object(S.a)(this,"validWcs",sn,this),Object(S.a)(this,"setColor",ln,this),Object(E.p)(this),this.system=fo.Auto,this.labelType=mo.Exterior,this.color=ol.Instance.astColor,this.tolerance=2,this.defaultSystem=fo.Auto,this.validWcs=!1}setTolerance(e){this.tolerance=e}setLabelType(e){this.labelType=e}setSystem(e){this.system=e}setDefaultSystem(e){this.defaultSystem=e}setValidWcs(e){this.validWcs=e}},tn=Object(C.a)(en.prototype,"labelType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn=Object(C.a)(en.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rn=Object(C.a)(en.prototype,"tolerance",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),on=Object(C.a)(en.prototype,"system",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),an=Object(C.a)(en.prototype,"defaultSystem",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sn=Object(C.a)(en.prototype,"validWcs",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(en.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(en.prototype,"styleString"),en.prototype),Object(C.a)(en.prototype,"explicitSystem",[E.i],Object.getOwnPropertyDescriptor(en.prototype,"explicitSystem"),en.prototype),ln=Object(C.a)(en.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(C.a)(en.prototype,"setTolerance",[E.g],Object.getOwnPropertyDescriptor(en.prototype,"setTolerance"),en.prototype),Object(C.a)(en.prototype,"setLabelType",[E.g],Object.getOwnPropertyDescriptor(en.prototype,"setLabelType"),en.prototype),Object(C.a)(en.prototype,"setSystem",[E.g],Object.getOwnPropertyDescriptor(en.prototype,"setSystem"),en.prototype),Object(C.a)(en.prototype,"setDefaultSystem",[E.g],Object.getOwnPropertyDescriptor(en.prototype,"setDefaultSystem"),en.prototype),Object(C.a)(en.prototype,"setValidWcs",[E.g],Object.getOwnPropertyDescriptor(en.prototype,"setValidWcs"),en.prototype),en),Eo=(cn=class{get styleString(){let e=new So;return e.add("DrawTitle",this.show),e.add("Font(Title)",this.font),e.add("Size(Title)",this.fontSize),e.add("Color(Title)",this.color,this.customColor),e.add("Title",this.customTitleString,this.customText),e.toString()}constructor(){Object(S.a)(this,"visible",un,this),Object(S.a)(this,"font",pn,this),Object(S.a)(this,"fontSize",dn,this),Object(S.a)(this,"customColor",hn,this),Object(S.a)(this,"color",gn,this),Object(S.a)(this,"hidden",mn,this),Object(S.a)(this,"customText",fn,this),Object(S.a)(this,"customTitleString",yn,this),Object(S.a)(this,"setFont",bn,this),Object(S.a)(this,"setColor",On,this),Object(S.a)(this,"setCustomText",Sn,this),Object(S.a)(this,"setCustomTitleString",Cn,this),Object(E.p)(this),this.visible=!1,this.hidden=!1,this.customColor=!1,this.color=4,this.font=2,this.fontSize=18,this.customText=!1,this.customTitleString=""}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setFontSize(e){this.fontSize=e}setCustomColor(e){this.customColor=e}},un=Object(C.a)(cn.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pn=Object(C.a)(cn.prototype,"font",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=Object(C.a)(cn.prototype,"fontSize",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=Object(C.a)(cn.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=Object(C.a)(cn.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=Object(C.a)(cn.prototype,"hidden",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=Object(C.a)(cn.prototype,"customText",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(C.a)(cn.prototype,"customTitleString",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(cn.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(cn.prototype,"styleString"),cn.prototype),Object(C.a)(cn.prototype,"show",[E.i],Object.getOwnPropertyDescriptor(cn.prototype,"show"),cn.prototype),Object(C.a)(cn.prototype,"setVisible",[E.g],Object.getOwnPropertyDescriptor(cn.prototype,"setVisible"),cn.prototype),Object(C.a)(cn.prototype,"setHidden",[E.g],Object.getOwnPropertyDescriptor(cn.prototype,"setHidden"),cn.prototype),bn=Object(C.a)(cn.prototype,"setFont",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(C.a)(cn.prototype,"setFontSize",[E.g],Object.getOwnPropertyDescriptor(cn.prototype,"setFontSize"),cn.prototype),Object(C.a)(cn.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(cn.prototype,"setCustomColor"),cn.prototype),On=Object(C.a)(cn.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Sn=Object(C.a)(cn.prototype,"setCustomText",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customText=e}}}),Cn=Object(C.a)(cn.prototype,"setCustomTitleString",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customTitleString=e}}}),cn),Io=(En=class{get styleString(){let e=new So;return e.add("Grid",this.visible),e.add("Color(Grid)",this.color,this.customColor),e.add("Width(Grid)",this.width,this.width>0),e.add("Gap(1)",this.gapX,this.customGap),e.add("Gap(2)",this.gapY,this.customGap),e.toString()}constructor(){Object(S.a)(this,"visible",In,this),Object(S.a)(this,"customColor",wn,this),Object(S.a)(this,"color",Tn,this),Object(S.a)(this,"width",vn,this),Object(S.a)(this,"customGap",An,this),Object(S.a)(this,"gapX",xn,this),Object(S.a)(this,"gapY",Rn,this),Object(S.a)(this,"setColor",Pn,this),Object(E.p)(this),this.visible=ol.Instance.astGridVisible,this.customColor=!1,this.color=4,this.width=1,this.customGap=!1,this.gapX=.2,this.gapY=.2}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}setCustomGap(e=!0){this.customGap=e}setGapX(e){this.gapX=e}setGapY(e){this.gapY=e}},In=Object(C.a)(En.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wn=Object(C.a)(En.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tn=Object(C.a)(En.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn=Object(C.a)(En.prototype,"width",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=Object(C.a)(En.prototype,"customGap",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xn=Object(C.a)(En.prototype,"gapX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=Object(C.a)(En.prototype,"gapY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(En.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(En.prototype,"styleString"),En.prototype),Object(C.a)(En.prototype,"setVisible",[E.g],Object.getOwnPropertyDescriptor(En.prototype,"setVisible"),En.prototype),Object(C.a)(En.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(En.prototype,"setCustomColor"),En.prototype),Pn=Object(C.a)(En.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(C.a)(En.prototype,"setWidth",[E.g],Object.getOwnPropertyDescriptor(En.prototype,"setWidth"),En.prototype),Object(C.a)(En.prototype,"setCustomGap",[E.g],Object.getOwnPropertyDescriptor(En.prototype,"setCustomGap"),En.prototype),Object(C.a)(En.prototype,"setGapX",[E.g],Object.getOwnPropertyDescriptor(En.prototype,"setGapX"),En.prototype),Object(C.a)(En.prototype,"setGapY",[E.g],Object.getOwnPropertyDescriptor(En.prototype,"setGapY"),En.prototype),En),wo=(jn=class{get styleString(){let e=new So;return e.add("Border",this.visible),e.add("Color(Border)",this.color,this.customColor),e.add("Width(Border)",this.width,this.width>0),e.toString()}constructor(){Object(S.a)(this,"visible",kn,this),Object(S.a)(this,"customColor",Fn,this),Object(S.a)(this,"color",Mn,this),Object(S.a)(this,"width",Dn,this),Object(S.a)(this,"setColor",Nn,this),Object(E.p)(this),this.visible=!0,this.customColor=!1,this.color=4,this.width=1}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}},kn=Object(C.a)(jn.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fn=Object(C.a)(jn.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=Object(C.a)(jn.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=Object(C.a)(jn.prototype,"width",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(jn.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(jn.prototype,"styleString"),jn.prototype),Object(C.a)(jn.prototype,"setVisible",[E.g],Object.getOwnPropertyDescriptor(jn.prototype,"setVisible"),jn.prototype),Object(C.a)(jn.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(jn.prototype,"setCustomColor"),jn.prototype),Nn=Object(C.a)(jn.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(C.a)(jn.prototype,"setWidth",[E.g],Object.getOwnPropertyDescriptor(jn.prototype,"setWidth"),jn.prototype),jn),To=(Ln=class{get styleString(){let e=new So;return e.add("TickAll",this.drawAll),e.add("MinTick(1)",this.densityX,this.customDensity),e.add("MinTick(2)",this.densityY,this.customDensity),e.add("Color(Ticks)",this.color,this.customColor),e.add("Width(Ticks)",this.width,this.width>0),e.add("MinTickLen",Object(B.kb)(this.length/100,2)),e.add("MajTickLen",Object(B.kb)(this.majorLength/100,2)),e.toString()}constructor(){Object(S.a)(this,"drawAll",_n,this),Object(S.a)(this,"densityX",zn,this),Object(S.a)(this,"densityY",Wn,this),Object(S.a)(this,"customDensity",Gn,this),Object(S.a)(this,"customColor",Vn,this),Object(S.a)(this,"color",Bn,this),Object(S.a)(this,"width",qn,this),Object(S.a)(this,"length",Hn,this),Object(S.a)(this,"majorLength",Un,this),Object(S.a)(this,"setColor",Yn,this),Object(E.p)(this),this.drawAll=!0,this.customDensity=!1,this.densityX=4,this.densityY=4,this.customColor=!1,this.color=4,this.width=1,this.length=1,this.majorLength=2}setDrawAll(e=!0){this.drawAll=e}setCustomDensity(e=!0){this.customDensity=e}setDensityX(e){this.densityX=e}setDensityY(e){this.densityY=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}setLength(e){this.length=e}setMajorLength(e){this.majorLength=e}},_n=Object(C.a)(Ln.prototype,"drawAll",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Object(C.a)(Ln.prototype,"densityX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wn=Object(C.a)(Ln.prototype,"densityY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=Object(C.a)(Ln.prototype,"customDensity",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vn=Object(C.a)(Ln.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bn=Object(C.a)(Ln.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qn=Object(C.a)(Ln.prototype,"width",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=Object(C.a)(Ln.prototype,"length",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Un=Object(C.a)(Ln.prototype,"majorLength",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Ln.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(Ln.prototype,"styleString"),Ln.prototype),Object(C.a)(Ln.prototype,"setDrawAll",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setDrawAll"),Ln.prototype),Object(C.a)(Ln.prototype,"setCustomDensity",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setCustomDensity"),Ln.prototype),Object(C.a)(Ln.prototype,"setDensityX",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setDensityX"),Ln.prototype),Object(C.a)(Ln.prototype,"setDensityY",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setDensityY"),Ln.prototype),Object(C.a)(Ln.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setCustomColor"),Ln.prototype),Yn=Object(C.a)(Ln.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(C.a)(Ln.prototype,"setWidth",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setWidth"),Ln.prototype),Object(C.a)(Ln.prototype,"setLength",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setLength"),Ln.prototype),Object(C.a)(Ln.prototype,"setMajorLength",[E.g],Object.getOwnPropertyDescriptor(Ln.prototype,"setMajorLength"),Ln.prototype),Ln),vo=(Xn=class{constructor(){Object(S.a)(this,"visible",Kn,this),Object(S.a)(this,"customColor",Qn,this),Object(S.a)(this,"color",Zn,this),Object(S.a)(this,"width",$n,this),Object(S.a)(this,"setColor",Jn,this),Object(E.p)(this),this.visible=!1,this.customColor=!1,this.color=4,this.width=1}get styleString(){let e=new So;return e.add("DrawAxes",this.visible),e.add("Color(Axes)",this.color,this.customColor),e.add("Width(Axes)",this.width,this.width>0),e.toString()}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}},Kn=Object(C.a)(Xn.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qn=Object(C.a)(Xn.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zn=Object(C.a)(Xn.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$n=Object(C.a)(Xn.prototype,"width",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Xn.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(Xn.prototype,"styleString"),Xn.prototype),Object(C.a)(Xn.prototype,"setVisible",[E.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setVisible"),Xn.prototype),Object(C.a)(Xn.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setCustomColor"),Xn.prototype),Jn=Object(C.a)(Xn.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(C.a)(Xn.prototype,"setWidth",[E.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setWidth"),Xn.prototype),Xn),Ao=(er=class{constructor(){Object(S.a)(this,"visible",tr,this),Object(S.a)(this,"hidden",ir,this),Object(S.a)(this,"font",nr,this),Object(S.a)(this,"fontSize",rr,this),Object(S.a)(this,"customColor",or,this),Object(S.a)(this,"color",ar,this),Object(S.a)(this,"customFormat",sr,this),Object(S.a)(this,"formatX",lr,this),Object(S.a)(this,"formatY",cr,this),Object(S.a)(this,"customPrecision",ur,this),Object(S.a)(this,"precision",pr,this),Object(S.a)(this,"defaultFormatX",dr,this),Object(S.a)(this,"defaultFormatY",hr,this),Object(S.a)(this,"validWcs",gr,this),Object(S.a)(this,"setFont",mr,this),Object(S.a)(this,"setColor",fr,this),Object(E.p)(this),this.visible=!0,this.hidden=!1,this.fontSize=12,this.font=0,this.customColor=!1,this.color=4,this.customFormat=!1,this.defaultFormatX=yo.Degrees,this.defaultFormatY=yo.Degrees,this.formatX=yo.Degrees,this.formatY=yo.Degrees,this.customPrecision=!1,this.precision=3,this.validWcs=!1}get formatTypeX(){if(this.validWcs)return this.customFormat?this.formatX:this.defaultFormatX}get formatTypeY(){if(this.validWcs)return this.customFormat?this.formatY:this.defaultFormatY}get formatStringX(){if(!this.validWcs)return;const e=this.customPrecision?this.precision:"*";return`${this.formatTypeX}.${e}`}get formatStringY(){if(!this.validWcs)return;const e=this.customPrecision?this.precision:"*";return`${this.formatTypeY}.${e}`}cursorFormatStringX(e){if(!this.validWcs)return;return`${this.customFormat?this.formatX:this.defaultFormatX}.${e}`}cursorFormatStringY(e){if(!this.validWcs)return;return`${this.customFormat?this.formatY:this.defaultFormatY}.${e}`}get styleString(){let e=new So;return e.add("NumLab",this.show),e.add("Font(NumLab)",this.font),e.add("Size(NumLab)",this.fontSize),e.add("Color(NumLab)",this.color,this.customColor),e.add("Format(1)",this.formatStringX),e.add("Format(2)",this.formatStringY),e.toString()}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setFontSize(e){this.fontSize=e}setCustomColor(e){this.customColor=e}setCustomFormat(e){this.customFormat=e}setFormatX(e){this.formatX=e}setFormatY(e){this.formatY=e}setDefaultFormatX(e){this.defaultFormatX=e}setDefaultFormatY(e){this.defaultFormatY=e}setCustomPrecision(e){this.customPrecision=e}setPrecision(e){this.precision=e}setValidWcs(e){this.validWcs=e}},tr=Object(C.a)(er.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ir=Object(C.a)(er.prototype,"hidden",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=Object(C.a)(er.prototype,"font",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rr=Object(C.a)(er.prototype,"fontSize",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),or=Object(C.a)(er.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ar=Object(C.a)(er.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sr=Object(C.a)(er.prototype,"customFormat",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lr=Object(C.a)(er.prototype,"formatX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cr=Object(C.a)(er.prototype,"formatY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ur=Object(C.a)(er.prototype,"customPrecision",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pr=Object(C.a)(er.prototype,"precision",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dr=Object(C.a)(er.prototype,"defaultFormatX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hr=Object(C.a)(er.prototype,"defaultFormatY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gr=Object(C.a)(er.prototype,"validWcs",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(er.prototype,"formatTypeX",[E.i],Object.getOwnPropertyDescriptor(er.prototype,"formatTypeX"),er.prototype),Object(C.a)(er.prototype,"formatTypeY",[E.i],Object.getOwnPropertyDescriptor(er.prototype,"formatTypeY"),er.prototype),Object(C.a)(er.prototype,"formatStringX",[E.i],Object.getOwnPropertyDescriptor(er.prototype,"formatStringX"),er.prototype),Object(C.a)(er.prototype,"formatStringY",[E.i],Object.getOwnPropertyDescriptor(er.prototype,"formatStringY"),er.prototype),Object(C.a)(er.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(er.prototype,"styleString"),er.prototype),Object(C.a)(er.prototype,"show",[E.i],Object.getOwnPropertyDescriptor(er.prototype,"show"),er.prototype),Object(C.a)(er.prototype,"setVisible",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setVisible"),er.prototype),Object(C.a)(er.prototype,"setHidden",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setHidden"),er.prototype),mr=Object(C.a)(er.prototype,"setFont",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(C.a)(er.prototype,"setFontSize",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setFontSize"),er.prototype),Object(C.a)(er.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setCustomColor"),er.prototype),fr=Object(C.a)(er.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(C.a)(er.prototype,"setCustomFormat",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setCustomFormat"),er.prototype),Object(C.a)(er.prototype,"setFormatX",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setFormatX"),er.prototype),Object(C.a)(er.prototype,"setFormatY",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setFormatY"),er.prototype),Object(C.a)(er.prototype,"setDefaultFormatX",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setDefaultFormatX"),er.prototype),Object(C.a)(er.prototype,"setDefaultFormatY",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setDefaultFormatY"),er.prototype),Object(C.a)(er.prototype,"setCustomPrecision",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setCustomPrecision"),er.prototype),Object(C.a)(er.prototype,"setPrecision",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setPrecision"),er.prototype),Object(C.a)(er.prototype,"setValidWcs",[E.g],Object.getOwnPropertyDescriptor(er.prototype,"setValidWcs"),er.prototype),er),xo=(yr=class{constructor(){Object(S.a)(this,"visible",br,this),Object(S.a)(this,"hidden",Or,this),Object(S.a)(this,"customColor",Sr,this),Object(S.a)(this,"color",Cr,this),Object(S.a)(this,"font",Er,this),Object(S.a)(this,"fontSize",Ir,this),Object(S.a)(this,"customText",wr,this),Object(S.a)(this,"customLabelX",Tr,this),Object(S.a)(this,"customLabelY",vr,this),Object(S.a)(this,"setColor",Ar,this),Object(S.a)(this,"setFont",xr,this),Object(S.a)(this,"setCustomText",Rr,this),Object(S.a)(this,"setCustomLabelX",Pr,this),Object(S.a)(this,"setCustomLabelY",jr,this),Object(E.p)(this),this.visible=ol.Instance.astLabelsVisible,this.hidden=!1,this.fontSize=15,this.font=0,this.customColor=!1,this.color=4,this.customText=!1,this.customLabelX="",this.customLabelY=""}get styleString(){let e=new So;return e.add("TextLab",this.show),e.add("Font(TextLab)",this.font),e.add("Size(TextLab)",this.fontSize),e.add("Color(TextLab)",this.color,this.customColor),e.add("Label(1)",this.customLabelX,this.customText),e.add("Label(2)",this.customLabelY,this.customText),e.toString()}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setCustomColor(e){this.customColor=e}setFontSize(e){this.fontSize=e}},br=Object(C.a)(yr.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Or=Object(C.a)(yr.prototype,"hidden",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sr=Object(C.a)(yr.prototype,"customColor",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cr=Object(C.a)(yr.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Er=Object(C.a)(yr.prototype,"font",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ir=Object(C.a)(yr.prototype,"fontSize",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wr=Object(C.a)(yr.prototype,"customText",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tr=Object(C.a)(yr.prototype,"customLabelX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vr=Object(C.a)(yr.prototype,"customLabelY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(yr.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(yr.prototype,"styleString"),yr.prototype),Object(C.a)(yr.prototype,"show",[E.i],Object.getOwnPropertyDescriptor(yr.prototype,"show"),yr.prototype),Object(C.a)(yr.prototype,"setVisible",[E.g],Object.getOwnPropertyDescriptor(yr.prototype,"setVisible"),yr.prototype),Object(C.a)(yr.prototype,"setHidden",[E.g],Object.getOwnPropertyDescriptor(yr.prototype,"setHidden"),yr.prototype),Object(C.a)(yr.prototype,"setCustomColor",[E.g],Object.getOwnPropertyDescriptor(yr.prototype,"setCustomColor"),yr.prototype),Ar=Object(C.a)(yr.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),xr=Object(C.a)(yr.prototype,"setFont",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(C.a)(yr.prototype,"setFontSize",[E.g],Object.getOwnPropertyDescriptor(yr.prototype,"setFontSize"),yr.prototype),Rr=Object(C.a)(yr.prototype,"setCustomText",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customText=e}}}),Pr=Object(C.a)(yr.prototype,"setCustomLabelX",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customLabelX=e}}}),jr=Object(C.a)(yr.prototype,"setCustomLabelY",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customLabelY=e}}}),yr),Ro=(kr=class{constructor(){Object(S.a)(this,"visible",Fr,this),Object(S.a)(this,"color",Mr,this),Object(S.a)(this,"type",Dr,this),Object(S.a)(this,"width",Nr,this),Object(S.a)(this,"shiftX",Lr,this),Object(S.a)(this,"shiftY",_r,this),Object(S.a)(this,"setVisible",zr,this),Object(S.a)(this,"setColor",Wr,this),Object(S.a)(this,"setType",Gr,this),Object(S.a)(this,"setWidth",Vr,this),Object(S.a)(this,"setShiftX",Br,this),Object(S.a)(this,"setShiftY",qr,this),Object(E.p)(this);const e=ol.Instance;this.visible=e.beamVisible,this.color=e.beamColor,this.type=e.beamType,this.width=e.beamWidth,this.shiftX=this.shiftY=0}},Fr=Object(C.a)(kr.prototype,"visible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr=Object(C.a)(kr.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr=Object(C.a)(kr.prototype,"type",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nr=Object(C.a)(kr.prototype,"width",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lr=Object(C.a)(kr.prototype,"shiftX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_r=Object(C.a)(kr.prototype,"shiftY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=Object(C.a)(kr.prototype,"setVisible",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),Wr=Object(C.a)(kr.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Gr=Object(C.a)(kr.prototype,"setType",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.type=e}}}),Vr=Object(C.a)(kr.prototype,"setWidth",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.width=e}}}),Br=Object(C.a)(kr.prototype,"setShiftX",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.shiftX=e}}}),qr=Object(C.a)(kr.prototype,"setShiftY",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.shiftY=e}}}),kr),Po=(Hr=class{constructor(){Object(S.a)(this,"selectedFileId",Ur,this),Object(S.a)(this,"settingsForDisplay",Yr,this),Object(S.a)(this,"setSelectedFrame",Xr,this),Object(E.p)(this),this.selectedFileId=-1,this.settingsForDisplay=null,Object(E.h)(()=>{const e=ne.a.Instance;e.activeFrame&&e.activeFrame.frameInfo&&e.activeFrame.frameInfo.fileInfo&&this.setSelectedFrame(e.activeFrame.frameInfo.fileId)})}get isSelectedFrameValid(){return this.selectedFileId>=0&&null!==this.settingsForDisplay}},Ur=Object(C.a)(Hr.prototype,"selectedFileId",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yr=Object(C.a)(Hr.prototype,"settingsForDisplay",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Hr.prototype,"isSelectedFrameValid",[E.i],Object.getOwnPropertyDescriptor(Hr.prototype,"isSelectedFrameValid"),Hr.prototype),Xr=Object(C.a)(Hr.prototype,"setSelectedFrame",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileId=e;const t=ne.a.Instance.getFrame(e);t&&t.overlayBeamSettings&&(this.settingsForDisplay=t.overlayBeamSettings)}}}),Hr),jo=(uo=co=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(S.a)(this,"viewWidth",Qr,this),Object(S.a)(this,"viewHeight",Zr,this),Object(S.a)(this,"global",$r,this),Object(S.a)(this,"title",Jr,this),Object(S.a)(this,"grid",eo,this),Object(S.a)(this,"border",to,this),Object(S.a)(this,"axes",io,this),Object(S.a)(this,"numbers",no,this),Object(S.a)(this,"labels",ro,this),Object(S.a)(this,"ticks",oo,this),Object(S.a)(this,"beam",ao,this),Object(S.a)(this,"setViewDimension",so,this),Object(S.a)(this,"toggleLabels",lo,this),Object(E.p)(this),this.global=new Co,this.title=new Eo,this.grid=new Io,this.border=new wo,this.axes=new vo,this.numbers=new Ao,this.labels=new xo,this.ticks=new To,this.beam=new Po,this.viewHeight=1,this.viewWidth=1,Object(E.h)(()=>{this.global.system;this.setFormatsFromSystem();const e=ne.a.Instance.activeFrame;e&&e.wcsInfoForTransformation&&e.validWcs&&Gi.set(ne.a.Instance.activeFrame.wcsInfoForTransformation,"System="+this.global.explicitSystem)}),Object(E.h)(()=>{this.numbers.formatTypeX;const e=ne.a.Instance.activeFrame;e&&e.wcsInfoForTransformation&&e.validWcs&&Gi.set(ne.a.Instance.activeFrame.wcsInfoForTransformation,`Format(1)=${this.numbers.formatTypeX}.${Hi}`)}),Object(E.h)(()=>{this.numbers.formatTypeY;const e=ne.a.Instance.activeFrame;e&&e.wcsInfoForTransformation&&e.validWcs&&Gi.set(ne.a.Instance.activeFrame.wcsInfoForTransformation,`Format(2)=${this.numbers.formatTypeY}.${Hi}`)})}setFormatsFromSystem(){if(this.global.validWcs)switch(ol.Instance.wcsType){case Vi.WCSType.DEGREES:this.numbers.setDefaultFormatX(yo.Degrees),this.numbers.setDefaultFormatY(yo.Degrees);break;case Vi.WCSType.SEXAGESIMAL:this.numbers.setDefaultFormatX(yo.HMS),this.numbers.setDefaultFormatY(yo.DMS);break;case Vi.WCSType.AUTOMATIC:default:[fo.FK4,fo.FK5,fo.ICRS].indexOf(this.global.explicitSystem)>-1?(this.numbers.setDefaultFormatX(yo.HMS),this.numbers.setDefaultFormatY(yo.DMS)):(this.numbers.setDefaultFormatX(yo.Degrees),this.numbers.setDefaultFormatY(yo.Degrees))}else this.numbers.setDefaultFormatX(void 0),this.numbers.setDefaultFormatY(void 0);this.numbers.customFormat||(this.numbers.setFormatX(this.numbers.defaultFormatX),this.numbers.setFormatY(this.numbers.defaultFormatY))}setDefaultsFromAST(e){this.global.setValidWcs(e.validWcs),this.numbers.setValidWcs(e.validWcs),this.global.setDefaultSystem(Gi.getString(e.wcsInfo,"System")),this.setFormatsFromSystem()}get labelsHidden(){return this.labels.hidden&&this.numbers.hidden&&this.title.hidden}get styleString(){let e=new So;return e.addSection(this.global.styleString),e.addSection(this.title.styleString),e.addSection(this.grid.styleString),e.addSection(this.border.styleString),e.addSection(this.ticks.styleString),e.addSection(this.axes.styleString),e.addSection(this.numbers.styleString),e.addSection(this.labels.styleString),e.add("LabelUp",0),e.add("TitleGap",this.titleGap/this.minSize),e.add("NumLabGap",this.defaultGap/this.minSize),e.add("TextLabGap",this.cumulativeLabelGap/this.minSize),e.add("TextGapType","plot"),e.toString()}get minSize(){return Math.min(this.viewWidth,this.viewHeight)}get showNumbers(){return this.numbers.show&&this.global.labelType===mo.Exterior}get defaultGap(){return 5}get titleGap(){return 2*this.defaultGap}get cumulativeLabelGap(){return(this.showNumbers?this.defaultGap:0)+(this.showNumbers?this.numbers.fontSize:0)+this.defaultGap}get padding(){const e=this.showNumbers?this.defaultGap:0,t=this.showNumbers?this.numbers.fontSize:0,i=this.labels.show?this.defaultGap:0,n=this.labels.show?this.labels.fontSize:0;return{left:5+e+t+i+n,right:5,top:5+(this.title.show?this.titleGap:0)+(this.title.show?this.title.fontSize:0),bottom:5+e+t+i+n}}get renderWidth(){return this.viewWidth-this.padding.left-this.padding.right}get renderHeight(){return this.viewHeight-this.padding.top-this.padding.bottom}},co.staticInstance=void 0,Kr=uo,Qr=Object(C.a)(Kr.prototype,"viewWidth",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zr=Object(C.a)(Kr.prototype,"viewHeight",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$r=Object(C.a)(Kr.prototype,"global",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jr=Object(C.a)(Kr.prototype,"title",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eo=Object(C.a)(Kr.prototype,"grid",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Object(C.a)(Kr.prototype,"border",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),io=Object(C.a)(Kr.prototype,"axes",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no=Object(C.a)(Kr.prototype,"numbers",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ro=Object(C.a)(Kr.prototype,"labels",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=Object(C.a)(Kr.prototype,"ticks",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ao=Object(C.a)(Kr.prototype,"beam",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so=Object(C.a)(Kr.prototype,"setViewDimension",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.viewWidth=e,this.viewHeight=t}}}),Object(C.a)(Kr.prototype,"setFormatsFromSystem",[E.g],Object.getOwnPropertyDescriptor(Kr.prototype,"setFormatsFromSystem"),Kr.prototype),Object(C.a)(Kr.prototype,"setDefaultsFromAST",[E.g],Object.getOwnPropertyDescriptor(Kr.prototype,"setDefaultsFromAST"),Kr.prototype),lo=Object(C.a)(Kr.prototype,"toggleLabels",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=!this.labelsHidden;this.labels.setHidden(e),this.numbers.setHidden(e),this.title.setHidden(e)}}}),Object(C.a)(Kr.prototype,"labelsHidden",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"labelsHidden"),Kr.prototype),Object(C.a)(Kr.prototype,"styleString",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"styleString"),Kr.prototype),Object(C.a)(Kr.prototype,"minSize",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"minSize"),Kr.prototype),Object(C.a)(Kr.prototype,"showNumbers",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"showNumbers"),Kr.prototype),Object(C.a)(Kr.prototype,"defaultGap",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"defaultGap"),Kr.prototype),Object(C.a)(Kr.prototype,"titleGap",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"titleGap"),Kr.prototype),Object(C.a)(Kr.prototype,"cumulativeLabelGap",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"cumulativeLabelGap"),Kr.prototype),Object(C.a)(Kr.prototype,"padding",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"padding"),Kr.prototype),Object(C.a)(Kr.prototype,"renderWidth",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"renderWidth"),Kr.prototype),Object(C.a)(Kr.prototype,"renderHeight",[E.i],Object.getOwnPropertyDescriptor(Kr.prototype,"renderHeight"),Kr.prototype),Kr);var ko,Fo,Mo,Do,No,Lo,_o=i(61);let zo=(ko=class{constructor(e=0,t=0){this.regionId=void 0,this.fileId=void 0,Object(S.a)(this,"stokes",Fo,this),Object(S.a)(this,"channel",Mo,this),Object(S.a)(this,"x",Do,this),Object(S.a)(this,"y",No,this),Object(S.a)(this,"profiles",Lo,this),Object(E.p)(this),this.fileId=e,this.regionId=t,this.profiles=new Map}updateFromStream(e){if(this.channel===e.channel&&this.stokes===e.stokes&&this.x===e.x&&this.y===e.y)for(let t of e.profiles)this.profiles.set(t.coordinate,Vi.ProtobufProcessing.ProcessSpatialProfile(t));else{this.channel=e.channel,this.stokes=e.stokes,this.x=e.x,this.y=e.y;const t=new Map;for(let i of e.profiles)t.set(i.coordinate,Vi.ProtobufProcessing.ProcessSpatialProfile(i));this.profiles=t}}setProfile(e,t){this.profiles.set(e,t)}setProfiles(e){this.profiles=e}},Fo=Object(C.a)(ko.prototype,"stokes",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mo=Object(C.a)(ko.prototype,"channel",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Do=Object(C.a)(ko.prototype,"x",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),No=Object(C.a)(ko.prototype,"y",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lo=Object(C.a)(ko.prototype,"profiles",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(ko.prototype,"updateFromStream",[E.g],Object.getOwnPropertyDescriptor(ko.prototype,"updateFromStream"),ko.prototype),Object(C.a)(ko.prototype,"setProfile",[E.g],Object.getOwnPropertyDescriptor(ko.prototype,"setProfile"),ko.prototype),Object(C.a)(ko.prototype,"setProfiles",[E.g],Object.getOwnPropertyDescriptor(ko.prototype,"setProfiles"),ko.prototype),ko);var Wo,Go,Vo,Bo,qo;let Ho=(Wo=class{constructor(e=0,t=0){this.regionId=void 0,this.fileId=void 0,Object(S.a)(this,"stokes",Go,this),Object(S.a)(this,"x",Vo,this),Object(S.a)(this,"y",Bo,this),Object(S.a)(this,"profiles",qo,this),Object(E.p)(this),this.fileId=e,this.regionId=t,this.profiles=new Map}getProfile(e,t){let i=this.profiles.get(e);return i?i.get(t):null}clearProfiles(){this.profiles=new Map}setProfile(e){let t=this.profiles.get(e.coordinate);t||(t=new E.b,this.profiles.set(e.coordinate,t)),t.set(e.statsType,e)}},Go=Object(C.a)(Wo.prototype,"stokes",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vo=Object(C.a)(Wo.prototype,"x",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=Object(C.a)(Wo.prototype,"y",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qo=Object(C.a)(Wo.prototype,"profiles",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Wo.prototype,"clearProfiles",[E.g],Object.getOwnPropertyDescriptor(Wo.prototype,"clearProfiles"),Wo.prototype),Object(C.a)(Wo.prototype,"setProfile",[E.g],Object.getOwnPropertyDescriptor(Wo.prototype,"setProfile"),Wo.prototype),Wo);var Uo,Yo,Xo,Ko,Qo,Zo,$o,Jo,ea,ta,ia,na,ra,oa,aa,sa,la,ca,ua,pa,da,ha,ga,ma,fa,ya,ba,Oa,Sa,Ca,Ea,Ia,wa,Ta,va,Aa,xa,Ra=i(80),Pa=i.n(Ra);let ja;!function(e){e.Region="Region List Widget",e.Log="Log Widget",e.SpatialProfiler="Spatial Profiler",e.SpectralProfiler="Spectral Profiler",e.Statistics="Statistics Widget",e.Histogram="Histogram Widget",e.Animator="Animator Widget",e.RenderConfig="Render Config Widget",e.StokesAnalysis="Stokes Analysis Widget",e.ImageList="Image List Widget",e.Catalog="Catalog Widget",e.SpectralLineQuery="Spectral Line Query Widget"}(ja||(ja={}));let ka=(Uo=class{constructor(e,t){this.id=void 0,this.type=void 0,this.minWidth=void 0,this.minHeight=void 0,Object(S.a)(this,"defaultWidth",Yo,this),Object(S.a)(this,"defaultHeight",Xo,this),Object(S.a)(this,"defaultX",Ko,this),Object(S.a)(this,"defaultY",Qo,this),this.isCloseable=void 0,Object(S.a)(this,"title",Zo,this),this.parentId=void 0,this.parentType=void 0,this.helpType=void 0,this.componentId=void 0,this.zIndex=0,Object(S.a)(this,"setDefaultPosition",$o,this),Object(S.a)(this,"setDefaultSize",Jo,this),Object(E.p)(this),this.id=e,this.type=t.type,this.minWidth=t.minWidth,this.minHeight=t.minHeight,this.defaultWidth=t.defaultWidth||t.minWidth,this.defaultHeight=t.defaultHeight||t.minHeight,this.defaultX=t.defaultX,this.defaultY=t.defaultY,this.isCloseable=t.isCloseable,this.title=t.title,this.parentId=t.parentId,this.parentType=t.parentType,this.helpType=t.helpType,this.componentId=t.componentId}},Yo=Object(C.a)(Uo.prototype,"defaultWidth",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xo=Object(C.a)(Uo.prototype,"defaultHeight",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=Object(C.a)(Uo.prototype,"defaultX",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=Object(C.a)(Uo.prototype,"defaultY",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zo=Object(C.a)(Uo.prototype,"title",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=Object(C.a)(Uo.prototype,"setDefaultPosition",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultX=e,this.defaultY=t}}}),Jo=Object(C.a)(Uo.prototype,"setDefaultSize",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultWidth=e,this.defaultHeight=t}}}),Uo);let Fa=(xa=Aa=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}static RemoveFrameFromRegionWidgets(e,t=Bi.a){t===Bi.a?e.forEach(e=>{e.clearRegionMap()}):e.forEach(e=>{e.clearFrameEntry(t),e.fileId===t&&e.setFileId(Bi.a)})}constructor(){Object(S.a)(this,"floatingWidgets",ta,this),Object(S.a)(this,"renderConfigWidgets",ia,this),Object(S.a)(this,"spatialProfileWidgets",na,this),Object(S.a)(this,"spectralProfileWidgets",ra,this),Object(S.a)(this,"statsWidgets",oa,this),Object(S.a)(this,"histogramWidgets",aa,this),Object(S.a)(this,"layerListWidgets",sa,this),Object(S.a)(this,"logWidgets",la,this),Object(S.a)(this,"regionListWidgets",ca,this),Object(S.a)(this,"animatorWidgets",ua,this),Object(S.a)(this,"stokesAnalysisWidgets",pa,this),Object(S.a)(this,"floatingSettingsWidgets",da,this),Object(S.a)(this,"catalogWidgets",ha,this),Object(S.a)(this,"catalogPlotWidgets",ga,this),Object(S.a)(this,"spectralLineQueryWidgets",ma,this),this.widgetsMap=void 0,this.defaultFloatingWidgetOffset=void 0,this.CARTAWidgets=new Map([[ja.Region,{isCustomIcon:!0,icon:"regionList",onClick:()=>e.Instance.createFloatingRegionListWidget()}],[ja.Log,{isCustomIcon:!1,icon:"application",onClick:()=>e.Instance.createFloatingLogWidget()}],[ja.SpatialProfiler,{isCustomIcon:!0,icon:"spatialProfiler",onClick:()=>e.Instance.createFloatingSpatialProfilerWidget()}],[ja.SpectralProfiler,{isCustomIcon:!0,icon:"spectralProfiler",onClick:()=>e.Instance.createFloatingSpectralProfilerWidget()}],[ja.Statistics,{isCustomIcon:!1,icon:"calculator",onClick:()=>e.Instance.createFloatingStatsWidget()}],[ja.Histogram,{isCustomIcon:!1,icon:"timeline-bar-chart",onClick:()=>e.Instance.createFloatingHistogramWidget()}],[ja.Animator,{isCustomIcon:!1,icon:"video",onClick:()=>e.Instance.createFloatingAnimatorWidget()}],[ja.RenderConfig,{isCustomIcon:!1,icon:"style",onClick:()=>e.Instance.createFloatingRenderWidget()}],[ja.StokesAnalysis,{isCustomIcon:!0,icon:"stokes",onClick:()=>e.Instance.createFloatingStokesWidget()}],[ja.ImageList,{isCustomIcon:!1,icon:"layers",onClick:()=>e.Instance.createFloatingLayerListWidget()}],[ja.Catalog,{isCustomIcon:!1,icon:"heatmap",onClick:()=>e.Instance.reloadFloatingCatalogWidget()}],[ja.SpectralLineQuery,{isCustomIcon:!0,icon:"spectralLineQuery",onClick:()=>e.Instance.createFloatingSpectralLineQueryWidget()}]]),this.getNextId=e=>{const t=this.widgetsMap.get(e);if(!t)return null;let i=0;for(;;){const n=`${e}-${i}`;if(!t.has(n))return n;i++}},this.getNextSettingId=(e,t)=>{const i=this.floatingSettingsWidgets;if(!i)return null;let n=!1;if(i.forEach(e=>{e===t&&(n=!0)}),n)return null;let r=0;for(;;){const n=`${t}-${e}-${r}`;if(!i.has(n))return n;r++}},this.getFloatingWidgetOffset=()=>(this.defaultFloatingWidgetOffset+=25,this.defaultFloatingWidgetOffset=(this.defaultFloatingWidgetOffset-100)%300+100,this.defaultFloatingWidgetOffset),this.removeWidget=(e,t)=>{const i=this.widgetsMap.get(t);i&&(this.removeAssociatedFloatingSetting(e),i.delete(e));this.floatingSettingsWidgets.has(e)&&this.floatingSettingsWidgets.delete(e)},this.addWidgetByType=(e,t=null)=>{let i;switch(e){case Ct.k.WIDGET_CONFIG.type:i=Ct.k.WIDGET_CONFIG.id;break;case Ct.s.WIDGET_CONFIG.type:i=this.addRenderConfigWidget(null,t);break;case Ct.v.WIDGET_CONFIG.type:i=this.addSpatialProfileWidget(null,t);break;case Ct.z.WIDGET_CONFIG.type:i=this.addSpectralProfileWidget(null,t);break;case Ct.D.WIDGET_CONFIG.type:i=this.addStatsWidget();break;case Ct.i.WIDGET_CONFIG.type:i=this.addHistogramWidget(null,t);break;case Ct.a.WIDGET_CONFIG.type:i=this.addAnimatorWidget();break;case Ct.n.WIDGET_CONFIG.type:i=this.addLayerListWidget();break;case Ct.o.WIDGET_CONFIG.type:i=this.addLogWidget();break;case Ct.q.WIDGET_CONFIG.type:i=this.addRegionListWidget();break;case Ct.E.WIDGET_CONFIG.type:i=this.addStokesWidget(null,t);break;case Ct.y.WIDGET_CONFIG.type:i=this.addSpectralLineQueryWidget();break;case Ct.b.WIDGET_CONFIG.type:i=this.getNextComponentId(Ct.b.WIDGET_CONFIG),yc.Instance.catalogProfiles.set(i,1),t&&this.addCatalogWidget(t.catalogFileId,null,t);break;case Bi.c.D2Scatter:const n={xColumnName:"None",yColumnName:"None",plotType:Bi.c.D2Scatter};i=this.addCatalogPlotWidget(n);const r=this.getNextComponentId(Ct.d.WIDGET_CONFIG);yc.Instance.setCatalogPlots(r,1,i);break;case Bi.c.Histogram:const o={xColumnName:"None",yColumnName:void 0,plotType:Bi.c.Histogram};i=this.addCatalogPlotWidget(o);const a=this.getNextComponentId(Ct.d.WIDGET_CONFIG);yc.Instance.setCatalogPlots(a,1,i);break;default:this.floatingWidgets.find(t=>t.id===e)&&this.removeFloatingWidget(e,!0),i=null}return i},this.removeFloatingWidgets=()=>{this.floatingWidgets&&this.floatingWidgets.forEach(e=>this.removeFloatingWidget(e.id))},this.createFloatingWidget=t=>{if(t.id){let i=t.id;t.plotType&&(i=t.plotType);const n=this.addWidgetByType(i,t.widgetSettings);let r=new ka(n,e.GetDefaultWidgetConfig(t.id));if(r.setDefaultSize(t.defaultWidth||r.defaultWidth,t.defaultHeight||r.defaultHeight),r.componentId&&(r.componentId=r.id),t.defaultX>0&&t.defaultY>0)r.setDefaultPosition(t.defaultX,t.defaultY);else{const e=this.getFloatingWidgetOffset();r.setDefaultPosition(e,e)}this.floatingWidgets.push(r)}},this.initWidgets=(e,t)=>{e.forEach(e=>{if(e.id&&e.props){let t=e.id;"plotType"in e&&(t=e.plotType);const i=this.addWidgetByType(t,"widgetSettings"in e?e.widgetSettings:null);i&&(e.id=i,e.props.id=i)}}),t.forEach(e=>this.createFloatingWidget(e))},this.initLayoutWithWidgets=t=>{if(!t)return void console.log("Invalid parameters!");t.registerComponent("placeholder",Ct.p),t.registerComponent("image-view",Ct.k),t.registerComponent("spatial-profiler",Ct.v),t.registerComponent("spectral-profiler",Ct.z),t.registerComponent("spectral-line-query",Ct.y),t.registerComponent("stats",Ct.D),t.registerComponent("histogram",Ct.i),t.registerComponent("render-config",Ct.s),t.registerComponent("region-list",Ct.q),t.registerComponent("layer-list",Ct.n),t.registerComponent("log",Ct.o),t.registerComponent("animator",Ct.a),t.registerComponent("stokes",Ct.E),t.registerComponent("catalog-overlay",Ct.b),t.registerComponent("catalog-plot",Ct.d);const i=["image-view","spatial-profiler","spectral-profiler","histogram","render-config","stokes","catalog-overlay"];Ct.H.DRAGSOURCE_WIDGETCONFIG_MAP.forEach((i,n)=>e.CreateDragSource(t,i,n)),t.on("stackCreated",t=>{const n=Pa()('<li class="lm-pin" title="detach"><span class="bp3-icon-standard bp3-icon-unpin"/></li>');n.on("click",()=>this.unpinWidget(t.getActiveContentItem())),t.header.controlsContainer.prepend(n);const r=Pa()('<li class="lm-help" title="help"><span class="bp3-icon-standard bp3-icon-help"/></li>');r.on("click",e=>this.onHelpPinedClick(e,t.getActiveContentItem())),t.header.controlsContainer.prepend(r),t.on("activeContentItemChanged",n=>{if(t&&t.config&&t.header.controlsContainer&&t.config.content.length){var r,o;const n=t.getActiveContentItem().config.component,a=t.header.controlsContainer[0];if(n&&i.includes(n)&&(null===a||void 0===a?void 0:a.childElementCount)<5){const i=Pa()('<li class="lm_settings" title="settings"><span class="bp3-icon-standard bp3-icon-cog"/></li>');i.on("click",()=>e.Instance.onCogPinedClick(t.getActiveContentItem())),t.header.controlsContainer.prepend(i)}else i.includes(n)||5!==(null===a||void 0===a?void 0:a.childElementCount)||a.children[0].remove();null===(r=Pa()(a))||void 0===r||null===(o=r.find("li.lm-pin"))||void 0===o||o.attr("style","image-view"===n?"display:none;":"")}})}),t.on("componentCreated",this.handleItemCreation),t.on("itemDestroyed",this.handleItemRemoval),t.on("stateChanged",this.handleStateUpdates)},this.toWidgetSettingsConfig=(e,t)=>{var i,n;if(!e||!t)return null;let r=null;switch(e){case Ct.s.WIDGET_CONFIG.type:r=this.renderConfigWidgets.get(t);break;case Ct.v.WIDGET_CONFIG.type:r=this.spatialProfileWidgets.get(t);break;case Ct.z.WIDGET_CONFIG.type:r=this.spectralProfileWidgets.get(t);break;case Ct.i.WIDGET_CONFIG.type:r=this.histogramWidgets.get(t);break;case Ct.E.WIDGET_CONFIG.type:r=this.stokesAnalysisWidgets.get(t);break;case Ct.b.WIDGET_CONFIG.type:r=this.catalogWidgets.get(t)}return null===(i=r)||void 0===i||null===(n=i.toConfig)||void 0===n?void 0:n.call(i)},Object(S.a)(this,"onCogPinedClick",fa,this),Object(S.a)(this,"unpinWidget",ya,this),Object(S.a)(this,"onHelpPinedClick",ba,this),Object(S.a)(this,"handleItemCreation",Oa,this),Object(S.a)(this,"handleItemRemoval",Sa,this),Object(S.a)(this,"handleStateUpdates",Ca,this),this.createFloatingSpatialProfilerWidget=()=>{this.addFloatingWidget(new ka(this.addSpatialProfileWidget(),Ct.v.WIDGET_CONFIG))},this.createFloatingSpectralProfilerWidget=()=>{this.addFloatingWidget(new ka(this.addSpectralProfileWidget(),Ct.z.WIDGET_CONFIG))},this.getSpectralWidgetStoreByID=e=>this.spectralProfileWidgets.get(e),this.createFloatingStokesWidget=()=>{this.addFloatingWidget(new ka(this.addStokesWidget(),Ct.E.WIDGET_CONFIG))},this.getNextComponentId=e=>{let t=0,i=[];for(e.type===Ct.d.WIDGET_CONFIG.type?yc.Instance.catalogPlots.forEach((e,t)=>{i.push(t)}):e.type===Ct.b.WIDGET_CONFIG.type&&yc.Instance.catalogProfiles.forEach((e,t)=>{i.push(t)});;){const n=`${e.componentId}-${t}`;if(!i.includes(n))return n;t++}},this.createFloatingCatalogWidget=e=>{const t=this.addCatalogWidget(e),i=this.getNextComponentId(Ct.b.WIDGET_CONFIG);let n=new ka(i,Ct.b.WIDGET_CONFIG);return n.componentId=i,this.addFloatingWidget(n),{widgetStoreId:t,widgetComponentId:i}},this.reloadFloatingCatalogWidget=()=>{const e=ne.a.Instance.catalogNum,t=this.getNextComponentId(Ct.b.WIDGET_CONFIG);let i=new ka(t,Ct.b.WIDGET_CONFIG);i.componentId=t,e&&yc.Instance.catalogProfiles.set(t,e),this.addFloatingWidget(i)},this.createFloatingCatalogPlotWidget=e=>{const t=Ct.d.WIDGET_CONFIG,i=this.addCatalogPlotWidget(e),n=this.getNextComponentId(t),r=new ka(i,t);return r.id=i,r.componentId=n,r.helpType=e.plotType===Bi.c.Histogram?Ac.CATALOG_HISTOGRAM_PLOT:Ac.CATALOG_SCATTER_PLOT,this.addFloatingWidget(r),{widgetStoreId:i,widgetComponentId:n}},this.createFloatingSpectralLineQueryWidget=()=>{const e=new ka(this.addSpectralLineQueryWidget(),Ct.y.WIDGET_CONFIG);return e.componentId=this.getNextComponentId(e),this.addFloatingWidget(e),e.id},this.createFloatingSettingsWidget=(t,i,n)=>{const r=e.GetDefaultWidgetSettingsConfig(n),o=new ka(this.addFloatingSettingsWidget(null,i,r.type),r);o.title=t+" Settings",o.parentId=i,o.parentType=n,o.id&&this.addFloatingWidget(o)},this.createFloatingStatsWidget=()=>{this.addFloatingWidget(new ka(this.addStatsWidget(),Ct.D.WIDGET_CONFIG))},this.createFloatingHistogramWidget=()=>{this.addFloatingWidget(new ka(this.addHistogramWidget(),Ct.i.WIDGET_CONFIG))},this.createFloatingRenderWidget=()=>{this.addFloatingWidget(new ka(this.addRenderConfigWidget(),Ct.s.WIDGET_CONFIG))},this.createFloatingLogWidget=()=>{this.addFloatingWidget(new ka(this.addLogWidget(),Ct.o.WIDGET_CONFIG))},this.createFloatingAnimatorWidget=()=>{this.addFloatingWidget(new ka(this.addAnimatorWidget(),Ct.a.WIDGET_CONFIG))},this.createFloatingRegionListWidget=()=>{this.addFloatingWidget(new ka(this.addRegionListWidget(),Ct.q.WIDGET_CONFIG))},this.createFloatingLayerListWidget=()=>{this.addFloatingWidget(new ka(this.addLayerListWidget(),Ct.n.WIDGET_CONFIG))},Object(S.a)(this,"selectFloatingWidget",Ea,this),Object(S.a)(this,"updateSelectFloatingWidgetzIndex",Ia,this),Object(S.a)(this,"addFloatingWidget",wa,this),Object(S.a)(this,"removeFloatingWidget",Ta,this),Object(S.a)(this,"removeFloatingWidgetComponent",va,this),this.removeAssociatedFloatingSetting=e=>{var t;if(null===(t=this.floatingSettingsWidgets)||void 0===t?void 0:t.size){let t=null;this.floatingSettingsWidgets.forEach((i,n)=>{i===e&&(t=n)}),t&&(this.removeFloatingWidget(t,!0),this.floatingSettingsWidgets.delete(t))}},Object(E.p)(this),this.spatialProfileWidgets=new Map,this.spectralProfileWidgets=new Map,this.statsWidgets=new Map,this.histogramWidgets=new Map,this.renderConfigWidgets=new Map,this.animatorWidgets=new Map,this.layerListWidgets=new Map,this.logWidgets=new Map,this.regionListWidgets=new Map,this.stokesAnalysisWidgets=new Map,this.catalogWidgets=new Map,this.floatingSettingsWidgets=new Map,this.catalogPlotWidgets=new Map,this.spectralLineQueryWidgets=new Map,this.widgetsMap=new Map([[Ct.v.WIDGET_CONFIG.type,this.spatialProfileWidgets],[Ct.z.WIDGET_CONFIG.type,this.spectralProfileWidgets],[Ct.D.WIDGET_CONFIG.type,this.statsWidgets],[Ct.i.WIDGET_CONFIG.type,this.histogramWidgets],[Ct.s.WIDGET_CONFIG.type,this.renderConfigWidgets],[Ct.a.WIDGET_CONFIG.type,this.animatorWidgets],[Ct.n.WIDGET_CONFIG.type,this.layerListWidgets],[Ct.o.WIDGET_CONFIG.type,this.logWidgets],[Ct.q.WIDGET_CONFIG.type,this.regionListWidgets],[Ct.E.WIDGET_CONFIG.type,this.stokesAnalysisWidgets],[Ct.b.WIDGET_CONFIG.type,this.catalogWidgets],[Ct.d.WIDGET_CONFIG.type,this.catalogPlotWidgets],[Ct.y.WIDGET_CONFIG.type,this.spectralLineQueryWidgets]]),this.floatingWidgets=[],this.defaultFloatingWidgetOffset=100}static GetDefaultWidgetConfig(e){switch(e){case Ct.k.WIDGET_CONFIG.type:return Ct.k.WIDGET_CONFIG;case Ct.s.WIDGET_CONFIG.type:return Ct.s.WIDGET_CONFIG;case Ct.n.WIDGET_CONFIG.type:return Ct.n.WIDGET_CONFIG;case Ct.o.WIDGET_CONFIG.type:return Ct.o.WIDGET_CONFIG;case Ct.a.WIDGET_CONFIG.type:return Ct.a.WIDGET_CONFIG;case Ct.v.WIDGET_CONFIG.type:return Ct.v.WIDGET_CONFIG;case Ct.z.WIDGET_CONFIG.type:return Ct.z.WIDGET_CONFIG;case Ct.D.WIDGET_CONFIG.type:return Ct.D.WIDGET_CONFIG;case Ct.i.WIDGET_CONFIG.type:return Ct.i.WIDGET_CONFIG;case Ct.q.WIDGET_CONFIG.type:return Ct.q.WIDGET_CONFIG;case Ct.E.WIDGET_CONFIG.type:return Ct.E.WIDGET_CONFIG;case Ct.b.WIDGET_CONFIG.type:return Ct.b.WIDGET_CONFIG;case Ct.d.WIDGET_CONFIG.type:return Ct.d.WIDGET_CONFIG;case Ct.y.WIDGET_CONFIG.type:return Ct.y.WIDGET_CONFIG;default:return Ct.p.WIDGET_CONFIG}}static GetDefaultWidgetSettingsConfig(e){switch(e){case Ct.k.WIDGET_CONFIG.type:return Ct.m.WIDGET_CONFIG;case Ct.E.WIDGET_CONFIG.type:return Ct.F.WIDGET_CONFIG;case Ct.z.WIDGET_CONFIG.type:return Ct.A.WIDGET_CONFIG;case Ct.v.WIDGET_CONFIG.type:return Ct.w.WIDGET_CONFIG;case Ct.s.WIDGET_CONFIG.type:return Ct.t.WIDGET_CONFIG;case Ct.i.WIDGET_CONFIG.type:return Ct.j.WIDGET_CONFIG;case Ct.b.WIDGET_CONFIG.type:return Ct.c.WIDGET_CONFIG;default:return Ct.p.WIDGET_CONFIG}}static CreateDragSource(e,t,i){const n={type:"react-component",component:t.type,title:t.title,id:t.id,isClosable:t.isCloseable,props:{appStore:ne.a.Instance,id:t.id,docked:!0}},r=document.getElementById(i);r&&e.createDragSource(r,n)}updateImageWidgetTitle(e){const t=ne.a.Instance;let i;if(i=t.activeFrame?t.activeFrame.filename:"No image loaded",null===e||void 0===e?void 0:e.root){const t=e.root.getItemsByFilter(e=>e.config.component===Ct.k.WIDGET_CONFIG.type);t.length&&t[0].config&&t[0].config.title!==i&&t[0].setTitle(i)}const n=this.floatingWidgets.find(e=>e.type===Ct.k.WIDGET_CONFIG.type);n&&n.title!==i&&this.setWidgetTitle(n.id,i)}setWidgetTitle(e,t){const i=Ol.Instance;if(i.dockedLayout&&i.dockedLayout.root){const n=i.dockedLayout.root.getItemsByFilter(t=>t.config.id===e);n.length&&n[0].setTitle(t)}const n=this.floatingWidgets.find(t=>t.id===e);n&&(n.title=t)}setWidgetComponentTitle(e,t){const i=Ol.Instance;if(i.dockedLayout&&i.dockedLayout.root){const n=i.dockedLayout.root.getItemsById(e);n.length&&n[0].setTitle(t)}const n=this.floatingWidgets.find(t=>t.componentId===e);n&&(n.title=t)}changeWidgetId(e,t){const i=this.floatingWidgets.find(t=>t.id===e);i&&(i.id=t)}addSpatialProfileWidget(e=null,t=null){if(e||(e=this.getNextId(Ct.v.WIDGET_CONFIG.type)),e){const i=new Bi.o;t&&i.init(t),this.spatialProfileWidgets.set(e,i)}return e}addSpectralProfileWidget(e=null,t=null){if(e||(e=this.getNextId(Ct.z.WIDGET_CONFIG.type)),e){const i=new Bi.s;t&&i.init(t),this.spectralProfileWidgets.set(e,i)}return e}get spectralProfilerList(){return Array.from(this.spectralProfileWidgets.keys())}get hasSpectralProfiler(){return this.spectralProfileWidgets&&this.spectralProfileWidgets.size>0}get isSpectralWidgetStreamingData(){let e=!1;return this.spectralProfileWidgets.forEach(t=>{e=e||t.isStreamingData}),e}addStokesWidget(e=null,t=null){if(e||(e=this.getNextId(Ct.E.WIDGET_CONFIG.type)),e){const i=new Bi.u;t&&i.init(t),this.stokesAnalysisWidgets.set(e,i)}return e}addCatalogWidget(e,t=null,i=null){const n=yc.Instance,r=n.catalogWidgets.get(e);if(r)return r;if(t||(t=this.getNextId(Ct.b.WIDGET_CONFIG.type)),t){const n=new Bi.f(e);i&&n.init(i),this.catalogWidgets.set(t,n)}return n.catalogWidgets.set(e,t),t}addCatalogPlotWidget(e,t=null){return t||(t=this.getNextId(Ct.d.WIDGET_CONFIG.type)),t&&this.catalogPlotWidgets.set(t,new Bi.d(e)),t}addSpectralLineQueryWidget(e=null){return e||(e=this.getNextId(Ct.y.WIDGET_CONFIG.type)),e&&this.spectralLineQueryWidgets.set(e,new Bi.r),e}addFloatingSettingsWidget(e=null,t,i){return e||(e=this.getNextSettingId(i,t)),e&&this.floatingSettingsWidgets.set(e,t),e}addStatsWidget(e=null){return e||(e=this.getNextId(Ct.D.WIDGET_CONFIG.type)),e&&this.statsWidgets.set(e,new Bi.t),e}addHistogramWidget(e=null,t=null){if(e||(e=this.getNextId(Ct.i.WIDGET_CONFIG.type)),e){const i=new Bi.h;t&&i.init(t),this.histogramWidgets.set(e,i)}return e}addRenderConfigWidget(e=null,t=null){if(e||(e=this.getNextId(Ct.s.WIDGET_CONFIG.type)),e){const i=new Bi.n;t&&i.init(t),this.renderConfigWidgets.set(e,i)}return e}addLogWidget(e=null){return e||(e=this.getNextId(Ct.o.WIDGET_CONFIG.type)),e&&this.logWidgets.set(e,new Bi.g),e}addAnimatorWidget(e=null){return e||(e=this.getNextId(Ct.a.WIDGET_CONFIG.type)),e&&this.animatorWidgets.set(e,new Bi.g),e}addRegionListWidget(e=null){return e||(e=this.getNextId(Ct.q.WIDGET_CONFIG.type)),e&&this.regionListWidgets.set(e,new Bi.g),e}addLayerListWidget(e=null){return e||(e=this.getNextId(Ct.n.WIDGET_CONFIG.type)),e&&this.layerListWidgets.set(e,new Bi.g),e}updateFloatingWidgetzIndexOnRemove(e){const t=this.floatingWidgets.length;if(e<t)for(let i=0;i<t;i++){const t=this.floatingWidgets[i].zIndex;t>e&&(this.floatingWidgets[i].zIndex=t-1)}}},Aa.staticInstance=void 0,Aa.RemoveRegionFromRegionWidgets=(e,t,i)=>{e.forEach(e=>{const n=e.regionIdMap.get(t);isFinite(n)&&n===i&&e.clearFrameEntry(t)})},ea=xa,ta=Object(C.a)(ea.prototype,"floatingWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ia=Object(C.a)(ea.prototype,"renderConfigWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),na=Object(C.a)(ea.prototype,"spatialProfileWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ra=Object(C.a)(ea.prototype,"spectralProfileWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oa=Object(C.a)(ea.prototype,"statsWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aa=Object(C.a)(ea.prototype,"histogramWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sa=Object(C.a)(ea.prototype,"layerListWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),la=Object(C.a)(ea.prototype,"logWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ca=Object(C.a)(ea.prototype,"regionListWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ua=Object(C.a)(ea.prototype,"animatorWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pa=Object(C.a)(ea.prototype,"stokesAnalysisWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),da=Object(C.a)(ea.prototype,"floatingSettingsWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ha=Object(C.a)(ea.prototype,"catalogWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ga=Object(C.a)(ea.prototype,"catalogPlotWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ma=Object(C.a)(ea.prototype,"spectralLineQueryWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa=Object(C.a)(ea.prototype,"onCogPinedClick",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=t.component,r=t.title;if(-1===[Ct.k.WIDGET_CONFIG.type,Ct.E.WIDGET_CONFIG.type,Ct.z.WIDGET_CONFIG.type,Ct.v.WIDGET_CONFIG.type,Ct.s.WIDGET_CONFIG.type,Ct.i.WIDGET_CONFIG.type,Ct.b.WIDGET_CONFIG.type].indexOf(n))return;const o=Fa.GetDefaultWidgetSettingsConfig(n);let a=new ka(this.addFloatingSettingsWidget(null,i,o.type),o);a.title="image-view"===n?"Image View Settings":r+" Settings",a.parentId=i,a.parentType=n,a.id&&this.addFloatingWidget(a)}}}),ya=Object(C.a)(ea.prototype,"unpinWidget",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=t.component,r=t.title;if(n===Ct.k.WIDGET_CONFIG.type)return;let o=new ka(i,Fa.GetDefaultWidgetConfig(n));o.title=r,n===Ct.b.WIDGET_CONFIG.type&&(o.componentId=i);const a=e.container;if(a&&a.width&&a.height){o.setDefaultSize(25*Math.round(a.width/25),25*Math.round(a.height/25));const e=a._element[0];o.setDefaultPosition(25*Math.round(e.offsetLeft/25)+5,25*Math.round(e.offsetTop/25)-25)}this.addFloatingWidget(o);e.config.component="floated",e.remove()}}}),ba=Object(C.a)(ea.prototype,"onHelpPinedClick",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=t.config.component;let n=Fa.GetDefaultWidgetConfig(i);if(n.helpType&&!Array.isArray(n.helpType)){const i=t.container;let r=0;i&&i.width&&(r=e.target.getBoundingClientRect().right+36-.5*i.width),xc.Instance.showHelpDrawer(n.helpType,r)}}}}),Oa=Object(C.a)(ea.prototype,"handleItemCreation",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=this.addWidgetByType(i);n&&(t.id=n,t.props.id=n)}}}),Sa=Object(C.a)(ea.prototype,"handleItemRemoval",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if("component"===e.config.type){const t=e.config,i=t.component===Ct.b.WIDGET_CONFIG.type,n=t.component===Ct.d.WIDGET_CONFIG.type,r=t.id;"floated"===t.component||i||n||this.removeWidget(r,t.component),i&&(yc.Instance.catalogProfiles.delete(r),this.removeAssociatedFloatingSetting(r)),n&&yc.Instance.clearCatalogPlotsByWidgetId(r)}}}}),Ca=Object(C.a)(ea.prototype,"handleStateUpdates",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e&&e.origin&&e.origin.isMaximised&&e.origin.header){const t=e.origin.header;if(t.controlsContainer&&t.controlsContainer.length){const e=t.controlsContainer[0];if(e.children&&e.children.length){const t=e.children[e.children.length-1];t&&t.setAttribute("title","restore")}}}}}}),Object(C.a)(ea.prototype,"updateImageWidgetTitle",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"updateImageWidgetTitle"),ea.prototype),Object(C.a)(ea.prototype,"setWidgetTitle",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"setWidgetTitle"),ea.prototype),Object(C.a)(ea.prototype,"setWidgetComponentTitle",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"setWidgetComponentTitle"),ea.prototype),Object(C.a)(ea.prototype,"changeWidgetId",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"changeWidgetId"),ea.prototype),Object(C.a)(ea.prototype,"addSpatialProfileWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addSpatialProfileWidget"),ea.prototype),Object(C.a)(ea.prototype,"addSpectralProfileWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addSpectralProfileWidget"),ea.prototype),Object(C.a)(ea.prototype,"spectralProfilerList",[E.i],Object.getOwnPropertyDescriptor(ea.prototype,"spectralProfilerList"),ea.prototype),Object(C.a)(ea.prototype,"hasSpectralProfiler",[E.i],Object.getOwnPropertyDescriptor(ea.prototype,"hasSpectralProfiler"),ea.prototype),Object(C.a)(ea.prototype,"isSpectralWidgetStreamingData",[E.i],Object.getOwnPropertyDescriptor(ea.prototype,"isSpectralWidgetStreamingData"),ea.prototype),Object(C.a)(ea.prototype,"addStokesWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addStokesWidget"),ea.prototype),Object(C.a)(ea.prototype,"addCatalogWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addCatalogWidget"),ea.prototype),Object(C.a)(ea.prototype,"addCatalogPlotWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addCatalogPlotWidget"),ea.prototype),Object(C.a)(ea.prototype,"addSpectralLineQueryWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addSpectralLineQueryWidget"),ea.prototype),Object(C.a)(ea.prototype,"addFloatingSettingsWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addFloatingSettingsWidget"),ea.prototype),Object(C.a)(ea.prototype,"addStatsWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addStatsWidget"),ea.prototype),Object(C.a)(ea.prototype,"addHistogramWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addHistogramWidget"),ea.prototype),Object(C.a)(ea.prototype,"addRenderConfigWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addRenderConfigWidget"),ea.prototype),Object(C.a)(ea.prototype,"addLogWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addLogWidget"),ea.prototype),Object(C.a)(ea.prototype,"addAnimatorWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addAnimatorWidget"),ea.prototype),Object(C.a)(ea.prototype,"addRegionListWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addRegionListWidget"),ea.prototype),Object(C.a)(ea.prototype,"addLayerListWidget",[E.g],Object.getOwnPropertyDescriptor(ea.prototype,"addLayerListWidget"),ea.prototype),Ea=Object(C.a)(ea.prototype,"selectFloatingWidget",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.findIndex(t=>t.id===e),i=this.floatingWidgets.length;if(i>1&&t>=0&&t<i-1){const e=this.floatingWidgets[t];for(let n=0;n<i-1;n++)n>=t&&(this.floatingWidgets[n]=this.floatingWidgets[n+1]);this.floatingWidgets[i-1]=e}}}}),Ia=Object(C.a)(ea.prototype,"updateSelectFloatingWidgetzIndex",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.findIndex(t=>t.id===e),i=this.floatingWidgets[t],n=this.floatingWidgets.length;if(n>1&&t>=0&&i.zIndex<n){for(let e=0;e<n;e++){let t=this.floatingWidgets[e].zIndex;t>=i.zIndex&&(this.floatingWidgets[e].zIndex=t-1)}this.floatingWidgets[t].zIndex=this.floatingWidgets.length}}}}),wa=Object(C.a)(ea.prototype,"addFloatingWidget",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!((null===e||void 0===e?void 0:e.defaultX)>0&&(null===e||void 0===e?void 0:e.defaultY)>0)){const t=this.getFloatingWidgetOffset();e.setDefaultPosition(t,t)}e.zIndex=this.floatingWidgets.length+1,this.floatingWidgets.push(e)}}}),Ta=Object(C.a)(ea.prototype,"removeFloatingWidget",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{const i=this.floatingWidgets.find(t=>t.id===e);if(i){if(this.updateFloatingWidgetzIndexOnRemove(i.zIndex),this.floatingWidgets=this.floatingWidgets.filter(t=>t.id!==e),t)return;this.removeWidget(e,i.type)}}}}),va=Object(C.a)(ea.prototype,"removeFloatingWidgetComponent",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.find(t=>t.componentId===e);t&&(this.updateFloatingWidgetzIndexOnRemove(t.zIndex),this.floatingWidgets=this.floatingWidgets.filter(t=>t.componentId!==e),this.removeAssociatedFloatingSetting(e))}}}),ea);var Ma,Da,Na,La,_a,za,Wa,Ga,Va,Ba,qa,Ha,Ua,Ya,Xa,Ka,Qa,Za,$a,Ja,es,ts,is,ns,rs,os,as,ss,ls,cs,us,ps,ds,hs,gs,ms;const fs=0;let ys;!function(e){e.Image="Image",e.World="World"}(ys||(ys={}));let bs=(Ma=E.q.shallow,ms=gs=class e{static RegionTypeString(e){switch(e){case V.a.RegionType.POINT:return"Point";case V.a.RegionType.RECTANGLE:return"Rectangle";case V.a.RegionType.ELLIPSE:return"Ellipse";case V.a.RegionType.POLYGON:return"Polygon";default:return"Not Implemented"}}static IsRegionTypeValid(t){return e.AVAILABLE_REGION_TYPES.has(t)}static IsRegionLineWidthValid(t){return t>=e.MIN_LINE_WIDTH&&t<=e.MAX_LINE_WIDTH}static IsRegionDashLengthValid(t){return t>=0&&t<=e.MAX_DASH_LENGTH}get isTemporary(){return this.regionId<0}get center(){if(!this.isValid)return{x:0,y:0};switch(this.regionType){case V.a.RegionType.POINT:case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:return this.controlPoints[0];case V.a.RegionType.POLYGON:const e=Object(B.R)(this.controlPoints);return Object(B.Q)(e.minPoint,e.maxPoint);default:return{x:0,y:0}}}get size(){switch(this.regionType){case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:return this.controlPoints[1];case V.a.RegionType.POLYGON:return this.boundingBox;default:return{x:void 0,y:void 0}}}get wcsSize(){const e=this.activeFrame;return this.size&&(null===e||void 0===e?void 0:e.validWcs)?e.getWcsSizeInArcsec(this.size):{x:void 0,y:void 0}}get boundingBox(){if(!this.isValid)return{x:0,y:0};switch(this.regionType){case V.a.RegionType.RECTANGLE:return this.size;case V.a.RegionType.ELLIPSE:return Object(B.cb)(this.size,2);case V.a.RegionType.POLYGON:const e=Object(B.R)(this.controlPoints);return Object(B.ib)(e.maxPoint,e.minPoint);default:return{x:0,y:0}}}get boundingBoxArea(){const e=this.boundingBox;return e.x*e.y}get isClosedRegion(){switch(this.regionType){case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:case V.a.RegionType.POLYGON:case V.a.RegionType.ANNULUS:return!0;default:return!1}}get isValid(){if(!this.controlPoints||!this.controlPoints.length)return!1;switch(this.regionType){case V.a.RegionType.POINT:return 1===this.controlPoints.length;case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:return 2===this.controlPoints.length&&this.size.x>0&&this.size.y>0;case V.a.RegionType.POLYGON:return this.controlPoints.length>=1;default:return!1}}get nameString(){return this.regionId===fs?"Cursor":this.name&&""!==this.name?this.name:"Region "+this.regionId}get regionProperties(){const e=this.center,t=isFinite(e.x)&&isFinite(e.y)?`${Object(B.kb)(e.x,1)}pix, ${Object(B.kb)(e.y,1)}pix`:"Invalid";switch(this.regionType){case V.a.RegionType.POINT:return`Point (pixel) [${t}]`;case V.a.RegionType.RECTANGLE:return`rotbox[[${t}], [${Object(B.kb)(this.size.x,1)}pix, ${Object(B.kb)(this.size.y,1)}pix], `+Object(B.kb)(this.rotation,1)+"deg]";case V.a.RegionType.ELLIPSE:return`ellipse[[${t}], [${Object(B.kb)(this.size.x,1)}pix, ${Object(B.kb)(this.size.y,1)}pix], `+Object(B.kb)(this.rotation,1)+"deg]";case V.a.RegionType.POLYGON:const e=Object(B.R)(this.controlPoints);return`polygon[[${t}], [${Object(B.kb)(e.maxPoint.x,1)}pix, ${Object(B.kb)(e.maxPoint.y,1)}pix], `+Object(B.kb)(this.rotation,1)+"deg]";default:return"Not Implemented"}}getRegionApproximation(t){let i=this.regionApproximationMap.get(t);if(!i){if(this.regionType===V.a.RegionType.POINT&&(i=[Object(B.lb)(t,this.center,!1)]),this.regionType===V.a.RegionType.ELLIPSE)i=Object(B.x)(t,this.center,this.size.y,this.size.x,this.rotation,e.TARGET_VERTEX_COUNT);else if(this.regionType===V.a.RegionType.RECTANGLE){let n=this.size.x/2,r=this.size.y/2;const o=this.rotation*Math.PI/180,a=[Object(B.f)(this.center,Object(B.ab)({x:-n,y:-r},o)),Object(B.f)(this.center,Object(B.ab)({x:+n,y:-r},o)),Object(B.f)(this.center,Object(B.ab)({x:+n,y:+r},o)),Object(B.f)(this.center,Object(B.ab)({x:-n,y:+r},o))];i=Object(B.y)(t,a,e.TARGET_VERTEX_COUNT)}else i=Object(B.y)(t,this.controlPoints,e.TARGET_VERTEX_COUNT,!this.creating);this.regionApproximationMap.set(t,i)}return i}constructor(e,t,i,n,r,o=-1,a=po.a.TURQUOISE5,s=2,l=0,c=0,u=""){this.fileId=void 0,Object(S.a)(this,"regionId",Na,this),Object(S.a)(this,"name",La,this),Object(S.a)(this,"color",_a,this),Object(S.a)(this,"lineWidth",za,this),Object(S.a)(this,"dashLength",Wa,this),Object(S.a)(this,"regionType",Ga,this),Object(S.a)(this,"coordinate",Va,this),Object(S.a)(this,"controlPoints",Ba,this),Object(S.a)(this,"rotation",qa,this),Object(S.a)(this,"editing",Ha,this),Object(S.a)(this,"creating",Ua,this),Object(S.a)(this,"locked",Ya,this),Object(S.a)(this,"isSimplePolygon",Xa,this),Object(S.a)(this,"activeFrame",Ka,this),this.backendService=void 0,this.regionApproximationMap=void 0,this.modifiedTimestamp=void 0,Object(S.a)(this,"setRegionId",Qa,this),Object(S.a)(this,"setCenter",Za,this),Object(S.a)(this,"setSize",$a,this),Object(S.a)(this,"setControlPoint",Ja,this),Object(S.a)(this,"setControlPoints",es,this),Object(S.a)(this,"setRotation",ts,this),Object(S.a)(this,"setName",is,this),Object(S.a)(this,"setColor",ns,this),Object(S.a)(this,"setLineWidth",rs,this),Object(S.a)(this,"setDashLength",os,this),Object(S.a)(this,"beginCreating",as,this),Object(S.a)(this,"endCreating",ss,this),Object(S.a)(this,"beginEditing",ls,this),Object(S.a)(this,"endEditing",cs,this),Object(S.a)(this,"toggleLock",us,this),Object(S.a)(this,"setLocked",ps,this),Object(S.a)(this,"focusCenter",ds,this),Object(S.a)(this,"setCoordinate",hs,this),this.updateRegion=()=>{this.isValid&&(this.regionId===fs&&this.regionType===V.a.RegionType.POINT?this.backendService.setCursor(this.fileId,this.center.x,this.center.y):this.backendService.setRegion(this.fileId,this.regionId,this).subscribe(e=>{e.success?console.log("Region updated"):console.log(e.message)}))},Object(E.p)(this),this.fileId=t,this.activeFrame=i,this.controlPoints=n,this.regionType=r,this.regionId=o,this.name=u,this.color=a,this.lineWidth=s,this.dashLength=l,this.rotation=c,this.backendService=e,i.validWcs?this.coordinate=ys.World:this.coordinate=ys.Image,this.regionApproximationMap=new Map,this.simplePolygonTest(),this.modifiedTimestamp=performance.now()}simplePolygonTest(e=-1){const t=this.controlPoints.slice();e>=0&&this.isSimplePolygon?this.isSimplePolygon=Object(B.fb)(t,e)&&Object(B.fb)(t,e-1):this.isSimplePolygon=Object(B.gb)(t)}},gs.MIN_LINE_WIDTH=.5,gs.MAX_LINE_WIDTH=10,gs.MAX_DASH_LENGTH=50,gs.TARGET_VERTEX_COUNT=200,gs.AVAILABLE_REGION_TYPES=new Map([[V.a.RegionType.POINT,"Point"],[V.a.RegionType.RECTANGLE,"Rectangle"],[V.a.RegionType.ELLIPSE,"Ellipse"],[V.a.RegionType.POLYGON,"Polygon"]]),Da=ms,Na=Object(C.a)(Da.prototype,"regionId",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),La=Object(C.a)(Da.prototype,"name",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_a=Object(C.a)(Da.prototype,"color",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),za=Object(C.a)(Da.prototype,"lineWidth",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wa=Object(C.a)(Da.prototype,"dashLength",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ga=Object(C.a)(Da.prototype,"regionType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Va=Object(C.a)(Da.prototype,"coordinate",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ba=Object(C.a)(Da.prototype,"controlPoints",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qa=Object(C.a)(Da.prototype,"rotation",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ha=Object(C.a)(Da.prototype,"editing",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ua=Object(C.a)(Da.prototype,"creating",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ya=Object(C.a)(Da.prototype,"locked",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xa=Object(C.a)(Da.prototype,"isSimplePolygon",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ka=Object(C.a)(Da.prototype,"activeFrame",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(Da.prototype,"isTemporary",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"isTemporary"),Da.prototype),Object(C.a)(Da.prototype,"center",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"center"),Da.prototype),Object(C.a)(Da.prototype,"size",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"size"),Da.prototype),Object(C.a)(Da.prototype,"wcsSize",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"wcsSize"),Da.prototype),Object(C.a)(Da.prototype,"boundingBox",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"boundingBox"),Da.prototype),Object(C.a)(Da.prototype,"boundingBoxArea",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"boundingBoxArea"),Da.prototype),Object(C.a)(Da.prototype,"isClosedRegion",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"isClosedRegion"),Da.prototype),Object(C.a)(Da.prototype,"isValid",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"isValid"),Da.prototype),Object(C.a)(Da.prototype,"nameString",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"nameString"),Da.prototype),Object(C.a)(Da.prototype,"regionProperties",[E.i],Object.getOwnPropertyDescriptor(Da.prototype,"regionProperties"),Da.prototype),Qa=Object(C.a)(Da.prototype,"setRegionId",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionId=e}}}),Za=Object(C.a)(Da.prototype,"setCenter",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.setControlPoint(0,e,t)}}}),$a=Object(C.a)(Da.prototype,"setSize",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.setControlPoint(1,e,t)}}}),Ja=Object(C.a)(Da.prototype,"setControlPoint",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i=!1)=>{e>=0&&e<this.controlPoints.length&&!Object(B.L)(t)&&isFinite(null===t||void 0===t?void 0:t.x)&&isFinite(null===t||void 0===t?void 0:t.y)&&(this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.controlPoints[e]=t,this.editing||i||this.updateRegion(),this.regionType===V.a.RegionType.POLYGON&&this.simplePolygonTest(e))}}}),es=Object(C.a)(Da.prototype,"setControlPoints",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1,i=!0)=>{if(e.length){for(const t of e)if(Object(B.L)(t)||!isFinite(null===t||void 0===t?void 0:t.x)||!isFinite(null===t||void 0===t?void 0:t.y))return;this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.controlPoints=e,i&&this.regionType===V.a.RegionType.POLYGON&&this.simplePolygonTest(),this.editing||t||this.updateRegion()}}}}),ts=Object(C.a)(Da.prototype,"setRotation",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.rotation=(e+360)%360,this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.editing||t||this.updateRegion()}}}),is=Object(C.a)(Da.prototype,"setName",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.name=e}}}),ns=Object(C.a)(Da.prototype,"setColor",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),rs=Object(C.a)(Da.prototype,"setLineWidth",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineWidth=e}}}),os=Object(C.a)(Da.prototype,"setDashLength",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dashLength=e}}}),as=Object(C.a)(Da.prototype,"beginCreating",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.creating=!0,this.editing=!0}}}),ss=Object(C.a)(Da.prototype,"endCreating",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.creating=!1,this.editing=!1,this.regionType!==V.a.RegionType.POINT&&this.backendService.setRegion(this.fileId,-1,this).subscribe(e=>{e.success&&(console.log(`Updating regionID from ${this.regionId} to ${e.regionId}`),this.setRegionId(e.regionId))})}}}),ls=Object(C.a)(Da.prototype,"beginEditing",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.editing=!0}}}),cs=Object(C.a)(Da.prototype,"endEditing",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.editing=!1,this.updateRegion()}}}),us=Object(C.a)(Da.prototype,"toggleLock",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionId!==fs&&(this.locked=!this.locked)}}}),ps=Object(C.a)(Da.prototype,"setLocked",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionId!==fs&&(this.locked=e)}}}),ds=Object(C.a)(Da.prototype,"focusCenter",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.activeFrame&&(this.activeFrame.setCenter(this.center.x,this.center.y),this.activeFrame.renderWidth<this.activeFrame.zoomLevel*this.boundingBox.x||this.activeFrame.renderHeight<this.activeFrame.zoomLevel*this.boundingBox.y)){const e=.4*Math.min(this.activeFrame.renderWidth/this.boundingBox.x,this.activeFrame.renderHeight/this.boundingBox.y);this.activeFrame.setZoom(e)}}}}),hs=Object(C.a)(Da.prototype,"setCoordinate",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.coordinate=e)}}}),Da);var Os,Ss,Cs,Es,Is,ws,Ts,vs,As,xs,Rs,Ps,js,ks,Fs,Ms,Ds,Ns;let Ls;!function(e){e[e.MOVING=0]="MOVING",e[e.CREATING=1]="CREATING"}(Ls||(Ls={}));let _s=(Os=class{constructor(e,t,i){Object(S.a)(this,"regions",Ss,this),Object(S.a)(this,"selectedRegion",Cs,this),Object(S.a)(this,"mode",Es,this),Object(S.a)(this,"newRegionType",Is,this),this.frame=void 0,this.backendService=void 0,this.preference=void 0,this.getTempRegionId=()=>{let e=-1;if(this.regions.length){let t=Math.min(...this.regions.map(e=>e.regionId));e=Math.min(e,t-1)}return e},Object(S.a)(this,"addPointRegion",ws,this),Object(S.a)(this,"addRectangularRegion",Ts,this),Object(S.a)(this,"addEllipticalRegion",vs,this),Object(S.a)(this,"addPolygonalRegion",As,this),Object(S.a)(this,"addExistingRegion",xs,this),Object(S.a)(this,"selectRegion",Rs,this),Object(S.a)(this,"selectRegionByIndex",Ps,this),Object(S.a)(this,"deselectRegion",js,this),Object(S.a)(this,"deleteRegion",ks,this),Object(S.a)(this,"setNewRegionType",Fs,this),Object(S.a)(this,"setMode",Ms,this),Object(S.a)(this,"toggleMode",Ds,this),Object(S.a)(this,"migrateRegionsFromExistingSet",Ns,this),Object(E.p)(this),this.frame=e,this.backendService=i,this.preference=t,this.regions=[],this.newRegionType=t.regionType,this.mode=Ls.MOVING,this.addPointRegion({x:0,y:0},!0),this.selectedRegion=this.regions[0]}addRegion(e,t,i,n=!1,r=this.getTempRegionId(),o=""){const a=new bs(this.backendService,this.frame.frameInfo.fileId,this.frame,e,i,r,this.preference.regionColor,this.preference.regionLineWidth,this.preference.regionDashLength,t,o);return this.regions.push(a),n||this.backendService.setRegion(this.frame.frameInfo.fileId,-1,a).subscribe(e=>{e.success&&(console.log(`Updating regionID from ${a.regionId} to ${e.regionId}`),a.setRegionId(e.regionId))}),a}},Ss=Object(C.a)(Os.prototype,"regions",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cs=Object(C.a)(Os.prototype,"selectedRegion",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Es=Object(C.a)(Os.prototype,"mode",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Is=Object(C.a)(Os.prototype,"newRegionType",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ws=Object(C.a)(Os.prototype,"addPointRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion([e],0,V.a.RegionType.POINT,t,t?fs:this.getTempRegionId())}}),Ts=Object(C.a)(Os.prototype,"addRectangularRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>this.addRegion([e,{x:t,y:i}],0,V.a.RegionType.RECTANGLE,n)}}),vs=Object(C.a)(Os.prototype,"addEllipticalRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>this.addRegion([e,{x:i,y:t}],0,V.a.RegionType.ELLIPSE,n)}}),As=Object(C.a)(Os.prototype,"addPolygonalRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion(e,0,V.a.RegionType.POLYGON,t)}}),xs=Object(C.a)(Os.prototype,"addExistingRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n,r,o,a,s)=>{const l=this.addRegion(e,t,i,!0,n,r);return o&&(l.color=o),a&&(l.lineWidth=a),(null===s||void 0===s?void 0:s.length)&&(l.dashLength=s[0]),l}}}),Rs=Object(C.a)(Os.prototype,"selectRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regions.indexOf(e)>=0&&(this.selectedRegion=e)}}}),Ps=Object(C.a)(Os.prototype,"selectRegionByIndex",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=0&&e<this.regions.length&&(this.selectedRegion=this.regions[e])}}}),js=Object(C.a)(Os.prototype,"deselectRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedRegion=null}}}),ks=Object(C.a)(Os.prototype,"deleteRegion",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e.regionId!==fs&&this.regions.length&&(e===this.selectedRegion&&(this.selectedRegion=this.regions[0]),this.regions=this.regions.filter(t=>t!==e),e.isTemporary||this.backendService.removeRegion(e.regionId))}}}),Fs=Object(C.a)(Os.prototype,"setNewRegionType",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.newRegionType=e}}}),Ms=Object(C.a)(Os.prototype,"setMode",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.mode=e}}}),Ds=Object(C.a)(Os.prototype,"toggleMode",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.mode=this.mode===Ls.MOVING?Ls.CREATING:Ls.MOVING}}}),Ns=Object(C.a)(Os.prototype,"migrateRegionsFromExistingSet",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i=!1)=>{var n;if((null===e||void 0===e||null===(n=e.regions)||void 0===n?void 0:n.length)<=1)return;let r=-1;for(const o of e.regions){if(!this.regions.find(e=>e.modifiedTimestamp===o.modifiedTimestamp))if(o.regionId===fs){const e=Object(B.lb)(t,o.center,i);this.regions.length&&this.regions[0].regionId===fs&&this.regions[0].setCenter(e)}else{let e=[],n=0;if(o.regionType===V.a.RegionType.RECTANGLE||o.regionType===V.a.RegionType.ELLIPSE){const r=Object(B.lb)(t,o.center,i);if(!Object(B.L)(r)){const a=new Vi.Transform2D(t,r),s=Object(B.cb)(o.size,i?a.scale:1/a.scale);n=o.rotation+(i?1:-1)*a.rotation*180/Math.PI,e=[r,s]}}else if(o.regionType===V.a.RegionType.POINT||o.regionType===V.a.RegionType.POLYGON)for(const r of o.controlPoints){const n=Object(B.lb)(t,r,i);Object(B.L)(n)||e.push(n)}if(e.length){let t;o.regionType===V.a.RegionType.POINT?(t=this.addRegion(e,0,V.a.RegionType.POINT),t.setName(o.name),t.setColor(o.color)):(t=this.addExistingRegion(e,n,o.regionType,r,o.name,o.color,o.lineWidth,o.dashLength?[o.dashLength]:[]),t.endCreating()),t.setLocked(o.locked),t.modifiedTimestamp=o.modifiedTimestamp,r--}}}}}}),Os);var zs,Ws,Gs,Vs,Bs,qs,Hs,Us,Ys,Xs,Ks,Qs,Zs,$s,Js,el,tl,il;let nl;!function(e){e.SILENT_FILE_SORTING_STRING="fileSortingString",e.SILENT_FILE_FILTERING_TYPE="fileFilteringType",e.GLOBAL_THEME="theme",e.GLOBAL_AUTOLAUNCH="autoLaunch",e.GLOBAL_LAYOUT="layout",e.GLOBAL_CURSOR_POSITION="cursorPosition",e.GLOBAL_ZOOM_MODE="zoomMode",e.GLOBAL_ZOOM_POINT="zoomPoint",e.GLOBAL_DRAG_PANNING="dragPanning",e.GLOBAL_SPECTRAL_MATCHING_TYPE="spectralMatchingType",e.GLOBAL_AUTO_WCS_MATCHING="autoWCSMatching",e.RENDER_CONFIG_SCALING="scaling",e.RENDER_CONFIG_COLORMAP="colormap",e.RENDER_CONFIG_PERCENTILE="percentile",e.RENDER_CONFIG_SCALING_ALPHA="scalingAlpha",e.RENDER_CONFIG_SCALING_GAMMA="scalingGamma",e.RENDER_CONFIG_NAN_COLOR_HEX="nanColorHex",e.RENDER_CONFIG_NAN_ALPHA="nanAlpha",e.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE="contourGeneratorType",e.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE="contourSmoothingMode",e.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR="contourSmoothingFactor",e.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS="contourNumLevels",e.CONTOUR_CONFIG_CONTOUR_THICKNESS="contourThickness",e.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED="contourColormapEnabled",e.CONTOUR_CONFIG_CONTOUR_COLOR="contourColor",e.CONTOUR_CONFIG_CONTOUR_COLORMAP="contourColormap",e.WCS_OVERLAY_AST_COLOR="astColor",e.WCS_OVERLAY_AST_GRID_VISIBLE="astGridVisible",e.WCS_OVERLAY_AST_LABELS_VISIBLE="astLabelsVisible",e.WCS_OVERLAY_WCS_TYPE="wcsType",e.WCS_OVERLAY_BEAM_VISIBLE="beamVisible",e.WCS_OVERLAY_BEAM_COLOR="beamColor",e.WCS_OVERLAY_BEAM_TYPE="beamType",e.WCS_OVERLAY_BEAM_WIDTH="beamWidth",e.REGION_COLOR="regionColor",e.REGION_LINE_WIDTH="regionLineWidth",e.REGION_DASH_LENGTH="regionDashLength",e.REGION_TYPE="regionType",e.REGION_CREATION_MODE="regionCreationMode",e.REGION_SIZE="regionSize",e.PERFORMANCE_IMAGE_COMPRESSION_QUALITY="imageCompressionQuality",e.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY="animationCompressionQuality",e.PERFORMANCE_GPU_TILE_CACHE="GPUTileCache",e.PERFORMANCE_SYSTEM_TILE_CACHE="systemTileCache",e.PERFORMANCE_CONTOUR_DECIMATION="contourDecimation",e.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL="contourCompressionLevel",e.PERFORMANCE_CONTOUR_CHUNK_SIZE="contourChunkSize",e.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH="contourControlMapWidth",e.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING="streamContoursWhileZooming",e.PERFORMANCE_LOW_BAND_WIDTH_MODE="lowBandwidthMode",e.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES="stopAnimationPlaybackMinutes",e.LOG_EVENT="logEventList",e.CATALOG_DISPLAYED_COLUMN_SIZE="catalogDisplayedColumnSize",e.CATALOG_TABLE_SEPARATOR_POSITION="catalogTableSeparatorPosition"}(nl||(nl={}));const rl={SILENT:{fileSortingString:"-date",fileFilteringType:It.Fuzzy},GLOBAL:{theme:Vi.Theme.AUTO,autoLaunch:!0,layout:Vi.PresetLayout.DEFAULT,cursorPosition:Vi.CursorPosition.TRACKING,zoomMode:Vi.Zoom.FIT,zoomPoint:Vi.ZoomPoint.CURSOR,dragPanning:!0,spectralMatchingType:Vi.SpectralType.VRAD,autoWCSMatching:Vi.WCSMatchingType.NONE},RENDER_CONFIG:{scaling:_o.a.LINEAR,colormap:"inferno",percentile:99.9,scalingAlpha:1e3,scalingGamma:1,nanColorHex:"#137CBD",nanAlpha:1},CONTOUR_CONFIG:{contourGeneratorType:ke.StartStepMultiplier,contourSmoothingMode:V.a.SmoothingMode.GaussianBlur,contourSmoothingFactor:4,contourNumLevels:5,contourThickness:1,contourColormapEnabled:!1,contourColor:po.a.GREEN3,contourColormap:"viridis"},WCS_OVERLAY:{astColor:4,astGridVisible:!1,astLabelsVisible:!0,wcsType:Vi.WCSType.AUTOMATIC,beamVisible:!0,beamColor:po.a.GRAY3,beamType:Oo.Open,beamWidth:1},REGION:{regionColor:"#2EE6D6",regionLineWidth:2,regionDashLength:0,regionType:V.a.RegionType.RECTANGLE,regionCreationMode:Vi.RegionCreationMode.CENTER,regionSize:30},PERFORMANCE:{imageCompressionQuality:Vi.CompressionQuality.IMAGE_DEFAULT,animationCompressionQuality:Vi.CompressionQuality.ANIMATION_DEFAULT,GPUTileCache:Vi.TileCache.GPU_DEFAULT,systemTileCache:Vi.TileCache.SYSTEM_DEFAULT,contourDecimation:4,contourCompressionLevel:8,contourChunkSize:1e5,contourControlMapWidth:256,streamContoursWhileZooming:!1,lowBandwidthMode:!1,stopAnimationPlaybackMinutes:5},LOG_EVENT:{eventLoggingEnabled:[]},CATALOG:{catalogDisplayedColumnSize:10,catalogTableSeparatorPosition:"60%"}};let ol=(il=tl=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get theme(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_THEME))&&void 0!==e?e:rl.GLOBAL.theme}get autoLaunch(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_AUTOLAUNCH))&&void 0!==e?e:rl.GLOBAL.autoLaunch}get fileSortingString(){var e;return null!==(e=this.preferences.get(nl.SILENT_FILE_SORTING_STRING))&&void 0!==e?e:rl.SILENT.fileSortingString}get fileFilteringType(){var e;return null!==(e=this.preferences.get(nl.SILENT_FILE_FILTERING_TYPE))&&void 0!==e?e:rl.SILENT.fileFilteringType}get layout(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_LAYOUT))&&void 0!==e?e:rl.GLOBAL.layout}get cursorPosition(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_CURSOR_POSITION))&&void 0!==e?e:rl.GLOBAL.cursorPosition}get zoomMode(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_ZOOM_MODE))&&void 0!==e?e:rl.GLOBAL.zoomMode}get zoomPoint(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_ZOOM_POINT))&&void 0!==e?e:rl.GLOBAL.zoomPoint}get dragPanning(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_DRAG_PANNING))&&void 0!==e?e:rl.GLOBAL.dragPanning}get spectralMatchingType(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_SPECTRAL_MATCHING_TYPE))&&void 0!==e?e:rl.GLOBAL.spectralMatchingType}get autoWCSMatching(){var e;return null!==(e=this.preferences.get(nl.GLOBAL_AUTO_WCS_MATCHING))&&void 0!==e?e:rl.GLOBAL.autoWCSMatching}get scaling(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_SCALING))&&void 0!==e?e:rl.RENDER_CONFIG.scaling}get colormap(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_COLORMAP))&&void 0!==e?e:rl.RENDER_CONFIG.colormap}get percentile(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_PERCENTILE))&&void 0!==e?e:rl.RENDER_CONFIG.percentile}get scalingAlpha(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_SCALING_ALPHA))&&void 0!==e?e:rl.RENDER_CONFIG.scalingAlpha}get scalingGamma(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_SCALING_GAMMA))&&void 0!==e?e:rl.RENDER_CONFIG.scalingGamma}get nanColorHex(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_NAN_COLOR_HEX))&&void 0!==e?e:rl.RENDER_CONFIG.nanColorHex}get nanAlpha(){var e;return null!==(e=this.preferences.get(nl.RENDER_CONFIG_NAN_ALPHA))&&void 0!==e?e:rl.RENDER_CONFIG.nanAlpha}get contourGeneratorType(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourGeneratorType}get contourColormapEnabled(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourColormapEnabled}get contourColormap(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_COLORMAP))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourColormap}get contourColor(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_COLOR))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourColor}get contourSmoothingMode(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourSmoothingMode}get contourSmoothingFactor(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourSmoothingFactor}get contourNumLevels(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourNumLevels}get contourThickness(){var e;return null!==(e=this.preferences.get(nl.CONTOUR_CONFIG_CONTOUR_THICKNESS))&&void 0!==e?e:rl.CONTOUR_CONFIG.contourThickness}get contourDecimation(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_CONTOUR_DECIMATION))&&void 0!==e?e:rl.PERFORMANCE.contourDecimation}get contourCompressionLevel(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL))&&void 0!==e?e:rl.PERFORMANCE.contourCompressionLevel}get contourChunkSize(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_CONTOUR_CHUNK_SIZE))&&void 0!==e?e:rl.PERFORMANCE.contourChunkSize}get astColor(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_AST_COLOR))&&void 0!==e?e:rl.WCS_OVERLAY.astColor}get astGridVisible(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_AST_GRID_VISIBLE))&&void 0!==e?e:rl.WCS_OVERLAY.astGridVisible}get astLabelsVisible(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_AST_LABELS_VISIBLE))&&void 0!==e?e:rl.WCS_OVERLAY.astLabelsVisible}get wcsType(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_WCS_TYPE))&&void 0!==e?e:rl.WCS_OVERLAY.wcsType}get beamVisible(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_BEAM_VISIBLE))&&void 0!==e?e:rl.WCS_OVERLAY.beamVisible}get beamColor(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_BEAM_COLOR))&&void 0!==e?e:rl.WCS_OVERLAY.beamColor}get beamType(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_BEAM_TYPE))&&void 0!==e?e:rl.WCS_OVERLAY.beamType}get beamWidth(){var e;return null!==(e=this.preferences.get(nl.WCS_OVERLAY_BEAM_WIDTH))&&void 0!==e?e:rl.WCS_OVERLAY.beamWidth}get regionColor(){var e;return null!==(e=this.preferences.get(nl.REGION_COLOR))&&void 0!==e?e:rl.REGION.regionColor}get regionLineWidth(){var e;return null!==(e=this.preferences.get(nl.REGION_LINE_WIDTH))&&void 0!==e?e:rl.REGION.regionLineWidth}get regionDashLength(){var e;return null!==(e=this.preferences.get(nl.REGION_DASH_LENGTH))&&void 0!==e?e:rl.REGION.regionDashLength}get regionType(){var e;return null!==(e=this.preferences.get(nl.REGION_TYPE))&&void 0!==e?e:rl.REGION.regionType}get regionCreationMode(){var e;return null!==(e=this.preferences.get(nl.REGION_CREATION_MODE))&&void 0!==e?e:rl.REGION.regionCreationMode}get regionSize(){var e;return null!==(e=this.preferences.get(nl.REGION_SIZE))&&void 0!==e?e:rl.REGION.regionSize}get imageCompressionQuality(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_IMAGE_COMPRESSION_QUALITY))&&void 0!==e?e:rl.PERFORMANCE.imageCompressionQuality}get animationCompressionQuality(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY))&&void 0!==e?e:rl.PERFORMANCE.animationCompressionQuality}get gpuTileCache(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_GPU_TILE_CACHE))&&void 0!==e?e:rl.PERFORMANCE.GPUTileCache}get systemTileCache(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_SYSTEM_TILE_CACHE))&&void 0!==e?e:rl.PERFORMANCE.systemTileCache}get contourControlMapWidth(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH))&&void 0!==e?e:rl.PERFORMANCE.contourControlMapWidth}get streamContoursWhileZooming(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING))&&void 0!==e?e:rl.PERFORMANCE.streamContoursWhileZooming}get lowBandwidthMode(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_LOW_BAND_WIDTH_MODE))&&void 0!==e?e:rl.PERFORMANCE.lowBandwidthMode}get stopAnimationPlaybackMinutes(){var e;return null!==(e=this.preferences.get(nl.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES))&&void 0!==e?e:rl.PERFORMANCE.stopAnimationPlaybackMinutes}get isSelectingAllLogEvents(){var e;return(null===(e=this.preferences.get(nl.LOG_EVENT))||void 0===e?void 0:e.length)===Vi.Event.EVENT_NUMBER}get isSelectingIndeterminateLogEvents(){var e;const t=null===(e=this.preferences.get(nl.LOG_EVENT))||void 0===e?void 0:e.length;return t>0&&t<Vi.Event.EVENT_NUMBER}get isZoomRAWMode(){return this.zoomMode===Vi.Zoom.FULL}get isRegionCornerMode(){return this.regionCreationMode===Vi.RegionCreationMode.CORNER}get isCursorFrozen(){return this.cursorPosition===Vi.CursorPosition.FIXED}get enabledLoggingEventNames(){var e;return null!==(e=this.preferences.get(nl.LOG_EVENT))&&void 0!==e?e:[]}get catalogDisplayedColumnSize(){var e;return null!==(e=this.preferences.get(nl.CATALOG_DISPLAYED_COLUMN_SIZE))&&void 0!==e?e:rl.CATALOG.catalogDisplayedColumnSize}get catalogTableSeparatorPosition(){var e;return null!==(e=this.preferences.get(nl.CATALOG_TABLE_SEPARATOR_POSITION))&&void 0!==e?e:rl.CATALOG.catalogTableSeparatorPosition}constructor(){Object(S.a)(this,"preferences",Ws,this),Object(S.a)(this,"supportsServer",Gs,this),this.isEventLoggingEnabled=e=>{if(Vi.Event.isEventTypeValid(e)){const t=this.preferences.get(nl.LOG_EVENT);if(t&&Array.isArray(t))return t.includes(e)}return!1},Object(S.a)(this,"setPreference",Vs,this),Object(S.a)(this,"clearPreferences",Bs,this),Object(S.a)(this,"resetSilentSettings",qs,this),Object(S.a)(this,"resetGlobalSettings",Hs,this),Object(S.a)(this,"resetRenderConfigSettings",Us,this),Object(S.a)(this,"resetContourConfigSettings",Ys,this),Object(S.a)(this,"resetOverlayConfigSettings",Xs,this),Object(S.a)(this,"resetRegionSettings",Ks,this),Object(S.a)(this,"resetPerformanceSettings",Qs,this),Object(S.a)(this,"selectAllLogEvents",Zs,this),Object(S.a)(this,"resetLogEventSettings",$s,this),Object(S.a)(this,"resetCatalogSettings",Js,this),Object(S.a)(this,"fetchPreferences",el,this),this.getPreferences=async()=>{const e=await oe.a.Instance.getPreferences();if(e){const t=Object.keys(e);for(const i of t){const t=e[i];this.preferences.set(i,t)}}},this.upgradePreferences=async()=>{if(!localStorage.getItem("preferences")){const t=[nl.GLOBAL_THEME,nl.GLOBAL_LAYOUT,nl.GLOBAL_CURSOR_POSITION,nl.GLOBAL_ZOOM_MODE,nl.GLOBAL_ZOOM_POINT,nl.GLOBAL_SPECTRAL_MATCHING_TYPE,nl.RENDER_CONFIG_COLORMAP,nl.RENDER_CONFIG_NAN_COLOR_HEX,nl.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE,nl.CONTOUR_CONFIG_CONTOUR_COLOR,nl.CONTOUR_CONFIG_CONTOUR_COLORMAP,nl.WCS_OVERLAY_WCS_TYPE,nl.WCS_OVERLAY_BEAM_COLOR,nl.WCS_OVERLAY_BEAM_TYPE,nl.REGION_COLOR,nl.REGION_CREATION_MODE,nl.CATALOG_TABLE_SEPARATOR_POSITION],i=[nl.GLOBAL_AUTO_WCS_MATCHING,nl.RENDER_CONFIG_SCALING,nl.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE,nl.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR,nl.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS,nl.WCS_OVERLAY_AST_COLOR,nl.REGION_DASH_LENGTH,nl.REGION_TYPE,nl.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,nl.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,nl.PERFORMANCE_GPU_TILE_CACHE,nl.PERFORMANCE_SYSTEM_TILE_CACHE,nl.PERFORMANCE_CONTOUR_DECIMATION,nl.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,nl.PERFORMANCE_CONTOUR_CHUNK_SIZE,nl.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,nl.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,nl.CATALOG_DISPLAYED_COLUMN_SIZE],n=[nl.RENDER_CONFIG_PERCENTILE,nl.RENDER_CONFIG_SCALING_ALPHA,nl.RENDER_CONFIG_SCALING_GAMMA,nl.RENDER_CONFIG_NAN_ALPHA,nl.CONTOUR_CONFIG_CONTOUR_THICKNESS,nl.WCS_OVERLAY_BEAM_WIDTH,nl.REGION_LINE_WIDTH],r=[nl.GLOBAL_AUTOLAUNCH,nl.GLOBAL_DRAG_PANNING,nl.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED,nl.WCS_OVERLAY_AST_GRID_VISIBLE,nl.WCS_OVERLAY_AST_LABELS_VISIBLE,nl.WCS_OVERLAY_BEAM_VISIBLE,nl.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,nl.PERFORMANCE_LOW_BAND_WIDTH_MODE],o={};for(const e of t){const t=localStorage.getItem(e);t&&(o[e]=t)}for(const e of i){const t=parseInt(localStorage.getItem(e));isFinite(t)&&(o[e]=t)}for(const e of n){const t=parseFloat(localStorage.getItem(e));isFinite(t)&&(o[e]=t)}for(const e of r){localStorage.getItem(e)&&(o[e]=Object(B.V)(localStorage.getItem(e),!1))}const a=localStorage.getItem(nl.LOG_EVENT);if(a)try{const e=JSON.parse(a);e&&Array.isArray(e)&&(o[nl.LOG_EVENT]=e)}catch(e){console.log("Problem parsing log events")}o[nl.WCS_OVERLAY_BEAM_TYPE]&&(o[nl.WCS_OVERLAY_BEAM_TYPE]=o[nl.WCS_OVERLAY_BEAM_TYPE].toLowerCase()),"1.0x"===o[nl.GLOBAL_ZOOM_MODE]&&(o[nl.GLOBAL_ZOOM_MODE]="full");for(const e of Object.keys(o))this.preferences.set(e,o[e]);o.version=1,await oe.a.Instance.setPreferences(o)}},Object(E.p)(this),this.preferences=new Map}},tl.staticInstance=void 0,zs=il,Ws=Object(C.a)(zs.prototype,"preferences",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gs=Object(C.a)(zs.prototype,"supportsServer",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(zs.prototype,"theme",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"theme"),zs.prototype),Object(C.a)(zs.prototype,"autoLaunch",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"autoLaunch"),zs.prototype),Object(C.a)(zs.prototype,"fileSortingString",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"fileSortingString"),zs.prototype),Object(C.a)(zs.prototype,"fileFilteringType",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"fileFilteringType"),zs.prototype),Object(C.a)(zs.prototype,"layout",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"layout"),zs.prototype),Object(C.a)(zs.prototype,"cursorPosition",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"cursorPosition"),zs.prototype),Object(C.a)(zs.prototype,"zoomMode",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"zoomMode"),zs.prototype),Object(C.a)(zs.prototype,"zoomPoint",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"zoomPoint"),zs.prototype),Object(C.a)(zs.prototype,"dragPanning",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"dragPanning"),zs.prototype),Object(C.a)(zs.prototype,"spectralMatchingType",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"spectralMatchingType"),zs.prototype),Object(C.a)(zs.prototype,"autoWCSMatching",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"autoWCSMatching"),zs.prototype),Object(C.a)(zs.prototype,"scaling",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"scaling"),zs.prototype),Object(C.a)(zs.prototype,"colormap",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"colormap"),zs.prototype),Object(C.a)(zs.prototype,"percentile",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"percentile"),zs.prototype),Object(C.a)(zs.prototype,"scalingAlpha",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"scalingAlpha"),zs.prototype),Object(C.a)(zs.prototype,"scalingGamma",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"scalingGamma"),zs.prototype),Object(C.a)(zs.prototype,"nanColorHex",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"nanColorHex"),zs.prototype),Object(C.a)(zs.prototype,"nanAlpha",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"nanAlpha"),zs.prototype),Object(C.a)(zs.prototype,"contourGeneratorType",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourGeneratorType"),zs.prototype),Object(C.a)(zs.prototype,"contourColormapEnabled",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourColormapEnabled"),zs.prototype),Object(C.a)(zs.prototype,"contourColormap",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourColormap"),zs.prototype),Object(C.a)(zs.prototype,"contourColor",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourColor"),zs.prototype),Object(C.a)(zs.prototype,"contourSmoothingMode",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourSmoothingMode"),zs.prototype),Object(C.a)(zs.prototype,"contourSmoothingFactor",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourSmoothingFactor"),zs.prototype),Object(C.a)(zs.prototype,"contourNumLevels",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourNumLevels"),zs.prototype),Object(C.a)(zs.prototype,"contourThickness",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourThickness"),zs.prototype),Object(C.a)(zs.prototype,"contourDecimation",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourDecimation"),zs.prototype),Object(C.a)(zs.prototype,"contourCompressionLevel",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourCompressionLevel"),zs.prototype),Object(C.a)(zs.prototype,"contourChunkSize",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourChunkSize"),zs.prototype),Object(C.a)(zs.prototype,"astColor",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"astColor"),zs.prototype),Object(C.a)(zs.prototype,"astGridVisible",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"astGridVisible"),zs.prototype),Object(C.a)(zs.prototype,"astLabelsVisible",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"astLabelsVisible"),zs.prototype),Object(C.a)(zs.prototype,"wcsType",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"wcsType"),zs.prototype),Object(C.a)(zs.prototype,"beamVisible",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"beamVisible"),zs.prototype),Object(C.a)(zs.prototype,"beamColor",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"beamColor"),zs.prototype),Object(C.a)(zs.prototype,"beamType",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"beamType"),zs.prototype),Object(C.a)(zs.prototype,"beamWidth",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"beamWidth"),zs.prototype),Object(C.a)(zs.prototype,"regionColor",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"regionColor"),zs.prototype),Object(C.a)(zs.prototype,"regionLineWidth",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"regionLineWidth"),zs.prototype),Object(C.a)(zs.prototype,"regionDashLength",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"regionDashLength"),zs.prototype),Object(C.a)(zs.prototype,"regionType",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"regionType"),zs.prototype),Object(C.a)(zs.prototype,"regionCreationMode",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"regionCreationMode"),zs.prototype),Object(C.a)(zs.prototype,"regionSize",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"regionSize"),zs.prototype),Object(C.a)(zs.prototype,"imageCompressionQuality",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"imageCompressionQuality"),zs.prototype),Object(C.a)(zs.prototype,"animationCompressionQuality",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"animationCompressionQuality"),zs.prototype),Object(C.a)(zs.prototype,"gpuTileCache",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"gpuTileCache"),zs.prototype),Object(C.a)(zs.prototype,"systemTileCache",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"systemTileCache"),zs.prototype),Object(C.a)(zs.prototype,"contourControlMapWidth",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"contourControlMapWidth"),zs.prototype),Object(C.a)(zs.prototype,"streamContoursWhileZooming",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"streamContoursWhileZooming"),zs.prototype),Object(C.a)(zs.prototype,"lowBandwidthMode",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"lowBandwidthMode"),zs.prototype),Object(C.a)(zs.prototype,"stopAnimationPlaybackMinutes",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"stopAnimationPlaybackMinutes"),zs.prototype),Object(C.a)(zs.prototype,"isSelectingAllLogEvents",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"isSelectingAllLogEvents"),zs.prototype),Object(C.a)(zs.prototype,"isSelectingIndeterminateLogEvents",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"isSelectingIndeterminateLogEvents"),zs.prototype),Object(C.a)(zs.prototype,"isZoomRAWMode",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"isZoomRAWMode"),zs.prototype),Object(C.a)(zs.prototype,"isRegionCornerMode",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"isRegionCornerMode"),zs.prototype),Object(C.a)(zs.prototype,"isCursorFrozen",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"isCursorFrozen"),zs.prototype),Object(C.a)(zs.prototype,"enabledLoggingEventNames",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"enabledLoggingEventNames"),zs.prototype),Object(C.a)(zs.prototype,"catalogDisplayedColumnSize",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"catalogDisplayedColumnSize"),zs.prototype),Object(C.a)(zs.prototype,"catalogTableSeparatorPosition",[E.i],Object.getOwnPropertyDescriptor(zs.prototype,"catalogTableSeparatorPosition"),zs.prototype),Vs=Object(C.a)(zs.prototype,"setPreference",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{if(!e)return!1;if(e===nl.LOG_EVENT){if(!Vi.Event.isEventTypeValid(t))return!1;let e=this.preferences.get(nl.LOG_EVENT);return e&&Array.isArray(e)||(e=[]),e.includes(t)?e=e.filter(e=>e!==t):e.push(t),this.preferences.set(nl.LOG_EVENT,e),await oe.a.Instance.setPreference(nl.LOG_EVENT,e)}return this.preferences.set(e,t),await oe.a.Instance.setPreference(e,t)}}}),Bs=Object(C.a)(zs.prototype,"clearPreferences",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async e=>{for(const t of e)this.preferences.delete(t);await oe.a.Instance.clearPreferences(e)}}}),qs=Object(C.a)(zs.prototype,"resetSilentSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.SILENT_FILE_SORTING_STRING,nl.SILENT_FILE_FILTERING_TYPE])}}}),Hs=Object(C.a)(zs.prototype,"resetGlobalSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.GLOBAL_THEME,nl.GLOBAL_AUTOLAUNCH,nl.GLOBAL_LAYOUT,nl.GLOBAL_CURSOR_POSITION,nl.GLOBAL_ZOOM_MODE,nl.GLOBAL_ZOOM_POINT,nl.GLOBAL_DRAG_PANNING,nl.GLOBAL_SPECTRAL_MATCHING_TYPE,nl.GLOBAL_AUTO_WCS_MATCHING])}}}),Us=Object(C.a)(zs.prototype,"resetRenderConfigSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.RENDER_CONFIG_COLORMAP,nl.RENDER_CONFIG_NAN_ALPHA,nl.RENDER_CONFIG_NAN_COLOR_HEX,nl.RENDER_CONFIG_PERCENTILE,nl.RENDER_CONFIG_SCALING,nl.RENDER_CONFIG_SCALING_ALPHA,nl.RENDER_CONFIG_SCALING_GAMMA])}}}),Ys=Object(C.a)(zs.prototype,"resetContourConfigSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.CONTOUR_CONFIG_CONTOUR_COLOR,nl.CONTOUR_CONFIG_CONTOUR_COLORMAP,nl.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED,nl.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE,nl.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS,nl.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR,nl.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE,nl.CONTOUR_CONFIG_CONTOUR_THICKNESS])}}}),Xs=Object(C.a)(zs.prototype,"resetOverlayConfigSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.WCS_OVERLAY_AST_COLOR,nl.WCS_OVERLAY_AST_GRID_VISIBLE,nl.WCS_OVERLAY_AST_LABELS_VISIBLE,nl.WCS_OVERLAY_BEAM_COLOR,nl.WCS_OVERLAY_BEAM_TYPE,nl.WCS_OVERLAY_BEAM_VISIBLE,nl.WCS_OVERLAY_BEAM_WIDTH,nl.WCS_OVERLAY_WCS_TYPE])}}}),Ks=Object(C.a)(zs.prototype,"resetRegionSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.REGION_COLOR,nl.REGION_CREATION_MODE,nl.REGION_DASH_LENGTH,nl.REGION_LINE_WIDTH,nl.REGION_TYPE,nl.REGION_SIZE])}}}),Qs=Object(C.a)(zs.prototype,"resetPerformanceSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,nl.PERFORMANCE_CONTOUR_CHUNK_SIZE,nl.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,nl.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,nl.PERFORMANCE_CONTOUR_DECIMATION,nl.PERFORMANCE_GPU_TILE_CACHE,nl.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,nl.PERFORMANCE_LOW_BAND_WIDTH_MODE,nl.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,nl.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,nl.PERFORMANCE_SYSTEM_TILE_CACHE])}}}),Zs=Object(C.a)(zs.prototype,"selectAllLogEvents",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isSelectingAllLogEvents||this.isSelectingIndeterminateLogEvents?this.resetLogEventSettings():Vi.Event.EVENT_TYPES.forEach(e=>this.setPreference(nl.LOG_EVENT,e))}}}),$s=Object(C.a)(zs.prototype,"resetLogEventSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.LOG_EVENT])}}}),Js=Object(C.a)(zs.prototype,"resetCatalogSettings",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([nl.CATALOG_DISPLAYED_COLUMN_SIZE,nl.CATALOG_TABLE_SEPARATOR_POSITION])}}}),el=Object(C.a)(zs.prototype,"fetchPreferences",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{await this.upgradePreferences(),await this.getPreferences()}}}),zs);var al,sl,ll,cl,ul,pl,dl,hl,gl,ml,fl,yl=i(436),bl=i(7);let Ol=(fl=ml=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){this.layoutNameToBeSaved=void 0,Object(S.a)(this,"dockedLayout",sl,this),Object(S.a)(this,"currentLayoutName",ll,this),Object(S.a)(this,"layouts",cl,this),Object(S.a)(this,"supportsServer",ul,this),this.layoutExists=e=>e&&this.allLayoutNames.includes(e),this.setLayoutToBeSaved=e=>{this.layoutNameToBeSaved=e||"Empty"},Object(S.a)(this,"fetchLayouts",pl,this),this.initLayoutsFromPresets=()=>{Vi.PresetLayout.PRESETS.forEach(e=>{const t=Vi.LayoutConfig.GetPresetConfig(e);t&&(this.layouts[e]=t)})},Object(S.a)(this,"applyLayout",dl,this),Object(S.a)(this,"saveLayout",hl,this),this.handleSaveResult=t=>{t?(bl.a.show(Object(bl.v)("layout-grid",`Layout ${this.layoutNameToBeSaved} saved successfully.`,e.ToasterTimeout)),this.currentLayoutName=this.layoutNameToBeSaved):(delete this.layouts[this.layoutNameToBeSaved],I.Instance.showAlert("Saving user-defined layout failed! "))},Object(S.a)(this,"deleteLayout",gl,this),this.handleDeleteResult=(t,i)=>{i?(bl.a.show(Object(bl.v)("layout-grid",`Layout ${t} deleted successfully.`,e.ToasterTimeout)),t===this.currentLayoutName&&(this.currentLayoutName="")):I.Instance.showAlert("Deleting user-defined layout failed!")},Object(E.p)(this),this.dockedLayout=null,this.layouts={},this.supportsServer=!1,this.initLayoutsFromPresets()}get allLayoutNames(){return this.layouts?Object.keys(this.layouts):[]}get userLayoutNames(){return this.layouts?Object.keys(this.layouts).filter(e=>!Vi.PresetLayout.isPreset(e)):[]}get orderedLayoutNames(){var e;let t=[...Vi.PresetLayout.PRESETS];return(null===(e=this.userLayoutNames)||void 0===e?void 0:e.length)?t.concat(this.userLayoutNames):t}get numSavedLayouts(){return this.userLayoutNames.length}},ml.staticInstance=void 0,ml.ToasterTimeout=1500,al=fl,sl=Object(C.a)(al.prototype,"dockedLayout",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll=Object(C.a)(al.prototype,"currentLayoutName",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cl=Object(C.a)(al.prototype,"layouts",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ul=Object(C.a)(al.prototype,"supportsServer",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pl=Object(C.a)(al.prototype,"fetchLayouts",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{try{const e=await oe.a.Instance.getLayouts();for(const t of Object.keys(e))t&&(this.layouts[t]=e[t])}catch(e){I.Instance.showAlert("Loading user-defined layout failed!"),console.log(e)}}}}),Object(C.a)(al.prototype,"allLayoutNames",[E.i],Object.getOwnPropertyDescriptor(al.prototype,"allLayoutNames"),al.prototype),Object(C.a)(al.prototype,"userLayoutNames",[E.i],Object.getOwnPropertyDescriptor(al.prototype,"userLayoutNames"),al.prototype),Object(C.a)(al.prototype,"orderedLayoutNames",[E.i],Object.getOwnPropertyDescriptor(al.prototype,"orderedLayoutNames"),al.prototype),Object(C.a)(al.prototype,"numSavedLayouts",[E.i],Object.getOwnPropertyDescriptor(al.prototype,"numSavedLayouts"),al.prototype),dl=Object(C.a)(al.prototype,"applyLayout",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!e||!this.layoutExists(e))return I.Instance.showAlert(`Applying layout failed! Layout ${e} not found.`),!1;const t=this.layouts[e],i=ne.a.Instance;this.dockedLayout&&(i.widgetsStore.removeFloatingWidgets(),this.dockedLayout.destroy());let n={type:t.docked.type,content:[]},r=[];return Vi.LayoutConfig.CreateConfigToApply(n.content,t.docked.content,r),i.widgetsStore.initWidgets(r,t.floating),this.dockedLayout=new yl({settings:{showPopoutIcon:!1,showCloseIcon:!1},dimensions:{minItemWidth:250,minItemHeight:200,dragProxyWidth:600,dragProxyHeight:270},content:[n]},i.getAppContainer()),i.widgetsStore.initLayoutWithWidgets(this.dockedLayout),this.dockedLayout.init(),this.currentLayoutName=e,!0}}}),hl=Object(C.a)(al.prototype,"saveLayout",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=ne.a.Instance;if(!this.layouts||!this.layoutNameToBeSaved||!this.dockedLayout)return void e.alertStore.showAlert("Save layout failed! Empty layouts or name.");if(Vi.PresetLayout.isPreset(this.layoutNameToBeSaved))return void e.alertStore.showAlert("Layout name cannot be the same as system presets.");if(!this.layoutExists(this.layoutNameToBeSaved)&&this.numSavedLayouts>=10)return void e.alertStore.showAlert("Maximum user-defined layout quota exceeded! (10 layouts)");const t=this.dockedLayout.toConfig();if(!t||!t.content||t.content.length<=0)return void e.alertStore.showAlert("Saving layout failed! Something is wrong with current layout.");const i=Vi.LayoutConfig.CreateConfigToSave(e,t.content[0]);i?(this.layouts[this.layoutNameToBeSaved]=i,Vi.PresetLayout.isPreset(this.layoutNameToBeSaved)||e.apiService.setLayout(this.layoutNameToBeSaved,i).then(e=>{this.handleSaveResult(e)},e=>{console.log(e),this.handleSaveResult(!1)})):e.alertStore.showAlert("Saving layout failed! Creat layout configuration for saving failed.")}}}),gl=Object(C.a)(al.prototype,"deleteLayout",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=ne.a.Instance;e&&this.layoutExists(e)?t.apiService.clearLayout(e).then(t=>{t&&(delete this.layouts[e],e===this.currentLayoutName&&(this.currentLayoutName="")),this.handleDeleteResult(e,t)},t=>{console.log(t),this.handleDeleteResult(e,!1)}):t.alertStore.showAlert(`Cannot delete layout ${e}! It does not exist.`)}}}),al);var Sl,Cl,El,Il,wl,Tl,vl,Al,xl,Rl,Pl,jl,kl,Fl,Ml,Dl,Nl,Ll,_l,zl,Wl,Gl,Vl,Bl,ql,Hl,Ul,Yl,Xl,Kl,Ql,Zl,$l,Jl,ec,tc,ic,nc,rc,oc;let ac=(oc=rc=class e{constructor(){Object(S.a)(this,"regionDialogVisible",Cl,this),Object(S.a)(this,"showRegionDialog",El,this),Object(S.a)(this,"hideRegionDialog",Il,this),Object(S.a)(this,"hotkeyDialogVisible",wl,this),Object(S.a)(this,"showHotkeyDialog",Tl,this),Object(S.a)(this,"hideHotkeyDialog",vl,this),Object(S.a)(this,"aboutDialogVisible",Al,this),Object(S.a)(this,"showAboutDialog",xl,this),Object(S.a)(this,"hideAboutDialog",Rl,this),Object(S.a)(this,"preferenceDialogVisible",Pl,this),Object(S.a)(this,"showPreferenceDialog",jl,this),Object(S.a)(this,"hidePreferenceDialog",kl,this),Object(S.a)(this,"saveLayoutDialogVisible",Fl,this),Object(S.a)(this,"deleteLayoutDialogVisible",Ml,this),Object(S.a)(this,"showSaveLayoutDialog",Dl,this),Object(S.a)(this,"hideSaveLayoutDialog",Nl,this),Object(S.a)(this,"showDeleteLayoutDialog",Ll,this),Object(S.a)(this,"hideDeleteLayoutDialog",_l,this),Object(S.a)(this,"fileBrowserDialogVisible",zl,this),Object(S.a)(this,"showFileBrowserDialog",Wl,this),Object(S.a)(this,"hideFileBrowserDialog",Gl,this),Object(S.a)(this,"fileInfoDialogVisible",Vl,this),Object(S.a)(this,"selectedFileInfoDialogTab",Bl,this),Object(S.a)(this,"showFileInfoDialog",ql,this),Object(S.a)(this,"hideFileInfoDialog",Hl,this),Object(S.a)(this,"setSelectedFileInfoDialogTab",Ul,this),Object(S.a)(this,"contourDialogVisible",Yl,this),Object(S.a)(this,"showContourDialog",Xl,this),Object(S.a)(this,"hideContourDialog",Kl,this),Object(S.a)(this,"debugExecutionDialogVisible",Ql,this),Object(S.a)(this,"showDebugExecutionDialog",Zl,this),Object(S.a)(this,"hideDebugExecutionDialog",$l,this),Object(S.a)(this,"externalPageDialogVisible",Jl,this),Object(S.a)(this,"externalPageDialogUrl",ec,this),Object(S.a)(this,"externalPageDialogTitle",tc,this),Object(S.a)(this,"showExternalPageDialog",ic,this),Object(S.a)(this,"hideExternalPageDialog",nc,this),Object(E.p)(this)}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}},rc.staticInstance=void 0,Sl=oc,Cl=Object(C.a)(Sl.prototype,"regionDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),El=Object(C.a)(Sl.prototype,"showRegionDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionDialogVisible=!0}}}),Il=Object(C.a)(Sl.prototype,"hideRegionDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionDialogVisible=!1}}}),wl=Object(C.a)(Sl.prototype,"hotkeyDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tl=Object(C.a)(Sl.prototype,"showHotkeyDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hotkeyDialogVisible=!0}}}),vl=Object(C.a)(Sl.prototype,"hideHotkeyDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hotkeyDialogVisible=!1}}}),Al=Object(C.a)(Sl.prototype,"aboutDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xl=Object(C.a)(Sl.prototype,"showAboutDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.aboutDialogVisible=!0}}}),Rl=Object(C.a)(Sl.prototype,"hideAboutDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.aboutDialogVisible=!1}}}),Pl=Object(C.a)(Sl.prototype,"preferenceDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=Object(C.a)(Sl.prototype,"showPreferenceDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceDialogVisible=!0}}}),kl=Object(C.a)(Sl.prototype,"hidePreferenceDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceDialogVisible=!1}}}),Fl=Object(C.a)(Sl.prototype,"saveLayoutDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ml=Object(C.a)(Sl.prototype,"deleteLayoutDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dl=Object(C.a)(Sl.prototype,"showSaveLayoutDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveLayoutDialogVisible=!0}}}),Nl=Object(C.a)(Sl.prototype,"hideSaveLayoutDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveLayoutDialogVisible=!1}}}),Ll=Object(C.a)(Sl.prototype,"showDeleteLayoutDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.deleteLayoutDialogVisible=!0}}}),_l=Object(C.a)(Sl.prototype,"hideDeleteLayoutDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.deleteLayoutDialogVisible=!1}}}),zl=Object(C.a)(Sl.prototype,"fileBrowserDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Wl=Object(C.a)(Sl.prototype,"showFileBrowserDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileBrowserDialogVisible=!0}}}),Gl=Object(C.a)(Sl.prototype,"hideFileBrowserDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileBrowserDialogVisible=!1}}}),Vl=Object(C.a)(Sl.prototype,"fileInfoDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Bl=Object(C.a)(Sl.prototype,"selectedFileInfoDialogTab",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ct.e.IMAGE_HEADER}}),ql=Object(C.a)(Sl.prototype,"showFileInfoDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileInfoDialogVisible=!0}}}),Hl=Object(C.a)(Sl.prototype,"hideFileInfoDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileInfoDialogVisible=!1}}}),Ul=Object(C.a)(Sl.prototype,"setSelectedFileInfoDialogTab",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileInfoDialogTab=e}}}),Yl=Object(C.a)(Sl.prototype,"contourDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xl=Object(C.a)(Sl.prototype,"showContourDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contourDialogVisible=!0}}}),Kl=Object(C.a)(Sl.prototype,"hideContourDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contourDialogVisible=!1}}}),Ql=Object(C.a)(Sl.prototype,"debugExecutionDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Zl=Object(C.a)(Sl.prototype,"showDebugExecutionDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.debugExecutionDialogVisible=!0}}}),$l=Object(C.a)(Sl.prototype,"hideDebugExecutionDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.debugExecutionDialogVisible=!1}}}),Jl=Object(C.a)(Sl.prototype,"externalPageDialogVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ec=Object(C.a)(Sl.prototype,"externalPageDialogUrl",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tc=Object(C.a)(Sl.prototype,"externalPageDialogTitle",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ic=Object(C.a)(Sl.prototype,"showExternalPageDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.externalPageDialogUrl=e,this.externalPageDialogTitle=t,this.externalPageDialogVisible=!0}}}),nc=Object(C.a)(Sl.prototype,"hideExternalPageDialog",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.externalPageDialogVisible=!1}}}),Sl);var sc,lc,cc,uc,pc,dc,hc,gc,mc,fc;let yc=(fc=mc=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(S.a)(this,"catalogData",lc,this),Object(S.a)(this,"imageAssociatedCatalogId",cc,this),Object(S.a)(this,"catalogProfiles",uc,this),Object(S.a)(this,"catalogPlots",pc,this),Object(S.a)(this,"catalogProfileStores",dc,this),Object(S.a)(this,"catalogWidgets",hc,this),Object(S.a)(this,"updateCatalogProfiles",gc,this),Object(E.p)(this),this.catalogData=new E.b,this.imageAssociatedCatalogId=new Map,this.catalogProfiles=new Map,this.catalogPlots=new Map,this.catalogProfileStores=new Map,this.catalogWidgets=new Map}addCatalog(e){this.catalogData.set(e,{xImageCoords:[],yImageCoords:[],xSelectedCoords:[],ySelectedCoords:[],showSelectedData:!1,displayed:!0})}updateCatalogData(t,i,n,r,o,a,s){const l=this.catalogData.get(t);if(l){switch(s){case Pc.c.Pixel0:for(let e=0;e<i.length;e++)l.xImageCoords.push(i[e]),l.yImageCoords.push(n[e]);break;case Pc.c.Pixel1:for(let e=0;e<i.length;e++)l.xImageCoords.push(i[e]-1),l.yImageCoords.push(n[e]-1);break;default:const t=e.TransformCatalogData(i,n,r,o,a,s);for(let e=0;e<t.xImageCoords.length;e++)l.xImageCoords.push(t.xImageCoords[e]),l.yImageCoords.push(t.yImageCoords[e])}this.catalogData.set(t,{xImageCoords:l.xImageCoords,yImageCoords:l.yImageCoords,xSelectedCoords:l.xSelectedCoords,ySelectedCoords:l.ySelectedCoords,showSelectedData:l.showSelectedData,displayed:l.displayed})}}updateSelectedPoints(e,t,i){const n=this.catalogData.get(e);n&&this.catalogData.set(e,{xImageCoords:n.xImageCoords,yImageCoords:n.yImageCoords,xSelectedCoords:t,ySelectedCoords:i,showSelectedData:n.showSelectedData,displayed:n.displayed})}clearImageCoordsData(e){const t=this.catalogData.get(e);t&&(t.xImageCoords=[],t.yImageCoords=[],t.showSelectedData=!1)}removeCatalog(e){this.catalogData.delete(e)}updateShowSelectedData(e,t){const i=this.catalogData.get(e);i&&(i.showSelectedData=t)}updateImageAssociatedCatalogId(e,t){this.imageAssociatedCatalogId.set(e,t)}resetActiveCatalogFile(e){const t=this.imageAssociatedCatalogId.get(e),i=t||[];this.catalogProfiles.size&&(null===i||void 0===i?void 0:i.length)&&this.catalogProfiles.forEach((e,t)=>{this.catalogProfiles.set(t,i[0])}),this.resetDisplayedData(i)}getImageIdbyCatalog(e){let t=void 0;return this.imageAssociatedCatalogId.forEach((i,n)=>{i.includes(e)&&(t=n)}),t}resetDisplayedData(e){e.length?this.catalogData.forEach((t,i)=>{let n=!0;e.includes(i)||(n=!1),this.catalogData.set(i,{xImageCoords:t.xImageCoords,yImageCoords:t.yImageCoords,xSelectedCoords:t.xSelectedCoords,ySelectedCoords:t.ySelectedCoords,showSelectedData:t.showSelectedData,displayed:n})}):this.catalogData.forEach((e,t)=>{this.catalogData.set(t,{xImageCoords:e.xImageCoords,yImageCoords:e.yImageCoords,xSelectedCoords:e.xSelectedCoords,ySelectedCoords:e.ySelectedCoords,showSelectedData:e.showSelectedData,displayed:!1})})}setCatalogPlots(e,t,i){let n=this.catalogPlots.get(e);n?n.set(t,i):(n=new E.b,n.set(t,i),this.catalogPlots.set(e,n))}clearCatalogPlotsByFileId(e){this.catalogPlots.forEach((t,i)=>{const n=t.get(e);Fa.Instance.catalogPlotWidgets.delete(n),t.delete(e)})}clearCatalogPlotsByComponentId(e){const t=this.catalogPlots.get(e);t&&(t.forEach((e,t)=>{Fa.Instance.catalogPlotWidgets.delete(e)}),this.catalogPlots.delete(e))}clearCatalogPlotsByWidgetId(e){const t=this.getAssociatedIdByWidgetId(e);t.catalogPlotComponentId&&this.clearCatalogPlotsByComponentId(t.catalogPlotComponentId)}closeAssociatedCatalog(e){const t=this.imageAssociatedCatalogId.get(e);(null===t||void 0===t?void 0:t.length)&&(t.forEach(e=>{const t=this.catalogWidgets.get(e);t&&ne.a.Instance.removeCatalog(e,t)}),this.imageAssociatedCatalogId.delete(e))}get activeCatalogFiles(){const e=ne.a.Instance.activeFrame;if(e){const t=e.frameInfo.fileId;return this.imageAssociatedCatalogId.get(t)}return[]}getAssociatedIdByWidgetId(e){let t,i;return this.catalogPlots.forEach((n,r)=>{n.forEach((n,o)=>{n===e&&(t=r,i=o)})}),{catalogPlotComponentId:t,catalogFileId:i}}getCatalogFileNames(e){let t=new Map;return e.forEach(e=>{const i=this.catalogProfileStores.get(e);if(i){const e=i.catalogInfo;t.set(e.fileId,e.fileInfo.name)}}),t}getCatalogWidgetStore(e){const t=Fa.Instance;if(this.catalogWidgets.has(e)){const i=this.catalogWidgets.get(e);return t.catalogWidgets.get(i)}{const i=t.addCatalogWidget(e);return t.catalogWidgets.get(i)}}static GetFractionFromUnit(t){return e.ArcminUnits.includes(t)?Math.PI/10800:e.ArcsecUnits.includes(t)?Math.PI/648e3:Math.PI/180}static TransformCatalogData(t,i,n,r,o,a){if((null===t||void 0===t?void 0:t.length)===(null===i||void 0===i?void 0:i.length)&&(null===t||void 0===t?void 0:t.length)>0){const s=t.length;let l=e.GetFractionFromUnit(r.toLocaleLowerCase()),c=e.GetFractionFromUnit(o.toLocaleLowerCase()),u=Gi.copy(n),p="System="+a;Gi.set(u,p),a===Pc.c.FK4&&(Gi.set(u,"Epoch=B1950"),Gi.set(u,"Equinox=1950")),a===Pc.c.FK5&&(Gi.set(u,"Epoch=J2000"),Gi.set(u,"Equinox=2000"));const d=new Float64Array(s),h=new Float64Array(s);for(let e=0;e<s;e++)d[e]=t[e]*l,h[e]=i[e]*c;const g=Gi.transformPointArrays(u,d,h,0);return Gi.delete(u),{xImageCoords:g.x,yImageCoords:g.y}}return{xImageCoords:new Float64Array(0),yImageCoords:new Float64Array(0)}}},mc.staticInstance=void 0,mc.DegreeUnits=["deg","degrees"],mc.ArcsecUnits=["arcsec","arcsecond"],mc.ArcminUnits=["arcmin","arcminute"],sc=fc,lc=Object(C.a)(sc.prototype,"catalogData",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cc=Object(C.a)(sc.prototype,"imageAssociatedCatalogId",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uc=Object(C.a)(sc.prototype,"catalogProfiles",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pc=Object(C.a)(sc.prototype,"catalogPlots",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dc=Object(C.a)(sc.prototype,"catalogProfileStores",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hc=Object(C.a)(sc.prototype,"catalogWidgets",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(C.a)(sc.prototype,"addCatalog",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"addCatalog"),sc.prototype),Object(C.a)(sc.prototype,"updateCatalogData",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"updateCatalogData"),sc.prototype),Object(C.a)(sc.prototype,"updateSelectedPoints",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"updateSelectedPoints"),sc.prototype),Object(C.a)(sc.prototype,"clearImageCoordsData",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"clearImageCoordsData"),sc.prototype),Object(C.a)(sc.prototype,"removeCatalog",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"removeCatalog"),sc.prototype),Object(C.a)(sc.prototype,"updateShowSelectedData",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"updateShowSelectedData"),sc.prototype),Object(C.a)(sc.prototype,"updateImageAssociatedCatalogId",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"updateImageAssociatedCatalogId"),sc.prototype),Object(C.a)(sc.prototype,"resetActiveCatalogFile",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"resetActiveCatalogFile"),sc.prototype),gc=Object(C.a)(sc.prototype,"updateCatalogProfiles",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.catalogProfiles.size>0){const t=Array.from(this.catalogProfiles.keys());Array.from(this.catalogProfiles.values()).includes(e)||this.catalogProfiles.set(t[0],e)}}}}),Object(C.a)(sc.prototype,"resetDisplayedData",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"resetDisplayedData"),sc.prototype),Object(C.a)(sc.prototype,"setCatalogPlots",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"setCatalogPlots"),sc.prototype),Object(C.a)(sc.prototype,"clearCatalogPlotsByFileId",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"clearCatalogPlotsByFileId"),sc.prototype),Object(C.a)(sc.prototype,"clearCatalogPlotsByComponentId",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"clearCatalogPlotsByComponentId"),sc.prototype),Object(C.a)(sc.prototype,"clearCatalogPlotsByWidgetId",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"clearCatalogPlotsByWidgetId"),sc.prototype),Object(C.a)(sc.prototype,"closeAssociatedCatalog",[E.g],Object.getOwnPropertyDescriptor(sc.prototype,"closeAssociatedCatalog"),sc.prototype),Object(C.a)(sc.prototype,"activeCatalogFiles",[E.i],Object.getOwnPropertyDescriptor(sc.prototype,"activeCatalogFiles"),sc.prototype),sc);var bc,Oc,Sc,Cc,Ec,Ic,wc,Tc,vc=i(45);let Ac,xc=(Tc=wc=class e{constructor(){Object(S.a)(this,"type",Oc,this),Object(S.a)(this,"helpVisible",Sc,this),Object(S.a)(this,"position",Cc,this),Object(S.a)(this,"showHelpDrawer",Ec,this),Object(S.a)(this,"hideHelpDrawer",Ic,this),Object(E.p)(this)}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}},wc.staticInstance=void 0,bc=Tc,Oc=Object(C.a)(bc.prototype,"type",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sc=Object(C.a)(bc.prototype,"helpVisible",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Cc=Object(C.a)(bc.prototype,"position",[E.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return vc.a.RIGHT}}),Ec=Object(C.a)(bc.prototype,"showHelpDrawer",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.type=e,this.position=t>.5*document.body.clientWidth?vc.a.LEFT:vc.a.RIGHT,this.helpVisible=!0}}}),Ic=Object(C.a)(bc.prototype,"hideHelpDrawer",[E.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.helpVisible=!1}}}),bc);!function(e){e.CONTOUR="contour",e.PREFERENCES="preferences",e.FILE_Browser="file-browser",e.FILE_INFO="file-info",e.SAVE_LAYOUT="save-layout",e.REGION_DIALOG="region-dialog",e.ANIMATOR="animator",e.HISTOGRAM="histogram",e.HISTOGRAM_SETTINGS="histogram-settings",e.IMAGE_VIEW="image-view",e.IMAGE_VIEW_SETTINGS="image-view-settings",e.LAYER_LIST="layer-list",e.LOG="log",e.PLACEHOLDER="placeholder",e.REGION_LIST="region-list",e.RENDER_CONFIG="render-config",e.RENDER_CONFIG_SETTINGS="render-config-settings",e.SPATIAL_PROFILER="spatial-profiler",e.SPATIAL_PROFILER_SETTINGS_STYLING="spatial-profiler-settings-styling",e.SPATIAL_PROFILER_SETTINGS_SMOOTHING="spatial-profiler-settings-smoothing",e.SPECTRAL_PROFILER="spectral-profiler",e.SPECTRAL_PROFILER_SETTINGS_CONVERSION="spectral-profiler-settings-conversion",e.SPECTRAL_PROFILER_SETTINGS_STYLING="spectral-profiler-settings-styling",e.SPECTRAL_PROFILER_SETTINGS_SMOOTHING="spectral-profiler-settings-smoothing",e.SPECTRAL_PROFILER_SETTINGS_MOMENTS="spectral-profiler-settings-moments",e.STATS="stats",e.STOKES_ANALYSIS="stoke-analysis",e.STOKES_ANALYSIS_SETTINGS_CONVERSION="stoke-analysis-settings-conversion",e.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING="stoke-analysis-settings-line-plot-styling",e.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING="stoke-analysis-settings-scatter-plot-styling",e.STOKES_ANALYSIS_SETTINGS_SMOOTHING="stoke-analysis-settings-smoothing",e.CATALOG_OVERLAY="catalog-overlay",e.CATALOG_HISTOGRAM_PLOT="catalog-histogram-plot",e.CATALOG_SCATTER_PLOT="catalog-scatter-plot",e.CATALOG_SETTINGS_GOLBAL="catalog-settings-golbal",e.CATALOG_SETTINGS_OVERLAY="catalog-settings-overlay",e.CATALOG_SETTINGS_COLOR="catalog-settings-color",e.SPECTRAL_LINE_QUERY="spectral-line-query"}(Ac||(Ac={}));var Rc=i(127),Pc=i(161)},442:function(e,t,i){e.exports=i.p+"static/media/head_contour_button.f25f6492.png"},443:function(e,t,i){e.exports=i.p+"static/media/head_contour_button_d.1703ebf0.png"},444:function(e,t,i){e.exports=i.p+"static/media/head_fileinfo_button.158dedfb.png"},445:function(e,t,i){e.exports=i.p+"static/media/head_fileinfo_button_d.235291c1.png"},446:function(e,t,i){e.exports=i.p+"static/media/head_preference_button.d6da12d8.png"},447:function(e,t,i){e.exports=i.p+"static/media/head_preference_button_d.056efcad.png"},448:function(e,t,i){e.exports=i.p+"static/media/head_animator_button.2af17a26.png"},449:function(e,t,i){e.exports=i.p+"static/media/head_animator_button_d.7e08564b.png"},450:function(e,t,i){e.exports=i.p+"static/media/head_histogram_button.fcb4421d.png"},451:function(e,t,i){e.exports=i.p+"static/media/head_histogram_button_d.ffe80422.png"},452:function(e,t,i){e.exports=i.p+"static/media/catalogue_selection_button.e6efeec2.png"},453:function(e,t,i){e.exports=i.p+"static/media/catalogue_selection_button_d.4fe9d44a.png"},454:function(e,t,i){e.exports=i.p+"static/media/contour_button.f25f6492.png"},455:function(e,t,i){e.exports=i.p+"static/media/contour_button_d.1703ebf0.png"},456:function(e,t,i){e.exports=i.p+"static/media/export_png_button.5e441e52.png"},457:function(e,t,i){e.exports=i.p+"static/media/export_png_button_d.b613c17d.png"},458:function(e,t,i){e.exports=i.p+"static/media/image_info_button.158dedfb.png"},459:function(e,t,i){e.exports=i.p+"static/media/image_info_button_d.235291c1.png"},460:function(e,t,i){e.exports=i.p+"static/media/image_tools.81b60eff.png"},461:function(e,t,i){e.exports=i.p+"static/media/image_tools_d.f6e8c058.png"},462:function(e,t,i){e.exports=i.p+"static/media/region_button.b6a80cc8.png"},463:function(e,t,i){e.exports=i.p+"static/media/region_button_d.394c2fac.png"},464:function(e,t,i){e.exports=i.p+"static/media/wcs_match_button.070b5787.png"},465:function(e,t,i){e.exports=i.p+"static/media/wcs_match_button_d.7f03c0ad.png"},466:function(e,t,i){e.exports=i.p+"static/media/zoom_button.39547a5e.png"},467:function(e,t,i){e.exports=i.p+"static/media/zoom_button_d.40a099e3.png"},468:function(e,t,i){e.exports=i.p+"static/media/image_overlay_demo.a7638f85.png"},469:function(e,t,i){e.exports=i.p+"static/media/image_overlay_demo_d.a7638f85.png"},470:function(e,t,i){e.exports=i.p+"static/media/head_layer_button.41b68969.png"},471:function(e,t,i){e.exports=i.p+"static/media/head_layer_button_d.28cdf682.png"},472:function(e,t,i){e.exports=i.p+"static/media/head_log_button.d03c4550.png"},473:function(e,t,i){e.exports=i.p+"static/media/head_log_button_d.aa1ca456.png"},474:function(e,t,i){e.exports=i.p+"static/media/under_construction.88fb1056.png"},475:function(e,t,i){e.exports=i.p+"static/media/head_region_button.4303242a.png"},476:function(e,t,i){e.exports=i.p+"static/media/head_region_button_d.2d44f7e1.png"},477:function(e,t,i){e.exports=i.p+"static/media/head_renderconfig_button.4a8c3d39.png"},478:function(e,t,i){e.exports=i.p+"static/media/head_renderconfig_button_d.eda3def3.png"},479:function(e,t,i){e.exports=i.p+"static/media/head_spatial_button.826c3bee.png"},480:function(e,t,i){e.exports=i.p+"static/media/head_spatial_button_d.d774d882.png"},481:function(e,t,i){e.exports=i.p+"static/media/head_spectral_button.e5e241eb.png"},482:function(e,t,i){e.exports=i.p+"static/media/head_spectral_button_d.c4a0ab8d.png"},483:function(e,t,i){e.exports=i.p+"static/media/head_statistics_button.c6745916.png"},484:function(e,t,i){e.exports=i.p+"static/media/head_statistics_button_d.9c7d3121.png"},485:function(e,t,i){e.exports=i.p+"static/media/head_stokes_button.db7f7084.png"},486:function(e,t,i){e.exports=i.p+"static/media/head_stokes_button_d.5415a053.png"},487:function(e,t,i){e.exports=i.p+"static/media/head_linequery_button.bd14b0ff.png"},488:function(e,t,i){e.exports=i.p+"static/media/head_linequery_button_d.bd9896ef.png"},5:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(23);const r=n.Reader,o=n.Writer,a=n.util,s=n.roots.default||(n.roots.default={}),l=s.CARTA=(()=>{const e={};return e.Point=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.x=0,e.prototype.y=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(13).float(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(21).float(e.y),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.Point;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.x=e.float();break;case 2:n.y=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!==typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!==typeof e.y?"y: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.Point)return e;let t=new s.CARTA.Point;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.x=0,i.y=0),null!=e.x&&e.hasOwnProperty("x")&&(i.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=t.json&&!isFinite(e.y)?String(e.y):e.y),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfo=function(){function e(e){if(this.HDUList=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.type=0,e.prototype.size=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.HDUList=a.emptyArray,e.prototype.date=a.Long?a.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(25).sfixed64(e.size),null!=e.HDUList&&e.HDUList.length)for(let i=0;i<e.HDUList.length;++i)t.uint32(34).string(e.HDUList[i]);return null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(41).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FileInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.type=e.int32();break;case 3:n.size=e.sfixed64();break;case 4:n.HDUList&&n.HDUList.length||(n.HDUList=[]),n.HDUList.push(e.string());break;case 5:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.size&&e.hasOwnProperty("size")&&!a.isInteger(e.size)&&!(e.size&&a.isInteger(e.size.low)&&a.isInteger(e.size.high)))return"size: integer|Long expected";if(null!=e.HDUList&&e.hasOwnProperty("HDUList")){if(!Array.isArray(e.HDUList))return"HDUList: array expected";for(let t=0;t<e.HDUList.length;++t)if(!a.isString(e.HDUList[t]))return"HDUList: string[] expected"}return null==e.date||!e.hasOwnProperty("date")||a.isInteger(e.date)||e.date&&a.isInteger(e.date.low)&&a.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof s.CARTA.FileInfo)return e;let t=new s.CARTA.FileInfo;switch(null!=e.name&&(t.name=String(e.name)),e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}if(null!=e.size&&(a.Long?(t.size=a.Long.fromValue(e.size)).unsigned=!1:"string"===typeof e.size?t.size=parseInt(e.size,10):"number"===typeof e.size?t.size=e.size:"object"===typeof e.size&&(t.size=new a.LongBits(e.size.low>>>0,e.size.high>>>0).toNumber())),e.HDUList){if(!Array.isArray(e.HDUList))throw TypeError(".CARTA.FileInfo.HDUList: array expected");t.HDUList=[];for(let i=0;i<e.HDUList.length;++i)t.HDUList[i]=String(e.HDUList[i])}return null!=e.date&&(a.Long?(t.date=a.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new a.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.HDUList=[]),t.defaults){if(i.name="",i.type=t.enums===String?"CASA":0,a.Long){let e=new a.Long(0,0,!1);i.size=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.size=t.longs===String?"0":0;if(a.Long){let e=new a.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0}if(null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?s.CARTA.FileType[e.type]:e.type),null!=e.size&&e.hasOwnProperty("size")&&("number"===typeof e.size?i.size=t.longs===String?String(e.size):e.size:i.size=t.longs===String?a.Long.prototype.toString.call(e.size):t.longs===Number?new a.LongBits(e.size.low>>>0,e.size.high>>>0).toNumber():e.size),e.HDUList&&e.HDUList.length){i.HDUList=[];for(let t=0;t<e.HDUList.length;++t)i.HDUList[t]=e.HDUList[t]}return null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?a.Long.prototype.toString.call(e.date):t.longs===Number?new a.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfoExtended=function(){function e(e){if(this.stokesVals=[],this.headerEntries=[],this.computedEntries=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dimensions=0,e.prototype.width=0,e.prototype.height=0,e.prototype.depth=0,e.prototype.stokes=0,e.prototype.stokesVals=a.emptyArray,e.prototype.headerEntries=a.emptyArray,e.prototype.computedEntries=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.dimensions&&Object.hasOwnProperty.call(e,"dimensions")&&t.uint32(13).sfixed32(e.dimensions),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(21).sfixed32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(29).sfixed32(e.height),null!=e.depth&&Object.hasOwnProperty.call(e,"depth")&&t.uint32(37).sfixed32(e.depth),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(45).sfixed32(e.stokes),null!=e.stokesVals&&e.stokesVals.length)for(let i=0;i<e.stokesVals.length;++i)t.uint32(50).string(e.stokesVals[i]);if(null!=e.headerEntries&&e.headerEntries.length)for(let i=0;i<e.headerEntries.length;++i)s.CARTA.HeaderEntry.encode(e.headerEntries[i],t.uint32(58).fork()).ldelim();if(null!=e.computedEntries&&e.computedEntries.length)for(let i=0;i<e.computedEntries.length;++i)s.CARTA.HeaderEntry.encode(e.computedEntries[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FileInfoExtended;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.dimensions=e.sfixed32();break;case 2:n.width=e.sfixed32();break;case 3:n.height=e.sfixed32();break;case 4:n.depth=e.sfixed32();break;case 5:n.stokes=e.sfixed32();break;case 6:n.stokesVals&&n.stokesVals.length||(n.stokesVals=[]),n.stokesVals.push(e.string());break;case 7:n.headerEntries&&n.headerEntries.length||(n.headerEntries=[]),n.headerEntries.push(s.CARTA.HeaderEntry.decode(e,e.uint32()));break;case 8:n.computedEntries&&n.computedEntries.length||(n.computedEntries=[]),n.computedEntries.push(s.CARTA.HeaderEntry.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.dimensions&&e.hasOwnProperty("dimensions")&&!a.isInteger(e.dimensions))return"dimensions: integer expected";if(null!=e.width&&e.hasOwnProperty("width")&&!a.isInteger(e.width))return"width: integer expected";if(null!=e.height&&e.hasOwnProperty("height")&&!a.isInteger(e.height))return"height: integer expected";if(null!=e.depth&&e.hasOwnProperty("depth")&&!a.isInteger(e.depth))return"depth: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.stokesVals&&e.hasOwnProperty("stokesVals")){if(!Array.isArray(e.stokesVals))return"stokesVals: array expected";for(let t=0;t<e.stokesVals.length;++t)if(!a.isString(e.stokesVals[t]))return"stokesVals: string[] expected"}if(null!=e.headerEntries&&e.hasOwnProperty("headerEntries")){if(!Array.isArray(e.headerEntries))return"headerEntries: array expected";for(let t=0;t<e.headerEntries.length;++t){let i=s.CARTA.HeaderEntry.verify(e.headerEntries[t]);if(i)return"headerEntries."+i}}if(null!=e.computedEntries&&e.hasOwnProperty("computedEntries")){if(!Array.isArray(e.computedEntries))return"computedEntries: array expected";for(let t=0;t<e.computedEntries.length;++t){let i=s.CARTA.HeaderEntry.verify(e.computedEntries[t]);if(i)return"computedEntries."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.FileInfoExtended)return e;let t=new s.CARTA.FileInfoExtended;if(null!=e.dimensions&&(t.dimensions=0|e.dimensions),null!=e.width&&(t.width=0|e.width),null!=e.height&&(t.height=0|e.height),null!=e.depth&&(t.depth=0|e.depth),null!=e.stokes&&(t.stokes=0|e.stokes),e.stokesVals){if(!Array.isArray(e.stokesVals))throw TypeError(".CARTA.FileInfoExtended.stokesVals: array expected");t.stokesVals=[];for(let i=0;i<e.stokesVals.length;++i)t.stokesVals[i]=String(e.stokesVals[i])}if(e.headerEntries){if(!Array.isArray(e.headerEntries))throw TypeError(".CARTA.FileInfoExtended.headerEntries: array expected");t.headerEntries=[];for(let i=0;i<e.headerEntries.length;++i){if("object"!==typeof e.headerEntries[i])throw TypeError(".CARTA.FileInfoExtended.headerEntries: object expected");t.headerEntries[i]=s.CARTA.HeaderEntry.fromObject(e.headerEntries[i])}}if(e.computedEntries){if(!Array.isArray(e.computedEntries))throw TypeError(".CARTA.FileInfoExtended.computedEntries: array expected");t.computedEntries=[];for(let i=0;i<e.computedEntries.length;++i){if("object"!==typeof e.computedEntries[i])throw TypeError(".CARTA.FileInfoExtended.computedEntries: object expected");t.computedEntries[i]=s.CARTA.HeaderEntry.fromObject(e.computedEntries[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stokesVals=[],i.headerEntries=[],i.computedEntries=[]),t.defaults&&(i.dimensions=0,i.width=0,i.height=0,i.depth=0,i.stokes=0),null!=e.dimensions&&e.hasOwnProperty("dimensions")&&(i.dimensions=e.dimensions),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),null!=e.depth&&e.hasOwnProperty("depth")&&(i.depth=e.depth),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.stokesVals&&e.stokesVals.length){i.stokesVals=[];for(let t=0;t<e.stokesVals.length;++t)i.stokesVals[t]=e.stokesVals[t]}if(e.headerEntries&&e.headerEntries.length){i.headerEntries=[];for(let n=0;n<e.headerEntries.length;++n)i.headerEntries[n]=s.CARTA.HeaderEntry.toObject(e.headerEntries[n],t)}if(e.computedEntries&&e.computedEntries.length){i.computedEntries=[];for(let n=0;n<e.computedEntries.length;++n)i.computedEntries[n]=s.CARTA.HeaderEntry.toObject(e.computedEntries[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.HeaderEntry=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.value="",e.prototype.entryType=0,e.prototype.numericValue=0,e.prototype.comment="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.entryType&&Object.hasOwnProperty.call(e,"entryType")&&t.uint32(24).int32(e.entryType),null!=e.numericValue&&Object.hasOwnProperty.call(e,"numericValue")&&t.uint32(33).double(e.numericValue),null!=e.comment&&Object.hasOwnProperty.call(e,"comment")&&t.uint32(42).string(e.comment),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.HeaderEntry;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.value=e.string();break;case 3:n.entryType=e.int32();break;case 4:n.numericValue=e.double();break;case 5:n.comment=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name))return"name: string expected";if(null!=e.value&&e.hasOwnProperty("value")&&!a.isString(e.value))return"value: string expected";if(null!=e.entryType&&e.hasOwnProperty("entryType"))switch(e.entryType){default:return"entryType: enum value expected";case 0:case 1:case 2:}return null!=e.numericValue&&e.hasOwnProperty("numericValue")&&"number"!==typeof e.numericValue?"numericValue: number expected":null!=e.comment&&e.hasOwnProperty("comment")&&!a.isString(e.comment)?"comment: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.HeaderEntry)return e;let t=new s.CARTA.HeaderEntry;switch(null!=e.name&&(t.name=String(e.name)),null!=e.value&&(t.value=String(e.value)),e.entryType){case"STRING":case 0:t.entryType=0;break;case"FLOAT":case 1:t.entryType=1;break;case"INT":case 2:t.entryType=2}return null!=e.numericValue&&(t.numericValue=Number(e.numericValue)),null!=e.comment&&(t.comment=String(e.comment)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.name="",i.value="",i.entryType=t.enums===String?"STRING":0,i.numericValue=0,i.comment=""),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.value&&e.hasOwnProperty("value")&&(i.value=e.value),null!=e.entryType&&e.hasOwnProperty("entryType")&&(i.entryType=t.enums===String?s.CARTA.EntryType[e.entryType]:e.entryType),null!=e.numericValue&&e.hasOwnProperty("numericValue")&&(i.numericValue=t.json&&!isFinite(e.numericValue)?String(e.numericValue):e.numericValue),null!=e.comment&&e.hasOwnProperty("comment")&&(i.comment=e.comment),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.IntBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(13).sfixed32(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(21).sfixed32(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.IntBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.sfixed32();break;case 2:n.max=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&!a.isInteger(e.min)?"min: integer expected":null!=e.max&&e.hasOwnProperty("max")&&!a.isInteger(e.max)?"max: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.IntBounds)return e;let t=new s.CARTA.IntBounds;return null!=e.min&&(t.min=0|e.min),null!=e.max&&(t.max=0|e.max),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FloatBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(13).float(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(21).float(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FloatBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.float();break;case 2:n.max=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&"number"!==typeof e.min?"min: number expected":null!=e.max&&e.hasOwnProperty("max")&&"number"!==typeof e.max?"max: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.FloatBounds)return e;let t=new s.CARTA.FloatBounds;return null!=e.min&&(t.min=Number(e.min)),null!=e.max&&(t.max=Number(e.max)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=t.json&&!isFinite(e.min)?String(e.min):e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=t.json&&!isFinite(e.max)?String(e.max):e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.DoubleBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(9).double(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(17).double(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.DoubleBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.double();break;case 2:n.max=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&"number"!==typeof e.min?"min: number expected":null!=e.max&&e.hasOwnProperty("max")&&"number"!==typeof e.max?"max: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.DoubleBounds)return e;let t=new s.CARTA.DoubleBounds;return null!=e.min&&(t.min=Number(e.min)),null!=e.max&&(t.max=Number(e.max)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=t.json&&!isFinite(e.min)?String(e.min):e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=t.json&&!isFinite(e.max)?String(e.max):e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImageBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.xMin=0,e.prototype.xMax=0,e.prototype.yMin=0,e.prototype.yMax=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.xMin&&Object.hasOwnProperty.call(e,"xMin")&&t.uint32(13).sfixed32(e.xMin),null!=e.xMax&&Object.hasOwnProperty.call(e,"xMax")&&t.uint32(21).sfixed32(e.xMax),null!=e.yMin&&Object.hasOwnProperty.call(e,"yMin")&&t.uint32(29).sfixed32(e.yMin),null!=e.yMax&&Object.hasOwnProperty.call(e,"yMax")&&t.uint32(37).sfixed32(e.yMax),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ImageBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.xMin=e.sfixed32();break;case 2:n.xMax=e.sfixed32();break;case 3:n.yMin=e.sfixed32();break;case 4:n.yMax=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.xMin&&e.hasOwnProperty("xMin")&&!a.isInteger(e.xMin)?"xMin: integer expected":null!=e.xMax&&e.hasOwnProperty("xMax")&&!a.isInteger(e.xMax)?"xMax: integer expected":null!=e.yMin&&e.hasOwnProperty("yMin")&&!a.isInteger(e.yMin)?"yMin: integer expected":null!=e.yMax&&e.hasOwnProperty("yMax")&&!a.isInteger(e.yMax)?"yMax: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ImageBounds)return e;let t=new s.CARTA.ImageBounds;return null!=e.xMin&&(t.xMin=0|e.xMin),null!=e.xMax&&(t.xMax=0|e.xMax),null!=e.yMin&&(t.yMin=0|e.yMin),null!=e.yMax&&(t.yMax=0|e.yMax),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.xMin=0,i.xMax=0,i.yMin=0,i.yMax=0),null!=e.xMin&&e.hasOwnProperty("xMin")&&(i.xMin=e.xMin),null!=e.xMax&&e.hasOwnProperty("xMax")&&(i.xMax=e.xMax),null!=e.yMin&&e.hasOwnProperty("yMin")&&(i.yMin=e.yMin),null!=e.yMax&&e.hasOwnProperty("yMax")&&(i.yMax=e.yMax),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.AnimationFrame=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.stokes=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(21).sfixed32(e.stokes),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.AnimationFrame;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.stokes=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes)?"stokes: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.AnimationFrame)return e;let t=new s.CARTA.AnimationFrame;return null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.stokes=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpatialProfile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.start=0,e.prototype.end=0,e.prototype.rawValuesFp32=a.newBuffer([]),e.prototype.coordinate="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(13).sfixed32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(21).sfixed32(e.end),null!=e.rawValuesFp32&&Object.hasOwnProperty.call(e,"rawValuesFp32")&&t.uint32(26).bytes(e.rawValuesFp32),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(34).string(e.coordinate),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SpatialProfile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.start=e.sfixed32();break;case 2:n.end=e.sfixed32();break;case 3:n.rawValuesFp32=e.bytes();break;case 4:n.coordinate=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.start&&e.hasOwnProperty("start")&&!a.isInteger(e.start)?"start: integer expected":null!=e.end&&e.hasOwnProperty("end")&&!a.isInteger(e.end)?"end: integer expected":null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&!(e.rawValuesFp32&&"number"===typeof e.rawValuesFp32.length||a.isString(e.rawValuesFp32))?"rawValuesFp32: buffer expected":null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!a.isString(e.coordinate)?"coordinate: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SpatialProfile)return e;let t=new s.CARTA.SpatialProfile;return null!=e.start&&(t.start=0|e.start),null!=e.end&&(t.end=0|e.end),null!=e.rawValuesFp32&&("string"===typeof e.rawValuesFp32?a.base64.decode(e.rawValuesFp32,t.rawValuesFp32=a.newBuffer(a.base64.length(e.rawValuesFp32)),0):e.rawValuesFp32.length&&(t.rawValuesFp32=e.rawValuesFp32)),null!=e.coordinate&&(t.coordinate=String(e.coordinate)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.start=0,i.end=0,t.bytes===String?i.rawValuesFp32="":(i.rawValuesFp32=[],t.bytes!==Array&&(i.rawValuesFp32=a.newBuffer(i.rawValuesFp32))),i.coordinate=""),null!=e.start&&e.hasOwnProperty("start")&&(i.start=e.start),null!=e.end&&e.hasOwnProperty("end")&&(i.end=e.end),null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&(i.rawValuesFp32=t.bytes===String?a.base64.encode(e.rawValuesFp32,0,e.rawValuesFp32.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp32):e.rawValuesFp32),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralProfile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsType=0,e.prototype.rawValuesFp32=a.newBuffer([]),e.prototype.rawValuesFp64=a.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsType&&Object.hasOwnProperty.call(e,"statsType")&&t.uint32(16).int32(e.statsType),null!=e.rawValuesFp32&&Object.hasOwnProperty.call(e,"rawValuesFp32")&&t.uint32(26).bytes(e.rawValuesFp32),null!=e.rawValuesFp64&&Object.hasOwnProperty.call(e,"rawValuesFp64")&&t.uint32(34).bytes(e.rawValuesFp64),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SpectralProfile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:n.statsType=e.int32();break;case 3:n.rawValuesFp32=e.bytes();break;case 4:n.rawValuesFp64=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!a.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsType&&e.hasOwnProperty("statsType"))switch(e.statsType){default:return"statsType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}return null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&!(e.rawValuesFp32&&"number"===typeof e.rawValuesFp32.length||a.isString(e.rawValuesFp32))?"rawValuesFp32: buffer expected":null!=e.rawValuesFp64&&e.hasOwnProperty("rawValuesFp64")&&!(e.rawValuesFp64&&"number"===typeof e.rawValuesFp64.length||a.isString(e.rawValuesFp64))?"rawValuesFp64: buffer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SpectralProfile)return e;let t=new s.CARTA.SpectralProfile;switch(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsType){case"NumPixels":case 0:t.statsType=0;break;case"NanCount":case 1:t.statsType=1;break;case"Sum":case 2:t.statsType=2;break;case"FluxDensity":case 3:t.statsType=3;break;case"Mean":case 4:t.statsType=4;break;case"RMS":case 5:t.statsType=5;break;case"Sigma":case 6:t.statsType=6;break;case"SumSq":case 7:t.statsType=7;break;case"Min":case 8:t.statsType=8;break;case"Max":case 9:t.statsType=9;break;case"Extrema":case 10:t.statsType=10;break;case"Blc":case 11:t.statsType=11;break;case"Trc":case 12:t.statsType=12;break;case"MinPos":case 13:t.statsType=13;break;case"MaxPos":case 14:t.statsType=14;break;case"Blcf":case 15:t.statsType=15;break;case"Trcf":case 16:t.statsType=16;break;case"MinPosf":case 17:t.statsType=17;break;case"MaxPosf":case 18:t.statsType=18}return null!=e.rawValuesFp32&&("string"===typeof e.rawValuesFp32?a.base64.decode(e.rawValuesFp32,t.rawValuesFp32=a.newBuffer(a.base64.length(e.rawValuesFp32)),0):e.rawValuesFp32.length&&(t.rawValuesFp32=e.rawValuesFp32)),null!=e.rawValuesFp64&&("string"===typeof e.rawValuesFp64?a.base64.decode(e.rawValuesFp64,t.rawValuesFp64=a.newBuffer(a.base64.length(e.rawValuesFp64)),0):e.rawValuesFp64.length&&(t.rawValuesFp64=e.rawValuesFp64)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.coordinate="",i.statsType=t.enums===String?"NumPixels":0,t.bytes===String?i.rawValuesFp32="":(i.rawValuesFp32=[],t.bytes!==Array&&(i.rawValuesFp32=a.newBuffer(i.rawValuesFp32))),t.bytes===String?i.rawValuesFp64="":(i.rawValuesFp64=[],t.bytes!==Array&&(i.rawValuesFp64=a.newBuffer(i.rawValuesFp64)))),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),null!=e.statsType&&e.hasOwnProperty("statsType")&&(i.statsType=t.enums===String?s.CARTA.StatsType[e.statsType]:e.statsType),null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&(i.rawValuesFp32=t.bytes===String?a.base64.encode(e.rawValuesFp32,0,e.rawValuesFp32.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp32):e.rawValuesFp32),null!=e.rawValuesFp64&&e.hasOwnProperty("rawValuesFp64")&&(i.rawValuesFp64=t.bytes===String?a.base64.encode(e.rawValuesFp64,0,e.rawValuesFp64.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp64):e.rawValuesFp64),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StatisticsValue=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.statsType=0,e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.statsType&&Object.hasOwnProperty.call(e,"statsType")&&t.uint32(8).int32(e.statsType),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.StatisticsValue;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.statsType=e.int32();break;case 2:n.value=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.statsType&&e.hasOwnProperty("statsType"))switch(e.statsType){default:return"statsType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value?"value: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.StatisticsValue)return e;let t=new s.CARTA.StatisticsValue;switch(e.statsType){case"NumPixels":case 0:t.statsType=0;break;case"NanCount":case 1:t.statsType=1;break;case"Sum":case 2:t.statsType=2;break;case"FluxDensity":case 3:t.statsType=3;break;case"Mean":case 4:t.statsType=4;break;case"RMS":case 5:t.statsType=5;break;case"Sigma":case 6:t.statsType=6;break;case"SumSq":case 7:t.statsType=7;break;case"Min":case 8:t.statsType=8;break;case"Max":case 9:t.statsType=9;break;case"Extrema":case 10:t.statsType=10;break;case"Blc":case 11:t.statsType=11;break;case"Trc":case 12:t.statsType=12;break;case"MinPos":case 13:t.statsType=13;break;case"MaxPos":case 14:t.statsType=14;break;case"Blcf":case 15:t.statsType=15;break;case"Trcf":case 16:t.statsType=16;break;case"MinPosf":case 17:t.statsType=17;break;case"MaxPosf":case 18:t.statsType=18}return null!=e.value&&(t.value=Number(e.value)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.statsType=t.enums===String?"NumPixels":0,i.value=0),null!=e.statsType&&e.hasOwnProperty("statsType")&&(i.statsType=t.enums===String?s.CARTA.StatsType[e.statsType]:e.statsType),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Histogram=function(){function e(e){if(this.bins=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.numBins=0,e.prototype.binWidth=0,e.prototype.firstBinCenter=0,e.prototype.bins=a.emptyArray,e.prototype.mean=0,e.prototype.stdDev=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.numBins&&Object.hasOwnProperty.call(e,"numBins")&&t.uint32(21).sfixed32(e.numBins),null!=e.binWidth&&Object.hasOwnProperty.call(e,"binWidth")&&t.uint32(25).double(e.binWidth),null!=e.firstBinCenter&&Object.hasOwnProperty.call(e,"firstBinCenter")&&t.uint32(33).double(e.firstBinCenter),null!=e.bins&&e.bins.length){t.uint32(42).fork();for(let i=0;i<e.bins.length;++i)t.sfixed32(e.bins[i]);t.ldelim()}return null!=e.mean&&Object.hasOwnProperty.call(e,"mean")&&t.uint32(49).double(e.mean),null!=e.stdDev&&Object.hasOwnProperty.call(e,"stdDev")&&t.uint32(57).double(e.stdDev),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.Histogram;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.numBins=e.sfixed32();break;case 3:n.binWidth=e.double();break;case 4:n.firstBinCenter=e.double();break;case 5:if(n.bins&&n.bins.length||(n.bins=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.bins.push(e.sfixed32())}else n.bins.push(e.sfixed32());break;case 6:n.mean=e.double();break;case 7:n.stdDev=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.numBins&&e.hasOwnProperty("numBins")&&!a.isInteger(e.numBins))return"numBins: integer expected";if(null!=e.binWidth&&e.hasOwnProperty("binWidth")&&"number"!==typeof e.binWidth)return"binWidth: number expected";if(null!=e.firstBinCenter&&e.hasOwnProperty("firstBinCenter")&&"number"!==typeof e.firstBinCenter)return"firstBinCenter: number expected";if(null!=e.bins&&e.hasOwnProperty("bins")){if(!Array.isArray(e.bins))return"bins: array expected";for(let t=0;t<e.bins.length;++t)if(!a.isInteger(e.bins[t]))return"bins: integer[] expected"}return null!=e.mean&&e.hasOwnProperty("mean")&&"number"!==typeof e.mean?"mean: number expected":null!=e.stdDev&&e.hasOwnProperty("stdDev")&&"number"!==typeof e.stdDev?"stdDev: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.Histogram)return e;let t=new s.CARTA.Histogram;if(null!=e.channel&&(t.channel=0|e.channel),null!=e.numBins&&(t.numBins=0|e.numBins),null!=e.binWidth&&(t.binWidth=Number(e.binWidth)),null!=e.firstBinCenter&&(t.firstBinCenter=Number(e.firstBinCenter)),e.bins){if(!Array.isArray(e.bins))throw TypeError(".CARTA.Histogram.bins: array expected");t.bins=[];for(let i=0;i<e.bins.length;++i)t.bins[i]=0|e.bins[i]}return null!=e.mean&&(t.mean=Number(e.mean)),null!=e.stdDev&&(t.stdDev=Number(e.stdDev)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.bins=[]),t.defaults&&(i.channel=0,i.numBins=0,i.binWidth=0,i.firstBinCenter=0,i.mean=0,i.stdDev=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.numBins&&e.hasOwnProperty("numBins")&&(i.numBins=e.numBins),null!=e.binWidth&&e.hasOwnProperty("binWidth")&&(i.binWidth=t.json&&!isFinite(e.binWidth)?String(e.binWidth):e.binWidth),null!=e.firstBinCenter&&e.hasOwnProperty("firstBinCenter")&&(i.firstBinCenter=t.json&&!isFinite(e.firstBinCenter)?String(e.firstBinCenter):e.firstBinCenter),e.bins&&e.bins.length){i.bins=[];for(let t=0;t<e.bins.length;++t)i.bins[t]=e.bins[t]}return null!=e.mean&&e.hasOwnProperty("mean")&&(i.mean=t.json&&!isFinite(e.mean)?String(e.mean):e.mean),null!=e.stdDev&&e.hasOwnProperty("stdDev")&&(i.stdDev=t.json&&!isFinite(e.stdDev)?String(e.stdDev):e.stdDev),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionInfo=function(){function e(e){if(this.controlPoints=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.regionType=0,e.prototype.controlPoints=a.emptyArray,e.prototype.rotation=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.regionType&&Object.hasOwnProperty.call(e,"regionType")&&t.uint32(8).int32(e.regionType),null!=e.controlPoints&&e.controlPoints.length)for(let i=0;i<e.controlPoints.length;++i)s.CARTA.Point.encode(e.controlPoints[i],t.uint32(18).fork()).ldelim();return null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(29).float(e.rotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.regionType=e.int32();break;case 2:n.controlPoints&&n.controlPoints.length||(n.controlPoints=[]),n.controlPoints.push(s.CARTA.Point.decode(e,e.uint32()));break;case 3:n.rotation=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.regionType&&e.hasOwnProperty("regionType"))switch(e.regionType){default:return"regionType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.controlPoints&&e.hasOwnProperty("controlPoints")){if(!Array.isArray(e.controlPoints))return"controlPoints: array expected";for(let t=0;t<e.controlPoints.length;++t){let i=s.CARTA.Point.verify(e.controlPoints[t]);if(i)return"controlPoints."+i}}return null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!==typeof e.rotation?"rotation: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionInfo)return e;let t=new s.CARTA.RegionInfo;switch(e.regionType){case"POINT":case 0:t.regionType=0;break;case"LINE":case 1:t.regionType=1;break;case"POLYLINE":case 2:t.regionType=2;break;case"RECTANGLE":case 3:t.regionType=3;break;case"ELLIPSE":case 4:t.regionType=4;break;case"ANNULUS":case 5:t.regionType=5;break;case"POLYGON":case 6:t.regionType=6}if(e.controlPoints){if(!Array.isArray(e.controlPoints))throw TypeError(".CARTA.RegionInfo.controlPoints: array expected");t.controlPoints=[];for(let i=0;i<e.controlPoints.length;++i){if("object"!==typeof e.controlPoints[i])throw TypeError(".CARTA.RegionInfo.controlPoints: object expected");t.controlPoints[i]=s.CARTA.Point.fromObject(e.controlPoints[i])}}return null!=e.rotation&&(t.rotation=Number(e.rotation)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.controlPoints=[]),t.defaults&&(i.regionType=t.enums===String?"POINT":0,i.rotation=0),null!=e.regionType&&e.hasOwnProperty("regionType")&&(i.regionType=t.enums===String?s.CARTA.RegionType[e.regionType]:e.regionType),e.controlPoints&&e.controlPoints.length){i.controlPoints=[];for(let n=0;n<e.controlPoints.length;++n)i.controlPoints[n]=s.CARTA.Point.toObject(e.controlPoints[n],t)}return null!=e.rotation&&e.hasOwnProperty("rotation")&&(i.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionStyle=function(){function e(e){if(this.dashList=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.color="",e.prototype.lineWidth=0,e.prototype.dashList=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(18).string(e.color),null!=e.lineWidth&&Object.hasOwnProperty.call(e,"lineWidth")&&t.uint32(29).sfixed32(e.lineWidth),null!=e.dashList&&e.dashList.length){t.uint32(34).fork();for(let i=0;i<e.dashList.length;++i)t.sfixed32(e.dashList[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionStyle;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.color=e.string();break;case 3:n.lineWidth=e.sfixed32();break;case 4:if(n.dashList&&n.dashList.length||(n.dashList=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.dashList.push(e.sfixed32())}else n.dashList.push(e.sfixed32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name))return"name: string expected";if(null!=e.color&&e.hasOwnProperty("color")&&!a.isString(e.color))return"color: string expected";if(null!=e.lineWidth&&e.hasOwnProperty("lineWidth")&&!a.isInteger(e.lineWidth))return"lineWidth: integer expected";if(null!=e.dashList&&e.hasOwnProperty("dashList")){if(!Array.isArray(e.dashList))return"dashList: array expected";for(let t=0;t<e.dashList.length;++t)if(!a.isInteger(e.dashList[t]))return"dashList: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionStyle)return e;let t=new s.CARTA.RegionStyle;if(null!=e.name&&(t.name=String(e.name)),null!=e.color&&(t.color=String(e.color)),null!=e.lineWidth&&(t.lineWidth=0|e.lineWidth),e.dashList){if(!Array.isArray(e.dashList))throw TypeError(".CARTA.RegionStyle.dashList: array expected");t.dashList=[];for(let i=0;i<e.dashList.length;++i)t.dashList[i]=0|e.dashList[i]}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.dashList=[]),t.defaults&&(i.name="",i.color="",i.lineWidth=0),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.color&&e.hasOwnProperty("color")&&(i.color=e.color),null!=e.lineWidth&&e.hasOwnProperty("lineWidth")&&(i.lineWidth=e.lineWidth),e.dashList&&e.dashList.length){i.dashList=[];for(let t=0;t<e.dashList.length;++t)i.dashList[t]=e.dashList[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFileInfo=function(){function e(e){if(this.coosys=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.type=0,e.prototype.fileSize=a.Long?a.Long.fromBits(0,0,!1):0,e.prototype.description="",e.prototype.coosys=a.emptyArray,e.prototype.date=a.Long?a.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.fileSize&&Object.hasOwnProperty.call(e,"fileSize")&&t.uint32(25).sfixed64(e.fileSize),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(34).string(e.description),null!=e.coosys&&e.coosys.length)for(let i=0;i<e.coosys.length;++i)s.CARTA.Coosys.encode(e.coosys[i],t.uint32(42).fork()).ldelim();return null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(49).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogFileInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.type=e.int32();break;case 3:n.fileSize=e.sfixed64();break;case 4:n.description=e.string();break;case 5:n.coosys&&n.coosys.length||(n.coosys=[]),n.coosys.push(s.CARTA.Coosys.decode(e,e.uint32()));break;case 6:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:}if(null!=e.fileSize&&e.hasOwnProperty("fileSize")&&!a.isInteger(e.fileSize)&&!(e.fileSize&&a.isInteger(e.fileSize.low)&&a.isInteger(e.fileSize.high)))return"fileSize: integer|Long expected";if(null!=e.description&&e.hasOwnProperty("description")&&!a.isString(e.description))return"description: string expected";if(null!=e.coosys&&e.hasOwnProperty("coosys")){if(!Array.isArray(e.coosys))return"coosys: array expected";for(let t=0;t<e.coosys.length;++t){let i=s.CARTA.Coosys.verify(e.coosys[t]);if(i)return"coosys."+i}}return null==e.date||!e.hasOwnProperty("date")||a.isInteger(e.date)||e.date&&a.isInteger(e.date.low)&&a.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogFileInfo)return e;let t=new s.CARTA.CatalogFileInfo;switch(null!=e.name&&(t.name=String(e.name)),e.type){case"FITSTable":case 0:t.type=0;break;case"VOTable":case 1:t.type=1}if(null!=e.fileSize&&(a.Long?(t.fileSize=a.Long.fromValue(e.fileSize)).unsigned=!1:"string"===typeof e.fileSize?t.fileSize=parseInt(e.fileSize,10):"number"===typeof e.fileSize?t.fileSize=e.fileSize:"object"===typeof e.fileSize&&(t.fileSize=new a.LongBits(e.fileSize.low>>>0,e.fileSize.high>>>0).toNumber())),null!=e.description&&(t.description=String(e.description)),e.coosys){if(!Array.isArray(e.coosys))throw TypeError(".CARTA.CatalogFileInfo.coosys: array expected");t.coosys=[];for(let i=0;i<e.coosys.length;++i){if("object"!==typeof e.coosys[i])throw TypeError(".CARTA.CatalogFileInfo.coosys: object expected");t.coosys[i]=s.CARTA.Coosys.fromObject(e.coosys[i])}}return null!=e.date&&(a.Long?(t.date=a.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new a.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.coosys=[]),t.defaults){if(i.name="",i.type=t.enums===String?"FITSTable":0,a.Long){let e=new a.Long(0,0,!1);i.fileSize=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.fileSize=t.longs===String?"0":0;if(i.description="",a.Long){let e=new a.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0}if(null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?s.CARTA.CatalogFileType[e.type]:e.type),null!=e.fileSize&&e.hasOwnProperty("fileSize")&&("number"===typeof e.fileSize?i.fileSize=t.longs===String?String(e.fileSize):e.fileSize:i.fileSize=t.longs===String?a.Long.prototype.toString.call(e.fileSize):t.longs===Number?new a.LongBits(e.fileSize.low>>>0,e.fileSize.high>>>0).toNumber():e.fileSize),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),e.coosys&&e.coosys.length){i.coosys=[];for(let n=0;n<e.coosys.length;++n)i.coosys[n]=s.CARTA.Coosys.toObject(e.coosys[n],t)}return null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?a.Long.prototype.toString.call(e.date):t.longs===Number?new a.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Coosys=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.equinox="",e.prototype.epoch="",e.prototype.system="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.equinox&&Object.hasOwnProperty.call(e,"equinox")&&t.uint32(10).string(e.equinox),null!=e.epoch&&Object.hasOwnProperty.call(e,"epoch")&&t.uint32(18).string(e.epoch),null!=e.system&&Object.hasOwnProperty.call(e,"system")&&t.uint32(26).string(e.system),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.Coosys;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.equinox=e.string();break;case 2:n.epoch=e.string();break;case 3:n.system=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.equinox&&e.hasOwnProperty("equinox")&&!a.isString(e.equinox)?"equinox: string expected":null!=e.epoch&&e.hasOwnProperty("epoch")&&!a.isString(e.epoch)?"epoch: string expected":null!=e.system&&e.hasOwnProperty("system")&&!a.isString(e.system)?"system: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.Coosys)return e;let t=new s.CARTA.Coosys;return null!=e.equinox&&(t.equinox=String(e.equinox)),null!=e.epoch&&(t.epoch=String(e.epoch)),null!=e.system&&(t.system=String(e.system)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.equinox="",i.epoch="",i.system=""),null!=e.equinox&&e.hasOwnProperty("equinox")&&(i.equinox=e.equinox),null!=e.epoch&&e.hasOwnProperty("epoch")&&(i.epoch=e.epoch),null!=e.system&&e.hasOwnProperty("system")&&(i.system=e.system),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogHeader=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.dataType=0,e.prototype.columnIndex=0,e.prototype.description="",e.prototype.units="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.columnIndex&&Object.hasOwnProperty.call(e,"columnIndex")&&t.uint32(29).sfixed32(e.columnIndex),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(42).string(e.description),null!=e.units&&Object.hasOwnProperty.call(e,"units")&&t.uint32(50).string(e.units),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogHeader;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.dataType=e.int32();break;case 3:n.columnIndex=e.sfixed32();break;case 5:n.description=e.string();break;case 6:n.units=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name))return"name: string expected";if(null!=e.dataType&&e.hasOwnProperty("dataType"))switch(e.dataType){default:return"dataType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}return null!=e.columnIndex&&e.hasOwnProperty("columnIndex")&&!a.isInteger(e.columnIndex)?"columnIndex: integer expected":null!=e.description&&e.hasOwnProperty("description")&&!a.isString(e.description)?"description: string expected":null!=e.units&&e.hasOwnProperty("units")&&!a.isString(e.units)?"units: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogHeader)return e;let t=new s.CARTA.CatalogHeader;switch(null!=e.name&&(t.name=String(e.name)),e.dataType){case"UnsupportedType":case 0:t.dataType=0;break;case"String":case 1:t.dataType=1;break;case"Uint8":case 2:t.dataType=2;break;case"Int8":case 3:t.dataType=3;break;case"Uint16":case 4:t.dataType=4;break;case"Int16":case 5:t.dataType=5;break;case"Uint32":case 6:t.dataType=6;break;case"Int32":case 7:t.dataType=7;break;case"Uint64":case 8:t.dataType=8;break;case"Int64":case 9:t.dataType=9;break;case"Float":case 10:t.dataType=10;break;case"Double":case 11:t.dataType=11;break;case"Bool":case 12:t.dataType=12}return null!=e.columnIndex&&(t.columnIndex=0|e.columnIndex),null!=e.description&&(t.description=String(e.description)),null!=e.units&&(t.units=String(e.units)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.name="",i.dataType=t.enums===String?"UnsupportedType":0,i.columnIndex=0,i.description="",i.units=""),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.dataType&&e.hasOwnProperty("dataType")&&(i.dataType=t.enums===String?s.CARTA.ColumnType[e.dataType]:e.dataType),null!=e.columnIndex&&e.hasOwnProperty("columnIndex")&&(i.columnIndex=e.columnIndex),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),null!=e.units&&e.hasOwnProperty("units")&&(i.units=e.units),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ColumnData=function(){function e(e){if(this.stringData=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dataType=0,e.prototype.stringData=a.emptyArray,e.prototype.binaryData=a.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(8).int32(e.dataType),null!=e.stringData&&e.stringData.length)for(let i=0;i<e.stringData.length;++i)t.uint32(18).string(e.stringData[i]);return null!=e.binaryData&&Object.hasOwnProperty.call(e,"binaryData")&&t.uint32(26).bytes(e.binaryData),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ColumnData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.dataType=e.int32();break;case 2:n.stringData&&n.stringData.length||(n.stringData=[]),n.stringData.push(e.string());break;case 3:n.binaryData=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.dataType&&e.hasOwnProperty("dataType"))switch(e.dataType){default:return"dataType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(let t=0;t<e.stringData.length;++t)if(!a.isString(e.stringData[t]))return"stringData: string[] expected"}return null!=e.binaryData&&e.hasOwnProperty("binaryData")&&!(e.binaryData&&"number"===typeof e.binaryData.length||a.isString(e.binaryData))?"binaryData: buffer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ColumnData)return e;let t=new s.CARTA.ColumnData;switch(e.dataType){case"UnsupportedType":case 0:t.dataType=0;break;case"String":case 1:t.dataType=1;break;case"Uint8":case 2:t.dataType=2;break;case"Int8":case 3:t.dataType=3;break;case"Uint16":case 4:t.dataType=4;break;case"Int16":case 5:t.dataType=5;break;case"Uint32":case 6:t.dataType=6;break;case"Int32":case 7:t.dataType=7;break;case"Uint64":case 8:t.dataType=8;break;case"Int64":case 9:t.dataType=9;break;case"Float":case 10:t.dataType=10;break;case"Double":case 11:t.dataType=11;break;case"Bool":case 12:t.dataType=12}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".CARTA.ColumnData.stringData: array expected");t.stringData=[];for(let i=0;i<e.stringData.length;++i)t.stringData[i]=String(e.stringData[i])}return null!=e.binaryData&&("string"===typeof e.binaryData?a.base64.decode(e.binaryData,t.binaryData=a.newBuffer(a.base64.length(e.binaryData)),0):e.binaryData.length&&(t.binaryData=e.binaryData)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stringData=[]),t.defaults&&(i.dataType=t.enums===String?"UnsupportedType":0,t.bytes===String?i.binaryData="":(i.binaryData=[],t.bytes!==Array&&(i.binaryData=a.newBuffer(i.binaryData)))),null!=e.dataType&&e.hasOwnProperty("dataType")&&(i.dataType=t.enums===String?s.CARTA.ColumnType[e.dataType]:e.dataType),e.stringData&&e.stringData.length){i.stringData=[];for(let t=0;t<e.stringData.length;++t)i.stringData[t]=e.stringData[t]}return null!=e.binaryData&&e.hasOwnProperty("binaryData")&&(i.binaryData=t.bytes===String?a.base64.encode(e.binaryData,0,e.binaryData.length):t.bytes===Array?Array.prototype.slice.call(e.binaryData):e.binaryData),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FilterConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.columnName="",e.prototype.comparisonOperator=0,e.prototype.value=0,e.prototype.secondaryValue=0,e.prototype.subString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.columnName&&Object.hasOwnProperty.call(e,"columnName")&&t.uint32(10).string(e.columnName),null!=e.comparisonOperator&&Object.hasOwnProperty.call(e,"comparisonOperator")&&t.uint32(16).int32(e.comparisonOperator),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(25).double(e.value),null!=e.secondaryValue&&Object.hasOwnProperty.call(e,"secondaryValue")&&t.uint32(33).double(e.secondaryValue),null!=e.subString&&Object.hasOwnProperty.call(e,"subString")&&t.uint32(42).string(e.subString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FilterConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.columnName=e.string();break;case 2:n.comparisonOperator=e.int32();break;case 3:n.value=e.double();break;case 4:n.secondaryValue=e.double();break;case 5:n.subString=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.columnName&&e.hasOwnProperty("columnName")&&!a.isString(e.columnName))return"columnName: string expected";if(null!=e.comparisonOperator&&e.hasOwnProperty("comparisonOperator"))switch(e.comparisonOperator){default:return"comparisonOperator: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value?"value: number expected":null!=e.secondaryValue&&e.hasOwnProperty("secondaryValue")&&"number"!==typeof e.secondaryValue?"secondaryValue: number expected":null!=e.subString&&e.hasOwnProperty("subString")&&!a.isString(e.subString)?"subString: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.FilterConfig)return e;let t=new s.CARTA.FilterConfig;switch(null!=e.columnName&&(t.columnName=String(e.columnName)),e.comparisonOperator){case"Equal":case 0:t.comparisonOperator=0;break;case"NotEqual":case 1:t.comparisonOperator=1;break;case"Lesser":case 2:t.comparisonOperator=2;break;case"Greater":case 3:t.comparisonOperator=3;break;case"LessorOrEqual":case 4:t.comparisonOperator=4;break;case"GreaterOrEqual":case 5:t.comparisonOperator=5;break;case"RangeOpen":case 6:t.comparisonOperator=6;break;case"RangeClosed":case 7:t.comparisonOperator=7}return null!=e.value&&(t.value=Number(e.value)),null!=e.secondaryValue&&(t.secondaryValue=Number(e.secondaryValue)),null!=e.subString&&(t.subString=String(e.subString)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.columnName="",i.comparisonOperator=t.enums===String?"Equal":0,i.value=0,i.secondaryValue=0,i.subString=""),null!=e.columnName&&e.hasOwnProperty("columnName")&&(i.columnName=e.columnName),null!=e.comparisonOperator&&e.hasOwnProperty("comparisonOperator")&&(i.comparisonOperator=t.enums===String?s.CARTA.ComparisonOperator[e.comparisonOperator]:e.comparisonOperator),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),null!=e.secondaryValue&&e.hasOwnProperty("secondaryValue")&&(i.secondaryValue=t.json&&!isFinite(e.secondaryValue)?String(e.secondaryValue):e.secondaryValue),null!=e.subString&&e.hasOwnProperty("subString")&&(i.subString=e.subString),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogImageBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.xColumnName="",e.prototype.yColumnName="",e.prototype.imageBounds=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.xColumnName&&Object.hasOwnProperty.call(e,"xColumnName")&&t.uint32(10).string(e.xColumnName),null!=e.yColumnName&&Object.hasOwnProperty.call(e,"yColumnName")&&t.uint32(18).string(e.yColumnName),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&s.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogImageBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.xColumnName=e.string();break;case 2:n.yColumnName=e.string();break;case 3:n.imageBounds=s.CARTA.ImageBounds.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.xColumnName&&e.hasOwnProperty("xColumnName")&&!a.isString(e.xColumnName))return"xColumnName: string expected";if(null!=e.yColumnName&&e.hasOwnProperty("yColumnName")&&!a.isString(e.yColumnName))return"yColumnName: string expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=s.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogImageBounds)return e;let t=new s.CARTA.CatalogImageBounds;if(null!=e.xColumnName&&(t.xColumnName=String(e.xColumnName)),null!=e.yColumnName&&(t.yColumnName=String(e.yColumnName)),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.CatalogImageBounds.imageBounds: object expected");t.imageBounds=s.CARTA.ImageBounds.fromObject(e.imageBounds)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.xColumnName="",i.yColumnName="",i.imageBounds=null),null!=e.xColumnName&&e.hasOwnProperty("xColumnName")&&(i.xColumnName=e.xColumnName),null!=e.yColumnName&&e.hasOwnProperty("yColumnName")&&(i.yColumnName=e.yColumnName),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=s.CARTA.ImageBounds.toObject(e.imageBounds,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MatchedFrameList=function(){function e(e){if(this.frameNumbers=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.frameNumbers=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.frameNumbers&&e.frameNumbers.length){t.uint32(10).fork();for(let i=0;i<e.frameNumbers.length;++i)t.float(e.frameNumbers[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.MatchedFrameList;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:if(n.frameNumbers&&n.frameNumbers.length||(n.frameNumbers=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.frameNumbers.push(e.float())}else n.frameNumbers.push(e.float());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.frameNumbers&&e.hasOwnProperty("frameNumbers")){if(!Array.isArray(e.frameNumbers))return"frameNumbers: array expected";for(let t=0;t<e.frameNumbers.length;++t)if("number"!==typeof e.frameNumbers[t])return"frameNumbers: number[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.MatchedFrameList)return e;let t=new s.CARTA.MatchedFrameList;if(e.frameNumbers){if(!Array.isArray(e.frameNumbers))throw TypeError(".CARTA.MatchedFrameList.frameNumbers: array expected");t.frameNumbers=[];for(let i=0;i<e.frameNumbers.length;++i)t.frameNumbers[i]=Number(e.frameNumbers[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.frameNumbers=[]),e.frameNumbers&&e.frameNumbers.length){i.frameNumbers=[];for(let n=0;n<e.frameNumbers.length;++n)i.frameNumbers[n]=t.json&&!isFinite(e.frameNumbers[n])?String(e.frameNumbers[n]):e.frameNumbers[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Beam=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.stokes=0,e.prototype.majorAxis=0,e.prototype.minorAxis=0,e.prototype.pa=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(21).sfixed32(e.stokes),null!=e.majorAxis&&Object.hasOwnProperty.call(e,"majorAxis")&&t.uint32(29).float(e.majorAxis),null!=e.minorAxis&&Object.hasOwnProperty.call(e,"minorAxis")&&t.uint32(37).float(e.minorAxis),null!=e.pa&&Object.hasOwnProperty.call(e,"pa")&&t.uint32(45).float(e.pa),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.Beam;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.stokes=e.sfixed32();break;case 3:n.majorAxis=e.float();break;case 4:n.minorAxis=e.float();break;case 5:n.pa=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes)?"stokes: integer expected":null!=e.majorAxis&&e.hasOwnProperty("majorAxis")&&"number"!==typeof e.majorAxis?"majorAxis: number expected":null!=e.minorAxis&&e.hasOwnProperty("minorAxis")&&"number"!==typeof e.minorAxis?"minorAxis: number expected":null!=e.pa&&e.hasOwnProperty("pa")&&"number"!==typeof e.pa?"pa: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.Beam)return e;let t=new s.CARTA.Beam;return null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.majorAxis&&(t.majorAxis=Number(e.majorAxis)),null!=e.minorAxis&&(t.minorAxis=Number(e.minorAxis)),null!=e.pa&&(t.pa=Number(e.pa)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.stokes=0,i.majorAxis=0,i.minorAxis=0,i.pa=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.majorAxis&&e.hasOwnProperty("majorAxis")&&(i.majorAxis=t.json&&!isFinite(e.majorAxis)?String(e.majorAxis):e.majorAxis),null!=e.minorAxis&&e.hasOwnProperty("minorAxis")&&(i.minorAxis=t.json&&!isFinite(e.minorAxis)?String(e.minorAxis):e.minorAxis),null!=e.pa&&e.hasOwnProperty("pa")&&(i.pa=t.json&&!isFinite(e.pa)?String(e.pa):e.pa),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.EventType=function(){const e={},t=Object.create(e);return t[e[0]="EMPTY_EVENT"]=0,t[e[1]="REGISTER_VIEWER"]=1,t[e[2]="FILE_LIST_REQUEST"]=2,t[e[3]="FILE_INFO_REQUEST"]=3,t[e[4]="OPEN_FILE"]=4,t[e[6]="SET_IMAGE_CHANNELS"]=6,t[e[7]="SET_CURSOR"]=7,t[e[8]="SET_SPATIAL_REQUIREMENTS"]=8,t[e[9]="SET_HISTOGRAM_REQUIREMENTS"]=9,t[e[10]="SET_STATS_REQUIREMENTS"]=10,t[e[11]="SET_REGION"]=11,t[e[12]="REMOVE_REGION"]=12,t[e[13]="CLOSE_FILE"]=13,t[e[14]="SET_SPECTRAL_REQUIREMENTS"]=14,t[e[15]="START_ANIMATION"]=15,t[e[16]="START_ANIMATION_ACK"]=16,t[e[17]="STOP_ANIMATION"]=17,t[e[18]="REGISTER_VIEWER_ACK"]=18,t[e[19]="FILE_LIST_RESPONSE"]=19,t[e[20]="FILE_INFO_RESPONSE"]=20,t[e[21]="OPEN_FILE_ACK"]=21,t[e[22]="SET_REGION_ACK"]=22,t[e[23]="REGION_HISTOGRAM_DATA"]=23,t[e[25]="SPATIAL_PROFILE_DATA"]=25,t[e[26]="SPECTRAL_PROFILE_DATA"]=26,t[e[27]="REGION_STATS_DATA"]=27,t[e[28]="ERROR_DATA"]=28,t[e[29]="ANIMATION_FLOW_CONTROL"]=29,t[e[30]="ADD_REQUIRED_TILES"]=30,t[e[31]="REMOVE_REQUIRED_TILES"]=31,t[e[32]="RASTER_TILE_DATA"]=32,t[e[33]="REGION_LIST_REQUEST"]=33,t[e[34]="REGION_LIST_RESPONSE"]=34,t[e[35]="REGION_FILE_INFO_REQUEST"]=35,t[e[36]="REGION_FILE_INFO_RESPONSE"]=36,t[e[37]="IMPORT_REGION"]=37,t[e[38]="IMPORT_REGION_ACK"]=38,t[e[39]="EXPORT_REGION"]=39,t[e[40]="EXPORT_REGION_ACK"]=40,t[e[45]="SET_CONTOUR_PARAMETERS"]=45,t[e[46]="CONTOUR_IMAGE_DATA"]=46,t[e[47]="RESUME_SESSION"]=47,t[e[48]="RESUME_SESSION_ACK"]=48,t[e[49]="RASTER_TILE_SYNC"]=49,t[e[50]="CATALOG_LIST_REQUEST"]=50,t[e[51]="CATALOG_LIST_RESPONSE"]=51,t[e[52]="CATALOG_FILE_INFO_REQUEST"]=52,t[e[53]="CATALOG_FILE_INFO_RESPONSE"]=53,t[e[54]="OPEN_CATALOG_FILE"]=54,t[e[55]="OPEN_CATALOG_FILE_ACK"]=55,t[e[56]="CLOSE_CATALOG_FILE"]=56,t[e[57]="CATALOG_FILTER_REQUEST"]=57,t[e[58]="CATALOG_FILTER_RESPONSE"]=58,t[e[59]="SCRIPTING_REQUEST"]=59,t[e[60]="SCRIPTING_RESPONSE"]=60,t[e[61]="MOMENT_REQUEST"]=61,t[e[62]="MOMENT_RESPONSE"]=62,t[e[63]="MOMENT_PROGRESS"]=63,t[e[64]="STOP_MOMENT_CALC"]=64,t[e[65]="SAVE_FILE"]=65,t[e[66]="SAVE_FILE_ACK"]=66,t[e[67]="SPECTRAL_LINE_REQUEST"]=67,t[e[68]="SPECTRAL_LINE_RESPONSE"]=68,t}(),e.SessionType=function(){const e={},t=Object.create(e);return t[e[0]="NEW"]=0,t[e[1]="RESUMED"]=1,t}(),e.FileType=function(){const e={},t=Object.create(e);return t[e[0]="CASA"]=0,t[e[1]="CRTF"]=1,t[e[2]="DS9_REG"]=2,t[e[3]="FITS"]=3,t[e[4]="HDF5"]=4,t[e[5]="MIRIAD"]=5,t[e[6]="UNKNOWN"]=6,t}(),e.RenderMode=function(){const e={},t=Object.create(e);return t[e[0]="RASTER"]=0,t[e[1]="CONTOUR"]=1,t}(),e.CompressionType=function(){const e={},t=Object.create(e);return t[e[0]="NONE"]=0,t[e[1]="ZFP"]=1,t[e[2]="SZ"]=2,t}(),e.RegionType=function(){const e={},t=Object.create(e);return t[e[0]="POINT"]=0,t[e[1]="LINE"]=1,t[e[2]="POLYLINE"]=2,t[e[3]="RECTANGLE"]=3,t[e[4]="ELLIPSE"]=4,t[e[5]="ANNULUS"]=5,t[e[6]="POLYGON"]=6,t}(),e.SmoothingMode=function(){const e={},t=Object.create(e);return t[e[0]="NoSmoothing"]=0,t[e[1]="BlockAverage"]=1,t[e[2]="GaussianBlur"]=2,t}(),e.StatsType=function(){const e={},t=Object.create(e);return t[e[0]="NumPixels"]=0,t[e[1]="NanCount"]=1,t[e[2]="Sum"]=2,t[e[3]="FluxDensity"]=3,t[e[4]="Mean"]=4,t[e[5]="RMS"]=5,t[e[6]="Sigma"]=6,t[e[7]="SumSq"]=7,t[e[8]="Min"]=8,t[e[9]="Max"]=9,t[e[10]="Extrema"]=10,t[e[11]="Blc"]=11,t[e[12]="Trc"]=12,t[e[13]="MinPos"]=13,t[e[14]="MaxPos"]=14,t[e[15]="Blcf"]=15,t[e[16]="Trcf"]=16,t[e[17]="MinPosf"]=17,t[e[18]="MaxPosf"]=18,t}(),e.ErrorSeverity=function(){const e={},t=Object.create(e);return t[e[0]="DEBUG"]=0,t[e[1]="INFO"]=1,t[e[2]="WARNING"]=2,t[e[3]="ERROR"]=3,t[e[4]="CRITICAL"]=4,t}(),e.EntryType=function(){const e={},t=Object.create(e);return t[e[0]="STRING"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t}(),e.ClientFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="CLIENT_FEATURE_NONE"]=0,t[e[1]="WEB_GL"]=1,t[e[2]="WEB_GL_2"]=2,t[e[4]="WEB_ASSEMBLY"]=4,t[e[8]="WEB_ASSEMBLY_THREADS"]=8,t[e[16]="OFFSCREEN_CANVAS"]=16,t}(),e.ServerFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="SERVER_FEATURE_NONE"]=0,t[e[1]="SZ_COMPRESSION"]=1,t[e[2]="HEVC_COMPRESSION"]=2,t[e[4]="NVENC_COMPRESSION"]=4,t[e[8]="REGION_WRITE_ACCESS"]=8,t[e[16]="USER_PREFERENCES"]=16,t[e[32]="USER_LAYOUTS"]=32,t[e[64]="GRPC_SCRIPTING"]=64,t}(),e.FileFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="FILE_FEATURE_NONE"]=0,t[e[1]="ROTATED_DATASET"]=1,t[e[2]="CHANNEL_HISTOGRAMS"]=2,t[e[4]="CUBE_HISTOGRAMS"]=4,t[e[8]="CHANNEL_STATS"]=8,t[e[16]="MEAN_IMAGE"]=16,t[e[32]="MIP_DATASET"]=32,t}(),e.CoordinateType=function(){const e={},t=Object.create(e);return t[e[0]="PIXEL"]=0,t[e[1]="WORLD"]=1,t}(),e.CatalogFileType=function(){const e={},t=Object.create(e);return t[e[0]="FITSTable"]=0,t[e[1]="VOTable"]=1,t}(),e.ColumnType=function(){const e={},t=Object.create(e);return t[e[0]="UnsupportedType"]=0,t[e[1]="String"]=1,t[e[2]="Uint8"]=2,t[e[3]="Int8"]=3,t[e[4]="Uint16"]=4,t[e[5]="Int16"]=5,t[e[6]="Uint32"]=6,t[e[7]="Int32"]=7,t[e[8]="Uint64"]=8,t[e[9]="Int64"]=9,t[e[10]="Float"]=10,t[e[11]="Double"]=11,t[e[12]="Bool"]=12,t}(),e.ComparisonOperator=function(){const e={},t=Object.create(e);return t[e[0]="Equal"]=0,t[e[1]="NotEqual"]=1,t[e[2]="Lesser"]=2,t[e[3]="Greater"]=3,t[e[4]="LessorOrEqual"]=4,t[e[5]="GreaterOrEqual"]=5,t[e[6]="RangeOpen"]=6,t[e[7]="RangeClosed"]=7,t}(),e.SortingType=function(){const e={},t=Object.create(e);return t[e[0]="Ascending"]=0,t[e[1]="Descending"]=1,t}(),e.Moment=function(){const e={},t=Object.create(e);return t[e[0]="MEAN_OF_THE_SPECTRUM"]=0,t[e[1]="INTEGRATED_OF_THE_SPECTRUM"]=1,t[e[2]="INTENSITY_WEIGHTED_COORD"]=2,t[e[3]="INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD"]=3,t[e[4]="MEDIAN_OF_THE_SPECTRUM"]=4,t[e[5]="MEDIAN_COORDINATE"]=5,t[e[6]="STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM"]=6,t[e[7]="RMS_OF_THE_SPECTRUM"]=7,t[e[8]="ABS_MEAN_DEVIATION_OF_THE_SPECTRUM"]=8,t[e[9]="MAX_OF_THE_SPECTRUM"]=9,t[e[10]="COORD_OF_THE_MAX_OF_THE_SPECTRUM"]=10,t[e[11]="MIN_OF_THE_SPECTRUM"]=11,t[e[12]="COORD_OF_THE_MIN_OF_THE_SPECTRUM"]=12,t}(),e.MomentAxis=function(){const e={},t=Object.create(e);return t[e[0]="SPECTRAL"]=0,t[e[1]="STOKES"]=1,t}(),e.MomentMask=function(){const e={},t=Object.create(e);return t[e[0]="None"]=0,t[e[1]="Include"]=1,t[e[2]="Exclude"]=2,t}(),e.StartAnimation=function(){function e(e){if(this.matchedFrames={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.firstFrame=null,e.prototype.startFrame=null,e.prototype.lastFrame=null,e.prototype.deltaFrame=null,e.prototype.frameRate=0,e.prototype.looping=!1,e.prototype.reverse=!1,e.prototype.requiredTiles=null,e.prototype.matchedFrames=a.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.firstFrame&&Object.hasOwnProperty.call(e,"firstFrame")&&s.CARTA.AnimationFrame.encode(e.firstFrame,t.uint32(18).fork()).ldelim(),null!=e.startFrame&&Object.hasOwnProperty.call(e,"startFrame")&&s.CARTA.AnimationFrame.encode(e.startFrame,t.uint32(26).fork()).ldelim(),null!=e.lastFrame&&Object.hasOwnProperty.call(e,"lastFrame")&&s.CARTA.AnimationFrame.encode(e.lastFrame,t.uint32(34).fork()).ldelim(),null!=e.deltaFrame&&Object.hasOwnProperty.call(e,"deltaFrame")&&s.CARTA.AnimationFrame.encode(e.deltaFrame,t.uint32(42).fork()).ldelim(),null!=e.frameRate&&Object.hasOwnProperty.call(e,"frameRate")&&t.uint32(53).sfixed32(e.frameRate),null!=e.looping&&Object.hasOwnProperty.call(e,"looping")&&t.uint32(56).bool(e.looping),null!=e.reverse&&Object.hasOwnProperty.call(e,"reverse")&&t.uint32(64).bool(e.reverse),null!=e.requiredTiles&&Object.hasOwnProperty.call(e,"requiredTiles")&&s.CARTA.AddRequiredTiles.encode(e.requiredTiles,t.uint32(74).fork()).ldelim(),null!=e.matchedFrames&&Object.hasOwnProperty.call(e,"matchedFrames"))for(let i=Object.keys(e.matchedFrames),n=0;n<i.length;++n)t.uint32(82).fork().uint32(13).sfixed32(i[n]),s.CARTA.MatchedFrameList.encode(e.matchedFrames[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.StartAnimation;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.fileId=e.sfixed32();break;case 2:o.firstFrame=s.CARTA.AnimationFrame.decode(e,e.uint32());break;case 3:o.startFrame=s.CARTA.AnimationFrame.decode(e,e.uint32());break;case 4:o.lastFrame=s.CARTA.AnimationFrame.decode(e,e.uint32());break;case 5:o.deltaFrame=s.CARTA.AnimationFrame.decode(e,e.uint32());break;case 6:o.frameRate=e.sfixed32();break;case 7:o.looping=e.bool();break;case 8:o.reverse=e.bool();break;case 9:o.requiredTiles=s.CARTA.AddRequiredTiles.decode(e,e.uint32());break;case 10:e.skip().pos++,o.matchedFrames===a.emptyObject&&(o.matchedFrames={}),i=e.sfixed32(),e.pos++,o.matchedFrames[i]=s.CARTA.MatchedFrameList.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.firstFrame&&e.hasOwnProperty("firstFrame")){let t=s.CARTA.AnimationFrame.verify(e.firstFrame);if(t)return"firstFrame."+t}if(null!=e.startFrame&&e.hasOwnProperty("startFrame")){let t=s.CARTA.AnimationFrame.verify(e.startFrame);if(t)return"startFrame."+t}if(null!=e.lastFrame&&e.hasOwnProperty("lastFrame")){let t=s.CARTA.AnimationFrame.verify(e.lastFrame);if(t)return"lastFrame."+t}if(null!=e.deltaFrame&&e.hasOwnProperty("deltaFrame")){let t=s.CARTA.AnimationFrame.verify(e.deltaFrame);if(t)return"deltaFrame."+t}if(null!=e.frameRate&&e.hasOwnProperty("frameRate")&&!a.isInteger(e.frameRate))return"frameRate: integer expected";if(null!=e.looping&&e.hasOwnProperty("looping")&&"boolean"!==typeof e.looping)return"looping: boolean expected";if(null!=e.reverse&&e.hasOwnProperty("reverse")&&"boolean"!==typeof e.reverse)return"reverse: boolean expected";if(null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")){let t=s.CARTA.AddRequiredTiles.verify(e.requiredTiles);if(t)return"requiredTiles."+t}if(null!=e.matchedFrames&&e.hasOwnProperty("matchedFrames")){if(!a.isObject(e.matchedFrames))return"matchedFrames: object expected";let t=Object.keys(e.matchedFrames);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"matchedFrames: integer key{k:sfixed32} expected";{let n=s.CARTA.MatchedFrameList.verify(e.matchedFrames[t[i]]);if(n)return"matchedFrames."+n}}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.StartAnimation)return e;let t=new s.CARTA.StartAnimation;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.firstFrame){if("object"!==typeof e.firstFrame)throw TypeError(".CARTA.StartAnimation.firstFrame: object expected");t.firstFrame=s.CARTA.AnimationFrame.fromObject(e.firstFrame)}if(null!=e.startFrame){if("object"!==typeof e.startFrame)throw TypeError(".CARTA.StartAnimation.startFrame: object expected");t.startFrame=s.CARTA.AnimationFrame.fromObject(e.startFrame)}if(null!=e.lastFrame){if("object"!==typeof e.lastFrame)throw TypeError(".CARTA.StartAnimation.lastFrame: object expected");t.lastFrame=s.CARTA.AnimationFrame.fromObject(e.lastFrame)}if(null!=e.deltaFrame){if("object"!==typeof e.deltaFrame)throw TypeError(".CARTA.StartAnimation.deltaFrame: object expected");t.deltaFrame=s.CARTA.AnimationFrame.fromObject(e.deltaFrame)}if(null!=e.frameRate&&(t.frameRate=0|e.frameRate),null!=e.looping&&(t.looping=Boolean(e.looping)),null!=e.reverse&&(t.reverse=Boolean(e.reverse)),null!=e.requiredTiles){if("object"!==typeof e.requiredTiles)throw TypeError(".CARTA.StartAnimation.requiredTiles: object expected");t.requiredTiles=s.CARTA.AddRequiredTiles.fromObject(e.requiredTiles)}if(e.matchedFrames){if("object"!==typeof e.matchedFrames)throw TypeError(".CARTA.StartAnimation.matchedFrames: object expected");t.matchedFrames={};for(let i=Object.keys(e.matchedFrames),n=0;n<i.length;++n){if("object"!==typeof e.matchedFrames[i[n]])throw TypeError(".CARTA.StartAnimation.matchedFrames: object expected");t.matchedFrames[i[n]]=s.CARTA.MatchedFrameList.fromObject(e.matchedFrames[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.matchedFrames={}),t.defaults&&(n.fileId=0,n.firstFrame=null,n.startFrame=null,n.lastFrame=null,n.deltaFrame=null,n.frameRate=0,n.looping=!1,n.reverse=!1,n.requiredTiles=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.firstFrame&&e.hasOwnProperty("firstFrame")&&(n.firstFrame=s.CARTA.AnimationFrame.toObject(e.firstFrame,t)),null!=e.startFrame&&e.hasOwnProperty("startFrame")&&(n.startFrame=s.CARTA.AnimationFrame.toObject(e.startFrame,t)),null!=e.lastFrame&&e.hasOwnProperty("lastFrame")&&(n.lastFrame=s.CARTA.AnimationFrame.toObject(e.lastFrame,t)),null!=e.deltaFrame&&e.hasOwnProperty("deltaFrame")&&(n.deltaFrame=s.CARTA.AnimationFrame.toObject(e.deltaFrame,t)),null!=e.frameRate&&e.hasOwnProperty("frameRate")&&(n.frameRate=e.frameRate),null!=e.looping&&e.hasOwnProperty("looping")&&(n.looping=e.looping),null!=e.reverse&&e.hasOwnProperty("reverse")&&(n.reverse=e.reverse),null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")&&(n.requiredTiles=s.CARTA.AddRequiredTiles.toObject(e.requiredTiles,t)),e.matchedFrames&&(i=Object.keys(e.matchedFrames)).length){n.matchedFrames={};for(let r=0;r<i.length;++r)n.matchedFrames[i[r]]=s.CARTA.MatchedFrameList.toObject(e.matchedFrames[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StartAnimationAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.animationId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(29).sfixed32(e.animationId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.StartAnimationAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.animationId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null!=e.animationId&&e.hasOwnProperty("animationId")&&!a.isInteger(e.animationId)?"animationId: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.StartAnimationAck)return e;let t=new s.CARTA.StartAnimationAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.animationId&&(t.animationId=0|e.animationId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.animationId=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.AnimationFlowControl=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.receivedFrame=null,e.prototype.animationId=0,e.prototype.timestamp=a.Long?a.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.receivedFrame&&Object.hasOwnProperty.call(e,"receivedFrame")&&s.CARTA.AnimationFrame.encode(e.receivedFrame,t.uint32(18).fork()).ldelim(),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(29).sfixed32(e.animationId),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(33).sfixed64(e.timestamp),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.AnimationFlowControl;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.receivedFrame=s.CARTA.AnimationFrame.decode(e,e.uint32());break;case 3:n.animationId=e.sfixed32();break;case 4:n.timestamp=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.receivedFrame&&e.hasOwnProperty("receivedFrame")){let t=s.CARTA.AnimationFrame.verify(e.receivedFrame);if(t)return"receivedFrame."+t}return null!=e.animationId&&e.hasOwnProperty("animationId")&&!a.isInteger(e.animationId)?"animationId: integer expected":null==e.timestamp||!e.hasOwnProperty("timestamp")||a.isInteger(e.timestamp)||e.timestamp&&a.isInteger(e.timestamp.low)&&a.isInteger(e.timestamp.high)?null:"timestamp: integer|Long expected"},e.fromObject=function(e){if(e instanceof s.CARTA.AnimationFlowControl)return e;let t=new s.CARTA.AnimationFlowControl;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.receivedFrame){if("object"!==typeof e.receivedFrame)throw TypeError(".CARTA.AnimationFlowControl.receivedFrame: object expected");t.receivedFrame=s.CARTA.AnimationFrame.fromObject(e.receivedFrame)}return null!=e.animationId&&(t.animationId=0|e.animationId),null!=e.timestamp&&(a.Long?(t.timestamp=a.Long.fromValue(e.timestamp)).unsigned=!1:"string"===typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"===typeof e.timestamp?t.timestamp=e.timestamp:"object"===typeof e.timestamp&&(t.timestamp=new a.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if(t.defaults)if(i.fileId=0,i.receivedFrame=null,i.animationId=0,a.Long){let e=new a.Long(0,0,!1);i.timestamp=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.timestamp=t.longs===String?"0":0;return null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.receivedFrame&&e.hasOwnProperty("receivedFrame")&&(i.receivedFrame=s.CARTA.AnimationFrame.toObject(e.receivedFrame,t)),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"===typeof e.timestamp?i.timestamp=t.longs===String?String(e.timestamp):e.timestamp:i.timestamp=t.longs===String?a.Long.prototype.toString.call(e.timestamp):t.longs===Number?new a.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StopAnimation=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.endFrame=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.endFrame&&Object.hasOwnProperty.call(e,"endFrame")&&s.CARTA.AnimationFrame.encode(e.endFrame,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.StopAnimation;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.endFrame=s.CARTA.AnimationFrame.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.endFrame&&e.hasOwnProperty("endFrame")){let t=s.CARTA.AnimationFrame.verify(e.endFrame);if(t)return"endFrame."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.StopAnimation)return e;let t=new s.CARTA.StopAnimation;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.endFrame){if("object"!==typeof e.endFrame)throw TypeError(".CARTA.StopAnimation.endFrame: object expected");t.endFrame=s.CARTA.AnimationFrame.fromObject(e.endFrame)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.endFrame=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.endFrame&&e.hasOwnProperty("endFrame")&&(i.endFrame=s.CARTA.AnimationFrame.toObject(e.endFrame,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.AddRequiredTiles=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.tiles=a.emptyArray,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.tiles&&e.tiles.length){t.uint32(18).fork();for(let i=0;i<e.tiles.length;++i)t.sfixed32(e.tiles[i]);t.ldelim()}return null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(24).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(37).float(e.compressionQuality),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.AddRequiredTiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.tiles&&n.tiles.length||(n.tiles=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.tiles.push(e.sfixed32())}else n.tiles.push(e.sfixed32());break;case 3:n.compressionType=e.int32();break;case 4:n.compressionQuality=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t)if(!a.isInteger(e.tiles[t]))return"tiles: integer[] expected"}if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}return null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality?"compressionQuality: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.AddRequiredTiles)return e;let t=new s.CARTA.AddRequiredTiles;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.AddRequiredTiles.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i)t.tiles[i]=0|e.tiles[i]}switch(e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}return null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.tiles&&e.tiles.length){i.tiles=[];for(let t=0;t<e.tiles.length;++t)i.tiles[t]=e.tiles[t]}return null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?s.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RemoveRequiredTiles=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.tiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.tiles&&e.tiles.length){t.uint32(18).fork();for(let i=0;i<e.tiles.length;++i)t.sfixed32(e.tiles[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RemoveRequiredTiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.tiles&&n.tiles.length||(n.tiles=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.tiles.push(e.sfixed32())}else n.tiles.push(e.sfixed32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t)if(!a.isInteger(e.tiles[t]))return"tiles: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.RemoveRequiredTiles)return e;let t=new s.CARTA.RemoveRequiredTiles;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.RemoveRequiredTiles.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i)t.tiles[i]=0|e.tiles[i]}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.tiles&&e.tiles.length){i.tiles=[];for(let t=0;t<e.tiles.length;++t)i.tiles[t]=e.tiles[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CloseFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CloseFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.CloseFile)return e;let t=new s.CARTA.CloseFile;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetContourParameters=function(){function e(e){if(this.levels=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.referenceFileId=0,e.prototype.imageBounds=null,e.prototype.levels=a.emptyArray,e.prototype.smoothingMode=0,e.prototype.smoothingFactor=0,e.prototype.decimationFactor=0,e.prototype.compressionLevel=0,e.prototype.contourChunkSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).fixed32(e.fileId),null!=e.referenceFileId&&Object.hasOwnProperty.call(e,"referenceFileId")&&t.uint32(21).fixed32(e.referenceFileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&s.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.levels&&e.levels.length){t.uint32(34).fork();for(let i=0;i<e.levels.length;++i)t.double(e.levels[i]);t.ldelim()}return null!=e.smoothingMode&&Object.hasOwnProperty.call(e,"smoothingMode")&&t.uint32(40).int32(e.smoothingMode),null!=e.smoothingFactor&&Object.hasOwnProperty.call(e,"smoothingFactor")&&t.uint32(48).int32(e.smoothingFactor),null!=e.decimationFactor&&Object.hasOwnProperty.call(e,"decimationFactor")&&t.uint32(56).int32(e.decimationFactor),null!=e.compressionLevel&&Object.hasOwnProperty.call(e,"compressionLevel")&&t.uint32(64).int32(e.compressionLevel),null!=e.contourChunkSize&&Object.hasOwnProperty.call(e,"contourChunkSize")&&t.uint32(72).int32(e.contourChunkSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetContourParameters;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.fixed32();break;case 2:n.referenceFileId=e.fixed32();break;case 3:n.imageBounds=s.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:if(n.levels&&n.levels.length||(n.levels=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.levels.push(e.double())}else n.levels.push(e.double());break;case 5:n.smoothingMode=e.int32();break;case 6:n.smoothingFactor=e.int32();break;case 7:n.decimationFactor=e.int32();break;case 8:n.compressionLevel=e.int32();break;case 9:n.contourChunkSize=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&!a.isInteger(e.referenceFileId))return"referenceFileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=s.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.levels&&e.hasOwnProperty("levels")){if(!Array.isArray(e.levels))return"levels: array expected";for(let t=0;t<e.levels.length;++t)if("number"!==typeof e.levels[t])return"levels: number[] expected"}if(null!=e.smoothingMode&&e.hasOwnProperty("smoothingMode"))switch(e.smoothingMode){default:return"smoothingMode: enum value expected";case 0:case 1:case 2:}return null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&!a.isInteger(e.smoothingFactor)?"smoothingFactor: integer expected":null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&!a.isInteger(e.decimationFactor)?"decimationFactor: integer expected":null!=e.compressionLevel&&e.hasOwnProperty("compressionLevel")&&!a.isInteger(e.compressionLevel)?"compressionLevel: integer expected":null!=e.contourChunkSize&&e.hasOwnProperty("contourChunkSize")&&!a.isInteger(e.contourChunkSize)?"contourChunkSize: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SetContourParameters)return e;let t=new s.CARTA.SetContourParameters;if(null!=e.fileId&&(t.fileId=e.fileId>>>0),null!=e.referenceFileId&&(t.referenceFileId=e.referenceFileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.SetContourParameters.imageBounds: object expected");t.imageBounds=s.CARTA.ImageBounds.fromObject(e.imageBounds)}if(e.levels){if(!Array.isArray(e.levels))throw TypeError(".CARTA.SetContourParameters.levels: array expected");t.levels=[];for(let i=0;i<e.levels.length;++i)t.levels[i]=Number(e.levels[i])}switch(e.smoothingMode){case"NoSmoothing":case 0:t.smoothingMode=0;break;case"BlockAverage":case 1:t.smoothingMode=1;break;case"GaussianBlur":case 2:t.smoothingMode=2}return null!=e.smoothingFactor&&(t.smoothingFactor=0|e.smoothingFactor),null!=e.decimationFactor&&(t.decimationFactor=0|e.decimationFactor),null!=e.compressionLevel&&(t.compressionLevel=0|e.compressionLevel),null!=e.contourChunkSize&&(t.contourChunkSize=0|e.contourChunkSize),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.levels=[]),t.defaults&&(i.fileId=0,i.referenceFileId=0,i.imageBounds=null,i.smoothingMode=t.enums===String?"NoSmoothing":0,i.smoothingFactor=0,i.decimationFactor=0,i.compressionLevel=0,i.contourChunkSize=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&(i.referenceFileId=e.referenceFileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=s.CARTA.ImageBounds.toObject(e.imageBounds,t)),e.levels&&e.levels.length){i.levels=[];for(let n=0;n<e.levels.length;++n)i.levels[n]=t.json&&!isFinite(e.levels[n])?String(e.levels[n]):e.levels[n]}return null!=e.smoothingMode&&e.hasOwnProperty("smoothingMode")&&(i.smoothingMode=t.enums===String?s.CARTA.SmoothingMode[e.smoothingMode]:e.smoothingMode),null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&(i.smoothingFactor=e.smoothingFactor),null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&(i.decimationFactor=e.decimationFactor),null!=e.compressionLevel&&e.hasOwnProperty("compressionLevel")&&(i.compressionLevel=e.compressionLevel),null!=e.contourChunkSize&&e.hasOwnProperty("contourChunkSize")&&(i.contourChunkSize=e.contourChunkSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ExportRegion=function(){function e(e){if(this.regionStyles={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=0,e.prototype.coordType=0,e.prototype.fileId=0,e.prototype.regionStyles=a.emptyObject,e.prototype.directory="",e.prototype.file="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.coordType&&Object.hasOwnProperty.call(e,"coordType")&&t.uint32(16).int32(e.coordType),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.regionStyles&&Object.hasOwnProperty.call(e,"regionStyles"))for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).sfixed32(i[n]),s.CARTA.RegionStyle.encode(e.regionStyles[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(42).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(50).string(e.file),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.ExportRegion;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.type=e.int32();break;case 2:o.coordType=e.int32();break;case 3:o.fileId=e.sfixed32();break;case 4:e.skip().pos++,o.regionStyles===a.emptyObject&&(o.regionStyles={}),i=e.sfixed32(),e.pos++,o.regionStyles[i]=s.CARTA.RegionStyle.decode(e,e.uint32());break;case 5:o.directory=e.string();break;case 6:o.file=e.string();break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.coordType&&e.hasOwnProperty("coordType"))switch(e.coordType){default:return"coordType: enum value expected";case 0:case 1:}if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionStyles&&e.hasOwnProperty("regionStyles")){if(!a.isObject(e.regionStyles))return"regionStyles: object expected";let t=Object.keys(e.regionStyles);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"regionStyles: integer key{k:sfixed32} expected";{let n=s.CARTA.RegionStyle.verify(e.regionStyles[t[i]]);if(n)return"regionStyles."+n}}}return null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!a.isString(e.file)?"file: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ExportRegion)return e;let t=new s.CARTA.ExportRegion;switch(e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}switch(e.coordType){case"PIXEL":case 0:t.coordType=0;break;case"WORLD":case 1:t.coordType=1}if(null!=e.fileId&&(t.fileId=0|e.fileId),e.regionStyles){if("object"!==typeof e.regionStyles)throw TypeError(".CARTA.ExportRegion.regionStyles: object expected");t.regionStyles={};for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n){if("object"!==typeof e.regionStyles[i[n]])throw TypeError(".CARTA.ExportRegion.regionStyles: object expected");t.regionStyles[i[n]]=s.CARTA.RegionStyle.fromObject(e.regionStyles[i[n]])}}return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regionStyles={}),t.defaults&&(n.type=t.enums===String?"CASA":0,n.coordType=t.enums===String?"PIXEL":0,n.fileId=0,n.directory="",n.file=""),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?s.CARTA.FileType[e.type]:e.type),null!=e.coordType&&e.hasOwnProperty("coordType")&&(n.coordType=t.enums===String?s.CARTA.CoordinateType[e.coordType]:e.coordType),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),e.regionStyles&&(i=Object.keys(e.regionStyles)).length){n.regionStyles={};for(let r=0;r<i.length;++r)n.regionStyles[i[r]]=s.CARTA.RegionStyle.toObject(e.regionStyles[i[r]],t)}return null!=e.directory&&e.hasOwnProperty("directory")&&(n.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(n.file=e.file),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ExportRegionAck=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.contents=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(26).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ExportRegionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!a.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.ExportRegionAck)return e;let t=new s.CARTA.ExportRegionAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.ExportRegionAck.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImportRegion=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.groupId=0,e.prototype.type=0,e.prototype.directory="",e.prototype.file="",e.prototype.contents=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(13).sfixed32(e.groupId),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(34).string(e.file),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(42).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ImportRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.groupId=e.sfixed32();break;case 2:n.type=e.int32();break;case 3:n.directory=e.string();break;case 4:n.file=e.string();break;case 5:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!a.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!a.isString(e.file))return"file: string expected";if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!a.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.ImportRegion)return e;let t=new s.CARTA.ImportRegion;switch(null!=e.groupId&&(t.groupId=0|e.groupId),e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}if(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.ImportRegion.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.groupId=0,i.type=t.enums===String?"CASA":0,i.directory="",i.file=""),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?s.CARTA.FileType[e.type]:e.type),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImportRegionAck=function(){function e(e){if(this.regions={},this.regionStyles={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.regions=a.emptyObject,e.prototype.regionStyles=a.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.regions&&Object.hasOwnProperty.call(e,"regions"))for(let i=Object.keys(e.regions),n=0;n<i.length;++n)t.uint32(26).fork().uint32(13).sfixed32(i[n]),s.CARTA.RegionInfo.encode(e.regions[i[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.regionStyles&&Object.hasOwnProperty.call(e,"regionStyles"))for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).sfixed32(i[n]),s.CARTA.RegionStyle.encode(e.regionStyles[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.ImportRegionAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:e.skip().pos++,o.regions===a.emptyObject&&(o.regions={}),i=e.sfixed32(),e.pos++,o.regions[i]=s.CARTA.RegionInfo.decode(e,e.uint32());break;case 4:e.skip().pos++,o.regionStyles===a.emptyObject&&(o.regionStyles={}),i=e.sfixed32(),e.pos++,o.regionStyles[i]=s.CARTA.RegionStyle.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.regions&&e.hasOwnProperty("regions")){if(!a.isObject(e.regions))return"regions: object expected";let t=Object.keys(e.regions);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"regions: integer key{k:sfixed32} expected";{let n=s.CARTA.RegionInfo.verify(e.regions[t[i]]);if(n)return"regions."+n}}}if(null!=e.regionStyles&&e.hasOwnProperty("regionStyles")){if(!a.isObject(e.regionStyles))return"regionStyles: object expected";let t=Object.keys(e.regionStyles);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"regionStyles: integer key{k:sfixed32} expected";{let n=s.CARTA.RegionStyle.verify(e.regionStyles[t[i]]);if(n)return"regionStyles."+n}}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.ImportRegionAck)return e;let t=new s.CARTA.ImportRegionAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.regions){if("object"!==typeof e.regions)throw TypeError(".CARTA.ImportRegionAck.regions: object expected");t.regions={};for(let i=Object.keys(e.regions),n=0;n<i.length;++n){if("object"!==typeof e.regions[i[n]])throw TypeError(".CARTA.ImportRegionAck.regions: object expected");t.regions[i[n]]=s.CARTA.RegionInfo.fromObject(e.regions[i[n]])}}if(e.regionStyles){if("object"!==typeof e.regionStyles)throw TypeError(".CARTA.ImportRegionAck.regionStyles: object expected");t.regionStyles={};for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n){if("object"!==typeof e.regionStyles[i[n]])throw TypeError(".CARTA.ImportRegionAck.regionStyles: object expected");t.regionStyles[i[n]]=s.CARTA.RegionStyle.fromObject(e.regionStyles[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regions={},n.regionStyles={}),t.defaults&&(n.success=!1,n.message=""),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),e.regions&&(i=Object.keys(e.regions)).length){n.regions={};for(let r=0;r<i.length;++r)n.regions[i[r]]=s.CARTA.RegionInfo.toObject(e.regions[i[r]],t)}if(e.regionStyles&&(i=Object.keys(e.regionStyles)).length){n.regionStyles={};for(let r=0;r<i.length;++r)n.regionStyles[i[r]]=s.CARTA.RegionStyle.toObject(e.regionStyles[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenCatalogFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.name="",e.prototype.fileId=0,e.prototype.previewDataSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.previewDataSize&&Object.hasOwnProperty.call(e,"previewDataSize")&&t.uint32(37).sfixed32(e.previewDataSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.OpenCatalogFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.name=e.string();break;case 3:n.fileId=e.sfixed32();break;case 4:n.previewDataSize=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name)?"name: string expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null!=e.previewDataSize&&e.hasOwnProperty("previewDataSize")&&!a.isInteger(e.previewDataSize)?"previewDataSize: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.OpenCatalogFile)return e;let t=new s.CARTA.OpenCatalogFile;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.name&&(t.name=String(e.name)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.previewDataSize&&(t.previewDataSize=0|e.previewDataSize),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.name="",i.fileId=0,i.previewDataSize=0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.previewDataSize&&e.hasOwnProperty("previewDataSize")&&(i.previewDataSize=e.previewDataSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenCatalogFileAck=function(){function e(e){if(this.headers=[],this.previewData={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileId=0,e.prototype.fileInfo=null,e.prototype.dataSize=0,e.prototype.headers=a.emptyArray,e.prototype.previewData=a.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&s.CARTA.CatalogFileInfo.encode(e.fileInfo,t.uint32(34).fork()).ldelim(),null!=e.dataSize&&Object.hasOwnProperty.call(e,"dataSize")&&t.uint32(45).sfixed32(e.dataSize),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)s.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(50).fork()).ldelim();if(null!=e.previewData&&Object.hasOwnProperty.call(e,"previewData"))for(let i=Object.keys(e.previewData),n=0;n<i.length;++n)t.uint32(58).fork().uint32(13).fixed32(i[n]),s.CARTA.ColumnData.encode(e.previewData[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.OpenCatalogFileAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:o.fileId=e.sfixed32();break;case 4:o.fileInfo=s.CARTA.CatalogFileInfo.decode(e,e.uint32());break;case 5:o.dataSize=e.sfixed32();break;case 6:o.headers&&o.headers.length||(o.headers=[]),o.headers.push(s.CARTA.CatalogHeader.decode(e,e.uint32()));break;case 7:e.skip().pos++,o.previewData===a.emptyObject&&(o.previewData={}),i=e.fixed32(),e.pos++,o.previewData[i]=s.CARTA.ColumnData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=s.CARTA.CatalogFileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.dataSize&&e.hasOwnProperty("dataSize")&&!a.isInteger(e.dataSize))return"dataSize: integer expected";if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=s.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}if(null!=e.previewData&&e.hasOwnProperty("previewData")){if(!a.isObject(e.previewData))return"previewData: object expected";let t=Object.keys(e.previewData);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"previewData: integer key{k:fixed32} expected";{let n=s.CARTA.ColumnData.verify(e.previewData[t[i]]);if(n)return"previewData."+n}}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.OpenCatalogFileAck)return e;let t=new s.CARTA.OpenCatalogFileAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.OpenCatalogFileAck.fileInfo: object expected");t.fileInfo=s.CARTA.CatalogFileInfo.fromObject(e.fileInfo)}if(null!=e.dataSize&&(t.dataSize=0|e.dataSize),e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.OpenCatalogFileAck.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.OpenCatalogFileAck.headers: object expected");t.headers[i]=s.CARTA.CatalogHeader.fromObject(e.headers[i])}}if(e.previewData){if("object"!==typeof e.previewData)throw TypeError(".CARTA.OpenCatalogFileAck.previewData: object expected");t.previewData={};for(let i=Object.keys(e.previewData),n=0;n<i.length;++n){if("object"!==typeof e.previewData[i[n]])throw TypeError(".CARTA.OpenCatalogFileAck.previewData: object expected");t.previewData[i[n]]=s.CARTA.ColumnData.fromObject(e.previewData[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.headers=[]),(t.objects||t.defaults)&&(n.previewData={}),t.defaults&&(n.success=!1,n.message="",n.fileId=0,n.fileInfo=null,n.dataSize=0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(n.fileInfo=s.CARTA.CatalogFileInfo.toObject(e.fileInfo,t)),null!=e.dataSize&&e.hasOwnProperty("dataSize")&&(n.dataSize=e.dataSize),e.headers&&e.headers.length){n.headers=[];for(let i=0;i<e.headers.length;++i)n.headers[i]=s.CARTA.CatalogHeader.toObject(e.headers[i],t)}if(e.previewData&&(i=Object.keys(e.previewData)).length){n.previewData={};for(let r=0;r<i.length;++r)n.previewData[i[r]]=s.CARTA.ColumnData.toObject(e.previewData[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CloseCatalogFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CloseCatalogFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.CloseCatalogFile)return e;let t=new s.CARTA.CloseCatalogFile;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.fileId=0,e.prototype.renderMode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(37).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(40).int32(e.renderMode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.OpenFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;case 4:n.fileId=e.sfixed32();break;case 5:n.renderMode=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!a.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!a.isString(e.hdu))return"hdu: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof s.CARTA.OpenFile)return e;let t=new s.CARTA.OpenFile;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu="",i.fileId=0,i.renderMode=t.enums===String?"RASTER":0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(i.renderMode=t.enums===String?s.CARTA.RenderMode[e.renderMode]:e.renderMode),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenFileAck=function(){function e(e){if(this.beamTable=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.fileId=0,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.fileInfoExtended=null,e.prototype.fileFeatureFlags=0,e.prototype.beamTable=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(21).sfixed32(e.fileId),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&s.CARTA.FileInfo.encode(e.fileInfo,t.uint32(34).fork()).ldelim(),null!=e.fileInfoExtended&&Object.hasOwnProperty.call(e,"fileInfoExtended")&&s.CARTA.FileInfoExtended.encode(e.fileInfoExtended,t.uint32(42).fork()).ldelim(),null!=e.fileFeatureFlags&&Object.hasOwnProperty.call(e,"fileFeatureFlags")&&t.uint32(53).fixed32(e.fileFeatureFlags),null!=e.beamTable&&e.beamTable.length)for(let i=0;i<e.beamTable.length;++i)s.CARTA.Beam.encode(e.beamTable[i],t.uint32(58).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.OpenFileAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.fileId=e.sfixed32();break;case 3:n.message=e.string();break;case 4:n.fileInfo=s.CARTA.FileInfo.decode(e,e.uint32());break;case 5:n.fileInfoExtended=s.CARTA.FileInfoExtended.decode(e,e.uint32());break;case 6:n.fileFeatureFlags=e.fixed32();break;case 7:n.beamTable&&n.beamTable.length||(n.beamTable=[]),n.beamTable.push(s.CARTA.Beam.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=s.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")){let t=s.CARTA.FileInfoExtended.verify(e.fileInfoExtended);if(t)return"fileInfoExtended."+t}if(null!=e.fileFeatureFlags&&e.hasOwnProperty("fileFeatureFlags")&&!a.isInteger(e.fileFeatureFlags))return"fileFeatureFlags: integer expected";if(null!=e.beamTable&&e.hasOwnProperty("beamTable")){if(!Array.isArray(e.beamTable))return"beamTable: array expected";for(let t=0;t<e.beamTable.length;++t){let i=s.CARTA.Beam.verify(e.beamTable[t]);if(i)return"beamTable."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.OpenFileAck)return e;let t=new s.CARTA.OpenFileAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.OpenFileAck.fileInfo: object expected");t.fileInfo=s.CARTA.FileInfo.fromObject(e.fileInfo)}if(null!=e.fileInfoExtended){if("object"!==typeof e.fileInfoExtended)throw TypeError(".CARTA.OpenFileAck.fileInfoExtended: object expected");t.fileInfoExtended=s.CARTA.FileInfoExtended.fromObject(e.fileInfoExtended)}if(null!=e.fileFeatureFlags&&(t.fileFeatureFlags=e.fileFeatureFlags>>>0),e.beamTable){if(!Array.isArray(e.beamTable))throw TypeError(".CARTA.OpenFileAck.beamTable: array expected");t.beamTable=[];for(let i=0;i<e.beamTable.length;++i){if("object"!==typeof e.beamTable[i])throw TypeError(".CARTA.OpenFileAck.beamTable: object expected");t.beamTable[i]=s.CARTA.Beam.fromObject(e.beamTable[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.beamTable=[]),t.defaults&&(i.success=!1,i.fileId=0,i.message="",i.fileInfo=null,i.fileInfoExtended=null,i.fileFeatureFlags=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=s.CARTA.FileInfo.toObject(e.fileInfo,t)),null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")&&(i.fileInfoExtended=s.CARTA.FileInfoExtended.toObject(e.fileInfoExtended,t)),null!=e.fileFeatureFlags&&e.hasOwnProperty("fileFeatureFlags")&&(i.fileFeatureFlags=e.fileFeatureFlags),e.beamTable&&e.beamTable.length){i.beamTable=[];for(let n=0;n<e.beamTable.length;++n)i.beamTable[n]=s.CARTA.Beam.toObject(e.beamTable[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetRegion=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.regionInfo=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.regionInfo&&Object.hasOwnProperty.call(e,"regionInfo")&&s.CARTA.RegionInfo.encode(e.regionInfo,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.regionInfo=s.CARTA.RegionInfo.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.regionInfo&&e.hasOwnProperty("regionInfo")){let t=s.CARTA.RegionInfo.verify(e.regionInfo);if(t)return"regionInfo."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetRegion)return e;let t=new s.CARTA.SetRegion;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.regionInfo){if("object"!==typeof e.regionInfo)throw TypeError(".CARTA.SetRegion.regionInfo: object expected");t.regionInfo=s.CARTA.RegionInfo.fromObject(e.regionInfo)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.regionId=0,i.regionInfo=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.regionInfo&&e.hasOwnProperty("regionInfo")&&(i.regionInfo=s.CARTA.RegionInfo.toObject(e.regionInfo,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetRegionAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.regionId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(29).sfixed32(e.regionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetRegionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.regionId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId)?"regionId: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SetRegionAck)return e;let t=new s.CARTA.SetRegionAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.regionId&&(t.regionId=0|e.regionId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.regionId=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RemoveRegion=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.regionId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(13).sfixed32(e.regionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RemoveRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.regionId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId)?"regionId: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RemoveRegion)return e;let t=new s.CARTA.RemoveRegion;return null!=e.regionId&&(t.regionId=0|e.regionId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.regionId=0),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetStatsRequirements=function(){function e(e){if(this.stats=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stats=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stats&&e.stats.length){t.uint32(26).fork();for(let i=0;i<e.stats.length;++i)t.int32(e.stats[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetStatsRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:if(n.stats&&n.stats.length||(n.stats=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.stats.push(e.int32())}else n.stats.push(e.int32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stats&&e.hasOwnProperty("stats")){if(!Array.isArray(e.stats))return"stats: array expected";for(let t=0;t<e.stats.length;++t)switch(e.stats[t]){default:return"stats: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetStatsRequirements)return e;let t=new s.CARTA.SetStatsRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.stats){if(!Array.isArray(e.stats))throw TypeError(".CARTA.SetStatsRequirements.stats: array expected");t.stats=[];for(let i=0;i<e.stats.length;++i)switch(e.stats[i]){default:case"NumPixels":case 0:t.stats[i]=0;break;case"NanCount":case 1:t.stats[i]=1;break;case"Sum":case 2:t.stats[i]=2;break;case"FluxDensity":case 3:t.stats[i]=3;break;case"Mean":case 4:t.stats[i]=4;break;case"RMS":case 5:t.stats[i]=5;break;case"Sigma":case 6:t.stats[i]=6;break;case"SumSq":case 7:t.stats[i]=7;break;case"Min":case 8:t.stats[i]=8;break;case"Max":case 9:t.stats[i]=9;break;case"Extrema":case 10:t.stats[i]=10;break;case"Blc":case 11:t.stats[i]=11;break;case"Trc":case 12:t.stats[i]=12;break;case"MinPos":case 13:t.stats[i]=13;break;case"MaxPos":case 14:t.stats[i]=14;break;case"Blcf":case 15:t.stats[i]=15;break;case"Trcf":case 16:t.stats[i]=16;break;case"MinPosf":case 17:t.stats[i]=17;break;case"MaxPosf":case 18:t.stats[i]=18}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stats=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.stats&&e.stats.length){i.stats=[];for(let n=0;n<e.stats.length;++n)i.stats[n]=t.enums===String?s.CARTA.StatsType[e.stats[n]]:e.stats[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetHistogramRequirements=function(){function e(e){if(this.histograms=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.histograms=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.histograms&&e.histograms.length)for(let i=0;i<e.histograms.length;++i)s.CARTA.SetHistogramRequirements.HistogramConfig.encode(e.histograms[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetHistogramRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.histograms&&n.histograms.length||(n.histograms=[]),n.histograms.push(s.CARTA.SetHistogramRequirements.HistogramConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.histograms&&e.hasOwnProperty("histograms")){if(!Array.isArray(e.histograms))return"histograms: array expected";for(let t=0;t<e.histograms.length;++t){let i=s.CARTA.SetHistogramRequirements.HistogramConfig.verify(e.histograms[t]);if(i)return"histograms."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetHistogramRequirements)return e;let t=new s.CARTA.SetHistogramRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.histograms){if(!Array.isArray(e.histograms))throw TypeError(".CARTA.SetHistogramRequirements.histograms: array expected");t.histograms=[];for(let i=0;i<e.histograms.length;++i){if("object"!==typeof e.histograms[i])throw TypeError(".CARTA.SetHistogramRequirements.histograms: object expected");t.histograms[i]=s.CARTA.SetHistogramRequirements.HistogramConfig.fromObject(e.histograms[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.histograms=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.histograms&&e.histograms.length){i.histograms=[];for(let n=0;n<e.histograms.length;++n)i.histograms[n]=s.CARTA.SetHistogramRequirements.HistogramConfig.toObject(e.histograms[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.HistogramConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.numBins=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.numBins&&Object.hasOwnProperty.call(e,"numBins")&&t.uint32(21).sfixed32(e.numBins),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetHistogramRequirements.HistogramConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.numBins=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel)?"channel: integer expected":null!=e.numBins&&e.hasOwnProperty("numBins")&&!a.isInteger(e.numBins)?"numBins: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SetHistogramRequirements.HistogramConfig)return e;let t=new s.CARTA.SetHistogramRequirements.HistogramConfig;return null!=e.channel&&(t.channel=0|e.channel),null!=e.numBins&&(t.numBins=0|e.numBins),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.numBins=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.numBins&&e.hasOwnProperty("numBins")&&(i.numBins=e.numBins),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e}(),e.SetSpatialRequirements=function(){function e(e){if(this.spatialProfiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.spatialProfiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.spatialProfiles&&e.spatialProfiles.length)for(let i=0;i<e.spatialProfiles.length;++i)t.uint32(26).string(e.spatialProfiles[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetSpatialRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.spatialProfiles&&n.spatialProfiles.length||(n.spatialProfiles=[]),n.spatialProfiles.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spatialProfiles&&e.hasOwnProperty("spatialProfiles")){if(!Array.isArray(e.spatialProfiles))return"spatialProfiles: array expected";for(let t=0;t<e.spatialProfiles.length;++t)if(!a.isString(e.spatialProfiles[t]))return"spatialProfiles: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetSpatialRequirements)return e;let t=new s.CARTA.SetSpatialRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.spatialProfiles){if(!Array.isArray(e.spatialProfiles))throw TypeError(".CARTA.SetSpatialRequirements.spatialProfiles: array expected");t.spatialProfiles=[];for(let i=0;i<e.spatialProfiles.length;++i)t.spatialProfiles[i]=String(e.spatialProfiles[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.spatialProfiles=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.spatialProfiles&&e.spatialProfiles.length){i.spatialProfiles=[];for(let t=0;t<e.spatialProfiles.length;++t)i.spatialProfiles[t]=e.spatialProfiles[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetSpectralRequirements=function(){function e(e){if(this.spectralProfiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.spectralProfiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.spectralProfiles&&e.spectralProfiles.length)for(let i=0;i<e.spectralProfiles.length;++i)s.CARTA.SetSpectralRequirements.SpectralConfig.encode(e.spectralProfiles[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetSpectralRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.spectralProfiles&&n.spectralProfiles.length||(n.spectralProfiles=[]),n.spectralProfiles.push(s.CARTA.SetSpectralRequirements.SpectralConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spectralProfiles&&e.hasOwnProperty("spectralProfiles")){if(!Array.isArray(e.spectralProfiles))return"spectralProfiles: array expected";for(let t=0;t<e.spectralProfiles.length;++t){let i=s.CARTA.SetSpectralRequirements.SpectralConfig.verify(e.spectralProfiles[t]);if(i)return"spectralProfiles."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetSpectralRequirements)return e;let t=new s.CARTA.SetSpectralRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.spectralProfiles){if(!Array.isArray(e.spectralProfiles))throw TypeError(".CARTA.SetSpectralRequirements.spectralProfiles: array expected");t.spectralProfiles=[];for(let i=0;i<e.spectralProfiles.length;++i){if("object"!==typeof e.spectralProfiles[i])throw TypeError(".CARTA.SetSpectralRequirements.spectralProfiles: object expected");t.spectralProfiles[i]=s.CARTA.SetSpectralRequirements.SpectralConfig.fromObject(e.spectralProfiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.spectralProfiles=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.spectralProfiles&&e.spectralProfiles.length){i.spectralProfiles=[];for(let n=0;n<e.spectralProfiles.length;++n)i.spectralProfiles[n]=s.CARTA.SetSpectralRequirements.SpectralConfig.toObject(e.spectralProfiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.SpectralConfig=function(){function e(e){if(this.statsTypes=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsTypes=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsTypes&&e.statsTypes.length){t.uint32(18).fork();for(let i=0;i<e.statsTypes.length;++i)t.int32(e.statsTypes[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetSpectralRequirements.SpectralConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:if(n.statsTypes&&n.statsTypes.length||(n.statsTypes=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.statsTypes.push(e.int32())}else n.statsTypes.push(e.int32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!a.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsTypes&&e.hasOwnProperty("statsTypes")){if(!Array.isArray(e.statsTypes))return"statsTypes: array expected";for(let t=0;t<e.statsTypes.length;++t)switch(e.statsTypes[t]){default:return"statsTypes: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetSpectralRequirements.SpectralConfig)return e;let t=new s.CARTA.SetSpectralRequirements.SpectralConfig;if(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsTypes){if(!Array.isArray(e.statsTypes))throw TypeError(".CARTA.SetSpectralRequirements.SpectralConfig.statsTypes: array expected");t.statsTypes=[];for(let i=0;i<e.statsTypes.length;++i)switch(e.statsTypes[i]){default:case"NumPixels":case 0:t.statsTypes[i]=0;break;case"NanCount":case 1:t.statsTypes[i]=1;break;case"Sum":case 2:t.statsTypes[i]=2;break;case"FluxDensity":case 3:t.statsTypes[i]=3;break;case"Mean":case 4:t.statsTypes[i]=4;break;case"RMS":case 5:t.statsTypes[i]=5;break;case"Sigma":case 6:t.statsTypes[i]=6;break;case"SumSq":case 7:t.statsTypes[i]=7;break;case"Min":case 8:t.statsTypes[i]=8;break;case"Max":case 9:t.statsTypes[i]=9;break;case"Extrema":case 10:t.statsTypes[i]=10;break;case"Blc":case 11:t.statsTypes[i]=11;break;case"Trc":case 12:t.statsTypes[i]=12;break;case"MinPos":case 13:t.statsTypes[i]=13;break;case"MaxPos":case 14:t.statsTypes[i]=14;break;case"Blcf":case 15:t.statsTypes[i]=15;break;case"Trcf":case 16:t.statsTypes[i]=16;break;case"MinPosf":case 17:t.statsTypes[i]=17;break;case"MaxPosf":case 18:t.statsTypes[i]=18}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statsTypes=[]),t.defaults&&(i.coordinate=""),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),e.statsTypes&&e.statsTypes.length){i.statsTypes=[];for(let n=0;n<e.statsTypes.length;++n)i.statsTypes[n]=t.enums===String?s.CARTA.StatsType[e.statsTypes[n]]:e.statsTypes[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e}(),e.RegisterViewer=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sessionId=0,e.prototype.apiKey="",e.prototype.clientFeatureFlags=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(13).fixed32(e.sessionId),null!=e.apiKey&&Object.hasOwnProperty.call(e,"apiKey")&&t.uint32(18).string(e.apiKey),null!=e.clientFeatureFlags&&Object.hasOwnProperty.call(e,"clientFeatureFlags")&&t.uint32(29).fixed32(e.clientFeatureFlags),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegisterViewer;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.sessionId=e.fixed32();break;case 2:n.apiKey=e.string();break;case 3:n.clientFeatureFlags=e.fixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!a.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.apiKey&&e.hasOwnProperty("apiKey")&&!a.isString(e.apiKey)?"apiKey: string expected":null!=e.clientFeatureFlags&&e.hasOwnProperty("clientFeatureFlags")&&!a.isInteger(e.clientFeatureFlags)?"clientFeatureFlags: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RegisterViewer)return e;let t=new s.CARTA.RegisterViewer;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.apiKey&&(t.apiKey=String(e.apiKey)),null!=e.clientFeatureFlags&&(t.clientFeatureFlags=e.clientFeatureFlags>>>0),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.sessionId=0,i.apiKey="",i.clientFeatureFlags=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(i.sessionId=e.sessionId),null!=e.apiKey&&e.hasOwnProperty("apiKey")&&(i.apiKey=e.apiKey),null!=e.clientFeatureFlags&&e.hasOwnProperty("clientFeatureFlags")&&(i.clientFeatureFlags=e.clientFeatureFlags),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegisterViewerAck=function(){function e(e){if(this.userPreferences={},this.userLayouts={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sessionId=0,e.prototype.success=!1,e.prototype.message="",e.prototype.sessionType=0,e.prototype.serverFeatureFlags=0,e.prototype.userPreferences=a.emptyObject,e.prototype.userLayouts=a.emptyObject,e.prototype.grpcPort=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(13).fixed32(e.sessionId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.sessionType&&Object.hasOwnProperty.call(e,"sessionType")&&t.uint32(32).int32(e.sessionType),null!=e.serverFeatureFlags&&Object.hasOwnProperty.call(e,"serverFeatureFlags")&&t.uint32(45).fixed32(e.serverFeatureFlags),null!=e.userPreferences&&Object.hasOwnProperty.call(e,"userPreferences"))for(let i=Object.keys(e.userPreferences),n=0;n<i.length;++n)t.uint32(50).fork().uint32(10).string(i[n]).uint32(18).string(e.userPreferences[i[n]]).ldelim();if(null!=e.userLayouts&&Object.hasOwnProperty.call(e,"userLayouts"))for(let i=Object.keys(e.userLayouts),n=0;n<i.length;++n)t.uint32(58).fork().uint32(10).string(i[n]).uint32(18).string(e.userLayouts[i[n]]).ldelim();return null!=e.grpcPort&&Object.hasOwnProperty.call(e,"grpcPort")&&t.uint32(69).fixed32(e.grpcPort),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.RegisterViewerAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.sessionId=e.fixed32();break;case 2:o.success=e.bool();break;case 3:o.message=e.string();break;case 4:o.sessionType=e.int32();break;case 5:o.serverFeatureFlags=e.fixed32();break;case 6:e.skip().pos++,o.userPreferences===a.emptyObject&&(o.userPreferences={}),i=e.string(),e.pos++,o.userPreferences[i]=e.string();break;case 7:e.skip().pos++,o.userLayouts===a.emptyObject&&(o.userLayouts={}),i=e.string(),e.pos++,o.userLayouts[i]=e.string();break;case 8:o.grpcPort=e.fixed32();break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!a.isInteger(e.sessionId))return"sessionId: integer expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.sessionType&&e.hasOwnProperty("sessionType"))switch(e.sessionType){default:return"sessionType: enum value expected";case 0:case 1:}if(null!=e.serverFeatureFlags&&e.hasOwnProperty("serverFeatureFlags")&&!a.isInteger(e.serverFeatureFlags))return"serverFeatureFlags: integer expected";if(null!=e.userPreferences&&e.hasOwnProperty("userPreferences")){if(!a.isObject(e.userPreferences))return"userPreferences: object expected";let t=Object.keys(e.userPreferences);for(let i=0;i<t.length;++i)if(!a.isString(e.userPreferences[t[i]]))return"userPreferences: string{k:string} expected"}if(null!=e.userLayouts&&e.hasOwnProperty("userLayouts")){if(!a.isObject(e.userLayouts))return"userLayouts: object expected";let t=Object.keys(e.userLayouts);for(let i=0;i<t.length;++i)if(!a.isString(e.userLayouts[t[i]]))return"userLayouts: string{k:string} expected"}return null!=e.grpcPort&&e.hasOwnProperty("grpcPort")&&!a.isInteger(e.grpcPort)?"grpcPort: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RegisterViewerAck)return e;let t=new s.CARTA.RegisterViewerAck;switch(null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.sessionType){case"NEW":case 0:t.sessionType=0;break;case"RESUMED":case 1:t.sessionType=1}if(null!=e.serverFeatureFlags&&(t.serverFeatureFlags=e.serverFeatureFlags>>>0),e.userPreferences){if("object"!==typeof e.userPreferences)throw TypeError(".CARTA.RegisterViewerAck.userPreferences: object expected");t.userPreferences={};for(let i=Object.keys(e.userPreferences),n=0;n<i.length;++n)t.userPreferences[i[n]]=String(e.userPreferences[i[n]])}if(e.userLayouts){if("object"!==typeof e.userLayouts)throw TypeError(".CARTA.RegisterViewerAck.userLayouts: object expected");t.userLayouts={};for(let i=Object.keys(e.userLayouts),n=0;n<i.length;++n)t.userLayouts[i[n]]=String(e.userLayouts[i[n]])}return null!=e.grpcPort&&(t.grpcPort=e.grpcPort>>>0),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.userPreferences={},n.userLayouts={}),t.defaults&&(n.sessionId=0,n.success=!1,n.message="",n.sessionType=t.enums===String?"NEW":0,n.serverFeatureFlags=0,n.grpcPort=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(n.sessionId=e.sessionId),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.sessionType&&e.hasOwnProperty("sessionType")&&(n.sessionType=t.enums===String?s.CARTA.SessionType[e.sessionType]:e.sessionType),null!=e.serverFeatureFlags&&e.hasOwnProperty("serverFeatureFlags")&&(n.serverFeatureFlags=e.serverFeatureFlags),e.userPreferences&&(i=Object.keys(e.userPreferences)).length){n.userPreferences={};for(let t=0;t<i.length;++t)n.userPreferences[i[t]]=e.userPreferences[i[t]]}if(e.userLayouts&&(i=Object.keys(e.userLayouts)).length){n.userLayouts={};for(let t=0;t<i.length;++t)n.userLayouts[i[t]]=e.userLayouts[i[t]]}return null!=e.grpcPort&&e.hasOwnProperty("grpcPort")&&(n.grpcPort=e.grpcPort),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImageProperties=function(){function e(e){if(this.regions={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.fileId=0,e.prototype.renderMode=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.regions=a.emptyObject,e.prototype.contourSettings=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(37).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(40).int32(e.renderMode),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(53).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(61).sfixed32(e.stokes),null!=e.regions&&Object.hasOwnProperty.call(e,"regions"))for(let i=Object.keys(e.regions),n=0;n<i.length;++n)t.uint32(66).fork().uint32(13).sfixed32(i[n]),s.CARTA.RegionInfo.encode(e.regions[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.contourSettings&&Object.hasOwnProperty.call(e,"contourSettings")&&s.CARTA.SetContourParameters.encode(e.contourSettings,t.uint32(74).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.ImageProperties;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.directory=e.string();break;case 2:o.file=e.string();break;case 3:o.hdu=e.string();break;case 4:o.fileId=e.sfixed32();break;case 5:o.renderMode=e.int32();break;case 6:o.channel=e.sfixed32();break;case 7:o.stokes=e.sfixed32();break;case 8:e.skip().pos++,o.regions===a.emptyObject&&(o.regions={}),i=e.sfixed32(),e.pos++,o.regions[i]=s.CARTA.RegionInfo.decode(e,e.uint32());break;case 9:o.contourSettings=s.CARTA.SetContourParameters.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!a.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!a.isString(e.hdu))return"hdu: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.regions&&e.hasOwnProperty("regions")){if(!a.isObject(e.regions))return"regions: object expected";let t=Object.keys(e.regions);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"regions: integer key{k:sfixed32} expected";{let n=s.CARTA.RegionInfo.verify(e.regions[t[i]]);if(n)return"regions."+n}}}if(null!=e.contourSettings&&e.hasOwnProperty("contourSettings")){let t=s.CARTA.SetContourParameters.verify(e.contourSettings);if(t)return"contourSettings."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.ImageProperties)return e;let t=new s.CARTA.ImageProperties;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}if(null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.regions){if("object"!==typeof e.regions)throw TypeError(".CARTA.ImageProperties.regions: object expected");t.regions={};for(let i=Object.keys(e.regions),n=0;n<i.length;++n){if("object"!==typeof e.regions[i[n]])throw TypeError(".CARTA.ImageProperties.regions: object expected");t.regions[i[n]]=s.CARTA.RegionInfo.fromObject(e.regions[i[n]])}}if(null!=e.contourSettings){if("object"!==typeof e.contourSettings)throw TypeError(".CARTA.ImageProperties.contourSettings: object expected");t.contourSettings=s.CARTA.SetContourParameters.fromObject(e.contourSettings)}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regions={}),t.defaults&&(n.directory="",n.file="",n.hdu="",n.fileId=0,n.renderMode=t.enums===String?"RASTER":0,n.channel=0,n.stokes=0,n.contourSettings=null),null!=e.directory&&e.hasOwnProperty("directory")&&(n.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(n.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(n.hdu=e.hdu),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(n.renderMode=t.enums===String?s.CARTA.RenderMode[e.renderMode]:e.renderMode),null!=e.channel&&e.hasOwnProperty("channel")&&(n.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(n.stokes=e.stokes),e.regions&&(i=Object.keys(e.regions)).length){n.regions={};for(let r=0;r<i.length;++r)n.regions[i[r]]=s.CARTA.RegionInfo.toObject(e.regions[i[r]],t)}return null!=e.contourSettings&&e.hasOwnProperty("contourSettings")&&(n.contourSettings=s.CARTA.SetContourParameters.toObject(e.contourSettings,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ResumeSession=function(){function e(e){if(this.images=[],this.catalogFiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.images=a.emptyArray,e.prototype.catalogFiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.images&&e.images.length)for(let i=0;i<e.images.length;++i)s.CARTA.ImageProperties.encode(e.images[i],t.uint32(10).fork()).ldelim();if(null!=e.catalogFiles&&e.catalogFiles.length)for(let i=0;i<e.catalogFiles.length;++i)s.CARTA.OpenCatalogFile.encode(e.catalogFiles[i],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ResumeSession;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.images&&n.images.length||(n.images=[]),n.images.push(s.CARTA.ImageProperties.decode(e,e.uint32()));break;case 2:n.catalogFiles&&n.catalogFiles.length||(n.catalogFiles=[]),n.catalogFiles.push(s.CARTA.OpenCatalogFile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.images&&e.hasOwnProperty("images")){if(!Array.isArray(e.images))return"images: array expected";for(let t=0;t<e.images.length;++t){let i=s.CARTA.ImageProperties.verify(e.images[t]);if(i)return"images."+i}}if(null!=e.catalogFiles&&e.hasOwnProperty("catalogFiles")){if(!Array.isArray(e.catalogFiles))return"catalogFiles: array expected";for(let t=0;t<e.catalogFiles.length;++t){let i=s.CARTA.OpenCatalogFile.verify(e.catalogFiles[t]);if(i)return"catalogFiles."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.ResumeSession)return e;let t=new s.CARTA.ResumeSession;if(e.images){if(!Array.isArray(e.images))throw TypeError(".CARTA.ResumeSession.images: array expected");t.images=[];for(let i=0;i<e.images.length;++i){if("object"!==typeof e.images[i])throw TypeError(".CARTA.ResumeSession.images: object expected");t.images[i]=s.CARTA.ImageProperties.fromObject(e.images[i])}}if(e.catalogFiles){if(!Array.isArray(e.catalogFiles))throw TypeError(".CARTA.ResumeSession.catalogFiles: array expected");t.catalogFiles=[];for(let i=0;i<e.catalogFiles.length;++i){if("object"!==typeof e.catalogFiles[i])throw TypeError(".CARTA.ResumeSession.catalogFiles: object expected");t.catalogFiles[i]=s.CARTA.OpenCatalogFile.fromObject(e.catalogFiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.images=[],i.catalogFiles=[]),e.images&&e.images.length){i.images=[];for(let n=0;n<e.images.length;++n)i.images[n]=s.CARTA.ImageProperties.toObject(e.images[n],t)}if(e.catalogFiles&&e.catalogFiles.length){i.catalogFiles=[];for(let n=0;n<e.catalogFiles.length;++n)i.catalogFiles[n]=s.CARTA.OpenCatalogFile.toObject(e.catalogFiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ResumeSessionAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ResumeSessionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ResumeSessionAck)return e;let t=new s.CARTA.ResumeSessionAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetCursor=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.point=null,e.prototype.spatialRequirements=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.point&&Object.hasOwnProperty.call(e,"point")&&s.CARTA.Point.encode(e.point,t.uint32(18).fork()).ldelim(),null!=e.spatialRequirements&&Object.hasOwnProperty.call(e,"spatialRequirements")&&s.CARTA.SetSpatialRequirements.encode(e.spatialRequirements,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetCursor;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.point=s.CARTA.Point.decode(e,e.uint32());break;case 3:n.spatialRequirements=s.CARTA.SetSpatialRequirements.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.point&&e.hasOwnProperty("point")){let t=s.CARTA.Point.verify(e.point);if(t)return"point."+t}if(null!=e.spatialRequirements&&e.hasOwnProperty("spatialRequirements")){let t=s.CARTA.SetSpatialRequirements.verify(e.spatialRequirements);if(t)return"spatialRequirements."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetCursor)return e;let t=new s.CARTA.SetCursor;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.point){if("object"!==typeof e.point)throw TypeError(".CARTA.SetCursor.point: object expected");t.point=s.CARTA.Point.fromObject(e.point)}if(null!=e.spatialRequirements){if("object"!==typeof e.spatialRequirements)throw TypeError(".CARTA.SetCursor.spatialRequirements: object expected");t.spatialRequirements=s.CARTA.SetSpatialRequirements.fromObject(e.spatialRequirements)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.point=null,i.spatialRequirements=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.point&&e.hasOwnProperty("point")&&(i.point=s.CARTA.Point.toObject(e.point,t)),null!=e.spatialRequirements&&e.hasOwnProperty("spatialRequirements")&&(i.spatialRequirements=s.CARTA.SetSpatialRequirements.toObject(e.spatialRequirements,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetImageChannels=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.requiredTiles=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.requiredTiles&&Object.hasOwnProperty.call(e,"requiredTiles")&&s.CARTA.AddRequiredTiles.encode(e.requiredTiles,t.uint32(34).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SetImageChannels;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.requiredTiles=s.CARTA.AddRequiredTiles.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")){let t=s.CARTA.AddRequiredTiles.verify(e.requiredTiles);if(t)return"requiredTiles."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SetImageChannels)return e;let t=new s.CARTA.SetImageChannels;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.requiredTiles){if("object"!==typeof e.requiredTiles)throw TypeError(".CARTA.SetImageChannels.requiredTiles: object expected");t.requiredTiles=s.CARTA.AddRequiredTiles.fromObject(e.requiredTiles)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.requiredTiles=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")&&(i.requiredTiles=s.CARTA.AddRequiredTiles.toObject(e.requiredTiles,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralLineRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.frequencyRange=null,e.prototype.lineIntensityLowerLimit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.frequencyRange&&Object.hasOwnProperty.call(e,"frequencyRange")&&s.CARTA.DoubleBounds.encode(e.frequencyRange,t.uint32(10).fork()).ldelim(),null!=e.lineIntensityLowerLimit&&Object.hasOwnProperty.call(e,"lineIntensityLowerLimit")&&t.uint32(17).double(e.lineIntensityLowerLimit),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SpectralLineRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.frequencyRange=s.CARTA.DoubleBounds.decode(e,e.uint32());break;case 2:n.lineIntensityLowerLimit=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.frequencyRange&&e.hasOwnProperty("frequencyRange")){let t=s.CARTA.DoubleBounds.verify(e.frequencyRange);if(t)return"frequencyRange."+t}return null!=e.lineIntensityLowerLimit&&e.hasOwnProperty("lineIntensityLowerLimit")&&"number"!==typeof e.lineIntensityLowerLimit?"lineIntensityLowerLimit: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SpectralLineRequest)return e;let t=new s.CARTA.SpectralLineRequest;if(null!=e.frequencyRange){if("object"!==typeof e.frequencyRange)throw TypeError(".CARTA.SpectralLineRequest.frequencyRange: object expected");t.frequencyRange=s.CARTA.DoubleBounds.fromObject(e.frequencyRange)}return null!=e.lineIntensityLowerLimit&&(t.lineIntensityLowerLimit=Number(e.lineIntensityLowerLimit)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.frequencyRange=null,i.lineIntensityLowerLimit=0),null!=e.frequencyRange&&e.hasOwnProperty("frequencyRange")&&(i.frequencyRange=s.CARTA.DoubleBounds.toObject(e.frequencyRange,t)),null!=e.lineIntensityLowerLimit&&e.hasOwnProperty("lineIntensityLowerLimit")&&(i.lineIntensityLowerLimit=t.json&&!isFinite(e.lineIntensityLowerLimit)?String(e.lineIntensityLowerLimit):e.lineIntensityLowerLimit),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralLineResponse=function(){function e(e){if(this.headers=[],this.spectralLineData={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.dataSize=0,e.prototype.headers=a.emptyArray,e.prototype.spectralLineData=a.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.dataSize&&Object.hasOwnProperty.call(e,"dataSize")&&t.uint32(29).sfixed32(e.dataSize),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)s.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(34).fork()).ldelim();if(null!=e.spectralLineData&&Object.hasOwnProperty.call(e,"spectralLineData"))for(let i=Object.keys(e.spectralLineData),n=0;n<i.length;++n)t.uint32(42).fork().uint32(13).fixed32(i[n]),s.CARTA.ColumnData.encode(e.spectralLineData[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.SpectralLineResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:o.dataSize=e.sfixed32();break;case 4:o.headers&&o.headers.length||(o.headers=[]),o.headers.push(s.CARTA.CatalogHeader.decode(e,e.uint32()));break;case 5:e.skip().pos++,o.spectralLineData===a.emptyObject&&(o.spectralLineData={}),i=e.fixed32(),e.pos++,o.spectralLineData[i]=s.CARTA.ColumnData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.dataSize&&e.hasOwnProperty("dataSize")&&!a.isInteger(e.dataSize))return"dataSize: integer expected";if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=s.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}if(null!=e.spectralLineData&&e.hasOwnProperty("spectralLineData")){if(!a.isObject(e.spectralLineData))return"spectralLineData: object expected";let t=Object.keys(e.spectralLineData);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"spectralLineData: integer key{k:fixed32} expected";{let n=s.CARTA.ColumnData.verify(e.spectralLineData[t[i]]);if(n)return"spectralLineData."+n}}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SpectralLineResponse)return e;let t=new s.CARTA.SpectralLineResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.dataSize&&(t.dataSize=0|e.dataSize),e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.SpectralLineResponse.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.SpectralLineResponse.headers: object expected");t.headers[i]=s.CARTA.CatalogHeader.fromObject(e.headers[i])}}if(e.spectralLineData){if("object"!==typeof e.spectralLineData)throw TypeError(".CARTA.SpectralLineResponse.spectralLineData: object expected");t.spectralLineData={};for(let i=Object.keys(e.spectralLineData),n=0;n<i.length;++n){if("object"!==typeof e.spectralLineData[i[n]])throw TypeError(".CARTA.SpectralLineResponse.spectralLineData: object expected");t.spectralLineData[i[n]]=s.CARTA.ColumnData.fromObject(e.spectralLineData[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.headers=[]),(t.objects||t.defaults)&&(n.spectralLineData={}),t.defaults&&(n.success=!1,n.message="",n.dataSize=0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.dataSize&&e.hasOwnProperty("dataSize")&&(n.dataSize=e.dataSize),e.headers&&e.headers.length){n.headers=[];for(let i=0;i<e.headers.length;++i)n.headers[i]=s.CARTA.CatalogHeader.toObject(e.headers[i],t)}if(e.spectralLineData&&(i=Object.keys(e.spectralLineData)).length){n.spectralLineData={};for(let r=0;r<i.length;++r)n.spectralLineData[i[r]]=s.CARTA.ColumnData.toObject(e.spectralLineData[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StopMomentCalc=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.StopMomentCalc;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.StopMomentCalc)return e;let t=new s.CARTA.StopMomentCalc;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.name="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogFileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.name=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null!=e.name&&e.hasOwnProperty("name")&&!a.isString(e.name)?"name: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogFileInfoRequest)return e;let t=new s.CARTA.CatalogFileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.name&&(t.name=String(e.name)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.name=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFileInfoResponse=function(){function e(e){if(this.headers=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.headers=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&s.CARTA.CatalogFileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)s.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogFileInfoResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.fileInfo=s.CARTA.CatalogFileInfo.decode(e,e.uint32());break;case 4:n.headers&&n.headers.length||(n.headers=[]),n.headers.push(s.CARTA.CatalogHeader.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=s.CARTA.CatalogFileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=s.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogFileInfoResponse)return e;let t=new s.CARTA.CatalogFileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.CatalogFileInfoResponse.fileInfo: object expected");t.fileInfo=s.CARTA.CatalogFileInfo.fromObject(e.fileInfo)}if(e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.CatalogFileInfoResponse.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.CatalogFileInfoResponse.headers: object expected");t.headers[i]=s.CARTA.CatalogHeader.fromObject(e.headers[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.headers=[]),t.defaults&&(i.success=!1,i.message="",i.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=s.CARTA.CatalogFileInfo.toObject(e.fileInfo,t)),e.headers&&e.headers.length){i.headers=[];for(let n=0;n<e.headers.length;++n)i.headers[n]=s.CARTA.CatalogHeader.toObject(e.headers[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogListRequest)return e;let t=new s.CARTA.CatalogListRequest;return null!=e.directory&&(t.directory=String(e.directory)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=a.emptyArray,e.prototype.subdirectories=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)s.CARTA.CatalogFileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)t.uint32(50).string(e.subdirectories[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(s.CARTA.CatalogFileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!a.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=s.CARTA.CatalogFileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t)if(!a.isString(e.subdirectories[t]))return"subdirectories: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogListResponse)return e;let t=new s.CARTA.CatalogListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.CatalogListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.CatalogListResponse.files: object expected");t.files[i]=s.CARTA.CatalogFileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.CatalogListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i)t.subdirectories[i]=String(e.subdirectories[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=s.CARTA.CatalogFileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let t=0;t<e.subdirectories.length;++t)i.subdirectories[t]=e.subdirectories[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!a.isString(e.file)?"file: string expected":null!=e.hdu&&e.hasOwnProperty("hdu")&&!a.isString(e.hdu)?"hdu: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.FileInfoRequest)return e;let t=new s.CARTA.FileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfoResponse=function(){function e(e){if(this.fileInfoExtended={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.fileInfoExtended=a.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&s.CARTA.FileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.fileInfoExtended&&Object.hasOwnProperty.call(e,"fileInfoExtended"))for(let i=Object.keys(e.fileInfoExtended),n=0;n<i.length;++n)t.uint32(34).fork().uint32(10).string(i[n]),s.CARTA.FileInfoExtended.encode(e.fileInfoExtended[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.FileInfoResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:o.fileInfo=s.CARTA.FileInfo.decode(e,e.uint32());break;case 4:e.skip().pos++,o.fileInfoExtended===a.emptyObject&&(o.fileInfoExtended={}),i=e.string(),e.pos++,o.fileInfoExtended[i]=s.CARTA.FileInfoExtended.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=s.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")){if(!a.isObject(e.fileInfoExtended))return"fileInfoExtended: object expected";let t=Object.keys(e.fileInfoExtended);for(let i=0;i<t.length;++i){let n=s.CARTA.FileInfoExtended.verify(e.fileInfoExtended[t[i]]);if(n)return"fileInfoExtended."+n}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.FileInfoResponse)return e;let t=new s.CARTA.FileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.FileInfoResponse.fileInfo: object expected");t.fileInfo=s.CARTA.FileInfo.fromObject(e.fileInfo)}if(e.fileInfoExtended){if("object"!==typeof e.fileInfoExtended)throw TypeError(".CARTA.FileInfoResponse.fileInfoExtended: object expected");t.fileInfoExtended={};for(let i=Object.keys(e.fileInfoExtended),n=0;n<i.length;++n){if("object"!==typeof e.fileInfoExtended[i[n]])throw TypeError(".CARTA.FileInfoResponse.fileInfoExtended: object expected");t.fileInfoExtended[i[n]]=s.CARTA.FileInfoExtended.fromObject(e.fileInfoExtended[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.fileInfoExtended={}),t.defaults&&(n.success=!1,n.message="",n.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(n.fileInfo=s.CARTA.FileInfo.toObject(e.fileInfo,t)),e.fileInfoExtended&&(i=Object.keys(e.fileInfoExtended)).length){n.fileInfoExtended={};for(let r=0;r<i.length;++r)n.fileInfoExtended[i[r]]=s.CARTA.FileInfoExtended.toObject(e.fileInfoExtended[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FileListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.FileListRequest)return e;let t=new s.CARTA.FileListRequest;return null!=e.directory&&(t.directory=String(e.directory)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=a.emptyArray,e.prototype.subdirectories=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)s.CARTA.FileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)t.uint32(50).string(e.subdirectories[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.FileListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(s.CARTA.FileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!a.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=s.CARTA.FileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t)if(!a.isString(e.subdirectories[t]))return"subdirectories: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.FileListResponse)return e;let t=new s.CARTA.FileListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.FileListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.FileListResponse.files: object expected");t.files[i]=s.CARTA.FileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.FileListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i)t.subdirectories[i]=String(e.subdirectories[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=s.CARTA.FileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let t=0;t<e.subdirectories.length;++t)i.subdirectories[t]=e.subdirectories[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MomentRequest=function(){function e(e){if(this.moments=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.moments=a.emptyArray,e.prototype.axis=0,e.prototype.regionId=0,e.prototype.spectralRange=null,e.prototype.mask=0,e.prototype.pixelRange=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.moments&&e.moments.length){t.uint32(18).fork();for(let i=0;i<e.moments.length;++i)t.int32(e.moments[i]);t.ldelim()}return null!=e.axis&&Object.hasOwnProperty.call(e,"axis")&&t.uint32(24).int32(e.axis),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(37).sfixed32(e.regionId),null!=e.spectralRange&&Object.hasOwnProperty.call(e,"spectralRange")&&s.CARTA.IntBounds.encode(e.spectralRange,t.uint32(42).fork()).ldelim(),null!=e.mask&&Object.hasOwnProperty.call(e,"mask")&&t.uint32(48).int32(e.mask),null!=e.pixelRange&&Object.hasOwnProperty.call(e,"pixelRange")&&s.CARTA.FloatBounds.encode(e.pixelRange,t.uint32(58).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.MomentRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.moments&&n.moments.length||(n.moments=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.moments.push(e.int32())}else n.moments.push(e.int32());break;case 3:n.axis=e.int32();break;case 4:n.regionId=e.sfixed32();break;case 5:n.spectralRange=s.CARTA.IntBounds.decode(e,e.uint32());break;case 6:n.mask=e.int32();break;case 7:n.pixelRange=s.CARTA.FloatBounds.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.moments&&e.hasOwnProperty("moments")){if(!Array.isArray(e.moments))return"moments: array expected";for(let t=0;t<e.moments.length;++t)switch(e.moments[t]){default:return"moments: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}}if(null!=e.axis&&e.hasOwnProperty("axis"))switch(e.axis){default:return"axis: enum value expected";case 0:case 1:}if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spectralRange&&e.hasOwnProperty("spectralRange")){let t=s.CARTA.IntBounds.verify(e.spectralRange);if(t)return"spectralRange."+t}if(null!=e.mask&&e.hasOwnProperty("mask"))switch(e.mask){default:return"mask: enum value expected";case 0:case 1:case 2:}if(null!=e.pixelRange&&e.hasOwnProperty("pixelRange")){let t=s.CARTA.FloatBounds.verify(e.pixelRange);if(t)return"pixelRange."+t}return null},e.fromObject=function(e){if(e instanceof s.CARTA.MomentRequest)return e;let t=new s.CARTA.MomentRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.moments){if(!Array.isArray(e.moments))throw TypeError(".CARTA.MomentRequest.moments: array expected");t.moments=[];for(let i=0;i<e.moments.length;++i)switch(e.moments[i]){default:case"MEAN_OF_THE_SPECTRUM":case 0:t.moments[i]=0;break;case"INTEGRATED_OF_THE_SPECTRUM":case 1:t.moments[i]=1;break;case"INTENSITY_WEIGHTED_COORD":case 2:t.moments[i]=2;break;case"INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD":case 3:t.moments[i]=3;break;case"MEDIAN_OF_THE_SPECTRUM":case 4:t.moments[i]=4;break;case"MEDIAN_COORDINATE":case 5:t.moments[i]=5;break;case"STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM":case 6:t.moments[i]=6;break;case"RMS_OF_THE_SPECTRUM":case 7:t.moments[i]=7;break;case"ABS_MEAN_DEVIATION_OF_THE_SPECTRUM":case 8:t.moments[i]=8;break;case"MAX_OF_THE_SPECTRUM":case 9:t.moments[i]=9;break;case"COORD_OF_THE_MAX_OF_THE_SPECTRUM":case 10:t.moments[i]=10;break;case"MIN_OF_THE_SPECTRUM":case 11:t.moments[i]=11;break;case"COORD_OF_THE_MIN_OF_THE_SPECTRUM":case 12:t.moments[i]=12}}switch(e.axis){case"SPECTRAL":case 0:t.axis=0;break;case"STOKES":case 1:t.axis=1}if(null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.spectralRange){if("object"!==typeof e.spectralRange)throw TypeError(".CARTA.MomentRequest.spectralRange: object expected");t.spectralRange=s.CARTA.IntBounds.fromObject(e.spectralRange)}switch(e.mask){case"None":case 0:t.mask=0;break;case"Include":case 1:t.mask=1;break;case"Exclude":case 2:t.mask=2}if(null!=e.pixelRange){if("object"!==typeof e.pixelRange)throw TypeError(".CARTA.MomentRequest.pixelRange: object expected");t.pixelRange=s.CARTA.FloatBounds.fromObject(e.pixelRange)}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.moments=[]),t.defaults&&(i.fileId=0,i.axis=t.enums===String?"SPECTRAL":0,i.regionId=0,i.spectralRange=null,i.mask=t.enums===String?"None":0,i.pixelRange=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.moments&&e.moments.length){i.moments=[];for(let n=0;n<e.moments.length;++n)i.moments[n]=t.enums===String?s.CARTA.Moment[e.moments[n]]:e.moments[n]}return null!=e.axis&&e.hasOwnProperty("axis")&&(i.axis=t.enums===String?s.CARTA.MomentAxis[e.axis]:e.axis),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.spectralRange&&e.hasOwnProperty("spectralRange")&&(i.spectralRange=s.CARTA.IntBounds.toObject(e.spectralRange,t)),null!=e.mask&&e.hasOwnProperty("mask")&&(i.mask=t.enums===String?s.CARTA.MomentMask[e.mask]:e.mask),null!=e.pixelRange&&e.hasOwnProperty("pixelRange")&&(i.pixelRange=s.CARTA.FloatBounds.toObject(e.pixelRange,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MomentResponse=function(){function e(e){if(this.openFileAcks=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.openFileAcks=a.emptyArray,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.openFileAcks&&e.openFileAcks.length)for(let i=0;i<e.openFileAcks.length;++i)s.CARTA.OpenFileAck.encode(e.openFileAcks[i],t.uint32(26).fork()).ldelim();return null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(32).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.MomentResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.openFileAcks&&n.openFileAcks.length||(n.openFileAcks=[]),n.openFileAcks.push(s.CARTA.OpenFileAck.decode(e,e.uint32()));break;case 4:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.openFileAcks&&e.hasOwnProperty("openFileAcks")){if(!Array.isArray(e.openFileAcks))return"openFileAcks: array expected";for(let t=0;t<e.openFileAcks.length;++t){let i=s.CARTA.OpenFileAck.verify(e.openFileAcks[t]);if(i)return"openFileAcks."+i}}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.MomentResponse)return e;let t=new s.CARTA.MomentResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.openFileAcks){if(!Array.isArray(e.openFileAcks))throw TypeError(".CARTA.MomentResponse.openFileAcks: array expected");t.openFileAcks=[];for(let i=0;i<e.openFileAcks.length;++i){if("object"!==typeof e.openFileAcks[i])throw TypeError(".CARTA.MomentResponse.openFileAcks: object expected");t.openFileAcks[i]=s.CARTA.OpenFileAck.fromObject(e.openFileAcks[i])}}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.openFileAcks=[]),t.defaults&&(i.success=!1,i.message="",i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.openFileAcks&&e.openFileAcks.length){i.openFileAcks=[];for(let n=0;n<e.openFileAcks.length;++n)i.openFileAcks[n]=s.CARTA.OpenFileAck.toObject(e.openFileAcks[n],t)}return null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MomentProgress=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(21).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.MomentProgress;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.MomentProgress)return e;let t=new s.CARTA.MomentProgress;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionFileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionFileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!a.isString(e.file)?"file: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionFileInfoRequest)return e;let t=new s.CARTA.RegionFileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionFileInfoResponse=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.contents=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&s.CARTA.FileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(34).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionFileInfoResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.fileInfo=s.CARTA.FileInfo.decode(e,e.uint32());break;case 4:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=s.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!a.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionFileInfoResponse)return e;let t=new s.CARTA.RegionFileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.RegionFileInfoResponse.fileInfo: object expected");t.fileInfo=s.CARTA.FileInfo.fromObject(e.fileInfo)}if(e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.RegionFileInfoResponse.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.success=!1,i.message="",i.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=s.CARTA.FileInfo.toObject(e.fileInfo,t)),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory)?"directory: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionListRequest)return e;let t=new s.CARTA.RegionListRequest;return null!=e.directory&&(t.directory=String(e.directory)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=a.emptyArray,e.prototype.subdirectories=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)s.CARTA.FileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)t.uint32(50).string(e.subdirectories[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(s.CARTA.FileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!a.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!a.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=s.CARTA.FileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t)if(!a.isString(e.subdirectories[t]))return"subdirectories: string[] expected"}return null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionListResponse)return e;let t=new s.CARTA.RegionListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.RegionListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.RegionListResponse.files: object expected");t.files[i]=s.CARTA.FileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.RegionListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i)t.subdirectories[i]=String(e.subdirectories[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=s.CARTA.FileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let t=0;t<e.subdirectories.length;++t)i.subdirectories[t]=e.subdirectories[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SaveFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.outputFileDirectory="",e.prototype.outputFileName="",e.prototype.outputFileType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.outputFileDirectory&&Object.hasOwnProperty.call(e,"outputFileDirectory")&&t.uint32(18).string(e.outputFileDirectory),null!=e.outputFileName&&Object.hasOwnProperty.call(e,"outputFileName")&&t.uint32(26).string(e.outputFileName),null!=e.outputFileType&&Object.hasOwnProperty.call(e,"outputFileType")&&t.uint32(32).int32(e.outputFileType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SaveFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.outputFileDirectory=e.string();break;case 3:n.outputFileName=e.string();break;case 4:n.outputFileType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.outputFileDirectory&&e.hasOwnProperty("outputFileDirectory")&&!a.isString(e.outputFileDirectory))return"outputFileDirectory: string expected";if(null!=e.outputFileName&&e.hasOwnProperty("outputFileName")&&!a.isString(e.outputFileName))return"outputFileName: string expected";if(null!=e.outputFileType&&e.hasOwnProperty("outputFileType"))switch(e.outputFileType){default:return"outputFileType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SaveFile)return e;let t=new s.CARTA.SaveFile;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.outputFileDirectory&&(t.outputFileDirectory=String(e.outputFileDirectory)),null!=e.outputFileName&&(t.outputFileName=String(e.outputFileName)),e.outputFileType){case"CASA":case 0:t.outputFileType=0;break;case"CRTF":case 1:t.outputFileType=1;break;case"DS9_REG":case 2:t.outputFileType=2;break;case"FITS":case 3:t.outputFileType=3;break;case"HDF5":case 4:t.outputFileType=4;break;case"MIRIAD":case 5:t.outputFileType=5;break;case"UNKNOWN":case 6:t.outputFileType=6}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.outputFileDirectory="",i.outputFileName="",i.outputFileType=t.enums===String?"CASA":0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.outputFileDirectory&&e.hasOwnProperty("outputFileDirectory")&&(i.outputFileDirectory=e.outputFileDirectory),null!=e.outputFileName&&e.hasOwnProperty("outputFileName")&&(i.outputFileName=e.outputFileName),null!=e.outputFileType&&e.hasOwnProperty("outputFileType")&&(i.outputFileType=t.enums===String?s.CARTA.FileType[e.outputFileType]:e.outputFileType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SaveFileAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SaveFileAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.success=e.bool();break;case 3:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.SaveFileAck)return e;let t=new s.CARTA.SaveFileAck;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.success=!1,i.message=""),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ScriptingRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.scriptingRequestId=0,e.prototype.target="",e.prototype.action="",e.prototype.parameters="",e.prototype.async=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.scriptingRequestId&&Object.hasOwnProperty.call(e,"scriptingRequestId")&&t.uint32(13).sfixed32(e.scriptingRequestId),null!=e.target&&Object.hasOwnProperty.call(e,"target")&&t.uint32(18).string(e.target),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(26).string(e.action),null!=e.parameters&&Object.hasOwnProperty.call(e,"parameters")&&t.uint32(34).string(e.parameters),null!=e.async&&Object.hasOwnProperty.call(e,"async")&&t.uint32(40).bool(e.async),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ScriptingRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.scriptingRequestId=e.sfixed32();break;case 2:n.target=e.string();break;case 3:n.action=e.string();break;case 4:n.parameters=e.string();break;case 5:n.async=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&!a.isInteger(e.scriptingRequestId)?"scriptingRequestId: integer expected":null!=e.target&&e.hasOwnProperty("target")&&!a.isString(e.target)?"target: string expected":null!=e.action&&e.hasOwnProperty("action")&&!a.isString(e.action)?"action: string expected":null!=e.parameters&&e.hasOwnProperty("parameters")&&!a.isString(e.parameters)?"parameters: string expected":null!=e.async&&e.hasOwnProperty("async")&&"boolean"!==typeof e.async?"async: boolean expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ScriptingRequest)return e;let t=new s.CARTA.ScriptingRequest;return null!=e.scriptingRequestId&&(t.scriptingRequestId=0|e.scriptingRequestId),null!=e.target&&(t.target=String(e.target)),null!=e.action&&(t.action=String(e.action)),null!=e.parameters&&(t.parameters=String(e.parameters)),null!=e.async&&(t.async=Boolean(e.async)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.scriptingRequestId=0,i.target="",i.action="",i.parameters="",i.async=!1),null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&(i.scriptingRequestId=e.scriptingRequestId),null!=e.target&&e.hasOwnProperty("target")&&(i.target=e.target),null!=e.action&&e.hasOwnProperty("action")&&(i.action=e.action),null!=e.parameters&&e.hasOwnProperty("parameters")&&(i.parameters=e.parameters),null!=e.async&&e.hasOwnProperty("async")&&(i.async=e.async),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ScriptingResponse=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.scriptingRequestId=0,e.prototype.success=!1,e.prototype.message="",e.prototype.response="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.scriptingRequestId&&Object.hasOwnProperty.call(e,"scriptingRequestId")&&t.uint32(13).sfixed32(e.scriptingRequestId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.response&&Object.hasOwnProperty.call(e,"response")&&t.uint32(34).string(e.response),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ScriptingResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.scriptingRequestId=e.sfixed32();break;case 2:n.success=e.bool();break;case 3:n.message=e.string();break;case 4:n.response=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&!a.isInteger(e.scriptingRequestId)?"scriptingRequestId: integer expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null!=e.response&&e.hasOwnProperty("response")&&!a.isString(e.response)?"response: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ScriptingResponse)return e;let t=new s.CARTA.ScriptingResponse;return null!=e.scriptingRequestId&&(t.scriptingRequestId=0|e.scriptingRequestId),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.response&&(t.response=String(e.response)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.scriptingRequestId=0,i.success=!1,i.message="",i.response=""),null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&(i.scriptingRequestId=e.scriptingRequestId),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.response&&e.hasOwnProperty("response")&&(i.response=e.response),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFilterRequest=function(){function e(e){if(this.columnIndices=[],this.filterConfigs=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.columnIndices=a.emptyArray,e.prototype.filterConfigs=a.emptyArray,e.prototype.subsetDataSize=0,e.prototype.subsetStartIndex=0,e.prototype.imageBounds=null,e.prototype.imageFileId=0,e.prototype.regionId=0,e.prototype.sortColumn="",e.prototype.sortingType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.columnIndices&&e.columnIndices.length){t.uint32(18).fork();for(let i=0;i<e.columnIndices.length;++i)t.int32(e.columnIndices[i]);t.ldelim()}if(null!=e.filterConfigs&&e.filterConfigs.length)for(let i=0;i<e.filterConfigs.length;++i)s.CARTA.FilterConfig.encode(e.filterConfigs[i],t.uint32(26).fork()).ldelim();return null!=e.subsetDataSize&&Object.hasOwnProperty.call(e,"subsetDataSize")&&t.uint32(37).sfixed32(e.subsetDataSize),null!=e.subsetStartIndex&&Object.hasOwnProperty.call(e,"subsetStartIndex")&&t.uint32(45).sfixed32(e.subsetStartIndex),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&s.CARTA.CatalogImageBounds.encode(e.imageBounds,t.uint32(50).fork()).ldelim(),null!=e.imageFileId&&Object.hasOwnProperty.call(e,"imageFileId")&&t.uint32(61).sfixed32(e.imageFileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(69).sfixed32(e.regionId),null!=e.sortColumn&&Object.hasOwnProperty.call(e,"sortColumn")&&t.uint32(74).string(e.sortColumn),null!=e.sortingType&&Object.hasOwnProperty.call(e,"sortingType")&&t.uint32(80).int32(e.sortingType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.CatalogFilterRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.columnIndices&&n.columnIndices.length||(n.columnIndices=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.columnIndices.push(e.int32())}else n.columnIndices.push(e.int32());break;case 3:n.filterConfigs&&n.filterConfigs.length||(n.filterConfigs=[]),n.filterConfigs.push(s.CARTA.FilterConfig.decode(e,e.uint32()));break;case 4:n.subsetDataSize=e.sfixed32();break;case 5:n.subsetStartIndex=e.sfixed32();break;case 6:n.imageBounds=s.CARTA.CatalogImageBounds.decode(e,e.uint32());break;case 7:n.imageFileId=e.sfixed32();break;case 8:n.regionId=e.sfixed32();break;case 9:n.sortColumn=e.string();break;case 10:n.sortingType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.columnIndices&&e.hasOwnProperty("columnIndices")){if(!Array.isArray(e.columnIndices))return"columnIndices: array expected";for(let t=0;t<e.columnIndices.length;++t)if(!a.isInteger(e.columnIndices[t]))return"columnIndices: integer[] expected"}if(null!=e.filterConfigs&&e.hasOwnProperty("filterConfigs")){if(!Array.isArray(e.filterConfigs))return"filterConfigs: array expected";for(let t=0;t<e.filterConfigs.length;++t){let i=s.CARTA.FilterConfig.verify(e.filterConfigs[t]);if(i)return"filterConfigs."+i}}if(null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&!a.isInteger(e.subsetDataSize))return"subsetDataSize: integer expected";if(null!=e.subsetStartIndex&&e.hasOwnProperty("subsetStartIndex")&&!a.isInteger(e.subsetStartIndex))return"subsetStartIndex: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=s.CARTA.CatalogImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&!a.isInteger(e.imageFileId))return"imageFileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.sortColumn&&e.hasOwnProperty("sortColumn")&&!a.isString(e.sortColumn))return"sortColumn: string expected";if(null!=e.sortingType&&e.hasOwnProperty("sortingType"))switch(e.sortingType){default:return"sortingType: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogFilterRequest)return e;let t=new s.CARTA.CatalogFilterRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.columnIndices){if(!Array.isArray(e.columnIndices))throw TypeError(".CARTA.CatalogFilterRequest.columnIndices: array expected");t.columnIndices=[];for(let i=0;i<e.columnIndices.length;++i)t.columnIndices[i]=0|e.columnIndices[i]}if(e.filterConfigs){if(!Array.isArray(e.filterConfigs))throw TypeError(".CARTA.CatalogFilterRequest.filterConfigs: array expected");t.filterConfigs=[];for(let i=0;i<e.filterConfigs.length;++i){if("object"!==typeof e.filterConfigs[i])throw TypeError(".CARTA.CatalogFilterRequest.filterConfigs: object expected");t.filterConfigs[i]=s.CARTA.FilterConfig.fromObject(e.filterConfigs[i])}}if(null!=e.subsetDataSize&&(t.subsetDataSize=0|e.subsetDataSize),null!=e.subsetStartIndex&&(t.subsetStartIndex=0|e.subsetStartIndex),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.CatalogFilterRequest.imageBounds: object expected");t.imageBounds=s.CARTA.CatalogImageBounds.fromObject(e.imageBounds)}switch(null!=e.imageFileId&&(t.imageFileId=0|e.imageFileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.sortColumn&&(t.sortColumn=String(e.sortColumn)),e.sortingType){case"Ascending":case 0:t.sortingType=0;break;case"Descending":case 1:t.sortingType=1}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.columnIndices=[],i.filterConfigs=[]),t.defaults&&(i.fileId=0,i.subsetDataSize=0,i.subsetStartIndex=0,i.imageBounds=null,i.imageFileId=0,i.regionId=0,i.sortColumn="",i.sortingType=t.enums===String?"Ascending":0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.columnIndices&&e.columnIndices.length){i.columnIndices=[];for(let t=0;t<e.columnIndices.length;++t)i.columnIndices[t]=e.columnIndices[t]}if(e.filterConfigs&&e.filterConfigs.length){i.filterConfigs=[];for(let n=0;n<e.filterConfigs.length;++n)i.filterConfigs[n]=s.CARTA.FilterConfig.toObject(e.filterConfigs[n],t)}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&(i.subsetDataSize=e.subsetDataSize),null!=e.subsetStartIndex&&e.hasOwnProperty("subsetStartIndex")&&(i.subsetStartIndex=e.subsetStartIndex),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=s.CARTA.CatalogImageBounds.toObject(e.imageBounds,t)),null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&(i.imageFileId=e.imageFileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.sortColumn&&e.hasOwnProperty("sortColumn")&&(i.sortColumn=e.sortColumn),null!=e.sortingType&&e.hasOwnProperty("sortingType")&&(i.sortingType=t.enums===String?s.CARTA.SortingType[e.sortingType]:e.sortingType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFilterResponse=function(){function e(e){if(this.columns={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.imageFileId=0,e.prototype.regionId=0,e.prototype.columns=a.emptyObject,e.prototype.subsetDataSize=0,e.prototype.subsetEndIndex=0,e.prototype.progress=0,e.prototype.filterDataSize=0,e.prototype.requestEndIndex=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.imageFileId&&Object.hasOwnProperty.call(e,"imageFileId")&&t.uint32(21).sfixed32(e.imageFileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(29).sfixed32(e.regionId),null!=e.columns&&Object.hasOwnProperty.call(e,"columns"))for(let i=Object.keys(e.columns),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).fixed32(i[n]),s.CARTA.ColumnData.encode(e.columns[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.subsetDataSize&&Object.hasOwnProperty.call(e,"subsetDataSize")&&t.uint32(45).sfixed32(e.subsetDataSize),null!=e.subsetEndIndex&&Object.hasOwnProperty.call(e,"subsetEndIndex")&&t.uint32(53).sfixed32(e.subsetEndIndex),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(61).float(e.progress),null!=e.filterDataSize&&Object.hasOwnProperty.call(e,"filterDataSize")&&t.uint32(69).sfixed32(e.filterDataSize),null!=e.requestEndIndex&&Object.hasOwnProperty.call(e,"requestEndIndex")&&t.uint32(77).sfixed32(e.requestEndIndex),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new s.CARTA.CatalogFilterResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.fileId=e.sfixed32();break;case 2:o.imageFileId=e.sfixed32();break;case 3:o.regionId=e.sfixed32();break;case 4:e.skip().pos++,o.columns===a.emptyObject&&(o.columns={}),i=e.fixed32(),e.pos++,o.columns[i]=s.CARTA.ColumnData.decode(e,e.uint32());break;case 5:o.subsetDataSize=e.sfixed32();break;case 6:o.subsetEndIndex=e.sfixed32();break;case 7:o.progress=e.float();break;case 8:o.filterDataSize=e.sfixed32();break;case 9:o.requestEndIndex=e.sfixed32();break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&!a.isInteger(e.imageFileId))return"imageFileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.columns&&e.hasOwnProperty("columns")){if(!a.isObject(e.columns))return"columns: object expected";let t=Object.keys(e.columns);for(let i=0;i<t.length;++i){if(!a.key32Re.test(t[i]))return"columns: integer key{k:fixed32} expected";{let n=s.CARTA.ColumnData.verify(e.columns[t[i]]);if(n)return"columns."+n}}}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&!a.isInteger(e.subsetDataSize)?"subsetDataSize: integer expected":null!=e.subsetEndIndex&&e.hasOwnProperty("subsetEndIndex")&&!a.isInteger(e.subsetEndIndex)?"subsetEndIndex: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null!=e.filterDataSize&&e.hasOwnProperty("filterDataSize")&&!a.isInteger(e.filterDataSize)?"filterDataSize: integer expected":null!=e.requestEndIndex&&e.hasOwnProperty("requestEndIndex")&&!a.isInteger(e.requestEndIndex)?"requestEndIndex: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.CatalogFilterResponse)return e;let t=new s.CARTA.CatalogFilterResponse;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.imageFileId&&(t.imageFileId=0|e.imageFileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.columns){if("object"!==typeof e.columns)throw TypeError(".CARTA.CatalogFilterResponse.columns: object expected");t.columns={};for(let i=Object.keys(e.columns),n=0;n<i.length;++n){if("object"!==typeof e.columns[i[n]])throw TypeError(".CARTA.CatalogFilterResponse.columns: object expected");t.columns[i[n]]=s.CARTA.ColumnData.fromObject(e.columns[i[n]])}}return null!=e.subsetDataSize&&(t.subsetDataSize=0|e.subsetDataSize),null!=e.subsetEndIndex&&(t.subsetEndIndex=0|e.subsetEndIndex),null!=e.progress&&(t.progress=Number(e.progress)),null!=e.filterDataSize&&(t.filterDataSize=0|e.filterDataSize),null!=e.requestEndIndex&&(t.requestEndIndex=0|e.requestEndIndex),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.columns={}),t.defaults&&(n.fileId=0,n.imageFileId=0,n.regionId=0,n.subsetDataSize=0,n.subsetEndIndex=0,n.progress=0,n.filterDataSize=0,n.requestEndIndex=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&(n.imageFileId=e.imageFileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(n.regionId=e.regionId),e.columns&&(i=Object.keys(e.columns)).length){n.columns={};for(let r=0;r<i.length;++r)n.columns[i[r]]=s.CARTA.ColumnData.toObject(e.columns[i[r]],t)}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&(n.subsetDataSize=e.subsetDataSize),null!=e.subsetEndIndex&&e.hasOwnProperty("subsetEndIndex")&&(n.subsetEndIndex=e.subsetEndIndex),null!=e.progress&&e.hasOwnProperty("progress")&&(n.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),null!=e.filterDataSize&&e.hasOwnProperty("filterDataSize")&&(n.filterDataSize=e.filterDataSize),null!=e.requestEndIndex&&e.hasOwnProperty("requestEndIndex")&&(n.requestEndIndex=e.requestEndIndex),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ContourImageData=function(){function e(e){if(this.contourSets=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.referenceFileId=0,e.prototype.imageBounds=null,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.contourSets=a.emptyArray,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.referenceFileId&&Object.hasOwnProperty.call(e,"referenceFileId")&&t.uint32(21).fixed32(e.referenceFileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&s.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(37).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(45).sfixed32(e.stokes),null!=e.contourSets&&e.contourSets.length)for(let i=0;i<e.contourSets.length;++i)s.CARTA.ContourSet.encode(e.contourSets[i],t.uint32(50).fork()).ldelim();return null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(57).double(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ContourImageData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.referenceFileId=e.fixed32();break;case 3:n.imageBounds=s.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:n.channel=e.sfixed32();break;case 5:n.stokes=e.sfixed32();break;case 6:n.contourSets&&n.contourSets.length||(n.contourSets=[]),n.contourSets.push(s.CARTA.ContourSet.decode(e,e.uint32()));break;case 7:n.progress=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&!a.isInteger(e.referenceFileId))return"referenceFileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=s.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.contourSets&&e.hasOwnProperty("contourSets")){if(!Array.isArray(e.contourSets))return"contourSets: array expected";for(let t=0;t<e.contourSets.length;++t){let i=s.CARTA.ContourSet.verify(e.contourSets[t]);if(i)return"contourSets."+i}}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ContourImageData)return e;let t=new s.CARTA.ContourImageData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.referenceFileId&&(t.referenceFileId=e.referenceFileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.ContourImageData.imageBounds: object expected");t.imageBounds=s.CARTA.ImageBounds.fromObject(e.imageBounds)}if(null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.contourSets){if(!Array.isArray(e.contourSets))throw TypeError(".CARTA.ContourImageData.contourSets: array expected");t.contourSets=[];for(let i=0;i<e.contourSets.length;++i){if("object"!==typeof e.contourSets[i])throw TypeError(".CARTA.ContourImageData.contourSets: object expected");t.contourSets[i]=s.CARTA.ContourSet.fromObject(e.contourSets[i])}}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contourSets=[]),t.defaults&&(i.fileId=0,i.referenceFileId=0,i.imageBounds=null,i.channel=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&(i.referenceFileId=e.referenceFileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=s.CARTA.ImageBounds.toObject(e.imageBounds,t)),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.contourSets&&e.contourSets.length){i.contourSets=[];for(let n=0;n<e.contourSets.length;++n)i.contourSets[n]=s.CARTA.ContourSet.toObject(e.contourSets[n],t)}return null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ContourSet=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.level=0,e.prototype.decimationFactor=0,e.prototype.rawCoordinates=a.newBuffer([]),e.prototype.rawStartIndices=a.newBuffer([]),e.prototype.uncompressedCoordinatesSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.level&&Object.hasOwnProperty.call(e,"level")&&t.uint32(9).double(e.level),null!=e.decimationFactor&&Object.hasOwnProperty.call(e,"decimationFactor")&&t.uint32(16).int32(e.decimationFactor),null!=e.rawCoordinates&&Object.hasOwnProperty.call(e,"rawCoordinates")&&t.uint32(26).bytes(e.rawCoordinates),null!=e.rawStartIndices&&Object.hasOwnProperty.call(e,"rawStartIndices")&&t.uint32(34).bytes(e.rawStartIndices),null!=e.uncompressedCoordinatesSize&&Object.hasOwnProperty.call(e,"uncompressedCoordinatesSize")&&t.uint32(40).int32(e.uncompressedCoordinatesSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ContourSet;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.level=e.double();break;case 2:n.decimationFactor=e.int32();break;case 3:n.rawCoordinates=e.bytes();break;case 4:n.rawStartIndices=e.bytes();break;case 5:n.uncompressedCoordinatesSize=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.level&&e.hasOwnProperty("level")&&"number"!==typeof e.level?"level: number expected":null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&!a.isInteger(e.decimationFactor)?"decimationFactor: integer expected":null!=e.rawCoordinates&&e.hasOwnProperty("rawCoordinates")&&!(e.rawCoordinates&&"number"===typeof e.rawCoordinates.length||a.isString(e.rawCoordinates))?"rawCoordinates: buffer expected":null!=e.rawStartIndices&&e.hasOwnProperty("rawStartIndices")&&!(e.rawStartIndices&&"number"===typeof e.rawStartIndices.length||a.isString(e.rawStartIndices))?"rawStartIndices: buffer expected":null!=e.uncompressedCoordinatesSize&&e.hasOwnProperty("uncompressedCoordinatesSize")&&!a.isInteger(e.uncompressedCoordinatesSize)?"uncompressedCoordinatesSize: integer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ContourSet)return e;let t=new s.CARTA.ContourSet;return null!=e.level&&(t.level=Number(e.level)),null!=e.decimationFactor&&(t.decimationFactor=0|e.decimationFactor),null!=e.rawCoordinates&&("string"===typeof e.rawCoordinates?a.base64.decode(e.rawCoordinates,t.rawCoordinates=a.newBuffer(a.base64.length(e.rawCoordinates)),0):e.rawCoordinates.length&&(t.rawCoordinates=e.rawCoordinates)),null!=e.rawStartIndices&&("string"===typeof e.rawStartIndices?a.base64.decode(e.rawStartIndices,t.rawStartIndices=a.newBuffer(a.base64.length(e.rawStartIndices)),0):e.rawStartIndices.length&&(t.rawStartIndices=e.rawStartIndices)),null!=e.uncompressedCoordinatesSize&&(t.uncompressedCoordinatesSize=0|e.uncompressedCoordinatesSize),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.level=0,i.decimationFactor=0,t.bytes===String?i.rawCoordinates="":(i.rawCoordinates=[],t.bytes!==Array&&(i.rawCoordinates=a.newBuffer(i.rawCoordinates))),t.bytes===String?i.rawStartIndices="":(i.rawStartIndices=[],t.bytes!==Array&&(i.rawStartIndices=a.newBuffer(i.rawStartIndices))),i.uncompressedCoordinatesSize=0),null!=e.level&&e.hasOwnProperty("level")&&(i.level=t.json&&!isFinite(e.level)?String(e.level):e.level),null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&(i.decimationFactor=e.decimationFactor),null!=e.rawCoordinates&&e.hasOwnProperty("rawCoordinates")&&(i.rawCoordinates=t.bytes===String?a.base64.encode(e.rawCoordinates,0,e.rawCoordinates.length):t.bytes===Array?Array.prototype.slice.call(e.rawCoordinates):e.rawCoordinates),null!=e.rawStartIndices&&e.hasOwnProperty("rawStartIndices")&&(i.rawStartIndices=t.bytes===String?a.base64.encode(e.rawStartIndices,0,e.rawStartIndices.length):t.bytes===Array?Array.prototype.slice.call(e.rawStartIndices):e.rawStartIndices),null!=e.uncompressedCoordinatesSize&&e.hasOwnProperty("uncompressedCoordinatesSize")&&(i.uncompressedCoordinatesSize=e.uncompressedCoordinatesSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ErrorData=function(){function e(e){if(this.tags=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.severity=0,e.prototype.tags=a.emptyArray,e.prototype.message="",e.prototype.data="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.severity&&Object.hasOwnProperty.call(e,"severity")&&t.uint32(8).int32(e.severity),null!=e.tags&&e.tags.length)for(let i=0;i<e.tags.length;++i)t.uint32(18).string(e.tags[i]);return null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).string(e.data),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.ErrorData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.severity=e.int32();break;case 2:n.tags&&n.tags.length||(n.tags=[]),n.tags.push(e.string());break;case 3:n.message=e.string();break;case 4:n.data=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.severity&&e.hasOwnProperty("severity"))switch(e.severity){default:return"severity: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.tags&&e.hasOwnProperty("tags")){if(!Array.isArray(e.tags))return"tags: array expected";for(let t=0;t<e.tags.length;++t)if(!a.isString(e.tags[t]))return"tags: string[] expected"}return null!=e.message&&e.hasOwnProperty("message")&&!a.isString(e.message)?"message: string expected":null!=e.data&&e.hasOwnProperty("data")&&!a.isString(e.data)?"data: string expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.ErrorData)return e;let t=new s.CARTA.ErrorData;switch(e.severity){case"DEBUG":case 0:t.severity=0;break;case"INFO":case 1:t.severity=1;break;case"WARNING":case 2:t.severity=2;break;case"ERROR":case 3:t.severity=3;break;case"CRITICAL":case 4:t.severity=4}if(e.tags){if(!Array.isArray(e.tags))throw TypeError(".CARTA.ErrorData.tags: array expected");t.tags=[];for(let i=0;i<e.tags.length;++i)t.tags[i]=String(e.tags[i])}return null!=e.message&&(t.message=String(e.message)),null!=e.data&&(t.data=String(e.data)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tags=[]),t.defaults&&(i.severity=t.enums===String?"DEBUG":0,i.message="",i.data=""),null!=e.severity&&e.hasOwnProperty("severity")&&(i.severity=t.enums===String?s.CARTA.ErrorSeverity[e.severity]:e.severity),e.tags&&e.tags.length){i.tags=[];for(let t=0;t<e.tags.length;++t)i.tags[t]=e.tags[t]}return null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.data&&e.hasOwnProperty("data")&&(i.data=e.data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RasterTileSync=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.animationId=0,e.prototype.endSync=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(37).sfixed32(e.animationId),null!=e.endSync&&Object.hasOwnProperty.call(e,"endSync")&&t.uint32(40).bool(e.endSync),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RasterTileSync;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.animationId=e.sfixed32();break;case 5:n.endSync=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId)?"fileId: integer expected":null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes)?"stokes: integer expected":null!=e.animationId&&e.hasOwnProperty("animationId")&&!a.isInteger(e.animationId)?"animationId: integer expected":null!=e.endSync&&e.hasOwnProperty("endSync")&&"boolean"!==typeof e.endSync?"endSync: boolean expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RasterTileSync)return e;let t=new s.CARTA.RasterTileSync;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.animationId&&(t.animationId=0|e.animationId),null!=e.endSync&&(t.endSync=Boolean(e.endSync)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.animationId=0,i.endSync=!1),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),null!=e.endSync&&e.hasOwnProperty("endSync")&&(i.endSync=e.endSync),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RasterTileData=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.prototype.animationId=0,e.prototype.tiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(32).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(45).float(e.compressionQuality),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(53).sfixed32(e.animationId),null!=e.tiles&&e.tiles.length)for(let i=0;i<e.tiles.length;++i)s.CARTA.TileData.encode(e.tiles[i],t.uint32(58).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RasterTileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.compressionType=e.int32();break;case 5:n.compressionQuality=e.float();break;case 6:n.animationId=e.sfixed32();break;case 7:n.tiles&&n.tiles.length||(n.tiles=[]),n.tiles.push(s.CARTA.TileData.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}if(null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality)return"compressionQuality: number expected";if(null!=e.animationId&&e.hasOwnProperty("animationId")&&!a.isInteger(e.animationId))return"animationId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t){let i=s.CARTA.TileData.verify(e.tiles[t]);if(i)return"tiles."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.RasterTileData)return e;let t=new s.CARTA.RasterTileData;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}if(null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),null!=e.animationId&&(t.animationId=0|e.animationId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.RasterTileData.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i){if("object"!==typeof e.tiles[i])throw TypeError(".CARTA.RasterTileData.tiles: object expected");t.tiles[i]=s.CARTA.TileData.fromObject(e.tiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0,i.animationId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?s.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),e.tiles&&e.tiles.length){i.tiles=[];for(let n=0;n<e.tiles.length;++n)i.tiles[n]=s.CARTA.TileData.toObject(e.tiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.TileData=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.layer=0,e.prototype.x=0,e.prototype.y=0,e.prototype.width=0,e.prototype.height=0,e.prototype.imageData=a.newBuffer([]),e.prototype.nanEncodings=a.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.layer&&Object.hasOwnProperty.call(e,"layer")&&t.uint32(13).sfixed32(e.layer),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(21).sfixed32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(29).sfixed32(e.y),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(37).sfixed32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(45).sfixed32(e.height),null!=e.imageData&&Object.hasOwnProperty.call(e,"imageData")&&t.uint32(50).bytes(e.imageData),null!=e.nanEncodings&&Object.hasOwnProperty.call(e,"nanEncodings")&&t.uint32(58).bytes(e.nanEncodings),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.TileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.layer=e.sfixed32();break;case 2:n.x=e.sfixed32();break;case 3:n.y=e.sfixed32();break;case 4:n.width=e.sfixed32();break;case 5:n.height=e.sfixed32();break;case 6:n.imageData=e.bytes();break;case 7:n.nanEncodings=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.layer&&e.hasOwnProperty("layer")&&!a.isInteger(e.layer)?"layer: integer expected":null!=e.x&&e.hasOwnProperty("x")&&!a.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!a.isInteger(e.y)?"y: integer expected":null!=e.width&&e.hasOwnProperty("width")&&!a.isInteger(e.width)?"width: integer expected":null!=e.height&&e.hasOwnProperty("height")&&!a.isInteger(e.height)?"height: integer expected":null!=e.imageData&&e.hasOwnProperty("imageData")&&!(e.imageData&&"number"===typeof e.imageData.length||a.isString(e.imageData))?"imageData: buffer expected":null!=e.nanEncodings&&e.hasOwnProperty("nanEncodings")&&!(e.nanEncodings&&"number"===typeof e.nanEncodings.length||a.isString(e.nanEncodings))?"nanEncodings: buffer expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.TileData)return e;let t=new s.CARTA.TileData;return null!=e.layer&&(t.layer=0|e.layer),null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.width&&(t.width=0|e.width),null!=e.height&&(t.height=0|e.height),null!=e.imageData&&("string"===typeof e.imageData?a.base64.decode(e.imageData,t.imageData=a.newBuffer(a.base64.length(e.imageData)),0):e.imageData.length&&(t.imageData=e.imageData)),null!=e.nanEncodings&&("string"===typeof e.nanEncodings?a.base64.decode(e.nanEncodings,t.nanEncodings=a.newBuffer(a.base64.length(e.nanEncodings)),0):e.nanEncodings.length&&(t.nanEncodings=e.nanEncodings)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.layer=0,i.x=0,i.y=0,i.width=0,i.height=0,t.bytes===String?i.imageData="":(i.imageData=[],t.bytes!==Array&&(i.imageData=a.newBuffer(i.imageData))),t.bytes===String?i.nanEncodings="":(i.nanEncodings=[],t.bytes!==Array&&(i.nanEncodings=a.newBuffer(i.nanEncodings)))),null!=e.layer&&e.hasOwnProperty("layer")&&(i.layer=e.layer),null!=e.x&&e.hasOwnProperty("x")&&(i.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=e.y),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),null!=e.imageData&&e.hasOwnProperty("imageData")&&(i.imageData=t.bytes===String?a.base64.encode(e.imageData,0,e.imageData.length):t.bytes===Array?Array.prototype.slice.call(e.imageData):e.imageData),null!=e.nanEncodings&&e.hasOwnProperty("nanEncodings")&&(i.nanEncodings=t.bytes===String?a.base64.encode(e.nanEncodings,0,e.nanEncodings.length):t.bytes===Array?Array.prototype.slice.call(e.nanEncodings):e.nanEncodings),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionHistogramData=function(){function e(e){if(this.histograms=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stokes=0,e.prototype.histograms=a.emptyArray,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.histograms&&e.histograms.length)for(let i=0;i<e.histograms.length;++i)s.CARTA.Histogram.encode(e.histograms[i],t.uint32(34).fork()).ldelim();return null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(45).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionHistogramData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.histograms&&n.histograms.length||(n.histograms=[]),n.histograms.push(s.CARTA.Histogram.decode(e,e.uint32()));break;case 5:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.histograms&&e.hasOwnProperty("histograms")){if(!Array.isArray(e.histograms))return"histograms: array expected";for(let t=0;t<e.histograms.length;++t){let i=s.CARTA.Histogram.verify(e.histograms[t]);if(i)return"histograms."+i}}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionHistogramData)return e;let t=new s.CARTA.RegionHistogramData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.stokes&&(t.stokes=0|e.stokes),e.histograms){if(!Array.isArray(e.histograms))throw TypeError(".CARTA.RegionHistogramData.histograms: array expected");t.histograms=[];for(let i=0;i<e.histograms.length;++i){if("object"!==typeof e.histograms[i])throw TypeError(".CARTA.RegionHistogramData.histograms: object expected");t.histograms[i]=s.CARTA.Histogram.fromObject(e.histograms[i])}}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.histograms=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.histograms&&e.histograms.length){i.histograms=[];for(let n=0;n<e.histograms.length;++n)i.histograms[n]=s.CARTA.Histogram.toObject(e.histograms[n],t)}return null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionStatsData=function(){function e(e){if(this.statistics=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.statistics=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(29).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(37).sfixed32(e.stokes),null!=e.statistics&&e.statistics.length)for(let i=0;i<e.statistics.length;++i)s.CARTA.StatisticsValue.encode(e.statistics[i],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.RegionStatsData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.channel=e.sfixed32();break;case 4:n.stokes=e.sfixed32();break;case 5:n.statistics&&n.statistics.length||(n.statistics=[]),n.statistics.push(s.CARTA.StatisticsValue.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.statistics&&e.hasOwnProperty("statistics")){if(!Array.isArray(e.statistics))return"statistics: array expected";for(let t=0;t<e.statistics.length;++t){let i=s.CARTA.StatisticsValue.verify(e.statistics[t]);if(i)return"statistics."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.RegionStatsData)return e;let t=new s.CARTA.RegionStatsData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.statistics){if(!Array.isArray(e.statistics))throw TypeError(".CARTA.RegionStatsData.statistics: array expected");t.statistics=[];for(let i=0;i<e.statistics.length;++i){if("object"!==typeof e.statistics[i])throw TypeError(".CARTA.RegionStatsData.statistics: object expected");t.statistics[i]=s.CARTA.StatisticsValue.fromObject(e.statistics[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statistics=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.channel=0,i.stokes=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.statistics&&e.statistics.length){i.statistics=[];for(let n=0;n<e.statistics.length;++n)i.statistics[n]=s.CARTA.StatisticsValue.toObject(e.statistics[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpatialProfileData=function(){function e(e){if(this.profiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.x=0,e.prototype.y=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.value=0,e.prototype.profiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(29).sfixed32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(37).sfixed32(e.y),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(45).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(53).sfixed32(e.stokes),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(61).float(e.value),null!=e.profiles&&e.profiles.length)for(let i=0;i<e.profiles.length;++i)s.CARTA.SpatialProfile.encode(e.profiles[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SpatialProfileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.x=e.sfixed32();break;case 4:n.y=e.sfixed32();break;case 5:n.channel=e.sfixed32();break;case 6:n.stokes=e.sfixed32();break;case 7:n.value=e.float();break;case 8:n.profiles&&n.profiles.length||(n.profiles=[]),n.profiles.push(s.CARTA.SpatialProfile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.x&&e.hasOwnProperty("x")&&!a.isInteger(e.x))return"x: integer expected";if(null!=e.y&&e.hasOwnProperty("y")&&!a.isInteger(e.y))return"y: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!a.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value)return"value: number expected";if(null!=e.profiles&&e.hasOwnProperty("profiles")){if(!Array.isArray(e.profiles))return"profiles: array expected";for(let t=0;t<e.profiles.length;++t){let i=s.CARTA.SpatialProfile.verify(e.profiles[t]);if(i)return"profiles."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SpatialProfileData)return e;let t=new s.CARTA.SpatialProfileData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.value&&(t.value=Number(e.value)),e.profiles){if(!Array.isArray(e.profiles))throw TypeError(".CARTA.SpatialProfileData.profiles: array expected");t.profiles=[];for(let i=0;i<e.profiles.length;++i){if("object"!==typeof e.profiles[i])throw TypeError(".CARTA.SpatialProfileData.profiles: object expected");t.profiles[i]=s.CARTA.SpatialProfile.fromObject(e.profiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.profiles=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.x=0,i.y=0,i.channel=0,i.stokes=0,i.value=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.x&&e.hasOwnProperty("x")&&(i.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=e.y),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),e.profiles&&e.profiles.length){i.profiles=[];for(let n=0;n<e.profiles.length;++n)i.profiles[n]=s.CARTA.SpatialProfile.toObject(e.profiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralProfileData=function(){function e(e){if(this.profiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stokes=0,e.prototype.progress=0,e.prototype.profiles=a.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(37).float(e.progress),null!=e.profiles&&e.profiles.length)for(let i=0;i<e.profiles.length;++i)s.CARTA.SpectralProfile.encode(e.profiles[i],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new s.CARTA.SpectralProfileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.progress=e.float();break;case 5:n.profiles&&n.profiles.length||(n.profiles=[]),n.profiles.push(s.CARTA.SpectralProfile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!a.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!a.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!a.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress)return"progress: number expected";if(null!=e.profiles&&e.hasOwnProperty("profiles")){if(!Array.isArray(e.profiles))return"profiles: array expected";for(let t=0;t<e.profiles.length;++t){let i=s.CARTA.SpectralProfile.verify(e.profiles[t]);if(i)return"profiles."+i}}return null},e.fromObject=function(e){if(e instanceof s.CARTA.SpectralProfileData)return e;let t=new s.CARTA.SpectralProfileData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.progress&&(t.progress=Number(e.progress)),e.profiles){if(!Array.isArray(e.profiles))throw TypeError(".CARTA.SpectralProfileData.profiles: array expected");t.profiles=[];for(let i=0;i<e.profiles.length;++i){if("object"!==typeof e.profiles[i])throw TypeError(".CARTA.SpectralProfileData.profiles: object expected");t.profiles[i]=s.CARTA.SpectralProfile.fromObject(e.profiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.profiles=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),e.profiles&&e.profiles.length){i.profiles=[];for(let n=0;n<e.profiles.length;++n)i.profiles[n]=s.CARTA.SpectralProfile.toObject(e.profiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e})()},55:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(0),r=i(47),o=i(4);i(964);class a extends n.Component{render(){let e="custom-icon bp3-icon";o.e.Instance.darkTheme&&(e+=" dark-theme");const t=(this.props.size?this.props.size:a.SIZE_STANDARD)+"px",i=n.createElement("span",{className:e},n.createElement("svg",{width:t,height:t,viewBox:"0 0 16 16"},s[this.props.icon]));return n.createElement(r.w,{icon:i})}}a.SIZE_STANDARD=16,a.SIZE_LARGE=20;const s={contour:n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 13.3086,13.326331 A 7.489923,8.4952736 45 0 1 2.0053593,14.037221 7.489923,8.4952736 45 0 1 2.7162497,2.7339802 7.489923,8.4952736 45 0 1 14.01949,2.02309 7.489923,8.4952736 45 0 1 13.3086,13.326331 Z M 13.148613,12.347604 A 6.6468272,7.6124401 40 0 1 3.1636657,13.906573 6.6468272,7.6124401 40 0 1 2.9650831,3.8026076 6.6468272,7.6124401 40 0 1 12.95003,2.2436383 6.6468272,7.6124401 40 0 1 13.148613,12.347604 Z M 10.882979,12.264102 A 4.8685541,5.7219758 50 0 1 3.3702451,12.212588 4.8685541,5.7219758 50 0 1 4.6240863,4.8050444 4.8685541,5.7219758 50 0 1 12.136821,4.8565581 4.8685541,5.7219758 50 0 1 10.882979,12.264102 Z M 10.33713,11.668778 A 4.0524521,4.8181229 50 0 1 4.0413674,11.66145 4.0524521,4.8181229 50 0 1 5.1273981,5.4600614 4.0524521,4.8181229 50 0 1 11.42316,5.4673901 4.0524521,4.8181229 50 0 1 10.33713,11.668778 Z M 7.9142814,10.852556 A 2.047241,2.547725 60 0 1 4.6842662,10.353456 2.047241,2.547725 60 0 1 5.8670405,7.3066306 2.047241,2.547725 60 0 1 9.0970556,7.8057308 2.047241,2.547725 60 0 1 7.9142814,10.852556 Z M 7.5029842,10.217581 A 1.2341059,1.684913 60 0 1 5.426754,9.9912708 1.2341059,1.684913 60 0 1 6.2688783,8.0800472 1.2341059,1.684913 60 0 1 8.3451088,8.3063578 1.2341059,1.684913 60 0 1 7.5029842,10.217581 Z"}),center:n.createElement("g",{fillRule:"evenodd",clipRule:"evenodd"},n.createElement("circle",{className:"st0",cx:"8",cy:"8",r:"2"}),n.createElement("path",{className:"st0",d:"M2.6,4H2C1.4,4,1,4.4,1,5s0.4,1,1,1h3c0.1,0,0.3,0,0.4-0.1c0.2-0.1,0.4-0.3,0.5-0.5C6,5.2,6,5.1,6,5V2 c0-0.6-0.4-1-1-1S4,1.4,4,2v0.6L1.7,0.3c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4L2.6,4z"}),n.createElement("path",{className:"st0",d:"M10.1,5.4c0.1,0.2,0.3,0.4,0.5,0.5S10.9,6,11.1,6h3c0.6,0,1-0.4,1-1s-0.4-1-1-1h-0.6l2.3-2.3 c0.4-0.4,0.4-1,0-1.4c-0.4-0.4-1-0.4-1.4,0L12,2.6V2c0-0.6-0.4-1-1-1s-1,0.4-1,1v3C10,5.1,10,5.2,10.1,5.4z"}),n.createElement("path",{className:"st0",d:"M13.4,12H14c0.6,0,1-0.4,1-1s-0.4-1-1-1h-3c-0.1,0-0.3,0-0.4,0.1c-0.2,0.1-0.4,0.3-0.5,0.5 C10,10.8,10,10.9,10,11v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-0.6l2.3,2.3c0.4,0.4,1,0.4,1.4,0c0.4-0.4,0.4-1,0-1.4L13.4,12z"}),n.createElement("path",{className:"st0",d:"M5.9,10.6c-0.1-0.2-0.3-0.4-0.5-0.5C5.2,10,5.1,10,4.9,10H2c-0.6,0-1,0.4-1,1s0.4,1,1,1h0.6l-2.3,2.3 c-0.4,0.4-0.4,1,0,1.4c0.4,0.4,1,0.4,1.4,0L4,13.4V14c0,0.6,0.4,1,1,1s1-0.4,1-1v-3C6,10.9,6,10.8,5.9,10.6z"})),regionList:n.createElement("g",null,n.createElement("g",{id:"Layer_1-2","data-name":"Layer 1"},n.createElement("path",{className:"cls-1",d:"M1,6H8A.9448.9448,0,0,0,9,5,.9448.9448,0,0,0,8,4H1A1,1,0,0,0,1,6Zm9,6H1a1,1,0,0,0,0,2h9a1,1,0,0,0,0-2Zm0-4H1a1,1,0,0,0,0,2h9a.9448.9448,0,0,0,1-1A.9448.9448,0,0,0,10,8Z"})),n.createElement("path",{d:"M15.6169,5.6628a2.6806,2.6806,0,0,1-.0932-.4019,3.6675,3.6675,0,0,1-.04-.4307q-.0089-.2191-.0244-.43a3.8144,3.8144,0,0,0-.0694-.4062,1.2166,1.2166,0,0,0-.1382-.3533A.8941.8941,0,0,0,15,3.3679a1.0366,1.0366,0,0,0-.4106-.1623V3.1894a1.2325,1.2325,0,0,0,.7676-.5444,1.7581,1.7581,0,0,0,.24-.9262A1.3974,1.3974,0,0,0,15.13.6063,1.9077,1.9077,0,0,0,13.8339.2h-2.73V6h.7722V3.5223h1.8847a1.0267,1.0267,0,0,1,.4549.0852.7677.7677,0,0,1,.2763.2275.9485.9485,0,0,1,.154.3332q.0486.1908.0813.4022a2.9046,2.9046,0,0,1,.049.43q.0078.22.0158.41a2.4616,2.4616,0,0,0,.037.3455A.48.48,0,0,0,14.9386,6H15.8A.9979.9979,0,0,1,15.6169,5.6628ZM14.423,2.6735a1.1087,1.1087,0,0,1-.4264.1583,3.079,3.079,0,0,1-.5117.0406H11.8765V.85h1.9171a1.0026,1.0026,0,0,1,.788.276,1.0431,1.0431,0,0,1,.2433.7149,1.0608,1.0608,0,0,1-.11.516A.8646.8646,0,0,1,14.423,2.6735Z"})),spatialProfiler:n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 8.3904279,2.3870306 6.5797618,4.9256964 h 0.961333 L 8.8850944,2.9283637 10.229094,4.9256964 h 1.017333 L 9.3797609,2.3216973 11.041094,0.10036468 h -0.952 L 8.8850944,1.7896974 7.7277615,0.10036468 h -1.017333 z M 13.818489,5.5696962 q -0.14,0.3546665 -0.28,0.5973331 -0.130667,0.2426666 -0.298667,0.3919999 -0.158666,0.1586666 -0.364,0.2239999 -0.196,0.074667 -0.457333,0.074667 -0.14,0 -0.28,-0.018667 -0.14,-0.018667 -0.270666, -0.065333 V 6.045696 q 0.102666,0.046667 0.233333,0.074667 0.14,0.037333 0.233333,0.037333 0.242667,0 0.401333,-0.1213333 0.168,-0.112 0.252,-0.3266666 L 13.314489,4.8976964 11.401156,0.10036468 h 0.896 l 1.409333, 3.94799862 h 0.01867 l 1.353333,-3.94799862 h 0.84 z"}),spectralProfiler:n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 11.225128,5.0020008 v 0.6933355 h 4.650681 V 4.8953338 H 12.355798 L 15.726475,0.79932088 V 0.18065225 h -4.288013 v 0.80000253 h 3.114676 z"}),stokes:n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 12.043082,4.1413775 h -0.906669 q 0.02133,0.5120017 0.213334,0.8746695 0.192,0.3520011 0.512001,0.5760018 0.320001,0.213334 0.736003,0.3093343 0.416001,0.096 0.874669,0.096 0.416002,0 0.832003,-0.085334 0.426668,-0.074667 0.757336, -0.2773342 0.341334,-0.2026673 0.544001,-0.533335 0.213334,-0.3306677 0.213334,-0.8320026 0,-0.394668 -0.16,-0.6613355 Q 15.50976,3.341375 15.253759,3.1707078 15.008425,2.9893739 14.677757,2.8827069 14.357756,2.7760399 14.016422, 2.701373 13.696421,2.6267061 13.37642,2.5627059 13.056419,2.488039 12.800418,2.3920387 12.544417,2.2853717 12.37375,2.1360379 q -0.16,-0.1600005 -0.16,-0.3946679 0,-0.213334 0.106667,-0.3413344 0.106667,-0.1386672 0.277334,-0.2133341 0.170667, -0.085334 0.373334,-0.1173337 0.213334,-0.032 0.416002,-0.032 0.224,0 0.437334,0.053334 0.224001,0.042667 0.405335,0.1493338 0.181334,0.1066671 0.298668,0.288001 0.117333,0.1706672 0.138667,0.4373347 H 15.57376 Q 15.54176,1.4640358 15.360426, 1.133368 15.179092,0.79203363 14.869758,0.60003303 14.57109,0.39736572 14.176422,0.32269882 13.781755,0.23736521 13.31242,0.23736521 q -0.362668,0 -0.736003,0.0960003 -0.362667,0.0853336 -0.661335,0.27733421 -0.288001,0.1813339 -0.480002, 0.48000147 -0.181333,0.2986677 -0.181333,0.714669 0,0.533335 0.266667,0.8320026 0.266668,0.2986676 0.661335,0.4693348 0.405335,0.1600005 0.87467,0.2560008 0.469335,0.085334 0.864003,0.2026673 0.405334,0.106667 0.672002,0.2880009 0.266667, 0.1813339 0.266667,0.5333351 0,0.2560008 -0.128,0.426668 -0.128001,0.1600005 -0.330668,0.2453341 -0.192,0.085334 -0.426668,0.1173337 -0.234667,0.032 -0.448001,0.032 -0.277334,0 -0.544002,-0.053334 -0.256001,-0.053333 -0.469335, -0.1706672 -0.202667,-0.1280004 -0.330668,-0.3306677 -0.128,-0.213334 -0.138667,-0.5120017 z"}),spectralLineQuery:n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M15.766554,6.815244l-1.355908,-1.360986c0.355481,-0.553535 0.563692,-1.208637 0.563692,-1.909443c0,-1.965304 -1.58951,-3.554814 -3.554814,-3.554814s-3.554814,1.58951 -3.554814,3.554814s1.58951,3.554814 3.554814,3.554814c0.705885,0 1.360986,-0.213289 1.909443,-0.563692l1.360986,1.355908c0.137114,0.137114 0.33009,0.223445 0.5383,0.223445c0.421499,0 0.761746,-0.340247 0.761746,-0.761746c0,-0.208211 -0.086331,-0.401186 -0.223445,-0.5383zm-4.34703,-0.731276c-1.401613,0 -2.539153,-1.137541 -2.539153,-2.539153s1.137541,-2.539153 2.539153,-2.539153s2.539153,1.137541 2.539153,2.539153s-1.137541,2.539153 -2.539153,2.539153z"}),smoothing:n.createElement("path",{strokeWidth:"2.42095",strokeLinecap:"round",fill:"none",d:"M 1.413244,14.6062 H 3.9277429 V 8.378223 H 6.9751347 V 1.4946692 H 9.5085614 L 14.575415,14.576401"}),moments:n.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 0.81609227,1.2562455 V 14.58427 H 3.5600972 V 5.2322526 h 0.037333 L 6.8641032,14.58427 H 9.1227739 L 12.389446,5.1389191 h 0.03733 V 14.58427 h 2.744005 V 1.2562455 H 11.045444 L 8.0961054,10.421595 H 8.058772 L 4.941433,1.2562455 Z"})}},564:function(e,t,i){e.exports=i(1014)},59:function(e,t,i){"use strict";i.d(t,"b",(function(){return p})),i.d(t,"a",(function(){return h}));var n=i(0),r=i(36),o=i(43),a=i.n(o),s=i(265),l=i(76),c=i(6),u=i(7);let p;!function(e){e[e.Automatic=0]="Automatic",e[e.Scientific=1]="Scientific",e[e.Integer=2]="Integer"}(p||(p={}));const d=i(265).Chart;d.defaults.multicolorLine=d.defaults.line,d.controllers.multicolorLine=d.controllers.line.extend({draw:function(e){let t=0;const i=this.getMeta(),n=i.data||[],r=this.getDataset().multicolorLineColors,o=this.chart.chartArea,a=i.dataset._children.filter((function(e){return!0}));if(r){for(let n=2;n<=r.length;n++)r[n-1]!==r[n]&&(s=r[n-1],i.dataset._view.borderColor=s,i.dataset._children=a.slice(t,n),i.dataset.draw(e),t=n-1);var s;for(let e=0;e<n.length;e++){n[e].draw(o)}}else d.controllers.line.prototype.draw.call(this,e)}});class h extends n.Component{constructor(...e){super(...e),this.plotRef=void 0,this.chartArea=void 0,this.afterChartLayout=e=>{if(this.props.isGroupSubPlot){var t=e.scales["x-axis-0"],i=e.scales["y-axis-0"];const n=e.width;e.chartArea.left=85,e.chartArea.right=n-1,t.left=85,t.right=n-1,t.width=t.right-t.left,t._startPixel=t.left,t._length=t.width,e.chartArea.left=85,e.chartArea.right=n-1,i.right=t.left,i.width=i.right-i.left}r.isEqual(e.chartArea,this.chartArea)||(this.chartArea=e.chartArea,this.props.chartAreaUpdated&&this.props.chartAreaUpdated(this.chartArea))},this.onRef=e=>{e!==this.plotRef&&(this.plotRef=e,this.props.plotRefUpdated&&this.props.plotRefUpdated(this.plotRef))},this.filterLogTicks=(e,t)=>{if(t&&t.length){let e=t.filter(e=>{const t=Math.floor(Math.log10(e)),i=e*Math.pow(10,t);return Math.abs(i%1)<1e-6});return e.length>8&&(e=t.filter(e=>Math.abs(Math.log10(e)%1)<.001||Math.abs(Math.log10(e/2)%1)<.001),e.length>8&&(e=t.filter(e=>Math.abs(Math.log10(e)%1)<.001))),e}return null},this.filterLinearTicks=(e,t)=>{let i=!1,n=!1;if(t&&t.length>=4){const e=Math.abs(t[2]-t[1]);Math.abs(t[1]-t[0])<.999*e&&(i=!0),Math.abs(t[t.length-1]-t[t.length-2])<.999*e&&(n=!0);const r=t.length>3?t[2]-t[1]:t[1]-t[0];for(let i=1;i<t.length-1;i++){const e=t[i];if(t[i-1]*t[i+1]<0&&Math.abs(e)<Math.abs(.001*r)){t[i]=0;break}}}return t.slice(i?1:0,n?-1:void 0)}}static GetCallbackForTickType(e){switch(e){case p.Scientific:return h.FormatTicksScientific;case p.Integer:return h.FormatTicksInteger;default:return h.FormatTicksAutomatic}}shouldComponentUpdate(e){const t=this.props;if(t.width!==e.width)return!0;if(t.height!==e.height)return!0;if(t.lineColor!==e.lineColor)return!0;if(t.opacity!==e.opacity)return!0;if(t.tickTypeX!==e.tickTypeX)return!0;if(t.tickTypeY!==e.tickTypeY)return!0;if(t.darkMode!==e.darkMode)return!0;if(t.logY!==e.logY)return!0;if(t.xLabel!==e.xLabel)return!0;if(t.xMin!==e.xMin)return!0;if(t.xMax!==e.xMax)return!0;if(t.yMin!==e.yMin)return!0;if(t.yMax!==e.yMax)return!0;if(t.yLabel!==e.yLabel)return!0;if(t.showTopAxis!==e.showTopAxis)return!0;if(t.topAxisTickFormatter!==e.topAxisTickFormatter)return!0;if(t.showXAxisTicks!==e.showXAxisTicks)return!0;if(t.showXAxisLabel!==e.showXAxisLabel)return!0;if(t.xZeroLineColor!==e.xZeroLineColor)return!0;if(t.yZeroLineColor!==e.yZeroLineColor)return!0;if(t.showLegend!==e.showLegend)return!0;if(t.xTickMarkLength!==e.xTickMarkLength)return!0;if(t.plotType!==e.plotType)return!0;if(t.dataBackgroundColor!==e.dataBackgroundColor)return!0;if(t.isGroupSubPlot!==e.isGroupSubPlot)return!0;if(t.pointRadius!==e.pointRadius)return!0;if(t.zeroLineWidth!==e.zeroLineWidth)return!0;if(t.borderWidth!==e.borderWidth)return!0;if(!t.data||!e.data||t.data.length!==e.data.length)return!0;for(let i=0;i<t.data.length;i++)if(t.data[i].x!==e.data[i].x||t.data[i].y!==e.data[i].y)return!0;if(!t.multiColorSingleLineColors||!e.multiColorSingleLineColors||t.multiColorSingleLineColors.length!==e.multiColorSingleLineColors.length)return!0;for(let i=0;i<t.multiColorSingleLineColors.length;i++)if(t.multiColorSingleLineColors[i]!==e.multiColorSingleLineColors[i])return!0;return!r.isEqual(t.multiPlotPropsMap,e.multiPlotPropsMap)}render(){const e=this.props.darkMode?l.a.LIGHT_GRAY4:l.a.GRAY1,t=this.props.darkMode?l.a.DARK_GRAY5:l.a.LIGHT_GRAY1;let i=this.props.lineColor||(this.props.darkMode?l.a.BLUE4:l.a.BLUE2);const r=Object(c.k)(this.props.opacity||1,0,1);r<1&&(i=a()(i).setAlpha(r).toRgbString());let o={maintainAspectRatio:!1,events:["mousedown","mouseup","mousemove","dblclick"],legend:{display:void 0!==this.props.showLegend&&this.props.showLegend},scales:{xAxes:[{id:"x-axis-0",position:"bottom",afterBuildTicks:this.filterLinearTicks,scaleLabel:{fontColor:e,display:void 0===this.props.showXAxisLabel||this.props.showXAxisLabel,labelString:this.props.xLabel},ticks:{display:void 0===this.props.showXAxisTicks||this.props.showXAxisTicks,minor:{fontColor:e},maxRotation:0,min:this.props.xMin,max:this.props.xMax,callback:h.GetCallbackForTickType(this.props.tickTypeX)},gridLines:{drawBorder:!1,color:t,zeroLineColor:this.props.xZeroLineColor?this.props.xZeroLineColor:t,zeroLineWidth:this.props.zeroLineWidth?this.props.zeroLineWidth:1,tickMarkLength:0===this.props.xTickMarkLength?this.props.xTickMarkLength:10}},{id:"x-axis-1",position:"top",afterBuildTicks:this.filterLinearTicks,type:"linear",display:this.props.showTopAxis,ticks:{minor:{fontColor:e},maxRotation:0,min:this.props.xMin,max:this.props.xMax}}],yAxes:[{id:"y-axis-0",scaleLabel:{fontColor:e,display:void 0===this.props.showYAxisLabel||this.props.showYAxisLabel,labelString:this.props.yLabel},ticks:{minor:{fontColor:e},display:void 0===this.props.showYAxisTicks||this.props.showYAxisTicks,min:this.props.yMin,max:this.props.yMax,callback:h.GetCallbackForTickType(this.props.tickTypeY)},gridLines:{drawBorder:!1,color:t,zeroLineColor:this.props.yZeroLineColor?this.props.yZeroLineColor:t,zeroLineWidth:this.props.zeroLineWidth?this.props.zeroLineWidth:1}}]},animation:{duration:0}};this.props.topAxisTickFormatter&&(o.scales.xAxes[1].ticks.callback=this.props.topAxisTickFormatter),this.props.logY?(o.scales.yAxes[0].afterBuildTicks=this.filterLogTicks,o.scales.yAxes[0].type="logarithmic"):(o.scales.yAxes[0].afterBuildTicks=this.filterLinearTicks,o.scales.yAxes[0].type="linear");let p=[];if(this.props.data&&this.props.data.length){const e={label:"LineGraph",type:"line",data:this.props.data,fill:!1,lineTension:0,order:this.props.order?this.props.order:0};this.props.plotType===u.j.POINTS?(e.showLine=!1,e.borderWidth=0,e.borderColor="rgba(0, 0, 0, 0)",e.pointRadius=this.props.pointRadius?this.props.pointRadius:1,e.pointBackgroundColor=i):(e.pointRadius=0,e.showLine=!0,e.steppedLine=this.props.plotType===u.j.STEPS&&"middle",e.borderWidth=this.props.borderWidth?this.props.borderWidth:1,e.borderColor=i),this.props.multiColorSingleLineColors&&this.props.multiColorSingleLineColors.length&&(this.props.plotType===u.j.POINTS?e.pointBackgroundColor=this.props.multiColorSingleLineColors:(e.pointRadius=.5,e.pointStyle="line",e.type="multicolorLine",e.multicolorLineColors=this.props.multiColorSingleLineColors)),this.props.dataBackgroundColor&&(e.pointBackgroundColor=this.props.dataBackgroundColor),p.push(e)}this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0&&this.props.multiPlotPropsMap.forEach((e,t)=>{let n=e.borderColor?e.borderColor:i;r<1&&(n=a()(n).setAlpha(r).toRgbString());const o={type:"line",label:t,data:e.data,fill:!1,lineTension:0,backgroundColor:n,order:e.order?e.order:0};this.props.multiColorMultiLinesColors&&this.props.multiColorMultiLinesColors.size&&(e.type===u.j.POINTS?(o.pointBackgroundColor=this.props.multiColorMultiLinesColors.get(t),o.borderColor=n,o.pointBorderColor="rgba(0, 0, 0, 0)"):o.multicolorLineColors=this.props.multiColorMultiLinesColors.get(t));let s=e.pointRadius?e.pointRadius:this.props.pointRadius,l=e.borderWidth?e.borderWidth:this.props.borderWidth;e.type===u.j.POINTS?(o.showLine=!1,o.pointStyle="circle",o.pointRadius=s||1,o.borderWidth=0):e.type!==u.j.LINES&&e.type!==u.j.STEPS||(o.showLine=!0,o.pointRadius=.5,o.pointStyle="line",o.steppedLine=e.type===u.j.STEPS&&"middle",o.borderWidth=l||1,o.type="multicolorLine",o.borderColor=n),p.push(o)});let d=[{afterLayout:this.afterChartLayout}];return n.createElement(s.Scatter,{data:{datasets:p},options:o,plugins:d,ref:this.onRef})}}h.FormatTicksScientific=(e,t,i)=>Object(c.jb)(e,2),h.FormatTicksInteger=(e,t,i)=>Object(c.kb)(e),h.FormatTicksAutomatic=(e,t,i)=>e},599:function(e){e.exports=JSON.parse('{"name":"carta-frontend","version":"2.0.0-dev.21.01.22","repository":"https://github.com/CARTAvis/carta-frontend","description":"The browser-based frontend component of CARTA, a radio-astronomy visualization tool designed for the ALMA, the VLA and the SKA pathfinders.","homepage":"./","devDependencies":{"@blueprintjs/core":"^3.36.0","@blueprintjs/icons":"^3.19.0","@blueprintjs/select":"^3.11.1","@blueprintjs/table":"3.7.1","@testing-library/jest-dom":"^4.2.4","@testing-library/react":"^9.5.0","@testing-library/user-event":"^7.2.1","@types/chart.js":"^2.9.20","@types/gapi":"0.0.39","@types/gapi.auth2":"0.0.52","@types/jest":"^24.9.1","@types/jquery":"^3.5.3","@types/lodash":"^4.14.162","@types/node":"^12.12.62","@types/plotly.js":"^1.54.0","@types/react":"^16.9.52","@types/react-color":"^3.0.1","@types/react-dom":"^16.9.8","@types/react-plotly.js":"^2.2.4","@types/react-resize-detector":"^5.0.0","@types/react-virtualized-auto-sizer":"^1.0.0","@types/react-window":"^1.8.2","@types/tinycolor2":"^1.4.2","ajv":"^6.12.6","axios":"^0.21.1","chart.js":"^2.9.3","fuzzy-search":"^3.2.1","glob-to-regexp":"^0.4.1","golden-layout":"^1.5.9","konva":"^7.0.3","lodash":"^4.17.15","mnemonist":"^0.38.0","mobx":"^6.0.1","mobx-react":"^7.0.0","moment":"^2.27.0","node-sass":"^4.14.1","npm-run-all":"^4.1.3","plotly.js":"^1.58.0","preval.macro":"^5.0.0","protobufjs":"6.9.0","raw-loader":"^4.0.2","react":"^16.14.0","react-chartjs-2":"^2.8.0","react-color":"^2.17.3","react-dom":"^16.14.0","react-iframe":"^1.8.0","react-konva":"^16.13.0-3","react-plotly.js":"^2.4.0","react-resize-detector":"^5.2.0","react-rnd":"^9.2.0","react-scripts":"3.4.3","react-scroll-to-bottom":"^4.0.0","react-split-pane":"^0.1.91","react-virtualized-auto-sizer":"^1.0.2","react-window":"^1.8.5","rxjs":"^6.5.2","source-map-explorer":"^2.1.0","tinycolor2":"^1.4.1","typescript":"^3.9.7","worker-loader":"^3.0.5"},"scripts":{"git-info":"echo export default {logMessage: \\\\\\"$(git log -1 --oneline)\\\\\\"}\\\\;  > src/static/gitInfo.ts","analyze":"source-map-explorer build/static/js/main.*","start":"npm run git-info; react-scripts start","build":"npm run git-info; npm-run-all build-wrappers build-protobuf build-ts","build-docker":"npm run git-info; npm-run-all build-wrappers-docker build-protobuf build-ts","build-singularity":"npm run git-info; npm-run-all build-wrappers-singularity build-protobuf build-ts","build-ts":"react-scripts --max_old_space_size=4096 build","build-libs":"./wasm_libs/build_libs.sh","build-libs-docker":"./build_wasm_libs_docker.sh","build-libs-singularity":"./build_wasm_libs_singularity.sh","build-wrappers":"./wasm_src/build_wrappers.sh","build-wrappers-docker":"./build_wasm_wrappers_docker.sh","build-wrappers-singularity":"./build_wasm_wrappers_singularity.sh","build-protobuf":"./protobuf/build_proto.sh","test":"react-scripts test --env=jsdom","eject":"react-scripts eject","prepack":"npm run build-libs-docker; npm run build-docker"},"eslintConfig":{"extends":"react-app","rules":{"no-unused-expressions":"off","@typescript-eslint/no-unused-expressions":"error","import/no-webpack-loader-syntax":"off","no-unused-vars":"off","@typescript-eslint/no-unused-vars":["error",{"args":"none"}],"jsx-a11y/alt-text":"off"}},"browserslist":{"production":["last 2 chrome versions","last 2 firefox versions","last 2 safari versions"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},6:function(e,t,i){"use strict";function n(e,t){if(!e||0===e.length||null===t||void 0===t||!isFinite(t))return null;const i=e.length,n=e[0].x<=e[i-1].x;if(n){if(t<=e[0].x)return{point:e[0],index:0};if(t>=e[i-1].x)return{point:e[i-1],index:i-1}}else{if(t>=e[0].x)return{point:e[0],index:0};if(t<=e[i-1].x)return{point:e[i-1],index:i-1}}let r=0,o=i-1;for(;r<=o;){let i=Math.floor((r+o)/2);if(t===e[i].x)return{point:e[i],index:i};n?t<e[i].x?o=i-1:r=i+1:t>e[i].x?o=i-1:r=i+1}if(r>=e.length||r<0||o>=e.length||o<0)return null;const a=Math.abs(e[r].x-t)<Math.abs(t-e[o].x)?r:o;return{point:e[a],index:a}}i.d(t,"i",(function(){return n})),i.d(t,"q",(function(){return r})),i.d(t,"e",(function(){return c})),i.d(t,"z",(function(){return d})),i.d(t,"hb",(function(){return h})),i.d(t,"k",(function(){return g})),i.d(t,"l",(function(){return m})),i.d(t,"Z",(function(){return f})),i.d(t,"Y",(function(){return y})),i.d(t,"U",(function(){return b})),i.d(t,"D",(function(){return O})),i.d(t,"eb",(function(){return S})),i.d(t,"j",(function(){return C})),i.d(t,"S",(function(){return E})),i.d(t,"f",(function(){return T})),i.d(t,"ib",(function(){return v})),i.d(t,"Q",(function(){return A})),i.d(t,"cb",(function(){return x})),i.d(t,"N",(function(){return R})),i.d(t,"h",(function(){return k})),i.d(t,"ab",(function(){return F})),i.d(t,"db",(function(){return M})),i.d(t,"R",(function(){return D})),i.d(t,"T",(function(){return N})),i.d(t,"n",(function(){return L})),i.d(t,"gb",(function(){return z})),i.d(t,"fb",(function(){return W})),i.d(t,"X",(function(){return V})),i.d(t,"m",(function(){return B})),i.d(t,"g",(function(){return q})),i.d(t,"bb",(function(){return H})),i.d(t,"V",(function(){return Y})),i.d(t,"W",(function(){return X})),i.d(t,"mb",(function(){return K})),i.d(t,"P",(function(){return Q})),i.d(t,"s",(function(){return Z})),i.d(t,"c",(function(){return J})),i.d(t,"b",(function(){return ee})),i.d(t,"d",(function(){return te})),i.d(t,"jb",(function(){return ie})),i.d(t,"kb",(function(){return ne})),i.d(t,"w",(function(){return re})),i.d(t,"u",(function(){return oe})),i.d(t,"v",(function(){return ae})),i.d(t,"t",(function(){return se})),i.d(t,"nb",(function(){return le})),i.d(t,"J",(function(){return ce})),i.d(t,"a",(function(){return he})),i.d(t,"F",(function(){return ge})),i.d(t,"G",(function(){return me})),i.d(t,"O",(function(){return fe})),i.d(t,"p",(function(){return ye})),i.d(t,"o",(function(){return be})),i.d(t,"K",(function(){return Oe})),i.d(t,"M",(function(){return Ee})),i.d(t,"C",(function(){return Ie})),i.d(t,"lb",(function(){return we})),i.d(t,"B",(function(){return Te})),i.d(t,"E",(function(){return ve})),i.d(t,"H",(function(){return Ae})),i.d(t,"I",(function(){return xe})),i.d(t,"L",(function(){return Pe})),i.d(t,"x",(function(){return je})),i.d(t,"y",(function(){return ke})),i.d(t,"A",(function(){return Fe})),i.d(t,"r",(function(){return Me}));const r=(e,t,i)=>i.indexOf(e)===t;var o=i(79),a=i.n(o),s=i(76),l=i(4);const c=[s.a.BLUE3,s.a.GREEN3,s.a.ORANGE3,s.a.RED3,s.a.VERMILION3,s.a.ROSE3,s.a.VIOLET3,s.a.INDIGO3,s.a.COBALT3,s.a.TURQUOISE3,s.a.FOREST3,s.a.LIME3,s.a.GOLD3,s.a.SEPIA3,s.a.BLACK,s.a.DARK_GRAY3,s.a.GRAY3,s.a.LIGHT_GRAY3,s.a.WHITE];let u;const p=new Image;function d(e){const t=l.O.COLOR_MAPS_ALL.indexOf(e);if(u){var i;const e=null===(i=u)||void 0===i?void 0:i.getImageData(0,5*t+2,p.width-1,1);return{color:null===e||void 0===e?void 0:e.data,size:null===e||void 0===e?void 0:e.width}}return{color:new Uint8ClampedArray([0,0,0,0]),size:1}}function h(e,t,i,n,r){return n+(r-n)*function(e,t,i){return(e=g((e-t)/(i-t),0,1))*e*(3-2*e)}(e,t,i)}function g(e,t,i){return Math.min(i,Math.max(t,e))}function m(e,t,i=1e-6){return Math.abs(e-t)<i}function f(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function y(e,t){return.5*Math.atan2(t,e)*180/Math.PI}function b(e,t){return e/t*100}function O(e,t){if(!t||!t.length||!e||!e.bins.length)return[];const i=e.firstBinCenter-e.binWidth/2,n=e.binWidth,r=e.bins;let o=t.slice(),a=0,s=0;for(let c=0;c<r.length;c++)s+=r[c];if(0===s)return[];let l=[];for(let c=0;c<r.length&&o.length;c++){const e=a/s,t=(a+r[c])/s;let u=o[0]/100;for(;t>=u&&o.length;){const r=(u-e)/(t-e);l.push(i+n*(c+r)),o.shift(),u=o[0]/100}a+=r[c]}return l}function S(e,t,i=1e3,n=1.5){switch(t){case l.u.SQUARE:return e*e;case l.u.SQRT:return Math.sqrt(e);case l.u.LOG:return g(Math.log(i*e+1)/Math.log(i),0,1);case l.u.POWER:return(Math.pow(i,e)-1)/i;case l.u.GAMMA:return Math.pow(e,n);default:return e}}function C(e,t){return Math.pow(t,Math.ceil(Math.log(e)/Math.log(t)))}function E(e){if(e&&e.length){let t=-Number.MAX_VALUE,i=Number.MAX_VALUE;for(let n=e.length-1;n>=0;n--){const r=e[n];isNaN(r)||(r>t&&(t=r),r<i&&(i=r))}if(t!==-Number.MAX_VALUE&&i!==Number.MAX_VALUE)return{maxVal:t,minVal:i}}return{minVal:NaN,maxVal:NaN}}function I(e,t){return e.x*t.x+e.y*t.y}function w(e,t){return e.x*t.y-e.y*t.x}function T(e,t){return{x:e.x+t.x,y:e.y+t.y}}function v(e,t){return{x:e.x-t.x,y:e.y-t.y}}function A(e,t){return{x:.5*(e.x+t.x),y:.5*(e.y+t.y)}}function x(e,t){return{x:e.x*t,y:e.y*t}}function R(e){return Math.sqrt(I(e,e))}function P(e){const t=R(e);return{x:e.x/t,y:e.y/t}}function j(e){const t=R(e);return{mag:t,dir:{x:e.x/t,y:e.y/t}}}function k(e){let t={x:0,y:0};for(const i of e)t=T(t,i);return x(t,1/e.length)}function F(e,t){const i=Math.sin(t),n=Math.cos(t);return{x:n*e.x-i*e.y,y:i*e.x+n*e.y}}function M(e,t,i,n){return T(x(F(v(e,t),n),i),t)}function D(e){let t={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE},i={x:Number.MAX_VALUE,y:Number.MAX_VALUE};for(const n of e)!n||isNaN(n.x)||isNaN(n.y)||(t.x=Math.max(t.x,n.x),t.y=Math.max(t.y,n.y),i.x=Math.min(i.x,n.x),i.y=Math.min(i.y,n.y));return{maxPoint:t,minPoint:i}}function N(e){let t=-Number.MAX_VALUE,i=Number.MAX_VALUE;for(const n of e)n&&!isNaN(n.z)&&(t=Math.max(t,n.z),i=Math.min(i,n.z));return{maxVal:t,minVal:i}}function L(e,t,i){const n=v(i,t),r=P(n),o=I(v(e,t),r),a=T(t,x(r,o));return{point:a,bounded:o>=0&&o<=R(n),distance:R(v(e,a))}}function _(e,t,i,n){const r=v(n,i);if(w(r,v(e,n))*w(r,v(t,n))<0){const r=v(t,e);return w(r,v(i,t))*w(r,v(n,t))<0}return!1}function z(e){if(e.length<4)return!0;for(let t=0;t<e.length;t++){const i=e[t],n=e[(t+1)%e.length];for(let r=t+2;r<e.length;r++){if(_(i,n,e[r],e[(r+1)%e.length]))return!1}}return!0}function W(e,t){if(e.length<4)return!0;let i=e[(t+e.length)%e.length],n=e[(t+e.length+1)%e.length];for(let r=1;r<e.length;r++){if(_(i,n,e[(r+t)%e.length],e[(r+t+1)%e.length]))return!1}return!0}function G(e,t){const i=v(e,t);return Math.sqrt(i.x*i.x+i.y*i.y)}function V(e,t){const i=v(e,t);return i.x*i.x+i.y*i.y}function B(e,t){let i=Number.MAX_VALUE,n=0;for(let r=0;r<t.length;r++){const o=V(e,t[r]);o<i&&(i=o,n=r)}return n}function q(e,t){return e=P(e),t=P(t),Math.asin(w(e,t))}function H(e){return{x:Math.round(e.x),y:Math.round(e.y)}}p.src=a.a,p.onload=()=>{u=function(e,t){const i=document.createElement("canvas");return i.width=e,i.height=t,i.getContext("2d")}(p.width,p.height),u.drawImage(p,0,0,p.width,p.height,0,0,p.width,p.height)};var U=i(36);function Y(e,t){return"true"===e||"false"!==e&&t}function X(e,t){return isFinite(e)?e:t}function K(e){return e?e.replace(/\s\/\s?.*$/,""):""}function Q(e){const t={};return e.forEach((e,i)=>{t[i.toString()]=e}),t}function Z(e,t){return t(e)?[e]:U.flatten(U.map(e,e=>"object"===typeof e?Z(e,t):[]))}var $=i(10);function J(e,t,i){const n=Math.ceil(t.x/i.x),r=Math.ceil(t.y/i.y),o=Math.max(n,r),a=Math.ceil(Math.log2(o));return Math.pow(2,a-e)}function ee(e,t,i){if(!e||!isFinite(e.xMin)||!isFinite(e.xMax)||!isFinite(e.yMin)||!isFinite(e.yMax)||!isFinite(e.mip))return[];if(e.xMin>=e.xMax||e.yMin>=e.yMax||e.mip<=0)return[];if(!t||!i||!isFinite(t.x)||!isFinite(t.y)||!isFinite(i.x)||!isFinite(i.y))return[];if(i.x<=0||i.y<=0||t.x<=0||t.y<=0)return[];if(e.xMax<0||e.xMin>t.x||e.yMax<0||e.yMin>t.y)return[];const n=function(e,t,i){const n=Math.ceil(t.x/i.x),r=Math.ceil(t.y/i.y),o=Math.max(n,r);return Math.ceil(Math.log2(o))-Math.ceil(Math.log2(e))}(e.mip,t,i);if(n<0)return[new $.TileCoordinate(0,0,0)];const r=Math.max(0,e.xMin),o=Math.min(e.xMax,t.x),a=Math.max(0,e.yMin),s=Math.min(e.yMax,t.y),l=(e.mip,e.mip*i.x),c=e.mip*i.y,u=Math.floor(r/l),p=Math.ceil(o/l),d=Math.floor(a/c),h=Math.ceil(s/c),g=new Array((p-u)*(h-d));for(let m=u,f=0;m<p;m++)for(let e=d;e<h;e++,f++)g[f]=new $.TileCoordinate(m,e,n);return g}const te=299792458;function ie(e,t=0){return isFinite(e)&&isFinite(t)&&t>=0&&t<=20?e.toExponential(t):String(e)}function ne(e,t=0){return isFinite(e)&&isFinite(t)&&t>=0&&t<=20?e.toFixed(t):String(e)}function re(e){return null===e||isNaN(e)?null:e<.01?ie(e,2):ne(e,2)}function oe(e,t,i="",n=!0,r=!1){let o=ie(e,t);return n&&(o=o.replace(/0+e/,"e"),o=o.replace(".e",".0e"),o=o.replace("e+0","")),r&&e>=0&&(o=" "+o),i&&i.length&&(o=`${o} ${i}`),o}function ae(e){if(!isFinite(e))return null;let t="";return t=e<3?ne(1e3*e,4)+" MHz":e>=3&&e<1e3?ne(e,4)+" GHz":ne(e/1e3,4)+" THz",t}function se(e,t=-1){if(!isFinite(e))return null;let i="";return i=e<120?ne(e,t<0?6:t)+'"':e>=120&&e<7200?ne(e/60,t<0?3:t)+"'":ne(e/3600,t<0?3:t)+" deg",i}function le(e){if(isFinite(e)&&0!==e&&null!==e)return te/e}function ce(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)return null;return/^(\d+(\.\d+)?)"?$/.test(t)?parseFloat(RegExp.$1):/^(\d+(\.\d+)?)'$/.test(t)?60*parseFloat(RegExp.$1):/^(\d+(\.\d+)?)\s*deg(ree)?$/i.test(t)?3600*parseFloat(RegExp.$1):null}var ue=i(0),pe=i.n(ue);const de={WebGLErrorMessage:pe.a.createElement(pe.a.Fragment,null,pe.a.createElement("p",null,pe.a.createElement("b",null,"Could not load WebGL. Images will not be displayed properly.")),pe.a.createElement("p",null,pe.a.createElement("small",null," If you are using CARTA through a browser, please ensure your browser supports WebGL. If you are using the CARTA standalone app, please ensure you are not running in a remote desktop. ")))},he=WebGLRenderingContext;function ge(e,t,i){if(!e||!t||i!==he.VERTEX_SHADER&&i!==he.FRAGMENT_SHADER)return null;let n=e.createShader(i);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,he.COMPILE_STATUS)?n:(console.log(e.getShaderInfoLog(n)),null)}function me(e,t,i){if(!e)return null;let n=ge(e,t,he.VERTEX_SHADER),r=ge(e,i,he.FRAGMENT_SHADER),o=e.createProgram();return e.attachShader(o,n),e.attachShader(o,r),e.linkProgram(o),e.getProgramParameter(o,he.LINK_STATUS)?o:(console.log("Could not initialise shaders"),null)}function fe(e,t,i){return new Promise((n,r)=>{e||r();const o=new Image;o.onload=()=>{const t=e.createTexture();e.activeTexture(i),e.bindTexture(he.TEXTURE_2D,t),e.texImage2D(he.TEXTURE_2D,0,he.RGB,he.RGB,he.UNSIGNED_BYTE,o),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.NEAREST),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.NEAREST),n(t)},o.onerror=()=>r("Error loading image "+t),o.src=t})}function ye(e,t,i,n,r=he.NEAREST){if(!e)return null;const o=e.createTexture();return e.activeTexture(n),e.bindTexture(he.TEXTURE_2D,o),e.texImage2D(he.TEXTURE_2D,0,he.LUMINANCE,t,i,0,he.LUMINANCE,he.FLOAT,new Float32Array(t*i)),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,r),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,r),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),o}function be(e,t,i,n,r,o,a,s){e&&(e.bindTexture(he.TEXTURE_2D,t),e.activeTexture(n),e.texSubImage2D(he.TEXTURE_2D,0,a,s,r,o,he.LUMINANCE,he.FLOAT,i),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.NEAREST),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.NEAREST),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),e.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE))}function Oe(){const e=document.createElement("canvas").getContext("webgl"),t=null===e||void 0===e?void 0:e.getExtension("OES_texture_float");return e&&t?e:(l.b.Instance.showAlert(de.WebGLErrorMessage,"issue"),null)}var Se=i(5),Ce=i(22);function Ee(e,t){if(!e||!t)return!1;const i=/^-?\d{0,2}:\d{0,2}:(\d{1,2}(\.\d+)?)?$/,n=/^-?\d*:\d{0,2}:(\d{1,2}(\.\d+)?)?$/;return t===l.C.HMS?i.test(e):t===l.C.DMS?n.test(e):/^-?\d+(\.\d+)?$/.test(e)}function Ie(e){return e?e.entryType===Se.a.EntryType.FLOAT||e.entryType===Se.a.EntryType.INT?e.numericValue:parseFloat(e.value):NaN}function we(e,t,i=!0){return Ce.transformPoint(e,t.x,t.y,i)}function Te(e,t){if(e){const i=we(e,t),n=Ce.normalizeCoordinates(e,i.x,i.y),r=Ce.getFormattedCoordinates(e,n.x,n.y);if(r)return r}return null}function ve(e,t){if(e){return we(e,Ce.getWCSValueFromFormattedString(e,t),!1)}return null}function Ae(e,t,i,n){if(i===$.SpectralType.CHANNEL)return n;Ce.set(e,`System=${i}, StdOfRest=Helio`),Ce.set(t,`System=${i}, StdOfRest=Helio`);const r=Ce.transform3DPoint(e,0,0,n,!0);if(!r||!isFinite(r.z))return NaN;const o=Ce.transform3DPoint(t,0,0,0,!0),a=Ce.transform3DPoint(t,o.x,o.y,r.z,!1);return a&&isFinite(a.z)?a.z:NaN}function xe(e,t,i,n,r){if(i===$.SpectralType.CHANNEL||n>r)return[];Ce.set(e,`System=${i}, StdOfRest=Helio`),Ce.set(t,`System=${i}, StdOfRest=Helio`);const o=r-n+1,a=new Array(o);for(let s=0;s<o;s++){const i=Ce.transform3DPoint(e,1,1,n+s+1,!0);if(!i||!isFinite(i.z)||Re(i.z)){a[s]=NaN;continue}const r=Ce.transform3DPoint(t,1,1,1,!0),o=Ce.transform3DPoint(t,r.x,r.y,i.z,!1);o&&isFinite(o.z)&&!Re(i.z)?a[s]=o.z-1:a[s]=NaN}return a}function Re(e){return!isFinite(e)||e===-Number.MAX_VALUE}function Pe(e){return!e||Re(e.x)||Re(e.y)}function je(e,t,i,n,r,o){const a=2*Math.PI/o,s=new Float64Array(o),l=new Float64Array(o);for(let p=0;p<o;p++){const e=p*a,o=T(t,F({x:i*Math.cos(e),y:n*Math.sin(e)},r*Math.PI/180));s[p]=o.x,l[p]=o.y}const c=Ce.transformPointArrays(e,s,l,0),u=new Array(o);for(let p=0;p<o;p++)u[p]={x:c.x[p],y:c.y[p]};return u}function ke(e,t,i,n=!0){const r=function(e,t=!0){let i=0;const n=e.length;for(let r=1;r<n;r++)i+=G(e[r],e[r-1]);return t&&(i+=G(e[n-1],e[0])),i}(t,n)/i,o=t.length+(n?1:0),a=new Array;for(let l=1;l<o;l++){const e=t[l%t.length],i=t[l-1],{mag:n,dir:o}=j(v(e,i)),s=Math.round(n/r),c=n/s;a.push(i);for(let t=1;t<s;t++){const e=T(i,x(o,t*c));a.push(e)}}const s=a.length;if(s){const t=new Float64Array(s),i=new Float64Array(s);for(let e=0;e<s;e++)t[e]=a[e].x,i[e]=a[e].y;const n=Ce.transformPointArrays(e,t,i,0),r=new Array(s);for(let e=0;e<s;e++)r[e]={x:n.x[e],y:n.y[e]};return r}return[]}function Fe(e){switch(e){case Se.a.ColumnType.String:return"string";case Se.a.ColumnType.Uint8:return"uint8";case Se.a.ColumnType.Int8:return"int8";case Se.a.ColumnType.Uint16:return"uint16";case Se.a.ColumnType.Int16:return"int16";case Se.a.ColumnType.Uint32:return"uint32";case Se.a.ColumnType.Int32:return"int32";case Se.a.ColumnType.Uint64:return"uint64";case Se.a.ColumnType.Int64:return"int64";case Se.a.ColumnType.Float:return"float";case Se.a.ColumnType.Double:return"double";case Se.a.ColumnType.Bool:return"bool";default:return"unsupported"}}function Me(e,t){const i=t.length;let n;if(e.dataType===Se.a.ColumnType.String){const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}else if(e.dataType===Se.a.ColumnType.Bool){const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}else{if(e.dataType===Se.a.ColumnType.UnsupportedType)return{dataType:Se.a.ColumnType.UnsupportedType,data:[]};{const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}}return{dataType:e.dataType,data:n}}},61:function(e,t,i){"use strict";i.d(t,"a",(function(){return q})),i.d(t,"b",(function(){return H}));var n,r,o,a,s,l,c,u,p,d,h,g,m,f,y,b,O,S,C,E,I,w,T,v,A,x,R,P,j,k,F,M,D,N,L,_,z,W=i(3),G=i(2),V=(i(29),i(1)),B=i(6);let q;!function(e){e[e.LINEAR=0]="LINEAR",e[e.LOG=1]="LOG",e[e.SQRT=2]="SQRT",e[e.SQUARE=3]="SQUARE",e[e.POWER=4]="POWER",e[e.GAMMA=5]="GAMMA",e[e.EXP=6]="EXP",e[e.CUSTOM=7]="CUSTOM"}(q||(q={}));let H=(z=_=class e{constructor(e,t){this.preference=e,Object(W.a)(this,"scaling",r,this),Object(W.a)(this,"colorMapIndex",o,this),Object(W.a)(this,"contrast",a,this),Object(W.a)(this,"bias",s,this),Object(W.a)(this,"gamma",l,this),Object(W.a)(this,"alpha",c,this),Object(W.a)(this,"inverted",u,this),Object(W.a)(this,"channelHistogram",p,this),Object(W.a)(this,"cubeHistogram",d,this),Object(W.a)(this,"useCubeHistogram",h,this),Object(W.a)(this,"useCubeHistogramContours",g,this),Object(W.a)(this,"cubeHistogramProgress",m,this),Object(W.a)(this,"selectedPercentile",f,this),Object(W.a)(this,"stokes",y,this),Object(W.a)(this,"scaleMin",b,this),Object(W.a)(this,"scaleMax",O,this),Object(W.a)(this,"visible",S,this),this.frame=void 0,Object(W.a)(this,"setStokes",C,this),Object(W.a)(this,"setUseCubeHistogram",E,this),Object(W.a)(this,"setUseCubeHistogramContours",I,this),Object(W.a)(this,"setPercentileRank",w,this),Object(W.a)(this,"updateChannelHistogram",T,this),Object(W.a)(this,"updateCubeHistogram",v,this),Object(W.a)(this,"setCustomScale",A,this),Object(W.a)(this,"setColorMapIndex",x,this),Object(W.a)(this,"setColorMap",R,this),Object(W.a)(this,"setScaling",P,this),Object(W.a)(this,"setGamma",j,this),Object(W.a)(this,"setAlpha",k,this),Object(W.a)(this,"setInverted",F,this),Object(W.a)(this,"setVisible",M,this),Object(W.a)(this,"toggleVisibility",D,this),Object(W.a)(this,"updateSiblings",N,this),Object(W.a)(this,"updateFrom",L,this),Object(V.p)(this),this.frame=t;const i=e.percentile;this.selectedPercentile=[i,i,i,i],this.bias=0,this.contrast=1,this.alpha=e.scalingAlpha,this.gamma=e.scalingGamma,this.scaling=e.scaling,this.inverted=!1,this.cubeHistogramProgress=0,this.setColorMap(e.colormap),this.stokes=0,this.scaleMin=[0,0,0,0],this.scaleMax=[1,1,1,1],this.visible=!0}static IsScalingValid(t){return e.SCALING_TYPES.has(t)}static IsGammaValid(t){return t>=e.GAMMA_MIN&&t<=e.GAMMA_MAX}static IsColormapValid(t){return e.COLOR_MAPS_SELECTED.includes(t)}static IsPercentileValid(t){return e.PERCENTILE_RANKS.includes(t)}get colorMap(){return this.colorMapIndex>=0&&this.colorMapIndex<=e.COLOR_MAPS_ALL.length-1?e.COLOR_MAPS_ALL[this.colorMapIndex]:"Unknown"}get scalingName(){const t=e.SCALING_TYPES.get(this.scaling);return t||"Unknown"}get histogram(){return this.useCubeHistogram&&this.cubeHistogram?this.cubeHistogram:this.channelHistogram}get contourHistogram(){return this.useCubeHistogramContours&&this.cubeHistogram?this.cubeHistogram:this.channelHistogram}get scaleMinVal(){return this.scaleMin[this.stokes]}get scaleMaxVal(){return this.scaleMax[this.stokes]}get selectedPercentileVal(){return this.selectedPercentile[this.stokes]}get histogramMin(){if(this.histogram)return this.histogram.firstBinCenter-.5*this.histogram.binWidth}get histogramMax(){if(this.histogram)return this.histogram.firstBinCenter+(this.histogram.bins.length+.5)*this.histogram.binWidth}},_.SCALING_TYPES=new Map([[q.LINEAR,"Linear"],[q.LOG,"Log"],[q.SQRT,"Square root"],[q.SQUARE,"Squared"],[q.GAMMA,"Gamma"],[q.POWER,"Power"]]),_.COLOR_MAPS_ALL=["accent","afmhot","autumn","binary","Blues","bone","BrBG","brg","BuGn","BuPu","bwr","CMRmap","cool","coolwarm","copper","cubehelix","dark2","flag","gist_earth","gist_gray","gist_heat","gist_ncar","gist_rainbow","gist_stern","gist_yarg","GnBu","gnuplot","gnuplot2","gray","greens","greys","hot","hsv","inferno","jet","magma","nipy_spectral","ocean","oranges","OrRd","paired","pastel1","pastel2","pink","PiYG","plasma","PRGn","prism","PuBu","PuBuGn","PuOr","PuRd","purples","rainbow","RdBu","RdGy","RdPu","RdYlBu","RdYlGn","reds","seismic","set1","set2","set3","spectral","spring","summer","tab10","tab20","tab20b","tab20c","terrain","viridis","winter","Wistia","YlGn","YlGnBu","YlOrBr","YlOrRd"],_.COLOR_MAPS_SELECTED=["afmhot","Blues","coolwarm","cubehelix","gist_heat","gist_stern","gnuplot","gnuplot2","gray","greens","greys","hot","inferno","jet","magma","nipy_spectral","plasma","rainbow","RdBu","RdGy","reds","seismic","spectral","tab10","viridis"],_.PERCENTILE_RANKS=[90,95,99,99.5,99.9,99.95,99.99,100],_.GAMMA_MIN=0,_.GAMMA_MAX=2,n=z,r=Object(G.a)(n.prototype,"scaling",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(G.a)(n.prototype,"colorMapIndex",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(G.a)(n.prototype,"contrast",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(G.a)(n.prototype,"bias",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(G.a)(n.prototype,"gamma",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(G.a)(n.prototype,"alpha",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(G.a)(n.prototype,"inverted",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(G.a)(n.prototype,"channelHistogram",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(G.a)(n.prototype,"cubeHistogram",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(G.a)(n.prototype,"useCubeHistogram",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(G.a)(n.prototype,"useCubeHistogramContours",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(G.a)(n.prototype,"cubeHistogramProgress",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(G.a)(n.prototype,"selectedPercentile",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(G.a)(n.prototype,"stokes",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(G.a)(n.prototype,"scaleMin",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(G.a)(n.prototype,"scaleMax",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Object(G.a)(n.prototype,"visible",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(G.a)(n.prototype,"colorMap",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"colorMap"),n.prototype),Object(G.a)(n.prototype,"scalingName",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"scalingName"),n.prototype),Object(G.a)(n.prototype,"histogram",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"histogram"),n.prototype),Object(G.a)(n.prototype,"contourHistogram",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"contourHistogram"),n.prototype),Object(G.a)(n.prototype,"scaleMinVal",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"scaleMinVal"),n.prototype),Object(G.a)(n.prototype,"scaleMaxVal",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"scaleMaxVal"),n.prototype),Object(G.a)(n.prototype,"selectedPercentileVal",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"selectedPercentileVal"),n.prototype),C=Object(G.a)(n.prototype,"setStokes",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.stokes=e}}}),E=Object(G.a)(n.prototype,"setUseCubeHistogram",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e!==this.useCubeHistogram&&(this.useCubeHistogram=e,this.selectedPercentile[this.stokes]>0&&this.setPercentileRank(this.selectedPercentile[this.stokes]))}}}),I=Object(G.a)(n.prototype,"setUseCubeHistogramContours",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.useCubeHistogramContours=e}}}),Object(G.a)(n.prototype,"histogramMin",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"histogramMin"),n.prototype),Object(G.a)(n.prototype,"histogramMax",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"histogramMax"),n.prototype),w=Object(G.a)(n.prototype,"setPercentileRank",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.selectedPercentile[this.stokes]=e,100===e)return this.scaleMin[this.stokes]=this.histogramMin,this.scaleMax[this.stokes]=this.histogramMax,this.updateSiblings(),!0;if(e<0||e>100)return!1;const t=100-e,i=Object(B.D)(this.histogram,[t,e]);return 2===i.length&&(this.scaleMin[this.stokes]=i[0],this.scaleMax[this.stokes]=i[1],this.updateSiblings(),!0)}}}),T=Object(G.a)(n.prototype,"updateChannelHistogram",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channelHistogram=e,this.selectedPercentile[this.stokes]>0&&!this.useCubeHistogram&&this.setPercentileRank(this.selectedPercentile[this.stokes])}}}),v=Object(G.a)(n.prototype,"updateCubeHistogram",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.cubeHistogram=e,this.cubeHistogramProgress=t,this.selectedPercentile[this.stokes]>0&&this.useCubeHistogram&&this.setPercentileRank(this.selectedPercentile[this.stokes])}}}),A=Object(G.a)(n.prototype,"setCustomScale",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.scaleMin[this.stokes]=e,this.scaleMax[this.stokes]=t,this.selectedPercentile[this.stokes]=-1,this.updateSiblings()}}}),x=Object(G.a)(n.prototype,"setColorMapIndex",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorMapIndex=Object(B.k)(e,0,H.COLOR_MAPS_ALL.length-1)}}}),R=Object(G.a)(n.prototype,"setColorMap",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=H.COLOR_MAPS_ALL.indexOf(e);t>=0&&this.setColorMapIndex(t)}}}),P=Object(G.a)(n.prototype,"setScaling",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{H.SCALING_TYPES.has(e)&&(this.scaling=e,this.updateSiblings())}}}),j=Object(G.a)(n.prototype,"setGamma",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.gamma=e,this.updateSiblings()}}}),k=Object(G.a)(n.prototype,"setAlpha",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.alpha=e,this.updateSiblings()}}}),F=Object(G.a)(n.prototype,"setInverted",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.inverted=e}}}),M=Object(G.a)(n.prototype,"setVisible",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),D=Object(G.a)(n.prototype,"toggleVisibility",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),N=Object(G.a)(n.prototype,"updateSiblings",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;const t=null===(e=this.frame)||void 0===e?void 0:e.renderConfigSiblings;for(const i of t)i.renderConfig.updateFrom(this)}}}),L=Object(G.a)(n.prototype,"updateFrom",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scaling=e.scaling,this.alpha=e.alpha,this.gamma=e.gamma,this.scaleMin[this.stokes]=e.scaleMinVal,this.scaleMax[this.stokes]=e.scaleMaxVal,this.selectedPercentile[this.stokes]=-1}}}),n)},62:function(e,t,i){(function(t,n){var r="undefined"!==typeof r?r:{};r.locateFile=function(e,t){return"./"+e};var o,a={};for(o in r)r.hasOwnProperty(o)&&(a[o]=r[o]);var s=[],l=!1,c=!1,u=!1,p=!1;l="object"===typeof window,c="function"===typeof importScripts,u="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,p=!l&&!u&&!c;var d,h,g,m,f="";function y(e){return r.locateFile?r.locateFile(e,f):f+e}u?(f=c?i(119).dirname(f)+"/":n+"/",d=function(e,t){return g||(g=i(210)),m||(m=i(119)),e=m.normalize(e),g.readFileSync(e,t?null:"utf8")},h=function(e){var t=d(e,!0);return t.buffer||(t=new Uint8Array(t)),T(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),s=t.argv.slice(2),e.exports=r,t.on("uncaughtException",(function(e){if(!(e instanceof Me))throw e})),t.on("unhandledRejection",se),function(e){t.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(d=function(e){return read(e)}),h=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(T("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?s=scriptArgs:"undefined"!=typeof arguments&&(s=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(l||c)&&(c?f=self.location.href:document.currentScript&&(f=document.currentScript.src),f=0!==f.indexOf("blob:")?f.substr(0,f.lastIndexOf("/")+1):"",d=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var b=r.print||console.log.bind(console),O=r.printErr||console.warn.bind(console);for(o in a)a.hasOwnProperty(o)&&(r[o]=a[o]);a=null,r.arguments&&(s=r.arguments),r.thisProgram&&r.thisProgram,r.quit&&r.quit;var S,C,E=function(e){e};r.wasmBinary&&(S=r.wasmBinary),r.noExitRuntime&&r.noExitRuntime,"object"!==typeof WebAssembly&&O("no native wasm support detected");var I=new WebAssembly.Table({initial:57,maximum:57,element:"anyfunc"}),w=!1;function T(e,t){e||se("Assertion failed: "+t)}function v(e){var t=r["_"+e];return T(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function A(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);F(e,t=Fe(i),i)}return t},array:function(e){var t=Fe(e.length);return M(e,t),t}};var a=v(e),s=[],l=0;if(n)for(var c=0;c<n.length;c++){var u=o[i[c]];u?(0===l&&(l=je()),s[c]=u(n[c])):s[c]=n[c]}var p=a.apply(null,s);return p=function(e){return"string"===t?j(e):"boolean"===t?Boolean(e):e}(p),0!==l&&ke(l),p}function x(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?v(e):function(){return A(e,t,i,arguments)}}var R="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function P(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&R)return R.decode(e.subarray(t,r));for(var o="";t<r;){var a=e[t++];if(128&a){var s=63&e[t++];if(192!=(224&a)){var l=63&e[t++];if((a=224==(240&a)?(15&a)<<12|s<<6|l:(7&a)<<18|s<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(a);else{var c=a-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&a)<<6|s)}else o+=String.fromCharCode(a)}return o}function j(e,t){return e?P(L,e,t):""}function k(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++a);if(s<=127){if(i>=o)break;t[i++]=s}else if(s<=2047){if(i+1>=o)break;t[i++]=192|s>>6,t[i++]=128|63&s}else if(s<=65535){if(i+2>=o)break;t[i++]=224|s>>12,t[i++]=128|s>>6&63,t[i++]=128|63&s}else{if(i+3>=o)break;t[i++]=240|s>>18,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}}return t[i]=0,i-r}function F(e,t,i){return k(e,L,t,i)}"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function M(e,t){N.set(e,t)}var D,N,L,_,z=65536;function W(e,t){return e%t>0&&(e+=t-e%t),e}function G(e){D=e,r.HEAP8=N=new Int8Array(e),r.HEAP16=new Int16Array(e),r.HEAP32=_=new Int32Array(e),r.HEAPU8=L=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=new Float32Array(e),r.HEAPF64=new Float64Array(e)}var V=5250816,B=7776,q=r.INITIAL_MEMORY||16777216;function H(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?r.dynCall_v(i):r.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t(r)}}(C=r.wasmMemory?r.wasmMemory:new WebAssembly.Memory({initial:q/z,maximum:2147483648/z}))&&(D=C.buffer),q=D.byteLength,G(D),_[B>>2]=V;var U=[],Y=[],X=[],K=[];function Q(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)ee(r.preRun.shift());H(U)}function Z(){!0,H(Y)}function $(){H(X)}function J(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)te(r.postRun.shift());H(K)}function ee(e){U.unshift(e)}function te(e){K.unshift(e)}Math.abs,Math.ceil,Math.floor,Math.min;var ie=0,ne=null,re=null;function oe(e){ie++,r.monitorRunDependencies&&r.monitorRunDependencies(ie)}function ae(e){if(ie--,r.monitorRunDependencies&&r.monitorRunDependencies(ie),0==ie&&(null!==ne&&(clearInterval(ne),ne=null),re)){var t=re;re=null,t()}}function se(e){throw r.onAbort&&r.onAbort(e),b(e+=""),O(e),w=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function le(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}r.preloadedImages={},r.preloadedAudios={};var ce="data:application/octet-stream;base64,";function ue(e){return le(e,ce)}var pe="file://";function de(e){return le(e,pe)}var he="gsl_wrapper.wasm";function ge(){try{if(S)return new Uint8Array(S);if(h)return h(he);throw"both async and sync fetching of the wasm failed"}catch(O){se(O)}}function me(){return S||!l&&!c||"function"!==typeof fetch||de(he)?new Promise((function(e,t){e(ge())})):fetch(he,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+he+"'";return e.arrayBuffer()})).catch((function(){return ge()}))}function fe(){var e={env:Re,wasi_snapshot_preview1:Re};function t(e,t){var i=e.exports;r.asm=i,ae()}function i(e){t(e.instance)}function n(t){return me().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){O("failed to asynchronously prepare wasm: "+e),se(e)}))}if(oe(),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(o){return O("Module.instantiateWasm callback failed with error: "+o),!1}return function(){if(S||"function"!==typeof WebAssembly.instantiateStreaming||ue(he)||de(he)||"function"!==typeof fetch)return n(i);fetch(he,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return O("wasm streaming compile failed: "+e),O("falling back to ArrayBuffer instantiation"),n(i)}))}))}(),{}}function ye(){se()}function be(){return 7776}function Oe(e,t,i){L.copyWithin(e,t,t+i)}function Se(){return L.length}function Ce(e){try{return C.grow(e-D.byteLength+65535>>>16),G(C.buffer),1}catch(t){}}function Ee(e){e>>>=0;var t=Se();if(e>2147483648)return!1;for(var i=1;i<=4;i*=2){var n=t*(1+.2/i);if(n=Math.min(n,e+100663296),Ce(Math.min(2147483648,W(Math.max(16777216,e,n),65536))))return!0}return!1}ue(he)||(he=y(he)),Y.push({func:function(){Pe()}});var Ie={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var i=Ie.buffers[e];0===t||10===t?((1===e?b:O)(P(i,0)),i.length=0):i.push(t)},varargs:void 0,get:function(){return Ie.varargs+=4,_[Ie.varargs-4>>2]},getStr:function(e){return j(e)},get64:function(e,t){return e}};function we(e){return 0}function Te(e,t,i,n,r){}function ve(e,t,i,n){for(var r=0,o=0;o<i;o++){for(var a=_[t+8*o>>2],s=_[t+(8*o+4)>>2],l=0;l<s;l++)Ie.printChar(e,L[a+l]);r+=s}return _[n>>2]=r,0}function Ae(e){E(0|e)}var xe,Re={abort:ye,emscripten_get_sbrk_ptr:be,emscripten_memcpy_big:Oe,emscripten_resize_heap:Ee,fd_close:we,fd_seek:Te,fd_write:ve,memory:C,setTempRet0:Ae,table:I},Pe=(fe(),r.___wasm_call_ctors=function(){return(Pe=r.___wasm_call_ctors=r.asm.__wasm_call_ctors).apply(null,arguments)}),je=(r._filterBoxcar=function(){return(r._filterBoxcar=r.asm.filterBoxcar).apply(null,arguments)},r._filterGaussian=function(){return(r._filterGaussian=r.asm.filterGaussian).apply(null,arguments)},r._filterHanning=function(){return(r._filterHanning=r.asm.filterHanning).apply(null,arguments)},r._filterDecimation=function(){return(r._filterDecimation=r.asm.filterDecimation).apply(null,arguments)},r._filterBinning=function(){return(r._filterBinning=r.asm.filterBinning).apply(null,arguments)},r._filterSavitzkyGolay=function(){return(r._filterSavitzkyGolay=r.asm.filterSavitzkyGolay).apply(null,arguments)},r._malloc=function(){return(r._malloc=r.asm.malloc).apply(null,arguments)},r._free=function(){return(r._free=r.asm.free).apply(null,arguments)},r.___errno_location=function(){return(r.___errno_location=r.asm.__errno_location).apply(null,arguments)},r.stackSave=function(){return(je=r.stackSave=r.asm.stackSave).apply(null,arguments)}),ke=r.stackRestore=function(){return(ke=r.stackRestore=r.asm.stackRestore).apply(null,arguments)},Fe=r.stackAlloc=function(){return(Fe=r.stackAlloc=r.asm.stackAlloc).apply(null,arguments)};r.__growWasmMemory=function(){return(r.__growWasmMemory=r.asm.__growWasmMemory).apply(null,arguments)},r.dynCall_diii=function(){return(r.dynCall_diii=r.asm.dynCall_diii).apply(null,arguments)},r.dynCall_ii=function(){return(r.dynCall_ii=r.asm.dynCall_ii).apply(null,arguments)},r.dynCall_iii=function(){return(r.dynCall_iii=r.asm.dynCall_iii).apply(null,arguments)},r.dynCall_idi=function(){return(r.dynCall_idi=r.asm.dynCall_idi).apply(null,arguments)},r.dynCall_iiii=function(){return(r.dynCall_iiii=r.asm.dynCall_iiii).apply(null,arguments)},r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.dynCall_jiji).apply(null,arguments)},r.dynCall_iidiiii=function(){return(r.dynCall_iidiiii=r.asm.dynCall_iidiiii).apply(null,arguments)},r.dynCall_vii=function(){return(r.dynCall_vii=r.asm.dynCall_vii).apply(null,arguments)};function Me(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function De(e){function t(){xe||(xe=!0,r.calledRun=!0,w||(Z(),$(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),J()))}e=e||s,ie>0||(Q(),ie>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}if(r.ccall=A,r.cwrap=x,re=function e(){xe||De(),xe||(re=e)},r.run=De,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();De(),r.filterBoxcar=r.cwrap("filterBoxcar","number",["number","number","number","number"]),r.filterGaussian=r.cwrap("filterGaussian","number",["number","number","number","number","number"]),r.filterHanning=r.cwrap("filterHanning","number",["number","number","number","number"]),r.filterDecimation=r.cwrap("filterDecimation","number",["number","number","number","number","number"]),r.filterBinning=r.cwrap("filterBinning","number",["number","number","number","number"]),r.filterSavitzkyGolay=r.cwrap("filterSavitzkyGolay","number",["number","number","number","number","number","number"]),r.boxcarSmooth=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.yIn=r._malloc(8*i),r.yOut=r._malloc(8*i),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterBoxcar(r.yIn,i,r.yOut,t);var n=new Float64Array(r.HEAPF64.buffer,r.yOut,i).slice();return r._free(r.yIn),r._free(r.yOut),n},r.gaussianSmooth=function(e,t,i){if(!e)return new Float64Array(1);var n=e.length;r.yIn=r._malloc(8*n),r.yOut=r._malloc(8*n),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterGaussian(r.yIn,n,r.yOut,t,i);var o=new Float64Array(r.HEAPF64.buffer,r.yOut,n).slice();return r._free(r.yIn),r._free(r.yOut),o},r.hanningSmooth=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.yIn=r._malloc(8*i),r.yOut=r._malloc(8*i),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterHanning(r.yIn,i,r.yOut,t);var n=new Float64Array(r.HEAPF64.buffer,r.yOut,i).slice();return r._free(r.yIn),r._free(r.yOut),n},r.decimation=function(e,t,i){if(!t)return new Float64Array(1);var n=t.length;r.xIn=r._malloc(8*n),r.yIn=r._malloc(8*n);var o=n%i===1?2*Math.ceil(n/i)-1:2*Math.ceil(n/i);r.xOut=r._malloc(8*o),r.yOut=r._malloc(8*o),r.HEAPF64.set(new Float64Array(e),r.xIn/8),r.HEAPF64.set(new Float64Array(t),r.yIn/8),r.filterDecimation(r.xIn,r.yIn,n,r.xOut,r.yOut,o,i);var a=new Float64Array(r.HEAPF64.buffer,r.xOut,o).slice(),s=new Float64Array(r.HEAPF64.buffer,r.yOut,o).slice();return r._free(r.xIn),r._free(r.yIn),r._free(r.xOut),r._free(r.yOut),{x:a,y:s}},r.binning=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.input=r._malloc(8*i);var n=Math.ceil(i/t);r.output=r._malloc(8*n),r.HEAPF64.set(new Float64Array(e),r.input/8),r.filterBinning(r.input,i,r.output,t);var o=new Float64Array(r.HEAPF64.buffer,r.output,n).slice();return r._free(r.input),r._free(r.output),o},r.savitzkyGolaySmooth=function(e,t,i,n){if(!e||!t||n>=i)return new Float64Array(1);var o=e.length;r.xIn=r._malloc(8*o),r.yIn=r._malloc(8*o),r.yOut=r._malloc(8*o),r.HEAPF64.set(new Float64Array(e),r.xIn/8),r.HEAPF64.set(new Float64Array(t),r.yIn/8),r.filterSavitzkyGolay(r.xIn,r.yIn,o,r.yOut,i,n);var a=new Float64Array(r.HEAPF64.buffer,r.yOut,o).slice();return r._free(r.xIn),r._free(r.yIn),r._free(r.yOut),a},e.exports=r}).call(this,i(44),"/")},63:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"d",(function(){return m})),i.d(t,"e",(function(){return b})),i.d(t,"f",(function(){return le})),i.d(t,"k",(function(){return ue})),i.d(t,"i",(function(){return Ge})),i.d(t,"h",(function(){return Je})),i.d(t,"j",(function(){return nt})),i.d(t,"g",(function(){return ot})),i.d(t,"b",(function(){return Yt})),i.d(t,"c",(function(){return ti}));var n,r=i(0),o=i(14),a=i(8),s=i(47),l=i(91),c=i(4),u=i(10),p=(i(968),i(203));let d=Object(o.a)(n=class extends r.Component{render(){const e=c.r.Instance,t={icon:"info-sign",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!0,lazy:!0,isOpen:e.aboutDialogVisible,onClose:e.hideAboutDialog,className:"about-dialog",canEscapeKeyClose:!0,title:"About CARTA"};return r.createElement(m,{dialogProps:t,defaultWidth:620,defaultHeight:700,enableResizing:!1},r.createElement("div",{className:a.a.DIALOG_BODY},r.createElement("div",{className:"image-div"},r.createElement("img",{src:p,width:80}),r.createElement("h3",null,u.CARTA_INFO.acronym," ",u.CARTA_INFO.version," (",u.CARTA_INFO.date,")"),r.createElement("p",null,u.CARTA_INFO.fullName)),r.createElement("h3",null,"Development team:"),r.createElement("p",null,"The development of the CARTA project is a joint effort from:"),r.createElement("ul",null,r.createElement("li",null,r.createElement("a",{href:"https://www.asiaa.sinica.edu.tw/",rel:"noopener noreferrer",target:"_blank"},"Academia Sinica, Institute of Astronomy and Astrophysics (ASIAA)")),r.createElement("li",null,r.createElement("a",{href:"https://idia.ac.za/",rel:"noopener noreferrer",target:"_blank"},"Inter-University Institute for Data Intensive Astronomy (IDIA)")),r.createElement("li",null,r.createElement("a",{href:"https://science.nrao.edu/",rel:"noopener noreferrer",target:"_blank"},"National Radio Astronomy Observatory (NRAO)")),r.createElement("li",null,r.createElement("a",{href:"https://www.ualberta.ca/physics",rel:"noopener noreferrer",target:"_blank"},"Department of Physics, University of Alberta"))),r.createElement("h3",null,"Useful links:"),r.createElement("ul",null,r.createElement("li",null,"Source code for CARTA is available on ",r.createElement("a",{href:"https://github.com/cartavis",rel:"noopener noreferrer",target:"_blank"},"GitHub")),r.createElement("li",null,"Please report bugs or suggestions to the ",r.createElement("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw",rel:"noopener noreferrer",target:"_blank"},"CARTA helpdesk")," or file a ",r.createElement("a",{href:"https://github.com/CARTAvis/carta/issues",rel:"noopener noreferrer",target:"_blank"},"GitHub issue")),r.createElement("li",null,"Documentation is available ",r.createElement("a",{href:"https://carta.readthedocs.io/en/1.4",rel:"noopener noreferrer",target:"_blank"},"online"))),r.createElement("h3",null,"License"),r.createElement("p",{className:a.a.TEXT_SMALL},"Copyright (C) 2018-2021 ASIAA, IDIA, NRAO, and Department of Physics, University of Alberta. This program is free software; you can redistribute it and/or modify it under the terms of the\xa0",r.createElement("a",{href:"http://www.gnu.org/copyleft/gpl.html",rel:"noopener noreferrer",target:"_blank"},"GNU General Public License version 3"),"\xa0 as published by the Free Software Foundation.")),r.createElement("div",{className:a.a.DIALOG_FOOTER},r.createElement("div",{className:a.a.DIALOG_FOOTER_ACTIONS},r.createElement(s.b,{intent:l.a.NONE,onClick:e.hideAboutDialog,text:"Close"}))))}})||n;var h=i(32),g=i(201);i(969);class m extends r.Component{constructor(...e){super(...e),this.dd=void 0,this.rnd=void 0,this.onClickHelpButton=()=>{const e=this.rnd.draggable.state.x+.5*this.rnd.resizable.size.width;c.w.Instance.showHelpDrawer(this.props.helpType,e)}}componentDidUpdate(){const e=this.dd.getElementsByClassName("bp3-dialog-header");if(this.props.helpType&&e.length>0&&0===this.dd.getElementsByClassName("help-button").length){const t=r.createElement(s.e,{icon:"help",minimal:!0,onClick:this.onClickHelpButton}),i=document.createElement("div");i.setAttribute("class","help-button"),h.render(t,i);const n=this.dd.getElementsByClassName("bp3-dialog-close-button");n.length>0?n[0].before(i):e[0].append(i)}}render(){const e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0],o=e.innerWidth||i.clientWidth||n.clientWidth,a=e.innerHeight||i.clientHeight||n.clientHeight,l=this.props.enableResizing,c={top:l,bottom:l,left:l,right:l,topLeft:l,topRight:l,bottomLeft:l,bottomRight:l};return r.createElement("div",{className:"draggable-dialog",ref:e=>this.dd=e},this.props.dialogProps.isOpen&&r.createElement(g.a,{enableResizing:c,bounds:".gl-container-app",dragGrid:[1,1],resizeGrid:[25,25],default:{x:Math.floor(Math.max((o-this.props.defaultWidth)/2,0)),y:Math.floor(Math.max((a-this.props.defaultHeight)/2,0)),width:Math.min(this.props.defaultWidth,o),height:Math.min(this.props.defaultHeight,a)},minWidth:this.props.minWidth,minHeight:this.props.minHeight,dragHandleClassName:"bp3-dialog-header",ref:e=>{this.rnd=e}},r.createElement(s.l,Object.assign({hasBackdrop:!1,usePortal:!1,enforceFocus:!1,autoFocus:!0},this.props.dialogProps,{children:this.props.children}))))}}var f,y=i(439);i(970);let b=Object(o.a)(f=class extends r.Component{render(){const e=c.e.Instance;let t="iframe-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"info-sign",className:t,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.externalPageDialogVisible,onClose:e.dialogStore.hideExternalPageDialog,title:e.dialogStore.externalPageDialogTitle};return r.createElement(m,{dialogProps:i,minWidth:400,minHeight:400,defaultWidth:800,defaultHeight:600,enableResizing:!0},r.createElement("div",{className:"bp3-dialog-body"},r.createElement(y.a,{url:e.dialogStore.externalPageDialogUrl})))}})||f;var O,S,C,E,I,w,T,v,A,x=i(3),R=i(2),P=(i(29),i(36)),j=i(1),k=i(45),F=i(5),M=i(68),D=i(163),N=i(208),L=i(20),_=i(1024),z=i(69),W=i(435),G=i(441),V=i.n(G),B=i(129),q=i.n(B),H=i(114),U=i(6);i(972);let Y=Object(o.a)((A=v=class e extends r.Component{static GetFileTypeDisplay(t){return e.FileTypeMap.get(t)||{type:"Unknown",description:"An unknown file format"}}static GeCatalogFileTypeDisplay(t){return e.CatalogFileTypeMap.get(t)||{type:"Unknown",description:"An unknown file format"}}static GetFileSizeDisplay(e){return e>=1e12?Object(U.kb)(e/1e12,2)+" TB":e>=1e9?Object(U.kb)(e/1e9,1)+" GB":e>=1e6?Object(U.kb)(e/1e6,1)+" MB":e>=1e3?Object(U.kb)(e/1e3,1)+" kB":e+" B"}get tableEntries(){var t,i;const n=this.props.listResponse;if(!n)return[];const r=this.props.fileBrowserMode;let o=null===n||void 0===n||null===(t=n.subdirectories)||void 0===t?void 0:t.slice(),a=null===n||void 0===n||null===(i=n.files)||void 0===i?void 0:i.slice();const s=this.props.filterString,l=this.props.filterType;if(s)try{let e;if(l===c.t.Fuzzy){o=new H.a(o).search(s);a=new H.a(a,["name"]).search(s)}else if(l===c.t.Unix){var u,p;e=RegExp(V()(s.toLowerCase())),o=null===(u=o)||void 0===u?void 0:u.filter(t=>t.toLowerCase().match(e)),a=null===(p=a)||void 0===p?void 0:p.filter(t=>t.name.toLowerCase().match(e))}else{var d,h;e=RegExp(s),o=null===(d=o)||void 0===d?void 0:d.filter(t=>t.match(e)),a=null===(h=a)||void 0===h?void 0:h.filter(t=>t.name.match(e))}}catch(f){"SyntaxError"!==f.name&&console.log(f)}const g=[],m={direction:this.props.sortingString.startsWith("+")?1:-1,columnName:this.props.sortingString.substring(1).toLowerCase()};if(o&&o.length){"filename"===(null===m||void 0===m?void 0:m.columnName)&&o.sort((e,t)=>m.direction*(e.toLowerCase()<t.toLowerCase()?-1:1));for(const e of o)g.push({filename:e,isDirectory:!0})}if(a&&a.length){switch(null===m||void 0===m?void 0:m.columnName){case"filename":a.sort((e,t)=>m.direction*(e.name.toLowerCase()<t.name.toLowerCase()?-1:1));break;case"type":a.sort((e,t)=>m.direction*(e.type<t.type?-1:1));break;case"size":a.sort((e,t)=>m.direction*(e.size<t.size?-1:1));break;case"date":a.sort((e,t)=>m.direction*(e.date<t.date?-1:1))}if(r===c.g.Catalog)for(const t of a)g.push({filename:t.name,typeInfo:e.GeCatalogFileTypeDisplay(t.type),size:t.fileSize,date:t.date,fileInfo:t});else if(r===c.g.File)for(const t of a)for(const i of t.HDUList){const n=t.HDUList.length>1?`${t.name}: HDU ${i}`:t.name;g.push({filename:n,typeInfo:e.GetFileTypeDisplay(t.type),size:t.size,date:t.date,fileInfo:t,hdu:i})}else for(const t of a)g.push({filename:t.name,typeInfo:e.GetFileTypeDisplay(t.type),size:t.size,date:t.date,fileInfo:t})}return g}get selectedFiles(){var e,t;if(!(null===(e=this.tableEntries)||void 0===e?void 0:e.length)||!(null===(t=this.selectedRegions)||void 0===t?void 0:t.length))return[];const i=[];for(const n of this.selectedRegions)for(let e=n.rows[0];e<=n.rows[1];e++)if(e>=0&&e<this.tableEntries.length){const t=this.tableEntries[e];i.push(t)}return i}constructor(t){super(t),Object(x.a)(this,"selectedRegions",C,this),Object(x.a)(this,"columnWidths",E,this),this.tableRef=void 0,this.cachedFilterString=void 0,this.cachedSortingString=void 0,this.cachedFileResponse=void 0,this.rowPivotIndex=-1,Object(x.a)(this,"selectEntry",I,this),Object(x.a)(this,"handleColumnWidthChanged",w,this),this.renderColumnHeader=(e,t)=>{const i={direction:this.props.sortingString.startsWith("+")?1:-1,columnName:this.props.sortingString.substring(1).toLowerCase()},n=e.toLowerCase()===(null===i||void 0===i?void 0:i.columnName),o=(null===i||void 0===i?void 0:i.direction)<0;return r.createElement(D.a,{className:"column-name",nameRenderer:()=>n?r.createElement("div",{className:"sort-label",onClick:()=>this.props.onSortingChanged(e,-i.direction)},r.createElement(s.y,{className:"bp3-inline label"},r.createElement(s.w,{className:"sort-icon",icon:o?"sort-desc":"sort-asc"}),e)):r.createElement("div",{className:"sort-label",onClick:()=>this.props.onSortingChanged(e,1)},r.createElement(s.y,{className:"bp3-inline label"},r.createElement(s.w,{className:"sort-icon inactive",icon:"sort"}),e))})},this.renderFilenames=e=>{const t=this.tableEntries[e];return r.createElement(N.a,{className:t.isDirectory?"folder-cell":"filename-cell",tooltip:null===t||void 0===t?void 0:t.filename},r.createElement(r.Fragment,null,r.createElement("div",{onClick:i=>this.handleEntryClicked(i,t,e),onDoubleClick:()=>this.handleEntryDoubleClicked(t)},(null===t||void 0===t?void 0:t.isDirectory)&&r.createElement(s.w,{icon:"folder-close"}),r.createElement("span",{className:"cell-text"},null===t||void 0===t?void 0:t.filename))))},this.renderTypes=e=>{var t,i;const n=this.tableEntries[e];return r.createElement(N.a,{tooltip:null===(t=n.typeInfo)||void 0===t?void 0:t.description},r.createElement(r.Fragment,null,r.createElement("div",{onClick:t=>this.handleEntryClicked(t,n,e),onDoubleClick:()=>this.handleEntryDoubleClicked(n)},null===(i=n.typeInfo)||void 0===i?void 0:i.type)))},this.renderSizes=t=>{const i=this.tableEntries[t],n=null===i||void 0===i?void 0:i.size;return r.createElement(N.a,null,r.createElement(r.Fragment,null,r.createElement("div",{onClick:e=>this.handleEntryClicked(e,i,t),onDoubleClick:()=>this.handleEntryDoubleClicked(i)},isFinite(n)&&e.GetFileSizeDisplay(n))))},this.renderDates=e=>{const t=this.tableEntries[e],i=null===t||void 0===t?void 0:t.date;let n;if(i>0){const e=q.a.unix(i);n=0===q()(0,"HH").diff(e,"days")?e.format("HH:mm"):e.format("D MMM YYYY")}return r.createElement(N.a,{className:"time-cell"},r.createElement(r.Fragment,null,r.createElement("div",{onClick:i=>this.handleEntryClicked(i,t,e),onDoubleClick:()=>this.handleEntryDoubleClicked(t)},n)))},this.handleEntryDoubleClicked=e=>{e.isDirectory||this.props.onFileDoubleClicked(e)},Object(x.a)(this,"handleEntryClicked",T,this),Object(j.p)(this),Object(j.h)(()=>{const e=this.props.listResponse,t=this.props.sortingString,i=this.props.filterString;e===this.cachedFileResponse&&t===this.cachedSortingString&&i===this.cachedFilterString||(this.cachedSortingString=t,this.cachedFilterString=i,this.cachedFileResponse=e,Object(j.r)(()=>this.selectedRegions=[]),this.rowPivotIndex=-1,this.props.onSelectionChanged([]),setTimeout(()=>{var e;return null===(e=this.tableRef)||void 0===e?void 0:e.scrollToRegion(L.c.row(0,0))},20))})}render(){var t,i;const n=this.props.listResponse,o=(this.props.sortingString,["browser-table"]);this.props.darkTheme&&o.push("bp3-dark");const a=this.tableEntries.length;return((null===n||void 0===n||null===(t=n.files)||void 0===t?void 0:t.length)||0)+((null===n||void 0===n||null===(i=n.subdirectories)||void 0===i?void 0:i.length)||0)?a?r.createElement(_.a,{ref:e=>this.tableRef=e,className:o.join(" "),enableRowReordering:!1,renderMode:z.a.NONE,selectionModes:L.d.NONE,enableGhostCells:!1,columnWidths:this.columnWidths,minColumnWidth:80,enableMultipleSelection:!0,enableRowResizing:!1,defaultRowHeight:e.RowHeight,onColumnWidthChanged:this.handleColumnWidthChanged,selectedRegions:this.selectedRegions,enableRowHeader:!1,numRows:this.tableEntries.length,loadingOptions:this.props.loading?[L.e.CELLS]:[]},r.createElement(W.a,{name:"Filename",columnHeaderCellRenderer:()=>this.renderColumnHeader("Filename"),cellRenderer:this.renderFilenames}),r.createElement(W.a,{name:"Type",columnHeaderCellRenderer:()=>this.renderColumnHeader("Type"),cellRenderer:this.renderTypes}),r.createElement(W.a,{name:"Size",columnHeaderCellRenderer:()=>this.renderColumnHeader("Size"),cellRenderer:this.renderSizes}),r.createElement(W.a,{name:"Date",columnHeaderCellRenderer:()=>this.renderColumnHeader("Date"),cellRenderer:this.renderDates})):r.createElement(s.C,{icon:"search",title:"No results",description:"There are no files or subdirectories matching the filter expression"}):r.createElement(s.C,{icon:"folder-open",title:"Empty folder",description:"There are no files or subdirectories in this folder"})}},v.RowHeight=22,v.FileTypeMap=new Map([[F.a.FileType.CASA,{type:"CASA",description:"CASA Image"}],[F.a.FileType.CRTF,{type:"CRTF",description:"CASA Region Text Format"}],[F.a.FileType.DS9_REG,{type:"DS9",description:"DS9 Region Format"}],[F.a.FileType.FITS,{type:"FITS",description:"Flexible Image Transport System"}],[F.a.FileType.HDF5,{type:"HDF5",description:"HDF5 File (IDIA Schema)"}],[F.a.FileType.MIRIAD,{type:"Miriad",description:"Miriad Image"}]]),v.CatalogFileTypeMap=new Map([[F.a.CatalogFileType.FITSTable,{type:"FITS",description:"Flexible Image Transport System"}],[F.a.CatalogFileType.VOTable,{type:"VOTable",description:"XML-Based Table Format"}]]),S=A,C=Object(R.a)(S.prototype,"selectedRegions",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(R.a)(S.prototype,"columnWidths",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[350,80,90,95]}}),Object(R.a)(S.prototype,"tableEntries",[j.i],Object.getOwnPropertyDescriptor(S.prototype,"tableEntries"),S.prototype),Object(R.a)(S.prototype,"selectedFiles",[j.i],Object.getOwnPropertyDescriptor(S.prototype,"selectedFiles"),S.prototype),I=Object(R.a)(S.prototype,"selectEntry",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&(e.isDirectory?(this.props.onFolderClicked(e.filename),this.selectedRegions=void 0,this.rowPivotIndex=-1,this.props.onSelectionChanged([])):(this.props.onFileClicked(e),this.selectedRegions=[L.c.row(t)],this.rowPivotIndex=t,this.props.onSelectionChanged(this.selectedFiles)))}}}),w=Object(R.a)(S.prototype,"handleColumnWidthChanged",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e>=0&&e<this.columnWidths.length&&(this.columnWidths[e]=t)}}}),T=Object(R.a)(S.prototype,"handleEntryClicked",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(t)if(t.isDirectory)this.props.onFolderClicked(t.filename),this.selectedRegions=[],this.rowPivotIndex=-1;else{var n;if((e.ctrlKey||e.metaKey)&&this.selectedRegions.length){const e=L.c.row(i),t=L.c.findMatchingRegion(this.selectedRegions,e);-1===t?(this.selectedRegions.push(e),this.selectedRegions=this.selectedRegions.slice()):(this.selectedRegions=this.selectedRegions.filter(e=>e!==this.selectedRegions[t]),this.selectedRegions.length||(this.selectedRegions=[L.c.row(i)]))}else if(e.shiftKey&&this.selectedRegions.length){const e=L.c.row(this.rowPivotIndex,i);this.selectedRegions=[];for(let t=e.rows[0];t<=e.rows[1];t++)this.selectedRegions.push(L.c.row(t))}else this.selectedRegions=[L.c.row(i)],this.rowPivotIndex=i;1===(null===(n=this.selectedRegions)||void 0===n?void 0:n.length)&&this.props.onFileClicked(this.tableEntries[this.selectedRegions[0].rows[0]])}this.props.onSelectionChanged(this.selectedFiles)}}}),O=S))||O;var X,K,Q,Z,$,J,ee,te,ie,ne,re,oe,ae,se=i(7);i(973);let le=Object(o.a)((K=class e extends r.Component{constructor(e){super(e),Object(x.a)(this,"overwriteExistingFileAlertVisible",Q,this),Object(x.a)(this,"fileFilterString",Z,this),Object(x.a)(this,"debouncedFilterString",$,this),Object(x.a)(this,"selectedFiles",J,this),this.handleTabChange=e=>{c.s.Instance.setSelectedTab(e)},Object(x.a)(this,"handleSelectionChanged",ee,this),this.loadSelectedFiles=async()=>{const e=c.s.Instance;if(this.selectedFiles.length>1)for(let i=0;i<this.selectedFiles.length;i++)try{await this.loadFile(this.selectedFiles[i],i>0)}catch(t){console.log(t)}else await this.loadFile({fileInfo:e.selectedFile,hdu:e.selectedHDU})},this.loadFile=async(e,t=!1)=>{const i=c.e.Instance,n=i.fileBrowserStore;if(n.browserMode!==c.g.RegionExport){if(n.browserMode===c.g.File){const r=i.frames;(t||n.appendingFrame)&&r.length?await i.appendFile(n.fileList.directory,e.fileInfo.name,e.hdu):await i.openFile(n.fileList.directory,e.fileInfo.name,e.hdu)}else n.browserMode===c.g.Catalog?await i.appendCatalog(n.catalogFileList.directory,e.fileInfo.name,c.j.InitTableRows,F.a.CatalogFileType.VOTable):await i.importRegion(n.fileList.directory,e.fileInfo.name,e.fileInfo.type);n.saveStartingDirectory()}},this.handleSaveFileClicked=()=>{const e=c.e.Instance,t=c.s.Instance,i=t.saveFilename.trim();t.fileList&&t.fileList.files&&t.fileList.files.find(e=>e.name.trim()===i)?this.overwriteExistingFileAlertVisible=!0:e.saveFile(t.fileList.directory,i,t.saveFileType)},this.handleSaveFileNameChanged=e=>{c.s.Instance.setSaveFilename(e.target.value)},this.handleExportRegionsClicked=()=>{const e=c.s.Instance,t=e.exportFilename.trim();e.fileList&&e.fileList.files&&e.fileList.files.find(e=>e.name.trim()===t)?this.overwriteExistingFileAlertVisible=!0:this.exportRegion(e.fileList.directory,t)},this.handleOverwriteAlertConfirmed=()=>{this.overwriteExistingFileAlertVisible=!1;const e=c.s.Instance;if(e.browserMode===c.g.RegionExport){const t=e.exportFilename.trim();this.exportRegion(e.fileList.directory,t)}else if(e.browserMode===c.g.SaveFile){const t=c.e.Instance,i=e.saveFilename.trim();t.saveFile(e.fileList.directory,i,e.saveFileType)}},this.handleOverwriteAlertDismissed=()=>{this.overwriteExistingFileAlertVisible=!1},this.handleExportInputChanged=e=>{c.s.Instance.setExportFilename(e.target.value)},Object(x.a)(this,"handleFilterStringInputChanged",te,this),this.setFilterString=P.debounce(e=>Object(j.r)(()=>{this.debouncedFilterString=e}),500),Object(x.a)(this,"clearFilterString",ie,this),Object(x.a)(this,"handleFolderClicked",ne,this),Object(x.a)(this,"handleBreadcrumbClicked",re,this),Object(x.a)(this,"setFilterType",oe,this),Object(x.a)(this,"refreshFileList",ae,this),this.renderBreadcrumb=e=>r.createElement(s.c,{onClick:e.onClick,className:"folder-breadcrumb"},e.icon&&r.createElement(s.w,{iconSize:14,icon:e.icon}),e.text),Object(j.p)(this)}exportRegion(e,t){if(!t||!e)return;t=t.trim();const i=c.e.Instance,n=c.s.Instance;i.exportRegions(e,t,n.exportCoordinateType,n.exportFileType),console.log(`Exporting all regions to ${e}/${t}`)}static ValidateFilename(e){return e&&e.length&&!e.match(/(\.\.)|(\\)+/gm)}renderActionButton(t,i){const n=c.e.Instance,o=n.fileBrowserStore;var a,u;if(t===c.g.File)return i?r.createElement(s.W,{content:"Append this image while keeping other images open"},r.createElement(s.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!o.selectedFile||!o.fileInfoResp||o.loadingInfo,onClick:this.loadSelectedFiles,text:(null===(a=this.selectedFiles)||void 0===a?void 0:a.length)>1?"Append selected":"Append"})):r.createElement(s.W,{content:"Close any existing images and load this image"},r.createElement(s.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!o.selectedFile||!o.fileInfoResp||o.loadingInfo,onClick:this.loadSelectedFiles,text:(null===(u=this.selectedFiles)||void 0===u?void 0:u.length)>1?"Load selected":"Load"}));if(t===c.g.SaveFile)return r.createElement(s.W,{content:"Save this file"},r.createElement(s.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||o.loadingInfo,onClick:this.handleSaveFileClicked,text:"Save"}));if(t===c.g.RegionImport)return r.createElement(s.W,{content:"Load a region file for the currently active image"},r.createElement(s.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!o.selectedFile||!o.fileInfoResp||o.loadingInfo||!n.activeFrame,onClick:this.loadSelectedFiles,text:"Load Region"}));if(t===c.g.Catalog)return r.createElement(s.W,{content:"Load a catalog file for the currently active image"},r.createElement(s.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!o.selectedFile||!o.fileInfoResp||o.loadingInfo||!n.activeFrame,onClick:this.loadSelectedFiles,text:"Load Catalog"}));{const t=n.activeFrame;return r.createElement(s.W,{content:"Export all regions for the currently active image"},r.createElement(s.b,{intent:l.a.PRIMARY,disabled:!e.ValidateFilename(o.exportFilename)||!t||t.regionSet.regions.length<=1,onClick:this.handleExportRegionsClicked,text:"Export Regions"}))}}renderExportFilenameInput(){const e=c.s.Instance,t=r.createElement(s.F,{content:r.createElement(s.z,null,r.createElement(s.B,{text:"World Coordinates",onClick:()=>e.setExportCoordinateType(F.a.CoordinateType.WORLD)}),r.createElement(s.B,{text:"Pixel Coordinates",onClick:()=>e.setExportCoordinateType(F.a.CoordinateType.PIXEL)})),position:k.a.BOTTOM_RIGHT},r.createElement(s.e,{minimal:!0,rightIcon:"caret-down"},e.exportCoordinateType===F.a.CoordinateType.WORLD?"World":"Pixel")),i=r.createElement(s.F,{minimal:!0,content:r.createElement(s.z,null,r.createElement(s.B,{text:"CRTF Region File",onClick:()=>e.setExportFileType(F.a.FileType.CRTF)}),r.createElement(s.B,{text:"DS9 Region File",onClick:()=>e.setExportFileType(F.a.FileType.DS9_REG)})),position:k.a.BOTTOM_RIGHT},r.createElement(s.e,{minimal:!0,rightIcon:"caret-down"},e.exportFileType===F.a.FileType.CRTF?"CRTF":"DS9"));let n=r.createElement("div",null,i,t);return r.createElement(s.x,{autoFocus:!0,placeholder:"Enter file name",value:e.exportFilename,onChange:this.handleExportInputChanged,rightElement:n})}renderSaveFilenameInput(){const e=c.s.Instance,t=r.createElement(s.F,{minimal:!0,content:r.createElement(s.z,null,r.createElement(s.B,{text:"CASA",onClick:()=>e.setSaveFileType(F.a.FileType.CASA)}),r.createElement(s.B,{text:"FITS",onClick:()=>e.setSaveFileType(F.a.FileType.FITS)})),position:k.a.BOTTOM_RIGHT},r.createElement(s.e,{minimal:!0,rightIcon:"caret-down"},e.saveFileType===F.a.FileType.CASA?"CASA":"FITS"));return r.createElement(s.x,{autoFocus:!0,placeholder:"Enter file name",value:e.saveFilename,onChange:this.handleSaveFileNameChanged,rightElement:t})}renderOpenFilenameInput(){const e=c.H.Instance;let t,i;e.fileFilteringType===c.t.Fuzzy?(t="Fuzzy search",i="Filter by filename with fuzzy search"):e.fileFilteringType===c.t.Unix?(t="Unix pattern",i="Filter by filename using unix-style pattern"):(t="Regular expression",i="Filter by filename using regular expression");const n=r.createElement(s.F,{minimal:!0,content:r.createElement(s.z,null,r.createElement(s.B,{text:"Fuzzy search",onClick:()=>this.setFilterType(c.t.Fuzzy)}),r.createElement(s.B,{text:"Unix pattern",onClick:()=>this.setFilterType(c.t.Unix)}),r.createElement(s.B,{text:"Regular expression",onClick:()=>this.setFilterType(c.t.Regex)})),position:k.a.BOTTOM_RIGHT},r.createElement(s.e,{minimal:!0,icon:"filter",rightIcon:"caret-down"},t));return r.createElement(s.x,{autoFocus:!1,placeholder:i,value:this.fileFilterString,onChange:this.handleFilterStringInputChanged,leftIcon:"search",rightElement:n})}render(){const t=c.e.Instance,i=t.fileBrowserStore;let n="file-browser-dialog";t.darkTheme&&(n+=" bp3-dark");const o={icon:"folder-open",className:n,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.fileBrowserDialogVisible,onClose:i.hideFileBrowser,onOpened:this.refreshFileList,title:"File Browser"},a=this.renderActionButton(i.browserMode,i.appendingFrame);let u;u=i.browserMode===c.g.SaveFile?this.renderSaveFilenameInput():i.browserMode===c.g.RegionExport?this.renderExportFilenameInput():this.renderOpenFilenameInput();let p=null;if(i.browserMode===c.g.Catalog&&i.catalogHeaders&&i.catalogHeaders.length){const e=i.catalogHeaderDataset;p={type:se.x.Normal,dataset:e.columnsData,columnHeaders:e.columnHeaders,numVisibleRows:i.catalogHeaders.length}}const d=i.getfileListByMode;return r.createElement(m,{dialogProps:o,helpType:c.x.FILE_Browser,minWidth:400,minHeight:400,defaultWidth:1200,defaultHeight:600,enableResizing:!0},r.createElement("div",{className:"file-path"},this.pathItems&&r.createElement(r.Fragment,null,r.createElement(s.W,{content:"Refresh current directory"},r.createElement(s.b,{className:"refresh-button",icon:"repeat",onClick:()=>i.selectFolder(d.directory,!0),minimal:!0})),r.createElement(s.d,{className:"path-breadcrumbs",breadcrumbRenderer:this.renderBreadcrumb,items:this.pathItems}))),r.createElement("div",{className:"bp3-dialog-body"},r.createElement("div",{className:"file-panes"},r.createElement("div",{className:"file-list"},r.createElement(Y,{darkTheme:t.darkTheme,loading:i.loadingList,listResponse:i.getfileListByMode,fileBrowserMode:i.browserMode,selectedFile:i.selectedFile,selectedHDU:i.selectedHDU,filterString:this.debouncedFilterString,filterType:t.preferenceStore.fileFilteringType,sortingString:t.preferenceStore.fileSortingString,onSortingChanged:i.setSortingConfig,onFileClicked:i.selectFile,onSelectionChanged:this.handleSelectionChanged,onFileDoubleClicked:this.loadFile,onFolderClicked:this.handleFolderClicked})),r.createElement("div",{className:"file-info-pane"},r.createElement(M.a,{infoTypes:e.GetFileInfoTypes(i.browserMode),HDUOptions:{HDUList:i.HDUList,handleSelectedHDUChange:i.selectHDU},fileInfoExtended:i.fileInfoExtended,regionFileInfo:i.regionFileInfo?i.regionFileInfo.join("\n"):"",catalogFileInfo:i.catalogFileInfo,selectedTab:i.selectedTab,handleTabChange:this.handleTabChange,isLoading:i.loadingInfo,errorMessage:i.responseErrorMessage,catalogHeaderTable:p}))),u),r.createElement("div",{className:"bp3-dialog-footer"},r.createElement("div",{className:"bp3-dialog-footer-actions"},r.createElement(s.b,{intent:l.a.NONE,onClick:i.hideFileBrowser,disabled:t.fileLoading,text:"Close"}),a)),r.createElement(s.a,{className:t.darkTheme?"bp3-dark":"",isOpen:this.overwriteExistingFileAlertVisible,confirmButtonText:"Yes",cancelButtonText:"Cancel",intent:l.a.DANGER,onConfirm:this.handleOverwriteAlertConfirmed,onCancel:this.handleOverwriteAlertDismissed,canEscapeKeyCancel:!0},"This file exists. Are you sure to overwrite it?"))}static GetFileInfoTypes(e){switch(e){case c.g.File:case c.g.SaveFile:return[M.b.IMAGE_FILE,M.b.IMAGE_HEADER];case c.g.Catalog:return[M.b.CATALOG_FILE,M.b.CATALOG_HEADER];default:return[M.b.REGION_FILE]}}get pathItems(){let e=[{icon:"desktop",onClick:()=>this.handleBreadcrumbClicked("")}];const t=c.s.Instance.getfileListByMode;if(t){const i=t.directory;if(i&&"."!==i){const t=i.split("/");let n="";if(t.length)for(const i of t){if(!i)continue;n+="/"+i;const t=n;e.push({text:i,onClick:()=>this.handleBreadcrumbClicked(t)})}}}return e}},Q=Object(R.a)(K.prototype,"overwriteExistingFileAlertVisible",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(R.a)(K.prototype,"fileFilterString",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),$=Object(R.a)(K.prototype,"debouncedFilterString",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),J=Object(R.a)(K.prototype,"selectedFiles",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ee=Object(R.a)(K.prototype,"handleSelectionChanged",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFiles=e}}}),te=Object(R.a)(K.prototype,"handleFilterStringInputChanged",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileFilterString=e.target.value,this.setFilterString(this.fileFilterString)}}}),ie=Object(R.a)(K.prototype,"clearFilterString",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileFilterString="",this.debouncedFilterString=""}}}),ne=Object(R.a)(K.prototype,"handleFolderClicked",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),c.e.Instance.fileBrowserStore.selectFolder(e)}}}),re=Object(R.a)(K.prototype,"handleBreadcrumbClicked",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),c.e.Instance.fileBrowserStore.selectFolder(e,!0)}}}),oe=Object(R.a)(K.prototype,"setFilterType",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),c.H.Instance.setPreference(c.G.SILENT_FILE_FILTERING_TYPE,e)}}}),ae=Object(R.a)(K.prototype,"refreshFileList",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearFilterString();const e=c.s.Instance;switch(e.browserMode){case c.g.Catalog:e.catalogFileList={...e.catalogFileList};break;default:e.fileList={...e.fileList}}}}}),Object(R.a)(K.prototype,"pathItems",[j.i],Object.getOwnPropertyDescriptor(K.prototype,"pathItems"),K.prototype),X=K))||X;var ce;let ue=Object(o.a)(ce=class extends r.Component{render(){let e,t=this.props.text;if(this.props.timeRemaining){const i=.001*this.props.timeRemaining;if(i>60){const t=Math.floor(i/60),n=Math.floor(i-60*t);e=`${t}m${n>=10?Object(U.kb)(n):"0"+Object(U.kb)(n)}s`}else{const t=Math.floor(i);e=(t>=10?Object(U.kb)(t):"0"+Object(U.kb)(t))+"s"}t=`${this.props.text} (${e} left)`}let i="task-progress-dialog";return c.e.Instance.darkTheme&&(i+=" bp3-dark"),r.createElement(s.l,{className:i,icon:"time",canEscapeKeyClose:!1,canOutsideClickClose:!1,isCloseButtonShown:!1,title:t,isOpen:this.props.isOpen},r.createElement("div",{className:a.a.DIALOG_BODY},r.createElement(s.J,{value:this.props.progress,animate:!isFinite(this.props.progress),stripes:!isFinite(this.props.progress),intent:"primary"})),this.props.cancellable&&r.createElement("div",{className:a.a.DIALOG_FOOTER},r.createElement("div",{className:a.a.DIALOG_FOOTER_ACTIONS},r.createElement(s.W,{content:"Cancel the current task"},r.createElement(s.b,{onClick:this.props.onCancel},"Cancel")))))}})||ce;var pe;i(974);let de=Object(o.a)(pe=class extends r.Component{render(){const e=this.props.region;return r.createElement("div",{className:"coordinate-panel"},r.createElement(s.L,{inline:!0,onChange:t=>e.setCoordinate(t.currentTarget.value),selectedValue:e.coordinate,disabled:this.props.disableCooridnate},r.createElement(s.K,{label:c.K.Image,value:c.K.Image}),r.createElement(s.K,{label:c.K.World,value:c.K.World})),r.createElement(s.r,{options:Object.keys(c.R).map(e=>({label:e,value:c.R[e]})),value:c.e.Instance.overlayStore.global.system,onChange:e=>c.e.Instance.overlayStore.global.setSystem(e.currentTarget.value)}))}})||pe;var he,ge,me;i(975);let fe=Object(o.a)((me=ge=class e extends r.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.B)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Object(U.M)(n,c.e.Instance.overlayStore.numbers.formatTypeX)){const t=Object(U.E)(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Object(U.l)(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.B)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Object(U.M)(n,c.e.Instance.overlayStore.numbers.formatTypeY)){const t=Object(U.E)(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Object(U.l)(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}}}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||i.regionType!==F.a.RegionType.POINT)return null;const n=i.center,o=Object(U.B)(this.props.wcsInfo,n);let l,p;i.coordinate===c.K.Image?(l=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),p=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(l=r.createElement(s.W,{content:"Format: "+c.B.get(e),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})),p=r.createElement(s.W,{content:"Format: "+c.B.get(t),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})));const d=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(o):"Image: "+u.Point2D.ToString(n,"px",3),h=i.coordinate===c.K.Image?r.createElement("span",{className:a.a.TEXT_MUTED},"(px)"):"";return r.createElement("div",{className:"form-section point-region-form"},r.createElement(s.q,null,"Properties"),r.createElement("div",{className:"form-contents"},r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"Region Name"),r.createElement("td",{colSpan:2},r.createElement(s.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange}))),r.createElement("tr",null,r.createElement("td",null,"Coordinate"),r.createElement("td",{colSpan:2},r.createElement(de,{region:i,disableCooridnate:!this.props.wcsInfo}))),r.createElement("tr",null,r.createElement("td",null,"Center ",h),r.createElement("td",null,l),r.createElement("td",null,p),r.createElement("td",null,r.createElement("span",{className:"info-string"},d)))))))}},ge.REGION_PIXEL_EPS=.001,he=me))||he;var ye,be,Oe,Se;i(976);let Ce=Object(o.a)((Se=Oe=class e extends r.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.B)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Object(U.M)(n,c.e.Instance.overlayStore.numbers.formatTypeX)){const t=Object(U.E)(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Object(U.l)(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.B)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Object(U.M)(n,c.e.Instance.overlayStore.numbers.formatTypeY)){const t=Object(U.E)(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Object(U.l)(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleWidthChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=r},this.handleWidthWCSChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.x)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.J)(i)),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=this.sizeWCS.x},this.handleHeightChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=r},this.handleHeightWCSChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.y)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.J)(i)),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=this.sizeWCS.y},this.handleLeftValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.x+n.x/2,o={x:(t+r)/2,y:i.y},a={x:Math.abs(t-r),y:n.y};if(a.x>0&&a.y>0)return e.setControlPoints([o,a]),!0}return!1},this.handleLeftChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.bottomLeftPoint.x;this.handleLeftValueChange(i,n)||(e.currentTarget.value=n)},this.handleLeftWCSChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=Object(U.B)(this.props.wcsInfo,this.bottomLeftPoint),i=e.currentTarget.value;if(i!==t.x){if(Object(U.M)(i,c.e.Instance.overlayStore.numbers.formatTypeX)){const e=Object(U.E)(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.bottomLeftPoint.x;if(this.handleLeftValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleBottomValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.y+n.y/2,o={x:i.x,y:(t+r)/2},a={x:n.x,y:Math.abs(t-r)};if(a.x>0&&a.y>0)return e.setControlPoints([o,a]),!0}return!1},this.handleBottomChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.bottomLeftPoint.y;this.handleBottomValueChange(i,n)||(e.currentTarget.value=n)},this.handleBottomWCSChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=Object(U.B)(this.props.wcsInfo,this.bottomLeftPoint),i=e.currentTarget.value;if(i!==t.y){if(Object(U.M)(i,c.e.Instance.overlayStore.numbers.formatTypeY)){const e=Object(U.E)(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.bottomLeftPoint.y;if(this.handleBottomValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRightValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.x-n.x/2,o={x:(t+r)/2,y:i.y},a={x:Math.abs(t-r),y:n.y};if(a.x>0&&a.y>0)return e.setControlPoints([o,a]),!0}return!1},this.handleRightChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.topRightPoint.x;this.handleRightValueChange(i,n)||(e.currentTarget.value=n)},this.handleRightWCSChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=Object(U.B)(this.props.wcsInfo,this.topRightPoint),i=e.currentTarget.value;if(i!==t.x){if(Object(U.M)(i,c.e.Instance.overlayStore.numbers.formatTypeX)){const e=Object(U.E)(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.topRightPoint.x;if(this.handleRightValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleTopValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.y-n.y/2,o={x:i.x,y:(t+r)/2},a={x:n.x,y:Math.abs(t-r)};if(a.x>0&&a.y>0)return e.setControlPoints([o,a]),!0}return!1},this.handleTopChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.topRightPoint.y;this.handleTopValueChange(i,n)||(e.currentTarget.value=n)},this.handleTopWCSChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=Object(U.B)(this.props.wcsInfo,this.topRightPoint),i=e.currentTarget.value;if(i!==t.y){if(Object(U.M)(i,c.e.Instance.overlayStore.numbers.formatTypeY)){const e=Object(U.E)(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.topRightPoint.y;if(this.handleTopValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRotationChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get topRightPoint(){const e=this.props.region;if(!e||2!==e.controlPoints.length)return{x:NaN,y:NaN};const t=e.center,i=e.size;return{x:t.x+i.x/2,y:t.y+i.y/2}}get bottomLeftPoint(){const e=this.props.region;if(!e||2!==e.controlPoints.length)return{x:NaN,y:NaN};const t=e.center,i=e.size;return{x:t.x-i.x/2,y:t.y-i.y/2}}get sizeWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?{x:Object(U.t)(i.x,c.S),y:Object(U.t)(i.y,c.S)}:null}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||2!==i.controlPoints.length||i.regionType!==F.a.RegionType.RECTANGLE)return null;const n=i.center,o=Object(U.B)(this.props.wcsInfo,n);let l,p;i.coordinate===c.K.Image?(l=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),p=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(l=r.createElement(s.W,{content:"Format: "+c.B.get(e),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})),p=r.createElement(s.W,{content:"Format: "+c.B.get(t),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})));const d=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(o):"Image: "+u.Point2D.ToString(n,"px",3),h=Math.abs(i.rotation)>.001,g=Object(U.B)(this.props.wcsInfo,this.bottomLeftPoint);let m,f;i.coordinate===c.K.Image?(m=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.bottomLeftPoint.x,onBlur:this.handleLeftChange,onKeyDown:this.handleLeftChange,disabled:h}),f=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.bottomLeftPoint.y,onBlur:this.handleBottomChange,onKeyDown:this.handleBottomChange,disabled:h})):(m=r.createElement(s.W,{content:"Format: "+c.B.get(e),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!g||h,value:g?g.x:"",onBlur:this.handleLeftWCSChange,onKeyDown:this.handleLeftWCSChange})),f=r.createElement(s.W,{content:"Format: "+c.B.get(t),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!g||h,value:g?g.y:"",onBlur:this.handleBottomWCSChange,onKeyDown:this.handleBottomWCSChange})));const y=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(g):"Image: "+u.Point2D.ToString(this.bottomLeftPoint,"px",3),b=Object(U.B)(this.props.wcsInfo,this.topRightPoint);let O,S;i.coordinate===c.K.Image?(O=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.topRightPoint.x,onBlur:this.handleRightChange,onKeyDown:this.handleRightChange,disabled:h}),S=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.topRightPoint.y,onBlur:this.handleTopChange,onKeyDown:this.handleTopChange,disabled:h})):(O=r.createElement(s.W,{content:"Format: "+c.B.get(e),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!b||h,value:b?b.x:"",onBlur:this.handleRightWCSChange,onKeyDown:this.handleRightWCSChange})),S=r.createElement(s.W,{content:"Format: "+c.B.get(t),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!b||h,value:b?b.y:"",onBlur:this.handleTopWCSChange,onKeyDown:this.handleTopWCSChange})));const C=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(b):"Image: "+u.Point2D.ToString(this.topRightPoint,"px",3),E=i.size;let I,w;i.coordinate===c.K.Image?(I=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Width",value:E.x,onBlur:this.handleWidthChange,onKeyDown:this.handleWidthChange}),w=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Height",value:E.y,onBlur:this.handleHeightChange,onKeyDown:this.handleHeightChange})):(I=r.createElement(s.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Width",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.x:"",onBlur:this.handleWidthWCSChange,onKeyDown:this.handleWidthWCSChange})),w=r.createElement(s.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Height",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.y:"",onBlur:this.handleHeightWCSChange,onKeyDown:this.handleHeightWCSChange})));const T=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(this.sizeWCS):"Image: "+u.Point2D.ToString(E,"px",3),v=i.coordinate===c.K.Image?r.createElement("span",{className:a.a.TEXT_MUTED},"(px)"):"";return r.createElement("div",{className:"form-section rectangular-region-form"},r.createElement(s.q,null,"Properties"),r.createElement("div",{className:"form-contents"},r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"Region Name"),r.createElement("td",{colSpan:2},r.createElement(s.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange}))),r.createElement("tr",null,r.createElement("td",null,"Coordinate"),r.createElement("td",{colSpan:2},r.createElement(de,{region:i,disableCooridnate:!this.props.wcsInfo}))),r.createElement("tr",null,r.createElement("td",null,"Center ",v),r.createElement("td",null,l),r.createElement("td",null,p),r.createElement("td",null,r.createElement("span",{className:"info-string"},d))),r.createElement("tr",null,r.createElement("td",null,"Size ",v),r.createElement("td",null,I),r.createElement("td",null,w),r.createElement("td",null,r.createElement("span",{className:"info-string"},T))),r.createElement("tr",null,r.createElement("td",null,"Bottom Left ",v),r.createElement("td",null,m),r.createElement("td",null,f),r.createElement("td",null,r.createElement("span",{className:"info-string"},y))),r.createElement("tr",null,r.createElement("td",null,"Top Right ",v),r.createElement("td",null,O),r.createElement("td",null,S),r.createElement("td",null,r.createElement("span",{className:"info-string"},C))),r.createElement("tr",null,r.createElement("td",null,"P.A. ",r.createElement("span",{className:a.a.TEXT_MUTED},"(deg)")),r.createElement("td",null,r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:i.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})))))))}},Oe.REGION_PIXEL_EPS=.001,be=Se,Object(R.a)(be.prototype,"topRightPoint",[j.i],Object.getOwnPropertyDescriptor(be.prototype,"topRightPoint"),be.prototype),Object(R.a)(be.prototype,"bottomLeftPoint",[j.i],Object.getOwnPropertyDescriptor(be.prototype,"bottomLeftPoint"),be.prototype),Object(R.a)(be.prototype,"sizeWCS",[j.i],Object.getOwnPropertyDescriptor(be.prototype,"sizeWCS"),be.prototype),ye=be))||ye;var Ee,Ie,we,Te;i(977);let ve=Object(o.a)((Te=we=class e extends r.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.B)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Object(U.M)(n,c.e.Instance.overlayStore.numbers.formatTypeX)){const t=Object(U.E)(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Object(U.l)(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.B)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Object(U.M)(n,c.e.Instance.overlayStore.numbers.formatTypeY)){const t=Object(U.E)(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Object(U.l)(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleMajorAxisChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=r},this.handleMajorAxisWCSChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.x)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.J)(i)),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=this.sizeWCS.x},this.handleMinorAxisChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=r},this.handleMinorAxisWCSChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.y)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.J)(i)),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=this.sizeWCS.y},this.handleRotationChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get sizeWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?{x:Object(U.t)(i.x,c.S),y:Object(U.t)(i.y,c.S)}:null}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||2!==i.controlPoints.length||i.regionType!==F.a.RegionType.ELLIPSE)return null;const n=i.center,o=Object(U.B)(this.props.wcsInfo,n);let l,p;i.coordinate===c.K.Image?(l=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),p=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(l=r.createElement(s.W,{content:"Format: "+c.B.get(e),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})),p=r.createElement(s.W,{content:"Format: "+c.B.get(t),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})));const d=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(o):"Image: "+u.Point2D.ToString(n,"px",3),h=i.size;let g,m;i.coordinate===c.K.Image?(g=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Semi-major",value:h.x,onBlur:this.handleMajorAxisChange,onKeyDown:this.handleMajorAxisChange}),m=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Semi-minor",value:h.y,onBlur:this.handleMinorAxisChange,onKeyDown:this.handleMinorAxisChange})):(g=r.createElement(s.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Semi-major",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.x:"",onBlur:this.handleMajorAxisWCSChange,onKeyDown:this.handleMajorAxisWCSChange})),m=r.createElement(s.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Semi-minor",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.y:"",onBlur:this.handleMinorAxisWCSChange,onKeyDown:this.handleMinorAxisWCSChange})));const f=i.coordinate===c.K.Image?"(Semi-major, Semi-minor): "+u.WCSPoint2D.ToString(this.sizeWCS):"Image: "+u.Point2D.ToString(h,"px",3),y=i.coordinate===c.K.Image?r.createElement("span",{className:a.a.TEXT_MUTED},"(px)"):"";return r.createElement("div",{className:"form-section elliptical-region-form"},r.createElement(s.q,null,"Properties"),r.createElement("div",{className:"form-contents"},r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"Region Name"),r.createElement("td",{colSpan:2},r.createElement(s.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange}))),r.createElement("tr",null,r.createElement("td",null,"Coordinate"),r.createElement("td",{colSpan:2},r.createElement(de,{region:i,disableCooridnate:!this.props.wcsInfo}))),r.createElement("tr",null,r.createElement("td",null,"Center ",y),r.createElement("td",null,l),r.createElement("td",null,p),r.createElement("td",null,r.createElement("span",{className:"info-string"},d))),r.createElement("tr",null,r.createElement("td",null,"Axes ",y),r.createElement("td",null,g),r.createElement("td",null,m),r.createElement("td",null,r.createElement("span",{className:"info-string"},f))),r.createElement("tr",null,r.createElement("td",null,"P.A. ",r.createElement("span",{className:a.a.TEXT_MUTED},"(deg)")),r.createElement("td",null,r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:i.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})))))))}},we.REGION_PIXEL_EPS=.001,Ie=Te,Object(R.a)(Ie.prototype,"sizeWCS",[j.i],Object.getOwnPropertyDescriptor(Ie.prototype,"sizeWCS"),Ie.prototype),Ee=Ie))||Ee;var Ae,xe,Re;i(978);let Pe=Object(o.a)((Re=xe=class e extends r.Component{constructor(...t){super(...t),this.handleLineWidthChange=P.throttle(e=>{this.props.region&&this.props.region.setLineWidth(Math.max(c.N.MIN_LINE_WIDTH,Math.min(c.N.MAX_LINE_WIDTH,e)))},e.APPEARANCE_CHANGE_DELAY),this.handleDashLengthChange=P.throttle(e=>{this.props.region&&this.props.region.setDashLength(Math.max(0,Math.min(c.N.MAX_DASH_LENGTH,e)))},e.APPEARANCE_CHANGE_DELAY)}render(){const e=this.props.region;return e&&e.isValid?r.createElement("div",{className:"form-section appearance-form"},r.createElement(s.q,null,"Appearance"),r.createElement("div",{className:"form-contents"},r.createElement(s.p,{label:"Color",inline:!0},r.createElement(se.c,{color:e.color,presetColors:U.e,setColor:t=>e.setColor(t.hex),disableAlpha:!0,darkTheme:this.props.darkTheme})),e.regionType!==F.a.RegionType.POINT&&r.createElement(s.p,{inline:!0,label:"Line Width",labelInfo:"(px)"},r.createElement(se.n,{placeholder:"Line Width",min:c.N.MIN_LINE_WIDTH,max:c.N.MAX_LINE_WIDTH,value:e.lineWidth,stepSize:.5,onValueChange:this.handleLineWidthChange})),e.regionType!==F.a.RegionType.POINT&&r.createElement(s.p,{inline:!0,label:"Dash Length",labelInfo:"(px)"},r.createElement(se.n,{placeholder:"Dash Length",min:0,max:c.N.MAX_DASH_LENGTH,value:e.dashLength,stepSize:1,onValueChange:this.handleDashLengthChange})))):null}},xe.APPEARANCE_CHANGE_DELAY=100,Ae=Re))||Ae;var je,ke,Fe,Me,De;i(979);let Ne=Object(o.a)((De=Me=class e extends r.Component{constructor(t){super(t),Object(x.a)(this,"displayColorPicker",Fe,this),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handlePointChange=(t,i,n)=>{if("keydown"===n.type&&13!==n.keyCode)return;const r=this.props.region,o=n.currentTarget.value,a=parseFloat(o),s=i?r.controlPoints[t].x:r.controlPoints[t].y;!isFinite(a)||Object(U.l)(a,s,e.REGION_PIXEL_EPS)?n.currentTarget.value=s:i?this.props.region.setControlPoint(t,{x:a,y:this.props.region.controlPoints[t].y}):this.props.region.setControlPoint(t,{x:this.props.region.controlPoints[t].x,y:a})},this.handleWCSPointChange=(t,i,n)=>{if("keydown"===n.type&&13!==n.keyCode)return;const r=this.props.region,o=Object(U.B)(this.props.wcsInfo,r.controlPoints[t]);if(!o)return;const a=n.currentTarget.value;if(a!==(i?o.x:o.y)){if(Object(U.M)(a,i?c.e.Instance.overlayStore.numbers.formatTypeX:c.e.Instance.overlayStore.numbers.formatTypeY)){const n=Object(U.E)(this.props.wcsInfo,i?{x:a,y:o.y}:{x:o.x,y:a});if(!n)return;const s=i?n.x:n.y,l=i?r.controlPoints[t].x:r.controlPoints[t].y;if(isFinite(s)&&!Object(U.l)(s,l,e.REGION_PIXEL_EPS))return void this.props.region.setControlPoint(t,n)}n.currentTarget.value=i?o.x:o.y}},Object(j.p)(this)}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||!i.isValid||i.regionType!==F.a.RegionType.POLYGON)return null;const n=i.coordinate===c.K.Image?r.createElement("span",{className:a.a.TEXT_MUTED},"(px)"):"",o=i.controlPoints.map((o,a)=>{const l=Object(U.B)(this.props.wcsInfo,o);let p,d;i.coordinate===c.K.Image?(p=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:o.x,onBlur:e=>this.handlePointChange(a,!0,e),onKeyDown:e=>this.handlePointChange(a,!0,e)}),d=r.createElement(se.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:o.y,onBlur:e=>this.handlePointChange(a,!1,e),onKeyDown:e=>this.handlePointChange(a,!1,e)})):(p=r.createElement(s.W,{content:"Format: "+c.B.get(e),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!l,value:l?l.x:"",onBlur:e=>this.handleWCSPointChange(a,!0,e),onKeyDown:e=>this.handleWCSPointChange(a,!0,e)})),d=r.createElement(s.W,{content:"Format: "+c.B.get(t),position:k.a.BOTTOM,hoverOpenDelay:300},r.createElement(se.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!l,value:l?l.y:"",onBlur:e=>this.handleWCSPointChange(a,!1,e),onKeyDown:e=>this.handleWCSPointChange(a,!1,e)})));const h=i.coordinate===c.K.Image?"WCS: "+u.WCSPoint2D.ToString(l):"Image: "+u.Point2D.ToString(o,"px",3);return r.createElement("tr",{key:a},r.createElement("td",null,"Point ",a," ",n),r.createElement("td",null,p),r.createElement("td",null,d),r.createElement("td",null,r.createElement("span",{className:"info-string"},h)))});return r.createElement("div",{className:"form-section polygon-region-form"},r.createElement(s.q,null,"Properties"),r.createElement("div",{className:"form-contents"},r.createElement("table",null,r.createElement("tbody",null,r.createElement("tr",null,r.createElement("td",null,"Region Name"),r.createElement("td",{colSpan:2},r.createElement(s.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange}))),r.createElement("tr",null,r.createElement("td",null,"Coordinate"),r.createElement("td",{colSpan:2},r.createElement(de,{region:i,disableCooridnate:!this.props.wcsInfo}))),o))))}},Me.REGION_PIXEL_EPS=.001,ke=De,Fe=Object(R.a)(ke.prototype,"displayColorPicker",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=ke))||je;var Le,_e,ze,We=i(55);i(980);let Ge=Object(o.a)((ze=_e=class e extends r.Component{constructor(...e){super(...e),this.handleDeleteClicked=()=>{const e=c.e.Instance;e.dialogStore.hideRegionDialog(),e.activeFrame&&e.activeFrame.regionSet.selectedRegion&&e.deleteRegion(e.activeFrame.regionSet.selectedRegion)},this.handleFocusClicked=()=>c.e.Instance.activeFrame.regionSet.selectedRegion.focusCenter()}render(){const t=c.e.Instance,i={icon:"info-sign",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!0,lazy:!0,isOpen:t.dialogStore.regionDialogVisible,onClose:t.dialogStore.hideRegionDialog,className:"region-dialog",canEscapeKeyClose:!0,title:"No region selected"};let n,o,u=!1;if(t.activeFrame&&t.activeFrame.regionSet.selectedRegion)if(0===t.activeFrame.regionSet.selectedRegion.regionId)n=e.InvalidRegionNode;else{var p;o=t.activeFrame.regionSet.selectedRegion;const a=null!==(p=t.activeFrame.spatialReference)&&void 0!==p?p:t.activeFrame;switch(i.title=`Editing ${o.nameString} (${a.filename})`,o.regionType){case F.a.RegionType.POINT:n=r.createElement(r.Fragment,null,r.createElement(Pe,{region:o,darkTheme:t.darkTheme}),r.createElement(fe,{region:o,wcsInfo:a.validWcs?a.wcsInfoForTransformation:0})),u=!0;break;case F.a.RegionType.RECTANGLE:n=r.createElement(r.Fragment,null,r.createElement(Pe,{region:o,darkTheme:t.darkTheme}),r.createElement(Ce,{region:o,frame:a,wcsInfo:a.validWcs?a.wcsInfoForTransformation:0})),u=!0;break;case F.a.RegionType.ELLIPSE:n=r.createElement(r.Fragment,null,r.createElement(Pe,{region:o,darkTheme:t.darkTheme}),r.createElement(ve,{region:o,frame:a,wcsInfo:a.validWcs?a.wcsInfoForTransformation:0})),u=!0;break;case F.a.RegionType.POLYGON:n=r.createElement(r.Fragment,null,r.createElement(Pe,{region:o,darkTheme:t.darkTheme}),r.createElement(Ne,{region:o,wcsInfo:a.validWcs?a.wcsInfoForTransformation:0})),u=!0;break;default:n=e.InvalidRegionNode}}else n=e.MissingRegionNode;let d=o&&0!==o.regionId&&r.createElement(r.Fragment,null,r.createElement(s.W,{content:"Region is "+(o.locked?"locked":"unlocked")},r.createElement(s.b,{intent:l.a.WARNING,minimal:!0,icon:o.locked?"lock":"unlock",onClick:o.toggleLock})),r.createElement(s.W,{content:"Focus"},r.createElement(s.b,{intent:l.a.WARNING,minimal:!0,icon:r.createElement(We.a,{icon:"center"}),onClick:this.handleFocusClicked})));return r.createElement(m,{dialogProps:i,helpType:c.x.REGION_DIALOG,defaultWidth:775,defaultHeight:475,minHeight:300,minWidth:400,enableResizing:!0},r.createElement("div",{className:a.a.DIALOG_BODY},n),r.createElement("div",{className:a.a.DIALOG_FOOTER},r.createElement("div",{className:a.a.DIALOG_FOOTER_ACTIONS},d,u&&r.createElement(s.b,{intent:l.a.DANGER,icon:"trash",text:"Delete",onClick:this.handleDeleteClicked}),r.createElement(s.b,{intent:l.a.NONE,onClick:t.dialogStore.hideRegionDialog,text:"Close"}))))}},_e.MissingRegionNode=r.createElement(s.C,{icon:"folder-open",title:"No region selected",description:"Select a region using the list or image view"}),_e.InvalidRegionNode=r.createElement(s.C,{icon:"error",title:"Region not supported",description:"The selected region does not have any editable properties"}),Le=ze))||Le;var Ve,Be,qe,He,Ue,Ye=i(43),Xe=i.n(Ye),Ke=i(491),Qe=i(183),Ze=i(77);i(981);!function(e){e[e.GLOBAL=0]="GLOBAL",e[e.RENDER_CONFIG=1]="RENDER_CONFIG",e[e.CONTOUR_CONFIG=2]="CONTOUR_CONFIG",e[e.OVERLAY_CONFIG=3]="OVERLAY_CONFIG",e[e.REGION=4]="REGION",e[e.PERFORMANCE=5]="PERFORMANCE",e[e.LOG_EVENT=6]="LOG_EVENT",e[e.CATALOG=7]="CATALOG"}(Ue||(Ue={}));const $e=Ke.a.ofType();let Je=Object(o.a)((Be=class extends r.Component{constructor(e){super(e),Object(x.a)(this,"selectedTab",qe,this),Object(x.a)(this,"setSelectedTab",He,this),this.renderPercentileSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>r.createElement(s.B,{text:e+"%",onClick:t,key:e}),this.handleImageCompressionQualityChange=P.throttle(e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,e)},100),this.handleAnimationCompressionQualityChange=P.throttle(e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,e)},100),this.handleGPUTileCacheChange=P.throttle(e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_GPU_TILE_CACHE,e)},100),this.handleSystemTileCacheChange=P.throttle(e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_SYSTEM_TILE_CACHE,e)},100),this.reset=()=>{const e=c.H.Instance;switch(this.selectedTab){case Ue.RENDER_CONFIG:e.resetRenderConfigSettings();break;case Ue.CONTOUR_CONFIG:e.resetContourConfigSettings();break;case Ue.OVERLAY_CONFIG:e.resetOverlayConfigSettings();break;case Ue.REGION:e.resetRegionSettings();break;case Ue.PERFORMANCE:e.resetPerformanceSettings();break;case Ue.LOG_EVENT:e.resetLogEventSettings();break;case Ue.CATALOG:e.resetCatalogSettings();break;case Ue.GLOBAL:default:e.resetGlobalSettings()}},Object(j.p)(this)}render(){const e=c.e.Instance,t=e.preferenceStore,i=e.layoutStore,n=r.createElement(r.Fragment,null,r.createElement(s.p,{inline:!0,label:"Theme"},r.createElement(s.r,{value:t.theme,onChange:t=>e.preferenceStore.setPreference(c.G.GLOBAL_THEME,t.currentTarget.value)},r.createElement("option",{value:u.Theme.AUTO},"Automatic"),r.createElement("option",{value:u.Theme.LIGHT},"Light"),r.createElement("option",{value:u.Theme.DARK},"Dark"))),r.createElement(s.p,{inline:!0,label:"Auto-launch File Browser"},r.createElement(s.P,{checked:t.autoLaunch,onChange:e=>t.setPreference(c.G.GLOBAL_AUTOLAUNCH,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"Initial Layout"},r.createElement(s.r,{value:t.layout,onChange:e=>t.setPreference(c.G.GLOBAL_LAYOUT,e.currentTarget.value)},i.orderedLayoutNames.map(e=>r.createElement("option",{key:e,value:e},e)))),r.createElement(s.p,{inline:!0,label:"Initial Cursor Position"},r.createElement(s.L,{selectedValue:t.cursorPosition,onChange:e=>t.setPreference(c.G.GLOBAL_CURSOR_POSITION,e.currentTarget.value),inline:!0},r.createElement(s.K,{label:"Fixed",value:u.CursorPosition.FIXED}),r.createElement(s.K,{label:"Tracking",value:u.CursorPosition.TRACKING}))),r.createElement(s.p,{inline:!0,label:"Initial Zoom Level"},r.createElement(s.L,{selectedValue:t.zoomMode,onChange:e=>t.setPreference(c.G.GLOBAL_ZOOM_MODE,e.currentTarget.value),inline:!0},r.createElement(s.K,{label:"Zoom to fit",value:u.Zoom.FIT}),r.createElement(s.K,{label:"Zoom to 1.0x",value:u.Zoom.FULL}))),r.createElement(s.p,{inline:!0,label:"Zoom to"},r.createElement(s.L,{selectedValue:t.zoomPoint,onChange:e=>t.setPreference(c.G.GLOBAL_ZOOM_POINT,e.currentTarget.value),inline:!0},r.createElement(s.K,{label:"Cursor",value:u.ZoomPoint.CURSOR}),r.createElement(s.K,{label:"Current Center",value:u.ZoomPoint.CENTER}))),r.createElement(s.p,{inline:!0,label:"Enable drag-to-pan"},r.createElement(s.P,{checked:t.dragPanning,onChange:e=>t.setPreference(c.G.GLOBAL_DRAG_PANNING,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"WCS matching on append"},r.createElement(s.r,{value:t.autoWCSMatching,onChange:e=>t.setPreference(c.G.GLOBAL_AUTO_WCS_MATCHING,Number(e.currentTarget.value))},r.createElement("option",{value:u.WCSMatchingType.NONE},"None"),r.createElement("option",{value:u.WCSMatchingType.SPATIAL},"Spatial Only"),r.createElement("option",{value:u.WCSMatchingType.SPECTRAL},"Spectral Only"),r.createElement("option",{value:u.WCSMatchingType.SPATIAL|u.WCSMatchingType.SPECTRAL},"Spatial and Spectral"))),r.createElement(s.p,{inline:!0,label:"Spectral Matching"},r.createElement(s.r,{value:t.spectralMatchingType,onChange:e=>t.setPreference(c.G.GLOBAL_SPECTRAL_MATCHING_TYPE,e.currentTarget.value)},u.SPECTRAL_MATCHING_TYPES.map(e=>r.createElement("option",{key:e,value:e},u.SPECTRAL_TYPE_STRING.get(e)))))),o=r.createElement(r.Fragment,null,r.createElement(s.p,{inline:!0,label:"Default Scaling"},r.createElement(Qe.b,{selectedItem:t.scaling,onItemSelect:e=>t.setPreference(c.G.RENDER_CONFIG_SCALING,e)})),r.createElement(s.p,{inline:!0,label:"Default Color Map"},r.createElement(se.d,{inverted:!1,selectedItem:t.colormap,onItemSelect:e=>t.setPreference(c.G.RENDER_CONFIG_COLORMAP,e)})),r.createElement(s.p,{inline:!0,label:"Default Percentile Ranks"},r.createElement($e,{activeItem:t.percentile.toString(10),onItemSelect:e=>t.setPreference(c.G.RENDER_CONFIG_PERCENTILE,Number(e)),popoverProps:{minimal:!0,position:"auto"},filterable:!1,items:c.O.PERCENTILE_RANKS.map(String),itemRenderer:this.renderPercentileSelectItem},r.createElement(s.e,{text:t.percentile.toString(10)+"%",rightIcon:"double-caret-vertical",alignText:"right"}))),(t.scaling===c.u.LOG||t.scaling===c.u.POWER)&&r.createElement(s.p,{label:"Alpha",inline:!0},r.createElement(se.n,{buttonPosition:"none",value:t.scalingAlpha,onValueChange:e=>t.setPreference(c.G.RENDER_CONFIG_SCALING_ALPHA,e)})),t.scaling===c.u.GAMMA&&r.createElement(s.p,{label:"Gamma",inline:!0},r.createElement(se.n,{min:c.O.GAMMA_MIN,max:c.O.GAMMA_MAX,stepSize:.1,minorStepSize:.01,majorStepSize:.5,value:t.scalingGamma,onValueChange:e=>t.setPreference(c.G.RENDER_CONFIG_SCALING_GAMMA,e)})),r.createElement(s.p,{inline:!0,label:"NaN Color"},r.createElement(se.c,{color:Xe()(t.nanColorHex).setAlpha(t.nanAlpha).toRgb(),presetColors:[...U.e,"transparent"],setColor:e=>{t.setPreference(c.G.RENDER_CONFIG_NAN_COLOR_HEX,"transparent"===e.hex?"#000000":e.hex),t.setPreference(c.G.RENDER_CONFIG_NAN_ALPHA,e.rgb.a)},disableAlpha:!1,darkTheme:e.darkTheme}))),a=r.createElement(r.Fragment,null,r.createElement(s.p,{inline:!0,label:"Generator Type"},r.createElement(s.r,{value:t.contourGeneratorType,options:Object.keys(c.p).map(e=>({label:c.p[e],value:c.p[e]})),onChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE,e.currentTarget.value)})),r.createElement(s.p,{inline:!0,label:"Smoothing Mode"},r.createElement(s.r,{value:t.contourSmoothingMode,onChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE,Number(e.currentTarget.value))},r.createElement("option",{key:F.a.SmoothingMode.NoSmoothing,value:F.a.SmoothingMode.NoSmoothing},"No Smoothing"),r.createElement("option",{key:F.a.SmoothingMode.BlockAverage,value:F.a.SmoothingMode.BlockAverage},"Block"),r.createElement("option",{key:F.a.SmoothingMode.GaussianBlur,value:F.a.SmoothingMode.GaussianBlur},"Gaussian"))),r.createElement(s.p,{inline:!0,label:"Default Smoothing Factor"},r.createElement(se.n,{placeholder:"Default Smoothing Factor",min:1,max:33,value:t.contourSmoothingFactor,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR,e)})),r.createElement(s.p,{inline:!0,label:"Default Contour Levels"},r.createElement(se.n,{placeholder:"Default Contour Levels",min:1,max:15,value:t.contourNumLevels,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS,e)})),r.createElement(s.p,{inline:!0,label:"Thickness"},r.createElement(se.n,{placeholder:"Thickness",min:.5,max:10,value:t.contourThickness,majorStepSize:.5,stepSize:.5,onValueChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_THICKNESS,e)})),r.createElement(s.p,{inline:!0,label:"Default Color Mode"},r.createElement(s.r,{value:t.contourColormapEnabled?1:0,onChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED,parseInt(e.currentTarget.value)>0)},r.createElement("option",{key:0,value:0},"Constant Color"),r.createElement("option",{key:1,value:1},"Color-mapped"))),r.createElement(s.p,{inline:!0,label:"Default Color Map"},r.createElement(se.d,{inverted:!1,selectedItem:t.contourColormap,onItemSelect:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_COLORMAP,e)})),r.createElement(s.p,{inline:!0,label:"Default Color"},r.createElement(se.c,{color:t.contourColor,presetColors:U.e,setColor:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme}))),p=r.createElement(r.Fragment,null,r.createElement(s.p,{inline:!0,label:"AST Color"},r.createElement(Ze.a,{selectedItem:t.astColor,onItemSelect:e=>t.setPreference(c.G.WCS_OVERLAY_AST_COLOR,e)})),r.createElement(s.p,{inline:!0,label:"AST Grid Visible"},r.createElement(s.P,{checked:t.astGridVisible,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_AST_GRID_VISIBLE,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"AST Label Visible"},r.createElement(s.P,{checked:t.astLabelsVisible,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_AST_LABELS_VISIBLE,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"WCS Format"},r.createElement(s.r,{options:[u.WCSType.AUTOMATIC,u.WCSType.DEGREES,u.WCSType.SEXAGESIMAL],value:t.wcsType,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_WCS_TYPE,e.currentTarget.value)})),r.createElement(s.p,{inline:!0,label:"Beam Visible"},r.createElement(s.P,{checked:t.beamVisible,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_VISIBLE,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"Beam Color"},r.createElement(se.c,{color:Xe()(t.beamColor).toRgb(),presetColors:U.e,setColor:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})),r.createElement(s.p,{inline:!0,label:"Beam Type"},r.createElement(s.r,{value:t.beamType,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_TYPE,e.currentTarget.value)},r.createElement("option",{key:0,value:c.f.Open},"Open"),r.createElement("option",{key:1,value:c.f.Solid},"Solid"))),r.createElement(s.p,{inline:!0,label:"Beam Width",labelInfo:"(px)"},r.createElement(se.n,{placeholder:"Beam Width",min:.5,max:10,value:t.beamWidth,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_WIDTH,e)})));let d=[];c.N.AVAILABLE_REGION_TYPES.forEach((e,t)=>{d.push(r.createElement("option",{key:t,value:t},e))});const h=r.createElement(r.Fragment,null,r.createElement(s.p,{inline:!0,label:"Color"},r.createElement(se.c,{color:t.regionColor,presetColors:U.e,setColor:e=>t.setPreference(c.G.REGION_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})),r.createElement(s.p,{inline:!0,label:"Line Width",labelInfo:"(px)"},r.createElement(se.n,{placeholder:"Line Width",min:c.N.MIN_LINE_WIDTH,max:c.N.MAX_LINE_WIDTH,value:t.regionLineWidth,stepSize:.5,onValueChange:e=>t.setPreference(c.G.REGION_LINE_WIDTH,Math.max(c.N.MIN_LINE_WIDTH,Math.min(c.N.MAX_LINE_WIDTH,e)))})),r.createElement(s.p,{inline:!0,label:"Dash Length",labelInfo:"(px)"},r.createElement(se.n,{placeholder:"Dash Length",min:0,max:c.N.MAX_DASH_LENGTH,value:t.regionDashLength,stepSize:1,onValueChange:e=>t.setPreference(c.G.REGION_DASH_LENGTH,Math.max(0,Math.min(c.N.MAX_DASH_LENGTH,e)))})),r.createElement(s.p,{inline:!0,label:"Region Type"},r.createElement(s.r,{value:t.regionType,onChange:e=>t.setPreference(c.G.REGION_TYPE,Number(e.currentTarget.value))},d)),r.createElement(s.p,{inline:!0,label:"Region size",labelInfo:"(px)"},r.createElement(se.n,{placeholder:"Region size",min:1,value:t.regionSize,stepSize:1,onValueChange:e=>t.setPreference(c.G.REGION_SIZE,Math.max(1,e))})),r.createElement(s.p,{inline:!0,label:"Creation Mode"},r.createElement(s.L,{selectedValue:t.regionCreationMode,onChange:e=>t.setPreference(c.G.REGION_CREATION_MODE,e.currentTarget.value)},r.createElement(s.K,{label:"Center to corner",value:u.RegionCreationMode.CENTER}),r.createElement(s.K,{label:"Corner to corner",value:u.RegionCreationMode.CORNER})))),g=r.createElement(r.Fragment,null,r.createElement(s.p,{inline:!0,label:"Low bandwidth mode"},r.createElement(s.P,{checked:t.lowBandwidthMode,onChange:e=>t.setPreference(c.G.PERFORMANCE_LOW_BAND_WIDTH_MODE,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"Compression Quality",labelInfo:"(Images)"},r.createElement(se.n,{placeholder:"Compression Quality",min:u.CompressionQuality.IMAGE_MIN,max:u.CompressionQuality.IMAGE_MAX,value:t.imageCompressionQuality,stepSize:u.CompressionQuality.IMAGE_STEP,onValueChange:this.handleImageCompressionQualityChange})),r.createElement(s.p,{inline:!0,label:"Compression Quality",labelInfo:"(Animation)"},r.createElement(se.n,{placeholder:"Compression Quality",min:u.CompressionQuality.ANIMATION_MIN,max:u.CompressionQuality.ANIMATION_MAX,value:t.animationCompressionQuality,stepSize:u.CompressionQuality.ANIMATION_STEP,onValueChange:this.handleAnimationCompressionQualityChange})),r.createElement(s.p,{inline:!0,label:"GPU Tile Cache Size"},r.createElement(se.n,{placeholder:"GPU Tile Cache Size",min:u.TileCache.GPU_MIN,max:u.TileCache.GPU_MAX,value:t.gpuTileCache,majorStepSize:u.TileCache.GPU_STEP,stepSize:u.TileCache.GPU_STEP,onValueChange:this.handleGPUTileCacheChange})),r.createElement(s.p,{inline:!0,label:"System Tile Cache Size"},r.createElement(se.n,{placeholder:"System Tile Cache Size",min:u.TileCache.SYSTEM_MIN,max:u.TileCache.SYSTEM_MAX,value:t.systemTileCache,majorStepSize:u.TileCache.SYSTEM_STEP,stepSize:u.TileCache.SYSTEM_STEP,onValueChange:this.handleSystemTileCacheChange})),r.createElement(s.p,{inline:!0,label:"Contour Rounding Factor"},r.createElement(se.n,{placeholder:"Contour Rounding Factor",min:1,max:32,value:t.contourDecimation,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_DECIMATION,e)})),r.createElement(s.p,{inline:!0,label:"Contour Compression Level"},r.createElement(se.n,{placeholder:"Contour Compression Level",min:0,max:19,value:t.contourCompressionLevel,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,e)})),r.createElement(s.p,{inline:!0,label:"Contour Chunk Size"},r.createElement(s.r,{value:t.contourChunkSize,onChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_CHUNK_SIZE,parseInt(e.currentTarget.value))},r.createElement("option",{key:0,value:25e3},"25K"),r.createElement("option",{key:1,value:5e4},"50K"),r.createElement("option",{key:2,value:1e5},"100K"),r.createElement("option",{key:3,value:25e4},"250K"),r.createElement("option",{key:4,value:5e5},"500K"),r.createElement("option",{key:5,value:1e6},"1M"))),r.createElement(s.p,{inline:!0,label:"Contour Control Map Resolution"},r.createElement(s.r,{value:t.contourControlMapWidth,onChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,parseInt(e.currentTarget.value))},r.createElement("option",{key:0,value:128},"128\xd7128 (128 KB)"),r.createElement("option",{key:1,value:256},"256\xd7256 (512 KB)"),r.createElement("option",{key:2,value:512},"512\xd7512 (2 MB)"),r.createElement("option",{key:3,value:1024},"1024\xd71024 (8 MB)"))),r.createElement(s.p,{inline:!0,label:"Stream image tiles while zooming"},r.createElement(s.P,{checked:t.streamContoursWhileZooming,onChange:e=>t.setPreference(c.G.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,e.currentTarget.checked)})),r.createElement(s.p,{inline:!0,label:"Stop animation playback in"},r.createElement(s.r,{value:t.stopAnimationPlaybackMinutes,onChange:e=>t.setPreference(c.G.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,parseInt(e.currentTarget.value))},r.createElement("option",{key:0,value:5},"5 minutes"),r.createElement("option",{key:1,value:10},"10 minutes"),r.createElement("option",{key:2,value:15},"15 minutes"),r.createElement("option",{key:3,value:20},"20 minutes"),r.createElement("option",{key:4,value:30},"30 minutes")))),f=r.createElement("div",{className:"log-event-panel"},r.createElement(s.p,{inline:!0,label:"Enable logged event type",className:"log-event-header"},r.createElement(s.g,{label:"Select all",checked:t.isSelectingAllLogEvents,indeterminate:t.isSelectingIndeterminateLogEvents,onChange:()=>t.selectAllLogEvents()})),r.createElement(s.p,{inline:!1,className:"log-event-list"},u.Event.EVENT_TYPES.map(e=>r.createElement(s.g,{className:"log-event-checkbox",key:e,checked:t.isEventLoggingEnabled(e),label:u.Event.getEventNameFromType(e),onChange:()=>t.setPreference(c.G.LOG_EVENT,e)})))),y=r.createElement("div",{className:"panel-container"},r.createElement(s.p,{inline:!0,label:"Displayed columns"},r.createElement(se.n,{placeholder:"Default Displayed Columns",min:1,value:t.catalogDisplayedColumnSize,stepSize:1,onValueChange:e=>t.setPreference(c.G.CATALOG_DISPLAYED_COLUMN_SIZE,e)})));let b="preference-dialog";e.darkTheme&&(b+=" bp3-dark");const O={icon:"wrench",backdropClassName:"minimal-dialog-backdrop",className:b,canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.preferenceDialogVisible,onClose:e.dialogStore.hidePreferenceDialog,title:"Preferences"};return r.createElement(m,{dialogProps:O,helpType:c.x.PREFERENCES,minWidth:450,minHeight:300,defaultWidth:775,defaultHeight:500,enableResizing:!0},r.createElement("div",{className:"bp3-dialog-body"},r.createElement(s.R,{id:"preferenceTabs",vertical:!0,selectedTabId:this.selectedTab,onChange:this.setSelectedTab},r.createElement(s.Q,{id:Ue.GLOBAL,title:"Global",panel:n}),r.createElement(s.Q,{id:Ue.RENDER_CONFIG,title:"Render Configuration",panel:o}),r.createElement(s.Q,{id:Ue.CONTOUR_CONFIG,title:"Contour Configuration",panel:a}),r.createElement(s.Q,{id:Ue.OVERLAY_CONFIG,title:"Overlay Configuration",panel:p}),r.createElement(s.Q,{id:Ue.CATALOG,title:"Catalog",panel:y}),r.createElement(s.Q,{id:Ue.REGION,title:"Region",panel:h}),r.createElement(s.Q,{id:Ue.PERFORMANCE,title:"Performance",panel:g}),r.createElement(s.Q,{id:Ue.LOG_EVENT,title:"Log Events",panel:f}))),r.createElement("div",{className:"bp3-dialog-footer"},r.createElement("div",{className:"bp3-dialog-footer-actions"},r.createElement(s.W,{content:"Apply to current tab only.",position:k.a.TOP},r.createElement(s.b,{intent:l.a.WARNING,icon:"refresh",onClick:this.reset,text:"Restore defaults"})),r.createElement(s.e,{intent:l.a.NONE,onClick:e.dialogStore.hidePreferenceDialog,text:"Close"}))))}},qe=Object(R.a)(Be.prototype,"selectedTab",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ue.GLOBAL}}),He=Object(R.a)(Be.prototype,"setSelectedTab",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTab=e}}}),Ve=Be))||Ve;var et,tt,it;i(982);let nt=Object(o.a)((tt=class extends r.Component{constructor(e){super(e),Object(x.a)(this,"layoutName",it,this),this.handleInput=e=>{this.layoutName=e.currentTarget.value},this.clearInput=()=>{this.layoutName=""},this.handleKeyDown=e=>{13!==e.keyCode||this.isEmpty||this.saveLayout()},this.saveLayout=()=>{const e=c.e.Instance;e.dialogStore.hideSaveLayoutDialog(),e.layoutStore.setLayoutToBeSaved(this.layoutName),e.layoutStore.layoutExists(this.layoutName)?u.PresetLayout.isPreset(this.layoutName)?e.alertStore.showAlert("Layout name cannot be the same as system presets."):e.alertStore.showInteractiveAlert(`Are you sure to overwrite the existing layout ${this.layoutName}?`,t=>{t&&e.layoutStore.saveLayout()}):e.layoutStore.saveLayout(),this.clearInput()},Object(j.p)(this)}get isEmpty(){return!this.layoutName}render(){const e=c.e.Instance;let t="preference-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"layout-grid",backdropClassName:"minimal-dialog-backdrop",className:t,canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.saveLayoutDialogVisible,onClose:e.dialogStore.hideSaveLayoutDialog,title:"Save Layout"};return r.createElement(m,{dialogProps:i,helpType:c.x.SAVE_LAYOUT,defaultWidth:400,defaultHeight:185,enableResizing:!0},r.createElement("div",{className:a.a.DIALOG_BODY},r.createElement(s.p,{inline:!0,label:"Save current layout as:"},r.createElement(s.x,{className:"layout-name-input",placeholder:"Enter layout name",value:this.layoutName,autoFocus:!0,onChange:this.handleInput,onKeyDown:this.handleKeyDown}))),r.createElement("div",{className:a.a.DIALOG_FOOTER},r.createElement("div",{className:a.a.DIALOG_FOOTER_ACTIONS},r.createElement(s.W,{content:"Layout name cannot be empty!",disabled:!this.isEmpty},r.createElement(s.b,{intent:l.a.PRIMARY,onClick:this.saveLayout,text:"Save",disabled:this.isEmpty})),r.createElement(s.e,{intent:l.a.NONE,text:"Close",onClick:()=>{e.dialogStore.hideSaveLayoutDialog(),this.clearInput()}}))))}},it=Object(R.a)(tt.prototype,"layoutName",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(R.a)(tt.prototype,"isEmpty",[j.i],Object.getOwnPropertyDescriptor(tt.prototype,"isEmpty"),tt.prototype),et=tt))||et;var rt;i(983);let ot=Object(o.a)(rt=class extends r.Component{render(){const e=c.e.Instance;let t="file-info-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"app-header",className:t,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.fileInfoDialogVisible,onClose:e.dialogStore.hideFileInfoDialog,title:"File Header"};return r.createElement(m,{dialogProps:i,helpType:c.x.FILE_INFO,minWidth:400,minHeight:400,defaultWidth:800,defaultHeight:600,enableResizing:!0},r.createElement("div",{className:"bp3-dialog-body"},r.createElement(M.a,{infoTypes:[M.b.IMAGE_FILE,M.b.IMAGE_HEADER],fileInfoExtended:e.activeFrame?e.activeFrame.frameInfo.fileInfoExtended:null,regionFileInfo:"",catalogFileInfo:null,selectedTab:e.dialogStore.selectedFileInfoDialogTab,handleTabChange:e.dialogStore.setSelectedFileInfoDialogTab,isLoading:!1,errorMessage:""})))}})||rt;var at,st=i(76);i(984);const lt=Ke.a.ofType();let ct=Object(o.a)(at=class extends r.Component{constructor(...e){super(...e),this.renderDashModeSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>r.createElement(s.B,{text:c.o[e],onClick:t,key:e})}render(){const e=this.props.frame;return r.createElement("div",{className:"contour-style-panel"},r.createElement(s.p,{inline:!0,label:"Thickness"},r.createElement(se.n,{placeholder:"Thickness",min:.5,max:10,value:e.contourConfig.thickness,majorStepSize:.5,stepSize:.5,onValueChange:e.contourConfig.setThickness})),r.createElement(s.p,{inline:!0,label:"Dashes"},r.createElement(lt,{activeItem:e.contourConfig.dashMode,onItemSelect:e.contourConfig.setDashMode,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:[c.o.None,c.o.Dashed,c.o.NegativeOnly],itemRenderer:this.renderDashModeSelectItem},r.createElement(s.e,{text:c.o[e.contourConfig.dashMode],rightIcon:"double-caret-vertical",alignText:"right"}))),r.createElement(s.p,{inline:!0,label:"Color Mode"},r.createElement(s.r,{value:e.contourConfig.colormapEnabled?1:0,onChange:t=>e.contourConfig.setColormapEnabled(parseInt(t.currentTarget.value)>0)},r.createElement("option",{key:0,value:0},"Constant Color"),r.createElement("option",{key:1,value:1},"Color-mapped"))),r.createElement(s.p,{inline:!0,label:"Color Map",disabled:!e.contourConfig.colormapEnabled},r.createElement(se.d,{inverted:!1,disabled:!e.contourConfig.colormapEnabled,selectedItem:e.contourConfig.colormap,onItemSelect:e.contourConfig.setColormap})),r.createElement(s.p,{inline:!0,label:"Bias",disabled:!e.contourConfig.colormapEnabled},r.createElement(se.n,{disabled:!e.contourConfig.colormapEnabled,placeholder:"Bias",min:-1,max:1,value:e.contourConfig.colormapBias,majorStepSize:.1,stepSize:.1,onValueChange:e.contourConfig.setColormapBias})),r.createElement(s.p,{inline:!0,label:"Contrast",disabled:!e.contourConfig.colormapEnabled},r.createElement(se.n,{disabled:!e.contourConfig.colormapEnabled,placeholder:"Contrast",min:0,max:3,value:e.contourConfig.colormapContrast,majorStepSize:.1,stepSize:.1,onValueChange:e.contourConfig.setColormapContrast})),r.createElement(s.p,{inline:!0,label:"Color",disabled:e.contourConfig.colormapEnabled},r.createElement(se.c,{color:e.contourConfig.color,presetColors:U.e,setColor:t=>e.contourConfig.setColor(t.rgb),disableAlpha:!0,disabled:e.contourConfig.colormapEnabled,darkTheme:this.props.darkTheme})))}})||at;var ut,pt,dt,ht,gt,mt,ft,yt,bt,Ot,St,Ct,Et,It,wt,Tt,vt,At;i(985);const xt=Ke.a.ofType();let Rt=Object(o.a)((pt=class extends r.Component{get minValue(){return void 0===this.enteredMinValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Object(U.D)(this.props.frame.renderConfig.contourHistogram,[.1])[0]:this.enteredMinValue}get maxValue(){return void 0===this.enteredMaxValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Object(U.D)(this.props.frame.renderConfig.contourHistogram,[99.9])[0]:this.enteredMaxValue}constructor(e){super(e),Object(x.a)(this,"generator",dt,this),Object(x.a)(this,"numLevels",ht,this),Object(x.a)(this,"enteredMinValue",gt,this),Object(x.a)(this,"enteredMaxValue",mt,this),Object(x.a)(this,"scalingType",ft,this),this.generateMinMaxLevels=()=>{if(isFinite(this.minValue)&&isFinite(this.maxValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[(this.maxValue+this.minValue)/2];{const e=this.maxValue-this.minValue,t=this.numLevels-1,i=[];for(let n=0;n<this.numLevels;n++){const r=Object(U.eb)(n/t,this.scalingType);i.push(this.minValue+e*r)}return i}}return[]},Object(x.a)(this,"enteredStartValue",yt,this),Object(x.a)(this,"enteredStepValue",bt,this),Object(x.a)(this,"multiplierValue",Ot,this),this.generateStartStepLevels=()=>{if(isFinite(this.startValue)&&isFinite(this.stepValue)&&isFinite(this.multiplierValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[this.startValue];{let e=this.stepValue,t=this.startValue;const i=[];for(let n=0;n<this.numLevels;n++)i.push(t),t+=e,e*=this.multiplierValue;return i}}return[]},Object(x.a)(this,"enteredRefValue",St,this),Object(x.a)(this,"lowerPercentage",Ct,this),Object(x.a)(this,"upperPercentage",Et,this),this.generatePercentageRefLevels=()=>{if(isFinite(this.upperPercentage)&&isFinite(this.lowerPercentage)&&isFinite(this.refValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[this.refValue];{const e=(this.upperPercentage-this.lowerPercentage)/(this.numLevels-1),t=[];for(let i=0;i<this.numLevels;i++)t.push(this.refValue*(this.lowerPercentage+e*i)/100);return t}}return[]},Object(x.a)(this,"enteredMeanValue",It,this),Object(x.a)(this,"enteredSigmaValue",wt,this),Object(x.a)(this,"sigmaLevels",Tt,this),Object(x.a)(this,"handleLevelAdded",vt,this),Object(x.a)(this,"handleLevelRemoved",At,this),this.generateMeanSigmaLevels=()=>this.sigmaLevels.map(e=>this.meanValue+this.sigmaValue*e).filter(e=>isFinite(e)),this.renderGeneratorSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>r.createElement(s.B,{text:e,onClick:t,key:e}),this.generateLevels=()=>{switch(this.generator){case c.p.MinMaxNScaling:this.props.onLevelsGenerated(this.generateMinMaxLevels());break;case c.p.StartStepMultiplier:this.props.onLevelsGenerated(this.generateStartStepLevels());break;case c.p.PercentagesRefValue:this.props.onLevelsGenerated(this.generatePercentageRefLevels());break;case c.p.MeanSigmaList:this.props.onLevelsGenerated(this.generateMeanSigmaLevels())}},Object(j.p)(this)}renderMinMaxParameterRow(){return this.props.frame?r.createElement("div",{className:"parameter-container"},r.createElement("div",{className:"parameter-line"},r.createElement(se.b,{label:"Min",value:this.minValue,onValueChanged:e=>this.enteredMinValue=e,onValueCleared:()=>this.enteredMinValue=void 0,displayExponential:!0}),r.createElement(se.b,{label:"Max",value:this.maxValue,onValueChanged:e=>this.enteredMaxValue=e,onValueCleared:()=>this.enteredMaxValue=void 0,displayExponential:!0})),r.createElement("div",{className:"parameter-line"},r.createElement(s.p,{label:"N",inline:!0},r.createElement(se.n,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})),r.createElement(s.p,{label:"Scaling",inline:!0},r.createElement(se.o,{selectedItem:this.scalingType,onItemSelect:e=>this.scalingType=e})))):null}get startValue(){return void 0===this.enteredStartValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.mean+5*this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredStartValue}get stepValue(){return void 0===this.enteredStepValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?4*this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredStepValue}renderStartStepParameterRow(){return this.props.frame?r.createElement("div",{className:"parameter-container"},r.createElement("div",{className:"parameter-line"},r.createElement(se.b,{label:"Start",value:this.startValue,onValueChanged:e=>this.enteredStartValue=e,onValueCleared:()=>this.enteredStartValue=void 0,displayExponential:!0}),r.createElement(se.b,{label:"Step",value:this.stepValue,onValueChanged:e=>this.enteredStepValue=e,onValueCleared:()=>this.enteredStepValue=void 0,displayExponential:!0})),r.createElement("div",{className:"parameter-line"},r.createElement(s.p,{label:"N",inline:!0},r.createElement(se.n,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})),r.createElement(s.p,{label:"Multiplier",inline:!0},r.createElement(se.n,{value:this.multiplierValue,min:.1,stepSize:1,className:"narrow",onValueChange:e=>this.multiplierValue=e})))):null}get refValue(){return void 0===this.enteredRefValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Object(U.D)(this.props.frame.renderConfig.contourHistogram,[99.9])[0]:this.enteredRefValue}renderPercentageRefParameterRow(){return this.props.frame?r.createElement("div",{className:"parameter-container"},r.createElement("div",{className:"parameter-line"},r.createElement(se.b,{label:"Reference",value:this.refValue,onValueChanged:e=>this.enteredRefValue=e,onValueCleared:()=>this.enteredRefValue=void 0,displayExponential:!0}),r.createElement(s.p,{label:"N",inline:!0},r.createElement(se.n,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)}))),r.createElement("div",{className:"parameter-line"},r.createElement(s.p,{label:"Upper (%)",inline:!0},r.createElement(se.n,{value:this.upperPercentage,min:0,max:100,stepSize:1,className:"narrow",onValueChange:e=>this.upperPercentage=e})),r.createElement(s.p,{label:"Lower (%)",inline:!0},r.createElement(se.n,{value:this.lowerPercentage,min:0,max:100,stepSize:1,className:"narrow",onValueChange:e=>this.lowerPercentage=e})))):null}get meanValue(){return void 0===this.enteredMeanValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.mean:this.enteredMeanValue}get sigmaValue(){return void 0===this.enteredSigmaValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredSigmaValue}renderMeanSigmaParameterRow(){return this.props.frame?r.createElement("div",{className:"parameter-container"},r.createElement("div",{className:"parameter-line"},r.createElement(se.b,{label:"Mean",value:this.meanValue,onValueChanged:e=>this.enteredMeanValue=e,onValueCleared:()=>this.enteredMeanValue=void 0,displayExponential:!0}),r.createElement(se.b,{label:"Sigma",value:this.sigmaValue,onValueChanged:e=>this.enteredSigmaValue=e,onValueCleared:()=>this.enteredSigmaValue=void 0,displayExponential:!0})),r.createElement("div",{className:"parameter-line"},r.createElement(s.p,{label:"Sigma List",inline:!0},r.createElement(s.T,{addOnBlur:!0,fill:!0,tagProps:{minimal:!0},onAdd:this.handleLevelAdded,onRemove:this.handleLevelRemoved,values:this.sigmaLevels.map(e=>e.toString())})))):null}render(){if(!this.props.frame)return null;let e;switch(this.generator){case c.p.MinMaxNScaling:e=this.renderMinMaxParameterRow();break;case c.p.StartStepMultiplier:e=this.renderStartStepParameterRow();break;case c.p.PercentagesRefValue:e=this.renderPercentageRefParameterRow();break;case c.p.MeanSigmaList:e=this.renderMeanSigmaParameterRow()}return r.createElement("div",{className:"contour-generator-panel"},r.createElement("div",{className:"generator-select-row"},r.createElement(s.p,{label:"Generator",inline:!0},r.createElement(xt,{activeItem:this.generator,popoverProps:se.m,filterable:!1,items:[c.p.StartStepMultiplier,c.p.MinMaxNScaling,c.p.PercentagesRefValue,c.p.MeanSigmaList],onItemSelect:e=>this.generator=e,itemRenderer:this.renderGeneratorSelectItem},r.createElement(s.e,{text:this.generator,rightIcon:"double-caret-vertical",alignText:"right"}))),r.createElement(s.e,{intent:"success",className:"generate-button",onClick:this.generateLevels},"Generate")),r.createElement("div",{className:"generator-parameters-row"},r.createElement(s.p,{label:"Parameters",inline:!0},e)))}},dt=Object(R.a)(pt.prototype,"generator",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.props.generatorType?this.props.generatorType:c.p.StartStepMultiplier}}),ht=Object(R.a)(pt.prototype,"numLevels",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),gt=Object(R.a)(pt.prototype,"enteredMinValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mt=Object(R.a)(pt.prototype,"enteredMaxValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft=Object(R.a)(pt.prototype,"scalingType",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c.u.LINEAR}}),Object(R.a)(pt.prototype,"minValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"minValue"),pt.prototype),Object(R.a)(pt.prototype,"maxValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"maxValue"),pt.prototype),yt=Object(R.a)(pt.prototype,"enteredStartValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bt=Object(R.a)(pt.prototype,"enteredStepValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Object(R.a)(pt.prototype,"multiplierValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Object(R.a)(pt.prototype,"startValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"startValue"),pt.prototype),Object(R.a)(pt.prototype,"stepValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"stepValue"),pt.prototype),St=Object(R.a)(pt.prototype,"enteredRefValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=Object(R.a)(pt.prototype,"lowerPercentage",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),Et=Object(R.a)(pt.prototype,"upperPercentage",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Object(R.a)(pt.prototype,"refValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"refValue"),pt.prototype),It=Object(R.a)(pt.prototype,"enteredMeanValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=Object(R.a)(pt.prototype,"enteredSigmaValue",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=Object(R.a)(pt.prototype,"sigmaLevels",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[-5,5,9,13,17]}}),Object(R.a)(pt.prototype,"meanValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"meanValue"),pt.prototype),Object(R.a)(pt.prototype,"sigmaValue",[j.i],Object.getOwnPropertyDescriptor(pt.prototype,"sigmaValue"),pt.prototype),vt=Object(R.a)(pt.prototype,"handleLevelAdded",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{try{for(const t of e){const e=parseFloat(t);isFinite(e)&&this.sigmaLevels.push(e)}}catch(t){console.log(t)}}}}),At=Object(R.a)(pt.prototype,"handleLevelRemoved",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.sigmaLevels=this.sigmaLevels.filter((e,i)=>i!==t)}}}),ut=pt))||ut;var Pt,jt,kt,Ft,Mt,Dt,Nt,Lt,_t,zt,Wt,Gt,Vt,Bt,qt=i(12);i(986);!function(e){e[e.Levels=0]="Levels",e[e.Configuration=1]="Configuration",e[e.Styling=2]="Styling"}(Bt||(Bt={}));const Ht=Ke.a.ofType(),Ut=Ke.a.ofType();let Yt=Object(o.a)((Vt=Gt=class e extends r.Component{constructor(e){super(e),Object(x.a)(this,"showCubeHistogramAlert",kt,this),Object(x.a)(this,"currentTab",Ft,this),Object(x.a)(this,"levels",Mt,this),Object(x.a)(this,"smoothingMode",Dt,this),Object(x.a)(this,"smoothingFactor",Nt,this),this.widgetStore=void 0,this.cachedFrame=void 0,this.cachedHistogram=void 0,this.renderDataSourceSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>e?r.createElement(s.B,{text:e.filename,onClick:t,key:e.frameInfo.fileId}):null,this.renderHistogramSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>r.createElement(s.B,{text:e?"Per-Cube":"Per-Channel",onClick:t,key:e?"cube":"channel"}),this.handleHistogramChange=e=>{const t=c.e.Instance;t&&t.contourDataSource&&(e&&!t.contourDataSource.renderConfig.cubeHistogram?t.contourDataSource.frameInfo.fileFeatureFlags&F.a.FileFeatureFlags.CUBE_HISTOGRAMS?this.handleAlertConfirm():this.showCubeHistogramAlert=!0:t.contourDataSource.renderConfig.setUseCubeHistogramContours(e))},this.handleAlertConfirm=()=>{const e=c.e.Instance,t=e.contourDataSource;t&&t.renderConfig&&(t.renderConfig.setUseCubeHistogramContours(!0),t.renderConfig.cubeHistogramProgress<1&&e.requestCubeHistogram(t.frameInfo.fileId)),this.showCubeHistogramAlert=!1},this.handleAlertCancel=()=>{this.showCubeHistogramAlert=!1},this.handleCubeHistogramCancelled=()=>{const e=c.e.Instance,t=e.contourDataSource;t&&t.renderConfig&&t.renderConfig.setUseCubeHistogramContours(!1),e.cancelCubeHistogramRequest(t.frameInfo.fileId)},this.handleApplyContours=()=>{const e=c.e.Instance.contourDataSource;e&&(e.contourConfig.setContourConfiguration(this.levels.slice(),this.smoothingMode,this.smoothingFactor),e.applyContours())},this.handleClearContours=()=>{const e=c.e.Instance;e.contourDataSource&&e.contourDataSource.clearContours()},this.handleGraphClicked=e=>{this.levels.push(e)},this.handleGraphRightClicked=e=>{let t=-1,i=Number.MAX_VALUE;for(let n=0;n<this.levels.length;n++){const r=Math.abs(e-this.levels[n]);r<i&&(i=r,t=n)}t>=0&&(this.levels=this.levels.filter((e,i)=>i!==t))},Object(x.a)(this,"handleLevelAdded",Lt,this),Object(x.a)(this,"handleLevelRemoved",_t,this),Object(x.a)(this,"handleLevelDragged",zt,this),Object(x.a)(this,"handleLevelsGenerated",Wt,this),Object(j.p)(this),this.widgetStore=new qt.n,this.setDefaultContourParameters(),Object(j.h)(()=>{const e=c.e.Instance;if(e.contourDataSource){const t=e.contourDataSource.renderConfig.contourHistogram;t!==this.cachedHistogram&&(this.cachedHistogram=t,this.widgetStore.clearXYBounds())}const t=this.widgetStore;if(t){const e=this.plotData;e&&t.initXYBoundaries(e.xMin,e.xMax,e.yMin,e.yMax)}})}setDefaultContourParameters(){const e=c.e.Instance,t=e.contourDataSource;t?(this.levels=t.contourConfig.levels.slice(),this.smoothingMode=t.contourConfig.smoothingMode,this.smoothingFactor=t.contourConfig.smoothingFactor):(this.levels=[],this.smoothingMode=e.preferenceStore.contourSmoothingMode,this.smoothingFactor=e.preferenceStore.contourSmoothingFactor)}componentDidUpdate(){const e=c.e.Instance;e.contourDataSource!==this.cachedFrame&&(this.cachedFrame=e.contourDataSource,this.widgetStore.clearXYBounds(),this.setDefaultContourParameters())}get contourConfigChanged(){const e=c.e.Instance.contourDataSource;if(e){const t=this.levels.length;if(e.contourConfig.smoothingMode!==this.smoothingMode)return!0;if(e.contourConfig.smoothingFactor!==this.smoothingFactor)return!0;if(e.contourConfig.levels.length!==t)return!0;for(let i=0;i<t;i++)if(e.contourConfig.levels[i]!==this.levels[i])return!0}return!1}get plotData(){const e=c.e.Instance.contourDataSource;if(e&&e.renderConfig.contourHistogram&&e.renderConfig.contourHistogram.bins&&e.renderConfig.contourHistogram.bins.length){const t=e.renderConfig.contourHistogram;let i=0,n=t.bins.length-1;this.widgetStore.isAutoScaledX||(i=Math.floor((this.widgetStore.minX-t.firstBinCenter)/t.binWidth),i=Object(U.k)(i,0,t.bins.length-1),n=Math.ceil((this.widgetStore.maxX-t.firstBinCenter)/t.binWidth),n=Object(U.k)(n,0,t.bins.length-1));let r,o=t.firstBinCenter+t.binWidth*i,a=t.firstBinCenter+t.binWidth*n,s=t.bins[i],l=s;const c=n-i;if(c>0&&!isNaN(c)){r=new Array(n-i);for(let e=i;e<=n;e++)r[e-i]={x:t.firstBinCenter+t.binWidth*e,y:t.bins[e]},s=Math.min(s,t.bins[e]),l=Math.max(l,t.bins[e])}return{values:r,xMin:o,xMax:a,yMin:s,yMax:l}}return null}render(){const t=c.e.Instance,i={icon:r.createElement(We.a,{icon:"contour",size:We.a.SIZE_LARGE}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.contourDialogVisible,onClose:t.dialogStore.hideContourDialog,className:"contour-dialog",canEscapeKeyClose:!0,title:"Contour Configuration"};if(!t||!t.contourDataSource)return r.createElement(m,{dialogProps:i,helpType:c.x.CONTOUR,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0},r.createElement(s.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}));const n=t.contourDataSource;let o="Value";n.unit&&(o=`Value (${n.unit})`);const u={xLabel:o,darkMode:t.darkTheme,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,showYAxisTicks:!1,showYAxisLabel:!1,graphClicked:this.handleGraphClicked,graphRightClicked:this.handleGraphRightClicked,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2},p=this.plotData;if(p){let e=this.widgetStore.primaryLineColor.colorHex;if(t.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(e=st.a.BLUE4)),u.lineColor=e,this.widgetStore.isAutoScaledX){const e=Math.min(p.xMin,...this.levels),t=Math.max(p.xMax,...this.levels),i=t-e;u.xMin=e-.01*i,u.xMax=t+.01*i}else u.xMin=this.widgetStore.minX,u.xMax=this.widgetStore.maxX;this.widgetStore.isAutoScaledY?(u.yMin=p.yMin,u.yMax=p.yMax):(u.yMin=this.widgetStore.minY,u.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&u.yMin<=0&&(u.yMin=.5),u.data=p.values}const d=this.levels&&this.levels.filter(e=>isFinite(e)).length;u.markers=d?this.levels.map((e,t)=>({value:e,id:"marker-"+t,draggable:!0,dragMove:this.handleLevelDragged(t),horizontal:!1})):[],this.widgetStore.meanRmsVisible&&n.renderConfig.contourHistogram&&n.renderConfig.contourHistogram.stdDev>0&&(u.markers.push({value:n.renderConfig.contourHistogram.mean,id:"marker-mean",draggable:!1,horizontal:!1,color:t.darkTheme?st.a.GREEN4:st.a.GREEN2,dash:[5]}),u.markers.push({value:n.renderConfig.contourHistogram.mean,id:"marker-rms",draggable:!1,horizontal:!1,width:n.renderConfig.contourHistogram.stdDev,opacity:.2,color:t.darkTheme?st.a.GREEN4:st.a.GREEN2}));let h=this.levels.slice().sort((e,t)=>e-t).map(e=>Math.abs(e)<.1?Object(U.jb)(e,2):Object(U.kb)(e,2));const g=r.createElement("div",{className:"contour-level-panel"},n.frameInfo.fileInfoExtended.depth>1&&r.createElement(s.p,{label:"Histogram",inline:!0},r.createElement(Ut,{activeItem:n.renderConfig.useCubeHistogramContours,popoverProps:se.m,filterable:!1,items:[!0,!1],onItemSelect:this.handleHistogramChange,itemRenderer:this.renderHistogramSelectItem},r.createElement(s.e,{text:n.renderConfig.useCubeHistogramContours?"Per-Cube":"Per-Channel",rightIcon:"double-caret-vertical",alignText:"right"}))),r.createElement("div",{className:"histogram-plot"},r.createElement(se.f,u)),r.createElement(Rt,{frame:n,generatorType:t.preferenceStore.contourGeneratorType,onLevelsGenerated:this.handleLevelsGenerated}),r.createElement("div",{className:"contour-level-panel-levels"},r.createElement(s.p,{label:"Levels",inline:!0},r.createElement(s.T,{addOnBlur:!0,fill:!0,tagProps:{minimal:!0},onAdd:this.handleLevelAdded,onRemove:this.handleLevelRemoved,values:h})))),f=r.createElement("div",{className:"contour-config-panel"},r.createElement(s.p,{inline:!0,label:"Smoothing Mode"},r.createElement(s.r,{value:this.smoothingMode,onChange:e=>this.smoothingMode=Number(e.currentTarget.value)},r.createElement("option",{key:F.a.SmoothingMode.NoSmoothing,value:F.a.SmoothingMode.NoSmoothing},"No Smoothing"),r.createElement("option",{key:F.a.SmoothingMode.BlockAverage,value:F.a.SmoothingMode.BlockAverage},"Block"),r.createElement("option",{key:F.a.SmoothingMode.GaussianBlur,value:F.a.SmoothingMode.GaussianBlur},"Gaussian"))),r.createElement(s.p,{inline:!0,label:"Smoothing Factor"},r.createElement(se.n,{placeholder:"Smoothing Factor",min:1,max:33,value:this.smoothingFactor,majorStepSize:1,stepSize:1,onValueChange:e=>Object(j.r)(()=>{this.smoothingFactor=e})})));return r.createElement(m,{dialogProps:i,helpType:c.x.CONTOUR,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0},r.createElement("div",{className:a.a.DIALOG_BODY},r.createElement(s.p,{inline:!0,label:"Data Source"},r.createElement(Ht,{activeItem:n,onItemSelect:t.setContourDataSource,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:t.frames,itemRenderer:this.renderDataSourceSelectItem,disabled:t.animatorStore.animationActive},r.createElement(s.e,{text:n.filename,rightIcon:"double-caret-vertical",alignText:"right",disabled:t.animatorStore.animationActive})),r.createElement(s.W,{content:t.frameLockedToContour?"Data source is locked to active image":"Data source is independent of active image"},r.createElement(s.b,{className:"lock-button",icon:t.frameLockedToContour?"lock":"unlock",minimal:!0,onClick:t.toggleFrameContourLock}))),r.createElement(s.R,{defaultSelectedTabId:Bt.Levels,renderActiveTabPanelOnly:!1},r.createElement(s.Q,{id:Bt.Levels,title:"Levels",panel:g,panelClassName:"contour-level-panel"}),r.createElement(s.Q,{id:Bt.Configuration,title:"Configuration",panel:f,panelClassName:"contour-config-panel"}),r.createElement(s.Q,{id:Bt.Styling,title:"Styling",panel:r.createElement(ct,{frame:n,darkTheme:t.darkTheme})}))),r.createElement("div",{className:a.a.DIALOG_FOOTER},r.createElement("div",{className:a.a.DIALOG_FOOTER_ACTIONS},r.createElement(s.b,{intent:l.a.WARNING,onClick:this.handleClearContours,disabled:!n.contourConfig.enabled,text:"Clear"}),r.createElement(s.b,{intent:l.a.SUCCESS,onClick:this.handleApplyContours,disabled:!d||!this.contourConfigChanged&&n.contourConfig.enabled,text:"Apply"}),r.createElement(s.b,{intent:l.a.NONE,onClick:t.dialogStore.hideContourDialog,text:"Close"}))),r.createElement(s.a,{className:t.darkTheme?"bp3-dark":"",icon:"time",isOpen:this.showCubeHistogramAlert,onCancel:this.handleAlertCancel,onConfirm:this.handleAlertConfirm,cancelButtonText:"Cancel"},r.createElement("p",null,"Calculating a cube histogram may take a long time, depending on the size of the file. Are you sure you want to continue?")),r.createElement(ue,{isOpen:n.renderConfig.useCubeHistogramContours&&n.renderConfig.cubeHistogramProgress<1,progress:n.renderConfig.cubeHistogramProgress,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleCubeHistogramCancelled,text:"Calculating cube histogram"}))}},Gt.DefaultWidth=600,Gt.DefaultHeight=660,jt=Vt,kt=Object(R.a)(jt.prototype,"showCubeHistogramAlert",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=Object(R.a)(jt.prototype,"currentTab",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Bt.Levels}}),Mt=Object(R.a)(jt.prototype,"levels",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=Object(R.a)(jt.prototype,"smoothingMode",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(R.a)(jt.prototype,"smoothingFactor",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(R.a)(jt.prototype,"setDefaultContourParameters",[j.g],Object.getOwnPropertyDescriptor(jt.prototype,"setDefaultContourParameters"),jt.prototype),Object(R.a)(jt.prototype,"contourConfigChanged",[j.i],Object.getOwnPropertyDescriptor(jt.prototype,"contourConfigChanged"),jt.prototype),Object(R.a)(jt.prototype,"plotData",[j.i],Object.getOwnPropertyDescriptor(jt.prototype,"plotData"),jt.prototype),Lt=Object(R.a)(jt.prototype,"handleLevelAdded",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{try{for(const t of e){const e=parseFloat(t);isFinite(e)&&this.levels.push(e)}}catch(t){console.log(t)}}}}),_t=Object(R.a)(jt.prototype,"handleLevelRemoved",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.levels=this.levels.filter((e,i)=>i!==t)}}}),zt=Object(R.a)(jt.prototype,"handleLevelDragged",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>t=>{e>=0&&e<this.levels.length&&(this.levels[e]=t)}}}),Wt=Object(R.a)(jt.prototype,"handleLevelsGenerated",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.levels=e.slice()}}}),Pt=jt))||Pt;var Xt,Kt,Qt,Zt,$t,Jt,ei=i(28);i(987);let ti=Object(o.a)((Kt=class extends r.Component{get executionEntries(){let e=this.inputString.split("\n"),t=new Array;for(let i of e){if(!i||!i.length||i.startsWith("//"))continue;const e=ei.e.FromString(i);if(!e.valid)return[];t.push(e)}return t}constructor(e){super(e),Object(x.a)(this,"inputString",Qt,this),Object(x.a)(this,"isExecuting",Zt,this),Object(x.a)(this,"errorString",$t,this),Object(x.a)(this,"handleActionInput",Jt,this),this.onExecuteClicked=async()=>{this.isExecuting=!0,await ei.f.Instance.executeEntries(this.executionEntries),localStorage.setItem("debugString",this.inputString),this.isExecuting=!1},Object(j.p)(this)}render(){const e=c.e.Instance;let t="debug-execution-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"console",className:t,canEscapeKeyClose:!0,canOutsideClickClose:!1,isOpen:e.dialogStore.debugExecutionDialogVisible,onClose:e.dialogStore.hideDebugExecutionDialog,isCloseButtonShown:!0,title:"Execute a command"},n=this.executionEntries&&this.executionEntries.length;return r.createElement(m,{dialogProps:i,defaultWidth:700,defaultHeight:400,enableResizing:!0},r.createElement("div",{className:a.a.DIALOG_BODY},r.createElement(s.o,{className:"input-text",onChange:this.handleActionInput,value:this.inputString,minLines:5,intent:n?"success":"warning",placeholder:"Enter execution string",multiline:!0})),r.createElement("div",{className:a.a.DIALOG_FOOTER},r.createElement("div",{className:a.a.DIALOG_FOOTER_ACTIONS},r.createElement(s.b,{intent:l.a.PRIMARY,onClick:this.onExecuteClicked,disabled:!n||this.isExecuting,text:"Execute"}),r.createElement(s.b,{intent:l.a.WARNING,onClick:()=>e.backendService.scriptingStream.next(JSON.parse(this.inputString)),text:"DebugTest"}),r.createElement(s.b,{intent:l.a.NONE,onClick:e.dialogStore.hideDebugExecutionDialog,text:"Close"}))))}},Qt=Object(R.a)(Kt.prototype,"inputString",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e;return null!==(e=localStorage.getItem("debugString"))&&void 0!==e?e:""}}),Zt=Object(R.a)(Kt.prototype,"isExecuting",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$t=Object(R.a)(Kt.prototype,"errorString",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(R.a)(Kt.prototype,"executionEntries",[j.i],Object.getOwnPropertyDescriptor(Kt.prototype,"executionEntries"),Kt.prototype),Jt=Object(R.a)(Kt.prototype,"handleActionInput",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.inputString=e}}}),Xt=Kt))||Xt},633:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Layout","description":"Schema for CARTA Layout (Version 2)","$id":"carta_layout_2","definitions":{"percentage-value":{"description":"Describes a percentage value from 0 to 100","type":"number","minimum":0,"maximum":100},"plot-type":{"description":"Describes a plot type","enum":["Steps","Lines","Points"]},"line-width":{"description":"Describes a plot line width","type":"number","minimum":0.5,"maximum":10},"point-size":{"description":"Describes a plot point size","type":"number","minimum":0.5,"maximum":10},"opacity":{"description":"Describes an opacity value between zero and one","type":"number","minimum":0,"maximum":1},"spatial-coord":{"description":"Spatial coordinate","type":"string","enum":["x","Ix","Qx","Ux","Vx","y","Iy","Qy","Uy","Vy"]},"spectral-coord":{"description":"Spectral coordinate","type":"string","enum":["z","Iz","Qz","Uz","Vz"]},"basic-widget":{"description":"Widgets that have no associated settings","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"type":"string","enum":["layer-list","log","animator","region-list","image-view","stats","spectral-line-query","catalog-overlay","catalog-plot"]},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"spectral-profiler":{"description":"Spectral profiler widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"spectral-profiler"},"widgetSettings":{"properties":{"coordinate":{"$ref":"#/definitions/spectral-coord"},"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"spatial-profiler":{"description":"Spatial profiler widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"spatial-profiler"},"widgetSettings":{"properties":{"coordinate":{"$ref":"#/definitions/spatial-coord"},"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"wcsAxisVisible":{"type":"boolean"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"coord":{"description":"Legacy V1 entry (replaced by widgetSettings.coordinate","$ref":"#/definitions/spatial-coord"},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"render-config":{"description":"Render config widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"render-config"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"logScaleY":{"type":"boolean"},"markerTextVisible":{"type":"boolean"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"histogram":{"description":"Histogram widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"histogram"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"logScaleY":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"stokes":{"description":"Stokes analysis widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"stokes"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"secondaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"plotType":{"$ref":"#/definitions/plot-type"},"colorMap":{"type":"string"},"scatterPlotPointSize":{"$ref":"#/definitions/point-size"},"pointTransparency":{"$ref":"#/definitions/opacity"},"equalAxes":{"type":"boolean"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"carta-widget":{"description":"A CARTA widget","oneOf":[{"$ref":"#/definitions/basic-widget"},{"$ref":"#/definitions/spectral-profiler"},{"$ref":"#/definitions/spatial-profiler"},{"$ref":"#/definitions/render-config"},{"$ref":"#/definitions/histogram"},{"$ref":"#/definitions/stokes"}]},"gl-container":{"description":"A GoldenLayout container","type":"object","required":["type","content"],"additionalProperties":false,"properties":{"type":{"enum":["row","column","stack"]},"content":{"type":"array","minItems":1,"items":{"oneOf":[{"$ref":"#/definitions/gl-container"},{"$ref":"#/definitions/carta-widget"}]}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"},"activeItemIndex":{"type":"integer","minimum":0}}}},"required":["layoutVersion","docked","floating"],"properties":{"layoutVersion":{"description":"The version of the layout contained","type":"integer","minimum":1,"maximum":2},"docked":{"description":"GoldenLayout widget hierarchy","$ref":"#/definitions/gl-container"},"floating":{"description":"List of floating widgets","type":"array","items":{"allOf":[{"$ref":"#/definitions/carta-widget"},{"properties":{"defaultX":{"type":"number"},"defaultY":{"type":"number"},"defaultWidth":{"type":"number"},"defaultHeight":{"type":"number"}}}]}}}}')},639:function(e,t){},64:function(e,t,i){"use strict";i.d(t,"a",(function(){return m})),i.d(t,"b",(function(){return f})),i.d(t,"d",(function(){return y})),i.d(t,"c",(function(){return b}));var n,r,o,a,s,l,c,u,p=i(3),d=i(2),h=(i(29),i(1)),g=i(184);const m=-1;let f,y;!function(e){e[e.ACTIVE=-3]="ACTIVE",e[e.IMAGE=-1]="IMAGE",e[e.CURSOR=0]="CURSOR"}(f||(f={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.CLOSED_AND_POINT=1]="CLOSED_AND_POINT"}(y||(y={}));let b=(n=class{constructor(e){this.appStore=void 0,Object(p.a)(this,"fileId",r,this),Object(p.a)(this,"regionIdMap",o,this),Object(p.a)(this,"type",a,this),Object(p.a)(this,"clearFrameEntry",s,this),Object(p.a)(this,"clearRegionMap",l,this),Object(p.a)(this,"setRegionId",c,this),Object(p.a)(this,"setFileId",u,this),Object(h.p)(this),this.appStore=g.a.Instance,this.fileId=m,this.type=e,this.regionIdMap=new Map}get effectiveFrame(){return this.appStore.activeFrame&&this.appStore.frames&&this.appStore.frames.length>0?this.fileId!==m&&this.appStore.getFrame(this.fileId)?this.appStore.getFrame(this.fileId):this.appStore.activeFrame:null}get matchActiveFrame(){return this.effectiveFrame&&this.appStore.activeFrame.frameInfo.fileId===this.effectiveFrame.frameInfo.fileId}get effectiveRegionId(){if(this.effectiveFrame){const e=this.regionIdMap.get(this.fileId);if(e!==f.ACTIVE&&void 0!==e)return e;{const e=this.effectiveFrame.regionSet.selectedRegion;if(e)return this.type!==y.CLOSED||e.isClosedRegion?e.regionId:f.IMAGE}}return this.type===y.CLOSED?f.IMAGE:f.CURSOR}get matchesSelectedRegion(){if(this.matchActiveFrame){if(this.appStore.selectedRegion)return this.effectiveRegionId===this.appStore.selectedRegion.regionId;if(this.effectiveRegionId===f.CURSOR||this.effectiveRegionId===f.IMAGE)return!0}return!1}static CalculateRequirementsArray(e){const t=new Map;return e.forEach(e=>{const i=e.effectiveFrame;if(!i||!i.regionSet)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=i.regionSet.regions.find(e=>e.regionId===r);if(-1===r||o&&o.isClosedRegion){let e=t.get(n);e||(e=[],t.set(n,e)),-1===e.indexOf(r)&&e.push(r)}}),t}},r=Object(d.a)(n.prototype,"fileId",[h.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(d.a)(n.prototype,"regionIdMap",[h.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(d.a)(n.prototype,"type",[h.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(d.a)(n.prototype,"clearFrameEntry",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionIdMap.delete(e)}}}),l=Object(d.a)(n.prototype,"clearRegionMap",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionIdMap.clear()}}}),c=Object(d.a)(n.prototype,"setRegionId",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.regionIdMap.set(e,t)}}}),u=Object(d.a)(n.prototype,"setFileId",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileId=e}}}),Object(d.a)(n.prototype,"effectiveFrame",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"effectiveFrame"),n.prototype),Object(d.a)(n.prototype,"matchActiveFrame",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"matchActiveFrame"),n.prototype),Object(d.a)(n.prototype,"effectiveRegionId",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"effectiveRegionId"),n.prototype),Object(d.a)(n.prototype,"matchesSelectedRegion",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"matchesSelectedRegion"),n.prototype),n)},641:function(e,t){},651:function(e,t){},653:function(e,t){},68:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return p}));var n,r=i(0),o=i(14),a=i(47),s=i(490),l=i(440),c=i(7);i(971);let u;!function(e){e.IMAGE_FILE="image-file",e.IMAGE_HEADER="image-header",e.REGION_FILE="region-file",e.CATALOG_FILE="catalog-file",e.CATALOG_HEADER="catalog-header"}(u||(u={}));let p=Object(o.a)(n=class extends r.Component{constructor(...e){super(...e),this.renderInfoTabs=()=>{const e=this.props.infoTypes.map(e=>u.IMAGE_FILE===e?r.createElement(a.Q,{key:e,id:e,title:"File Information"}):u.IMAGE_HEADER===e?r.createElement(a.Q,{key:e,id:e,title:"Header"}):u.CATALOG_FILE===e?r.createElement(a.Q,{key:e,id:e,title:"Catalog Information"}):u.CATALOG_HEADER===e?r.createElement(a.Q,{key:e,id:e,title:"Catalog Header"}):r.createElement(a.Q,{key:e,id:e,title:"Region Information"}));return r.createElement(a.R,{id:"file-info-tabs",onChange:e=>this.props.handleTabChange(e),selectedTabId:this.props.selectedTab},e)},this.renderHDUList=()=>{var e;return this.props.HDUOptions&&(null===(e=this.props.HDUOptions.HDUList)||void 0===e?void 0:e.length)>1?r.createElement(a.k,{vertical:!1},r.createElement(a.m,null),r.createElement(a.p,{inline:!0,label:"HDU"},r.createElement(a.r,{options:this.props.HDUOptions.HDUList,onChange:e=>this.props.HDUOptions.handleSelectedHDUChange(e.currentTarget.value)}))):void 0},this.renderInfoPanel=()=>{if(this.props.isLoading)return r.createElement(a.C,{className:"non-ideal-state-file",icon:r.createElement(a.O,{className:"astLoadingSpinner"}),title:"Loading file info..."});if(this.props.errorMessage)return r.createElement(a.C,{className:"non-ideal-state-file",icon:"document",title:"Cannot open file!",description:this.props.errorMessage+" Select another file from the folder."});if(!this.props.fileInfoExtended&&!this.props.regionFileInfo&&!this.props.catalogFileInfo)return r.createElement(a.C,{className:"non-ideal-state-file",icon:"document",title:"No file selected.",description:"Select a file from the folder."});switch(this.props.selectedTab){case u.IMAGE_FILE:return this.renderImageHeaderList(this.props.fileInfoExtended.computedEntries);case u.IMAGE_HEADER:return this.renderImageHeaderList(this.props.fileInfoExtended.headerEntries);case u.REGION_FILE:return r.createElement(a.I,{className:"file-info-pre"},this.props.regionFileInfo);case u.CATALOG_FILE:return r.createElement(a.I,{className:"file-info-pre"},r.createElement(a.U,null,this.props.catalogFileInfo.description));case u.CATALOG_HEADER:return this.props.catalogHeaderTable?r.createElement(a.I,{className:"file-header-table"},r.createElement(c.w,this.props.catalogHeaderTable)):"";default:return""}}}renderImageHeaderList(e){const t=({index:t,style:i})=>{if(t<0||t>=(null===e||void 0===e?void 0:e.length))return null;const n=e[t];return"END"===n.name?r.createElement("div",{style:i,className:"header-name"},""+n.name):r.createElement("div",{style:i,className:"header-entry"},r.createElement("span",{className:"header-name"},n.name),r.createElement("span",{className:"header-value"}," = ",""+n.value),n.comment&&r.createElement("span",{className:"header-comment"}," / ",n.comment," "))},i=(null===e||void 0===e?void 0:e.length)||0;return r.createElement(l.a,null,({height:e,width:n})=>r.createElement(s.a,{className:"header-list bp3-code-block",itemCount:i,itemSize:18,height:e,width:n},t))}render(){return r.createElement("div",{className:"file-info"},r.createElement("div",{className:"file-info-panel-top"},this.renderInfoTabs(),this.renderHDUList()),this.renderInfoPanel())}})||n},680:function(e,t){},681:function(e,t){},686:function(e,t){},688:function(e,t){},7:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"v",(function(){return a})),i.d(t,"e",(function(){return s})),i.d(t,"z",(function(){return l})),i.d(t,"c",(function(){return T})),i.d(t,"d",(function(){return k})),i.d(t,"g",(function(){return le})),i.d(t,"y",(function(){return ce})),i.d(t,"f",(function(){return pe})),i.d(t,"j",(function(){return ue})),i.d(t,"k",(function(){return de})),i.d(t,"l",(function(){return he})),i.d(t,"p",(function(){return Ae})),i.d(t,"i",(function(){return Re})),i.d(t,"h",(function(){return Pe})),i.d(t,"r",(function(){return ke})),i.d(t,"q",(function(){return Fe})),i.d(t,"x",(function(){return Ve})),i.d(t,"w",(function(){return Be})),i.d(t,"m",(function(){return Qe.a})),i.d(t,"o",(function(){return Qe.b})),i.d(t,"b",(function(){return Ze})),i.d(t,"u",(function(){return Je})),i.d(t,"n",(function(){return et})),i.d(t,"t",(function(){return nt})),i.d(t,"s",(function(){return rt}));var n=i(47),r=i(45);const o=n.V.create({className:"app-toaster",position:r.a.BOTTOM});function a(e,t,i){return{icon:e,intent:"success",message:t,timeout:i||0===i?i:3e3}}function s(e){return{icon:"error",intent:"danger",message:e,timeout:3e4,action:{onClick:()=>{var t;return null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e)},icon:"clipboard"}}}function l(e){return{icon:"warning-sign",intent:"warning",message:e,timeout:3e4,action:{onClick:()=>{var t;return null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e)},icon:"clipboard"}}}var c,u,p,d,h,g,m,f=i(3),y=i(2),b=(i(29),i(0)),O=i(36),S=i(1),C=i(14),E=i(43),I=i.n(E),w=i(489);i(858);let T=Object(C.a)((m=g=class e extends b.Component{constructor(t){super(t),Object(f.a)(this,"displayColorPicker",p,this),Object(f.a)(this,"handleColorClick",d,this),Object(f.a)(this,"handleColorClose",h,this),this.handleColorChange=O.throttle(e=>{this.props.setColor&&this.props.setColor(e)},e.CHANGE_DELAY),Object(S.p)(this)}render(){let e="color-picker-popup";this.props.darkTheme&&(e+=" bp3-dark");const t=I()(this.props.color).toString();return b.createElement(n.F,{isOpen:this.displayColorPicker,onClose:this.handleColorClose,position:n.H.RIGHT,popoverClassName:e},b.createElement(n.e,{onClick:this.handleColorClick,className:"color-swatch-button",disabled:this.props.disabled},b.createElement("div",{style:{backgroundColor:t}})),b.createElement(w.a,{color:this.props.color,onChange:this.handleColorChange,disableAlpha:this.props.disableAlpha,presetColors:this.props.presetColors}))}},g.CHANGE_DELAY=100,u=m,p=Object(y.a)(u.prototype,"displayColorPicker",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(y.a)(u.prototype,"handleColorClick",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.displayColorPicker=!0}}}),h=Object(y.a)(u.prototype,"handleColorClose",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.displayColorPicker=!1}}}),c=u))||c;var v=i(491),A=i(61),x=i(79),R=i.n(x);const P=v.a.ofType(),j={minimal:!0,position:"auto-end",popoverClassName:"colormap-select-popover"},k=e=>{const t=t=>{const i=A.b.COLOR_MAPS_ALL.length,n=A.b.COLOR_MAPS_ALL.indexOf(t);return b.createElement("div",{className:"colormap-block",style:{transform:`scaleX(${e.inverted?-1:1})`,height:"15px",backgroundImage:`url(${R.a})`,backgroundSize:`100% calc(300% * ${i})`,backgroundPosition:`0 calc(300% * -${n} - 15px)`}})};return b.createElement(P,{disabled:e.disabled,activeItem:e.selectedItem,popoverProps:j,filterable:!1,items:A.b.COLOR_MAPS_SELECTED,onItemSelect:e.onItemSelect,itemRenderer:(e,{handleClick:i,modifiers:r,query:o})=>r.matchesPredicate?b.createElement(n.B,{active:r.active,disabled:r.disabled,label:e,key:e,onClick:i,text:t(e)}):null},b.createElement(n.e,{disabled:e.disabled,text:t(e.selectedItem),rightIcon:"double-caret-vertical",alignText:"right"}))};var F,M=i(191),D=i(76),N=i(42),L=i(25),_=i(59);i(910);let z=Object(C.a)(F=class extends b.Component{render(){let e={opacity:this.props.visible?1:0},t="profiler-toolbar";return this.props.darkMode&&(t+=" bp3-dark"),b.createElement(n.f,{className:t,style:e},b.createElement(n.W,{content:"Export image"},b.createElement(n.b,{icon:"floppy-disk",onClick:this.props.exportImage})),b.createElement(n.W,{content:"Export data"},b.createElement(n.b,{icon:"th",onClick:this.props.exportData})))}})||F;var W,G,V,B,q,H,U,Y,X,K,Q,Z,$,J,ee,te,ie,ne,re=i(160),oe=i(6);i(911);let ae,se,le;!function(e){e[e.NONE=0]="NONE",e[e.X=1]="X",e[e.Y=2]="Y",e[e.XY=3]="XY"}(ae||(ae={})),function(e){e[e.NONE=0]="NONE",e[e.SELECTING=1]="SELECTING",e[e.PANNING=2]="PANNING"}(se||(se={})),function(e){e[e.BOX=0]="BOX",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL"}(le||(le={}));const ce=.05;let ue,pe=Object(C.a)((G=class e extends b.Component{get isSelecting(){return this.interactionMode===se.SELECTING}get isPanning(){return this.interactionMode===se.PANNING}get zoomMode(){const e=Math.abs(this.selectionBoxEnd.x-this.selectionBoxStart.x),t=Math.abs(this.selectionBoxEnd.y-this.selectionBoxStart.y);return e>20&&t>20&&this.props.graphZoomedXY?ae.XY:this.props.graphZoomedX&&this.props.graphZoomedY?e>t?ae.X:ae.Y:this.props.graphZoomedX?ae.X:this.props.graphZoomedY?ae.Y:ae.NONE}get cursorShape(){const e=void 0!==this.hoveredMarker&&!this.isSelecting;return this.isPanning||e?"move":this.props.selectingMode===le.HORIZONTAL?"ew-resize":this.props.selectingMode===le.VERTICAL?"ns-resize":"crosshair"}constructor(t){super(t),this.plotRef=void 0,this.stageRef=void 0,this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.panPrevious=void 0,this.previousClickTime=void 0,this.pendingClickHandle=void 0,Object(f.a)(this,"chartArea",V,this),Object(f.a)(this,"hoveredMarker",B,this),Object(f.a)(this,"width",q,this),Object(f.a)(this,"height",H,this),Object(f.a)(this,"interactionMode",U,this),Object(f.a)(this,"panStart",Y,this),Object(f.a)(this,"selectionBoxStart",X,this),Object(f.a)(this,"selectionBoxEnd",K,this),Object(f.a)(this,"isMouseEntered",Q,this),Object(f.a)(this,"isMarkerDragging",Z,this),this.onPlotRefUpdated=e=>{this.plotRef=e},Object(f.a)(this,"updateChart",$,this),Object(f.a)(this,"resize",J,this),Object(f.a)(this,"showMouseEnterWidget",ee,this),Object(f.a)(this,"hideMouseEnterWidget",te,this),this.dragBoundsFuncVertical=(e,t)=>{let i=this.chartArea.left,n=this.chartArea.right;return t.dragCustomBoundary&&t.dragCustomBoundary.xMin&&(i=this.getCanvasSpaceX(t.dragCustomBoundary.xMin)),t.dragCustomBoundary&&t.dragCustomBoundary.xMax&&(n=this.getCanvasSpaceX(t.dragCustomBoundary.xMax)),{x:Object(oe.k)(e.x,i,n),y:0}},this.dragBoundsFuncHorizontal=(e,t)=>{let i=this.chartArea.top,n=this.chartArea.bottom;return t.dragCustomBoundary&&t.dragCustomBoundary.yMin&&(i=this.getCanvasSpaceY(t.dragCustomBoundary.yMin)),t.dragCustomBoundary&&t.dragCustomBoundary.yMax&&(n=this.getCanvasSpaceY(t.dragCustomBoundary.yMax)),{x:0,y:Object(oe.k)(e.y,i,n)}},Object(f.a)(this,"onMarkerDragStart",ie,this),Object(f.a)(this,"onMarkerDragEnd",ne,this),this.onMarkerDragged=(e,t)=>{if(this.props.markers&&t&&t.dragMove){let i;i=t.horizontal?this.getValueForPixelY(Object(oe.k)(e.evt.offsetY,this.chartArea.top,this.chartArea.bottom),this.props.logY):this.getValueForPixelX(Object(oe.k)(e.evt.offsetX,this.chartArea.left,this.chartArea.right)),t.dragMove(i)}if(this.props.graphCursorMoved){const t=this.getValueForPixelX(e.evt.offsetX);this.props.graphCursorMoved(t)}},this.onStageMouseDown=e=>{const t=e.evt;this.stageClickStartX=t.offsetX,this.stageClickStartY=t.offsetY;const i=t.ctrlKey||t.shiftKey||t.altKey;void 0!==this.hoveredMarker||i?i&&this.startPanning(t.offsetX):this.startSelection(t.offsetX,t.offsetY)},this.onStageMouseUp=e=>{const t=e.evt,i=Math.abs(t.offsetX-this.stageClickStartX),n=Math.abs(t.offsetY-this.stageClickStartY);if(i<3&&n<3)this.onStageClick(e);else if((this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0)&&(this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.isSelecting&&this.zoomMode!==ae.NONE)){let e=Math.min(this.selectionBoxStart.x,this.selectionBoxEnd.x),t=Math.max(this.selectionBoxStart.x,this.selectionBoxEnd.x),i=this.getValueForPixelX(e),n=this.getValueForPixelX(t);e=Math.min(this.selectionBoxStart.y,this.selectionBoxEnd.y),t=Math.max(this.selectionBoxStart.y,this.selectionBoxEnd.y);let r=this.getValueForPixelY(t,this.props.logY),o=this.getValueForPixelY(e,this.props.logY);this.props.setSelectedRange&&this.props.selectingMode===le.HORIZONTAL?this.props.setSelectedRange(i,n):this.props.setSelectedRange&&this.props.selectingMode===le.VERTICAL?this.props.setSelectedRange(r,o):(this.zoomMode===ae.X&&this.props.graphZoomedX(i,n),this.zoomMode===ae.Y?this.props.graphZoomedY(r,o):this.zoomMode===ae.XY&&this.props.graphZoomedXY(i,n,r,o))}this.endInteractions()},this.onStageMouseMove=e=>{if(this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0){const t=e.evt,i=this.chartArea;let n=Object(oe.k)(t.offsetX,i.left-1,i.right+1),r=Object(oe.k)(t.offsetY,i.top-1,i.bottom+1);if(this.isSelecting)this.updateSelection(n,r);else if(this.isPanning&&this.props.graphZoomedX){const e=n,t=this.getValueForPixelX(this.panPrevious),i=this.getValueForPixelX(e)-t;this.updatePan(e),this.props.graphZoomedX(this.props.xMin-i,this.props.xMax-i)}if(this.interactionMode===se.NONE&&this.props.graphCursorMoved){const e=this.getValueForPixelX(n);this.props.graphCursorMoved(e)}}},this.onStageClick=e=>{const t={x:e.evt.offsetX,y:e.evt.offsetY},i=e.evt.button,n=performance.now(),r=n-this.previousClickTime;if(this.previousClickTime=n,r<300)return this.onStageDoubleClick(),void clearTimeout(this.pendingClickHandle);this.pendingClickHandle=setTimeout(()=>{const e=Math.abs(t.x-this.stageClickStartX),n=Math.abs(t.y-this.stageClickStartY);if(!(e>1||n>1))if(this.props.graphClicked&&0===i){const e=t.x,i=this.getValueForPixelX(e);this.props.graphClicked(i)}else if(this.props.graphRightClicked&&2===i){const e=t.x,i=this.getValueForPixelX(e);this.props.graphRightClicked(i)}},300)},this.onStageRightClick=e=>{this.props.graphRightClicked&&e.evt.preventDefault()},this.onStageDoubleClick=()=>{this.props.graphZoomReset&&this.props.graphZoomReset()},this.onStageWheel=e=>{if((this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0)&&this.props.scrollZoom&&this.props.graphZoomedX&&this.chartArea){const t=e.evt,i=this.chartArea,n=15,r=.001;if(t.offsetX>i.right||t.offsetX<i.left)return;const o=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n,a=this.props.xMax-this.props.xMin,s=(t.offsetX-i.left)/(i.right-i.left),l=r*o*a;this.props.graphZoomedX(this.props.xMin-l*s,this.props.xMax+l*(1-s))}},this.onKeyDown=e=>{this.isSelecting&&e.keyCode===M.ESCAPE&&this.endInteractions()},this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseMove=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget()},this.exportImage=()=>{const t=this.plotRef,i=this.showPlotxAxes();i&&this.exportSubPlotImage(!0);const n=t.chartInstance.canvas,r=this.props.plotName||"unknown",o=this.props.imageName||"unknown",a=document.createElement("canvas");a.width=n.width,a.height=n.height;const s=a.getContext("2d");s.fillStyle="rgba(255, 255, 255, 0.0)",s.fillRect(0,0,a.width,a.height),s.drawImage(n,0,0);const l=this.genChartBorder();l&&(s.beginPath(),s.strokeStyle=this.props.darkMode?D.a.DARK_GRAY5:D.a.LIGHT_GRAY1,s.lineWidth=1,s.rect(l.x,l.y,l.width,l.height),s.stroke());const c=this.genMeanRMSForPngPlot();(null===c||void 0===c?void 0:c.mean)&&(s.beginPath(),s.setLineDash([c.mean.dash]),s.strokeStyle=c.mean.color,s.lineWidth=1,s.moveTo(c.mean.xLeft,c.mean.y),s.lineTo(c.mean.xRight,c.mean.y),s.stroke()),(null===c||void 0===c?void 0:c.RMS)&&(s.fillStyle=c.RMS.color,s.globalAlpha=c.RMS.opacity,s.fillRect(c.RMS.xLeft,c.RMS.yTop,c.RMS.width,c.RMS.height),s.globalAlpha=1);const u=this.genSpectralLinesForPngPlot();null===u||void 0===u||u.forEach(e=>{s.beginPath(),s.strokeStyle=e.color,s.lineWidth=1,s.moveTo(e.x,e.yBottom),s.lineTo(e.x,e.yTop),s.stroke(),s.save(),s.font="12px Arial",s.translate(e.x,e.yBottom),s.rotate(-Math.PI/2),s.fillStyle=e.color,s.fillText(e.text,0,10),s.restore()}),a.toBlob(t=>{const i=document.createElement("a");i.download=`${o}-${r.replace(" ","-")}-${e.GetTimestamp()}.png`,i.href=URL.createObjectURL(t),i.dispatchEvent(new MouseEvent("click"))},"image/png"),i&&this.exportSubPlotImage(!1)},this.exportData=()=>{const t=this.props.plotName||"unknown",i=this.props.imageName||"unknown";let n=`# ${i} ${t}`;this.props.xLabel&&(n+="\n# xLabel: "+this.props.xLabel),this.props.yLabel&&(n+="\n# yLabel: "+this.props.yLabel),this.props.comments&&this.props.comments.length&&(n+="\n"+this.props.comments.map(e=>"# "+e).join("\n"));let r=[];"histogram"===t?r=this.props.data.map(e=>`${Object(oe.jb)(e.x,10)}\t${Object(oe.jb)(e.y,10)}`):(this.props.data&&this.props.data.length&&(r=this.props.tickTypeX===_.b.Scientific?this.props.data.map(e=>`${Object(oe.jb)(e.x,10)}\t${Object(oe.jb)(e.y,10)}`):this.props.data.map(e=>`${e.x}\t${Object(oe.jb)(e.y,10)}`)),this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size&&this.props.multiPlotPropsMap.forEach((e,t)=>{t===re.b.LinearPolarizationQ||t===re.b.LinearPolarizationU?r.push(`# ${t}\t`):t.indexOf("smoothed")>-1&&(e.exportData&&e.exportData.forEach((e,t)=>{r.push(`# ${t}: ${e}\t`)}),r.push("# smoothed_x\tsmoothed_y")),e.data&&e.data.forEach(e=>{r.push(`${e.x}\t${Object(oe.jb)(e.y,10)}`)})}));const o=`data:text/tab-separated-values;charset=utf-8,${n}\n# x\ty\n${r.join("\n")}\n`,a=encodeURI(o).replace(/#/g,"%23"),s=document.createElement("a");s.href=a,s.download=`${i}-${t.replace(" ","-")}-${e.GetTimestamp()}.tsv`,s.dispatchEvent(new MouseEvent("click"))},this.calcMarkerBox=e=>{if(!e)return;const t=this.chartArea,i=this.getPixelForValueY(e.value-e.width/2,this.props.logY)-this.getPixelForValueY(e.value+e.width/2,this.props.logY),n=this.getCanvasSpaceY(e.value),r=Object(oe.k)(n-i,t.top,t.bottom);return{lowerBound:r,height:Object(oe.k)(n+i,t.top,t.bottom)-r}},this.genHorizontalLine=(e,t,i,n,r)=>{const o=this.chartArea,a=o.right-o.left,s=t&&this.hoveredMarker.id===e.id,l=(o.left+o.right)/2;let c=null;if(e.width||!(r<Math.floor(o.top-1)||r>Math.ceil(o.bottom+1))){if(s){const t=16/1.5,r=3;c=[b.createElement(L.Line,{listening:!1,key:0,points:[o.left,0,o.right,0],strokeWidth:1,stroke:i,opacity:n,dash:e.dash}),b.createElement(L.Arrow,{listening:!1,key:1,x:l,y:0,points:[0,-r,0,-r-t],pointerLength:t,pointerWidth:t,opacity:n,fill:i}),b.createElement(L.Arrow,{listening:!1,key:2,x:l,y:0,points:[0,r,0,r+t],pointerLength:t,pointerWidth:t,opacity:n,fill:i})]}else if(e.width){const t=this.calcMarkerBox(e),s=(null===t||void 0===t?void 0:t.lowerBound)-r;c=[b.createElement(L.Rect,{listening:!1,key:0,x:o.left,y:s,width:a,height:null===t||void 0===t?void 0:t.height,fill:i,opacity:n})]}else c=[b.createElement(L.Line,{listening:!1,key:0,points:[o.left,0,o.right,0],strokeWidth:1,stroke:i,opacity:n,dash:e.dash})];return e.label&&c.push(b.createElement(L.Text,{align:"left",fill:i,key:c.length,text:e.label,x:o.left,y:0})),e.draggable?b.createElement(L.Group,{key:e.id+"-draggable",x:0,y:r,draggable:!0,dragBoundFunc:t=>this.dragBoundsFuncHorizontal(t,e),onDragMove:t=>this.onMarkerDragged(t,e)},b.createElement(L.Rect,{x:o.left,y:-8,width:a,height:16,onMouseEnter:()=>this.setHoveredMarker(e),onMouseLeave:()=>this.setHoveredMarker(void 0)}),c):b.createElement(L.Group,{key:e.id,x:0,y:r},c)}},this.genVerticalLine=(e,t,i,n,r,o)=>{const a=this.chartArea,s=a.bottom-a.top,l=t&&this.hoveredMarker.id===e.id,c=(a.top+a.bottom)/2;let u=null;if(e.width||!(r<Math.floor(a.left-1)||r>Math.ceil(a.right+1))){if(l){const e=16/1.5,t=3;u=[b.createElement(L.Line,{listening:!1,key:0,points:[0,a.top,0,a.bottom],strokeWidth:1,stroke:i,opacity:n}),b.createElement(L.Arrow,{listening:!1,key:1,x:0,y:c,points:[-t,0,-t-e,0],pointerLength:e,pointerWidth:e,opacity:n,fill:i}),b.createElement(L.Arrow,{listening:!1,key:2,x:0,y:c,points:[t,0,t+e,0],pointerLength:e,pointerWidth:e,opacity:n,fill:i})]}else if(e.width){const t=this.getPixelForValueX(e.value+e.width/2)-this.getPixelForValueX(e.value-e.width/2);let o=Object(oe.k)(r-t,a.left,a.right),l=Object(oe.k)(r+t,a.left,a.right)-o;u=[b.createElement(L.Rect,{listening:!1,key:0,x:o-r,y:a.top,width:l,height:s,fill:i,opacity:n})]}else u=[b.createElement(L.Line,{listening:!1,key:0,points:[0,a.top,0,a.bottom],strokeWidth:1,stroke:i,opacity:n,dash:e.dash})];return o&&e.label&&u.push(b.createElement(L.Text,{align:"left",fill:i,key:u.length,text:e.label,rotation:-90,x:0,y:a.bottom})),e.draggable?b.createElement(L.Group,{key:e.id+"-draggable",x:r,y:0,draggable:!0,dragBoundFunc:t=>this.dragBoundsFuncVertical(t,e),onDragStart:this.onMarkerDragStart,onDragEnd:this.onMarkerDragEnd,onDragMove:t=>this.onMarkerDragged(t,e)},b.createElement(L.Rect,{x:-8,y:a.top,width:16,height:s,onMouseEnter:()=>this.setHoveredMarker(e),onMouseLeave:()=>this.setHoveredMarker(void 0)}),u):b.createElement(L.Group,{key:e.id,x:r,y:0},u)}},this.genLines=()=>{const e=this.chartArea,t=void 0!==this.hoveredMarker&&!this.isSelecting;let i=[];if(this.props.markers&&this.props.markers.length&&e){const n=Math.abs(e.right-e.left),r=12*this.props.markers.length/2<n;for(let e=0;e<this.props.markers.length;e++){const n=this.props.markers[e],o=n.color||(this.props.darkMode?D.a.RED4:D.a.RED2),a=!n.isMouseMove||this.isMouseEntered&&!this.isMarkerDragging?n.opacity||1:0;if(n.horizontal){let e=this.getCanvasSpaceY(n.value);if(isNaN(e))continue;i.push(this.genHorizontalLine(n,t,o,a,e))}else{let e=this.getCanvasSpaceX(n.value);if(isNaN(e))continue;if(n.interactionMarker){const r=!n.isMouseMove&&this.isMouseEntered?0:n.opacity||1;i.push(this.genVerticalLine(n,t,o,r,e))}else i.push(this.genVerticalLine(n,t,o,a,e,r))}}}return i},this.genSelectionRect=()=>{let e=null;const t=this.chartArea,i=this.selectionBoxStart,n=this.selectionBoxEnd,r={x:n.x-i.x,y:n.y-i.y},o=Math.abs(r.x),a=Math.abs(r.y);if(this.isSelecting&&(o>3||a>3)&&t){const o=t.right-t.left,a=t.bottom-t.top;if(this.zoomMode===ae.X){const o=Object(oe.k)(20,0,i.y-t.top),s=Object(oe.k)(20,0,t.bottom-i.y);e=[b.createElement(L.Rect,{fill:D.a.GRAY3,key:0,opacity:.2,x:i.x,y:t.top,width:r.x,height:a}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:1,x:i.x,y:i.y,points:[0,-o,0,s],strokeWidth:3}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:2,x:n.x,y:i.y,points:[0,-o,0,s],strokeWidth:3})]}else if(this.zoomMode===ae.Y){const a=Object(oe.k)(20,0,i.x-t.left),s=Object(oe.k)(20,0,t.right-i.x);e=[b.createElement(L.Rect,{fill:D.a.GRAY3,key:0,opacity:.2,x:t.left,y:i.y,width:o,height:r.y}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:1,x:i.x,y:i.y,points:[-a,0,s,0],strokeWidth:3}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:2,x:i.x,y:n.y,points:[-a,0,s,0],strokeWidth:3})]}else this.zoomMode===ae.XY&&(e=[b.createElement(L.Rect,{fill:D.a.GRAY3,key:0,opacity:.2,x:i.x,y:i.y,width:r.x,height:r.y}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:1,x:i.x,y:i.y,points:[0,10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:2,x:n.x,y:i.y,points:[0,10,0,0,-10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:3,x:i.x,y:n.y,points:[0,-10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:4,x:n.x,y:n.y,points:[-10,0,0,0,0,-10],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)})])}return e},this.genChartBorder=()=>{const e=this.chartArea;let t=void 0;return e&&(t={x:(Math.floor(e.left)-.5)*devicePixelRatio,y:(Math.floor(e.top)-.5)*devicePixelRatio,width:Math.ceil(e.right-e.left+1)*devicePixelRatio,height:Math.ceil(e.bottom-e.top+1)*devicePixelRatio}),t},this.genBorderRect=()=>{const e=this.chartArea;let t=null;return e&&(t=b.createElement(L.Rect,{x:Math.floor(e.left)-.5*devicePixelRatio,y:Math.floor(e.top)-.5*devicePixelRatio,width:Math.ceil(e.right-e.left+1),height:Math.ceil(e.bottom-e.top+1),listening:!1,stroke:this.props.darkMode?D.a.DARK_GRAY5:D.a.LIGHT_GRAY1,strokeWidth:1})),t},this.genMeanRMSForPngPlot=()=>{var e;let t={mean:void 0,RMS:void 0};const i=this.chartArea;return null===(e=this.props.markers)||void 0===e||e.forEach(e=>{const n=this.getCanvasSpaceY(e.value);if((null===e||void 0===e?void 0:e.id.match(/^marker-mean/))&&!isNaN(n)&&(t.mean={color:null===e||void 0===e?void 0:e.color,dash:e.dash,y:n*devicePixelRatio,xLeft:i.left*devicePixelRatio,xRight:i.right*devicePixelRatio}),(null===e||void 0===e?void 0:e.id.match(/^marker-rms/))&&!isNaN(n)){const n=this.calcMarkerBox(e);t.RMS={color:null===e||void 0===e?void 0:e.color,opacity:null===e||void 0===e?void 0:e.opacity,xLeft:i.left*devicePixelRatio,yTop:(null===n||void 0===n?void 0:n.lowerBound)*devicePixelRatio,width:(i.right-i.left)*devicePixelRatio,height:(null===n||void 0===n?void 0:n.height)*devicePixelRatio}}}),t},this.genSpectralLinesForPngPlot=()=>{var e;let t=[];const i=this.chartArea;return null===(e=this.props.markers)||void 0===e||e.forEach(e=>{const n=this.getCanvasSpaceX(e.value);(null===e||void 0===e?void 0:e.id.match(/^spectral-line-/))&&!isNaN(n)&&t.push({color:null===e||void 0===e?void 0:e.color,text:null===e||void 0===e?void 0:e.label,x:n,yBottom:i.bottom,yTop:i.top})}),t},Object(S.p)(this)}getValueForPixelX(e){if(!this.chartArea)return;return(e-this.chartArea.left)/(this.chartArea.right-this.chartArea.left)*(this.props.xMax-this.props.xMin)+this.props.xMin}getValueForPixelY(e,t=!1){if(this.chartArea){if(t){let t=this.chartArea.bottom-e;return t/=this.chartArea.bottom-this.chartArea.top,t*=Math.log10(this.props.yMax/this.props.yMin),Math.pow(10,Math.log10(this.props.yMin)+t)}return(this.chartArea.bottom-e)/(this.chartArea.bottom-this.chartArea.top)*(this.props.yMax-this.props.yMin)+this.props.yMin}}getPixelForValueX(e){if(!this.chartArea)return;return(e-this.props.xMin)/(this.props.xMax-this.props.xMin)*(this.chartArea.right-this.chartArea.left)+this.chartArea.left}getPixelForValueY(e,t=!1){if(!this.chartArea)return;let i;return i=t?(Math.log(this.props.yMax)-Math.log(e))/(Math.log(this.props.yMax)-Math.log(this.props.yMin)):(this.props.yMax-e)/(this.props.yMax-this.props.yMin),i*(this.chartArea.bottom-this.chartArea.top)+this.chartArea.top}getCanvasSpaceX(e){return Math.floor(this.getPixelForValueX(e))+.5*devicePixelRatio}getCanvasSpaceY(e){return Math.floor(this.getPixelForValueY(e,this.props.logY))+.5*devicePixelRatio}setHoveredMarker(e){this.hoveredMarker=e}startSelection(e,t){this.interactionMode=se.SELECTING,this.selectionBoxStart={x:e,y:t},this.selectionBoxEnd={x:e,y:t}}startPanning(e){this.interactionMode=se.PANNING,this.panPrevious=e}endInteractions(){this.interactionMode=se.NONE}updateSelection(e,t){this.selectionBoxEnd={x:e,y:t}}updatePan(e){this.panPrevious=e}static GetTimestamp(){const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`}exportSubPlotImage(e){const t=this.plotRef.chartInstance;t.config.options.scales.xAxes[0].ticks.display=e,t.config.options.scales.xAxes[0].ticks.major.display=e,t.config.options.scales.xAxes[0].ticks.minor.display=e;let i=10;e||(i=0),t.options.scales.xAxes[0].gridLines.tickMarkLength=i,t.options.scales.xAxes[0].scaleLabel.display=e,t.update()}showPlotxAxes(){const e=this.plotRef.chartInstance;return!(!0!==this.props.isGroupSubPlot||!e||!1!==e.options.scales.xAxes[0].ticks.display)}render(){return b.createElement("div",{className:"line-plot-component",style:{cursor:this.cursorShape},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,tabIndex:0},b.createElement(N.a,{handleWidth:!0,handleHeight:!0,onResize:this.resize,refreshMode:"throttle",refreshRate:33}),this.width>0&&this.height>0&&b.createElement(_.a,Object.assign({},this.props,{plotRefUpdated:this.onPlotRefUpdated,chartAreaUpdated:this.updateChart,width:this.width,height:this.height})),this.width>0&&this.height>0&&b.createElement(L.Stage,{className:"annotation-stage",ref:e=>this.stageRef=e,width:this.width,height:this.height,onMouseDown:this.onStageMouseDown,onMouseUp:this.onStageMouseUp,onContextMenu:this.onStageRightClick,onMouseMove:this.onStageMouseMove,onWheel:this.onStageWheel},b.createElement(L.Layer,null,this.genLines(),this.genSelectionRect(),this.genBorderRect())),b.createElement(z,{darkMode:this.props.darkMode,visible:this.isMouseEntered&&(void 0!==this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0),exportImage:this.exportImage,exportData:this.exportData}))}},V=Object(y.a)(G.prototype,"chartArea",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=Object(y.a)(G.prototype,"hoveredMarker",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=Object(y.a)(G.prototype,"width",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),H=Object(y.a)(G.prototype,"height",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),U=Object(y.a)(G.prototype,"interactionMode",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return se.NONE}}),Y=Object(y.a)(G.prototype,"panStart",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),X=Object(y.a)(G.prototype,"selectionBoxStart",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),K=Object(y.a)(G.prototype,"selectionBoxEnd",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),Q=Object(y.a)(G.prototype,"isMouseEntered",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Z=Object(y.a)(G.prototype,"isMarkerDragging",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(y.a)(G.prototype,"isSelecting",[S.i],Object.getOwnPropertyDescriptor(G.prototype,"isSelecting"),G.prototype),Object(y.a)(G.prototype,"isPanning",[S.i],Object.getOwnPropertyDescriptor(G.prototype,"isPanning"),G.prototype),Object(y.a)(G.prototype,"zoomMode",[S.i],Object.getOwnPropertyDescriptor(G.prototype,"zoomMode"),G.prototype),Object(y.a)(G.prototype,"cursorShape",[S.i],Object.getOwnPropertyDescriptor(G.prototype,"cursorShape"),G.prototype),$=Object(y.a)(G.prototype,"updateChart",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chartArea=e}}}),J=Object(y.a)(G.prototype,"resize",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),ee=Object(y.a)(G.prototype,"showMouseEnterWidget",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0,this.props.mouseEntered&&this.props.mouseEntered(!0)}}}),te=Object(y.a)(G.prototype,"hideMouseEnterWidget",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1,this.props.mouseEntered&&this.props.mouseEntered(!1)}}}),ie=Object(y.a)(G.prototype,"onMarkerDragStart",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMarkerDragging=!0}}}),ne=Object(y.a)(G.prototype,"onMarkerDragEnd",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMarkerDragging=!1}}}),Object(y.a)(G.prototype,"setHoveredMarker",[S.g],Object.getOwnPropertyDescriptor(G.prototype,"setHoveredMarker"),G.prototype),Object(y.a)(G.prototype,"startSelection",[S.g],Object.getOwnPropertyDescriptor(G.prototype,"startSelection"),G.prototype),Object(y.a)(G.prototype,"startPanning",[S.g],Object.getOwnPropertyDescriptor(G.prototype,"startPanning"),G.prototype),Object(y.a)(G.prototype,"endInteractions",[S.g],Object.getOwnPropertyDescriptor(G.prototype,"endInteractions"),G.prototype),Object(y.a)(G.prototype,"updateSelection",[S.g],Object.getOwnPropertyDescriptor(G.prototype,"updateSelection"),G.prototype),Object(y.a)(G.prototype,"updatePan",[S.g],Object.getOwnPropertyDescriptor(G.prototype,"updatePan"),G.prototype),W=G))||W;!function(e){e.STEPS="Steps",e.LINES="Lines",e.POINTS="Points"}(ue||(ue={}));class de extends b.Component{constructor(...e){super(...e),this.plotTypeButton=e=>b.createElement(n.W,{content:e},b.createElement(n.b,{icon:de.getIconForType(e),active:this.props.value===e,onClick:()=>this.props.onValueChanged(e)}))}static getIconForType(e){switch(e){case ue.STEPS:return"step-chart";case ue.LINES:return"timeline-line-chart";default:return"scatter-plot"}}render(){return b.createElement(n.f,{className:"plot-type-selector"},this.plotTypeButton(ue.STEPS),this.plotTypeButton(ue.LINES),this.plotTypeButton(ue.POINTS))}}i(914);b.Component;i(915);const he=e=>{var t;let i="";return null===(t=e.info)||void 0===t||t.forEach((e,t)=>{i=0===t?e:i+", "+e}),b.createElement("div",{className:"profiler-info"},b.createElement("pre",null,i))};var ge,me,fe,ye,be,Oe,Se,Ce,Ee,Ie,we,Te,ve;i(916);let Ae=Object(C.a)((me=class extends b.Component{get isSelecting(){return this.interactionMode===se.SELECTING}get isPanning(){return this.interactionMode===se.PANNING}constructor(e){super(e),this.markerOpacity=.8,this.plotRef=void 0,this.previousClickTime=void 0,this.pendingClickHandle=void 0,this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.panPrevious=void 0,Object(f.a)(this,"selectionBoxStart",fe,this),Object(f.a)(this,"selectionBoxEnd",ye,this),Object(f.a)(this,"chartArea",be,this),Object(f.a)(this,"width",Oe,this),Object(f.a)(this,"height",Se,this),Object(f.a)(this,"isMouseEntered",Ce,this),Object(f.a)(this,"interactionMode",Ee,this),this.onPlotRefUpdated=e=>{this.plotRef=e},Object(f.a)(this,"updateChart",Ie,this),Object(f.a)(this,"resize",we,this),Object(f.a)(this,"showMouseEnterWidget",Te,this),Object(f.a)(this,"hideMouseEnterWidget",ve,this),this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseMove=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget(),this.props.mouseEntered&&this.props.mouseEntered(!1)},this.onKeyDown=e=>{this.isSelecting&&e.keyCode===M.ESCAPE&&this.endInteractions()},this.genBorderRect=()=>{const e=this.chartArea;let t=null;return this.chartArea&&(t=b.createElement(L.Rect,{x:Math.floor(e.left)-.5*devicePixelRatio,y:Math.floor(e.top)-.5*devicePixelRatio,width:Math.ceil(e.right-e.left+1),height:Math.ceil(e.bottom-e.top+1),listening:!1,stroke:this.props.darkMode?D.a.DARK_GRAY5:D.a.LIGHT_GRAY1,strokeWidth:1})),t},this.genIndicator=()=>{const e=this.chartArea;let t=[];const i=this.props.indicatorInteractionChannel,n=this.markerOpacity;if(e&&i&&i.hoveredChannel&&!isNaN(i.hoveredChannel.x)&&!isNaN(i.hoveredChannel.y)&&!this.isMouseEntered&&i.start){const e=this.props.indicatorInteractionChannel.hoveredChannel,i=this.props.darkMode?D.a.GRAY4:D.a.GRAY2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){let n=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0)),r=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1));t.push(this.genCircle("scatter-indicator-y-hovered-interaction-circle",i,n,r))}}if(e&&i&&i.currentChannel&&!isNaN(i.currentChannel.x)&&!isNaN(i.currentChannel.y)){const e=this.props.indicatorInteractionChannel.currentChannel,i=this.props.darkMode?D.a.RED4:D.a.RED2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){let r=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0)),o=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1));t.push(this.genXline("scatter-indicator-x-current-interactive",i,n,r)),t.push(this.genYline("scatter-indicator-y-current-interactive",i,n,o))}}if(this.isMouseEntered&&this.props.cursorNearestPoint){const e=this.props.cursorNearestPoint,i=this.props.darkMode?D.a.GRAY4:D.a.GRAY2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){const n=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0))+.5*devicePixelRatio,r=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1))+.5*devicePixelRatio;t.push(this.genCircle("scatter-indicator-y-hovered-circle",i,n,r))}}return t},this.exportImage=()=>{const e=this.plotRef.chartInstance.canvas,t=this.props.plotName||"unknown",i=this.props.imageName||"unknown",n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.fillStyle="rgba(255, 255, 255, 0.0)",r.fillRect(0,0,n.width,n.height),r.drawImage(e,0,0),n.toBlob(e=>{const n=document.createElement("a");n.download=`${i}-${t.replace(" ","-")}-${this.getTimestamp()}.png`,n.href=URL.createObjectURL(e),n.dispatchEvent(new MouseEvent("click"))},"image/png")},this.exportData=()=>{const e=this.props.plotName||"unknown",t=this.props.imageName||"unknown";let i=`# ${t} ${e}`;this.props.xLabel&&(i+="\n# xLabel: "+this.props.xLabel),this.props.yLabel&&(i+="\n# yLabel: "+this.props.yLabel),this.props.comments&&this.props.comments.length&&(i+="\n"+this.props.comments.map(e=>"# "+e).join("\n"));let n=[];"histogram"===e?n=this.props.data.map(e=>`${Object(oe.jb)(e.x,10)}\t${Object(oe.jb)(e.y,10)}`):this.props.data&&this.props.data.length&&(n=this.props.tickTypeX===_.b.Scientific?this.props.data.map(e=>`${Object(oe.jb)(e.x,10)}\t${Object(oe.jb)(e.y,10)}`):this.props.data.map(e=>`${e.x}\t${Object(oe.jb)(e.y,10)}`));const r=`data:text/tab-separated-values;charset=utf-8,${i}\n# x\ty\n${n.join("\n")}\n`,o=encodeURI(r).replace(/#/g,"%23"),a=document.createElement("a");a.href=o,a.download=`${t}-${e.replace(" ","-")}-${this.getTimestamp()}.tsv`,a.dispatchEvent(new MouseEvent("click"))},this.onStageMouseMove=e=>{var t;if(this.props.data||(null===(t=this.props.multiPlotPropsMap)||void 0===t?void 0:t.size)>0){const t=e.evt,i=this.chartArea;let n=Object(oe.k)(t.offsetX,i.left-1,i.right+1),r=Object(oe.k)(t.offsetY,i.top-1,i.bottom+1);if(this.interactionMode===se.NONE&&this.props.graphCursorMoved){const e=this.getValueForPixelX(n),t=this.getValueForPixelY(r);this.props.graphCursorMoved(e,t)}if(this.isPanning&&this.props.graphZoomedXY){const e=n,t=r,i=this.getValueForPixelX(this.panPrevious.x),o=this.getValueForPixelX(e)-i,a=this.getValueForPixelY(this.panPrevious.y),s=this.getValueForPixelY(t)-a;this.updatePan(e,t);const l=this.props.xMin-o,c=this.props.xMax-o,u=this.props.yMin-s,p=this.props.yMax-s;this.props.graphZoomedXY(l,c,u,p)}this.isSelecting&&this.updateSelection(n,r)}},this.onStageMouseDown=e=>{const t=e.evt;this.stageClickStartX=t.offsetX,this.stageClickStartY=t.offsetY;const i=t.ctrlKey||t.shiftKey||t.altKey;i?i&&this.startPanning(t.offsetX,t.offsetY):this.startSelection(t.offsetX,t.offsetY)},this.onStageDoubleClick=()=>{this.props.graphZoomReset&&this.props.graphZoomReset()},this.onStageClick=e=>{const t=e.evt.offsetX,i=e.evt.offsetY,n=e.evt.button,r=performance.now(),o=r-this.previousClickTime;if(this.previousClickTime=r,o<300)return this.onStageDoubleClick(),void clearTimeout(this.pendingClickHandle);this.pendingClickHandle=setTimeout(()=>{const e=Math.abs(t-this.stageClickStartX),r=Math.abs(i-this.stageClickStartY);e>1||r>1||this.props.graphClicked&&0===n&&this.props.cursorNearestPoint&&this.props.graphClicked(this.props.cursorNearestPoint.x,this.props.cursorNearestPoint.y,this.props.data)},300)},this.onStageMouseUp=e=>{const t=e.evt,i=Math.abs(t.offsetX-this.stageClickStartX),n=Math.abs(t.offsetY-this.stageClickStartY);if(i<3&&n<3)this.onStageClick(e);else if(this.props.data&&(this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.isSelecting&&this.zoomMode!==ae.NONE)){let e=Math.min(this.selectionBoxStart.x,this.selectionBoxEnd.x),t=Math.max(this.selectionBoxStart.x,this.selectionBoxEnd.x),i=this.getValueForPixelX(e),n=this.getValueForPixelX(t);e=Math.min(this.selectionBoxStart.y,this.selectionBoxEnd.y),t=Math.max(this.selectionBoxStart.y,this.selectionBoxEnd.y);let r=this.getValueForPixelY(t),o=this.getValueForPixelY(e);this.zoomMode===ae.X&&this.props.graphZoomedX(i,n),this.zoomMode===ae.Y?this.props.graphZoomedY(r,o):this.zoomMode===ae.XY&&this.props.graphZoomedXY(i,n,r,o)}this.endInteractions()},this.onStageWheel=e=>{if(this.props.data&&this.props.scrollZoom&&this.props.graphZoomedXY&&this.chartArea){const t=e.evt,i=this.chartArea,n=15,r=.001;if(t.offsetX>i.right||t.offsetX<i.left||t.offsetY>i.bottom||t.offsetY<i.top)return;const o=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n;let a=this.props.xMax-this.props.xMin;const s=(t.offsetX-i.left)/(i.right-i.left),l=r*o*a;let c=this.props.yMax-this.props.yMin;const u=(t.offsetY-i.top)/(i.bottom-i.top),p=r*o*c,d=this.props.xMin-l*s,h=this.props.xMax+l*(1-s),g=this.props.yMin-p*(1-u),m=this.props.yMax+p*u;this.props.graphZoomedXY(d,h,g,m)}},this.genSelectionRect=()=>{let e=null;const t=this.chartArea,i=this.selectionBoxStart,n=this.selectionBoxEnd,r={x:n.x-i.x,y:n.y-i.y},o=Math.abs(r.x),a=Math.abs(r.y);if(this.isSelecting&&(o>3||a>3)&&t){const o=t.right-t.left,a=t.bottom-t.top;if(this.zoomMode===ae.X){const o=Object(oe.k)(20,0,i.y-t.top),s=Object(oe.k)(20,0,t.bottom-i.y);e=[b.createElement(L.Rect,{fill:D.a.GRAY3,key:0,opacity:.2,x:i.x,y:t.top,width:r.x,height:a}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:1,x:i.x,y:i.y,points:[0,-o,0,s],strokeWidth:3}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:2,x:n.x,y:i.y,points:[0,-o,0,s],strokeWidth:3})]}else if(this.zoomMode===ae.Y){const a=Object(oe.k)(20,0,i.x-t.left),s=Object(oe.k)(20,0,t.right-i.x);e=[b.createElement(L.Rect,{fill:D.a.GRAY3,key:0,opacity:.2,x:t.left,y:i.y,width:o,height:r.y}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:1,x:i.x,y:i.y,points:[-a,0,s,0],strokeWidth:3}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:2,x:i.x,y:n.y,points:[-a,0,s,0],strokeWidth:3})]}else this.zoomMode===ae.XY&&(e=[b.createElement(L.Rect,{fill:D.a.GRAY3,key:0,opacity:.2,x:i.x,y:i.y,width:r.x,height:r.y}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:1,x:i.x,y:i.y,points:[0,10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:2,x:n.x,y:i.y,points:[0,10,0,0,-10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:3,x:i.x,y:n.y,points:[0,-10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)}),b.createElement(L.Line,{stroke:D.a.GRAY3,key:4,x:n.x,y:n.y,points:[-10,0,0,0,0,-10],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)})])}return e},Object(S.p)(this)}endInteractions(){this.interactionMode=se.NONE}getTimestamp(){const e=new Date;return`${e.getFullYear()}-${e.getMonth()+1}-${e.getDate()}-${e.getHours()}-${e.getMinutes()}-${e.getSeconds()}`}getPixelValue(e,t,i,n){if(!this.chartArea)return;let r=(e-t)/(i-t);return n?r*(this.chartArea.right-this.chartArea.left)+this.chartArea.left:(r=1-r,r*(this.chartArea.bottom-this.chartArea.top)+this.chartArea.top)}getValueForPixelX(e){if(!this.chartArea)return;return(e-this.chartArea.left)/(this.chartArea.right-this.chartArea.left)*(this.props.xMax-this.props.xMin)+this.props.xMin}getValueForPixelY(e){if(!this.chartArea)return;return(this.chartArea.bottom-e)/(this.chartArea.bottom-this.chartArea.top)*(this.props.yMax-this.props.yMin)+this.props.yMin}genXline(e,t,i,n){const r=this.chartArea;let o=[];return r&&o.push(b.createElement(L.Line,{listening:!1,key:0,points:[0,r.top,0,r.bottom],strokeWidth:1,stroke:t,opacity:i})),b.createElement(L.Group,{key:e,x:n,y:0},o)}genYline(e,t,i,n){const r=this.chartArea;let o=[];return r&&o.push(b.createElement(L.Line,{listening:!1,key:0,points:[r.left,0,r.right,0],strokeWidth:1,stroke:t,opacity:i})),b.createElement(L.Group,{key:e,x:0,y:n},o)}genCircle(e,t,i,n){let r=.5,o=3;return this.props&&this.props.pointRadius&&(r=this.props.pointRadius-1<=0?.5:this.props.pointRadius-1,o=this.props.pointRadius+2.5),b.createElement(L.Group,{key:e,x:i,y:n},b.createElement(L.Ring,{innerRadius:r,outerRadius:o,fill:t}))}startSelection(e,t){this.interactionMode=se.SELECTING,this.selectionBoxStart={x:e,y:t},this.selectionBoxEnd={x:e,y:t}}startPanning(e,t){this.interactionMode=se.PANNING,this.panPrevious={x:e,y:t}}updateSelection(e,t){this.selectionBoxEnd={x:e,y:t}}updatePan(e,t){this.panPrevious={x:e,y:t}}get zoomMode(){const e=Math.abs(this.selectionBoxEnd.x-this.selectionBoxStart.x),t=Math.abs(this.selectionBoxEnd.y-this.selectionBoxStart.y);return e>20&&t>20&&this.props.graphZoomedXY?ae.XY:this.props.graphZoomedX&&this.props.graphZoomedY?e>t?ae.X:ae.Y:this.props.graphZoomedX?ae.X:this.props.graphZoomedY?ae.Y:ae.NONE}render(){return b.createElement("div",{className:"scatter-plot-component",style:{cursor:this.isPanning?"move":"crosshair"},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,tabIndex:0},b.createElement(N.a,{handleWidth:!0,handleHeight:!0,onResize:this.resize,refreshMode:"throttle",refreshRate:33}),this.width>0&&this.height>0&&b.createElement(_.a,Object.assign({},this.props,{plotRefUpdated:this.onPlotRefUpdated,chartAreaUpdated:this.updateChart,width:this.width,height:this.height})),this.width>0&&this.height>0&&b.createElement(L.Stage,{className:"annotation-stage",width:this.width,height:this.height,onMouseMove:this.onStageMouseMove,onMouseDown:this.onStageMouseDown,onMouseUp:this.onStageMouseUp,onWheel:this.onStageWheel},b.createElement(L.Layer,null,this.genIndicator(),this.genBorderRect(),this.genSelectionRect())),b.createElement(z,{darkMode:this.props.darkMode,visible:this.isMouseEntered&&(void 0!==this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0),exportImage:this.exportImage,exportData:this.exportData}))}},fe=Object(y.a)(me.prototype,"selectionBoxStart",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),ye=Object(y.a)(me.prototype,"selectionBoxEnd",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),be=Object(y.a)(me.prototype,"chartArea",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=Object(y.a)(me.prototype,"width",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Se=Object(y.a)(me.prototype,"height",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ce=Object(y.a)(me.prototype,"isMouseEntered",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ee=Object(y.a)(me.prototype,"interactionMode",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return se.NONE}}),Object(y.a)(me.prototype,"isSelecting",[S.i],Object.getOwnPropertyDescriptor(me.prototype,"isSelecting"),me.prototype),Object(y.a)(me.prototype,"isPanning",[S.i],Object.getOwnPropertyDescriptor(me.prototype,"isPanning"),me.prototype),Ie=Object(y.a)(me.prototype,"updateChart",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chartArea=e,this.props.updateChartArea&&this.props.updateChartArea(e)}}}),we=Object(y.a)(me.prototype,"resize",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Te=Object(y.a)(me.prototype,"showMouseEnterWidget",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0,this.props.mouseEntered&&this.props.mouseEntered(!0)}}}),ve=Object(y.a)(me.prototype,"hideMouseEnterWidget",[S.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1}}}),Object(y.a)(me.prototype,"endInteractions",[S.g],Object.getOwnPropertyDescriptor(me.prototype,"endInteractions"),me.prototype),Object(y.a)(me.prototype,"startSelection",[S.g],Object.getOwnPropertyDescriptor(me.prototype,"startSelection"),me.prototype),Object(y.a)(me.prototype,"startPanning",[S.g],Object.getOwnPropertyDescriptor(me.prototype,"startPanning"),me.prototype),Object(y.a)(me.prototype,"updateSelection",[S.g],Object.getOwnPropertyDescriptor(me.prototype,"updateSelection"),me.prototype),Object(y.a)(me.prototype,"updatePan",[S.g],Object.getOwnPropertyDescriptor(me.prototype,"updatePan"),me.prototype),Object(y.a)(me.prototype,"zoomMode",[S.i],Object.getOwnPropertyDescriptor(me.prototype,"zoomMode"),me.prototype),ge=me))||ge;var xe;i(917);let Re;!function(e){e[e.MIN_WIDTH=.5]="MIN_WIDTH",e[e.MAX_WIDTH=10]="MAX_WIDTH",e[e.MIN_POINT_SIZE=.5]="MIN_POINT_SIZE",e[e.MAX_POINT_SIZE=10]="MAX_POINT_SIZE",e[e.POINT_SIZE_STEP_SIZE=.5]="POINT_SIZE_STEP_SIZE",e[e.LINE_WIDTH_STEP_SIZE=.5]="LINE_WIDTH_STEP_SIZE"}(Re||(Re={}));let Pe=Object(C.a)(xe=class extends b.Component{getThemeDefaultColor(e,t){return this.props.darkMode&&!t.fixed?e:t.colorHex}render(){const e=this.props;return b.createElement("div",{className:"line-settings-panel"},b.createElement(b.Fragment,null,e.userSelectedCoordinate&&e.handleCoordinateChanged&&b.createElement(n.p,{label:"Coordinate",inline:!0},b.createElement(n.r,{value:e.userSelectedCoordinate,options:e.profileCoordinateOptions,onChange:e.handleCoordinateChanged})),b.createElement(n.p,{inline:!0,label:"Primary Color"},b.createElement(T,{color:this.getThemeDefaultColor(e.primaryDarkModeLineColor,e.primaryLineColor),presetColors:[...oe.e,"transparent"],setColor:t=>{e.setPrimaryLineColor("transparent"===t.hex?"#000000":t.hex,!0)},disableAlpha:!0,darkTheme:e.darkMode})),e.secondaryDarkModeLineColor&&e.secondaryLineColor&&e.setSecondaryLineColor&&b.createElement(n.p,{inline:!0,label:"Secondary Color"},b.createElement(T,{color:this.getThemeDefaultColor(e.secondaryDarkModeLineColor,e.secondaryLineColor),presetColors:[...oe.e,"transparent"],setColor:t=>{e.setSecondaryLineColor("transparent"===t.hex?"#000000":t.hex,!0)},disableAlpha:!0,darkTheme:e.darkMode})),b.createElement(n.p,{inline:!0,label:"Line Width",labelInfo:"(px)"},b.createElement(et,{placeholder:"Line Width",min:Re.MIN_WIDTH,max:Re.MAX_WIDTH,value:e.lineWidth,stepSize:Re.LINE_WIDTH_STEP_SIZE,disabled:e.plotType===ue.POINTS,onValueChange:t=>e.setLineWidth(t)})),b.createElement(n.p,{inline:!0,label:"Point Size",labelInfo:"(px)"},b.createElement(et,{placeholder:"Point Size",min:Re.MIN_POINT_SIZE,max:Re.MAX_POINT_SIZE,value:e.linePlotPointSize,stepSize:Re.POINT_SIZE_STEP_SIZE,disabled:e.plotType!==ue.POINTS,onValueChange:t=>e.setLinePlotPointSize(t)})),"undefined"!==typeof e.logScaleY&&e.handleLogScaleChanged&&b.createElement(n.p,{inline:!0,label:"Log Scale"},b.createElement(n.P,{checked:e.logScaleY,onChange:e.handleLogScaleChanged})),"undefined"!==typeof e.markerTextVisible&&e.handleMarkerTextChanged&&b.createElement(n.p,{inline:!0,label:"Show Labels"},b.createElement(n.P,{checked:e.markerTextVisible,onChange:e.handleMarkerTextChanged})),"undefined"!==typeof e.useWcsValues&&e.handleWcsValuesChanged&&b.createElement(n.p,{inline:!0,label:"Use WCS Values"},b.createElement(n.P,{checked:e.useWcsValues,onChange:e.handleWcsValuesChanged})),"undefined"!==typeof e.showWCSAxis&&e.handleWcsAxisChanged&&b.createElement(n.p,{inline:!0,label:"Show WCS Axis"},b.createElement(n.P,{checked:e.showWCSAxis,onChange:e.handleWcsAxisChanged})),"undefined"!==typeof e.meanRmsVisible&&e.handleMeanRmsChanged&&b.createElement(n.p,{inline:!0,label:"Show Mean/RMS"},b.createElement(n.P,{checked:e.meanRmsVisible,onChange:e.handleMeanRmsChanged})),b.createElement(n.p,{inline:!0,label:"Line Style"},b.createElement(de,{value:e.plotType,onValueChanged:e.setPlotType})),"undefined"!==typeof e.xMinVal&&e.handleXMinChange&&b.createElement(n.p,{label:"X Min",inline:!0},b.createElement(et,{className:"line-boundary",value:e.xMinVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleXMinChange,onKeyDown:e.handleXMinChange})),"undefined"!==typeof e.xMaxVal&&e.handleXMaxChange&&b.createElement(n.p,{label:"X Max",inline:!0},b.createElement(et,{className:"line-boundary",value:e.xMaxVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleXMaxChange,onKeyDown:e.handleXMaxChange})),"undefined"!==typeof e.yMinVal&&e.handleYMinChange&&b.createElement(n.p,{label:"Y Min",inline:!0},b.createElement(et,{className:"line-boundary",asyncControl:!0,value:e.yMinVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleYMinChange,onKeyDown:e.handleYMinChange})),"undefined"!==typeof e.yMaxVal&&e.handleYMaxChange&&b.createElement(n.p,{label:"Y Max",inline:!0},b.createElement(et,{className:"line-boundary",asyncControl:!0,value:e.yMaxVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleYMaxChange,onKeyDown:e.handleYMaxChange})),"undefined"!==typeof e.isAutoScaledX&&"undefined"!==typeof e.isAutoScaledY&&e.clearXYBounds&&b.createElement(n.p,{inline:!0,className:"reset-range-content"},b.createElement(n.e,{className:"reset-range-button",icon:"zoom-to-fit",small:!0,disabled:e.isAutoScaledX&&e.isAutoScaledY,onClick:e.clearXYBounds},"Reset Range"))))}})||xe;var je;i(918);let ke;!function(e){e[e.MIN_POINT_SIZE=.5]="MIN_POINT_SIZE",e[e.MAX_POINT_SIZE=10]="MAX_POINT_SIZE",e[e.MIN_TRANSPARENCY=.1]="MIN_TRANSPARENCY",e[e.MAX_TRANSPARENCY=1]="MAX_TRANSPARENCY",e[e.POINT_SIZE_STEP_SIZE=.5]="POINT_SIZE_STEP_SIZE",e[e.TRANSPARENCY_STEP_SIZE=.1]="TRANSPARENCY_STEP_SIZE"}(ke||(ke={}));let Fe=Object(C.a)(je=class extends b.Component{render(){const e=this.props;return b.createElement("div",{className:"scatter-settings-panel"},b.createElement(b.Fragment,null,b.createElement(n.p,{inline:!0,label:"Color Map"},b.createElement(k,{inverted:!1,selectedItem:e.colorMap,onItemSelect:t=>{e.setColormap(t)}})),b.createElement(n.p,{inline:!0,label:"Symbol Size",labelInfo:"(px)"},b.createElement(et,{placeholder:"Symbol Size",min:ke.MIN_POINT_SIZE,max:ke.MAX_POINT_SIZE,value:e.scatterPlotPointSize,stepSize:ke.POINT_SIZE_STEP_SIZE,onValueChange:t=>e.setScatterPlotPointSize(t)})),b.createElement(n.p,{inline:!0,label:"Transparency"},b.createElement(et,{placeholder:"transparency",min:ke.MIN_TRANSPARENCY,max:ke.MAX_TRANSPARENCY,value:e.pointTransparency,stepSize:ke.TRANSPARENCY_STEP_SIZE,onValueChange:t=>e.setPointTransparency(t)})),b.createElement(n.p,{inline:!0,label:"Equal Axes"},b.createElement(n.P,{checked:e.equalAxes,onChange:e.handleEqualAxesValuesChanged}))))}})||je;var Me,De=i(435),Ne=i(163),Le=i(208),_e=i(1024),ze=i(69),We=i(20),Ge=i(5);i(919);let Ve;!function(e){e[e.Normal=0]="Normal",e[e.ColumnFilter=1]="ColumnFilter"}(Ve||(Ve={}));let Be=Object(C.a)(Me=class extends b.Component{constructor(...e){super(...e),this.SortingTypelinkedList={head:{value:null,next:{value:Ge.a.SortingType.Ascending,next:{value:Ge.a.SortingType.Descending,next:null}}}},this.renderManualSelectionColumn=(e,t)=>{if(!e||!t||t.length<=0)return null;return b.createElement(De.a,{key:"select",name:"select",columnHeaderCellRenderer:()=>b.createElement(Ne.a,null,b.createElement(b.Fragment,null,b.createElement(n.g,{indeterminate:e.isSelectingIndeterminate,checked:e.isSelectingAll,inline:!0,onChange:e.selectAllLines}))),cellRenderer:(i,r)=>b.createElement(Le.a,{key:`cell_${r}_${i}`,interactive:!1},b.createElement(b.Fragment,null,b.createElement(n.g,{checked:t[i]||!1,onChange:()=>e.selectSingleLine(i)})))})},this.getfilterSyntax=e=>{switch(e){case Ge.a.ColumnType.String||Ge.a.ColumnType.Bool:return b.createElement("div",{className:"column-popover-content"},b.createElement("small",null,"Filter by substring"),b.createElement("br",null),b.createElement("small",null,'e.g. gal (no quotation, entries contain the "gal" string)'));default:return b.createElement("div",{className:"column-popover-content"},b.createElement("small",null,"Operators: ",">",", ",">=",", ","<",", ","<=",", ","==",", ","!=",", ","..",", ","..."),b.createElement("br",null),b.createElement("small",null,"e.g. ","<"," 10 (everything less than 10) "),b.createElement("br",null),b.createElement("small",null,"e.g. == 1.23 (entries equal to 1.23) "),b.createElement("br",null),b.createElement("small",null,"e.g. 10..50 (everything between 10 and 50, exclusive)) "),b.createElement("br",null),b.createElement("small",null,"e.g. 10...50 (everything between 10 and 50, inclusive) "))}},this.renderDataColumnWithFilter=(e,t)=>b.createElement(De.a,{key:e.name,name:e.name,columnHeaderCellRenderer:t=>this.renderColumnHeaderCell(t,e),cellRenderer:(null===t||void 0===t?void 0:t.length)?(e,i)=>this.renderCell(e,i,t):void 0}),this.renderCell=(e,t,i)=>{const n=this.props.selectedDataIndex;return n&&n.includes(e)&&!this.props.showSelectedData?b.createElement(Le.a,{key:`cell_${t}_${e}`,intent:"danger",loading:this.isLoading(e),interactive:!1},i[e]):b.createElement(Le.a,{key:`cell_${t}_${e}`,loading:this.isLoading(e),interactive:!1},i[e])},this.getNextSortingType=()=>{const e=this.props.sortingInfo;let t=this.SortingTypelinkedList.head;for(;t.next;){if(t.value===e.sortingType)return t.next.value;t=t.next}return null},this.renderColumnHeaderCell=(e,t)=>{if(!isFinite(e)||!t)return null;const i=this.props.filter.get(t.name),r=this.getfilterSyntax(t.dataType),o=this.props.sortingInfo,a=o.columnName===t.name;let s=!1;""!==i.filter&&(s=!0);const l=this.props.tableHeaders[i.dataIndex].description,c=this.props.disable;let u=this.props.darkTheme?"column-popover-dark":"column-popover";return b.createElement(Ne.a,null,b.createElement(Ne.a,{className:"column-name",nameRenderer:()=>{let e="sort",i="sort-icon inactive",r=0;return a&&(r=this.getNextSortingType(),o.sortingType===Ge.a.SortingType.Descending?(e="sort-desc",i="sort-icon"):o.sortingType===Ge.a.SortingType.Ascending&&(e="sort-asc",i="sort-icon")),b.createElement("div",{className:"sort-label",onClick:()=>c?null:this.props.updateSortRequest(t.name,r)},b.createElement(n.y,{disabled:c,className:"bp3-inline label"},b.createElement(n.w,{className:i,icon:e}),b.createElement(n.F,{hoverOpenDelay:250,hoverCloseDelay:0,className:"column-popover",popoverClassName:u,content:l||"Description not avaliable",interactionKind:n.G.HOVER},t.name)))}}),b.createElement(Ne.a,{isActive:s},b.createElement(n.F,{hoverOpenDelay:250,hoverCloseDelay:0,className:"column-popover",popoverClassName:u,content:r,interactionKind:n.G.HOVER},b.createElement(n.x,{key:"column-popover-"+e,small:!0,placeholder:"Click to filter",value:i&&i.filter?i.filter:"",onChange:e=>this.props.updateColumnFilter(e.currentTarget.value,t.name)}))))},this.infiniteScroll=e=>{const t=e.rowIndexEnd+1;e.rowIndexEnd>0&&t>=this.props.numVisibleRows&&!this.props.loadingCell&&!this.props.showSelectedData&&this.props.updateByInfiniteScroll(e.rowIndexEnd)},this.updateTableColumnWidth=(e,t)=>{const i=this.props.columnHeaders[e];i&&this.props.updateTableColumnWidth&&this.props.updateTableColumnWidth(t,i.name)},this.onRowIndexSelection=e=>{if(e.length>0){let t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.rows[0],o=n.rows[1];if(r===o)t.push(r);else for(let e=r;e<=o;e++)t.push(e)}this.props.updateSelectedRow(t)}}}isLoading(e){return!!(this.props.loadingCell&&e+4>this.props.numVisibleRows)}renderDataColumn(e,t){return b.createElement(De.a,{key:e,name:e,cellRenderer:(e,i)=>b.createElement(Le.a,{key:`cell_${i}_${e}`,interactive:!0},e<(null===t||void 0===t?void 0:t.length)?t[e]:void 0)})}render(){var e,t;const i=this.props,n=[],r=i.dataset;let o=i.columnWidths?i.columnWidths:new Array(null===(e=i.columnHeaders)||void 0===e?void 0:e.length).fill(150);if(i.manualSelectionProps&&(null===(t=i.manualSelectionData)||void 0===t?void 0:t.length)>0){const e=this.renderManualSelectionColumn(i.manualSelectionProps,i.manualSelectionData);n.push(e),o.splice(0,0,50)}for(let s=0;s<i.columnHeaders.length;s++){var a;const e=i.columnHeaders[s],t=e.columnIndex;let o=null===(a=r.get(t))||void 0===a?void 0:a.data;if(i.type===Ve.ColumnFilter){const t=this.renderDataColumnWithFilter(e,o);n.push(t)}else if(i.type===Ve.Normal){const t=this.renderDataColumn(e.name,o);n.push(t)}}return i.type===Ve.ColumnFilter?b.createElement(_e.a,{className:"column-filter-table",ref:i.updateTableRef?e=>i.updateTableRef(e):null,numRows:i.numVisibleRows,renderMode:ze.a.BATCH,enableRowReordering:!1,selectionModes:We.d.ROWS_AND_CELLS,onVisibleCellsChange:this.infiniteScroll,onColumnWidthChanged:this.updateTableColumnWidth,enableGhostCells:!0,onSelection:this.onRowIndexSelection,enableMultipleSelection:!0,enableRowResizing:!1,columnWidths:o},n):b.createElement(_e.a,{ref:i.updateTableRef?e=>i.updateTableRef(e):null,numRows:i.numVisibleRows,renderMode:ze.a.NONE,enableRowReordering:!1,selectionModes:We.d.NONE,enableGhostCells:!0,enableRowResizing:!1,columnWidths:o},n)}})||Me;var qe,He,Ue,Ye,Xe,Ke,Qe=i(183);let Ze=Object(C.a)((Ke=Xe=class e extends b.Component{constructor(e){super(e),this.defaulteValue=void 0,Object(f.a)(this,"value",Ue,this),Object(f.a)(this,"isFocused",Ye,this),this.handleChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;isFinite(parseFloat(this.value))||this.setValue(this.defaulteValue);const t=parseFloat(this.validation(this.value));this.props.onValueChanged(t)},this.handleOnFocus=()=>{this.props.displayExponential&&this.setFocused(!0)},this.handleOnBlur=e=>{this.handleChange(e),this.props.displayExponential&&this.setFocused(!1)},this.handleOnValueChange=(e,t)=>{this.setValue(this.validation(t))},this.handelOnValueCleared=()=>{this.setValue(this.defaulteValue),this.props.onValueCleared()},this.validation=e=>{const t=parseFloat(e);let i=e;if(this.props.integerOnly){const e=Math.round(t);isFinite(e)&&(i=e.toString())}return this.props.min&&t<this.props.min&&(i=this.props.min.toString()),this.props.max&&t>this.props.max&&(i=this.props.max.toString()),i},Object(S.p)(this),this.value=this.props.value.toString(),this.defaulteValue=this.props.value.toString()}setValue(e){this.value=e}setFocused(e){this.isFocused=e}render(){let t=this.props.displayExponential&&!this.isFocused?Object(oe.jb)(Number(this.props.value),3):this.props.value;return b.createElement(n.p,{className:this.props.className,label:this.props.label,inline:!0,disabled:this.props.disabled},b.createElement(n.D,{asyncControl:!0,stepSize:this.props.stepSize,value:t,minorStepSize:this.props.minorStepSize?this.props.minorStepSize:e.minorStepSize,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.handleChange,onValueChange:this.handleOnValueChange,buttonPosition:"none",disabled:this.props.disabled,rightElement:b.createElement(n.W,{content:"Reset value to default"},b.createElement(n.b,{icon:"refresh",minimal:!0,onClick:this.handelOnValueCleared,disabled:this.props.disabled}))}))}},Xe.minorStepSize=.001,He=Ke,Ue=Object(y.a)(He.prototype,"value",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye=Object(y.a)(He.prototype,"isFocused",[S.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(y.a)(He.prototype,"setValue",[S.g],Object.getOwnPropertyDescriptor(He.prototype,"setValue"),He.prototype),Object(y.a)(He.prototype,"setFocused",[S.g],Object.getOwnPropertyDescriptor(He.prototype,"setFocused"),He.prototype),qe=He))||qe;var $e;let Je=Object(C.a)($e=class extends b.Component{render(){const e=this.props.widgetStore.effectiveFrame,t=e?e.nativeSpectralCoordinate:void 0,i=this.props.widgetStore,r=e&&e.spectralCoordsSupported?Array.from(e.spectralCoordsSupported.keys()).map(e=>({value:e,label:e===t?e+" (Native WCS)":e})):[],o=e&&e.spectralSystemsSupported?e.spectralSystemsSupported.map(e=>({value:e,label:e})):[],a=e&&(e.isSpectralCoordinateConvertible||e.spectralAxis&&!e.spectralAxis.valid),s=this.props.disable||!a,l=this.props.disable||!e||!e.isSpectralSystemConvertible;return b.createElement(b.Fragment,null,b.createElement(n.p,{label:"Coordinate",inline:!0,disabled:s},b.createElement(n.r,{disabled:s,value:e&&e.spectralCoordinate?e.spectralCoordinate:"",options:r,onChange:e=>i.setSpectralCoordinate(e.currentTarget.value)})),b.createElement(n.p,{label:"System",inline:!0,disabled:l},b.createElement(n.r,{disabled:l,value:e&&e.spectralSystem?e.spectralSystem:"",options:o,onChange:e=>i.setSpectralSystem(e.currentTarget.value)})))}})||$e;class et extends b.Component{constructor(...e){super(...e),this.safeHandleValueChanged=(e,t,i)=>{if(this.props.intOnly){const n=Math.ceil(e);isFinite(n)&&(e=n,t=n.toString(),i.value=n.toString())}this.props.onValueChange&&isFinite(e)&&(!this.props.min||this.props.min<=e)&&(!this.props.max||this.props.max>=e)&&this.props.onValueChange(e,t,i)}}render(){const{intOnly:e,...t}=this.props;return b.createElement(n.D,Object.assign({},t,{asyncControl:!0,minorStepSize:this.props.minorStepSize?this.props.minorStepSize:e?1:et.minorStepSize,onValueChange:this.safeHandleValueChanged}))}}et.minorStepSize=.001;var tt,it=i(4);i(920);let nt;!function(e){e.NONE="None",e.HANNING="Hanning",e.BOXCAR="Boxcar",e.GAUSSIAN="Gaussian",e.DECIMATION="Decimation",e.BINNING="Binning",e.SAVITZKY_GOLAY="Savitzky-Golay"}(nt||(nt={}));let rt=Object(C.a)(tt=class extends b.Component{constructor(...e){super(...e),this.handleSelectedLineChanged=e=>{this.props.smoothingStore.setSelectedLine(e.target.value)}}render(){const e=this.props.smoothingStore,t=[{value:nt.NONE,label:"None"},{value:nt.BOXCAR,label:"Boxcar"},{value:nt.GAUSSIAN,label:"Gaussian"},{value:nt.HANNING,label:"Hanning"},{value:nt.BINNING,label:"Binning"},{value:nt.SAVITZKY_GOLAY,label:"Savitzky-Golay"}];this.props.diableDecimation||t.push({value:nt.DECIMATION,label:"Decimation"});let i=[];return e.colorMap.size>0&&e.colorMap.forEach((e,t)=>{i=i.concat({value:t,label:t})}),b.createElement("div",{className:"smoothing-settings-panel"},b.createElement(n.p,{label:"Method",inline:!0},b.createElement(n.r,{value:e&&e.type?e.type:nt.NONE,options:t,onChange:t=>e.setType(t.currentTarget.value)})),e.type!==nt.NONE&&!this.props.diableStyle&&b.createElement(b.Fragment,null,b.createElement(n.p,{inline:!0,label:"Color"},e.colorMap.size>0&&b.createElement(n.r,{value:e.selectedLine,options:i,onChange:this.handleSelectedLineChanged}),b.createElement(T,{color:e.selectedLine&&e.colorMap.get(e.selectedLine)?e.colorMap.get(e.selectedLine).colorHex:e.lineColor.colorHex,presetColors:oe.e,setColor:t=>{e.selectedLine&&e.colorMap.get(e.selectedLine)?e.setColorMap(e.selectedLine,{colorHex:t.hex,fixed:!0}):e.setLineColor(t.hex,!0)},disableAlpha:!0,darkTheme:it.e.Instance.darkTheme})),b.createElement(n.p,{inline:!0,label:"Line Style"},b.createElement(de,{value:e.lineType,onValueChanged:e.setLineType})),b.createElement(n.p,{inline:!0,label:"Line Width",labelInfo:"(px)"},b.createElement(et,{placeholder:"Line Width",min:Re.MIN_WIDTH,max:Re.MAX_WIDTH,value:e.lineWidth,stepSize:1,disabled:e.lineType===ue.POINTS,onValueChange:t=>e.setLineWidth(t)})),b.createElement(n.p,{inline:!0,label:"Point Size",labelInfo:"(px)"},b.createElement(et,{placeholder:"Point Size",min:Re.MIN_POINT_SIZE,max:Re.MAX_POINT_SIZE,value:e.pointRadius,stepSize:Re.POINT_SIZE_STEP_SIZE,disabled:e.lineType!==ue.POINTS,onValueChange:t=>e.setPointRadius(t)}))),e.type!==nt.NONE&&b.createElement(n.p,{label:"Overlay",inline:!0},b.createElement(n.P,{checked:e.isOverlayOn,onChange:t=>e.setIsOverlayOn(t.currentTarget.checked)})),e.type===nt.BOXCAR&&b.createElement(n.p,{label:"Kernel",inline:!0},b.createElement(et,{value:e.boxcarSize,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setBoxcarSize(Math.round(t))})),e.type===nt.GAUSSIAN&&b.createElement(n.p,{label:"Sigma",inline:!0},b.createElement(et,{value:e.gaussianSigma,min:1,className:"narrow",onValueChange:t=>e.setGaussianSigma(t)})),e.type===nt.HANNING&&b.createElement(n.p,{label:"Kernel",inline:!0},b.createElement(et,{value:e.hanningSize,min:3,stepSize:2,className:"narrow",onValueChange:t=>e.setHanningSize(Math.round(t))})),e.type===nt.DECIMATION&&b.createElement(n.p,{label:"Decimation Width",inline:!0},b.createElement(et,{value:e.decimationWidth,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setDecimationWidth(Math.round(t))})),e.type===nt.BINNING&&b.createElement(n.p,{label:"Binning Width",inline:!0},b.createElement(et,{value:e.binWidth,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setBinWidth(Math.round(t))})),e.type===nt.SAVITZKY_GOLAY&&b.createElement(b.Fragment,null,b.createElement(n.p,{label:"Kernel",inline:!0},b.createElement(et,{value:e.savitzkyGolaySize,min:5,stepSize:2,className:"narrow",onValueChange:t=>e.setSavitzkyGolaySize(Math.round(t))})),b.createElement(n.p,{label:"Degree of Fitting",inline:!0},b.createElement(et,{value:e.savitzkyGolayOrder,min:0,max:4,stepSize:2,className:"narrow",onValueChange:t=>e.setSavitzkyGolayOrder(Math.round(t))}))))}})||tt},712:function(e,t){},77:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n=i(0),r=i(22),o=i(47),a=i(491);i(929);const s=a.a.ofType(),l={minimal:!0,position:"auto-end",popoverClassName:"colorselect"},c=e=>{const t=e.selectedItem>=0&&e.selectedItem<r.colors.length?e.selectedItem:4,i=e=>n.createElement("div",{className:"dropdown-color",style:{background:e}},"\xa0");return n.createElement(s,{activeItem:r.colors[t],onItemSelect:t=>e.onItemSelect(r.colors.indexOf(t)),popoverProps:l,filterable:!1,items:r.colors,itemRenderer:(e,{handleClick:t,modifiers:r,query:a})=>n.createElement(o.B,{active:r.active,disabled:r.disabled,key:e,onClick:t,text:i(e)})},n.createElement(o.e,{className:"colorselect",text:i(r.colors[t]),rightIcon:"double-caret-vertical"}))}},79:function(e,t,i){e.exports=i.p+"static/media/allmaps.94bda471.png"},858:function(e,t,i){},910:function(e,t,i){},911:function(e,t,i){},914:function(e,t,i){},915:function(e,t,i){},916:function(e,t,i){},917:function(e,t,i){},918:function(e,t,i){},919:function(e,t,i){},920:function(e,t,i){},921:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Preferences","description":"Schema for CARTA Preferences (Version 1)","$id":"carta_preferences_1","required":["version"],"properties":{"version":{"type":"integer","minimum":1},"username":{"type":"string","minLength":1},"theme":{"type":"string","enum":["auto","light","dark"]},"autoLaunch":{"type":"boolean"},"fileSortingString":{"type":"string","pattern":"^([+\\\\-])(date|filename|type|size)$"},"fileFilteringType":{"type":"string","enum":["fuzzy","unix","regex"]},"layout":{"type":"string"},"cursorPosition":{"type":"string","enum":["fixed","tracking"]},"zoomMode":{"type":"string","enum":["fit","full"]},"zoomPoint":{"type":"string","enum":["cursor","center"]},"dragPanning":{"type":"boolean"},"spectralMatchingType":{"type":"string","enum":["VRAD","VOPT","FREQ","WAVE","AWAV","CHANNEL"]},"wcsMatchingType":{"type":"integer","minimum":0,"maximum":3},"scaling":{"type":"integer","minimum":0,"maximum":7},"colormap":{"type":"string"},"percentile":{"type":"number","exclusiveMaximum":100,"exclusiveMinimum":0},"scalingAlpha":{"type":"number","minimum":1},"scalingGamma":{"type":"number","exclusiveMinimum":0},"nanColorHex":{"type":"string","description":"TODO: validate color string"},"nanAlpha":{"type":"number","minimum":0,"maximum":1},"contourGeneratorType":{"type":"string","enum":["start-step-multiplier","min-max-scaling","percentages-ref.value","mean-sigma-list"]},"contourSmoothingMode":{"type":"integer","minimum":0,"maximum":2},"contourSmoothingFactor":{"type":"integer","minimum":0},"contourNumLevels":{"type":"integer","minimum":1},"contourThickness":{"type":"number","minimum":0},"contourColormapEnabled":{"type":"boolean"},"contourColor":{"type":"string","description":"TODO: validate color string"},"contourColormap":{"type":"string"},"astColor":{"type":"integer","minimum":0},"astGridVisible":{"type":"boolean"},"astLabelsVisible":{"type":"boolean"},"wcsType":{"type":"string","enum":["automatic","degrees","sexagesimal"]},"beamVisible":{"type":"boolean"},"beamColor":{"type":"string"},"beamType":{"type":"string","enum":["open","solid"]},"beamWidth":{"type":"number","minimum":0},"regionColor":{"type":"string","description":"TODO: validate color string"},"regionLineWidth":{"type":"number","minimum":0},"regionDashLength":{"type":"integer","minimum":0},"regionType":{"type":"integer","minimum":0,"maximum":6},"regionCreationMode":{"type":"string","enum":["center","corner"]},"regionSize":{"type":"number","minimum":1},"imageCompressionQuality":{"type":"integer","minimum":4,"maximum":32},"animationCompressionQuality":{"type":"integer","minimum":4,"maximum":32},"GPUTileCache":{"type":"integer","multipleOf":128,"minimum":512},"systemTileCache":{"type":"integer","multipleOf":128,"minimum":1024},"contourDecimation":{"type":"integer","minimum":1,"maximum":32},"contourCompressionLevel":{"type":"integer","minimum":0,"maximum":19},"contourChunkSize":{"type":"integer","multipleOf":25000,"minimum":25000,"maximum":1000000},"contourControlMapWidth":{"type":"integer","multipleOf":128,"minimum":128,"maximum":1024},"streamContoursWhileZooming":{"type":"boolean"},"lowBandwidthMode":{"type":"boolean"},"stopAnimationPlayback":{"type":"integer","minimum":5,"maximum":30}}}')},924:function(e,t,i){},928:function(e,t,i){},929:function(e,t,i){},930:function(e,t,i){},931:function(e,t,i){},932:function(e,t,i){},933:function(e,t,i){},934:function(e,t,i){},935:function(e,t,i){},936:function(e,t,i){},937:function(e,t,i){},940:function(e,t,i){},941:function(e,t,i){},962:function(e,t,i){},963:function(e,t,i){},964:function(e,t,i){},965:function(e,t,i){},966:function(e,t,i){},967:function(e,t,i){},968:function(e,t,i){},969:function(e,t,i){},970:function(e,t,i){},971:function(e,t,i){},972:function(e,t,i){},973:function(e,t,i){},974:function(e,t,i){},975:function(e,t,i){},976:function(e,t,i){},977:function(e,t,i){},978:function(e,t,i){},979:function(e,t,i){},980:function(e,t,i){},981:function(e,t,i){},982:function(e,t,i){},983:function(e,t,i){},984:function(e,t,i){},985:function(e,t,i){},986:function(e,t,i){},987:function(e,t,i){},988:function(e,t,i){},989:function(e,t,i){},990:function(e,t,i){},992:function(e,t,i){},993:function(e,t,i){},994:function(e,t,i){},995:function(e,t,i){},996:function(e,t,i){},997:function(e,t,i){},998:function(e,t,i){},999:function(e,t,i){}},[[564,1,2]]]);