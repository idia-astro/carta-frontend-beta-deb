(this["webpackJsonpcarta-frontend"]=this["webpackJsonpcarta-frontend"]||[]).push([[0],{10:function(e,t,i){(function(t,n,r){var o="undefined"!==typeof o?o:{};o.locateFile=function(e,t){return"./"+e};var s,a={};for(s in o)o.hasOwnProperty(s)&&(a[s]=o[s]);var l=[],c="./this.program",d=!1,p=!1,h=!1,u=!1;d="object"===typeof window,p="function"===typeof importScripts,h="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,u=!d&&!h&&!p;var g,f,b,m,y,O="";function j(e){return o.locateFile?o.locateFile(e,O):O+e}h?(O=p?i(113).dirname(O)+"/":n+"/",g=function(e,t){return m||(m=i(221)),y||(y=i(113)),e=y.normalize(e),m.readFileSync(e,t?null:"utf8")},b=function(e){var t=g(e,!0);return t.buffer||(t=new Uint8Array(t)),A(t.buffer),t},t.argv.length>1&&(c=t.argv[1].replace(/\\/g,"/")),l=t.argv.slice(2),e.exports=o,t.on("uncaughtException",(function(e){if(!(e instanceof It))throw e})),t.on("unhandledRejection",pe),function(e){t.exit(e)},o.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(g=function(e){return read(e)}),b=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(A("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?l=scriptArgs:"undefined"!=typeof arguments&&(l=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(d||p)&&(p?O=self.location.href:"undefined"!==typeof document&&document.currentScript&&(O=document.currentScript.src),O=0!==O.indexOf("blob:")?O.substr(0,O.lastIndexOf("/")+1):"",g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},p&&(b=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var x=o.print||console.log.bind(console),S=o.printErr||console.warn.bind(console);for(s in a)a.hasOwnProperty(s)&&(o[s]=a[s]);a=null,o.arguments&&(l=o.arguments),o.thisProgram&&(c=o.thisProgram),o.quit&&o.quit;var v=16;function C(e,t){return t||(t=v),Math.ceil(e/t)*t}var I,w=function(e){e};o.wasmBinary&&(I=o.wasmBinary);var T;o.noExitRuntime;"object"!==typeof WebAssembly&&pe("no native wasm support detected");var R=!1;function A(e,t){e||pe("Assertion failed: "+t)}function P(e){var t=o["_"+e];return A(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function E(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);N(e,t=Ct(i),i)}return t},array:function(e){var t=Ct(e.length);return H(e,t),t}};var s=P(e),a=[],l=0;if(n)for(var c=0;c<n.length;c++){var d=o[i[c]];d?(0===l&&(l=St()),a[c]=d(n[c])):a[c]=n[c]}var p=s.apply(null,a);return p=function(e){return"string"===t?D(e):"boolean"===t?Boolean(e):e}(p),0!==l&&vt(l),p}function M(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?P(e):function(){return E(e,t,i,arguments)}}var F="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&F)return F.decode(e.subarray(t,r));for(var o="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function D(e,t){return e?k(W,e,t):""}function L(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-r}function N(e,t,i){return L(e,W,t,i)}function _(e){for(var t=0,i=0;i<e.length;++i){var n=e.charCodeAt(i);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}var z,V,W,G,B,q;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function H(e,t){V.set(e,t)}function Y(e,t,i){for(var n=0;n<e.length;++n)V[t++>>0]=e.charCodeAt(n);i||(V[t>>0]=0)}function U(e,t){return e%t>0&&(e+=t-e%t),e}function X(e){z=e,o.HEAP8=V=new Int8Array(e),o.HEAP16=G=new Int16Array(e),o.HEAP32=B=new Int32Array(e),o.HEAPU8=W=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=q=new Float64Array(e)}o.INITIAL_MEMORY;var $,K=[],Q=[],Z=[],J=[];function ee(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)re(o.preRun.shift());Ce(K)}function te(){!0,o.noFSInit||Fe.init.initialized||Fe.init(),Pe.init(),Ce(Q)}function ie(){Fe.ignorePermissions=!1,Ce(Z)}function ne(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)oe(o.postRun.shift());Ce(J)}function re(e){K.unshift(e)}function oe(e){J.unshift(e)}Q.push({func:function(){Ot()}});var se=0,ae=null,le=null;function ce(e){se++,o.monitorRunDependencies&&o.monitorRunDependencies(se)}function de(e){if(se--,o.monitorRunDependencies&&o.monitorRunDependencies(se),0==se&&(null!==ae&&(clearInterval(ae),ae=null),le)){var t=le;le=null,t()}}function pe(e){throw o.onAbort&&o.onAbort(e),S(e+=""),R=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function he(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}o.preloadedImages={},o.preloadedAudios={};var ue="data:application/octet-stream;base64,";function ge(e){return he(e,ue)}var fe="file://";function be(e){return he(e,fe)}var me,ye,Oe="ast_wrapper.wasm";function je(e){try{if(e==Oe&&I)return new Uint8Array(I);if(b)return b(e);throw"both async and sync fetching of the wasm failed"}catch(S){pe(S)}}function xe(){if(!I&&(d||p)){if("function"===typeof fetch&&!be(Oe))return fetch(Oe,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Oe+"'";return e.arrayBuffer()})).catch((function(){return je(Oe)}));if(f)return new Promise((function(e,t){f(Oe,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return je(Oe)}))}function Se(){var e={env:yt,wasi_snapshot_preview1:yt};function t(e,t){var i=e.exports;o.asm=i,X((T=o.asm.memory).buffer),$=o.asm.__indirect_function_table,de()}function i(e){t(e.instance)}function n(t){return xe().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){S("failed to asynchronously prepare wasm: "+e),pe(e)}))}if(ce(),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(r){return S("Module.instantiateWasm callback failed with error: "+r),!1}return I||"function"!==typeof WebAssembly.instantiateStreaming||ge(Oe)||be(Oe)||"function"!==typeof fetch?n(i):fetch(Oe,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return S("wasm streaming compile failed: "+e),S("falling back to ArrayBuffer instantiation"),n(i)}))})),{}}ge(Oe)||(Oe=j(Oe));var ve={2004:function(e){o.gridContext.strokeStyle=o.colors[e],o.gridContext.fillStyle=o.colors[e]},2112:function(e,t){var i=o.fonts[e];i=i.replace("{size}",t*devicePixelRatio+"px"),o.gridContext.font=i},2241:function(e,t){o.gridContext.beginPath(),o.gridContext.moveTo(e,t)},2315:function(e,t){o.gridContext.lineTo(Math.floor(e)+.5,Math.floor(t)+.5)},2384:function(e,t){o.gridContext.lineTo(e,t)},2421:function(){o.gridContext.stroke()},2451:function(){return 2*o.gridContext.measureText("e").width},2505:function(e){o.gridContext.textAlign="center",o.gridContext.textBaseline="middle";var t=Math.max(Math.min(e,o.shapes.length-1),0);o.gridContext.symbolText=o.shapes[t]},2712:function(e,t){o.gridContext.save(),o.gridContext.translate(e,t),o.gridContext.scale(1,-1),o.gridContext.fillText(o.gridContext.symbolText,0,0),o.gridContext.restore()},2910:function(){o.gridContext.textAlign="center"},2951:function(){o.gridContext.textAlign="left"},2990:function(){o.gridContext.textAlign="right"},3062:function(){o.gridContext.textBaseline="top"},3103:function(){o.gridContext.textBaseline="middle"},3147:function(){o.gridContext.textBaseline="bottom"},3191:function(e,t,i,n){o.gridContext.save(),o.gridContext.translate(t,i),o.gridContext.rotate(n),o.gridContext.scale(1,-1),o.gridContext.fillText(D(e),0,0),o.gridContext.restore()},3412:function(e){return o.gridContext.measureText(D(e)).width},3479:function(e){o.gridContext.lineWidth=e},3518:function(){return o.colors.length},3549:function(){return o.fonts.length},3579:function(e){o.gridContext.lineWidth=e*devicePixelRatio,o.gridContext.font=o.fonts[0],o.gridContext.clearRect(0,0,o.gridContext.canvas.width,o.gridContext.canvas.height)}};function Ce(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?$.get(i)():$.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(o)}}function Ie(e,t){}function we(e){return B[jt()>>2]=e,e}var Te={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var i=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i;i--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),i="/"===e.substr(-1);return(e=Te.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=Te.splitPath(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},basename:function(e){if("/"===e)return"/";var t=(e=(e=Te.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return Te.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return Te.normalize(e.join("/"))},join2:function(e,t){return Te.normalize(e+"/"+t)}};function Re(){if("object"===typeof crypto&&"function"===typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}if(h)try{var t=i(677);return function(){return t.randomBytes(1)[0]}}catch(n){}return function(){pe("randomDevice")}}var Ae={resolve:function(){for(var e="",t=!1,i=arguments.length-1;i>=-1&&!t;i--){var n=i>=0?arguments[i]:Fe.cwd();if("string"!==typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return(t?"/":"")+(e=Te.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."},relative:function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=Ae.resolve(e).substr(1),t=Ae.resolve(t).substr(1);for(var n=i(e.split("/")),r=i(t.split("/")),o=Math.min(n.length,r.length),s=o,a=0;a<o;a++)if(n[a]!==r[a]){s=a;break}var l=[];for(a=s;a<n.length;a++)l.push("..");return(l=l.concat(r.slice(s))).join("/")}},Pe={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Pe.ttys[e]={input:[],output:[],ops:t},Fe.registerDevice(e,Pe.stream_ops)},stream_ops:{open:function(e){var t=Pe.ttys[e.node.rdev];if(!t)throw new Fe.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,i,n,r){if(!e.tty||!e.tty.ops.get_char)throw new Fe.ErrnoError(60);for(var o=0,s=0;s<n;s++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(l){throw new Fe.ErrnoError(29)}if(void 0===a&&0===o)throw new Fe.ErrnoError(6);if(null===a||void 0===a)break;o++,t[i+s]=a}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,i,n,r){if(!e.tty||!e.tty.ops.put_char)throw new Fe.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,t[i+o])}catch(s){throw new Fe.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var i=null;if(h){var n=r.alloc?r.alloc(256):new r(256),o=0;try{o=m.readSync(t.stdin.fd,n,0,256,null)}catch(s){if(-1==s.toString().indexOf("EOF"))throw s;o=0}i=o>0?n.slice(0,o).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(i=window.prompt("Input: "))&&(i+="\n"):"function"==typeof readline&&null!==(i=readline())&&(i+="\n");if(!i)return null;e.input=bt(i,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(x(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(x(k(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(S(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(S(k(e.output,0)),e.output=[])}}};function Ee(e){for(var t=C(e,16384),i=xt(t);e<t;)V[i+e++]=0;return i}var Me={ops_table:null,mount:function(e){return Me.createNode(null,"/",16895,0)},createNode:function(e,t,i,n){if(Fe.isBlkdev(i)||Fe.isFIFO(i))throw new Fe.ErrnoError(63);Me.ops_table||(Me.ops_table={dir:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr,lookup:Me.node_ops.lookup,mknod:Me.node_ops.mknod,rename:Me.node_ops.rename,unlink:Me.node_ops.unlink,rmdir:Me.node_ops.rmdir,readdir:Me.node_ops.readdir,symlink:Me.node_ops.symlink},stream:{llseek:Me.stream_ops.llseek}},file:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr},stream:{llseek:Me.stream_ops.llseek,read:Me.stream_ops.read,write:Me.stream_ops.write,allocate:Me.stream_ops.allocate,mmap:Me.stream_ops.mmap,msync:Me.stream_ops.msync}},link:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr,readlink:Me.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Me.node_ops.getattr,setattr:Me.node_ops.setattr},stream:Fe.chrdev_stream_ops}});var r=Fe.createNode(e,t,i,n);return Fe.isDir(r.mode)?(r.node_ops=Me.ops_table.dir.node,r.stream_ops=Me.ops_table.dir.stream,r.contents={}):Fe.isFile(r.mode)?(r.node_ops=Me.ops_table.file.node,r.stream_ops=Me.ops_table.file.stream,r.usedBytes=0,r.contents=null):Fe.isLink(r.mode)?(r.node_ops=Me.ops_table.link.node,r.stream_ops=Me.ops_table.link.stream):Fe.isChrdev(r.mode)&&(r.node_ops=Me.ops_table.chrdev.node,r.stream_ops=Me.ops_table.chrdev.stream),r.timestamp=Date.now(),e&&(e.contents[t]=r,e.timestamp=r.timestamp),r},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var i=e.contents?e.contents.length:0;if(!(i>=t)){t=Math.max(t,i*(i<1048576?2:1.125)>>>0),0!=i&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var i=e.contents;e.contents=new Uint8Array(t),i&&e.contents.set(i.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=Fe.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Fe.isDir(e.mode)?t.size=4096:Fe.isFile(e.mode)?t.size=e.usedBytes:Fe.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Me.resizeFileStorage(e,t.size)},lookup:function(e,t){throw Fe.genericErrors[44]},mknod:function(e,t,i,n){return Me.createNode(e,t,i,n)},rename:function(e,t,i){if(Fe.isDir(e.mode)){var n;try{n=Fe.lookupNode(t,i)}catch(o){}if(n)for(var r in n.contents)throw new Fe.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=i,t.contents[i]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var i=Fe.lookupNode(e,t);for(var n in i.contents)throw new Fe.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var i in e.contents)e.contents.hasOwnProperty(i)&&t.push(i);return t},symlink:function(e,t,i){var n=Me.createNode(e,t,41471,0);return n.link=i,n},readlink:function(e){if(!Fe.isLink(e.mode))throw new Fe.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,i,n,r){var o=e.node.contents;if(r>=e.node.usedBytes)return 0;var s=Math.min(e.node.usedBytes-r,n);if(s>8&&o.subarray)t.set(o.subarray(r,r+s),i);else for(var a=0;a<s;a++)t[i+a]=o[r+a];return s},write:function(e,t,i,n,r,o){if(t.buffer===V.buffer&&(o=!1),!n)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(o)return s.contents=t.subarray(i,i+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===r)return s.contents=t.slice(i,i+n),s.usedBytes=n,n;if(r+n<=s.usedBytes)return s.contents.set(t.subarray(i,i+n),r),n}if(Me.expandFileStorage(s,r+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(i,i+n),r);else for(var a=0;a<n;a++)s.contents[r+a]=t[i+a];return s.usedBytes=Math.max(s.usedBytes,r+n),n},llseek:function(e,t,i){var n=t;if(1===i?n+=e.position:2===i&&Fe.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new Fe.ErrnoError(28);return n},allocate:function(e,t,i){Me.expandFileStorage(e.node,t+i),e.node.usedBytes=Math.max(e.node.usedBytes,t+i)},mmap:function(e,t,i,n,r,o){if(0!==t)throw new Fe.ErrnoError(28);if(!Fe.isFile(e.node.mode))throw new Fe.ErrnoError(43);var s,a,l=e.node.contents;if(2&o||l.buffer!==z){if((n>0||n+i<l.length)&&(l=l.subarray?l.subarray(n,n+i):Array.prototype.slice.call(l,n,n+i)),a=!0,!(s=Ee(i)))throw new Fe.ErrnoError(48);V.set(l,s)}else a=!1,s=l.byteOffset;return{ptr:s,allocated:a}},msync:function(e,t,i,n,r){if(!Fe.isFile(e.node.mode))throw new Fe.ErrnoError(43);if(2&r)return 0;Me.stream_ops.write(e,t,0,n,i,!1);return 0}}},Fe={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(e,t){if(t=t||{},!(e=Ae.resolve(Fe.cwd(),e)))return{path:"",node:null};var i={follow_mount:!0,recurse_count:0};for(var n in i)void 0===t[n]&&(t[n]=i[n]);if(t.recurse_count>8)throw new Fe.ErrnoError(32);for(var r=Te.normalizeArray(e.split("/").filter((function(e){return!!e})),!1),o=Fe.root,s="/",a=0;a<r.length;a++){var l=a===r.length-1;if(l&&t.parent)break;if(o=Fe.lookupNode(o,r[a]),s=Te.join2(s,r[a]),Fe.isMountpoint(o)&&(!l||l&&t.follow_mount)&&(o=o.mounted.root),!l||t.follow)for(var c=0;Fe.isLink(o.mode);){var d=Fe.readlink(s);if(s=Ae.resolve(Te.dirname(s),d),o=Fe.lookupPath(s,{recurse_count:t.recurse_count}).node,c++>40)throw new Fe.ErrnoError(32)}}return{path:s,node:o}},getPath:function(e){for(var t;;){if(Fe.isRoot(e)){var i=e.mount.mountpoint;return t?"/"!==i[i.length-1]?i+"/"+t:i+t:i}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var i=0,n=0;n<t.length;n++)i=(i<<5)-i+t.charCodeAt(n)|0;return(e+i>>>0)%Fe.nameTable.length},hashAddNode:function(e){var t=Fe.hashName(e.parent.id,e.name);e.name_next=Fe.nameTable[t],Fe.nameTable[t]=e},hashRemoveNode:function(e){var t=Fe.hashName(e.parent.id,e.name);if(Fe.nameTable[t]===e)Fe.nameTable[t]=e.name_next;else for(var i=Fe.nameTable[t];i;){if(i.name_next===e){i.name_next=e.name_next;break}i=i.name_next}},lookupNode:function(e,t){var i=Fe.mayLookup(e);if(i)throw new Fe.ErrnoError(i,e);for(var n=Fe.hashName(e.id,t),r=Fe.nameTable[n];r;r=r.name_next){var o=r.name;if(r.parent.id===e.id&&o===t)return r}return Fe.lookup(e,t)},createNode:function(e,t,i,n){var r=new Fe.FSNode(e,t,i,n);return Fe.hashAddNode(r),r},destroyNode:function(e){Fe.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768===(61440&e)},isDir:function(e){return 16384===(61440&e)},isLink:function(e){return 40960===(61440&e)},isChrdev:function(e){return 8192===(61440&e)},isBlkdev:function(e){return 24576===(61440&e)},isFIFO:function(e){return 4096===(61440&e)},isSocket:function(e){return 49152===(49152&e)},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(e){var t=Fe.flagModes[e];if("undefined"===typeof t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return Fe.ignorePermissions||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){var t=Fe.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{Fe.lookupNode(e,t);return 20}catch(i){}return Fe.nodePermissions(e,"wx")},mayDelete:function(e,t,i){var n;try{n=Fe.lookupNode(e,t)}catch(o){return o.errno}var r=Fe.nodePermissions(e,"wx");if(r)return r;if(i){if(!Fe.isDir(n.mode))return 54;if(Fe.isRoot(n)||Fe.getPath(n)===Fe.cwd())return 10}else if(Fe.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?Fe.isLink(e.mode)?32:Fe.isDir(e.mode)&&("r"!==Fe.flagsToPermissionString(t)||512&t)?31:Fe.nodePermissions(e,Fe.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||Fe.MAX_OPEN_FDS;for(var i=e;i<=t;i++)if(!Fe.streams[i])return i;throw new Fe.ErrnoError(33)},getStream:function(e){return Fe.streams[e]},createStream:function(e,t,i){Fe.FSStream||(Fe.FSStream=function(){},Fe.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!==(2097155&this.flags)}},isWrite:{get:function(){return 0!==(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var n=new Fe.FSStream;for(var r in e)n[r]=e[r];e=n;var o=Fe.nextfd(t,i);return e.fd=o,Fe.streams[o]=e,e},closeStream:function(e){Fe.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=Fe.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new Fe.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){Fe.devices[e]={stream_ops:t}},getDevice:function(e){return Fe.devices[e]},getMounts:function(e){for(var t=[],i=[e];i.length;){var n=i.pop();t.push(n),i.push.apply(i,n.mounts)}return t},syncfs:function(e,t){"function"===typeof e&&(t=e,e=!1),Fe.syncFSRequests++,Fe.syncFSRequests>1&&S("warning: "+Fe.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var i=Fe.getMounts(Fe.root.mount),n=0;function r(e){return Fe.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,r(e));++n>=i.length&&r(null)}i.forEach((function(t){if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:function(e,t,i){var n,r="/"===i,o=!i;if(r&&Fe.root)throw new Fe.ErrnoError(10);if(!r&&!o){var s=Fe.lookupPath(i,{follow_mount:!1});if(i=s.path,n=s.node,Fe.isMountpoint(n))throw new Fe.ErrnoError(10);if(!Fe.isDir(n.mode))throw new Fe.ErrnoError(54)}var a={type:e,opts:t,mountpoint:i,mounts:[]},l=e.mount(a);return l.mount=a,a.root=l,r?Fe.root=l:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),l},unmount:function(e){var t=Fe.lookupPath(e,{follow_mount:!1});if(!Fe.isMountpoint(t.node))throw new Fe.ErrnoError(28);var i=t.node,n=i.mounted,r=Fe.getMounts(n);Object.keys(Fe.nameTable).forEach((function(e){for(var t=Fe.nameTable[e];t;){var i=t.name_next;-1!==r.indexOf(t.mount)&&Fe.destroyNode(t),t=i}})),i.mounted=null;var o=i.mount.mounts.indexOf(n);i.mount.mounts.splice(o,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,i){var n=Fe.lookupPath(e,{parent:!0}).node,r=Te.basename(e);if(!r||"."===r||".."===r)throw new Fe.ErrnoError(28);var o=Fe.mayCreate(n,r);if(o)throw new Fe.ErrnoError(o);if(!n.node_ops.mknod)throw new Fe.ErrnoError(63);return n.node_ops.mknod(n,r,t,i)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,Fe.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,Fe.mknod(e,t,0)},mkdirTree:function(e,t){for(var i=e.split("/"),n="",r=0;r<i.length;++r)if(i[r]){n+="/"+i[r];try{Fe.mkdir(n,t)}catch(o){if(20!=o.errno)throw o}}},mkdev:function(e,t,i){return"undefined"===typeof i&&(i=t,t=438),t|=8192,Fe.mknod(e,t,i)},symlink:function(e,t){if(!Ae.resolve(e))throw new Fe.ErrnoError(44);var i=Fe.lookupPath(t,{parent:!0}).node;if(!i)throw new Fe.ErrnoError(44);var n=Te.basename(t),r=Fe.mayCreate(i,n);if(r)throw new Fe.ErrnoError(r);if(!i.node_ops.symlink)throw new Fe.ErrnoError(63);return i.node_ops.symlink(i,n,e)},rename:function(e,t){var i,n,r=Te.dirname(e),o=Te.dirname(t),s=Te.basename(e),a=Te.basename(t);if(i=Fe.lookupPath(e,{parent:!0}).node,n=Fe.lookupPath(t,{parent:!0}).node,!i||!n)throw new Fe.ErrnoError(44);if(i.mount!==n.mount)throw new Fe.ErrnoError(75);var l,c=Fe.lookupNode(i,s),d=Ae.relative(e,o);if("."!==d.charAt(0))throw new Fe.ErrnoError(28);if("."!==(d=Ae.relative(t,r)).charAt(0))throw new Fe.ErrnoError(55);try{l=Fe.lookupNode(n,a)}catch(u){}if(c!==l){var p=Fe.isDir(c.mode),h=Fe.mayDelete(i,s,p);if(h)throw new Fe.ErrnoError(h);if(h=l?Fe.mayDelete(n,a,p):Fe.mayCreate(n,a))throw new Fe.ErrnoError(h);if(!i.node_ops.rename)throw new Fe.ErrnoError(63);if(Fe.isMountpoint(c)||l&&Fe.isMountpoint(l))throw new Fe.ErrnoError(10);if(n!==i&&(h=Fe.nodePermissions(i,"w")))throw new Fe.ErrnoError(h);try{Fe.trackingDelegate.willMovePath&&Fe.trackingDelegate.willMovePath(e,t)}catch(u){S("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+u.message)}Fe.hashRemoveNode(c);try{i.node_ops.rename(c,n,a)}catch(u){throw u}finally{Fe.hashAddNode(c)}try{Fe.trackingDelegate.onMovePath&&Fe.trackingDelegate.onMovePath(e,t)}catch(u){S("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+u.message)}}},rmdir:function(e){var t=Fe.lookupPath(e,{parent:!0}).node,i=Te.basename(e),n=Fe.lookupNode(t,i),r=Fe.mayDelete(t,i,!0);if(r)throw new Fe.ErrnoError(r);if(!t.node_ops.rmdir)throw new Fe.ErrnoError(63);if(Fe.isMountpoint(n))throw new Fe.ErrnoError(10);try{Fe.trackingDelegate.willDeletePath&&Fe.trackingDelegate.willDeletePath(e)}catch(o){S("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.rmdir(t,i),Fe.destroyNode(n);try{Fe.trackingDelegate.onDeletePath&&Fe.trackingDelegate.onDeletePath(e)}catch(o){S("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readdir:function(e){var t=Fe.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new Fe.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=Fe.lookupPath(e,{parent:!0}).node,i=Te.basename(e),n=Fe.lookupNode(t,i),r=Fe.mayDelete(t,i,!1);if(r)throw new Fe.ErrnoError(r);if(!t.node_ops.unlink)throw new Fe.ErrnoError(63);if(Fe.isMountpoint(n))throw new Fe.ErrnoError(10);try{Fe.trackingDelegate.willDeletePath&&Fe.trackingDelegate.willDeletePath(e)}catch(o){S("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.unlink(t,i),Fe.destroyNode(n);try{Fe.trackingDelegate.onDeletePath&&Fe.trackingDelegate.onDeletePath(e)}catch(o){S("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readlink:function(e){var t=Fe.lookupPath(e).node;if(!t)throw new Fe.ErrnoError(44);if(!t.node_ops.readlink)throw new Fe.ErrnoError(28);return Ae.resolve(Fe.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var i=Fe.lookupPath(e,{follow:!t}).node;if(!i)throw new Fe.ErrnoError(44);if(!i.node_ops.getattr)throw new Fe.ErrnoError(63);return i.node_ops.getattr(i)},lstat:function(e){return Fe.stat(e,!0)},chmod:function(e,t,i){var n;"string"===typeof e?n=Fe.lookupPath(e,{follow:!i}).node:n=e;if(!n.node_ops.setattr)throw new Fe.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,t){Fe.chmod(e,t,!0)},fchmod:function(e,t){var i=Fe.getStream(e);if(!i)throw new Fe.ErrnoError(8);Fe.chmod(i.node,t)},chown:function(e,t,i,n){var r;"string"===typeof e?r=Fe.lookupPath(e,{follow:!n}).node:r=e;if(!r.node_ops.setattr)throw new Fe.ErrnoError(63);r.node_ops.setattr(r,{timestamp:Date.now()})},lchown:function(e,t,i){Fe.chown(e,t,i,!0)},fchown:function(e,t,i){var n=Fe.getStream(e);if(!n)throw new Fe.ErrnoError(8);Fe.chown(n.node,t,i)},truncate:function(e,t){if(t<0)throw new Fe.ErrnoError(28);var i;"string"===typeof e?i=Fe.lookupPath(e,{follow:!0}).node:i=e;if(!i.node_ops.setattr)throw new Fe.ErrnoError(63);if(Fe.isDir(i.mode))throw new Fe.ErrnoError(31);if(!Fe.isFile(i.mode))throw new Fe.ErrnoError(28);var n=Fe.nodePermissions(i,"w");if(n)throw new Fe.ErrnoError(n);i.node_ops.setattr(i,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var i=Fe.getStream(e);if(!i)throw new Fe.ErrnoError(8);if(0===(2097155&i.flags))throw new Fe.ErrnoError(28);Fe.truncate(i.node,t)},utime:function(e,t,i){var n=Fe.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,i)})},open:function(e,t,i,n,r){if(""===e)throw new Fe.ErrnoError(44);var s;if(i="undefined"===typeof i?438:i,i=64&(t="string"===typeof t?Fe.modeStringToFlags(t):t)?4095&i|32768:0,"object"===typeof e)s=e;else{e=Te.normalize(e);try{s=Fe.lookupPath(e,{follow:!(131072&t)}).node}catch(p){}}var a=!1;if(64&t)if(s){if(128&t)throw new Fe.ErrnoError(20)}else s=Fe.mknod(e,i,0),a=!0;if(!s)throw new Fe.ErrnoError(44);if(Fe.isChrdev(s.mode)&&(t&=-513),65536&t&&!Fe.isDir(s.mode))throw new Fe.ErrnoError(54);if(!a){var l=Fe.mayOpen(s,t);if(l)throw new Fe.ErrnoError(l)}512&t&&Fe.truncate(s,0),t&=-131713;var c=Fe.createStream({node:s,path:Fe.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1},n,r);c.stream_ops.open&&c.stream_ops.open(c),!o.logReadFiles||1&t||(Fe.readFiles||(Fe.readFiles={}),e in Fe.readFiles||(Fe.readFiles[e]=1,S("FS.trackingDelegate error on read file: "+e)));try{if(Fe.trackingDelegate.onOpenFile){var d=0;1!==(2097155&t)&&(d|=Fe.tracking.openFlags.READ),0!==(2097155&t)&&(d|=Fe.tracking.openFlags.WRITE),Fe.trackingDelegate.onOpenFile(e,d)}}catch(p){S("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+p.message)}return c},close:function(e){if(Fe.isClosed(e))throw new Fe.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{Fe.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,i){if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Fe.ErrnoError(70);if(0!=i&&1!=i&&2!=i)throw new Fe.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,i),e.ungotten=[],e.position},read:function(e,t,i,n,r){if(n<0||r<0)throw new Fe.ErrnoError(28);if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(1===(2097155&e.flags))throw new Fe.ErrnoError(8);if(Fe.isDir(e.node.mode))throw new Fe.ErrnoError(31);if(!e.stream_ops.read)throw new Fe.ErrnoError(28);var o="undefined"!==typeof r;if(o){if(!e.seekable)throw new Fe.ErrnoError(70)}else r=e.position;var s=e.stream_ops.read(e,t,i,n,r);return o||(e.position+=s),s},write:function(e,t,i,n,r,o){if(n<0||r<0)throw new Fe.ErrnoError(28);if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(0===(2097155&e.flags))throw new Fe.ErrnoError(8);if(Fe.isDir(e.node.mode))throw new Fe.ErrnoError(31);if(!e.stream_ops.write)throw new Fe.ErrnoError(28);e.seekable&&1024&e.flags&&Fe.llseek(e,0,2);var s="undefined"!==typeof r;if(s){if(!e.seekable)throw new Fe.ErrnoError(70)}else r=e.position;var a=e.stream_ops.write(e,t,i,n,r,o);s||(e.position+=a);try{e.path&&Fe.trackingDelegate.onWriteToFile&&Fe.trackingDelegate.onWriteToFile(e.path)}catch(l){S("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+l.message)}return a},allocate:function(e,t,i){if(Fe.isClosed(e))throw new Fe.ErrnoError(8);if(t<0||i<=0)throw new Fe.ErrnoError(28);if(0===(2097155&e.flags))throw new Fe.ErrnoError(8);if(!Fe.isFile(e.node.mode)&&!Fe.isDir(e.node.mode))throw new Fe.ErrnoError(43);if(!e.stream_ops.allocate)throw new Fe.ErrnoError(138);e.stream_ops.allocate(e,t,i)},mmap:function(e,t,i,n,r,o){if(0!==(2&r)&&0===(2&o)&&2!==(2097155&e.flags))throw new Fe.ErrnoError(2);if(1===(2097155&e.flags))throw new Fe.ErrnoError(2);if(!e.stream_ops.mmap)throw new Fe.ErrnoError(43);return e.stream_ops.mmap(e,t,i,n,r,o)},msync:function(e,t,i,n,r){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,i,n,r):0},munmap:function(e){return 0},ioctl:function(e,t,i){if(!e.stream_ops.ioctl)throw new Fe.ErrnoError(59);return e.stream_ops.ioctl(e,t,i)},readFile:function(e,t){if((t=t||{}).flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var i,n=Fe.open(e,t.flags),r=Fe.stat(e).size,o=new Uint8Array(r);return Fe.read(n,o,0,r,0),"utf8"===t.encoding?i=k(o,0):"binary"===t.encoding&&(i=o),Fe.close(n),i},writeFile:function(e,t,i){(i=i||{}).flags=i.flags||577;var n=Fe.open(e,i.flags,i.mode);if("string"===typeof t){var r=new Uint8Array(_(t)+1),o=L(t,r,0,r.length);Fe.write(n,r,0,o,void 0,i.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Fe.write(n,t,0,t.byteLength,void 0,i.canOwn)}Fe.close(n)},cwd:function(){return Fe.currentPath},chdir:function(e){var t=Fe.lookupPath(e,{follow:!0});if(null===t.node)throw new Fe.ErrnoError(44);if(!Fe.isDir(t.node.mode))throw new Fe.ErrnoError(54);var i=Fe.nodePermissions(t.node,"x");if(i)throw new Fe.ErrnoError(i);Fe.currentPath=t.path},createDefaultDirectories:function(){Fe.mkdir("/tmp"),Fe.mkdir("/home"),Fe.mkdir("/home/web_user")},createDefaultDevices:function(){Fe.mkdir("/dev"),Fe.registerDevice(Fe.makedev(1,3),{read:function(){return 0},write:function(e,t,i,n,r){return n}}),Fe.mkdev("/dev/null",Fe.makedev(1,3)),Pe.register(Fe.makedev(5,0),Pe.default_tty_ops),Pe.register(Fe.makedev(6,0),Pe.default_tty1_ops),Fe.mkdev("/dev/tty",Fe.makedev(5,0)),Fe.mkdev("/dev/tty1",Fe.makedev(6,0));var e=Re();Fe.createDevice("/dev","random",e),Fe.createDevice("/dev","urandom",e),Fe.mkdir("/dev/shm"),Fe.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){Fe.mkdir("/proc");var e=Fe.mkdir("/proc/self");Fe.mkdir("/proc/self/fd"),Fe.mount({mount:function(){var t=Fe.createNode(e,"fd",16895,73);return t.node_ops={lookup:function(e,t){var i=+t,n=Fe.getStream(i);if(!n)throw new Fe.ErrnoError(8);var r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return r.parent=r,r}},t}},{},"/proc/self/fd")},createStandardStreams:function(){o.stdin?Fe.createDevice("/dev","stdin",o.stdin):Fe.symlink("/dev/tty","/dev/stdin"),o.stdout?Fe.createDevice("/dev","stdout",null,o.stdout):Fe.symlink("/dev/tty","/dev/stdout"),o.stderr?Fe.createDevice("/dev","stderr",null,o.stderr):Fe.symlink("/dev/tty1","/dev/stderr");Fe.open("/dev/stdin",0),Fe.open("/dev/stdout",1),Fe.open("/dev/stderr",1)},ensureErrnoError:function(){Fe.ErrnoError||(Fe.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},Fe.ErrnoError.prototype=new Error,Fe.ErrnoError.prototype.constructor=Fe.ErrnoError,[44].forEach((function(e){Fe.genericErrors[e]=new Fe.ErrnoError(e),Fe.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){Fe.ensureErrnoError(),Fe.nameTable=new Array(4096),Fe.mount(Me,{},"/"),Fe.createDefaultDirectories(),Fe.createDefaultDevices(),Fe.createSpecialDirectories(),Fe.filesystems={MEMFS:Me}},init:function(e,t,i){Fe.init.initialized=!0,Fe.ensureErrnoError(),o.stdin=e||o.stdin,o.stdout=t||o.stdout,o.stderr=i||o.stderr,Fe.createStandardStreams()},quit:function(){Fe.init.initialized=!1;var e=o._fflush;e&&e(0);for(var t=0;t<Fe.streams.length;t++){var i=Fe.streams[t];i&&Fe.close(i)}},getMode:function(e,t){var i=0;return e&&(i|=365),t&&(i|=146),i},findObject:function(e,t){var i=Fe.analyzePath(e,t);return i.exists?i.object:null},analyzePath:function(e,t){try{e=(n=Fe.lookupPath(e,{follow:!t})).path}catch(r){}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=Fe.lookupPath(e,{parent:!0});i.parentExists=!0,i.parentPath=n.path,i.parentObject=n.node,i.name=Te.basename(e),n=Fe.lookupPath(e,{follow:!t}),i.exists=!0,i.path=n.path,i.object=n.node,i.name=n.node.name,i.isRoot="/"===n.path}catch(r){i.error=r.errno}return i},createPath:function(e,t,i,n){e="string"===typeof e?e:Fe.getPath(e);for(var r=t.split("/").reverse();r.length;){var o=r.pop();if(o){var s=Te.join2(e,o);try{Fe.mkdir(s)}catch(a){}e=s}}return s},createFile:function(e,t,i,n,r){var o=Te.join2("string"===typeof e?e:Fe.getPath(e),t),s=Fe.getMode(n,r);return Fe.create(o,s)},createDataFile:function(e,t,i,n,r,o){var s=t?Te.join2("string"===typeof e?e:Fe.getPath(e),t):e,a=Fe.getMode(n,r),l=Fe.create(s,a);if(i){if("string"===typeof i){for(var c=new Array(i.length),d=0,p=i.length;d<p;++d)c[d]=i.charCodeAt(d);i=c}Fe.chmod(l,146|a);var h=Fe.open(l,577);Fe.write(h,i,0,i.length,0,o),Fe.close(h),Fe.chmod(l,a)}return l},createDevice:function(e,t,i,n){var r=Te.join2("string"===typeof e?e:Fe.getPath(e),t),o=Fe.getMode(!!i,!!n);Fe.createDevice.major||(Fe.createDevice.major=64);var s=Fe.makedev(Fe.createDevice.major++,0);return Fe.registerDevice(s,{open:function(e){e.seekable=!1},close:function(e){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,t,n,r,o){for(var s=0,a=0;a<r;a++){var l;try{l=i()}catch(c){throw new Fe.ErrnoError(29)}if(void 0===l&&0===s)throw new Fe.ErrnoError(6);if(null===l||void 0===l)break;s++,t[n+a]=l}return s&&(e.node.timestamp=Date.now()),s},write:function(e,t,i,r,o){for(var s=0;s<r;s++)try{n(t[i+s])}catch(a){throw new Fe.ErrnoError(29)}return r&&(e.node.timestamp=Date.now()),s}}),Fe.mkdev(r,o,s)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!==typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!g)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=bt(g(e.url),!0),e.usedBytes=e.contents.length}catch(t){throw new Fe.ErrnoError(29)}},createLazyFile:function(e,t,i,n,r){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,i=e/this.chunkSize|0;return this.getter(i)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",i,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+i+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),r=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;r||(s=n);var a=this;a.setDataGetter((function(e){var t=e*s,r=(e+1)*s-1;if(r=Math.min(r,n-1),"undefined"===typeof a.chunks[e]&&(a.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var r=new XMLHttpRequest;if(r.open("GET",i,!1),n!==s&&r.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(r.responseType="arraybuffer"),r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.send(null),!(r.status>=200&&r.status<300||304===r.status))throw new Error("Couldn't load "+i+". Status: "+r.status);return void 0!==r.response?new Uint8Array(r.response||[]):bt(r.responseText||"",!0)}(t,r)),"undefined"===typeof a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!o&&n||(s=n=1,n=this.getter(0).length,s=n,x("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0},"undefined"!==typeof XMLHttpRequest){if(!p)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new o;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:s}}else a={isDevice:!1,url:i};var l=Fe.createFile(e,t,a,n,r);a.contents?l.contents=a.contents:a.url&&(l.contents=null,l.url=a.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var c={};return Object.keys(l.stream_ops).forEach((function(e){var t=l.stream_ops[e];c[e]=function(){return Fe.forceLoadFile(l),t.apply(null,arguments)}})),c.read=function(e,t,i,n,r){Fe.forceLoadFile(l);var o=e.node.contents;if(r>=o.length)return 0;var s=Math.min(o.length-r,n);if(o.slice)for(var a=0;a<s;a++)t[i+a]=o[r+a];else for(a=0;a<s;a++)t[i+a]=o.get(r+a);return s},l.stream_ops=c,l},createPreloadedFile:function(e,t,i,n,r,s,a,l,c,d){Browser.init();var p=t?Ae.resolve(Te.join2(e,t)):e;function h(i){function h(i){d&&d(),l||Fe.createDataFile(e,t,i,n,r,c),s&&s(),de()}var u=!1;o.preloadPlugins.forEach((function(e){u||e.canHandle(p)&&(e.handle(i,p,h,(function(){a&&a(),de()})),u=!0)})),u||h(i)}ce(),"string"==typeof i?Browser.asyncLoad(i,(function(e){h(e)}),a):h(i)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,i){t=t||function(){},i=i||function(){};var n=Fe.indexedDB();try{var r=n.open(Fe.DB_NAME(),Fe.DB_VERSION)}catch(o){return i(o)}r.onupgradeneeded=function(){x("creating db"),r.result.createObjectStore(Fe.DB_STORE_NAME)},r.onsuccess=function(){var n=r.result.transaction([Fe.DB_STORE_NAME],"readwrite"),o=n.objectStore(Fe.DB_STORE_NAME),s=0,a=0,l=e.length;function c(){0==a?t():i()}e.forEach((function(e){var t=o.put(Fe.analyzePath(e).object.contents,e);t.onsuccess=function(){++s+a==l&&c()},t.onerror=function(){a++,s+a==l&&c()}})),n.onerror=i},r.onerror=i},loadFilesFromDB:function(e,t,i){t=t||function(){},i=i||function(){};var n=Fe.indexedDB();try{var r=n.open(Fe.DB_NAME(),Fe.DB_VERSION)}catch(o){return i(o)}r.onupgradeneeded=i,r.onsuccess=function(){var n=r.result;try{var s=n.transaction([Fe.DB_STORE_NAME],"readonly")}catch(o){return void i(o)}var a=s.objectStore(Fe.DB_STORE_NAME),l=0,c=0,d=e.length;function p(){0==c?t():i()}e.forEach((function(e){var t=a.get(e);t.onsuccess=function(){Fe.analyzePath(e).exists&&Fe.unlink(e),Fe.createDataFile(Te.dirname(e),Te.basename(e),t.result,!0,!0,!0),++l+c==d&&p()},t.onerror=function(){c++,l+c==d&&p()}})),s.onerror=i},r.onerror=i}},ke={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t,i){if("/"===t[0])return t;var n;if(-100===e)n=Fe.cwd();else{var r=Fe.getStream(e);if(!r)throw new Fe.ErrnoError(8);n=r.path}if(0==t.length){if(!i)throw new Fe.ErrnoError(44);return n}return Te.join2(n,t)},doStat:function(e,t,i){try{var n=e(t)}catch(r){if(r&&r.node&&Te.normalize(t)!==Te.normalize(Fe.getPath(r.node)))return-54;throw r}return B[i>>2]=n.dev,B[i+4>>2]=0,B[i+8>>2]=n.ino,B[i+12>>2]=n.mode,B[i+16>>2]=n.nlink,B[i+20>>2]=n.uid,B[i+24>>2]=n.gid,B[i+28>>2]=n.rdev,B[i+32>>2]=0,ye=[n.size>>>0,(me=n.size,+Math.abs(me)>=1?me>0?(0|Math.min(+Math.floor(me/4294967296),4294967295))>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],B[i+40>>2]=ye[0],B[i+44>>2]=ye[1],B[i+48>>2]=4096,B[i+52>>2]=n.blocks,B[i+56>>2]=n.atime.getTime()/1e3|0,B[i+60>>2]=0,B[i+64>>2]=n.mtime.getTime()/1e3|0,B[i+68>>2]=0,B[i+72>>2]=n.ctime.getTime()/1e3|0,B[i+76>>2]=0,ye=[n.ino>>>0,(me=n.ino,+Math.abs(me)>=1?me>0?(0|Math.min(+Math.floor(me/4294967296),4294967295))>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],B[i+80>>2]=ye[0],B[i+84>>2]=ye[1],0},doMsync:function(e,t,i,n,r){var o=W.slice(e,e+i);Fe.msync(t,o,r,i,n)},doMkdir:function(e,t){return"/"===(e=Te.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),Fe.mkdir(e,t,0),0},doMknod:function(e,t,i){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return Fe.mknod(e,t,i),0},doReadlink:function(e,t,i){if(i<=0)return-28;var n=Fe.readlink(e),r=Math.min(i,_(n)),o=V[t+r];return N(n,t,i+1),V[t+r]=o,r},doAccess:function(e,t){if(-8&t)return-28;var i;if(!(i=Fe.lookupPath(e,{follow:!0}).node))return-44;var n="";return 4&t&&(n+="r"),2&t&&(n+="w"),1&t&&(n+="x"),n&&Fe.nodePermissions(i,n)?-2:0},doDup:function(e,t,i){var n=Fe.getStream(i);return n&&Fe.close(n),Fe.open(e,t,0,i,i).fd},doReadv:function(e,t,i,n){for(var r=0,o=0;o<i;o++){var s=B[t+8*o>>2],a=B[t+(8*o+4)>>2],l=Fe.read(e,V,s,a,n);if(l<0)return-1;if(r+=l,l<a)break}return r},doWritev:function(e,t,i,n){for(var r=0,o=0;o<i;o++){var s=B[t+8*o>>2],a=B[t+(8*o+4)>>2],l=Fe.write(e,V,s,a,n);if(l<0)return-1;r+=l}return r},varargs:void 0,get:function(){return ke.varargs+=4,B[ke.varargs-4>>2]},getStr:function(e){return D(e)},getStreamFromFD:function(e){var t=Fe.getStream(e);if(!t)throw new Fe.ErrnoError(8);return t},get64:function(e,t){return e}};function De(e,t,i){ke.varargs=i;try{var n=ke.getStreamFromFD(e);switch(t){case 0:return(r=ke.get())<0?-28:Fe.open(n.path,n.flags,0,r).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:var r=ke.get();return n.flags|=r,0;case 12:r=ke.get();return G[r+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return we(28),-1;default:return-28}}catch(o){return"undefined"!==typeof Fe&&o instanceof Fe.ErrnoError||pe(o),-o.errno}}function Le(e,t,i){ke.varargs=i;try{var n=ke.getStreamFromFD(e);switch(t){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:if(!n.tty)return-59;var r=ke.get();return B[r>>2]=0,0;case 21520:return n.tty?-28:-59;case 21531:r=ke.get();return Fe.ioctl(n,t,r);case 21523:case 21524:return n.tty?0:-59;default:pe("bad ioctl syscall "+t)}}catch(o){return"undefined"!==typeof Fe&&o instanceof Fe.ErrnoError||pe(o),-o.errno}}function Ne(e,t,i){ke.varargs=i;try{var n=ke.getStr(e),r=i?ke.get():0;return Fe.open(n,t,r).fd}catch(o){return"undefined"!==typeof Fe&&o instanceof Fe.ErrnoError||pe(o),-o.errno}}function _e(){pe()}function ze(){return void 0===ze.start&&(ze.start=Date.now()),1e3*(Date.now()-ze.start)|0}function Ve(e,t){return e-t}function We(e,t,i){var n=ht(t,i);return ve[e].apply(null,n)}function Ge(e,t,i){return We(e,t,i)}function Be(e,t,i){W.copyWithin(e,t,t+i)}function qe(){return W.length}function He(e){try{return T.grow(e-z.byteLength+65535>>>16),X(T.buffer),1}catch(t){}}function Ye(e){var t=qe(),i=2147483648;if(e>i)return!1;for(var n=1;n<=4;n*=2){var r=t*(1+.2/n);if(r=Math.min(r,e+100663296),He(Math.min(i,U(Math.max(e,r),65536))))return!0}return!1}var Ue={};function Xe(){return c||"./this.program"}function $e(){if(!$e.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"===typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Xe()};for(var t in Ue)e[t]=Ue[t];var i=[];for(var t in e)i.push(t+"="+e[t]);$e.strings=i}return $e.strings}function Ke(e,t){try{var i=0;return $e().forEach((function(n,r){var o=t+i;B[e+4*r>>2]=o,Y(n,o),i+=n.length+1})),0}catch(n){return"undefined"!==typeof Fe&&n instanceof Fe.ErrnoError||pe(n),n.errno}}function Qe(e,t){try{var i=$e();B[e>>2]=i.length;var n=0;return i.forEach((function(e){n+=e.length+1})),B[t>>2]=n,0}catch(r){return"undefined"!==typeof Fe&&r instanceof Fe.ErrnoError||pe(r),r.errno}}function Ze(e){try{var t=ke.getStreamFromFD(e);return Fe.close(t),0}catch(i){return"undefined"!==typeof Fe&&i instanceof Fe.ErrnoError||pe(i),i.errno}}function Je(e,t,i,n){try{var r=ke.getStreamFromFD(e),o=ke.doReadv(r,t,i);return B[n>>2]=o,0}catch(s){return"undefined"!==typeof Fe&&s instanceof Fe.ErrnoError||pe(s),s.errno}}function et(e,t,i,n,r){try{var o=ke.getStreamFromFD(e),s=4294967296*i+(t>>>0),a=9007199254740992;return s<=-a||s>=a?-61:(Fe.llseek(o,s,n),ye=[o.position>>>0,(me=o.position,+Math.abs(me)>=1?me>0?(0|Math.min(+Math.floor(me/4294967296),4294967295))>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],B[r>>2]=ye[0],B[r+4>>2]=ye[1],o.getdents&&0===s&&0===n&&(o.getdents=null),0)}catch(l){return"undefined"!==typeof Fe&&l instanceof Fe.ErrnoError||pe(l),l.errno}}function tt(e,t,i,n){try{var r=ke.getStreamFromFD(e),o=ke.doWritev(r,t,i);return B[n>>2]=o,0}catch(s){return"undefined"!==typeof Fe&&s instanceof Fe.ErrnoError||pe(s),s.errno}}function it(e){w(0|e)}function nt(e){return e%4===0&&(e%100!==0||e%400===0)}function rt(e,t){for(var i=0,n=0;n<=t;i+=e[n++]);return i}var ot=[31,29,31,30,31,30,31,31,30,31,30,31],st=[31,28,31,30,31,30,31,31,30,31,30,31];function at(e,t){for(var i=new Date(e.getTime());t>0;){var n=nt(i.getFullYear()),r=i.getMonth(),o=(n?ot:st)[r];if(!(t>o-i.getDate()))return i.setDate(i.getDate()+t),i;t-=o-i.getDate()+1,i.setDate(1),r<11?i.setMonth(r+1):(i.setMonth(0),i.setFullYear(i.getFullYear()+1))}return i}function lt(e,t,i,n){var r=B[n+40>>2],o={tm_sec:B[n>>2],tm_min:B[n+4>>2],tm_hour:B[n+8>>2],tm_mday:B[n+12>>2],tm_mon:B[n+16>>2],tm_year:B[n+20>>2],tm_wday:B[n+24>>2],tm_yday:B[n+28>>2],tm_isdst:B[n+32>>2],tm_gmtoff:B[n+36>>2],tm_zone:r?D(r):""},s=D(i),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in a)s=s.replace(new RegExp(l,"g"),a[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"];function p(e,t,i){for(var n="number"===typeof e?e.toString():e||"";n.length<t;)n=i[0]+n;return n}function h(e,t){return p(e,t,"0")}function u(e,t){function i(e){return e<0?-1:e>0?1:0}var n;return 0===(n=i(e.getFullYear()-t.getFullYear()))&&0===(n=i(e.getMonth()-t.getMonth()))&&(n=i(e.getDate()-t.getDate())),n}function g(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function f(e){var t=at(new Date(e.tm_year+1900,0,1),e.tm_yday),i=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),r=g(i),o=g(n);return u(r,t)<=0?u(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var b={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return d[e.tm_mon].substring(0,3)},"%B":function(e){return d[e.tm_mon]},"%C":function(e){return h((e.tm_year+1900)/100|0,2)},"%d":function(e){return h(e.tm_mday,2)},"%e":function(e){return p(e.tm_mday,2," ")},"%g":function(e){return f(e).toString().substring(2)},"%G":function(e){return f(e)},"%H":function(e){return h(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),h(t,2)},"%j":function(e){return h(e.tm_mday+rt(nt(e.tm_year+1900)?ot:st,e.tm_mon-1),3)},"%m":function(e){return h(e.tm_mon+1,2)},"%M":function(e){return h(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return h(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=new Date(e.tm_year+1900,0,1),i=0===t.getDay()?t:at(t,7-t.getDay()),n=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(u(i,n)<0){var r=rt(nt(n.getFullYear())?ot:st,n.getMonth()-1)-31,o=31-i.getDate()+r+n.getDate();return h(Math.ceil(o/7),2)}return 0===u(i,t)?"01":"00"},"%V":function(e){var t,i=new Date(e.tm_year+1900,0,4),n=new Date(e.tm_year+1901,0,4),r=g(i),o=g(n),s=at(new Date(e.tm_year+1900,0,1),e.tm_yday);return u(s,r)<0?"53":u(o,s)<=0?"01":(t=r.getFullYear()<e.tm_year+1900?e.tm_yday+32-r.getDate():e.tm_yday+1-r.getDate(),h(Math.ceil(t/7),2))},"%w":function(e){return e.tm_wday},"%W":function(e){var t=new Date(e.tm_year,0,1),i=1===t.getDay()?t:at(t,0===t.getDay()?1:7-t.getDay()+1),n=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(u(i,n)<0){var r=rt(nt(n.getFullYear())?ot:st,n.getMonth()-1)-31,o=31-i.getDate()+r+n.getDate();return h(Math.ceil(o/7),2)}return 0===u(i,t)?"01":"00"},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,i=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(i?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var l in b)s.indexOf(l)>=0&&(s=s.replace(new RegExp(l,"g"),b[l](o)));var m=bt(s,!1);return m.length>t?0:(H(m,e),m.length-1)}function ct(e,t,i,n){return lt(e,t,i,n)}function dt(e){var t=Date.now()/1e3|0;return e&&(B[e>>2]=t),t}var pt=[];function ht(e,t){var i;for(pt.length=0,t>>=2;i=W[e++];){var n=i<105;n&&1&t&&t++,pt.push(n?q[t++>>1]:B[t]),++t}return pt}var ut=function(e,t,i,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Fe.nextInode++,this.name=t,this.mode=i,this.node_ops={},this.stream_ops={},this.rdev=n},gt=365,ft=146;Object.defineProperties(ut.prototype,{read:{get:function(){return(this.mode&gt)===gt},set:function(e){e?this.mode|=gt:this.mode&=~gt}},write:{get:function(){return(this.mode&ft)===ft},set:function(e){e?this.mode|=ft:this.mode&=~ft}},isFolder:{get:function(){return Fe.isDir(this.mode)}},isDevice:{get:function(){return Fe.isChrdev(this.mode)}}}),Fe.FSNode=ut,Fe.staticInit();function bt(e,t,i){var n=i>0?i:_(e)+1,r=new Array(n),o=L(e,r,0,r.length);return t&&(r.length=o),r}var mt,yt={__cxa_atexit:Ie,__sys_fcntl64:De,__sys_ioctl:Le,__sys_open:Ne,abort:_e,clock:ze,difftime:Ve,emscripten_asm_const_double:Ge,emscripten_asm_const_int:We,emscripten_memcpy_big:Be,emscripten_resize_heap:Ye,environ_get:Ke,environ_sizes_get:Qe,fd_close:Ze,fd_read:Je,fd_seek:et,fd_write:tt,setTempRet0:it,strftime_l:ct,time:dt},Ot=(Se(),o.___wasm_call_ctors=function(){return(Ot=o.___wasm_call_ctors=o.asm.__wasm_call_ctors).apply(null,arguments)}),jt=(o._getLastErrorMessage=function(){return(o._getLastErrorMessage=o.asm.getLastErrorMessage).apply(null,arguments)},o._clearLastErrorMessage=function(){return(o._clearLastErrorMessage=o.asm.clearLastErrorMessage).apply(null,arguments)},o._emptyFitsChan=function(){return(o._emptyFitsChan=o.asm.emptyFitsChan).apply(null,arguments)},o._putFits=function(){return(o._putFits=o.asm.putFits).apply(null,arguments)},o._getFrameFromFitsChan=function(){return(o._getFrameFromFitsChan=o.asm.getFrameFromFitsChan).apply(null,arguments)},o._getSpectralFrame=function(){return(o._getSpectralFrame=o.asm.getSpectralFrame).apply(null,arguments)},o._getSkyFrameSet=function(){return(o._getSkyFrameSet=o.asm.getSkyFrameSet).apply(null,arguments)},o._createTransformedFrameset=function(){return(o._createTransformedFrameset=o.asm.createTransformedFrameset).apply(null,arguments)},o._initDummyFrame=function(){return(o._initDummyFrame=o.asm.initDummyFrame).apply(null,arguments)},o._plotGrid=function(){return(o._plotGrid=o.asm.plotGrid).apply(null,arguments)},o._format=function(){return(o._format=o.asm.format).apply(null,arguments)},o._unformat=function(){return(o._unformat=o.asm.unformat).apply(null,arguments)},o._set=function(){return(o._set=o.asm.set).apply(null,arguments)},o._setI=function(){return(o._setI=o.asm.setI).apply(null,arguments)},o._setD=function(){return(o._setD=o.asm.setD).apply(null,arguments)},o._clear=function(){return(o._clear=o.asm.clear).apply(null,arguments)},o._dump=function(){return(o._dump=o.asm.dump).apply(null,arguments)},o._getString=function(){return(o._getString=o.asm.getString).apply(null,arguments)},o._norm=function(){return(o._norm=o.asm.norm).apply(null,arguments)},o._transform=function(){return(o._transform=o.asm.transform).apply(null,arguments)},o._transform3D=function(){return(o._transform3D=o.asm.transform3D).apply(null,arguments)},o._spectralTransform=function(){return(o._spectralTransform=o.asm.spectralTransform).apply(null,arguments)},o._deleteObject=function(){return(o._deleteObject=o.asm.deleteObject).apply(null,arguments)},o._copy=function(){return(o._copy=o.asm.copy).apply(null,arguments)},o._invert=function(){return(o._invert=o.asm.invert).apply(null,arguments)},o._convert=function(){return(o._convert=o.asm.convert).apply(null,arguments)},o._shiftMap2D=function(){return(o._shiftMap2D=o.asm.shiftMap2D).apply(null,arguments)},o._axDistance=function(){return(o._axDistance=o.asm.axDistance).apply(null,arguments)},o._geodesicDistance=function(){return(o._geodesicDistance=o.asm.geodesicDistance).apply(null,arguments)},o._frame=function(){return(o._frame=o.asm.frame).apply(null,arguments)},o._addFrame=function(){return(o._addFrame=o.asm.addFrame).apply(null,arguments)},o._scaleMap2D=function(){return(o._scaleMap2D=o.asm.scaleMap2D).apply(null,arguments)},o._fillTransformGrid=function(){return(o._fillTransformGrid=o.asm.fillTransformGrid).apply(null,arguments)},o.___errno_location=function(){return(jt=o.___errno_location=o.asm.__errno_location).apply(null,arguments)}),xt=(o._free=function(){return(o._free=o.asm.free).apply(null,arguments)},o._malloc=function(){return(xt=o._malloc=o.asm.malloc).apply(null,arguments)}),St=o.stackSave=function(){return(St=o.stackSave=o.asm.stackSave).apply(null,arguments)},vt=o.stackRestore=function(){return(vt=o.stackRestore=o.asm.stackRestore).apply(null,arguments)},Ct=o.stackAlloc=function(){return(Ct=o.stackAlloc=o.asm.stackAlloc).apply(null,arguments)};o.dynCall_vidiiiiiiiidijjiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidijjiiiiiiiiii=o.asm.dynCall_vidiiiiiiiidijjiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidijjiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidijjiiiiiiii=o.asm.dynCall_vidiiiiiiiidijjiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidijjiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidijjiiiiiiii=o.asm.dynCall_jiiiiiiiiiidijjiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidiiiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidiiiiiiiiii=o.asm.dynCall_jiiiiiiiiiidiiiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidijiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidijiiiiiiii=o.asm.dynCall_jiiiiiiiiiidijiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidifiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidifiiiiiiii=o.asm.dynCall_jiiiiiiiiiidifiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiididiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiididiiiiiiii=o.asm.dynCall_jiiiiiiiiiididiiiiiiii).apply(null,arguments)},o.dynCall_vijiiii=function(){return(o.dynCall_vijiiii=o.asm.dynCall_vijiiii).apply(null,arguments)},o.dynCall_vijiiiiii=function(){return(o.dynCall_vijiiiiii=o.asm.dynCall_vijiiiiii).apply(null,arguments)},o.dynCall_viiiidiiijii=function(){return(o.dynCall_viiiidiiijii=o.asm.dynCall_viiiidiiijii).apply(null,arguments)},o.dynCall_vijijiiijii=function(){return(o.dynCall_vijijiiijii=o.asm.dynCall_vijijiiijii).apply(null,arguments)},o.dynCall_viiiiijiiiijjiii=function(){return(o.dynCall_viiiiijiiiijjiii=o.asm.dynCall_viiiiijiiiijjiii).apply(null,arguments)},o.dynCall_viiiiijiiiidiii=function(){return(o.dynCall_viiiiijiiiidiii=o.asm.dynCall_viiiiijiiiidiii).apply(null,arguments)},o.dynCall_viiiiijiiiifiii=function(){return(o.dynCall_viiiiijiiiifiii=o.asm.dynCall_viiiiijiiiifiii).apply(null,arguments)},o.dynCall_viiiiijiiiiiiii=function(){return(o.dynCall_viiiiijiiiiiiii=o.asm.dynCall_viiiiijiiiiiiii).apply(null,arguments)},o.dynCall_viiiiijiiiijiii=function(){return(o.dynCall_viiiiijiiiijiii=o.asm.dynCall_viiiiijiiiijiii).apply(null,arguments)},o.dynCall_iiijii=function(){return(o.dynCall_iiijii=o.asm.dynCall_iiijii).apply(null,arguments)},o.dynCall_viiiji=function(){return(o.dynCall_viiiji=o.asm.dynCall_viiiji).apply(null,arguments)},o.dynCall_viiijjiijjiii=function(){return(o.dynCall_viiijjiijjiii=o.asm.dynCall_viiijjiijjiii).apply(null,arguments)},o.dynCall_jiiiiiiiii=function(){return(o.dynCall_jiiiiiiiii=o.asm.dynCall_jiiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiifi=function(){return(o.dynCall_jiiiiiiifi=o.asm.dynCall_jiiiiiiifi).apply(null,arguments)},o.dynCall_jiiiiiiidi=function(){return(o.dynCall_jiiiiiiidi=o.asm.dynCall_jiiiiiiidi).apply(null,arguments)},o.dynCall_jiiiiiiijji=function(){return(o.dynCall_jiiiiiiijji=o.asm.dynCall_jiiiiiiijji).apply(null,arguments)},o.dynCall_jii=function(){return(o.dynCall_jii=o.asm.dynCall_jii).apply(null,arguments)},o.dynCall_vijiii=function(){return(o.dynCall_vijiii=o.asm.dynCall_vijiii).apply(null,arguments)},o.dynCall_viji=function(){return(o.dynCall_viji=o.asm.dynCall_viji).apply(null,arguments)},o.dynCall_jiji=function(){return(o.dynCall_jiji=o.asm.dynCall_jiji).apply(null,arguments)},o.dynCall_viijii=function(){return(o.dynCall_viijii=o.asm.dynCall_viijii).apply(null,arguments)},o.dynCall_iiiiij=function(){return(o.dynCall_iiiiij=o.asm.dynCall_iiiiij).apply(null,arguments)},o.dynCall_iiiiijj=function(){return(o.dynCall_iiiiijj=o.asm.dynCall_iiiiijj).apply(null,arguments)},o.dynCall_iiiiiijj=function(){return(o.dynCall_iiiiiijj=o.asm.dynCall_iiiiiijj).apply(null,arguments)};function It(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function wt(e){function t(){mt||(mt=!0,o.calledRun=!0,R||(te(),ie(),o.onRuntimeInitialized&&o.onRuntimeInitialized(),ne()))}e=e||l,se>0||(ee(),se>0||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t()))}if(o.ccall=E,o.cwrap=M,o.UTF8ToString=D,le=function e(){mt||wt(),mt||(le=e)},o.run=wt,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();wt(),oe((function(){o.numArrayCoordinates=1,o.xIn=o._malloc(8*o.numArrayCoordinates),o.yIn=o._malloc(8*o.numArrayCoordinates),o.xOut=o._malloc(8*o.numArrayCoordinates),o.yOut=o._malloc(8*o.numArrayCoordinates),o.zIn=o._malloc(8*o.numArrayCoordinates),o.zOut=o._malloc(8*o.numArrayCoordinates),console.log("AST WebAssembly module loaded")})),o.LABEL_EXTERIOR=0,o.LABEL_INTERIOR=1,o.DEFAULT_TOLERANCE=.01,o.DEFAULT_COLOR=2,o.DEFAULT_FONT="20px Arial",o.SYS_ECLIPTIC=0,o.SYS_FK4=1,o.SYS_FK5=2,o.SYS_GALACTIC=3,o.SYS_ICRS=4,o.SYS_J2000=5,o.fonts=["{size} sans-serif","italic {size} sans-serif","bold {size} sans-serif","bold italic {size} sans-serif","{size} times","italic {size} times","bold {size} times","bold italic {size} times","{size} arial","bold {size} arial","italic {size} arial","bold italic {size} arial","{size} palatino","italic {size} palatino","bold {size} palatino","bold italic {size} palatino","{size} courier new","italic {size} courier new","bold {size} courier new","bold italic {size} courier new"],o.colors=["blue","blue","blue","blue","blue","blue","blue","blue","#62D96B"],o.shapes=["\u25a1","\u25e6","+","\u26b9","\u25cb","\u2a09","\u25a1","\u25bd","\u2295","\u25a1","\u25c7","\u2606"],o.setColors=function(e){o.colors=e},o.setColor=function(e,t){o.colors[t]=e},o.setFontList=function(e){o.fonts=e},o.setCanvas=function(e){o.gridContext=e.getContext("2d"),o.gridContext.imageSmoothingEnabled=!1,o.gridContext.scale(1,-1),o.gridContext.translate(0,-e.height),o.gridContext.font=o.font},o.plot=o.cwrap("plotGrid","number",["number","number","number","number","number","number","number","number","number","number","number","string"]),o.emptyFitsChan=o.cwrap("emptyFitsChan","number"),o.putFits=o.cwrap("putFits",null,["number","string"]),o.getFrameFromFitsChan=o.cwrap("getFrameFromFitsChan","number",["number","number"]),o.getSpectralFrame=o.cwrap("getSpectralFrame","number",["number"]),o.getSkyFrameSet=o.cwrap("getSkyFrameSet","number",["number"]),o.initDummyFrame=o.cwrap("initDummyFrame","number",[]),o.set=o.cwrap("set","number",["number","string"]),o.clear=o.cwrap("clear","number",["number","string"]),o.getString=o.cwrap("getString","string",["number","string"]),o.dump=o.cwrap("dump",null,["number"]),o.norm=o.cwrap("norm","number",["number","number"]),o.axDistance=o.cwrap("axDistance","number",["number","number","number","number"]),o.geodesicDistance=o.cwrap("geodesicDistance","number",["number","number","number","number","number"]),o.format=o.cwrap("format","string",["number","number","number"]),o.unformat=o.cwrap("unformat","number",["number","number","string","number"]),o.transform=o.cwrap("transform","number",["number","number","number","number","number","number","number"]),o.transform3D=o.cwrap("transform3D","number",["number","number","number","number","number","number"]),o.spectralTransform=o.cwrap("spectralTransform","number",["number","string","string","string","number","number","number","number"]),o.getLastErrorMessage=o.cwrap("getLastErrorMessage","string"),o.clearLastErrorMessage=o.cwrap("clearLastErrorMessage",null),o.copy=o.cwrap("copy",null,["number"]),o.deleteObject=o.cwrap("deleteObject",null,["number"]),o.invert=o.cwrap("invert","number",["number"]),o.convert=o.cwrap("convert","number",["number","number","string"]),o.shiftMap2D=o.cwrap("shiftMap2D","number",["number","number"]),o.scaleMap2D=o.cwrap("scaleMap2D","number",["number","number"]),o.frame=o.cwrap("frame","number",["number","string"]),o.addFrame=o.cwrap("addFrame",null,["number","number","number","number"]),o.setI=o.cwrap("setI",null,["number","string","number"]),o.setD=o.cwrap("setD",null,["number","string","number"]),o.createTransformedFrameset=o.cwrap("createTransformedFrameset","number",["number","number","number","number","number","number","number","number"]),o.fillTransformGrid=o.cwrap("fillTransformGrid","number",["number","number","number","number","number","number","number","number"]),o.currentFormatStrings=[],o.getFormattedCoordinates=function(e,t,i,n,r){var s,a,l;return r?(s=o.currentFormatStrings[e],o.set(e,n)):n&&o.currentFormatStrings[e]!==n&&(o.set(e,n),o.currentFormatStrings[e]=n),void 0!==t&&(a=o.format(e,1,t)),void 0!==i&&(l=o.format(e,2,i)),r&&o.set(e,s),{x:a,y:l}},o.getWCSValueFromFormattedString=function(e,t){o.unformat(e,1,t.x,o.xOut),o.unformat(e,2,t.y,o.yOut);var i=new Float64Array(o.HEAPF64.buffer,o.xOut,1),n=new Float64Array(o.HEAPF64.buffer,o.yOut,1);return{x:i[0],y:n[0]}},o.transformPointArrays=function(e,t,i,n){if(void 0===n&&(n=!0),!(t instanceof Float64Array)||!(i instanceof Float64Array)||t.length!==i.length)return{x:new Float64Array(1),y:new Float64Array(1)};var r=t.length,s=o._malloc(8*r),a=o._malloc(8*r),l=o._malloc(8*r),c=o._malloc(8*r);o.HEAPF64.set(t,s/8),o.HEAPF64.set(i,a/8),o.transform(e,r,s,a,n,l,c);var d=new Float64Array(o.HEAPF64.buffer,l,r),p=new Float64Array(o.HEAPF64.buffer,c,r),h={x:d.slice(0),y:p.slice(0)};return o._free(s),o._free(a),o._free(l),o._free(c),h},o.transformPoint=function(e,t,i,n){void 0===n&&(n=!0);o.HEAPF64.set(new Float64Array([t]),o.xIn/8),o.HEAPF64.set(new Float64Array([i]),o.yIn/8),o.transform(e,1,o.xIn,o.yIn,n,o.xOut,o.yOut);var r=new Float64Array(o.HEAPF64.buffer,o.xOut,1),s=new Float64Array(o.HEAPF64.buffer,o.yOut,1);return{x:r[0],y:s[0]}},o.transform3DPoint=function(e,t,i,n,r){void 0===r&&(r=!0);var s=o._malloc(24);o.transform3D(e,t,i,n,r,s);var a=new Float64Array(o.HEAPF64.buffer,s,3),l={x:a[0],y:a[1],z:a[2]};return o._free(s),l},o.transformSpectralPoint=function(e,t,i,n,r,s){void 0===s&&(s=!0);return o.HEAPF64.set(new Float64Array([r]),o.zIn/8),o.spectralTransform(e,t,i,n,1,o.zIn,s,o.zOut),new Float64Array(o.HEAPF64.buffer,o.zOut,1)[0]},o.transformSpectralPointArray=function(e,t,i,n,r,s){void 0===s&&(s=!0);var a=null===r||void 0===r?void 0:r.length;if(!a)return new Float64Array([]);var l=o._malloc(8*a),c=o._malloc(8*a);o.HEAPF64.set(r,l/8),o.spectralTransform(e,t,i,n,a,l,s,c);var d=new Float64Array(o.HEAPF64.buffer,c,a).slice(0);return o._free(l),o._free(c),d},o.normalizeCoordinates=function(e,t,i){o.HEAPF64.set(new Float64Array([t,i]),o.xIn/8),o.norm(e,o.xIn);var n=new Float64Array(o.HEAPF64.buffer,o.xIn,2);return{x:n[0],y:n[1]}},o.getTransformGrid=function(e,t,i,n,r,s,a,l){var c=o.fillTransformGrid(e,t,i,n,r,s,a,l);if(c){var d=new Float32Array(o.HEAPF32.buffer,c,n*a*2).slice();return o._free(c),d}return null},o.onReady=new Promise((function(e){if(o.calledRun)e(o);else{var t=o.onRuntimeInitialized;o.onRuntimeInitialized=function(){t&&t(),e(o)}}})),e.exports=o}).call(this,i(39),"/",i(46).Buffer)},1001:function(e,t,i){},1002:function(e,t,i){},1003:function(e,t,i){},1004:function(e,t,i){},1005:function(e,t,i){},1006:function(e,t,i){},1007:function(e,t,i){},1008:function(e,t,i){},1009:function(e,t,i){},1010:function(e,t,i){},1011:function(e,t,i){},1012:function(e,t,i){},1013:function(e,t,i){},1014:function(e,t,i){},1015:function(e,t,i){},1016:function(e,t,i){},1017:function(e,t,i){},1018:function(e,t,i){},1021:function(e,t,i){},1022:function(e,t,i){},1023:function(e,t,i){},1024:function(e,t,i){},1025:function(e,t,i){},1026:function(e,t,i){},1027:function(e,t,i){},1028:function(e,t,i){"use strict";i.r(t);var n=i(4),r=i.n(n),o=i(33),s=i(53),a=i.n(s),l=i(1043),c=i(7),d=i.n(c),p=i(8),h=i(28),u=i(80),g=i(93),f=i(3),b=i(2),m=(i(17),i(1)),y=i(37),O=i(270),j=i(460),x=i(143),S=i.n(x);const v=u.V.create({className:"app-toaster",position:y.a.BOTTOM});function C(e,t,i){return{icon:e,intent:"success",message:t,timeout:i||0===i?i:3e3}}function I(e){return{icon:"error",intent:"danger",message:e,timeout:3e4,action:{onClick:()=>{var t;return null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e)},icon:"clipboard"}}}function w(e){return{icon:"warning-sign",intent:"warning",message:e,timeout:3e4,action:{onClick:()=>{var t;return null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e)},icon:"clipboard"}}}var T=i(22),R=i(194),A=i(1038);function P(e,t){if(!e||0===e.length||null===t||void 0===t||!isFinite(t))return null;const i=e.length,n=e[0].x<=e[i-1].x;if(n){if(t<=e[0].x)return{point:e[0],index:0};if(t>=e[i-1].x)return{point:e[i-1],index:i-1}}else{if(t>=e[0].x)return{point:e[0],index:0};if(t<=e[i-1].x)return{point:e[i-1],index:i-1}}let r=0,o=i-1;for(;r<=o;){let i=Math.floor((r+o)/2);if(t===e[i].x)return{point:e[i],index:i};n?t<e[i].x?o=i-1:r=i+1:t>e[i].x?o=i-1:r=i+1}if(r>=e.length||r<0||o>=e.length||o<0)return null;const s=Math.abs(e[r].x-t)<Math.abs(t-e[o].x)?r:o;return{point:e[s],index:s}}const E=(e,t,i)=>i.indexOf(e)===t;var M,F,k,D=i.p+"static/media/allmaps.ac43eb19.png",L=i(385);let N=(k=F=class e{constructor(e){this.frame=void 0,this.overlayStore=void 0,Object(m.p)(this),this.frame=e,this.overlayStore=bA.Instance}get roundedNumbers(){var t,i,n,r;const o=null===(t=this.frame)||void 0===t||null===(i=t.renderConfig)||void 0===i?void 0:i.scaleMinVal,s=null===(n=this.frame)||void 0===n||null===(r=n.renderConfig)||void 0===r?void 0:r.scaleMaxVal,a=this.overlayStore.colorbar.tickNum;if(!isFinite(o)||!isFinite(s)||o>=s||!a)return null;{let t=(s-o)/a,i=-e.GetPrecision(t),n=Math.pow(10,i);t=Math.round(t*n)/n,i=-e.GetPrecision(t),n=Math.pow(10,i);const r=Math.round(o*n)/n;let l=[],c=r>o?r:Math.round((r+t)*n)/n;for(;c<s;)l.push(c),c=Math.round((c+t)*n)/n;return{numbers:l,precision:i}}}get texts(){if(!this.roundedNumbers)return[];const t=this.roundedNumbers.numbers.map((t=>e.GetOrder(t))),i=Math.max(...t),n=Math.min(...t),r=this.overlayStore.colorbar,o=r.numberCustomPrecision?r.numberPrecision:this.roundedNumbers.precision;return i>5||n<-5?this.roundedNumbers.numbers.map((t=>t.toExponential(Gi(r.numberCustomPrecision?o:0===t?0:o+e.GetPrecision(t),0,e.PRECISION_MAX)))):this.roundedNumbers.numbers.map((t=>t.toFixed(Gi(o,0,e.PRECISION_MAX))))}get positions(){var e,t,i,n;const r=this.overlayStore.colorbar;if(!this.roundedNumbers||!this.frame||!isFinite(r.yOffset))return[];const o=null===(e=this.frame)||void 0===e||null===(t=e.renderConfig)||void 0===t?void 0:t.scaleMinVal,s=null===(i=this.frame)||void 0===i||null===(n=i.renderConfig)||void 0===n?void 0:n.scaleMaxVal;return"right"===r.position?this.roundedNumbers.numbers.map((e=>r.yOffset+r.height*(s-e)/(s-o))):this.roundedNumbers.numbers.map((e=>r.yOffset+r.height*(e-o)/(s-o)))}},F.PRECISION_MAX=15,F.GetOrder=e=>0===e?0:Math.log10(Math.abs(e)),F.GetPrecision=e=>Math.floor(F.GetOrder(e)),M=k,Object(b.a)(M.prototype,"roundedNumbers",[m.i],Object.getOwnPropertyDescriptor(M.prototype,"roundedNumbers"),M.prototype),Object(b.a)(M.prototype,"texts",[m.i],Object.getOwnPropertyDescriptor(M.prototype,"texts"),M.prototype),Object(b.a)(M.prototype,"positions",[m.i],Object.getOwnPropertyDescriptor(M.prototype,"positions"),M.prototype),M);var _,z,V,W,G,B,q,H,Y,U,X=i(60);let $=(U=Y=class{get hasValidData(){return!!this.vertexData&&this.vertexData.length>0}get isComplete(){return this.progress>=1}constructor(){Object(f.a)(this,"progress",z,this),Object(f.a)(this,"numGeneratedVertices",V,this),Object(f.a)(this,"vertexCount",W,this),Object(f.a)(this,"chunkCount",G,this),this.indexOffsets=void 0,this.vertexData=void 0,this.vertexBuffers=void 0,this.gl=void 0,Object(f.a)(this,"setContourData",B,this),Object(f.a)(this,"addContourData",q,this),Object(f.a)(this,"clearData",H,this),Object(m.p)(this),this.gl=xx.Instance.gl}generateBuffers(e){this.vertexBuffers||(this.vertexBuffers=[]),this.gl&&this.vertexBuffers.length===e?(this.vertexBuffers.push(this.gl.createBuffer()),this.gl.bindBuffer(vm.ARRAY_BUFFER,this.vertexBuffers[e]),this.gl.bufferData(vm.ARRAY_BUFFER,this.vertexData[e],vm.STATIC_DRAW),this.vertexData[e]=null):console.log("WebGL buffer index is incorrect!")}bindBuffer(e){!this.vertexBuffers||e>=this.vertexBuffers.length?console.log("WebGL buffer missing"):this.gl.bindBuffer(vm.ARRAY_BUFFER,this.vertexBuffers[e])}},Y.VertexDataElements=8,_=U,z=Object(b.a)(_.prototype,"progress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(b.a)(_.prototype,"numGeneratedVertices",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=Object(b.a)(_.prototype,"vertexCount",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G=Object(b.a)(_.prototype,"chunkCount",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(b.a)(_.prototype,"isComplete",[m.i],Object.getOwnPropertyDescriptor(_.prototype,"isComplete"),_.prototype),B=Object(b.a)(_.prototype,"setContourData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.clearData(),this.addContourData(e,t,i)}}}),q=Object(b.a)(_.prototype,"addContourData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{const n=t.length/2;if(!n)return;this.vertexData||(this.vertexData=[]),this.indexOffsets||(this.indexOffsets=[]),this.numGeneratedVertices||(this.numGeneratedVertices=[]);const r=X.GenerateVertexData(t,e);this.vertexData.push(r),this.indexOffsets.push(e),this.progress=i,this.numGeneratedVertices.push(r.length/($.VertexDataElements/2));const o=this.vertexData.length-1;this.generateBuffers(o),this.vertexCount+=n,this.chunkCount++}}}),H=Object(b.a)(_.prototype,"clearData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.indexOffsets=[],this.vertexData=[],this.numGeneratedVertices=[],this.vertexCount=0,this.chunkCount=0,this.gl&&this.vertexBuffers){const e=this.vertexBuffers.length;for(let t=0;t<e;t++)this.gl.deleteBuffer(this.vertexBuffers[t]);this.vertexBuffers=[]}}}}),_);var K,Q,Z,J,ee,te,ie,ne,re,oe,se,ae,le,ce,de,pe,he,ue,ge,fe,be,me,ye,Oe=i(34),je=i.n(Oe);let xe,Se;!function(e){e.StartStepMultiplier="start-step-multiplier",e.MinMaxNScaling="min-max-scaling",e.PercentagesRefValue="percentages-ref.value",e.MeanSigmaList="mean-sigma-list"}(xe||(xe={})),function(e){e[e.None=0]="None",e[e.Dashed=1]="Dashed",e[e.NegativeOnly=2]="NegativeOnly"}(Se||(Se={}));let ve=(K=class{constructor(e){Object(f.a)(this,"enabled",Q,this),Object(f.a)(this,"levels",Z,this),Object(f.a)(this,"smoothingMode",J,this),Object(f.a)(this,"smoothingFactor",ee,this),Object(f.a)(this,"color",te,this),Object(f.a)(this,"colormapEnabled",ie,this),Object(f.a)(this,"colormap",ne,this),Object(f.a)(this,"colormapContrast",re,this),Object(f.a)(this,"colormapBias",oe,this),Object(f.a)(this,"dashMode",se,this),Object(f.a)(this,"thickness",ae,this),Object(f.a)(this,"visible",le,this),this.preferenceStore=void 0,Object(f.a)(this,"setContourConfiguration",ce,this),Object(f.a)(this,"setColor",de,this),Object(f.a)(this,"setDashMode",pe,this),Object(f.a)(this,"setThickness",he,this),Object(f.a)(this,"setColormap",ue,this),Object(f.a)(this,"setColormapEnabled",ge,this),Object(f.a)(this,"setColormapBias",fe,this),Object(f.a)(this,"setColormapContrast",be,this),Object(f.a)(this,"setVisible",me,this),Object(f.a)(this,"toggleVisibility",ye,this),Object(m.p)(this),this.preferenceStore=e,this.enabled=!1,this.levels=[],this.smoothingMode=this.preferenceStore.contourSmoothingMode,this.smoothingFactor=this.preferenceStore.contourSmoothingFactor,this.color=je()(this.preferenceStore.contourColor).toRgb(),this.colormapEnabled=this.preferenceStore.contourColormapEnabled,this.colormap=this.preferenceStore.contourColormap,this.colormapBias=0,this.colormapContrast=1,this.thickness=this.preferenceStore.contourThickness,this.dashMode=Se.NegativeOnly,this.visible=!0}setEnabled(e){this.enabled=e}},Q=Object(b.a)(K.prototype,"enabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(b.a)(K.prototype,"levels",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(b.a)(K.prototype,"smoothingMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Object(b.a)(K.prototype,"smoothingFactor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Object(b.a)(K.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Object(b.a)(K.prototype,"colormapEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(b.a)(K.prototype,"colormap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(b.a)(K.prototype,"colormapContrast",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oe=Object(b.a)(K.prototype,"colormapBias",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=Object(b.a)(K.prototype,"dashMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=Object(b.a)(K.prototype,"thickness",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),le=Object(b.a)(K.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(K.prototype,"setEnabled",[m.g],Object.getOwnPropertyDescriptor(K.prototype,"setEnabled"),K.prototype),ce=Object(b.a)(K.prototype,"setContourConfiguration",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.levels=e,this.smoothingMode=t,this.smoothingFactor=i}}}),de=Object(b.a)(K.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=je()(e);t.isValid()&&(this.color=t.toRgb())}}}),pe=Object(b.a)(K.prototype,"setDashMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dashMode=e}}}),he=Object(b.a)(K.prototype,"setThickness",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.thickness=e}}}),ue=Object(b.a)(K.prototype,"setColormap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormap=e}}}),ge=Object(b.a)(K.prototype,"setColormapEnabled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapEnabled=e}}}),fe=Object(b.a)(K.prototype,"setColormapBias",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapBias=e}}}),be=Object(b.a)(K.prototype,"setColormapContrast",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapContrast=e}}}),me=Object(b.a)(K.prototype,"setVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),ye=Object(b.a)(K.prototype,"toggleVisibility",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),K);var Ce,Ie,we,Te,Re,Ae,Pe,Ee;let Me=(Ce=class{constructor(e){Object(f.a)(this,"progress",Ie,this),Object(f.a)(this,"tiles",we,this),Object(f.a)(this,"intensityMin",Te,this),Object(f.a)(this,"intensityMax",Re,this),this.gl=void 0,this.frame=void 0,Object(f.a)(this,"clearData",Ae,this),Object(f.a)(this,"setData",Pe,this),Object(f.a)(this,"addData",Ee,this),Object(m.p)(this),this.gl=Sx.Instance.gl,this.frame=e,this.intensityMin=void 0,this.intensityMax=void 0}get isComplete(){return this.progress>=1}},Ie=Object(b.a)(Ce.prototype,"progress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),we=Object(b.a)(Ce.prototype,"tiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Te=Object(b.a)(Ce.prototype,"intensityMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Object(b.a)(Ce.prototype,"intensityMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Ce.prototype,"isComplete",[m.i],Object.getOwnPropertyDescriptor(Ce.prototype,"isComplete"),Ce.prototype),Ae=Object(b.a)(Ce.prototype,"clearData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.gl&&this.tiles)for(const e of this.tiles)e.texture&&(this.gl.deleteTexture(e.texture),e.texture=void 0);this.tiles=[],this.intensityMin=void 0,this.intensityMax=void 0}}}),Pe=Object(b.a)(Ce.prototype,"setData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.clearData(),this.addData(e,t,i)}}}),Ee=Object(b.a)(Ce.prototype,"addData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.progress=i;let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;const o=Math.max(e.length,t.length);for(let V=0;V<o;V++){var s,a,l,c,d,p,h,u,g,f,b,m,y,O,j,x,S,v,C,I,w,T,R,A,P,E,M,F,k,D,L,N,_,z;let i=null===e||void 0===e?void 0:e[V],o=null===t||void 0===t?void 0:t[V];if((null===(s=i)||void 0===s||null===(a=s.imageData)||void 0===a?void 0:a.length)||(i=void 0),(null===(l=o)||void 0===l||null===(c=l.imageData)||void 0===c?void 0:c.length)||(o=void 0),!i&&!o)continue;if(!qi(null===(d=i)||void 0===d?void 0:d.width,null===(p=o)||void 0===p?void 0:p.width)||!qi(null===(h=i)||void 0===h?void 0:h.height,null===(u=o)||void 0===u?void 0:u.height))continue;if(!qi(null===(g=i)||void 0===g?void 0:g.mip,null===(f=o)||void 0===f?void 0:f.mip)||!qi(null===(b=i)||void 0===b?void 0:b.x,null===(m=o)||void 0===m?void 0:m.x)||!qi(null===(y=i)||void 0===y?void 0:y.y,null===(O=o)||void 0===O?void 0:O.y))continue;const W=Math.max(null!==(j=null===(x=i)||void 0===x?void 0:x.width)&&void 0!==j?j:0,null!==(S=null===(v=o)||void 0===v?void 0:v.width)&&void 0!==S?S:0),G=Math.max(null!==(C=null===(I=i)||void 0===I?void 0:I.height)&&void 0!==C?C:0,null!==(w=null===(T=o)||void 0===T?void 0:T.height)&&void 0!==w?w:0),B=null!==(R=null===(A=i)||void 0===A?void 0:A.mip)&&void 0!==R?R:null===(P=o)||void 0===P?void 0:P.mip,q=null!==(E=null===(M=i)||void 0===M?void 0:M.x)&&void 0!==E?E:null===(F=o)||void 0===F?void 0:F.x,H=null!==(k=null===(D=i)||void 0===D?void 0:D.y)&&void 0!==k?k:null===(L=o)||void 0===L?void 0:L.y;let Y,U;Y=(null===(N=i)||void 0===N?void 0:N.imageData)?new Float32Array(i.imageData.buffer.slice(i.imageData.byteOffset,i.imageData.byteOffset+i.imageData.byteLength)):new Float32Array(W*G*4),U=(null===(_=o)||void 0===_||null===(z=_.imageData)||void 0===z?void 0:z.length)?new Float32Array(o.imageData.buffer.slice(o.imageData.byteOffset,o.imageData.byteOffset+o.imageData.byteLength)):new Float32Array(W*G*4);let X=new Float32Array(W*G*4),$=0,K=B*(256*q+.5)-.5,Q=B*(256*H+.5)-.5;for(let e=0;e<G;e++)for(let t=0;t<W;t++){const i=t+W*e,o=Y[i],s=U[i];isFinite(o)&&isFinite(s)&&(X[4*$]=t*B+K,X[4*$+1]=e*B+Q,X[4*$+2]=o,X[4*$+3]=s,$++,n=Math.min(n,o),r=Math.max(r,o))}X=new Float32Array(X.buffer,0,4*$);const Z=Am(this.gl,X,WebGLRenderingContext.TEXTURE0,4);this.tiles||(this.tiles=[]),this.tiles.push({texture:Z,numVertices:$})}this.intensityMin=isFinite(this.intensityMin)?Math.min(this.intensityMin,n):n,this.intensityMax=isFinite(this.intensityMax)?Math.max(this.intensityMax,r):r}}}),Ce);var Fe,ke,De,Le,Ne,_e,ze,Ve,We,Ge,Be,qe,He,Ye,Ue,Xe,$e,Ke,Qe,Ze,Je,et,tt,it,nt,rt,ot,st,at,lt,ct,dt,pt,ht,ut,gt,ft,bt;let mt;!function(e){e[e.None=-1]="None",e[e.Current=0]="Current",e[e.Computed=1]="Computed"}(mt||(mt={}));let yt=(bt=ft=class e{constructor(t,i){Object(f.a)(this,"enabled",ke,this),Object(f.a)(this,"angularSource",De,this),Object(f.a)(this,"intensitySource",Le,this),Object(f.a)(this,"fractionalIntensity",Ne,this),Object(f.a)(this,"pixelAveragingEnabled",_e,this),Object(f.a)(this,"pixelAveraging",ze,this),Object(f.a)(this,"thresholdEnabled",Ve,this),Object(f.a)(this,"threshold",We,this),Object(f.a)(this,"debiasing",Ge,this),Object(f.a)(this,"qError",Be,this),Object(f.a)(this,"uError",qe,this),Object(f.a)(this,"visible",He,this),Object(f.a)(this,"thickness",Ye,this),Object(f.a)(this,"colormapEnabled",Ue,this),Object(f.a)(this,"color",Xe,this),Object(f.a)(this,"colormap",$e,this),Object(f.a)(this,"colormapContrast",Ke,this),Object(f.a)(this,"colormapBias",Qe,this),Object(f.a)(this,"lengthMin",Ze,this),Object(f.a)(this,"lengthMax",Je,this),Object(f.a)(this,"intensityMin",et,this),Object(f.a)(this,"intensityMax",tt,this),Object(f.a)(this,"rotationOffset",it,this),this.preferenceStore=void 0,Object(f.a)(this,"setVectorOverlayConfiguration",nt,this),Object(f.a)(this,"setColor",rt,this),Object(f.a)(this,"setThickness",ot,this),Object(f.a)(this,"setColormap",st,this),Object(f.a)(this,"setColormapEnabled",at,this),Object(f.a)(this,"setColormapBias",lt,this),Object(f.a)(this,"setColormapContrast",ct,this),Object(f.a)(this,"setLengthRange",dt,this),Object(f.a)(this,"setIntensityRange",pt,this),Object(f.a)(this,"setRotationOffset",ht,this),Object(f.a)(this,"setVisible",ut,this),Object(f.a)(this,"toggleVisibility",gt,this),Object(m.p)(this),this.preferenceStore=t,this.enabled=!1,this.angularSource=i.hasLinearStokes?mt.Computed:mt.Current,this.intensitySource=i.hasLinearStokes?mt.Computed:mt.Current,this.fractionalIntensity=this.preferenceStore.vectorOverlayFractionalIntensity,this.pixelAveraging=this.preferenceStore.vectorOverlayPixelAveraging,this.pixelAveragingEnabled=this.preferenceStore.vectorOverlayPixelAveraging>0,this.threshold=0,this.thresholdEnabled=!1,this.debiasing=!1,this.color=je()(this.preferenceStore.vectorOverlayColor).toRgb(),this.colormapEnabled=this.preferenceStore.vectorOverlayColormapEnabled,this.colormap=this.preferenceStore.vectorOverlayColormap,this.colormapBias=0,this.colormapContrast=1,this.thickness=this.preferenceStore.vectorOverlayThickness,this.lengthMin=e.DefaultLengthMin,this.lengthMax=e.DefaultLengthMax,this.intensityMin=void 0,this.intensityMax=void 0,this.rotationOffset=0,this.visible=!0}setEnabled(e){this.enabled=e}setThresholdEnabled(e){this.thresholdEnabled=e}},ft.DefaultLengthMin=0,ft.DefaultLengthMax=20,Fe=bt,ke=Object(b.a)(Fe.prototype,"enabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=Object(b.a)(Fe.prototype,"angularSource",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Object(b.a)(Fe.prototype,"intensitySource",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ne=Object(b.a)(Fe.prototype,"fractionalIntensity",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(b.a)(Fe.prototype,"pixelAveragingEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Object(b.a)(Fe.prototype,"pixelAveraging",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Object(b.a)(Fe.prototype,"thresholdEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=Object(b.a)(Fe.prototype,"threshold",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=Object(b.a)(Fe.prototype,"debiasing",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=Object(b.a)(Fe.prototype,"qError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qe=Object(b.a)(Fe.prototype,"uError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=Object(b.a)(Fe.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye=Object(b.a)(Fe.prototype,"thickness",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue=Object(b.a)(Fe.prototype,"colormapEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Object(b.a)(Fe.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Object(b.a)(Fe.prototype,"colormap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=Object(b.a)(Fe.prototype,"colormapContrast",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qe=Object(b.a)(Fe.prototype,"colormapBias",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ze=Object(b.a)(Fe.prototype,"lengthMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Object(b.a)(Fe.prototype,"lengthMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=Object(b.a)(Fe.prototype,"intensityMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt=Object(b.a)(Fe.prototype,"intensityMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=Object(b.a)(Fe.prototype,"rotationOffset",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Fe.prototype,"setEnabled",[m.g],Object.getOwnPropertyDescriptor(Fe.prototype,"setEnabled"),Fe.prototype),Object(b.a)(Fe.prototype,"setThresholdEnabled",[m.g],Object.getOwnPropertyDescriptor(Fe.prototype,"setThresholdEnabled"),Fe.prototype),nt=Object(b.a)(Fe.prototype,"setVectorOverlayConfiguration",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n,r,o,s,a,l,c)=>{this.angularSource=e,this.intensitySource=t,this.pixelAveragingEnabled=i,this.pixelAveraging=n,this.fractionalIntensity=r,this.thresholdEnabled=o,this.threshold=s,this.debiasing=a,this.qError=l,this.uError=c}}}),rt=Object(b.a)(Fe.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=je()(e);t.isValid()&&(this.color=t.toRgb())}}}),ot=Object(b.a)(Fe.prototype,"setThickness",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.thickness=e}}}),st=Object(b.a)(Fe.prototype,"setColormap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormap=e}}}),at=Object(b.a)(Fe.prototype,"setColormapEnabled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapEnabled=e}}}),lt=Object(b.a)(Fe.prototype,"setColormapBias",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapBias=e}}}),ct=Object(b.a)(Fe.prototype,"setColormapContrast",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapContrast=e}}}),dt=Object(b.a)(Fe.prototype,"setLengthRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.lengthMin=e,this.lengthMax=t}}}),pt=Object(b.a)(Fe.prototype,"setIntensityRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.intensityMin=e,this.intensityMax=t}}}),ht=Object(b.a)(Fe.prototype,"setRotationOffset",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.rotationOffset=e}}}),ut=Object(b.a)(Fe.prototype,"setVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),gt=Object(b.a)(Fe.prototype,"toggleVisibility",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),Fe);var Ot,jt,xt,St,vt,Ct,It,wt,Tt,Rt,At,Pt=i(10);let Et=(At=Rt=class e{constructor(){this.start=void 0,this.finish=void 0,Object(f.a)(this,"transformedStart",jt,this),Object(f.a)(this,"transformedFinish",xt,this),Object(f.a)(this,"isCreating",St,this),Object(f.a)(this,"color",vt,this),Object(f.a)(this,"setIsCreating",Ct,this),Object(f.a)(this,"updateTransformedPos",It,this),Object(f.a)(this,"resetPos",wt,this),Object(f.a)(this,"setColor",Tt,this),Object(m.p)(this),this.transformedStart={x:null,y:null},this.transformedFinish={x:null,y:null},this.isCreating=!1,this.color=e.DEFAULT_COLOR}get showCurve(){return null!=this.transformedStart.x&&null!=this.transformedStart.y&&null!=this.transformedFinish.x&&null!=this.transformedFinish.y&&gC.Instance.activeLayer===_G.DistanceMeasuring}get styleString(){let t=new oA;return t.add("Color(Curve)",JR.DISTANCE_MEASURE),t.add("Width(Curve)",e.DEFAULT_WIDTH*gC.Instance.imageRatio),t.add("Color(Strings)",JR.DISTANCE_MEASURE),t.add("Size(Strings)",e.DEFAULT_FONTSIZE*gC.Instance.imageRatio),t.toString()}},Rt.DEFAULT_WIDTH=1.5,Rt.DEFAULT_FONTSIZE=14,Rt.DEFAULT_COLOR="#62D96B",Ot=At,jt=Object(b.a)(Ot.prototype,"transformedStart",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Object(b.a)(Ot.prototype,"transformedFinish",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=Object(b.a)(Ot.prototype,"isCreating",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Object(b.a)(Ot.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Ot.prototype,"showCurve",[m.i],Object.getOwnPropertyDescriptor(Ot.prototype,"showCurve"),Ot.prototype),Object(b.a)(Ot.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(Ot.prototype,"styleString"),Ot.prototype),Ct=Object(b.a)(Ot.prototype,"setIsCreating",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isCreating=e}}}),It=Object(b.a)(Ot.prototype,"updateTransformedPos",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t,i,n,r;null!=(null===(t=this.start)||void 0===t?void 0:t.x)&&null!=(null===(i=this.start)||void 0===i?void 0:i.y)&&null!=(null===(n=this.finish)||void 0===n?void 0:n.x)&&null!=(null===(r=this.finish)||void 0===r?void 0:r.y)&&(this.transformedStart=e?e.transformCoordinate(this.start):this.start,this.transformedFinish=e?e.transformCoordinate(this.finish):this.finish)}}}),wt=Object(b.a)(Ot.prototype,"resetPos",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.start={x:null,y:null},this.finish={x:null,y:null},this.transformedStart={x:null,y:null},this.transformedFinish={x:null,y:null},this.isCreating=!1}}}),Tt=Object(b.a)(Ot.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.DISTANCE_MEASURE)}}}),Ot);var Mt=i(14);const Ft=Mt.Reader,kt=Mt.Writer,Dt=Mt.util,Lt=Mt.roots.default||(Mt.roots.default={}),Nt=Lt.CARTA=(()=>{const e={};return e.Point=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.x=0,e.prototype.y=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(13).float(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(21).float(e.y),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.Point;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.x=e.float();break;case 2:n.y=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!==typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!==typeof e.y?"y: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.Point)return e;let t=new Lt.CARTA.Point;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.x=0,i.y=0),null!=e.x&&e.hasOwnProperty("x")&&(i.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=t.json&&!isFinite(e.y)?String(e.y):e.y),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.DoublePoint=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.x=0,e.prototype.y=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(9).double(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(17).double(e.y),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.DoublePoint;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.x=e.double();break;case 2:n.y=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!==typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!==typeof e.y?"y: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.DoublePoint)return e;let t=new Lt.CARTA.DoublePoint;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.x=0,i.y=0),null!=e.x&&e.hasOwnProperty("x")&&(i.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=t.json&&!isFinite(e.y)?String(e.y):e.y),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FileInfo=function(){function e(e){if(this.HDUList=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.type=0,e.prototype.size=Dt.Long?Dt.Long.fromBits(0,0,!1):0,e.prototype.HDUList=Dt.emptyArray,e.prototype.date=Dt.Long?Dt.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(25).sfixed64(e.size),null!=e.HDUList&&e.HDUList.length)for(let i=0;i<e.HDUList.length;++i)t.uint32(34).string(e.HDUList[i]);return null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(41).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FileInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.type=e.int32();break;case 3:n.size=e.sfixed64();break;case 4:n.HDUList&&n.HDUList.length||(n.HDUList=[]),n.HDUList.push(e.string());break;case 5:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.size&&e.hasOwnProperty("size")&&!Dt.isInteger(e.size)&&!(e.size&&Dt.isInteger(e.size.low)&&Dt.isInteger(e.size.high)))return"size: integer|Long expected";if(null!=e.HDUList&&e.hasOwnProperty("HDUList")){if(!Array.isArray(e.HDUList))return"HDUList: array expected";for(let t=0;t<e.HDUList.length;++t)if(!Dt.isString(e.HDUList[t]))return"HDUList: string[] expected"}return null==e.date||!e.hasOwnProperty("date")||Dt.isInteger(e.date)||e.date&&Dt.isInteger(e.date.low)&&Dt.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof Lt.CARTA.FileInfo)return e;let t=new Lt.CARTA.FileInfo;switch(null!=e.name&&(t.name=String(e.name)),e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}if(null!=e.size&&(Dt.Long?(t.size=Dt.Long.fromValue(e.size)).unsigned=!1:"string"===typeof e.size?t.size=parseInt(e.size,10):"number"===typeof e.size?t.size=e.size:"object"===typeof e.size&&(t.size=new Dt.LongBits(e.size.low>>>0,e.size.high>>>0).toNumber())),e.HDUList){if(!Array.isArray(e.HDUList))throw TypeError(".CARTA.FileInfo.HDUList: array expected");t.HDUList=[];for(let i=0;i<e.HDUList.length;++i)t.HDUList[i]=String(e.HDUList[i])}return null!=e.date&&(Dt.Long?(t.date=Dt.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new Dt.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.HDUList=[]),t.defaults){if(i.name="",i.type=t.enums===String?"CASA":0,Dt.Long){let e=new Dt.Long(0,0,!1);i.size=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.size=t.longs===String?"0":0;if(Dt.Long){let e=new Dt.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0}if(null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?Lt.CARTA.FileType[e.type]:e.type),null!=e.size&&e.hasOwnProperty("size")&&("number"===typeof e.size?i.size=t.longs===String?String(e.size):e.size:i.size=t.longs===String?Dt.Long.prototype.toString.call(e.size):t.longs===Number?new Dt.LongBits(e.size.low>>>0,e.size.high>>>0).toNumber():e.size),e.HDUList&&e.HDUList.length){i.HDUList=[];for(let t=0;t<e.HDUList.length;++t)i.HDUList[t]=e.HDUList[t]}return null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?Dt.Long.prototype.toString.call(e.date):t.longs===Number?new Dt.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.DirectoryInfo=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.itemCount=0,e.prototype.date=Dt.Long?Dt.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.itemCount&&Object.hasOwnProperty.call(e,"itemCount")&&t.uint32(21).sfixed32(e.itemCount),null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(25).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.DirectoryInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.itemCount=e.sfixed32();break;case 3:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name)?"name: string expected":null!=e.itemCount&&e.hasOwnProperty("itemCount")&&!Dt.isInteger(e.itemCount)?"itemCount: integer expected":null==e.date||!e.hasOwnProperty("date")||Dt.isInteger(e.date)||e.date&&Dt.isInteger(e.date.low)&&Dt.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof Lt.CARTA.DirectoryInfo)return e;let t=new Lt.CARTA.DirectoryInfo;return null!=e.name&&(t.name=String(e.name)),null!=e.itemCount&&(t.itemCount=0|e.itemCount),null!=e.date&&(Dt.Long?(t.date=Dt.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new Dt.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if(t.defaults)if(i.name="",i.itemCount=0,Dt.Long){let e=new Dt.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0;return null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.itemCount&&e.hasOwnProperty("itemCount")&&(i.itemCount=e.itemCount),null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?Dt.Long.prototype.toString.call(e.date):t.longs===Number?new Dt.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FileInfoExtended=function(){function e(e){if(this.stokesVals=[],this.headerEntries=[],this.computedEntries=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dimensions=0,e.prototype.width=0,e.prototype.height=0,e.prototype.depth=0,e.prototype.stokes=0,e.prototype.stokesVals=Dt.emptyArray,e.prototype.headerEntries=Dt.emptyArray,e.prototype.computedEntries=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.dimensions&&Object.hasOwnProperty.call(e,"dimensions")&&t.uint32(13).sfixed32(e.dimensions),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(21).sfixed32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(29).sfixed32(e.height),null!=e.depth&&Object.hasOwnProperty.call(e,"depth")&&t.uint32(37).sfixed32(e.depth),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(45).sfixed32(e.stokes),null!=e.stokesVals&&e.stokesVals.length)for(let i=0;i<e.stokesVals.length;++i)t.uint32(50).string(e.stokesVals[i]);if(null!=e.headerEntries&&e.headerEntries.length)for(let i=0;i<e.headerEntries.length;++i)Lt.CARTA.HeaderEntry.encode(e.headerEntries[i],t.uint32(58).fork()).ldelim();if(null!=e.computedEntries&&e.computedEntries.length)for(let i=0;i<e.computedEntries.length;++i)Lt.CARTA.HeaderEntry.encode(e.computedEntries[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FileInfoExtended;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.dimensions=e.sfixed32();break;case 2:n.width=e.sfixed32();break;case 3:n.height=e.sfixed32();break;case 4:n.depth=e.sfixed32();break;case 5:n.stokes=e.sfixed32();break;case 6:n.stokesVals&&n.stokesVals.length||(n.stokesVals=[]),n.stokesVals.push(e.string());break;case 7:n.headerEntries&&n.headerEntries.length||(n.headerEntries=[]),n.headerEntries.push(Lt.CARTA.HeaderEntry.decode(e,e.uint32()));break;case 8:n.computedEntries&&n.computedEntries.length||(n.computedEntries=[]),n.computedEntries.push(Lt.CARTA.HeaderEntry.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.dimensions&&e.hasOwnProperty("dimensions")&&!Dt.isInteger(e.dimensions))return"dimensions: integer expected";if(null!=e.width&&e.hasOwnProperty("width")&&!Dt.isInteger(e.width))return"width: integer expected";if(null!=e.height&&e.hasOwnProperty("height")&&!Dt.isInteger(e.height))return"height: integer expected";if(null!=e.depth&&e.hasOwnProperty("depth")&&!Dt.isInteger(e.depth))return"depth: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.stokesVals&&e.hasOwnProperty("stokesVals")){if(!Array.isArray(e.stokesVals))return"stokesVals: array expected";for(let t=0;t<e.stokesVals.length;++t)if(!Dt.isString(e.stokesVals[t]))return"stokesVals: string[] expected"}if(null!=e.headerEntries&&e.hasOwnProperty("headerEntries")){if(!Array.isArray(e.headerEntries))return"headerEntries: array expected";for(let t=0;t<e.headerEntries.length;++t){let i=Lt.CARTA.HeaderEntry.verify(e.headerEntries[t]);if(i)return"headerEntries."+i}}if(null!=e.computedEntries&&e.hasOwnProperty("computedEntries")){if(!Array.isArray(e.computedEntries))return"computedEntries: array expected";for(let t=0;t<e.computedEntries.length;++t){let i=Lt.CARTA.HeaderEntry.verify(e.computedEntries[t]);if(i)return"computedEntries."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FileInfoExtended)return e;let t=new Lt.CARTA.FileInfoExtended;if(null!=e.dimensions&&(t.dimensions=0|e.dimensions),null!=e.width&&(t.width=0|e.width),null!=e.height&&(t.height=0|e.height),null!=e.depth&&(t.depth=0|e.depth),null!=e.stokes&&(t.stokes=0|e.stokes),e.stokesVals){if(!Array.isArray(e.stokesVals))throw TypeError(".CARTA.FileInfoExtended.stokesVals: array expected");t.stokesVals=[];for(let i=0;i<e.stokesVals.length;++i)t.stokesVals[i]=String(e.stokesVals[i])}if(e.headerEntries){if(!Array.isArray(e.headerEntries))throw TypeError(".CARTA.FileInfoExtended.headerEntries: array expected");t.headerEntries=[];for(let i=0;i<e.headerEntries.length;++i){if("object"!==typeof e.headerEntries[i])throw TypeError(".CARTA.FileInfoExtended.headerEntries: object expected");t.headerEntries[i]=Lt.CARTA.HeaderEntry.fromObject(e.headerEntries[i])}}if(e.computedEntries){if(!Array.isArray(e.computedEntries))throw TypeError(".CARTA.FileInfoExtended.computedEntries: array expected");t.computedEntries=[];for(let i=0;i<e.computedEntries.length;++i){if("object"!==typeof e.computedEntries[i])throw TypeError(".CARTA.FileInfoExtended.computedEntries: object expected");t.computedEntries[i]=Lt.CARTA.HeaderEntry.fromObject(e.computedEntries[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stokesVals=[],i.headerEntries=[],i.computedEntries=[]),t.defaults&&(i.dimensions=0,i.width=0,i.height=0,i.depth=0,i.stokes=0),null!=e.dimensions&&e.hasOwnProperty("dimensions")&&(i.dimensions=e.dimensions),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),null!=e.depth&&e.hasOwnProperty("depth")&&(i.depth=e.depth),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.stokesVals&&e.stokesVals.length){i.stokesVals=[];for(let t=0;t<e.stokesVals.length;++t)i.stokesVals[t]=e.stokesVals[t]}if(e.headerEntries&&e.headerEntries.length){i.headerEntries=[];for(let n=0;n<e.headerEntries.length;++n)i.headerEntries[n]=Lt.CARTA.HeaderEntry.toObject(e.headerEntries[n],t)}if(e.computedEntries&&e.computedEntries.length){i.computedEntries=[];for(let n=0;n<e.computedEntries.length;++n)i.computedEntries[n]=Lt.CARTA.HeaderEntry.toObject(e.computedEntries[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.HeaderEntry=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.value="",e.prototype.entryType=0,e.prototype.numericValue=0,e.prototype.comment="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.entryType&&Object.hasOwnProperty.call(e,"entryType")&&t.uint32(24).int32(e.entryType),null!=e.numericValue&&Object.hasOwnProperty.call(e,"numericValue")&&t.uint32(33).double(e.numericValue),null!=e.comment&&Object.hasOwnProperty.call(e,"comment")&&t.uint32(42).string(e.comment),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.HeaderEntry;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.value=e.string();break;case 3:n.entryType=e.int32();break;case 4:n.numericValue=e.double();break;case 5:n.comment=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name))return"name: string expected";if(null!=e.value&&e.hasOwnProperty("value")&&!Dt.isString(e.value))return"value: string expected";if(null!=e.entryType&&e.hasOwnProperty("entryType"))switch(e.entryType){default:return"entryType: enum value expected";case 0:case 1:case 2:}return null!=e.numericValue&&e.hasOwnProperty("numericValue")&&"number"!==typeof e.numericValue?"numericValue: number expected":null!=e.comment&&e.hasOwnProperty("comment")&&!Dt.isString(e.comment)?"comment: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.HeaderEntry)return e;let t=new Lt.CARTA.HeaderEntry;switch(null!=e.name&&(t.name=String(e.name)),null!=e.value&&(t.value=String(e.value)),e.entryType){case"STRING":case 0:t.entryType=0;break;case"FLOAT":case 1:t.entryType=1;break;case"INT":case 2:t.entryType=2}return null!=e.numericValue&&(t.numericValue=Number(e.numericValue)),null!=e.comment&&(t.comment=String(e.comment)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.name="",i.value="",i.entryType=t.enums===String?"STRING":0,i.numericValue=0,i.comment=""),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.value&&e.hasOwnProperty("value")&&(i.value=e.value),null!=e.entryType&&e.hasOwnProperty("entryType")&&(i.entryType=t.enums===String?Lt.CARTA.EntryType[e.entryType]:e.entryType),null!=e.numericValue&&e.hasOwnProperty("numericValue")&&(i.numericValue=t.json&&!isFinite(e.numericValue)?String(e.numericValue):e.numericValue),null!=e.comment&&e.hasOwnProperty("comment")&&(i.comment=e.comment),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.IntBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(13).sfixed32(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(21).sfixed32(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.IntBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.sfixed32();break;case 2:n.max=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&!Dt.isInteger(e.min)?"min: integer expected":null!=e.max&&e.hasOwnProperty("max")&&!Dt.isInteger(e.max)?"max: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.IntBounds)return e;let t=new Lt.CARTA.IntBounds;return null!=e.min&&(t.min=0|e.min),null!=e.max&&(t.max=0|e.max),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FloatBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(13).float(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(21).float(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FloatBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.float();break;case 2:n.max=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&"number"!==typeof e.min?"min: number expected":null!=e.max&&e.hasOwnProperty("max")&&"number"!==typeof e.max?"max: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FloatBounds)return e;let t=new Lt.CARTA.FloatBounds;return null!=e.min&&(t.min=Number(e.min)),null!=e.max&&(t.max=Number(e.max)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=t.json&&!isFinite(e.min)?String(e.min):e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=t.json&&!isFinite(e.max)?String(e.max):e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.DoubleBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(9).double(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(17).double(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.DoubleBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.double();break;case 2:n.max=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&"number"!==typeof e.min?"min: number expected":null!=e.max&&e.hasOwnProperty("max")&&"number"!==typeof e.max?"max: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.DoubleBounds)return e;let t=new Lt.CARTA.DoubleBounds;return null!=e.min&&(t.min=Number(e.min)),null!=e.max&&(t.max=Number(e.max)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=t.json&&!isFinite(e.min)?String(e.min):e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=t.json&&!isFinite(e.max)?String(e.max):e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ImageBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.xMin=0,e.prototype.xMax=0,e.prototype.yMin=0,e.prototype.yMax=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.xMin&&Object.hasOwnProperty.call(e,"xMin")&&t.uint32(13).sfixed32(e.xMin),null!=e.xMax&&Object.hasOwnProperty.call(e,"xMax")&&t.uint32(21).sfixed32(e.xMax),null!=e.yMin&&Object.hasOwnProperty.call(e,"yMin")&&t.uint32(29).sfixed32(e.yMin),null!=e.yMax&&Object.hasOwnProperty.call(e,"yMax")&&t.uint32(37).sfixed32(e.yMax),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ImageBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.xMin=e.sfixed32();break;case 2:n.xMax=e.sfixed32();break;case 3:n.yMin=e.sfixed32();break;case 4:n.yMax=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.xMin&&e.hasOwnProperty("xMin")&&!Dt.isInteger(e.xMin)?"xMin: integer expected":null!=e.xMax&&e.hasOwnProperty("xMax")&&!Dt.isInteger(e.xMax)?"xMax: integer expected":null!=e.yMin&&e.hasOwnProperty("yMin")&&!Dt.isInteger(e.yMin)?"yMin: integer expected":null!=e.yMax&&e.hasOwnProperty("yMax")&&!Dt.isInteger(e.yMax)?"yMax: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ImageBounds)return e;let t=new Lt.CARTA.ImageBounds;return null!=e.xMin&&(t.xMin=0|e.xMin),null!=e.xMax&&(t.xMax=0|e.xMax),null!=e.yMin&&(t.yMin=0|e.yMin),null!=e.yMax&&(t.yMax=0|e.yMax),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.xMin=0,i.xMax=0,i.yMin=0,i.yMax=0),null!=e.xMin&&e.hasOwnProperty("xMin")&&(i.xMin=e.xMin),null!=e.xMax&&e.hasOwnProperty("xMax")&&(i.xMax=e.xMax),null!=e.yMin&&e.hasOwnProperty("yMin")&&(i.yMin=e.yMin),null!=e.yMax&&e.hasOwnProperty("yMax")&&(i.yMax=e.yMax),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.AnimationFrame=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.stokes=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(21).sfixed32(e.stokes),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.AnimationFrame;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.stokes=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes)?"stokes: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.AnimationFrame)return e;let t=new Lt.CARTA.AnimationFrame;return null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.stokes=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SpatialProfile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.start=0,e.prototype.end=0,e.prototype.rawValuesFp32=Dt.newBuffer([]),e.prototype.coordinate="",e.prototype.mip=0,e.prototype.lineAxis=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(13).sfixed32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(21).sfixed32(e.end),null!=e.rawValuesFp32&&Object.hasOwnProperty.call(e,"rawValuesFp32")&&t.uint32(26).bytes(e.rawValuesFp32),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(34).string(e.coordinate),null!=e.mip&&Object.hasOwnProperty.call(e,"mip")&&t.uint32(45).sfixed32(e.mip),null!=e.lineAxis&&Object.hasOwnProperty.call(e,"lineAxis")&&Lt.CARTA.LineProfileAxis.encode(e.lineAxis,t.uint32(50).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SpatialProfile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.start=e.sfixed32();break;case 2:n.end=e.sfixed32();break;case 3:n.rawValuesFp32=e.bytes();break;case 4:n.coordinate=e.string();break;case 5:n.mip=e.sfixed32();break;case 6:n.lineAxis=Lt.CARTA.LineProfileAxis.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.start&&e.hasOwnProperty("start")&&!Dt.isInteger(e.start))return"start: integer expected";if(null!=e.end&&e.hasOwnProperty("end")&&!Dt.isInteger(e.end))return"end: integer expected";if(null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&!(e.rawValuesFp32&&"number"===typeof e.rawValuesFp32.length||Dt.isString(e.rawValuesFp32)))return"rawValuesFp32: buffer expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!Dt.isString(e.coordinate))return"coordinate: string expected";if(null!=e.mip&&e.hasOwnProperty("mip")&&!Dt.isInteger(e.mip))return"mip: integer expected";if(null!=e.lineAxis&&e.hasOwnProperty("lineAxis")){let t=Lt.CARTA.LineProfileAxis.verify(e.lineAxis);if(t)return"lineAxis."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SpatialProfile)return e;let t=new Lt.CARTA.SpatialProfile;if(null!=e.start&&(t.start=0|e.start),null!=e.end&&(t.end=0|e.end),null!=e.rawValuesFp32&&("string"===typeof e.rawValuesFp32?Dt.base64.decode(e.rawValuesFp32,t.rawValuesFp32=Dt.newBuffer(Dt.base64.length(e.rawValuesFp32)),0):e.rawValuesFp32.length&&(t.rawValuesFp32=e.rawValuesFp32)),null!=e.coordinate&&(t.coordinate=String(e.coordinate)),null!=e.mip&&(t.mip=0|e.mip),null!=e.lineAxis){if("object"!==typeof e.lineAxis)throw TypeError(".CARTA.SpatialProfile.lineAxis: object expected");t.lineAxis=Lt.CARTA.LineProfileAxis.fromObject(e.lineAxis)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.start=0,i.end=0,t.bytes===String?i.rawValuesFp32="":(i.rawValuesFp32=[],t.bytes!==Array&&(i.rawValuesFp32=Dt.newBuffer(i.rawValuesFp32))),i.coordinate="",i.mip=0,i.lineAxis=null),null!=e.start&&e.hasOwnProperty("start")&&(i.start=e.start),null!=e.end&&e.hasOwnProperty("end")&&(i.end=e.end),null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&(i.rawValuesFp32=t.bytes===String?Dt.base64.encode(e.rawValuesFp32,0,e.rawValuesFp32.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp32):e.rawValuesFp32),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),null!=e.mip&&e.hasOwnProperty("mip")&&(i.mip=e.mip),null!=e.lineAxis&&e.hasOwnProperty("lineAxis")&&(i.lineAxis=Lt.CARTA.LineProfileAxis.toObject(e.lineAxis,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.LineProfileAxis=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.axisType=0,e.prototype.crpix=0,e.prototype.crval=0,e.prototype.cdelt=0,e.prototype.unit="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.axisType&&Object.hasOwnProperty.call(e,"axisType")&&t.uint32(8).int32(e.axisType),null!=e.crpix&&Object.hasOwnProperty.call(e,"crpix")&&t.uint32(21).float(e.crpix),null!=e.crval&&Object.hasOwnProperty.call(e,"crval")&&t.uint32(29).float(e.crval),null!=e.cdelt&&Object.hasOwnProperty.call(e,"cdelt")&&t.uint32(37).float(e.cdelt),null!=e.unit&&Object.hasOwnProperty.call(e,"unit")&&t.uint32(42).string(e.unit),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.LineProfileAxis;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.axisType=e.int32();break;case 2:n.crpix=e.float();break;case 3:n.crval=e.float();break;case 4:n.cdelt=e.float();break;case 5:n.unit=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.axisType&&e.hasOwnProperty("axisType"))switch(e.axisType){default:return"axisType: enum value expected";case 0:case 1:}return null!=e.crpix&&e.hasOwnProperty("crpix")&&"number"!==typeof e.crpix?"crpix: number expected":null!=e.crval&&e.hasOwnProperty("crval")&&"number"!==typeof e.crval?"crval: number expected":null!=e.cdelt&&e.hasOwnProperty("cdelt")&&"number"!==typeof e.cdelt?"cdelt: number expected":null!=e.unit&&e.hasOwnProperty("unit")&&!Dt.isString(e.unit)?"unit: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.LineProfileAxis)return e;let t=new Lt.CARTA.LineProfileAxis;switch(e.axisType){case"Offset":case 0:t.axisType=0;break;case"Distance":case 1:t.axisType=1}return null!=e.crpix&&(t.crpix=Number(e.crpix)),null!=e.crval&&(t.crval=Number(e.crval)),null!=e.cdelt&&(t.cdelt=Number(e.cdelt)),null!=e.unit&&(t.unit=String(e.unit)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.axisType=t.enums===String?"Offset":0,i.crpix=0,i.crval=0,i.cdelt=0,i.unit=""),null!=e.axisType&&e.hasOwnProperty("axisType")&&(i.axisType=t.enums===String?Lt.CARTA.ProfileAxisType[e.axisType]:e.axisType),null!=e.crpix&&e.hasOwnProperty("crpix")&&(i.crpix=t.json&&!isFinite(e.crpix)?String(e.crpix):e.crpix),null!=e.crval&&e.hasOwnProperty("crval")&&(i.crval=t.json&&!isFinite(e.crval)?String(e.crval):e.crval),null!=e.cdelt&&e.hasOwnProperty("cdelt")&&(i.cdelt=t.json&&!isFinite(e.cdelt)?String(e.cdelt):e.cdelt),null!=e.unit&&e.hasOwnProperty("unit")&&(i.unit=e.unit),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SpectralProfile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsType=0,e.prototype.rawValuesFp32=Dt.newBuffer([]),e.prototype.rawValuesFp64=Dt.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsType&&Object.hasOwnProperty.call(e,"statsType")&&t.uint32(16).int32(e.statsType),null!=e.rawValuesFp32&&Object.hasOwnProperty.call(e,"rawValuesFp32")&&t.uint32(26).bytes(e.rawValuesFp32),null!=e.rawValuesFp64&&Object.hasOwnProperty.call(e,"rawValuesFp64")&&t.uint32(34).bytes(e.rawValuesFp64),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SpectralProfile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:n.statsType=e.int32();break;case 3:n.rawValuesFp32=e.bytes();break;case 4:n.rawValuesFp64=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!Dt.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsType&&e.hasOwnProperty("statsType"))switch(e.statsType){default:return"statsType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}return null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&!(e.rawValuesFp32&&"number"===typeof e.rawValuesFp32.length||Dt.isString(e.rawValuesFp32))?"rawValuesFp32: buffer expected":null!=e.rawValuesFp64&&e.hasOwnProperty("rawValuesFp64")&&!(e.rawValuesFp64&&"number"===typeof e.rawValuesFp64.length||Dt.isString(e.rawValuesFp64))?"rawValuesFp64: buffer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SpectralProfile)return e;let t=new Lt.CARTA.SpectralProfile;switch(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsType){case"NumPixels":case 0:t.statsType=0;break;case"NanCount":case 1:t.statsType=1;break;case"Sum":case 2:t.statsType=2;break;case"FluxDensity":case 3:t.statsType=3;break;case"Mean":case 4:t.statsType=4;break;case"RMS":case 5:t.statsType=5;break;case"Sigma":case 6:t.statsType=6;break;case"SumSq":case 7:t.statsType=7;break;case"Min":case 8:t.statsType=8;break;case"Max":case 9:t.statsType=9;break;case"Extrema":case 10:t.statsType=10;break;case"Blc":case 11:t.statsType=11;break;case"Trc":case 12:t.statsType=12;break;case"MinPos":case 13:t.statsType=13;break;case"MaxPos":case 14:t.statsType=14;break;case"Blcf":case 15:t.statsType=15;break;case"Trcf":case 16:t.statsType=16;break;case"MinPosf":case 17:t.statsType=17;break;case"MaxPosf":case 18:t.statsType=18}return null!=e.rawValuesFp32&&("string"===typeof e.rawValuesFp32?Dt.base64.decode(e.rawValuesFp32,t.rawValuesFp32=Dt.newBuffer(Dt.base64.length(e.rawValuesFp32)),0):e.rawValuesFp32.length&&(t.rawValuesFp32=e.rawValuesFp32)),null!=e.rawValuesFp64&&("string"===typeof e.rawValuesFp64?Dt.base64.decode(e.rawValuesFp64,t.rawValuesFp64=Dt.newBuffer(Dt.base64.length(e.rawValuesFp64)),0):e.rawValuesFp64.length&&(t.rawValuesFp64=e.rawValuesFp64)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.coordinate="",i.statsType=t.enums===String?"NumPixels":0,t.bytes===String?i.rawValuesFp32="":(i.rawValuesFp32=[],t.bytes!==Array&&(i.rawValuesFp32=Dt.newBuffer(i.rawValuesFp32))),t.bytes===String?i.rawValuesFp64="":(i.rawValuesFp64=[],t.bytes!==Array&&(i.rawValuesFp64=Dt.newBuffer(i.rawValuesFp64)))),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),null!=e.statsType&&e.hasOwnProperty("statsType")&&(i.statsType=t.enums===String?Lt.CARTA.StatsType[e.statsType]:e.statsType),null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&(i.rawValuesFp32=t.bytes===String?Dt.base64.encode(e.rawValuesFp32,0,e.rawValuesFp32.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp32):e.rawValuesFp32),null!=e.rawValuesFp64&&e.hasOwnProperty("rawValuesFp64")&&(i.rawValuesFp64=t.bytes===String?Dt.base64.encode(e.rawValuesFp64,0,e.rawValuesFp64.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp64):e.rawValuesFp64),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StatisticsValue=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.statsType=0,e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.statsType&&Object.hasOwnProperty.call(e,"statsType")&&t.uint32(8).int32(e.statsType),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StatisticsValue;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.statsType=e.int32();break;case 2:n.value=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.statsType&&e.hasOwnProperty("statsType"))switch(e.statsType){default:return"statsType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value?"value: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StatisticsValue)return e;let t=new Lt.CARTA.StatisticsValue;switch(e.statsType){case"NumPixels":case 0:t.statsType=0;break;case"NanCount":case 1:t.statsType=1;break;case"Sum":case 2:t.statsType=2;break;case"FluxDensity":case 3:t.statsType=3;break;case"Mean":case 4:t.statsType=4;break;case"RMS":case 5:t.statsType=5;break;case"Sigma":case 6:t.statsType=6;break;case"SumSq":case 7:t.statsType=7;break;case"Min":case 8:t.statsType=8;break;case"Max":case 9:t.statsType=9;break;case"Extrema":case 10:t.statsType=10;break;case"Blc":case 11:t.statsType=11;break;case"Trc":case 12:t.statsType=12;break;case"MinPos":case 13:t.statsType=13;break;case"MaxPos":case 14:t.statsType=14;break;case"Blcf":case 15:t.statsType=15;break;case"Trcf":case 16:t.statsType=16;break;case"MinPosf":case 17:t.statsType=17;break;case"MaxPosf":case 18:t.statsType=18}return null!=e.value&&(t.value=Number(e.value)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.statsType=t.enums===String?"NumPixels":0,i.value=0),null!=e.statsType&&e.hasOwnProperty("statsType")&&(i.statsType=t.enums===String?Lt.CARTA.StatsType[e.statsType]:e.statsType),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.Histogram=function(){function e(e){if(this.bins=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.numBins=0,e.prototype.binWidth=0,e.prototype.firstBinCenter=0,e.prototype.bins=Dt.emptyArray,e.prototype.mean=0,e.prototype.stdDev=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.numBins&&Object.hasOwnProperty.call(e,"numBins")&&t.uint32(13).sfixed32(e.numBins),null!=e.binWidth&&Object.hasOwnProperty.call(e,"binWidth")&&t.uint32(17).double(e.binWidth),null!=e.firstBinCenter&&Object.hasOwnProperty.call(e,"firstBinCenter")&&t.uint32(25).double(e.firstBinCenter),null!=e.bins&&e.bins.length){t.uint32(34).fork();for(let i=0;i<e.bins.length;++i)t.sfixed32(e.bins[i]);t.ldelim()}return null!=e.mean&&Object.hasOwnProperty.call(e,"mean")&&t.uint32(41).double(e.mean),null!=e.stdDev&&Object.hasOwnProperty.call(e,"stdDev")&&t.uint32(49).double(e.stdDev),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.Histogram;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.numBins=e.sfixed32();break;case 2:n.binWidth=e.double();break;case 3:n.firstBinCenter=e.double();break;case 4:if(n.bins&&n.bins.length||(n.bins=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.bins.push(e.sfixed32())}else n.bins.push(e.sfixed32());break;case 5:n.mean=e.double();break;case 6:n.stdDev=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.numBins&&e.hasOwnProperty("numBins")&&!Dt.isInteger(e.numBins))return"numBins: integer expected";if(null!=e.binWidth&&e.hasOwnProperty("binWidth")&&"number"!==typeof e.binWidth)return"binWidth: number expected";if(null!=e.firstBinCenter&&e.hasOwnProperty("firstBinCenter")&&"number"!==typeof e.firstBinCenter)return"firstBinCenter: number expected";if(null!=e.bins&&e.hasOwnProperty("bins")){if(!Array.isArray(e.bins))return"bins: array expected";for(let t=0;t<e.bins.length;++t)if(!Dt.isInteger(e.bins[t]))return"bins: integer[] expected"}return null!=e.mean&&e.hasOwnProperty("mean")&&"number"!==typeof e.mean?"mean: number expected":null!=e.stdDev&&e.hasOwnProperty("stdDev")&&"number"!==typeof e.stdDev?"stdDev: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.Histogram)return e;let t=new Lt.CARTA.Histogram;if(null!=e.numBins&&(t.numBins=0|e.numBins),null!=e.binWidth&&(t.binWidth=Number(e.binWidth)),null!=e.firstBinCenter&&(t.firstBinCenter=Number(e.firstBinCenter)),e.bins){if(!Array.isArray(e.bins))throw TypeError(".CARTA.Histogram.bins: array expected");t.bins=[];for(let i=0;i<e.bins.length;++i)t.bins[i]=0|e.bins[i]}return null!=e.mean&&(t.mean=Number(e.mean)),null!=e.stdDev&&(t.stdDev=Number(e.stdDev)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.bins=[]),t.defaults&&(i.numBins=0,i.binWidth=0,i.firstBinCenter=0,i.mean=0,i.stdDev=0),null!=e.numBins&&e.hasOwnProperty("numBins")&&(i.numBins=e.numBins),null!=e.binWidth&&e.hasOwnProperty("binWidth")&&(i.binWidth=t.json&&!isFinite(e.binWidth)?String(e.binWidth):e.binWidth),null!=e.firstBinCenter&&e.hasOwnProperty("firstBinCenter")&&(i.firstBinCenter=t.json&&!isFinite(e.firstBinCenter)?String(e.firstBinCenter):e.firstBinCenter),e.bins&&e.bins.length){i.bins=[];for(let t=0;t<e.bins.length;++t)i.bins[t]=e.bins[t]}return null!=e.mean&&e.hasOwnProperty("mean")&&(i.mean=t.json&&!isFinite(e.mean)?String(e.mean):e.mean),null!=e.stdDev&&e.hasOwnProperty("stdDev")&&(i.stdDev=t.json&&!isFinite(e.stdDev)?String(e.stdDev):e.stdDev),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionInfo=function(){function e(e){if(this.controlPoints=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.regionType=0,e.prototype.controlPoints=Dt.emptyArray,e.prototype.rotation=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.regionType&&Object.hasOwnProperty.call(e,"regionType")&&t.uint32(8).int32(e.regionType),null!=e.controlPoints&&e.controlPoints.length)for(let i=0;i<e.controlPoints.length;++i)Lt.CARTA.Point.encode(e.controlPoints[i],t.uint32(18).fork()).ldelim();return null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(29).float(e.rotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.regionType=e.int32();break;case 2:n.controlPoints&&n.controlPoints.length||(n.controlPoints=[]),n.controlPoints.push(Lt.CARTA.Point.decode(e,e.uint32()));break;case 3:n.rotation=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.regionType&&e.hasOwnProperty("regionType"))switch(e.regionType){default:return"regionType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.controlPoints&&e.hasOwnProperty("controlPoints")){if(!Array.isArray(e.controlPoints))return"controlPoints: array expected";for(let t=0;t<e.controlPoints.length;++t){let i=Lt.CARTA.Point.verify(e.controlPoints[t]);if(i)return"controlPoints."+i}}return null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!==typeof e.rotation?"rotation: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionInfo)return e;let t=new Lt.CARTA.RegionInfo;switch(e.regionType){case"POINT":case 0:t.regionType=0;break;case"LINE":case 1:t.regionType=1;break;case"POLYLINE":case 2:t.regionType=2;break;case"RECTANGLE":case 3:t.regionType=3;break;case"ELLIPSE":case 4:t.regionType=4;break;case"ANNULUS":case 5:t.regionType=5;break;case"POLYGON":case 6:t.regionType=6}if(e.controlPoints){if(!Array.isArray(e.controlPoints))throw TypeError(".CARTA.RegionInfo.controlPoints: array expected");t.controlPoints=[];for(let i=0;i<e.controlPoints.length;++i){if("object"!==typeof e.controlPoints[i])throw TypeError(".CARTA.RegionInfo.controlPoints: object expected");t.controlPoints[i]=Lt.CARTA.Point.fromObject(e.controlPoints[i])}}return null!=e.rotation&&(t.rotation=Number(e.rotation)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.controlPoints=[]),t.defaults&&(i.regionType=t.enums===String?"POINT":0,i.rotation=0),null!=e.regionType&&e.hasOwnProperty("regionType")&&(i.regionType=t.enums===String?Lt.CARTA.RegionType[e.regionType]:e.regionType),e.controlPoints&&e.controlPoints.length){i.controlPoints=[];for(let n=0;n<e.controlPoints.length;++n)i.controlPoints[n]=Lt.CARTA.Point.toObject(e.controlPoints[n],t)}return null!=e.rotation&&e.hasOwnProperty("rotation")&&(i.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionStyle=function(){function e(e){if(this.dashList=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.color="",e.prototype.lineWidth=0,e.prototype.dashList=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(18).string(e.color),null!=e.lineWidth&&Object.hasOwnProperty.call(e,"lineWidth")&&t.uint32(29).sfixed32(e.lineWidth),null!=e.dashList&&e.dashList.length){t.uint32(34).fork();for(let i=0;i<e.dashList.length;++i)t.sfixed32(e.dashList[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionStyle;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.color=e.string();break;case 3:n.lineWidth=e.sfixed32();break;case 4:if(n.dashList&&n.dashList.length||(n.dashList=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.dashList.push(e.sfixed32())}else n.dashList.push(e.sfixed32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name))return"name: string expected";if(null!=e.color&&e.hasOwnProperty("color")&&!Dt.isString(e.color))return"color: string expected";if(null!=e.lineWidth&&e.hasOwnProperty("lineWidth")&&!Dt.isInteger(e.lineWidth))return"lineWidth: integer expected";if(null!=e.dashList&&e.hasOwnProperty("dashList")){if(!Array.isArray(e.dashList))return"dashList: array expected";for(let t=0;t<e.dashList.length;++t)if(!Dt.isInteger(e.dashList[t]))return"dashList: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionStyle)return e;let t=new Lt.CARTA.RegionStyle;if(null!=e.name&&(t.name=String(e.name)),null!=e.color&&(t.color=String(e.color)),null!=e.lineWidth&&(t.lineWidth=0|e.lineWidth),e.dashList){if(!Array.isArray(e.dashList))throw TypeError(".CARTA.RegionStyle.dashList: array expected");t.dashList=[];for(let i=0;i<e.dashList.length;++i)t.dashList[i]=0|e.dashList[i]}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.dashList=[]),t.defaults&&(i.name="",i.color="",i.lineWidth=0),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.color&&e.hasOwnProperty("color")&&(i.color=e.color),null!=e.lineWidth&&e.hasOwnProperty("lineWidth")&&(i.lineWidth=e.lineWidth),e.dashList&&e.dashList.length){i.dashList=[];for(let t=0;t<e.dashList.length;++t)i.dashList[t]=e.dashList[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogFileInfo=function(){function e(e){if(this.coosys=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.type=0,e.prototype.fileSize=Dt.Long?Dt.Long.fromBits(0,0,!1):0,e.prototype.description="",e.prototype.coosys=Dt.emptyArray,e.prototype.date=Dt.Long?Dt.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.fileSize&&Object.hasOwnProperty.call(e,"fileSize")&&t.uint32(25).sfixed64(e.fileSize),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(34).string(e.description),null!=e.coosys&&e.coosys.length)for(let i=0;i<e.coosys.length;++i)Lt.CARTA.Coosys.encode(e.coosys[i],t.uint32(42).fork()).ldelim();return null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(49).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogFileInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.type=e.int32();break;case 3:n.fileSize=e.sfixed64();break;case 4:n.description=e.string();break;case 5:n.coosys&&n.coosys.length||(n.coosys=[]),n.coosys.push(Lt.CARTA.Coosys.decode(e,e.uint32()));break;case 6:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:}if(null!=e.fileSize&&e.hasOwnProperty("fileSize")&&!Dt.isInteger(e.fileSize)&&!(e.fileSize&&Dt.isInteger(e.fileSize.low)&&Dt.isInteger(e.fileSize.high)))return"fileSize: integer|Long expected";if(null!=e.description&&e.hasOwnProperty("description")&&!Dt.isString(e.description))return"description: string expected";if(null!=e.coosys&&e.hasOwnProperty("coosys")){if(!Array.isArray(e.coosys))return"coosys: array expected";for(let t=0;t<e.coosys.length;++t){let i=Lt.CARTA.Coosys.verify(e.coosys[t]);if(i)return"coosys."+i}}return null==e.date||!e.hasOwnProperty("date")||Dt.isInteger(e.date)||e.date&&Dt.isInteger(e.date.low)&&Dt.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogFileInfo)return e;let t=new Lt.CARTA.CatalogFileInfo;switch(null!=e.name&&(t.name=String(e.name)),e.type){case"FITSTable":case 0:t.type=0;break;case"VOTable":case 1:t.type=1;break;case"Unknown":case 2:t.type=2}if(null!=e.fileSize&&(Dt.Long?(t.fileSize=Dt.Long.fromValue(e.fileSize)).unsigned=!1:"string"===typeof e.fileSize?t.fileSize=parseInt(e.fileSize,10):"number"===typeof e.fileSize?t.fileSize=e.fileSize:"object"===typeof e.fileSize&&(t.fileSize=new Dt.LongBits(e.fileSize.low>>>0,e.fileSize.high>>>0).toNumber())),null!=e.description&&(t.description=String(e.description)),e.coosys){if(!Array.isArray(e.coosys))throw TypeError(".CARTA.CatalogFileInfo.coosys: array expected");t.coosys=[];for(let i=0;i<e.coosys.length;++i){if("object"!==typeof e.coosys[i])throw TypeError(".CARTA.CatalogFileInfo.coosys: object expected");t.coosys[i]=Lt.CARTA.Coosys.fromObject(e.coosys[i])}}return null!=e.date&&(Dt.Long?(t.date=Dt.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new Dt.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.coosys=[]),t.defaults){if(i.name="",i.type=t.enums===String?"FITSTable":0,Dt.Long){let e=new Dt.Long(0,0,!1);i.fileSize=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.fileSize=t.longs===String?"0":0;if(i.description="",Dt.Long){let e=new Dt.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0}if(null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?Lt.CARTA.CatalogFileType[e.type]:e.type),null!=e.fileSize&&e.hasOwnProperty("fileSize")&&("number"===typeof e.fileSize?i.fileSize=t.longs===String?String(e.fileSize):e.fileSize:i.fileSize=t.longs===String?Dt.Long.prototype.toString.call(e.fileSize):t.longs===Number?new Dt.LongBits(e.fileSize.low>>>0,e.fileSize.high>>>0).toNumber():e.fileSize),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),e.coosys&&e.coosys.length){i.coosys=[];for(let n=0;n<e.coosys.length;++n)i.coosys[n]=Lt.CARTA.Coosys.toObject(e.coosys[n],t)}return null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?Dt.Long.prototype.toString.call(e.date):t.longs===Number?new Dt.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.Coosys=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.equinox="",e.prototype.epoch="",e.prototype.system="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.equinox&&Object.hasOwnProperty.call(e,"equinox")&&t.uint32(10).string(e.equinox),null!=e.epoch&&Object.hasOwnProperty.call(e,"epoch")&&t.uint32(18).string(e.epoch),null!=e.system&&Object.hasOwnProperty.call(e,"system")&&t.uint32(26).string(e.system),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.Coosys;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.equinox=e.string();break;case 2:n.epoch=e.string();break;case 3:n.system=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.equinox&&e.hasOwnProperty("equinox")&&!Dt.isString(e.equinox)?"equinox: string expected":null!=e.epoch&&e.hasOwnProperty("epoch")&&!Dt.isString(e.epoch)?"epoch: string expected":null!=e.system&&e.hasOwnProperty("system")&&!Dt.isString(e.system)?"system: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.Coosys)return e;let t=new Lt.CARTA.Coosys;return null!=e.equinox&&(t.equinox=String(e.equinox)),null!=e.epoch&&(t.epoch=String(e.epoch)),null!=e.system&&(t.system=String(e.system)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.equinox="",i.epoch="",i.system=""),null!=e.equinox&&e.hasOwnProperty("equinox")&&(i.equinox=e.equinox),null!=e.epoch&&e.hasOwnProperty("epoch")&&(i.epoch=e.epoch),null!=e.system&&e.hasOwnProperty("system")&&(i.system=e.system),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogHeader=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.dataType=0,e.prototype.columnIndex=0,e.prototype.description="",e.prototype.units="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.columnIndex&&Object.hasOwnProperty.call(e,"columnIndex")&&t.uint32(29).sfixed32(e.columnIndex),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(42).string(e.description),null!=e.units&&Object.hasOwnProperty.call(e,"units")&&t.uint32(50).string(e.units),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogHeader;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.dataType=e.int32();break;case 3:n.columnIndex=e.sfixed32();break;case 5:n.description=e.string();break;case 6:n.units=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name))return"name: string expected";if(null!=e.dataType&&e.hasOwnProperty("dataType"))switch(e.dataType){default:return"dataType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}return null!=e.columnIndex&&e.hasOwnProperty("columnIndex")&&!Dt.isInteger(e.columnIndex)?"columnIndex: integer expected":null!=e.description&&e.hasOwnProperty("description")&&!Dt.isString(e.description)?"description: string expected":null!=e.units&&e.hasOwnProperty("units")&&!Dt.isString(e.units)?"units: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogHeader)return e;let t=new Lt.CARTA.CatalogHeader;switch(null!=e.name&&(t.name=String(e.name)),e.dataType){case"UnsupportedType":case 0:t.dataType=0;break;case"String":case 1:t.dataType=1;break;case"Uint8":case 2:t.dataType=2;break;case"Int8":case 3:t.dataType=3;break;case"Uint16":case 4:t.dataType=4;break;case"Int16":case 5:t.dataType=5;break;case"Uint32":case 6:t.dataType=6;break;case"Int32":case 7:t.dataType=7;break;case"Uint64":case 8:t.dataType=8;break;case"Int64":case 9:t.dataType=9;break;case"Float":case 10:t.dataType=10;break;case"Double":case 11:t.dataType=11;break;case"Bool":case 12:t.dataType=12}return null!=e.columnIndex&&(t.columnIndex=0|e.columnIndex),null!=e.description&&(t.description=String(e.description)),null!=e.units&&(t.units=String(e.units)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.name="",i.dataType=t.enums===String?"UnsupportedType":0,i.columnIndex=0,i.description="",i.units=""),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.dataType&&e.hasOwnProperty("dataType")&&(i.dataType=t.enums===String?Lt.CARTA.ColumnType[e.dataType]:e.dataType),null!=e.columnIndex&&e.hasOwnProperty("columnIndex")&&(i.columnIndex=e.columnIndex),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),null!=e.units&&e.hasOwnProperty("units")&&(i.units=e.units),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ColumnData=function(){function e(e){if(this.stringData=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dataType=0,e.prototype.stringData=Dt.emptyArray,e.prototype.binaryData=Dt.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(8).int32(e.dataType),null!=e.stringData&&e.stringData.length)for(let i=0;i<e.stringData.length;++i)t.uint32(18).string(e.stringData[i]);return null!=e.binaryData&&Object.hasOwnProperty.call(e,"binaryData")&&t.uint32(26).bytes(e.binaryData),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ColumnData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.dataType=e.int32();break;case 2:n.stringData&&n.stringData.length||(n.stringData=[]),n.stringData.push(e.string());break;case 3:n.binaryData=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.dataType&&e.hasOwnProperty("dataType"))switch(e.dataType){default:return"dataType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(let t=0;t<e.stringData.length;++t)if(!Dt.isString(e.stringData[t]))return"stringData: string[] expected"}return null!=e.binaryData&&e.hasOwnProperty("binaryData")&&!(e.binaryData&&"number"===typeof e.binaryData.length||Dt.isString(e.binaryData))?"binaryData: buffer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ColumnData)return e;let t=new Lt.CARTA.ColumnData;switch(e.dataType){case"UnsupportedType":case 0:t.dataType=0;break;case"String":case 1:t.dataType=1;break;case"Uint8":case 2:t.dataType=2;break;case"Int8":case 3:t.dataType=3;break;case"Uint16":case 4:t.dataType=4;break;case"Int16":case 5:t.dataType=5;break;case"Uint32":case 6:t.dataType=6;break;case"Int32":case 7:t.dataType=7;break;case"Uint64":case 8:t.dataType=8;break;case"Int64":case 9:t.dataType=9;break;case"Float":case 10:t.dataType=10;break;case"Double":case 11:t.dataType=11;break;case"Bool":case 12:t.dataType=12}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".CARTA.ColumnData.stringData: array expected");t.stringData=[];for(let i=0;i<e.stringData.length;++i)t.stringData[i]=String(e.stringData[i])}return null!=e.binaryData&&("string"===typeof e.binaryData?Dt.base64.decode(e.binaryData,t.binaryData=Dt.newBuffer(Dt.base64.length(e.binaryData)),0):e.binaryData.length&&(t.binaryData=e.binaryData)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stringData=[]),t.defaults&&(i.dataType=t.enums===String?"UnsupportedType":0,t.bytes===String?i.binaryData="":(i.binaryData=[],t.bytes!==Array&&(i.binaryData=Dt.newBuffer(i.binaryData)))),null!=e.dataType&&e.hasOwnProperty("dataType")&&(i.dataType=t.enums===String?Lt.CARTA.ColumnType[e.dataType]:e.dataType),e.stringData&&e.stringData.length){i.stringData=[];for(let t=0;t<e.stringData.length;++t)i.stringData[t]=e.stringData[t]}return null!=e.binaryData&&e.hasOwnProperty("binaryData")&&(i.binaryData=t.bytes===String?Dt.base64.encode(e.binaryData,0,e.binaryData.length):t.bytes===Array?Array.prototype.slice.call(e.binaryData):e.binaryData),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FilterConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.columnName="",e.prototype.comparisonOperator=0,e.prototype.value=0,e.prototype.secondaryValue=0,e.prototype.subString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.columnName&&Object.hasOwnProperty.call(e,"columnName")&&t.uint32(10).string(e.columnName),null!=e.comparisonOperator&&Object.hasOwnProperty.call(e,"comparisonOperator")&&t.uint32(16).int32(e.comparisonOperator),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(25).double(e.value),null!=e.secondaryValue&&Object.hasOwnProperty.call(e,"secondaryValue")&&t.uint32(33).double(e.secondaryValue),null!=e.subString&&Object.hasOwnProperty.call(e,"subString")&&t.uint32(42).string(e.subString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FilterConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.columnName=e.string();break;case 2:n.comparisonOperator=e.int32();break;case 3:n.value=e.double();break;case 4:n.secondaryValue=e.double();break;case 5:n.subString=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.columnName&&e.hasOwnProperty("columnName")&&!Dt.isString(e.columnName))return"columnName: string expected";if(null!=e.comparisonOperator&&e.hasOwnProperty("comparisonOperator"))switch(e.comparisonOperator){default:return"comparisonOperator: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value?"value: number expected":null!=e.secondaryValue&&e.hasOwnProperty("secondaryValue")&&"number"!==typeof e.secondaryValue?"secondaryValue: number expected":null!=e.subString&&e.hasOwnProperty("subString")&&!Dt.isString(e.subString)?"subString: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FilterConfig)return e;let t=new Lt.CARTA.FilterConfig;switch(null!=e.columnName&&(t.columnName=String(e.columnName)),e.comparisonOperator){case"Equal":case 0:t.comparisonOperator=0;break;case"NotEqual":case 1:t.comparisonOperator=1;break;case"Lesser":case 2:t.comparisonOperator=2;break;case"Greater":case 3:t.comparisonOperator=3;break;case"LessorOrEqual":case 4:t.comparisonOperator=4;break;case"GreaterOrEqual":case 5:t.comparisonOperator=5;break;case"RangeOpen":case 6:t.comparisonOperator=6;break;case"RangeClosed":case 7:t.comparisonOperator=7}return null!=e.value&&(t.value=Number(e.value)),null!=e.secondaryValue&&(t.secondaryValue=Number(e.secondaryValue)),null!=e.subString&&(t.subString=String(e.subString)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.columnName="",i.comparisonOperator=t.enums===String?"Equal":0,i.value=0,i.secondaryValue=0,i.subString=""),null!=e.columnName&&e.hasOwnProperty("columnName")&&(i.columnName=e.columnName),null!=e.comparisonOperator&&e.hasOwnProperty("comparisonOperator")&&(i.comparisonOperator=t.enums===String?Lt.CARTA.ComparisonOperator[e.comparisonOperator]:e.comparisonOperator),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),null!=e.secondaryValue&&e.hasOwnProperty("secondaryValue")&&(i.secondaryValue=t.json&&!isFinite(e.secondaryValue)?String(e.secondaryValue):e.secondaryValue),null!=e.subString&&e.hasOwnProperty("subString")&&(i.subString=e.subString),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogImageBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.xColumnName="",e.prototype.yColumnName="",e.prototype.imageBounds=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.xColumnName&&Object.hasOwnProperty.call(e,"xColumnName")&&t.uint32(10).string(e.xColumnName),null!=e.yColumnName&&Object.hasOwnProperty.call(e,"yColumnName")&&t.uint32(18).string(e.yColumnName),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&Lt.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogImageBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.xColumnName=e.string();break;case 2:n.yColumnName=e.string();break;case 3:n.imageBounds=Lt.CARTA.ImageBounds.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.xColumnName&&e.hasOwnProperty("xColumnName")&&!Dt.isString(e.xColumnName))return"xColumnName: string expected";if(null!=e.yColumnName&&e.hasOwnProperty("yColumnName")&&!Dt.isString(e.yColumnName))return"yColumnName: string expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=Lt.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogImageBounds)return e;let t=new Lt.CARTA.CatalogImageBounds;if(null!=e.xColumnName&&(t.xColumnName=String(e.xColumnName)),null!=e.yColumnName&&(t.yColumnName=String(e.yColumnName)),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.CatalogImageBounds.imageBounds: object expected");t.imageBounds=Lt.CARTA.ImageBounds.fromObject(e.imageBounds)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.xColumnName="",i.yColumnName="",i.imageBounds=null),null!=e.xColumnName&&e.hasOwnProperty("xColumnName")&&(i.xColumnName=e.xColumnName),null!=e.yColumnName&&e.hasOwnProperty("yColumnName")&&(i.yColumnName=e.yColumnName),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=Lt.CARTA.ImageBounds.toObject(e.imageBounds,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.MatchedFrameList=function(){function e(e){if(this.frameNumbers=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.frameNumbers=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.frameNumbers&&e.frameNumbers.length){t.uint32(10).fork();for(let i=0;i<e.frameNumbers.length;++i)t.float(e.frameNumbers[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.MatchedFrameList;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:if(n.frameNumbers&&n.frameNumbers.length||(n.frameNumbers=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.frameNumbers.push(e.float())}else n.frameNumbers.push(e.float());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.frameNumbers&&e.hasOwnProperty("frameNumbers")){if(!Array.isArray(e.frameNumbers))return"frameNumbers: array expected";for(let t=0;t<e.frameNumbers.length;++t)if("number"!==typeof e.frameNumbers[t])return"frameNumbers: number[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.MatchedFrameList)return e;let t=new Lt.CARTA.MatchedFrameList;if(e.frameNumbers){if(!Array.isArray(e.frameNumbers))throw TypeError(".CARTA.MatchedFrameList.frameNumbers: array expected");t.frameNumbers=[];for(let i=0;i<e.frameNumbers.length;++i)t.frameNumbers[i]=Number(e.frameNumbers[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.frameNumbers=[]),e.frameNumbers&&e.frameNumbers.length){i.frameNumbers=[];for(let n=0;n<e.frameNumbers.length;++n)i.frameNumbers[n]=t.json&&!isFinite(e.frameNumbers[n])?String(e.frameNumbers[n]):e.frameNumbers[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.Beam=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.stokes=0,e.prototype.majorAxis=0,e.prototype.minorAxis=0,e.prototype.pa=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(21).sfixed32(e.stokes),null!=e.majorAxis&&Object.hasOwnProperty.call(e,"majorAxis")&&t.uint32(29).float(e.majorAxis),null!=e.minorAxis&&Object.hasOwnProperty.call(e,"minorAxis")&&t.uint32(37).float(e.minorAxis),null!=e.pa&&Object.hasOwnProperty.call(e,"pa")&&t.uint32(45).float(e.pa),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.Beam;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.stokes=e.sfixed32();break;case 3:n.majorAxis=e.float();break;case 4:n.minorAxis=e.float();break;case 5:n.pa=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes)?"stokes: integer expected":null!=e.majorAxis&&e.hasOwnProperty("majorAxis")&&"number"!==typeof e.majorAxis?"majorAxis: number expected":null!=e.minorAxis&&e.hasOwnProperty("minorAxis")&&"number"!==typeof e.minorAxis?"minorAxis: number expected":null!=e.pa&&e.hasOwnProperty("pa")&&"number"!==typeof e.pa?"pa: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.Beam)return e;let t=new Lt.CARTA.Beam;return null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.majorAxis&&(t.majorAxis=Number(e.majorAxis)),null!=e.minorAxis&&(t.minorAxis=Number(e.minorAxis)),null!=e.pa&&(t.pa=Number(e.pa)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.stokes=0,i.majorAxis=0,i.minorAxis=0,i.pa=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.majorAxis&&e.hasOwnProperty("majorAxis")&&(i.majorAxis=t.json&&!isFinite(e.majorAxis)?String(e.majorAxis):e.majorAxis),null!=e.minorAxis&&e.hasOwnProperty("minorAxis")&&(i.minorAxis=t.json&&!isFinite(e.minorAxis)?String(e.minorAxis):e.minorAxis),null!=e.pa&&e.hasOwnProperty("pa")&&(i.pa=t.json&&!isFinite(e.pa)?String(e.pa):e.pa),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ListProgress=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileListType=0,e.prototype.percentage=0,e.prototype.checkedCount=0,e.prototype.totalCount=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileListType&&Object.hasOwnProperty.call(e,"fileListType")&&t.uint32(8).int32(e.fileListType),null!=e.percentage&&Object.hasOwnProperty.call(e,"percentage")&&t.uint32(21).float(e.percentage),null!=e.checkedCount&&Object.hasOwnProperty.call(e,"checkedCount")&&t.uint32(29).sfixed32(e.checkedCount),null!=e.totalCount&&Object.hasOwnProperty.call(e,"totalCount")&&t.uint32(37).sfixed32(e.totalCount),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ListProgress;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileListType=e.int32();break;case 2:n.percentage=e.float();break;case 3:n.checkedCount=e.sfixed32();break;case 4:n.totalCount=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileListType&&e.hasOwnProperty("fileListType"))switch(e.fileListType){default:return"fileListType: enum value expected";case 0:case 1:}return null!=e.percentage&&e.hasOwnProperty("percentage")&&"number"!==typeof e.percentage?"percentage: number expected":null!=e.checkedCount&&e.hasOwnProperty("checkedCount")&&!Dt.isInteger(e.checkedCount)?"checkedCount: integer expected":null!=e.totalCount&&e.hasOwnProperty("totalCount")&&!Dt.isInteger(e.totalCount)?"totalCount: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ListProgress)return e;let t=new Lt.CARTA.ListProgress;switch(e.fileListType){case"Image":case 0:t.fileListType=0;break;case"Catalog":case 1:t.fileListType=1}return null!=e.percentage&&(t.percentage=Number(e.percentage)),null!=e.checkedCount&&(t.checkedCount=0|e.checkedCount),null!=e.totalCount&&(t.totalCount=0|e.totalCount),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileListType=t.enums===String?"Image":0,i.percentage=0,i.checkedCount=0,i.totalCount=0),null!=e.fileListType&&e.hasOwnProperty("fileListType")&&(i.fileListType=t.enums===String?Lt.CARTA.FileListType[e.fileListType]:e.fileListType),null!=e.percentage&&e.hasOwnProperty("percentage")&&(i.percentage=t.json&&!isFinite(e.percentage)?String(e.percentage):e.percentage),null!=e.checkedCount&&e.hasOwnProperty("checkedCount")&&(i.checkedCount=e.checkedCount),null!=e.totalCount&&e.hasOwnProperty("totalCount")&&(i.totalCount=e.totalCount),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.TileData=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.layer=0,e.prototype.x=0,e.prototype.y=0,e.prototype.width=0,e.prototype.height=0,e.prototype.imageData=Dt.newBuffer([]),e.prototype.nanEncodings=Dt.newBuffer([]),e.prototype.mip=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.layer&&Object.hasOwnProperty.call(e,"layer")&&t.uint32(13).sfixed32(e.layer),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(21).sfixed32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(29).sfixed32(e.y),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(37).sfixed32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(45).sfixed32(e.height),null!=e.imageData&&Object.hasOwnProperty.call(e,"imageData")&&t.uint32(50).bytes(e.imageData),null!=e.nanEncodings&&Object.hasOwnProperty.call(e,"nanEncodings")&&t.uint32(58).bytes(e.nanEncodings),null!=e.mip&&Object.hasOwnProperty.call(e,"mip")&&t.uint32(69).sfixed32(e.mip),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.TileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.layer=e.sfixed32();break;case 2:n.x=e.sfixed32();break;case 3:n.y=e.sfixed32();break;case 4:n.width=e.sfixed32();break;case 5:n.height=e.sfixed32();break;case 6:n.imageData=e.bytes();break;case 7:n.nanEncodings=e.bytes();break;case 8:n.mip=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.layer&&e.hasOwnProperty("layer")&&!Dt.isInteger(e.layer)?"layer: integer expected":null!=e.x&&e.hasOwnProperty("x")&&!Dt.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!Dt.isInteger(e.y)?"y: integer expected":null!=e.width&&e.hasOwnProperty("width")&&!Dt.isInteger(e.width)?"width: integer expected":null!=e.height&&e.hasOwnProperty("height")&&!Dt.isInteger(e.height)?"height: integer expected":null!=e.imageData&&e.hasOwnProperty("imageData")&&!(e.imageData&&"number"===typeof e.imageData.length||Dt.isString(e.imageData))?"imageData: buffer expected":null!=e.nanEncodings&&e.hasOwnProperty("nanEncodings")&&!(e.nanEncodings&&"number"===typeof e.nanEncodings.length||Dt.isString(e.nanEncodings))?"nanEncodings: buffer expected":null!=e.mip&&e.hasOwnProperty("mip")&&!Dt.isInteger(e.mip)?"mip: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.TileData)return e;let t=new Lt.CARTA.TileData;return null!=e.layer&&(t.layer=0|e.layer),null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.width&&(t.width=0|e.width),null!=e.height&&(t.height=0|e.height),null!=e.imageData&&("string"===typeof e.imageData?Dt.base64.decode(e.imageData,t.imageData=Dt.newBuffer(Dt.base64.length(e.imageData)),0):e.imageData.length&&(t.imageData=e.imageData)),null!=e.nanEncodings&&("string"===typeof e.nanEncodings?Dt.base64.decode(e.nanEncodings,t.nanEncodings=Dt.newBuffer(Dt.base64.length(e.nanEncodings)),0):e.nanEncodings.length&&(t.nanEncodings=e.nanEncodings)),null!=e.mip&&(t.mip=0|e.mip),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.layer=0,i.x=0,i.y=0,i.width=0,i.height=0,t.bytes===String?i.imageData="":(i.imageData=[],t.bytes!==Array&&(i.imageData=Dt.newBuffer(i.imageData))),t.bytes===String?i.nanEncodings="":(i.nanEncodings=[],t.bytes!==Array&&(i.nanEncodings=Dt.newBuffer(i.nanEncodings))),i.mip=0),null!=e.layer&&e.hasOwnProperty("layer")&&(i.layer=e.layer),null!=e.x&&e.hasOwnProperty("x")&&(i.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=e.y),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),null!=e.imageData&&e.hasOwnProperty("imageData")&&(i.imageData=t.bytes===String?Dt.base64.encode(e.imageData,0,e.imageData.length):t.bytes===Array?Array.prototype.slice.call(e.imageData):e.imageData),null!=e.nanEncodings&&e.hasOwnProperty("nanEncodings")&&(i.nanEncodings=t.bytes===String?Dt.base64.encode(e.nanEncodings,0,e.nanEncodings.length):t.bytes===Array?Array.prototype.slice.call(e.nanEncodings):e.nanEncodings),null!=e.mip&&e.hasOwnProperty("mip")&&(i.mip=e.mip),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.GaussianComponent=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.center=null,e.prototype.amp=0,e.prototype.fwhm=null,e.prototype.pa=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.center&&Object.hasOwnProperty.call(e,"center")&&Lt.CARTA.DoublePoint.encode(e.center,t.uint32(10).fork()).ldelim(),null!=e.amp&&Object.hasOwnProperty.call(e,"amp")&&t.uint32(17).double(e.amp),null!=e.fwhm&&Object.hasOwnProperty.call(e,"fwhm")&&Lt.CARTA.DoublePoint.encode(e.fwhm,t.uint32(26).fork()).ldelim(),null!=e.pa&&Object.hasOwnProperty.call(e,"pa")&&t.uint32(33).double(e.pa),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.GaussianComponent;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.center=Lt.CARTA.DoublePoint.decode(e,e.uint32());break;case 2:n.amp=e.double();break;case 3:n.fwhm=Lt.CARTA.DoublePoint.decode(e,e.uint32());break;case 4:n.pa=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.center&&e.hasOwnProperty("center")){let t=Lt.CARTA.DoublePoint.verify(e.center);if(t)return"center."+t}if(null!=e.amp&&e.hasOwnProperty("amp")&&"number"!==typeof e.amp)return"amp: number expected";if(null!=e.fwhm&&e.hasOwnProperty("fwhm")){let t=Lt.CARTA.DoublePoint.verify(e.fwhm);if(t)return"fwhm."+t}return null!=e.pa&&e.hasOwnProperty("pa")&&"number"!==typeof e.pa?"pa: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.GaussianComponent)return e;let t=new Lt.CARTA.GaussianComponent;if(null!=e.center){if("object"!==typeof e.center)throw TypeError(".CARTA.GaussianComponent.center: object expected");t.center=Lt.CARTA.DoublePoint.fromObject(e.center)}if(null!=e.amp&&(t.amp=Number(e.amp)),null!=e.fwhm){if("object"!==typeof e.fwhm)throw TypeError(".CARTA.GaussianComponent.fwhm: object expected");t.fwhm=Lt.CARTA.DoublePoint.fromObject(e.fwhm)}return null!=e.pa&&(t.pa=Number(e.pa)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.center=null,i.amp=0,i.fwhm=null,i.pa=0),null!=e.center&&e.hasOwnProperty("center")&&(i.center=Lt.CARTA.DoublePoint.toObject(e.center,t)),null!=e.amp&&e.hasOwnProperty("amp")&&(i.amp=t.json&&!isFinite(e.amp)?String(e.amp):e.amp),null!=e.fwhm&&e.hasOwnProperty("fwhm")&&(i.fwhm=Lt.CARTA.DoublePoint.toObject(e.fwhm,t)),null!=e.pa&&e.hasOwnProperty("pa")&&(i.pa=t.json&&!isFinite(e.pa)?String(e.pa):e.pa),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.EventType=function(){const e={},t=Object.create(e);return t[e[0]="EMPTY_EVENT"]=0,t[e[1]="REGISTER_VIEWER"]=1,t[e[2]="FILE_LIST_REQUEST"]=2,t[e[3]="FILE_INFO_REQUEST"]=3,t[e[4]="OPEN_FILE"]=4,t[e[6]="SET_IMAGE_CHANNELS"]=6,t[e[7]="SET_CURSOR"]=7,t[e[8]="SET_SPATIAL_REQUIREMENTS"]=8,t[e[9]="SET_HISTOGRAM_REQUIREMENTS"]=9,t[e[10]="SET_STATS_REQUIREMENTS"]=10,t[e[11]="SET_REGION"]=11,t[e[12]="REMOVE_REGION"]=12,t[e[13]="CLOSE_FILE"]=13,t[e[14]="SET_SPECTRAL_REQUIREMENTS"]=14,t[e[15]="START_ANIMATION"]=15,t[e[16]="START_ANIMATION_ACK"]=16,t[e[17]="STOP_ANIMATION"]=17,t[e[18]="REGISTER_VIEWER_ACK"]=18,t[e[19]="FILE_LIST_RESPONSE"]=19,t[e[20]="FILE_INFO_RESPONSE"]=20,t[e[21]="OPEN_FILE_ACK"]=21,t[e[22]="SET_REGION_ACK"]=22,t[e[23]="REGION_HISTOGRAM_DATA"]=23,t[e[25]="SPATIAL_PROFILE_DATA"]=25,t[e[26]="SPECTRAL_PROFILE_DATA"]=26,t[e[27]="REGION_STATS_DATA"]=27,t[e[28]="ERROR_DATA"]=28,t[e[29]="ANIMATION_FLOW_CONTROL"]=29,t[e[30]="ADD_REQUIRED_TILES"]=30,t[e[31]="REMOVE_REQUIRED_TILES"]=31,t[e[32]="RASTER_TILE_DATA"]=32,t[e[33]="REGION_LIST_REQUEST"]=33,t[e[34]="REGION_LIST_RESPONSE"]=34,t[e[35]="REGION_FILE_INFO_REQUEST"]=35,t[e[36]="REGION_FILE_INFO_RESPONSE"]=36,t[e[37]="IMPORT_REGION"]=37,t[e[38]="IMPORT_REGION_ACK"]=38,t[e[39]="EXPORT_REGION"]=39,t[e[40]="EXPORT_REGION_ACK"]=40,t[e[45]="SET_CONTOUR_PARAMETERS"]=45,t[e[46]="CONTOUR_IMAGE_DATA"]=46,t[e[47]="RESUME_SESSION"]=47,t[e[48]="RESUME_SESSION_ACK"]=48,t[e[49]="RASTER_TILE_SYNC"]=49,t[e[50]="CATALOG_LIST_REQUEST"]=50,t[e[51]="CATALOG_LIST_RESPONSE"]=51,t[e[52]="CATALOG_FILE_INFO_REQUEST"]=52,t[e[53]="CATALOG_FILE_INFO_RESPONSE"]=53,t[e[54]="OPEN_CATALOG_FILE"]=54,t[e[55]="OPEN_CATALOG_FILE_ACK"]=55,t[e[56]="CLOSE_CATALOG_FILE"]=56,t[e[57]="CATALOG_FILTER_REQUEST"]=57,t[e[58]="CATALOG_FILTER_RESPONSE"]=58,t[e[59]="SCRIPTING_REQUEST"]=59,t[e[60]="SCRIPTING_RESPONSE"]=60,t[e[61]="MOMENT_REQUEST"]=61,t[e[62]="MOMENT_RESPONSE"]=62,t[e[63]="MOMENT_PROGRESS"]=63,t[e[64]="STOP_MOMENT_CALC"]=64,t[e[65]="SAVE_FILE"]=65,t[e[66]="SAVE_FILE_ACK"]=66,t[e[67]="SPECTRAL_LINE_REQUEST"]=67,t[e[68]="SPECTRAL_LINE_RESPONSE"]=68,t[e[69]="CONCAT_STOKES_FILES"]=69,t[e[70]="CONCAT_STOKES_FILES_ACK"]=70,t[e[71]="FILE_LIST_PROGRESS"]=71,t[e[72]="STOP_FILE_LIST"]=72,t[e[73]="SPLATALOGUE_PING"]=73,t[e[74]="SPLATALOGUE_PONG"]=74,t[e[75]="PV_REQUEST"]=75,t[e[76]="PV_RESPONSE"]=76,t[e[77]="PV_PROGRESS"]=77,t[e[78]="STOP_PV_CALC"]=78,t[e[79]="FITTING_REQUEST"]=79,t[e[80]="FITTING_RESPONSE"]=80,t[e[81]="SET_VECTOR_OVERLAY_PARAMETERS"]=81,t[e[82]="VECTOR_OVERLAY_TILE_DATA"]=82,t}(),e.SessionType=function(){const e={},t=Object.create(e);return t[e[0]="NEW"]=0,t[e[1]="RESUMED"]=1,t}(),e.FileType=function(){const e={},t=Object.create(e);return t[e[0]="CASA"]=0,t[e[1]="CRTF"]=1,t[e[2]="DS9_REG"]=2,t[e[3]="FITS"]=3,t[e[4]="HDF5"]=4,t[e[5]="MIRIAD"]=5,t[e[6]="UNKNOWN"]=6,t}(),e.RenderMode=function(){const e={},t=Object.create(e);return t[e[0]="RASTER"]=0,t[e[1]="CONTOUR"]=1,t}(),e.CompressionType=function(){const e={},t=Object.create(e);return t[e[0]="NONE"]=0,t[e[1]="ZFP"]=1,t[e[2]="SZ"]=2,t}(),e.RegionType=function(){const e={},t=Object.create(e);return t[e[0]="POINT"]=0,t[e[1]="LINE"]=1,t[e[2]="POLYLINE"]=2,t[e[3]="RECTANGLE"]=3,t[e[4]="ELLIPSE"]=4,t[e[5]="ANNULUS"]=5,t[e[6]="POLYGON"]=6,t}(),e.SmoothingMode=function(){const e={},t=Object.create(e);return t[e[0]="NoSmoothing"]=0,t[e[1]="BlockAverage"]=1,t[e[2]="GaussianBlur"]=2,t}(),e.StatsType=function(){const e={},t=Object.create(e);return t[e[0]="NumPixels"]=0,t[e[1]="NanCount"]=1,t[e[2]="Sum"]=2,t[e[3]="FluxDensity"]=3,t[e[4]="Mean"]=4,t[e[5]="RMS"]=5,t[e[6]="Sigma"]=6,t[e[7]="SumSq"]=7,t[e[8]="Min"]=8,t[e[9]="Max"]=9,t[e[10]="Extrema"]=10,t[e[11]="Blc"]=11,t[e[12]="Trc"]=12,t[e[13]="MinPos"]=13,t[e[14]="MaxPos"]=14,t[e[15]="Blcf"]=15,t[e[16]="Trcf"]=16,t[e[17]="MinPosf"]=17,t[e[18]="MaxPosf"]=18,t}(),e.ErrorSeverity=function(){const e={},t=Object.create(e);return t[e[0]="DEBUG"]=0,t[e[1]="INFO"]=1,t[e[2]="WARNING"]=2,t[e[3]="ERROR"]=3,t[e[4]="CRITICAL"]=4,t}(),e.EntryType=function(){const e={},t=Object.create(e);return t[e[0]="STRING"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t}(),e.ClientFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="CLIENT_FEATURE_NONE"]=0,t[e[1]="WEB_GL"]=1,t[e[2]="WEB_GL_2"]=2,t[e[4]="WEB_ASSEMBLY"]=4,t[e[8]="WEB_ASSEMBLY_THREADS"]=8,t[e[16]="OFFSCREEN_CANVAS"]=16,t}(),e.ServerFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="SERVER_FEATURE_NONE"]=0,t[e[1]="SZ_COMPRESSION"]=1,t[e[2]="HEVC_COMPRESSION"]=2,t[e[4]="NVENC_COMPRESSION"]=4,t[e[8]="READ_ONLY"]=8,t[e[16]="USER_PREFERENCES"]=16,t[e[32]="USER_LAYOUTS"]=32,t[e[64]="SCRIPTING"]=64,t}(),e.FileFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="FILE_FEATURE_NONE"]=0,t[e[1]="ROTATED_DATASET"]=1,t[e[2]="CHANNEL_HISTOGRAMS"]=2,t[e[4]="CUBE_HISTOGRAMS"]=4,t[e[8]="CHANNEL_STATS"]=8,t[e[16]="MEAN_IMAGE"]=16,t[e[32]="MIP_DATASET"]=32,t}(),e.CoordinateType=function(){const e={},t=Object.create(e);return t[e[0]="PIXEL"]=0,t[e[1]="WORLD"]=1,t}(),e.CatalogFileType=function(){const e={},t=Object.create(e);return t[e[0]="FITSTable"]=0,t[e[1]="VOTable"]=1,t[e[2]="Unknown"]=2,t}(),e.ColumnType=function(){const e={},t=Object.create(e);return t[e[0]="UnsupportedType"]=0,t[e[1]="String"]=1,t[e[2]="Uint8"]=2,t[e[3]="Int8"]=3,t[e[4]="Uint16"]=4,t[e[5]="Int16"]=5,t[e[6]="Uint32"]=6,t[e[7]="Int32"]=7,t[e[8]="Uint64"]=8,t[e[9]="Int64"]=9,t[e[10]="Float"]=10,t[e[11]="Double"]=11,t[e[12]="Bool"]=12,t}(),e.ComparisonOperator=function(){const e={},t=Object.create(e);return t[e[0]="Equal"]=0,t[e[1]="NotEqual"]=1,t[e[2]="Lesser"]=2,t[e[3]="Greater"]=3,t[e[4]="LessorOrEqual"]=4,t[e[5]="GreaterOrEqual"]=5,t[e[6]="RangeOpen"]=6,t[e[7]="RangeClosed"]=7,t}(),e.SortingType=function(){const e={},t=Object.create(e);return t[e[0]="Ascending"]=0,t[e[1]="Descending"]=1,t}(),e.Moment=function(){const e={},t=Object.create(e);return t[e[0]="MEAN_OF_THE_SPECTRUM"]=0,t[e[1]="INTEGRATED_OF_THE_SPECTRUM"]=1,t[e[2]="INTENSITY_WEIGHTED_COORD"]=2,t[e[3]="INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD"]=3,t[e[4]="MEDIAN_OF_THE_SPECTRUM"]=4,t[e[5]="MEDIAN_COORDINATE"]=5,t[e[6]="STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM"]=6,t[e[7]="RMS_OF_THE_SPECTRUM"]=7,t[e[8]="ABS_MEAN_DEVIATION_OF_THE_SPECTRUM"]=8,t[e[9]="MAX_OF_THE_SPECTRUM"]=9,t[e[10]="COORD_OF_THE_MAX_OF_THE_SPECTRUM"]=10,t[e[11]="MIN_OF_THE_SPECTRUM"]=11,t[e[12]="COORD_OF_THE_MIN_OF_THE_SPECTRUM"]=12,t}(),e.MomentAxis=function(){const e={},t=Object.create(e);return t[e[0]="SPECTRAL"]=0,t[e[1]="STOKES"]=1,t}(),e.MomentMask=function(){const e={},t=Object.create(e);return t[e[0]="None"]=0,t[e[1]="Include"]=1,t[e[2]="Exclude"]=2,t}(),e.PolarizationType=function(){const e={},t=Object.create(e);return t[e[0]="POLARIZATION_TYPE_NONE"]=0,t[e[1]="I"]=1,t[e[2]="Q"]=2,t[e[3]="U"]=3,t[e[4]="V"]=4,t[e[5]="RR"]=5,t[e[6]="LL"]=6,t[e[7]="RL"]=7,t[e[8]="LR"]=8,t[e[9]="XX"]=9,t[e[10]="YY"]=10,t[e[11]="XY"]=11,t[e[12]="YX"]=12,t[e[13]="Ptotal"]=13,t[e[14]="Plinear"]=14,t[e[15]="PFtotal"]=15,t[e[16]="PFlinear"]=16,t[e[17]="Pangle"]=17,t}(),e.FileListType=function(){const e={},t=Object.create(e);return t[e[0]="Image"]=0,t[e[1]="Catalog"]=1,t}(),e.FileListFilterMode=function(){const e={},t=Object.create(e);return t[e[0]="Content"]=0,t[e[1]="Extension"]=1,t[e[2]="AllFiles"]=2,t}(),e.ProfileAxisType=function(){const e={},t=Object.create(e);return t[e[0]="Offset"]=0,t[e[1]="Distance"]=1,t}(),e.StartAnimation=function(){function e(e){if(this.matchedFrames={},this.stokesIndices=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.firstFrame=null,e.prototype.startFrame=null,e.prototype.lastFrame=null,e.prototype.deltaFrame=null,e.prototype.frameRate=0,e.prototype.looping=!1,e.prototype.reverse=!1,e.prototype.requiredTiles=null,e.prototype.matchedFrames=Dt.emptyObject,e.prototype.stokesIndices=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.firstFrame&&Object.hasOwnProperty.call(e,"firstFrame")&&Lt.CARTA.AnimationFrame.encode(e.firstFrame,t.uint32(18).fork()).ldelim(),null!=e.startFrame&&Object.hasOwnProperty.call(e,"startFrame")&&Lt.CARTA.AnimationFrame.encode(e.startFrame,t.uint32(26).fork()).ldelim(),null!=e.lastFrame&&Object.hasOwnProperty.call(e,"lastFrame")&&Lt.CARTA.AnimationFrame.encode(e.lastFrame,t.uint32(34).fork()).ldelim(),null!=e.deltaFrame&&Object.hasOwnProperty.call(e,"deltaFrame")&&Lt.CARTA.AnimationFrame.encode(e.deltaFrame,t.uint32(42).fork()).ldelim(),null!=e.frameRate&&Object.hasOwnProperty.call(e,"frameRate")&&t.uint32(53).sfixed32(e.frameRate),null!=e.looping&&Object.hasOwnProperty.call(e,"looping")&&t.uint32(56).bool(e.looping),null!=e.reverse&&Object.hasOwnProperty.call(e,"reverse")&&t.uint32(64).bool(e.reverse),null!=e.requiredTiles&&Object.hasOwnProperty.call(e,"requiredTiles")&&Lt.CARTA.AddRequiredTiles.encode(e.requiredTiles,t.uint32(74).fork()).ldelim(),null!=e.matchedFrames&&Object.hasOwnProperty.call(e,"matchedFrames"))for(let i=Object.keys(e.matchedFrames),n=0;n<i.length;++n)t.uint32(82).fork().uint32(13).sfixed32(i[n]),Lt.CARTA.MatchedFrameList.encode(e.matchedFrames[i[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.stokesIndices&&e.stokesIndices.length){t.uint32(90).fork();for(let i=0;i<e.stokesIndices.length;++i)t.sfixed32(e.stokesIndices[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.StartAnimation;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.fileId=e.sfixed32();break;case 2:r.firstFrame=Lt.CARTA.AnimationFrame.decode(e,e.uint32());break;case 3:r.startFrame=Lt.CARTA.AnimationFrame.decode(e,e.uint32());break;case 4:r.lastFrame=Lt.CARTA.AnimationFrame.decode(e,e.uint32());break;case 5:r.deltaFrame=Lt.CARTA.AnimationFrame.decode(e,e.uint32());break;case 6:r.frameRate=e.sfixed32();break;case 7:r.looping=e.bool();break;case 8:r.reverse=e.bool();break;case 9:r.requiredTiles=Lt.CARTA.AddRequiredTiles.decode(e,e.uint32());break;case 10:e.skip().pos++,r.matchedFrames===Dt.emptyObject&&(r.matchedFrames={}),i=e.sfixed32(),e.pos++,r.matchedFrames[i]=Lt.CARTA.MatchedFrameList.decode(e,e.uint32());break;case 11:if(r.stokesIndices&&r.stokesIndices.length||(r.stokesIndices=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)r.stokesIndices.push(e.sfixed32())}else r.stokesIndices.push(e.sfixed32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.firstFrame&&e.hasOwnProperty("firstFrame")){let t=Lt.CARTA.AnimationFrame.verify(e.firstFrame);if(t)return"firstFrame."+t}if(null!=e.startFrame&&e.hasOwnProperty("startFrame")){let t=Lt.CARTA.AnimationFrame.verify(e.startFrame);if(t)return"startFrame."+t}if(null!=e.lastFrame&&e.hasOwnProperty("lastFrame")){let t=Lt.CARTA.AnimationFrame.verify(e.lastFrame);if(t)return"lastFrame."+t}if(null!=e.deltaFrame&&e.hasOwnProperty("deltaFrame")){let t=Lt.CARTA.AnimationFrame.verify(e.deltaFrame);if(t)return"deltaFrame."+t}if(null!=e.frameRate&&e.hasOwnProperty("frameRate")&&!Dt.isInteger(e.frameRate))return"frameRate: integer expected";if(null!=e.looping&&e.hasOwnProperty("looping")&&"boolean"!==typeof e.looping)return"looping: boolean expected";if(null!=e.reverse&&e.hasOwnProperty("reverse")&&"boolean"!==typeof e.reverse)return"reverse: boolean expected";if(null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")){let t=Lt.CARTA.AddRequiredTiles.verify(e.requiredTiles);if(t)return"requiredTiles."+t}if(null!=e.matchedFrames&&e.hasOwnProperty("matchedFrames")){if(!Dt.isObject(e.matchedFrames))return"matchedFrames: object expected";let t=Object.keys(e.matchedFrames);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"matchedFrames: integer key{k:sfixed32} expected";{let n=Lt.CARTA.MatchedFrameList.verify(e.matchedFrames[t[i]]);if(n)return"matchedFrames."+n}}}if(null!=e.stokesIndices&&e.hasOwnProperty("stokesIndices")){if(!Array.isArray(e.stokesIndices))return"stokesIndices: array expected";for(let t=0;t<e.stokesIndices.length;++t)if(!Dt.isInteger(e.stokesIndices[t]))return"stokesIndices: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StartAnimation)return e;let t=new Lt.CARTA.StartAnimation;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.firstFrame){if("object"!==typeof e.firstFrame)throw TypeError(".CARTA.StartAnimation.firstFrame: object expected");t.firstFrame=Lt.CARTA.AnimationFrame.fromObject(e.firstFrame)}if(null!=e.startFrame){if("object"!==typeof e.startFrame)throw TypeError(".CARTA.StartAnimation.startFrame: object expected");t.startFrame=Lt.CARTA.AnimationFrame.fromObject(e.startFrame)}if(null!=e.lastFrame){if("object"!==typeof e.lastFrame)throw TypeError(".CARTA.StartAnimation.lastFrame: object expected");t.lastFrame=Lt.CARTA.AnimationFrame.fromObject(e.lastFrame)}if(null!=e.deltaFrame){if("object"!==typeof e.deltaFrame)throw TypeError(".CARTA.StartAnimation.deltaFrame: object expected");t.deltaFrame=Lt.CARTA.AnimationFrame.fromObject(e.deltaFrame)}if(null!=e.frameRate&&(t.frameRate=0|e.frameRate),null!=e.looping&&(t.looping=Boolean(e.looping)),null!=e.reverse&&(t.reverse=Boolean(e.reverse)),null!=e.requiredTiles){if("object"!==typeof e.requiredTiles)throw TypeError(".CARTA.StartAnimation.requiredTiles: object expected");t.requiredTiles=Lt.CARTA.AddRequiredTiles.fromObject(e.requiredTiles)}if(e.matchedFrames){if("object"!==typeof e.matchedFrames)throw TypeError(".CARTA.StartAnimation.matchedFrames: object expected");t.matchedFrames={};for(let i=Object.keys(e.matchedFrames),n=0;n<i.length;++n){if("object"!==typeof e.matchedFrames[i[n]])throw TypeError(".CARTA.StartAnimation.matchedFrames: object expected");t.matchedFrames[i[n]]=Lt.CARTA.MatchedFrameList.fromObject(e.matchedFrames[i[n]])}}if(e.stokesIndices){if(!Array.isArray(e.stokesIndices))throw TypeError(".CARTA.StartAnimation.stokesIndices: array expected");t.stokesIndices=[];for(let i=0;i<e.stokesIndices.length;++i)t.stokesIndices[i]=0|e.stokesIndices[i]}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.stokesIndices=[]),(t.objects||t.defaults)&&(n.matchedFrames={}),t.defaults&&(n.fileId=0,n.firstFrame=null,n.startFrame=null,n.lastFrame=null,n.deltaFrame=null,n.frameRate=0,n.looping=!1,n.reverse=!1,n.requiredTiles=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.firstFrame&&e.hasOwnProperty("firstFrame")&&(n.firstFrame=Lt.CARTA.AnimationFrame.toObject(e.firstFrame,t)),null!=e.startFrame&&e.hasOwnProperty("startFrame")&&(n.startFrame=Lt.CARTA.AnimationFrame.toObject(e.startFrame,t)),null!=e.lastFrame&&e.hasOwnProperty("lastFrame")&&(n.lastFrame=Lt.CARTA.AnimationFrame.toObject(e.lastFrame,t)),null!=e.deltaFrame&&e.hasOwnProperty("deltaFrame")&&(n.deltaFrame=Lt.CARTA.AnimationFrame.toObject(e.deltaFrame,t)),null!=e.frameRate&&e.hasOwnProperty("frameRate")&&(n.frameRate=e.frameRate),null!=e.looping&&e.hasOwnProperty("looping")&&(n.looping=e.looping),null!=e.reverse&&e.hasOwnProperty("reverse")&&(n.reverse=e.reverse),null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")&&(n.requiredTiles=Lt.CARTA.AddRequiredTiles.toObject(e.requiredTiles,t)),e.matchedFrames&&(i=Object.keys(e.matchedFrames)).length){n.matchedFrames={};for(let r=0;r<i.length;++r)n.matchedFrames[i[r]]=Lt.CARTA.MatchedFrameList.toObject(e.matchedFrames[i[r]],t)}if(e.stokesIndices&&e.stokesIndices.length){n.stokesIndices=[];for(let t=0;t<e.stokesIndices.length;++t)n.stokesIndices[t]=e.stokesIndices[t]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StartAnimationAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.animationId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(29).sfixed32(e.animationId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StartAnimationAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.animationId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null!=e.animationId&&e.hasOwnProperty("animationId")&&!Dt.isInteger(e.animationId)?"animationId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StartAnimationAck)return e;let t=new Lt.CARTA.StartAnimationAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.animationId&&(t.animationId=0|e.animationId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.animationId=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.AnimationFlowControl=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.receivedFrame=null,e.prototype.animationId=0,e.prototype.timestamp=Dt.Long?Dt.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.receivedFrame&&Object.hasOwnProperty.call(e,"receivedFrame")&&Lt.CARTA.AnimationFrame.encode(e.receivedFrame,t.uint32(18).fork()).ldelim(),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(29).sfixed32(e.animationId),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(33).sfixed64(e.timestamp),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.AnimationFlowControl;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.receivedFrame=Lt.CARTA.AnimationFrame.decode(e,e.uint32());break;case 3:n.animationId=e.sfixed32();break;case 4:n.timestamp=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.receivedFrame&&e.hasOwnProperty("receivedFrame")){let t=Lt.CARTA.AnimationFrame.verify(e.receivedFrame);if(t)return"receivedFrame."+t}return null!=e.animationId&&e.hasOwnProperty("animationId")&&!Dt.isInteger(e.animationId)?"animationId: integer expected":null==e.timestamp||!e.hasOwnProperty("timestamp")||Dt.isInteger(e.timestamp)||e.timestamp&&Dt.isInteger(e.timestamp.low)&&Dt.isInteger(e.timestamp.high)?null:"timestamp: integer|Long expected"},e.fromObject=function(e){if(e instanceof Lt.CARTA.AnimationFlowControl)return e;let t=new Lt.CARTA.AnimationFlowControl;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.receivedFrame){if("object"!==typeof e.receivedFrame)throw TypeError(".CARTA.AnimationFlowControl.receivedFrame: object expected");t.receivedFrame=Lt.CARTA.AnimationFrame.fromObject(e.receivedFrame)}return null!=e.animationId&&(t.animationId=0|e.animationId),null!=e.timestamp&&(Dt.Long?(t.timestamp=Dt.Long.fromValue(e.timestamp)).unsigned=!1:"string"===typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"===typeof e.timestamp?t.timestamp=e.timestamp:"object"===typeof e.timestamp&&(t.timestamp=new Dt.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if(t.defaults)if(i.fileId=0,i.receivedFrame=null,i.animationId=0,Dt.Long){let e=new Dt.Long(0,0,!1);i.timestamp=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.timestamp=t.longs===String?"0":0;return null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.receivedFrame&&e.hasOwnProperty("receivedFrame")&&(i.receivedFrame=Lt.CARTA.AnimationFrame.toObject(e.receivedFrame,t)),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"===typeof e.timestamp?i.timestamp=t.longs===String?String(e.timestamp):e.timestamp:i.timestamp=t.longs===String?Dt.Long.prototype.toString.call(e.timestamp):t.longs===Number?new Dt.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StopAnimation=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.endFrame=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.endFrame&&Object.hasOwnProperty.call(e,"endFrame")&&Lt.CARTA.AnimationFrame.encode(e.endFrame,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StopAnimation;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.endFrame=Lt.CARTA.AnimationFrame.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.endFrame&&e.hasOwnProperty("endFrame")){let t=Lt.CARTA.AnimationFrame.verify(e.endFrame);if(t)return"endFrame."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StopAnimation)return e;let t=new Lt.CARTA.StopAnimation;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.endFrame){if("object"!==typeof e.endFrame)throw TypeError(".CARTA.StopAnimation.endFrame: object expected");t.endFrame=Lt.CARTA.AnimationFrame.fromObject(e.endFrame)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.endFrame=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.endFrame&&e.hasOwnProperty("endFrame")&&(i.endFrame=Lt.CARTA.AnimationFrame.toObject(e.endFrame,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.AddRequiredTiles=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.tiles=Dt.emptyArray,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.tiles&&e.tiles.length){t.uint32(18).fork();for(let i=0;i<e.tiles.length;++i)t.sfixed32(e.tiles[i]);t.ldelim()}return null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(24).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(37).float(e.compressionQuality),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.AddRequiredTiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.tiles&&n.tiles.length||(n.tiles=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.tiles.push(e.sfixed32())}else n.tiles.push(e.sfixed32());break;case 3:n.compressionType=e.int32();break;case 4:n.compressionQuality=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t)if(!Dt.isInteger(e.tiles[t]))return"tiles: integer[] expected"}if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}return null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality?"compressionQuality: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.AddRequiredTiles)return e;let t=new Lt.CARTA.AddRequiredTiles;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.AddRequiredTiles.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i)t.tiles[i]=0|e.tiles[i]}switch(e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}return null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.tiles&&e.tiles.length){i.tiles=[];for(let t=0;t<e.tiles.length;++t)i.tiles[t]=e.tiles[t]}return null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?Lt.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RemoveRequiredTiles=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.tiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.tiles&&e.tiles.length){t.uint32(18).fork();for(let i=0;i<e.tiles.length;++i)t.sfixed32(e.tiles[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RemoveRequiredTiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.tiles&&n.tiles.length||(n.tiles=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.tiles.push(e.sfixed32())}else n.tiles.push(e.sfixed32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t)if(!Dt.isInteger(e.tiles[t]))return"tiles: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RemoveRequiredTiles)return e;let t=new Lt.CARTA.RemoveRequiredTiles;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.RemoveRequiredTiles.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i)t.tiles[i]=0|e.tiles[i]}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.tiles&&e.tiles.length){i.tiles=[];for(let t=0;t<e.tiles.length;++t)i.tiles[t]=e.tiles[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CloseFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CloseFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CloseFile)return e;let t=new Lt.CARTA.CloseFile;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ConcatStokesFiles=function(){function e(e){if(this.stokesFiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.stokesFiles=Dt.emptyArray,e.prototype.fileId=0,e.prototype.renderMode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.stokesFiles&&e.stokesFiles.length)for(let i=0;i<e.stokesFiles.length;++i)Lt.CARTA.StokesFile.encode(e.stokesFiles[i],t.uint32(10).fork()).ldelim();return null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(21).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(24).int32(e.renderMode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ConcatStokesFiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.stokesFiles&&n.stokesFiles.length||(n.stokesFiles=[]),n.stokesFiles.push(Lt.CARTA.StokesFile.decode(e,e.uint32()));break;case 2:n.fileId=e.sfixed32();break;case 3:n.renderMode=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.stokesFiles&&e.hasOwnProperty("stokesFiles")){if(!Array.isArray(e.stokesFiles))return"stokesFiles: array expected";for(let t=0;t<e.stokesFiles.length;++t){let i=Lt.CARTA.StokesFile.verify(e.stokesFiles[t]);if(i)return"stokesFiles."+i}}if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ConcatStokesFiles)return e;let t=new Lt.CARTA.ConcatStokesFiles;if(e.stokesFiles){if(!Array.isArray(e.stokesFiles))throw TypeError(".CARTA.ConcatStokesFiles.stokesFiles: array expected");t.stokesFiles=[];for(let i=0;i<e.stokesFiles.length;++i){if("object"!==typeof e.stokesFiles[i])throw TypeError(".CARTA.ConcatStokesFiles.stokesFiles: object expected");t.stokesFiles[i]=Lt.CARTA.StokesFile.fromObject(e.stokesFiles[i])}}switch(null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stokesFiles=[]),t.defaults&&(i.fileId=0,i.renderMode=t.enums===String?"RASTER":0),e.stokesFiles&&e.stokesFiles.length){i.stokesFiles=[];for(let n=0;n<e.stokesFiles.length;++n)i.stokesFiles[n]=Lt.CARTA.StokesFile.toObject(e.stokesFiles[n],t)}return null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(i.renderMode=t.enums===String?Lt.CARTA.RenderMode[e.renderMode]:e.renderMode),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StokesFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.polarizationType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.polarizationType&&Object.hasOwnProperty.call(e,"polarizationType")&&t.uint32(32).int32(e.polarizationType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StokesFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;case 4:n.polarizationType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!Dt.isString(e.hdu))return"hdu: string expected";if(null!=e.polarizationType&&e.hasOwnProperty("polarizationType"))switch(e.polarizationType){default:return"polarizationType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StokesFile)return e;let t=new Lt.CARTA.StokesFile;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),e.polarizationType){case"POLARIZATION_TYPE_NONE":case 0:t.polarizationType=0;break;case"I":case 1:t.polarizationType=1;break;case"Q":case 2:t.polarizationType=2;break;case"U":case 3:t.polarizationType=3;break;case"V":case 4:t.polarizationType=4;break;case"RR":case 5:t.polarizationType=5;break;case"LL":case 6:t.polarizationType=6;break;case"RL":case 7:t.polarizationType=7;break;case"LR":case 8:t.polarizationType=8;break;case"XX":case 9:t.polarizationType=9;break;case"YY":case 10:t.polarizationType=10;break;case"XY":case 11:t.polarizationType=11;break;case"YX":case 12:t.polarizationType=12;break;case"Ptotal":case 13:t.polarizationType=13;break;case"Plinear":case 14:t.polarizationType=14;break;case"PFtotal":case 15:t.polarizationType=15;break;case"PFlinear":case 16:t.polarizationType=16;break;case"Pangle":case 17:t.polarizationType=17}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu="",i.polarizationType=t.enums===String?"POLARIZATION_TYPE_NONE":0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),null!=e.polarizationType&&e.hasOwnProperty("polarizationType")&&(i.polarizationType=t.enums===String?Lt.CARTA.PolarizationType[e.polarizationType]:e.polarizationType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ConcatStokesFilesAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.openFileAck=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.openFileAck&&Object.hasOwnProperty.call(e,"openFileAck")&&Lt.CARTA.OpenFileAck.encode(e.openFileAck,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ConcatStokesFilesAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.openFileAck=Lt.CARTA.OpenFileAck.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.openFileAck&&e.hasOwnProperty("openFileAck")){let t=Lt.CARTA.OpenFileAck.verify(e.openFileAck);if(t)return"openFileAck."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ConcatStokesFilesAck)return e;let t=new Lt.CARTA.ConcatStokesFilesAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.openFileAck){if("object"!==typeof e.openFileAck)throw TypeError(".CARTA.ConcatStokesFilesAck.openFileAck: object expected");t.openFileAck=Lt.CARTA.OpenFileAck.fromObject(e.openFileAck)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.openFileAck=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.openFileAck&&e.hasOwnProperty("openFileAck")&&(i.openFileAck=Lt.CARTA.OpenFileAck.toObject(e.openFileAck,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.OpenFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.fileId=0,e.prototype.renderMode=0,e.prototype.lelExpr=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(37).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(40).int32(e.renderMode),null!=e.lelExpr&&Object.hasOwnProperty.call(e,"lelExpr")&&t.uint32(48).bool(e.lelExpr),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.OpenFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;case 4:n.fileId=e.sfixed32();break;case 5:n.renderMode=e.int32();break;case 6:n.lelExpr=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!Dt.isString(e.hdu))return"hdu: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}return null!=e.lelExpr&&e.hasOwnProperty("lelExpr")&&"boolean"!==typeof e.lelExpr?"lelExpr: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.OpenFile)return e;let t=new Lt.CARTA.OpenFile;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}return null!=e.lelExpr&&(t.lelExpr=Boolean(e.lelExpr)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu="",i.fileId=0,i.renderMode=t.enums===String?"RASTER":0,i.lelExpr=!1),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(i.renderMode=t.enums===String?Lt.CARTA.RenderMode[e.renderMode]:e.renderMode),null!=e.lelExpr&&e.hasOwnProperty("lelExpr")&&(i.lelExpr=e.lelExpr),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.OpenFileAck=function(){function e(e){if(this.beamTable=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.fileId=0,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.fileInfoExtended=null,e.prototype.fileFeatureFlags=0,e.prototype.beamTable=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(21).sfixed32(e.fileId),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&Lt.CARTA.FileInfo.encode(e.fileInfo,t.uint32(34).fork()).ldelim(),null!=e.fileInfoExtended&&Object.hasOwnProperty.call(e,"fileInfoExtended")&&Lt.CARTA.FileInfoExtended.encode(e.fileInfoExtended,t.uint32(42).fork()).ldelim(),null!=e.fileFeatureFlags&&Object.hasOwnProperty.call(e,"fileFeatureFlags")&&t.uint32(53).fixed32(e.fileFeatureFlags),null!=e.beamTable&&e.beamTable.length)for(let i=0;i<e.beamTable.length;++i)Lt.CARTA.Beam.encode(e.beamTable[i],t.uint32(58).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.OpenFileAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.fileId=e.sfixed32();break;case 3:n.message=e.string();break;case 4:n.fileInfo=Lt.CARTA.FileInfo.decode(e,e.uint32());break;case 5:n.fileInfoExtended=Lt.CARTA.FileInfoExtended.decode(e,e.uint32());break;case 6:n.fileFeatureFlags=e.fixed32();break;case 7:n.beamTable&&n.beamTable.length||(n.beamTable=[]),n.beamTable.push(Lt.CARTA.Beam.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=Lt.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")){let t=Lt.CARTA.FileInfoExtended.verify(e.fileInfoExtended);if(t)return"fileInfoExtended."+t}if(null!=e.fileFeatureFlags&&e.hasOwnProperty("fileFeatureFlags")&&!Dt.isInteger(e.fileFeatureFlags))return"fileFeatureFlags: integer expected";if(null!=e.beamTable&&e.hasOwnProperty("beamTable")){if(!Array.isArray(e.beamTable))return"beamTable: array expected";for(let t=0;t<e.beamTable.length;++t){let i=Lt.CARTA.Beam.verify(e.beamTable[t]);if(i)return"beamTable."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.OpenFileAck)return e;let t=new Lt.CARTA.OpenFileAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.OpenFileAck.fileInfo: object expected");t.fileInfo=Lt.CARTA.FileInfo.fromObject(e.fileInfo)}if(null!=e.fileInfoExtended){if("object"!==typeof e.fileInfoExtended)throw TypeError(".CARTA.OpenFileAck.fileInfoExtended: object expected");t.fileInfoExtended=Lt.CARTA.FileInfoExtended.fromObject(e.fileInfoExtended)}if(null!=e.fileFeatureFlags&&(t.fileFeatureFlags=e.fileFeatureFlags>>>0),e.beamTable){if(!Array.isArray(e.beamTable))throw TypeError(".CARTA.OpenFileAck.beamTable: array expected");t.beamTable=[];for(let i=0;i<e.beamTable.length;++i){if("object"!==typeof e.beamTable[i])throw TypeError(".CARTA.OpenFileAck.beamTable: object expected");t.beamTable[i]=Lt.CARTA.Beam.fromObject(e.beamTable[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.beamTable=[]),t.defaults&&(i.success=!1,i.fileId=0,i.message="",i.fileInfo=null,i.fileInfoExtended=null,i.fileFeatureFlags=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=Lt.CARTA.FileInfo.toObject(e.fileInfo,t)),null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")&&(i.fileInfoExtended=Lt.CARTA.FileInfoExtended.toObject(e.fileInfoExtended,t)),null!=e.fileFeatureFlags&&e.hasOwnProperty("fileFeatureFlags")&&(i.fileFeatureFlags=e.fileFeatureFlags),e.beamTable&&e.beamTable.length){i.beamTable=[];for(let n=0;n<e.beamTable.length;++n)i.beamTable[n]=Lt.CARTA.Beam.toObject(e.beamTable[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetContourParameters=function(){function e(e){if(this.levels=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.referenceFileId=0,e.prototype.imageBounds=null,e.prototype.levels=Dt.emptyArray,e.prototype.smoothingMode=0,e.prototype.smoothingFactor=0,e.prototype.decimationFactor=0,e.prototype.compressionLevel=0,e.prototype.contourChunkSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).fixed32(e.fileId),null!=e.referenceFileId&&Object.hasOwnProperty.call(e,"referenceFileId")&&t.uint32(21).fixed32(e.referenceFileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&Lt.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.levels&&e.levels.length){t.uint32(34).fork();for(let i=0;i<e.levels.length;++i)t.double(e.levels[i]);t.ldelim()}return null!=e.smoothingMode&&Object.hasOwnProperty.call(e,"smoothingMode")&&t.uint32(40).int32(e.smoothingMode),null!=e.smoothingFactor&&Object.hasOwnProperty.call(e,"smoothingFactor")&&t.uint32(48).int32(e.smoothingFactor),null!=e.decimationFactor&&Object.hasOwnProperty.call(e,"decimationFactor")&&t.uint32(56).int32(e.decimationFactor),null!=e.compressionLevel&&Object.hasOwnProperty.call(e,"compressionLevel")&&t.uint32(64).int32(e.compressionLevel),null!=e.contourChunkSize&&Object.hasOwnProperty.call(e,"contourChunkSize")&&t.uint32(72).int32(e.contourChunkSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetContourParameters;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.fixed32();break;case 2:n.referenceFileId=e.fixed32();break;case 3:n.imageBounds=Lt.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:if(n.levels&&n.levels.length||(n.levels=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.levels.push(e.double())}else n.levels.push(e.double());break;case 5:n.smoothingMode=e.int32();break;case 6:n.smoothingFactor=e.int32();break;case 7:n.decimationFactor=e.int32();break;case 8:n.compressionLevel=e.int32();break;case 9:n.contourChunkSize=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&!Dt.isInteger(e.referenceFileId))return"referenceFileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=Lt.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.levels&&e.hasOwnProperty("levels")){if(!Array.isArray(e.levels))return"levels: array expected";for(let t=0;t<e.levels.length;++t)if("number"!==typeof e.levels[t])return"levels: number[] expected"}if(null!=e.smoothingMode&&e.hasOwnProperty("smoothingMode"))switch(e.smoothingMode){default:return"smoothingMode: enum value expected";case 0:case 1:case 2:}return null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&!Dt.isInteger(e.smoothingFactor)?"smoothingFactor: integer expected":null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&!Dt.isInteger(e.decimationFactor)?"decimationFactor: integer expected":null!=e.compressionLevel&&e.hasOwnProperty("compressionLevel")&&!Dt.isInteger(e.compressionLevel)?"compressionLevel: integer expected":null!=e.contourChunkSize&&e.hasOwnProperty("contourChunkSize")&&!Dt.isInteger(e.contourChunkSize)?"contourChunkSize: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetContourParameters)return e;let t=new Lt.CARTA.SetContourParameters;if(null!=e.fileId&&(t.fileId=e.fileId>>>0),null!=e.referenceFileId&&(t.referenceFileId=e.referenceFileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.SetContourParameters.imageBounds: object expected");t.imageBounds=Lt.CARTA.ImageBounds.fromObject(e.imageBounds)}if(e.levels){if(!Array.isArray(e.levels))throw TypeError(".CARTA.SetContourParameters.levels: array expected");t.levels=[];for(let i=0;i<e.levels.length;++i)t.levels[i]=Number(e.levels[i])}switch(e.smoothingMode){case"NoSmoothing":case 0:t.smoothingMode=0;break;case"BlockAverage":case 1:t.smoothingMode=1;break;case"GaussianBlur":case 2:t.smoothingMode=2}return null!=e.smoothingFactor&&(t.smoothingFactor=0|e.smoothingFactor),null!=e.decimationFactor&&(t.decimationFactor=0|e.decimationFactor),null!=e.compressionLevel&&(t.compressionLevel=0|e.compressionLevel),null!=e.contourChunkSize&&(t.contourChunkSize=0|e.contourChunkSize),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.levels=[]),t.defaults&&(i.fileId=0,i.referenceFileId=0,i.imageBounds=null,i.smoothingMode=t.enums===String?"NoSmoothing":0,i.smoothingFactor=0,i.decimationFactor=0,i.compressionLevel=0,i.contourChunkSize=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&(i.referenceFileId=e.referenceFileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=Lt.CARTA.ImageBounds.toObject(e.imageBounds,t)),e.levels&&e.levels.length){i.levels=[];for(let n=0;n<e.levels.length;++n)i.levels[n]=t.json&&!isFinite(e.levels[n])?String(e.levels[n]):e.levels[n]}return null!=e.smoothingMode&&e.hasOwnProperty("smoothingMode")&&(i.smoothingMode=t.enums===String?Lt.CARTA.SmoothingMode[e.smoothingMode]:e.smoothingMode),null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&(i.smoothingFactor=e.smoothingFactor),null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&(i.decimationFactor=e.decimationFactor),null!=e.compressionLevel&&e.hasOwnProperty("compressionLevel")&&(i.compressionLevel=e.compressionLevel),null!=e.contourChunkSize&&e.hasOwnProperty("contourChunkSize")&&(i.contourChunkSize=e.contourChunkSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ExportRegion=function(){function e(e){if(this.regionStyles={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=0,e.prototype.coordType=0,e.prototype.fileId=0,e.prototype.regionStyles=Dt.emptyObject,e.prototype.directory="",e.prototype.file="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.coordType&&Object.hasOwnProperty.call(e,"coordType")&&t.uint32(16).int32(e.coordType),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.regionStyles&&Object.hasOwnProperty.call(e,"regionStyles"))for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).sfixed32(i[n]),Lt.CARTA.RegionStyle.encode(e.regionStyles[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(42).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(50).string(e.file),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.ExportRegion;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.type=e.int32();break;case 2:r.coordType=e.int32();break;case 3:r.fileId=e.sfixed32();break;case 4:e.skip().pos++,r.regionStyles===Dt.emptyObject&&(r.regionStyles={}),i=e.sfixed32(),e.pos++,r.regionStyles[i]=Lt.CARTA.RegionStyle.decode(e,e.uint32());break;case 5:r.directory=e.string();break;case 6:r.file=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.coordType&&e.hasOwnProperty("coordType"))switch(e.coordType){default:return"coordType: enum value expected";case 0:case 1:}if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionStyles&&e.hasOwnProperty("regionStyles")){if(!Dt.isObject(e.regionStyles))return"regionStyles: object expected";let t=Object.keys(e.regionStyles);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"regionStyles: integer key{k:sfixed32} expected";{let n=Lt.CARTA.RegionStyle.verify(e.regionStyles[t[i]]);if(n)return"regionStyles."+n}}}return null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file)?"file: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ExportRegion)return e;let t=new Lt.CARTA.ExportRegion;switch(e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}switch(e.coordType){case"PIXEL":case 0:t.coordType=0;break;case"WORLD":case 1:t.coordType=1}if(null!=e.fileId&&(t.fileId=0|e.fileId),e.regionStyles){if("object"!==typeof e.regionStyles)throw TypeError(".CARTA.ExportRegion.regionStyles: object expected");t.regionStyles={};for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n){if("object"!==typeof e.regionStyles[i[n]])throw TypeError(".CARTA.ExportRegion.regionStyles: object expected");t.regionStyles[i[n]]=Lt.CARTA.RegionStyle.fromObject(e.regionStyles[i[n]])}}return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regionStyles={}),t.defaults&&(n.type=t.enums===String?"CASA":0,n.coordType=t.enums===String?"PIXEL":0,n.fileId=0,n.directory="",n.file=""),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?Lt.CARTA.FileType[e.type]:e.type),null!=e.coordType&&e.hasOwnProperty("coordType")&&(n.coordType=t.enums===String?Lt.CARTA.CoordinateType[e.coordType]:e.coordType),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),e.regionStyles&&(i=Object.keys(e.regionStyles)).length){n.regionStyles={};for(let r=0;r<i.length;++r)n.regionStyles[i[r]]=Lt.CARTA.RegionStyle.toObject(e.regionStyles[i[r]],t)}return null!=e.directory&&e.hasOwnProperty("directory")&&(n.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(n.file=e.file),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ExportRegionAck=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.contents=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(26).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ExportRegionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!Dt.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ExportRegionAck)return e;let t=new Lt.CARTA.ExportRegionAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.ExportRegionAck.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ImportRegion=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.groupId=0,e.prototype.type=0,e.prototype.directory="",e.prototype.file="",e.prototype.contents=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(13).sfixed32(e.groupId),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(34).string(e.file),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(42).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ImportRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.groupId=e.sfixed32();break;case 2:n.type=e.int32();break;case 3:n.directory=e.string();break;case 4:n.file=e.string();break;case 5:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!Dt.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file))return"file: string expected";if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!Dt.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ImportRegion)return e;let t=new Lt.CARTA.ImportRegion;switch(null!=e.groupId&&(t.groupId=0|e.groupId),e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}if(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.ImportRegion.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.groupId=0,i.type=t.enums===String?"CASA":0,i.directory="",i.file=""),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?Lt.CARTA.FileType[e.type]:e.type),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ImportRegionAck=function(){function e(e){if(this.regions={},this.regionStyles={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.regions=Dt.emptyObject,e.prototype.regionStyles=Dt.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.regions&&Object.hasOwnProperty.call(e,"regions"))for(let i=Object.keys(e.regions),n=0;n<i.length;++n)t.uint32(26).fork().uint32(13).sfixed32(i[n]),Lt.CARTA.RegionInfo.encode(e.regions[i[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.regionStyles&&Object.hasOwnProperty.call(e,"regionStyles"))for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).sfixed32(i[n]),Lt.CARTA.RegionStyle.encode(e.regionStyles[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.ImportRegionAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.success=e.bool();break;case 2:r.message=e.string();break;case 3:e.skip().pos++,r.regions===Dt.emptyObject&&(r.regions={}),i=e.sfixed32(),e.pos++,r.regions[i]=Lt.CARTA.RegionInfo.decode(e,e.uint32());break;case 4:e.skip().pos++,r.regionStyles===Dt.emptyObject&&(r.regionStyles={}),i=e.sfixed32(),e.pos++,r.regionStyles[i]=Lt.CARTA.RegionStyle.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.regions&&e.hasOwnProperty("regions")){if(!Dt.isObject(e.regions))return"regions: object expected";let t=Object.keys(e.regions);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"regions: integer key{k:sfixed32} expected";{let n=Lt.CARTA.RegionInfo.verify(e.regions[t[i]]);if(n)return"regions."+n}}}if(null!=e.regionStyles&&e.hasOwnProperty("regionStyles")){if(!Dt.isObject(e.regionStyles))return"regionStyles: object expected";let t=Object.keys(e.regionStyles);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"regionStyles: integer key{k:sfixed32} expected";{let n=Lt.CARTA.RegionStyle.verify(e.regionStyles[t[i]]);if(n)return"regionStyles."+n}}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ImportRegionAck)return e;let t=new Lt.CARTA.ImportRegionAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.regions){if("object"!==typeof e.regions)throw TypeError(".CARTA.ImportRegionAck.regions: object expected");t.regions={};for(let i=Object.keys(e.regions),n=0;n<i.length;++n){if("object"!==typeof e.regions[i[n]])throw TypeError(".CARTA.ImportRegionAck.regions: object expected");t.regions[i[n]]=Lt.CARTA.RegionInfo.fromObject(e.regions[i[n]])}}if(e.regionStyles){if("object"!==typeof e.regionStyles)throw TypeError(".CARTA.ImportRegionAck.regionStyles: object expected");t.regionStyles={};for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n){if("object"!==typeof e.regionStyles[i[n]])throw TypeError(".CARTA.ImportRegionAck.regionStyles: object expected");t.regionStyles[i[n]]=Lt.CARTA.RegionStyle.fromObject(e.regionStyles[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regions={},n.regionStyles={}),t.defaults&&(n.success=!1,n.message=""),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),e.regions&&(i=Object.keys(e.regions)).length){n.regions={};for(let r=0;r<i.length;++r)n.regions[i[r]]=Lt.CARTA.RegionInfo.toObject(e.regions[i[r]],t)}if(e.regionStyles&&(i=Object.keys(e.regionStyles)).length){n.regionStyles={};for(let r=0;r<i.length;++r)n.regionStyles[i[r]]=Lt.CARTA.RegionStyle.toObject(e.regionStyles[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.OpenCatalogFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.name="",e.prototype.fileId=0,e.prototype.previewDataSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.previewDataSize&&Object.hasOwnProperty.call(e,"previewDataSize")&&t.uint32(37).sfixed32(e.previewDataSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.OpenCatalogFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.name=e.string();break;case 3:n.fileId=e.sfixed32();break;case 4:n.previewDataSize=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory)?"directory: string expected":null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name)?"name: string expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null!=e.previewDataSize&&e.hasOwnProperty("previewDataSize")&&!Dt.isInteger(e.previewDataSize)?"previewDataSize: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.OpenCatalogFile)return e;let t=new Lt.CARTA.OpenCatalogFile;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.name&&(t.name=String(e.name)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.previewDataSize&&(t.previewDataSize=0|e.previewDataSize),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.name="",i.fileId=0,i.previewDataSize=0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.previewDataSize&&e.hasOwnProperty("previewDataSize")&&(i.previewDataSize=e.previewDataSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.OpenCatalogFileAck=function(){function e(e){if(this.headers=[],this.previewData={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileId=0,e.prototype.fileInfo=null,e.prototype.dataSize=0,e.prototype.headers=Dt.emptyArray,e.prototype.previewData=Dt.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&Lt.CARTA.CatalogFileInfo.encode(e.fileInfo,t.uint32(34).fork()).ldelim(),null!=e.dataSize&&Object.hasOwnProperty.call(e,"dataSize")&&t.uint32(45).sfixed32(e.dataSize),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)Lt.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(50).fork()).ldelim();if(null!=e.previewData&&Object.hasOwnProperty.call(e,"previewData"))for(let i=Object.keys(e.previewData),n=0;n<i.length;++n)t.uint32(58).fork().uint32(13).fixed32(i[n]),Lt.CARTA.ColumnData.encode(e.previewData[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.OpenCatalogFileAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.success=e.bool();break;case 2:r.message=e.string();break;case 3:r.fileId=e.sfixed32();break;case 4:r.fileInfo=Lt.CARTA.CatalogFileInfo.decode(e,e.uint32());break;case 5:r.dataSize=e.sfixed32();break;case 6:r.headers&&r.headers.length||(r.headers=[]),r.headers.push(Lt.CARTA.CatalogHeader.decode(e,e.uint32()));break;case 7:e.skip().pos++,r.previewData===Dt.emptyObject&&(r.previewData={}),i=e.fixed32(),e.pos++,r.previewData[i]=Lt.CARTA.ColumnData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=Lt.CARTA.CatalogFileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.dataSize&&e.hasOwnProperty("dataSize")&&!Dt.isInteger(e.dataSize))return"dataSize: integer expected";if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=Lt.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}if(null!=e.previewData&&e.hasOwnProperty("previewData")){if(!Dt.isObject(e.previewData))return"previewData: object expected";let t=Object.keys(e.previewData);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"previewData: integer key{k:fixed32} expected";{let n=Lt.CARTA.ColumnData.verify(e.previewData[t[i]]);if(n)return"previewData."+n}}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.OpenCatalogFileAck)return e;let t=new Lt.CARTA.OpenCatalogFileAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.OpenCatalogFileAck.fileInfo: object expected");t.fileInfo=Lt.CARTA.CatalogFileInfo.fromObject(e.fileInfo)}if(null!=e.dataSize&&(t.dataSize=0|e.dataSize),e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.OpenCatalogFileAck.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.OpenCatalogFileAck.headers: object expected");t.headers[i]=Lt.CARTA.CatalogHeader.fromObject(e.headers[i])}}if(e.previewData){if("object"!==typeof e.previewData)throw TypeError(".CARTA.OpenCatalogFileAck.previewData: object expected");t.previewData={};for(let i=Object.keys(e.previewData),n=0;n<i.length;++n){if("object"!==typeof e.previewData[i[n]])throw TypeError(".CARTA.OpenCatalogFileAck.previewData: object expected");t.previewData[i[n]]=Lt.CARTA.ColumnData.fromObject(e.previewData[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.headers=[]),(t.objects||t.defaults)&&(n.previewData={}),t.defaults&&(n.success=!1,n.message="",n.fileId=0,n.fileInfo=null,n.dataSize=0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(n.fileInfo=Lt.CARTA.CatalogFileInfo.toObject(e.fileInfo,t)),null!=e.dataSize&&e.hasOwnProperty("dataSize")&&(n.dataSize=e.dataSize),e.headers&&e.headers.length){n.headers=[];for(let i=0;i<e.headers.length;++i)n.headers[i]=Lt.CARTA.CatalogHeader.toObject(e.headers[i],t)}if(e.previewData&&(i=Object.keys(e.previewData)).length){n.previewData={};for(let r=0;r<i.length;++r)n.previewData[i[r]]=Lt.CARTA.ColumnData.toObject(e.previewData[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CloseCatalogFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CloseCatalogFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CloseCatalogFile)return e;let t=new Lt.CARTA.CloseCatalogFile;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetRegion=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.regionInfo=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.regionInfo&&Object.hasOwnProperty.call(e,"regionInfo")&&Lt.CARTA.RegionInfo.encode(e.regionInfo,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.regionInfo=Lt.CARTA.RegionInfo.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.regionInfo&&e.hasOwnProperty("regionInfo")){let t=Lt.CARTA.RegionInfo.verify(e.regionInfo);if(t)return"regionInfo."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetRegion)return e;let t=new Lt.CARTA.SetRegion;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.regionInfo){if("object"!==typeof e.regionInfo)throw TypeError(".CARTA.SetRegion.regionInfo: object expected");t.regionInfo=Lt.CARTA.RegionInfo.fromObject(e.regionInfo)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.regionId=0,i.regionInfo=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.regionInfo&&e.hasOwnProperty("regionInfo")&&(i.regionInfo=Lt.CARTA.RegionInfo.toObject(e.regionInfo,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetRegionAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.regionId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(29).sfixed32(e.regionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetRegionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.regionId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId)?"regionId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetRegionAck)return e;let t=new Lt.CARTA.SetRegionAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.regionId&&(t.regionId=0|e.regionId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.regionId=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RemoveRegion=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.regionId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(13).sfixed32(e.regionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RemoveRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.regionId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId)?"regionId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RemoveRegion)return e;let t=new Lt.CARTA.RemoveRegion;return null!=e.regionId&&(t.regionId=0|e.regionId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.regionId=0),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetStatsRequirements=function(){function e(e){if(this.statsConfigs=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.statsConfigs=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.statsConfigs&&e.statsConfigs.length)for(let i=0;i<e.statsConfigs.length;++i)Lt.CARTA.SetStatsRequirements.StatsConfig.encode(e.statsConfigs[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetStatsRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.statsConfigs&&n.statsConfigs.length||(n.statsConfigs=[]),n.statsConfigs.push(Lt.CARTA.SetStatsRequirements.StatsConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.statsConfigs&&e.hasOwnProperty("statsConfigs")){if(!Array.isArray(e.statsConfigs))return"statsConfigs: array expected";for(let t=0;t<e.statsConfigs.length;++t){let i=Lt.CARTA.SetStatsRequirements.StatsConfig.verify(e.statsConfigs[t]);if(i)return"statsConfigs."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetStatsRequirements)return e;let t=new Lt.CARTA.SetStatsRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.statsConfigs){if(!Array.isArray(e.statsConfigs))throw TypeError(".CARTA.SetStatsRequirements.statsConfigs: array expected");t.statsConfigs=[];for(let i=0;i<e.statsConfigs.length;++i){if("object"!==typeof e.statsConfigs[i])throw TypeError(".CARTA.SetStatsRequirements.statsConfigs: object expected");t.statsConfigs[i]=Lt.CARTA.SetStatsRequirements.StatsConfig.fromObject(e.statsConfigs[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statsConfigs=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.statsConfigs&&e.statsConfigs.length){i.statsConfigs=[];for(let n=0;n<e.statsConfigs.length;++n)i.statsConfigs[n]=Lt.CARTA.SetStatsRequirements.StatsConfig.toObject(e.statsConfigs[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e.StatsConfig=function(){function e(e){if(this.statsTypes=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsTypes=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsTypes&&e.statsTypes.length){t.uint32(18).fork();for(let i=0;i<e.statsTypes.length;++i)t.int32(e.statsTypes[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetStatsRequirements.StatsConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:if(n.statsTypes&&n.statsTypes.length||(n.statsTypes=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.statsTypes.push(e.int32())}else n.statsTypes.push(e.int32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!Dt.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsTypes&&e.hasOwnProperty("statsTypes")){if(!Array.isArray(e.statsTypes))return"statsTypes: array expected";for(let t=0;t<e.statsTypes.length;++t)switch(e.statsTypes[t]){default:return"statsTypes: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetStatsRequirements.StatsConfig)return e;let t=new Lt.CARTA.SetStatsRequirements.StatsConfig;if(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsTypes){if(!Array.isArray(e.statsTypes))throw TypeError(".CARTA.SetStatsRequirements.StatsConfig.statsTypes: array expected");t.statsTypes=[];for(let i=0;i<e.statsTypes.length;++i)switch(e.statsTypes[i]){default:case"NumPixels":case 0:t.statsTypes[i]=0;break;case"NanCount":case 1:t.statsTypes[i]=1;break;case"Sum":case 2:t.statsTypes[i]=2;break;case"FluxDensity":case 3:t.statsTypes[i]=3;break;case"Mean":case 4:t.statsTypes[i]=4;break;case"RMS":case 5:t.statsTypes[i]=5;break;case"Sigma":case 6:t.statsTypes[i]=6;break;case"SumSq":case 7:t.statsTypes[i]=7;break;case"Min":case 8:t.statsTypes[i]=8;break;case"Max":case 9:t.statsTypes[i]=9;break;case"Extrema":case 10:t.statsTypes[i]=10;break;case"Blc":case 11:t.statsTypes[i]=11;break;case"Trc":case 12:t.statsTypes[i]=12;break;case"MinPos":case 13:t.statsTypes[i]=13;break;case"MaxPos":case 14:t.statsTypes[i]=14;break;case"Blcf":case 15:t.statsTypes[i]=15;break;case"Trcf":case 16:t.statsTypes[i]=16;break;case"MinPosf":case 17:t.statsTypes[i]=17;break;case"MaxPosf":case 18:t.statsTypes[i]=18}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statsTypes=[]),t.defaults&&(i.coordinate=""),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),e.statsTypes&&e.statsTypes.length){i.statsTypes=[];for(let n=0;n<e.statsTypes.length;++n)i.statsTypes[n]=t.enums===String?Lt.CARTA.StatsType[e.statsTypes[n]]:e.statsTypes[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e}(),e.SetHistogramRequirements=function(){function e(e){if(this.histograms=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.histograms=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.histograms&&e.histograms.length)for(let i=0;i<e.histograms.length;++i)Lt.CARTA.SetHistogramRequirements.HistogramConfig.encode(e.histograms[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetHistogramRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.histograms&&n.histograms.length||(n.histograms=[]),n.histograms.push(Lt.CARTA.SetHistogramRequirements.HistogramConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.histograms&&e.hasOwnProperty("histograms")){if(!Array.isArray(e.histograms))return"histograms: array expected";for(let t=0;t<e.histograms.length;++t){let i=Lt.CARTA.SetHistogramRequirements.HistogramConfig.verify(e.histograms[t]);if(i)return"histograms."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetHistogramRequirements)return e;let t=new Lt.CARTA.SetHistogramRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.histograms){if(!Array.isArray(e.histograms))throw TypeError(".CARTA.SetHistogramRequirements.histograms: array expected");t.histograms=[];for(let i=0;i<e.histograms.length;++i){if("object"!==typeof e.histograms[i])throw TypeError(".CARTA.SetHistogramRequirements.histograms: object expected");t.histograms[i]=Lt.CARTA.SetHistogramRequirements.HistogramConfig.fromObject(e.histograms[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.histograms=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.histograms&&e.histograms.length){i.histograms=[];for(let n=0;n<e.histograms.length;++n)i.histograms[n]=Lt.CARTA.SetHistogramRequirements.HistogramConfig.toObject(e.histograms[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e.HistogramConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.channel=0,e.prototype.numBins=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.numBins&&Object.hasOwnProperty.call(e,"numBins")&&t.uint32(29).sfixed32(e.numBins),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetHistogramRequirements.HistogramConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:n.channel=e.sfixed32();break;case 3:n.numBins=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!Dt.isString(e.coordinate)?"coordinate: string expected":null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel)?"channel: integer expected":null!=e.numBins&&e.hasOwnProperty("numBins")&&!Dt.isInteger(e.numBins)?"numBins: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetHistogramRequirements.HistogramConfig)return e;let t=new Lt.CARTA.SetHistogramRequirements.HistogramConfig;return null!=e.coordinate&&(t.coordinate=String(e.coordinate)),null!=e.channel&&(t.channel=0|e.channel),null!=e.numBins&&(t.numBins=0|e.numBins),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.coordinate="",i.channel=0,i.numBins=0),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.numBins&&e.hasOwnProperty("numBins")&&(i.numBins=e.numBins),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e}(),e.SetSpatialRequirements=function(){function e(e){if(this.spatialProfiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.spatialProfiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.spatialProfiles&&e.spatialProfiles.length)for(let i=0;i<e.spatialProfiles.length;++i)Lt.CARTA.SetSpatialRequirements.SpatialConfig.encode(e.spatialProfiles[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetSpatialRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.spatialProfiles&&n.spatialProfiles.length||(n.spatialProfiles=[]),n.spatialProfiles.push(Lt.CARTA.SetSpatialRequirements.SpatialConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spatialProfiles&&e.hasOwnProperty("spatialProfiles")){if(!Array.isArray(e.spatialProfiles))return"spatialProfiles: array expected";for(let t=0;t<e.spatialProfiles.length;++t){let i=Lt.CARTA.SetSpatialRequirements.SpatialConfig.verify(e.spatialProfiles[t]);if(i)return"spatialProfiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetSpatialRequirements)return e;let t=new Lt.CARTA.SetSpatialRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.spatialProfiles){if(!Array.isArray(e.spatialProfiles))throw TypeError(".CARTA.SetSpatialRequirements.spatialProfiles: array expected");t.spatialProfiles=[];for(let i=0;i<e.spatialProfiles.length;++i){if("object"!==typeof e.spatialProfiles[i])throw TypeError(".CARTA.SetSpatialRequirements.spatialProfiles: object expected");t.spatialProfiles[i]=Lt.CARTA.SetSpatialRequirements.SpatialConfig.fromObject(e.spatialProfiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.spatialProfiles=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.spatialProfiles&&e.spatialProfiles.length){i.spatialProfiles=[];for(let n=0;n<e.spatialProfiles.length;++n)i.spatialProfiles[n]=Lt.CARTA.SetSpatialRequirements.SpatialConfig.toObject(e.spatialProfiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e.SpatialConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.start=0,e.prototype.end=0,e.prototype.mip=0,e.prototype.width=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(21).sfixed32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(29).sfixed32(e.end),null!=e.mip&&Object.hasOwnProperty.call(e,"mip")&&t.uint32(37).sfixed32(e.mip),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(45).sfixed32(e.width),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetSpatialRequirements.SpatialConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:n.start=e.sfixed32();break;case 3:n.end=e.sfixed32();break;case 4:n.mip=e.sfixed32();break;case 5:n.width=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!Dt.isString(e.coordinate)?"coordinate: string expected":null!=e.start&&e.hasOwnProperty("start")&&!Dt.isInteger(e.start)?"start: integer expected":null!=e.end&&e.hasOwnProperty("end")&&!Dt.isInteger(e.end)?"end: integer expected":null!=e.mip&&e.hasOwnProperty("mip")&&!Dt.isInteger(e.mip)?"mip: integer expected":null!=e.width&&e.hasOwnProperty("width")&&!Dt.isInteger(e.width)?"width: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetSpatialRequirements.SpatialConfig)return e;let t=new Lt.CARTA.SetSpatialRequirements.SpatialConfig;return null!=e.coordinate&&(t.coordinate=String(e.coordinate)),null!=e.start&&(t.start=0|e.start),null!=e.end&&(t.end=0|e.end),null!=e.mip&&(t.mip=0|e.mip),null!=e.width&&(t.width=0|e.width),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.coordinate="",i.start=0,i.end=0,i.mip=0,i.width=0),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),null!=e.start&&e.hasOwnProperty("start")&&(i.start=e.start),null!=e.end&&e.hasOwnProperty("end")&&(i.end=e.end),null!=e.mip&&e.hasOwnProperty("mip")&&(i.mip=e.mip),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e}(),e.SetSpectralRequirements=function(){function e(e){if(this.spectralProfiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.spectralProfiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.spectralProfiles&&e.spectralProfiles.length)for(let i=0;i<e.spectralProfiles.length;++i)Lt.CARTA.SetSpectralRequirements.SpectralConfig.encode(e.spectralProfiles[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetSpectralRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.spectralProfiles&&n.spectralProfiles.length||(n.spectralProfiles=[]),n.spectralProfiles.push(Lt.CARTA.SetSpectralRequirements.SpectralConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spectralProfiles&&e.hasOwnProperty("spectralProfiles")){if(!Array.isArray(e.spectralProfiles))return"spectralProfiles: array expected";for(let t=0;t<e.spectralProfiles.length;++t){let i=Lt.CARTA.SetSpectralRequirements.SpectralConfig.verify(e.spectralProfiles[t]);if(i)return"spectralProfiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetSpectralRequirements)return e;let t=new Lt.CARTA.SetSpectralRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.spectralProfiles){if(!Array.isArray(e.spectralProfiles))throw TypeError(".CARTA.SetSpectralRequirements.spectralProfiles: array expected");t.spectralProfiles=[];for(let i=0;i<e.spectralProfiles.length;++i){if("object"!==typeof e.spectralProfiles[i])throw TypeError(".CARTA.SetSpectralRequirements.spectralProfiles: object expected");t.spectralProfiles[i]=Lt.CARTA.SetSpectralRequirements.SpectralConfig.fromObject(e.spectralProfiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.spectralProfiles=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.spectralProfiles&&e.spectralProfiles.length){i.spectralProfiles=[];for(let n=0;n<e.spectralProfiles.length;++n)i.spectralProfiles[n]=Lt.CARTA.SetSpectralRequirements.SpectralConfig.toObject(e.spectralProfiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e.SpectralConfig=function(){function e(e){if(this.statsTypes=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsTypes=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsTypes&&e.statsTypes.length){t.uint32(18).fork();for(let i=0;i<e.statsTypes.length;++i)t.int32(e.statsTypes[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetSpectralRequirements.SpectralConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:if(n.statsTypes&&n.statsTypes.length||(n.statsTypes=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.statsTypes.push(e.int32())}else n.statsTypes.push(e.int32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!Dt.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsTypes&&e.hasOwnProperty("statsTypes")){if(!Array.isArray(e.statsTypes))return"statsTypes: array expected";for(let t=0;t<e.statsTypes.length;++t)switch(e.statsTypes[t]){default:return"statsTypes: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetSpectralRequirements.SpectralConfig)return e;let t=new Lt.CARTA.SetSpectralRequirements.SpectralConfig;if(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsTypes){if(!Array.isArray(e.statsTypes))throw TypeError(".CARTA.SetSpectralRequirements.SpectralConfig.statsTypes: array expected");t.statsTypes=[];for(let i=0;i<e.statsTypes.length;++i)switch(e.statsTypes[i]){default:case"NumPixels":case 0:t.statsTypes[i]=0;break;case"NanCount":case 1:t.statsTypes[i]=1;break;case"Sum":case 2:t.statsTypes[i]=2;break;case"FluxDensity":case 3:t.statsTypes[i]=3;break;case"Mean":case 4:t.statsTypes[i]=4;break;case"RMS":case 5:t.statsTypes[i]=5;break;case"Sigma":case 6:t.statsTypes[i]=6;break;case"SumSq":case 7:t.statsTypes[i]=7;break;case"Min":case 8:t.statsTypes[i]=8;break;case"Max":case 9:t.statsTypes[i]=9;break;case"Extrema":case 10:t.statsTypes[i]=10;break;case"Blc":case 11:t.statsTypes[i]=11;break;case"Trc":case 12:t.statsTypes[i]=12;break;case"MinPos":case 13:t.statsTypes[i]=13;break;case"MaxPos":case 14:t.statsTypes[i]=14;break;case"Blcf":case 15:t.statsTypes[i]=15;break;case"Trcf":case 16:t.statsTypes[i]=16;break;case"MinPosf":case 17:t.statsTypes[i]=17;break;case"MaxPosf":case 18:t.statsTypes[i]=18}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statsTypes=[]),t.defaults&&(i.coordinate=""),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),e.statsTypes&&e.statsTypes.length){i.statsTypes=[];for(let n=0;n<e.statsTypes.length;++n)i.statsTypes[n]=t.enums===String?Lt.CARTA.StatsType[e.statsTypes[n]]:e.statsTypes[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e}(),e.RegisterViewer=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sessionId=0,e.prototype.apiKey="",e.prototype.clientFeatureFlags=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(13).fixed32(e.sessionId),null!=e.apiKey&&Object.hasOwnProperty.call(e,"apiKey")&&t.uint32(18).string(e.apiKey),null!=e.clientFeatureFlags&&Object.hasOwnProperty.call(e,"clientFeatureFlags")&&t.uint32(29).fixed32(e.clientFeatureFlags),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegisterViewer;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.sessionId=e.fixed32();break;case 2:n.apiKey=e.string();break;case 3:n.clientFeatureFlags=e.fixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!Dt.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.apiKey&&e.hasOwnProperty("apiKey")&&!Dt.isString(e.apiKey)?"apiKey: string expected":null!=e.clientFeatureFlags&&e.hasOwnProperty("clientFeatureFlags")&&!Dt.isInteger(e.clientFeatureFlags)?"clientFeatureFlags: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegisterViewer)return e;let t=new Lt.CARTA.RegisterViewer;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.apiKey&&(t.apiKey=String(e.apiKey)),null!=e.clientFeatureFlags&&(t.clientFeatureFlags=e.clientFeatureFlags>>>0),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.sessionId=0,i.apiKey="",i.clientFeatureFlags=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(i.sessionId=e.sessionId),null!=e.apiKey&&e.hasOwnProperty("apiKey")&&(i.apiKey=e.apiKey),null!=e.clientFeatureFlags&&e.hasOwnProperty("clientFeatureFlags")&&(i.clientFeatureFlags=e.clientFeatureFlags),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegisterViewerAck=function(){function e(e){if(this.userPreferences={},this.userLayouts={},this.platformStrings={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sessionId=0,e.prototype.success=!1,e.prototype.message="",e.prototype.sessionType=0,e.prototype.serverFeatureFlags=0,e.prototype.userPreferences=Dt.emptyObject,e.prototype.userLayouts=Dt.emptyObject,e.prototype.platformStrings=Dt.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(13).fixed32(e.sessionId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.sessionType&&Object.hasOwnProperty.call(e,"sessionType")&&t.uint32(32).int32(e.sessionType),null!=e.serverFeatureFlags&&Object.hasOwnProperty.call(e,"serverFeatureFlags")&&t.uint32(45).fixed32(e.serverFeatureFlags),null!=e.userPreferences&&Object.hasOwnProperty.call(e,"userPreferences"))for(let i=Object.keys(e.userPreferences),n=0;n<i.length;++n)t.uint32(50).fork().uint32(10).string(i[n]).uint32(18).string(e.userPreferences[i[n]]).ldelim();if(null!=e.userLayouts&&Object.hasOwnProperty.call(e,"userLayouts"))for(let i=Object.keys(e.userLayouts),n=0;n<i.length;++n)t.uint32(58).fork().uint32(10).string(i[n]).uint32(18).string(e.userLayouts[i[n]]).ldelim();if(null!=e.platformStrings&&Object.hasOwnProperty.call(e,"platformStrings"))for(let i=Object.keys(e.platformStrings),n=0;n<i.length;++n)t.uint32(66).fork().uint32(10).string(i[n]).uint32(18).string(e.platformStrings[i[n]]).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.RegisterViewerAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.sessionId=e.fixed32();break;case 2:r.success=e.bool();break;case 3:r.message=e.string();break;case 4:r.sessionType=e.int32();break;case 5:r.serverFeatureFlags=e.fixed32();break;case 6:e.skip().pos++,r.userPreferences===Dt.emptyObject&&(r.userPreferences={}),i=e.string(),e.pos++,r.userPreferences[i]=e.string();break;case 7:e.skip().pos++,r.userLayouts===Dt.emptyObject&&(r.userLayouts={}),i=e.string(),e.pos++,r.userLayouts[i]=e.string();break;case 8:e.skip().pos++,r.platformStrings===Dt.emptyObject&&(r.platformStrings={}),i=e.string(),e.pos++,r.platformStrings[i]=e.string();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!Dt.isInteger(e.sessionId))return"sessionId: integer expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.sessionType&&e.hasOwnProperty("sessionType"))switch(e.sessionType){default:return"sessionType: enum value expected";case 0:case 1:}if(null!=e.serverFeatureFlags&&e.hasOwnProperty("serverFeatureFlags")&&!Dt.isInteger(e.serverFeatureFlags))return"serverFeatureFlags: integer expected";if(null!=e.userPreferences&&e.hasOwnProperty("userPreferences")){if(!Dt.isObject(e.userPreferences))return"userPreferences: object expected";let t=Object.keys(e.userPreferences);for(let i=0;i<t.length;++i)if(!Dt.isString(e.userPreferences[t[i]]))return"userPreferences: string{k:string} expected"}if(null!=e.userLayouts&&e.hasOwnProperty("userLayouts")){if(!Dt.isObject(e.userLayouts))return"userLayouts: object expected";let t=Object.keys(e.userLayouts);for(let i=0;i<t.length;++i)if(!Dt.isString(e.userLayouts[t[i]]))return"userLayouts: string{k:string} expected"}if(null!=e.platformStrings&&e.hasOwnProperty("platformStrings")){if(!Dt.isObject(e.platformStrings))return"platformStrings: object expected";let t=Object.keys(e.platformStrings);for(let i=0;i<t.length;++i)if(!Dt.isString(e.platformStrings[t[i]]))return"platformStrings: string{k:string} expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegisterViewerAck)return e;let t=new Lt.CARTA.RegisterViewerAck;switch(null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.sessionType){case"NEW":case 0:t.sessionType=0;break;case"RESUMED":case 1:t.sessionType=1}if(null!=e.serverFeatureFlags&&(t.serverFeatureFlags=e.serverFeatureFlags>>>0),e.userPreferences){if("object"!==typeof e.userPreferences)throw TypeError(".CARTA.RegisterViewerAck.userPreferences: object expected");t.userPreferences={};for(let i=Object.keys(e.userPreferences),n=0;n<i.length;++n)t.userPreferences[i[n]]=String(e.userPreferences[i[n]])}if(e.userLayouts){if("object"!==typeof e.userLayouts)throw TypeError(".CARTA.RegisterViewerAck.userLayouts: object expected");t.userLayouts={};for(let i=Object.keys(e.userLayouts),n=0;n<i.length;++n)t.userLayouts[i[n]]=String(e.userLayouts[i[n]])}if(e.platformStrings){if("object"!==typeof e.platformStrings)throw TypeError(".CARTA.RegisterViewerAck.platformStrings: object expected");t.platformStrings={};for(let i=Object.keys(e.platformStrings),n=0;n<i.length;++n)t.platformStrings[i[n]]=String(e.platformStrings[i[n]])}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.userPreferences={},n.userLayouts={},n.platformStrings={}),t.defaults&&(n.sessionId=0,n.success=!1,n.message="",n.sessionType=t.enums===String?"NEW":0,n.serverFeatureFlags=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(n.sessionId=e.sessionId),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.sessionType&&e.hasOwnProperty("sessionType")&&(n.sessionType=t.enums===String?Lt.CARTA.SessionType[e.sessionType]:e.sessionType),null!=e.serverFeatureFlags&&e.hasOwnProperty("serverFeatureFlags")&&(n.serverFeatureFlags=e.serverFeatureFlags),e.userPreferences&&(i=Object.keys(e.userPreferences)).length){n.userPreferences={};for(let t=0;t<i.length;++t)n.userPreferences[i[t]]=e.userPreferences[i[t]]}if(e.userLayouts&&(i=Object.keys(e.userLayouts)).length){n.userLayouts={};for(let t=0;t<i.length;++t)n.userLayouts[i[t]]=e.userLayouts[i[t]]}if(e.platformStrings&&(i=Object.keys(e.platformStrings)).length){n.platformStrings={};for(let t=0;t<i.length;++t)n.platformStrings[i[t]]=e.platformStrings[i[t]]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ImageProperties=function(){function e(e){if(this.regions={},this.stokesFiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.fileId=0,e.prototype.renderMode=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.regions=Dt.emptyObject,e.prototype.contourSettings=null,e.prototype.stokesFiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(37).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(40).int32(e.renderMode),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(53).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(61).sfixed32(e.stokes),null!=e.regions&&Object.hasOwnProperty.call(e,"regions"))for(let i=Object.keys(e.regions),n=0;n<i.length;++n)t.uint32(66).fork().uint32(13).sfixed32(i[n]),Lt.CARTA.RegionInfo.encode(e.regions[i[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.contourSettings&&Object.hasOwnProperty.call(e,"contourSettings")&&Lt.CARTA.SetContourParameters.encode(e.contourSettings,t.uint32(74).fork()).ldelim(),null!=e.stokesFiles&&e.stokesFiles.length)for(let i=0;i<e.stokesFiles.length;++i)Lt.CARTA.StokesFile.encode(e.stokesFiles[i],t.uint32(82).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.ImageProperties;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.directory=e.string();break;case 2:r.file=e.string();break;case 3:r.hdu=e.string();break;case 4:r.fileId=e.sfixed32();break;case 5:r.renderMode=e.int32();break;case 6:r.channel=e.sfixed32();break;case 7:r.stokes=e.sfixed32();break;case 8:e.skip().pos++,r.regions===Dt.emptyObject&&(r.regions={}),i=e.sfixed32(),e.pos++,r.regions[i]=Lt.CARTA.RegionInfo.decode(e,e.uint32());break;case 9:r.contourSettings=Lt.CARTA.SetContourParameters.decode(e,e.uint32());break;case 10:r.stokesFiles&&r.stokesFiles.length||(r.stokesFiles=[]),r.stokesFiles.push(Lt.CARTA.StokesFile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!Dt.isString(e.hdu))return"hdu: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.regions&&e.hasOwnProperty("regions")){if(!Dt.isObject(e.regions))return"regions: object expected";let t=Object.keys(e.regions);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"regions: integer key{k:sfixed32} expected";{let n=Lt.CARTA.RegionInfo.verify(e.regions[t[i]]);if(n)return"regions."+n}}}if(null!=e.contourSettings&&e.hasOwnProperty("contourSettings")){let t=Lt.CARTA.SetContourParameters.verify(e.contourSettings);if(t)return"contourSettings."+t}if(null!=e.stokesFiles&&e.hasOwnProperty("stokesFiles")){if(!Array.isArray(e.stokesFiles))return"stokesFiles: array expected";for(let t=0;t<e.stokesFiles.length;++t){let i=Lt.CARTA.StokesFile.verify(e.stokesFiles[t]);if(i)return"stokesFiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ImageProperties)return e;let t=new Lt.CARTA.ImageProperties;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}if(null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.regions){if("object"!==typeof e.regions)throw TypeError(".CARTA.ImageProperties.regions: object expected");t.regions={};for(let i=Object.keys(e.regions),n=0;n<i.length;++n){if("object"!==typeof e.regions[i[n]])throw TypeError(".CARTA.ImageProperties.regions: object expected");t.regions[i[n]]=Lt.CARTA.RegionInfo.fromObject(e.regions[i[n]])}}if(null!=e.contourSettings){if("object"!==typeof e.contourSettings)throw TypeError(".CARTA.ImageProperties.contourSettings: object expected");t.contourSettings=Lt.CARTA.SetContourParameters.fromObject(e.contourSettings)}if(e.stokesFiles){if(!Array.isArray(e.stokesFiles))throw TypeError(".CARTA.ImageProperties.stokesFiles: array expected");t.stokesFiles=[];for(let i=0;i<e.stokesFiles.length;++i){if("object"!==typeof e.stokesFiles[i])throw TypeError(".CARTA.ImageProperties.stokesFiles: object expected");t.stokesFiles[i]=Lt.CARTA.StokesFile.fromObject(e.stokesFiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.stokesFiles=[]),(t.objects||t.defaults)&&(n.regions={}),t.defaults&&(n.directory="",n.file="",n.hdu="",n.fileId=0,n.renderMode=t.enums===String?"RASTER":0,n.channel=0,n.stokes=0,n.contourSettings=null),null!=e.directory&&e.hasOwnProperty("directory")&&(n.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(n.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(n.hdu=e.hdu),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(n.renderMode=t.enums===String?Lt.CARTA.RenderMode[e.renderMode]:e.renderMode),null!=e.channel&&e.hasOwnProperty("channel")&&(n.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(n.stokes=e.stokes),e.regions&&(i=Object.keys(e.regions)).length){n.regions={};for(let r=0;r<i.length;++r)n.regions[i[r]]=Lt.CARTA.RegionInfo.toObject(e.regions[i[r]],t)}if(null!=e.contourSettings&&e.hasOwnProperty("contourSettings")&&(n.contourSettings=Lt.CARTA.SetContourParameters.toObject(e.contourSettings,t)),e.stokesFiles&&e.stokesFiles.length){n.stokesFiles=[];for(let i=0;i<e.stokesFiles.length;++i)n.stokesFiles[i]=Lt.CARTA.StokesFile.toObject(e.stokesFiles[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ResumeSession=function(){function e(e){if(this.images=[],this.catalogFiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.images=Dt.emptyArray,e.prototype.catalogFiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.images&&e.images.length)for(let i=0;i<e.images.length;++i)Lt.CARTA.ImageProperties.encode(e.images[i],t.uint32(10).fork()).ldelim();if(null!=e.catalogFiles&&e.catalogFiles.length)for(let i=0;i<e.catalogFiles.length;++i)Lt.CARTA.OpenCatalogFile.encode(e.catalogFiles[i],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ResumeSession;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.images&&n.images.length||(n.images=[]),n.images.push(Lt.CARTA.ImageProperties.decode(e,e.uint32()));break;case 2:n.catalogFiles&&n.catalogFiles.length||(n.catalogFiles=[]),n.catalogFiles.push(Lt.CARTA.OpenCatalogFile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.images&&e.hasOwnProperty("images")){if(!Array.isArray(e.images))return"images: array expected";for(let t=0;t<e.images.length;++t){let i=Lt.CARTA.ImageProperties.verify(e.images[t]);if(i)return"images."+i}}if(null!=e.catalogFiles&&e.hasOwnProperty("catalogFiles")){if(!Array.isArray(e.catalogFiles))return"catalogFiles: array expected";for(let t=0;t<e.catalogFiles.length;++t){let i=Lt.CARTA.OpenCatalogFile.verify(e.catalogFiles[t]);if(i)return"catalogFiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ResumeSession)return e;let t=new Lt.CARTA.ResumeSession;if(e.images){if(!Array.isArray(e.images))throw TypeError(".CARTA.ResumeSession.images: array expected");t.images=[];for(let i=0;i<e.images.length;++i){if("object"!==typeof e.images[i])throw TypeError(".CARTA.ResumeSession.images: object expected");t.images[i]=Lt.CARTA.ImageProperties.fromObject(e.images[i])}}if(e.catalogFiles){if(!Array.isArray(e.catalogFiles))throw TypeError(".CARTA.ResumeSession.catalogFiles: array expected");t.catalogFiles=[];for(let i=0;i<e.catalogFiles.length;++i){if("object"!==typeof e.catalogFiles[i])throw TypeError(".CARTA.ResumeSession.catalogFiles: object expected");t.catalogFiles[i]=Lt.CARTA.OpenCatalogFile.fromObject(e.catalogFiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.images=[],i.catalogFiles=[]),e.images&&e.images.length){i.images=[];for(let n=0;n<e.images.length;++n)i.images[n]=Lt.CARTA.ImageProperties.toObject(e.images[n],t)}if(e.catalogFiles&&e.catalogFiles.length){i.catalogFiles=[];for(let n=0;n<e.catalogFiles.length;++n)i.catalogFiles[n]=Lt.CARTA.OpenCatalogFile.toObject(e.catalogFiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ResumeSessionAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ResumeSessionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ResumeSessionAck)return e;let t=new Lt.CARTA.ResumeSessionAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetCursor=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.point=null,e.prototype.spatialRequirements=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.point&&Object.hasOwnProperty.call(e,"point")&&Lt.CARTA.Point.encode(e.point,t.uint32(18).fork()).ldelim(),null!=e.spatialRequirements&&Object.hasOwnProperty.call(e,"spatialRequirements")&&Lt.CARTA.SetSpatialRequirements.encode(e.spatialRequirements,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetCursor;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.point=Lt.CARTA.Point.decode(e,e.uint32());break;case 3:n.spatialRequirements=Lt.CARTA.SetSpatialRequirements.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.point&&e.hasOwnProperty("point")){let t=Lt.CARTA.Point.verify(e.point);if(t)return"point."+t}if(null!=e.spatialRequirements&&e.hasOwnProperty("spatialRequirements")){let t=Lt.CARTA.SetSpatialRequirements.verify(e.spatialRequirements);if(t)return"spatialRequirements."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetCursor)return e;let t=new Lt.CARTA.SetCursor;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.point){if("object"!==typeof e.point)throw TypeError(".CARTA.SetCursor.point: object expected");t.point=Lt.CARTA.Point.fromObject(e.point)}if(null!=e.spatialRequirements){if("object"!==typeof e.spatialRequirements)throw TypeError(".CARTA.SetCursor.spatialRequirements: object expected");t.spatialRequirements=Lt.CARTA.SetSpatialRequirements.fromObject(e.spatialRequirements)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.point=null,i.spatialRequirements=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.point&&e.hasOwnProperty("point")&&(i.point=Lt.CARTA.Point.toObject(e.point,t)),null!=e.spatialRequirements&&e.hasOwnProperty("spatialRequirements")&&(i.spatialRequirements=Lt.CARTA.SetSpatialRequirements.toObject(e.spatialRequirements,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetImageChannels=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.requiredTiles=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.requiredTiles&&Object.hasOwnProperty.call(e,"requiredTiles")&&Lt.CARTA.AddRequiredTiles.encode(e.requiredTiles,t.uint32(34).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetImageChannels;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.requiredTiles=Lt.CARTA.AddRequiredTiles.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")){let t=Lt.CARTA.AddRequiredTiles.verify(e.requiredTiles);if(t)return"requiredTiles."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetImageChannels)return e;let t=new Lt.CARTA.SetImageChannels;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.requiredTiles){if("object"!==typeof e.requiredTiles)throw TypeError(".CARTA.SetImageChannels.requiredTiles: object expected");t.requiredTiles=Lt.CARTA.AddRequiredTiles.fromObject(e.requiredTiles)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.requiredTiles=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")&&(i.requiredTiles=Lt.CARTA.AddRequiredTiles.toObject(e.requiredTiles,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SplataloguePing=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SplataloguePing;for(;e.pos<i;){let t=e.uint32();e.skipType(7&t)}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof Lt.CARTA.SplataloguePing?e:new Lt.CARTA.SplataloguePing},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SplataloguePong=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SplataloguePong;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SplataloguePong)return e;let t=new Lt.CARTA.SplataloguePong;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SpectralLineRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.frequencyRange=null,e.prototype.lineIntensityLowerLimit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.frequencyRange&&Object.hasOwnProperty.call(e,"frequencyRange")&&Lt.CARTA.DoubleBounds.encode(e.frequencyRange,t.uint32(10).fork()).ldelim(),null!=e.lineIntensityLowerLimit&&Object.hasOwnProperty.call(e,"lineIntensityLowerLimit")&&t.uint32(17).double(e.lineIntensityLowerLimit),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SpectralLineRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.frequencyRange=Lt.CARTA.DoubleBounds.decode(e,e.uint32());break;case 2:n.lineIntensityLowerLimit=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.frequencyRange&&e.hasOwnProperty("frequencyRange")){let t=Lt.CARTA.DoubleBounds.verify(e.frequencyRange);if(t)return"frequencyRange."+t}return null!=e.lineIntensityLowerLimit&&e.hasOwnProperty("lineIntensityLowerLimit")&&"number"!==typeof e.lineIntensityLowerLimit?"lineIntensityLowerLimit: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SpectralLineRequest)return e;let t=new Lt.CARTA.SpectralLineRequest;if(null!=e.frequencyRange){if("object"!==typeof e.frequencyRange)throw TypeError(".CARTA.SpectralLineRequest.frequencyRange: object expected");t.frequencyRange=Lt.CARTA.DoubleBounds.fromObject(e.frequencyRange)}return null!=e.lineIntensityLowerLimit&&(t.lineIntensityLowerLimit=Number(e.lineIntensityLowerLimit)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.frequencyRange=null,i.lineIntensityLowerLimit=0),null!=e.frequencyRange&&e.hasOwnProperty("frequencyRange")&&(i.frequencyRange=Lt.CARTA.DoubleBounds.toObject(e.frequencyRange,t)),null!=e.lineIntensityLowerLimit&&e.hasOwnProperty("lineIntensityLowerLimit")&&(i.lineIntensityLowerLimit=t.json&&!isFinite(e.lineIntensityLowerLimit)?String(e.lineIntensityLowerLimit):e.lineIntensityLowerLimit),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SpectralLineResponse=function(){function e(e){if(this.headers=[],this.spectralLineData={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.dataSize=0,e.prototype.headers=Dt.emptyArray,e.prototype.spectralLineData=Dt.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.dataSize&&Object.hasOwnProperty.call(e,"dataSize")&&t.uint32(29).sfixed32(e.dataSize),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)Lt.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(34).fork()).ldelim();if(null!=e.spectralLineData&&Object.hasOwnProperty.call(e,"spectralLineData"))for(let i=Object.keys(e.spectralLineData),n=0;n<i.length;++n)t.uint32(42).fork().uint32(13).fixed32(i[n]),Lt.CARTA.ColumnData.encode(e.spectralLineData[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.SpectralLineResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.success=e.bool();break;case 2:r.message=e.string();break;case 3:r.dataSize=e.sfixed32();break;case 4:r.headers&&r.headers.length||(r.headers=[]),r.headers.push(Lt.CARTA.CatalogHeader.decode(e,e.uint32()));break;case 5:e.skip().pos++,r.spectralLineData===Dt.emptyObject&&(r.spectralLineData={}),i=e.fixed32(),e.pos++,r.spectralLineData[i]=Lt.CARTA.ColumnData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.dataSize&&e.hasOwnProperty("dataSize")&&!Dt.isInteger(e.dataSize))return"dataSize: integer expected";if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=Lt.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}if(null!=e.spectralLineData&&e.hasOwnProperty("spectralLineData")){if(!Dt.isObject(e.spectralLineData))return"spectralLineData: object expected";let t=Object.keys(e.spectralLineData);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"spectralLineData: integer key{k:fixed32} expected";{let n=Lt.CARTA.ColumnData.verify(e.spectralLineData[t[i]]);if(n)return"spectralLineData."+n}}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SpectralLineResponse)return e;let t=new Lt.CARTA.SpectralLineResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.dataSize&&(t.dataSize=0|e.dataSize),e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.SpectralLineResponse.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.SpectralLineResponse.headers: object expected");t.headers[i]=Lt.CARTA.CatalogHeader.fromObject(e.headers[i])}}if(e.spectralLineData){if("object"!==typeof e.spectralLineData)throw TypeError(".CARTA.SpectralLineResponse.spectralLineData: object expected");t.spectralLineData={};for(let i=Object.keys(e.spectralLineData),n=0;n<i.length;++n){if("object"!==typeof e.spectralLineData[i[n]])throw TypeError(".CARTA.SpectralLineResponse.spectralLineData: object expected");t.spectralLineData[i[n]]=Lt.CARTA.ColumnData.fromObject(e.spectralLineData[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.headers=[]),(t.objects||t.defaults)&&(n.spectralLineData={}),t.defaults&&(n.success=!1,n.message="",n.dataSize=0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.dataSize&&e.hasOwnProperty("dataSize")&&(n.dataSize=e.dataSize),e.headers&&e.headers.length){n.headers=[];for(let i=0;i<e.headers.length;++i)n.headers[i]=Lt.CARTA.CatalogHeader.toObject(e.headers[i],t)}if(e.spectralLineData&&(i=Object.keys(e.spectralLineData)).length){n.spectralLineData={};for(let r=0;r<i.length;++r)n.spectralLineData[i[r]]=Lt.CARTA.ColumnData.toObject(e.spectralLineData[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StopMomentCalc=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StopMomentCalc;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StopMomentCalc)return e;let t=new Lt.CARTA.StopMomentCalc;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StopPvCalc=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StopPvCalc;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StopPvCalc)return e;let t=new Lt.CARTA.StopPvCalc;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SetVectorOverlayParameters=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.imageBounds=null,e.prototype.smoothingFactor=0,e.prototype.fractional=!1,e.prototype.threshold=0,e.prototype.debiasing=!1,e.prototype.qError=0,e.prototype.uError=0,e.prototype.stokesIntensity=0,e.prototype.stokesAngle=0,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).fixed32(e.fileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&Lt.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.smoothingFactor&&Object.hasOwnProperty.call(e,"smoothingFactor")&&t.uint32(37).fixed32(e.smoothingFactor),null!=e.fractional&&Object.hasOwnProperty.call(e,"fractional")&&t.uint32(40).bool(e.fractional),null!=e.threshold&&Object.hasOwnProperty.call(e,"threshold")&&t.uint32(49).double(e.threshold),null!=e.debiasing&&Object.hasOwnProperty.call(e,"debiasing")&&t.uint32(56).bool(e.debiasing),null!=e.qError&&Object.hasOwnProperty.call(e,"qError")&&t.uint32(65).double(e.qError),null!=e.uError&&Object.hasOwnProperty.call(e,"uError")&&t.uint32(73).double(e.uError),null!=e.stokesIntensity&&Object.hasOwnProperty.call(e,"stokesIntensity")&&t.uint32(85).sfixed32(e.stokesIntensity),null!=e.stokesAngle&&Object.hasOwnProperty.call(e,"stokesAngle")&&t.uint32(93).sfixed32(e.stokesAngle),null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(96).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(109).float(e.compressionQuality),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SetVectorOverlayParameters;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.fixed32();break;case 3:n.imageBounds=Lt.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:n.smoothingFactor=e.fixed32();break;case 5:n.fractional=e.bool();break;case 6:n.threshold=e.double();break;case 7:n.debiasing=e.bool();break;case 8:n.qError=e.double();break;case 9:n.uError=e.double();break;case 10:n.stokesIntensity=e.sfixed32();break;case 11:n.stokesAngle=e.sfixed32();break;case 12:n.compressionType=e.int32();break;case 13:n.compressionQuality=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=Lt.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&!Dt.isInteger(e.smoothingFactor))return"smoothingFactor: integer expected";if(null!=e.fractional&&e.hasOwnProperty("fractional")&&"boolean"!==typeof e.fractional)return"fractional: boolean expected";if(null!=e.threshold&&e.hasOwnProperty("threshold")&&"number"!==typeof e.threshold)return"threshold: number expected";if(null!=e.debiasing&&e.hasOwnProperty("debiasing")&&"boolean"!==typeof e.debiasing)return"debiasing: boolean expected";if(null!=e.qError&&e.hasOwnProperty("qError")&&"number"!==typeof e.qError)return"qError: number expected";if(null!=e.uError&&e.hasOwnProperty("uError")&&"number"!==typeof e.uError)return"uError: number expected";if(null!=e.stokesIntensity&&e.hasOwnProperty("stokesIntensity")&&!Dt.isInteger(e.stokesIntensity))return"stokesIntensity: integer expected";if(null!=e.stokesAngle&&e.hasOwnProperty("stokesAngle")&&!Dt.isInteger(e.stokesAngle))return"stokesAngle: integer expected";if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}return null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality?"compressionQuality: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SetVectorOverlayParameters)return e;let t=new Lt.CARTA.SetVectorOverlayParameters;if(null!=e.fileId&&(t.fileId=e.fileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.SetVectorOverlayParameters.imageBounds: object expected");t.imageBounds=Lt.CARTA.ImageBounds.fromObject(e.imageBounds)}switch(null!=e.smoothingFactor&&(t.smoothingFactor=e.smoothingFactor>>>0),null!=e.fractional&&(t.fractional=Boolean(e.fractional)),null!=e.threshold&&(t.threshold=Number(e.threshold)),null!=e.debiasing&&(t.debiasing=Boolean(e.debiasing)),null!=e.qError&&(t.qError=Number(e.qError)),null!=e.uError&&(t.uError=Number(e.uError)),null!=e.stokesIntensity&&(t.stokesIntensity=0|e.stokesIntensity),null!=e.stokesAngle&&(t.stokesAngle=0|e.stokesAngle),e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}return null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.imageBounds=null,i.smoothingFactor=0,i.fractional=!1,i.threshold=0,i.debiasing=!1,i.qError=0,i.uError=0,i.stokesIntensity=0,i.stokesAngle=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=Lt.CARTA.ImageBounds.toObject(e.imageBounds,t)),null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&(i.smoothingFactor=e.smoothingFactor),null!=e.fractional&&e.hasOwnProperty("fractional")&&(i.fractional=e.fractional),null!=e.threshold&&e.hasOwnProperty("threshold")&&(i.threshold=t.json&&!isFinite(e.threshold)?String(e.threshold):e.threshold),null!=e.debiasing&&e.hasOwnProperty("debiasing")&&(i.debiasing=e.debiasing),null!=e.qError&&e.hasOwnProperty("qError")&&(i.qError=t.json&&!isFinite(e.qError)?String(e.qError):e.qError),null!=e.uError&&e.hasOwnProperty("uError")&&(i.uError=t.json&&!isFinite(e.uError)?String(e.uError):e.uError),null!=e.stokesIntensity&&e.hasOwnProperty("stokesIntensity")&&(i.stokesIntensity=e.stokesIntensity),null!=e.stokesAngle&&e.hasOwnProperty("stokesAngle")&&(i.stokesAngle=e.stokesAngle),null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?Lt.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogFileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.name="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogFileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.name=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory)?"directory: string expected":null!=e.name&&e.hasOwnProperty("name")&&!Dt.isString(e.name)?"name: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogFileInfoRequest)return e;let t=new Lt.CARTA.CatalogFileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.name&&(t.name=String(e.name)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.name=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogFileInfoResponse=function(){function e(e){if(this.headers=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.headers=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&Lt.CARTA.CatalogFileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)Lt.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogFileInfoResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.fileInfo=Lt.CARTA.CatalogFileInfo.decode(e,e.uint32());break;case 4:n.headers&&n.headers.length||(n.headers=[]),n.headers.push(Lt.CARTA.CatalogHeader.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=Lt.CARTA.CatalogFileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=Lt.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogFileInfoResponse)return e;let t=new Lt.CARTA.CatalogFileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.CatalogFileInfoResponse.fileInfo: object expected");t.fileInfo=Lt.CARTA.CatalogFileInfo.fromObject(e.fileInfo)}if(e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.CatalogFileInfoResponse.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.CatalogFileInfoResponse.headers: object expected");t.headers[i]=Lt.CARTA.CatalogHeader.fromObject(e.headers[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.headers=[]),t.defaults&&(i.success=!1,i.message="",i.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=Lt.CARTA.CatalogFileInfo.toObject(e.fileInfo,t)),e.headers&&e.headers.length){i.headers=[];for(let n=0;n<e.headers.length;++n)i.headers[n]=Lt.CARTA.CatalogHeader.toObject(e.headers[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.filterMode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.filterMode&&Object.hasOwnProperty.call(e,"filterMode")&&t.uint32(16).int32(e.filterMode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.filterMode=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.filterMode&&e.hasOwnProperty("filterMode"))switch(e.filterMode){default:return"filterMode: enum value expected";case 0:case 1:case 2:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogListRequest)return e;let t=new Lt.CARTA.CatalogListRequest;switch(null!=e.directory&&(t.directory=String(e.directory)),e.filterMode){case"Content":case 0:t.filterMode=0;break;case"Extension":case 1:t.filterMode=1;break;case"AllFiles":case 2:t.filterMode=2}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.filterMode=t.enums===String?"Content":0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.filterMode&&e.hasOwnProperty("filterMode")&&(i.filterMode=t.enums===String?Lt.CARTA.FileListFilterMode[e.filterMode]:e.filterMode),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=Dt.emptyArray,e.prototype.subdirectories=Dt.emptyArray,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)Lt.CARTA.CatalogFileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)Lt.CARTA.DirectoryInfo.encode(e.subdirectories[i],t.uint32(50).fork()).ldelim();return null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(56).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(Lt.CARTA.CatalogFileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(Lt.CARTA.DirectoryInfo.decode(e,e.uint32()));break;case 7:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!Dt.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=Lt.CARTA.CatalogFileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t){let i=Lt.CARTA.DirectoryInfo.verify(e.subdirectories[t]);if(i)return"subdirectories."+i}}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogListResponse)return e;let t=new Lt.CARTA.CatalogListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.CatalogListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.CatalogListResponse.files: object expected");t.files[i]=Lt.CARTA.CatalogFileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.CatalogListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i){if("object"!==typeof e.subdirectories[i])throw TypeError(".CARTA.CatalogListResponse.subdirectories: object expected");t.subdirectories[i]=Lt.CARTA.DirectoryInfo.fromObject(e.subdirectories[i])}}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent="",i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=Lt.CARTA.CatalogFileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let n=0;n<e.subdirectories.length;++n)i.subdirectories[n]=Lt.CARTA.DirectoryInfo.toObject(e.subdirectories[n],t)}return null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file)?"file: string expected":null!=e.hdu&&e.hasOwnProperty("hdu")&&!Dt.isString(e.hdu)?"hdu: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FileInfoRequest)return e;let t=new Lt.CARTA.FileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FileInfoResponse=function(){function e(e){if(this.fileInfoExtended={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.fileInfoExtended=Dt.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&Lt.CARTA.FileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.fileInfoExtended&&Object.hasOwnProperty.call(e,"fileInfoExtended"))for(let i=Object.keys(e.fileInfoExtended),n=0;n<i.length;++n)t.uint32(34).fork().uint32(10).string(i[n]),Lt.CARTA.FileInfoExtended.encode(e.fileInfoExtended[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.FileInfoResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.success=e.bool();break;case 2:r.message=e.string();break;case 3:r.fileInfo=Lt.CARTA.FileInfo.decode(e,e.uint32());break;case 4:e.skip().pos++,r.fileInfoExtended===Dt.emptyObject&&(r.fileInfoExtended={}),i=e.string(),e.pos++,r.fileInfoExtended[i]=Lt.CARTA.FileInfoExtended.decode(e,e.uint32());break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=Lt.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")){if(!Dt.isObject(e.fileInfoExtended))return"fileInfoExtended: object expected";let t=Object.keys(e.fileInfoExtended);for(let i=0;i<t.length;++i){let n=Lt.CARTA.FileInfoExtended.verify(e.fileInfoExtended[t[i]]);if(n)return"fileInfoExtended."+n}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FileInfoResponse)return e;let t=new Lt.CARTA.FileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.FileInfoResponse.fileInfo: object expected");t.fileInfo=Lt.CARTA.FileInfo.fromObject(e.fileInfo)}if(e.fileInfoExtended){if("object"!==typeof e.fileInfoExtended)throw TypeError(".CARTA.FileInfoResponse.fileInfoExtended: object expected");t.fileInfoExtended={};for(let i=Object.keys(e.fileInfoExtended),n=0;n<i.length;++n){if("object"!==typeof e.fileInfoExtended[i[n]])throw TypeError(".CARTA.FileInfoResponse.fileInfoExtended: object expected");t.fileInfoExtended[i[n]]=Lt.CARTA.FileInfoExtended.fromObject(e.fileInfoExtended[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.fileInfoExtended={}),t.defaults&&(n.success=!1,n.message="",n.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(n.fileInfo=Lt.CARTA.FileInfo.toObject(e.fileInfo,t)),e.fileInfoExtended&&(i=Object.keys(e.fileInfoExtended)).length){n.fileInfoExtended={};for(let r=0;r<i.length;++r)n.fileInfoExtended[i[r]]=Lt.CARTA.FileInfoExtended.toObject(e.fileInfoExtended[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FileListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.filterMode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.filterMode&&Object.hasOwnProperty.call(e,"filterMode")&&t.uint32(16).int32(e.filterMode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FileListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.filterMode=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.filterMode&&e.hasOwnProperty("filterMode"))switch(e.filterMode){default:return"filterMode: enum value expected";case 0:case 1:case 2:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FileListRequest)return e;let t=new Lt.CARTA.FileListRequest;switch(null!=e.directory&&(t.directory=String(e.directory)),e.filterMode){case"Content":case 0:t.filterMode=0;break;case"Extension":case 1:t.filterMode=1;break;case"AllFiles":case 2:t.filterMode=2}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.filterMode=t.enums===String?"Content":0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.filterMode&&e.hasOwnProperty("filterMode")&&(i.filterMode=t.enums===String?Lt.CARTA.FileListFilterMode[e.filterMode]:e.filterMode),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FileListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=Dt.emptyArray,e.prototype.subdirectories=Dt.emptyArray,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)Lt.CARTA.FileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)Lt.CARTA.DirectoryInfo.encode(e.subdirectories[i],t.uint32(50).fork()).ldelim();return null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(56).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FileListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(Lt.CARTA.FileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(Lt.CARTA.DirectoryInfo.decode(e,e.uint32()));break;case 7:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!Dt.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=Lt.CARTA.FileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t){let i=Lt.CARTA.DirectoryInfo.verify(e.subdirectories[t]);if(i)return"subdirectories."+i}}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FileListResponse)return e;let t=new Lt.CARTA.FileListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.FileListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.FileListResponse.files: object expected");t.files[i]=Lt.CARTA.FileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.FileListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i){if("object"!==typeof e.subdirectories[i])throw TypeError(".CARTA.FileListResponse.subdirectories: object expected");t.subdirectories[i]=Lt.CARTA.DirectoryInfo.fromObject(e.subdirectories[i])}}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent="",i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=Lt.CARTA.FileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let n=0;n<e.subdirectories.length;++n)i.subdirectories[n]=Lt.CARTA.DirectoryInfo.toObject(e.subdirectories[n],t)}return null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.StopFileList=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileListType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileListType&&Object.hasOwnProperty.call(e,"fileListType")&&t.uint32(8).int32(e.fileListType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.StopFileList;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileListType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileListType&&e.hasOwnProperty("fileListType"))switch(e.fileListType){default:return"fileListType: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.StopFileList)return e;let t=new Lt.CARTA.StopFileList;switch(e.fileListType){case"Image":case 0:t.fileListType=0;break;case"Catalog":case 1:t.fileListType=1}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileListType=t.enums===String?"Image":0),null!=e.fileListType&&e.hasOwnProperty("fileListType")&&(i.fileListType=t.enums===String?Lt.CARTA.FileListType[e.fileListType]:e.fileListType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FittingRequest=function(){function e(e){if(this.initialValues=[],this.fixedParams=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.initialValues=Dt.emptyArray,e.prototype.fixedParams=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.initialValues&&e.initialValues.length)for(let i=0;i<e.initialValues.length;++i)Lt.CARTA.GaussianComponent.encode(e.initialValues[i],t.uint32(18).fork()).ldelim();if(null!=e.fixedParams&&e.fixedParams.length){t.uint32(26).fork();for(let i=0;i<e.fixedParams.length;++i)t.bool(e.fixedParams[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FittingRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.initialValues&&n.initialValues.length||(n.initialValues=[]),n.initialValues.push(Lt.CARTA.GaussianComponent.decode(e,e.uint32()));break;case 3:if(n.fixedParams&&n.fixedParams.length||(n.fixedParams=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.fixedParams.push(e.bool())}else n.fixedParams.push(e.bool());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.initialValues&&e.hasOwnProperty("initialValues")){if(!Array.isArray(e.initialValues))return"initialValues: array expected";for(let t=0;t<e.initialValues.length;++t){let i=Lt.CARTA.GaussianComponent.verify(e.initialValues[t]);if(i)return"initialValues."+i}}if(null!=e.fixedParams&&e.hasOwnProperty("fixedParams")){if(!Array.isArray(e.fixedParams))return"fixedParams: array expected";for(let t=0;t<e.fixedParams.length;++t)if("boolean"!==typeof e.fixedParams[t])return"fixedParams: boolean[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FittingRequest)return e;let t=new Lt.CARTA.FittingRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.initialValues){if(!Array.isArray(e.initialValues))throw TypeError(".CARTA.FittingRequest.initialValues: array expected");t.initialValues=[];for(let i=0;i<e.initialValues.length;++i){if("object"!==typeof e.initialValues[i])throw TypeError(".CARTA.FittingRequest.initialValues: object expected");t.initialValues[i]=Lt.CARTA.GaussianComponent.fromObject(e.initialValues[i])}}if(e.fixedParams){if(!Array.isArray(e.fixedParams))throw TypeError(".CARTA.FittingRequest.fixedParams: array expected");t.fixedParams=[];for(let i=0;i<e.fixedParams.length;++i)t.fixedParams[i]=Boolean(e.fixedParams[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.initialValues=[],i.fixedParams=[]),t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.initialValues&&e.initialValues.length){i.initialValues=[];for(let n=0;n<e.initialValues.length;++n)i.initialValues[n]=Lt.CARTA.GaussianComponent.toObject(e.initialValues[n],t)}if(e.fixedParams&&e.fixedParams.length){i.fixedParams=[];for(let t=0;t<e.fixedParams.length;++t)i.fixedParams[t]=e.fixedParams[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.FittingResponse=function(){function e(e){if(this.resultValues=[],this.resultErrors=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.resultValues=Dt.emptyArray,e.prototype.resultErrors=Dt.emptyArray,e.prototype.log="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.resultValues&&e.resultValues.length)for(let i=0;i<e.resultValues.length;++i)Lt.CARTA.GaussianComponent.encode(e.resultValues[i],t.uint32(26).fork()).ldelim();if(null!=e.resultErrors&&e.resultErrors.length)for(let i=0;i<e.resultErrors.length;++i)Lt.CARTA.GaussianComponent.encode(e.resultErrors[i],t.uint32(34).fork()).ldelim();return null!=e.log&&Object.hasOwnProperty.call(e,"log")&&t.uint32(42).string(e.log),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.FittingResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.resultValues&&n.resultValues.length||(n.resultValues=[]),n.resultValues.push(Lt.CARTA.GaussianComponent.decode(e,e.uint32()));break;case 4:n.resultErrors&&n.resultErrors.length||(n.resultErrors=[]),n.resultErrors.push(Lt.CARTA.GaussianComponent.decode(e,e.uint32()));break;case 5:n.log=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.resultValues&&e.hasOwnProperty("resultValues")){if(!Array.isArray(e.resultValues))return"resultValues: array expected";for(let t=0;t<e.resultValues.length;++t){let i=Lt.CARTA.GaussianComponent.verify(e.resultValues[t]);if(i)return"resultValues."+i}}if(null!=e.resultErrors&&e.hasOwnProperty("resultErrors")){if(!Array.isArray(e.resultErrors))return"resultErrors: array expected";for(let t=0;t<e.resultErrors.length;++t){let i=Lt.CARTA.GaussianComponent.verify(e.resultErrors[t]);if(i)return"resultErrors."+i}}return null!=e.log&&e.hasOwnProperty("log")&&!Dt.isString(e.log)?"log: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.FittingResponse)return e;let t=new Lt.CARTA.FittingResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.resultValues){if(!Array.isArray(e.resultValues))throw TypeError(".CARTA.FittingResponse.resultValues: array expected");t.resultValues=[];for(let i=0;i<e.resultValues.length;++i){if("object"!==typeof e.resultValues[i])throw TypeError(".CARTA.FittingResponse.resultValues: object expected");t.resultValues[i]=Lt.CARTA.GaussianComponent.fromObject(e.resultValues[i])}}if(e.resultErrors){if(!Array.isArray(e.resultErrors))throw TypeError(".CARTA.FittingResponse.resultErrors: array expected");t.resultErrors=[];for(let i=0;i<e.resultErrors.length;++i){if("object"!==typeof e.resultErrors[i])throw TypeError(".CARTA.FittingResponse.resultErrors: object expected");t.resultErrors[i]=Lt.CARTA.GaussianComponent.fromObject(e.resultErrors[i])}}return null!=e.log&&(t.log=String(e.log)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.resultValues=[],i.resultErrors=[]),t.defaults&&(i.success=!1,i.message="",i.log=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.resultValues&&e.resultValues.length){i.resultValues=[];for(let n=0;n<e.resultValues.length;++n)i.resultValues[n]=Lt.CARTA.GaussianComponent.toObject(e.resultValues[n],t)}if(e.resultErrors&&e.resultErrors.length){i.resultErrors=[];for(let n=0;n<e.resultErrors.length;++n)i.resultErrors[n]=Lt.CARTA.GaussianComponent.toObject(e.resultErrors[n],t)}return null!=e.log&&e.hasOwnProperty("log")&&(i.log=e.log),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.MomentRequest=function(){function e(e){if(this.moments=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.moments=Dt.emptyArray,e.prototype.axis=0,e.prototype.regionId=0,e.prototype.spectralRange=null,e.prototype.mask=0,e.prototype.pixelRange=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.moments&&e.moments.length){t.uint32(18).fork();for(let i=0;i<e.moments.length;++i)t.int32(e.moments[i]);t.ldelim()}return null!=e.axis&&Object.hasOwnProperty.call(e,"axis")&&t.uint32(24).int32(e.axis),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(37).sfixed32(e.regionId),null!=e.spectralRange&&Object.hasOwnProperty.call(e,"spectralRange")&&Lt.CARTA.IntBounds.encode(e.spectralRange,t.uint32(42).fork()).ldelim(),null!=e.mask&&Object.hasOwnProperty.call(e,"mask")&&t.uint32(48).int32(e.mask),null!=e.pixelRange&&Object.hasOwnProperty.call(e,"pixelRange")&&Lt.CARTA.FloatBounds.encode(e.pixelRange,t.uint32(58).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.MomentRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.moments&&n.moments.length||(n.moments=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.moments.push(e.int32())}else n.moments.push(e.int32());break;case 3:n.axis=e.int32();break;case 4:n.regionId=e.sfixed32();break;case 5:n.spectralRange=Lt.CARTA.IntBounds.decode(e,e.uint32());break;case 6:n.mask=e.int32();break;case 7:n.pixelRange=Lt.CARTA.FloatBounds.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.moments&&e.hasOwnProperty("moments")){if(!Array.isArray(e.moments))return"moments: array expected";for(let t=0;t<e.moments.length;++t)switch(e.moments[t]){default:return"moments: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}}if(null!=e.axis&&e.hasOwnProperty("axis"))switch(e.axis){default:return"axis: enum value expected";case 0:case 1:}if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spectralRange&&e.hasOwnProperty("spectralRange")){let t=Lt.CARTA.IntBounds.verify(e.spectralRange);if(t)return"spectralRange."+t}if(null!=e.mask&&e.hasOwnProperty("mask"))switch(e.mask){default:return"mask: enum value expected";case 0:case 1:case 2:}if(null!=e.pixelRange&&e.hasOwnProperty("pixelRange")){let t=Lt.CARTA.FloatBounds.verify(e.pixelRange);if(t)return"pixelRange."+t}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.MomentRequest)return e;let t=new Lt.CARTA.MomentRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.moments){if(!Array.isArray(e.moments))throw TypeError(".CARTA.MomentRequest.moments: array expected");t.moments=[];for(let i=0;i<e.moments.length;++i)switch(e.moments[i]){default:case"MEAN_OF_THE_SPECTRUM":case 0:t.moments[i]=0;break;case"INTEGRATED_OF_THE_SPECTRUM":case 1:t.moments[i]=1;break;case"INTENSITY_WEIGHTED_COORD":case 2:t.moments[i]=2;break;case"INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD":case 3:t.moments[i]=3;break;case"MEDIAN_OF_THE_SPECTRUM":case 4:t.moments[i]=4;break;case"MEDIAN_COORDINATE":case 5:t.moments[i]=5;break;case"STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM":case 6:t.moments[i]=6;break;case"RMS_OF_THE_SPECTRUM":case 7:t.moments[i]=7;break;case"ABS_MEAN_DEVIATION_OF_THE_SPECTRUM":case 8:t.moments[i]=8;break;case"MAX_OF_THE_SPECTRUM":case 9:t.moments[i]=9;break;case"COORD_OF_THE_MAX_OF_THE_SPECTRUM":case 10:t.moments[i]=10;break;case"MIN_OF_THE_SPECTRUM":case 11:t.moments[i]=11;break;case"COORD_OF_THE_MIN_OF_THE_SPECTRUM":case 12:t.moments[i]=12}}switch(e.axis){case"SPECTRAL":case 0:t.axis=0;break;case"STOKES":case 1:t.axis=1}if(null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.spectralRange){if("object"!==typeof e.spectralRange)throw TypeError(".CARTA.MomentRequest.spectralRange: object expected");t.spectralRange=Lt.CARTA.IntBounds.fromObject(e.spectralRange)}switch(e.mask){case"None":case 0:t.mask=0;break;case"Include":case 1:t.mask=1;break;case"Exclude":case 2:t.mask=2}if(null!=e.pixelRange){if("object"!==typeof e.pixelRange)throw TypeError(".CARTA.MomentRequest.pixelRange: object expected");t.pixelRange=Lt.CARTA.FloatBounds.fromObject(e.pixelRange)}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.moments=[]),t.defaults&&(i.fileId=0,i.axis=t.enums===String?"SPECTRAL":0,i.regionId=0,i.spectralRange=null,i.mask=t.enums===String?"None":0,i.pixelRange=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.moments&&e.moments.length){i.moments=[];for(let n=0;n<e.moments.length;++n)i.moments[n]=t.enums===String?Lt.CARTA.Moment[e.moments[n]]:e.moments[n]}return null!=e.axis&&e.hasOwnProperty("axis")&&(i.axis=t.enums===String?Lt.CARTA.MomentAxis[e.axis]:e.axis),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.spectralRange&&e.hasOwnProperty("spectralRange")&&(i.spectralRange=Lt.CARTA.IntBounds.toObject(e.spectralRange,t)),null!=e.mask&&e.hasOwnProperty("mask")&&(i.mask=t.enums===String?Lt.CARTA.MomentMask[e.mask]:e.mask),null!=e.pixelRange&&e.hasOwnProperty("pixelRange")&&(i.pixelRange=Lt.CARTA.FloatBounds.toObject(e.pixelRange,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.MomentResponse=function(){function e(e){if(this.openFileAcks=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.openFileAcks=Dt.emptyArray,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.openFileAcks&&e.openFileAcks.length)for(let i=0;i<e.openFileAcks.length;++i)Lt.CARTA.OpenFileAck.encode(e.openFileAcks[i],t.uint32(26).fork()).ldelim();return null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(32).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.MomentResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.openFileAcks&&n.openFileAcks.length||(n.openFileAcks=[]),n.openFileAcks.push(Lt.CARTA.OpenFileAck.decode(e,e.uint32()));break;case 4:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.openFileAcks&&e.hasOwnProperty("openFileAcks")){if(!Array.isArray(e.openFileAcks))return"openFileAcks: array expected";for(let t=0;t<e.openFileAcks.length;++t){let i=Lt.CARTA.OpenFileAck.verify(e.openFileAcks[t]);if(i)return"openFileAcks."+i}}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.MomentResponse)return e;let t=new Lt.CARTA.MomentResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.openFileAcks){if(!Array.isArray(e.openFileAcks))throw TypeError(".CARTA.MomentResponse.openFileAcks: array expected");t.openFileAcks=[];for(let i=0;i<e.openFileAcks.length;++i){if("object"!==typeof e.openFileAcks[i])throw TypeError(".CARTA.MomentResponse.openFileAcks: object expected");t.openFileAcks[i]=Lt.CARTA.OpenFileAck.fromObject(e.openFileAcks[i])}}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.openFileAcks=[]),t.defaults&&(i.success=!1,i.message="",i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.openFileAcks&&e.openFileAcks.length){i.openFileAcks=[];for(let n=0;n<e.openFileAcks.length;++n)i.openFileAcks[n]=Lt.CARTA.OpenFileAck.toObject(e.openFileAcks[n],t)}return null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.MomentProgress=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(21).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.MomentProgress;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.MomentProgress)return e;let t=new Lt.CARTA.MomentProgress;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.PvRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.width=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(29).sfixed32(e.width),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.PvRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.width=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId)?"regionId: integer expected":null!=e.width&&e.hasOwnProperty("width")&&!Dt.isInteger(e.width)?"width: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.PvRequest)return e;let t=new Lt.CARTA.PvRequest;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.width&&(t.width=0|e.width),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.regionId=0,i.width=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.PvResponse=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.openFileAck=null,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.openFileAck&&Object.hasOwnProperty.call(e,"openFileAck")&&Lt.CARTA.OpenFileAck.encode(e.openFileAck,t.uint32(26).fork()).ldelim(),null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(32).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.PvResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.openFileAck=Lt.CARTA.OpenFileAck.decode(e,e.uint32());break;case 4:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.openFileAck&&e.hasOwnProperty("openFileAck")){let t=Lt.CARTA.OpenFileAck.verify(e.openFileAck);if(t)return"openFileAck."+t}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.PvResponse)return e;let t=new Lt.CARTA.PvResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.openFileAck){if("object"!==typeof e.openFileAck)throw TypeError(".CARTA.PvResponse.openFileAck: object expected");t.openFileAck=Lt.CARTA.OpenFileAck.fromObject(e.openFileAck)}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.openFileAck=null,i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.openFileAck&&e.hasOwnProperty("openFileAck")&&(i.openFileAck=Lt.CARTA.OpenFileAck.toObject(e.openFileAck,t)),null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.PvProgress=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(21).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.PvProgress;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.PvProgress)return e;let t=new Lt.CARTA.PvProgress;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionFileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionFileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!Dt.isString(e.file)?"file: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionFileInfoRequest)return e;let t=new Lt.CARTA.RegionFileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionFileInfoResponse=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.contents=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&Lt.CARTA.FileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(34).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionFileInfoResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.fileInfo=Lt.CARTA.FileInfo.decode(e,e.uint32());break;case 4:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=Lt.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!Dt.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionFileInfoResponse)return e;let t=new Lt.CARTA.RegionFileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.RegionFileInfoResponse.fileInfo: object expected");t.fileInfo=Lt.CARTA.FileInfo.fromObject(e.fileInfo)}if(e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.RegionFileInfoResponse.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.success=!1,i.message="",i.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=Lt.CARTA.FileInfo.toObject(e.fileInfo,t)),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.filterMode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.filterMode&&Object.hasOwnProperty.call(e,"filterMode")&&t.uint32(16).int32(e.filterMode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.filterMode=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.filterMode&&e.hasOwnProperty("filterMode"))switch(e.filterMode){default:return"filterMode: enum value expected";case 0:case 1:case 2:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionListRequest)return e;let t=new Lt.CARTA.RegionListRequest;switch(null!=e.directory&&(t.directory=String(e.directory)),e.filterMode){case"Content":case 0:t.filterMode=0;break;case"Extension":case 1:t.filterMode=1;break;case"AllFiles":case 2:t.filterMode=2}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.filterMode=t.enums===String?"Content":0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.filterMode&&e.hasOwnProperty("filterMode")&&(i.filterMode=t.enums===String?Lt.CARTA.FileListFilterMode[e.filterMode]:e.filterMode),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=Dt.emptyArray,e.prototype.subdirectories=Dt.emptyArray,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)Lt.CARTA.FileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)Lt.CARTA.DirectoryInfo.encode(e.subdirectories[i],t.uint32(50).fork()).ldelim();return null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(56).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(Lt.CARTA.FileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(Lt.CARTA.DirectoryInfo.decode(e,e.uint32()));break;case 7:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!Dt.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!Dt.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=Lt.CARTA.FileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t){let i=Lt.CARTA.DirectoryInfo.verify(e.subdirectories[t]);if(i)return"subdirectories."+i}}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionListResponse)return e;let t=new Lt.CARTA.RegionListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.RegionListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.RegionListResponse.files: object expected");t.files[i]=Lt.CARTA.FileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.RegionListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i){if("object"!==typeof e.subdirectories[i])throw TypeError(".CARTA.RegionListResponse.subdirectories: object expected");t.subdirectories[i]=Lt.CARTA.DirectoryInfo.fromObject(e.subdirectories[i])}}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent="",i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=Lt.CARTA.FileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let n=0;n<e.subdirectories.length;++n)i.subdirectories[n]=Lt.CARTA.DirectoryInfo.toObject(e.subdirectories[n],t)}return null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SaveFile=function(){function e(e){if(this.channels=[],this.stokes=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.outputFileDirectory="",e.prototype.outputFileName="",e.prototype.outputFileType=0,e.prototype.regionId=0,e.prototype.channels=Dt.emptyArray,e.prototype.stokes=Dt.emptyArray,e.prototype.keepDegenerate=!1,e.prototype.restFreq=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.outputFileDirectory&&Object.hasOwnProperty.call(e,"outputFileDirectory")&&t.uint32(18).string(e.outputFileDirectory),null!=e.outputFileName&&Object.hasOwnProperty.call(e,"outputFileName")&&t.uint32(26).string(e.outputFileName),null!=e.outputFileType&&Object.hasOwnProperty.call(e,"outputFileType")&&t.uint32(32).int32(e.outputFileType),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(45).sfixed32(e.regionId),null!=e.channels&&e.channels.length){t.uint32(50).fork();for(let i=0;i<e.channels.length;++i)t.sfixed32(e.channels[i]);t.ldelim()}if(null!=e.stokes&&e.stokes.length){t.uint32(58).fork();for(let i=0;i<e.stokes.length;++i)t.sfixed32(e.stokes[i]);t.ldelim()}return null!=e.keepDegenerate&&Object.hasOwnProperty.call(e,"keepDegenerate")&&t.uint32(64).bool(e.keepDegenerate),null!=e.restFreq&&Object.hasOwnProperty.call(e,"restFreq")&&t.uint32(73).double(e.restFreq),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SaveFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.outputFileDirectory=e.string();break;case 3:n.outputFileName=e.string();break;case 4:n.outputFileType=e.int32();break;case 5:n.regionId=e.sfixed32();break;case 6:if(n.channels&&n.channels.length||(n.channels=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.channels.push(e.sfixed32())}else n.channels.push(e.sfixed32());break;case 7:if(n.stokes&&n.stokes.length||(n.stokes=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.stokes.push(e.sfixed32())}else n.stokes.push(e.sfixed32());break;case 8:n.keepDegenerate=e.bool();break;case 9:n.restFreq=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.outputFileDirectory&&e.hasOwnProperty("outputFileDirectory")&&!Dt.isString(e.outputFileDirectory))return"outputFileDirectory: string expected";if(null!=e.outputFileName&&e.hasOwnProperty("outputFileName")&&!Dt.isString(e.outputFileName))return"outputFileName: string expected";if(null!=e.outputFileType&&e.hasOwnProperty("outputFileType"))switch(e.outputFileType){default:return"outputFileType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.channels&&e.hasOwnProperty("channels")){if(!Array.isArray(e.channels))return"channels: array expected";for(let t=0;t<e.channels.length;++t)if(!Dt.isInteger(e.channels[t]))return"channels: integer[] expected"}if(null!=e.stokes&&e.hasOwnProperty("stokes")){if(!Array.isArray(e.stokes))return"stokes: array expected";for(let t=0;t<e.stokes.length;++t)if(!Dt.isInteger(e.stokes[t]))return"stokes: integer[] expected"}return null!=e.keepDegenerate&&e.hasOwnProperty("keepDegenerate")&&"boolean"!==typeof e.keepDegenerate?"keepDegenerate: boolean expected":null!=e.restFreq&&e.hasOwnProperty("restFreq")&&"number"!==typeof e.restFreq?"restFreq: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SaveFile)return e;let t=new Lt.CARTA.SaveFile;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.outputFileDirectory&&(t.outputFileDirectory=String(e.outputFileDirectory)),null!=e.outputFileName&&(t.outputFileName=String(e.outputFileName)),e.outputFileType){case"CASA":case 0:t.outputFileType=0;break;case"CRTF":case 1:t.outputFileType=1;break;case"DS9_REG":case 2:t.outputFileType=2;break;case"FITS":case 3:t.outputFileType=3;break;case"HDF5":case 4:t.outputFileType=4;break;case"MIRIAD":case 5:t.outputFileType=5;break;case"UNKNOWN":case 6:t.outputFileType=6}if(null!=e.regionId&&(t.regionId=0|e.regionId),e.channels){if(!Array.isArray(e.channels))throw TypeError(".CARTA.SaveFile.channels: array expected");t.channels=[];for(let i=0;i<e.channels.length;++i)t.channels[i]=0|e.channels[i]}if(e.stokes){if(!Array.isArray(e.stokes))throw TypeError(".CARTA.SaveFile.stokes: array expected");t.stokes=[];for(let i=0;i<e.stokes.length;++i)t.stokes[i]=0|e.stokes[i]}return null!=e.keepDegenerate&&(t.keepDegenerate=Boolean(e.keepDegenerate)),null!=e.restFreq&&(t.restFreq=Number(e.restFreq)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.channels=[],i.stokes=[]),t.defaults&&(i.fileId=0,i.outputFileDirectory="",i.outputFileName="",i.outputFileType=t.enums===String?"CASA":0,i.regionId=0,i.keepDegenerate=!1,i.restFreq=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.outputFileDirectory&&e.hasOwnProperty("outputFileDirectory")&&(i.outputFileDirectory=e.outputFileDirectory),null!=e.outputFileName&&e.hasOwnProperty("outputFileName")&&(i.outputFileName=e.outputFileName),null!=e.outputFileType&&e.hasOwnProperty("outputFileType")&&(i.outputFileType=t.enums===String?Lt.CARTA.FileType[e.outputFileType]:e.outputFileType),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.channels&&e.channels.length){i.channels=[];for(let t=0;t<e.channels.length;++t)i.channels[t]=e.channels[t]}if(e.stokes&&e.stokes.length){i.stokes=[];for(let t=0;t<e.stokes.length;++t)i.stokes[t]=e.stokes[t]}return null!=e.keepDegenerate&&e.hasOwnProperty("keepDegenerate")&&(i.keepDegenerate=e.keepDegenerate),null!=e.restFreq&&e.hasOwnProperty("restFreq")&&(i.restFreq=t.json&&!isFinite(e.restFreq)?String(e.restFreq):e.restFreq),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SaveFileAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SaveFileAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.success=e.bool();break;case 3:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SaveFileAck)return e;let t=new Lt.CARTA.SaveFileAck;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.success=!1,i.message=""),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ScriptingRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.scriptingRequestId=0,e.prototype.target="",e.prototype.action="",e.prototype.parameters="",e.prototype.async=!1,e.prototype.returnPath="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.scriptingRequestId&&Object.hasOwnProperty.call(e,"scriptingRequestId")&&t.uint32(13).sfixed32(e.scriptingRequestId),null!=e.target&&Object.hasOwnProperty.call(e,"target")&&t.uint32(18).string(e.target),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(26).string(e.action),null!=e.parameters&&Object.hasOwnProperty.call(e,"parameters")&&t.uint32(34).string(e.parameters),null!=e.async&&Object.hasOwnProperty.call(e,"async")&&t.uint32(40).bool(e.async),null!=e.returnPath&&Object.hasOwnProperty.call(e,"returnPath")&&t.uint32(50).string(e.returnPath),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ScriptingRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.scriptingRequestId=e.sfixed32();break;case 2:n.target=e.string();break;case 3:n.action=e.string();break;case 4:n.parameters=e.string();break;case 5:n.async=e.bool();break;case 6:n.returnPath=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&!Dt.isInteger(e.scriptingRequestId)?"scriptingRequestId: integer expected":null!=e.target&&e.hasOwnProperty("target")&&!Dt.isString(e.target)?"target: string expected":null!=e.action&&e.hasOwnProperty("action")&&!Dt.isString(e.action)?"action: string expected":null!=e.parameters&&e.hasOwnProperty("parameters")&&!Dt.isString(e.parameters)?"parameters: string expected":null!=e.async&&e.hasOwnProperty("async")&&"boolean"!==typeof e.async?"async: boolean expected":null!=e.returnPath&&e.hasOwnProperty("returnPath")&&!Dt.isString(e.returnPath)?"returnPath: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ScriptingRequest)return e;let t=new Lt.CARTA.ScriptingRequest;return null!=e.scriptingRequestId&&(t.scriptingRequestId=0|e.scriptingRequestId),null!=e.target&&(t.target=String(e.target)),null!=e.action&&(t.action=String(e.action)),null!=e.parameters&&(t.parameters=String(e.parameters)),null!=e.async&&(t.async=Boolean(e.async)),null!=e.returnPath&&(t.returnPath=String(e.returnPath)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.scriptingRequestId=0,i.target="",i.action="",i.parameters="",i.async=!1,i.returnPath=""),null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&(i.scriptingRequestId=e.scriptingRequestId),null!=e.target&&e.hasOwnProperty("target")&&(i.target=e.target),null!=e.action&&e.hasOwnProperty("action")&&(i.action=e.action),null!=e.parameters&&e.hasOwnProperty("parameters")&&(i.parameters=e.parameters),null!=e.async&&e.hasOwnProperty("async")&&(i.async=e.async),null!=e.returnPath&&e.hasOwnProperty("returnPath")&&(i.returnPath=e.returnPath),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ScriptingResponse=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.scriptingRequestId=0,e.prototype.success=!1,e.prototype.message="",e.prototype.response="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.scriptingRequestId&&Object.hasOwnProperty.call(e,"scriptingRequestId")&&t.uint32(13).sfixed32(e.scriptingRequestId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.response&&Object.hasOwnProperty.call(e,"response")&&t.uint32(34).string(e.response),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ScriptingResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.scriptingRequestId=e.sfixed32();break;case 2:n.success=e.bool();break;case 3:n.message=e.string();break;case 4:n.response=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&!Dt.isInteger(e.scriptingRequestId)?"scriptingRequestId: integer expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null!=e.response&&e.hasOwnProperty("response")&&!Dt.isString(e.response)?"response: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ScriptingResponse)return e;let t=new Lt.CARTA.ScriptingResponse;return null!=e.scriptingRequestId&&(t.scriptingRequestId=0|e.scriptingRequestId),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.response&&(t.response=String(e.response)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.scriptingRequestId=0,i.success=!1,i.message="",i.response=""),null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&(i.scriptingRequestId=e.scriptingRequestId),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.response&&e.hasOwnProperty("response")&&(i.response=e.response),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogFilterRequest=function(){function e(e){if(this.columnIndices=[],this.filterConfigs=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.columnIndices=Dt.emptyArray,e.prototype.filterConfigs=Dt.emptyArray,e.prototype.subsetDataSize=0,e.prototype.subsetStartIndex=0,e.prototype.imageBounds=null,e.prototype.imageFileId=0,e.prototype.regionId=0,e.prototype.sortColumn="",e.prototype.sortingType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.columnIndices&&e.columnIndices.length){t.uint32(18).fork();for(let i=0;i<e.columnIndices.length;++i)t.int32(e.columnIndices[i]);t.ldelim()}if(null!=e.filterConfigs&&e.filterConfigs.length)for(let i=0;i<e.filterConfigs.length;++i)Lt.CARTA.FilterConfig.encode(e.filterConfigs[i],t.uint32(26).fork()).ldelim();return null!=e.subsetDataSize&&Object.hasOwnProperty.call(e,"subsetDataSize")&&t.uint32(37).sfixed32(e.subsetDataSize),null!=e.subsetStartIndex&&Object.hasOwnProperty.call(e,"subsetStartIndex")&&t.uint32(45).sfixed32(e.subsetStartIndex),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&Lt.CARTA.CatalogImageBounds.encode(e.imageBounds,t.uint32(50).fork()).ldelim(),null!=e.imageFileId&&Object.hasOwnProperty.call(e,"imageFileId")&&t.uint32(61).sfixed32(e.imageFileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(69).sfixed32(e.regionId),null!=e.sortColumn&&Object.hasOwnProperty.call(e,"sortColumn")&&t.uint32(74).string(e.sortColumn),null!=e.sortingType&&Object.hasOwnProperty.call(e,"sortingType")&&t.uint32(80).int32(e.sortingType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.CatalogFilterRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.columnIndices&&n.columnIndices.length||(n.columnIndices=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.columnIndices.push(e.int32())}else n.columnIndices.push(e.int32());break;case 3:n.filterConfigs&&n.filterConfigs.length||(n.filterConfigs=[]),n.filterConfigs.push(Lt.CARTA.FilterConfig.decode(e,e.uint32()));break;case 4:n.subsetDataSize=e.sfixed32();break;case 5:n.subsetStartIndex=e.sfixed32();break;case 6:n.imageBounds=Lt.CARTA.CatalogImageBounds.decode(e,e.uint32());break;case 7:n.imageFileId=e.sfixed32();break;case 8:n.regionId=e.sfixed32();break;case 9:n.sortColumn=e.string();break;case 10:n.sortingType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.columnIndices&&e.hasOwnProperty("columnIndices")){if(!Array.isArray(e.columnIndices))return"columnIndices: array expected";for(let t=0;t<e.columnIndices.length;++t)if(!Dt.isInteger(e.columnIndices[t]))return"columnIndices: integer[] expected"}if(null!=e.filterConfigs&&e.hasOwnProperty("filterConfigs")){if(!Array.isArray(e.filterConfigs))return"filterConfigs: array expected";for(let t=0;t<e.filterConfigs.length;++t){let i=Lt.CARTA.FilterConfig.verify(e.filterConfigs[t]);if(i)return"filterConfigs."+i}}if(null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&!Dt.isInteger(e.subsetDataSize))return"subsetDataSize: integer expected";if(null!=e.subsetStartIndex&&e.hasOwnProperty("subsetStartIndex")&&!Dt.isInteger(e.subsetStartIndex))return"subsetStartIndex: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=Lt.CARTA.CatalogImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&!Dt.isInteger(e.imageFileId))return"imageFileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.sortColumn&&e.hasOwnProperty("sortColumn")&&!Dt.isString(e.sortColumn))return"sortColumn: string expected";if(null!=e.sortingType&&e.hasOwnProperty("sortingType"))switch(e.sortingType){default:return"sortingType: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogFilterRequest)return e;let t=new Lt.CARTA.CatalogFilterRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.columnIndices){if(!Array.isArray(e.columnIndices))throw TypeError(".CARTA.CatalogFilterRequest.columnIndices: array expected");t.columnIndices=[];for(let i=0;i<e.columnIndices.length;++i)t.columnIndices[i]=0|e.columnIndices[i]}if(e.filterConfigs){if(!Array.isArray(e.filterConfigs))throw TypeError(".CARTA.CatalogFilterRequest.filterConfigs: array expected");t.filterConfigs=[];for(let i=0;i<e.filterConfigs.length;++i){if("object"!==typeof e.filterConfigs[i])throw TypeError(".CARTA.CatalogFilterRequest.filterConfigs: object expected");t.filterConfigs[i]=Lt.CARTA.FilterConfig.fromObject(e.filterConfigs[i])}}if(null!=e.subsetDataSize&&(t.subsetDataSize=0|e.subsetDataSize),null!=e.subsetStartIndex&&(t.subsetStartIndex=0|e.subsetStartIndex),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.CatalogFilterRequest.imageBounds: object expected");t.imageBounds=Lt.CARTA.CatalogImageBounds.fromObject(e.imageBounds)}switch(null!=e.imageFileId&&(t.imageFileId=0|e.imageFileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.sortColumn&&(t.sortColumn=String(e.sortColumn)),e.sortingType){case"Ascending":case 0:t.sortingType=0;break;case"Descending":case 1:t.sortingType=1}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.columnIndices=[],i.filterConfigs=[]),t.defaults&&(i.fileId=0,i.subsetDataSize=0,i.subsetStartIndex=0,i.imageBounds=null,i.imageFileId=0,i.regionId=0,i.sortColumn="",i.sortingType=t.enums===String?"Ascending":0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.columnIndices&&e.columnIndices.length){i.columnIndices=[];for(let t=0;t<e.columnIndices.length;++t)i.columnIndices[t]=e.columnIndices[t]}if(e.filterConfigs&&e.filterConfigs.length){i.filterConfigs=[];for(let n=0;n<e.filterConfigs.length;++n)i.filterConfigs[n]=Lt.CARTA.FilterConfig.toObject(e.filterConfigs[n],t)}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&(i.subsetDataSize=e.subsetDataSize),null!=e.subsetStartIndex&&e.hasOwnProperty("subsetStartIndex")&&(i.subsetStartIndex=e.subsetStartIndex),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=Lt.CARTA.CatalogImageBounds.toObject(e.imageBounds,t)),null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&(i.imageFileId=e.imageFileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.sortColumn&&e.hasOwnProperty("sortColumn")&&(i.sortColumn=e.sortColumn),null!=e.sortingType&&e.hasOwnProperty("sortingType")&&(i.sortingType=t.enums===String?Lt.CARTA.SortingType[e.sortingType]:e.sortingType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.CatalogFilterResponse=function(){function e(e){if(this.columns={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.imageFileId=0,e.prototype.regionId=0,e.prototype.columns=Dt.emptyObject,e.prototype.subsetDataSize=0,e.prototype.subsetEndIndex=0,e.prototype.progress=0,e.prototype.filterDataSize=0,e.prototype.requestEndIndex=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.imageFileId&&Object.hasOwnProperty.call(e,"imageFileId")&&t.uint32(21).sfixed32(e.imageFileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(29).sfixed32(e.regionId),null!=e.columns&&Object.hasOwnProperty.call(e,"columns"))for(let i=Object.keys(e.columns),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).fixed32(i[n]),Lt.CARTA.ColumnData.encode(e.columns[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.subsetDataSize&&Object.hasOwnProperty.call(e,"subsetDataSize")&&t.uint32(45).sfixed32(e.subsetDataSize),null!=e.subsetEndIndex&&Object.hasOwnProperty.call(e,"subsetEndIndex")&&t.uint32(53).sfixed32(e.subsetEndIndex),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(61).float(e.progress),null!=e.filterDataSize&&Object.hasOwnProperty.call(e,"filterDataSize")&&t.uint32(69).sfixed32(e.filterDataSize),null!=e.requestEndIndex&&Object.hasOwnProperty.call(e,"requestEndIndex")&&t.uint32(77).sfixed32(e.requestEndIndex),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i,n=void 0===t?e.len:e.pos+t,r=new Lt.CARTA.CatalogFilterResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:r.fileId=e.sfixed32();break;case 2:r.imageFileId=e.sfixed32();break;case 3:r.regionId=e.sfixed32();break;case 4:e.skip().pos++,r.columns===Dt.emptyObject&&(r.columns={}),i=e.fixed32(),e.pos++,r.columns[i]=Lt.CARTA.ColumnData.decode(e,e.uint32());break;case 5:r.subsetDataSize=e.sfixed32();break;case 6:r.subsetEndIndex=e.sfixed32();break;case 7:r.progress=e.float();break;case 8:r.filterDataSize=e.sfixed32();break;case 9:r.requestEndIndex=e.sfixed32();break;default:e.skipType(7&t)}}return r},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&!Dt.isInteger(e.imageFileId))return"imageFileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.columns&&e.hasOwnProperty("columns")){if(!Dt.isObject(e.columns))return"columns: object expected";let t=Object.keys(e.columns);for(let i=0;i<t.length;++i){if(!Dt.key32Re.test(t[i]))return"columns: integer key{k:fixed32} expected";{let n=Lt.CARTA.ColumnData.verify(e.columns[t[i]]);if(n)return"columns."+n}}}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&!Dt.isInteger(e.subsetDataSize)?"subsetDataSize: integer expected":null!=e.subsetEndIndex&&e.hasOwnProperty("subsetEndIndex")&&!Dt.isInteger(e.subsetEndIndex)?"subsetEndIndex: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null!=e.filterDataSize&&e.hasOwnProperty("filterDataSize")&&!Dt.isInteger(e.filterDataSize)?"filterDataSize: integer expected":null!=e.requestEndIndex&&e.hasOwnProperty("requestEndIndex")&&!Dt.isInteger(e.requestEndIndex)?"requestEndIndex: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.CatalogFilterResponse)return e;let t=new Lt.CARTA.CatalogFilterResponse;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.imageFileId&&(t.imageFileId=0|e.imageFileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.columns){if("object"!==typeof e.columns)throw TypeError(".CARTA.CatalogFilterResponse.columns: object expected");t.columns={};for(let i=Object.keys(e.columns),n=0;n<i.length;++n){if("object"!==typeof e.columns[i[n]])throw TypeError(".CARTA.CatalogFilterResponse.columns: object expected");t.columns[i[n]]=Lt.CARTA.ColumnData.fromObject(e.columns[i[n]])}}return null!=e.subsetDataSize&&(t.subsetDataSize=0|e.subsetDataSize),null!=e.subsetEndIndex&&(t.subsetEndIndex=0|e.subsetEndIndex),null!=e.progress&&(t.progress=Number(e.progress)),null!=e.filterDataSize&&(t.filterDataSize=0|e.filterDataSize),null!=e.requestEndIndex&&(t.requestEndIndex=0|e.requestEndIndex),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.columns={}),t.defaults&&(n.fileId=0,n.imageFileId=0,n.regionId=0,n.subsetDataSize=0,n.subsetEndIndex=0,n.progress=0,n.filterDataSize=0,n.requestEndIndex=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&(n.imageFileId=e.imageFileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(n.regionId=e.regionId),e.columns&&(i=Object.keys(e.columns)).length){n.columns={};for(let r=0;r<i.length;++r)n.columns[i[r]]=Lt.CARTA.ColumnData.toObject(e.columns[i[r]],t)}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&(n.subsetDataSize=e.subsetDataSize),null!=e.subsetEndIndex&&e.hasOwnProperty("subsetEndIndex")&&(n.subsetEndIndex=e.subsetEndIndex),null!=e.progress&&e.hasOwnProperty("progress")&&(n.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),null!=e.filterDataSize&&e.hasOwnProperty("filterDataSize")&&(n.filterDataSize=e.filterDataSize),null!=e.requestEndIndex&&e.hasOwnProperty("requestEndIndex")&&(n.requestEndIndex=e.requestEndIndex),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ContourImageData=function(){function e(e){if(this.contourSets=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.referenceFileId=0,e.prototype.imageBounds=null,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.contourSets=Dt.emptyArray,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.referenceFileId&&Object.hasOwnProperty.call(e,"referenceFileId")&&t.uint32(21).fixed32(e.referenceFileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&Lt.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(37).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(45).sfixed32(e.stokes),null!=e.contourSets&&e.contourSets.length)for(let i=0;i<e.contourSets.length;++i)Lt.CARTA.ContourSet.encode(e.contourSets[i],t.uint32(50).fork()).ldelim();return null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(57).double(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ContourImageData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.referenceFileId=e.fixed32();break;case 3:n.imageBounds=Lt.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:n.channel=e.sfixed32();break;case 5:n.stokes=e.sfixed32();break;case 6:n.contourSets&&n.contourSets.length||(n.contourSets=[]),n.contourSets.push(Lt.CARTA.ContourSet.decode(e,e.uint32()));break;case 7:n.progress=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&!Dt.isInteger(e.referenceFileId))return"referenceFileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=Lt.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.contourSets&&e.hasOwnProperty("contourSets")){if(!Array.isArray(e.contourSets))return"contourSets: array expected";for(let t=0;t<e.contourSets.length;++t){let i=Lt.CARTA.ContourSet.verify(e.contourSets[t]);if(i)return"contourSets."+i}}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ContourImageData)return e;let t=new Lt.CARTA.ContourImageData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.referenceFileId&&(t.referenceFileId=e.referenceFileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.ContourImageData.imageBounds: object expected");t.imageBounds=Lt.CARTA.ImageBounds.fromObject(e.imageBounds)}if(null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.contourSets){if(!Array.isArray(e.contourSets))throw TypeError(".CARTA.ContourImageData.contourSets: array expected");t.contourSets=[];for(let i=0;i<e.contourSets.length;++i){if("object"!==typeof e.contourSets[i])throw TypeError(".CARTA.ContourImageData.contourSets: object expected");t.contourSets[i]=Lt.CARTA.ContourSet.fromObject(e.contourSets[i])}}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contourSets=[]),t.defaults&&(i.fileId=0,i.referenceFileId=0,i.imageBounds=null,i.channel=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&(i.referenceFileId=e.referenceFileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=Lt.CARTA.ImageBounds.toObject(e.imageBounds,t)),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.contourSets&&e.contourSets.length){i.contourSets=[];for(let n=0;n<e.contourSets.length;++n)i.contourSets[n]=Lt.CARTA.ContourSet.toObject(e.contourSets[n],t)}return null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ContourSet=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.level=0,e.prototype.decimationFactor=0,e.prototype.rawCoordinates=Dt.newBuffer([]),e.prototype.rawStartIndices=Dt.newBuffer([]),e.prototype.uncompressedCoordinatesSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.level&&Object.hasOwnProperty.call(e,"level")&&t.uint32(9).double(e.level),null!=e.decimationFactor&&Object.hasOwnProperty.call(e,"decimationFactor")&&t.uint32(16).int32(e.decimationFactor),null!=e.rawCoordinates&&Object.hasOwnProperty.call(e,"rawCoordinates")&&t.uint32(26).bytes(e.rawCoordinates),null!=e.rawStartIndices&&Object.hasOwnProperty.call(e,"rawStartIndices")&&t.uint32(34).bytes(e.rawStartIndices),null!=e.uncompressedCoordinatesSize&&Object.hasOwnProperty.call(e,"uncompressedCoordinatesSize")&&t.uint32(40).int32(e.uncompressedCoordinatesSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ContourSet;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.level=e.double();break;case 2:n.decimationFactor=e.int32();break;case 3:n.rawCoordinates=e.bytes();break;case 4:n.rawStartIndices=e.bytes();break;case 5:n.uncompressedCoordinatesSize=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.level&&e.hasOwnProperty("level")&&"number"!==typeof e.level?"level: number expected":null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&!Dt.isInteger(e.decimationFactor)?"decimationFactor: integer expected":null!=e.rawCoordinates&&e.hasOwnProperty("rawCoordinates")&&!(e.rawCoordinates&&"number"===typeof e.rawCoordinates.length||Dt.isString(e.rawCoordinates))?"rawCoordinates: buffer expected":null!=e.rawStartIndices&&e.hasOwnProperty("rawStartIndices")&&!(e.rawStartIndices&&"number"===typeof e.rawStartIndices.length||Dt.isString(e.rawStartIndices))?"rawStartIndices: buffer expected":null!=e.uncompressedCoordinatesSize&&e.hasOwnProperty("uncompressedCoordinatesSize")&&!Dt.isInteger(e.uncompressedCoordinatesSize)?"uncompressedCoordinatesSize: integer expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ContourSet)return e;let t=new Lt.CARTA.ContourSet;return null!=e.level&&(t.level=Number(e.level)),null!=e.decimationFactor&&(t.decimationFactor=0|e.decimationFactor),null!=e.rawCoordinates&&("string"===typeof e.rawCoordinates?Dt.base64.decode(e.rawCoordinates,t.rawCoordinates=Dt.newBuffer(Dt.base64.length(e.rawCoordinates)),0):e.rawCoordinates.length&&(t.rawCoordinates=e.rawCoordinates)),null!=e.rawStartIndices&&("string"===typeof e.rawStartIndices?Dt.base64.decode(e.rawStartIndices,t.rawStartIndices=Dt.newBuffer(Dt.base64.length(e.rawStartIndices)),0):e.rawStartIndices.length&&(t.rawStartIndices=e.rawStartIndices)),null!=e.uncompressedCoordinatesSize&&(t.uncompressedCoordinatesSize=0|e.uncompressedCoordinatesSize),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.level=0,i.decimationFactor=0,t.bytes===String?i.rawCoordinates="":(i.rawCoordinates=[],t.bytes!==Array&&(i.rawCoordinates=Dt.newBuffer(i.rawCoordinates))),t.bytes===String?i.rawStartIndices="":(i.rawStartIndices=[],t.bytes!==Array&&(i.rawStartIndices=Dt.newBuffer(i.rawStartIndices))),i.uncompressedCoordinatesSize=0),null!=e.level&&e.hasOwnProperty("level")&&(i.level=t.json&&!isFinite(e.level)?String(e.level):e.level),null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&(i.decimationFactor=e.decimationFactor),null!=e.rawCoordinates&&e.hasOwnProperty("rawCoordinates")&&(i.rawCoordinates=t.bytes===String?Dt.base64.encode(e.rawCoordinates,0,e.rawCoordinates.length):t.bytes===Array?Array.prototype.slice.call(e.rawCoordinates):e.rawCoordinates),null!=e.rawStartIndices&&e.hasOwnProperty("rawStartIndices")&&(i.rawStartIndices=t.bytes===String?Dt.base64.encode(e.rawStartIndices,0,e.rawStartIndices.length):t.bytes===Array?Array.prototype.slice.call(e.rawStartIndices):e.rawStartIndices),null!=e.uncompressedCoordinatesSize&&e.hasOwnProperty("uncompressedCoordinatesSize")&&(i.uncompressedCoordinatesSize=e.uncompressedCoordinatesSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.ErrorData=function(){function e(e){if(this.tags=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.severity=0,e.prototype.tags=Dt.emptyArray,e.prototype.message="",e.prototype.data="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.severity&&Object.hasOwnProperty.call(e,"severity")&&t.uint32(8).int32(e.severity),null!=e.tags&&e.tags.length)for(let i=0;i<e.tags.length;++i)t.uint32(18).string(e.tags[i]);return null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).string(e.data),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.ErrorData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.severity=e.int32();break;case 2:n.tags&&n.tags.length||(n.tags=[]),n.tags.push(e.string());break;case 3:n.message=e.string();break;case 4:n.data=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.severity&&e.hasOwnProperty("severity"))switch(e.severity){default:return"severity: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.tags&&e.hasOwnProperty("tags")){if(!Array.isArray(e.tags))return"tags: array expected";for(let t=0;t<e.tags.length;++t)if(!Dt.isString(e.tags[t]))return"tags: string[] expected"}return null!=e.message&&e.hasOwnProperty("message")&&!Dt.isString(e.message)?"message: string expected":null!=e.data&&e.hasOwnProperty("data")&&!Dt.isString(e.data)?"data: string expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.ErrorData)return e;let t=new Lt.CARTA.ErrorData;switch(e.severity){case"DEBUG":case 0:t.severity=0;break;case"INFO":case 1:t.severity=1;break;case"WARNING":case 2:t.severity=2;break;case"ERROR":case 3:t.severity=3;break;case"CRITICAL":case 4:t.severity=4}if(e.tags){if(!Array.isArray(e.tags))throw TypeError(".CARTA.ErrorData.tags: array expected");t.tags=[];for(let i=0;i<e.tags.length;++i)t.tags[i]=String(e.tags[i])}return null!=e.message&&(t.message=String(e.message)),null!=e.data&&(t.data=String(e.data)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tags=[]),t.defaults&&(i.severity=t.enums===String?"DEBUG":0,i.message="",i.data=""),null!=e.severity&&e.hasOwnProperty("severity")&&(i.severity=t.enums===String?Lt.CARTA.ErrorSeverity[e.severity]:e.severity),e.tags&&e.tags.length){i.tags=[];for(let t=0;t<e.tags.length;++t)i.tags[t]=e.tags[t]}return null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.data&&e.hasOwnProperty("data")&&(i.data=e.data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RasterTileSync=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.animationId=0,e.prototype.endSync=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(37).sfixed32(e.animationId),null!=e.endSync&&Object.hasOwnProperty.call(e,"endSync")&&t.uint32(40).bool(e.endSync),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RasterTileSync;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.animationId=e.sfixed32();break;case 5:n.endSync=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId)?"fileId: integer expected":null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes)?"stokes: integer expected":null!=e.animationId&&e.hasOwnProperty("animationId")&&!Dt.isInteger(e.animationId)?"animationId: integer expected":null!=e.endSync&&e.hasOwnProperty("endSync")&&"boolean"!==typeof e.endSync?"endSync: boolean expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RasterTileSync)return e;let t=new Lt.CARTA.RasterTileSync;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.animationId&&(t.animationId=0|e.animationId),null!=e.endSync&&(t.endSync=Boolean(e.endSync)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.animationId=0,i.endSync=!1),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),null!=e.endSync&&e.hasOwnProperty("endSync")&&(i.endSync=e.endSync),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RasterTileData=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.prototype.animationId=0,e.prototype.tiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(32).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(45).float(e.compressionQuality),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(53).sfixed32(e.animationId),null!=e.tiles&&e.tiles.length)for(let i=0;i<e.tiles.length;++i)Lt.CARTA.TileData.encode(e.tiles[i],t.uint32(58).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RasterTileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.compressionType=e.int32();break;case 5:n.compressionQuality=e.float();break;case 6:n.animationId=e.sfixed32();break;case 7:n.tiles&&n.tiles.length||(n.tiles=[]),n.tiles.push(Lt.CARTA.TileData.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}if(null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality)return"compressionQuality: number expected";if(null!=e.animationId&&e.hasOwnProperty("animationId")&&!Dt.isInteger(e.animationId))return"animationId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t){let i=Lt.CARTA.TileData.verify(e.tiles[t]);if(i)return"tiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RasterTileData)return e;let t=new Lt.CARTA.RasterTileData;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}if(null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),null!=e.animationId&&(t.animationId=0|e.animationId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.RasterTileData.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i){if("object"!==typeof e.tiles[i])throw TypeError(".CARTA.RasterTileData.tiles: object expected");t.tiles[i]=Lt.CARTA.TileData.fromObject(e.tiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0,i.animationId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?Lt.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),e.tiles&&e.tiles.length){i.tiles=[];for(let n=0;n<e.tiles.length;++n)i.tiles[n]=Lt.CARTA.TileData.toObject(e.tiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionHistogramData=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.histograms=null,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(29).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(37).sfixed32(e.stokes),null!=e.histograms&&Object.hasOwnProperty.call(e,"histograms")&&Lt.CARTA.Histogram.encode(e.histograms,t.uint32(42).fork()).ldelim(),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(53).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionHistogramData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.channel=e.sfixed32();break;case 4:n.stokes=e.sfixed32();break;case 5:n.histograms=Lt.CARTA.Histogram.decode(e,e.uint32());break;case 6:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.histograms&&e.hasOwnProperty("histograms")){let t=Lt.CARTA.Histogram.verify(e.histograms);if(t)return"histograms."+t}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionHistogramData)return e;let t=new Lt.CARTA.RegionHistogramData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.histograms){if("object"!==typeof e.histograms)throw TypeError(".CARTA.RegionHistogramData.histograms: object expected");t.histograms=Lt.CARTA.Histogram.fromObject(e.histograms)}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.regionId=0,i.channel=0,i.stokes=0,i.histograms=null,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.histograms&&e.hasOwnProperty("histograms")&&(i.histograms=Lt.CARTA.Histogram.toObject(e.histograms,t)),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.RegionStatsData=function(){function e(e){if(this.statistics=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.statistics=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(29).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(37).sfixed32(e.stokes),null!=e.statistics&&e.statistics.length)for(let i=0;i<e.statistics.length;++i)Lt.CARTA.StatisticsValue.encode(e.statistics[i],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.RegionStatsData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.channel=e.sfixed32();break;case 4:n.stokes=e.sfixed32();break;case 5:n.statistics&&n.statistics.length||(n.statistics=[]),n.statistics.push(Lt.CARTA.StatisticsValue.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.statistics&&e.hasOwnProperty("statistics")){if(!Array.isArray(e.statistics))return"statistics: array expected";for(let t=0;t<e.statistics.length;++t){let i=Lt.CARTA.StatisticsValue.verify(e.statistics[t]);if(i)return"statistics."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.RegionStatsData)return e;let t=new Lt.CARTA.RegionStatsData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.statistics){if(!Array.isArray(e.statistics))throw TypeError(".CARTA.RegionStatsData.statistics: array expected");t.statistics=[];for(let i=0;i<e.statistics.length;++i){if("object"!==typeof e.statistics[i])throw TypeError(".CARTA.RegionStatsData.statistics: object expected");t.statistics[i]=Lt.CARTA.StatisticsValue.fromObject(e.statistics[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statistics=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.channel=0,i.stokes=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.statistics&&e.statistics.length){i.statistics=[];for(let n=0;n<e.statistics.length;++n)i.statistics[n]=Lt.CARTA.StatisticsValue.toObject(e.statistics[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SpatialProfileData=function(){function e(e){if(this.profiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.x=0,e.prototype.y=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.value=0,e.prototype.profiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(29).sfixed32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(37).sfixed32(e.y),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(45).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(53).sfixed32(e.stokes),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(61).float(e.value),null!=e.profiles&&e.profiles.length)for(let i=0;i<e.profiles.length;++i)Lt.CARTA.SpatialProfile.encode(e.profiles[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SpatialProfileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.x=e.sfixed32();break;case 4:n.y=e.sfixed32();break;case 5:n.channel=e.sfixed32();break;case 6:n.stokes=e.sfixed32();break;case 7:n.value=e.float();break;case 8:n.profiles&&n.profiles.length||(n.profiles=[]),n.profiles.push(Lt.CARTA.SpatialProfile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.x&&e.hasOwnProperty("x")&&!Dt.isInteger(e.x))return"x: integer expected";if(null!=e.y&&e.hasOwnProperty("y")&&!Dt.isInteger(e.y))return"y: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value)return"value: number expected";if(null!=e.profiles&&e.hasOwnProperty("profiles")){if(!Array.isArray(e.profiles))return"profiles: array expected";for(let t=0;t<e.profiles.length;++t){let i=Lt.CARTA.SpatialProfile.verify(e.profiles[t]);if(i)return"profiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SpatialProfileData)return e;let t=new Lt.CARTA.SpatialProfileData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.value&&(t.value=Number(e.value)),e.profiles){if(!Array.isArray(e.profiles))throw TypeError(".CARTA.SpatialProfileData.profiles: array expected");t.profiles=[];for(let i=0;i<e.profiles.length;++i){if("object"!==typeof e.profiles[i])throw TypeError(".CARTA.SpatialProfileData.profiles: object expected");t.profiles[i]=Lt.CARTA.SpatialProfile.fromObject(e.profiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.profiles=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.x=0,i.y=0,i.channel=0,i.stokes=0,i.value=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.x&&e.hasOwnProperty("x")&&(i.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=e.y),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),e.profiles&&e.profiles.length){i.profiles=[];for(let n=0;n<e.profiles.length;++n)i.profiles[n]=Lt.CARTA.SpatialProfile.toObject(e.profiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.SpectralProfileData=function(){function e(e){if(this.profiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stokes=0,e.prototype.progress=0,e.prototype.profiles=Dt.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(37).float(e.progress),null!=e.profiles&&e.profiles.length)for(let i=0;i<e.profiles.length;++i)Lt.CARTA.SpectralProfile.encode(e.profiles[i],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.SpectralProfileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.progress=e.float();break;case 5:n.profiles&&n.profiles.length||(n.profiles=[]),n.profiles.push(Lt.CARTA.SpectralProfile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!Dt.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!Dt.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress)return"progress: number expected";if(null!=e.profiles&&e.hasOwnProperty("profiles")){if(!Array.isArray(e.profiles))return"profiles: array expected";for(let t=0;t<e.profiles.length;++t){let i=Lt.CARTA.SpectralProfile.verify(e.profiles[t]);if(i)return"profiles."+i}}return null},e.fromObject=function(e){if(e instanceof Lt.CARTA.SpectralProfileData)return e;let t=new Lt.CARTA.SpectralProfileData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.progress&&(t.progress=Number(e.progress)),e.profiles){if(!Array.isArray(e.profiles))throw TypeError(".CARTA.SpectralProfileData.profiles: array expected");t.profiles=[];for(let i=0;i<e.profiles.length;++i){if("object"!==typeof e.profiles[i])throw TypeError(".CARTA.SpectralProfileData.profiles: object expected");t.profiles[i]=Lt.CARTA.SpectralProfile.fromObject(e.profiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.profiles=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),e.profiles&&e.profiles.length){i.profiles=[];for(let n=0;n<e.profiles.length;++n)i.profiles[n]=Lt.CARTA.SpectralProfile.toObject(e.profiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e.VectorOverlayTileData=function(){function e(e){if(this.intensityTiles=[],this.angleTiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokesIntensity=0,e.prototype.stokesAngle=0,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.prototype.intensityTiles=Dt.emptyArray,e.prototype.angleTiles=Dt.emptyArray,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=kt.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokesIntensity&&Object.hasOwnProperty.call(e,"stokesIntensity")&&t.uint32(29).sfixed32(e.stokesIntensity),null!=e.stokesAngle&&Object.hasOwnProperty.call(e,"stokesAngle")&&t.uint32(37).sfixed32(e.stokesAngle),null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(40).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(53).float(e.compressionQuality),null!=e.intensityTiles&&e.intensityTiles.length)for(let i=0;i<e.intensityTiles.length;++i)Lt.CARTA.TileData.encode(e.intensityTiles[i],t.uint32(58).fork()).ldelim();if(null!=e.angleTiles&&e.angleTiles.length)for(let i=0;i<e.angleTiles.length;++i)Lt.CARTA.TileData.encode(e.angleTiles[i],t.uint32(66).fork()).ldelim();return null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(73).double(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof Ft||(e=Ft.create(e));let i=void 0===t?e.len:e.pos+t,n=new Lt.CARTA.VectorOverlayTileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokesIntensity=e.sfixed32();break;case 4:n.stokesAngle=e.sfixed32();break;case 5:n.compressionType=e.int32();break;case 6:n.compressionQuality=e.float();break;case 7:n.intensityTiles&&n.intensityTiles.length||(n.intensityTiles=[]),n.intensityTiles.push(Lt.CARTA.TileData.decode(e,e.uint32()));break;case 8:n.angleTiles&&n.angleTiles.length||(n.angleTiles=[]),n.angleTiles.push(Lt.CARTA.TileData.decode(e,e.uint32()));break;case 9:n.progress=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof Ft||(e=new Ft(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!Dt.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!Dt.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokesIntensity&&e.hasOwnProperty("stokesIntensity")&&!Dt.isInteger(e.stokesIntensity))return"stokesIntensity: integer expected";if(null!=e.stokesAngle&&e.hasOwnProperty("stokesAngle")&&!Dt.isInteger(e.stokesAngle))return"stokesAngle: integer expected";if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}if(null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality)return"compressionQuality: number expected";if(null!=e.intensityTiles&&e.hasOwnProperty("intensityTiles")){if(!Array.isArray(e.intensityTiles))return"intensityTiles: array expected";for(let t=0;t<e.intensityTiles.length;++t){let i=Lt.CARTA.TileData.verify(e.intensityTiles[t]);if(i)return"intensityTiles."+i}}if(null!=e.angleTiles&&e.hasOwnProperty("angleTiles")){if(!Array.isArray(e.angleTiles))return"angleTiles: array expected";for(let t=0;t<e.angleTiles.length;++t){let i=Lt.CARTA.TileData.verify(e.angleTiles[t]);if(i)return"angleTiles."+i}}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof Lt.CARTA.VectorOverlayTileData)return e;let t=new Lt.CARTA.VectorOverlayTileData;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokesIntensity&&(t.stokesIntensity=0|e.stokesIntensity),null!=e.stokesAngle&&(t.stokesAngle=0|e.stokesAngle),e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}if(null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),e.intensityTiles){if(!Array.isArray(e.intensityTiles))throw TypeError(".CARTA.VectorOverlayTileData.intensityTiles: array expected");t.intensityTiles=[];for(let i=0;i<e.intensityTiles.length;++i){if("object"!==typeof e.intensityTiles[i])throw TypeError(".CARTA.VectorOverlayTileData.intensityTiles: object expected");t.intensityTiles[i]=Lt.CARTA.TileData.fromObject(e.intensityTiles[i])}}if(e.angleTiles){if(!Array.isArray(e.angleTiles))throw TypeError(".CARTA.VectorOverlayTileData.angleTiles: array expected");t.angleTiles=[];for(let i=0;i<e.angleTiles.length;++i){if("object"!==typeof e.angleTiles[i])throw TypeError(".CARTA.VectorOverlayTileData.angleTiles: object expected");t.angleTiles[i]=Lt.CARTA.TileData.fromObject(e.angleTiles[i])}}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.intensityTiles=[],i.angleTiles=[]),t.defaults&&(i.fileId=0,i.channel=0,i.stokesIntensity=0,i.stokesAngle=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokesIntensity&&e.hasOwnProperty("stokesIntensity")&&(i.stokesIntensity=e.stokesIntensity),null!=e.stokesAngle&&e.hasOwnProperty("stokesAngle")&&(i.stokesAngle=e.stokesAngle),null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?Lt.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),e.intensityTiles&&e.intensityTiles.length){i.intensityTiles=[];for(let n=0;n<e.intensityTiles.length;++n)i.intensityTiles[n]=Lt.CARTA.TileData.toObject(e.intensityTiles[n],t)}if(e.angleTiles&&e.angleTiles.length){i.angleTiles=[];for(let n=0;n<e.angleTiles.length;++n)i.angleTiles[n]=Lt.CARTA.TileData.toObject(e.angleTiles[n],t)}return null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,Mt.util.toJSONOptions)},e}(),e})();let _t;!function(e){e.Always="always",e.Never="never",e.ActiveImage="activeImage",e.HideTiled="hideTiled"}(_t||(_t={}));const zt=[{code:"FREQ",name:"Frequency",unit:"Hz"},{code:"ENER",name:"Energy",unit:"J"},{code:"WAVN",name:"Wavenumber",unit:"1/m"},{code:"VRAD",name:"Radio velocity",unit:"m/s"},{code:"WAVE",name:"Vacuum wavelength",unit:"m"},{code:"VOPT",name:"Optical velocity",unit:"m/s"},{code:"ZOPT",name:"Redshift",unit:""},{code:"AWAV",name:"Air wavelength",unit:"m"},{code:"VELO",name:"Apparent radial velocity",unit:"m/s"},{code:"BETA",name:"Beta",unit:""}];let Vt,Wt;!function(e){e.FREQ="FREQ",e.ENER="ENER",e.WAVE="WAVE"}(Vt||(Vt={})),function(e){e.VRAD="VRAD",e.VOPT="VOPT",e.FREQ="FREQ",e.WAVE="WAVE",e.AWAV="AWAV",e.CHANNEL="CHANNEL"}(Wt||(Wt={}));const Gt=e=>{const t=null===e||void 0===e?void 0:e.toUpperCase();return Object.values(Wt).includes(t)&&t!==Wt.CHANNEL},Bt=Object.values(Wt);let qt,Ht;!function(e){e.KMS="km/s",e.MS="m/s",e.GHZ="GHz",e.MHZ="MHz",e.KHZ="kHz",e.HZ="Hz",e.M="m",e.MM="mm",e.UM="um",e.NM="nm",e.ANGSTROM="Angstrom"}(qt||(qt={})),function(e){e.GHZ="GHz",e.MHZ="MHz",e.KHZ="kHz",e.HZ="Hz"}(Ht||(Ht={}));const Yt=e=>e&&Object.values(qt).includes(e);let Ut;!function(e){e.LSRK="LSRK",e.LSRD="LSRD",e.BARY="BARYCENT",e.TOPO="TOPOCENT"}(Ut||(Ut={}));const Xt=e=>{const t=null===e||void 0===e?void 0:e.toUpperCase();return Object.values(Ut).includes(t)},$t=new Map([[Wt.VRAD,"Radio velocity"],[Wt.VOPT,"Optical velocity"],[Wt.FREQ,"Frequency"],[Wt.WAVE,"Vacuum wavelength"],[Wt.AWAV,"Air wavelength"],[Wt.CHANNEL,"Channel"]]),Kt=new Map([[Wt.VRAD,qt.KMS],[Wt.VOPT,qt.KMS],[Wt.FREQ,qt.GHZ],[Wt.WAVE,qt.MM],[Wt.AWAV,qt.MM]]),Qt=(e,t)=>`${e?$t.get(e):""}${t?" ("+t+")":""}`,Zt=new Map([[Qt(Wt.VRAD,qt.KMS),{type:Wt.VRAD,unit:qt.KMS}],[Qt(Wt.VRAD,qt.MS),{type:Wt.VRAD,unit:qt.MS}],[Qt(Wt.VOPT,qt.KMS),{type:Wt.VOPT,unit:qt.KMS}],[Qt(Wt.VOPT,qt.MS),{type:Wt.VOPT,unit:qt.MS}],[Qt(Wt.FREQ,qt.GHZ),{type:Wt.FREQ,unit:qt.GHZ}],[Qt(Wt.FREQ,qt.MHZ),{type:Wt.FREQ,unit:qt.MHZ}],[Qt(Wt.FREQ,qt.KHZ),{type:Wt.FREQ,unit:qt.KHZ}],[Qt(Wt.FREQ,qt.HZ),{type:Wt.FREQ,unit:qt.HZ}],[Qt(Wt.WAVE,qt.M),{type:Wt.WAVE,unit:qt.M}],[Qt(Wt.WAVE,qt.MM),{type:Wt.WAVE,unit:qt.MM}],[Qt(Wt.WAVE,qt.UM),{type:Wt.WAVE,unit:qt.UM}],[Qt(Wt.WAVE,qt.NM),{type:Wt.WAVE,unit:qt.NM}],[Qt(Wt.WAVE,qt.ANGSTROM),{type:Wt.WAVE,unit:qt.ANGSTROM}],[Qt(Wt.AWAV,qt.M),{type:Wt.AWAV,unit:qt.M}],[Qt(Wt.AWAV,qt.MM),{type:Wt.AWAV,unit:qt.MM}],[Qt(Wt.AWAV,qt.UM),{type:Wt.AWAV,unit:qt.UM}],[Qt(Wt.AWAV,qt.NM),{type:Wt.AWAV,unit:qt.NM}],[Qt(Wt.AWAV,qt.ANGSTROM),{type:Wt.AWAV,unit:qt.ANGSTROM}],["Channel",{type:Wt.CHANNEL,unit:null}]]);let Jt;var ei,ti;!function(e){e[e.Kelvin=0]="Kelvin",e[e.JyBeam=1]="JyBeam",e[e.JySr=2]="JySr",e[e.JyArcsec2=3]="JyArcsec2",e[e.JyPixel=4]="JyPixel",e[e.Unsupported=5]="Unsupported"}(Jt||(Jt={})),function(e){e.MJy="MJy",e.Jy="Jy",e.mJy="mJy",e.uJy="uJy"}(ei||(ei={})),function(e){e.K="K",e.mK="mK"}(ti||(ti={}));const ii=Object.values(ei),ni=new Map([[Jt.Kelvin,Object.values(ti)],[Jt.JyBeam,ii.filter((e=>e!==ei.MJy)).map((e=>`${e}/beam`))],[Jt.JySr,ii.filter((e=>e===ei.MJy)).map((e=>`${e}/sr`))],[Jt.JyArcsec2,ii.filter((e=>e!==ei.MJy)).map((e=>`${e}/arcsec^2`))],[Jt.JyPixel,ii.map((e=>`${e}/pixel`))]]),ri=e=>{const t=ni.get(Jt.JyBeam).map((e=>e.toLowerCase())),i=ni.get(Jt.JySr).map((e=>e.toLowerCase())),n=ni.get(Jt.JyArcsec2).map((e=>e.toLowerCase())),r=ni.get(Jt.JyPixel).map((e=>e.toLowerCase())),o=ni.get(Jt.Kelvin).map((e=>e.toLowerCase())),s=null===e||void 0===e?void 0:e.toLowerCase();return t.includes(s)?Jt.JyBeam:i.includes(s)?Jt.JySr:n.includes(s)?Jt.JyArcsec2:r.includes(s)?Jt.JyPixel:o.includes(s)?Jt.Kelvin:Jt.Unsupported},oi=e=>ri(e)!==Jt.Unsupported,si=e=>{const t=(e=>{let t=[];const i=ri(null===e||void 0===e?void 0:e.nativeIntensityUnit);return i!==Jt.Unsupported&&(i===Jt.Kelvin?(t.push(Jt.Kelvin),isFinite(null===e||void 0===e?void 0:e.bmaj)&&isFinite(null===e||void 0===e?void 0:e.bmin)&&isFinite(null===e||void 0===e?void 0:e.freqGHz)&&(t.push(Jt.JyBeam),t.push(Jt.JySr),t.push(Jt.JyArcsec2))):i===Jt.JyBeam?(t.push(Jt.JyBeam),isFinite(null===e||void 0===e?void 0:e.bmaj)&&isFinite(null===e||void 0===e?void 0:e.bmin)&&(t.push(Jt.JySr),t.push(Jt.JyArcsec2),isFinite(null===e||void 0===e?void 0:e.freqGHz)&&t.push(Jt.Kelvin))):i===Jt.JySr||i===Jt.JyArcsec2?(t.push(Jt.JySr),t.push(Jt.JyArcsec2),isFinite(null===e||void 0===e?void 0:e.bmaj)&&isFinite(null===e||void 0===e?void 0:e.bmin)&&(t.push(Jt.JyBeam),isFinite(null===e||void 0===e?void 0:e.freqGHz)&&t.push(Jt.Kelvin)),isFinite(null===e||void 0===e?void 0:e.cdelta1)&&isFinite(null===e||void 0===e?void 0:e.cdelta2)&&t.push(Jt.JyPixel)):i===Jt.JyPixel&&(t.push(Jt.JyPixel),isFinite(null===e||void 0===e?void 0:e.cdelta1)&&isFinite(null===e||void 0===e?void 0:e.cdelta2)&&(t.push(Jt.JySr),t.push(Jt.JyArcsec2)))),t})(e);let i=[];return null===t||void 0===t||t.forEach((e=>{i.push(...ni.get(e))})),i},ai=(e,t,i,n=!0)=>{const r=1222e3/(e*e*t*i);return n?r:1/r},li=(e,t,i=!0)=>{const n=e*Math.PI/648e3,r=t*Math.PI/648e3,o=Math.PI*n*r/(4*Math.LN2);return i?1/o:o},ci=(e=!0)=>{const t=2.350443*1e-11;return e?t:1/t},di=(e,t,i=!0)=>{const n=e*t/(2.350443*1e-11);return i?n:1/n},pi=e=>e.match(/^M/)?1e6:e.match(/^m/)?.001:e.match(/^u/)?1e-6:1,hi=(e,t)=>{const i=ri(null===e||void 0===e?void 0:e.nativeIntensityUnit),n=ri(t);if(i===Jt.Unsupported||n===Jt.Unsupported||(null===e||void 0===e?void 0:e.nativeIntensityUnit)===t)return;const r=pi(e.nativeIntensityUnit)/pi(t);return i===n?e=>e.map((e=>e*r)):((e,t,i,n)=>{let r;return e===Jt.Kelvin?t===Jt.JyBeam?r=e=>e*i*ai(n.freqGHz,n.bmaj,n.bmin,!1):t===Jt.JySr?r=e=>e*i*ai(n.freqGHz,n.bmaj,n.bmin,!1)*li(n.bmaj,n.bmin):t===Jt.JyArcsec2&&(r=e=>e*i*ai(n.freqGHz,n.bmaj,n.bmin,!1)*li(n.bmaj,n.bmin)*ci()):e===Jt.JyBeam?t===Jt.Kelvin?r=e=>e*i*ai(n.freqGHz,n.bmaj,n.bmin):t===Jt.JySr?r=e=>e*i*li(n.bmaj,n.bmin):t===Jt.JyArcsec2&&(r=e=>e*i*li(n.bmaj,n.bmin)*ci()):e===Jt.JySr?t===Jt.Kelvin?r=e=>e*i*li(n.bmaj,n.bmin,!1)*ai(n.freqGHz,n.bmaj,n.bmin):t===Jt.JyBeam?r=e=>e*i*li(n.bmaj,n.bmin,!1):t===Jt.JyArcsec2?r=e=>e*i*ci():t===Jt.JyPixel&&(r=e=>e*i*ci()*di(n.cdelta1,n.cdelta2,!1)):e===Jt.JyArcsec2?t===Jt.Kelvin?r=e=>e*i*ci(!1)*li(n.bmaj,n.bmin,!1)*ai(n.freqGHz,n.bmaj,n.bmin):t===Jt.JyBeam?r=e=>e*i*ci(!1)*li(n.bmaj,n.bmin,!1):t===Jt.JySr?r=e=>e*i*ci(!1):t===Jt.JyPixel&&(r=e=>e*i*di(n.cdelta1,n.cdelta2,!1)):e===Jt.JyPixel&&(t===Jt.JySr?r=e=>e*i*di(n.cdelta1,n.cdelta2)*ci(!1):t===Jt.JyArcsec2&&(r=e=>e*i*di(n.cdelta1,n.cdelta2))),r?e=>e.map(r):void 0})(i,n,r,e)},ui=299792458;function gi(e,t=0){return isFinite(e)&&isFinite(t)&&t>=0&&t<=20?e.toExponential(t):String(e)}function fi(e,t=0){return isFinite(e)&&isFinite(t)&&t>=0&&t<=20?e.toFixed(t):String(e)}function bi(e){return null===e||isNaN(e)?null:e<.01?gi(e,2):fi(e,2)}function mi(e,t,i="",n=!0,r=!1){let o=gi(e,t);return n&&(o=o.replace(/0+e/,"e"),o=o.replace(".e",".0e"),o=o.replace("e+0","")),r&&e>=0&&(o=" "+o),i&&i.length&&(o=`${o} ${i}`),o}function yi(e){if(!isFinite(e))return null;let t="";return t=e<3?`${fi(1e3*e,4)} MHz`:e>=3&&e<1e3?`${fi(e,4)} GHz`:`${fi(e/1e3,4)} THz`,t}function Oi(e,t){if(isFinite(e)&&t){var i;const n=null===(i=t.trim())||void 0===i?void 0:i.toLowerCase();return"rad"===n?e:"deg"===n?e*Math.PI/180:"arcmin"===n?e*Math.PI/10800:"arcsec"===n?e*Math.PI/648e3:"mas"===n?e*Math.PI/648e6:void 0}}function ji(e,t=-1){if(!isFinite(e)||!isFinite(t))return null;let i="";return i=e<120?`${fi(e,t<0?6:t)}"`:e>=120&&e<7200?`${fi(e/60,t<0?3:t)}'`:`${fi(e/3600,t<0?3:t)} deg`,i}function xi(e){if(isFinite(e)&&0!==e&&null!==e)return ui/e}function Si(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)return null;return/^(\d+(\.\d+)?)"?$/.test(t)?parseFloat(RegExp.$1):/^(\d+(\.\d+)?)'$/.test(t)?60*parseFloat(RegExp.$1):/^(\d+(\.\d+)?)\s*deg(ree)?$/i.test(t)?3600*parseFloat(RegExp.$1):null}class vi{constructor(){this.x=void 0,this.y=void 0}static ToString(e,t,i=-1){return e?`(${i<0?e.x:fi(e.x,i)} ${t}, ${i<0?e.y:fi(e.y,i)} ${t})`:""}}class Ci{constructor(){this.x=void 0,this.y=void 0}static ToString(e){return e?`(${e.x}, ${e.y})`:""}}class Ii{constructor(e,t){this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.origin=void 0;const i=Mm(e,t,!0),n=im(t,{x:0,y:.5}),r=im(t,{x:0,y:-.5}),o=nm(n,r),s=nm(Mm(e,n,!0),Mm(e,r,!0));this.scale=sm(s)/sm(o),this.rotation=Math.atan2(s.y,s.x)-Math.atan2(o.y,o.x),this.translation=nm(i,t),this.origin={x:t.x,y:t.y}}transformCoordinate(e,t=!0){if(t){return im(pm(e,this.origin,this.scale,this.rotation),this.translation)}return pm(nm(e,this.translation),this.origin,1/this.scale,-this.rotation)}}class wi{constructor(e,t,i){this.layer=void 0,this.x=void 0,this.y=void 0,this.x=e,this.y=t,this.layer=i}encode(){return wi.EncodeCoordinate(this)}static EncodeCoordinate(e){return e?wi.Encode(e.x,e.y,e.layer):-1}static AddFileId(e,t){return e+t*wi.FileIdOffset}static RemoveFileId(e){return e%wi.FileIdOffset}static Encode(e,t,i){const n=1<<i;return e<0||t<0||i<0||i>12||e>=n||t>=n?-1:i<<24|t<<12|e}static Decode(e){return new wi(4095&e,e>>12&4095,e>>24&127)}static GetLayer(e){return e>>24&127}static GetFileId(e){return Math.floor(e/wi.FileIdOffset)}}wi.FileIdOffset=2**32;class Ti{}Ti.LIGHT="light",Ti.DARK="dark",Ti.AUTO="auto",Ti.isValid=e=>e&&(e===Ti.LIGHT||e===Ti.DARK||e===Ti.AUTO);class Ri{}Ri.DEFAULT="Default",Ri.CUBEVIEW="Cube View",Ri.CUBEANALYSIS="Cube Analysis",Ri.CONTINUUMANALYSIS="Continuum Analysis",Ri.PRESETS=[Ri.DEFAULT,Ri.CUBEVIEW,Ri.CUBEANALYSIS,Ri.CONTINUUMANALYSIS],Ri.PRESET_CONFIGS=new Map([[Ri.DEFAULT,{leftBottomContent:{type:"stack",content:[{type:"component",id:"render-config"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"stack",content:[{type:"component",id:"layer-list"},{type:"component",id:"animator"},{type:"component",id:"region-list"}]}]}],[Ri.CUBEVIEW,{leftBottomContent:{type:"stack",content:[{type:"component",id:"animator"},{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"component",id:"spectral-profiler"}]}],[Ri.CUBEANALYSIS,{leftBottomContent:{type:"stack",content:[{type:"component",id:"animator"},{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spectral-profiler"},{type:"component",id:"stats"}]}],[Ri.CONTINUUMANALYSIS,{leftBottomContent:{type:"stack",content:[{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"animator"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"component",id:"stats"}]}]]),Ri.isPreset=e=>e&&Ri.PRESETS.includes(e);class Ai{}Ai.FIXED="fixed",Ai.TRACKING="tracking",Ai.isValid=e=>e&&(e===Ai.FIXED||e===Ai.TRACKING);class Pi{}Pi.FIT="fit",Pi.FULL="full",Pi.isValid=e=>e&&(e===Pi.FIT||e===Pi.FULL);class Ei{}Ei.CURSOR="cursor",Ei.CENTER="center",Ei.isValid=e=>e&&(e===Ei.CURSOR||e===Ei.CENTER);class Mi{}Mi.AUTOMATIC="automatic",Mi.DEGREES="degrees",Mi.SEXAGESIMAL="sexagesimal",Mi.isValid=e=>e&&(e===Mi.AUTOMATIC||e===Mi.DEGREES||e===Mi.SEXAGESIMAL);class Fi{}Fi.CENTER="center",Fi.CORNER="corner",Fi.isValid=e=>e&&(e===Fi.CENTER||e===Fi.CORNER);class ki{}ki.IMAGE_MIN=1,ki.IMAGE_MAX=32,ki.IMAGE_STEP=1,ki.IMAGE_DEFAULT=11,ki.ANIMATION_MIN=1,ki.ANIMATION_MAX=32,ki.ANIMATION_STEP=1,ki.ANIMATION_DEFAULT=9,ki.isImageCompressionQualityValid=e=>isFinite(e)&&e>=ki.IMAGE_MIN&&e<=ki.IMAGE_MAX,ki.isAnimationCompressionQualityValid=e=>isFinite(e)&&e>=ki.ANIMATION_MIN&&e<=ki.ANIMATION_MAX;class Di{}Di.GPU_MIN=1024,Di.GPU_MAX=8192,Di.GPU_STEP=256,Di.GPU_DEFAULT=1024,Di.SYSTEM_MIN=1024,Di.SYSTEM_MAX=16384,Di.SYSTEM_STEP=256,Di.SYSTEM_DEFAULT=4096,Di.isGPUTileCacheValid=e=>isFinite(e)&&e>=Di.GPU_MIN&&e<=Di.GPU_MAX,Di.isSystemTileCacheValid=e=>isFinite(e)&&e>=Di.SYSTEM_MIN&&e<=Di.SYSTEM_MAX;class Li{}Li.EVENT_TYPES=Object.values(Nt.EventType),Li.EVENT_NUMBER=Li.EVENT_TYPES.length,Li.isEventTypeValid=e=>Li.EVENT_TYPES.includes(e),Li.getEventTypeFromName=e=>Nt.EventType[e],Li.getEventNameFromType=e=>Nt.EventType[e];var Ni=i(94),_i=i.n(Ni);const{version:zi}=i(384),Vi={acronym:"CARTA",version:zi,date:_i()("2022-05-10T17:40:32.732Z").format("D MMM YYYY"),fullName:"Cube Analysis and Rendering Tool for Astronomy"};function Wi(e,t,i){return(e=Gi((e-t)/(i-t),0,1))*e*(3-2*e)}function Gi(e,t,i){return Math.min(i,Math.max(t,e))}function Bi(e,t,i=1e-6){return Math.abs(e-t)<i}function qi(e,t){return!isFinite(e)||!isFinite(t)||e===t}function Hi(e,t){if(!t||!t.length||!e||!e.bins.length)return[];const i=e.firstBinCenter-e.binWidth/2,n=e.binWidth,r=e.bins;let o=t.slice(),s=0,a=0;for(let c=0;c<r.length;c++)a+=r[c];if(0===a)return[];let l=[];for(let c=0;c<r.length&&o.length;c++){const e=s/a,t=(s+r[c])/a;let d=o[0]/100;for(;t>=d&&o.length;){const r=(d-e)/(t-e);l.push(i+n*(c+r)),o.shift(),d=o[0]/100}s+=r[c]}return l}function Yi(e,t,i){const n=Math.exp(t*(e-i));return n/(n+1)}function Ui(e,t){const i=e/2+.5;let n=t<1?0:t-1;n=0===n?.001:12*n;const r=Yi(0,n,i);let o=Yi(1,n,i)-r;return o<=0&&(o=.1),{bias:i,contrast:n,offset:r,denominator:o}}function Xi(e,t,i=1e3,n=1.5,r=0,o=1,s=!0){let a;switch(t){case Rf.SQUARE:a=e*e;break;case Rf.SQRT:a=Math.sqrt(e);break;case Rf.LOG:a=Math.log(i*e+1)/Math.log(i+1);break;case Rf.POWER:a=(Math.pow(i,e)-1)/(i-1);break;case Rf.GAMMA:a=Math.pow(e,n);break;default:a=e}if(s)if(o<=1){const e=.5-r/2;a=Gi((a-e)*o+e,0,1)}else{const e=Ui(r,o);a=(Yi(a,e.contrast,e.bias)-e.offset)/e.denominator}else a=Gi(a-r,0,1),a=Gi((a-.5)*o+.5,0,1);return a}function $i(e,t,i=1e3,n=1.5,r=0,o=1,s=!0){let a;if(s)if(o<=1){const t=.5-r/2;a=0===e&&0===t&&0===o?1:Gi((e-t)/o+t,0,1)}else{const t=Ui(r,o);a=Gi(function(e,t,i){return Math.log(e/(1-e))/t+i}(e*t.denominator+t.offset,t.contrast,t.bias),0,1)}else a=(e-.5)/o+.5,a=Gi(a+r,0,1);switch(t){case Rf.SQUARE:return Math.sqrt(a);case Rf.SQRT:return a*a;case Rf.LOG:return(Math.pow(i+1,a)-1)/i;case Rf.POWER:return 1===i?0:Math.log((i-1)*a+1)/Math.log(i);case Rf.GAMMA:return Math.pow(a,1/n);default:return a}}function Ki(e,t){return Math.pow(t,Math.ceil(Math.log(e)/Math.log(t)))}function Qi(e){if(e&&e.length){let t=-Number.MAX_VALUE,i=Number.MAX_VALUE;for(let n=e.length-1;n>=0;n--){const r=e[n];isNaN(r)||(r>t&&(t=r),r<i&&(i=r))}if(t!==-Number.MAX_VALUE&&i!==Number.MAX_VALUE)return{maxVal:t,minVal:i}}return{minVal:NaN,maxVal:NaN}}function Zi(e,t,i,n){const r=(e-i)/n;return t*Math.exp(-4*Math.log(2)*r*r)}function Ji(e,t,i,n){return.25*t*Math.pow(n,2)/(Math.pow(e-i,2)+.25*Math.pow(n,2))}let en;function tn(e,t){return isFinite(e)?e:t}function nn(e){return e?e.replace(/\s\/\s?.*$/,""):""}function rn(e){const t={};return e.forEach(((e,i)=>{t[i.toString()]=e})),t}function on(e,t){return t(e)?[e]:T.flatten(T.map(e,(e=>"object"===typeof e?on(e,t):[])))}function sn(e){const t=e.replace(/[^0-9.+-.]+/g,"");if(""!==t)return Number(t)}function an(e){const t=e.replace(/\s/g,"");let i={operator:-1,values:[]};for(const n of Object.keys(en)){const e=en[n];if(t.includes(e)){if(e===en.Equal){const e=sn(t);return void 0!==e&&(i.operator=Nt.ComparisonOperator.Equal,i.values.push(e)),i}if(e===en.NotEqual){const e=sn(t);return void 0!==e&&(i.operator=Nt.ComparisonOperator.NotEqual,i.values.push(e)),i}if(e===en.Lesser){const e=sn(t);return void 0!==e&&(i.operator=Nt.ComparisonOperator.Lesser,i.values.push(e)),i}if(e===en.LessorOrEqual){const e=sn(t);return void 0!==e&&(i.values.push(e),i.operator=Nt.ComparisonOperator.LessorOrEqual),i}if(e===en.Greater){const e=sn(t);return void 0!==e&&(i.operator=Nt.ComparisonOperator.Greater,i.values.push(e)),i}if(e===en.GreaterOrEqual){const e=sn(t);return void 0!==e&&(i.values.push(e),i.operator=Nt.ComparisonOperator.GreaterOrEqual),i}if(e===en.RangeOpen){const e=t.split(en.RangeOpen,2);return""!==e[0]&&""!==e[1]&&(i.values.push(Number(e[0])),i.values.push(Number(e[1])),i.operator=Nt.ComparisonOperator.RangeOpen),i}if(e===en.RangeClosed){const e=t.split(en.RangeClosed,2);return""!==e[0]&&""!==e[1]&&(i.values.push(Number(e[0])),i.values.push(Number(e[1])),i.operator=Nt.ComparisonOperator.RangeClosed),i}}}return i}!function(e){e.Equal="==",e.NotEqual="!=",e.LessorOrEqual="<=",e.Lesser="<",e.GreaterOrEqual=">=",e.Greater=">",e.RangeClosed="...",e.RangeOpen=".."}(en||(en={}));const ln=i(786),cn=new Map([["image-view",{type:"react-component",component:"image-view",title:"No image loaded",height:(dn=window.innerHeight,pn=720,hn=1080,un=65,gn=75,un+(gn-un)*Wi(dn,pn,hn)),id:"image-view",isClosable:!1}],["render-config",{type:"react-component",component:"render-config",title:"Render Configuration",id:"render-config"}],["region-list",{type:"react-component",component:"region-list",title:"Region List",id:"region-list"}],["animator",{type:"react-component",component:"animator",title:"Animator",id:"animator"}],["spatial-profiler",{type:"react-component",component:"spatial-profiler",id:"spatial-profiler"}],["spectral-profiler",{type:"react-component",component:"spectral-profiler",id:"spectral-profiler",title:"Z Profile: Cursor"}],["stokes",{type:"react-component",component:"stokes",id:"stokes",title:"Stokes Analysis"}],["histogram",{type:"react-component",component:"histogram",title:"Histogram",id:"histogram"}],["stats",{type:"react-component",component:"stats",title:"Statistics",id:"stats"}],["layer-list",{type:"react-component",component:"layer-list",title:"Image List",id:"layer-list"}],["log",{type:"react-component",component:"log",title:"Log",id:"log"}],["catalog-overlay",{type:"react-component",component:"catalog-overlay",title:"Catalog Overlay",id:"catalog-overlay"}],["catalog-plot",{type:"react-component",component:"catalog-plot",title:"Catalog Plot",id:"catalog-plot"}],["spectral-line-query",{type:"react-component",component:"spectral-line-query",title:"Spectral Line Query",id:"spectral-line-query"}],["cursor-info",{type:"react-component",component:"cursor-info",title:"Cursor Info",id:"cursor-info"}]]);var dn,pn,hn,un,gn;class fn{}fn.LayoutValidator=new S.a({useDefaults:"empty",strictTypes:!1}).compile(ln),fn.CurrentSchemaVersion=2,fn.GetPresetConfig=e=>{if(!e)return null;const t=Ri.PRESET_CONFIGS.get(e);return t?{layoutVersion:fn.CurrentSchemaVersion,docked:{type:"row",content:[{type:"column",width:60,content:[{type:"component",id:"image-view"},t.leftBottomContent]},{type:"column",content:t.rightColumnContent}]},floating:[]}:null},fn.UpgradeLayout=e=>{if(1===e.layoutVersion){const t=on(e,(e=>"spatial-profiler"===e.id));for(const e of t)e.coord&&(e.widgetSettings||(e.widgetSettings={}),e.widgetSettings.coordinate=e.coord,delete e.coord);e.layoutVersion=2}if(e.floating&&Array.isArray(e.floating)){e.floating=e.floating.filter((e=>"floating-settings"!==(null===e||void 0===e?void 0:e.id)));for(const t of e.floating)"component"!==t.type&&(t.id=t.type,t.type="component")}},fn.IsUserLayoutValid=(e,t)=>{if(!e||!t)return!1;if(Ri.isPreset(e))return!1;return!!fn.LayoutValidator(t)||(console.log(fn.LayoutValidator.errors),!1)},fn.CreateConfigToSave=(e,t)=>{var i;if(!e||!t||!("type"in t)||!("content"in t))return null;let n={layoutVersion:fn.CurrentSchemaVersion,docked:{type:t.type,content:[]},floating:[]};return fn.GenSimpleConfigToSave(e,n.docked.content,t.content),null===(i=e.widgetsStore.floatingWidgets)||void 0===i||i.forEach((t=>{if("floating-settings"===(null===t||void 0===t?void 0:t.type))return;let i,r={type:"component",id:t.type,defaultWidth:t.defaultWidth?t.defaultWidth:"",defaultHeight:t.defaultHeight?t.defaultHeight:"",defaultX:t.defaultX?t.defaultX:"",defaultY:t.defaultY?t.defaultY:""};if(t.type===oH.WIDGET_CONFIG.type){const n=hM.Instance.catalogProfiles.get(t.id),r=hM.Instance.catalogWidgets.get(n);i=e.widgetsStore.toWidgetSettingsConfig(t.type,r)}else i=e.widgetsStore.toWidgetSettingsConfig(t.type,t.id);i&&(r.widgetSettings=i);const o=e.widgetsStore.catalogPlotWidgets.get(t.id);o&&(r.plotType=o.plotType),n.floating.push(r)})),n},fn.GenSimpleConfigToSave=(e,t,i)=>{e&&t&&Array.isArray(t)&&i&&Array.isArray(i)&&i.forEach((i=>{if(i.type)if("stack"===i.type||"row"===i.type||"column"===i.type){var n;let r={type:i.type,content:[]};"stack"===i.type&&i.activeItemIndex>=0&&i.activeItemIndex<(null===(n=i.content)||void 0===n?void 0:n.length)&&(r.activeItemIndex=i.activeItemIndex),i.width&&(r.width=i.width),i.height&&(r.height=i.height),t.push(r),i.content&&fn.GenSimpleConfigToSave(e,r.content,i.content)}else if("component"===i.type&&i.id){const n=i.id.replace(/(-component)?-\d+$/,"");let r,o={type:i.type,id:n};if(i.width&&(o.width=i.width),i.height&&(o.height=i.height),n===oH.WIDGET_CONFIG.type){const t=hM.Instance.catalogProfiles.get(i.id),o=hM.Instance.catalogWidgets.get(t);r=e.widgetsStore.toWidgetSettingsConfig(n,o)}else r=e.widgetsStore.toWidgetSettingsConfig(n,i.id);r&&(o.widgetSettings=r);const s=e.widgetsStore.catalogPlotWidgets.get(i.id);s&&(o.plotType=s.plotType),t.push(o)}}))},fn.CreateConfigToApply=(e,t,i)=>{e&&Array.isArray(e)&&t&&Array.isArray(t)&&t.forEach((t=>{if(t.type)if("stack"===t.type||"row"===t.type||"column"===t.type){var n;let r={type:t.type,content:[]};"stack"===t.type&&t.activeItemIndex>=0&&t.activeItemIndex<(null===(n=t.content)||void 0===n?void 0:n.length)&&(r.activeItemIndex=t.activeItemIndex),t.width&&(r.width=t.width),t.height&&(r.height=t.height),e.push(r),t.content&&fn.CreateConfigToApply(r.content,t.content,i)}else if("component"===t.type&&t.id){const n=t.id.replace(/-\d+$/,"");if(cn.has(n)){let r=Object.assign({},cn.get(n));t.width&&(r.width=t.width),t.height&&(r.height=t.height),"widgetSettings"in t&&(r.widgetSettings=t.widgetSettings),"plotType"in t&&(r.plotType=t.plotType),r.props={appStore:gC.Instance,id:"",docked:!0},i.push(r),e.push(r)}}}))};class bn{constructor(e,t,i,n,r){this.source=void 0,this.destination=void 0,this.width=void 0,this.height=void 0,this.minPoint=void 0,this.maxPoint=void 0,this.grid=void 0,this.texture=void 0,this.gl=void 0,this.getTextureX=e=>(e===this.gl&&this.texture||(this.gl=e,this.texture=this.gl.createTexture(),this.gl.activeTexture(vm.TEXTURE1),this.gl.bindTexture(vm.TEXTURE_2D,this.texture),this.gl.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,vm.NEAREST),this.gl.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,vm.NEAREST),this.gl.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_S,vm.CLAMP_TO_EDGE),this.gl.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_T,vm.CLAMP_TO_EDGE),this.gl.texImage2D(vm.TEXTURE_2D,0,vm.RG32F,this.width,this.height,0,vm.RG,vm.FLOAT,this.grid)),this.texture),this.hasTextureForContext=e=>e===this.gl&&this.texture&&e.isTexture(this.texture),this.source=e,this.destination=t,this.width=n,this.height=r;let o=!1;if(i<0){const n=Pt.copy(e.wcsInfo),r=Pt.copy(t.wcsInfo);Pt.invert(n),Pt.invert(r),i=Pt.convert(n,r,""),Pt.deleteObject(n),Pt.deleteObject(r),o=!0}const s=Math.ceil(e.frameInfo.fileInfoExtended.width/n),a=Math.ceil(e.frameInfo.fileInfoExtended.height/r);this.minPoint={x:-s,y:-a},this.maxPoint={x:s+e.frameInfo.fileInfoExtended.width,y:a+e.frameInfo.fileInfoExtended.height},this.grid=Pt.getTransformGrid(i,this.minPoint.x,this.maxPoint.x,n,this.minPoint.y,this.maxPoint.y,r,!0),o&&Pt.deleteObject(i)}getTransformedCoordinate(e){const t=nm(this.maxPoint,this.minPoint),i=nm(e,this.minPoint),n={x:this.width*i.x/t.x,y:this.height*i.y/t.y},r=Math.floor(n.x),o=Math.floor(n.y),s=n.x-r,a=n.y-o,l=o*this.width+r,c=(o+1)*this.width+r,d=o*this.width+r+1,p=(o+1)*this.width+r+1,h=this.grid[2*l],u=this.grid[2*l+1],g=this.grid[2*c],f=this.grid[2*c+1],b=this.grid[2*d],m=this.grid[2*d+1];return{x:h*(1-s)*(1-a)+b*s*(1-a)+g*(1-s)*a+this.grid[2*p]*s*a,y:u*(1-s)*(1-a)+m*s*(1-a)+f*(1-s)*a+this.grid[2*p+1]*s*a}}static IsWidthValid(e){return e>=128&&e<=1024}}let mn;!function(e){e[e.NONE=0]="NONE",e[e.SPATIAL=1]="SPATIAL",e[e.SPECTRAL=2]="SPECTRAL"}(mn||(mn={}));const yn=new Map([[Nt.Moment.MEAN_OF_THE_SPECTRUM,{tag:"-1",text:"Mean value of the spectrum"}],[Nt.Moment.INTEGRATED_OF_THE_SPECTRUM,{tag:"0",text:"Integrated value of the spectrum"}],[Nt.Moment.INTENSITY_WEIGHTED_COORD,{tag:"1",text:"Intensity weighted coordinate"}],[Nt.Moment.INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD,{tag:"2",text:"Intensity weighted dispersion of the coordinate"}],[Nt.Moment.MEDIAN_OF_THE_SPECTRUM,{tag:"3",text:"Median value of the spectrum"}],[Nt.Moment.MEDIAN_COORDINATE,{tag:"4",text:"Median coordinate"}],[Nt.Moment.STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM,{tag:"5",text:"Standard deviation about the mean of the spectrum"}],[Nt.Moment.RMS_OF_THE_SPECTRUM,{tag:"6",text:"Root mean square of the spectrum"}],[Nt.Moment.ABS_MEAN_DEVIATION_OF_THE_SPECTRUM,{tag:"7",text:"Absolute mean deviation of the spectrum"}],[Nt.Moment.MAX_OF_THE_SPECTRUM,{tag:"8",text:"Maximum value of the spectrum"}],[Nt.Moment.COORD_OF_THE_MAX_OF_THE_SPECTRUM,{tag:"9",text:"Coordinate of the maximum value of the spectrum"}],[Nt.Moment.MIN_OF_THE_SPECTRUM,{tag:"10",text:"Minimum value of the spectrum"}],[Nt.Moment.COORD_OF_THE_MIN_OF_THE_SPECTRUM,{tag:"11",text:"Coordinate of the minimum value of the spectrum"}]]),On=[Nt.StatsType.Sum,Nt.StatsType.FluxDensity,Nt.StatsType.Mean,Nt.StatsType.RMS,Nt.StatsType.Sigma,Nt.StatsType.SumSq,Nt.StatsType.Min,Nt.StatsType.Max,Nt.StatsType.Extrema],jn=new Map([[Nt.StatsType.Sum,"Sum"],[Nt.StatsType.FluxDensity,"FluxDensity"],[Nt.StatsType.Mean,"Mean"],[Nt.StatsType.RMS,"RMS"],[Nt.StatsType.Sigma,"StdDev"],[Nt.StatsType.SumSq,"SumSq"],[Nt.StatsType.Min,"Min"],[Nt.StatsType.Max,"Max"],[Nt.StatsType.Extrema,"Extrema"]]),xn=e=>{var t;return null!==(t=jn.get(e))&&void 0!==t?t:"Not Implemented"},{version:Sn}=i(384);class vn{constructor(){this.code=void 0,this.snippetVersion=void 0,this.frontendVersion=void 0,this.description=void 0,this.tags=void 0,this.categories=void 0,this.requires=void 0}}vn.FrontendVersion=Sn,vn.SnippetVersion=1;class Cn{constructor(e,t,i,n,r){this.source=void 0,this.destination=void 0,this.width=void 0,this.height=void 0,this.minPoint=void 0,this.maxPoint=void 0,this.gl2=void 0,this.texture=void 0,this.grid=void 0,this.boundaryUpdated=void 0,this.hasTextureForContext=e=>e===this.gl2&&this.texture&&e.isTexture(this.texture),this.updateCatalogBoundary=()=>{const e=hM.Instance,t=Math.ceil(this.source.frameInfo.fileInfoExtended.width/this.width),i=Math.ceil(this.destination.frameInfo.fileInfoExtended.height/this.height),n=e.getFrameMinMaxPoints(this.source.frameInfo.fileId),r=e.getFrameMinMaxPoints(this.destination.frameInfo.fileId),o=n.minX<r.minX?n.minX:r.minX,s=n.minY<r.minY?n.minY:r.minY,a=n.maxX>r.maxX?n.maxX:r.maxX,l=n.maxY>r.maxY?n.maxY:r.maxY;if(this.minPoint.x>o||this.minPoint.y>s||this.maxPoint.x<a||this.maxPoint.y<l){this.minPoint={x:o-t,y:s-i},this.maxPoint={x:a+t,y:l+i},this.boundaryUpdated=!0;const e=Pt.copy(this.source.wcsInfo),n=Pt.copy(this.destination.wcsInfo);Pt.invert(e),Pt.invert(n);const r=Pt.convert(e,n,"");Pt.deleteObject(e),Pt.deleteObject(n),this.minPoint={x:o-t,y:s-i},this.maxPoint={x:a+t,y:l+i},this.grid=Pt.getTransformGrid(r,this.minPoint.x,this.maxPoint.x,this.width,this.minPoint.y,this.maxPoint.y,this.height,!0),Pt.deleteObject(r)}},this.getTextureX=e=>(e===this.gl2&&this.texture&&!this.boundaryUpdated||(this.boundaryUpdated=!1,this.gl2=e,this.texture=this.gl2.createTexture(),this.gl2.activeTexture(vm.TEXTURE1),this.gl2.bindTexture(vm.TEXTURE_2D,this.texture),this.gl2.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,vm.NEAREST),this.gl2.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,vm.NEAREST),this.gl2.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_S,vm.CLAMP_TO_EDGE),this.gl2.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_T,vm.CLAMP_TO_EDGE),this.gl2.texImage2D(vm.TEXTURE_2D,0,vm.RG32F,this.width,this.height,0,vm.RG,vm.FLOAT,this.grid)),this.texture),this.source=e,this.destination=t,this.width=n,this.height=r;let o=!1;if(i<0){const n=Pt.copy(e.wcsInfo),r=Pt.copy(t.wcsInfo);Pt.invert(n),Pt.invert(r),i=Pt.convert(n,r,""),Pt.deleteObject(n),Pt.deleteObject(r),o=!0}this.minPoint={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.maxPoint={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE},this.boundaryUpdated=!1,o&&Pt.deleteObject(i)}static IsWidthValid(e){return e>=128&&e<=1024}}var In,wn,Tn,Rn,An,Pn,En,Mn,Fn,kn,Dn,Ln,Nn,_n,zn,Vn,Wn,Gn,Bn,qn=i(15);let Hn,Yn,Un;!function(e){e[e.VIZIER=0]="VIZIER",e[e.SIMBAD=1]="SIMBAD",e[e.FILE=2]="FILE"}(Hn||(Hn={})),function(e){e.Ecliptic="ECLIPTIC",e.FK4="FK4",e.FK5="FK5",e.Galactic="GALACTIC",e.ICRS="ICRS",e.Pixel0="Pixel0",e.Pixel1="Pixel1"}(Yn||(Yn={})),function(e){e.X="X",e.Y="Y",e.NONE="None",e.RA="RA",e.DEC="DEC",e.GLAT="GLAT",e.GLON="GLON",e.ELON="ELON",e.ELAT="ELAT",e.X0="X0",e.Y0="Y0",e.X1="X1",e.Y1="Y1"}(Un||(Un={}));let Xn,$n=(In=m.g.bound,Bn=Gn=class e{constructor(e,t){this.catalogInfo=void 0,this.catalogHeader=void 0,this.catalogControlHeader=void 0,this.numVisibleRows=void 0,Object(f.a)(this,"loadingData",Tn,this),Object(f.a)(this,"catalogType",Rn,this),Object(f.a)(this,"catalogFilterRequest",An,this),Object(f.a)(this,"catalogCoordinateSystem",Pn,this),Object(f.a)(this,"filterDataSize",En,this),Object(f.a)(this,"progress",Mn,this),Object(f.a)(this,"updatingDataStream",Fn,this),Object(f.a)(this,"updateTableView",kn,this),Object(f.a)(this,"updateMode",Dn,this),Object(f.a)(this,"selectedPointIndices",Ln,this),Object(f.a)(this,"sortingInfo",Nn,this),Object(f.a)(this,"sortedIndexMap",_n,this),Object(f.a)(this,"filterIndexMap",zn,this),this._catalogData=void 0,this._systemCoordinateMap=new Map([[Yn.FK4,{x:Un.RA,y:Un.DEC}],[Yn.FK5,{x:Un.RA,y:Un.DEC}],[Yn.ICRS,{x:Un.RA,y:Un.DEC}],[Yn.Galactic,{x:Un.GLON,y:Un.GLAT}],[Yn.Ecliptic,{x:Un.ELON,y:Un.ELAT}],[Yn.Pixel0,{x:Un.X0,y:Un.Y0}],[Yn.Pixel1,{x:Un.X1,y:Un.Y1}]]),Object(f.a)(this,"setColumnFilter",Vn,this),Object(f.a)(this,"setSelectedPointIndices",Wn,this),this._catalogData=t,this.catalogType=e,this.updatingDataStream=!1,this.updateTableView=!1,this.filterDataSize=void 0,this.selectedPointIndices=[],this.updateMode=DM.TableUpdate,this.sortingInfo={columnName:null,sortingType:null},this.sortedIndexMap=[],this.filterIndexMap=[],this.loadingData=!1}get catalogData(){if(!this.isFileBasedCatalog&&this.filterIndexMap.length!==this.catalogInfo.dataSize){const e=new Map;return this._catalogData.forEach(((t,i)=>{e.set(i,Gm(t,this.filterIndexMap))})),e}return this._catalogData}get catalogOriginalData(){return this._catalogData}get systemCoordinateMap(){return this._systemCoordinateMap}clearData(){this.catalogData.clear()}static getCatalogSystem(t){let i=Yn.ICRS;return e.CoordinateSystemName.forEach(((e,n)=>{t.toUpperCase().includes(e.toUpperCase())&&(i=n)})),i}get2DPlotData(e,t,i){const n=this.catalogControlHeader,r=n.get(e),o=n.get(t),s=this.catalogHeader[r.dataIndex],a=this.catalogHeader[o.dataIndex],l=i.get(s.columnIndex),c=i.get(a.columnIndex);if(l&&l.dataType!==Nt.ColumnType.String&&l.dataType!==Nt.ColumnType.Bool&&c&&c.dataType!==Nt.ColumnType.String&&c.dataType!==Nt.ColumnType.Bool){return{wcsX:l.data,wcsY:c.data,xHeaderInfo:s,yHeaderInfo:a}}return{xHeaderInfo:s,yHeaderInfo:a}}get1DPlotData(e){const t=this.catalogControlHeader.get(e),i=this.catalogHeader[t.dataIndex],n=this.catalogData.get(i.columnIndex);if(n&&n.dataType!==Nt.ColumnType.String&&n.dataType!==Nt.ColumnType.Bool){return{wcsData:n.data,headerInfo:i}}return{headerInfo:i}}getUserFilters(){let t=[];return this.catalogControlHeader.forEach(((i,n)=>{if(void 0!==i.filter&&i.display){let r=new Nt.FilterConfig;const o=this.catalogHeader[i.dataIndex].dataType;if(r.columnName=n,o===Nt.ColumnType.String)""!==i.filter&&(r.subString=i.filter,t.push(r));else if(o===Nt.ColumnType.Bool)i.filter&&(r.comparisonOperator=Nt.ComparisonOperator.Equal,i.filter.match(e.TRUE_REGEX)?(r.value=1,t.push(r)):i.filter.match(e.FALSE_REGEX)&&(r.value=0,t.push(r)));else{const e=an(i.filter);void 0!==e.operator&&e.values.length>0&&(r.comparisonOperator=e.operator,e.values.length>1?(r.value=Math.min(e.values[0],e.values[1]),r.secondaryValue=Math.max(e.values[0],e.values[1])):r.value=e.values[0],t.push(r))}}})),t}get catalogFileId(){return this.catalogInfo.fileId}get activedSystem(){return this.systemCoordinateMap.get(this.catalogCoordinateSystem.system)}get regionSelected(){return this.selectedPointIndices.length}get displayedColumnHeaders(){let e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.display&&this.catalogHeader&&e.push(this.catalogHeader[t.dataIndex])})),e}get selectedData(){let e=this.catalogData;const t=this.selectedPointIndices,i=this.displayedColumnHeaders.map((e=>e.columnIndex));if(t.length>0){const e=new Map;return this.catalogData.forEach(((n,r)=>{i.includes(r)&&e.set(r,Gm(n,t))})),e}return e}get autoScrollRowNumber(){let e=qn.c.row(0);return this.selectedPointIndices.length>0&&(e=qn.c.row(Qi(this.selectedPointIndices).minVal)),e}get isFileBasedCatalog(){return this.catalogType===Hn.FILE}get tableColumnWidts(){const e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.display&&e.push(t.columnWidth)})),e}get hasFilter(){let t=!1;return this.catalogControlHeader.forEach(((i,n)=>{if(i.filter&&i.display){const n=this.catalogData.get(i.dataIndex);if((null===n||void 0===n?void 0:n.dataType)===Nt.ColumnType.String)t=!0;else if((null===n||void 0===n?void 0:n.dataType)===Nt.ColumnType.Bool){var r,o;t=(null===(r=i.filter.match(e.TRUE_REGEX))||void 0===r?void 0:r.length)>0||(null===(o=i.filter.match(e.FALSE_REGEX))||void 0===o?void 0:o.length)>0}else{const{operator:e,values:n}=an(i.filter);e>=0&&n.length&&(t=!0)}}})),t}updateTableStatus(e){this.updateTableView=e}setTableColumnWidth(e,t){this.catalogControlHeader.get(t).columnWidth=e}setHeaderDisplay(e,t){this.catalogControlHeader.get(t).display=e}setUpdateMode(e){this.updateMode=e}setLoadingDataStatus(e){this.loadingData=e}setUpdatingDataStream(e){this.updatingDataStream=e}setCatalogCoordinateSystem(e){const t=this.catalogCoordinateSystem;this.catalogCoordinateSystem={system:e,equinox:t.equinox,epoch:t.epoch,coordinate:this.systemCoordinateMap.get(e)}}setProgress(e){this.progress=e}getSortedIndices(e){let t=new Array(e.length);if(!this.sortedIndexMap.length||!e.length||this.isFileBasedCatalog)return e;for(let i=0;i<e.length;i++){const n=e[i];t[i]=this.sortedIndexMap[n]}return t}getOriginIndices(e){let t=new Array(e.length);if(!this.sortedIndexMap.length||!e.length||this.isFileBasedCatalog)return e;for(let i=0;i<e.length;i++){const n=e[i],r=this.sortedIndexMap.indexOf(n);r>-1&&(t[i]=r)}return t}resetUserFilters(){this.catalogControlHeader.forEach(((e,t)=>{e.filter=""})),this.filterDataSize=void 0}isInfinite(t){return!isFinite(t)||t===e.NEGATIVE_INFINITY||t===e.POSITIVE_INFINITY}},Gn.NEGATIVE_INFINITY=-17976931348623157e292,Gn.POSITIVE_INFINITY=17976931348623157e292,Gn.TRUE_REGEX=/^[tTyY].*$/,Gn.FALSE_REGEX=/^[fFnN].*$/,Gn.CoordinateSystemName=new Map([[Yn.FK5,"FK5"],[Yn.FK4,"FK4"],[Yn.Galactic,"GALACTIC"],[Yn.Ecliptic,"ECLIPTIC"],[Yn.ICRS,"ICRS"],[Yn.Pixel0,"PIX0"],[Yn.Pixel1,"PIX1"]]),wn=Bn,Tn=Object(b.a)(wn.prototype,"loadingData",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=Object(b.a)(wn.prototype,"catalogType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=Object(b.a)(wn.prototype,"catalogFilterRequest",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pn=Object(b.a)(wn.prototype,"catalogCoordinateSystem",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),En=Object(b.a)(wn.prototype,"filterDataSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=Object(b.a)(wn.prototype,"progress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fn=Object(b.a)(wn.prototype,"updatingDataStream",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=Object(b.a)(wn.prototype,"updateTableView",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=Object(b.a)(wn.prototype,"updateMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Object(b.a)(wn.prototype,"selectedPointIndices",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nn=Object(b.a)(wn.prototype,"sortingInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Object(b.a)(wn.prototype,"sortedIndexMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Object(b.a)(wn.prototype,"filterIndexMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(wn.prototype,"catalogFileId",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"catalogFileId"),wn.prototype),Object(b.a)(wn.prototype,"activedSystem",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"activedSystem"),wn.prototype),Object(b.a)(wn.prototype,"regionSelected",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"regionSelected"),wn.prototype),Object(b.a)(wn.prototype,"displayedColumnHeaders",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"displayedColumnHeaders"),wn.prototype),Object(b.a)(wn.prototype,"selectedData",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"selectedData"),wn.prototype),Object(b.a)(wn.prototype,"autoScrollRowNumber",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"autoScrollRowNumber"),wn.prototype),Object(b.a)(wn.prototype,"isFileBasedCatalog",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"isFileBasedCatalog"),wn.prototype),Object(b.a)(wn.prototype,"tableColumnWidts",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"tableColumnWidts"),wn.prototype),Object(b.a)(wn.prototype,"hasFilter",[m.i],Object.getOwnPropertyDescriptor(wn.prototype,"hasFilter"),wn.prototype),Object(b.a)(wn.prototype,"updateTableStatus",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"updateTableStatus"),wn.prototype),Vn=Object(b.a)(wn.prototype,"setColumnFilter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=this.catalogControlHeader.get(t),n={columnIndex:i.columnIndex,dataIndex:i.dataIndex,display:i.display,filter:e,columnWidth:i.columnWidth};this.catalogControlHeader.set(t,n),this.updateTableStatus(!0)}}}),Object(b.a)(wn.prototype,"setTableColumnWidth",[In],Object.getOwnPropertyDescriptor(wn.prototype,"setTableColumnWidth"),wn.prototype),Object(b.a)(wn.prototype,"setHeaderDisplay",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"setHeaderDisplay"),wn.prototype),Object(b.a)(wn.prototype,"setUpdateMode",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"setUpdateMode"),wn.prototype),Object(b.a)(wn.prototype,"setLoadingDataStatus",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"setLoadingDataStatus"),wn.prototype),Object(b.a)(wn.prototype,"setUpdatingDataStream",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"setUpdatingDataStream"),wn.prototype),Object(b.a)(wn.prototype,"setCatalogCoordinateSystem",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"setCatalogCoordinateSystem"),wn.prototype),Object(b.a)(wn.prototype,"setProgress",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"setProgress"),wn.prototype),Wn=Object(b.a)(wn.prototype,"setSelectedPointIndices",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i;this.selectedPointIndices=e;const n=hM.Instance,r=hM.Instance.catalogGLData.get(this.catalogFileId);if(null===r||void 0===r||null===(i=r.x)||void 0===i?void 0:i.length){let i=[],o=[];const s=new Uint8Array(r.x.length);let a=this.getSortedIndices(e);for(let e=0;e<a.length;e++){const t=a[e],n=r.x[t],l=r.y[t];this.isInfinite(n)||this.isInfinite(l)||(i.push(n),o.push(l)),s[t]=1}if(Tx.Instance.updateDataTexture(this.catalogFileId,s,Ix.SelectedSource),t&&this.updateMode===DM.ViewUpdate){const e=gC.Instance,t=e.getFrame(n.getFrameIdByCatalogId(this.catalogFileId)),r=i.length;let s={x:i[0],y:o[0]};if(r>1){const t=Qi(i),n=Qi(o),r=t.maxVal-t.minVal,a=n.maxVal-n.minVal;s={x:r/2+t.minVal,y:a/2+n.minVal};const l=Math.min(e.activeFrame.renderWidth/r,e.activeFrame.renderHeight/a);e.activeFrame.setZoom(l)}t.spatialReference&&t!==e.activeFrame&&(s=Mm(t.spatialTransformAST,s,!0)),e.activeFrame.spatialReference&&!t.spatialReference?e.activeFrame.setCenter(s.x,s.y,!1):e.activeFrame.setCenter(s.x,s.y)}}}}}),Object(b.a)(wn.prototype,"resetUserFilters",[m.g],Object.getOwnPropertyDescriptor(wn.prototype,"resetUserFilters"),wn.prototype),wn);!function(e){e.None="none",e.Dynamic="dynamic",e.Fixed="fixed"}(Xn||(Xn={}));const Kn=new Map([[-8,"YX"],[-7,"XY"],[-6,"YY"],[-5,"XX"],[-4,"LR"],[-3,"RL"],[-2,"LL"],[-1,"RR"],[1,"I"],[2,"Q"],[3,"U"],[4,"V"]]),Qn=new Map([[13,"Ptotal"],[14,"Plinear"],[15,"PFtotal"],[16,"PFlinear"],[17,"Pangle"]]),Zn=new Map([...Kn,...Qn]),Jn=new Map([["","Current"],["I","Stokes I"],["Q","Stokes Q"],["U","Stokes U"],["V","Stokes V"],["YX","YX"],["XY","XY"],["YY","YY"],["XX","XX"],["LR","LR"],["RL","RL"],["LL","LL"],["RR","RR"],["Ptotal","Ptotal"],["Plinear","Plinear"],["PFtotal","PFtotal"],["PFlinear","PFlinear"],["Pangle","Pangle"]]);let er;!function(e){e[e.YX=-8]="YX",e[e.XY=-7]="XY",e[e.YY=-6]="YY",e[e.XX=-5]="XX",e[e.LR=-4]="LR",e[e.RL=-3]="RL",e[e.LL=-2]="LL",e[e.RR=-1]="RR",e[e.I=1]="I",e[e.Q=2]="Q",e[e.U=3]="U",e[e.V=4]="V",e[e.Ptotal=13]="Ptotal",e[e.Plinear=14]="Plinear",e[e.PFtotal=15]="PFtotal",e[e.PFlinear=16]="PFlinear",e[e.Pangle=17]="Pangle"}(er||(er={}));const tr=["z",...Array.from(Zn.values()).map((e=>`${e}z`))],ir=["x","y",...Array.from(Zn.values()).map((e=>`${e}x`)),...Array.from(Zn.values()).map((e=>`${e}y`))];let nr;function rr(e){switch(e){case nr.Content:return Nt.FileListFilterMode.Content;case nr.Extension:return Nt.FileListFilterMode.Extension;default:return Nt.FileListFilterMode.AllFiles}}!function(e){e.Content="content",e.Extension="extension",e.All="all"}(nr||(nr={}));class or{constructor(){this.value=void 0,this.unit=void 0}}var sr,ar,lr,cr,dr,pr,hr,ur,gr,fr,br,mr,yr,Or,jr,xr,Sr,vr,Cr,Ir,wr,Tr,Rr,Ar,Pr,Er,Mr,Fr;or.convertUnitFromHz=e=>isFinite(e)?e>=1e9?{value:e/1e9,unit:Ht.GHZ}:e>=1e6?{value:e/1e6,unit:Ht.MHZ}:e>=1e3?{value:e/1e3,unit:Ht.KHZ}:{value:e,unit:Ht.HZ}:{value:void 0,unit:Ht.MHZ},or.convertUnitToHz=e=>{switch(e.unit){case Ht.GHZ:return 1e9*e.value;case Ht.MHZ:return 1e6*e.value;case Ht.KHZ:return 1e3*e.value;default:return e.value}};let kr=(sr=class{constructor(){Object(f.a)(this,"minX",ar,this),Object(f.a)(this,"maxX",lr,this),Object(f.a)(this,"minY",cr,this),Object(f.a)(this,"maxY",dr,this),Object(f.a)(this,"cursorX",pr,this),Object(f.a)(this,"plotType",hr,this),Object(f.a)(this,"primaryLineColor",ur,this),Object(f.a)(this,"lineWidth",gr,this),Object(f.a)(this,"linePlotPointSize",fr,this),Object(f.a)(this,"logScaleY",br,this),Object(f.a)(this,"markerTextVisible",mr,this),Object(f.a)(this,"meanRmsVisible",yr,this),Object(f.a)(this,"linePlotInitXYBoundaries",Or,this),Object(f.a)(this,"setXBounds",jr,this),Object(f.a)(this,"clearXBounds",xr,this),Object(f.a)(this,"setYBounds",Sr,this),Object(f.a)(this,"clearYBounds",vr,this),Object(f.a)(this,"setXYBounds",Cr,this),Object(f.a)(this,"clearXYBounds",Ir,this),Object(f.a)(this,"setMarkerTextVisible",wr,this),Object(f.a)(this,"setMeanRmsVisible",Tr,this),Object(f.a)(this,"setLogScale",Rr,this),Object(f.a)(this,"setPlotType",Ar,this),Object(f.a)(this,"setCursor",Pr,this),Object(f.a)(this,"setPrimaryLineColor",Er,this),Object(f.a)(this,"setLineWidth",Mr,this),Object(f.a)(this,"setLinePlotPointSize",Fr,this),this.init=e=>{if(!e)return;(je()(e.primaryLineColor).isValid()||Qb(e.primaryLineColor))&&(this.primaryLineColor=e.primaryLineColor),"number"===typeof e.lineWidth&&e.lineWidth>=rO.MIN_WIDTH&&e.lineWidth<=rO.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=rO.MIN_POINT_SIZE&&e.linePlotPointSize<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.logScaleY&&(this.logScaleY=e.logScaleY),"boolean"===typeof e.markerTextVisible&&(this.markerTextVisible=e.markerTextVisible),"boolean"===typeof e.meanRmsVisible&&(this.meanRmsVisible=e.meanRmsVisible),"string"!==typeof e.plotType||e.plotType!==oO.STEPS&&e.plotType!==oO.LINES&&e.plotType!==oO.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,logScaleY:this.logScaleY,markerTextVisible:this.markerTextVisible,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(m.p)(this),this.logScaleY=!0,this.plotType=oO.STEPS,this.markerTextVisible=!0,this.meanRmsVisible=!0,this.primaryLineColor="auto-blue",this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0}}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},ar=Object(b.a)(sr.prototype,"minX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lr=Object(b.a)(sr.prototype,"maxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cr=Object(b.a)(sr.prototype,"minY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dr=Object(b.a)(sr.prototype,"maxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pr=Object(b.a)(sr.prototype,"cursorX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hr=Object(b.a)(sr.prototype,"plotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ur=Object(b.a)(sr.prototype,"primaryLineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gr=Object(b.a)(sr.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Object(b.a)(sr.prototype,"linePlotPointSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),br=Object(b.a)(sr.prototype,"logScaleY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mr=Object(b.a)(sr.prototype,"markerTextVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yr=Object(b.a)(sr.prototype,"meanRmsVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Or=Object(b.a)(sr.prototype,"linePlotInitXYBoundaries",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jr=Object(b.a)(sr.prototype,"setXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),xr=Object(b.a)(sr.prototype,"clearXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Sr=Object(b.a)(sr.prototype,"setYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),vr=Object(b.a)(sr.prototype,"clearYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Cr=Object(b.a)(sr.prototype,"setXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),Ir=Object(b.a)(sr.prototype,"clearXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),wr=Object(b.a)(sr.prototype,"setMarkerTextVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),Tr=Object(b.a)(sr.prototype,"setMeanRmsVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),Rr=Object(b.a)(sr.prototype,"setLogScale",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logScaleY=e}}}),Ar=Object(b.a)(sr.prototype,"setPlotType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),Pr=Object(b.a)(sr.prototype,"setCursor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Object(b.a)(sr.prototype,"isAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(sr.prototype,"isAutoScaledX"),sr.prototype),Object(b.a)(sr.prototype,"isAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(sr.prototype,"isAutoScaledY"),sr.prototype),Er=Object(b.a)(sr.prototype,"setPrimaryLineColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.primaryLineColor=e}}}),Mr=Object(b.a)(sr.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_WIDTH&&e<=rO.MAX_WIDTH&&(this.lineWidth=e)}}}),Fr=Object(b.a)(sr.prototype,"setLinePlotPointSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_POINT_SIZE&&e<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(b.a)(sr.prototype,"initXYBoundaries",[m.g],Object.getOwnPropertyDescriptor(sr.prototype,"initXYBoundaries"),sr.prototype),sr);var Dr,Lr,Nr,_r,zr,Vr,Wr;const Gr=-1;let Br,qr;!function(e){e[e.ACTIVE=-3]="ACTIVE",e[e.IMAGE=-1]="IMAGE",e[e.CURSOR=0]="CURSOR"}(Br||(Br={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.CLOSED_AND_POINT=1]="CLOSED_AND_POINT",e[e.POINT_AND_LINES=2]="POINT_AND_LINES",e[e.LINE=3]="LINE"}(qr||(qr={}));let Hr=(Dr=class{constructor(e){this.appStore=void 0,Object(f.a)(this,"fileId",Lr,this),Object(f.a)(this,"regionIdMap",Nr,this),Object(f.a)(this,"type",_r,this),Object(f.a)(this,"clearFrameEntry",zr,this),Object(f.a)(this,"clearRegionMap",Vr,this),Object(f.a)(this,"setFileId",Wr,this),Object(m.p)(this),this.appStore=gC.Instance,this.fileId=Gr,this.type=e,this.regionIdMap=new Map}setRegionId(e,t){this.regionIdMap.set(e,t)}get effectiveFrame(){var e;return this.appStore.activeFrame&&(null===(e=this.appStore.frames)||void 0===e?void 0:e.length)>0?this.fileId!==Gr&&this.appStore.getFrame(this.fileId)?this.appStore.getFrame(this.fileId):this.appStore.activeFrame:null}get isEffectiveFrameEqualToActiveFrame(){return this.effectiveFrame&&this.appStore.activeFrame.frameInfo.fileId===this.effectiveFrame.frameInfo.fileId}get effectiveRegionId(){if(this.effectiveFrame){const e=this.regionIdMap.get(this.fileId);if(e!==Br.ACTIVE&&void 0!==e)return e;{const e=this.effectiveFrame.regionSet.selectedRegion;if(e)switch(this.type){case qr.CLOSED:return e.isClosedRegion?e.regionId:this.defaultRegionId();case qr.CLOSED_AND_POINT:case qr.POINT_AND_LINES:return e.regionId;case qr.LINE:default:return e.regionType===Nt.RegionType.LINE?e.regionId:this.defaultRegionId()}}}return this.defaultRegionId()}defaultRegionId(){switch(this.type){case qr.CLOSED:return Br.IMAGE;case qr.CLOSED_AND_POINT:case qr.POINT_AND_LINES:return Br.CURSOR;case qr.LINE:default:return null}}get effectiveRegion(){var e;return null===(e=this.effectiveFrame)||void 0===e?void 0:e.getRegion(this.effectiveRegionId)}get effectiveRegionInfo(){var e,t;if(this.effectiveFrame)return this.effectiveRegionId===Br.IMAGE?"Image":null!==(e=null===(t=this.effectiveRegion)||void 0===t?void 0:t.nameString)&&void 0!==e?e:void 0}get matchesSelectedRegion(){if(this.isEffectiveFrameEqualToActiveFrame){if(this.appStore.selectedRegion)return this.effectiveRegionId===this.appStore.selectedRegion.regionId;if(this.effectiveRegionId===Br.CURSOR||this.effectiveRegionId===Br.IMAGE)return!0}return!1}get frameOptions(){var e;return[{value:Gr,label:"Active"},...null!==(e=gC.Instance.frameNames)&&void 0!==e?e:[]]}static CalculateRequirementsArray(e){const t=new Map;return e.forEach((e=>{const i=e.effectiveFrame;if(!i)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=i.getRegion(r);if(-1===r||(null===o||void 0===o?void 0:o.isClosedRegion)){let e=t.get(n);e||(e=[],t.set(n,e)),e.includes(r)||e.push(r)}})),t}},Lr=Object(b.a)(Dr.prototype,"fileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nr=Object(b.a)(Dr.prototype,"regionIdMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_r=Object(b.a)(Dr.prototype,"type",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zr=Object(b.a)(Dr.prototype,"clearFrameEntry",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionIdMap.delete(e)}}}),Vr=Object(b.a)(Dr.prototype,"clearRegionMap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionIdMap.clear()}}}),Object(b.a)(Dr.prototype,"setRegionId",[m.g],Object.getOwnPropertyDescriptor(Dr.prototype,"setRegionId"),Dr.prototype),Wr=Object(b.a)(Dr.prototype,"setFileId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileId=e}}}),Object(b.a)(Dr.prototype,"effectiveFrame",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"effectiveFrame"),Dr.prototype),Object(b.a)(Dr.prototype,"isEffectiveFrameEqualToActiveFrame",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"isEffectiveFrameEqualToActiveFrame"),Dr.prototype),Object(b.a)(Dr.prototype,"effectiveRegionId",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"effectiveRegionId"),Dr.prototype),Object(b.a)(Dr.prototype,"effectiveRegion",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"effectiveRegion"),Dr.prototype),Object(b.a)(Dr.prototype,"effectiveRegionInfo",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"effectiveRegionInfo"),Dr.prototype),Object(b.a)(Dr.prototype,"matchesSelectedRegion",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"matchesSelectedRegion"),Dr.prototype),Object(b.a)(Dr.prototype,"frameOptions",[m.i],Object.getOwnPropertyDescriptor(Dr.prototype,"frameOptions"),Dr.prototype),Dr);var Yr,Ur,Xr,$r,Kr,Qr,Zr,Jr,eo,to,io,no,ro,oo,so,ao,lo,co,po,ho,uo,go,fo,bo,mo,yo,Oo,jo,xo,So,vo,Co,Io,wo,To,Ro,Ao,Po,Eo;const Mo="current";let Fo=(Yr=class e extends Hr{constructor(e="x"){super(qr.POINT_AND_LINES),Object(f.a)(this,"coordinate",Ur,this),Object(f.a)(this,"selectedStokes",Xr,this),Object(f.a)(this,"minX",$r,this),Object(f.a)(this,"maxX",Kr,this),Object(f.a)(this,"minY",Qr,this),Object(f.a)(this,"maxY",Zr,this),Object(f.a)(this,"cursorX",Jr,this),Object(f.a)(this,"markerTextVisible",eo,this),Object(f.a)(this,"isMouseMoveIntoLinePlots",to,this),Object(f.a)(this,"wcsAxisVisible",io,this),Object(f.a)(this,"plotType",no,this),Object(f.a)(this,"meanRmsVisible",ro,this),Object(f.a)(this,"primaryLineColor",oo,this),Object(f.a)(this,"lineWidth",so,this),Object(f.a)(this,"linePlotPointSize",ao,this),Object(f.a)(this,"linePlotInitXYBoundaries",lo,this),this.smoothingStore=void 0,Object(f.a)(this,"settingsTabId",co,this),Object(f.a)(this,"lineRegionSampleWidth",po,this),Object(f.a)(this,"setRegionId",ho,this),Object(f.a)(this,"setCoordinate",uo,this),Object(f.a)(this,"setXBounds",go,this),Object(f.a)(this,"clearXBounds",fo,this),Object(f.a)(this,"setYBounds",bo,this),Object(f.a)(this,"clearYBounds",mo,this),Object(f.a)(this,"setXYBounds",yo,this),Object(f.a)(this,"clearXYBounds",Oo,this),Object(f.a)(this,"setMarkerTextVisible",jo,this),Object(f.a)(this,"setMeanRmsVisible",xo,this),Object(f.a)(this,"setWcsAxisVisible",So,this),Object(f.a)(this,"setPlotType",vo,this),Object(f.a)(this,"setCursor",Co,this),Object(f.a)(this,"setMouseMoveIntoLinePlots",Io,this),Object(f.a)(this,"setSettingsTabId",wo,this),Object(f.a)(this,"setLineRegionSampleWidth",To,this),Object(f.a)(this,"setPrimaryLineColor",Ro,this),Object(f.a)(this,"setLineWidth",Ao,this),Object(f.a)(this,"setLinePlotPointSize",Po,this),Object(f.a)(this,"setSelectedStokes",Eo,this),this.init=e=>{if(!e)return;"string"===typeof e.coordinate&&ir.includes(e.coordinate)&&(this.coordinate=e.coordinate);(je()(e.primaryLineColor).isValid()||Qb(e.primaryLineColor))&&(this.primaryLineColor=e.primaryLineColor),"number"===typeof e.lineWidth&&e.lineWidth>=rO.MIN_WIDTH&&e.lineWidth<=rO.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=rO.MIN_POINT_SIZE&&e.linePlotPointSize<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.wcsAxisVisible&&(this.wcsAxisVisible=e.wcsAxisVisible),"boolean"===typeof e.meanRmsVisible&&(this.meanRmsVisible=e.meanRmsVisible),"string"!==typeof e.plotType||e.plotType!==oO.STEPS&&e.plotType!==oO.LINES&&e.plotType!==oO.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({coordinate:this.coordinate,primaryLineColor:this.primaryLineColor,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,wcsAxisVisible:this.wcsAxisVisible,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(m.p)(this),this.lineRegionSampleWidth=3,this.coordinate=e,this.selectedStokes=Mo,this.plotType=oO.STEPS,this.meanRmsVisible=!1,this.markerTextVisible=!1,this.wcsAxisVisible=!0,this.primaryLineColor="auto-blue",this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.smoothingStore=new Ha,this.settingsTabId=OH.STYLING,Object(m.h)((()=>{this.effectiveFrame&&(this.selectedStokes=Mo)}))}get isXProfile(){var e;return null===(e=this.coordinate)||void 0===e?void 0:e.includes("x")}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}get stokesOptions(){var e;let t=[{value:Mo,label:"Current"}];return(null===(e=this.effectiveFrame)||void 0===e?void 0:e.hasStokes)&&t.push(...this.effectiveFrame.coordinateOptions),t}get fullCoordinate(){var e,t;const i=this.effectiveFrame;let n;return(null===i||void 0===i?void 0:i.hasStokes)&&(n=this.selectedStokes===Mo?i.requiredPolarizationInfo:this.selectedStokes),`${null!==(e=null===(t=n)||void 0===t?void 0:t.replace("Stokes ",""))&&void 0!==e?e:""}${this.isLineOrPolyline?"":this.coordinate}`}get isLineOrPolyline(){var e,t;return(null===(e=this.effectiveRegion)||void 0===e?void 0:e.regionType)===Nt.RegionType.LINE||(null===(t=this.effectiveRegion)||void 0===t?void 0:t.regionType)===Nt.RegionType.POLYLINE}get effectivePolarization(){var e;return this.selectedStokes===Mo?null===(e=this.effectiveFrame)||void 0===e?void 0:e.requiredPolarization:er[this.fullCoordinate.substring(0,this.fullCoordinate.length-1)]}static GetSpatialConfig(e,t,i,n){return e.cursorMoving&&!gC.Instance.cursorFrozen&&(null===i||void 0===i?void 0:i.regionId)===Br.CURSOR?t.includes("x")?{coordinate:t,mip:Gi(e.requiredFrameView.mip,1,e.maxMip),start:Math.floor(Gi(e.requiredFrameView.xMin,0,e.frameInfo.fileInfoExtended.width)),end:Math.ceil(Gi(e.requiredFrameView.xMax,0,e.frameInfo.fileInfoExtended.width))}:{coordinate:t,mip:Gi(e.requiredFrameView.mip,1,e.maxMip),start:Math.floor(Gi(e.requiredFrameView.yMin,0,e.frameInfo.fileInfoExtended.height)),end:Math.ceil(Gi(e.requiredFrameView.yMax,0,e.frameInfo.fileInfoExtended.height))}:{coordinate:t,mip:1,width:(null===i||void 0===i?void 0:i.regionType)===Nt.RegionType.LINE||(null===i||void 0===i?void 0:i.regionType)===Nt.RegionType.POLYLINE?n:void 0}}static CalculateRequirementsMap(t){const i=new Map;return t.forEach((t=>{const n=t.effectiveFrame,r=n.frameInfo.fileId,o=t.effectiveRegionId;if(!n.regionSet)return;const s=n.regionSet.regions.find((e=>e.regionId===o));if(s){let a=i.get(r);a||(a=new Map,i.set(r,a));let l=a.get(o);l||(l=new Nt.SetSpatialRequirements({regionId:o,fileId:r}),a.set(o,l)),l.spatialProfiles||(l.spatialProfiles=[]);l.spatialProfiles.find((e=>e.coordinate===t.fullCoordinate))||l.spatialProfiles.push(e.GetSpatialConfig(n,t.fullCoordinate,s,t.lineRegionSampleWidth))}})),i}static DiffSpatialRequirements(e,t){const i=[];return e.forEach(((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach(((e,t)=>{let r=n.get(t);r||(r=new Nt.SetSpatialRequirements({fileId:i,regionId:t,spatialProfiles:[]}),n.set(t,r))}))})),t.forEach(((t,n)=>{let r=e.get(n);r?t.forEach(((e,t)=>{let n=r.get(t);if(n){const t=n.spatialProfiles?n.spatialProfiles.length:0,r=e.spatialProfiles?e.spatialProfiles.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.spatialProfiles.sort(),s=n.spatialProfiles.sort();for(let n=0;n<r;n++){const t=o[n],r=s[n];if(!T.isEqual(r,t))return void i.push(e)}}else i.push(e)})):t.forEach((e=>i.push(e)))})),i.sort(((e,t)=>e.spatialProfiles.length>t.spatialProfiles.length?1:-1))}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ur=Object(b.a)(Yr.prototype,"coordinate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xr=Object(b.a)(Yr.prototype,"selectedStokes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$r=Object(b.a)(Yr.prototype,"minX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kr=Object(b.a)(Yr.prototype,"maxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qr=Object(b.a)(Yr.prototype,"minY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zr=Object(b.a)(Yr.prototype,"maxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jr=Object(b.a)(Yr.prototype,"cursorX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eo=Object(b.a)(Yr.prototype,"markerTextVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Object(b.a)(Yr.prototype,"isMouseMoveIntoLinePlots",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),io=Object(b.a)(Yr.prototype,"wcsAxisVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),no=Object(b.a)(Yr.prototype,"plotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ro=Object(b.a)(Yr.prototype,"meanRmsVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oo=Object(b.a)(Yr.prototype,"primaryLineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),so=Object(b.a)(Yr.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ao=Object(b.a)(Yr.prototype,"linePlotPointSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lo=Object(b.a)(Yr.prototype,"linePlotInitXYBoundaries",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),co=Object(b.a)(Yr.prototype,"settingsTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),po=Object(b.a)(Yr.prototype,"lineRegionSampleWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ho=Object(b.a)(Yr.prototype,"setRegionId",[m.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.regionIdMap.set(e,t),this.clearXYBounds()}}}),uo=Object(b.a)(Yr.prototype,"setCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{ir.includes(e)&&(this.clearXYBounds(),this.coordinate=e)}}}),go=Object(b.a)(Yr.prototype,"setXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),fo=Object(b.a)(Yr.prototype,"clearXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),bo=Object(b.a)(Yr.prototype,"setYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),mo=Object(b.a)(Yr.prototype,"clearYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),yo=Object(b.a)(Yr.prototype,"setXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),Oo=Object(b.a)(Yr.prototype,"clearXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),jo=Object(b.a)(Yr.prototype,"setMarkerTextVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),xo=Object(b.a)(Yr.prototype,"setMeanRmsVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),So=Object(b.a)(Yr.prototype,"setWcsAxisVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.wcsAxisVisible=e}}}),vo=Object(b.a)(Yr.prototype,"setPlotType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),Co=Object(b.a)(Yr.prototype,"setCursor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Io=Object(b.a)(Yr.prototype,"setMouseMoveIntoLinePlots",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),wo=Object(b.a)(Yr.prototype,"setSettingsTabId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),To=Object(b.a)(Yr.prototype,"setLineRegionSampleWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineRegionSampleWidth=e}}}),Object(b.a)(Yr.prototype,"isXProfile",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"isXProfile"),Yr.prototype),Object(b.a)(Yr.prototype,"isAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"isAutoScaledX"),Yr.prototype),Object(b.a)(Yr.prototype,"isAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"isAutoScaledY"),Yr.prototype),Object(b.a)(Yr.prototype,"stokesOptions",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"stokesOptions"),Yr.prototype),Object(b.a)(Yr.prototype,"fullCoordinate",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"fullCoordinate"),Yr.prototype),Object(b.a)(Yr.prototype,"isLineOrPolyline",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"isLineOrPolyline"),Yr.prototype),Object(b.a)(Yr.prototype,"effectivePolarization",[m.i],Object.getOwnPropertyDescriptor(Yr.prototype,"effectivePolarization"),Yr.prototype),Ro=Object(b.a)(Yr.prototype,"setPrimaryLineColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.primaryLineColor=e}}}),Ao=Object(b.a)(Yr.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_WIDTH&&e<=rO.MAX_WIDTH&&(this.lineWidth=e)}}}),Po=Object(b.a)(Yr.prototype,"setLinePlotPointSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_POINT_SIZE&&e<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(b.a)(Yr.prototype,"initXYBoundaries",[m.g],Object.getOwnPropertyDescriptor(Yr.prototype,"initXYBoundaries"),Yr.prototype),Eo=Object(b.a)(Yr.prototype,"setSelectedStokes",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedStokes=e}}}),Yr);var ko,Do,Lo,No,_o,zo,Vo,Wo,Go,Bo,qo,Ho,Yo,Uo,Xo,$o,Ko,Qo,Zo,Jo,es,ts,is,ns,rs,os,ss,as,ls,cs,ds,ps,hs,us,gs,fs,bs,ms,ys,Os,js;let xs,Ss,vs,Cs;!function(e){e[e.Checking=0]="Checking",e[e.Success=1]="Success",e[e.Failure=2]="Failure"}(xs||(xs={})),function(e){e.Range="Range",e.Center="Center"}(Ss||(Ss={})),function(e){e.GHz="GHz",e.MHz="MHz",e.CM="cm",e.MM="mm"}(vs||(vs={})),function(e){e.LineSelection="Line selection",e.Species="Species",e.ChemicalName="Chemical Name",e.ShiftedFrequency="Shifted Frequency",e.RestFrequencySPLA="Freq-MHz(rest frame,redshifted)",e.RestFrequency="Rest Frequency",e.RestFrequencyErrSPLA="Freq Err(rest frame,redshifted)",e.RestFrequencyErr="Rest Frequency Error",e.MeasuredFrequencySPLA="Meas Freq-MHz(rest frame,redshifted)",e.MeasuredFrequency="Measured Frequency",e.MeasuredFrequencyErrSPLA="Meas Freq Err(rest frame,redshifted)",e.MeasuredFrequencyErr="Measured Frequency Error",e.ResolvedQN="Resolved QNs",e.UnresolvedQNSPLA="Unresolved Quantum Numbers",e.UnresolvedQN="Unresolved QNs",e.IntensityCDMS="CDMS/JPL Intensity",e.IntensitySijm2SPLA="S<sub>ij</sub>&#956;<sup>2</sup> (D<sup>2</sup>)",e.IntensitySijm2="Sij \u03bc^2",e.IntensitySijSPLA="S<sub>ij</sub>",e.IntensitySij="Sij",e.IntensityAijSPLA="Log<sub>10</sub> (A<sub>ij</sub>)",e.IntensityAij="Log10(Aij)",e.IntensityLovas="Lovas/AST Intensity",e.EnergyLowerCM="E_L (cm^-1)",e.EnergyLowerK="E_L (K)",e.EnergyUpperCM="E_U (cm^-1)",e.EnergyUpperK="E_U (K)",e.LineList="Linelist"}(Cs||(Cs={}));const Is=new Map([[Cs.RestFrequencySPLA,Cs.RestFrequency],[Cs.RestFrequencyErrSPLA,Cs.RestFrequencyErr],[Cs.MeasuredFrequencySPLA,Cs.MeasuredFrequency],[Cs.MeasuredFrequencyErrSPLA,Cs.MeasuredFrequencyErr],[Cs.UnresolvedQNSPLA,Cs.UnresolvedQN],[Cs.IntensitySijm2SPLA,Cs.IntensitySijm2],[Cs.IntensitySijSPLA,Cs.IntensitySij],[Cs.IntensityAijSPLA,Cs.IntensityAij]]),ws=new Map([[Cs.LineSelection,"Column for line selection"],[Cs.Species,"Descriptive formula of molecular species"],[Cs.ChemicalName,"Common chemical name for species"],[Cs.ShiftedFrequency,"Shifted frequency according to the input velocity or redshift"],[Cs.RestFrequency,"Frequency at the rest frame"],[Cs.RestFrequencyErr,"Frequency error at the rest frame"],[Cs.MeasuredFrequency,"Frequency measured from laboratories"],[Cs.MeasuredFrequencyErr,"Frequency error measured from laboratories"],[Cs.ResolvedQN,"Rotational/rovibrational quantum numbers associated with the transition"],[Cs.UnresolvedQN,"Unresolved Quantum Numbers"],[Cs.IntensityCDMS,"Boltzmann-weighted logarithmic intensity of transition, given at 300 K"],[Cs.IntensitySijm2,"Dipole-weighted transition dipole matrix elements (Debye^2)"],[Cs.IntensitySij,"Line strength"],[Cs.IntensityAij,"Base-10 logarithm of the Einstein A coefficient (s^-1)"],[Cs.IntensityLovas,"Observed astronomical intensity for given transition"],[Cs.EnergyLowerCM,"Lower level energy in wave number"],[Cs.EnergyLowerK,"Lower level energy in K"],[Cs.EnergyUpperCM,"Upper level energy in wave number"],[Cs.EnergyUpperK,"Upper level energy in K"],[Cs.LineList,"Originated catalogue"]]),Ts=new Map([[Cs.LineSelection,50],[Cs.Species,100],[Cs.ChemicalName,150],[Cs.ShiftedFrequency,165],[Cs.RestFrequency,150],[Cs.RestFrequencyErr,180],[Cs.MeasuredFrequency,180],[Cs.MeasuredFrequencyErr,215],[Cs.ResolvedQN,150],[Cs.UnresolvedQN,150],[Cs.IntensityCDMS,180],[Cs.IntensitySijm2,100],[Cs.IntensitySij,100],[Cs.IntensityAij,120],[Cs.IntensityLovas,180],[Cs.EnergyLowerCM,120],[Cs.EnergyLowerK,120],[Cs.EnergyUpperCM,120],[Cs.EnergyUpperK,120],[Cs.LineList,100]]);let Rs;!function(e){e.V="Velocity (km/s)",e.Z="Redshift"}(Rs||(Rs={}));const As=-1;let Ps=(ko=m.g.bound,Do=class{setQueryResultTableRef(e){this.queryResultTableRef=e}setResultTableColumnWidth(e,t){this.controlHeader.get(t).columnWidth=e}get fullRowIndexes(){return Array.from(Array(this.numDataRows).keys())}get numVisibleRows(){return this.filteredRowIndexes.length}get redshiftFactor(){return this.redshiftType===Rs.V?Math.sqrt((1-1e3*this.redshiftInput/ui)/(1+1e3*this.redshiftInput/ui)):1/(this.redshiftInput+1)}get displayedColumnHeaders(){var e;let t=[];return null===(e=this.controlHeader)||void 0===e||e.forEach((e=>{var i;e.display&&e.dataIndex<(null===(i=this.columnHeaders)||void 0===i?void 0:i.length)&&t.push(this.columnHeaders[e.dataIndex])})),t}get numSelectedLines(){var e;const t=null===(e=this.queryResult.get(As))||void 0===e?void 0:e.data;if((null===t||void 0===t?void 0:t.length)<=0)return 0;let i=0;return null===t||void 0===t||t.forEach((e=>i+=e?1:0)),i}get filters(){let e=[];return this.controlHeader.forEach((t=>{t.filter&&e.push(t)})),e}get resultTableInfo(){const e=`Showing ${this.numDataRows} line(s).`,t=`Showing ${this.filteredRowIndexes.length} filtered line(s) of total ${this.numDataRows} line(s). Applied ${this.filterNum} filter(s).`,i=this.numSelectedLines>0?` Selected ${this.numSelectedLines} line(s).`:"";return(this.isDataFiltered?t:e)+i}get resultTableColumnWidths(){const e=[];return this.controlHeader.forEach((t=>{t.display&&e.push(t.columnWidth)})),e}getSelectedLines(){var e;const t=[],i=this.queryResult.get(0),n=this.queryResult.get(2),r=this.queryResult.get(7),o=null===(e=this.queryResult.get(As))||void 0===e?void 0:e.data;return null===o||void 0===o||o.forEach(((e,o)=>{e&&t.push({species:i.data[o],value:n.data[o]*this.redshiftFactor,qn:r.data[o]})})),t}constructor(){Object(f.a)(this,"splataloguePingStatus",Lo,this),Object(f.a)(this,"queryRangeType",No,this),Object(f.a)(this,"queryRange",_o,this),Object(f.a)(this,"queryRangeByCenter",zo,this),Object(f.a)(this,"queryUnit",Vo,this),Object(f.a)(this,"intensityLimitEnabled",Wo,this),Object(f.a)(this,"intensityLimitValue",Go,this),Object(f.a)(this,"isQuerying",Bo,this),Object(f.a)(this,"columnHeaders",qo,this),Object(f.a)(this,"redshiftType",Ho,this),Object(f.a)(this,"redshiftInput",Yo,this),Object(f.a)(this,"queryResultTableRef",Uo,this),Object(f.a)(this,"queryResult",Xo,this),Object(f.a)(this,"filterResult",$o,this),Object(f.a)(this,"filteredRowIndexes",Ko,this),Object(f.a)(this,"isDataFiltered",Qo,this),Object(f.a)(this,"filterNum",Zo,this),Object(f.a)(this,"numDataRows",Jo,this),Object(f.a)(this,"selectedSpectralProfilerID",es,this),Object(f.a)(this,"controlHeader",ts,this),this.shiftedFreqColumnRawData=void 0,Object(f.a)(this,"setQueryRangeType",is,this),Object(f.a)(this,"setQueryRange",ns,this),Object(f.a)(this,"setQueryRangeByCenter",rs,this),Object(f.a)(this,"setQueryUnit",os,this),Object(f.a)(this,"toggleIntensityLimit",ss,this),Object(f.a)(this,"setIntensityLimitValue",as,this),Object(f.a)(this,"setHeaderDisplay",ls,this),Object(f.a)(this,"setRedshiftType",cs,this),Object(f.a)(this,"setRedshiftInput",ds,this),Object(f.a)(this,"applyShiftFactor",ps,this),Object(f.a)(this,"selectSingleLine",hs,this),Object(f.a)(this,"setSelectedSpectralProfiler",us,this),Object(f.a)(this,"updateFilterResult",gs,this),Object(f.a)(this,"resetQueryContents",fs,this),Object(f.a)(this,"query",bs,this),Object(f.a)(this,"setColumnFilter",ms,this),Object(f.a)(this,"filter",ys,this),Object(f.a)(this,"resetFilter",Os,this),this.preprocessHeaders=e=>{let t=[];return null===e||void 0===e||e.forEach((e=>{const i=Is.has(e.name)?Is.get(e.name):e.name;t.push(new Nt.CatalogHeader({name:i,dataType:e.dataType,columnIndex:e.columnIndex,description:ws.get(i)}))})),t.splice(0,0,new Nt.CatalogHeader({name:Cs.LineSelection,dataType:Nt.ColumnType.Bool,columnIndex:As,description:ws.get(Cs.LineSelection)})),t.sort(((e,t)=>e.columnIndex-t.columnIndex))},this.initColumnData=(e,t,i)=>{var n,r;const o=$m.ProcessCatalogData(e),s=new Array(t).fill(!1);o.set(As,{dataType:Nt.ColumnType.Bool,data:s});const a=null===(n=o.get(2))||void 0===n?void 0:n.data,l=null===(r=o.get(5))||void 0===r?void 0:r.data,c=null===a||void 0===a?void 0:a.map(((e,t)=>{let i=parseFloat(e);return!isFinite(i)&&t<(null===l||void 0===l?void 0:l.length)&&(i=parseFloat(l[t])),isFinite(i)?i:void 0}));return o.set(2,{dataType:Nt.ColumnType.Double,data:c}),i.forEach((e=>{if(e.dataType===Nt.ColumnType.Double){const t=o.get(e.columnIndex);t.dataType=Nt.ColumnType.Double,t.data=t.data}})),o},this.initControlHeader=e=>{const t=new Map;return null===e||void 0===e||e.forEach(((e,i)=>{var n;const r={columnIndex:e.columnIndex,dataIndex:i,display:!0,filter:"",columnWidth:null!==(n=Ts.get(e.name))&&void 0!==n?n:150};t.set(e.name,r)})),t},this.calculateFreqMHz=(e,t)=>{if(isFinite(e)&&null!==e&&!(e<0)&&t)return t===vs.CM?xi(e/100)/1e6:t===vs.MM?xi(e/1e3)/1e6:t===vs.GHz?1e3*e:t===vs.MHz?e:void 0},Object(f.a)(this,"pingSplatalogue",js,this),Object(m.p)(this),this.splataloguePingStatus=xs.Checking,this.queryRangeType=Ss.Range,this.queryRange=[0,0],this.queryRangeByCenter=[0,0],this.queryUnit=vs.MHz,this.intensityLimitEnabled=!0,this.intensityLimitValue=-5,this.isQuerying=!1,this.redshiftType=Rs.V,this.redshiftInput=0,this.queryResultTableRef=void 0,this.selectedSpectralProfilerID=gC.Instance.widgetsStore.spectralProfilerList.length>0?gC.Instance.widgetsStore.spectralProfilerList[0]:void 0,this.resetQueryContents(),this.pingSplatalogue(),Object(m.h)((()=>{gC.Instance.widgetsStore.getSpectralWidgetStoreByID(this.selectedSpectralProfilerID)||(this.selectedSpectralProfilerID=gC.Instance.widgetsStore.spectralProfilerList.length>0?gC.Instance.widgetsStore.spectralProfilerList[0]:void 0)}))}},Lo=Object(b.a)(Do.prototype,"splataloguePingStatus",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),No=Object(b.a)(Do.prototype,"queryRangeType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_o=Object(b.a)(Do.prototype,"queryRange",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zo=Object(b.a)(Do.prototype,"queryRangeByCenter",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vo=Object(b.a)(Do.prototype,"queryUnit",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wo=Object(b.a)(Do.prototype,"intensityLimitEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Go=Object(b.a)(Do.prototype,"intensityLimitValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=Object(b.a)(Do.prototype,"isQuerying",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qo=Object(b.a)(Do.prototype,"columnHeaders",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=Object(b.a)(Do.prototype,"redshiftType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Object(b.a)(Do.prototype,"redshiftInput",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uo=Object(b.a)(Do.prototype,"queryResultTableRef",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xo=Object(b.a)(Do.prototype,"queryResult",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=Object(b.a)(Do.prototype,"filterResult",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=Object(b.a)(Do.prototype,"filteredRowIndexes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=Object(b.a)(Do.prototype,"isDataFiltered",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zo=Object(b.a)(Do.prototype,"filterNum",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jo=Object(b.a)(Do.prototype,"numDataRows",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),es=Object(b.a)(Do.prototype,"selectedSpectralProfilerID",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ts=Object(b.a)(Do.prototype,"controlHeader",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is=Object(b.a)(Do.prototype,"setQueryRangeType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRangeType=e}}}),ns=Object(b.a)(Do.prototype,"setQueryRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRange=e}}}),rs=Object(b.a)(Do.prototype,"setQueryRangeByCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRangeByCenter=e}}}),os=Object(b.a)(Do.prototype,"setQueryUnit",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryUnit=e}}}),ss=Object(b.a)(Do.prototype,"toggleIntensityLimit",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.intensityLimitEnabled=!this.intensityLimitEnabled}}}),as=Object(b.a)(Do.prototype,"setIntensityLimitValue",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.intensityLimitValue=e}}}),ls=Object(b.a)(Do.prototype,"setHeaderDisplay",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.controlHeader.get(t).display=e}}}),cs=Object(b.a)(Do.prototype,"setRedshiftType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.redshiftType=e,e===Rs.Z&&this.redshiftInput<0&&(this.redshiftInput=0)}}}),ds=Object(b.a)(Do.prototype,"setRedshiftInput",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{isFinite(e)&&(this.redshiftInput=e),this.applyShiftFactor()}}}),ps=Object(b.a)(Do.prototype,"applyShiftFactor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.shiftedFreqColumnRawData.map((e=>isFinite(e)?e*this.redshiftFactor:void 0));this.filterResult.set(2,{dataType:Nt.ColumnType.Double,data:e})}}}),Object(b.a)(Do.prototype,"setQueryResultTableRef",[m.g],Object.getOwnPropertyDescriptor(Do.prototype,"setQueryResultTableRef"),Do.prototype),hs=Object(b.a)(Do.prototype,"selectSingleLine",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t,i;const n=null===(t=this.filterResult)||void 0===t||null===(i=t.get(As))||void 0===i?void 0:i.data;if((null===n||void 0===n?void 0:n.length)>0&&isFinite(e)&&e>=0&&e<(null===n||void 0===n?void 0:n.length)){const t=n[e],i=this.filteredRowIndexes[e];n[e]=this.queryResult.get(As).data[i]=!t}}}}),us=Object(b.a)(Do.prototype,"setSelectedSpectralProfiler",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedSpectralProfilerID=e}}}),gs=Object(b.a)(Do.prototype,"updateFilterResult",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{let t=new Map;(null===e||void 0===e?void 0:e.length)===this.numDataRows?(this.queryResult.forEach(((e,i)=>{t.set(i,e)})),this.filterResult=t):(this.queryResult.forEach(((i,n)=>{let r=[];e.forEach((e=>{e>=0&&e<i.data.length&&r.push(i.data[e])})),t.set(n,{dataType:i.dataType,data:r})})),this.filterResult=t),this.filteredRowIndexes=e,this.shiftedFreqColumnRawData=this.filterResult.get(2).data,this.applyShiftFactor()}}}),fs=Object(b.a)(Do.prototype,"resetQueryContents",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.queryResult=new Map,this.filterResult=new Map,this.columnHeaders=[],this.filteredRowIndexes=[],this.shiftedFreqColumnRawData=[],this.numDataRows=0,this.controlHeader=new Map,this.isDataFiltered=!1,this.filterNum=0}}}),bs=Object(b.a)(Do.prototype,"query",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{let e=0,t=0;this.queryRangeType===Ss.Range?(e=this.queryRange[0],t=this.queryRange[1]):(e=this.queryRangeByCenter[0]-this.queryRangeByCenter[1],t=this.queryRangeByCenter[0]+this.queryRangeByCenter[1]);const i=this.calculateFreqMHz(e,this.queryUnit),n=this.calculateFreqMHz(t,this.queryUnit),r=gC.Instance.alertStore;if(!isFinite(i)||!isFinite(n)||i<0||n<0)return void r.showAlert("Invalid frequency range.");if(i===n)return void r.showAlert("Please specify a frequency range.");if(Math.abs(n-i)>2e4)return void r.showAlert(`Frequency range ${i<=n?i:n} MHz to ${i<=n?n:i} MHz is too wide.Please specify a frequency range within 20 GHz.`);this.isQuerying=!0;const o=tx.Instance;try{const e=await o.requestSpectralLine(new Nt.DoubleBounds({min:i,max:n}),this.intensityLimitEnabled?this.intensityLimitValue:NaN);e.dataSize>=0?Object(m.t)((()=>{this.numDataRows=e.dataSize,this.columnHeaders=this.preprocessHeaders(e.headers),this.controlHeader=this.initControlHeader(this.columnHeaders),this.queryResult=this.initColumnData(e.spectralLineData,e.dataSize,this.columnHeaders),this.updateFilterResult(this.fullRowIndexes),this.isDataFiltered=!1,this.filterNum=0})):this.resetQueryContents()}catch(s){this.resetQueryContents(),r.showAlert(s)}this.isQuerying=!1}}}),ms=Object(b.a)(Do.prototype,"setColumnFilter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{if(!this.controlHeader.has(t))return;const i=this.controlHeader.get(t),n={columnIndex:i.columnIndex,dataIndex:i.dataIndex,display:i.display,filter:e,columnWidth:i.columnWidth};this.controlHeader.set(t,n)}}}),ys=Object(b.a)(Do.prototype,"filter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e=this.fullRowIndexes,t=0;this.controlHeader.forEach((i=>{const n=i.filter;if(""!==n){const r=this.queryResult.get(i.columnIndex),o=r.dataType,s=r.data;o===Nt.ColumnType.Double?e=function(e,t,i){if((null===e||void 0===e?void 0:e.length)<=0||(null===t||void 0===t?void 0:t.length)<=0||!i)return[];const n=an(i);if(void 0===(null===n||void 0===n?void 0:n.operator)||(null===n||void 0===n?void 0:n.values.length)<=0)return[];let r;if(n.operator===Nt.ComparisonOperator.Equal&&1===n.values.length)r=e=>e-n.values[0]===0;else if(n.operator===Nt.ComparisonOperator.NotEqual&&1===n.values.length)r=e=>e-n.values[0]!==0;else if(n.operator===Nt.ComparisonOperator.Lesser&&1===n.values.length)r=e=>e<n.values[0];else if(n.operator===Nt.ComparisonOperator.LessorOrEqual&&1===n.values.length)r=e=>e<=n.values[0];else if(n.operator===Nt.ComparisonOperator.Greater&&1===n.values.length)r=e=>e>n.values[0];else if(n.operator===Nt.ComparisonOperator.GreaterOrEqual&&1===n.values.length)r=e=>e>=n.values[0];else if(n.operator===Nt.ComparisonOperator.RangeOpen&&2===n.values.length){const e=Math.min(n.values[0],n.values[1]),t=Math.max(n.values[0],n.values[1]);r=i=>i>=e&&i<=t}else{if(n.operator!==Nt.ComparisonOperator.RangeClosed||2!==n.values.length)return[];{const e=Math.min(n.values[0],n.values[1]),t=Math.max(n.values[0],n.values[1]);r=i=>i>e&&i<t}}let o=[];return t.forEach((t=>{t>=0&&t<e.length&&r(e[t])&&o.push(t)})),o}(s,e,n):o===Nt.ColumnType.Bool?e=function(e,t,i){var n;if((null===e||void 0===e?void 0:e.length)<=0||(null===t||void 0===t?void 0:t.length)<=0||!i)return[];let r=[];const o=null===i||void 0===i||null===(n=i.trim())||void 0===n?void 0:n.toLowerCase();"t"===o||"true"===o?t.forEach((t=>{t>=0&&t<e.length&&e[t]&&r.push(t)})):"f"!==o&&"false"!==o||t.forEach((t=>{t>=0&&t<e.length&&!e[t]&&r.push(t)}));return r}(s,e,n):o===Nt.ColumnType.String&&(e=function(e,t,i){if((null===e||void 0===e?void 0:e.length)<=0||(null===t||void 0===t?void 0:t.length)<=0||!i)return[];let n=[];return t.forEach((t=>{var r;t>=0&&t<e.length&&(null===(r=e[t])||void 0===r?void 0:r.includes(i))&&n.push(t)})),n}(s,e,n)),t++}})),this.updateFilterResult(e),this.isDataFiltered=!0,this.filterNum=t}}}),Os=Object(b.a)(Do.prototype,"resetFilter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.controlHeader.forEach((e=>{e.filter=""})),this.isDataFiltered&&this.updateFilterResult(this.fullRowIndexes),this.isDataFiltered=!1,this.filterNum=0}}}),Object(b.a)(Do.prototype,"setResultTableColumnWidth",[ko],Object.getOwnPropertyDescriptor(Do.prototype,"setResultTableColumnWidth"),Do.prototype),Object(b.a)(Do.prototype,"fullRowIndexes",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"fullRowIndexes"),Do.prototype),Object(b.a)(Do.prototype,"numVisibleRows",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"numVisibleRows"),Do.prototype),Object(b.a)(Do.prototype,"redshiftFactor",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"redshiftFactor"),Do.prototype),Object(b.a)(Do.prototype,"displayedColumnHeaders",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"displayedColumnHeaders"),Do.prototype),Object(b.a)(Do.prototype,"numSelectedLines",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"numSelectedLines"),Do.prototype),Object(b.a)(Do.prototype,"filters",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"filters"),Do.prototype),Object(b.a)(Do.prototype,"resultTableInfo",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"resultTableInfo"),Do.prototype),Object(b.a)(Do.prototype,"resultTableColumnWidths",[m.i],Object.getOwnPropertyDescriptor(Do.prototype,"resultTableColumnWidths"),Do.prototype),js=Object(b.a)(Do.prototype,"pingSplatalogue",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{try{this.splataloguePingStatus=xs.Checking;const e=await tx.Instance.pingSplatalogue();this.splataloguePingStatus=(null===e||void 0===e?void 0:e.success)?xs.Success:xs.Failure}catch(e){this.splataloguePingStatus=xs.Failure,gC.Instance.alertStore.showAlert(`${e}`),console.error(e)}}}}),Do);var Es,Ms,Fs;let ks=(Es=class extends Hr{get effectivePolarization(){var e;return"z"===this.coordinate?null===(e=this.effectiveFrame)||void 0===e?void 0:e.requiredPolarization:er[this.coordinate.substring(0,this.coordinate.length-1)]}constructor(){super(qr.CLOSED),Object(f.a)(this,"coordinate",Ms,this),Object(f.a)(this,"setCoordinate",Fs,this),Object(m.p)(this),this.coordinate="z"}static CalculateRequirementsMap(e){const t=new Map;return e.forEach((e=>{const i=e.effectiveFrame;if(!i||!i.regionSet)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=e.coordinate,s=i.regionSet.regions.find((e=>e.regionId===r));if(-1===r||s&&s.isClosedRegion){let e=t.get(n);e||(e=new Map,t.set(n,e));let i=e.get(r);i||(i=new Nt.SetStatsRequirements({fileId:n,regionId:r}),e.set(r,i)),i.statsConfigs||(i.statsConfigs=[]),i.statsConfigs.find((e=>e.coordinate===o))||i.statsConfigs.push({coordinate:o,statsTypes:gC.DEFAULT_STATS_TYPES})}})),t}static DiffStatsRequirements(e,t){const i=[];return e.forEach(((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach(((e,t)=>{let r=n.get(t);r||(r=new Nt.SetStatsRequirements({fileId:i,regionId:t,statsConfigs:[]}),n.set(t,r))}))})),t.forEach(((t,n)=>{let r=e.get(n);r?t.forEach(((e,t)=>{let n=r.get(t);if(n){const t=n.statsConfigs?n.statsConfigs.length:0,r=e.statsConfigs?e.statsConfigs.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.statsConfigs.sort(((e,t)=>e.coordinate>t.coordinate?1:-1)),s=n.statsConfigs.sort(((e,t)=>e.coordinate>t.coordinate?1:-1));for(let n=0;n<r;n++){const t=o[n],r=s[n];if(t.coordinate!==r.coordinate)return void i.push(e)}}else i.push(e)})):t.forEach((e=>i.push(e)))})),i.sort(((e,t)=>e.statsConfigs.length>t.statsConfigs.length?1:-1))}},Ms=Object(b.a)(Es.prototype,"coordinate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fs=Object(b.a)(Es.prototype,"setCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==tr.indexOf(e)&&(this.coordinate=e)}}}),Object(b.a)(Es.prototype,"effectivePolarization",[m.i],Object.getOwnPropertyDescriptor(Es.prototype,"effectivePolarization"),Es.prototype),Es);var Ds,Ls,Ns,_s,zs,Vs,Ws,Gs,Bs,qs,Hs,Ys,Us,Xs,$s,Ks,Qs,Zs,Js,ea,ta,ia,na,ra,oa,sa,aa,la,ca,da;let pa=(Ds=class extends Hr{get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}get effectivePolarization(){var e;return"z"===this.coordinate?null===(e=this.effectiveFrame)||void 0===e?void 0:e.requiredPolarization:er[this.coordinate.substring(0,this.coordinate.length-1)]}static CalculateRequirementsMap(e){const t=new Map;return e.forEach((e=>{const i=e.effectiveFrame;if(!i||!i.regionSet)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=e.coordinate,s=i.regionSet.regions.find((e=>e.regionId===r));if(-1===r||s&&s.isClosedRegion){let e=t.get(n);e||(e=new Map,t.set(n,e));let i=e.get(r);i||(i=new Nt.SetHistogramRequirements({fileId:n,regionId:r}),e.set(r,i)),i.histograms||(i.histograms=[]),i.histograms.find((e=>e.coordinate===o))||i.histograms.push({coordinate:o,channel:-1,numBins:-1})}})),t}static DiffHistoRequirements(e,t){const i=[];return e.forEach(((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach(((e,t)=>{let r=n.get(t);r||(r=new Nt.SetHistogramRequirements({fileId:i,regionId:t,histograms:[]}),n.set(t,r))}))})),t.forEach(((t,n)=>{let r=e.get(n);r?t.forEach(((e,t)=>{let n=r.get(t);if(n){const t=n.histograms?n.histograms.length:0,r=e.histograms?e.histograms.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.histograms.sort(((e,t)=>e.coordinate>t.coordinate?1:-1)),s=n.histograms.sort(((e,t)=>e.coordinate>t.coordinate?1:-1));for(let n=0;n<r;n++){const t=o[n],r=s[n];if(t.coordinate!==r.coordinate)return void i.push(e)}}else i.push(e)})):t.forEach((e=>i.push(e)))})),i.sort(((e,t)=>e.histograms.length>t.histograms.length?1:-1))}constructor(){super(qr.CLOSED),Object(f.a)(this,"coordinate",Ls,this),Object(f.a)(this,"minX",Ns,this),Object(f.a)(this,"maxX",_s,this),Object(f.a)(this,"minY",zs,this),Object(f.a)(this,"maxY",Vs,this),Object(f.a)(this,"cursorX",Ws,this),Object(f.a)(this,"isMouseMoveIntoLinePlots",Gs,this),Object(f.a)(this,"logScaleY",Bs,this),Object(f.a)(this,"plotType",qs,this),Object(f.a)(this,"primaryLineColor",Hs,this),Object(f.a)(this,"lineWidth",Ys,this),Object(f.a)(this,"linePlotPointSize",Us,this),Object(f.a)(this,"meanRmsVisible",Xs,this),Object(f.a)(this,"linePlotInitXYBoundaries",$s,this),Object(f.a)(this,"setCoordinate",Ks,this),Object(f.a)(this,"setXBounds",Qs,this),Object(f.a)(this,"clearXBounds",Zs,this),Object(f.a)(this,"setYBounds",Js,this),Object(f.a)(this,"clearYBounds",ea,this),Object(f.a)(this,"setXYBounds",ta,this),Object(f.a)(this,"clearXYBounds",ia,this),Object(f.a)(this,"setLogScale",na,this),Object(f.a)(this,"setPlotType",ra,this),Object(f.a)(this,"setCursor",oa,this),Object(f.a)(this,"setMouseMoveIntoLinePlots",sa,this),Object(f.a)(this,"setPrimaryLineColor",aa,this),Object(f.a)(this,"setLineWidth",la,this),Object(f.a)(this,"setLinePlotPointSize",ca,this),Object(f.a)(this,"setMeanRmsVisible",da,this),this.init=e=>{if(!e)return;(je()(e.primaryLineColor).isValid()||Qb(e.primaryLineColor))&&(this.primaryLineColor=e.primaryLineColor),"number"===typeof e.lineWidth&&e.lineWidth>=rO.MIN_WIDTH&&e.lineWidth<=rO.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=rO.MIN_POINT_SIZE&&e.linePlotPointSize<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.logScaleY&&(this.logScaleY=e.logScaleY),"string"!==typeof e.plotType||e.plotType!==oO.STEPS&&e.plotType!==oO.LINES&&e.plotType!==oO.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,logScaleY:this.logScaleY,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(m.p)(this),this.logScaleY=!0,this.plotType=oO.STEPS,this.primaryLineColor="auto-blue",this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.coordinate="z"}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ls=Object(b.a)(Ds.prototype,"coordinate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ns=Object(b.a)(Ds.prototype,"minX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_s=Object(b.a)(Ds.prototype,"maxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=Object(b.a)(Ds.prototype,"minY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vs=Object(b.a)(Ds.prototype,"maxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ws=Object(b.a)(Ds.prototype,"cursorX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gs=Object(b.a)(Ds.prototype,"isMouseMoveIntoLinePlots",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bs=Object(b.a)(Ds.prototype,"logScaleY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qs=Object(b.a)(Ds.prototype,"plotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hs=Object(b.a)(Ds.prototype,"primaryLineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ys=Object(b.a)(Ds.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Us=Object(b.a)(Ds.prototype,"linePlotPointSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xs=Object(b.a)(Ds.prototype,"meanRmsVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$s=Object(b.a)(Ds.prototype,"linePlotInitXYBoundaries",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ks=Object(b.a)(Ds.prototype,"setCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==tr.indexOf(e)&&(this.clearXYBounds(),this.coordinate=e)}}}),Qs=Object(b.a)(Ds.prototype,"setXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),Zs=Object(b.a)(Ds.prototype,"clearXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Js=Object(b.a)(Ds.prototype,"setYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),ea=Object(b.a)(Ds.prototype,"clearYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),ta=Object(b.a)(Ds.prototype,"setXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),ia=Object(b.a)(Ds.prototype,"clearXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),na=Object(b.a)(Ds.prototype,"setLogScale",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logScaleY=e}}}),ra=Object(b.a)(Ds.prototype,"setPlotType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),oa=Object(b.a)(Ds.prototype,"setCursor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),sa=Object(b.a)(Ds.prototype,"setMouseMoveIntoLinePlots",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),Object(b.a)(Ds.prototype,"isAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(Ds.prototype,"isAutoScaledX"),Ds.prototype),Object(b.a)(Ds.prototype,"isAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(Ds.prototype,"isAutoScaledY"),Ds.prototype),Object(b.a)(Ds.prototype,"effectivePolarization",[m.i],Object.getOwnPropertyDescriptor(Ds.prototype,"effectivePolarization"),Ds.prototype),aa=Object(b.a)(Ds.prototype,"setPrimaryLineColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.primaryLineColor=e}}}),la=Object(b.a)(Ds.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_WIDTH&&e<=rO.MAX_WIDTH&&(this.lineWidth=e)}}}),ca=Object(b.a)(Ds.prototype,"setLinePlotPointSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_POINT_SIZE&&e<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),da=Object(b.a)(Ds.prototype,"setMeanRmsVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),Object(b.a)(Ds.prototype,"initXYBoundaries",[m.g],Object.getOwnPropertyDescriptor(Ds.prototype,"initXYBoundaries"),Ds.prototype),Ds);class ha{}var ua,ga,fa,ba,ma,ya,Oa,ja,xa,Sa,va,Ca,Ia,wa,Ta,Ra,Aa,Pa,Ea,Ma,Fa,ka,Da,La,Na,_a,za,Va,Wa,Ga,Ba,qa=i(41);let Ha=(ua=class{constructor(){Object(f.a)(this,"type",ga,this),Object(f.a)(this,"lineColor",fa,this),Object(f.a)(this,"selectedLine",ba,this),Object(f.a)(this,"lineType",ma,this),Object(f.a)(this,"lineWidth",ya,this),Object(f.a)(this,"pointRadius",Oa,this),Object(f.a)(this,"isOverlayOn",ja,this),Object(f.a)(this,"boxcarSize",xa,this),Object(f.a)(this,"gaussianSigma",Sa,this),Object(f.a)(this,"hanningSize",va,this),Object(f.a)(this,"decimationWidth",Ca,this),Object(f.a)(this,"binWidth",Ia,this),Object(f.a)(this,"savitzkyGolaySize",wa,this),Object(f.a)(this,"savitzkyGolayOrder",Ta,this),Object(f.a)(this,"colorMap",Ra,this),Object(f.a)(this,"setType",Aa,this),Object(f.a)(this,"setLineColor",Pa,this),Object(f.a)(this,"setSelectedLine",Ea,this),Object(f.a)(this,"setLineType",Ma,this),Object(f.a)(this,"setLineWidth",Fa,this),Object(f.a)(this,"setPointRadius",ka,this),Object(f.a)(this,"setIsOverlayOn",Da,this),Object(f.a)(this,"setBoxcarSize",La,this),Object(f.a)(this,"setGaussianSigma",Na,this),Object(f.a)(this,"setHanningSize",_a,this),Object(f.a)(this,"setDecimationWidth",za,this),Object(f.a)(this,"setBinWidth",Va,this),Object(f.a)(this,"setSavitzkyGolaySize",Wa,this),Object(f.a)(this,"setSavitzkyGolayOrder",Ga,this),Object(f.a)(this,"setColorMap",Ba,this),Object(m.p)(this),this.type=GO.NONE,this.lineColor="auto-rose",this.lineType=oO.STEPS,this.lineWidth=1,this.pointRadius=1,this.isOverlayOn=!1,this.boxcarSize=2,this.gaussianSigma=1,this.hanningSize=3,this.decimationWidth=3,this.binWidth=2,this.savitzkyGolaySize=5,this.savitzkyGolayOrder=0,this.colorMap=new Map}get exportData(){let e=new Map;return e.set("smooth",this.type),this.type===GO.BOXCAR?e.set("kernel",String(this.boxcarSize)):this.type===GO.GAUSSIAN?e.set("sigma",String(this.gaussianSigma)):this.type===GO.HANNING?e.set("kernel",String(this.hanningSize)):this.type===GO.DECIMATION?e.set("decimation width",String(this.decimationWidth)):this.type===GO.BINNING?e.set("bin width",String(this.binWidth)):this.type===GO.SAVITZKY_GOLAY&&(e.set("kernel",String(this.savitzkyGolaySize)),e.set("order",String(this.savitzkyGolayOrder))),e}get comments(){var e;let t=[];return null===(e=this.exportData)||void 0===e||e.forEach(((e,i)=>t.push(`${i}: ${e}`))),t}get gaussianKernel(){if(this.gaussianSigma<3)return 3;const e=Math.ceil(this.gaussianSigma);return e%2===0?e+1:e}get gaussianAlpha(){return(this.gaussianKernel-1)/(2*this.gaussianSigma)}getLocalStartEndIndexes(e,t,i,n){let r,o;n%2===1?(r=(n-1)/2,o=(n-1)/2):(r=n/2-1,o=n/2);const s=t<r?t:r;return{startSmoothing:t<r?0:t-r,endSmoothing:i+o>e-1?e-1:i+o,smoothedStart:s,smoothedEnd:s+i-t}}getLocalGroupStartEndIndexes(e,t,i,n){let r=i%n===n-1?i:i-i%n+(n-1);return r>e-1&&(r=e-1),{firstIndex:t%n===0?t:t-t%n,lastIndex:r}}getSmoothingValues(e,t,i,n){let r,o=e;if(this.type===GO.BOXCAR)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.boxcarSize),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=qa.boxcarSmooth(a,this.boxcarSize).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=qa.boxcarSmooth(t,this.boxcarSize);else if(this.type===GO.GAUSSIAN){if(this.gaussianSigma&&this.gaussianSigma>=1)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.gaussianKernel),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=qa.gaussianSmooth(a,this.gaussianKernel,this.gaussianAlpha).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=qa.gaussianSmooth(t,this.gaussianKernel,this.gaussianAlpha)}else if(this.type===GO.HANNING)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.hanningSize),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=qa.hanningSmooth(a,this.hanningSize).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=qa.hanningSmooth(t,this.hanningSize);else if(this.type===GO.DECIMATION)if((i||0===n)&&n){const s=this.getLocalGroupStartEndIndexes(e.length,i,n,this.decimationWidth),a=t.subarray(s.firstIndex,s.lastIndex+1),l=e.slice(s.firstIndex,s.lastIndex+1);let c=qa.decimation(l,a,this.decimationWidth);o=c.x,r=c.y}else{let i=qa.decimation(e,t,this.decimationWidth);o=i.x,r=i.y}else if(this.type===GO.BINNING)if((i||0===n)&&n){const s=this.getLocalGroupStartEndIndexes(e.length,i,n,this.binWidth),a=t.subarray(s.firstIndex,s.lastIndex+1),l=e.slice(s.firstIndex,s.lastIndex+1);o=qa.binning(l,this.binWidth),r=qa.binning(a,this.binWidth)}else o=qa.binning(e,this.binWidth),r=qa.binning(t,this.binWidth);else if(this.type===GO.SAVITZKY_GOLAY)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.savitzkyGolaySize),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=qa.savitzkyGolaySmooth(e,a,this.savitzkyGolaySize,this.savitzkyGolayOrder).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=qa.savitzkyGolaySmooth(e,t,this.savitzkyGolaySize,this.savitzkyGolayOrder);return{x:o,y:r}}getSmoothingPoint2DArray(e,t,i,n){if(this.type===GO.NONE)return[];const r=this.getSmoothingValues(e,t,i,n);let o=new Array(r.x.length);for(let s=0;s<r.x.length;s++)o[s]={x:r.x[s],y:r.y[s]};return o}getDecimatedPoint2DArray(e,t,i,n,r){if(!e||!t||e.length!==t.length)return[];let o;if((n||0===r)&&r){const s=this.getLocalGroupStartEndIndexes(e.length,n,r,i),a=t.subarray(s.firstIndex,s.lastIndex+1),l=e.slice(s.firstIndex,s.lastIndex+1);o=qa.decimation(l,a,i)}else o=qa.decimation(e,t,i);let s=new Array(o.x.length);for(let a=0;a<o.x.length;a++)s[a]={x:o.x[a],y:o.y[a]};return s}},ga=Object(b.a)(ua.prototype,"type",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa=Object(b.a)(ua.prototype,"lineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ba=Object(b.a)(ua.prototype,"selectedLine",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ma=Object(b.a)(ua.prototype,"lineType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya=Object(b.a)(ua.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oa=Object(b.a)(ua.prototype,"pointRadius",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ja=Object(b.a)(ua.prototype,"isOverlayOn",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xa=Object(b.a)(ua.prototype,"boxcarSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sa=Object(b.a)(ua.prototype,"gaussianSigma",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),va=Object(b.a)(ua.prototype,"hanningSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ca=Object(b.a)(ua.prototype,"decimationWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ia=Object(b.a)(ua.prototype,"binWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wa=Object(b.a)(ua.prototype,"savitzkyGolaySize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ta=Object(b.a)(ua.prototype,"savitzkyGolayOrder",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ra=Object(b.a)(ua.prototype,"colorMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aa=Object(b.a)(ua.prototype,"setType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.type=e}}}),Pa=Object(b.a)(ua.prototype,"setLineColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineColor=e}}}),Ea=Object(b.a)(ua.prototype,"setSelectedLine",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedLine=e}}}),Ma=Object(b.a)(ua.prototype,"setLineType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineType=e}}}),Fa=Object(b.a)(ua.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_WIDTH&&e<=rO.MAX_WIDTH&&(this.lineWidth=e)}}}),ka=Object(b.a)(ua.prototype,"setPointRadius",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_POINT_SIZE&&e<=rO.MAX_POINT_SIZE&&(this.pointRadius=e)}}}),Da=Object(b.a)(ua.prototype,"setIsOverlayOn",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isOverlayOn=e}}}),La=Object(b.a)(ua.prototype,"setBoxcarSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.boxcarSize=e}}}),Na=Object(b.a)(ua.prototype,"setGaussianSigma",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.gaussianSigma=e}}}),_a=Object(b.a)(ua.prototype,"setHanningSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hanningSize=e}}}),za=Object(b.a)(ua.prototype,"setDecimationWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.decimationWidth=e}}}),Va=Object(b.a)(ua.prototype,"setBinWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.binWidth=e}}}),Wa=Object(b.a)(ua.prototype,"setSavitzkyGolaySize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.savitzkyGolaySize=e}}}),Ga=Object(b.a)(ua.prototype,"setSavitzkyGolayOrder",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.savitzkyGolayOrder=e}}}),Ba=Object(b.a)(ua.prototype,"setColorMap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.colorMap.set(e,t)}}}),Object(b.a)(ua.prototype,"exportData",[m.i],Object.getOwnPropertyDescriptor(ua.prototype,"exportData"),ua.prototype),Object(b.a)(ua.prototype,"comments",[m.i],Object.getOwnPropertyDescriptor(ua.prototype,"comments"),ua.prototype),Object(b.a)(ua.prototype,"gaussianKernel",[m.i],Object.getOwnPropertyDescriptor(ua.prototype,"gaussianKernel"),ua.prototype),Object(b.a)(ua.prototype,"gaussianAlpha",[m.i],Object.getOwnPropertyDescriptor(ua.prototype,"gaussianAlpha"),ua.prototype),ua);var Ya,Ua,Xa,$a,Ka,Qa,Za,Ja,el,tl,il,nl,rl,ol,sl,al,ll,cl,dl,pl,hl,ul,gl,fl,bl,ml,yl,Ol,jl,xl,Sl,vl,Cl,Il,wl,Tl,Rl,Al,Pl,El,Ml,Fl,kl,Dl,Ll,Nl,_l,zl,Vl,Wl,Gl,Bl,ql,Hl,Yl,Ul,Xl,$l,Kl,Ql,Zl,Jl,ec,tc,ic,nc,rc,oc,sc,ac,lc,cc;let dc;!function(e){e.CurrentZ="z",e.TotalIntensity="Iz",e.LinearPolarizationQ="Qz",e.LinearPolarizationU="Uz",e.CircularPolarization="Vz",e.PolarizedIntensity="PIz",e.PolarizationAngle="PAz",e.PolarizationQU="QvsU"}(dc||(dc={}));const pc=!1,hc=[],uc="auto-blue",gc="auto-orange",fc=1,bc=1.5,mc=3,yc=!0,Oc="jet",jc=1,xc=!1;let Sc=(cc=lc=class e extends Hr{static requiredCoordinate(t){let i=e.requestDataType,n=i.indexOf(dc.TotalIntensity);return t.fractionalPolVisible&&n<0&&i.push(dc.TotalIntensity),i}static addToRequirementsMap(t,i){return i.forEach((i=>{const n=i.effectiveFrame;if(n&&n.hasStokes){const r=n.frameInfo.fileId,o=i.effectiveRegionId,s=e.requiredCoordinate(i);let a=i.statsType;if(!n.regionSet)return;const l=n.regionSet.regions.find((e=>e.regionId===o));if(l){l.regionType===Nt.RegionType.POINT&&(a=Nt.StatsType.Sum);let e=t.get(r);e||(e=new Map,t.set(r,e));let i=e.get(o);i||(i=new Nt.SetSpectralRequirements({regionId:o,fileId:r}),e.set(o,i)),i.spectralProfiles||(i.spectralProfiles=[]),s.forEach((e=>{let t=i.spectralProfiles.find((t=>t.coordinate===e));t?-1===t.statsTypes.indexOf(a)&&t.statsTypes.push(a):i.spectralProfiles.push({coordinate:e,statsTypes:[a]})}))}}})),t}setRegionId(e,t){this.regionIdMap.set(e,t),this.clearLinePlotsXYBounds(),this.clearScatterPlotXYBounds()}constructor(){super(qr.CLOSED_AND_POINT),Object(f.a)(this,"sharedMinX",Ua,this),Object(f.a)(this,"sharedMaxX",Xa,this),Object(f.a)(this,"quMinY",$a,this),Object(f.a)(this,"quMaxY",Ka,this),Object(f.a)(this,"polIntensityMinY",Qa,this),Object(f.a)(this,"polIntensityMaxY",Za,this),Object(f.a)(this,"polAngleMinY",Ja,this),Object(f.a)(this,"polAngleMaxY",el,this),Object(f.a)(this,"quScatterMinX",tl,this),Object(f.a)(this,"quScatterMaxX",il,this),Object(f.a)(this,"quScatterMinY",nl,this),Object(f.a)(this,"quScatterMaxY",rl,this),Object(f.a)(this,"linePlotcursorX",ol,this),Object(f.a)(this,"channel",sl,this),Object(f.a)(this,"scatterPlotCursorX",al,this),Object(f.a)(this,"scatterPlotCursorY",ll,this),Object(f.a)(this,"isMouseMoveIntoScatterPlots",cl,this),Object(f.a)(this,"isMouseMoveIntoLinePlots",dl,this),Object(f.a)(this,"scatterChartArea",pl,this),Object(f.a)(this,"statsType",hl,this),Object(f.a)(this,"fractionalPolVisible",ul,this),this.scatterOutRangePointsZIndex=void 0,Object(f.a)(this,"plotType",gl,this),Object(f.a)(this,"primaryLineColor",fl,this),Object(f.a)(this,"secondaryLineColor",bl,this),Object(f.a)(this,"lineWidth",ml,this),Object(f.a)(this,"linePlotPointSize",yl,this),Object(f.a)(this,"scatterPlotPointSize",Ol,this),Object(f.a)(this,"equalAxes",jl,this),Object(f.a)(this,"colorMap",xl,this),Object(f.a)(this,"colorPixel",Sl,this),Object(f.a)(this,"pointTransparency",vl,this),Object(f.a)(this,"invertedColorMap",Cl,this),this.smoothingStore=void 0,Object(f.a)(this,"settingsTabId",Il,this),Object(f.a)(this,"setScatterChartAres",wl,this),Object(f.a)(this,"setMouseMoveIntoScatterPlots",Tl,this),Object(f.a)(this,"setMouseMoveIntoLinePlots",Rl,this),Object(f.a)(this,"setStatsType",Al,this),Object(f.a)(this,"setSpectralCoordinate",Pl,this),Object(f.a)(this,"setSpectralSystem",El,this),Object(f.a)(this,"setSharedXBounds",Ml,this),Object(f.a)(this,"clearSharedXBounds",Fl,this),Object(f.a)(this,"setPolIntensityYBounds",kl,this),Object(f.a)(this,"clearPolIntensityYBounds",Dl,this),Object(f.a)(this,"setChannel",Ll,this),Object(f.a)(this,"setlinePlotCursorX",Nl,this),Object(f.a)(this,"setScatterPlotCursor",_l,this),Object(f.a)(this,"setFractionalPolVisible",zl,this),Object(f.a)(this,"setQUScatterPlotXBounds",Vl,this),Object(f.a)(this,"setPolAngleYBounds",Wl,this),Object(f.a)(this,"setQULinePlotYBounds",Gl,this),Object(f.a)(this,"setQUScatterPlotYBounds",Bl,this),Object(f.a)(this,"clearLinePlotsXYBounds",ql,this),Object(f.a)(this,"clearScatterPlotXYBounds",Hl,this),Object(f.a)(this,"clearXYBounds",Yl,this),Object(f.a)(this,"setQULinePlotsXYBounds",Ul,this),Object(f.a)(this,"setPolIntensityXYBounds",Xl,this),Object(f.a)(this,"setPolAngleXYBounds",$l,this),Object(f.a)(this,"setQUScatterPlotXYBounds",Kl,this),Object(f.a)(this,"setInvertedColorMap",Ql,this),Object(f.a)(this,"setPlotType",Zl,this),Object(f.a)(this,"setPrimaryLineColor",Jl,this),Object(f.a)(this,"setSecondaryLineColor",ec,this),Object(f.a)(this,"setLineWidth",tc,this),Object(f.a)(this,"setLinePlotPointSize",ic,this),Object(f.a)(this,"setScatterPlotPointSize",nc,this),Object(f.a)(this,"setEqualAxesValue",rc,this),Object(f.a)(this,"setColormap",oc,this),Object(f.a)(this,"setPointTransparency",sc,this),Object(f.a)(this,"setSettingsTabId",ac,this),this.init=e=>{if(!e)return;(je()(e.primaryLineColor).isValid()||Qb(e.primaryLineColor))&&(this.primaryLineColor=e.primaryLineColor);(je()(e.secondaryLineColor).isValid()||Qb(e.secondaryLineColor))&&(this.secondaryLineColor=e.secondaryLineColor),"number"===typeof e.lineWidth&&e.lineWidth>=rO.MIN_WIDTH&&e.lineWidth<=rO.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=rO.MIN_POINT_SIZE&&e.linePlotPointSize<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"string"!==typeof e.plotType||e.plotType!==oO.STEPS&&e.plotType!==oO.LINES&&e.plotType!==oO.POINTS||(this.plotType=e.plotType),"string"===typeof e.colorMap&&(this.colorMap=e.colorMap),"number"===typeof e.scatterPlotPointSize&&e.scatterPlotPointSize>=zO.MIN_POINT_SIZE&&e.scatterPlotPointSize<=zO.MAX_POINT_SIZE&&(this.scatterPlotPointSize=e.scatterPlotPointSize),"number"===typeof e.pointTransparency&&e.pointTransparency>=zO.MIN_TRANSPARENCY&&e.pointTransparency<=zO.MAX_TRANSPARENCY&&(this.pointTransparency=e.pointTransparency),"boolean"===typeof e.equalAxes&&(this.equalAxes=e.equalAxes)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor,secondaryLineColor:this.secondaryLineColor,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,plotType:this.plotType,colorMap:this.colorMap,scatterPlotPointSize:this.scatterPlotPointSize,pointTransparency:this.pointTransparency,equalAxes:this.equalAxes}),Object(m.p)(this),this.colorMap=Oc,this.colorPixel=Kb(Oc),this.statsType=Nt.StatsType.Mean,this.plotType=oO.STEPS,this.fractionalPolVisible=pc,this.scatterOutRangePointsZIndex=hc,this.primaryLineColor=uc,this.secondaryLineColor=gc,this.lineWidth=fc,this.linePlotPointSize=bc,this.scatterPlotPointSize=mc,this.equalAxes=yc,this.pointTransparency=jc,this.smoothingStore=new Ha,this.settingsTabId=lH.CONVERSION,this.invertedColorMap=xc}get isLinePlotsAutoScaledX(){return void 0===this.sharedMinX||void 0===this.sharedMaxX}get isQUScatterPlotAutoScaledX(){return void 0===this.quScatterMinX||void 0===this.quScatterMaxX}get isQUScatterPlotAutoScaledY(){return void 0===this.quScatterMinY||void 0===this.quScatterMaxY}get isQULinePlotAutoScaledY(){return void 0===this.quMinY||void 0===this.quMaxY}get isPolIntensityAutoScaledY(){return void 0===this.polIntensityMinY||void 0===this.polIntensityMaxY}get isPolAngleAutoScaledY(){return void 0===this.polAngleMinY||void 0===this.polAngleMaxY}},lc.requestDataType=[dc.LinearPolarizationQ,dc.LinearPolarizationU],lc.ValidStatsTypes=[Nt.StatsType.Mean],Ya=cc,Ua=Object(b.a)(Ya.prototype,"sharedMinX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xa=Object(b.a)(Ya.prototype,"sharedMaxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$a=Object(b.a)(Ya.prototype,"quMinY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ka=Object(b.a)(Ya.prototype,"quMaxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qa=Object(b.a)(Ya.prototype,"polIntensityMinY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Za=Object(b.a)(Ya.prototype,"polIntensityMaxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ja=Object(b.a)(Ya.prototype,"polAngleMinY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),el=Object(b.a)(Ya.prototype,"polAngleMaxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tl=Object(b.a)(Ya.prototype,"quScatterMinX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),il=Object(b.a)(Ya.prototype,"quScatterMaxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nl=Object(b.a)(Ya.prototype,"quScatterMinY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rl=Object(b.a)(Ya.prototype,"quScatterMaxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol=Object(b.a)(Ya.prototype,"linePlotcursorX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sl=Object(b.a)(Ya.prototype,"channel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),al=Object(b.a)(Ya.prototype,"scatterPlotCursorX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ll=Object(b.a)(Ya.prototype,"scatterPlotCursorY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cl=Object(b.a)(Ya.prototype,"isMouseMoveIntoScatterPlots",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dl=Object(b.a)(Ya.prototype,"isMouseMoveIntoLinePlots",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pl=Object(b.a)(Ya.prototype,"scatterChartArea",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hl=Object(b.a)(Ya.prototype,"statsType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ul=Object(b.a)(Ya.prototype,"fractionalPolVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gl=Object(b.a)(Ya.prototype,"plotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fl=Object(b.a)(Ya.prototype,"primaryLineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=Object(b.a)(Ya.prototype,"secondaryLineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ml=Object(b.a)(Ya.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yl=Object(b.a)(Ya.prototype,"linePlotPointSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ol=Object(b.a)(Ya.prototype,"scatterPlotPointSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jl=Object(b.a)(Ya.prototype,"equalAxes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xl=Object(b.a)(Ya.prototype,"colorMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sl=Object(b.a)(Ya.prototype,"colorPixel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vl=Object(b.a)(Ya.prototype,"pointTransparency",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cl=Object(b.a)(Ya.prototype,"invertedColorMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Il=Object(b.a)(Ya.prototype,"settingsTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wl=Object(b.a)(Ya.prototype,"setScatterChartAres",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scatterChartArea=e}}}),Tl=Object(b.a)(Ya.prototype,"setMouseMoveIntoScatterPlots",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoScatterPlots=e}}}),Rl=Object(b.a)(Ya.prototype,"setMouseMoveIntoLinePlots",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),Al=Object(b.a)(Ya.prototype,"setStatsType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==Sc.ValidStatsTypes.indexOf(e)&&(this.statsType=e)}}}),Pl=Object(b.a)(Ya.prototype,"setSpectralCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.effectiveFrame.setSpectralCoordinate(e)&&this.clearSharedXBounds()}}}),El=Object(b.a)(Ya.prototype,"setSpectralSystem",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.effectiveFrame.setSpectralSystem(e)&&this.clearSharedXBounds()}}}),Ml=Object(b.a)(Ya.prototype,"setSharedXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.sharedMinX=e,this.sharedMaxX=t}}}),Fl=Object(b.a)(Ya.prototype,"clearSharedXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sharedMinX=void 0,this.sharedMaxX=void 0}}}),kl=Object(b.a)(Ya.prototype,"setPolIntensityYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.polIntensityMinY=e,this.polIntensityMaxY=t}}}),Dl=Object(b.a)(Ya.prototype,"clearPolIntensityYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.polIntensityMinY=void 0,this.polIntensityMaxY=void 0}}}),Ll=Object(b.a)(Ya.prototype,"setChannel",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channel=e}}}),Nl=Object(b.a)(Ya.prototype,"setlinePlotCursorX",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.linePlotcursorX=e}}}),_l=Object(b.a)(Ya.prototype,"setScatterPlotCursor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scatterPlotCursorX=e.x,this.scatterPlotCursorY=e.y}}}),zl=Object(b.a)(Ya.prototype,"setFractionalPolVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fractionalPolVisible=e,this.clearScatterPlotXYBounds()}}}),Object(b.a)(Ya.prototype,"setRegionId",[m.r],Object.getOwnPropertyDescriptor(Ya.prototype,"setRegionId"),Ya.prototype),Vl=Object(b.a)(Ya.prototype,"setQUScatterPlotXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quScatterMinX=e,this.quScatterMaxX=t}}}),Wl=Object(b.a)(Ya.prototype,"setPolAngleYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.polAngleMinY=e,this.polAngleMaxY=t}}}),Gl=Object(b.a)(Ya.prototype,"setQULinePlotYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quMinY=e,this.quMaxY=t}}}),Bl=Object(b.a)(Ya.prototype,"setQUScatterPlotYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quScatterMinY=e,this.quScatterMaxY=t}}}),ql=Object(b.a)(Ya.prototype,"clearLinePlotsXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sharedMinX=void 0,this.sharedMaxX=void 0,this.quMinY=void 0,this.quMaxY=void 0,this.polIntensityMinY=void 0,this.polIntensityMaxY=void 0,this.polAngleMinY=void 0,this.polAngleMaxY=void 0}}}),Hl=Object(b.a)(Ya.prototype,"clearScatterPlotXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.quScatterMinX=void 0,this.quScatterMaxX=void 0,this.quScatterMinY=void 0,this.quScatterMaxY=void 0,this.scatterOutRangePointsZIndex=[]}}}),Yl=Object(b.a)(Ya.prototype,"clearXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearLinePlotsXYBounds(),this.clearScatterPlotXYBounds()}}}),Ul=Object(b.a)(Ya.prototype,"setQULinePlotsXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.quMinY=i,this.quMaxY=n}}}),Xl=Object(b.a)(Ya.prototype,"setPolIntensityXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.polIntensityMinY=i,this.polIntensityMaxY=n}}}),$l=Object(b.a)(Ya.prototype,"setPolAngleXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.polAngleMinY=i,this.polAngleMaxY=n}}}),Kl=Object(b.a)(Ya.prototype,"setQUScatterPlotXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.quScatterMinX=e,this.quScatterMaxX=t,this.quScatterMinY=i,this.quScatterMaxY=n}}}),Ql=Object(b.a)(Ya.prototype,"setInvertedColorMap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.invertedColorMap=e}}}),Zl=Object(b.a)(Ya.prototype,"setPlotType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),Jl=Object(b.a)(Ya.prototype,"setPrimaryLineColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.primaryLineColor=e}}}),ec=Object(b.a)(Ya.prototype,"setSecondaryLineColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryLineColor=e}}}),tc=Object(b.a)(Ya.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_WIDTH&&e<=rO.MAX_WIDTH&&(this.lineWidth=e)}}}),ic=Object(b.a)(Ya.prototype,"setLinePlotPointSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_POINT_SIZE&&e<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),nc=Object(b.a)(Ya.prototype,"setScatterPlotPointSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=zO.MIN_POINT_SIZE&&e<=zO.MAX_POINT_SIZE&&(this.scatterPlotPointSize=e)}}}),rc=Object(b.a)(Ya.prototype,"setEqualAxesValue",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.equalAxes=e}}}),oc=Object(b.a)(Ya.prototype,"setColormap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorMap=e,this.colorPixel=Kb(e)}}}),sc=Object(b.a)(Ya.prototype,"setPointTransparency",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=zO.MIN_TRANSPARENCY&&e<=zO.MAX_TRANSPARENCY&&(this.pointTransparency=e)}}}),ac=Object(b.a)(Ya.prototype,"setSettingsTabId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(b.a)(Ya.prototype,"isLinePlotsAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(Ya.prototype,"isLinePlotsAutoScaledX"),Ya.prototype),Object(b.a)(Ya.prototype,"isQUScatterPlotAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(Ya.prototype,"isQUScatterPlotAutoScaledX"),Ya.prototype),Object(b.a)(Ya.prototype,"isQUScatterPlotAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(Ya.prototype,"isQUScatterPlotAutoScaledY"),Ya.prototype),Object(b.a)(Ya.prototype,"isQULinePlotAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(Ya.prototype,"isQULinePlotAutoScaledY"),Ya.prototype),Object(b.a)(Ya.prototype,"isPolIntensityAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(Ya.prototype,"isPolIntensityAutoScaledY"),Ya.prototype),Object(b.a)(Ya.prototype,"isPolAngleAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(Ya.prototype,"isPolAngleAutoScaledY"),Ya.prototype),Ya);var vc,Cc,Ic,wc,Tc,Rc,Ac,Pc,Ec,Mc,Fc,kc,Dc,Lc,Nc,_c,zc,Vc,Wc,Gc,Bc,qc,Hc,Yc,Uc,Xc,$c,Kc,Qc,Zc,Jc,ed,td,id,nd,rd,od,sd,ad,ld,cd,dd,pd,hd,ud,gd,fd,bd,md,yd,Od,jd;let xd,Sd,vd;!function(e){e.ImageOverlay="Image Overlay",e.Histogram="Histogram",e.D2Scatter="2D Scatter"}(xd||(xd={})),function(e){e[e.BOX_LINED=1]="BOX_LINED",e[e.CIRCLE_FILLED=2]="CIRCLE_FILLED",e[e.CIRCLE_LINED=3]="CIRCLE_LINED",e[e.HEXAGON_LINED=5]="HEXAGON_LINED",e[e.RHOMB_LINED=7]="RHOMB_LINED",e[e.TRIANGLE_LINED_UP=9]="TRIANGLE_LINED_UP",e[e.ELLIPSE_LINED=11]="ELLIPSE_LINED",e[e.TRIANGLE_LINED_DOWN=13]="TRIANGLE_LINED_DOWN",e[e.HEXAGON_LINED_2=15]="HEXAGON_LINED_2",e[e.CROSS_FILLED=16]="CROSS_FILLED",e[e.CROSS_LINED=17]="CROSS_LINED",e[e.X_FILLED=18]="X_FILLED",e[e.X_LINED=19]="X_LINED",e[e.LineSegment_FILLED=20]="LineSegment_FILLED"}(Sd||(Sd={})),function(e){e[e.GLOBAL=0]="GLOBAL",e[e.STYLING=1]="STYLING",e[e.COLOR=2]="COLOR",e[e.SIZE=3]="SIZE",e[e.ORIENTATION=4]="ORIENTATION",e[e.SIZE_MAJOR=5]="SIZE_MAJOR",e[e.SIZE_MINOR=6]="SIZE_MINOR"}(vd||(vd={}));let Cd=(jd=Od=class e{constructor(t){this.OverlayShapeSettings=new Map([[Sd.BOX_LINED,{featherWidth:.35,diameterBase:1.5,areaBase:100,thicknessBase:1.5}],[Sd.CIRCLE_FILLED,{featherWidth:.35,diameterBase:1.5,areaBase:70,thicknessBase:1}],[Sd.CIRCLE_LINED,{featherWidth:.5,diameterBase:1.5,areaBase:70,thicknessBase:1}],[Sd.ELLIPSE_LINED,{featherWidth:-1,diameterBase:8,areaBase:100,thicknessBase:1.5}],[Sd.HEXAGON_LINED,{featherWidth:.35,diameterBase:0,areaBase:50,thicknessBase:1.3}],[Sd.RHOMB_LINED,{featherWidth:.35,diameterBase:1.5,areaBase:100,thicknessBase:1.5}],[Sd.TRIANGLE_LINED_UP,{featherWidth:.35,diameterBase:0,areaBase:20,thicknessBase:2}],[Sd.TRIANGLE_LINED_DOWN,{featherWidth:.35,diameterBase:0,areaBase:20,thicknessBase:2}],[Sd.HEXAGON_LINED_2,{featherWidth:.35,diameterBase:0,areaBase:50,thicknessBase:1.3}],[Sd.CROSS_FILLED,{featherWidth:.5,diameterBase:3.5,areaBase:150,thicknessBase:1}],[Sd.X_FILLED,{featherWidth:.5,diameterBase:3.5,areaBase:150,thicknessBase:1}],[Sd.LineSegment_FILLED,{featherWidth:.35,diameterBase:3,areaBase:100,thicknessBase:1}]]),Object(f.a)(this,"catalogFileId",Cc,this),Object(f.a)(this,"headerTableColumnWidts",Ic,this),Object(f.a)(this,"dataTableColumnWidts",wc,this),Object(f.a)(this,"showSelectedData",Tc,this),Object(f.a)(this,"catalogTableAutoScroll",Rc,this),Object(f.a)(this,"catalogPlotType",Ac,this),Object(f.a)(this,"catalogSize",Pc,this),Object(f.a)(this,"catalogColor",Ec,this),Object(f.a)(this,"catalogShape",Mc,this),Object(f.a)(this,"xAxis",Fc,this),Object(f.a)(this,"yAxis",kc,this),Object(f.a)(this,"tableSeparatorPosition",Dc,this),Object(f.a)(this,"highlightColor",Lc,this),Object(f.a)(this,"settingsTabId",Nc,this),Object(f.a)(this,"thickness",_c,this),Object(f.a)(this,"sizeMapColumn",zc,this),Object(f.a)(this,"sizeColumnMax",Vc,this),Object(f.a)(this,"sizeColumnMin",Wc,this),Object(f.a)(this,"sizeMax",Gc,this),Object(f.a)(this,"sizeMin",Bc,this),Object(f.a)(this,"sizeArea",qc,this),Object(f.a)(this,"sizeScalingType",Hc,this),Object(f.a)(this,"sizeAxisTabId",Yc,this),Object(f.a)(this,"sizeColumnMinLocked",Uc,this),Object(f.a)(this,"sizeColumnMaxLocked",Xc,this),Object(f.a)(this,"sizeMinorMapColumn",$c,this),Object(f.a)(this,"sizeMinorColumnMax",Kc,this),Object(f.a)(this,"sizeMinorColumnMin",Qc,this),Object(f.a)(this,"sizeMinorArea",Zc,this),Object(f.a)(this,"sizeMinorScalingType",Jc,this),Object(f.a)(this,"sizeMinorColumnMinLocked",ed,this),Object(f.a)(this,"sizeMinorColumnMaxLocked",td,this),Object(f.a)(this,"colorMapColumn",id,this),Object(f.a)(this,"colorColumnMax",nd,this),Object(f.a)(this,"colorColumnMin",rd,this),Object(f.a)(this,"colorMap",od,this),Object(f.a)(this,"colorScalingType",sd,this),Object(f.a)(this,"invertedColorMap",ad,this),Object(f.a)(this,"orientationMapColumn",ld,this),Object(f.a)(this,"orientationMax",cd,this),Object(f.a)(this,"orientationMin",dd,this),Object(f.a)(this,"orientationScalingType",pd,this),Object(f.a)(this,"angleMax",hd,this),Object(f.a)(this,"angleMin",ud,this),Object(f.a)(this,"toggleSizeColumnMinLock",gd,this),Object(f.a)(this,"toggleSizeColumnMaxLock",fd,this),Object(f.a)(this,"toggleSizeMinorColumnMinLock",bd,this),Object(f.a)(this,"toggleSizeMinorColumnMaxLock",md,this),Object(f.a)(this,"setSettingsTabId",yd,this),this.init=t=>{if(!t)return;const i=t.catalogFileId;"number"===typeof i&&i>0&&(this.catalogFileId=i);const n=t.catalogSize;"number"===typeof n&&n>=e.MinOverlaySize&&n<=e.MaxOverlaySize&&(this.catalogSize=n),this.catalogShape=t.catalogShape,this.catalogColor=t.catalogColor,this.highlightColor=t.highlightColor,this.tableSeparatorPosition=t.tableSeparatorPosition,this.thickness=t.thickness},this.toConfig=()=>({catalogFileId:this.catalogFileId,catalogColor:this.catalogColor,highlightColor:this.highlightColor,catalogSize:this.catalogSize,catalogShape:this.catalogShape,tableSeparatorPosition:this.tableSeparatorPosition,thickness:this.thickness}),Object(m.p)(this),this.catalogFileId=t,this.headerTableColumnWidts=[150,75,65,100,230],this.showSelectedData=!1,this.catalogTableAutoScroll=!1,this.catalogPlotType=xd.ImageOverlay,this.catalogColor=L.a.TURQUOISE3,this.catalogSize=10,this.catalogShape=Sd.CIRCLE_LINED,this.xAxis=Un.NONE,this.yAxis=Un.NONE,this.tableSeparatorPosition=JA.Instance.catalogTableSeparatorPosition,this.highlightColor=L.a.RED2,this.settingsTabId=vd.SIZE,this.thickness=2,this.sizeMapColumn=Un.NONE,this.sizeArea=!1,this.sizeScalingType=Rf.LINEAR,this.sizeMin={area:100,diameter:5},this.sizeMax={area:200,diameter:20},this.sizeColumnMin={default:void 0,clipd:void 0},this.sizeColumnMax={default:void 0,clipd:void 0},this.sizeAxisTabId=vd.SIZE_MAJOR,this.sizeMinorMapColumn=Un.NONE,this.sizeMinorArea=!1,this.sizeMinorScalingType=Rf.LINEAR,this.sizeMinorColumnMin={default:void 0,clipd:void 0},this.sizeMinorColumnMax={default:void 0,clipd:void 0},this.colorMapColumn=Un.NONE,this.colorColumnMax={default:void 0,clipd:void 0},this.colorColumnMin={default:void 0,clipd:void 0},this.colorMap="viridis",this.colorScalingType=Rf.LINEAR,this.invertedColorMap=!1,this.orientationMapColumn=Un.NONE,this.orientationMax={default:void 0,clipd:void 0},this.orientationMin={default:void 0,clipd:void 0},this.orientationScalingType=Rf.LINEAR,this.angleMax=360,this.angleMin=e.MinAngle,this.sizeColumnMinLocked=!1,this.sizeColumnMaxLocked=!1,this.sizeMinorColumnMinLocked=!1,this.sizeMinorColumnMaxLocked=!1,Object(m.s)((()=>this.sizeMapData),(e=>{const t=Qi(e);this.setSizeColumnMin(isFinite(t.minVal)?t.minVal:0,"default"),this.setSizeColumnMax(isFinite(t.maxVal)?t.maxVal:0,"default")})),Object(m.s)((()=>this.sizeArray()),(e=>{e.length&&Tx.Instance.updateDataTexture(this.catalogFileId,e,Ix.Size)})),Object(m.s)((()=>this.sizeColumnMin.clipd),(e=>{this.sizeColumnMinLocked&&(this.sizeMinorColumnMin.clipd=e)})),Object(m.s)((()=>this.sizeColumnMax.clipd),(e=>{this.sizeColumnMaxLocked&&(this.sizeMinorColumnMax.clipd=e)})),Object(m.s)((()=>this.sizeMinorMapData),(e=>{const t=Qi(e);this.setSizeMinorColumnMin(isFinite(t.minVal)?t.minVal:0,"default"),this.setSizeMinorColumnMax(isFinite(t.maxVal)?t.maxVal:0,"default")})),Object(m.s)((()=>this.sizeMinorArray()),(e=>{e.length&&Tx.Instance.updateDataTexture(this.catalogFileId,e,Ix.SizeMinor)})),Object(m.s)((()=>this.sizeMinorColumnMin.clipd),(e=>{this.sizeMinorColumnMinLocked&&(this.sizeColumnMin.clipd=e)})),Object(m.s)((()=>this.sizeMinorColumnMax.clipd),(e=>{this.sizeMinorColumnMaxLocked&&(this.sizeColumnMax.clipd=e)})),Object(m.s)((()=>this.colorMapData),(e=>{const t=Qi(e);this.setColorColumnMin(isFinite(t.minVal)?t.minVal:0,"default"),this.setColorColumnMax(isFinite(t.maxVal)?t.maxVal:0,"default")})),Object(m.s)((()=>this.colorArray()),(e=>{e.length&&Tx.Instance.updateDataTexture(this.catalogFileId,e,Ix.Color)})),Object(m.s)((()=>this.orientationMapData),(e=>{const t=Qi(e);this.setOrientationMin(isFinite(t.minVal)?t.minVal:0,"default"),this.setOrientationMax(isFinite(t.maxVal)?t.maxVal:0,"default")})),Object(m.s)((()=>this.orientationArray()),(e=>{e.length&&Tx.Instance.updateDataTexture(this.catalogFileId,e,Ix.Orientation)}))}resetMaps(){this.sizeMapColumn=Un.NONE,this.sizeArea=!1,this.sizeScalingType=Rf.LINEAR,this.sizeMin={area:50,diameter:5},this.sizeMax={area:200,diameter:20},this.sizeColumnMin={default:void 0,clipd:void 0},this.sizeColumnMax={default:void 0,clipd:void 0},this.sizeAxisTabId=vd.SIZE_MAJOR,this.sizeColumnMinLocked=!1,this.sizeColumnMaxLocked=!1,this.sizeMinorMapColumn=Un.NONE,this.sizeMinorArea=!1,this.sizeMinorScalingType=Rf.LINEAR,this.sizeMinorColumnMin={default:void 0,clipd:void 0},this.sizeMinorColumnMax={default:void 0,clipd:void 0},this.sizeMinorColumnMinLocked=!1,this.sizeMinorColumnMaxLocked=!1,this.colorMapColumn=Un.NONE,this.colorColumnMax={default:void 0,clipd:void 0},this.colorColumnMin={default:void 0,clipd:void 0},this.colorMap="jet",this.colorScalingType=Rf.LINEAR,this.invertedColorMap=!1,this.orientationMapColumn=Un.NONE,this.orientationMax={default:void 0,clipd:void 0},this.orientationMin={default:void 0,clipd:void 0},this.orientationScalingType=Rf.LINEAR,this.angleMax=e.MaxAngle,this.angleMin=e.MinAngle}setAngleMax(t){this.angleMax=Gi(t,e.MinAngle,e.MaxAngle)}setAngleMin(t){this.angleMin=Gi(t,e.MinAngle,e.MaxAngle)}setOrientationMax(e,t){"default"===t?(this.orientationMax.default=e,this.orientationMax.clipd=e):this.orientationMax.clipd=e}setOrientationMin(e,t){"default"===t?(this.orientationMin.default=e,this.orientationMin.clipd=e):this.orientationMin.clipd=e}resetOrientationValue(e){"min"===e?this.orientationMin.clipd=this.orientationMin.default:this.orientationMax.clipd=this.orientationMax.default}setOrientationMapColumn(e){this.orientationMapColumn!==e&&(this.orientationMapColumn=e,this.orientationMin={default:void 0,clipd:void 0},this.orientationMax={default:void 0,clipd:void 0})}setOrientationScalingType(e){this.orientationScalingType=e}setColorMapDirection(e){this.invertedColorMap=e}setColorColumnMax(e,t){"default"===t?(this.colorColumnMax.default=e,this.colorColumnMax.clipd=e):this.colorColumnMax.clipd=e}setColorColumnMin(e,t){"default"===t?(this.colorColumnMin.default=e,this.colorColumnMin.clipd=e):this.colorColumnMin.clipd=e}resetColorColumnValue(e){"min"===e?this.colorColumnMin.clipd=this.colorColumnMin.default:this.colorColumnMax.clipd=this.colorColumnMax.default}setColorMapColumn(e){this.colorMapColumn!==e&&(this.colorMapColumn=e,this.colorColumnMin={default:void 0,clipd:void 0},this.colorColumnMax={default:void 0,clipd:void 0})}setColorScalingType(e){this.colorScalingType=e}setColorMap(e){this.colorMap=e}setSizeMax(e){let t=this.sizeArea;this.sizeAxisTabId===vd.SIZE_MINOR&&(t=this.sizeMinorArea),t?this.sizeMax.area=e:this.sizeMax.diameter=e}setSizeMin(e){let t=this.sizeArea;this.sizeAxisTabId===vd.SIZE_MINOR&&(t=this.sizeMinorArea),t?this.sizeMin.area=e:this.sizeMin.diameter=e}setSizeColumnMax(e,t){"default"===t?(this.sizeColumnMax.default=e,this.sizeColumnMax.clipd=e):this.sizeColumnMax.clipd=e}setSizeColumnMin(e,t){"default"===t?(this.sizeColumnMin.default=e,this.sizeColumnMin.clipd=e):this.sizeColumnMin.clipd=e}resetSizeColumnValue(e){"min"===e?this.sizeColumnMin.clipd=this.sizeColumnMin.default:this.sizeColumnMax.clipd=this.sizeColumnMax.default}setSizeScalingType(e){this.sizeScalingType=e}setSizeArea(e){this.sizeArea=e}setSizeMap(e){this.sizeMapColumn!==e&&(this.sizeMapColumn=e,this.sizeColumnMin={default:void 0,clipd:void 0},this.sizeColumnMax={default:void 0,clipd:void 0},e===Un.NONE&&(this.sizeArea=!1,this.sizeColumnMinLocked=!1,this.sizeColumnMaxLocked=!1,this.sizeMinorColumnMinLocked=!1,this.sizeMinorColumnMaxLocked=!1,this.sizeMinorMapColumn=Un.NONE))}setSizeAxisTab(e){this.sizeAxisTabId=e}setSizeMinorColumnMax(e,t){"default"===t?(this.sizeMinorColumnMax.default=e,this.sizeMinorColumnMax.clipd=e):this.sizeMinorColumnMax.clipd=e}setSizeMinorColumnMin(e,t){"default"===t?(this.sizeMinorColumnMin.default=e,this.sizeMinorColumnMin.clipd=e):this.sizeMinorColumnMin.clipd=e}resetSizeMinorColumnValue(e){"min"===e?this.sizeMinorColumnMin.clipd=this.sizeMinorColumnMin.default:this.sizeMinorColumnMax.clipd=this.sizeMinorColumnMax.default}setSizeMinorScalingType(e){this.sizeMinorScalingType=e}setSizeMinorArea(e){this.sizeMinorArea=e}setSizeMinorMap(e){this.sizeMinorMapColumn!==e&&(this.sizeMinorMapColumn=e,this.sizeMinorColumnMin={default:void 0,clipd:void 0},this.sizeMinorColumnMax={default:void 0,clipd:void 0},e===Un.NONE&&(this.sizeMinorArea=!1,this.sizeMinorColumnMinLocked=!1,this.sizeMinorColumnMaxLocked=!1,this.sizeColumnMinLocked=!1,this.sizeColumnMaxLocked=!1))}setHeaderTableColumnWidts(e){this.headerTableColumnWidts=e}setDataTableColumnWidts(e){this.dataTableColumnWidts=e}setShowSelectedData(e){this.showSelectedData=e}setCatalogTableAutoScroll(e){this.catalogTableAutoScroll=e}setCatalogPlotType(e){this.catalogPlotType=e}setCatalogSize(t){t>=e.MinOverlaySize&&t<=e.MaxOverlaySize&&(this.catalogSize=t)}setCatalogColor(e){this.catalogColor=e}setCatalogShape(e){this.catalogShape=e,e!==Sd.ELLIPSE_LINED&&this.sizeAxisTabId===vd.SIZE_MINOR&&(this.sizeAxisTabId=vd.SIZE_MAJOR)}setxAxis(e){this.xAxis=e}setyAxis(e){this.yAxis=e}setTableSeparatorPosition(e){this.tableSeparatorPosition=e}setHighlightColor(e){this.highlightColor=e}setThickness(t){this.thickness=Gi(t,e.MinThickness,e.MaxThickness)}get orientationMapData(){const e=hM.Instance.catalogProfileStores.get(this.catalogFileId);if(!this.disableOrientationMap&&e){let t=e.get1DPlotData(this.orientationMapColumn).wcsData;return t?Float32Array.from(t):new Float32Array(0)}return new Float32Array(0)}orientationArray(){let e=this.orientationMapData;return!this.disableOrientationMap&&(null===e||void 0===e?void 0:e.length)&&void 0!==this.orientationMin.clipd&&void 0!==this.orientationMax.clipd?X.CalculateCatalogOrientation(e,this.orientationMin.clipd,this.orientationMax.clipd,this.angleMin,this.angleMax,this.orientationScalingType):new Float32Array(0)}get colorMapData(){const e=hM.Instance.catalogProfileStores.get(this.catalogFileId);if(!this.disableColorMap&&e){let t=e.get1DPlotData(this.colorMapColumn).wcsData;return t?Float32Array.from(t):new Float32Array(0)}return new Float32Array(0)}colorArray(){const e=this.colorMapData;return!this.disableColorMap&&(null===e||void 0===e?void 0:e.length)&&void 0!==this.colorColumnMin.clipd&&void 0!==this.colorColumnMax.clipd?X.CalculateCatalogColor(e,this.invertedColorMap,this.colorColumnMin.clipd,this.colorColumnMax.clipd,this.colorScalingType):new Float32Array(0)}get sizeMapData(){const e=hM.Instance.catalogProfileStores.get(this.catalogFileId);if(!this.disableSizeMap&&e){let t=e.get1DPlotData(this.sizeMapColumn).wcsData;return t?Float32Array.from(t):new Float32Array(0)}return new Float32Array(0)}get sizeMinorMapData(){const e=hM.Instance.catalogProfileStores.get(this.catalogFileId);if(!this.disableSizeMinorMap&&e){let t=e.get1DPlotData(this.sizeMinorMapColumn).wcsData;return t?Float32Array.from(t):new Float32Array(0)}return new Float32Array(0)}sizeArray(){let e=this.sizeMapData;if(!this.disableSizeMap&&(null===e||void 0===e?void 0:e.length)&&void 0!==this.sizeColumnMin.clipd&&void 0!==this.sizeColumnMax.clipd){const t=this.pointSizebyType;let i=this.sizeArea?this.shapeSettings.areaBase:this.shapeSettings.diameterBase;return X.CalculateCatalogSize(e,this.sizeColumnMin.clipd,this.sizeColumnMax.clipd,t.min+i,t.max+i,this.sizeScalingType,this.sizeArea,devicePixelRatio*gC.Instance.imageRatio)}return new Float32Array(0)}sizeMinorArray(){let e=this.sizeMinorMapData;if(!this.disableSizeMinorMap&&(null===e||void 0===e?void 0:e.length)&&void 0!==this.sizeMinorColumnMin.clipd&&void 0!==this.sizeMinorColumnMax.clipd){const t=this.minorPointSizebyType;let i=this.sizeMinorArea?this.shapeSettings.areaBase:this.shapeSettings.diameterBase;return X.CalculateCatalogSize(e,this.sizeMinorColumnMin.clipd,this.sizeMinorColumnMax.clipd,t.min+i,t.max+i,this.sizeMinorScalingType,this.sizeMinorArea,devicePixelRatio*gC.Instance.imageRatio)}return new Float32Array(0)}get disableSizeMap(){return this.sizeMapColumn===Un.NONE}get disableSizeMinorMap(){return this.sizeMinorMapColumn===Un.NONE}get enableSizeMinorTab(){return this.sizeMapColumn!==Un.NONE&&this.catalogShape===Sd.ELLIPSE_LINED}get maxPointSizebyType(){let t=this.sizeArea;return this.sizeAxisTabId===vd.SIZE_MINOR&&(t=this.sizeMinorArea),t?e.MaxAreaSize:e.MaxOverlaySize}get pointSizebyType(){return this.sizeArea?{min:this.sizeMin.area,max:this.sizeMax.area}:{min:this.sizeMin.diameter,max:this.sizeMax.diameter}}get minorPointSizebyType(){return this.sizeMinorArea?{min:this.sizeMin.area,max:this.sizeMax.area}:{min:this.sizeMin.diameter,max:this.sizeMax.diameter}}get sizeMajor(){return this.sizeAxisTabId===vd.SIZE_MAJOR}get disableColorMap(){return this.colorMapColumn===Un.NONE}get disableOrientationMap(){return this.orientationMapColumn===Un.NONE}get shapeSettings(){const e=this.sizeMajor?this.pointSizebyType:this.minorPointSizebyType,t=this.OverlayShapeSettings.get(this.catalogShape);return 0===e.min?{featherWidth:t.featherWidth,diameterBase:0,areaBase:0,thicknessBase:t.thicknessBase}:t}},Od.MinOverlaySize=1,Od.MaxOverlaySize=50,Od.MaxAreaSize=4e3,Od.MinTableSeparatorPosition=5,Od.MaxTableSeparatorPosition=95,Od.MinThickness=1,Od.MaxThickness=10,Od.MinAngle=0,Od.MaxAngle=720,Od.SizeMapMin=0,vc=jd,Cc=Object(b.a)(vc.prototype,"catalogFileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ic=Object(b.a)(vc.prototype,"headerTableColumnWidts",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wc=Object(b.a)(vc.prototype,"dataTableColumnWidts",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tc=Object(b.a)(vc.prototype,"showSelectedData",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rc=Object(b.a)(vc.prototype,"catalogTableAutoScroll",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ac=Object(b.a)(vc.prototype,"catalogPlotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pc=Object(b.a)(vc.prototype,"catalogSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ec=Object(b.a)(vc.prototype,"catalogColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mc=Object(b.a)(vc.prototype,"catalogShape",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fc=Object(b.a)(vc.prototype,"xAxis",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kc=Object(b.a)(vc.prototype,"yAxis",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dc=Object(b.a)(vc.prototype,"tableSeparatorPosition",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lc=Object(b.a)(vc.prototype,"highlightColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nc=Object(b.a)(vc.prototype,"settingsTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_c=Object(b.a)(vc.prototype,"thickness",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zc=Object(b.a)(vc.prototype,"sizeMapColumn",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vc=Object(b.a)(vc.prototype,"sizeColumnMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wc=Object(b.a)(vc.prototype,"sizeColumnMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gc=Object(b.a)(vc.prototype,"sizeMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bc=Object(b.a)(vc.prototype,"sizeMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qc=Object(b.a)(vc.prototype,"sizeArea",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hc=Object(b.a)(vc.prototype,"sizeScalingType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yc=Object(b.a)(vc.prototype,"sizeAxisTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uc=Object(b.a)(vc.prototype,"sizeColumnMinLocked",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xc=Object(b.a)(vc.prototype,"sizeColumnMaxLocked",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$c=Object(b.a)(vc.prototype,"sizeMinorMapColumn",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kc=Object(b.a)(vc.prototype,"sizeMinorColumnMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qc=Object(b.a)(vc.prototype,"sizeMinorColumnMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zc=Object(b.a)(vc.prototype,"sizeMinorArea",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jc=Object(b.a)(vc.prototype,"sizeMinorScalingType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ed=Object(b.a)(vc.prototype,"sizeMinorColumnMinLocked",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),td=Object(b.a)(vc.prototype,"sizeMinorColumnMaxLocked",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),id=Object(b.a)(vc.prototype,"colorMapColumn",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nd=Object(b.a)(vc.prototype,"colorColumnMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rd=Object(b.a)(vc.prototype,"colorColumnMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),od=Object(b.a)(vc.prototype,"colorMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sd=Object(b.a)(vc.prototype,"colorScalingType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ad=Object(b.a)(vc.prototype,"invertedColorMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ld=Object(b.a)(vc.prototype,"orientationMapColumn",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cd=Object(b.a)(vc.prototype,"orientationMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dd=Object(b.a)(vc.prototype,"orientationMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pd=Object(b.a)(vc.prototype,"orientationScalingType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hd=Object(b.a)(vc.prototype,"angleMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ud=Object(b.a)(vc.prototype,"angleMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(vc.prototype,"resetMaps",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"resetMaps"),vc.prototype),Object(b.a)(vc.prototype,"setAngleMax",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setAngleMax"),vc.prototype),Object(b.a)(vc.prototype,"setAngleMin",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setAngleMin"),vc.prototype),Object(b.a)(vc.prototype,"setOrientationMax",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setOrientationMax"),vc.prototype),Object(b.a)(vc.prototype,"setOrientationMin",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setOrientationMin"),vc.prototype),Object(b.a)(vc.prototype,"resetOrientationValue",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"resetOrientationValue"),vc.prototype),Object(b.a)(vc.prototype,"setOrientationMapColumn",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setOrientationMapColumn"),vc.prototype),Object(b.a)(vc.prototype,"setOrientationScalingType",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setOrientationScalingType"),vc.prototype),Object(b.a)(vc.prototype,"setColorMapDirection",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setColorMapDirection"),vc.prototype),Object(b.a)(vc.prototype,"setColorColumnMax",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setColorColumnMax"),vc.prototype),Object(b.a)(vc.prototype,"setColorColumnMin",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setColorColumnMin"),vc.prototype),Object(b.a)(vc.prototype,"resetColorColumnValue",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"resetColorColumnValue"),vc.prototype),Object(b.a)(vc.prototype,"setColorMapColumn",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setColorMapColumn"),vc.prototype),Object(b.a)(vc.prototype,"setColorScalingType",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setColorScalingType"),vc.prototype),Object(b.a)(vc.prototype,"setColorMap",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setColorMap"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMax",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMax"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMin",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMin"),vc.prototype),Object(b.a)(vc.prototype,"setSizeColumnMax",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeColumnMax"),vc.prototype),Object(b.a)(vc.prototype,"setSizeColumnMin",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeColumnMin"),vc.prototype),Object(b.a)(vc.prototype,"resetSizeColumnValue",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"resetSizeColumnValue"),vc.prototype),Object(b.a)(vc.prototype,"setSizeScalingType",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeScalingType"),vc.prototype),Object(b.a)(vc.prototype,"setSizeArea",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeArea"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMap",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMap"),vc.prototype),Object(b.a)(vc.prototype,"setSizeAxisTab",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeAxisTab"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMinorColumnMax",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMinorColumnMax"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMinorColumnMin",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMinorColumnMin"),vc.prototype),Object(b.a)(vc.prototype,"resetSizeMinorColumnValue",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"resetSizeMinorColumnValue"),vc.prototype),gd=Object(b.a)(vc.prototype,"toggleSizeColumnMinLock",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sizeColumnMinLocked=!this.sizeColumnMinLocked,this.sizeColumnMinLocked&&(this.sizeMinorColumnMin.clipd=this.sizeColumnMin.clipd)}}}),fd=Object(b.a)(vc.prototype,"toggleSizeColumnMaxLock",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sizeColumnMaxLocked=!this.sizeColumnMaxLocked,this.sizeColumnMaxLocked&&(this.sizeMinorColumnMax.clipd=this.sizeColumnMax.clipd)}}}),bd=Object(b.a)(vc.prototype,"toggleSizeMinorColumnMinLock",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sizeMinorColumnMinLocked=!this.sizeMinorColumnMinLocked,this.sizeMinorColumnMinLocked&&(this.sizeColumnMin.clipd=this.sizeMinorColumnMin.clipd)}}}),md=Object(b.a)(vc.prototype,"toggleSizeMinorColumnMaxLock",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sizeMinorColumnMaxLocked=!this.sizeMinorColumnMaxLocked,this.sizeMinorColumnMaxLocked&&(this.sizeColumnMax.clipd=this.sizeMinorColumnMax.clipd)}}}),Object(b.a)(vc.prototype,"setSizeMinorScalingType",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMinorScalingType"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMinorArea",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMinorArea"),vc.prototype),Object(b.a)(vc.prototype,"setSizeMinorMap",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setSizeMinorMap"),vc.prototype),Object(b.a)(vc.prototype,"setHeaderTableColumnWidts",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setHeaderTableColumnWidts"),vc.prototype),Object(b.a)(vc.prototype,"setDataTableColumnWidts",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setDataTableColumnWidts"),vc.prototype),Object(b.a)(vc.prototype,"setShowSelectedData",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setShowSelectedData"),vc.prototype),Object(b.a)(vc.prototype,"setCatalogTableAutoScroll",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setCatalogTableAutoScroll"),vc.prototype),Object(b.a)(vc.prototype,"setCatalogPlotType",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setCatalogPlotType"),vc.prototype),Object(b.a)(vc.prototype,"setCatalogSize",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setCatalogSize"),vc.prototype),Object(b.a)(vc.prototype,"setCatalogColor",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setCatalogColor"),vc.prototype),Object(b.a)(vc.prototype,"setCatalogShape",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setCatalogShape"),vc.prototype),Object(b.a)(vc.prototype,"setxAxis",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setxAxis"),vc.prototype),Object(b.a)(vc.prototype,"setyAxis",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setyAxis"),vc.prototype),Object(b.a)(vc.prototype,"setTableSeparatorPosition",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setTableSeparatorPosition"),vc.prototype),Object(b.a)(vc.prototype,"setHighlightColor",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setHighlightColor"),vc.prototype),yd=Object(b.a)(vc.prototype,"setSettingsTabId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e,this.sizeAxisTabId=vd.SIZE_MAJOR}}}),Object(b.a)(vc.prototype,"setThickness",[m.g],Object.getOwnPropertyDescriptor(vc.prototype,"setThickness"),vc.prototype),Object(b.a)(vc.prototype,"orientationMapData",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"orientationMapData"),vc.prototype),Object(b.a)(vc.prototype,"colorMapData",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"colorMapData"),vc.prototype),Object(b.a)(vc.prototype,"sizeMapData",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"sizeMapData"),vc.prototype),Object(b.a)(vc.prototype,"sizeMinorMapData",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"sizeMinorMapData"),vc.prototype),Object(b.a)(vc.prototype,"disableSizeMap",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"disableSizeMap"),vc.prototype),Object(b.a)(vc.prototype,"disableSizeMinorMap",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"disableSizeMinorMap"),vc.prototype),Object(b.a)(vc.prototype,"enableSizeMinorTab",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"enableSizeMinorTab"),vc.prototype),Object(b.a)(vc.prototype,"maxPointSizebyType",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"maxPointSizebyType"),vc.prototype),Object(b.a)(vc.prototype,"pointSizebyType",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"pointSizebyType"),vc.prototype),Object(b.a)(vc.prototype,"minorPointSizebyType",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"minorPointSizebyType"),vc.prototype),Object(b.a)(vc.prototype,"sizeMajor",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"sizeMajor"),vc.prototype),Object(b.a)(vc.prototype,"disableColorMap",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"disableColorMap"),vc.prototype),Object(b.a)(vc.prototype,"disableOrientationMap",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"disableOrientationMap"),vc.prototype),Object(b.a)(vc.prototype,"shapeSettings",[m.i],Object.getOwnPropertyDescriptor(vc.prototype,"shapeSettings"),vc.prototype),vc);var Id,wd,Td,Rd,Ad,Pd,Ed,Md,Fd,kd,Dd,Ld,Nd,_d,zd,Vd,Wd,Gd;let Bd=(Gd=Wd=class e{constructor(e){Object(f.a)(this,"indicatorInfo",wd,this),Object(f.a)(this,"scatterborder",Td,this),Object(f.a)(this,"dragmode",Rd,this),Object(f.a)(this,"plotType",Ad,this),Object(f.a)(this,"histogramBorder",Pd,this),Object(f.a)(this,"logScaleY",Ed,this),Object(f.a)(this,"nBinx",Md,this),Object(f.a)(this,"xColumnName",Fd,this),Object(f.a)(this,"yColumnName",kd,this),Object(f.a)(this,"fitting",Dd,this),Object(f.a)(this,"minMaxX",Ld,this),Object(f.a)(this,"statisticColumnName",Nd,this),Object(f.a)(this,"statistic",_d,this),Object(f.a)(this,"initLinearFitting",zd,this),Object(f.a)(this,"initStatistic",Vd,this),Object(m.p)(this),this.indicatorInfo=void 0,this.dragmode="select",this.plotType=e.plotType,this.logScaleY=!0,this.scatterborder=void 0,this.histogramBorder=void 0,this.nBinx=void 0,this.xColumnName=e.xColumnName,this.yColumnName=e.yColumnName,this.initLinearFitting(),this.statisticColumnName=Un.NONE,this.initStatistic()}setStatisticColumn(e){this.statisticColumnName=e}setStatistic(e){this.statistic=e}setColumnX(e){this.xColumnName=e}setColumnY(e){this.yColumnName=e}setIndicator(e){this.indicatorInfo=e}setScatterborder(e){this.scatterborder=e}setHistogramXBorder(e){this.histogramBorder=e}setDragmode(e){this.dragmode=e}setLogScaleY(e){this.logScaleY=e}setNumBinsX(e){this.nBinx=e}setFitting(e){this.fitting=e}setMinMaxX(e){this.minMaxX=e}get isScatterAutoScaled(){return void 0===this.scatterborder}get isHistogramAutoScaledX(){return void 0===this.histogramBorder}get fittingResultString(){if(this.showFittingResult){const t=gi(Math.sqrt(this.fitting.cov00),e.Decimals),i=gi(Math.sqrt(this.fitting.cov11),e.Decimals);return`${this.yColumnName} = ${gi(this.fitting.intercept,e.Decimals)} + ${gi(this.fitting.slope,e.Decimals)} ${this.xColumnName} <br>cov00 = ${gi(this.fitting.cov00,e.Decimals)}, cov01 = ${gi(this.fitting.cov01,e.Decimals)}, cov11 = ${gi(this.fitting.cov11,e.Decimals)} <br>sqrt(cov00) = ${t}, sqrt(cov11) = ${i} <br>rss = ${gi(this.fitting.rss,e.Decimals)}`}return""}get showFittingResult(){return!isNaN(this.fitting.intercept)&&!isNaN(this.fitting.slope)&&!isNaN(this.minMaxX.minVal)&&!isNaN(this.minMaxX.maxVal)}get enableStatistic(){return this.statisticColumnName!==Un.NONE}get showStatisticResult(){return!isNaN(this.statistic.count)&&!isNaN(this.statistic.validCount)}get statisticString(){return this.enableStatistic&&this.showStatisticResult?`${this.statisticColumnName} - count: ${this.statistic.count}, valid count: ${this.statistic.validCount}, mean: ${gi(this.statistic.mean,e.Decimals)}, rms: ${gi(this.statistic.rms,e.Decimals)}, stddev: ${gi(this.statistic.std,e.Decimals)}, min: ${gi(this.statistic.min,e.Decimals)}, max: ${gi(this.statistic.max,e.Decimals)}`:""}},Wd.Decimals=4,Id=Gd,wd=Object(b.a)(Id.prototype,"indicatorInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Td=Object(b.a)(Id.prototype,"scatterborder",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rd=Object(b.a)(Id.prototype,"dragmode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ad=Object(b.a)(Id.prototype,"plotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pd=Object(b.a)(Id.prototype,"histogramBorder",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ed=Object(b.a)(Id.prototype,"logScaleY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Md=Object(b.a)(Id.prototype,"nBinx",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fd=Object(b.a)(Id.prototype,"xColumnName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kd=Object(b.a)(Id.prototype,"yColumnName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dd=Object(b.a)(Id.prototype,"fitting",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ld=Object(b.a)(Id.prototype,"minMaxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nd=Object(b.a)(Id.prototype,"statisticColumnName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_d=Object(b.a)(Id.prototype,"statistic",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Id.prototype,"setStatisticColumn",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setStatisticColumn"),Id.prototype),Object(b.a)(Id.prototype,"setStatistic",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setStatistic"),Id.prototype),Object(b.a)(Id.prototype,"setColumnX",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setColumnX"),Id.prototype),Object(b.a)(Id.prototype,"setColumnY",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setColumnY"),Id.prototype),Object(b.a)(Id.prototype,"setIndicator",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setIndicator"),Id.prototype),Object(b.a)(Id.prototype,"setScatterborder",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setScatterborder"),Id.prototype),Object(b.a)(Id.prototype,"setHistogramXBorder",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setHistogramXBorder"),Id.prototype),Object(b.a)(Id.prototype,"setDragmode",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setDragmode"),Id.prototype),Object(b.a)(Id.prototype,"setLogScaleY",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setLogScaleY"),Id.prototype),Object(b.a)(Id.prototype,"setNumBinsX",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setNumBinsX"),Id.prototype),Object(b.a)(Id.prototype,"setFitting",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setFitting"),Id.prototype),Object(b.a)(Id.prototype,"setMinMaxX",[m.g],Object.getOwnPropertyDescriptor(Id.prototype,"setMinMaxX"),Id.prototype),zd=Object(b.a)(Id.prototype,"initLinearFitting",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setFitting({intercept:void 0,slope:void 0,cov00:void 0,cov01:void 0,cov11:void 0,rss:void 0}),this.setMinMaxX({minVal:void 0,maxVal:void 0})}}}),Vd=Object(b.a)(Id.prototype,"initStatistic",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.statistic={mean:void 0,count:void 0,validCount:void 0,std:void 0,min:void 0,max:void 0,rms:void 0}}}}),Object(b.a)(Id.prototype,"isScatterAutoScaled",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"isScatterAutoScaled"),Id.prototype),Object(b.a)(Id.prototype,"isHistogramAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"isHistogramAutoScaledX"),Id.prototype),Object(b.a)(Id.prototype,"fittingResultString",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"fittingResultString"),Id.prototype),Object(b.a)(Id.prototype,"showFittingResult",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"showFittingResult"),Id.prototype),Object(b.a)(Id.prototype,"enableStatistic",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"enableStatistic"),Id.prototype),Object(b.a)(Id.prototype,"showStatisticResult",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"showStatisticResult"),Id.prototype),Object(b.a)(Id.prototype,"statisticString",[m.i],Object.getOwnPropertyDescriptor(Id.prototype,"statisticString"),Id.prototype),Id);var qd,Hd,Yd,Ud,Xd,$d,Kd,Qd,Zd,Jd,ep,tp,ip,np,rp,op,sp,ap,lp,cp,dp,pp,hp,up,gp,fp,bp,mp,yp,Op,jp,xp,Sp,vp,Cp,Ip,wp,Tp,Rp,Ap,Pp,Ep,Mp,Fp,kp,Dp,Lp,Np,_p,zp,Vp,Wp,Gp,Bp,qp,Hp,Yp,Up,Xp,$p,Kp,Qp,Zp,Jp,eh,th,ih,nh,rh,oh,sh;let ah;!function(e){e[e.NONE=1]="NONE",e[e.CHANNEL=2]="CHANNEL",e[e.MASK=3]="MASK"}(ah||(ah={}));let lh=(sh=oh=class e extends Hr{constructor(t="z"){var i;super(qr.CLOSED_AND_POINT),Object(f.a)(this,"minX",Hd,this),Object(f.a)(this,"maxX",Yd,this),Object(f.a)(this,"minY",Ud,this),Object(f.a)(this,"maxY",Xd,this),Object(f.a)(this,"cursorX",$d,this),Object(f.a)(this,"channel",Kd,this),Object(f.a)(this,"markerTextVisible",Qd,this),Object(f.a)(this,"isMouseMoveIntoLinePlots",Zd,this),Object(f.a)(this,"isStreamingData",Jd,this),Object(f.a)(this,"isHighlighted",ep,this),Object(f.a)(this,"spectralLinesMHz",tp,this),Object(f.a)(this,"intensityUnit",ip,this),Object(f.a)(this,"intensityConversion",np,this),Object(f.a)(this,"plotType",rp,this),Object(f.a)(this,"meanRmsVisible",op,this),Object(f.a)(this,"primaryLineColor",sp,this),Object(f.a)(this,"lineColorMap",ap,this),Object(f.a)(this,"lineWidth",lp,this),Object(f.a)(this,"linePlotPointSize",cp,this),Object(f.a)(this,"linePlotInitXYBoundaries",dp,this),Object(f.a)(this,"settingsTabId",pp,this),Object(f.a)(this,"momentRegionId",hp,this),Object(f.a)(this,"selectingMode",up,this),Object(f.a)(this,"channelValueRange",gp,this),Object(f.a)(this,"momentMask",fp,this),Object(f.a)(this,"maskRange",bp,this),Object(f.a)(this,"selectedMoments",mp,this),this.smoothingStore=void 0,this.profileSelectionStore=void 0,this.fittingStore=void 0,Object(f.a)(this,"setRegionId",yp,this),Object(f.a)(this,"setSpectralCoordinate",Op,this),Object(f.a)(this,"setSpectralSystem",jp,this),Object(f.a)(this,"setIntensityUnit",xp,this),Object(f.a)(this,"selectMomentRegion",Sp,this),Object(f.a)(this,"setMomentRangeSelectingMode",vp,this),Object(f.a)(this,"clearMomentRangeSelectingMode",Cp,this),Object(f.a)(this,"setSelectedChannelRange",Ip,this),Object(f.a)(this,"setSelectedMaskRange",wp,this),Object(f.a)(this,"updateRanges",Tp,this),Object(f.a)(this,"setMomentMask",Rp,this),Object(f.a)(this,"selectMoment",Ap,this),Object(f.a)(this,"deselectMoment",Pp,this),Object(f.a)(this,"removeMomentByIndex",Ep,this),Object(f.a)(this,"clearSelectedMoments",Mp,this),Object(f.a)(this,"isMomentSelected",Fp,this),Object(f.a)(this,"requestMoment",kp,this),Object(f.a)(this,"requestingMomentCancelled",Dp,this),Object(f.a)(this,"setHighlighted",Lp,this),Object(f.a)(this,"addSpectralLines",Np,this),Object(f.a)(this,"clearSpectralLines",_p,this),Object(f.a)(this,"setXBounds",zp,this),Object(f.a)(this,"clearXBounds",Vp,this),Object(f.a)(this,"setYBounds",Wp,this),Object(f.a)(this,"clearYBounds",Gp,this),Object(f.a)(this,"setXYBounds",Bp,this),Object(f.a)(this,"clearXYBounds",qp,this),Object(f.a)(this,"setMarkerTextVisible",Hp,this),Object(f.a)(this,"setMeanRmsVisible",Yp,this),Object(f.a)(this,"setPlotType",Up,this),Object(f.a)(this,"setChannel",Xp,this),Object(f.a)(this,"setCursor",$p,this),Object(f.a)(this,"setMouseMoveIntoLinePlots",Kp,this),Object(f.a)(this,"updateStreamingDataStatus",Qp,this),Object(f.a)(this,"setSettingsTabId",Zp,this),Object(f.a)(this,"getProfileColor",Jp,this),Object(f.a)(this,"setProfileColor",eh,this),Object(f.a)(this,"removeProfileColor",th,this),Object(f.a)(this,"clearProfileColors",ih,this),Object(f.a)(this,"setLineWidth",nh,this),Object(f.a)(this,"setLinePlotPointSize",rh,this),this.init=t=>{if(!t)return;(je()(t.primaryLineColor).isValid()||Qb(t.primaryLineColor))&&(this.primaryLineColor=t.primaryLineColor,this.lineColorMap.set(e.PRIMARY_LINE_KEY,this.primaryLineColor)),"number"===typeof t.lineWidth&&t.lineWidth>=rO.MIN_WIDTH&&t.lineWidth<=rO.MAX_WIDTH&&(this.lineWidth=t.lineWidth),"number"===typeof t.linePlotPointSize&&t.linePlotPointSize>=rO.MIN_POINT_SIZE&&t.linePlotPointSize<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=t.linePlotPointSize),"boolean"===typeof t.meanRmsVisible&&(this.meanRmsVisible=t.meanRmsVisible),"string"!==typeof t.plotType||t.plotType!==oO.STEPS&&t.plotType!==oO.LINES&&t.plotType!==oO.POINTS||(this.plotType=t.plotType),"number"===typeof t.minXVal&&(this.linePlotInitXYBoundaries.minXVal=t.minXVal),"number"===typeof t.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=t.maxXVal),"number"===typeof t.minYVal&&(this.linePlotInitXYBoundaries.minYVal=t.minYVal),"number"===typeof t.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=t.maxYVal)},this.selectFrame=e=>{this.profileSelectionStore.selectFrame(e)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),this.getBoundX=e=>{if((null===e||void 0===e?void 0:e.length)>0){let t=Math.min(e[0],e[e.length-1]),i=Math.max(e[0],e[e.length-1]);if(!this.isAutoScaledX){const e=Gi(this.minX,t,i),n=Gi(this.maxX,t,i);t=e,i=n}return{xMin:t,xMax:i}}return{xMin:void 0,xMax:void 0}},this.getDataPointsAndProperties=(e,t,i)=>{let n,r,o=[],s=[],a=this.getBoundX(e),l={yMin:Number.MAX_VALUE,yMax:-Number.MAX_VALUE};if((null===t||void 0===t?void 0:t.length)>0&&(null===e||void 0===e?void 0:e.length)>0&&t.length===e.length){let c,d,p=0,h=0,u=0;for(let n=0;n<e.length;n++){const r=e[n],s=t[n];if(r<(null===a||void 0===a?void 0:a.xMin)||r>(null===a||void 0===a?void 0:a.xMax)){if(o.length)break}else isFinite(c)||(c=n),d=n,o.push({x:r,y:s}),isNaN(s)||(l.yMin=Math.min(l.yMin,s),l.yMax=Math.max(l.yMax,s),i&&(u++,p+=s,h+=s*s))}return s=s.concat(this.smoothingStore.getSmoothingPoint2DArray(e,t)),i&&u>0&&(n=p/u,r=Math.sqrt(h/u-n*n)),{points:o,smoothedPoints:s,xBound:a,yBound:l,yMean:n,yRms:r,startIndex:c,endIndex:d}}},Object(m.p)(this),this.isStreamingData=!1,this.isHighlighted=!1,this.spectralLinesMHz=[],this.plotType=oO.STEPS,this.meanRmsVisible=!1,this.markerTextVisible=!1,this.primaryLineColor="auto-blue",this.lineColorMap=new Map([[e.PRIMARY_LINE_KEY,this.primaryLineColor]]),this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.smoothingStore=new Ha,this.fittingStore=new Ok(this),this.profileSelectionStore=new Ah(this,t),this.selectingMode=ah.NONE,this.momentRegionId=Br.ACTIVE,this.channelValueRange=[0,0],this.momentMask=Nt.MomentMask.None,this.maskRange=[0,1],this.selectedMoments=[Nt.Moment.INTEGRATED_OF_THE_SPECTRUM],this.settingsTabId=fH.CONVERSION,this.intensityConversion=void 0,this.setIntensityUnit(null===(i=this.effectiveFrame)||void 0===i?void 0:i.headerUnit),Object(m.s)((()=>this.effectiveFrame),(e=>{e&&this.setIntensityUnit(e.headerUnit)})),Object(m.s)((()=>{var e;return null===(e=this.effectiveFrame)||void 0===e?void 0:e.requiredPolarization}),(e=>{this.effectiveFrame&&[er.PFtotal,er.PFlinear,er.Pangle].includes(e)&&this.setIntensityUnit(this.effectiveFrame.headerUnit)})),Object(m.h)((()=>{this.effectiveFrame&&(this.updateRanges(),this.selectMomentRegion(Br.ACTIVE))})),Object(m.h)((()=>{const e=this.plotData;e&&this.initXYBoundaries(e.xMin,e.xMax,e.yMin,e.yMax)}))}get intensityConfig(){const e=this.effectiveFrame;if(e){var t,i;let o={nativeIntensityUnit:e.headerUnit};var n,r;if(e.beamProperties)o.bmaj=e.beamProperties.majorAxis,o.bmin=e.beamProperties.minorAxis,"FREQ"===(null===(n=e.spectralAxis)||void 0===n||null===(r=n.type)||void 0===r?void 0:r.code)&&(o.freqGHz=((e,t)=>{if(e&&Object.values(Ht).includes(e)&&isFinite(t))return e===Ht.GHZ?t:e===Ht.MHZ?t/1e3:e===Ht.KHZ?t/1e6:t/1e9})(e.spectralAxis.type.unit,e.spectralAxis.value));return isFinite(null===(t=e.pixelUnitSizeArcsec)||void 0===t?void 0:t.x)&&isFinite(null===(i=e.pixelUnitSizeArcsec)||void 0===i?void 0:i.y)&&(o.cdelta1=Oi(e.pixelUnitSizeArcsec.x,"arcsec"),o.cdelta2=Oi(e.pixelUnitSizeArcsec.y,"arcsec")),o}}get isIntensityConvertible(){var e;return oi(null===(e=this.intensityConfig)||void 0===e?void 0:e.nativeIntensityUnit)&&!this.profileSelectionStore.isCoordinatesIncludingNonIntensityUnit}get intensityOptions(){return si(this.intensityConfig)}get profileNum(){var e;return null===(e=this.profileSelectionStore.profiles)||void 0===e?void 0:e.length}get plotData(){const e=this.effectiveFrame;if(!(null===e||void 0===e?void 0:e.channelInfo))return null;const t=this.profileSelectionStore.profiles;if(!((null===t||void 0===t?void 0:t.length)>0))return null;let i,n,r=0,o=[],s=[],a=[],l=[],c=[],d={xMin:Number.MAX_VALUE,xMax:-Number.MAX_VALUE},p={yMin:Number.MAX_VALUE,yMax:-Number.MAX_VALUE},h=0,u=[];const g=1===t.length,f=this.lineColorMap;let b;if(t.forEach((e=>{if(null===e||void 0===e?void 0:e.data){var t,b;r++,a.push(Jb(f.get(e.colorKey))),l.push(e.label),c.push(e.comments);const m=this.intensityConversion?this.intensityConversion(e.data.values):e.data.values,y=this.getDataPointsAndProperties(e.channelValues,m,g);o.push(null!==(t=null===y||void 0===y?void 0:y.points)&&void 0!==t?t:[]),s.push(null!==(b=null===y||void 0===y?void 0:y.smoothedPoints)&&void 0!==b?b:[]),y&&(g&&(i=y.yMean,n=y.yRms),d.xMin>y.xBound.xMin&&(d.xMin=y.xBound.xMin),d.xMax<y.xBound.xMax&&(d.xMax=y.xBound.xMax),p.yMin>y.yBound.yMin&&(p.yMin=y.yBound.yMin),p.yMax<y.yBound.yMax&&(p.yMax=y.yBound.yMax),h+=e.data.progress,u.push({startIndex:y.startIndex,endIndex:y.endIndex}))}})),1===t.length&&1===u.length){let e=t[0].channelValues.slice(u[0].startIndex,u[0].endIndex+1);let i=(this.intensityConversion?this.intensityConversion(t[0].data.values):t[0].data.values).slice(u[0].startIndex,u[0].endIndex+1);if(this.smoothingStore.type!==GO.NONE){const t=this.smoothingStore.getSmoothingValues(e,i);e=t.x,i=t.y}b={x:e,y:i}}if(d.xMin===Number.MAX_VALUE&&(d.xMin=void 0,d.xMax=void 0),p.yMin===Number.MAX_VALUE)p.yMin=void 0,p.yMax=void 0;else{const e=p.yMax-p.yMin;p.yMin-=e*tO,p.yMax+=e*tO}return{numProfiles:r,data:o,smoothedData:s,fittingData:b,colors:a,labels:l,comments:c,plotName:this.profileSelectionStore.profilesPlotName,xMin:d.xMin,xMax:d.xMax,yMin:p.yMin,yMax:p.yMax,yMean:i,yRms:n,progress:h/r}}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}get isSelectingMomentChannelRange(){return this.selectingMode===ah.CHANNEL}get isSelectingMomentMaskRange(){return this.selectingMode===ah.MASK}get selectedRange(){return this.isSelectingMomentChannelRange?{isHorizontal:!1,center:(this.channelValueRange[0]+this.channelValueRange[1])/2,width:Math.abs(this.channelValueRange[0]-this.channelValueRange[1])}:this.isSelectingMomentMaskRange?{isHorizontal:!0,center:(this.maskRange[0]+this.maskRange[1])/2,width:Math.abs(this.maskRange[0]-this.maskRange[1])}:null}get momentRegionOptions(){const e=this.effectiveFrame;let t=[{value:Br.ACTIVE,label:"Active"},{value:Br.IMAGE,label:"Image"}];if(null===e||void 0===e?void 0:e.regionSet){var i,n;const r=null===(i=e.regionSet.regions)||void 0===i||null===(n=i.filter((e=>!e.isTemporary&&(e.isClosedRegion||e.regionType===Nt.RegionType.POINT))))||void 0===n?void 0:n.map((e=>({value:null===e||void 0===e?void 0:e.regionId,label:null===e||void 0===e?void 0:e.nameString,disabled:!(null===e||void 0===e?void 0:e.isClosedRegion)})));r&&(t=t.concat(r))}return t}get isMomentRegionValid(){if(this.effectiveFrame){if(this.momentRegionId===Br.IMAGE)return!0;if(this.momentRegionId===Br.ACTIVE){var e;const t=null===(e=this.effectiveFrame.regionSet)||void 0===e?void 0:e.selectedRegion;return!t||(null===t||void 0===t?void 0:t.regionId)===Br.CURSOR||(null===t||void 0===t?void 0:t.isClosedRegion)}{var t;const e=this.effectiveFrame.getRegion(this.momentRegionId);return null!==(t=null===e||void 0===e?void 0:e.isClosedRegion)&&void 0!==t&&t}}return!1}get momentRegionInfo(){if(this.effectiveFrame){if(this.momentRegionId===Br.IMAGE)return"Image";if(this.momentRegionId===Br.ACTIVE){var e;const t=null===(e=this.effectiveFrame.regionSet)||void 0===e?void 0:e.selectedRegion;return t&&t.regionId!==Br.CURSOR?t.nameString:"Image"}{var t;const e=this.effectiveFrame.getRegion(this.momentRegionId);return null!==(t=null===e||void 0===e?void 0:e.nameString)&&void 0!==t?t:void 0}}}get transformedSpectralLines(){const e=this.effectiveFrame,t=(null===e||void 0===e?void 0:e.isCoordChannel)||(null===e||void 0===e?void 0:e.isCoordVelocity)&&this.profileSelectionStore.isShowingProfilesOfMultiImages;let i=[];var n;e&&!t&&(null===(n=this.spectralLinesMHz)||void 0===n||n.forEach((t=>{const n=e.convertFreqMHzToSettingWCS(null===t||void 0===t?void 0:t.value);isFinite(n)&&i.push({species:null===t||void 0===t?void 0:t.species,value:n,qn:null===t||void 0===t?void 0:t.qn})})));return i}get yUnit(){if(this.intensityUnit&&this.profileSelectionStore.isSameStatsTypeUnit&&this.profileSelectionStore.isSameCoordinatesUnit){let e;return e=this.profileSelectionStore.isCoordinatesPFtotalPFlinearOnly?"%":this.profileSelectionStore.isCoordinatesPangleOnly?"degree":this.intensityUnit,this.profileSelectionStore.isStatsTypeFluxDensityOnly&&this.profileSelectionStore.isCoordinatesPangleOnly?"":this.profileSelectionStore.isStatsTypeFluxDensityOnly?ri(e)===Jt.Kelvin?"K":"Jy":this.profileSelectionStore.isStatsTypeSumSqOnly?`(${e})^2`:e}return""}static CalculateRequirementsMap(e){const t=new Map;return e.forEach((e=>{const i=e.profileSelectionStore.getFormattedSpectralConfigs();null===i||void 0===i||i.forEach((e=>{let i=t.get(e.fileId);i||(i=new Map,t.set(e.fileId,i));let n=i.get(e.regionId);n||(n=new Nt.SetSpectralRequirements({fileId:e.fileId,regionId:e.regionId}),i.set(e.regionId,n)),n.spectralProfiles||(n.spectralProfiles=[]);let r=n.spectralProfiles.find((t=>t.coordinate===e.coordinate));var o;r?null===(o=e.statsTypes)||void 0===o||o.forEach((e=>{r.statsTypes.includes(e)||r.statsTypes.push(e)})):n.spectralProfiles.push({coordinate:e.coordinate,statsTypes:e.statsTypes})}))})),t}static DiffSpectralRequirements(e,t){const i=[];return e.forEach(((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach(((e,t)=>{let r=n.get(t);r||(r=new Nt.SetSpectralRequirements({fileId:i,regionId:t,spectralProfiles:[]}),n.set(t,r))}))})),t.forEach(((t,n)=>{let r=e.get(n);r?t.forEach(((e,t)=>{let n=r.get(t);if(n){const t=n.spectralProfiles?n.spectralProfiles.length:0,r=e.spectralProfiles?e.spectralProfiles.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.spectralProfiles.sort(((e,t)=>e.coordinate>t.coordinate?1:-1)),s=n.spectralProfiles.sort(((e,t)=>e.coordinate>t.coordinate?1:-1));for(let n=0;n<r;n++){const t=o[n],r=s[n];if(t.coordinate!==r.coordinate)return void i.push(e);const a=r.statsTypes?r.statsTypes.length:0,l=t.statsTypes?t.statsTypes.length:0;if(a!==l)return void i.push(e);if(0===a)return;const c=t.statsTypes.sort(),d=r.statsTypes.sort();for(let n=0;n<l;n++)if(c[n]!==d[n])return void i.push(e)}}else i.push(e)})):t.forEach((e=>i.push(e)))})),i.sort(((e,t)=>e.spectralProfiles.length>t.spectralProfiles.length?1:-1))}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},oh.PRIMARY_LINE_KEY="Primary",qd=sh,Hd=Object(b.a)(qd.prototype,"minX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yd=Object(b.a)(qd.prototype,"maxX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ud=Object(b.a)(qd.prototype,"minY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xd=Object(b.a)(qd.prototype,"maxY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$d=Object(b.a)(qd.prototype,"cursorX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kd=Object(b.a)(qd.prototype,"channel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qd=Object(b.a)(qd.prototype,"markerTextVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zd=Object(b.a)(qd.prototype,"isMouseMoveIntoLinePlots",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jd=Object(b.a)(qd.prototype,"isStreamingData",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ep=Object(b.a)(qd.prototype,"isHighlighted",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tp=Object(b.a)(qd.prototype,"spectralLinesMHz",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ip=Object(b.a)(qd.prototype,"intensityUnit",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),np=Object(b.a)(qd.prototype,"intensityConversion",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rp=Object(b.a)(qd.prototype,"plotType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),op=Object(b.a)(qd.prototype,"meanRmsVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sp=Object(b.a)(qd.prototype,"primaryLineColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ap=Object(b.a)(qd.prototype,"lineColorMap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lp=Object(b.a)(qd.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cp=Object(b.a)(qd.prototype,"linePlotPointSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dp=Object(b.a)(qd.prototype,"linePlotInitXYBoundaries",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pp=Object(b.a)(qd.prototype,"settingsTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hp=Object(b.a)(qd.prototype,"momentRegionId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),up=Object(b.a)(qd.prototype,"selectingMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gp=Object(b.a)(qd.prototype,"channelValueRange",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fp=Object(b.a)(qd.prototype,"momentMask",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bp=Object(b.a)(qd.prototype,"maskRange",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mp=Object(b.a)(qd.prototype,"selectedMoments",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yp=Object(b.a)(qd.prototype,"setRegionId",[m.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.regionIdMap.set(e,t),this.clearXYBounds()}}}),Op=Object(b.a)(qd.prototype,"setSpectralCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.effectiveFrame.setSpectralCoordinate(e)&&this.clearXBounds()}}}),jp=Object(b.a)(qd.prototype,"setSpectralSystem",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.effectiveFrame.setSpectralSystem(e)&&this.clearXBounds()}}}),xp=Object(b.a)(qd.prototype,"setIntensityUnit",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{oi(e)&&(this.intensityUnit=e,this.intensityConversion=hi(this.intensityConfig,this.intensityUnit))}}}),Sp=Object(b.a)(qd.prototype,"selectMomentRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.momentRegionId=e}}}),vp=Object(b.a)(qd.prototype,"setMomentRangeSelectingMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.selectingMode=e)}}}),Cp=Object(b.a)(qd.prototype,"clearMomentRangeSelectingMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectingMode=ah.NONE}}}),Ip=Object(b.a)(qd.prototype,"setSelectedChannelRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{isFinite(e)&&isFinite(t)&&(this.channelValueRange[0]=e,this.channelValueRange[1]=t),this.selectingMode=ah.NONE}}}),wp=Object(b.a)(qd.prototype,"setSelectedMaskRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{isFinite(e)&&isFinite(t)&&(this.maskRange[0]=e,this.maskRange[1]=t),this.selectingMode=ah.NONE}}}),Tp=Object(b.a)(qd.prototype,"updateRanges",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&e.channelValueBounds&&(this.channelValueRange[0]=e.channelValueBounds.min,this.channelValueRange[1]=e.channelValueBounds.max,this.maskRange[0]=0,this.maskRange[1]=1)}}}),Rp=Object(b.a)(qd.prototype,"setMomentMask",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.momentMask=e}}}),Ap=Object(b.a)(qd.prototype,"selectMoment",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedMoments.includes(e)||this.selectedMoments.push(e)}}}),Pp=Object(b.a)(qd.prototype,"deselectMoment",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedMoments.includes(e)&&(this.selectedMoments=this.selectedMoments.filter((t=>t!==e)))}}}),Ep=Object(b.a)(qd.prototype,"removeMomentByIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=0&&e<this.selectedMoments.length&&(this.selectedMoments=this.selectedMoments.filter(((t,i)=>i!==e)))}}}),Mp=Object(b.a)(qd.prototype,"clearSelectedMoments",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedMoments=[]}}}),Fp=Object(b.a)(qd.prototype,"isMomentSelected",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>this.selectedMoments.includes(e)}}),kp=Object(b.a)(qd.prototype,"requestMoment",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;if(e&&this.isMomentRegionValid){const r=e.findChannelIndexByValue(this.channelValueRange[0]),o=e.findChannelIndexByValue(this.channelValueRange[1]);if(isFinite(r)&&isFinite(o)){var t,i,n;const s={min:r<=o?r:o,max:r<=o?o:r},a=this.momentRegionId===Br.ACTIVE?null!==(t=null===(i=this.effectiveFrame.regionSet)||void 0===i||null===(n=i.selectedRegion)||void 0===n?void 0:n.regionId)&&void 0!==t?t:Br.CURSOR:this.momentRegionId,l={fileId:e.frameInfo.fileId,moments:this.selectedMoments,axis:Nt.MomentAxis.SPECTRAL,regionId:a,spectralRange:s,mask:this.momentMask,pixelRange:new Nt.FloatBounds({min:this.maskRange[0],max:this.maskRange[1]})};e.resetMomentRequestState(),e.setIsRequestingMoments(!0),gC.Instance.requestMoment(l,e)}}}}}),Dp=Object(b.a)(qd.prototype,"requestingMomentCancelled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&gC.Instance.cancelRequestingMoment(e.frameInfo.fileId)}}}),Lp=Object(b.a)(qd.prototype,"setHighlighted",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isHighlighted=e}}}),Np=Object(b.a)(qd.prototype,"addSpectralLines",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.spectralLinesMHz=e)}}}),_p=Object(b.a)(qd.prototype,"clearSpectralLines",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralLinesMHz=[]}}}),zp=Object(b.a)(qd.prototype,"setXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),Vp=Object(b.a)(qd.prototype,"clearXBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Wp=Object(b.a)(qd.prototype,"setYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),Gp=Object(b.a)(qd.prototype,"clearYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Bp=Object(b.a)(qd.prototype,"setXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),qp=Object(b.a)(qd.prototype,"clearXYBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),Hp=Object(b.a)(qd.prototype,"setMarkerTextVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),Yp=Object(b.a)(qd.prototype,"setMeanRmsVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),Up=Object(b.a)(qd.prototype,"setPlotType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),Xp=Object(b.a)(qd.prototype,"setChannel",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channel=e}}}),$p=Object(b.a)(qd.prototype,"setCursor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Kp=Object(b.a)(qd.prototype,"setMouseMoveIntoLinePlots",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),Qp=Object(b.a)(qd.prototype,"updateStreamingDataStatus",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isStreamingData=e}}}),Zp=Object(b.a)(qd.prototype,"setSettingsTabId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(b.a)(qd.prototype,"intensityConfig",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"intensityConfig"),qd.prototype),Object(b.a)(qd.prototype,"isIntensityConvertible",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"isIntensityConvertible"),qd.prototype),Object(b.a)(qd.prototype,"intensityOptions",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"intensityOptions"),qd.prototype),Object(b.a)(qd.prototype,"profileNum",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"profileNum"),qd.prototype),Object(b.a)(qd.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"plotData"),qd.prototype),Object(b.a)(qd.prototype,"isAutoScaledX",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"isAutoScaledX"),qd.prototype),Object(b.a)(qd.prototype,"isAutoScaledY",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"isAutoScaledY"),qd.prototype),Object(b.a)(qd.prototype,"isSelectingMomentChannelRange",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"isSelectingMomentChannelRange"),qd.prototype),Object(b.a)(qd.prototype,"isSelectingMomentMaskRange",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"isSelectingMomentMaskRange"),qd.prototype),Object(b.a)(qd.prototype,"selectedRange",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"selectedRange"),qd.prototype),Object(b.a)(qd.prototype,"momentRegionOptions",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"momentRegionOptions"),qd.prototype),Object(b.a)(qd.prototype,"isMomentRegionValid",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"isMomentRegionValid"),qd.prototype),Object(b.a)(qd.prototype,"momentRegionInfo",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"momentRegionInfo"),qd.prototype),Object(b.a)(qd.prototype,"transformedSpectralLines",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"transformedSpectralLines"),qd.prototype),Object(b.a)(qd.prototype,"yUnit",[m.i],Object.getOwnPropertyDescriptor(qd.prototype,"yUnit"),qd.prototype),Jp=Object(b.a)(qd.prototype,"getProfileColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>this.lineColorMap.get(e)}}),eh=Object(b.a)(qd.prototype,"setProfileColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i;this.lineColorMap.set(e,t),(null===(i=this.profileSelectionStore)||void 0===i?void 0:i.isSingleProfileMode)&&(this.primaryLineColor=t)}}}),th=Object(b.a)(qd.prototype,"removeProfileColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineColorMap.delete(e)}}}),ih=Object(b.a)(qd.prototype,"clearProfileColors",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.lineColorMap.clear()}}}),nh=Object(b.a)(qd.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_WIDTH&&e<=rO.MAX_WIDTH&&(this.lineWidth=e)}}}),rh=Object(b.a)(qd.prototype,"setLinePlotPointSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=rO.MIN_POINT_SIZE&&e<=rO.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(b.a)(qd.prototype,"initXYBoundaries",[m.g],Object.getOwnPropertyDescriptor(qd.prototype,"initXYBoundaries"),qd.prototype),qd);var ch,dh,ph,hh,uh,gh,fh,bh,mh,yh,Oh,jh,xh,Sh,vh,Ch,Ih,wh,Th;let Rh;!function(e){e.NONE="None",e.IMAGE="Image",e.REGION="Region",e.STATISTIC="Statistic",e.STOKES="Polarization"}(Rh||(Rh={}));let Ah=(ch=class{get profileConfigs(){var e,t,i;let n=[];if(this.selectedFrame&&(null===(e=this.selectedRegionIds)||void 0===e?void 0:e.length)>0&&(null===(t=this.selectedStatsTypes)||void 0===t?void 0:t.length)>0&&(null===(i=this.selectedCoordinates)||void 0===i?void 0:i.length)>0)if(this.activeProfileCategory===Rh.NONE||this.activeProfileCategory===Rh.IMAGE){const e=this.widgetStore.effectiveRegion,t=(null===e||void 0===e?void 0:e.isClosedRegion)?this.selectedStatsTypes[0]:Nt.StatsType.Sum,i=this.selectedCoordinates[0],r=gC.Instance.spatialAndSpectalMatchedFileIds;this.activeProfileCategory===Rh.IMAGE&&(null===r||void 0===r?void 0:r.includes(this.selectedFrameFileId))?r.forEach((r=>{n.length<10&&n.push({fileId:r,regionId:this.effectiveRegionId,statsType:t,coordinate:i,colorKey:r,label:this.genProfileLabel(r,null===e||void 0===e?void 0:e.nameString,t,i)})})):n.push({fileId:this.selectedFrameFileId,regionId:this.effectiveRegionId,statsType:t,coordinate:i,colorKey:this.selectedFrameFileId,label:this.genProfileLabel(this.selectedFrameFileId,null===e||void 0===e?void 0:e.nameString,t,i)})}else if(this.activeProfileCategory===Rh.REGION){var r;const e=this.selectedStatsTypes[0],t=this.selectedCoordinates[0];null===(r=this.selectedRegionIds)||void 0===r||r.forEach((i=>{if(i!==Br.ACTIVE){const r=this.selectedFrame.getRegion(i),o=(null===r||void 0===r?void 0:r.isClosedRegion)?e:Nt.StatsType.Sum;n.push({fileId:this.selectedFrameFileId,regionId:i,statsType:o,coordinate:t,colorKey:i,label:this.genProfileLabel(this.selectedFrameFileId,null===r||void 0===r?void 0:r.nameString,o,t)})}}))}else if(this.activeProfileCategory===Rh.STATISTIC){const e=this.selectedCoordinates[0],t=this.widgetStore.effectiveRegion;(null===t||void 0===t?void 0:t.isClosedRegion)?this.selectedStatsTypes.forEach((i=>{n.push({fileId:this.selectedFrameFileId,regionId:this.effectiveRegionId,statsType:i,coordinate:e,colorKey:i,label:this.genProfileLabel(this.selectedFrameFileId,null===t||void 0===t?void 0:t.nameString,i,e)})})):n.push({fileId:this.selectedFrameFileId,regionId:this.effectiveRegionId,statsType:Nt.StatsType.Sum,coordinate:e,colorKey:Nt.StatsType.Sum,label:this.genProfileLabel(this.selectedFrameFileId,null===t||void 0===t?void 0:t.nameString,Nt.StatsType.Sum,e)})}else if(this.activeProfileCategory===Rh.STOKES){var o;const e=this.selectedStatsTypes[0],t=this.widgetStore.effectiveRegion,i=(null===t||void 0===t?void 0:t.isClosedRegion)?e:Nt.StatsType.Sum;null===(o=this.selectedCoordinates)||void 0===o||o.forEach((e=>{n.push({fileId:this.selectedFrameFileId,regionId:this.effectiveRegionId,statsType:i,coordinate:e,colorKey:e,label:this.genProfileLabel(this.selectedFrameFileId,null===t||void 0===t?void 0:t.nameString,i,e)})}))}return n}get profiles(){var e;let t=[];return null===(e=this.profileConfigs)||void 0===e||e.forEach((e=>{const i=gC.Instance,n=i.getFrame(e.fileId),r=i.spectralProfiles.get(e.fileId),o=null===r||void 0===r?void 0:r.get(e.regionId),s=null===o||void 0===o?void 0:o.getProfile(e.coordinate,e.statsType);n&&t.push({channelValues:n.channelValues,data:s,colorKey:e.colorKey,label:e.label,comments:n.getRegionProperties(e.regionId)})})),t}get profilesPlotName(){var e;let t,i,n,r,o,s,a,l;return t=i=n=r="",o=s=a=l=void 0,null===(e=this.profileConfigs)||void 0===e||e.forEach(((e,c)=>{var d;const p=null===(d=gC.Instance.getFrame(e.fileId))||void 0===d?void 0:d.filename;o!==e.fileId&&(t+=`${0===c?"":","}${p}`),s!==e.regionId&&(i+=`${0===c?"":","}${e.regionId===Br.CURSOR?"Cursor":e.regionId}`),a!==e.statsType&&(n+=`${0===c?"":","}${xn(e.statsType)}`),l!==e.coordinate&&(r+=`${0===c?"":","}${Jn.get(e.coordinate.slice(0,e.coordinate.length-1))}}`),o=e.fileId,s=e.regionId,a=e.statsType,l=e.coordinate})),{image:t,plot:`Z-Profile-Region_${i}-Statistic_${n}-Coordinate_${r}`}}get profileOrderedKeys(){if(this.activeProfileCategory===Rh.NONE)return[lh.PRIMARY_LINE_KEY];if(this.activeProfileCategory===Rh.IMAGE){const e=gC.Instance.spatialAndSpectalMatchedFileIds;return(null===e||void 0===e?void 0:e.includes(this.selectedFrameFileId))?e:[this.selectedFrameFileId]}return this.activeProfileCategory===Rh.REGION?this.selectedRegionIds:this.activeProfileCategory===Rh.STATISTIC?this.selectedStatsTypes:this.activeProfileCategory===Rh.STOKES?this.selectedCoordinates:void 0}get profileOptions(){return this.activeProfileCategory===Rh.NONE?[{value:lh.PRIMARY_LINE_KEY,label:lh.PRIMARY_LINE_KEY}]:this.activeProfileCategory===Rh.IMAGE?this.frameOptions:this.activeProfileCategory===Rh.REGION?this.regionOptions:this.activeProfileCategory===Rh.STATISTIC?this.statsTypeOptions:this.activeProfileCategory===Rh.STOKES?this.coordinateOptions:void 0}get frameOptions(){let e=[{value:Gr,label:"Active"}];const t=gC.Instance,i=t.frameOptions;if(this.activeProfileCategory===Rh.IMAGE){const n=t.spatialAndSpectalMatchedFileIds;if((null===n||void 0===n?void 0:n.length)>1&&(null===n||void 0===n?void 0:n.includes(t.activeFrameFileId))){let t=e.find((e=>e.value===Gr));t.label="Active (matched)",t.hightlight=!0}null===i||void 0===i||i.forEach((i=>{const r=(null===n||void 0===n?void 0:n.length)>1&&(null===n||void 0===n?void 0:n.includes(i.value));e.push({value:i.value,label:`${i.label}${r?" (matched)":""}`,hightlight:r,active:i.value===t.activeFrameFileId,disabled:!i.hasZAxis})}))}else e=e.concat(null===i||void 0===i?void 0:i.map((e=>({value:e.value,label:e.label,active:e.value===t.activeFrameFileId,disabled:!e.hasZAxis}))));return e}get regionOptions(){var e;let t=[{value:Br.ACTIVE,label:"Active",disabled:this.activeProfileCategory===Rh.REGION}];const i=this.selectedFrame;if(null===i||void 0===i||null===(e=i.regionSet)||void 0===e?void 0:e.regions){const e=gC.Instance,n=e.selectedRegion?e.selectedRegion.regionId:Br.CURSOR,r=i.regionSet.regions.filter((e=>!e.isTemporary&&(e.isClosedRegion||e.regionType===Nt.RegionType.POINT)));t=t.concat(null===r||void 0===r?void 0:r.map((e=>({value:e.regionId,label:e.nameString,active:this.widgetStore.isEffectiveFrameEqualToActiveFrame&&e.regionId===n}))))}return t}get statsTypeOptions(){var e;const t=null===(e=Array.from(jn.keys()))||void 0===e?void 0:e.sort(((e,t)=>e-t));return null===t||void 0===t?void 0:t.map((e=>({value:e,label:jn.get(e)})))}get coordinateOptions(){var e;let t=[{value:"z",label:"Current"}];var i;(null===(e=this.selectedFrame)||void 0===e?void 0:e.hasStokes)&&(null===(i=this.selectedFrame.polarizationInfo)||void 0===i||i.forEach((e=>t.push({value:`${e.replace("Stokes ","")}z`,label:e}))));return t}get selectedFrame(){return this.widgetStore.effectiveFrame}get selectedFrameFileId(){var e;return null===(e=this.selectedFrame)||void 0===e?void 0:e.frameInfo.fileId}get selectedFrameWidgetFileId(){return this.widgetStore.fileId}get effectiveRegionId(){return this.widgetStore.effectiveRegionId}get isSelectingActiveFrame(){return this.widgetStore.isEffectiveFrameEqualToActiveFrame&&this.selectedFrameWidgetFileId!==Gr}get isSelectingActiveRegion(){var e;const t=gC.Instance;if(this.widgetStore.isEffectiveFrameEqualToActiveFrame&&1===(null===(e=this.selectedRegionIds)||void 0===e?void 0:e.length)){return this.selectedRegionIds[0]===(t.selectedRegion?t.selectedRegion.regionId:Br.CURSOR)}return!1}get isStatsTypeSelectionAvailable(){if(this.selectedFrame){var e;if(this.activeProfileCategory===Rh.REGION)return null===(e=this.selectedRegionIds)||void 0===e?void 0:e.some((e=>{const t=this.selectedFrame.getRegion(e);return null===t||void 0===t?void 0:t.isClosedRegion}));{const e=this.widgetStore.effectiveRegion;return null===e||void 0===e?void 0:e.isClosedRegion}}return!1}get isStatsTypeFluxDensityOnly(){var e;return 1===(null===(e=this.selectedStatsTypes)||void 0===e?void 0:e.length)&&this.selectedStatsTypes[0]===Nt.StatsType.FluxDensity}get isStatsTypeSumSqOnly(){var e;return 1===(null===(e=this.selectedStatsTypes)||void 0===e?void 0:e.length)&&this.selectedStatsTypes[0]===Nt.StatsType.SumSq}get isSameStatsTypeUnit(){var e,t,i;return(null===(e=this.selectedStatsTypes)||void 0===e?void 0:e.length)<=1||!(null===(t=this.selectedStatsTypes)||void 0===t?void 0:t.includes(Nt.StatsType.FluxDensity))&&!(null===(i=this.selectedStatsTypes)||void 0===i?void 0:i.includes(Nt.StatsType.SumSq))}get effectivePolarizations(){const e=[];return this.selectedCoordinates&&this.selectedCoordinates.forEach((t=>{e.push("z"===t?this.widgetStore.effectiveFrame.requiredPolarization:er[t.substring(0,t.length-1)])})),e}get isCoordinatesPangleOnly(){var e;return!(null===(e=this.effectivePolarizations)||void 0===e?void 0:e.some((e=>er.Pangle!==e)))}get isCoordinatesPFtotalPFlinearOnly(){var e;return!(null===(e=this.effectivePolarizations)||void 0===e?void 0:e.some((e=>![er.PFtotal,er.PFlinear].includes(e))))}get isCoordinatesIncludingNonIntensityUnit(){return this.effectivePolarizations.some((e=>[er.PFtotal,er.PFlinear,er.Pangle].includes(e)))}get isSameCoordinatesUnit(){return this.isCoordinatesPFtotalPFlinearOnly||this.isCoordinatesPangleOnly||!this.isCoordinatesIncludingNonIntensityUnit}get isSingleProfileMode(){return this.activeProfileCategory===Rh.NONE}get isShowingProfilesOfMultiImages(){var e;return this.activeProfileCategory===Rh.IMAGE&&(null===(e=this.profiles)||void 0===e?void 0:e.length)>1}constructor(e,t){Object(f.a)(this,"activeProfileCategory",dh,this),Object(f.a)(this,"selectedRegionIds",ph,this),Object(f.a)(this,"selectedStatsTypes",hh,this),Object(f.a)(this,"selectedCoordinates",uh,this),this.widgetStore=void 0,this.DEFAULT_COORDINATE=void 0,this.getFormattedSpectralConfigs=()=>{let e=[];const t=this.profileConfigs;if((null===t||void 0===t?void 0:t.length)>0)if(this.activeProfileCategory===Rh.STATISTIC){let i=[];t.forEach((e=>i.push(e.statsType))),e.push({fileId:t[0].fileId,regionId:t[0].regionId,statsTypes:i,coordinate:t[0].coordinate})}else t.forEach((t=>{e.push({fileId:t.fileId,regionId:t.regionId,statsTypes:[t.statsType],coordinate:t.coordinate})}));return e},this.genProfileLabel=(e,t,i,n)=>({image:gC.Instance.getFrameName(e),plot:`${t}, Statistic ${xn(i)}, Cooridnate ${Jn.get(n.slice(0,n.length-1))}`}),Object(f.a)(this,"switchToSingleModeHandily",gh,this),Object(f.a)(this,"selectSingleRegionHandily",fh,this),Object(f.a)(this,"selectSingleStatHandily",bh,this),Object(f.a)(this,"selectSingleStokesHandily",mh,this),Object(f.a)(this,"setActiveProfileCategory",yh,this),Object(f.a)(this,"selectFrame",Oh,this),Object(f.a)(this,"selectRegionSingleMode",jh,this),Object(f.a)(this,"selectStatSingleMode",xh,this),Object(f.a)(this,"selectCoordinateSingleMode",Sh,this),Object(f.a)(this,"removeSelectedRegionMultiMode",vh,this),Object(f.a)(this,"selectRegionMultiMode",Ch,this),Object(f.a)(this,"selectStatMultiMode",Ih,this),Object(f.a)(this,"selectCoordinateMultiMode",wh,this),Object(f.a)(this,"initSingleMode",Th,this),Object(m.p)(this),this.widgetStore=e,this.DEFAULT_COORDINATE=t,this.initSingleMode(),Object(m.h)((()=>{this.selectedFrame||this.initSingleMode()})),Object(m.h)((()=>{var e,t,i,n;this.activeProfileCategory===Rh.REGION?(null===(e=this.selectedRegionIds)||void 0===e||e.forEach((e=>{var t;(null===(t=this.regionOptions)||void 0===t?void 0:t.find((t=>e===t.value)))||this.removeSelectedRegionMultiMode(e)})),0===(null===(t=this.selectedRegionIds)||void 0===t?void 0:t.length)&&this.selectRegionMultiMode(Br.CURSOR,0)):(null===(i=this.selectedRegionIds)||void 0===i?void 0:i.length)>0&&!(null===(n=this.regionOptions)||void 0===n?void 0:n.find((e=>this.selectedRegionIds[0]===e.value)))&&this.selectRegionSingleMode(Br.ACTIVE)})),Object(m.h)((()=>{var e;(null===(e=this.selectedCoordinates)||void 0===e?void 0:e.some((e=>{var t;return!(null===(t=this.coordinateOptions)||void 0===t?void 0:t.find((t=>e===t.value)))})))&&this.selectCoordinateSingleMode(this.DEFAULT_COORDINATE)})),Object(m.h)((()=>{const e=gC.Instance.spatialAndSpectalMatchedFileIds;(null===e||void 0===e?void 0:e.length)>1&&this.activeProfileCategory===Rh.IMAGE&&e.includes(this.selectedFrameFileId)&&e.forEach(((e,t)=>{const i=this.widgetStore,n=e===this.selectedFrameFileId?i.primaryLineColor:Zb(t+1);i.setProfileColor(e,n)}))}))}},dh=Object(b.a)(ch.prototype,"activeProfileCategory",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ph=Object(b.a)(ch.prototype,"selectedRegionIds",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hh=Object(b.a)(ch.prototype,"selectedStatsTypes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uh=Object(b.a)(ch.prototype,"selectedCoordinates",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(ch.prototype,"profileConfigs",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"profileConfigs"),ch.prototype),Object(b.a)(ch.prototype,"profiles",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"profiles"),ch.prototype),Object(b.a)(ch.prototype,"profilesPlotName",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"profilesPlotName"),ch.prototype),Object(b.a)(ch.prototype,"profileOrderedKeys",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"profileOrderedKeys"),ch.prototype),Object(b.a)(ch.prototype,"profileOptions",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"profileOptions"),ch.prototype),Object(b.a)(ch.prototype,"frameOptions",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"frameOptions"),ch.prototype),Object(b.a)(ch.prototype,"regionOptions",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"regionOptions"),ch.prototype),Object(b.a)(ch.prototype,"statsTypeOptions",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"statsTypeOptions"),ch.prototype),Object(b.a)(ch.prototype,"coordinateOptions",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"coordinateOptions"),ch.prototype),Object(b.a)(ch.prototype,"selectedFrame",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"selectedFrame"),ch.prototype),Object(b.a)(ch.prototype,"selectedFrameFileId",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"selectedFrameFileId"),ch.prototype),Object(b.a)(ch.prototype,"selectedFrameWidgetFileId",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"selectedFrameWidgetFileId"),ch.prototype),Object(b.a)(ch.prototype,"effectiveRegionId",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"effectiveRegionId"),ch.prototype),Object(b.a)(ch.prototype,"isSelectingActiveFrame",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isSelectingActiveFrame"),ch.prototype),Object(b.a)(ch.prototype,"isSelectingActiveRegion",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isSelectingActiveRegion"),ch.prototype),Object(b.a)(ch.prototype,"isStatsTypeSelectionAvailable",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isStatsTypeSelectionAvailable"),ch.prototype),Object(b.a)(ch.prototype,"isStatsTypeFluxDensityOnly",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isStatsTypeFluxDensityOnly"),ch.prototype),Object(b.a)(ch.prototype,"isStatsTypeSumSqOnly",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isStatsTypeSumSqOnly"),ch.prototype),Object(b.a)(ch.prototype,"isSameStatsTypeUnit",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isSameStatsTypeUnit"),ch.prototype),Object(b.a)(ch.prototype,"effectivePolarizations",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"effectivePolarizations"),ch.prototype),Object(b.a)(ch.prototype,"isCoordinatesPangleOnly",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isCoordinatesPangleOnly"),ch.prototype),Object(b.a)(ch.prototype,"isCoordinatesPFtotalPFlinearOnly",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isCoordinatesPFtotalPFlinearOnly"),ch.prototype),Object(b.a)(ch.prototype,"isCoordinatesIncludingNonIntensityUnit",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isCoordinatesIncludingNonIntensityUnit"),ch.prototype),Object(b.a)(ch.prototype,"isSameCoordinatesUnit",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isSameCoordinatesUnit"),ch.prototype),Object(b.a)(ch.prototype,"isSingleProfileMode",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isSingleProfileMode"),ch.prototype),Object(b.a)(ch.prototype,"isShowingProfilesOfMultiImages",[m.i],Object.getOwnPropertyDescriptor(ch.prototype,"isShowingProfilesOfMultiImages"),ch.prototype),gh=Object(b.a)(ch.prototype,"switchToSingleModeHandily",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e===Rh.REGION?this.selectSingleRegionHandily():e===Rh.STATISTIC?this.selectSingleStatHandily():e===Rh.STOKES&&this.selectSingleStokesHandily()}}}),fh=Object(b.a)(ch.prototype,"selectSingleRegionHandily",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e,t;1===(null===(e=this.selectedRegionIds)||void 0===e?void 0:e.length)?this.selectRegionSingleMode(this.selectedRegionIds[0]):(null===(t=this.selectedRegionIds)||void 0===t?void 0:t.length)>1&&this.selectRegionSingleMode(Br.ACTIVE)}}}),bh=Object(b.a)(ch.prototype,"selectSingleStatHandily",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e,t;1===(null===(e=this.selectedStatsTypes)||void 0===e?void 0:e.length)?this.selectStatSingleMode(this.selectedStatsTypes[0]):(null===(t=this.selectedStatsTypes)||void 0===t?void 0:t.length)>1&&this.selectStatSingleMode(Nt.StatsType.Mean)}}}),mh=Object(b.a)(ch.prototype,"selectSingleStokesHandily",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e,t;1===(null===(e=this.selectedCoordinates)||void 0===e?void 0:e.length)?this.selectCoordinateSingleMode(this.selectedCoordinates[0]):(null===(t=this.selectedCoordinates)||void 0===t?void 0:t.length)>1&&this.selectCoordinateSingleMode(this.DEFAULT_COORDINATE)}}}),yh=Object(b.a)(ch.prototype,"setActiveProfileCategory",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this.activeProfileCategory)return;this.activeProfileCategory!==Rh.REGION&&this.activeProfileCategory!==Rh.STATISTIC&&this.activeProfileCategory!==Rh.STOKES||this.switchToSingleModeHandily(this.activeProfileCategory),this.activeProfileCategory=e;const t=this.widgetStore,i=t.primaryLineColor;if(t.clearProfileColors(),e===Rh.NONE)t.setProfileColor(lh.PRIMARY_LINE_KEY,i);else if(e===Rh.IMAGE)this.selectedFrame&&(this.selectedFrame.setSpectralCoordinateToRadioVelocity(),t.setProfileColor(this.selectedFrameFileId,i));else if(e===Rh.REGION){var n;(null===(n=this.selectedRegionIds)||void 0===n?void 0:n.length)>0&&(this.selectedRegionIds[0]===Br.ACTIVE&&this.selectRegionSingleMode(this.effectiveRegionId),t.setProfileColor(this.selectedRegionIds[0],i))}else if(e===Rh.STATISTIC){var r;(null===(r=this.selectedStatsTypes)||void 0===r?void 0:r.length)>0&&t.setProfileColor(this.selectedStatsTypes[0],i)}else if(e===Rh.STOKES){var o;(null===(o=this.selectedCoordinates)||void 0===o?void 0:o.length)>0&&t.setProfileColor(this.selectedCoordinates[0],i)}}}}),Oh=Object(b.a)(ch.prototype,"selectFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.widgetStore;t.setFileId(e);const i=this.activeProfileCategory===Rh.REGION?this.effectiveRegionId:Br.ACTIVE;t.setRegionId(e,i),this.selectedRegionIds=[i]}}}),jh=Object(b.a)(ch.prototype,"selectRegionSingleMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.widgetStore;t.setFileId(this.selectedFrameFileId),t.setRegionId(this.selectedFrameFileId,e),this.selectedRegionIds=[e]}}}),xh=Object(b.a)(ch.prototype,"selectStatSingleMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{On.includes(e)&&(this.selectedStatsTypes=[e])}}}),Sh=Object(b.a)(ch.prototype,"selectCoordinateSingleMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{tr.includes(e)&&(this.selectedCoordinates=[e])}}}),vh=Object(b.a)(ch.prototype,"removeSelectedRegionMultiMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;(null===(t=this.selectedRegionIds)||void 0===t?void 0:t.includes(e))&&(this.selectedRegionIds=this.selectedRegionIds.filter((t=>t!==e)),this.widgetStore.removeProfileColor(e))}}}),Ch=Object(b.a)(ch.prototype,"selectRegionMultiMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i,n,r,o;if((null===(i=this.selectedRegionIds)||void 0===i?void 0:i.includes(e))&&(null===(n=this.selectedRegionIds)||void 0===n?void 0:n.length)>1)this.removeSelectedRegionMultiMode(e);else if(!(null===(r=this.selectedRegionIds)||void 0===r?void 0:r.includes(e))&&(null===(o=this.selectedRegionIds)||void 0===o?void 0:o.length)<10){this.selectedRegionIds=[...this.selectedRegionIds,e].sort(((e,t)=>e-t));const i=1===this.selectedRegionIds.length?this.widgetStore.primaryLineColor:Zb(t);this.widgetStore.setProfileColor(e,i)}}}}),Ih=Object(b.a)(ch.prototype,"selectStatMultiMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i,n,r,o;if(On.includes(e))if((null===(i=this.selectedStatsTypes)||void 0===i?void 0:i.includes(e))&&(null===(n=this.selectedStatsTypes)||void 0===n?void 0:n.length)>1)this.selectedStatsTypes=this.selectedStatsTypes.filter((t=>t!==e)),this.widgetStore.removeProfileColor(e);else if(!(null===(r=this.selectedStatsTypes)||void 0===r?void 0:r.includes(e))&&(null===(o=this.selectedStatsTypes)||void 0===o?void 0:o.length)<10){this.selectedStatsTypes=[...this.selectedStatsTypes,e].sort(((e,t)=>e-t));const i=1===this.selectedStatsTypes.length?this.widgetStore.primaryLineColor:Zb(t);this.widgetStore.setProfileColor(e,i)}}}}),wh=Object(b.a)(ch.prototype,"selectCoordinateMultiMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i,n;if(tr.includes(e))if((null===(i=this.selectedCoordinates)||void 0===i?void 0:i.includes(e))&&this.selectedCoordinates.length>1)this.selectedCoordinates=this.selectedCoordinates.filter((t=>t!==e)),this.widgetStore.removeProfileColor(e);else if(!this.selectedCoordinates.includes(e)&&(null===(n=this.selectedCoordinates)||void 0===n?void 0:n.length)<10){this.selectedCoordinates=[...this.selectedCoordinates,e].sort(((e,t)=>"z"===e?-1:"z"===t?1:e.charCodeAt(0)-t.charCodeAt(0)));const i=1===this.selectedCoordinates.length?this.widgetStore.primaryLineColor:Zb(t);this.widgetStore.setProfileColor(e,i)}}}}),Th=Object(b.a)(ch.prototype,"initSingleMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.activeProfileCategory=Rh.NONE,this.selectedRegionIds=[Br.ACTIVE],this.selectedStatsTypes=[Nt.StatsType.Mean],this.selectedCoordinates=[this.DEFAULT_COORDINATE];const e=this.widgetStore;e.clearProfileColors(),e.setProfileColor(lh.PRIMARY_LINE_KEY,e.primaryLineColor)}}}),ch);var Ph,Eh,Mh,Fh,kh,Dh;let Lh;!function(e){e[e.MATCHING=0]="MATCHING",e[e.REST_FREQ=1]="REST_FREQ"}(Lh||(Lh={}));let Nh=(Ph=class{get restFreqFrameOptions(){var e;const t=gC.Instance;let i=[{label:"Active",frameIndex:-1,active:!1,disable:!1}];return null===(e=t.frames)||void 0===e||e.forEach(((e,n)=>{i.push({label:n+": "+e.filename+(n===t.activeFrameIndex?" (Active)":""),frameIndex:n,active:n===t.activeFrameIndex,disable:!e.isRestFreqEditable})})),i}constructor(){Object(f.a)(this,"settingsTabId",Eh,this),Object(f.a)(this,"selectedFrameIndex",Mh,this),Object(f.a)(this,"setSettingsTabId",Fh,this),Object(f.a)(this,"setSelectedFrameIndex",kh,this),Object(f.a)(this,"resetSelectedFrameIndex",Dh,this),Object(m.p)(this)}},Eh=Object(b.a)(Ph.prototype,"settingsTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Lh.MATCHING}}),Mh=Object(b.a)(Ph.prototype,"selectedFrameIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),Fh=Object(b.a)(Ph.prototype,"setSettingsTabId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),kh=Object(b.a)(Ph.prototype,"setSelectedFrameIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFrameIndex=e}}}),Dh=Object(b.a)(Ph.prototype,"resetSelectedFrameIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedFrameIndex=-1}}}),Object(b.a)(Ph.prototype,"restFreqFrameOptions",[m.i],Object.getOwnPropertyDescriptor(Ph.prototype,"restFreqFrameOptions"),Ph.prototype),Ph);var _h,zh,Vh,Wh,Gh;let Bh=(_h=class extends Hr{get regionOptions(){const e=gC.Instance;let t=[{value:Br.ACTIVE,label:"Active"}];if(e.frames){const r=e.getFrame(this.fileId);if(null===r||void 0===r?void 0:r.regionSet){var i,n;const e=null===(i=r.regionSet.regions)||void 0===i||null===(n=i.filter((e=>!e.isTemporary&&e.regionType===Nt.RegionType.LINE)))||void 0===n?void 0:n.map((e=>({value:null===e||void 0===e?void 0:e.regionId,label:null===e||void 0===e?void 0:e.nameString})));e&&(t=t.concat(e))}}return t}constructor(){super(qr.LINE),Object(f.a)(this,"width",zh,this),Object(f.a)(this,"requestPV",Vh,this),Object(f.a)(this,"requestingPVCancelled",Wh,this),Object(f.a)(this,"setWidth",Gh,this),Object(m.p)(this),this.width=3}},zh=Object(b.a)(_h.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(_h.prototype,"regionOptions",[m.i],Object.getOwnPropertyDescriptor(_h.prototype,"regionOptions"),_h.prototype),Vh=Object(b.a)(_h.prototype,"requestPV",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;if(e&&this.effectiveRegion){const t={fileId:e.frameInfo.fileId,regionId:this.effectiveRegionId,width:this.width};e.resetPvRequestState(),e.setIsRequestingPV(!0),gC.Instance.requestPV(t,e)}}}}),Wh=Object(b.a)(_h.prototype,"requestingPVCancelled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&(gC.Instance.cancelRequestingPV(e.frameInfo.fileId),e.setIsRequestPVCancelling(!0))}}}),Gh=Object(b.a)(_h.prototype,"setWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.width=e}}}),_h);var qh,Hh,Yh,Uh,Xh,$h,Kh,Qh,Zh,Jh,eu,tu,iu,nu,ru,ou,su,au,lu,cu,du,pu,hu,uu,gu,fu,bu,mu,yu,Ou,ju,xu,Su,vu,Cu,Iu,wu,Tu,Ru,Au,Pu,Eu,Mu,Fu,ku,Du,Lu,Nu,_u,zu,Vu,Wu,Gu,Bu,qu,Hu,Yu,Uu,Xu,$u,Ku,Qu,Zu,Ju,eg,tg,ig,ng,rg,og,sg,ag,lg,cg,dg,pg,hg,ug,gg,fg,bg,mg,yg,Og,jg,xg;const Sg=10;let vg=(xg=jg=class e{get filename(){var e,t,i,n,r,o,s;const a=(null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t||null===(i=t.computedEntries)||void 0===i?void 0:i.length)>=3&&"Extension name"===(null===(n=this.frameInfo)||void 0===n||null===(r=n.fileInfoExtended)||void 0===r||null===(o=r.computedEntries[2])||void 0===o?void 0:o.name)?`_${null===(s=this.frameInfo.fileInfoExtended.computedEntries[2])||void 0===s?void 0:s.value}`:"";return this.frameInfo.hdu&&""!==this.frameInfo.hdu&&"0"!==this.frameInfo.hdu?`${this.frameInfo.fileInfo.name}.HDU_${this.frameInfo.hdu}${a}`:this.frameInfo.fileInfo.name}get centerMovement(){return nm(this.initialCenter,this.center)}get regionSet(){return this.spatialReference?this.spatialReference.regionSet:this.frameRegionSet}get sharedRegions(){return!!this.spatialReference}get maxMip(){return Math.pow(2,Math.ceil(Math.log2(this.frameInfo.fileInfoExtended.width/hx)))}get aspectRatio(){return isFinite(this.framePixelRatio)?this.framePixelRatio:this.overlayStore.renderWidth/this.frameInfo.fileInfoExtended.width/(this.overlayStore.renderHeight/this.frameInfo.fileInfoExtended.height)}get hasSquarePixels(){return!!isFinite(this.framePixelRatio)&&1===this.framePixelRatio}get unitFrameView(){const e=this.renderHiDPI?devicePixelRatio*gC.Instance.imageRatio:1,t=e*this.renderWidth/this.aspectRatio,i=e*this.renderHeight,n=JA.Instance.lowBandwidthMode?2:1,r=Math.max(1,n),o=Math.log2(r),s=Math.round(o),a=Math.pow(2,s);return{xMin:this.initialCenter.x-t/2,xMax:this.initialCenter.x+t/2,yMin:this.initialCenter.y-i/2,yMax:this.initialCenter.y+i/2,mip:a}}get requiredFrameView(){if(this.spatialReference){const e=this.spatialReference.requiredFrameView,t=[this.spatialTransform.transformCoordinate({x:e.xMin,y:e.yMin},!1),this.spatialTransform.transformCoordinate({x:e.xMin,y:e.yMax},!1),this.spatialTransform.transformCoordinate({x:e.xMax,y:e.yMax},!1),this.spatialTransform.transformCoordinate({x:e.xMax,y:e.yMin},!1)],{minPoint:i,maxPoint:n}=hm(t),r=(JA.Instance.lowBandwidthMode?2:1)/this.spatialTransform.scale,o=Math.max(1,r/this.spatialReference.zoomLevel),s=Math.log2(o),a=Math.round(s);return{xMin:i.x,xMax:n.x,yMin:i.y,yMax:n.y,mip:Math.pow(2,a)}}{if(this.zoomLevel<=0||!this.isRenderable)return{xMin:0,xMax:1,yMin:0,yMax:1,mip:1};const e=this.renderHiDPI?devicePixelRatio*gC.Instance.imageRatio:1,t=e*this.renderWidth/this.zoomLevel/this.aspectRatio,i=e*this.renderHeight/this.zoomLevel,n=JA.Instance.lowBandwidthMode?2:1,r=Math.max(1,n/this.zoomLevel),o=Math.log2(r),s=Math.round(o),a=Math.pow(2,s);return{xMin:this.center.x-t/2,xMax:this.center.x+t/2,yMin:this.center.y-i/2,yMax:this.center.y+i/2,mip:a}}}get spatialTransform(){if(this.spatialReference&&this.spatialTransformAST){const e=Mm(this.spatialTransformAST,this.spatialReference.center,!1);return zm(e)?new Ii(this.spatialTransformAST,{x:this.frameInfo.fileInfoExtended.width/2+.5,y:this.frameInfo.fileInfoExtended.height/2+.5}):new Ii(this.spatialTransformAST,e)}return null}get transformedWcsInfo(){if(this.spatialTransform){let e={x:-this.spatialTransform.translation.x/this.spatialTransform.scale,y:-this.spatialTransform.translation.y/this.spatialTransform.scale};return e=dm(e,-this.spatialTransform.rotation),this.cachedTransformedWcsInfo>0&&Pt.deleteObject(this.cachedTransformedWcsInfo),this.cachedTransformedWcsInfo=Pt.createTransformedFrameset(this.wcsInfo,e.x,e.y,-this.spatialTransform.rotation,this.spatialTransform.origin.x,this.spatialTransform.origin.y,1/this.spatialTransform.scale,1/this.spatialTransform.scale),this.cachedTransformedWcsInfo}return null}get renderWidth(){return this.overlayStore.renderWidth}get renderHeight(){return this.overlayStore.renderHeight}get isRenderable(){return this.renderWidth>0&&this.renderHeight>0}get headerUnit(){if(this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.headerEntries){const t=this.frameInfo.fileInfoExtended.headerEntries.filter((e=>"BUNIT"===e.name));var e;return t.length?null===(e=nn(t[0].value))||void 0===e?void 0:e.replace(/^"+|"+$/g,""):void 0}}get requiredUnit(){if(this.headerUnit)return this.requiredPolarization===er.Pangle?"degree":this.requiredPolarization===er.PFtotal||this.requiredPolarization===er.PFlinear?"%":this.headerUnit}get beamProperties(){const e=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CUNIT1"))),t=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CDELT1")));if(e&&t){const i=e.value.trim(),n=Em(t);if(isFinite(n)&&("deg"===i||"rad"===i)&&this.frameInfo.beamTable&&this.frameInfo.beamTable.length>0){let e;if(1===this.frameInfo.beamTable.length&&-1===this.frameInfo.beamTable[0].channel&&-1===this.frameInfo.beamTable[0].stokes?e=this.frameInfo.beamTable[0]:this.frameInfo.fileInfoExtended.depth>1&&this.frameInfo.fileInfoExtended.stokes>1?e=this.frameInfo.beamTable.find((e=>e.channel===this.requiredChannel&&e.stokes===this.requiredStokes)):this.frameInfo.fileInfoExtended.depth>1&&this.frameInfo.fileInfoExtended.stokes<=1?e=this.frameInfo.beamTable.find((e=>e.channel===this.requiredChannel)):this.frameInfo.fileInfoExtended.depth<=1&&this.frameInfo.fileInfoExtended.stokes>1&&(e=this.frameInfo.beamTable.find((e=>e.stokes===this.requiredStokes))),e&&isFinite(e.majorAxis)&&e.majorAxis>0&&isFinite(e.minorAxis)&&e.minorAxis>0&&isFinite(e.pa))return{x:e.majorAxis/("deg"===i?3600:648e3/Math.PI)/Math.abs(n),y:e.minorAxis/("deg"===i?3600:648e3/Math.PI)/Math.abs(n),majorAxis:e.majorAxis,minorAxis:e.minorAxis,angle:e.pa,overlayBeamSettings:this.overlayBeamSettings}}}return null}get hasVisibleBeam(){var e,t;return null===(e=this.beamProperties)||void 0===e||null===(t=e.overlayBeamSettings)||void 0===t?void 0:t.visible}get channelInfo(){if(!this.frameInfo||!this.frameInfo.fileInfoExtended||this.frameInfo.fileInfoExtended.depth<=1||!this.frameInfo.fileInfoExtended.headerEntries)return;const e=this.frameInfo.fileInfoExtended.depth,t=new Array(e),i=new Array(e),n=new Array(e);let r=t=>{if(!t)return null;if(t<0)return 0;if(t>e-1)return e-1;const i=Math.ceil(t),n=Math.floor(t);return i-t<t-n?i:n};if(this.spectralAxis){const o=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRPIX${this.spectralAxis.dimension}`))),s=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRVAL${this.spectralAxis.dimension}`))),a=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CDELT${this.spectralAxis.dimension}`)));if(o&&s&&a){const l=Em(o)-1,c=Em(s),d=Em(a);if(isFinite(l)&&isFinite(c)&&isFinite(d)){for(let r=0;r<e;r++){const e=r-l;t[r]=r,n[r]=e*d+c,i[r]=n[r]}return{fromWCS:!0,indexes:t,delta:d,values:i,rawValues:n,getChannelIndexWCS:e=>{if(!e)return null;const t=(e-c)/d+l;if(t<0)return 0;if(t>i.length-1)return i.length-1;const n=Math.ceil(t),r=Math.floor(t);return Math.abs(i[n]-e)<Math.abs(e-i[r])?n:r},getChannelIndexSimple:r}}}}for(let o=0;o<e;o++)t[o]=o,i[o]=o,n[o]=o;return{fromWCS:!1,delta:void 0,indexes:t,values:i,rawValues:n,getChannelIndexWCS:null,getChannelIndexSimple:r}}get spectralInfo(){const e={channel:this.channel,spectralString:""};if(this.frameInfo.fileInfoExtended.depth>1){var t;const o=this.channelInfo,s=null===(t=this.spectralAxis)||void 0===t?void 0:t.type;var i,n,r;if(s)if(e.spectralString=`${s.name} (${null!==(i=null===(n=this.spectralAxis)||void 0===n?void 0:n.specsys)&&void 0!==i?i:""}): ${fi(o.values[this.channel],4)} ${null!==(r=s.unit)&&void 0!==r?r:""}`,"FREQ"===s.code){this.restFreqStore.restFreqInHz;const t=o.rawValues[this.channel];if(this.isSpectralCoordinateConvertible&&s.unit!==Kt.get(Wt.FREQ)){const i=this.astSpectralTransform(Wt.FREQ,qt.GHZ,this.spectralSystem,t);isFinite(i)&&(e.spectralString=`Frequency (${this.spectralSystem}): ${yi(i)}`)}const i=this.astSpectralTransform(Wt.VRAD,qt.KMS,this.spectralSystem,t);isFinite(i)&&(e.velocityString=`Velocity: ${fi(i,4)} km/s`)}else if("VRAD"===s.code){const t=o.rawValues[this.channel];if(this.isSpectralCoordinateConvertible&&s.unit!==Kt.get(Wt.VRAD)){const i=this.astSpectralTransform(Wt.VRAD,qt.KMS,this.spectralSystem,t);isFinite(i)&&(e.spectralString=`Velocity (${this.spectralSystem}): ${fi(i,4)} km/s`)}const i=this.astSpectralTransform(Wt.FREQ,qt.GHZ,this.spectralSystem,t);isFinite(i)&&(e.freqString=`Frequency: ${yi(i)}`)}}return e}get simpleSpectralInfo(){var e,t;const i=this.spectralInfo.freqString?this.spectralInfo.freqString:this.spectralInfo.velocityString;return`${null===(e=this.spectralInfo.spectralString)||void 0===e||null===(t=e.replace(/\w+\s\(/,""))||void 0===t?void 0:t.replace(/\):\s/,"\n")}${null===i||void 0===i?void 0:i.replace(/\w+:\s/,"\n")}`}get isPVImage(){var e,t;if(null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t?void 0:t.headerEntries){var i;const e=this.frameInfo.fileInfoExtended.headerEntries.find((e=>e.name.includes("CTYPE1")));return!!(null===e||void 0===e||null===(i=e.value)||void 0===i?void 0:i.match(/offset|position|offset position/i))}return!1}get isUVImage(){return void 0!==this.uvAxis}get uvAxis(){var e,t;if(null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t?void 0:t.headerEntries){var i,n;const e=this.frameInfo.fileInfoExtended.headerEntries,t=e.find((e=>e.name.includes("CTYPE1"))),r=e.find((e=>e.name.includes("CTYPE2")));if(null===t||void 0===t||null===(i=t.value)||void 0===i?void 0:i.match(/uu/i))return 1;if(null===r||void 0===r||null===(n=r.value)||void 0===n?void 0:n.match(/uu/i))return 2}}get spectralAxis(){var e,t;if(null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t?void 0:t.headerEntries){const e=this.frameInfo.fileInfoExtended.headerEntries;let t;if(this.isPVImage){const i=e.find((e=>e.name.includes("CTYPE2"))),n=e.find((e=>e.name.includes("CTYPE3")));i&&!i.value.match(/stokes/i)?t=2:n&&!n.value.match(/stokes/i)&&(t=3)}else{const i=e.find((e=>e.name.includes("CTYPE3"))),n=e.find((e=>e.name.includes("CTYPE4")));i&&!i.value.match(/stokes/i)?t=3:n&&!n.value.match(/stokes/i)&&(t=4)}if(t){var i;const a=e.find((e=>e.name.includes(`CTYPE${t}`))),l=null===a||void 0===a?void 0:a.value.trim().toUpperCase(),c=zt.find((e=>l===e.code)),d=e.find((e=>e.name.includes(`CRVAL${t}`))),p=e.find((e=>e.name.includes(`CUNIT${t}`))),h=e.find((e=>e.name.includes("SPECSYS"))),u=(null===h||void 0===h?void 0:h.value)?null===(i=nn(h.value))||void 0===i?void 0:i.toUpperCase():void 0;var n,r,o,s;return c?{valid:!0,dimension:t,type:{name:c.name,code:c.code,unit:null!==(n=null===p||void 0===p||null===(r=p.value)||void 0===r?void 0:r.trim())&&void 0!==n?n:c.unit},specsys:u,value:Em(d)}:{valid:!1,dimension:t,type:{name:l,code:l,unit:null!==(o=null===p||void 0===p||null===(s=p.value)||void 0===s?void 0:s.trim())&&void 0!==o?o:void 0},specsys:u,value:Em(d)}}}}get isSpectralCoordinateConvertible(){return!(!this.spectralAxis||this.spectralAxis&&!this.spectralAxis.valid||!this.spectralFrame)&&(Gt(this.spectralAxis.type.code)&&Yt(this.spectralAxis.type.unit))}get isSpectralSystemConvertible(){return!(!this.spectralAxis||!this.spectralFrame)&&Xt(this.spectralAxis.specsys)}get isSpectralPropsEqual(){var e,t;let i=!1;if((null===(e=this.spectralAxis)||void 0===e?void 0:e.type)&&(null===(t=this.spectralAxis)||void 0===t?void 0:t.specsys)){const e=this.spectralAxis.type.code===this.spectralType,t=this.spectralAxis.type.unit===this.spectralUnit,n=this.spectralAxis.specsys===this.spectralSystem;i=e&&t&&n}return i}get isRestFreqEditable(){var e,t,i,n,r,o,s,a;return((null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t?void 0:t.depth)>1||this.isPVImage)&&((null===(i=this.spectralAxis)||void 0===i||null===(n=i.type)||void 0===n?void 0:n.code)===Wt.FREQ||(null===(r=this.spectralAxis)||void 0===r||null===(o=r.type)||void 0===o?void 0:o.code)===Wt.WAVE||(null===(s=this.spectralAxis)||void 0===s||null===(a=s.type)||void 0===a?void 0:a.code)===Wt.AWAV)}get isCoordChannel(){return this.spectralType===Wt.CHANNEL}get isCoordVelocity(){return this.spectralType===Wt.VRAD||this.spectralType===Wt.VOPT}get nativeSpectralCoordinate(){return this.spectralAxis?`${this.spectralAxis.type.name}${this.spectralAxis.type.unit?` (${this.spectralAxis.type.unit})`:""}`:void 0}get spectralCoordinate(){return this.spectralType||this.spectralUnit?Qt(this.spectralType,this.spectralUnit):this.nativeSpectralCoordinate}get spectralLabel(){let e;if(this.spectralAxis){var t;const i=this.isSpectralSystemConvertible?this.spectralSystem:this.spectralAxis.specsys;e=`${i?`[${i}] `:""}${null!==(t=this.spectralCoordinate)&&void 0!==t?t:""}`}return e}get spectralUnitStr(){return!this.spectralAxis||this.spectralType||this.spectralUnit?this.isCoordChannel?$t.get(Wt.CHANNEL):this.spectralUnit:this.spectralAxis.type.unit}get hasStokes(){return this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.stokes>1}get numChannels(){return this.frameInfo.fileInfoExtended.depth}get channelValueBounds(){if(this.numChannels>1&&this.channelValues){const e=this.channelValues[0],t=this.channelValues[this.numChannels-1];return new Nt.FloatBounds(e<=t?{min:e,max:t}:{min:t,max:e})}return null}get spectralSiblings(){if(this.spectralReference){let e=[];return e.push(this.spectralReference),e.push(...this.spectralReference.secondarySpectralImages.slice().filter((e=>e!==this))),e}return this.secondarySpectralImages.slice()}get spatialSiblings(){if(this.spatialReference){let e=[];return e.push(this.spatialReference),e.push(...this.spatialReference.secondarySpatialImages.slice().filter((e=>e!==this))),e}return this.secondarySpatialImages.slice()}get renderConfigSiblings(){if(this.rasterScalingReference){let e=[];return e.push(this.rasterScalingReference),e.push(...this.rasterScalingReference.secondaryRasterScalingImages.slice().filter((e=>e!==this))),e}return this.secondaryRasterScalingImages.slice()}get isCursorValueCurrent(){if(!this.cursorValue||!this.cursorInfo)return!1;const e=Om(this.cursorInfo.posImageSpace),t=Om(this.cursorValue.position);return this.cursorValue.channel===this.channel&&e.x===t.x&&e.y===t.y}get zoomLevelForFit(){return Math.min(this.calculateZoomX,this.calculateZoomY)}get calculateZoomX(){const e=this.frameInfo.fileInfoExtended.width,t=(this.renderHiDPI?devicePixelRatio*gC.Instance.imageRatio:1)/this.aspectRatio;return e<=0?1:this.renderWidth*t/e}get calculateZoomY(){const e=this.frameInfo.fileInfoExtended.height,t=this.renderHiDPI?devicePixelRatio*gC.Instance.imageRatio:1;return e<=0?1:this.renderHeight*t/e}get contourProgress(){if(!this.contourConfig.levels||!this.contourConfig.levels.length||!this.contourConfig.enabled)return-1;if(!this.contourStores||!this.contourStores.size)return 0;let e=0;return this.contourStores.forEach(((t,i)=>{-1!==this.contourConfig.levels.indexOf(i)&&(e+=t.progress)})),e/(this.contourConfig.levels?this.contourConfig.levels.length:1)}get stokesOptions(){let e=[];if(this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.headerEntries){const t=this.frameInfo.fileInfoExtended.headerEntries.find((e=>"STOKES"===e.value.toUpperCase()));if(t&&-1!==t.name.indexOf("CTYPE")){const i=t.name.substring(5),n=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`NAXIS${i}`))),r=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRPIX${i}`))),o=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRVAL${i}`))),s=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CDELT${i}`)));if(!n||!r||!o||!s)return[];for(let t=0;t<parseInt(n.value);t++){const i=Em(o)+(t+1-Em(r))*Em(s);Kn.has(i)&&e.push({value:i,label:Jn.get(Kn.get(i))})}}}return e}get hasLinearStokes(){const e=this.stokesOptions,t=Jn.get("Q"),i=Jn.get("U");return!!e.find((e=>e.label===t))&&!!e.find((e=>e.label===i))}get stokesInfo(){var e;return null===(e=this.stokesOptions)||void 0===e?void 0:e.map((e=>null===e||void 0===e?void 0:e.label))}get polarizations(){var e;const t=null===(e=this.stokesOptions)||void 0===e?void 0:e.map((e=>e.value)),i=t.includes(er.I),n=t.includes(er.Q),r=t.includes(er.U),o=t.includes(er.V);return n&&r&&(o&&t.push(er.Ptotal),t.push(er.Plinear),i&&o&&t.push(er.PFtotal),i&&t.push(er.PFlinear),t.push(er.Pangle)),t}get polarizationInfo(){var e;return null===(e=this.polarizations)||void 0===e?void 0:e.map((e=>Jn.get(Zn.get(e))))}get coordinateOptions(){var e;return null===(e=this.polarizations)||void 0===e?void 0:e.map((e=>({value:Zn.get(e),label:Jn.get(Zn.get(e))})))}get coordinateOptionsZ(){var e;return null===(e=this.polarizations)||void 0===e?void 0:e.map((e=>({value:Zn.get(e)+"z",label:Jn.get(Zn.get(e))})))}get requiredPolarization(){var e;return null===(e=this.polarizations)||void 0===e?void 0:e[this.requiredPolarizationIndex]}get requiredPolarizationInfo(){var e;return null===(e=this.polarizationInfo)||void 0===e?void 0:e[this.requiredPolarizationIndex]}get requiredPolarizationIndex(){return Qn.has(this.requiredStokes)&&this.polarizations.includes(this.requiredStokes)?this.polarizations.indexOf(this.requiredStokes):this.requiredStokes}get headerRestFreq(){var e,t,i,n;return null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t||null===(i=t.headerEntries)||void 0===i||null===(n=i.find((e=>"RESTFRQ"===e.name)))||void 0===n?void 0:n.numericValue}constructor(t){this.spectralFrame=void 0,this.controlMaps=void 0,this.catalogControlMaps=void 0,this.framePixelRatio=void 0,this.backendService=void 0,this.overlayStore=void 0,this.logStore=void 0,this.initialCenter=void 0,this.pixelUnitSizeArcsec=void 0,this.spectralTransformAST=void 0,this.cachedTransformedWcsInfo=-1,this.zoomTimeoutHandler=void 0,this.requiredFrameViewForRegionRender=void 0,this.wcsInfo=void 0,this.wcsInfoForTransformation=void 0,this.wcsInfo3D=void 0,this.validWcs=void 0,this.frameInfo=void 0,this.colorbarStore=void 0,this.spectralCoordsSupported=void 0,this.spectralSystemsSupported=void 0,this.spatialTransformAST=void 0,this.cursorMovementHandle=void 0,this.distanceMeasuring=void 0,this.restFreqStore=void 0,this.renderConfig=void 0,this.contourConfig=void 0,this.vectorOverlayConfig=void 0,this.vectorOverlayStore=void 0,Object(f.a)(this,"frameRegionSet",Hh,this),Object(f.a)(this,"renderHiDPI",Yh,this),Object(f.a)(this,"spectralType",Uh,this),Object(f.a)(this,"spectralUnit",Xh,this),Object(f.a)(this,"spectralSystem",$h,this),Object(f.a)(this,"channelValues",Kh,this),Object(f.a)(this,"center",Qh,this),Object(f.a)(this,"cursorInfo",Zh,this),Object(f.a)(this,"cursorValue",Jh,this),Object(f.a)(this,"cursorMoving",eu,this),Object(f.a)(this,"zoomLevel",tu,this),Object(f.a)(this,"stokes",iu,this),Object(f.a)(this,"channel",nu,this),Object(f.a)(this,"requiredStokes",ru,this),Object(f.a)(this,"requiredChannel",ou,this),Object(f.a)(this,"animationChannelRange",su,this),Object(f.a)(this,"currentFrameView",au,this),Object(f.a)(this,"currentCompressionQuality",lu,this),Object(f.a)(this,"contourStores",cu,this),Object(f.a)(this,"moving",du,this),Object(f.a)(this,"zooming",pu,this),Object(f.a)(this,"colorbarLabelCustomText",hu,this),Object(f.a)(this,"titleCustomText",uu,this),Object(f.a)(this,"overlayBeamSettings",gu,this),Object(f.a)(this,"spatialReference",fu,this),Object(f.a)(this,"spectralReference",bu,this),Object(f.a)(this,"rasterScalingReference",mu,this),Object(f.a)(this,"secondarySpatialImages",yu,this),Object(f.a)(this,"secondarySpectralImages",Ou,this),Object(f.a)(this,"secondaryRasterScalingImages",ju,this),Object(f.a)(this,"momentImages",xu,this),Object(f.a)(this,"pvImage",Su,this),Object(f.a)(this,"generatedPVRegionId",vu,this),Object(f.a)(this,"fittingResult",Cu,this),Object(f.a)(this,"fittingLog",Iu,this),Object(f.a)(this,"isRequestingMoments",wu,this),Object(f.a)(this,"requestingMomentsProgress",Tu,this),Object(f.a)(this,"isRequestingPV",Ru,this),Object(f.a)(this,"requestingPVProgress",Au,this),Object(f.a)(this,"isRequestPVCancelling",Pu,this),Object(f.a)(this,"stokesFiles",Eu,this),this.convertSpectral=e=>{if(!(null===e||void 0===e?void 0:e.length)||!this.spectralFrame)return null;const t=Pt.transformSpectralPointArray(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e);return Array.from(t)},this.astSpectralTransform=(e,t,i,n)=>{if(this.spectralFrame&&isFinite(n))return Pt.transformSpectralPoint(this.spectralFrame,e,t,i,n)},this.initPVFrame=()=>{var t;const i=null===(t=this.spectralAxis)||void 0===t?void 0:t.dimension;if(!this.isPVImage||2!==i&&3!==i)return;const n=Pt.emptyFitsChan();for(let r of this.frameInfo.fileInfoExtended.headerEntries){if(r.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[4-9]/))continue;let t=r.name;if(2===i){if(r.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[3]/))continue}else{if(r.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[2]/))continue;r.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[3]/)&&(t=r.name.replace("3","2"))}let o=nn(r.value);for("NAXIS"!==r.name.toUpperCase()&&"WCSAXES"!==r.name.toUpperCase()||(o="2"),o=r.entryType===Nt.EntryType.STRING?`'${o}'`:e.ShiftASTCoords(r,o);t.length<8;)t+=" ";const s=`${t}=  ${o}`;Pt.putFits(n,s)}return Pt.getFrameFromFitsChan(n,!1)},this.initFrame2D=()=>{const t=Pt.emptyFitsChan();for(let i of this.frameInfo.fileInfoExtended.headerEntries){if(i.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[3-9]/))continue;let n=i.name,r=nn(i.value);for("NAXIS"!==i.name.toUpperCase()&&"WCSAXES"!==i.name.toUpperCase()||(r="2"),r=i.entryType===Nt.EntryType.STRING?`'${r}'`:e.ShiftASTCoords(i,r);n.length<8;)n+=" ";const o=`${n}=  ${r}`;Pt.putFits(t,o)}return Pt.getFrameFromFitsChan(t,!1)},this.initFrame=(t=!0)=>{const i=this.frameInfo.fileInfoExtended.depth>1?"3":"2",n=Pt.emptyFitsChan();for(let a of this.frameInfo.fileInfoExtended.headerEntries){let t=a.name;if("2"===i){if(a.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[3-9]/))continue}else{var r,o,s;if(a.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[5-9]/)||3===(null===(r=this.spectralAxis)||void 0===r?void 0:r.dimension)&&a.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)4/)||4===(null===(o=this.spectralAxis)||void 0===o?void 0:o.dimension)&&a.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)3/))continue;4===(null===(s=this.spectralAxis)||void 0===s?void 0:s.dimension)&&a.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)4/)&&(t=a.name.replace("4","3"))}if(!a.value.length)continue;let l=nn(a.value);for("NAXIS"!==a.name.toUpperCase()&&"WCSAXES"!==a.name.toUpperCase()||(l=i),l=a.entryType===Nt.EntryType.STRING?`'${l}'`:e.ShiftASTCoords(a,l);t.length<8;)t+=" ";const c=`${t}=  ${l}`;Pt.putFits(n,c)}return Pt.getFrameFromFitsChan(n,t)},this.replaceZoomTimeoutHandler=()=>{this.zoomTimeoutHandler&&clearTimeout(this.zoomTimeoutHandler),this.zoomTimeoutHandler=setTimeout((()=>Object(m.t)((()=>{this.zooming=!1}))),e.ZoomInertiaDuration)},this.getPixelUnitSize=()=>{if(this.isPVImage||this.isUVImage)return null;const e=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CRPIX1"))),t=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CRPIX2")));if(e&&t){const i=Em(e),n=Em(t),r=Math.round(1e6*Pt.geodesicDistance(this.wcsInfo,i,n,i+1,n))/1e6,o=Math.round(1e6*Pt.geodesicDistance(this.wcsInfo,i,n,i,n+1))/1e6;if(isFinite(r)&&isFinite(o))return{x:r,y:o}}return null},this.getRegion=e=>{var t,i;return null===(t=this.regionSet)||void 0===t||null===(i=t.regions)||void 0===i?void 0:i.find((t=>t.regionId===e))},this.convertToNativeWCS=e=>{if(this.spectralFrame&&isFinite(e))return Pt.transformSpectralPoint(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e,!1)},this.convertFreqMHzToSettingWCS=e=>{if(!this.spectralFrame||!isFinite(e))return;if(this.spectralType===Wt.FREQ&&this.spectralUnit===qt.MHZ)return e;const t=Pt.transformSpectralPoint(this.spectralFrame,Wt.FREQ,qt.MHZ,this.spectralSystem,e,!1);if(!isFinite(t))return;const i=this.astSpectralTransform(this.spectralType,this.spectralUnit,this.spectralSystem,t);return isFinite(i)?i:void 0},Object(f.a)(this,"setColorbarLabelCustomText",Mu,this),Object(f.a)(this,"setTitleCustomText",Fu,this),this.findChannelIndexByValue=e=>{if(null!==e&&void 0!==e&&isFinite(e)&&this.channelInfo){if(this.isCoordChannel)return this.channelInfo.getChannelIndexSimple(e);if(this.spectralAxis&&!this.spectralAxis.valid||this.isSpectralPropsEqual)return this.channelInfo.getChannelIndexWCS(e);{const t=Pt.transformSpectralPoint(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e,!1);return this.channelInfo.getChannelIndexWCS(t)}}},Object(f.a)(this,"initSupportedSpectralConversion",ku,this),Object(f.a)(this,"initCenter",Du,this),Object(f.a)(this,"setSpectralCoordinateToRadioVelocity",Lu,this),Object(f.a)(this,"setSpectralCoordinate",Nu,this),Object(f.a)(this,"setSpectralSystem",_u,this),Object(f.a)(this,"updateCursorRegion",zu,this),Object(f.a)(this,"fitZoom",Vu,this),Object(f.a)(this,"setAnimationRange",Wu,this),Object(f.a)(this,"startMoving",Gu,this),Object(f.a)(this,"endMoving",Bu,this),Object(f.a)(this,"applyContours",qu,this),Object(f.a)(this,"clearContours",Hu,this),Object(f.a)(this,"applyVectorOverlay",Yu,this),Object(f.a)(this,"clearVectorOverlay",Uu,this),Object(f.a)(this,"setSpatialReference",Xu,this),Object(f.a)(this,"clearSpatialReference",$u,this),Object(f.a)(this,"addSecondarySpatialImage",Ku,this),Object(f.a)(this,"removeSecondarySpatialImage",Qu,this),Object(f.a)(this,"setSpectralReference",Zu,this),Object(f.a)(this,"clearSpectralReference",Ju,this),Object(f.a)(this,"addSecondarySpectralImage",eg,this),Object(f.a)(this,"removeSecondarySpectralImage",tg,this),Object(f.a)(this,"setRasterScalingReference",ig,this),Object(f.a)(this,"addSecondaryRasterScalingImage",ng,this),Object(f.a)(this,"removeSecondaryRasterScalingImage",rg,this),Object(f.a)(this,"addMomentImage",og,this),Object(f.a)(this,"removeMomentImage",sg,this),Object(f.a)(this,"setIsRequestingMoments",ag,this),Object(f.a)(this,"updateRequestingMomentsProgress",lg,this),Object(f.a)(this,"resetMomentRequestState",cg,this),Object(f.a)(this,"setStokesFiles",dg,this),Object(f.a)(this,"addPvImage",pg,this),Object(f.a)(this,"removePvImage",hg,this),Object(f.a)(this,"setIsRequestingPV",ug,this),Object(f.a)(this,"updateRequestingPvProgress",gg,this),Object(f.a)(this,"resetPvRequestState",fg,this),Object(f.a)(this,"setGeneratedPVRegionId",bg,this),Object(f.a)(this,"setIsRequestPVCancelling",mg,this),Object(f.a)(this,"setFittingResult",yg,this),Object(f.a)(this,"setFittingLog",Og,this),Object(m.p)(this),this.overlayStore=bA.Instance,this.logStore=qI.Instance,this.backendService=tx.Instance;const i=JA.Instance;this.spectralFrame=null,this.spectralType=null,this.spectralUnit=null,this.spectralSystem=null,this.channelValues=null,this.spectralCoordsSupported=null,this.spectralSystemsSupported=null,this.wcsInfo=null,this.wcsInfoForTransformation=null,this.wcsInfo3D=null,this.validWcs=!1,this.frameInfo=t,this.initialCenter={x:(this.frameInfo.fileInfoExtended.width-1)/2,y:(this.frameInfo.fileInfoExtended.height-1)/2},this.renderHiDPI=!0,this.center={x:0,y:0},this.stokes=0,this.channel=0,this.requiredStokes=0,this.requiredChannel=0,this.renderConfig=new Af(i,this),this.colorbarStore=new N(this),this.contourConfig=new ve(i),this.contourStores=new Map,this.vectorOverlayConfig=new yt(i,this),this.vectorOverlayStore=new Me(this),this.moving=!1,this.zooming=!1,this.colorbarLabelCustomText=void 0!==this.requiredUnit&&this.requiredUnit.length?this.requiredUnit:"arbitrary units",this.titleCustomText="",this.overlayBeamSettings=new Ng,this.spatialReference=null,this.spatialTransformAST=null,this.catalogControlMaps=new Map,this.controlMaps=new Map,this.secondarySpatialImages=[],this.secondarySpectralImages=[],this.secondaryRasterScalingImages=[],this.momentImages=[],this.pvImage=null,this.fittingResult="",this.fittingLog="",this.isRequestingMoments=!1,this.requestingMomentsProgress=0,this.isRequestingPV=!1,this.requestingPVProgress=0,this.cursorMovementHandle=null,this.stokesFiles=[],this.distanceMeasuring=new Et;const n=i.astColor;n!==this.overlayStore.global.color&&this.overlayStore.global.setColor(n);const r=i.astGridVisible;r!==this.overlayStore.grid.visible&&this.overlayStore.grid.setVisible(r);const o=i.astLabelsVisible;o!==this.overlayStore.labels.visible&&this.overlayStore.labels.setVisible(o);const s=i.colorbarVisible;s!==this.overlayStore.colorbar.visible&&this.overlayStore.colorbar.setVisible(s);const a=i.colorbarInteractive;a!==this.overlayStore.colorbar.interactive&&this.overlayStore.colorbar.setInteractive(a);const l=i.colorbarPosition;l!==this.overlayStore.colorbar.position&&this.overlayStore.colorbar.setPosition(l);const c=i.colorbarWidth;c!==this.overlayStore.colorbar.width&&this.overlayStore.colorbar.setWidth(c);const d=i.colorbarTicksDensity;d!==this.overlayStore.colorbar.tickDensity&&this.overlayStore.colorbar.setTickDensity(d);const p=i.colorbarLabelVisible;if(p!==this.overlayStore.colorbar.labelVisible&&this.overlayStore.colorbar.setLabelVisible(p),this.frameRegionSet=new Wb(this,JA.Instance,tx.Instance),this.currentFrameView={xMin:0,xMax:0,yMin:0,yMax:0,mip:999},this.animationChannelRange=[0,t.fileInfoExtended.depth-1],this.isPVImage){const e=this.initPVFrame();e&&(this.spectralFrame=Pt.getSpectralFrame(e),this.wcsInfo=Pt.copy(e),Pt.deleteObject(e))}else if(this.isUVImage){const e=this.initFrame(!1),i=this.initFrame2D();e&&i&&(this.spectralFrame=Pt.getSpectralFrame(e),t.fileInfoExtended.depth>1?(this.wcsInfo3D=Pt.copy(e),this.wcsInfo=Pt.copy(i)):this.wcsInfo=Pt.copy(e)),Pt.deleteObject(e),Pt.deleteObject(i)}else{const e=this.initFrame();e&&(this.spectralFrame=Pt.getSpectralFrame(e),t.fileInfoExtended.depth>1?(this.wcsInfo3D=Pt.copy(e),this.wcsInfo=Pt.getSkyFrameSet(this.wcsInfo3D)):this.wcsInfo=Pt.copy(e),Pt.deleteObject(e),this.wcsInfo&&(this.wcsInfoForTransformation=Pt.copy(this.wcsInfo),Pt.set(this.wcsInfoForTransformation,`Format(1)=${gC.Instance.overlayStore.numbers.formatTypeX}.10`),Pt.set(this.wcsInfoForTransformation,`Format(2)=${gC.Instance.overlayStore.numbers.formatTypeY}.10`),this.validWcs=!0,this.overlayStore.setDefaultsFromAST(this)))}this.wcsInfo||(this.logStore.addWarning(`Problem processing headers in file ${this.filename} for AST`,["ast"]),this.wcsInfo=Pt.initDummyFrame());const h=this.frameInfo.fileInfoExtended.headerEntries.find((e=>"CUNIT1"===e.name)),u=this.frameInfo.fileInfoExtended.headerEntries.find((e=>"CUNIT2"===e.name)),g=h&&u,b=g&&nn(h.value)===nn(u.value);if(g&&!b)this.framePixelRatio=NaN;else{const e=Fm(this,1),t=Fm(this,2);this.framePixelRatio=Math.abs(e/t),Math.abs(this.framePixelRatio-1)<.001&&(this.framePixelRatio=1)}const y=this.headerRestFreq;this.restFreqStore=new Df(y),this.initSupportedSpectralConversion(),this.initCenter(),this.zoomLevel=i.isZoomRAWMode?1:this.zoomLevelForFit,this.pixelUnitSizeArcsec=this.getPixelUnitSize(),this.spectralAxis&&Gt(this.spectralAxis.type.code)&&Yt(this.spectralAxis.type.unit)&&(this.isPVImage?this.spectralType=Wt.VRAD:this.spectralType=this.spectralAxis.type.code,this.spectralUnit=Kt.get(this.spectralType)),this.isSpectralSystemConvertible&&(this.spectralSystem=this.spectralAxis.specsys),this.cursorInfo=this.getCursorInfo(this.center),this.cursorValue={position:{x:NaN,y:NaN},channel:0,value:NaN},this.cursorMoving=!1,Object(m.s)((()=>this.restFreqStore.restFreqInHz),(e=>{if(!this.restFreqStore.inValidInput&&isFinite(e))if(this.wcsInfo3D&&Pt.set(this.wcsInfo3D,`RestFreq=${e} Hz`),this.spectralFrame&&Pt.set(this.spectralFrame,`RestFreq=${e} Hz`),this.spectralReference){const e=this.spectralReference;this.clearSpectralReference(),this.setSpectralReference(e)}else if(this.secondarySpectralImages.length>0)for(const t of this.secondarySpectralImages)t.clearSpectralReference(),t.setSpectralReference(this)})),Object(m.h)((()=>{this.requiredFrameView&&(this.requiredFrameViewForRegionRender=this.requiredFrameView)})),Object(m.h)((()=>{this.isRenderable&&this.zoomLevel<=0&&this.setZoom(this.zoomLevelForFit)})),Object(m.h)((()=>{const e=this.spectralType,t=this.spectralUnit;this.spectralSystem,this.restFreqStore.restFreqInHz;this.channelInfo&&(e||t?this.isCoordChannel?this.setChannelValues(this.channelInfo.indexes):this.setChannelValues(this.isSpectralPropsEqual?this.channelInfo.values:this.convertSpectral(this.channelInfo.values)):this.setChannelValues(this.channelInfo.values))})),Object(m.h)((()=>{this.distanceMeasuring.updateTransformedPos(this.spatialTransform)}))}sanitizeChannelNumber(e){return isFinite(e)?Math.round(Gi(e,0,this.frameInfo.fileInfoExtended.depth-1)):this.requiredChannel}getCursorInfo(t){let i,n;if(this.validWcs||this.isPVImage||this.isUVImage){const r=[[0,0],[1,1],[-1,-1]].map((e=>Mm(this.wcsInfo,{x:t.x+e[0],y:t.y+e[1]})));i=r[0];const o=r.map((e=>Pt.normalizeCoordinates(this.wcsInfo,e.x,e.y)));let s=0,a=0;for(;s<e.CursorInfoMaxPrecision&&a<e.CursorInfoMaxPrecision;){let e=new oA;e.add("Format(1)",this.isPVImage||this.isUVImage?void 0:this.overlayStore.numbers.cursorFormatStringX(s)),e.add("Format(2)",this.isPVImage||this.isUVImage?void 0:this.overlayStore.numbers.cursorFormatStringY(a)),e.add("System",this.isPVImage||this.isUVImage?"cartesian":this.overlayStore.global.explicitSystem);let t=o.map((t=>Pt.getFormattedCoordinates(this.wcsInfo,t.x,t.y,e.toString(),!0))),[i,r,l]=t;if(!i.x||!i.y||"<bad>"===i.x||"<bad>"===i.y){n=null;break}if(i.x!==r.x&&i.x!==l.x&&i.y!==r.y&&i.y!==l.y){n={x:i.x,y:i.y};break}i.x!==r.x&&i.x!==l.x||(s+=1),i.y!==r.y&&i.y!==l.y||(a+=1)}}const r=Math.round(t.x),o=Math.round(t.y),s=r>=0&&r<this.frameInfo.fileInfoExtended.width&&o>=0&&o<this.frameInfo.fileInfoExtended.height;return{posImageSpace:t,isInsideImage:s,posWCS:i,infoWCS:n}}getControlMap(e){const t=JA.Instance;let i=this.controlMaps.get(e);if(!i){const n=performance.now();i=new bn(this,e,-1,t.contourControlMapWidth,t.contourControlMapWidth),this.controlMaps.set(e,i);const r=performance.now()-n;console.log(`Created ${t.contourControlMapWidth}x${t.contourControlMapWidth} transform grid for ${this.frameInfo.fileId} -> ${e.frameInfo.fileId} in ${r} ms`)}return i}removeControlMap(e){const t=xx.Instance.gl,i=this.controlMaps.get(e);if(i&&t&&i.hasTextureForContext(t)){const e=i.getTextureX(t);t.deleteTexture(e)}this.controlMaps.delete(e)}getCatalogControlMap(e){const t=JA.Instance;let i=this.catalogControlMaps.get(e);if(!i){const n=performance.now();i=new Cn(this,e,-1,t.contourControlMapWidth,t.contourControlMapWidth),this.catalogControlMaps.set(e,i);const r=performance.now()-n;console.log(`Created ${t.contourControlMapWidth}x${t.contourControlMapWidth} transform grid for ${this.frameInfo.fileId} -> ${e.frameInfo.fileId} in ${r} ms`)}return i}removeCatalogControlMap(e){const t=Tx.Instance.gl,i=this.catalogControlMaps.get(e);if(i&&t&&i.hasTextureForContext(t)){const e=i.getTextureX(t);t.deleteTexture(e)}this.catalogControlMaps.delete(e)}getWcsSizeInArcsec(e){return e&&this.pixelUnitSizeArcsec?(t=e,i=this.pixelUnitSizeArcsec,{x:t.x*i.x,y:t.y*i.y}):null;var t,i}getImageXValueFromArcsec(e){var t;return isFinite(e)&&isFinite(null===(t=this.pixelUnitSizeArcsec)||void 0===t?void 0:t.x)?e/this.pixelUnitSizeArcsec.x:null}getImageYValueFromArcsec(e){var t;return isFinite(e)&&isFinite(null===(t=this.pixelUnitSizeArcsec)||void 0===t?void 0:t.y)?e/this.pixelUnitSizeArcsec.y:null}getRegionProperties(e){let t=[];const i=this.getRegion(e);return i&&(t.push(i.regionProperties),this.validWcs&&t.push(this.getRegionWcsProperties(i))),t}getRegionWcsProperties(e){var t,i,n,r,o,s,a,l;if(!this.validWcs||!isFinite(e.center.x)||!isFinite(e.center.y))return"Invalid";const c=km(this.wcsInfoForTransformation,e.center);if(!c)return"Invalid";const d=e.regionId===Br.CURSOR?`${null===(t=this.cursorInfo)||void 0===t||null===(i=t.infoWCS)||void 0===i?void 0:i.x}, ${null===(n=this.cursorInfo)||void 0===n||null===(r=n.infoWCS)||void 0===r?void 0:r.y}`:`${c.x}, ${c.y}`,p=this.getWcsSizeInArcsec(e.size),h={x:ji(null===p||void 0===p?void 0:p.x,Sg),y:ji(null===p||void 0===p?void 0:p.y,Sg)},u=bA.Instance.global.explicitSystem;switch(e.regionType){case Nt.RegionType.POINT:return`Point (wcs:${u}) [${d}]`;case Nt.RegionType.LINE:const t=km(this.wcsInfoForTransformation,e.controlPoints[0]),i=km(this.wcsInfoForTransformation,e.controlPoints[1]);return`Line (wcs:${u}) [[${t.x}, ${t.y}], [${i.x}, ${i.y}]]`;case Nt.RegionType.RECTANGLE:return`rotbox(wcs:${u})[[${d}], [${null!==(o=h.x)&&void 0!==o?o:""}, ${null!==(s=h.y)&&void 0!==s?s:""}], ${fi(e.rotation,6)}deg]`;case Nt.RegionType.ELLIPSE:return`ellipse(wcs:${u})[[${d}], [${null!==(a=h.x)&&void 0!==a?a:""}, ${null!==(l=h.y)&&void 0!==l?l:""}], ${fi(e.rotation,6)}deg]`;case Nt.RegionType.POLYGON:let n=`poly(wcs:${u})[`;return e.controlPoints.forEach(((t,i)=>{const r=isFinite(t.x)&&isFinite(t.y)?km(this.wcsInfoForTransformation,t):null;n+=r?`[${r.x}, ${r.y}]`:"[Invalid]",n+=i!==e.controlPoints.length-1?", ":"]"})),n;case Nt.RegionType.POLYLINE:let r=`Polyline (wcs:${u})[`;return e.controlPoints.forEach(((t,i)=>{const n=isFinite(t.x)&&isFinite(t.y)?km(this.wcsInfoForTransformation,t):null;r+=n?`[${n.x}, ${n.y}]`:"[Invalid]",r+=i!==e.controlPoints.length-1?", ":"]"})),r;default:return"Not Implemented"}}setChannelValues(e){this.channelValues=e}updateFromContourData(e){const t=$m.ProcessContourData(e);this.stokes=t.stokes,this.channel=t.channel;dS.Instance.serverAnimationActive&&(this.requiredChannel=t.channel,this.requiredStokes=t.stokes);for(const i of t.contourSets){let e=this.contourStores.get(i.level);e||(e=new $,this.contourStores.set(i.level,e)),!e.isComplete&&t.progress>0?e.addContourData(i.indexOffsets,i.coordinates,t.progress):e.setContourData(i.indexOffsets,i.coordinates,t.progress)}this.contourStores.forEach(((e,t)=>{-1===this.contourConfig.levels.indexOf(t)&&this.contourStores.delete(t)}))}updateFromVectorOverlayData(e){!this.vectorOverlayStore.isComplete&&e.progress>0?this.vectorOverlayStore.addData(e.intensityTiles,e.angleTiles,e.progress):this.vectorOverlayStore.setData(e.intensityTiles,e.angleTiles,e.progress)}setChannels(e,t,i){t<0&&(t+=this.frameInfo.fileInfoExtended.stokes),t>=this.frameInfo.fileInfoExtended.stokes&&!Qn.get(t)&&(t=0);const n=this.sanitizeChannelNumber(e);this.requiredStokes!==t&&(this.renderConfig.setUseCubeHistogram(!1),this.renderConfig.updateCubeHistogram(null,0)),this.requiredChannel=n,this.requiredStokes=t,i&&this.spectralSiblings.forEach((e=>{const t=Lm(this.wcsInfo3D,e.wcsInfo3D,JA.Instance.spectralMatchingType,n);e.setChannels(t,e.requiredStokes,!1)}))}incrementChannels(e,t,i=!0){var n;const r=Math.max(1,this.frameInfo.fileInfoExtended.depth),o=Math.max(1,null===(n=this.polarizations)||void 0===n?void 0:n.length);let s=this.requiredChannel+e,a=this.requiredPolarizationIndex+t;i?(s=(s+r)%r,a=(a+o)%o):(s=Gi(s,0,r-1),a=Gi(a,0,o-1));const l=a>=this.frameInfo.fileInfoExtended.stokes;this.setChannels(s,l?this.polarizations[a]:a,!0)}setZoom(e,t=!1){if(this.spatialReference){const i=t?e:e/this.spatialTransform.scale;this.spatialReference.setZoom(i)}else this.zoomLevel=e,this.replaceZoomTimeoutHandler(),this.zooming=!0}setCenter(e,t,i=!0){if(this.spatialReference){let n={x:e,y:t};i&&(n=this.spatialTransform.transformCoordinate({x:e,y:t},!0)),this.spatialReference.setCenter(n.x,n.y)}else this.center={x:e,y:t}}setCursorPosition(t){if(this.spatialReference)this.spatialReference.setCursorPosition(Mm(this.spatialTransformAST,t,!0));else{this.cursorInfo=this.getCursorInfo(t);for(const e of this.secondarySpatialImages){const i=Mm(e.spatialTransformAST,t,!1);e.cursorInfo=e.getCursorInfo(i)}}this.cursorMoving=!0,clearTimeout(this.cursorMovementHandle),this.cursorMovementHandle=setTimeout((()=>Object(m.t)((()=>{this.cursorMoving=!1}))),e.CursorMovementDuration)}setCursorValue(e,t,i){this.cursorValue={position:e,channel:t,value:i}}zoomToPoint(e,t,i,n=!1){if(this.spatialReference){const r=n?i:i/this.spatialTransform.scale,o=Mm(this.spatialTransformAST,{x:e,y:t},!0);this.spatialReference.zoomToPoint(o.x,o.y,r)}else JA.Instance.zoomPoint===Ei.CURSOR&&(this.center={x:e+this.zoomLevel/i*(this.center.x-e),y:t+this.zoomLevel/i*(this.center.y-t)}),this.setZoom(i)}clearRasterScalingReference(){this.rasterScalingReference&&(this.rasterScalingReference.removeSecondaryRasterScalingImage(this),this.rasterScalingReference=null)}},jg.CursorInfoMaxPrecision=25,jg.ZoomInertiaDuration=250,jg.CursorMovementDuration=250,jg.ShiftASTCoords=(e,t)=>{if(e.name.match(/CRPIX\d+/)){const t=parseFloat(e.value);if(isFinite(t))return(t-1).toString()}return t},qh=xg,Hh=Object(b.a)(qh.prototype,"frameRegionSet",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yh=Object(b.a)(qh.prototype,"renderHiDPI",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uh=Object(b.a)(qh.prototype,"spectralType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xh=Object(b.a)(qh.prototype,"spectralUnit",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$h=Object(b.a)(qh.prototype,"spectralSystem",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kh=Object(b.a)(qh.prototype,"channelValues",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qh=Object(b.a)(qh.prototype,"center",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zh=Object(b.a)(qh.prototype,"cursorInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jh=Object(b.a)(qh.prototype,"cursorValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eu=Object(b.a)(qh.prototype,"cursorMoving",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tu=Object(b.a)(qh.prototype,"zoomLevel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iu=Object(b.a)(qh.prototype,"stokes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nu=Object(b.a)(qh.prototype,"channel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ru=Object(b.a)(qh.prototype,"requiredStokes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ou=Object(b.a)(qh.prototype,"requiredChannel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),su=Object(b.a)(qh.prototype,"animationChannelRange",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),au=Object(b.a)(qh.prototype,"currentFrameView",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lu=Object(b.a)(qh.prototype,"currentCompressionQuality",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cu=Object(b.a)(qh.prototype,"contourStores",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),du=Object(b.a)(qh.prototype,"moving",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pu=Object(b.a)(qh.prototype,"zooming",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hu=Object(b.a)(qh.prototype,"colorbarLabelCustomText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uu=Object(b.a)(qh.prototype,"titleCustomText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gu=Object(b.a)(qh.prototype,"overlayBeamSettings",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fu=Object(b.a)(qh.prototype,"spatialReference",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bu=Object(b.a)(qh.prototype,"spectralReference",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mu=Object(b.a)(qh.prototype,"rasterScalingReference",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yu=Object(b.a)(qh.prototype,"secondarySpatialImages",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ou=Object(b.a)(qh.prototype,"secondarySpectralImages",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ju=Object(b.a)(qh.prototype,"secondaryRasterScalingImages",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xu=Object(b.a)(qh.prototype,"momentImages",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Su=Object(b.a)(qh.prototype,"pvImage",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vu=Object(b.a)(qh.prototype,"generatedPVRegionId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cu=Object(b.a)(qh.prototype,"fittingResult",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Iu=Object(b.a)(qh.prototype,"fittingLog",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wu=Object(b.a)(qh.prototype,"isRequestingMoments",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tu=Object(b.a)(qh.prototype,"requestingMomentsProgress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ru=Object(b.a)(qh.prototype,"isRequestingPV",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Au=Object(b.a)(qh.prototype,"requestingPVProgress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pu=Object(b.a)(qh.prototype,"isRequestPVCancelling",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eu=Object(b.a)(qh.prototype,"stokesFiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(qh.prototype,"filename",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"filename"),qh.prototype),Object(b.a)(qh.prototype,"centerMovement",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"centerMovement"),qh.prototype),Object(b.a)(qh.prototype,"regionSet",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"regionSet"),qh.prototype),Object(b.a)(qh.prototype,"sharedRegions",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"sharedRegions"),qh.prototype),Object(b.a)(qh.prototype,"maxMip",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"maxMip"),qh.prototype),Object(b.a)(qh.prototype,"aspectRatio",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"aspectRatio"),qh.prototype),Object(b.a)(qh.prototype,"unitFrameView",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"unitFrameView"),qh.prototype),Object(b.a)(qh.prototype,"requiredFrameView",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"requiredFrameView"),qh.prototype),Object(b.a)(qh.prototype,"spatialTransform",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spatialTransform"),qh.prototype),Object(b.a)(qh.prototype,"transformedWcsInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"transformedWcsInfo"),qh.prototype),Object(b.a)(qh.prototype,"renderWidth",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"renderWidth"),qh.prototype),Object(b.a)(qh.prototype,"renderHeight",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"renderHeight"),qh.prototype),Object(b.a)(qh.prototype,"isRenderable",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isRenderable"),qh.prototype),Object(b.a)(qh.prototype,"requiredUnit",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"requiredUnit"),qh.prototype),Object(b.a)(qh.prototype,"beamProperties",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"beamProperties"),qh.prototype),Object(b.a)(qh.prototype,"hasVisibleBeam",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"hasVisibleBeam"),qh.prototype),Object(b.a)(qh.prototype,"channelInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"channelInfo"),qh.prototype),Object(b.a)(qh.prototype,"spectralInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spectralInfo"),qh.prototype),Object(b.a)(qh.prototype,"simpleSpectralInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"simpleSpectralInfo"),qh.prototype),Object(b.a)(qh.prototype,"isPVImage",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isPVImage"),qh.prototype),Object(b.a)(qh.prototype,"isUVImage",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isUVImage"),qh.prototype),Object(b.a)(qh.prototype,"uvAxis",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"uvAxis"),qh.prototype),Object(b.a)(qh.prototype,"spectralAxis",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spectralAxis"),qh.prototype),Object(b.a)(qh.prototype,"isSpectralCoordinateConvertible",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isSpectralCoordinateConvertible"),qh.prototype),Object(b.a)(qh.prototype,"isSpectralSystemConvertible",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isSpectralSystemConvertible"),qh.prototype),Object(b.a)(qh.prototype,"isSpectralPropsEqual",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isSpectralPropsEqual"),qh.prototype),Object(b.a)(qh.prototype,"isRestFreqEditable",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isRestFreqEditable"),qh.prototype),Object(b.a)(qh.prototype,"isCoordChannel",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isCoordChannel"),qh.prototype),Object(b.a)(qh.prototype,"isCoordVelocity",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isCoordVelocity"),qh.prototype),Object(b.a)(qh.prototype,"nativeSpectralCoordinate",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"nativeSpectralCoordinate"),qh.prototype),Object(b.a)(qh.prototype,"spectralCoordinate",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spectralCoordinate"),qh.prototype),Object(b.a)(qh.prototype,"spectralLabel",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spectralLabel"),qh.prototype),Object(b.a)(qh.prototype,"spectralUnitStr",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spectralUnitStr"),qh.prototype),Object(b.a)(qh.prototype,"hasStokes",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"hasStokes"),qh.prototype),Object(b.a)(qh.prototype,"numChannels",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"numChannels"),qh.prototype),Object(b.a)(qh.prototype,"channelValueBounds",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"channelValueBounds"),qh.prototype),Object(b.a)(qh.prototype,"spectralSiblings",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spectralSiblings"),qh.prototype),Object(b.a)(qh.prototype,"spatialSiblings",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"spatialSiblings"),qh.prototype),Object(b.a)(qh.prototype,"renderConfigSiblings",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"renderConfigSiblings"),qh.prototype),Object(b.a)(qh.prototype,"isCursorValueCurrent",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"isCursorValueCurrent"),qh.prototype),Object(b.a)(qh.prototype,"zoomLevelForFit",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"zoomLevelForFit"),qh.prototype),Object(b.a)(qh.prototype,"calculateZoomX",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"calculateZoomX"),qh.prototype),Object(b.a)(qh.prototype,"calculateZoomY",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"calculateZoomY"),qh.prototype),Object(b.a)(qh.prototype,"contourProgress",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"contourProgress"),qh.prototype),Object(b.a)(qh.prototype,"stokesOptions",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"stokesOptions"),qh.prototype),Object(b.a)(qh.prototype,"hasLinearStokes",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"hasLinearStokes"),qh.prototype),Object(b.a)(qh.prototype,"stokesInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"stokesInfo"),qh.prototype),Object(b.a)(qh.prototype,"polarizations",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"polarizations"),qh.prototype),Object(b.a)(qh.prototype,"polarizationInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"polarizationInfo"),qh.prototype),Object(b.a)(qh.prototype,"coordinateOptions",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"coordinateOptions"),qh.prototype),Object(b.a)(qh.prototype,"coordinateOptionsZ",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"coordinateOptionsZ"),qh.prototype),Object(b.a)(qh.prototype,"requiredPolarization",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"requiredPolarization"),qh.prototype),Object(b.a)(qh.prototype,"requiredPolarizationInfo",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"requiredPolarizationInfo"),qh.prototype),Object(b.a)(qh.prototype,"requiredPolarizationIndex",[m.i],Object.getOwnPropertyDescriptor(qh.prototype,"requiredPolarizationIndex"),qh.prototype),Mu=Object(b.a)(qh.prototype,"setColorbarLabelCustomText",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorbarLabelCustomText=e}}}),Fu=Object(b.a)(qh.prototype,"setTitleCustomText",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.titleCustomText=e}}}),Object(b.a)(qh.prototype,"setChannelValues",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"setChannelValues"),qh.prototype),ku=Object(b.a)(qh.prototype,"initSupportedSpectralConversion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.channelInfo&&this.spectralAxis&&!this.spectralAxis.valid)return this.setChannelValues(this.channelInfo.values),this.spectralCoordsSupported=new Map([[this.nativeSpectralCoordinate,{type:null,unit:null}],[$t.get(Wt.CHANNEL),{type:Wt.CHANNEL,unit:null}]]),void(this.spectralSystemsSupported=[]);if(!this.spectralAxis||!this.spectralFrame)return this.spectralCoordsSupported=null,void(this.spectralSystemsSupported=null);const e=this.frameInfo.fileInfoExtended.headerEntries,t=this.spectralAxis.type.code;Gt(t)?isFinite(this.headerRestFreq)?this.spectralCoordsSupported=Zt:(this.spectralCoordsSupported=new Map,Array.from(Zt.keys()).forEach((e=>{const i=Zt.get(e),n=t===Wt.VRAD||t===Wt.VOPT,r=i.type===Wt.VRAD||i.type===Wt.VOPT;n&&r&&this.spectralCoordsSupported.set(e,i),n||r||this.spectralCoordsSupported.set(e,i)})),this.spectralCoordsSupported.set($t.get(Wt.CHANNEL),{type:Wt.CHANNEL,unit:null})):this.spectralCoordsSupported=new Map([[$t.get(Wt.CHANNEL),{type:Wt.CHANNEL,unit:null}]]);const i=this.spectralAxis.specsys;if(Xt(i)){const t=e.find((e=>-1!==e.name.indexOf("DATE-OBS"))),n=e.find((e=>-1!==e.name.indexOf("OBSGEO-X"))),r=e.find((e=>-1!==e.name.indexOf("OBSGEO-Y"))),o=e.find((e=>-1!==e.name.indexOf("OBSGEO-Z")));i===Ut.LSRK||i===Ut.LSRD?this.spectralSystemsSupported=t&&n&&r&&o?[Ut.LSRK,Ut.LSRD,Ut.BARY,Ut.TOPO]:!t||n&&r&&o?[Ut.LSRK,Ut.LSRD]:[Ut.LSRK,Ut.LSRD,Ut.BARY]:i===Ut.BARY?this.spectralSystemsSupported=t&&n&&r&&o?[Ut.LSRK,Ut.LSRD,Ut.BARY,Ut.TOPO]:!t||n&&r&&o?[Ut.BARY]:[Ut.LSRK,Ut.LSRD,Ut.BARY]:this.spectralSystemsSupported=t&&n&&r&&o?[Ut.LSRK,Ut.LSRD,Ut.BARY,Ut.TOPO]:[Ut.TOPO]}else this.spectralSystemsSupported=[]}}}),Du=Object(b.a)(qh.prototype,"initCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.center.x=(this.frameInfo.fileInfoExtended.width-1)/2,this.center.y=(this.frameInfo.fileInfoExtended.height-1)/2}}}),Lu=Object(b.a)(qh.prototype,"setSpectralCoordinateToRadioVelocity",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;const t=Qt(Wt.VRAD,Kt.get(Wt.VRAD));(null===(e=this.spectralCoordsSupported)||void 0===e?void 0:e.has(t))&&this.setSpectralCoordinate(t)}}}),Nu=Object(b.a)(qh.prototype,"setSpectralCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{var i;if(null===(i=this.spectralCoordsSupported)||void 0===i?void 0:i.has(e)){const i=this.spectralCoordsSupported.get(e);var n;if(this.spectralType=i.type,this.spectralUnit=i.unit,t)null===(n=this.spectralReference?this.spectralSiblings:this.secondarySpectralImages)||void 0===n||n.forEach((t=>t.setSpectralCoordinate(e,!1)));return!0}return!1}}}),_u=Object(b.a)(qh.prototype,"setSpectralSystem",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{var i;if(null===(i=this.spectralSystemsSupported)||void 0===i?void 0:i.includes(e)){var n;if(this.spectralSystem=e,t)null===(n=this.spectralReference?this.spectralSiblings:this.secondarySpectralImages)||void 0===n||n.forEach((t=>t.setSpectralSystem(e,!1)));return!0}return!1}}}),Object(b.a)(qh.prototype,"updateFromContourData",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"updateFromContourData"),qh.prototype),Object(b.a)(qh.prototype,"updateFromVectorOverlayData",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"updateFromVectorOverlayData"),qh.prototype),Object(b.a)(qh.prototype,"setChannels",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"setChannels"),qh.prototype),Object(b.a)(qh.prototype,"incrementChannels",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"incrementChannels"),qh.prototype),Object(b.a)(qh.prototype,"setZoom",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"setZoom"),qh.prototype),Object(b.a)(qh.prototype,"setCenter",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"setCenter"),qh.prototype),Object(b.a)(qh.prototype,"setCursorPosition",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"setCursorPosition"),qh.prototype),Object(b.a)(qh.prototype,"setCursorValue",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"setCursorValue"),qh.prototype),zu=Object(b.a)(qh.prototype,"updateCursorRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.spatialReference){const t=Mm(this.spatialTransformAST,e,!0);this.spatialReference.updateCursorRegion(t)}else e.x>=0&&e.x<=this.frameInfo.fileInfoExtended.width-1&&e.y>=0&&e.y<=this.frameInfo.fileInfoExtended.height-1&&this.frameRegionSet.updateCursorRegionPosition(e);for(const t of this.secondarySpatialImages){const i=Mm(t.spatialTransformAST,e,!1);i.x>=0&&i.x<=t.frameInfo.fileInfoExtended.width-1&&i.y>=0&&i.y<=t.frameInfo.fileInfoExtended.height-1&&t.frameRegionSet.updateCursorRegionPosition(i)}}}}),Object(b.a)(qh.prototype,"zoomToPoint",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"zoomToPoint"),qh.prototype),Vu=Object(b.a)(qh.prototype,"fitZoom",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.spatialReference){this.initCenter();const e=Mm(this.spatialTransformAST,this.center,!0);this.spatialReference.setCenter(e.x,e.y);const t=[this.spatialTransform.transformCoordinate({x:0,y:0},!0),this.spatialTransform.transformCoordinate({x:0,y:this.frameInfo.fileInfoExtended.height},!0),this.spatialTransform.transformCoordinate({x:this.frameInfo.fileInfoExtended.width,y:this.frameInfo.fileInfoExtended.height},!0),this.spatialTransform.transformCoordinate({x:this.frameInfo.fileInfoExtended.width,y:0},!0)],{minPoint:i,maxPoint:n}=hm(t),r=n.x-i.x,o=n.y-i.y,s=this.renderHiDPI?devicePixelRatio*gC.Instance.imageRatio:1,a=this.spatialReference.renderWidth*s/r,l=this.spatialReference.renderHeight*s/o,c=Math.min(a,l);return this.spatialReference.setZoom(c,!0),c}return this.zoomLevel=this.zoomLevelForFit,this.initCenter(),this.zoomLevel}}}),Wu=Object(b.a)(qh.prototype,"setAnimationRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.animationChannelRange=e}}}),Gu=Object(b.a)(qh.prototype,"startMoving",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.moving=!0}}}),Bu=Object(b.a)(qh.prototype,"endMoving",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.moving=!1}}}),qu=Object(b.a)(qh.prototype,"applyContours",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(!this.contourConfig||!this.renderConfig)return;const e=JA.Instance;this.contourConfig.setEnabled(!0);const t={fileId:this.frameInfo.fileId,referenceFileId:this.frameInfo.fileId,smoothingMode:this.contourConfig.smoothingMode,smoothingFactor:this.contourConfig.smoothingFactor,levels:this.contourConfig.levels,imageBounds:{xMin:0,xMax:this.frameInfo.fileInfoExtended.width,yMin:0,yMax:this.frameInfo.fileInfoExtended.height},decimationFactor:e.contourDecimation,compressionLevel:e.contourCompressionLevel,contourChunkSize:e.contourChunkSize};this.backendService.setContourParameters(t)}}}),Hu=Object(b.a)(qh.prototype,"clearContours",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!0)=>{if(this.contourStores.forEach((e=>e.clearData())),this.contourStores.clear(),e){const e={fileId:this.frameInfo.fileId,referenceFileId:this.frameInfo.fileId};this.backendService.setContourParameters(e)}this.contourConfig.setEnabled(!1)}}}),Yu=Object(b.a)(qh.prototype,"applyVectorOverlay",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.vectorOverlayConfig;if(!e||!this.renderConfig)return;const t=JA.Instance;e.setEnabled(!0);const i={fileId:this.frameInfo.fileId,imageBounds:{xMin:0,xMax:this.frameInfo.fileInfoExtended.width,yMin:0,yMax:this.frameInfo.fileInfoExtended.height},smoothingFactor:e.pixelAveragingEnabled?e.pixelAveraging:1,fractional:e.fractionalIntensity,threshold:e.thresholdEnabled?e.threshold:NaN,debiasing:e.debiasing,qError:e.qError,uError:e.uError,stokesIntensity:e.intensitySource,stokesAngle:e.angularSource,compressionType:Nt.CompressionType.NONE,compressionQuality:t.contourCompressionLevel};this.backendService.setVectorOverlayParameters(i)}}}),Uu=Object(b.a)(qh.prototype,"clearVectorOverlay",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!0)=>{if(this.vectorOverlayStore.clearData(),e){const e={fileId:this.frameInfo.fileId,stokesAngle:-1,stokesIntensity:-1};this.backendService.setVectorOverlayParameters(e)}this.vectorOverlayConfig.setEnabled(!1)}}}),Xu=Object(b.a)(qh.prototype,"setSpatialReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;if(e===this)return console.log("Skipping spatial self-reference"),this.clearSpatialReference(),!1;if(!e.hasSquarePixels||!this.hasSquarePixels)return console.log("Cannot perform spatial transform between images with non-square pixels"),this.spatialReference=null,!1;if(this.validWcs!==e.validWcs)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,!1;this.spatialReference=e,console.log(`Setting spatial reference for file ${this.frameInfo.fileId} to ${e.frameInfo.fileId}`);const i=Pt.copy(this.wcsInfo),n=Pt.copy(e.wcsInfo);if(Pt.invert(i),Pt.invert(n),this.spatialTransformAST=Pt.convert(i,n,""),Pt.deleteObject(i),Pt.deleteObject(n),!this.spatialTransformAST)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,!1;const r=this.spatialTransform;if(!r||!isFinite(r.rotation)||!isFinite(r.scale)||!isFinite(r.translation.x)||!isFinite(r.translation.y)||!isFinite(r.origin.x)||!isFinite(r.origin.y)||!this.transformedWcsInfo)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,Pt.deleteObject(this.spatialTransformAST),this.spatialTransformAST=null,!1;this.spatialReference.addSecondarySpatialImage(this);const o=null===(t=this.spatialReference.cursorInfo)||void 0===t?void 0:t.posImageSpace;if(o){const e=Mm(this.spatialTransformAST,o,!1);this.cursorInfo=this.getCursorInfo(e)}this.spatialReference.frameRegionSet.migrateRegionsFromExistingSet(this.frameRegionSet,this.spatialTransformAST,!0);for(const s of this.frameRegionSet.regions)this.frameRegionSet.deleteRegion(s);return!0}}}),$u=Object(b.a)(qh.prototype,"clearSpatialReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spatialReference&&(this.frameRegionSet.migrateRegionsFromExistingSet(this.spatialReference.frameRegionSet,this.spatialTransformAST),this.center=this.spatialTransform.transformCoordinate(this.spatialReference.center,!1),this.zoomLevel=this.spatialReference.zoomLevel,this.spatialReference.removeSecondarySpatialImage(this),this.spatialReference=null),this.spatialTransformAST&&Pt.deleteObject(this.spatialTransformAST),this.spatialTransformAST=null;const e=xx.Instance.gl;e&&this.controlMaps.forEach((t=>{if(t.hasTextureForContext(e)){const i=t.getTextureX(e);e.deleteTexture(i)}})),this.controlMaps.forEach(((e,t)=>{this.removeControlMap(t)})),this.controlMaps.clear();const t=Tx.Instance.gl;t&&this.catalogControlMaps.forEach((i=>{if(i.hasTextureForContext(e)){const e=i.getTextureX(t);t.deleteTexture(e)}})),this.catalogControlMaps.forEach(((e,t)=>{this.removeCatalogControlMap(t)})),this.catalogControlMaps.clear()}}}),Ku=Object(b.a)(qh.prototype,"addSecondarySpatialImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpatialImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))||this.secondarySpatialImages.push(e)}}}),Qu=Object(b.a)(qh.prototype,"removeSecondarySpatialImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpatialImages=this.secondarySpatialImages.filter((t=>t.frameInfo.fileId!==e.frameInfo.fileId))}}}),Zu=Object(b.a)(qh.prototype,"setSpectralReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this)return this.clearSpatialReference(),console.log("Skipping spectral self-reference"),!1;if(console.log(`Setting spectral reference for file ${this.frameInfo.fileId} to ${e.frameInfo.fileId}`),!this.wcsInfo3D||!e.wcsInfo3D)return console.log(`Error creating spectral transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}. One of the files is missing spectral information`),this.spectralReference=null,!1;const t=Pt.copy(this.wcsInfo3D),i=Pt.copy(e.wcsInfo3D),n=JA.Instance;if(n.spectralMatchingType!==Wt.CHANNEL&&(Pt.set(t,`AlignSystem=${n.spectralMatchingType}`),Pt.set(i,`AlignSystem=${n.spectralMatchingType}`)),Pt.invert(t),Pt.invert(i),this.spectralTransformAST=Pt.convert(t,i,""),Pt.deleteObject(t),Pt.deleteObject(i),!this.spectralTransformAST)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}. Could not create AST transform`),this.spectralReference=null,!1;this.spectralReference=e,this.spectralReference.addSecondarySpectralImage(this);const r=Lm(e.wcsInfo3D,this.wcsInfo3D,n.spectralMatchingType,e.requiredChannel);return this.setChannels(r,this.requiredStokes,!1),this.setSpectralCoordinate(e.spectralCoordinate,!1),!0}}}),Ju=Object(b.a)(qh.prototype,"clearSpectralReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralReference&&(this.spectralReference.removeSecondarySpectralImage(this),this.spectralReference=null),this.spectralTransformAST&&Pt.deleteObject(this.spectralTransformAST),this.spectralTransformAST=null}}}),eg=Object(b.a)(qh.prototype,"addSecondarySpectralImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpectralImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))||this.secondarySpectralImages.push(e)}}}),tg=Object(b.a)(qh.prototype,"removeSecondarySpectralImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpectralImages=this.secondarySpectralImages.filter((t=>t.frameInfo.fileId!==e.frameInfo.fileId))}}}),ig=Object(b.a)(qh.prototype,"setRasterScalingReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this)return this.clearRasterScalingReference(),void console.log("Skipping RenderConfig self-reference");this.rasterScalingReference=e,this.rasterScalingReference.addSecondaryRasterScalingImage(this),this.renderConfig.updateFrom(e.renderConfig)}}}),Object(b.a)(qh.prototype,"clearRasterScalingReference",[m.g],Object.getOwnPropertyDescriptor(qh.prototype,"clearRasterScalingReference"),qh.prototype),ng=Object(b.a)(qh.prototype,"addSecondaryRasterScalingImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryRasterScalingImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))||this.secondaryRasterScalingImages.push(e)}}}),rg=Object(b.a)(qh.prototype,"removeSecondaryRasterScalingImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryRasterScalingImages=this.secondaryRasterScalingImages.filter((t=>t.frameInfo.fileId!==e.frameInfo.fileId))}}}),og=Object(b.a)(qh.prototype,"addMomentImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&!this.momentImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))&&this.momentImages.push(e)}}}),sg=Object(b.a)(qh.prototype,"removeMomentImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.momentImages=[]}}}),ag=Object(b.a)(qh.prototype,"setIsRequestingMoments",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isRequestingMoments=e}}}),lg=Object(b.a)(qh.prototype,"updateRequestingMomentsProgress",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.requestingMomentsProgress=e}}}),cg=Object(b.a)(qh.prototype,"resetMomentRequestState",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setIsRequestingMoments(!1),this.updateRequestingMomentsProgress(0)}}}),dg=Object(b.a)(qh.prototype,"setStokesFiles",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.stokesFiles=e}}}),pg=Object(b.a)(qh.prototype,"addPvImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{!e||this.pvImage&&this.pvImage.frameInfo.fileId===e.frameInfo.fileId||(this.pvImage=e)}}}),hg=Object(b.a)(qh.prototype,"removePvImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.pvImage=null}}}),ug=Object(b.a)(qh.prototype,"setIsRequestingPV",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isRequestingPV=e}}}),gg=Object(b.a)(qh.prototype,"updateRequestingPvProgress",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.requestingPVProgress=e}}}),fg=Object(b.a)(qh.prototype,"resetPvRequestState",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setIsRequestingPV(!1),this.updateRequestingPvProgress(0)}}}),bg=Object(b.a)(qh.prototype,"setGeneratedPVRegionId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.generatedPVRegionId=e}}}),mg=Object(b.a)(qh.prototype,"setIsRequestPVCancelling",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isRequestPVCancelling=e}}}),yg=Object(b.a)(qh.prototype,"setFittingResult",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fittingResult=e}}}),Og=Object(b.a)(qh.prototype,"setFittingLog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fittingLog=e}}}),qh);var Cg,Ig,wg,Tg,Rg,Ag,Pg,Eg,Mg,Fg,kg,Dg,Lg;let Ng=(Cg=class{constructor(){Object(f.a)(this,"visible",Ig,this),Object(f.a)(this,"color",wg,this),Object(f.a)(this,"type",Tg,this),Object(f.a)(this,"width",Rg,this),Object(f.a)(this,"shiftX",Ag,this),Object(f.a)(this,"shiftY",Pg,this),Object(f.a)(this,"setVisible",Eg,this),Object(f.a)(this,"setColor",Mg,this),Object(f.a)(this,"setType",Fg,this),Object(f.a)(this,"setWidth",kg,this),Object(f.a)(this,"setShiftX",Dg,this),Object(f.a)(this,"setShiftY",Lg,this),Object(m.p)(this);const e=JA.Instance;this.visible=e.beamVisible,this.color=e.beamColor,this.type=e.beamType,this.width=e.beamWidth,this.shiftX=this.shiftY=0}},Ig=Object(b.a)(Cg.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wg=Object(b.a)(Cg.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tg=Object(b.a)(Cg.prototype,"type",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rg=Object(b.a)(Cg.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ag=Object(b.a)(Cg.prototype,"shiftX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pg=Object(b.a)(Cg.prototype,"shiftY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eg=Object(b.a)(Cg.prototype,"setVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),Mg=Object(b.a)(Cg.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Fg=Object(b.a)(Cg.prototype,"setType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.type=e}}}),kg=Object(b.a)(Cg.prototype,"setWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.width=e}}}),Dg=Object(b.a)(Cg.prototype,"setShiftX",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.shiftX=e}}}),Lg=Object(b.a)(Cg.prototype,"setShiftY",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.shiftY=e}}}),Cg);var _g,zg,Vg,Wg,Gg,Bg,qg,Hg,Yg,Ug,Xg,$g,Kg,Qg,Zg,Jg,ef,tf,nf,rf,of,sf,af,lf,cf,df,pf,hf,uf,gf,ff,bf,mf,yf,Of,jf,xf,Sf,vf,Cf,If,wf,Tf;let Rf;!function(e){e[e.LINEAR=0]="LINEAR",e[e.LOG=1]="LOG",e[e.SQRT=2]="SQRT",e[e.SQUARE=3]="SQUARE",e[e.POWER=4]="POWER",e[e.GAMMA=5]="GAMMA",e[e.EXP=6]="EXP",e[e.CUSTOM=7]="CUSTOM"}(Rf||(Rf={}));let Af=(Tf=wf=class e{constructor(e,t){this.preference=e,Object(f.a)(this,"scaling",zg,this),Object(f.a)(this,"colorMapIndex",Vg,this),Object(f.a)(this,"bias",Wg,this),Object(f.a)(this,"contrast",Gg,this),Object(f.a)(this,"gamma",Bg,this),Object(f.a)(this,"alpha",qg,this),Object(f.a)(this,"inverted",Hg,this),Object(f.a)(this,"channelHistogram",Yg,this),Object(f.a)(this,"cubeHistogram",Ug,this),Object(f.a)(this,"useCubeHistogram",Xg,this),Object(f.a)(this,"useCubeHistogramContours",$g,this),Object(f.a)(this,"cubeHistogramProgress",Kg,this),Object(f.a)(this,"selectedPercentile",Qg,this),Object(f.a)(this,"histChannel",Zg,this),Object(f.a)(this,"stokesIndex",Jg,this),Object(f.a)(this,"scaleMin",ef,this),Object(f.a)(this,"scaleMax",tf,this),Object(f.a)(this,"visible",nf,this),this.frame=void 0,Object(f.a)(this,"setHistChannel",rf,this),Object(f.a)(this,"setStokesIndex",of,this),Object(f.a)(this,"setUseCubeHistogram",sf,this),Object(f.a)(this,"setUseCubeHistogramContours",af,this),Object(f.a)(this,"setPercentileRank",lf,this),Object(f.a)(this,"updateChannelHistogram",cf,this),Object(f.a)(this,"updateCubeHistogram",df,this),Object(f.a)(this,"setCustomScale",pf,this),Object(f.a)(this,"setColorMapIndex",hf,this),Object(f.a)(this,"setColorMap",uf,this),Object(f.a)(this,"setScaling",gf,this),Object(f.a)(this,"setGamma",ff,this),Object(f.a)(this,"setAlpha",bf,this),Object(f.a)(this,"setBias",mf,this),Object(f.a)(this,"resetBias",yf,this),Object(f.a)(this,"setContrast",Of,this),Object(f.a)(this,"resetContrast",jf,this),Object(f.a)(this,"setInverted",xf,this),Object(f.a)(this,"setVisible",Sf,this),Object(f.a)(this,"toggleVisibility",vf,this),Object(f.a)(this,"updateSiblings",Cf,this),Object(f.a)(this,"updateFrom",If,this),Object(m.p)(this),this.frame=t;const i=0!==this.frame.polarizations.length?this.frame.polarizations.length:1,n=e.percentile;this.selectedPercentile=new Array(i).fill(n),this.bias=0,this.contrast=1,this.alpha=e.scalingAlpha,this.gamma=e.scalingGamma,this.scaling=e.scaling,this.inverted=!1,this.cubeHistogramProgress=0,this.setColorMap(e.colormap),this.stokesIndex=0,this.scaleMin=new Array(i).fill(0),this.scaleMax=new Array(i).fill(1),this.visible=!0}static IsScalingValid(t){return e.SCALING_TYPES.has(t)}static IsGammaValid(t){return t>=e.GAMMA_MIN&&t<=e.GAMMA_MAX}static IsColormapValid(t){return e.COLOR_MAPS_SELECTED.includes(t)}static IsPercentileValid(t){return e.PERCENTILE_RANKS.includes(t)}get colorMap(){return this.colorMapIndex>=0&&this.colorMapIndex<=e.COLOR_MAPS_ALL.length-1?e.COLOR_MAPS_ALL[this.colorMapIndex]:"Unknown"}get colorscaleArray(){const e=Kb(this.colorMap),t=Array.from(Array(e.size).keys()).map((t=>this.inverted?1-t/e.size:t/e.size)).map((e=>{var t,i;return 1-$i(e,this.scaling,this.alpha,this.gamma,this.bias,this.contrast,null===(t=gC.Instance)||void 0===t||null===(i=t.preferenceStore)||void 0===i?void 0:i.useSmoothedBiasContrast)}));let i=t=>`rgb(${e.color[4*t]}, ${e.color[4*t+1]}, ${e.color[4*t+2]}, ${e.color[4*t+3]})`,n=[];if(0===this.contrast){for(let n=0;n<e.size;n++)if(t[n]===(this.inverted?1:0))return[0,i(n),1,i(n)];return[0,i(e.size-1),1,i(e.size-1)]}if(1===Math.min(...t)){const t=this.inverted?i(0):i(e.size-1);return[0,t,1,t]}if(0===Math.max(...t)){const t=this.inverted?i(e.size-1):i(0);return[0,t,1,t]}for(let r=0;r<e.size&&(t[r+1]!==t[r]&&n.push(t[r],i(r)),t[r]!==(this.inverted?1:0));r++);return n}get scalingName(){const t=e.SCALING_TYPES.get(this.scaling);return t||"Unknown"}get histogram(){return this.useCubeHistogram&&this.cubeHistogram?this.cubeHistogram:this.channelHistogram}get contourHistogram(){return this.useCubeHistogramContours&&this.cubeHistogram?this.cubeHistogram:this.channelHistogram}get scaleMinVal(){return this.scaleMin[this.stokesIndex]}get scaleMaxVal(){return this.scaleMax[this.stokesIndex]}get selectedPercentileVal(){return this.selectedPercentile[this.stokesIndex]}get histogramMin(){if(this.histogram)return this.histogram.firstBinCenter-.5*this.histogram.binWidth}get histogramMax(){if(this.histogram)return this.histogram.firstBinCenter+(this.histogram.bins.length+.5)*this.histogram.binWidth}},wf.SCALING_TYPES=new Map([[Rf.LINEAR,"Linear"],[Rf.LOG,"Log"],[Rf.SQRT,"Square root"],[Rf.SQUARE,"Squared"],[Rf.GAMMA,"Gamma"],[Rf.POWER,"Power"]]),wf.COLOR_MAPS_ALL=["accent","afmhot","autumn","binary","Blues","bone","BrBG","brg","BuGn","BuPu","bwr","CMRmap","cool","coolwarm","copper","cubehelix","dark2","flag","gist_earth","gist_gray","gist_heat","gist_ncar","gist_rainbow","gist_stern","gist_yarg","GnBu","gnuplot","gnuplot2","gray","greens","greys","hot","hsv","inferno","jet","magma","nipy_spectral","ocean","oranges","OrRd","paired","pastel1","pastel2","pink","PiYG","plasma","PRGn","prism","PuBu","PuBuGn","PuOr","PuRd","purples","rainbow","RdBu","RdGy","RdPu","RdYlBu","RdYlGn","reds","seismic","set1","set2","set3","spectral","spring","summer","tab10","tab20","tab20b","tab20c","terrain","viridis","winter","Wistia","YlGn","YlGnBu","YlOrBr","YlOrRd"],wf.COLOR_MAPS_SELECTED=["afmhot","Blues","coolwarm","cubehelix","gist_heat","gist_stern","gnuplot","gnuplot2","gray","greens","greys","hot","inferno","jet","magma","nipy_spectral","plasma","rainbow","RdBu","RdGy","reds","seismic","spectral","tab10","viridis"],wf.PERCENTILE_RANKS=[90,95,99,99.5,99.9,99.95,99.99,100],wf.GAMMA_MIN=.1,wf.GAMMA_MAX=2,wf.ALPHA_MIN=.1,wf.ALPHA_MAX=1e6,wf.BIAS_MIN=-1,wf.BIAS_MAX=1,wf.CONTRAST_MIN=0,wf.CONTRAST_MAX=2,_g=Tf,zg=Object(b.a)(_g.prototype,"scaling",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vg=Object(b.a)(_g.prototype,"colorMapIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wg=Object(b.a)(_g.prototype,"bias",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gg=Object(b.a)(_g.prototype,"contrast",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bg=Object(b.a)(_g.prototype,"gamma",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qg=Object(b.a)(_g.prototype,"alpha",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hg=Object(b.a)(_g.prototype,"inverted",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yg=Object(b.a)(_g.prototype,"channelHistogram",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ug=Object(b.a)(_g.prototype,"cubeHistogram",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xg=Object(b.a)(_g.prototype,"useCubeHistogram",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$g=Object(b.a)(_g.prototype,"useCubeHistogramContours",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kg=Object(b.a)(_g.prototype,"cubeHistogramProgress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qg=Object(b.a)(_g.prototype,"selectedPercentile",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zg=Object(b.a)(_g.prototype,"histChannel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jg=Object(b.a)(_g.prototype,"stokesIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ef=Object(b.a)(_g.prototype,"scaleMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tf=Object(b.a)(_g.prototype,"scaleMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nf=Object(b.a)(_g.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(_g.prototype,"colorMap",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"colorMap"),_g.prototype),Object(b.a)(_g.prototype,"colorscaleArray",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"colorscaleArray"),_g.prototype),Object(b.a)(_g.prototype,"scalingName",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"scalingName"),_g.prototype),Object(b.a)(_g.prototype,"histogram",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"histogram"),_g.prototype),Object(b.a)(_g.prototype,"contourHistogram",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"contourHistogram"),_g.prototype),Object(b.a)(_g.prototype,"scaleMinVal",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"scaleMinVal"),_g.prototype),Object(b.a)(_g.prototype,"scaleMaxVal",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"scaleMaxVal"),_g.prototype),Object(b.a)(_g.prototype,"selectedPercentileVal",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"selectedPercentileVal"),_g.prototype),rf=Object(b.a)(_g.prototype,"setHistChannel",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.histChannel=e}}}),of=Object(b.a)(_g.prototype,"setStokesIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.stokesIndex=e}}}),sf=Object(b.a)(_g.prototype,"setUseCubeHistogram",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e!==this.useCubeHistogram&&(this.useCubeHistogram=e,this.selectedPercentile[this.stokesIndex]>0&&this.setPercentileRank(this.selectedPercentile[this.stokesIndex]))}}}),af=Object(b.a)(_g.prototype,"setUseCubeHistogramContours",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.useCubeHistogramContours=e}}}),Object(b.a)(_g.prototype,"histogramMin",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"histogramMin"),_g.prototype),Object(b.a)(_g.prototype,"histogramMax",[m.i],Object.getOwnPropertyDescriptor(_g.prototype,"histogramMax"),_g.prototype),lf=Object(b.a)(_g.prototype,"setPercentileRank",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.selectedPercentile[this.stokesIndex]=e,100===e)return this.scaleMin[this.stokesIndex]=this.histogramMin,this.scaleMax[this.stokesIndex]=this.histogramMax,this.updateSiblings(),!0;if(e<0||e>100)return!1;const t=100-e,i=Hi(this.histogram,[t,e]);return 2===i.length&&(this.scaleMin[this.stokesIndex]=i[0],this.scaleMax[this.stokesIndex]=i[1],this.updateSiblings(),!0)}}}),cf=Object(b.a)(_g.prototype,"updateChannelHistogram",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channelHistogram=e,this.selectedPercentile[this.stokesIndex]>0&&!this.useCubeHistogram&&this.setPercentileRank(this.selectedPercentile[this.stokesIndex])}}}),df=Object(b.a)(_g.prototype,"updateCubeHistogram",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.cubeHistogram=e,this.cubeHistogramProgress=t,this.selectedPercentile[this.stokesIndex]>0&&this.useCubeHistogram&&this.setPercentileRank(this.selectedPercentile[this.stokesIndex])}}}),pf=Object(b.a)(_g.prototype,"setCustomScale",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.scaleMin[this.stokesIndex]=e,this.scaleMax[this.stokesIndex]=t,this.selectedPercentile[this.stokesIndex]=-1,this.updateSiblings()}}}),hf=Object(b.a)(_g.prototype,"setColorMapIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorMapIndex=Gi(e,0,Af.COLOR_MAPS_ALL.length-1)}}}),uf=Object(b.a)(_g.prototype,"setColorMap",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=Af.COLOR_MAPS_ALL.indexOf(e);t>=0&&this.setColorMapIndex(t)}}}),gf=Object(b.a)(_g.prototype,"setScaling",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{Af.SCALING_TYPES.has(e)&&(this.scaling=e,this.updateSiblings())}}}),ff=Object(b.a)(_g.prototype,"setGamma",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.gamma=e,this.updateSiblings()}}}),bf=Object(b.a)(_g.prototype,"setAlpha",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.alpha=e,this.updateSiblings()}}}),mf=Object(b.a)(_g.prototype,"setBias",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.bias=e}}}),yf=Object(b.a)(_g.prototype,"resetBias",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.bias=0}}}),Of=Object(b.a)(_g.prototype,"setContrast",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.contrast=e}}}),jf=Object(b.a)(_g.prototype,"resetContrast",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contrast=1}}}),xf=Object(b.a)(_g.prototype,"setInverted",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.inverted=e}}}),Sf=Object(b.a)(_g.prototype,"setVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),vf=Object(b.a)(_g.prototype,"toggleVisibility",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),Cf=Object(b.a)(_g.prototype,"updateSiblings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;const t=null===(e=this.frame)||void 0===e?void 0:e.renderConfigSiblings;for(const i of t)i.renderConfig.updateFrom(this)}}}),If=Object(b.a)(_g.prototype,"updateFrom",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scaling=e.scaling,this.alpha=e.alpha,this.gamma=e.gamma,this.bias=e.bias,this.contrast=e.contrast,this.scaleMin[this.stokesIndex]=e.scaleMinVal,this.scaleMax[this.stokesIndex]=e.scaleMaxVal,this.selectedPercentile[this.stokesIndex]=-1}}}),_g);var Pf,Ef,Mf,Ff,kf;let Df=(Pf=class{get restFreqInHz(){if(!this.inValidInput)return or.convertUnitToHz(this.customRestFreq)}get inValidInput(){return!isFinite(this.customRestFreq.value)}get resetDisable(){return!isFinite(this.headerRestFreq.value)}get defaultInfo(){return isFinite(this.headerRestFreq.value)?`Header: ${this.headerRestFreq.value} ${this.headerRestFreq.unit}`:void 0}constructor(e){this.headerRestFreq=void 0,Object(f.a)(this,"customRestFreq",Ef,this),Object(f.a)(this,"setCustomVal",Mf,this),Object(f.a)(this,"setCustomUnit",Ff,this),Object(f.a)(this,"restoreDefaults",kf,this),Object(m.p)(this);const t=or.convertUnitFromHz(e);this.headerRestFreq=t,this.customRestFreq=t}},Ef=Object(b.a)(Pf.prototype,"customRestFreq",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Pf.prototype,"restFreqInHz",[m.i],Object.getOwnPropertyDescriptor(Pf.prototype,"restFreqInHz"),Pf.prototype),Object(b.a)(Pf.prototype,"inValidInput",[m.i],Object.getOwnPropertyDescriptor(Pf.prototype,"inValidInput"),Pf.prototype),Object(b.a)(Pf.prototype,"resetDisable",[m.i],Object.getOwnPropertyDescriptor(Pf.prototype,"resetDisable"),Pf.prototype),Object(b.a)(Pf.prototype,"defaultInfo",[m.i],Object.getOwnPropertyDescriptor(Pf.prototype,"defaultInfo"),Pf.prototype),Mf=Object(b.a)(Pf.prototype,"setCustomVal",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customRestFreq.value=e}}}),Ff=Object(b.a)(Pf.prototype,"setCustomUnit",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customRestFreq.unit=e}}}),kf=Object(b.a)(Pf.prototype,"restoreDefaults",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.customRestFreq=this.headerRestFreq}}}),Pf);var Lf,Nf,_f,zf,Vf,Wf,Gf,Bf,qf,Hf,Yf,Uf,Xf,$f,Kf,Qf,Zf,Jf,eb,tb,ib,nb,rb,ob,sb,ab,lb,cb,db,pb,hb,ub,gb,fb,bb,mb;let yb;!function(e){e.Image="Image",e.World="World"}(yb||(yb={}));let Ob=(Lf=m.q.shallow,mb=bb=class e{static RegionTypeString(e){switch(e){case Nt.RegionType.POINT:return"Point";case Nt.RegionType.LINE:return"Line";case Nt.RegionType.RECTANGLE:return"Rectangle";case Nt.RegionType.ELLIPSE:return"Ellipse";case Nt.RegionType.POLYGON:return"Polygon";case Nt.RegionType.POLYLINE:return"Polyline";default:return"Not Implemented"}}static IsRegionCustomIcon(e){switch(e){case Nt.RegionType.LINE:case Nt.RegionType.POLYLINE:return!0;default:return!1}}static RegionIconString(e){switch(e){case Nt.RegionType.POINT:return"symbol-square";case Nt.RegionType.LINE:return"line";case Nt.RegionType.RECTANGLE:return"square";case Nt.RegionType.ELLIPSE:return"circle";case Nt.RegionType.POLYGON:return"polygon-filter";case Nt.RegionType.POLYLINE:return"polyline";default:return"error"}}static IsRegionTypeValid(t){return e.AVAILABLE_REGION_TYPES.has(t)}static IsRegionLineWidthValid(t){return t>=e.MIN_LINE_WIDTH&&t<=e.MAX_LINE_WIDTH}static IsRegionDashLengthValid(t){return t>=0&&t<=e.MAX_DASH_LENGTH}get isTemporary(){return this.regionId<0}get center(){if(!this.isValid)return{x:0,y:0};switch(this.regionType){case Nt.RegionType.POINT:case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:return this.controlPoints[0];case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:const e=hm(this.controlPoints);return rm(e.minPoint,e.maxPoint);case Nt.RegionType.LINE:return rm(this.controlPoints[0],this.controlPoints[1]);default:return{x:0,y:0}}}get size(){switch(this.regionType){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:return this.controlPoints[1];case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:return this.boundingBox;case Nt.RegionType.LINE:return nm(this.controlPoints[0],this.controlPoints[1]);default:return{x:void 0,y:void 0}}}get wcsSize(){const e=this.activeFrame;return this.size&&(null===e||void 0===e?void 0:e.validWcs)?e.getWcsSizeInArcsec(this.size):{x:void 0,y:void 0}}get boundingBox(){if(!this.isValid)return{x:0,y:0};switch(this.regionType){case Nt.RegionType.RECTANGLE:return this.size;case Nt.RegionType.ELLIPSE:return om(this.size,2);case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:const e=hm(this.controlPoints);return nm(e.maxPoint,e.minPoint);default:return{x:0,y:0}}}get boundingBoxArea(){const e=this.boundingBox;return e.x*e.y}get isClosedRegion(){switch(this.regionType){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:case Nt.RegionType.POLYGON:case Nt.RegionType.ANNULUS:return!0;default:return!1}}get isValid(){if(!this.controlPoints||!this.controlPoints.length)return!1;switch(this.regionType){case Nt.RegionType.POINT:return 1===this.controlPoints.length;case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:return 2===this.controlPoints.length&&this.size.x>0&&this.size.y>0;case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:return this.controlPoints.length>=1;case Nt.RegionType.LINE:return 1===this.controlPoints.length||2===this.controlPoints.length;default:return!1}}get nameString(){return 0===this.regionId?"Cursor":this.name&&""!==this.name?this.name:`Region ${this.regionId>0?this.regionId:"..."}`}get regionProperties(){const e=this.center,t=isFinite(e.x)&&isFinite(e.y)?`${fi(e.x,6)}pix, ${fi(e.y,6)}pix`:"Invalid";switch(this.regionType){case Nt.RegionType.POINT:return`Point (pixel) [${t}]`;case Nt.RegionType.LINE:let e="Line (pixel) [";return this.controlPoints.forEach(((t,i)=>{e+=isFinite(t.x)&&isFinite(t.y)?`[${fi(t.x,6)}pix, ${fi(t.y,6)}pix]`:"[Invalid]",e+=i!==this.controlPoints.length-1?", ":"]"})),e;case Nt.RegionType.RECTANGLE:return`rotbox[[${t}], [${fi(this.size.x,6)}pix, ${fi(this.size.y,6)}pix], ${fi(this.rotation,6)}deg]`;case Nt.RegionType.ELLIPSE:return`ellipse[[${t}], [${fi(this.size.x,6)}pix, ${fi(this.size.y,6)}pix], ${fi(this.rotation,6)}deg]`;case Nt.RegionType.POLYGON:let i="poly[";return this.controlPoints.forEach(((e,t)=>{i+=isFinite(e.x)&&isFinite(e.y)?`[${fi(e.x,6)}pix, ${fi(e.y,6)}pix]`:"[Invalid]",i+=t!==this.controlPoints.length-1?", ":"]"})),i;case Nt.RegionType.POLYLINE:let n="Polyline (pixel) [";return this.controlPoints.forEach(((e,t)=>{n+=isFinite(e.x)&&isFinite(e.y)?`[${fi(e.x,6)}pix, ${fi(e.y,6)}pix]`:"[Invalid]",n+=t!==this.controlPoints.length-1?", ":"]"})),n;default:return"Not Implemented"}}getRegionApproximation(t){let i=this.regionApproximationMap.get(t);if(!i){if(this.regionType===Nt.RegionType.POINT&&(i=[Mm(t,this.center,!1)]),this.regionType===Nt.RegionType.ELLIPSE)i=function(e,t,i,n,r,o){const s=2*Math.PI/o,a=new Float64Array(o),l=new Float64Array(o);for(let p=0;p<o;p++){const e=p*s,o=im(t,dm({x:i*Math.cos(e),y:n*Math.sin(e)},r*Math.PI/180));a[p]=o.x,l[p]=o.y}const c=Pt.transformPointArrays(e,a,l,!1),d=new Array(o);for(let p=0;p<o;p++)d[p]={x:c.x[p],y:c.y[p]};return d}(t,this.center,this.size.y,this.size.x,this.rotation,e.TARGET_VERTEX_COUNT);else if(this.regionType===Nt.RegionType.RECTANGLE){let n=this.size.x/2,r=this.size.y/2;const o=this.rotation*Math.PI/180;i=Vm(t,[im(this.center,dm({x:-n,y:-r},o)),im(this.center,dm({x:+n,y:-r},o)),im(this.center,dm({x:+n,y:+r},o)),im(this.center,dm({x:-n,y:+r},o))],e.TARGET_VERTEX_COUNT)}else i=this.regionType===Nt.RegionType.POLYGON?Vm(t,this.controlPoints,e.TARGET_VERTEX_COUNT,!this.creating):Vm(t,this.controlPoints,e.TARGET_VERTEX_COUNT,!1);this.regionApproximationMap.set(t,i)}return i}constructor(e,t,i,n,r,o=-1,s=L.a.TURQUOISE5,a=2,l=0,c=0,d=""){var p;this.fileId=void 0,Object(f.a)(this,"regionId",_f,this),Object(f.a)(this,"name",zf,this),Object(f.a)(this,"color",Vf,this),Object(f.a)(this,"lineWidth",Wf,this),Object(f.a)(this,"dashLength",Gf,this),Object(f.a)(this,"regionType",Bf,this),Object(f.a)(this,"coordinate",qf,this),Object(f.a)(this,"controlPoints",Hf,this),Object(f.a)(this,"rotation",Yf,this),Object(f.a)(this,"editing",Uf,this),Object(f.a)(this,"creating",Xf,this),Object(f.a)(this,"locked",$f,this),Object(f.a)(this,"isSimplePolygon",Kf,this),Object(f.a)(this,"activeFrame",Qf,this),this.backendService=void 0,this.regionApproximationMap=void 0,this.modifiedTimestamp=void 0,this.getLineAngle=(e,t)=>{let i=180*Math.atan((t.x-e.x)/(e.y-t.y))/Math.PI;return t.y>e.y&&(i+=180),i=(i+360)%360,i},Object(f.a)(this,"setRegionId",Zf,this),Object(f.a)(this,"setCenter",Jf,this),Object(f.a)(this,"setSize",eb,this),Object(f.a)(this,"setControlPoint",tb,this),Object(f.a)(this,"setControlPoints",ib,this),Object(f.a)(this,"setRotation",nb,this),Object(f.a)(this,"setName",rb,this),Object(f.a)(this,"setColor",ob,this),Object(f.a)(this,"setLineWidth",sb,this),Object(f.a)(this,"setDashLength",ab,this),Object(f.a)(this,"beginCreating",lb,this),Object(f.a)(this,"endCreating",cb,this),Object(f.a)(this,"beginEditing",db,this),Object(f.a)(this,"endEditing",pb,this),Object(f.a)(this,"toggleLock",hb,this),Object(f.a)(this,"setLocked",ub,this),Object(f.a)(this,"focusCenter",gb,this),Object(f.a)(this,"setCoordinate",fb,this),this.updateRegion=async()=>{if(this.isValid)if(0===this.regionId)gC.Instance.resetCursorRegionSpectralProfileProgress(this.fileId),this.backendService.setCursor(this.fileId,this.center.x,this.center.y);else try{gC.Instance.resetRegionSpectralProfileProgress(this.regionId),await this.backendService.setRegion(this.fileId,this.regionId,this),console.log("Region updated")}catch(e){console.log(e)}},Object(m.p)(this),this.fileId=t,this.activeFrame=i,this.controlPoints=n,this.regionType=r,this.regionId=o,this.name=d,this.color=s,this.lineWidth=a,this.dashLength=l,this.rotation=c,this.backendService=e,i.validWcs?this.coordinate=yb.World:this.coordinate=yb.Image,this.isSimplePolygon=!0,(null===(p=this.activeFrame)||void 0===p?void 0:p.hasSquarePixels)||(this.rotation=0),this.regionApproximationMap=new Map,this.regionType===Nt.RegionType.POLYGON&&this.simplePolygonTest(),this.regionType===Nt.RegionType.LINE&&2===n.length&&(this.rotation=2===this.controlPoints.length?this.getLineAngle(this.controlPoints[0],this.controlPoints[1]):0),this.modifiedTimestamp=performance.now()}simplePolygonTest(e=-1){const t=this.controlPoints.slice();e>=0&&this.isSimplePolygon?this.isSimplePolygon=fm(t,e)&&fm(t,e-1):this.isSimplePolygon=function(e){if(e.length<4)return!0;for(let t=0;t<e.length;t++){const i=e[t],n=e[(t+1)%e.length];for(let r=t+2;r<e.length;r++){if(gm(i,n,e[r],e[(r+1)%e.length]))return!1}}return!0}(t)}},bb.MIN_LINE_WIDTH=.5,bb.MAX_LINE_WIDTH=10,bb.MAX_DASH_LENGTH=50,bb.TARGET_VERTEX_COUNT=200,bb.AVAILABLE_REGION_TYPES=new Map([[Nt.RegionType.POINT,"Point"],[Nt.RegionType.LINE,"Line"],[Nt.RegionType.RECTANGLE,"Rectangle"],[Nt.RegionType.ELLIPSE,"Ellipse"],[Nt.RegionType.POLYGON,"Polygon"],[Nt.RegionType.POLYLINE,"Polyline"]]),Nf=mb,_f=Object(b.a)(Nf.prototype,"regionId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zf=Object(b.a)(Nf.prototype,"name",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vf=Object(b.a)(Nf.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wf=Object(b.a)(Nf.prototype,"lineWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gf=Object(b.a)(Nf.prototype,"dashLength",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bf=Object(b.a)(Nf.prototype,"regionType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qf=Object(b.a)(Nf.prototype,"coordinate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hf=Object(b.a)(Nf.prototype,"controlPoints",[Lf],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yf=Object(b.a)(Nf.prototype,"rotation",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uf=Object(b.a)(Nf.prototype,"editing",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xf=Object(b.a)(Nf.prototype,"creating",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$f=Object(b.a)(Nf.prototype,"locked",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kf=Object(b.a)(Nf.prototype,"isSimplePolygon",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qf=Object(b.a)(Nf.prototype,"activeFrame",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Nf.prototype,"isTemporary",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"isTemporary"),Nf.prototype),Object(b.a)(Nf.prototype,"center",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"center"),Nf.prototype),Object(b.a)(Nf.prototype,"size",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"size"),Nf.prototype),Object(b.a)(Nf.prototype,"wcsSize",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"wcsSize"),Nf.prototype),Object(b.a)(Nf.prototype,"boundingBox",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"boundingBox"),Nf.prototype),Object(b.a)(Nf.prototype,"boundingBoxArea",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"boundingBoxArea"),Nf.prototype),Object(b.a)(Nf.prototype,"isClosedRegion",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"isClosedRegion"),Nf.prototype),Object(b.a)(Nf.prototype,"isValid",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"isValid"),Nf.prototype),Object(b.a)(Nf.prototype,"nameString",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"nameString"),Nf.prototype),Object(b.a)(Nf.prototype,"regionProperties",[m.i],Object.getOwnPropertyDescriptor(Nf.prototype,"regionProperties"),Nf.prototype),Zf=Object(b.a)(Nf.prototype,"setRegionId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionId=e}}}),Jf=Object(b.a)(Nf.prototype,"setCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{if(this.regionType===Nt.RegionType.LINE){const t=this.rotation*Math.PI/180,i=sm(this.size)*Math.sin(t),n=-1*sm(this.size)*Math.cos(t),r={x:e.x-i/2,y:e.y-n/2},o={x:e.x+i/2,y:e.y+n/2};this.setControlPoints([r,o])}else this.setControlPoint(0,e,t)}}}),eb=Object(b.a)(Nf.prototype,"setSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{if(this.regionType===Nt.RegionType.LINE){const t={x:this.center.x-e.x/2,y:this.center.y-e.y/2},i={x:this.center.x+e.x/2,y:this.center.y+e.y/2};this.setControlPoints([t,i])}else this.setControlPoint(1,e,t)}}}),tb=Object(b.a)(Nf.prototype,"setControlPoint",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i=!1)=>{e>=0&&e<this.controlPoints.length&&!zm(t)&&isFinite(null===t||void 0===t?void 0:t.x)&&isFinite(null===t||void 0===t?void 0:t.y)&&(this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.controlPoints[e]=t,this.editing||i||this.updateRegion(),this.regionType===Nt.RegionType.POLYGON&&this.simplePolygonTest(e),this.regionType===Nt.RegionType.LINE&&(this.rotation=2===this.controlPoints.length?this.getLineAngle(this.controlPoints[0],this.controlPoints[1]):0))}}}),ib=Object(b.a)(Nf.prototype,"setControlPoints",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1,i=!0)=>{if(e.length){for(const t of e)if(zm(t)||!isFinite(null===t||void 0===t?void 0:t.x)||!isFinite(null===t||void 0===t?void 0:t.y))return;this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.controlPoints=e,i&&this.regionType===Nt.RegionType.POLYGON&&this.simplePolygonTest(),this.regionType===Nt.RegionType.LINE&&(this.rotation=2===e.length?this.getLineAngle(e[0],e[1]):0),this.editing||t||this.updateRegion()}}}}),nb=Object(b.a)(Nf.prototype,"setRotation",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{var i;if(null===(i=this.activeFrame)||void 0===i?void 0:i.hasSquarePixels)if(this.regionType===Nt.RegionType.LINE){const t=(e+360)%360*Math.PI/180,i=sm(this.size)*Math.sin(t),n=-sm(this.size)*Math.cos(t),r={x:this.center.x-i/2,y:this.center.y-n/2},o={x:this.center.x+i/2,y:this.center.y+n/2};this.setControlPoints([r,o])}else this.rotation=(e+360)%360,this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.editing||t||this.updateRegion()}}}),rb=Object(b.a)(Nf.prototype,"setName",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.name=e}}}),ob=Object(b.a)(Nf.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),sb=Object(b.a)(Nf.prototype,"setLineWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineWidth=e}}}),ab=Object(b.a)(Nf.prototype,"setDashLength",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dashLength=e}}}),lb=Object(b.a)(Nf.prototype,"beginCreating",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.creating=!0,this.editing=!0}}}),cb=Object(b.a)(Nf.prototype,"endCreating",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{if(this.creating=!1,this.editing=!1,this.regionType!==Nt.RegionType.POINT)try{const e=await this.backendService.setRegion(this.fileId,-1,this);console.log(`Updating regionID from ${this.regionId} to ${e.regionId}`),this.setRegionId(e.regionId)}catch(e){console.log(e)}}}}),db=Object(b.a)(Nf.prototype,"beginEditing",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.editing=!0}}}),pb=Object(b.a)(Nf.prototype,"endEditing",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.editing=!1,this.updateRegion()}}}),hb=Object(b.a)(Nf.prototype,"toggleLock",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{0!==this.regionId&&(this.locked=!this.locked)}}}),ub=Object(b.a)(Nf.prototype,"setLocked",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{0!==this.regionId&&(this.locked=e)}}}),gb=Object(b.a)(Nf.prototype,"focusCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.activeFrame&&(this.activeFrame.setCenter(this.center.x,this.center.y),this.activeFrame.renderWidth<this.activeFrame.zoomLevel*this.boundingBox.x||this.activeFrame.renderHeight<this.activeFrame.zoomLevel*this.boundingBox.y)){const e=.4*Math.min(this.activeFrame.renderWidth/this.boundingBox.x,this.activeFrame.renderHeight/this.boundingBox.y);this.activeFrame.setZoom(e)}}}}),fb=Object(b.a)(Nf.prototype,"setCoordinate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.coordinate=e)}}}),Nf);var jb,xb,Sb,vb,Cb,Ib,wb,Tb,Rb,Ab,Pb,Eb,Mb,Fb,kb,Db,Lb,Nb,_b,zb;let Vb;!function(e){e[e.MOVING=0]="MOVING",e[e.CREATING=1]="CREATING"}(Vb||(Vb={}));let Wb=(jb=class{constructor(e,t,i){Object(f.a)(this,"regions",xb,this),Object(f.a)(this,"selectedRegion",Sb,this),Object(f.a)(this,"mode",vb,this),Object(f.a)(this,"newRegionType",Cb,this),this.frame=void 0,this.backendService=void 0,this.preference=void 0,this.updateCursorRegionPosition=e=>{if(e&&this.regions.length>0){var t,i;const n=this.regions[0],r={x:Math.round(e.x),y:Math.round(e.y)};0!==(null===n||void 0===n?void 0:n.regionId)||(null===(t=n.center)||void 0===t?void 0:t.x)===r.x&&(null===(i=n.center)||void 0===i?void 0:i.y)===r.y||n.setCenter(r)}},this.getTempRegionId=()=>{let e=-1;if(this.regions.length){let t=Math.min(...this.regions.map((e=>e.regionId)));e=Math.min(e,t-1)}return e},Object(f.a)(this,"addPointRegion",Ib,this),Object(f.a)(this,"addRectangularRegion",wb,this),Object(f.a)(this,"addEllipticalRegion",Tb,this),Object(f.a)(this,"addPolygonalRegion",Rb,this),Object(f.a)(this,"addLineRegion",Ab,this),Object(f.a)(this,"addPolylineRegion",Pb,this),Object(f.a)(this,"addExistingRegion",Eb,this),Object(f.a)(this,"selectRegion",Mb,this),Object(f.a)(this,"selectRegionByIndex",Fb,this),Object(f.a)(this,"deselectRegion",kb,this),Object(f.a)(this,"deleteRegion",Db,this),Object(f.a)(this,"setNewRegionType",Lb,this),Object(f.a)(this,"setMode",Nb,this),Object(f.a)(this,"toggleMode",_b,this),Object(f.a)(this,"migrateRegionsFromExistingSet",zb,this),Object(m.p)(this),this.frame=e,this.backendService=i,this.preference=t,this.regions=[],this.newRegionType=t.regionType,this.mode=Vb.MOVING,this.addPointRegion(e.center,!0),this.selectedRegion=this.regions[0]}get regionsForRender(){var e,t;return null===(e=this.regions)||void 0===e||null===(t=e.filter((e=>e.isValid&&0!==e.regionId)))||void 0===t?void 0:t.sort(((e,t)=>e.boundingBoxArea>t.boundingBoxArea?-1:1))}addRegion(e,t,i,n=!1,r=this.getTempRegionId(),o=""){const s=new Ob(this.backendService,this.frame.frameInfo.fileId,this.frame,e,i,r,this.preference.regionColor,this.preference.regionLineWidth,this.preference.regionDashLength,t,o);return this.regions.push(s),n||this.backendService.setRegion(this.frame.frameInfo.fileId,-1,s).then((e=>{console.log(`Updating regionID from ${s.regionId} to ${e.regionId}`),s.setRegionId(e.regionId)}),(e=>console.log(e))),s}},xb=Object(b.a)(jb.prototype,"regions",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sb=Object(b.a)(jb.prototype,"selectedRegion",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vb=Object(b.a)(jb.prototype,"mode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cb=Object(b.a)(jb.prototype,"newRegionType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(jb.prototype,"regionsForRender",[m.i],Object.getOwnPropertyDescriptor(jb.prototype,"regionsForRender"),jb.prototype),Ib=Object(b.a)(jb.prototype,"addPointRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion([e],0,Nt.RegionType.POINT,t,t?0:this.getTempRegionId())}}),wb=Object(b.a)(jb.prototype,"addRectangularRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>this.addRegion([e,{x:t,y:i}],0,Nt.RegionType.RECTANGLE,n)}}),Tb=Object(b.a)(jb.prototype,"addEllipticalRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>this.addRegion([e,{x:i,y:t}],0,Nt.RegionType.ELLIPSE,n)}}),Rb=Object(b.a)(jb.prototype,"addPolygonalRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion(e,0,Nt.RegionType.POLYGON,t)}}),Ab=Object(b.a)(jb.prototype,"addLineRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion(e,0,Nt.RegionType.LINE,t)}}),Pb=Object(b.a)(jb.prototype,"addPolylineRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion(e,0,Nt.RegionType.POLYLINE,t)}}),Eb=Object(b.a)(jb.prototype,"addExistingRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n,r,o,s,a)=>{const l=this.addRegion(e,t,i,!0,n,r);return o&&(l.color=o),s&&(l.lineWidth=s),(null===a||void 0===a?void 0:a.length)&&(l.dashLength=a[0]),l}}}),Mb=Object(b.a)(jb.prototype,"selectRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regions.indexOf(e)>=0&&(this.selectedRegion=e)}}}),Fb=Object(b.a)(jb.prototype,"selectRegionByIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=0&&e<this.regions.length&&(this.selectedRegion=this.regions[e])}}}),kb=Object(b.a)(jb.prototype,"deselectRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedRegion=null}}}),Db=Object(b.a)(jb.prototype,"deleteRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&0!==e.regionId&&this.regions.length&&(e===this.selectedRegion&&(this.selectedRegion=this.regions[0]),this.regions=this.regions.filter((t=>t!==e)),e.isTemporary||this.backendService.removeRegion(e.regionId))}}}),Lb=Object(b.a)(jb.prototype,"setNewRegionType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.newRegionType=e}}}),Nb=Object(b.a)(jb.prototype,"setMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.mode=e}}}),_b=Object(b.a)(jb.prototype,"toggleMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.mode=this.mode===Vb.MOVING?Vb.CREATING:Vb.MOVING}}}),zb=Object(b.a)(jb.prototype,"migrateRegionsFromExistingSet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i=!1)=>{var n;if((null===e||void 0===e||null===(n=e.regions)||void 0===n?void 0:n.length)<=1)return;let r=-1;for(const o of e.regions){if(!this.regions.find((e=>e.modifiedTimestamp===o.modifiedTimestamp)))if(0===o.regionId){const e=Mm(t,o.center,i);this.regions.length&&0===this.regions[0].regionId&&this.regions[0].setCenter(e)}else{let e=[],n=0;switch(o.regionType){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:const r=Mm(t,o.center,i);if(!zm(r)){const s=new Ii(t,r),a=om(o.size,i?s.scale:1/s.scale);n=o.rotation+(i?1:-1)*s.rotation*180/Math.PI,e=[r,a]}break;case Nt.RegionType.POINT:case Nt.RegionType.POLYGON:case Nt.RegionType.LINE:case Nt.RegionType.POLYLINE:for(const n of o.controlPoints){const r=Mm(t,n,i);zm(r)||e.push(r)}}if(e.length){let t;o.regionType===Nt.RegionType.POINT?(t=this.addRegion(e,0,Nt.RegionType.POINT),t.setName(o.name),t.setColor(o.color)):(t=this.addExistingRegion(e,n,o.regionType,r,o.name,o.color,o.lineWidth,o.dashLength?[o.dashLength]:[]),t.endCreating()),t.setLocked(o.locked),t.modifiedTimestamp=o.modifiedTimestamp,r--}}}}}}),jb);const Gb=[L.a.BLUE3,L.a.ORANGE3,L.a.GREEN3,L.a.RED3,L.a.VIOLET3,L.a.SEPIA3,L.a.INDIGO3,L.a.GRAY3,L.a.LIME3,L.a.TURQUOISE3,L.a.FOREST3,L.a.GOLD3,L.a.COBALT3,L.a.LIGHT_GRAY3,L.a.DARK_GRAY3,L.a.WHITE,L.a.BLACK],Bb=Gb[0],qb=["blue","orange","green","red","violet","sepia","indigo","gray","lime","turquoise","forest","gold","cobalt","light_gray","dark_gray","white","black"],Hb=qb.map((e=>`auto-${e}`)),Yb=[...qb,"rose","vermilion"],Ub=new RegExp(`^auto-(${Yb.join("|")})$`);let Xb;const $b=new Image;function Kb(e){const t=Af.COLOR_MAPS_ALL.indexOf(e);if(Xb){var i;const e=null===(i=Xb)||void 0===i?void 0:i.getImageData(0,5*t+2,$b.width-1,1);return{color:null===e||void 0===e?void 0:e.data,size:null===e||void 0===e?void 0:e.width}}return{color:new Uint8ClampedArray([0,0,0,0]),size:1}}function Qb(e){return Ub.test(e)}function Zb(e){const t=Number.isInteger(e)&&e>=0?qb[e%qb.length]:qb[0];return L.a[`${t.toUpperCase()}${gC.Instance.darkTheme?"4":"2"}`]}function Jb(e){if(!Qb(e))return e;if("auto-black"===e)return L.a.BLACK;if("auto-white"===e)return L.a.WHITE;const t=e.substr(5).toUpperCase();return L.a[`${t}${gC.Instance.darkTheme?"4":"2"}`]}function em(e,t){return e.x*t.x+e.y*t.y}function tm(e,t){return e.x*t.y-e.y*t.x}function im(e,t){return{x:e.x+t.x,y:e.y+t.y}}function nm(e,t){return{x:e.x-t.x,y:e.y-t.y}}function rm(e,t){return{x:.5*(e.x+t.x),y:.5*(e.y+t.y)}}function om(e,t){return{x:e.x*t,y:e.y*t}}function sm(e){return Math.sqrt(em(e,e))}function am(e){const t=sm(e);return{x:e.x/t,y:e.y/t}}function lm(e){const t=sm(e);return{mag:t,dir:{x:e.x/t,y:e.y/t}}}function cm(e){let t={x:0,y:0};for(const i of e)t=im(t,i);return om(t,1/e.length)}function dm(e,t){const i=Math.sin(t),n=Math.cos(t);return{x:n*e.x-i*e.y,y:i*e.x+n*e.y}}function pm(e,t,i,n){return im(om(dm(nm(e,t),n),i),t)}function hm(e){let t={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE},i={x:Number.MAX_VALUE,y:Number.MAX_VALUE};for(const n of e)!n||isNaN(n.x)||isNaN(n.y)||(t.x=Math.max(t.x,n.x),t.y=Math.max(t.y,n.y),i.x=Math.min(i.x,n.x),i.y=Math.min(i.y,n.y));return{maxPoint:t,minPoint:i}}function um(e,t,i){const n=nm(i,t),r=am(n),o=em(nm(e,t),r),s=im(t,om(r,o));return{point:s,bounded:o>=0&&o<=sm(n),distance:sm(nm(e,s))}}function gm(e,t,i,n){const r=nm(n,i);if(tm(r,nm(e,n))*tm(r,nm(t,n))<0){const r=nm(t,e);return tm(r,nm(i,t))*tm(r,nm(n,t))<0}return!1}function fm(e,t){if(e.length<4)return!0;let i=e[(t+e.length)%e.length],n=e[(t+e.length+1)%e.length];for(let r=1;r<e.length;r++){if(gm(i,n,e[(r+t)%e.length],e[(r+t+1)%e.length]))return!1}return!0}function bm(e,t){const i=nm(e,t);return Math.sqrt(i.x*i.x+i.y*i.y)}function mm(e,t){const i=nm(e,t);return i.x*i.x+i.y*i.y}function ym(e,t){return e=am(e),t=am(t),Math.asin(tm(e,t))}function Om(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function jm(e,t,i){if(!e||!isFinite(e.xMin)||!isFinite(e.xMax)||!isFinite(e.yMin)||!isFinite(e.yMax)||!isFinite(e.mip))return[];if(e.xMin>=e.xMax||e.yMin>=e.yMax||e.mip<=0)return[];if(!t||!i||!isFinite(t.x)||!isFinite(t.y)||!isFinite(i.x)||!isFinite(i.y))return[];if(i.x<=0||i.y<=0||t.x<=0||t.y<=0)return[];if(e.xMax<0||e.xMin>t.x||e.yMax<0||e.yMin>t.y)return[];const n=function(e,t,i){const n=Math.ceil(t.x/i.x),r=Math.ceil(t.y/i.y),o=Math.max(n,r);return Math.ceil(Math.log2(o))-Math.ceil(Math.log2(e))}(e.mip,t,i);if(n<0)return[new wi(0,0,0)];const r=Math.max(0,e.xMin),o=Math.min(e.xMax,t.x),s=Math.max(0,e.yMin),a=Math.min(e.yMax,t.y),l=(e.mip,e.mip*i.x),c=e.mip*i.y,d=Math.floor(r/l),p=Math.ceil(o/l),h=Math.floor(s/c),u=Math.ceil(a/c),g=new Array((p-d)*(u-h));for(let f=d,b=0;f<p;f++)for(let e=h;e<u;e++,b++)g[b]=new wi(f,e,n);return g}$b.src=D,$b.onload=()=>{Xb=function(e,t){const i=document.createElement("canvas");return i.width=e,i.height=t,i.getContext("2d")}($b.width,$b.height),Xb.drawImage($b,0,0,$b.width,$b.height,0,0,$b.width,$b.height)};var xm=i(0);const Sm={WebGLErrorMessage:Object(xm.jsxs)(r.a.Fragment,{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)("b",{children:"Could not load WebGL. Images will not be displayed properly."})}),Object(xm.jsx)("p",{children:Object(xm.jsx)("small",{children:" If you are using CARTA through a browser, please ensure your browser supports WebGL. If you are using the CARTA standalone app, please ensure you are not running in a remote desktop. "})})]}),WebGL2ErrorMessage:Object(xm.jsxs)("div",{children:[Object(xm.jsx)("div",{children:Object(xm.jsx)("p",{children:"Could not load WebGL2.0. The catalog overlay feature will not be available."})}),Object(xm.jsx)("div",{children:Object(xm.jsx)("small",{children:" If you are using CARTA with Safari, please ensure WebGL2.0 is enabled at Develop > Experimental Features > WebGL2.0 then reload the page."})})]})},vm=WebGL2RenderingContext;function Cm(e,t,i){if(!e||!t||i!==vm.VERTEX_SHADER&&i!==vm.FRAGMENT_SHADER)return null;let n=e.createShader(i);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,vm.COMPILE_STATUS)?n:(console.log(e.getShaderInfoLog(n)),null)}function Im(e,t,i){if(!e)return null;let n=Cm(e,t,vm.VERTEX_SHADER),r=Cm(e,i,vm.FRAGMENT_SHADER),o=e.createProgram();return e.attachShader(o,n),e.attachShader(o,r),e.linkProgram(o),e.getProgramParameter(o,vm.LINK_STATUS)?o:(console.log("Could not initialise shaders"),null)}function wm(e,t,i){return new Promise(((n,r)=>{e||r();const o=new Image;o.onload=()=>{const t=e.createTexture();e.activeTexture(i),e.bindTexture(vm.TEXTURE_2D,t),e.texImage2D(vm.TEXTURE_2D,0,vm.RGB,vm.RGB,vm.UNSIGNED_BYTE,o),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_S,vm.CLAMP_TO_EDGE),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_T,vm.CLAMP_TO_EDGE),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,vm.NEAREST),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,vm.NEAREST),n(t)},o.onerror=()=>r(`Error loading image ${t}`),o.src=t}))}function Tm(e,t,i,n,r=vm.NEAREST){if(!e)return null;const o=e.createTexture();return e.activeTexture(n),e.bindTexture(vm.TEXTURE_2D,o),e.texImage2D(vm.TEXTURE_2D,0,vm.R32F,t,i,0,vm.RED,vm.FLOAT,new Float32Array(t*i)),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,r),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,r),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_S,vm.CLAMP_TO_EDGE),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_T,vm.CLAMP_TO_EDGE),o}function Rm(){const e=document.createElement("canvas").getContext("webgl2");return e||(Bx.Instance.showAlert(Sm.WebGL2ErrorMessage,"issue"),null)}function Am(e,t,i=WebGL2RenderingContext.TEXTURE0,n=1){const r=t.length/n;if(t.length%n!==0)return console.error(`Invalid data size (${t.length} for number of components ${n}`),null;let o,s=Math.ceil(Math.sqrt(r)),a=Math.ceil(r/s);const l="UIn8"===(t.constructor===Uint8Array?"UIn8":"Float32");if(s*a===r)o=t;else{const e=s*a*n;o=l?new Uint8Array(e):new Float32Array(e),o.set(t,0)}const c=e.createTexture();switch(e.activeTexture(i),e.bindTexture(vm.TEXTURE_2D,c),n){case 1:l?(e.pixelStorei(vm.UNPACK_ALIGNMENT,1),e.texImage2D(vm.TEXTURE_2D,0,vm.R8UI,s,a,0,vm.RED_INTEGER,vm.UNSIGNED_BYTE,o)):e.texImage2D(vm.TEXTURE_2D,0,vm.R32F,s,a,0,vm.RED,vm.FLOAT,o);break;case 2:e.texImage2D(vm.TEXTURE_2D,0,vm.RG32F,s,a,0,vm.RG,vm.FLOAT,o);break;case 3:e.texImage2D(vm.TEXTURE_2D,0,vm.RGB32F,s,a,0,vm.RGB,vm.FLOAT,o);break;case 4:e.texImage2D(vm.TEXTURE_2D,0,vm.RGBA32F,s,a,0,vm.RGBA,vm.FLOAT,o);break;default:return console.error(`Invalid number of components specified: ${n}`),null}return e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,vm.NEAREST),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,vm.NEAREST),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_S,vm.CLAMP_TO_EDGE),e.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_T,vm.CLAMP_TO_EDGE),c}function Pm(e,t){if(!e||!t)return!1;const i=/^-?\d{0,2}:\d{0,2}:(\d{1,2}(\.\d+)?)?$/,n=/^-?\d*:\d{0,2}:(\d{1,2}(\.\d+)?)?$/;return t===iA.HMS?i.test(e):t===iA.DMS?n.test(e):/^-?\d+(\.\d+)?$/.test(e)}function Em(e){return e?e.entryType===Nt.EntryType.FLOAT||e.entryType===Nt.EntryType.INT?e.numericValue:parseFloat(nn(e.value)):NaN}function Mm(e,t,i=!0){return Pt.transformPoint(e,t.x,t.y,i)}function Fm(e,t){var i,n;const r=null===e||void 0===e||null===(i=e.frameInfo)||void 0===i||null===(n=i.fileInfoExtended)||void 0===n?void 0:n.headerEntries;if(!r)return NaN;let o=r.find((e=>e.name===`CDELT${t}`));return o||(o=r.find((e=>e.name===`PC${t}_${t}`)),o||(o=r.find((e=>e.name===`CD${t}_${t}`)))),Em(o)}function km(e,t){if(e){const i=Mm(e,t),n=Pt.normalizeCoordinates(e,i.x,i.y),r=Pt.getFormattedCoordinates(e,n.x,n.y);if(r)return r}return null}function Dm(e,t){if(e){return Mm(e,Pt.getWCSValueFromFormattedString(e,t),!1)}return null}function Lm(e,t,i,n){if(i===Wt.CHANNEL)return n;const r=Kt.get(i);if(!r)return NaN;Pt.set(e,`System=${i}, StdOfRest=Helio, Unit=${r}`),Pt.set(t,`System=${i}, StdOfRest=Helio, Unit=${r}`);const o=Pt.transform3DPoint(e,0,0,n,!0);if(!o||!isFinite(o.z))return NaN;const s=Pt.transform3DPoint(t,0,0,0,!0),a=Pt.transform3DPoint(t,s.x,s.y,o.z,!1);return a&&isFinite(a.z)?a.z:NaN}function Nm(e,t,i,n,r){if(i===Wt.CHANNEL||n>r)return[];const o=Kt.get(i);if(!o)return[];Pt.set(e,`System=${i}, StdOfRest=Helio, Unit=${o}`),Pt.set(t,`System=${i}, StdOfRest=Helio, Unit=${o}`);const s=r-n+1,a=new Array(s);for(let l=0;l<s;l++){const i=Pt.transform3DPoint(e,1,1,n+l+1,!0);if(!i||!isFinite(i.z)||_m(i.z)){a[l]=NaN;continue}const r=Pt.transform3DPoint(t,1,1,1,!0),o=Pt.transform3DPoint(t,r.x,r.y,i.z,!1);o&&isFinite(o.z)&&!_m(i.z)?a[l]=o.z-1:a[l]=NaN}return a}function _m(e){return!isFinite(e)||e===-Number.MAX_VALUE}function zm(e){return!e||_m(e.x)||_m(e.y)}function Vm(e,t,i,n=!0){const r=function(e,t=!0){let i=0;const n=e.length;for(let r=1;r<n;r++)i+=bm(e[r],e[r-1]);return t&&(i+=bm(e[n-1],e[0])),i}(t,n)/i,o=t.length+(n?1:0),s=new Array;for(let l=1;l<o;l++){const e=t[l%t.length],i=t[l-1],{mag:n,dir:o}=lm(nm(e,i)),a=Math.round(n/r),c=n/a;s.push(i);for(let t=1;t<a;t++){const e=im(i,om(o,t*c));s.push(e)}}const a=s.length;if(a){const t=new Float64Array(a),i=new Float64Array(a);for(let e=0;e<a;e++)t[e]=s[e].x,i[e]=s[e].y;const n=Pt.transformPointArrays(e,t,i,!1),r=new Array(a);for(let e=0;e<a;e++)r[e]={x:n.x[e],y:n.y[e]};return r}return[]}function Wm(e){switch(e){case Nt.ColumnType.String:return"string";case Nt.ColumnType.Uint8:return"uint8";case Nt.ColumnType.Int8:return"int8";case Nt.ColumnType.Uint16:return"uint16";case Nt.ColumnType.Int16:return"int16";case Nt.ColumnType.Uint32:return"uint32";case Nt.ColumnType.Int32:return"int32";case Nt.ColumnType.Uint64:return"uint64";case Nt.ColumnType.Int64:return"int64";case Nt.ColumnType.Float:return"float";case Nt.ColumnType.Double:return"double";case Nt.ColumnType.Bool:return"bool";default:return"unsupported"}}function Gm(e,t){const i=t.length;let n;if(e.dataType===Nt.ColumnType.String){const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}else if(e.dataType===Nt.ColumnType.Bool){const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}else{if(e.dataType===Nt.ColumnType.UnsupportedType)return{dataType:Nt.ColumnType.UnsupportedType,data:[]};{const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}}return{dataType:e.dataType,data:n}}function Bm(e="YYYY-MM-DD-HH-mm-ss"){return _i()(new Date).format(e)}function qm(){return+_i()(new Date)}function Hm(e,t,i){const n=encodeURI(`data:text/tab-separated-values;charset=utf-8,${i}\n`).replace(/#/g,"%23"),r=document.createElement("a");return r.href=n,r.download=`${e}-${t.replace(" ","-")}-${Bm()}.tsv`,r.dispatchEvent(new MouseEvent("click")),null}function Ym(e,t){const i=encodeURI(`data:text/plain;charset=utf-8,${t}\n`).replace(/#/g,"%23"),n=document.createElement("a");return n.href=i,n.download=`${e}.txt`,n.dispatchEvent(new MouseEvent("click")),null}var Um;!function(e){e.CHAR="CHAR",e.SHORT="SHORT",e.FLOAT="FLOAT",e.LONG="LONG",e.INT="INT",e.DOUBLE="DOUBLE",e.UNSIGNEDBYTE="UNSIGNEDBYTE"}(Um||(Um={}));class Xm{static ProcessSimbadMetaData(e){let t=new Array(e.length+2);for(let i=0;i<e.length;i++){const n=e[i];t[i]=new Nt.CatalogHeader({name:n.name,description:n.description,dataType:Xm.matchDataType(n.datatype),columnIndex:i,units:n.unit}),"dist"===n.name&&(t[i].units="arcsec",t[i].description="Distance to the center coordiante (computed by CARTA)")}return t[e.length]=new Nt.CatalogHeader({name:"RA_HMS",description:"RA in sexagesimal format (H:M:S, computed by CARTA)",dataType:Nt.ColumnType.String,columnIndex:e.length,units:"H:M:S"}),t[e.length+1]=new Nt.CatalogHeader({name:"DEC_DMS",description:"DEC in sexagesimal format (D:M:S, computed by CARTA)",dataType:Nt.ColumnType.String,columnIndex:e.length+1,units:"D:M:S"}),t}static ProcessSimbadData(e,t){var i,n;const r=new Map,o=null===(i=t.filter((e=>"ra"===e.name))[0])||void 0===i?void 0:i.columnIndex,s=null===(n=t.filter((e=>"dec"===e.name))[0])||void 0===n?void 0:n.columnIndex,a=gC.Instance.activeFrame,l=`${iA.HMS}.6`,c=`${iA.DMS}.6`,d=Pt.copy(a.wcsInfo);Pt.set(d,`System=${tA.ICRS}`),Pt.set(d,`Format(1)=${l}`),Pt.set(d,`Format(2)=${c}`);const p=Math.PI/180;for(let h=0;h<t.length;h++){const i=t[h];let n={dataType:i.dataType,data:new Array(e.length)};for(let t=0;t<e.length;t++)if("dist"===i.name)n.data[t]=Number((3600*e[t][i.columnIndex]).toFixed(6));else if("RA_HMS"===i.name&&o>-1){const i=Pt.format(d,1,e[t][o]*p);n.data[t]=i}else if("DEC_DMS"===i.name&&s>-1){const i=Pt.format(d,2,e[t][s]*p);n.data[t]=i}else n.data[t]=e[t][i.columnIndex];r.set(h,n)}return Pt.deleteObject(d),r}static matchDataType(e){switch(e.toUpperCase()){case Um.CHAR:return Nt.ColumnType.String;case Um.INT:case Um.SHORT:return Nt.ColumnType.Int16;case Um.LONG:return Nt.ColumnType.Int32;case Um.FLOAT:return Nt.ColumnType.Float;case Um.DOUBLE:return Nt.ColumnType.Double;case Um.UNSIGNEDBYTE:return Nt.ColumnType.Uint16;default:return Nt.ColumnType.UnsupportedType}}static ProcessVizierData(e){const t=new Map;let i;i=(new DOMParser).parseFromString(e,"application/xml");const n=i.documentElement.getElementsByTagName("RESOURCE");for(let a=0;a<n.length;a++){const e=n[a],i=e.getElementsByTagName("TABLE");for(let n=0;n<i.length;n++){var r;const a=i[n],l=a.getAttribute("name");if(null===(r=a.getElementsByTagName("FIELD"))||void 0===r?void 0:r.length){var o,s;const i={id:e.getAttribute("ID"),name:e.getAttribute("name"),description:null===(o=e.getElementsByTagName("DESCRIPTION")[0])||void 0===o?void 0:o.textContent,coosys:{system:Yn.FK5,equinox:"J2000"},table:{name:l,description:null===(s=a.getElementsByTagName("DESCRIPTION")[0])||void 0===s?void 0:s.textContent,tableElement:a}};t.set(l,i)}}}return t}static ProcessVizierTableData(e){var t,i;const n=e.getElementsByTagName("FIELD");let r=new Array(n.length);for(let c=0;c<n.length;c++){var o;const e=n[c];r[c]=new Nt.CatalogHeader({name:e.getAttribute("name"),description:null===(o=e.getElementsByTagName("DESCRIPTION")[0])||void 0===o?void 0:o.textContent,dataType:Xm.matchDataType(e.getAttribute("datatype")),columnIndex:c,units:e.getAttribute("unit")})}const s=null===(t=e.getElementsByTagName("DATA")[0])||void 0===t||null===(i=t.getElementsByTagName("TABLEDATA")[0])||void 0===i?void 0:i.getElementsByTagName("TR"),a=null===s||void 0===s?void 0:s.length,l=new Map;for(let c=0;c<r.length;c++){let e={dataType:r[c].dataType,data:new Array(a)};l.set(c,e)}for(let c=0;c<a;c++){const e=s[c].getElementsByTagName("TD");for(let t=0;t<e.length;t++)l.get(t).data[c]=e[t].textContent}return{headers:r,dataMap:l,size:a}}}class $m{static ProcessSpatialProfile(e){return e.rawValuesFp32&&e.rawValuesFp32.length&&e.rawValuesFp32.length%4===0?{coordinate:e.coordinate,start:e.start,end:e.end,mip:e.mip,values:new Float32Array(e.rawValuesFp32.slice().buffer),lineAxis:e.lineAxis}:{coordinate:e.coordinate,start:e.start,end:e.end,mip:e.mip,values:null,lineAxis:e.lineAxis}}static ProcessSpectralProfile(e,t){return e.rawValuesFp64&&e.rawValuesFp64.length&&e.rawValuesFp64.length%8===0?{coordinate:e.coordinate,statsType:e.statsType,values:new Float64Array(e.rawValuesFp64.slice().buffer),progress:t}:e.rawValuesFp32&&e.rawValuesFp32.length&&e.rawValuesFp32.length%4===0?{coordinate:e.coordinate,statsType:e.statsType,values:new Float32Array(e.rawValuesFp32.slice().buffer),progress:t}:{coordinate:e.coordinate,statsType:e.statsType,values:null,progress:0}}static ProcessContourSet(e){let t;if(e.decimationFactor>=1)t=X.Decode(e.rawCoordinates,e.uncompressedCoordinatesSize,e.decimationFactor);else{const i=e.rawCoordinates.slice();t=new Float32Array(i.buffer)}const i=new Int32Array(e.rawStartIndices.buffer.slice(e.rawStartIndices.byteOffset,e.rawStartIndices.byteOffset+e.rawStartIndices.byteLength));return{level:e.level,indexOffsets:i,coordinates:t}}static ProcessContourData(e){return{fileId:e.fileId,channel:e.channel,stokes:e.stokes,imageBounds:e.imageBounds,progress:e.progress,contourSets:e.contourSets?e.contourSets.map((e=>this.ProcessContourSet(e))):null}}static GetProcessedData(e){let t;switch(e.dataType){case Nt.ColumnType.Uint8:t=new Uint8Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Int8:t=new Int8Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Uint16:t=new Uint16Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Int16:t=new Int16Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Uint32:t=new Uint32Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Int32:t=new Int32Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Float:t=new Float32Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Double:t=new Float64Array(e.binaryData.slice().buffer);break;case Nt.ColumnType.Int64:t=X.ConvertInt64Array(e.binaryData,!0);break;case Nt.ColumnType.Uint64:t=X.ConvertInt64Array(e.binaryData,!1);break;case Nt.ColumnType.Bool:const i=new Uint8Array(e.binaryData.slice().buffer),n=new Array(i.length);for(let e=n.length-1;e>=0;e--)n[e]=0!==i[e];return{dataType:e.dataType,data:n};case Nt.ColumnType.String:return{dataType:e.dataType,data:e.stringData};default:return{dataType:Nt.ColumnType.UnsupportedType,data:[]}}return{dataType:e.dataType,data:t}}static ProcessCatalogData(e){const t=new Map;return new Map(Object.entries(e)).forEach(((e,i)=>{t.set(parseInt(i),$m.GetProcessedData(e))})),t}}var Km,Qm,Zm,Jm,ey;i(788);const ty=A.a.ofType(),iy="custom-color";let ny=Object(p.a)((ey=Jm=class e extends n.Component{get autoColor(){return Jb(this.props.color)}constructor(t){super(t),Object(f.a)(this,"displayColorPicker",Zm,this),this.handleColorChange=T.throttle((e=>{this.props.setColor&&this.props.setColor(e.hex)}),e.CHANGE_DELAY),this.renderColorBlock=e=>Object(xm.jsx)("div",{className:"dropdown-color",style:{backgroundColor:e},children:"\xa0"}),this.renderColorSelectItem=(e,{handleClick:t,modifiers:i})=>{if(e===iy){const e=d()("color-picker-popup",{"bp3-dark":gC.Instance.darkTheme});return Object(xm.jsx)("div",{className:"custom-color",children:Object(xm.jsx)(O.a,{position:u.H.BOTTOM_RIGHT,popoverClassName:e,content:Object(xm.jsx)(R.a,{color:this.autoColor,onChange:this.handleColorChange,disableAlpha:this.props.disableAlpha,presetColors:this.props.presetColors}),children:Object(xm.jsx)(u.e,{text:"Other",className:"color-swatch-button",disabled:this.props.disabled})})},"custom-color")}return Object(xm.jsx)(u.B,{active:i.active,disabled:i.disabled,onClick:t,text:this.renderColorBlock(Jb(e))},e)},Object(m.p)(this)}render(){const e=this.props.color;return Object(xm.jsx)(ty,{activeItem:e,onItemSelect:e=>this.props.setColor(e),popoverProps:{minimal:!0,position:u.H.BOTTOM_LEFT,popoverClassName:"colorselect"},filterable:!1,items:[...Hb,iy],itemRenderer:this.renderColorSelectItem,disabled:this.props.disabled,children:Object(xm.jsx)(u.e,{className:"colorselect",text:this.renderColorBlock(this.autoColor),rightIcon:"double-caret-vertical",disabled:this.props.disabled})})}},Jm.CHANGE_DELAY=100,Qm=ey,Zm=Object(b.a)(Qm.prototype,"displayColorPicker",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Qm.prototype,"autoColor",[m.i],Object.getOwnPropertyDescriptor(Qm.prototype,"autoColor"),Qm.prototype),Km=Qm))||Km;var ry,oy=i(16);let sy=Object(p.a)(ry=class extends n.Component{constructor(...e){super(...e),this.updateValuesTimer=void 0,this.updateValues=(e,t,i)=>{clearTimeout(this.updateValuesTimer),this.updateValuesTimer=setTimeout((()=>{const i=Gi(e,0,this.props.boardWidth)/this.props.boardWidth*(this.props.biasMax-this.props.biasMin)+this.props.biasMin,n=this.props.contrastMax-Gi(t,0,this.props.boardHeight)/this.props.boardHeight*(this.props.contrastMax-this.props.contrastMin);this.props.setBias(i),this.props.setContrast(n)}),i)},this.handleDoubleClick=()=>{clearTimeout(this.updateValuesTimer),this.props.resetBias(),this.props.resetContrast()},this.handleClick=e=>{const t=e.target.getStage().getPointerPosition();this.updateValues(t.x,t.y,300)},this.handleDragMove=e=>{const t=e.target.getPosition();this.updateValues(t.x,t.y,10)},this.resetButton=e=>Object(xm.jsx)(u.e,{icon:"refresh",minimal:!0,small:!0,onClick:e})}render(){const e=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(oy.g,{x:0,y:0,width:this.props.boardWidth,height:this.props.boardHeight,stroke:L.a.LIGHT_GRAY1,strokeWidth:4,onClick:this.handleClick,onDblClick:this.handleDoubleClick}),Object(xm.jsx)(oy.b,{x:(this.props.bias-this.props.biasMin)*this.props.boardWidth/(this.props.biasMax-this.props.biasMin),y:(this.props.contrastMax-this.props.contrast)*this.props.boardHeight/(this.props.contrastMax-this.props.contrastMin),radius:5,fill:L.a.GRAY3,draggable:!0,dragBoundFunc:e=>({x:Gi(e.x,0,this.props.boardWidth),y:Gi(e.y,0,this.props.boardHeight)}),onDragMove:this.handleDragMove,onDblClick:this.handleDoubleClick})]});return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(oy.j,{className:"bias-contrast-stage",width:this.props.boardWidth,height:this.props.boardHeight,style:{paddingBottom:10},children:Object(xm.jsx)(oy.e,{children:e})}),Object(xm.jsx)(u.p,{label:"Bias",inline:!0,children:Object(xm.jsx)(pO,{className:"step-input",min:this.props.biasMin,max:this.props.biasMax,stepSize:.1,majorStepSize:.5,value:this.props.bias,onValueChange:this.props.setBias,rightElement:this.resetButton(this.props.resetBias)})}),Object(xm.jsx)(u.p,{label:"Contrast",inline:!0,children:Object(xm.jsx)(pO,{className:"step-input",min:this.props.contrastMin,max:this.props.contrastMax,stepSize:.1,majorStepSize:.5,value:this.props.contrast,onValueChange:this.props.setContrast,rightElement:this.resetButton(this.props.resetContrast)})})]})}})||ry;var ay,ly,cy,dy,py;let hy=Object(p.a)((py=dy=class e extends n.Component{componentDidMount(){var e,t,i,n,r,o;this.props.focused&&(null===(e=this.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.setSelectionRange(0,0),null===(i=this.inputRef)||void 0===i||null===(n=i.current)||void 0===n||n.focus(),null===(r=this.inputRef)||void 0===r||null===(o=r.current)||void 0===o||o.select())}componentDidUpdate(){var e,t,i,n,r,o;this.props.focused&&(null===(e=this.inputRef)||void 0===e||null===(t=e.current)||void 0===t||t.setSelectionRange(0,0),null===(i=this.inputRef)||void 0===i||null===(n=i.current)||void 0===n||n.focus(),null===(r=this.inputRef)||void 0===r||null===(o=r.current)||void 0===o||o.select())}constructor(e){super(e),this.inputRef=n.createRef(),Object(f.a)(this,"isFocused",cy,this),this.handleChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(this.validation(e.currentTarget.value));this.props.onValueChanged(t)},this.handleOnFocus=()=>{this.props.displayExponential&&this.setFocused(!0)},this.handleOnBlur=e=>{this.handleChange(e),this.props.displayExponential&&this.setFocused(!1)},this.validation=e=>{const t=parseFloat(e);let i=e;if(this.props.integerOnly){const e=Math.round(t);isFinite(e)&&(i=e.toString())}return this.props.min&&t<this.props.min&&(i=this.props.min.toString()),this.props.max&&t>this.props.max&&(i=this.props.max.toString()),i},Object(m.p)(this)}setFocused(e){this.isFocused=e}render(){var t,i,n;let r=this.props.value;return void 0!==r&&(r=this.props.displayExponential&&!this.isFocused?gi(Number(this.props.value),3):this.props.value),Object(xm.jsx)(u.p,{className:this.props.className,label:this.props.label,labelInfo:this.props.labelInfo,inline:void 0===this.props.inline,disabled:this.props.disabled,children:Object(xm.jsx)(u.D,{inputRef:this.inputRef,asyncControl:!0,stepSize:this.props.stepSize,value:r,minorStepSize:null!==(t=this.props.minorStepSize)&&void 0!==t?t:e.minorStepSize,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.handleChange,buttonPosition:"none",disabled:this.props.disabled,rightElement:Object(xm.jsx)(j.a,{content:null!==(i=this.props.tooltipContent)&&void 0!==i?i:"Reset value to default",disabled:this.props.disabled||this.props.resetDisabled,placement:null!==(n=this.props.tooltipPlacement)&&void 0!==n?n:"auto",children:Object(xm.jsx)(u.b,{icon:"refresh",minimal:!0,onClick:this.props.onValueCleared,disabled:this.props.disabled||this.props.resetDisabled})}),placeholder:this.props.placeholder})})}},dy.minorStepSize=.001,ly=py,cy=Object(b.a)(ly.prototype,"isFocused",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(b.a)(ly.prototype,"setFocused",[m.g],Object.getOwnPropertyDescriptor(ly.prototype,"setFocused"),ly.prototype),ay=ly))||ay;var uy,gy,fy,by,my,yy,Oy;i(790);let jy=Object(p.a)((Oy=yy=class e extends n.Component{constructor(t){super(t),Object(f.a)(this,"displayColorPicker",fy,this),Object(f.a)(this,"handleColorClick",by,this),Object(f.a)(this,"handleColorClose",my,this),this.handleColorChange=T.throttle((e=>{this.props.setColor&&this.props.setColor(e)}),e.CHANGE_DELAY),Object(m.p)(this)}render(){let e=d()("color-picker-popup",{"bp3-dark":this.props.darkTheme});const t=je()(this.props.color).toString();return Object(xm.jsx)(O.a,{isOpen:this.displayColorPicker,onClose:this.handleColorClose,position:u.H.RIGHT,popoverClassName:e,content:Object(xm.jsx)(R.a,{color:this.props.color,onChange:this.handleColorChange,disableAlpha:this.props.disableAlpha,presetColors:this.props.presetColors}),children:Object(xm.jsx)(u.e,{onClick:this.handleColorClick,className:"color-swatch-button",disabled:this.props.disabled,children:Object(xm.jsx)("div",{style:{backgroundColor:t}})})})}},yy.CHANGE_DELAY=100,gy=Oy,fy=Object(b.a)(gy.prototype,"displayColorPicker",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),by=Object(b.a)(gy.prototype,"handleColorClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.displayColorPicker=!0}}}),my=Object(b.a)(gy.prototype,"handleColorClose",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.displayColorPicker=!1}}}),uy=gy))||uy;const xy=A.a.ofType(),Sy={minimal:!0,position:"auto-end",popoverClassName:"colormap-select-popover"},vy=e=>{const t=t=>{const i=Af.COLOR_MAPS_ALL.length,n=Af.COLOR_MAPS_ALL.indexOf(t);return Object(xm.jsx)("div",{className:"colormap-block",style:{transform:`scaleX(${e.inverted?-1:1})`,height:"15px",backgroundImage:`url(${D})`,backgroundSize:`100% calc(300% * ${i})`,backgroundPosition:`0 calc(300% * -${n} - 15px)`}})};return Object(xm.jsx)(xy,{disabled:e.disabled,activeItem:e.selectedItem,popoverProps:Sy,filterable:!1,items:Af.COLOR_MAPS_SELECTED,onItemSelect:e.onItemSelect,itemRenderer:(e,{handleClick:i,modifiers:n,query:r})=>n.matchesPredicate?Object(xm.jsx)(u.B,{active:n.active,disabled:n.disabled,label:e,onClick:i,text:t(e)},e):null,children:Object(xm.jsx)(u.e,{disabled:e.disabled,text:t(e.selectedItem),rightIcon:"double-caret-vertical",alignText:"right"})})};var Cy;let Iy=Object(p.a)(Cy=class extends n.Component{render(){const e=gC.Instance;return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.A,{title:"Resolution"}),Object(xm.jsx)(u.B,{text:"Normal (100%)",label:`${e.modifierString}E`,onClick:()=>e.exportImage(1)}),Object(xm.jsx)(u.B,{text:"High (200%)",onClick:()=>e.exportImage(2)}),Object(xm.jsx)(u.B,{text:"Highest (400%)",onClick:()=>e.exportImage(4)})]})}})||Cy;var wy=i(188),Ty=i(458);let Ry;!function(e){e[e.Automatic=0]="Automatic",e[e.Scientific=1]="Scientific",e[e.Integer=2]="Integer"}(Ry||(Ry={}));class Ay extends n.Component{constructor(...e){super(...e),this.plotRef=void 0,this.chartArea=void 0,this.afterChartLayout=e=>{if(this.props.isGroupSubPlot){var t=e.scales["x-axis-0"],i=e.scales["y-axis-0"];const n=e.width;e.chartArea.left=85,e.chartArea.right=n-1,t.left=85,t.right=n-1,t.width=t.right-t.left,t._startPixel=t.left,t._length=t.width,e.chartArea.left=85,e.chartArea.right=n-1,i.right=t.left,i.width=i.right-i.left}T.isEqual(e.chartArea,this.chartArea)||(this.chartArea=e.chartArea,this.props.chartAreaUpdated&&this.props.chartAreaUpdated(this.chartArea))},this.onRef=e=>{e!==this.plotRef&&(this.plotRef=e,this.props.plotRefUpdated&&this.props.plotRefUpdated(this.plotRef))},this.filterLogTicks=e=>{const t=this.removeAdditionalTicks(e.ticks);if(t&&t.length){let i=t.filter((e=>{const t=Math.floor(Math.log10(e.value)),i=e.value*Math.pow(10,t);return Math.abs(i%1)<1e-6}));i.length>8&&(i=t.filter((e=>Math.abs(Math.log10(e.value)%1)<.001||Math.abs(Math.log10(e.value/2)%1)<.001)),i.length>8&&(i=t.filter((e=>Math.abs(Math.log10(e.value)%1)<.001)))),e.ticks=i}},this.filterLinearTicks=(e,t=!0)=>{let i,n=!1,r=!1;const o=t?this.removeAdditionalTicks(e.ticks):e.ticks;if(o&&o.length>=4){const e=Math.abs(o[2].value-o[1].value),t=Math.abs(o[1].value-o[0].value),s=Math.abs(o[o.length-1].value-o[o.length-2].value);(t<.999*e||t>1.001*e)&&(n=!0),(s<.999*e||s>1.001*e)&&(r=!0);const a=o.length>3?o[2].value-o[1].value:o[1].value-o[0].value;for(let i=1;i<o.length-1;i++){const e=o[i].value;if(o[i-1].value*o[i+1].value<0&&Math.abs(e)<Math.abs(.001*a)){o[i].value=0;break}}e<1&&(i=Math.abs(Math.floor(Math.log10(e))))}const s=o.slice(n?1:0,r?-1:void 0);e.ticks=i?s.map((e=>(e.value=Number(e.value.toFixed(i)),e))):s},this.filterYLogTicks=e=>this.filterLogTicks(e),this.filterYLinearTicks=e=>this.filterLinearTicks(e),this.removeAdditionalTicks=e=>{var t,i,n,r;let o=e;return 1!==(null===(t=this.props.data)||void 0===t?void 0:t.length)||(null===(i=this.props.multiPlotPropsMap)||void 0===i?void 0:i.size)?(null===(n=this.props.data)||void 0===n?void 0:n.length)||1!==(null===(r=this.props.multiPlotPropsMap)||void 0===r?void 0:r.size)||this.props.multiPlotPropsMap.forEach((t=>{var i;1===(null===(i=t.data)||void 0===i?void 0:i.length)&&(o=e.slice(1,e.length-1))})):o=e.slice(1,e.length-1),o}}static GetCallbackForTickType(e){switch(e){case Ry.Scientific:return Ay.FormatTicksScientific;case Ry.Integer:return Ay.FormatTicksInteger;default:return Ay.FormatTicksAutomatic}}static ConvertLogData(e){if(!(null===e||void 0===e?void 0:e.length))return e;for(let t=0;t<e.length;t++){const i=e[t];0===i.y&&(i.y=.5)}return e}shouldComponentUpdate(e){const t=this.props;if(t.width!==e.width)return!0;if(t.height!==e.height)return!0;if(t.lineColor!==e.lineColor)return!0;if(t.opacity!==e.opacity)return!0;if(t.tickTypeX!==e.tickTypeX)return!0;if(t.tickTypeY!==e.tickTypeY)return!0;if(t.darkMode!==e.darkMode)return!0;if(t.logY!==e.logY)return!0;if(t.xLabel!==e.xLabel)return!0;if(t.xMin!==e.xMin)return!0;if(t.xMax!==e.xMax)return!0;if(t.yMin!==e.yMin)return!0;if(t.yMax!==e.yMax)return!0;if(t.yLabel!==e.yLabel)return!0;if(t.showTopAxis!==e.showTopAxis)return!0;if(t.topAxisTickFormatter!==e.topAxisTickFormatter)return!0;if(t.showXAxisTicks!==e.showXAxisTicks)return!0;if(t.showXAxisLabel!==e.showXAxisLabel)return!0;if(t.xZeroLineColor!==e.xZeroLineColor)return!0;if(t.yZeroLineColor!==e.yZeroLineColor)return!0;if(t.showLegend!==e.showLegend)return!0;if(t.xTickMarkLength!==e.xTickMarkLength)return!0;if(t.plotType!==e.plotType)return!0;if(t.dataBackgroundColor!==e.dataBackgroundColor)return!0;if(t.isGroupSubPlot!==e.isGroupSubPlot)return!0;if(t.pointRadius!==e.pointRadius)return!0;if(t.zeroLineWidth!==e.zeroLineWidth)return!0;if(t.borderWidth!==e.borderWidth)return!0;if(!t.data||!e.data||t.data.length!==e.data.length)return!0;for(let i=0;i<t.data.length;i++)if(t.data[i].x!==e.data[i].x||t.data[i].y!==e.data[i].y)return!0;if(!t.multiColorSingleLineColors||!e.multiColorSingleLineColors||t.multiColorSingleLineColors.length!==e.multiColorSingleLineColors.length)return!0;for(let i=0;i<t.multiColorSingleLineColors.length;i++)if(t.multiColorSingleLineColors[i]!==e.multiColorSingleLineColors[i])return!0;return!T.isEqual(t.multiPlotPropsMap,e.multiPlotPropsMap)}render(){var e,t;const i=this.props.darkMode?L.a.LIGHT_GRAY4:L.a.GRAY1,n=this.props.darkMode?L.a.DARK_GRAY5:L.a.LIGHT_GRAY1;let r=this.props.lineColor||(this.props.darkMode?L.a.BLUE4:L.a.BLUE2);const o=Gi(this.props.opacity||1,0,1);o<1&&(r=je()(r).setAlpha(o).toRgbString());let s={maintainAspectRatio:!1,plugins:{legend:{display:void 0!==this.props.showLegend&&this.props.showLegend}},scales:{"x-axis-0":{position:"bottom",min:this.props.xMin,max:this.props.xMax,afterBuildTicks:e=>this.filterLinearTicks(e,!1),title:{color:i,display:void 0===this.props.showXAxisLabel||this.props.showXAxisLabel,text:this.props.xLabel},ticks:{includeBounds:!1,display:void 0===this.props.showXAxisTicks||this.props.showXAxisTicks,maxRotation:0,color:i,callback:Ay.GetCallbackForTickType(this.props.tickTypeX)},grid:{drawBorder:!1,color:e=>0===e.index&&this.props.xZeroLineColor?this.props.xZeroLineColor:n,lineWidth:e=>0===e.index&&this.props.zeroLineWidth?this.props.zeroLineWidth:1,tickLength:0===this.props.xTickMarkLength?this.props.xTickMarkLength:10}},"x-axis-1":{position:"top",min:this.props.xMin,max:this.props.xMax,afterBuildTicks:e=>this.filterLinearTicks(e,!1),type:"linear",display:void 0!==this.props.showTopAxis,ticks:{includeBounds:!1,color:i,maxRotation:0}},"y-axis-0":{min:this.props.yMin,max:this.props.yMax,title:{color:i,display:void 0===this.props.showYAxisLabel||this.props.showYAxisLabel,text:this.props.yLabel},ticks:{includeBounds:!1,color:i,display:void 0===this.props.showYAxisTicks||this.props.showYAxisTicks,callback:Ay.GetCallbackForTickType(this.props.tickTypeY)},grid:{drawBorder:!1,color:e=>0===e.index&&this.props.xZeroLineColor?this.props.xZeroLineColor:n,lineWidth:e=>0===e.index&&this.props.zeroLineWidth?this.props.zeroLineWidth:1}}},animation:!1,layout:{padding:5}};this.props.topAxisTickFormatter&&(s.scales["x-axis-1"].ticks.callback=this.props.topAxisTickFormatter),this.props.logY?(s.scales["y-axis-0"].afterBuildTicks=this.filterYLogTicks,s.scales["y-axis-0"].type="logarithmic"):(s.scales["y-axis-0"].afterBuildTicks=this.filterYLinearTicks,s.scales["y-axis-0"].type="linear");let a=[];if(null===(e=this.props.data)||void 0===e?void 0:e.length){var l;const e={label:"LineGraph",type:"scatter",data:this.props.logY?Ay.ConvertLogData(this.props.data):this.props.data,fill:!1,tension:0,order:this.props.order?this.props.order:0};this.props.plotType===oO.POINTS?(e.showLine=!1,e.borderWidth=0,e.borderColor="rgba(0, 0, 0, 0)",e.pointRadius=this.props.pointRadius?this.props.pointRadius:1,e.pointBackgroundColor=r):(e.pointRadius=0,e.showLine=!0,e.stepped=this.props.plotType===oO.STEPS&&"middle",e.borderWidth=this.props.borderWidth?this.props.borderWidth:1,e.borderColor=r),(null===(l=this.props.multiColorSingleLineColors)||void 0===l?void 0:l.length)&&(this.props.plotType===oO.POINTS?(e.pointStyle="circle",e.pointBackgroundColor=this.props.multiColorSingleLineColors):(e.pointRadius=.5,e.pointStyle="line",e.segment={borderColor:e=>this.props.multiColorSingleLineColors[e.p0DataIndex]})),this.props.dataBackgroundColor&&(e.pointBackgroundColor=this.props.dataBackgroundColor),a.push(e)}(null===(t=this.props.multiPlotPropsMap)||void 0===t?void 0:t.size)>0&&this.props.multiPlotPropsMap.forEach(((e,t)=>{var i;if(e.hidden)return;let n=e.borderColor?e.borderColor:r,s=Gi((e.opacity?e.opacity:o)||1,0,1);s<1&&(n=je()(n).setAlpha(s).toRgbString());const l={type:"scatter",label:t,data:this.props.logY?Ay.ConvertLogData(e.data):e.data,fill:!1,tension:0,backgroundColor:n,order:e.order?e.order:0};if(null===(i=this.props.multiColorMultiLinesColors)||void 0===i?void 0:i.size)if(e.type===oO.POINTS)l.pointBackgroundColor=this.props.multiColorMultiLinesColors.get(t),l.borderColor=n,l.pointBorderColor="rgba(0, 0, 0, 0)";else{const e=this.props.multiColorMultiLinesColors.get(t);e&&(l.segment={borderColor:t=>e[t.p0DataIndex]})}let c=e.pointRadius?e.pointRadius:this.props.pointRadius,d=e.borderWidth?e.borderWidth:this.props.borderWidth;e.type===oO.POINTS?(l.showLine=!1,l.pointStyle="circle",l.pointRadius=c||1,l.borderWidth=0):e.type!==oO.LINES&&e.type!==oO.STEPS||(l.showLine=!0,l.pointRadius=.5,l.pointStyle="line",l.stepped=e.type===oO.STEPS&&"middle",l.borderWidth=d||1,l.borderColor=n),a.push(l)}));let c=[{id:"afterLayout",afterLayout:this.afterChartLayout}];return Object(xm.jsx)(Ty.a,{data:{datasets:a},options:s,plugins:c,ref:this.onRef})}}Ay.FormatTicksScientific=(e,t,i)=>gi(e,2),Ay.FormatTicksInteger=(e,t,i)=>fi(e),Ay.FormatTicksAutomatic=(e,t,i)=>e;var Py;i(811);let Ey=Object(p.a)(Py=class extends n.Component{constructor(...e){super(...e),this.exportImageTooltip=()=>Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Background color is ",gC.Instance.preferenceStore.transparentImageBackground?"transparent":"filled",".",Object(xm.jsx)("br",{}),gC.Instance.preferenceStore.transparentImageBackground?"Disable":"Enable"," transparent image background in Preferences.",Object(xm.jsx)("br",{})]})})]})}render(){let e={opacity:this.props.visible?1:0};const t=d()("profiler-toolbar",{"bp3-dark":this.props.darkMode});return Object(xm.jsxs)(u.f,{className:t,style:e,children:[this.props.exportImage?Object(xm.jsx)(j.a,{content:Object(xm.jsxs)("span",{children:["Export image ",this.exportImageTooltip()]}),children:Object(xm.jsx)(u.b,{icon:"floppy-disk",onClick:this.props.exportImage})}):null,Object(xm.jsx)(j.a,{content:"Export data",children:Object(xm.jsx)(u.b,{icon:"th",onClick:this.props.exportData})})]})}})||Py;var My,Fy,ky,Dy,Ly,Ny,_y,zy,Vy,Wy,Gy,By,qy,Hy,Yy,Uy,Xy,$y;i(812);let Ky,Qy,Zy;!function(e){e[e.NONE=0]="NONE",e[e.X=1]="X",e[e.Y=2]="Y",e[e.XY=3]="XY"}(Ky||(Ky={})),function(e){e[e.NONE=0]="NONE",e[e.SELECTING=1]="SELECTING",e[e.PANNING=2]="PANNING"}(Qy||(Qy={})),function(e){e[e.BOX=0]="BOX",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL",e[e.LINE=3]="LINE"}(Zy||(Zy={}));const Jy=16,eO=20,tO=.05;let iO=Object(p.a)((Fy=class extends n.Component{get isSelecting(){return this.interactionMode===Qy.SELECTING}get isPanning(){return this.interactionMode===Qy.PANNING}get zoomMode(){const e=Math.abs(this.selectionBoxEnd.x-this.selectionBoxStart.x),t=Math.abs(this.selectionBoxEnd.y-this.selectionBoxStart.y);return this.props.selectingMode===Zy.LINE?Ky.NONE:e>eO&&t>eO&&this.props.graphZoomedXY?Ky.XY:this.props.graphZoomedX&&this.props.graphZoomedY?e>t?Ky.X:Ky.Y:this.props.graphZoomedX?Ky.X:this.props.graphZoomedY?Ky.Y:Ky.NONE}get cursorShape(){const e=void 0!==this.hoveredMarker&&!this.isSelecting;return this.isPanning||e?"move":this.props.selectingMode===Zy.HORIZONTAL?"ew-resize":this.props.selectingMode===Zy.VERTICAL?"ns-resize":this.props.selectingMode===Zy.BOX&&this.props.setSelectedInsideBox&&this.props.isSelectingInsideBox?"pointer":"crosshair"}constructor(e){super(e),this.plotRef=void 0,this.stageRef=void 0,this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.panPrevious=void 0,this.previousClickTime=void 0,this.pendingClickHandle=void 0,Object(f.a)(this,"chartArea",ky,this),Object(f.a)(this,"hoveredMarker",Dy,this),Object(f.a)(this,"width",Ly,this),Object(f.a)(this,"height",Ny,this),Object(f.a)(this,"interactionMode",_y,this),Object(f.a)(this,"panStart",zy,this),Object(f.a)(this,"selectionBoxStart",Vy,this),Object(f.a)(this,"selectionBoxEnd",Wy,this),Object(f.a)(this,"isMouseEntered",Gy,this),Object(f.a)(this,"isMarkerDragging",By,this),this.onPlotRefUpdated=e=>{this.plotRef=e},Object(f.a)(this,"updateChart",qy,this),Object(f.a)(this,"resize",Hy,this),Object(f.a)(this,"showMouseEnterWidget",Yy,this),Object(f.a)(this,"hideMouseEnterWidget",Uy,this),this.dragBoundsFuncVertical=(e,t)=>{let i=this.chartArea.left,n=this.chartArea.right;return t.dragCustomBoundary&&t.dragCustomBoundary.xMin&&(i=this.getCanvasSpaceX(t.dragCustomBoundary.xMin)),t.dragCustomBoundary&&t.dragCustomBoundary.xMax&&(n=this.getCanvasSpaceX(t.dragCustomBoundary.xMax)),{x:Gi(e.x,i,n),y:0}},this.dragBoundsFuncHorizontal=(e,t)=>{let i=this.chartArea.top,n=this.chartArea.bottom;return t.dragCustomBoundary&&t.dragCustomBoundary.yMin&&(i=this.getCanvasSpaceY(t.dragCustomBoundary.yMin)),t.dragCustomBoundary&&t.dragCustomBoundary.yMax&&(n=this.getCanvasSpaceY(t.dragCustomBoundary.yMax)),{x:0,y:Gi(e.y,i,n)}},Object(f.a)(this,"onMarkerDragStart",Xy,this),Object(f.a)(this,"onMarkerDragEnd",$y,this),this.onMarkerDragged=(e,t)=>{if(this.props.markers&&t&&t.dragMove){let i;i=t.horizontal?this.getValueForPixelY(Gi(e.evt.offsetY,this.chartArea.top,this.chartArea.bottom),this.props.logY):this.getValueForPixelX(Gi(e.evt.offsetX,this.chartArea.left,this.chartArea.right)),t.dragMove(i)}if(this.props.graphCursorMoved){const t=this.getValueForPixelX(e.evt.offsetX);this.props.graphCursorMoved(t)}},this.onStageMouseDown=e=>{const t=e.evt;this.stageClickStartX=t.offsetX,this.stageClickStartY=t.offsetY;const i=t.ctrlKey||t.shiftKey||t.altKey;void 0!==this.hoveredMarker||i?i&&this.startPanning(t.offsetX):this.startSelection(t.offsetX,t.offsetY)},this.onStageMouseUp=e=>{const t=e.evt,i=Math.abs(t.offsetX-this.stageClickStartX),n=Math.abs(t.offsetY-this.stageClickStartY);if(i<3&&n<3)this.onStageClick(e);else if(this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0)if(this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.isSelecting&&this.props.setSelectedLine&&this.props.selectingMode===Zy.LINE){let e=this.getValueForPixelX(this.selectionBoxStart.x),t=this.getValueForPixelX(this.selectionBoxEnd.x),i=this.getValueForPixelY(this.selectionBoxStart.y,this.props.logY),n=this.getValueForPixelY(this.selectionBoxEnd.y,this.props.logY);this.props.setSelectedLine(e,t,i,n)}else if(this.isSelecting&&this.zoomMode!==Ky.NONE){let e=Math.min(this.selectionBoxStart.x,this.selectionBoxEnd.x),t=Math.max(this.selectionBoxStart.x,this.selectionBoxEnd.x),i=this.getValueForPixelX(e),n=this.getValueForPixelX(t);e=Math.min(this.selectionBoxStart.y,this.selectionBoxEnd.y),t=Math.max(this.selectionBoxStart.y,this.selectionBoxEnd.y);let r=this.getValueForPixelY(t,this.props.logY),o=this.getValueForPixelY(e,this.props.logY);this.props.setSelectedRange&&this.props.selectingMode===Zy.HORIZONTAL?this.props.setSelectedRange(i,n):this.props.setSelectedRange&&this.props.selectingMode===Zy.VERTICAL?this.props.setSelectedRange(r,o):this.props.setSelectedInsideBox&&this.props.isSelectingInsideBox&&this.props.selectingMode===Zy.BOX?this.props.setSelectedInsideBox(i,n,r,o):(this.zoomMode===Ky.X&&this.props.graphZoomedX(i,n),this.zoomMode===Ky.Y?this.props.graphZoomedY(r,o):this.zoomMode===Ky.XY&&this.props.graphZoomedXY(i,n,r,o))}this.endInteractions()},this.onStageMouseMove=e=>{if(this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0){const t=e.evt,i=this.chartArea;let n=Gi(t.offsetX,i.left-1,i.right+1),r=Gi(t.offsetY,i.top-1,i.bottom+1);if(this.isSelecting)this.updateSelection(n,r);else if(this.isPanning&&this.props.graphZoomedX){const e=n,t=this.getValueForPixelX(this.panPrevious),i=this.getValueForPixelX(e)-t;this.updatePan(e),this.props.graphZoomedX(this.props.xMin-i,this.props.xMax-i)}if(this.interactionMode===Qy.NONE&&this.props.graphCursorMoved){const e=this.getValueForPixelX(n);this.props.graphCursorMoved(e)}}},this.onStageClick=e=>{const t={x:e.evt.offsetX,y:e.evt.offsetY},i=e.evt.button,n=performance.now(),r=n-this.previousClickTime;if(this.previousClickTime=n,r<300)return this.onStageDoubleClick(),void clearTimeout(this.pendingClickHandle);this.pendingClickHandle=setTimeout((()=>{const e=Math.abs(t.x-this.stageClickStartX),n=Math.abs(t.y-this.stageClickStartY);if(!(e>1||n>1))if(this.props.graphClicked&&0===i){const e=t.x,i=this.getValueForPixelX(e);this.props.graphClicked(i)}else if(this.props.graphRightClicked&&2===i){const e=t.x,i=this.getValueForPixelX(e);this.props.graphRightClicked(i)}}),300)},this.onStageRightClick=e=>{this.props.graphRightClicked&&e.evt.preventDefault()},this.onStageDoubleClick=()=>{this.props.graphZoomReset&&this.props.graphZoomReset()},this.onStageWheel=e=>{if((this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0)&&this.props.scrollZoom&&this.props.graphZoomedX&&this.chartArea){const t=e.evt,i=this.chartArea,n=15,r=.001;if(t.offsetX>i.right||t.offsetX<i.left)return;const o=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n,s=this.props.xMax-this.props.xMin,a=(t.offsetX-i.left)/(i.right-i.left),l=r*o*s,c=this.props.xMin-l*a,d=this.props.xMax+l*(1-a);c<d&&this.props.graphZoomedX(c,d)}},this.onKeyDown=e=>{this.isSelecting&&e.keyCode===wy.ESCAPE&&this.endInteractions()},this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseMove=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget()},this.exportImage=()=>{const e=this.plotRef,t=this.showPlotxAxes();t&&this.exportSubPlotImage(!0);const i=e.canvas,n=this.props.plotName||"unknown",r=this.props.imageName||"unknown",o=document.createElement("canvas");o.width=i.width,o.height=i.height;const s=o.getContext("2d");s.fillStyle=gC.Instance.preferenceStore.transparentImageBackground?"rgba(255, 255, 255, 0.0)":this.props.darkMode?L.a.DARK_GRAY3:L.a.LIGHT_GRAY5,s.fillRect(0,0,o.width,o.height),s.drawImage(i,0,0);const a=this.genChartBorder();a&&(s.beginPath(),s.strokeStyle=this.props.darkMode?L.a.DARK_GRAY5:L.a.LIGHT_GRAY1,s.lineWidth=1,s.rect(a.x,a.y,a.width,a.height),s.stroke());const l=this.genMeanRMSForPngPlot();(null===l||void 0===l?void 0:l.mean)&&(s.beginPath(),s.setLineDash([l.mean.dash]),s.strokeStyle=l.mean.color,s.lineWidth=1,s.moveTo(l.mean.xLeft,l.mean.y),s.lineTo(l.mean.xRight,l.mean.y),s.stroke()),(null===l||void 0===l?void 0:l.RMS)&&(s.fillStyle=l.RMS.color,s.globalAlpha=l.RMS.opacity,s.fillRect(l.RMS.xLeft,l.RMS.yTop,l.RMS.width,l.RMS.height),s.globalAlpha=1);const c=this.genSpectralLinesForPngPlot();null===c||void 0===c||c.forEach((e=>{s.beginPath(),s.strokeStyle=e.color,s.lineWidth=1,s.moveTo(e.x,e.yBottom),s.lineTo(e.x,e.yTop),s.stroke(),s.save(),s.font="12px Arial",s.translate(e.x,e.yBottom),s.rotate(-Math.PI/2),s.fillStyle=e.color,s.fillText(e.text,0,10),s.restore()})),o.toBlob((e=>{const t=document.createElement("a");t.download=`${r}-${n.replace(" ","-")}`.substring(0,200)+`-${Bm()}.png`,t.href=URL.createObjectURL(e),t.dispatchEvent(new MouseEvent("click"))}),"image/png"),t&&this.exportSubPlotImage(!1)},this.exportData=()=>{var e,t;if((null===(e=this.props.data)||void 0===e?void 0:e.length)>0){var i;let e=[];const t=this.props.plotName||"unknown",n=this.props.imageName||"unknown";let r=`# ${n} ${t}`;this.props.xLabel&&(r+=`\n# xLabel: ${this.props.xLabel}`),this.props.yLabel&&(r+=`\n# yLabel: ${this.props.yLabel}`),(null===(i=this.props.comments)||void 0===i?void 0:i.length)>0&&(r+="\n"+this.props.comments.map((e=>"# "+e)).join("\n")),e.push("# x\ty");const o="histogram"===t||this.props.tickTypeX===Ry.Scientific;e=e.concat(this.props.data.map((e=>o?`${gi(e.x,10)}\t${gi(e.y,10)}`:`${e.x}\t${gi(e.y,10)}`))),Hm(n,t,`${r}\n${e.join("\n")}\n`)}null===(t=this.props.multiPlotPropsMap)||void 0===t||t.forEach(((e,t)=>{var i,n;if(e.noExport)return;let r=[];const o=e.imageName;let s=`# ${e.plotName} ${o}`;this.props.xLabel&&(s+=`\n# xLabel: ${this.props.xLabel}`),this.props.yLabel&&(s+=`\n# yLabel: ${this.props.yLabel}`),(null===(i=this.props.comments)||void 0===i?void 0:i.length)>0&&(s+="\n"+this.props.comments.map((e=>"# "+e)).join("\n")),null===(n=e.comments)||void 0===n||n.forEach((e=>r.push(`# ${e}\t`)));let a="# x\ty";e.followingData&&e.followingData.forEach((e=>{a+=`\t${e}`})),r.push(a),e.data.forEach((t=>{let i=`${t.x}\t${gi(t.y,10)}`;e.followingData&&e.followingData.forEach((e=>{const n=this.props.multiPlotPropsMap.get(e);(null===n||void 0===n?void 0:n.data)&&n.data.forEach((e=>{e.x===t.x&&(i+=`\t${gi(e.y,6)}`)}))})),r.push(i)})),Hm(e.imageName,e.plotName,`${s}\n${r.join("\n")}\n`)}))},this.calcMarkerBox=e=>{if(!e)return;const t=this.chartArea,i=this.getPixelForValueY(e.value-e.width/2,this.props.logY)-this.getPixelForValueY(e.value+e.width/2,this.props.logY),n=this.getCanvasSpaceY(e.value),r=Gi(n-i,t.top,t.bottom);return{lowerBound:r,height:Gi(n+i,t.top,t.bottom)-r}},this.genHorizontalLine=(e,t,i,n,r)=>{const o=this.chartArea,s=o.right-o.left,a=t&&this.hoveredMarker.id===e.id,l=(o.left+o.right)/2;let c=null;if(e.width||!(r<Math.floor(o.top-1)||r>Math.ceil(o.bottom+1))){if(a){const t=10.666666666666666,r=3;c=[Object(xm.jsx)(oy.f,{listening:!1,points:[o.left,0,o.right,0],strokeWidth:1,stroke:i,opacity:n,dash:e.dash},0),Object(xm.jsx)(oy.a,{listening:!1,x:l,y:0,points:[0,-r,0,-r-t],pointerLength:t,pointerWidth:t,opacity:n,fill:i},1),Object(xm.jsx)(oy.a,{listening:!1,x:l,y:0,points:[0,r,0,r+t],pointerLength:t,pointerWidth:t,opacity:n,fill:i},2)]}else if(e.width){const t=this.calcMarkerBox(e),a=(null===t||void 0===t?void 0:t.lowerBound)-r;c=[Object(xm.jsx)(oy.g,{listening:!1,x:o.left,y:a,width:s,height:null===t||void 0===t?void 0:t.height,fill:i,opacity:n},0)]}else c=[Object(xm.jsx)(oy.f,{listening:!1,points:[o.left,0,o.right,0],strokeWidth:1,stroke:i,opacity:n,dash:e.dash},0)];return e.label&&c.push(Object(xm.jsx)(oy.k,{align:"left",fill:i,text:e.label,x:o.left,y:0},c.length)),e.draggable?Object(xm.jsxs)(oy.d,{x:0,y:r,draggable:!0,dragBoundFunc:t=>this.dragBoundsFuncHorizontal(t,e),onDragMove:t=>this.onMarkerDragged(t,e),children:[Object(xm.jsx)(oy.g,{x:o.left,y:-8,width:s,height:Jy,onMouseEnter:()=>this.setHoveredMarker(e),onMouseLeave:()=>this.setHoveredMarker(void 0)}),c]},e.id+"-draggable"):Object(xm.jsx)(oy.d,{x:0,y:r,children:c},e.id)}},this.genVerticalLine=(e,t,i,n,r,o)=>{const s=this.chartArea,a=s.bottom-s.top,l=t&&this.hoveredMarker.id===e.id,c=(s.top+s.bottom)/2;let d=null;if(e.width||!(r<Math.floor(s.left-1)||r>Math.ceil(s.right+1))){if(l){const e=10.666666666666666,t=3;d=[Object(xm.jsx)(oy.f,{listening:!1,points:[0,s.top,0,s.bottom],strokeWidth:1,stroke:i,opacity:n},0),Object(xm.jsx)(oy.a,{listening:!1,x:0,y:c,points:[-t,0,-t-e,0],pointerLength:e,pointerWidth:e,opacity:n,fill:i},1),Object(xm.jsx)(oy.a,{listening:!1,x:0,y:c,points:[t,0,t+e,0],pointerLength:e,pointerWidth:e,opacity:n,fill:i},2)]}else if(e.width){const t=this.getPixelForValueX(e.value+e.width/2)-this.getPixelForValueX(e.value-e.width/2);let o=Gi(r-t,s.left,s.right),l=Gi(r+t,s.left,s.right)-o;d=[Object(xm.jsx)(oy.g,{listening:!1,x:o-r,y:s.top,width:l,height:a,fill:i,opacity:n},0)]}else d=[Object(xm.jsx)(oy.f,{listening:!1,points:[0,s.top,0,s.bottom],strokeWidth:1,stroke:i,opacity:n,dash:e.dash},0)];return o&&e.label&&d.push(Object(xm.jsx)(oy.k,{align:"left",fill:i,text:e.label,rotation:-90,x:0,y:s.bottom},d.length)),e.draggable?Object(xm.jsxs)(oy.d,{x:r,y:0,draggable:!0,dragBoundFunc:t=>this.dragBoundsFuncVertical(t,e),onDragStart:this.onMarkerDragStart,onDragEnd:this.onMarkerDragEnd,onDragMove:t=>this.onMarkerDragged(t,e),children:[Object(xm.jsx)(oy.g,{x:-8,y:s.top,width:Jy,height:a,onMouseEnter:()=>this.setHoveredMarker(e),onMouseLeave:()=>this.setHoveredMarker(void 0)}),d]},e.id+"-draggable"):Object(xm.jsx)(oy.d,{x:r,y:0,children:d},e.id)}},this.genLines=()=>{const e=this.chartArea,t=void 0!==this.hoveredMarker&&!this.isSelecting;let i=[];if(this.props.markers&&this.props.markers.length&&e){const n=Math.abs(e.right-e.left),r=12*this.props.markers.length/2<n;for(let e=0;e<this.props.markers.length;e++){const n=this.props.markers[e],o=n.color||(this.props.darkMode?L.a.RED4:L.a.RED2),s=!n.isMouseMove||this.isMouseEntered&&!this.isMarkerDragging?n.opacity||1:0;if(n.horizontal){let e=this.getCanvasSpaceY(n.value);if(isNaN(e))continue;i.push(this.genHorizontalLine(n,t,o,s,e))}else{let e=this.getCanvasSpaceX(n.value);if(isNaN(e))continue;if(n.interactionMarker){const r=!n.isMouseMove&&this.isMouseEntered?0:n.opacity||1;i.push(this.genVerticalLine(n,t,o,r,e))}else i.push(this.genVerticalLine(n,t,o,s,e,r))}}}return i},this.genSelectionRect=()=>{let e=null;const t=this.chartArea,i=this.selectionBoxStart,n=this.selectionBoxEnd,r={x:n.x-i.x,y:n.y-i.y},o=Math.abs(r.x),s=Math.abs(r.y);if(this.isSelecting&&(o>3||s>3)&&t){const o=t.right-t.left,s=t.bottom-t.top;if(this.zoomMode===Ky.X){const o=Gi(eO,0,i.y-t.top),a=Gi(eO,0,t.bottom-i.y);e=[Object(xm.jsx)(oy.g,{fill:L.a.GRAY3,opacity:.2,x:i.x,y:t.top,width:r.x,height:s},0),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},1),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:n.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},2)]}else if(this.zoomMode===Ky.Y){const s=Gi(eO,0,i.x-t.left),a=Gi(eO,0,t.right-i.x);e=[Object(xm.jsx)(oy.g,{fill:L.a.GRAY3,opacity:.2,x:t.left,y:i.y,width:o,height:r.y},0),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:i.y,points:[-s,0,a,0],strokeWidth:3},1),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:n.y,points:[-s,0,a,0],strokeWidth:3},2)]}else this.zoomMode===Ky.XY?e=[Object(xm.jsx)(oy.g,{fill:L.a.GRAY3,opacity:.2,x:i.x,y:i.y,width:r.x,height:r.y},0),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:i.y,points:[0,10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},1),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:n.x,y:i.y,points:[0,10,0,0,-10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},2),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:n.y,points:[0,-10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},3),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:n.x,y:n.y,points:[-10,0,0,0,0,-10],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},4)]:this.zoomMode===Ky.NONE&&this.props.selectingMode===Zy.LINE&&(e=[Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,points:[i.x,i.y,n.x,n.y],strokeWidth:3},1)])}return e},this.genChartBorder=()=>{const e=this.chartArea;let t;return e&&(t={x:(Math.floor(e.left)-.5)*devicePixelRatio,y:(Math.floor(e.top)-.5)*devicePixelRatio,width:Math.ceil(e.right-e.left+1)*devicePixelRatio,height:Math.ceil(e.bottom-e.top+1)*devicePixelRatio}),t},this.genBorderRect=()=>{const e=this.chartArea;let t=null;return e&&(t=Object(xm.jsx)(oy.g,{x:Math.floor(e.left)-.5*devicePixelRatio,y:Math.floor(e.top)-.5*devicePixelRatio,width:Math.ceil(e.right-e.left+1),height:Math.ceil(e.bottom-e.top+1),listening:!1,stroke:this.props.darkMode?L.a.DARK_GRAY5:L.a.LIGHT_GRAY1,strokeWidth:1})),t},this.genInsideBoxes=()=>{const e=this.chartArea;let t=[];if(this.props.insideBoxes&&e)for(let i=0;i<this.props.insideBoxes.length;i++){const n=this.props.insideBoxes[i],r=this.getPixelForValueX(n.boundary.xMin),o=this.getPixelForValueX(n.boundary.xMax),s=this.getPixelForValueY(n.boundary.yMin),a=this.getPixelForValueY(n.boundary.yMax);if(r>e.right||o<e.left||s<e.top||a>e.bottom)continue;const l=Math.max(r,e.left),c=Math.min(o,e.right),d=Math.max(a,e.top),p=Math.min(s,e.bottom);t.push(Object(xm.jsx)(oy.g,{x:l,y:d,width:c-l,height:p-d,fill:n.color,opacity:n.opacity,stroke:n.strokeColor,strokeWidth:1},i)),n.text&&t.push(Object(xm.jsx)(oy.k,{text:n.text,x:l,y:(d+p)/2,width:c-l,align:"center",fill:this.props.darkMode?L.a.LIGHT_GRAY4:L.a.GRAY1},i+"-text"))}return t},this.genInsideTexts=()=>{const e=this.chartArea;let t=[];if(this.props.insideTexts&&e)for(let i=0;i<this.props.insideTexts.length;i++){const n=this.props.insideTexts[i],r=this.getPixelForValueX(n.x),o=this.getPixelForValueY(n.y);if(r>e.right||r<e.left||o<e.top||o>e.bottom)continue;const s=n.fontSize?n.fontSize:12;t.push(Object(xm.jsx)(oy.k,{text:n.text,fontSize:s,x:r-n.text.length*s/2,y:o,width:n.text.length*s,align:"center",fill:n.color?n.color:this.props.darkMode?L.a.LIGHT_GRAY4:L.a.GRAY1,opacity:n.opacity},i+"-text"))}return t},this.genMeanRMSForPngPlot=()=>{var e;let t={mean:void 0,RMS:void 0};const i=this.chartArea;return null===(e=this.props.markers)||void 0===e||e.forEach((e=>{const n=this.getCanvasSpaceY(e.value);if((null===e||void 0===e?void 0:e.id.match(/^marker-mean/))&&!isNaN(n)&&(t.mean={color:null===e||void 0===e?void 0:e.color,dash:e.dash,y:n*devicePixelRatio,xLeft:i.left*devicePixelRatio,xRight:i.right*devicePixelRatio}),(null===e||void 0===e?void 0:e.id.match(/^marker-rms/))&&!isNaN(n)){const n=this.calcMarkerBox(e);t.RMS={color:null===e||void 0===e?void 0:e.color,opacity:null===e||void 0===e?void 0:e.opacity,xLeft:i.left*devicePixelRatio,yTop:(null===n||void 0===n?void 0:n.lowerBound)*devicePixelRatio,width:(i.right-i.left)*devicePixelRatio,height:(null===n||void 0===n?void 0:n.height)*devicePixelRatio}}})),t},this.genSpectralLinesForPngPlot=()=>{var e;let t=[];const i=this.chartArea;return null===(e=this.props.markers)||void 0===e||e.forEach((e=>{const n=this.getCanvasSpaceX(e.value);(null===e||void 0===e?void 0:e.id.match(/^spectral-line-/))&&!isNaN(n)&&t.push({color:null===e||void 0===e?void 0:e.color,text:null===e||void 0===e?void 0:e.label,x:n,yBottom:i.bottom,yTop:i.top})})),t},Object(m.p)(this)}getValueForPixelX(e){if(!this.chartArea)return;return(e-this.chartArea.left)/(this.chartArea.right-this.chartArea.left)*(this.props.xMax-this.props.xMin)+this.props.xMin}getValueForPixelY(e,t=!1){if(this.chartArea){if(t){let t=this.chartArea.bottom-e;return t/=this.chartArea.bottom-this.chartArea.top,t*=Math.log10(this.props.yMax/this.props.yMin),Math.pow(10,Math.log10(this.props.yMin)+t)}return(this.chartArea.bottom-e)/(this.chartArea.bottom-this.chartArea.top)*(this.props.yMax-this.props.yMin)+this.props.yMin}}getPixelForValueX(e){if(!this.chartArea)return;return(e-this.props.xMin)/(this.props.xMax-this.props.xMin)*(this.chartArea.right-this.chartArea.left)+this.chartArea.left}getPixelForValueY(e,t=!1){if(!this.chartArea)return;let i;return i=t?(Math.log(this.props.yMax)-Math.log(e))/(Math.log(this.props.yMax)-Math.log(this.props.yMin)):(this.props.yMax-e)/(this.props.yMax-this.props.yMin),i*(this.chartArea.bottom-this.chartArea.top)+this.chartArea.top}getCanvasSpaceX(e){return Math.floor(this.getPixelForValueX(e))+.5*devicePixelRatio}getCanvasSpaceY(e){return Math.floor(this.getPixelForValueY(e,this.props.logY))+.5*devicePixelRatio}setHoveredMarker(e){this.hoveredMarker=e}startSelection(e,t){this.interactionMode=Qy.SELECTING,this.selectionBoxStart={x:e,y:t},this.selectionBoxEnd={x:e,y:t}}startPanning(e){this.interactionMode=Qy.PANNING,this.panPrevious=e}endInteractions(){this.interactionMode=Qy.NONE}updateSelection(e,t){this.selectionBoxEnd={x:e,y:t}}updatePan(e){this.panPrevious=e}exportSubPlotImage(e){const t=this.plotRef;t.config._config.options.scales["x-axis-0"].ticks.display=e;let i=10;e||(i=0),t.config._config.options.scales["x-axis-0"].grid.tickLength=i,t.config._config.options.scales["x-axis-0"].title.display=e,t.update()}showPlotxAxes(){const e=this.plotRef;return!(!0!==this.props.isGroupSubPlot||!e||!1!==e.config._config.options.scales["x-axis-0"].ticks.display)}render(){var e;return Object(xm.jsxs)("div",{className:"line-plot-component",style:{cursor:this.cursorShape},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,tabIndex:0,children:[Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.resize,refreshMode:"throttle",refreshRate:33}),this.width>0&&this.height>0&&Object(xm.jsx)(Ay,{...this.props,plotRefUpdated:this.onPlotRefUpdated,chartAreaUpdated:this.updateChart,width:this.width,height:this.height}),this.width>0&&this.height>0&&Object(xm.jsx)(oy.j,{className:"annotation-stage",ref:e=>this.stageRef=e,width:this.width,height:this.height,onMouseDown:this.onStageMouseDown,onMouseUp:this.onStageMouseUp,onContextMenu:this.onStageRightClick,onMouseMove:this.onStageMouseMove,onWheel:this.onStageWheel,children:Object(xm.jsxs)(oy.e,{children:[this.genLines(),this.genSelectionRect(),this.genInsideBoxes(),this.genInsideTexts(),this.genBorderRect()]})}),(void 0!==this.props.data||(null===(e=this.props.multiPlotPropsMap)||void 0===e?void 0:e.size)>0)&&Object(xm.jsx)(Ey,{darkMode:this.props.darkMode,visible:this.isMouseEntered,exportImage:this.exportImage,exportData:this.exportData})]})}},ky=Object(b.a)(Fy.prototype,"chartArea",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dy=Object(b.a)(Fy.prototype,"hoveredMarker",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ly=Object(b.a)(Fy.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ny=Object(b.a)(Fy.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_y=Object(b.a)(Fy.prototype,"interactionMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Qy.NONE}}),zy=Object(b.a)(Fy.prototype,"panStart",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Vy=Object(b.a)(Fy.prototype,"selectionBoxStart",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),Wy=Object(b.a)(Fy.prototype,"selectionBoxEnd",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),Gy=Object(b.a)(Fy.prototype,"isMouseEntered",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),By=Object(b.a)(Fy.prototype,"isMarkerDragging",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(b.a)(Fy.prototype,"isSelecting",[m.i],Object.getOwnPropertyDescriptor(Fy.prototype,"isSelecting"),Fy.prototype),Object(b.a)(Fy.prototype,"isPanning",[m.i],Object.getOwnPropertyDescriptor(Fy.prototype,"isPanning"),Fy.prototype),Object(b.a)(Fy.prototype,"zoomMode",[m.i],Object.getOwnPropertyDescriptor(Fy.prototype,"zoomMode"),Fy.prototype),Object(b.a)(Fy.prototype,"cursorShape",[m.i],Object.getOwnPropertyDescriptor(Fy.prototype,"cursorShape"),Fy.prototype),qy=Object(b.a)(Fy.prototype,"updateChart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chartArea=e}}}),Hy=Object(b.a)(Fy.prototype,"resize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Yy=Object(b.a)(Fy.prototype,"showMouseEnterWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0,this.props.mouseEntered&&this.props.mouseEntered(!0)}}}),Uy=Object(b.a)(Fy.prototype,"hideMouseEnterWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1,this.props.mouseEntered&&this.props.mouseEntered(!1)}}}),Xy=Object(b.a)(Fy.prototype,"onMarkerDragStart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMarkerDragging=!0}}}),$y=Object(b.a)(Fy.prototype,"onMarkerDragEnd",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMarkerDragging=!1}}}),Object(b.a)(Fy.prototype,"setHoveredMarker",[m.g],Object.getOwnPropertyDescriptor(Fy.prototype,"setHoveredMarker"),Fy.prototype),Object(b.a)(Fy.prototype,"startSelection",[m.g],Object.getOwnPropertyDescriptor(Fy.prototype,"startSelection"),Fy.prototype),Object(b.a)(Fy.prototype,"startPanning",[m.g],Object.getOwnPropertyDescriptor(Fy.prototype,"startPanning"),Fy.prototype),Object(b.a)(Fy.prototype,"endInteractions",[m.g],Object.getOwnPropertyDescriptor(Fy.prototype,"endInteractions"),Fy.prototype),Object(b.a)(Fy.prototype,"updateSelection",[m.g],Object.getOwnPropertyDescriptor(Fy.prototype,"updateSelection"),Fy.prototype),Object(b.a)(Fy.prototype,"updatePan",[m.g],Object.getOwnPropertyDescriptor(Fy.prototype,"updatePan"),Fy.prototype),My=Fy))||My;var nO;i(813);let rO;!function(e){e[e.MIN_WIDTH=.5]="MIN_WIDTH",e[e.MAX_WIDTH=10]="MAX_WIDTH",e[e.MIN_POINT_SIZE=.5]="MIN_POINT_SIZE",e[e.MAX_POINT_SIZE=10]="MAX_POINT_SIZE",e[e.POINT_SIZE_STEP_SIZE=.5]="POINT_SIZE_STEP_SIZE",e[e.LINE_WIDTH_STEP_SIZE=.5]="LINE_WIDTH_STEP_SIZE"}(rO||(rO={}));let oO,sO=Object(p.a)(nO=class extends n.Component{constructor(...e){super(...e),this.getLineColorSelectors=()=>{const e=this.props.lineColorMap,t=this.props.setLineColor;if(e&&t){var i;const r=null!==(i=this.props.lineOrderedKeys)&&void 0!==i?i:Array.from(e.keys());return Object(xm.jsx)(n.Fragment,{children:r.map(((i,r)=>{var o,s,a;const l=null===(o=this.props.lineOptions)||void 0===o||null===(s=o.find((e=>e.value===i)))||void 0===s?void 0:s.label;return Object(xm.jsx)(u.p,{inline:!0,label:"Line Color",labelInfo:l?Object(xm.jsxs)(n.Fragment,{children:["(",Object(xm.jsx)("span",{className:"line-label",title:l,children:l}),")"]}):"",children:Object(xm.jsx)(ny,{color:null!==(a=e.get(i))&&void 0!==a?a:Bb,presetColors:[...Gb,"transparent"],setColor:e=>{t(i,"transparent"===e?"#000000":e)},disableAlpha:!0})},r)}))})}return null}}render(){const e=this.props;return Object(xm.jsx)("div",{className:"line-settings-panel",children:Object(xm.jsxs)(n.Fragment,{children:[e.userSelectedCoordinate&&e.handleCoordinateChanged&&Object(xm.jsx)(u.p,{label:"Coordinate",inline:!0,children:Object(xm.jsx)(u.r,{value:e.userSelectedCoordinate,options:e.profileCoordinateOptions,onChange:e.handleCoordinateChanged})}),this.getLineColorSelectors(),Object(xm.jsx)(u.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Line Width",min:rO.MIN_WIDTH,max:rO.MAX_WIDTH,value:e.lineWidth,stepSize:rO.LINE_WIDTH_STEP_SIZE,disabled:e.plotType===oO.POINTS,onValueChange:t=>e.setLineWidth(t)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Point Size",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Point Size",min:rO.MIN_POINT_SIZE,max:rO.MAX_POINT_SIZE,value:e.linePlotPointSize,stepSize:rO.POINT_SIZE_STEP_SIZE,disabled:e.plotType!==oO.POINTS,onValueChange:t=>e.setLinePlotPointSize(t)})}),"undefined"!==typeof e.logScaleY&&e.handleLogScaleChanged&&Object(xm.jsx)(u.p,{inline:!0,label:"Log Scale",children:Object(xm.jsx)(u.P,{checked:e.logScaleY,onChange:e.handleLogScaleChanged})}),"undefined"!==typeof e.markerTextVisible&&e.handleMarkerTextChanged&&Object(xm.jsx)(u.p,{inline:!0,label:"Show Labels",children:Object(xm.jsx)(u.P,{checked:e.markerTextVisible,onChange:e.handleMarkerTextChanged})}),"undefined"!==typeof e.useWcsValues&&e.handleWcsValuesChanged&&Object(xm.jsx)(u.p,{inline:!0,label:"Use WCS Values",children:Object(xm.jsx)(u.P,{checked:e.useWcsValues,onChange:e.handleWcsValuesChanged})}),"undefined"!==typeof e.showWCSAxis&&e.handleWcsAxisChanged&&Object(xm.jsx)(u.p,{inline:!0,label:"Show WCS Axis",children:Object(xm.jsx)(u.P,{checked:e.showWCSAxis,onChange:e.handleWcsAxisChanged})}),"undefined"!==typeof e.meanRmsVisible&&e.handleMeanRmsChanged&&Object(xm.jsx)(u.p,{inline:!0,label:"Show Mean/RMS",helperText:"Only visible in single profile",children:Object(xm.jsx)(u.P,{checked:e.meanRmsVisible,onChange:e.handleMeanRmsChanged})}),Object(xm.jsx)(u.p,{inline:!0,label:"Line Style",children:Object(xm.jsx)(aO,{value:e.plotType,onValueChanged:e.setPlotType})}),"undefined"!==typeof e.xMinVal&&e.handleXMinChange&&Object(xm.jsx)(u.p,{label:"X Min",inline:!0,children:Object(xm.jsx)(pO,{className:"line-boundary",value:e.xMinVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleXMinChange,onKeyDown:e.handleXMinChange})}),"undefined"!==typeof e.xMaxVal&&e.handleXMaxChange&&Object(xm.jsx)(u.p,{label:"X Max",inline:!0,children:Object(xm.jsx)(pO,{className:"line-boundary",value:e.xMaxVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleXMaxChange,onKeyDown:e.handleXMaxChange})}),"undefined"!==typeof e.yMinVal&&e.handleYMinChange&&Object(xm.jsx)(u.p,{label:"Y Min",inline:!0,children:Object(xm.jsx)(pO,{className:"line-boundary",asyncControl:!0,value:e.yMinVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleYMinChange,onKeyDown:e.handleYMinChange})}),"undefined"!==typeof e.yMaxVal&&e.handleYMaxChange&&Object(xm.jsx)(u.p,{label:"Y Max",inline:!0,children:Object(xm.jsx)(pO,{className:"line-boundary",asyncControl:!0,value:e.yMaxVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleYMaxChange,onKeyDown:e.handleYMaxChange})}),"undefined"!==typeof e.isAutoScaledX&&"undefined"!==typeof e.isAutoScaledY&&e.clearXYBounds&&Object(xm.jsx)(u.p,{label:"Reset Range",inline:!0,className:"reset-range-content",children:Object(xm.jsx)(u.e,{className:"reset-range-button",icon:"zoom-to-fit",small:!0,disabled:e.isAutoScaledX&&e.isAutoScaledY,onClick:e.clearXYBounds,children:"Reset Range"})})]})})}})||nO;!function(e){e.STEPS="Steps",e.LINES="Lines",e.POINTS="Points"}(oO||(oO={}));class aO extends n.Component{constructor(...e){super(...e),this.plotTypeButton=e=>Object(xm.jsx)(j.a,{content:e,children:Object(xm.jsx)(u.b,{icon:aO.getIconForType(e),active:this.props.value===e,onClick:()=>this.props.onValueChanged(e)})})}static getIconForType(e){switch(e){case oO.STEPS:return"step-chart";case oO.LINES:return"timeline-line-chart";default:return"scatter-plot"}}render(){return Object(xm.jsxs)(u.f,{className:"plot-type-selector",children:[this.plotTypeButton(oO.STEPS),this.plotTypeButton(oO.LINES),this.plotTypeButton(oO.POINTS)]})}}i(814);n.Component;i(815);const lO=e=>{var t;let i="";return null===(t=e.info)||void 0===t||t.forEach(((t,n)=>{let r=",";switch(e.separator){case"newLine":r="\n"}i=0===n?t:i+r+t})),Object(xm.jsx)("div",{className:"profiler-info",children:Object(xm.jsx)("pre",{className:"pre-line"===e.type?"pre-line":"pre",children:i})})};var cO;i(816);let dO=Object(p.a)(cO=class extends n.Component{constructor(...e){super(...e),this.handleFrameChanged=e=>{const t=gC.Instance,i=this.props.widgetStore;if(t.activeFrame){const t=parseInt(e.target.value);i.setFileId(t),i.setRegionId(i.effectiveFrame.frameInfo.fileId,Br.ACTIVE),this.props.onFrameChanged&&this.props.onFrameChanged(i.effectiveFrame)}},this.handleRegionChanged=e=>{const t=gC.Instance,i=this.props.widgetStore;if(t.activeFrame){const t=i.effectiveFrame.frameInfo.fileId;i.setFileId(t),i.setRegionId(t,parseInt(e.target.value))}}}render(){const e=gC.Instance,t=this.props.widgetStore;let i=!1,r=Gr;e.activeFrame&&(r=t.fileId,i=!0);let o=!1,s=Br.ACTIVE,a=[{value:Br.ACTIVE,label:"Active"}];if(t.effectiveFrame&&t.effectiveFrame.regionSet){let e;t.type===qr.CLOSED&&(a=a.concat([{value:Br.IMAGE,label:"Image"}]));let i=t.effectiveFrame.regionSet.regions;switch(t.type){case qr.CLOSED:e=i.filter((e=>!e.isTemporary&&e.isClosedRegion));break;case qr.CLOSED_AND_POINT:e=i.filter((e=>!e.isTemporary&&(e.isClosedRegion||e.regionType===Nt.RegionType.POINT)));break;case qr.POINT_AND_LINES:e=i.filter((e=>!e.isTemporary&&(e.regionType===Nt.RegionType.POINT||e.regionType===Nt.RegionType.LINE||e.regionType===Nt.RegionType.POLYLINE)));break;default:e=i}a=a.concat(e.map((e=>({value:e.regionId,label:e.nameString})))),t.type===qr.CLOSED_AND_POINT&&1===a.length&&(a=a.concat([{value:Br.CURSOR,label:"Cursor"}])),s=t.regionIdMap.get(t.effectiveFrame.frameInfo.fileId),o=!0}let l="unlinked-to-selected",c="unlinked-to-selected";const d="linked-to-selected";return t.isEffectiveFrameEqualToActiveFrame&&t.fileId!==Gr&&(l=gC.Instance.darkTheme?`${d} dark-theme`:d),t.matchesSelectedRegion&&void 0!==s&&s!==Br.ACTIVE&&(c=gC.Instance.darkTheme?`${d} dark-theme`:d),Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"Image",inline:!0,disabled:!i,children:Object(xm.jsx)(u.r,{className:l,value:r,options:t.frameOptions,onChange:this.handleFrameChanged,disabled:!i,style:{width:"100px"}})}),Object(xm.jsx)(u.p,{label:"Region",inline:!0,disabled:!o,children:Object(xm.jsx)(u.r,{className:c,value:s,options:a,onChange:this.handleRegionChanged,disabled:!o})})]})}})||cO;class pO extends n.Component{constructor(...e){super(...e),this.safeHandleValueChanged=(e,t,i)=>{if(this.props.intOnly){const n=Math.ceil(e);isFinite(n)&&(e=n,t=n.toString(),i.value=n.toString())}this.props.onValueChange&&isFinite(e)&&(!isFinite(this.props.min)||this.props.min<=e)&&(!isFinite(this.props.max)||this.props.max>=e)&&this.props.onValueChange(e,t,i)}}render(){const{intOnly:e,...t}=this.props;return Object(xm.jsx)(u.D,{...t,asyncControl:!0,minorStepSize:this.props.minorStepSize?this.props.minorStepSize:e?1:pO.minorStepSize,onValueChange:this.safeHandleValueChanged})}}pO.minorStepSize=.001;i(817);var hO=i.p+"static/media/linear.a0a2adc3.png",uO=i.p+"static/media/log.1b868671.png",gO=i.p+"static/media/sqrt.c22078c4.png",fO=i.p+"static/media/squared.c3b27aed.png",bO=i.p+"static/media/gamma.90eaaa41.png",mO=i.p+"static/media/power.67af1163.png";const yO=new Map([[Rf.LINEAR,hO],[Rf.LOG,uO],[Rf.SQRT,gO],[Rf.SQUARE,fO],[Rf.GAMMA,bO],[Rf.POWER,mO]]),OO=A.a.ofType(),jO=Array.from(Af.SCALING_TYPES.keys()),xO={minimal:!0,position:"auto-end",popoverClassName:"colormap-select-popover"},SO=e=>Object(xm.jsx)(OO,{activeItem:e.selectedItem,onItemSelect:e.onItemSelect,popoverProps:xO,filterable:!1,items:jO,itemRenderer:(e,{handleClick:t,modifiers:i,query:n})=>i.matchesPredicate&&Af.SCALING_TYPES.has(e)?Object(xm.jsx)(u.B,{active:i.active,disabled:i.disabled,label:Af.SCALING_TYPES.get(e),onClick:t,text:Object(xm.jsx)("div",{className:"equation-div",style:{backgroundImage:`url(${yO.get(e)}`,backgroundSize:"contain"}}),style:{width:"220px"}},e):null,disabled:e.disabled,children:Object(xm.jsx)(u.e,{text:Af.SCALING_TYPES.get(e.selectedItem),rightIcon:"double-caret-vertical",alignText:"right",disabled:e.disabled})});var vO,CO,IO,wO,TO,RO,AO,PO,EO,MO,FO,kO,DO;i(818);const LO=20;let NO=Object(p.a)((CO=class extends n.Component{get isSelecting(){return this.interactionMode===Qy.SELECTING}get isPanning(){return this.interactionMode===Qy.PANNING}constructor(e){super(e),this.markerOpacity=.8,this.plotRef=void 0,this.previousClickTime=void 0,this.pendingClickHandle=void 0,this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.panPrevious=void 0,Object(f.a)(this,"selectionBoxStart",IO,this),Object(f.a)(this,"selectionBoxEnd",wO,this),Object(f.a)(this,"chartArea",TO,this),Object(f.a)(this,"width",RO,this),Object(f.a)(this,"height",AO,this),Object(f.a)(this,"isMouseEntered",PO,this),Object(f.a)(this,"interactionMode",EO,this),this.onPlotRefUpdated=e=>{this.plotRef=e},Object(f.a)(this,"updateChart",MO,this),Object(f.a)(this,"resize",FO,this),Object(f.a)(this,"showMouseEnterWidget",kO,this),Object(f.a)(this,"hideMouseEnterWidget",DO,this),this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseMove=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget(),this.props.mouseEntered&&this.props.mouseEntered(!1)},this.onKeyDown=e=>{this.isSelecting&&e.keyCode===wy.ESCAPE&&this.endInteractions()},this.genBorderRect=()=>{const e=this.chartArea;let t=null;return this.chartArea&&(t=Object(xm.jsx)(oy.g,{x:Math.floor(e.left)-.5*devicePixelRatio,y:Math.floor(e.top)-.5*devicePixelRatio,width:Math.ceil(e.right-e.left+1),height:Math.ceil(e.bottom-e.top+1),listening:!1,stroke:this.props.darkMode?L.a.DARK_GRAY5:L.a.LIGHT_GRAY1,strokeWidth:1})),t},this.genIndicator=()=>{const e=this.chartArea;let t=[];const i=this.props.indicatorInteractionChannel,n=this.markerOpacity;if(e&&i&&i.hoveredChannel&&!isNaN(i.hoveredChannel.x)&&!isNaN(i.hoveredChannel.y)&&!this.isMouseEntered&&i.start){const e=this.props.indicatorInteractionChannel.hoveredChannel,i=this.props.darkMode?L.a.GRAY4:L.a.GRAY2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){let n=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0)),r=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1));t.push(this.genCircle("scatter-indicator-y-hovered-interaction-circle",i,n,r))}}if(e&&i&&i.currentChannel&&!isNaN(i.currentChannel.x)&&!isNaN(i.currentChannel.y)){const e=this.props.indicatorInteractionChannel.currentChannel,i=this.props.darkMode?L.a.RED4:L.a.RED2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){let r=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0)),o=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1));t.push(this.genXline("scatter-indicator-x-current-interactive",i,n,r)),t.push(this.genYline("scatter-indicator-y-current-interactive",i,n,o))}}if(this.isMouseEntered&&this.props.cursorNearestPoint){const e=this.props.cursorNearestPoint,i=this.props.darkMode?L.a.GRAY4:L.a.GRAY2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){const n=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0))+.5*devicePixelRatio,r=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1))+.5*devicePixelRatio;t.push(this.genCircle("scatter-indicator-y-hovered-circle",i,n,r))}}return t},this.exportImage=()=>{const e=this.plotRef.canvas,t=this.props.plotName||"unknown",i=this.props.imageName||"unknown",n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.fillStyle=gC.Instance.preferenceStore.transparentImageBackground?"rgba(255, 255, 255, 0.0)":this.props.darkMode?L.a.DARK_GRAY3:L.a.LIGHT_GRAY5,r.fillRect(0,0,n.width,n.height),r.drawImage(e,0,0),n.toBlob((e=>{const n=document.createElement("a");n.download=`${i}-${t.replace(" ","-")}`.substring(0,200)+`-${Bm()}.png`,n.href=URL.createObjectURL(e),n.dispatchEvent(new MouseEvent("click"))}),"image/png")},this.exportData=()=>{const e=this.props.plotName||"unknown",t=this.props.imageName||"unknown";let i=`# ${t} ${e}`;this.props.xLabel&&(i+=`\n# xLabel: ${this.props.xLabel}`),this.props.yLabel&&(i+=`\n# yLabel: ${this.props.yLabel}`),this.props.comments&&this.props.comments.length&&(i+="\n"+this.props.comments.map((e=>"# "+e)).join("\n"));let n=[];"histogram"===e?n=this.props.data.map((e=>`${gi(e.x,10)}\t${gi(e.y,10)}`)):this.props.data&&this.props.data.length&&(n=this.props.tickTypeX===Ry.Scientific?this.props.data.map((e=>`${gi(e.x,10)}\t${gi(e.y,10)}`)):this.props.data.map((e=>`${e.x}\t${gi(e.y,10)}`))),Hm(t,e,`${i}\n# x\ty\n${n.join("\n")}\n`)},this.onStageMouseMove=e=>{var t;if(this.props.data||(null===(t=this.props.multiPlotPropsMap)||void 0===t?void 0:t.size)>0){const t=e.evt,i=this.chartArea;let n=Gi(t.offsetX,i.left-1,i.right+1),r=Gi(t.offsetY,i.top-1,i.bottom+1);if(this.interactionMode===Qy.NONE&&this.props.graphCursorMoved){const e=this.getValueForPixelX(n),t=this.getValueForPixelY(r);this.props.graphCursorMoved(e,t)}if(this.isPanning&&this.props.graphZoomedXY){const e=n,t=r,i=this.getValueForPixelX(this.panPrevious.x),o=this.getValueForPixelX(e)-i,s=this.getValueForPixelY(this.panPrevious.y),a=this.getValueForPixelY(t)-s;this.updatePan(e,t);const l=this.props.xMin-o,c=this.props.xMax-o,d=this.props.yMin-a,p=this.props.yMax-a;this.props.graphZoomedXY(l,c,d,p)}this.isSelecting&&this.updateSelection(n,r)}},this.onStageMouseDown=e=>{const t=e.evt;this.stageClickStartX=t.offsetX,this.stageClickStartY=t.offsetY;const i=t.ctrlKey||t.shiftKey||t.altKey;i?i&&this.startPanning(t.offsetX,t.offsetY):this.startSelection(t.offsetX,t.offsetY)},this.onStageDoubleClick=()=>{this.props.graphZoomReset&&this.props.graphZoomReset()},this.onStageClick=e=>{const t=e.evt.offsetX,i=e.evt.offsetY,n=e.evt.button,r=performance.now(),o=r-this.previousClickTime;if(this.previousClickTime=r,o<300)return this.onStageDoubleClick(),void clearTimeout(this.pendingClickHandle);this.pendingClickHandle=setTimeout((()=>{const e=Math.abs(t-this.stageClickStartX),r=Math.abs(i-this.stageClickStartY);e>1||r>1||this.props.graphClicked&&0===n&&this.props.cursorNearestPoint&&this.props.graphClicked(this.props.cursorNearestPoint.x,this.props.cursorNearestPoint.y,this.props.data)}),300)},this.onStageMouseUp=e=>{const t=e.evt,i=Math.abs(t.offsetX-this.stageClickStartX),n=Math.abs(t.offsetY-this.stageClickStartY);if(i<3&&n<3)this.onStageClick(e);else if(this.props.data&&(this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.isSelecting&&this.zoomMode!==Ky.NONE)){let e=Math.min(this.selectionBoxStart.x,this.selectionBoxEnd.x),t=Math.max(this.selectionBoxStart.x,this.selectionBoxEnd.x),i=this.getValueForPixelX(e),n=this.getValueForPixelX(t);e=Math.min(this.selectionBoxStart.y,this.selectionBoxEnd.y),t=Math.max(this.selectionBoxStart.y,this.selectionBoxEnd.y);let r=this.getValueForPixelY(t),o=this.getValueForPixelY(e);this.zoomMode===Ky.X&&this.props.graphZoomedX(i,n),this.zoomMode===Ky.Y?this.props.graphZoomedY(r,o):this.zoomMode===Ky.XY&&this.props.graphZoomedXY(i,n,r,o)}this.endInteractions()},this.onStageWheel=e=>{if(this.props.data&&this.props.scrollZoom&&this.props.graphZoomedXY&&this.chartArea){const t=e.evt,i=this.chartArea,n=15,r=.001;if(t.offsetX>i.right||t.offsetX<i.left||t.offsetY>i.bottom||t.offsetY<i.top)return;const o=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n;let s=this.props.xMax-this.props.xMin;const a=(t.offsetX-i.left)/(i.right-i.left),l=r*o*s;let c=this.props.yMax-this.props.yMin;const d=(t.offsetY-i.top)/(i.bottom-i.top),p=r*o*c,h=this.props.xMin-l*a,u=this.props.xMax+l*(1-a),g=this.props.yMin-p*(1-d),f=this.props.yMax+p*d;h<u&&g<f&&this.props.graphZoomedXY(h,u,g,f)}},this.genSelectionRect=()=>{let e=null;const t=this.chartArea,i=this.selectionBoxStart,n=this.selectionBoxEnd,r={x:n.x-i.x,y:n.y-i.y},o=Math.abs(r.x),s=Math.abs(r.y);if(this.isSelecting&&(o>3||s>3)&&t){const o=t.right-t.left,s=t.bottom-t.top;if(this.zoomMode===Ky.X){const o=Gi(LO,0,i.y-t.top),a=Gi(LO,0,t.bottom-i.y);e=[Object(xm.jsx)(oy.g,{fill:L.a.GRAY3,opacity:.2,x:i.x,y:t.top,width:r.x,height:s},0),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},1),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:n.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},2)]}else if(this.zoomMode===Ky.Y){const s=Gi(LO,0,i.x-t.left),a=Gi(LO,0,t.right-i.x);e=[Object(xm.jsx)(oy.g,{fill:L.a.GRAY3,opacity:.2,x:t.left,y:i.y,width:o,height:r.y},0),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:i.y,points:[-s,0,a,0],strokeWidth:3},1),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:n.y,points:[-s,0,a,0],strokeWidth:3},2)]}else this.zoomMode===Ky.XY&&(e=[Object(xm.jsx)(oy.g,{fill:L.a.GRAY3,opacity:.2,x:i.x,y:i.y,width:r.x,height:r.y},0),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:i.y,points:[0,10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},1),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:n.x,y:i.y,points:[0,10,0,0,-10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},2),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:i.x,y:n.y,points:[0,-10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},3),Object(xm.jsx)(oy.f,{stroke:L.a.GRAY3,x:n.x,y:n.y,points:[-10,0,0,0,0,-10],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},4)])}return e},Object(m.p)(this)}endInteractions(){this.interactionMode=Qy.NONE}getPixelValue(e,t,i,n){if(!this.chartArea)return;let r=(e-t)/(i-t);return n?r*(this.chartArea.right-this.chartArea.left)+this.chartArea.left:(r=1-r,r*(this.chartArea.bottom-this.chartArea.top)+this.chartArea.top)}getValueForPixelX(e){if(!this.chartArea)return;return(e-this.chartArea.left)/(this.chartArea.right-this.chartArea.left)*(this.props.xMax-this.props.xMin)+this.props.xMin}getValueForPixelY(e){if(!this.chartArea)return;return(this.chartArea.bottom-e)/(this.chartArea.bottom-this.chartArea.top)*(this.props.yMax-this.props.yMin)+this.props.yMin}genXline(e,t,i,n){const r=this.chartArea;let o=[];return r&&o.push(Object(xm.jsx)(oy.f,{listening:!1,points:[0,r.top,0,r.bottom],strokeWidth:1,stroke:t,opacity:i},0)),Object(xm.jsx)(oy.d,{x:n,y:0,children:o},e)}genYline(e,t,i,n){const r=this.chartArea;let o=[];return r&&o.push(Object(xm.jsx)(oy.f,{listening:!1,points:[r.left,0,r.right,0],strokeWidth:1,stroke:t,opacity:i},0)),Object(xm.jsx)(oy.d,{x:0,y:n,children:o},e)}genCircle(e,t,i,n){let r=.5,o=3;return this.props&&this.props.pointRadius&&(r=this.props.pointRadius-1<=0?.5:this.props.pointRadius-1,o=this.props.pointRadius+2.5),Object(xm.jsx)(oy.d,{x:i,y:n,children:Object(xm.jsx)(oy.h,{innerRadius:r,outerRadius:o,fill:t})},e)}startSelection(e,t){this.interactionMode=Qy.SELECTING,this.selectionBoxStart={x:e,y:t},this.selectionBoxEnd={x:e,y:t}}startPanning(e,t){this.interactionMode=Qy.PANNING,this.panPrevious={x:e,y:t}}updateSelection(e,t){this.selectionBoxEnd={x:e,y:t}}updatePan(e,t){this.panPrevious={x:e,y:t}}get zoomMode(){const e=Math.abs(this.selectionBoxEnd.x-this.selectionBoxStart.x),t=Math.abs(this.selectionBoxEnd.y-this.selectionBoxStart.y);return e>LO&&t>LO&&this.props.graphZoomedXY?Ky.XY:this.props.graphZoomedX&&this.props.graphZoomedY?e>t?Ky.X:Ky.Y:this.props.graphZoomedX?Ky.X:this.props.graphZoomedY?Ky.Y:Ky.NONE}render(){var e;return Object(xm.jsxs)("div",{className:"scatter-plot-component",style:{cursor:this.isPanning?"move":"crosshair"},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,tabIndex:0,children:[Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.resize,refreshMode:"throttle",refreshRate:33}),this.width>0&&this.height>0&&Object(xm.jsx)(Ay,{...this.props,plotRefUpdated:this.onPlotRefUpdated,chartAreaUpdated:this.updateChart,width:this.width,height:this.height}),this.width>0&&this.height>0&&Object(xm.jsx)(oy.j,{className:"annotation-stage",width:this.width,height:this.height,onMouseMove:this.onStageMouseMove,onMouseDown:this.onStageMouseDown,onMouseUp:this.onStageMouseUp,onWheel:this.onStageWheel,children:Object(xm.jsxs)(oy.e,{children:[this.genIndicator(),this.genBorderRect(),this.genSelectionRect()]})}),(void 0!==this.props.data||(null===(e=this.props.multiPlotPropsMap)||void 0===e?void 0:e.size)>0)&&Object(xm.jsx)(Ey,{darkMode:this.props.darkMode,visible:this.isMouseEntered,exportImage:this.exportImage,exportData:this.exportData})]})}},IO=Object(b.a)(CO.prototype,"selectionBoxStart",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),wO=Object(b.a)(CO.prototype,"selectionBoxEnd",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),TO=Object(b.a)(CO.prototype,"chartArea",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RO=Object(b.a)(CO.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),AO=Object(b.a)(CO.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),PO=Object(b.a)(CO.prototype,"isMouseEntered",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),EO=Object(b.a)(CO.prototype,"interactionMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Qy.NONE}}),Object(b.a)(CO.prototype,"isSelecting",[m.i],Object.getOwnPropertyDescriptor(CO.prototype,"isSelecting"),CO.prototype),Object(b.a)(CO.prototype,"isPanning",[m.i],Object.getOwnPropertyDescriptor(CO.prototype,"isPanning"),CO.prototype),MO=Object(b.a)(CO.prototype,"updateChart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chartArea=e,this.props.updateChartArea&&this.props.updateChartArea(e)}}}),FO=Object(b.a)(CO.prototype,"resize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),kO=Object(b.a)(CO.prototype,"showMouseEnterWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0,this.props.mouseEntered&&this.props.mouseEntered(!0)}}}),DO=Object(b.a)(CO.prototype,"hideMouseEnterWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1}}}),Object(b.a)(CO.prototype,"endInteractions",[m.g],Object.getOwnPropertyDescriptor(CO.prototype,"endInteractions"),CO.prototype),Object(b.a)(CO.prototype,"startSelection",[m.g],Object.getOwnPropertyDescriptor(CO.prototype,"startSelection"),CO.prototype),Object(b.a)(CO.prototype,"startPanning",[m.g],Object.getOwnPropertyDescriptor(CO.prototype,"startPanning"),CO.prototype),Object(b.a)(CO.prototype,"updateSelection",[m.g],Object.getOwnPropertyDescriptor(CO.prototype,"updateSelection"),CO.prototype),Object(b.a)(CO.prototype,"updatePan",[m.g],Object.getOwnPropertyDescriptor(CO.prototype,"updatePan"),CO.prototype),Object(b.a)(CO.prototype,"zoomMode",[m.i],Object.getOwnPropertyDescriptor(CO.prototype,"zoomMode"),CO.prototype),vO=CO))||vO;var _O;i(819);let zO;!function(e){e[e.MIN_POINT_SIZE=.5]="MIN_POINT_SIZE",e[e.MAX_POINT_SIZE=10]="MAX_POINT_SIZE",e[e.MIN_TRANSPARENCY=.1]="MIN_TRANSPARENCY",e[e.MAX_TRANSPARENCY=1]="MAX_TRANSPARENCY",e[e.POINT_SIZE_STEP_SIZE=.5]="POINT_SIZE_STEP_SIZE",e[e.TRANSPARENCY_STEP_SIZE=.1]="TRANSPARENCY_STEP_SIZE"}(zO||(zO={}));let VO=Object(p.a)(_O=class extends n.Component{render(){const e=this.props;return Object(xm.jsx)("div",{className:"scatter-settings-panel",children:Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Color Map",children:Object(xm.jsx)(vy,{inverted:e.invertedColorMap,selectedItem:e.colorMap,onItemSelect:t=>{e.setColormap(t)}})}),Object(xm.jsx)(u.p,{label:"Invert Color Map",inline:!0,children:Object(xm.jsx)(u.P,{checked:e.invertedColorMap,onChange:e.handleInvertedColorMapChanged})}),Object(xm.jsx)(u.p,{inline:!0,label:"Symbol Size",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Symbol Size",min:zO.MIN_POINT_SIZE,max:zO.MAX_POINT_SIZE,value:e.scatterPlotPointSize,stepSize:zO.POINT_SIZE_STEP_SIZE,onValueChange:t=>e.setScatterPlotPointSize(t)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Transparency",children:Object(xm.jsx)(pO,{placeholder:"transparency",min:zO.MIN_TRANSPARENCY,max:zO.MAX_TRANSPARENCY,value:e.pointTransparency,stepSize:zO.TRANSPARENCY_STEP_SIZE,onValueChange:t=>e.setPointTransparency(t)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Equal Axes",children:Object(xm.jsx)(u.P,{checked:e.equalAxes,onChange:e.handleEqualAxesValuesChanged})})]})})}})||_O;var WO;i(820);let GO;!function(e){e.NONE="None",e.HANNING="Hanning",e.BOXCAR="Boxcar",e.GAUSSIAN="Gaussian",e.DECIMATION="Decimation",e.BINNING="Binning",e.SAVITZKY_GOLAY="Savitzky-Golay"}(GO||(GO={}));let BO=Object(p.a)(WO=class extends n.Component{constructor(...e){super(...e),this.handleSelectedLineChanged=e=>{this.props.smoothingStore.setSelectedLine(e.target.value)}}render(){const e=this.props.smoothingStore,t=[{value:GO.NONE,label:"None"},{value:GO.BOXCAR,label:"Boxcar"},{value:GO.GAUSSIAN,label:"Gaussian"},{value:GO.HANNING,label:"Hanning"},{value:GO.BINNING,label:"Binning"},{value:GO.SAVITZKY_GOLAY,label:"Savitzky-Golay"}];this.props.diableDecimation||t.push({value:GO.DECIMATION,label:"Decimation"});let i=[];return e.colorMap.size>0&&e.colorMap.forEach(((e,t)=>{i=i.concat({value:t,label:t})})),Object(xm.jsxs)("div",{className:"smoothing-settings-panel",children:[Object(xm.jsx)(u.p,{label:"Method",inline:!0,children:Object(xm.jsx)(u.r,{value:e&&e.type?e.type:GO.NONE,options:t,onChange:t=>e.setType(t.currentTarget.value)})}),e.type!==GO.NONE&&!this.props.diableStyle&&Object(xm.jsxs)(n.Fragment,{children:[!this.props.disableColorAndLineWidth&&Object(xm.jsxs)(u.p,{inline:!0,label:"Color",children:[e.colorMap.size>0&&Object(xm.jsx)(u.r,{value:e.selectedLine,options:i,onChange:this.handleSelectedLineChanged}),Object(xm.jsx)(ny,{color:e.selectedLine&&e.colorMap.get(e.selectedLine)?e.colorMap.get(e.selectedLine):e.lineColor,presetColors:Gb,setColor:t=>{e.selectedLine&&e.colorMap.get(e.selectedLine)?e.setColorMap(e.selectedLine,t):e.setLineColor(t)},disableAlpha:!0})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Line Style",children:Object(xm.jsx)(aO,{value:e.lineType,onValueChanged:e.setLineType})}),!this.props.disableColorAndLineWidth&&Object(xm.jsx)(u.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Line Width",min:rO.MIN_WIDTH,max:rO.MAX_WIDTH,value:e.lineWidth,stepSize:1,disabled:e.lineType===oO.POINTS,onValueChange:t=>e.setLineWidth(t)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Point Size",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Point Size",min:rO.MIN_POINT_SIZE,max:rO.MAX_POINT_SIZE,value:e.pointRadius,stepSize:rO.POINT_SIZE_STEP_SIZE,disabled:e.lineType!==oO.POINTS,onValueChange:t=>e.setPointRadius(t)})})]}),e.type!==GO.NONE&&Object(xm.jsx)(u.p,{label:"Overlay",inline:!0,children:Object(xm.jsx)(u.P,{checked:e.isOverlayOn,onChange:t=>e.setIsOverlayOn(t.currentTarget.checked)})}),e.type===GO.BOXCAR&&Object(xm.jsx)(u.p,{label:"Kernel",inline:!0,children:Object(xm.jsx)(pO,{value:e.boxcarSize,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setBoxcarSize(Math.round(t))})}),e.type===GO.GAUSSIAN&&Object(xm.jsx)(u.p,{label:"Sigma",inline:!0,children:Object(xm.jsx)(pO,{value:e.gaussianSigma,min:1,className:"narrow",onValueChange:t=>e.setGaussianSigma(t)})}),e.type===GO.HANNING&&Object(xm.jsx)(u.p,{label:"Kernel",inline:!0,children:Object(xm.jsx)(pO,{value:e.hanningSize,min:3,stepSize:2,className:"narrow",onValueChange:t=>e.setHanningSize(Math.round(t))})}),e.type===GO.DECIMATION&&Object(xm.jsx)(u.p,{label:"Decimation Width",inline:!0,children:Object(xm.jsx)(pO,{value:e.decimationWidth,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setDecimationWidth(Math.round(t))})}),e.type===GO.BINNING&&Object(xm.jsx)(u.p,{label:"Binning Width",inline:!0,children:Object(xm.jsx)(pO,{value:e.binWidth,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setBinWidth(Math.round(t))})}),e.type===GO.SAVITZKY_GOLAY&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"Kernel",inline:!0,children:Object(xm.jsx)(pO,{value:e.savitzkyGolaySize,min:5,stepSize:2,className:"narrow",onValueChange:t=>e.setSavitzkyGolaySize(Math.round(t))})}),Object(xm.jsx)(u.p,{label:"Degree of Fitting",inline:!0,children:Object(xm.jsx)(pO,{value:e.savitzkyGolayOrder,min:0,max:4,stepSize:2,className:"narrow",onValueChange:t=>e.setSavitzkyGolayOrder(Math.round(t))})})]})]})}})||WO;var qO;let HO=Object(p.a)(qO=class extends n.Component{render(){const e=this.props.frame,t=null===e||void 0===e?void 0:e.nativeSpectralCoordinate,i=(null===e||void 0===e?void 0:e.spectralCoordsSupported)?Array.from(e.spectralCoordsSupported.keys()):[],r=(this.props.disableChannelOption?i.filter((e=>"Channel"!==e)):i).map((e=>({value:e,label:e===t?e+" (Native WCS)":e}))),o=(null===e||void 0===e?void 0:e.spectralSystemsSupported)?e.spectralSystemsSupported.map((e=>({value:e,label:e}))):[],s=e&&(e.isSpectralCoordinateConvertible||e.spectralAxis&&!e.spectralAxis.valid),a=this.props.disable||!s,l=this.props.disable||!e||!e.isSpectralSystemConvertible;return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"Coordinate",inline:!0,disabled:a,children:Object(xm.jsx)(u.r,{disabled:a,value:e&&e.spectralCoordinate?e.spectralCoordinate:"",options:r,onChange:e=>this.props.onSpectralCoordinateChange(e.currentTarget.value)})}),Object(xm.jsx)(u.p,{label:"System",inline:!0,disabled:l,children:Object(xm.jsx)(u.r,{disabled:l,value:e&&e.spectralSystem?e.spectralSystem:"",options:o,onChange:e=>this.props.onSpectralSystemChange(e.currentTarget.value)})})]})}})||qO;var YO,UO,XO=i(145),$O=i(195),KO=i(436),QO=i(1041),ZO=i(62);i(821);!function(e){e[e.None=0]="None",e[e.Indeterminate=1]="Indeterminate",e[e.All=2]="All"}(UO||(UO={}));let JO=Object(p.a)(YO=class extends n.Component{constructor(...e){super(...e),this.SortingTypelinkedList={head:{value:null,next:{value:Nt.SortingType.Ascending,next:{value:Nt.SortingType.Descending,next:null}}}},this.getFilterSyntax=e=>{const t="column-popover-content";switch(e){case Nt.ColumnType.String:return Object(xm.jsxs)("div",{className:t,children:[Object(xm.jsx)("small",{children:"Filter by substring"}),Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:'e.g. gal (no quotation, entries contain the "gal" string)'})]});case Nt.ColumnType.Bool:return Object(xm.jsxs)("div",{className:t,children:[Object(xm.jsx)("small",{children:"Filter by boolean value"}),Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:'e.g. "True" or "T", "False" or "F", case insensitive'})]});case Nt.ColumnType.Double:default:return Object(xm.jsxs)("div",{className:t,children:[Object(xm.jsxs)("small",{children:["Operators: ",">",", ",">=",", ","<",", ","<=",", ","==",", ","!=",", ","..",", ","..."]}),Object(xm.jsx)("br",{}),Object(xm.jsxs)("small",{children:["e.g. ","<"," 10 (everything less than 10) "]}),Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:"e.g. == 1.23 (entries equal to 1.23) "}),Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:"e.g. 10..50 (everything between 10 and 50, exclusive)) "}),Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:"e.g. 10...50 (everything between 10 and 50, inclusive) "})]})}},this.renderCheckboxColumnHeaderCell=(e,t,i,n)=>{var r,o;const s=null===(r=this.props.filter)||void 0===r?void 0:r.get(t.name),a=this.getFilterSyntax(t.dataType);return Object(xm.jsxs)(XO.a,{children:[Object(xm.jsx)(XO.a,{children:Object(xm.jsx)(u.h,{indeterminate:n===UO.Indeterminate,checked:n===UO.All,inline:!0,onChange:()=>{n===UO.None||n===UO.All?null===i||void 0===i||i.forEach(((e,t)=>this.props.flipRowSelection(t))):null===i||void 0===i||i.forEach(((e,t)=>{e&&this.props.flipRowSelection(t)}))}})}),Object(xm.jsx)(XO.a,{isActive:""!==(null===s||void 0===s?void 0:s.filter),children:Object(xm.jsx)(j.a,{hoverOpenDelay:250,hoverCloseDelay:0,content:a,position:y.a.BOTTOM,children:Object(xm.jsx)(u.x,{small:!0,placeholder:"Click to filter",value:null!==(o=null===s||void 0===s?void 0:s.filter)&&void 0!==o?o:"",onChange:e=>this.props.updateColumnFilter(e.currentTarget.value,t.name)},"column-popover-"+e)})})]})},this.renderCheckboxCell=(e,t,i)=>Object(xm.jsx)($O.a,{interactive:!1,children:Object(xm.jsx)(n.Fragment,{children:e<(null===i||void 0===i?void 0:i.length)?Object(xm.jsx)(u.h,{checked:i[e],onChange:()=>this.props.flipRowSelection(e)}):null})},`cell_${t}_${e}`),this.renderCheckboxColumn=(e,t)=>{let i=0;null===t||void 0===t||t.forEach((e=>i+=e?1:0));const n=0===i?UO.None:i===(null===t||void 0===t?void 0:t.length)?UO.All:UO.Indeterminate;return Object(xm.jsx)(KO.a,{name:e.name,columnHeaderCellRenderer:i=>this.renderCheckboxColumnHeaderCell(i,e,t,n),cellRenderer:(null===t||void 0===t?void 0:t.length)?(e,i)=>this.renderCheckboxCell(e,i,t):void 0},e.name)},this.renderDataColumnWithFilter=(e,t)=>Object(xm.jsx)(KO.a,{name:e.name,columnHeaderCellRenderer:t=>this.renderColumnHeaderCell(t,e),cellRenderer:(null===t||void 0===t?void 0:t.length)?(i,n)=>this.renderCell(i,n,t,e):void 0},e.name),this.renderCell=(e,t,i,r)=>{const o=this.props.selectedDataIndex;let s=e;this.props.sortedIndexMap&&(s=this.props.showSelectedData?this.props.sortedIndices[s]:this.props.sortedIndexMap[s]);let a=s<i.length?i[s]:"";"boolean"===typeof a&&this.props.catalogType===Hn.FILE&&(a=a.toString());let l=a;var c,d;this.props.catalogType===Hn.SIMBAD&&((null===(c=r.name)||void 0===c?void 0:c.toLocaleLowerCase().includes("bibcode"))&&(l=Object(xm.jsx)("a",{href:`${Rx.SimbadHyperLink.bibcode}${a}`,target:"_blank",rel:"noopener noreferrer",children:a})),(null===(d=r.name)||void 0===d?void 0:d.toLocaleLowerCase().includes("main_id"))&&(l=Object(xm.jsx)("a",{href:`${Rx.SimbadHyperLink.mainId}${a}`,target:"_blank",rel:"noopener noreferrer",children:a})));const p=o&&o.includes(e)&&!this.props.showSelectedData;return Object(xm.jsx)($O.a,{intent:p?"danger":"none",loading:this.isLoading(s),interactive:!1,children:Object(xm.jsx)(n.Fragment,{children:l})},`cell_${t}_${s}`)},this.getNextSortingType=()=>{const e=this.props.sortingInfo;let t=this.SortingTypelinkedList.head;for(;t.next;){if(t.value===e.sortingType)return t.next.value;t=t.next}return null},this.renderColumnHeaderCell=(e,t)=>{var i,n,r,o;if(!isFinite(e)||!t)return null;const s=null===(i=this.props.filter)||void 0===i?void 0:i.get(t.name),a=this.getFilterSyntax(t.dataType),l=this.props.sortingInfo,c=null===(n=this.props.tableHeaders)||void 0===n||null===(r=n[null===s||void 0===s?void 0:s.dataIndex])||void 0===r?void 0:r.description,d=this.props.disableSort;return Object(xm.jsxs)(XO.a,{children:[Object(xm.jsx)(XO.a,{className:"column-name",nameRenderer:()=>{let e="sort",i="sort-icon inactive",n=0;return(null===l||void 0===l?void 0:l.columnName)===t.name&&(n=this.getNextSortingType(),(null===l||void 0===l?void 0:l.sortingType)===Nt.SortingType.Descending?(e="sort-desc",i="sort-icon"):(null===l||void 0===l?void 0:l.sortingType)===Nt.SortingType.Ascending&&(e="sort-asc",i="sort-icon")),Object(xm.jsx)("div",{className:"sort-label",onClick:()=>d?null:this.props.updateSortRequest(t.name,n,t.columnIndex),children:Object(xm.jsxs)(u.y,{disabled:d,className:"bp3-inline label",children:[Object(xm.jsx)(u.w,{className:i,icon:e}),Object(xm.jsx)(j.a,{hoverOpenDelay:250,hoverCloseDelay:0,content:null!==c&&void 0!==c?c:"Description not avaliable",position:y.a.BOTTOM,popoverClassName:gC.Instance.darkTheme?"bp3-dark":"",children:t.name})]})})}}),Object(xm.jsx)(XO.a,{isActive:""!==(null===s||void 0===s?void 0:s.filter),children:Object(xm.jsx)(j.a,{hoverOpenDelay:250,hoverCloseDelay:0,content:a,position:y.a.BOTTOM,children:Object(xm.jsx)(u.x,{small:!0,placeholder:"Click to filter",value:null!==(o=null===s||void 0===s?void 0:s.filter)&&void 0!==o?o:"",onChange:e=>this.props.updateColumnFilter(e.currentTarget.value,t.name)},"column-popover-"+e)})})]})},this.infiniteScroll=e=>{const t=e.rowIndexEnd+1;var i,n;e.rowIndexEnd>0&&t>=this.props.numVisibleRows&&!this.props.loadingCell&&!this.props.showSelectedData&&(null===(i=(n=this.props).updateByInfiniteScroll)||void 0===i||i.call(n,e.rowIndexEnd))},this.updateTableColumnWidth=(e,t)=>{const i=this.props.columnHeaders[e];i&&this.props.updateTableColumnWidth&&this.props.updateTableColumnWidth(t,i.name)},this.onRowIndexSelection=e=>{if(e.length>0){var t,i;let n=[];for(let t=0;t<e.length;t++){const i=e[t],r=i.rows[0],o=i.rows[1];if(r===o)n.push(r);else for(let e=r;e<=o;e++)n.push(e)}null===(t=(i=this.props).updateSelectedRow)||void 0===t||t.call(i,n)}}}isLoading(e){return!!(this.props.loadingCell&&e+4>this.props.numVisibleRows)}render(){var e;const t=this.props,i=[],n=t.dataset;null===(e=t.columnHeaders)||void 0===e||e.forEach((e=>{var t;const r=e.columnIndex;let o=null===(t=n.get(r))||void 0===t?void 0:t.data;const s=e.name===Cs.LineSelection&&this.props.flipRowSelection?this.renderCheckboxColumn(e,o):this.renderDataColumnWithFilter(e,o);i.push(s)}));const r=d()("column-filter-table",{"bp3-dark":gC.Instance.darkTheme});return Object(xm.jsx)(QO.a,{className:r,ref:t.updateTableRef?e=>t.updateTableRef(e):null,numRows:t.numVisibleRows,renderMode:ZO.a.BATCH,enableRowReordering:!1,selectionModes:qn.d.ROWS_AND_CELLS,onVisibleCellsChange:this.infiniteScroll,onColumnWidthChanged:this.updateTableColumnWidth,enableGhostCells:!0,onSelection:this.onRowIndexSelection,enableMultipleSelection:!0,enableRowResizing:!1,columnWidths:t.columnWidths,onCompleteRender:t.onCompleteRender,children:i})}})||YO;var ej,tj=i(264);let ij=Object(p.a)(ej=class extends n.Component{constructor(...e){super(...e),this.getFontStyle=e=>{var t;return(null===(t=this.props.boldIndex)||void 0===t?void 0:t.includes(e))?{fontWeight:"bold"}:null},this.renderRowHeaderCell=e=>{const t=this.props.isIndexZero?e:e+1;return Object(xm.jsx)(tj.a,{name:t.toString(),style:this.getFontStyle(e)})},this.renderDataColumn=(e,t)=>Object(xm.jsx)(KO.a,{name:e,cellRenderer:(e,i)=>Object(xm.jsx)($O.a,{interactive:!0,style:this.getFontStyle(e),children:e<(null===t||void 0===t?void 0:t.length)?t[e]:void 0},`cell_${i}_${e}`)},e)}render(){var e,t;const i=this.props,n=[],r=i.dataset;return null===(e=i.columnHeaders)||void 0===e||e.forEach((e=>{var t;const i=e.columnIndex;let o=null===(t=r.get(i))||void 0===t?void 0:t.data;const s=this.renderDataColumn(e.name,o);n.push(s)})),Object(xm.jsx)(QO.a,{ref:i.updateTableRef?e=>i.updateTableRef(e):null,numRows:i.numVisibleRows,renderMode:ZO.a.NONE,enableRowReordering:!1,selectionModes:qn.d.NONE,enableGhostCells:null===(t=this.props.enableGhostCells)||void 0===t||t,defaultRowHeight:this.props.defaultRowHeight,rowHeaderCellRenderer:this.renderRowHeaderCell,enableRowResizing:!1,columnWidths:this.props.columnWidths,onColumnWidthChanged:this.props.onColumnWidthChanged,children:n})}})||ej;var nj,rj,oj,sj,aj,lj;const cj=i(822),dj=i(823);let pj=(lj=aj=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}static SetRuntimeConfig(t){if(console.log("Setting runtime config"),"object"===typeof t){if("string"===typeof t.apiAddress){var i,n;const e=new URL(window.location.href).searchParams.get("socketUrl"),r=/^wss?:\/\/.*:(\d+)/,o=null!==(i=null===e||void 0===e||null===(n=e.match(r))||void 0===n?void 0:n[1])&&void 0!==i?i:"";t.apiAddress=t.apiAddress.replace("{port}",o)}e.RuntimeConfig=t}else e.RuntimeConfig={}}get accessToken(){return this._accessToken}get tokenLifetime(){return this._tokenLifetime}get authenticated(){return this._accessToken&&this._tokenLifetime>0}constructor(){Object(f.a)(this,"_accessToken",rj,this),this._tokenLifetime=void 0,this._tokenExpiryHandler=void 0,this.axiosInstance=void 0,this.authInstance=void 0,Object(f.a)(this,"setToken",oj,this),Object(f.a)(this,"clearToken",sj,this),this.onTokenExpired=async()=>{clearTimeout(this._tokenExpiryHandler);if(await this.refreshAccessToken()){console.log("Authenticated");const e=this.tokenLifetime;this._tokenExpiryHandler=setTimeout(this.onTokenExpired,1e3*(e-10))}else this.handleAuthLost()},this.handleAuthLost=()=>{if(e.RuntimeConfig.dashboardAddress){this.clearToken();const t=btoa(window.location.search);window.open(`${e.RuntimeConfig.dashboardAddress}?redirectParams=${t}`,"_self")}else this.clearToken(),v.show({icon:"warning-sign",message:"Could not authenticate with server",intent:"danger",timeout:3e3})},this.refreshAccessToken=async()=>{if(e.RuntimeConfig.googleClientId)try{var t;this.authInstance=gapi.auth2.getAuthInstance();const e=null===(t=this.authInstance)||void 0===t?void 0:t.currentUser.get();if(null===e||void 0===e?void 0:e.isSignedIn()){const t=await e.reloadAuthResponse();return this.setToken(t.id_token,t.expires_in)?(console.log("Authenticated with Google"),!0):(console.log("Error parsing Google access token"),!1)}return console.log("Not authenticated!"),this.clearToken(),!1}catch(n){return!1}else{if(!e.RuntimeConfig.tokenRefreshAddress)return!1;try{var i;const t=await this.axiosInstance.post(e.RuntimeConfig.tokenRefreshAddress);return(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.access_token)?(this.setToken(t.data.access_token,t.data.expires_in||Number.MAX_VALUE),!0):(this.clearToken(),!1)}catch(r){return this.clearToken(),console.log(r),!1}}},this.logout=async()=>{var t;if(this.clearToken(),e.RuntimeConfig.googleClientId)null===(t=this.authInstance)||void 0===t||t.signOut();else if(e.RuntimeConfig.logoutAddress)try{await this.axiosInstance.post(e.RuntimeConfig.logoutAddress)}catch(i){console.log(i)}e.RuntimeConfig.dashboardAddress&&window.open(e.RuntimeConfig.dashboardAddress,"_self")},this.stopServer=async()=>{if(e.RuntimeConfig.apiAddress)try{const t=`${e.RuntimeConfig.apiAddress}/server/stop`;await this.axiosInstance.post(t)}catch(t){v.show({icon:"warning-sign",message:"Could not stop CARTA server",intent:"danger",timeout:3e3}),console.log(t)}},this.getPreferences=async()=>{let t;var i;if(e.RuntimeConfig.apiAddress)try{var n;const i=`${e.RuntimeConfig.apiAddress}/database/preferences`,r=await this.axiosInstance.get(i);if(!(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.success))return;t=r.data.preferences}catch(r){return void console.log(r)}else t=null!==(i=JSON.parse(localStorage.getItem("preferences")))&&void 0!==i?i:{};if(t){this.upgradePreferences(t);if(!e.PreferenceValidator(t))for(const i of e.PreferenceValidator.errors)i.instancePath&&(console.log(`Removing invalid preference ${i.instancePath}`),delete t[i.instancePath.substring(1)])}return t},this.upgradePreferences=e=>{if((null===e||void 0===e?void 0:e.version)&&1===e.version){if(e.astColor||0===e.astColor)switch(e.astColor){case 0:e.astColor="auto-black";break;case 1:e.astColor="auto-white";break;case 2:e.astColor="auto-red";break;case 3:e.astColor="auto-forest";break;case 4:e.astColor="auto-blue";break;case 5:e.astColor="auto-turquoise";break;case 6:e.astColor="auto-violet";break;case 7:e.astColor="auto-gold";break;case 8:e.astColor="auto-gray";break;default:e.astColor="auto-blue"}e.version=2,this.setPreferences(e)}},this.setPreference=async(e,t)=>{const i={};return i[e]=t,this.setPreferences(i)},this.setPreferences=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/preferences`,r=await this.axiosInstance.put(n,t);return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const i=null!==(n=JSON.parse(localStorage.getItem("preferences")))&&void 0!==n?n:{};for(const e of Object.keys(t))i[e]=t[e];return e.PreferenceValidator(i)||console.log(e.PreferenceValidator.errors),localStorage.setItem("preferences",JSON.stringify(i)),!0}catch(r){return!1}},this.clearPreferences=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/preferences`,r=await this.axiosInstance.delete(n,{data:{keys:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("preferences")))&&void 0!==n?n:{};for(const i of t)delete e[i];return localStorage.setItem("preferences",JSON.stringify(e)),!0}catch(r){return!1}},this.getLayouts=async()=>{let t;if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/layouts`,r=await this.axiosInstance.get(n);if(!(null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success))return;t=r.data.layouts}catch(r){return void console.log(r)}else try{var n;t=null!==(n=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==n?n:{}}catch(r){return void console.log(r)}if(t){const e={};for(const i of Object.keys(t)){const n=t[i];fn.UpgradeLayout(n);fn.LayoutValidator(n)?e[i]=n:console.log(fn.LayoutValidator.errors)}return e}},this.setLayout=async(t,i)=>{if(e.RuntimeConfig.apiAddress)try{var n;const r=`${e.RuntimeConfig.apiAddress}/database/layout`,o=await this.axiosInstance.put(r,{layoutName:t,layout:i});return null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.success}catch(o){return console.log(o),!1}else try{var r;const e=null!==(r=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==r?r:{};return e[t]=i,localStorage.setItem("savedLayouts",JSON.stringify(e)),!0}catch(o){return!1}},this.clearLayout=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/layout`,r=await this.axiosInstance.delete(n,{data:{layoutName:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==n?n:{};return delete e[t],localStorage.setItem("savedLayouts",JSON.stringify(e)),!0}catch(r){return!1}},this.getSnippets=async()=>{let t;if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/snippets`,r=await this.axiosInstance.get(n);if(!(null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success))return;t=r.data.snippets}catch(r){return void console.log(r)}else try{var n;t=null!==(n=JSON.parse(localStorage.getItem("savedSnippets")))&&void 0!==n?n:{}}catch(r){return void console.log(r)}if(t){const i=new Map;for(const n of Object.keys(t)){const r=t[n];e.SnippetValidator(r)?i.set(n,r):console.log(e.SnippetValidator.errors)}return i}},this.setSnippet=async(t,i)=>{if(e.RuntimeConfig.apiAddress)try{var n;const r=`${e.RuntimeConfig.apiAddress}/database/snippet`,o=await this.axiosInstance.put(r,{snippetName:t,snippet:i});return null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.success}catch(o){return console.log(o),!1}else try{var r;const e=null!==(r=JSON.parse(localStorage.getItem("savedSnippets")))&&void 0!==r?r:{};return e[t]=i,localStorage.setItem("savedSnippets",JSON.stringify(e)),!0}catch(o){return!1}},this.clearSnippet=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/snippet`,r=await this.axiosInstance.delete(n,{data:{snippetName:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("savedSnippets")))&&void 0!==n?n:{};return delete e[t],localStorage.setItem("savedSnippets",JSON.stringify(e)),!0}catch(r){return!1}},Object(m.p)(this),this.axiosInstance=a.a.create(),e.RuntimeConfig.googleClientId?gapi.load("auth2",(()=>{console.log("Google auth loaded");try{gapi.auth2.init({client_id:e.RuntimeConfig.googleClientId,scope:"profile email"}).then(this.onTokenExpired,(e=>{console.log(e),this.handleAuthLost()}))}catch(t){console.log(t),this.handleAuthLost()}})):e.RuntimeConfig.tokenRefreshAddress?this.onTokenExpired():(this._accessToken="no_auth_configured",this._tokenLifetime=Number.MAX_VALUE)}},aj.staticInstance=void 0,aj.RuntimeConfig=void 0,aj.PreferenceValidator=new S.a({strictTypes:!1}).compile(cj),aj.SnippetValidator=new S.a({strictTypes:!1}).compile(dj),nj=lj,rj=Object(b.a)(nj.prototype,"_accessToken",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oj=Object(b.a)(nj.prototype,"setToken",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=Number.MAX_VALUE)=>isFinite(t)&&t>0?(t===Number.MAX_VALUE?document.cookie=`carta-auth-token=${e}`:console.log(`Token updated and valid for ${t.toFixed()} seconds`),this._accessToken=e,this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${e}`,this._tokenLifetime=t,!0):(this.clearToken(),!1)}}),sj=Object(b.a)(nj.prototype,"clearToken",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this._accessToken=void 0,this._tokenLifetime=-1,delete this.axiosInstance.defaults.headers.common.Authorization}}}),Object(b.a)(nj.prototype,"authenticated",[m.i],Object.getOwnPropertyDescriptor(nj.prototype,"authenticated"),nj.prototype),nj);var hj,uj,gj,fj,bj,mj=i(1044),yj=i(1039),Oj=i(265),jj=i(1042),xj=i(459);let Sj,vj;!function(e){e.None="none",e.Minimal="minimal",e.Usage="usage"}(Sj||(Sj={})),function(e){e.Connection="connection",e.EndSession="endSession",e.OptIn="optIn",e.OptOut="optOut",e.FileOpen="fileOpen",e.FileClose="fileClose"}(vj||(vj={}));let Cj=(bj=fj=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get effectiveTelemetryMode(){const e=JA.Instance;return!this.skipTelemetry&&e.telemetryConsentShown&&e.telemetryUuid?e.telemetryMode:Sj.None}get consentRequired(){const e=JA.Instance;return!this.skipTelemetry&&!e.telemetryConsentShown}get decodedUserId(){return this.uuid}constructor(){this.sessionId=void 0,this.axiosInstance=void 0,this.db=void 0,Object(f.a)(this,"uuid",uj,this),Object(f.a)(this,"skipTelemetry",gj,this),this.flushTelemetry=async(t=!1)=>{if(this.effectiveTelemetryMode!==Sj.None){var i;this.effectiveTelemetryMode,Sj.Minimal,this.uuid||await this.checkAndGenerateId();const r=await this.getDb(),o=null!==(i=await r.getAll(e.StoreName))&&void 0!==i?i:[];if(t){const e={id:Object(jj.a)(),timestamp:qm(),sessionId:this.sessionId,version:Vi.version,action:vj.EndSession,usageEntry:!1};o.push(e),this.addTelemetryEntry(vj.EndSession,void 0,e.id)}if(!(null===o||void 0===o?void 0:o.length))return;try{200===(await this.axiosInstance.post("/api/submit",o)).status&&(await this.clearTelemetry(),console.debug(`Submitted ${o.length} telemetry entries`))}catch(n){console.debug("Telemetry server not available")}}},Object(m.p)(this),this.axiosInstance=a.a.create({baseURL:e.ServerUrl}),this.sessionId=Object(jj.a)(),window.onbeforeunload=e=>{this.flushTelemetry(!0),e.preventDefault()},setInterval(this.flushTelemetry,1e3*e.SubmissionIntervalSeconds)}async checkAndGenerateId(e=!1){const t=new URL(window.location.href).searchParams.get("skipTelemetry");if(t)return console.log("Skipping telemetry due to "+(t?"URL override":"build-time override")),Object(m.t)((()=>{this.skipTelemetry=!0})),!1;const i=JA.Instance;let n=i.telemetryUuid;if(!n||e)try{var r;n=null===(r=(await this.axiosInstance.get("/api/token")).data)||void 0===r?void 0:r.token;const t=Object(Oj.a)(n);(null===t||void 0===t?void 0:t.uuid)&&(await i.setPreference(QA.TELEMETRY_UUID,n),console.log(`Generated new telemetry ID ${t.uuid}. This will only be used if telemetry consent is given.`),e&&await this.clearTelemetry())}catch(o){return console.warn("Could not generate telemetry UUID"),!1}if(!n)return console.warn("Could not generate telemetry UUID"),!1;try{const e=Object(Oj.a)(n);(null===e||void 0===e?void 0:e.uuid)&&Object(m.t)((()=>{this.uuid=e.uuid}))}catch(o){return console.warn("Malformed telemetry token"),!1}return this.axiosInstance.defaults.headers.common={Authorization:`Bearer ${n}`},!0}async optIn(e){const t=JA.Instance;await t.setPreference(QA.TELEMETRY_CONSENT_SHOWN,!0),await t.setPreference(QA.TELEMETRY_MODE,e);const i={timestamp:qm(),id:Object(jj.a)(),sessionId:this.sessionId,version:Vi.version,action:vj.OptIn};try{await this.axiosInstance.post("/api/submit",[i])}catch(n){console.log("Telemetry server unavailable")}}async optOut(){const e=JA.Instance;await e.setPreference(QA.TELEMETRY_CONSENT_SHOWN,!0),await e.setPreference(QA.TELEMETRY_MODE,Sj.None);const t={id:Object(jj.a)(),timestamp:qm(),sessionId:this.sessionId,version:Vi.version,action:vj.OptOut};try{await this.axiosInstance.post("/api/submit",[t])}catch(i){console.log("Telemetry server unavailable")}}async clearTelemetry(){const t=await this.getDb();await t.clear(e.StoreName)}async getDb(){return this.db||(this.db=await Object(xj.a)(e.DbName,1,{upgrade(t){t.createObjectStore(e.StoreName,{keyPath:"timestamp"})}})),this.db}addFileOpenEntry(e,t,i,n,r,o){return this.addTelemetryEntry(vj.FileOpen,{id:e,width:t,height:i,depth:n,stokes:r,generated:o})}addFileCloseEntry(e){return this.addTelemetryEntry(vj.FileClose,{id:e})}async addTelemetryEntry(t,i,n){const r=!(t===vj.Connection||t===vj.EndSession),o=JA.Instance,s=o.telemetryLogging,a=`[Telemetry] [uuid=${this.uuid}, sessionId=${this.sessionId}]`,l=qm();if(this.effectiveTelemetryMode===Sj.Usage||!r&&this.effectiveTelemetryMode===Sj.Minimal){const o={id:n||Object(jj.a)(),timestamp:l,sessionId:this.sessionId,version:Vi.version,action:t,details:i,usageEntry:r};s&&console.debug(`${a} ${o.action} ${i?JSON.stringify(i):""}`);try{const t=await this.getDb();let i=await t.count(e.StoreName);if(i>=e.EntryLimit){const n=t.transaction(e.StoreName,"readwrite"),r=await n.store.openCursor();if(n.store){for(;i>=e.EntryLimit;)n.store.delete(r.key),await r.continue(),i--;n.store.add(o),await n.done}}else await t.add(e.StoreName,o)}catch(c){console.warn(c)}}else s&&console.debug(`${a} NO-OP (disabled due to ${o.telemetryConsentShown?"user preference":"lack of explicit consent"})`)}},fj.staticInstance=void 0,fj.ServerUrl="https://telemetry.cartavis.org",fj.SubmissionIntervalSeconds=300,fj.EntryLimit=1e3,fj.DbName="telemetry",fj.StoreName="entries",hj=bj,Object(b.a)(hj.prototype,"effectiveTelemetryMode",[m.i],Object.getOwnPropertyDescriptor(hj.prototype,"effectiveTelemetryMode"),hj.prototype),Object(b.a)(hj.prototype,"consentRequired",[m.i],Object.getOwnPropertyDescriptor(hj.prototype,"consentRequired"),hj.prototype),Object(b.a)(hj.prototype,"decodedUserId",[m.i],Object.getOwnPropertyDescriptor(hj.prototype,"decodedUserId"),hj.prototype),uj=Object(b.a)(hj.prototype,"uuid",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gj=Object(b.a)(hj.prototype,"skipTelemetry",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hj);var Ij,wj,Tj,Rj,Aj,Pj,Ej,Mj,Fj,kj,Dj,Lj,Nj,_j,zj,Vj,Wj,Gj,Bj,qj,Hj,Yj,Uj,Xj,$j,Kj,Qj,Zj;let Jj;!function(e){e[e.CLOSED=0]="CLOSED",e[e.PENDING=1]="PENDING",e[e.ACTIVE=2]="ACTIVE"}(Jj||(Jj={}));class ex{constructor(){this._resolve=()=>{},this._reject=()=>{},this._promise=new Promise(((e,t)=>{this._reject=t,this._resolve=e}))}get promise(){return this._promise}resolve(e){this._resolve(e)}reject(e){this._reject(e)}}let tx=(Ij=Object(m.g)("connect"),wj=Object(m.g)("close catalog file"),Tj=Object(m.g)("set channels"),Rj=Object(m.g)("set cursor"),Aj=Object(m.g)("remove region"),Pj=Object(m.g)("set catalog filter"),Ej=Object(m.g)("set spatial requirements"),Mj=Object(m.g)("set spectral requirements"),Fj=Object(m.g)("set stats requirements"),kj=Object(m.g)("set histogram requirements"),Dj=Object(m.g)("add required tiles"),Lj=Object(m.g)("remove required tiles"),Nj=Object(m.g)("stop animation"),_j=Object(m.g)("animation flow control"),zj=Object(m.g)("set contour parameters"),Vj=Object(m.g)("set vector overlay parameters"),Wj=Object(m.g)("set auth token"),Gj=Object(m.g)("cancel requesting file list"),Bj=Object(m.g)("send scripting response"),Zj=Qj=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"connectionStatus",Hj,this),this.loggingEnabled=void 0,Object(f.a)(this,"connectionDropped",Yj,this),Object(f.a)(this,"endToEndPing",Uj,this),this.animationId=void 0,this.sessionId=void 0,this.serverFeatureFlags=void 0,this.serverUrl=void 0,this.connection=void 0,this.lastPingTime=void 0,this.lastPongTime=void 0,this.deferredMap=void 0,this.eventCounter=void 0,this.rasterTileStream=void 0,this.rasterSyncStream=void 0,this.histogramStream=void 0,this.errorStream=void 0,this.spatialProfileStream=void 0,this.spectralProfileStream=void 0,this.statsStream=void 0,this.contourStream=void 0,this.catalogStream=void 0,this.momentProgressStream=void 0,this.scriptingStream=void 0,this.listProgressStream=void 0,this.pvProgressStream=void 0,this.vectorTileStream=void 0,this.decoderMap=void 0,this.sendPing=()=>{this.connection&&this.connectionStatus===Jj.ACTIVE&&(this.lastPingTime=performance.now(),this.connection.send("PING"))},Object(f.a)(this,"updateEndToEndPing",Xj,this),Object(f.a)(this,"setAuthToken",$j,this),Object(f.a)(this,"sendScriptingResponse",Kj,this),Object(m.p)(this),this.loggingEnabled=!0,this.deferredMap=new Map,this.eventCounter=1,this.sessionId=0,this.endToEndPing=NaN,this.animationId=-1,this.connectionStatus=Jj.CLOSED,this.rasterTileStream=new mj.a,this.rasterSyncStream=new mj.a,this.histogramStream=new mj.a,this.errorStream=new mj.a,this.spatialProfileStream=new mj.a,this.spectralProfileStream=new mj.a,this.statsStream=new mj.a,this.contourStream=new mj.a,this.scriptingStream=new mj.a,this.catalogStream=new mj.a,this.momentProgressStream=new mj.a,this.listProgressStream=new mj.a,this.pvProgressStream=new mj.a,this.vectorTileStream=new mj.a,this.decoderMap=new Map([[Nt.EventType.REGISTER_VIEWER_ACK,{messageClass:Nt.RegisterViewerAck,handler:this.onRegisterViewerAck}],[Nt.EventType.FILE_LIST_RESPONSE,{messageClass:Nt.FileListResponse,handler:this.onDeferredResponse}],[Nt.EventType.REGION_LIST_RESPONSE,{messageClass:Nt.RegionListResponse,handler:this.onDeferredResponse}],[Nt.EventType.CATALOG_LIST_RESPONSE,{messageClass:Nt.CatalogListResponse,handler:this.onDeferredResponse}],[Nt.EventType.FILE_LIST_PROGRESS,{messageClass:Nt.ListProgress,handler:this.onStreamedListProgress}],[Nt.EventType.FILE_INFO_RESPONSE,{messageClass:Nt.FileInfoResponse,handler:this.onDeferredResponse}],[Nt.EventType.REGION_FILE_INFO_RESPONSE,{messageClass:Nt.RegionFileInfoResponse,handler:this.onDeferredResponse}],[Nt.EventType.CATALOG_FILE_INFO_RESPONSE,{messageClass:Nt.CatalogFileInfoResponse,handler:this.onDeferredResponse}],[Nt.EventType.OPEN_FILE_ACK,{messageClass:Nt.OpenFileAck,handler:this.onDeferredResponse}],[Nt.EventType.SAVE_FILE_ACK,{messageClass:Nt.SaveFileAck,handler:this.onDeferredResponse}],[Nt.EventType.OPEN_CATALOG_FILE_ACK,{messageClass:Nt.OpenCatalogFileAck,handler:this.onDeferredResponse}],[Nt.EventType.IMPORT_REGION_ACK,{messageClass:Nt.ImportRegionAck,handler:this.onDeferredResponse}],[Nt.EventType.EXPORT_REGION_ACK,{messageClass:Nt.ExportRegionAck,handler:this.onDeferredResponse}],[Nt.EventType.SET_REGION_ACK,{messageClass:Nt.SetRegionAck,handler:this.onDeferredResponse}],[Nt.EventType.RESUME_SESSION_ACK,{messageClass:Nt.ResumeSessionAck,handler:this.onDeferredResponse}],[Nt.EventType.START_ANIMATION_ACK,{messageClass:Nt.StartAnimationAck,handler:this.onStartAnimationAck}],[Nt.EventType.RASTER_TILE_DATA,{messageClass:Nt.RasterTileData,handler:this.onStreamedRasterTileData}],[Nt.EventType.REGION_HISTOGRAM_DATA,{messageClass:Nt.RegionHistogramData,handler:this.onStreamedRegionHistogramData}],[Nt.EventType.ERROR_DATA,{messageClass:Nt.ErrorData,handler:this.onStreamedErrorData}],[Nt.EventType.SPATIAL_PROFILE_DATA,{messageClass:Nt.SpatialProfileData,handler:this.onStreamedSpatialProfileData}],[Nt.EventType.SPECTRAL_PROFILE_DATA,{messageClass:Nt.SpectralProfileData,handler:this.onStreamedSpectralProfileData}],[Nt.EventType.REGION_STATS_DATA,{messageClass:Nt.RegionStatsData,handler:this.onStreamedRegionStatsData}],[Nt.EventType.CONTOUR_IMAGE_DATA,{messageClass:Nt.ContourImageData,handler:this.onStreamedContourData}],[Nt.EventType.CATALOG_FILTER_RESPONSE,{messageClass:Nt.CatalogFilterResponse,handler:this.onStreamedCatalogData}],[Nt.EventType.RASTER_TILE_SYNC,{messageClass:Nt.RasterTileSync,handler:this.onStreamedRasterSync}],[Nt.EventType.MOMENT_PROGRESS,{messageClass:Nt.MomentProgress,handler:this.onStreamedMomentProgress}],[Nt.EventType.MOMENT_RESPONSE,{messageClass:Nt.MomentResponse,handler:this.onDeferredResponse}],[Nt.EventType.SCRIPTING_REQUEST,{messageClass:Nt.ScriptingRequest,handler:this.onScriptingRequest}],[Nt.EventType.SPLATALOGUE_PONG,{messageClass:Nt.SpectralLineResponse,handler:this.onDeferredResponse}],[Nt.EventType.SPECTRAL_LINE_RESPONSE,{messageClass:Nt.SpectralLineResponse,handler:this.onDeferredResponse}],[Nt.EventType.CONCAT_STOKES_FILES_ACK,{messageClass:Nt.ConcatStokesFilesAck,handler:this.onDeferredResponse}],[Nt.EventType.PV_PROGRESS,{messageClass:Nt.PvProgress,handler:this.onStreamedPvProgress}],[Nt.EventType.PV_RESPONSE,{messageClass:Nt.PvResponse,handler:this.onDeferredResponse}],[Nt.EventType.FITTING_RESPONSE,{messageClass:Nt.FittingResponse,handler:this.onDeferredResponse}],[Nt.EventType.VECTOR_OVERLAY_TILE_DATA,{messageClass:Nt.VectorOverlayTileData,handler:this.onStreamedVectorOverlayData}]]),setInterval(this.sendPing,5e3)}async connect(t){this.connection&&(this.connection.onclose=null,this.connection.close());const i=t===this.serverUrl;let n=0;const r=pj.Instance;this.connectionDropped=!1,this.connectionStatus=Jj.PENDING,this.serverUrl=t,this.connection=new WebSocket(r.accessToken?t+`?token=${r.accessToken}`:t),this.connection.binaryType="arraybuffer",this.connection.onmessage=this.messageHandler.bind(this),this.connection.onclose=o=>Object(m.t)((()=>{this.connectionStatus===Jj.ACTIVE||i||n>=e.MaxConnectionAttempts?this.connectionStatus=Jj.CLOSED:(n++,setTimeout((()=>{const e=new WebSocket(r.accessToken?t+`?token=${r.accessToken}`:t);e.binaryType="arraybuffer",e.onopen=this.connection.onopen,e.onerror=this.connection.onerror,e.onclose=this.connection.onclose,e.onmessage=this.connection.onmessage,this.connection=e}),e.ConnectionAttemptDelay))})),this.deferredMap.clear(),this.eventCounter=1;const o=this.eventCounter,s=new ex;return this.deferredMap.set(o,s),this.connection.onopen=Object(m.g)((()=>{this.connectionStatus===Jj.CLOSED&&(this.connectionDropped=!0),this.connectionStatus=Jj.ACTIVE;const t=Nt.RegisterViewer.create({sessionId:this.sessionId,clientFeatureFlags:e.DefaultFeatureFlags});if(this.logEvent(Nt.EventType.REGISTER_VIEWER,o,t,!1),!this.sendEvent(Nt.EventType.REGISTER_VIEWER,Nt.RegisterViewer.encode(t).finish()))throw new Error("Could not send event");this.deferredMap.set(o,s)})),this.connection.onerror=e=>{gC.Instance.logStore.addInfo(`Connecting to server ${t} failed.`,["network"]),console.log(e)},await s.promise}async getFileList(e,t){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const i=Nt.FileListRequest.create({directory:e,filterMode:t}),n=this.eventCounter;if(this.logEvent(Nt.EventType.FILE_LIST_REQUEST,n,i,!1),this.sendEvent(Nt.EventType.FILE_LIST_REQUEST,Nt.FileListRequest.encode(i).finish())){const e=new ex;return this.deferredMap.set(n,e),await e.promise}throw new Error("Could not send event")}}async getRegionList(e,t){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const i=Nt.RegionListRequest.create({directory:e,filterMode:t}),n=this.eventCounter;if(this.logEvent(Nt.EventType.REGION_LIST_REQUEST,n,i,!1),this.sendEvent(Nt.EventType.REGION_LIST_REQUEST,Nt.RegionListRequest.encode(i).finish())){const e=new ex;return this.deferredMap.set(n,e),await e.promise}throw new Error("Could not send event")}}async getCatalogList(e,t){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const i=Nt.CatalogListRequest.create({directory:e,filterMode:t}),n=this.eventCounter;if(this.logEvent(Nt.EventType.CATALOG_LIST_REQUEST,n,i,!1),this.sendEvent(Nt.EventType.CATALOG_LIST_REQUEST,Nt.CatalogListRequest.encode(i).finish())){const e=new ex;return this.deferredMap.set(n,e),await e.promise}throw new Error("Could not send event")}}async getFileInfo(e,t,i){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const n=Nt.FileInfoRequest.create({directory:e,file:t,hdu:i}),r=this.eventCounter;if(this.logEvent(Nt.EventType.FILE_INFO_REQUEST,r,n,!1),this.sendEvent(Nt.EventType.FILE_INFO_REQUEST,Nt.FileInfoRequest.encode(n).finish())){const e=new ex;return this.deferredMap.set(r,e),await e.promise}throw new Error("Could not send event")}}async getRegionFileInfo(e,t){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const i=Nt.RegionFileInfoRequest.create({directory:e,file:t}),n=this.eventCounter;if(this.logEvent(Nt.EventType.REGION_FILE_INFO_REQUEST,n,i,!1),this.sendEvent(Nt.EventType.REGION_FILE_INFO_REQUEST,Nt.RegionFileInfoRequest.encode(i).finish())){const e=new ex;return this.deferredMap.set(n,e),await e.promise}throw new Error("Could not send event")}}async getCatalogFileInfo(e,t){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const i=Nt.CatalogFileInfoRequest.create({directory:e,name:t}),n=this.eventCounter;if(this.logEvent(Nt.EventType.CATALOG_FILE_INFO_REQUEST,n,i,!1),this.sendEvent(Nt.EventType.CATALOG_FILE_INFO_REQUEST,Nt.CatalogFileInfoRequest.encode(i).finish())){const e=new ex;return this.deferredMap.set(n,e),await e.promise}throw new Error("Could not send event")}}async importRegion(e,t,i,n){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const r=Nt.ImportRegion.create({directory:e,file:t,type:i,groupId:n}),o=this.eventCounter;if(this.logEvent(Nt.EventType.IMPORT_REGION,o,r,!1),this.sendEvent(Nt.EventType.IMPORT_REGION,Nt.ImportRegion.encode(r).finish())){const e=new ex;return this.deferredMap.set(o,e),await e.promise}throw new Error("Could not send event")}}async exportRegion(e,t,i,n,r,o){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const s=Nt.ExportRegion.create({directory:e,file:t,type:i,fileId:r,regionStyles:rn(o),coordType:n}),a=this.eventCounter;if(this.logEvent(Nt.EventType.EXPORT_REGION,a,s,!1),this.sendEvent(Nt.EventType.EXPORT_REGION,Nt.ExportRegion.encode(s).finish())){const e=new ex;return this.deferredMap.set(a,e),await e.promise}throw new Error("Could not send event")}}async loadFile(e,t,i,n,r){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const o=Nt.OpenFile.create({directory:e,file:t,hdu:i,fileId:n,lelExpr:r,renderMode:Nt.RenderMode.RASTER}),s=this.eventCounter;if(this.logEvent(Nt.EventType.OPEN_FILE,s,o,!1),this.sendEvent(Nt.EventType.OPEN_FILE,Nt.OpenFile.encode(o).finish())){const e=new ex;return this.deferredMap.set(s,e),await e.promise}throw new Error("Could not send event")}}async loadStokeFiles(e,t,i){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const n={stokesFiles:e,fileId:t,renderMode:i},r=Nt.ConcatStokesFiles.create(n),o=this.eventCounter;if(this.logEvent(Nt.EventType.CONCAT_STOKES_FILES,o,r,!1),this.sendEvent(Nt.EventType.CONCAT_STOKES_FILES,Nt.ConcatStokesFiles.encode(r).finish())){const e=new ex;return this.deferredMap.set(o,e),await e.promise}throw new Error("Could not send event")}}async loadCatalogFile(e,t,i,n){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const r=Nt.OpenCatalogFile.create({directory:e,name:t,fileId:i,previewDataSize:n}),o=this.eventCounter;if(this.logEvent(Nt.EventType.OPEN_CATALOG_FILE,o,r,!1),this.sendEvent(Nt.EventType.OPEN_CATALOG_FILE,Nt.OpenCatalogFile.encode(r).finish())){const e=new ex;return this.deferredMap.set(o,e),await e.promise}throw new Error("Could not send event")}}closeCatalogFile(e){if(this.connectionStatus===Jj.ACTIVE){const t=Nt.CloseCatalogFile.create({fileId:e});if(this.logEvent(Nt.EventType.CLOSE_CATALOG_FILE,this.eventCounter,t,!1),this.sendEvent(Nt.EventType.CLOSE_CATALOG_FILE,Nt.CloseCatalogFile.encode(t).finish()))return!0}return!1}async saveFile(e,t,i,n,r,o,s,a,l){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const c=Nt.SaveFile.create({fileId:e,outputFileDirectory:t,outputFileName:i,outputFileType:n,regionId:r,channels:o,stokes:s,keepDegenerate:a,restFreq:l}),d=this.eventCounter;if(this.logEvent(Nt.EventType.SAVE_FILE,this.eventCounter,c,!1),this.sendEvent(Nt.EventType.SAVE_FILE,Nt.SaveFile.encode(c).finish())){const e=new ex;return this.deferredMap.set(d,e),await e.promise}throw new Error("Could not send event")}}closeFile(e){if(this.connectionStatus===Jj.ACTIVE){const t=Nt.CloseFile.create({fileId:e});if(this.logEvent(Nt.EventType.CLOSE_FILE,this.eventCounter,t,!1),this.sendEvent(Nt.EventType.CLOSE_FILE,Nt.CloseFile.encode(t).finish()))return!0}return!1}setChannels(e,t,i,n){if(this.connectionStatus===Jj.ACTIVE){const r=Nt.SetImageChannels.create({fileId:e,channel:t,stokes:i,requiredTiles:n});if(this.logEvent(Nt.EventType.SET_IMAGE_CHANNELS,this.eventCounter,r,!1),this.sendEvent(Nt.EventType.SET_IMAGE_CHANNELS,Nt.SetImageChannels.encode(r).finish()))return!0}return!1}setCursor(e,t,i){if(this.connectionStatus===Jj.ACTIVE){const n=Nt.SetCursor.create({fileId:e,point:{x:t,y:i}});if(this.logEvent(Nt.EventType.SET_CURSOR,this.eventCounter,n,!1),this.sendEvent(Nt.EventType.SET_CURSOR,Nt.SetCursor.encode(n).finish()))return!0}return!1}async setRegion(e,t,i){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const n=Nt.SetRegion.create({fileId:e,regionId:t,regionInfo:{regionType:i.regionType,rotation:i.rotation,controlPoints:i.controlPoints.slice()}}),r=this.eventCounter;if(this.logEvent(Nt.EventType.SET_REGION,r,n,!1),this.sendEvent(Nt.EventType.SET_REGION,Nt.SetRegion.encode(n).finish())){const e=new ex;return this.deferredMap.set(r,e),await e.promise}throw new Error("Could not send event")}}removeRegion(e){if(this.connectionStatus===Jj.ACTIVE){const t=Nt.RemoveRegion.create({regionId:e});if(this.logEvent(Nt.EventType.REMOVE_REGION,this.eventCounter,t,!1),this.sendEvent(Nt.EventType.REMOVE_REGION,Nt.RemoveRegion.encode(t).finish()))return!0}return!1}setCatalogFilterRequest(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.CATALOG_FILTER_REQUEST,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.CATALOG_FILTER_REQUEST,Nt.CatalogFilterRequest.encode(e).finish())))}setSpatialRequirements(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SET_SPATIAL_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SET_SPATIAL_REQUIREMENTS,Nt.SetSpatialRequirements.encode(e).finish())))}setSpectralRequirements(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SET_SPECTRAL_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SET_SPECTRAL_REQUIREMENTS,Nt.SetSpectralRequirements.encode(e).finish())))}setStatsRequirements(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SET_STATS_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SET_STATS_REQUIREMENTS,Nt.SetStatsRequirements.encode(e).finish())))}setHistogramRequirements(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SET_HISTOGRAM_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SET_HISTOGRAM_REQUIREMENTS,Nt.SetHistogramRequirements.encode(e).finish())))}addRequiredTiles(e,t,i){if(this.connectionStatus===Jj.ACTIVE){const n=Nt.AddRequiredTiles.create({fileId:e,tiles:t,compressionQuality:i,compressionType:Nt.CompressionType.ZFP});if(this.logEvent(Nt.EventType.ADD_REQUIRED_TILES,this.eventCounter,n,!1),this.sendEvent(Nt.EventType.ADD_REQUIRED_TILES,Nt.AddRequiredTiles.encode(n).finish()))return!0}return!1}removeRequiredTiles(e,t){if(this.connectionStatus===Jj.ACTIVE){const i=Nt.RemoveRequiredTiles.create({fileId:e,tiles:t});if(this.logEvent(Nt.EventType.REMOVE_REQUIRED_TILES,this.eventCounter,i,!1),this.sendEvent(Nt.EventType.REMOVE_REQUIRED_TILES,Nt.RemoveRequiredTiles.encode(i).finish()))return!0}return!1}async startAnimation(e){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const t=this.eventCounter;if(this.logEvent(Nt.EventType.START_ANIMATION,t,e,!1),this.sendEvent(Nt.EventType.START_ANIMATION,Nt.StartAnimation.encode(e).finish())){const e=new ex;return this.deferredMap.set(t,e),await e.promise}throw new Error("Could not send event")}}stopAnimation(e){return this.animationId=-1,!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.STOP_ANIMATION,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.STOP_ANIMATION,Nt.StopAnimation.encode(e).finish())))}sendAnimationFlowControl(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.ANIMATION_FLOW_CONTROL,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.ANIMATION_FLOW_CONTROL,Nt.AnimationFlowControl.encode(e).finish())))}setContourParameters(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SET_CONTOUR_PARAMETERS,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SET_CONTOUR_PARAMETERS,Nt.SetContourParameters.encode(e).finish())))}setVectorOverlayParameters(e){return!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SET_VECTOR_OVERLAY_PARAMETERS,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SET_VECTOR_OVERLAY_PARAMETERS,Nt.SetVectorOverlayParameters.encode(e).finish())))}async resumeSession(e){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const t=this.eventCounter;if(this.logEvent(Nt.EventType.RESUME_SESSION,t,e,!1),this.sendEvent(Nt.EventType.RESUME_SESSION,Nt.ResumeSession.encode(e).finish())){const e=new ex;return this.deferredMap.set(t,e),await e.promise}throw new Error("Could not send event")}}async requestMoment(e){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const t=this.eventCounter;if(this.logEvent(Nt.EventType.MOMENT_REQUEST,t,e,!1),this.sendEvent(Nt.EventType.MOMENT_REQUEST,Nt.MomentRequest.encode(e).finish())){const e=new ex;return this.deferredMap.set(t,e),await e.promise}throw new Error("Could not send event")}}cancelRequestingMoment(e){if(this.connectionStatus!==Jj.ACTIVE)return Object(yj.a)(new Error("Not connected"));{const t=Nt.StopMomentCalc.create({fileId:e});return this.logEvent(Nt.EventType.STOP_MOMENT_CALC,this.eventCounter,t,!1),!!this.sendEvent(Nt.EventType.STOP_MOMENT_CALC,Nt.StopMomentCalc.encode(t).finish())||Object(yj.a)(new Error("Could not send event"))}}cancelRequestingFileList(e){if(this.connectionStatus!==Jj.ACTIVE)return Object(yj.a)(new Error("Not connected"));{const t=Nt.StopFileList.create({fileListType:e});return this.logEvent(Nt.EventType.STOP_FILE_LIST,this.eventCounter,t,!1),!!this.sendEvent(Nt.EventType.STOP_FILE_LIST,new Uint8Array)||Object(yj.a)(new Error("Could not send event"))}}async pingSplatalogue(){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const e=Nt.SplataloguePing.create(),t=this.eventCounter;if(this.logEvent(Nt.EventType.SPLATALOGUE_PING,t,e,!1),this.sendEvent(Nt.EventType.SPLATALOGUE_PING,Nt.SplataloguePing.encode(e).finish())){const e=new ex;return this.deferredMap.set(t,e),await e.promise}throw new Error("Could not send event")}}async requestSpectralLine(e,t){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const i=Nt.SpectralLineRequest.create({frequencyRange:e,lineIntensityLowerLimit:t}),n=this.eventCounter;if(this.logEvent(Nt.EventType.SPECTRAL_LINE_REQUEST,n,i,!1),this.sendEvent(Nt.EventType.SPECTRAL_LINE_REQUEST,Nt.SpectralLineRequest.encode(i).finish())){const e=new ex;return this.deferredMap.set(n,e),await e.promise}throw new Error("Could not send event")}}async requestPV(e){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const t=this.eventCounter;if(this.logEvent(Nt.EventType.PV_REQUEST,t,e,!1),this.sendEvent(Nt.EventType.PV_REQUEST,Nt.PvRequest.encode(e).finish())){const e=new ex;return this.deferredMap.set(t,e),await e.promise}throw new Error("Could not send event")}}cancelRequestingPV(e){if(this.connectionStatus!==Jj.ACTIVE)return Object(yj.a)(new Error("Not connected"));{const t=Nt.StopPvCalc.create({fileId:e});return this.logEvent(Nt.EventType.STOP_PV_CALC,this.eventCounter,t,!1),!!this.sendEvent(Nt.EventType.STOP_PV_CALC,Nt.StopPvCalc.encode(t).finish())||Object(yj.a)(new Error("Could not send event"))}}async requestFitting(e){if(this.connectionStatus!==Jj.ACTIVE)throw new Error("Not connected");{const t=this.eventCounter;if(this.logEvent(Nt.EventType.FITTING_REQUEST,t,e,!1),this.sendEvent(Nt.EventType.FITTING_REQUEST,Nt.FittingRequest.encode(e).finish())){const e=new ex;return this.deferredMap.set(t,e),await e.promise}throw new Error("Could not send event")}}serverHasFeature(e){return 0!==(this.serverFeatureFlags&e)}messageHandler(t){if("PONG"===t.data)return this.lastPongTime=performance.now(),void this.updateEndToEndPing();if(t.data.byteLength<8)return void console.log("Unknown event format");const i=new Uint16Array(t.data,0,2),n=new Uint32Array(t.data,4,1),r=new Uint8Array(t.data,8),o=i[0],s=i[1],a=n[0];s!==e.IcdVersion&&console.warn(`Server event has ICD version ${s}, which differs from frontend version ${e.IcdVersion}. Errors may occur`);try{const e=this.decoderMap.get(o);if(e){const t=e.messageClass.decode(r);t?(this.logEvent(o,a,t),e.handler.call(this,a,t)):console.log(`Unsupported event response ${o}`)}}catch(l){console.log(l)}}onDeferredResponse(e,t){const i=this.deferredMap.get(e);i?t.success?i.resolve(t):i.reject(t.message):console.log(`Can't find deferred for request ${e}`)}onRegisterViewerAck(e,t){this.sessionId=t.sessionId,this.serverFeatureFlags=t.serverFeatureFlags,Cj.Instance.addTelemetryEntry(vj.Connection,{serverFeatureFlags:t.serverFeatureFlags,platformInfo:t.platformStrings}),this.onDeferredResponse(e,t)}onStartAnimationAck(e,t){this.animationId=t.success?t.animationId:-1,this.onDeferredResponse(e,t)}onStreamedRasterTileData(e,t){this.rasterTileStream.next(t)}onStreamedRasterSync(e,t){this.rasterSyncStream.next(t)}onStreamedRegionHistogramData(e,t){this.histogramStream.next(t)}onStreamedErrorData(e,t){this.errorStream.next(t)}onStreamedSpatialProfileData(e,t){this.spatialProfileStream.next(t)}onStreamedSpectralProfileData(e,t){this.spectralProfileStream.next(t)}onStreamedRegionStatsData(e,t){this.statsStream.next(t)}onStreamedContourData(e,t){this.contourStream.next(t)}onStreamedVectorOverlayData(e,t){this.vectorTileStream.next(t)}onScriptingRequest(e,t){this.scriptingStream.next(t)}onStreamedCatalogData(e,t){this.catalogStream.next(t)}onStreamedMomentProgress(e,t){this.momentProgressStream.next(t)}onStreamedListProgress(e,t){this.listProgressStream.next(t)}onStreamedPvProgress(e,t){this.pvProgressStream.next(t)}sendEvent(t,i){if(this.connection.readyState===WebSocket.OPEN){const n=new Uint8Array(8+i.byteLength),r=new Uint16Array(n.buffer,0,2),o=new Uint32Array(n.buffer,4,1);return r[0]=t,r[1]=e.IcdVersion,o[0]=this.eventCounter,n.set(i,8),this.connection.send(n),this.eventCounter++,!0}return console.log("Error sending event"),this.eventCounter++,!1}logEvent(e,t,i,n=!0){const r=Nt.EventType[e];this.loggingEnabled&&JA.Instance.isEventLoggingEnabled(e)&&(n?0===t?console.log(`<== ${r} [Stream]`):console.log(`<== ${r} [${t}]`):console.log(`${r} [${t}] ==>`),console.log(i),console.log("\n"))}},Qj.staticInstance=void 0,Qj.IcdVersion=27,Qj.DefaultFeatureFlags=Nt.ClientFeatureFlags.WEB_ASSEMBLY|Nt.ClientFeatureFlags.WEB_GL,Qj.MaxConnectionAttempts=15,Qj.ConnectionAttemptDelay=1e3,qj=Zj,Hj=Object(b.a)(qj.prototype,"connectionStatus",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yj=Object(b.a)(qj.prototype,"connectionDropped",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uj=Object(b.a)(qj.prototype,"endToEndPing",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(qj.prototype,"connect",[Ij],Object.getOwnPropertyDescriptor(qj.prototype,"connect"),qj.prototype),Xj=Object(b.a)(qj.prototype,"updateEndToEndPing",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.endToEndPing=this.lastPongTime-this.lastPingTime}}}),Object(b.a)(qj.prototype,"closeCatalogFile",[wj],Object.getOwnPropertyDescriptor(qj.prototype,"closeCatalogFile"),qj.prototype),Object(b.a)(qj.prototype,"setChannels",[Tj],Object.getOwnPropertyDescriptor(qj.prototype,"setChannels"),qj.prototype),Object(b.a)(qj.prototype,"setCursor",[Rj],Object.getOwnPropertyDescriptor(qj.prototype,"setCursor"),qj.prototype),Object(b.a)(qj.prototype,"removeRegion",[Aj],Object.getOwnPropertyDescriptor(qj.prototype,"removeRegion"),qj.prototype),Object(b.a)(qj.prototype,"setCatalogFilterRequest",[Pj],Object.getOwnPropertyDescriptor(qj.prototype,"setCatalogFilterRequest"),qj.prototype),Object(b.a)(qj.prototype,"setSpatialRequirements",[Ej],Object.getOwnPropertyDescriptor(qj.prototype,"setSpatialRequirements"),qj.prototype),Object(b.a)(qj.prototype,"setSpectralRequirements",[Mj],Object.getOwnPropertyDescriptor(qj.prototype,"setSpectralRequirements"),qj.prototype),Object(b.a)(qj.prototype,"setStatsRequirements",[Fj],Object.getOwnPropertyDescriptor(qj.prototype,"setStatsRequirements"),qj.prototype),Object(b.a)(qj.prototype,"setHistogramRequirements",[kj],Object.getOwnPropertyDescriptor(qj.prototype,"setHistogramRequirements"),qj.prototype),Object(b.a)(qj.prototype,"addRequiredTiles",[Dj],Object.getOwnPropertyDescriptor(qj.prototype,"addRequiredTiles"),qj.prototype),Object(b.a)(qj.prototype,"removeRequiredTiles",[Lj],Object.getOwnPropertyDescriptor(qj.prototype,"removeRequiredTiles"),qj.prototype),Object(b.a)(qj.prototype,"stopAnimation",[Nj],Object.getOwnPropertyDescriptor(qj.prototype,"stopAnimation"),qj.prototype),Object(b.a)(qj.prototype,"sendAnimationFlowControl",[_j],Object.getOwnPropertyDescriptor(qj.prototype,"sendAnimationFlowControl"),qj.prototype),Object(b.a)(qj.prototype,"setContourParameters",[zj],Object.getOwnPropertyDescriptor(qj.prototype,"setContourParameters"),qj.prototype),Object(b.a)(qj.prototype,"setVectorOverlayParameters",[Vj],Object.getOwnPropertyDescriptor(qj.prototype,"setVectorOverlayParameters"),qj.prototype),$j=Object(b.a)(qj.prototype,"setAuthToken",[Wj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{document.cookie=`CARTA-Authorization=${e}; path=/`}}}),Object(b.a)(qj.prototype,"cancelRequestingFileList",[Gj],Object.getOwnPropertyDescriptor(qj.prototype,"cancelRequestingFileList"),qj.prototype),Kj=Object(b.a)(qj.prototype,"sendScriptingResponse",[Bj],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>!(this.connectionStatus!==Jj.ACTIVE||(this.logEvent(Nt.EventType.SCRIPTING_RESPONSE,this.eventCounter,e,!1),!this.sendEvent(Nt.EventType.SCRIPTING_RESPONSE,Nt.ScriptingResponse.encode(e).finish())))}}),qj);var ix,nx,rx,ox,sx,ax,lx=i(198),cx=i.n(lx);function dx(){return new Worker(i.p+"static/js/index.4b3485c5.worker.js")}const px=4096,hx=256;let ux=(ax=sx=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get zfpReady(){return this.workersReady&&this.workersReady.every((e=>e))}setWorkerReady(e){e>=0&&e<this.workersReady.length&&(this.workersReady[e]=!0)}constructor(){this.backendService=void 0,this.cacheMapCompressedTiles=void 0,this.pendingRequests=void 0,this.pendingDecompressions=void 0,this.channelMap=void 0,this.completedChannels=void 0,this.tileStream=void 0,this.cachedTiles=void 0,this.lruCapacitySystem=void 0,this.textureArray=void 0,this.textureCoordinateQueue=void 0,this.workers=void 0,this.compressionRequestCounter=void 0,this.pendingSynchronisedTiles=void 0,this.receivedSynchronisedTiles=void 0,this.animationEnabled=void 0,this.gl=void 0,Object(f.a)(this,"remainingTiles",nx,this),Object(f.a)(this,"workersReady",rx,this),this.setAnimationEnabled=e=>{this.animationEnabled=e},this.setCache=(e,t)=>{const i=16777216/(hx*hx),n=Math.min(Math.ceil(e/i),8);e=n*i,console.log(`lruGPU capacity rounded to : ${e}`),this.textureArray=new Array(n),this.initTextures(),this.resetCoordinateQueue(),this.cachedTiles=new cx.a(Float64Array,null,e),this.lruCapacitySystem=t},Object(f.a)(this,"updateRemainingTileCount",ox,this),this.clearTile=(e,t)=>{e.data&&delete e.data,this.textureCoordinateQueue.push(e.textureCoordinate)},this.handleStreamSync=e=>{const t=`${e.fileId}_${e.stokes}_${e.channel}`;this.animationEnabled&&e.animationId!==this.backendService.animationId||(this.animationEnabled||0===e.animationId)&&(e.endSync?this.completedChannels.set(t,!0):(this.completedChannels.delete(t),this.pendingDecompressions.set(t,new Map)))},this.handleStreamedTiles=e=>{const t=`${e.fileId}_${e.stokes}_${e.channel}`;e.compressionType!==Nt.CompressionType.NONE&&e.compressionType!==Nt.CompressionType.ZFP&&console.error("Unsupported compression type");const i=this.channelMap.get(e.fileId);if(!this.animationEnabled&&(!i||i.channel!==e.channel||i.stokes!==e.stokes))return void console.log(`Ignoring stale tile for channel=${e.channel} (Current channel=${i?i.channel:void 0})`);if(this.animationEnabled&&e.animationId!==this.backendService.animationId)return void console.log(`Skipping stale tile during animation Message animation_id: ${e.animationId}. Service animation_id: ${this.backendService.animationId}`);if(!this.animationEnabled&&0!==e.animationId)return void console.log(`Skipping stale animation tile outside of animation. Message animation_id: ${e.animationId}. Service animation_id: ${this.backendService.animationId}`);if(this.pendingDecompressions.get(t)){this.animationEnabled&&this.channelMap.set(e.fileId,{channel:e.channel,stokes:e.stokes});for(let i of e.tiles){const n=wi.Encode(i.x,i.y,i.layer),r=this.pendingRequests.get(t);if((null===r||void 0===r?void 0:r.has(n))||this.animationEnabled)if(r&&r.delete(n),this.updateRemainingTileCount(),e.compressionType===Nt.CompressionType.NONE){const t=new Float32Array(i.imageData.buffer.slice(i.imageData.byteOffset,i.imageData.byteOffset+i.imageData.byteLength));this.updateStream(e.fileId,e.channel,e.stokes,t,i.width,i.height,i.layer,n)}else this.getCompressedCache(e.fileId).set(n,{tile:i,compressionQuality:e.compressionQuality}),this.asyncDecompressTile(e.fileId,e.channel,e.stokes,i,e.compressionQuality,n);else console.warn(`No pending request for tile (${i.x}, ${i.y}, ${i.layer}) and key=${t}`)}}else console.warn(`Missing compression map for key=${t}`)},Object(m.p)(this),this.backendService=tx.Instance,this.gl=jx.Instance.gl,this.channelMap=new Map,this.pendingRequests=new Map,this.cacheMapCompressedTiles=new Map,this.pendingDecompressions=new Map,this.completedChannels=new Map,this.receivedSynchronisedTiles=new Map,this.pendingSynchronisedTiles=new Map,this.compressionRequestCounter=0,this.remainingTiles=0,this.animationEnabled=!1,this.tileStream=new mj.a,this.backendService.rasterTileStream.subscribe(this.handleStreamedTiles),this.backendService.rasterSyncStream.subscribe(this.handleStreamSync),this.workers=new Array(Math.min(navigator.hardwareConcurrency||4,4)),this.workersReady=new Array(this.workers.length);for(let e=0;e<this.workers.length;e++)this.workers[e]=new dx,this.workers[e].onmessage=t=>{if("ready"===t.data[0])this.setWorkerReady(e);else if("decompress"===t.data[0]){const e=t.data[1],i=t.data[2],n=i.width*i.subsetHeight,r=new Float32Array(e,0,n);this.updateStream(i.fileId,i.channel,i.stokes,r,i.width,i.subsetHeight,i.layer,i.tileCoordinate)}}}resetCoordinateQueue(){const e=16777216/(hx*hx),t=this.textureArray.length*e;this.textureCoordinateQueue=new Array(t);for(let i=0;i<t;i++)this.textureCoordinateQueue[i]=t-1-i}getCompressedCache(e){const t=this.cacheMapCompressedTiles.get(e);if(t)return t;{const t=new cx.a(Float64Array,null,this.lruCapacitySystem);return this.cacheMapCompressedTiles.set(e,t),t}}getTile(e,t,i,n,r=!1){const o=wi.AddFileId(e,t);return r?this.cachedTiles.peek(o):this.cachedTiles.get(o)}requestTiles(e,t,i,n,r,o,s=!1){const a=`${t}_${n}_${i}`;!s&&this.channelMap.has(t)||(this.pendingSynchronisedTiles.set(a,e.map((e=>e.encode()))),this.receivedSynchronisedTiles.delete(a),this.clearRequestQueue(t),this.channelMap.set(t,{channel:i,stokes:n}),this.clearCompressedCache(t));const l=new Array;for(const p of e){var c,d;if(p.layer<0)continue;const e=p.encode(),r=wi.AddFileId(e,t),o=null===(c=this.pendingRequests)||void 0===c?void 0:c.get(a);if(!(!s&&(null===(d=this.cachedTiles)||void 0===d?void 0:d.has(r)))&&(!o||!o.has(e))){const r=!s&&this.getCompressedCache(t).get(e),c=this.pendingDecompressions.get(a),d=c&&c.has(e);r&&!d?(c||this.pendingDecompressions.set(a,new Map),this.asyncDecompressTile(t,i,n,r.tile,r.compressionQuality,e)):r||(o||this.pendingRequests.set(a,new Map),this.pendingRequests.get(a).set(e,!0),this.updateRemainingTileCount(),l.push(p))}}if(l.length){const e=l.sort(((e,t)=>{const i=r.x-e.x,n=r.y-e.y,o=r.x-t.x,s=r.y-t.y;return i*i+n*n-(o*o+s*s)})).map((e=>e.encode()));s?this.backendService.setChannels(t,i,n,{fileId:t,compressionQuality:o,compressionType:Nt.CompressionType.ZFP,tiles:e}):this.backendService.addRequiredTiles(t,e,o)}else this.completedChannels.set(a,!0),this.tileStream.next({tileCount:0,fileId:t,channel:i,stokes:n,flush:!1})}updateHiddenFileChannels(e,t,i){this.clearCompressedCache(e),this.clearGPUCache(e),this.channelMap.set(e,{channel:t,stokes:i}),this.backendService.setChannels(e,t,i,{})}clearGPUCache(e){const t=this.cachedTiles.capacity,i=[],n=[];for(const[r,o]of this.cachedTiles)wi.GetFileId(r)===e?this.clearTile(o,r):(i.push(r),n.push(o));this.cachedTiles=new cx.a(Float64Array,null,t);for(let r=i.length-1;r>=0;r--)this.cachedTiles.set(i[r],n[r])}clearCompressedCache(e){-1===e?this.cacheMapCompressedTiles.clear():this.cacheMapCompressedTiles.delete(e)}clearRequestQueue(e){if(void 0!==e){const t=`${e}`;this.pendingRequests.forEach(((e,i)=>{i.startsWith(t)&&e.clear()}))}else this.pendingRequests.clear();this.updateRemainingTileCount()}handleFileClosed(e){this.clearCompressedCache(e),this.clearGPUCache(e),this.channelMap.delete(e);const t=`${e}`;this.completedChannels.forEach(((e,i)=>{i.startsWith(t)&&this.completedChannels.delete(i)})),this.pendingDecompressions.forEach(((e,i)=>{i.startsWith(t)&&this.pendingDecompressions.delete(i)}))}initTextures(){console.log(`Creating ${this.textureArray.length} tile textures of size 64 MB each (${64*this.textureArray.length} MB total)`);for(let e=0;e<this.textureArray.length;e++)this.textureArray[e]=Tm(this.gl,px,px,vm.TEXTURE0)}uploadTileToGPU(e){const t=this.getTileTextureParameters(e);var i,n,r,o,s,a,l,c;i=this.gl,n=t.texture,r=e.data,o=vm.TEXTURE0,s=e.width,a=e.height,l=t.offset.x,c=t.offset.y,i&&(i.bindTexture(vm.TEXTURE_2D,n),i.activeTexture(o),i.texSubImage2D(vm.TEXTURE_2D,0,l,c,s,a,vm.RED,vm.FLOAT,r),i.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,vm.NEAREST),i.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,vm.NEAREST),i.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_S,vm.CLAMP_TO_EDGE),i.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_WRAP_T,vm.CLAMP_TO_EDGE))}getTileTextureParameters(e){const t=16777216/(hx*hx),i=e.textureCoordinate%t,n=Math.floor((e.textureCoordinate-i)/t),r=px/hx,o=i%r*hx,s=Math.floor(i/r)*hx;return{texture:this.textureArray[n],offset:{x:o,y:s}}}asyncDecompressTile(e,t,i,n,r,o){const s=n.imageData,a=this.compressionRequestCounter%this.workers.length,l=new Int32Array(n.nanEncodings.slice(0).buffer);let c=new Uint8Array(Math.max(s.byteLength,n.width*n.height*4));c.set(s);const d=`${e}_${i}_${t}`,p=this.pendingDecompressions.get(d);if(!p)return void console.warn("Problem decompressing tile!");p.set(o,!0);const h={fileId:e,channel:t,stokes:i,width:n.width,subsetHeight:n.height,subsetLength:s.byteLength,compression:r,nanEncodings:l,tileCoordinate:o,layer:n.layer,requestId:this.compressionRequestCounter};this.workers[a].postMessage(["decompress",c.buffer,h],[c.buffer,l.buffer]),this.compressionRequestCounter++}updateStream(e,t,i,n,r,o,s,a){const l=`${e}_${i}_${t}`,c=this.pendingDecompressions.get(l);if(!c)return void console.warn(`Problem decompressing tile. Missing pending decompression map ${l}!`);const d=this.pendingSynchronisedTiles.get(l);if(this.animationEnabled||(null===d||void 0===d?void 0:d.length)){d&&this.pendingSynchronisedTiles.set(l,d.filter((e=>e!==a)));const s={width:r,height:o,textureCoordinate:-1,data:n};let p=this.receivedSynchronisedTiles.get(l);if(p||(p=[],this.receivedSynchronisedTiles.set(l,p)),p.push({coordinate:a,tile:s}),c.delete(a),!c.size&&this.completedChannels.get(l)){this.completedChannels.delete(l),this.pendingDecompressions.delete(l);const n=p.length;this.clearGPUCache(e),this.animationEnabled&&this.clearCompressedCache(e);for(const t of p){t.tile.textureCoordinate=this.textureCoordinateQueue.pop();const i=wi.AddFileId(t.coordinate,e),n=this.cachedTiles.setpop(i,t.tile);n&&this.clearTile(n.value,n.key)}this.receivedSynchronisedTiles.set(l,p),this.tileStream.next({tileCount:n,fileId:e,channel:t,stokes:i,flush:!0})}}else{const s={width:r,height:o,textureCoordinate:0,data:n},l=wi.AddFileId(a,e),d=this.cachedTiles.setpop(l,s);d&&this.clearTile(d.value,d.key),s.textureCoordinate=this.textureCoordinateQueue.pop(),c.delete(a),this.tileStream.next({tileCount:1,fileId:e,channel:t,stokes:i,flush:!1})}}},sx.staticInstance=void 0,ix=ax,nx=Object(b.a)(ix.prototype,"remainingTiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rx=Object(b.a)(ix.prototype,"workersReady",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(ix.prototype,"zfpReady",[m.i],Object.getOwnPropertyDescriptor(ix.prototype,"zfpReady"),ix.prototype),Object(b.a)(ix.prototype,"setWorkerReady",[m.g],Object.getOwnPropertyDescriptor(ix.prototype,"setWorkerReady"),ix.prototype),ox=Object(b.a)(ix.prototype,"updateRemainingTileCount",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e=0;this.pendingRequests.forEach((t=>e+=t.size)),this.remainingTiles=e}}}),ix);var gx="precision highp usampler2D;\nprecision highp int;\nprecision highp float;\n\nvec2 rotate2D(vec2 vector, float theta) {\n    float sinTheta = sin(theta);\n    float cosTheta = cos(theta);\n    return mat2(cosTheta, -sinTheta, sinTheta, cosTheta) * vector;\n}\n\nvec2 scaleAndRotate2D(vec2 vector, float theta, float scale) {\n    return rotate2D(vector, theta) * scale;\n}\n\nvec2 imageToGL(vec2 imageVec) {\n    return 2.0 * imageVec - 1.0;\n}\n\n// Adapted from https://www.shadertoy.com/view/MllSzX to work with non-square vec4 textures of variable size\nvec4 cubic(vec4 A, vec4 B, vec4 C, vec4 D, float t) {\n    float t2 = t * t;\n    float t3 = t * t * t;\n    vec4 a = -A / 2.0 + (3.0 * B) / 2.0 - (3.0 * C) / 2.0 + D / 2.0;\n    vec4 b = A - (5.0 * B) / 2.0 + 2.0 * C - D / 2.0;\n    vec4 c = -A / 2.0 + C / 2.0;\n    vec4 d = B;\n\n    return a * t3 + b * t2 + c * t + d;\n}\n\nvec4 bicubicFilter(sampler2D textureData, vec2 P, vec2 controlMapSize) {\n    // Calculate offset and base pixel coordiante\n    vec2 pixelSize = 1.0 / controlMapSize;\n    vec2 pixel = P * controlMapSize + 0.5;\n    vec2 frac = fract(pixel);\n    pixel = floor(pixel) / controlMapSize - pixelSize / 2.0;\n\n    // Texture lookups\n    vec4 C00 = texture(textureData, pixel + pixelSize * vec2(-1.0, -1.0));\n    vec4 C10 = texture(textureData, pixel + pixelSize * vec2(0.0, -1.0));\n    vec4 C20 = texture(textureData, pixel + pixelSize * vec2(1.0, -1.0));\n    vec4 C30 = texture(textureData, pixel + pixelSize * vec2(2.0, -1.0));\n\n    vec4 C01 = texture(textureData, pixel + pixelSize * vec2(-1.0, 0.0));\n    vec4 C11 = texture(textureData, pixel + pixelSize * vec2(0.0, 0.0));\n    vec4 C21 = texture(textureData, pixel + pixelSize * vec2(1.0, 0.0));\n    vec4 C31 = texture(textureData, pixel + pixelSize * vec2(2.0, 0.0));\n\n    vec4 C02 = texture(textureData, pixel + pixelSize * vec2(-1.0, 1.0));\n    vec4 C12 = texture(textureData, pixel + pixelSize * vec2(0.0, 1.0));\n    vec4 C22 = texture(textureData, pixel + pixelSize * vec2(1.0, 1.0));\n    vec4 C32 = texture(textureData, pixel + pixelSize * vec2(2.0, 1.0));\n\n    vec4 C03 = texture(textureData, pixel + pixelSize * vec2(-1.0, 2.0));\n    vec4 C13 = texture(textureData, pixel + pixelSize * vec2(0.0, 2.0));\n    vec4 C23 = texture(textureData, pixel + pixelSize * vec2(1.0, 2.0));\n    vec4 C33 = texture(textureData, pixel + pixelSize * vec2(2.0, 2.0));\n\n    // Cubic along x\n    vec4 CP0X = cubic(C00, C10, C20, C30, frac.x);\n    vec4 CP1X = cubic(C01, C11, C21, C31, frac.x);\n    vec4 CP2X = cubic(C02, C12, C22, C32, frac.x);\n    vec4 CP3X = cubic(C03, C13, C23, C33, frac.x);\n\n    // Final cubic along y\n    return cubic(CP0X, CP1X, CP2X, CP3X, frac.y);\n}\n// end adapted from https://www.shadertoy.com/view/MllSzX\n\nvec2 controlMapLookup(sampler2D controlMapTexture, vec2 pos, vec2 controlMapSize, vec2 controlMapMin, vec2 controlMapMax) {\n    vec2 texScale = 1.0 / controlMapSize;\n    vec2 range = controlMapMax - controlMapMin;\n    vec2 shiftedPoint = pos - controlMapMin;\n    vec2 index = shiftedPoint / range + 0.5 / controlMapSize;\n    return bicubicFilter(controlMapTexture, index, controlMapSize).rg;\n}\n\nvec4 getValueByIndexFromTexture(sampler2D texture, int index) {\n    ivec2 size = textureSize(texture, 0);\n    int row = index / size.x;\n    int col = index - row * size.x;\n    return texelFetch(texture, ivec2(col, row), 0);\n}\n\nuvec4 getValueByIndexFromTextureU(usampler2D texture, int index) {\n    ivec2 size = textureSize(texture, 0);\n    int row = index / size.x;\n    int col = index - row * size.x;\n    return texelFetch(texture, ivec2(col, row), 0);\n}\n";const fx={vertexShader:`#version 300 es\n${gx}\nprecision highp float;\n\n//Data from buffers\nin vec3 aVertexPosition;\nin vec2 aVertexNormal;\n\nuniform vec2 uRangeScale;\nuniform vec2 uRangeOffset;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\nuniform float uLineThickness;\nuniform float uPixelRatio;\n\n// Control-map based transformation\nuniform int uControlMapEnabled;\nuniform vec2 uControlMapMin;\nuniform vec2 uControlMapMax;\nuniform vec2 uControlMapSize;\nuniform highp sampler2D uControlMapTexture;\n\nout float vLinePosition;\nout float vLineSide;\n\nvoid main(void) {\n\n    // Shift by half a pixel to account for position of pixel center\n    vec2 posImageSpace = aVertexPosition.xy - 0.5;\n\n    // Calculate extrusion vector and distance\n    vec2 extrudeOffet = vec2(1.0 / uPixelRatio, 1.0) * (aVertexNormal / 16384.0) * uLineThickness * 0.5;\n    float extrudeDistance = length(extrudeOffet);\n\n    // If there's a control map, use it to look up location using bilinear filtering\n    if (uControlMapEnabled > 0) {\n        // Use an offset of 10% of the grid spacing to estimate the direction of the normal\n        vec2 deltaVec = 0.1 * (uControlMapMax - uControlMapMin) / uControlMapSize;\n        // Use a minimum of 10% in X and 10% in Y directions\n        float delta = min(deltaVec.x, deltaVec.y);\n        vec2 extrudedPoint = controlMapLookup(uControlMapTexture, posImageSpace + normalize(extrudeOffet) * delta, uControlMapSize, uControlMapMin, uControlMapMax);\n        posImageSpace = controlMapLookup(uControlMapTexture, posImageSpace, uControlMapSize, uControlMapMin, uControlMapMax);\n        vec2 transformedNormal = extrudedPoint - posImageSpace;\n        // Ensure consistent extrusion distance\n        posImageSpace += extrudeDistance * normalize(transformedNormal);\n    } else {\n        // Extrude point along normal\n        posImageSpace += extrudeOffet;\n    }\n\n    // Scale and rotate\n    vec2 posRefSpace = scaleAndRotate2D(posImageSpace, uRotationAngle, uScaleAdjustment);\n    // Convert from image space to GL space [-1, 1]\n    vec2 adjustedPosition = (posRefSpace * uRangeScale + uRangeOffset) * 2.0 - 1.0;\n\n    vLineSide = sign(aVertexPosition.z);\n    vLinePosition = abs(aVertexPosition.z);\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, 0.0, 1.0);\n}`,fragmentShader:"#version 300 es\nprecision highp float;\n\nin float vLinePosition;\nin float vLineSide;\nout vec4 outColor;\n\nuniform float uDashLength;\nuniform vec4 uLineColor;\nuniform int uCmapEnabled;\n\nuniform sampler2D uCmapTexture;\nuniform float uCmapValue;\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform float uBias;\nuniform float uContrast;\n\nvoid main(void) {\n    float dashStrength;\n    // Modulate dash strength based on dash length and line position\n    if (uDashLength > 1e-3) {\n        float dashRepeatLength = 2.0 * uDashLength;\n        dashStrength = mod(vLinePosition, dashRepeatLength) / dashRepeatLength <= 0.75 ? 1.0: 0.0;\n        if (dashStrength == 0.0) {\n            discard;\n        }\n    }\n    else {\n        dashStrength = 1.0;\n    }\n\n    vec4 color;\n    if (uCmapEnabled > 0) {\n        // bias mod\n        float x = clamp(uCmapValue - uBias, 0.0, 1.0);\n        // contrast mod\n        x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n        float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n        vec2 cmapCoords = vec2(x, cmapYVal);\n        color = texture(uCmapTexture, cmapCoords);\n    } else {\n        color = uLineColor;\n    }\n\n    outColor = dashStrength * color;\n}"};const bx="\n#define BOX_FILLED 0\n#define BOX_LINED 1\n#define CIRCLE_FILLED 2\n#define CIRCLE_LINED 3\n#define HEXAGON_FILLED 4\n#define HEXAGON_LINED 5\n#define RHOMB_FILLED 6\n#define RHOMB_LINED 7\n#define TRIANGLE_FILLED_UP 8\n#define TRIANGLE_LINED_UP 9\n#define ELLIPSE_FILLED 10\n#define ELLIPSE_LINED 11\n#define TRIANGLE_FILLED_DOWN 12\n#define TRIANGLE_LINED_DOWN 13\n#define HEXAGON_FILLED_2 14\n#define HEXAGON_LINED_2 15\n#define CROSS_FILLED 16\n#define CROSS_LINED 17\n#define X_FILLED 18\n#define X_LINED 19\n#define LineSegment_FILLED 20\n",mx={vertexShader:`#version 300 es\n${bx}\n\n#define PI radians(180.0)\n#define SQRT3 sqrt(3.0)\n#define SIN_60 0.86602540378\n\n#define LINEAR 0\n#define LOG 1\n#define SQRT 2\n#define SQUARE 3\n#define POWER 4\n#define GAMMA 5\n\n${gx}\nprecision highp float;\nprecision highp int;\n\nuniform sampler2D uCmapTexture;\nuniform highp sampler2D uControlMapTexture;\nuniform sampler2D uSizeTexture;\nuniform sampler2D uColorTexture;\nuniform sampler2D uOrientationTexture;\nuniform usampler2D uSelectedSourceTexture;\nuniform sampler2D uSizeMinorTexture;\n\nuniform vec2 uFrameViewMin;\nuniform vec2 uFrameViewMax;\nuniform vec3 uPointColor;\nuniform int uShapeType;\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform float uFeatherWidth;\nuniform float uPointSize;\nuniform bool uSizeMajorMapEnabled;\nuniform bool uAreaMode;\nuniform bool uShowSelectedSource;\nuniform bool uSizeMinorMapEnabled;\nuniform bool uAreaModeMinor;\nuniform bool uCmapEnabled;\nuniform bool uOmapEnabled;\n\nuniform float uRotationAngle;\nuniform vec2 uRangeOffset;\nuniform vec2 uRangeScale;\nuniform float uScaleAdjustment;\n\n// Control-map based transformation\nuniform int uControlMapEnabled;\nuniform vec2 uControlMapMin;\nuniform vec2 uControlMapMax;\nuniform vec2 uControlMapSize;\nuniform float uLineThickness;\nuniform float uPixelRatio;\n\nin vec4 a_position;\nout vec3 v_colour;\nout float v_pointSize;\nout float v_orientation;\nout float v_selected;\nout float v_minorSize;\nout float v_featherWidth;\n\n\nfloat getSquareSideByArea(float area, float minorSize) {\n    if (uShapeType == BOX_FILLED || uShapeType == BOX_LINED || uShapeType == RHOMB_FILLED || uShapeType == RHOMB_LINED || uShapeType == CROSS_FILLED || uShapeType == CROSS_LINED || uShapeType == X_FILLED || uShapeType == X_LINED || uShapeType == LineSegment_FILLED) {\n        return sqrt(area);\n    } else if (uShapeType == CIRCLE_FILLED || uShapeType == CIRCLE_LINED) {\n        return sqrt(area / PI) * 2.0;\n    } else if (uShapeType == HEXAGON_FILLED || uShapeType == HEXAGON_LINED || uShapeType == HEXAGON_FILLED_2 || uShapeType == HEXAGON_LINED_2) {\n        return sqrt((2.0 * area) / (3.0 * SQRT3)) * SIN_60 * 2.0;\n    } else if (uShapeType == TRIANGLE_FILLED_UP || uShapeType == TRIANGLE_LINED_UP || uShapeType == TRIANGLE_FILLED_DOWN || uShapeType == TRIANGLE_LINED_DOWN) {\n        return sqrt(area * 4.0 / SQRT3);\n    } else if (uShapeType == ELLIPSE_FILLED || uShapeType == ELLIPSE_LINED) {\n        float side = sqrt(area / PI) * 2.0;\n        if (minorSize >= 0.0 && area < minorSize) {\n            side = sqrt(minorSize / PI) * 2.0;\n        }   \n        return side;\n    } else {\n        return 0.0;\n    }\n}\n\nbool isNaN(float val) {\n    return isnan(val) || isinf(val);\n}\n\nvoid main() {\n    uvec4 selectedSource = getValueByIndexFromTextureU(uSelectedSourceTexture, gl_VertexID);\n    // Scale and rotate\n    vec2 posImageSpace = vec2(a_position.x,a_position.y);\n\n    if (uControlMapEnabled > 0) {\n        posImageSpace = controlMapLookup(uControlMapTexture, posImageSpace, uControlMapSize, uControlMapMin, uControlMapMax);\n    }\n\n    vec2 pos = rotate2D(posImageSpace, uRotationAngle) * uScaleAdjustment * uRangeScale + uRangeOffset;\n\n    gl_Position = vec4(imageToGL(pos), 0.5, 1.0);\n\n    v_colour = uPointColor;\n    v_orientation = 0.0;\n    v_minorSize = -1.0;\n    v_selected = float(selectedSource.x);\n    v_pointSize = uPointSize;\n    v_featherWidth = uFeatherWidth;\n\n    if (uCmapEnabled) {\n        vec4 color = getValueByIndexFromTexture(uColorTexture, gl_VertexID);\n        float x = clamp(color.x, 0.0, 1.0);\n        float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n        vec2 cmapCoords = vec2(x, cmapYVal);\n        v_colour = texture(uCmapTexture, cmapCoords).xyz;\n    }\n\n    if (uOmapEnabled) {\n        vec4 orientation = getValueByIndexFromTexture(uOrientationTexture, gl_VertexID);\n        if (!isNaN(orientation.x)) {\n            v_orientation = orientation.x;\n        }\n    }\n\n    if (uSizeMajorMapEnabled) {\n        vec4 sizeMajor = getValueByIndexFromTexture(uSizeTexture, gl_VertexID);\n        float size = sizeMajor.x;\n        if(!isNaN(size)) {\n            v_pointSize = size;\n        }\n    }\n\n    if (uAreaMode) {\n        v_pointSize = getSquareSideByArea(v_pointSize, v_minorSize);\n    }\n\n    if (uShowSelectedSource) {\n        if (v_selected == 1.0) {\n            gl_PointSize = v_pointSize + v_featherWidth;\n        } else {\n            gl_PointSize = 0.0;\n        }\n    } else {\n        gl_PointSize = v_pointSize + v_featherWidth;\n    }\n\n    if (uSizeMinorMapEnabled) {\n        vec4 sizeMinor = getValueByIndexFromTexture(uSizeMinorTexture, gl_VertexID);\n        v_minorSize = sizeMinor.x;\n        if (uAreaModeMinor) {\n            v_minorSize = getSquareSideByArea(v_pointSize, v_minorSize);\n        }\n        if (v_pointSize < v_minorSize) {\n            gl_PointSize = v_minorSize + v_featherWidth;\n        }\n    }\n\n    if (uShapeType == ELLIPSE_LINED) {\n        v_featherWidth = v_pointSize / 50.0 * 15.0 + 0.7;\n    }\n}`,fragmentShader:`#version 300 es\n${bx}\n\n#define SIN_0 0.0\n#define COS_0 1.0\n#define COS_45 0.70710678118\n#define SIN_60 0.86602540378\n#define COS_60 0.5\n#define SIN_90 1.0\n#define COS_90 0.0\n\nprecision highp float;\nprecision highp int;\n\n#define SIN_0 0.0\n#define COS_0 1.0\n#define COS_45 0.70710678118\n#define SIN_60 0.86602540378\n#define COS_60 0.5\n#define SIN_90 1.0\n#define COS_90 0.0\n\nuniform float uLineThickness;\nuniform int uShapeType;\nuniform vec3 uSelectedSourceColor;\nuniform bool uOmapEnabled;\n\nin vec3 v_colour;\nin float v_pointSize;\nin float v_orientation;\nin float v_selected;\nin float v_minorSize;\nin float v_featherWidth;\nout vec4 outColor;\n\nmat2 rot45 = mat2(COS_45, -COS_45, COS_45, COS_45);\nmat2 rot60 = mat2(COS_60, -SIN_60, SIN_60, COS_60);\nmat2 rot90 = mat2(COS_90, -SIN_90, SIN_90, COS_90);\nmat2 rot120 = mat2(-COS_60, -SIN_60, SIN_60, -COS_60);\nmat2 rot180 = mat2(-COS_0, SIN_0, -SIN_0, -COS_0);\n\nmat2 rotateMat(float deg) {\n    float rads = radians(deg);\n    float cosRads = cos(rads);\n    float sinRads = sin(rads);\n    return mat2(cosRads, -sinRads, sinRads, cosRads);\n}\n\n// Circle\nfloat featherRange(vec2 a, float rMax) {\n    float r = length(a);\n    float v = (rMax - r - v_featherWidth) / (2.0 * v_featherWidth);\n    return smoothstep(0.0, 1.0, v);\n}\n\nfloat featherRange(vec2 a, float rMin, float rMax) {\n    float r = length(a);\n    vec2 v = (vec2(rMax, rMin) - r - v_featherWidth) / (2.0 * v_featherWidth);\n    vec2 alpha = smoothstep(0.0, 1.0, v);\n    // subtract inner feathered circle\n    return (alpha.x) * (1.0 - alpha.y);\n}\n\n// Ellipse\nfloat featherRangeEllipse(vec2 r, float rMax) {\n    float v = ((pow(rMax, 2.0) - pow(r.x, 2.0) * 3.0) - v_featherWidth - pow(r.y, 2.0)) / (2.0 * v_featherWidth);\n    return smoothstep(0.0, 1.0, v);\n}\n\nfloat featherRangeEllipse(vec2 r, float rMin, float rMax) {\n    vec2 p = vec2(2.0, 2.0);\n    vec2 bb = pow(vec2(rMax, rMin), p);\n    vec2 aa = bb / 3.0;\n    float featherWidth = 6.0 * v_featherWidth;\n    if (v_minorSize >= 0.0) {\n        float rMaxMinor = v_minorSize * 0.5;\n        float rMinMinor = rMaxMinor - uLineThickness;\n        if(v_selected == 1.0){\n            rMaxMinor = rMaxMinor - uLineThickness * 0.5;\n            rMinMinor = rMinMinor - uLineThickness * 0.7;\n        }\n        aa = pow(vec2(rMaxMinor, rMinMinor), p);\n        if (aa.x > bb.x) {\n            featherWidth = 0.5 * featherWidth;\n        }\n    }\n    vec2 v = ((1.0 - pow(r.x, 2.0) / aa) * bb - pow(r.y, 2.0) - v_featherWidth) / featherWidth;\n    vec2 alpha = smoothstep(0.0, 1.0, v);\n    return alpha.x * (1.0 - alpha.y);\n}\n\n// Rhomb\nfloat featherRangeRhomb(vec2 r, float rMax) {\n    float v = (rMax - abs(r.x) - v_featherWidth - abs(r.y)) / (2.0 * v_featherWidth);\n    return smoothstep(0.0, 1.0, v);\n}\n\nfloat featherRangeRhomb(vec2 r, float rMin, float rMax) {\n    float v = (rMax - abs(r.x) - v_featherWidth - abs(r.y)) / (2.0 * v_featherWidth);\n    float v2 = (rMin - abs(r.x) - v_featherWidth - abs(r.y)) / (2.0 * v_featherWidth);\n    float alpha = smoothstep(0.0, 1.0, v);\n    float alpha2 = smoothstep(0.0, 1.0, v2);\n    return alpha * (1.0 - alpha2);\n}\n\n// Square\nfloat featherRangeSquare(vec2 r, float rMax) {\n    r*= rot45;\n    return featherRangeRhomb(r, rMax);\n}\n\nfloat featherRangeSquare(vec2 r, float rMin, float rMax) {\n    r*= rot45;\n    return featherRangeRhomb(r, rMin, rMax);\n}\n\n// Hexagon\n// Calculates the minimum distance to a hexagon of a given radius\nfloat distHex(vec2 r, float radius) {\n    float height = radius * SIN_60;\n    // Compare two sides at a time\n    float dist = max(r.y - height, -height - r.y);\n    for (int i = 0; i < 2; i++) {\n        // Rotate by 60 degrees\n        r*= rot60;\n        float currentDist = max(r.y - height, -height - r.y);\n        dist = max(dist, currentDist);\n    }\n    return dist;\n}\n\nvec2 distHex(vec2 r, vec2 radius) {\n    vec2 height = radius * SIN_60;\n    // Compare two sides at a time\n    vec2 dist = max(r.y - height, -height - r.y);\n    for (int i = 0; i < 2; i++) {\n        // Rotate by 60 degrees\n        r*= rot60;\n        vec2 currentDist = max(r.y - height, -height - r.y);\n        dist = max(dist, currentDist);\n    }\n    return dist;\n}\n\nvec2 distHexSelected(vec2 radius) {\n    float dist = radius.x;\n    for (int i = 0; i < 2; i++) {\n        radius*= rot60;\n        float currentDist = radius.x;\n        dist = max(dist, currentDist);\n    }\n    return vec2(dist, dist);\n}\n\nfloat featherRangeHex(vec2 r, float rMax) {\n    float maxDist = distHex(r, rMax);\n    float v = (v_featherWidth - maxDist) / (2.0 * v_featherWidth);\n    return smoothstep(0.0, 1.0, v);\n}\n\nfloat featherRangeHex(vec2 r, float rMin, float rMax) {\n    vec2 maxDist = distHex(r, vec2(rMax, rMin));\n    vec2 v = (v_featherWidth - maxDist) / (2.0 * v_featherWidth);\n    vec2 alpha = smoothstep(0.0, 1.0, v);\n    return alpha.x * (1.0 - alpha.y);\n}\n\n// Hexagon 2\nfloat featherRangeHex2(vec2 r, float rMax) {\n    r*= rot90;\n    return featherRangeHex(r, rMax);\n}\n\nfloat featherRangeHex2(vec2 r, float rMin, float rMax) {\n    r*= rot90;\n    return featherRangeHex(r, rMin, rMax);\n}\n\n// Triangle Down\nfloat distTriangleDown(vec2 r, float radius) {\n    float height = radius * COS_60;\n    float dist = r.y - height;\n    for (int i = 0; i < 2; i++) {\n        r*= rot120;\n        float currentDist = r.y - height;\n        dist = max(dist, currentDist);\n    }\n    return dist;\n}\n\nvec2 distTriangleDown(vec2 r, vec2 radius) {\n    vec2 height = radius * COS_60;\n    vec2 dist = r.y - height;\n    for (int i = 0; i < 2; i++) {\n        r*= rot120;\n        vec2 currentDist = r.y - height;\n        dist = max(dist, currentDist);\n    }\n    return dist;\n}\n\nvec2 distTriangleSelected(vec2 radius) {\n    float dist = radius.x;\n    for (int i = 0; i < 2; i++) {\n        radius*= rot120;\n        float currentDist = radius.x;\n        dist = max(dist, currentDist);\n    }\n    return vec2(dist, dist);\n}\n\nfloat featherRangeTriangleDown(vec2 r, float rMax) {\n    float maxDist = distTriangleDown(r, rMax);\n    float v = (v_featherWidth - maxDist) / (2.0 * v_featherWidth);\n    return smoothstep(0.0, 1.0, v);\n}\n\nfloat featherRangeTriangleDown(vec2 r, float rMin, float rMax) {\n    vec2 maxDist = distTriangleDown(r, vec2(rMax, rMin));\n    vec2 v = (v_featherWidth - maxDist) / (2.0 * v_featherWidth);\n    vec2 alpha = smoothstep(0.0, 1.0, v);\n    return alpha.x * (1.0 - alpha.y);\n}\n\n// Triangle Up\nfloat featherRangeTriangleUp(vec2 r, float rMax) {\n    r*= rot180;\n    return featherRangeTriangleDown(r, rMax);\n}\n\nfloat featherRangeTriangleUp(vec2 r, float rMin, float rMax) {\n    r*= rot180;\n    return featherRangeTriangleDown(r, rMin, rMax);\n}\n\n// Cross\nfloat featherRangeCross(vec2 r, float rMin, float rMax) {\n    float lineThickness = (rMax - rMin) * 0.5;\n    if(r.y > -lineThickness && r.y < lineThickness){\n        float v = (lineThickness + v_featherWidth - abs(r.y)) / (2.0 * v_featherWidth);\n        float v2 = (rMax - lineThickness - v_featherWidth - abs(r.x)) / (2.0 * v_featherWidth);\n        float alpha = smoothstep(0.0, 1.0, v);\n        float alpha2 = smoothstep(0.0, 1.0, v2);\n        return alpha * alpha2;\n    }\n    if(r.x > -lineThickness && r.x < lineThickness){\n        float v = (lineThickness + v_featherWidth - abs(r.x)) / (2.0 * v_featherWidth);\n        float v2 = (rMax - lineThickness - v_featherWidth - abs(r.y)) / (2.0 * v_featherWidth);\n        float alpha3 = smoothstep(0.0, 1.0, v);\n        float alpha4 = smoothstep(0.0, 1.0, v2);\n        return alpha3 * alpha4;\n    }\n    return 0.0;\n}\n\nfloat featherRangeCrossLined(vec2 r, float rMin, float rMax) {\n    float lineThicknessMin = uLineThickness * 0.5;\n    float lineThicknessMax = uLineThickness;\n    if(rMax > length(r)) {\n        if((abs(r.y) < lineThicknessMax && abs(r.y) > lineThicknessMin) && (r.x < -lineThicknessMin || r.x > lineThicknessMin)) {\n            return 1.0;\n        }\n\n        if(abs(r.y) < uLineThickness && abs(r.x) > rMin && abs(r.x) < rMax) {\n            return 1.0;\n        }\n\n        if((abs(r.x) < lineThicknessMax && abs(r.x) > lineThicknessMin) && (r.y < -lineThicknessMin || r.y > lineThicknessMin)) {\n            return 1.0;\n        }\n\n        if(abs(r.x) < uLineThickness && abs(r.y) > rMin && abs(r.y) < rMax) {\n            return 1.0;\n        }\n    }\n    \n    return 0.0;\n}\n\n// X\nfloat featherRangeX(vec2 r, float rMin, float rMax) {\n    r*= rot45;\n    return featherRangeCross(r, rMin, rMax);\n}\n\nfloat featherRangeXLined(vec2 r, float rMin, float rMax) {\n    r*= rot45;\n    return featherRangeCrossLined(r, rMin, rMax);\n}\n\n// Line Segment\nfloat featherLineSegment(vec2 r, float rMin, float rMax) {\n    float lineThickness = (rMax - rMin) * 0.5;\n    float v = (lineThickness + v_featherWidth - abs(r.x)) / (2.0 * v_featherWidth);\n    float v2 = (rMax - lineThickness - v_featherWidth - abs(r.y)) / (2.0 * v_featherWidth);\n    float alpha = smoothstep(0.0, 1.0, v);\n    float alpha2 = smoothstep(0.0, 1.0, v2);\n    return alpha * alpha2;\n}\n\nfloat featherLineSegmentLined(vec2 r, float rMin, float rMax) {\n    if(rMax > abs(r.y)) {\n        if(abs(r.x) < uLineThickness && abs(r.x) > uLineThickness * 0.4) {\n            return 1.0;\n        }\n\n        if(abs(r.x) < uLineThickness && abs(r.y) > rMin && abs(r.y) < rMax) {\n            return 1.0;\n        }\n    }\n    return 0.0;\n}\n\nfloat drawOutline(vec2 posPixelSpace, float borderWidth, float rMin, float rMax) {\n    vec2 pos = vec2(0.0, 0.0);\n    vec2 pos2 = vec2(0.0, 0.0);\n    if (uShapeType == BOX_FILLED || uShapeType == BOX_LINED){\n        pos = rMin + borderWidth - abs(posPixelSpace * rot45);\n        return step(length(pos), length(posPixelSpace * rot45));\n    } else if (uShapeType == RHOMB_FILLED || uShapeType == RHOMB_LINED) {\n        pos = rMin + borderWidth - abs(posPixelSpace);\n        return step(length(pos), length(posPixelSpace));\n    } else if (uShapeType == CIRCLE_FILLED || uShapeType == CIRCLE_LINED) {\n        return step(rMin + borderWidth, length(posPixelSpace));\n    } else if (uShapeType == ELLIPSE_FILLED || uShapeType == ELLIPSE_LINED) { \n        float bb = pow(rMin + borderWidth, 2.0);\n        float aa = bb / 3.0;\n        if (v_minorSize >= 0.0) {\n            float rMinMinor = v_minorSize * 0.5 - 2.0 * uLineThickness + borderWidth;\n            aa = pow(rMinMinor, 2.0);\n            pos.y = (1.0 - pow(posPixelSpace.x, 2.0) / aa) * bb;\n        } else {\n            pos.y = (1.0 - pow(posPixelSpace.x, 2.0) / aa) * bb;\n        }\n        pos.x = posPixelSpace.x * posPixelSpace.x;\n        return step(pos.x + pos.y, pos.x + posPixelSpace.y * posPixelSpace.y);\n    } else if (uShapeType == HEXAGON_FILLED || uShapeType == HEXAGON_LINED) {\n        pos = rMin + borderWidth - distHexSelected(vec2(rMin, rMin));\n        pos2 = distHex(posPixelSpace, vec2(rMin, rMin));\n        return step(length(pos), length(pos2));\n    } else if (uShapeType == HEXAGON_FILLED_2 || uShapeType == HEXAGON_LINED_2) {\n        pos = rMin + borderWidth - distHexSelected(vec2(rMin, rMin));\n        pos2 = distHex(posPixelSpace * rot90, vec2(rMin, rMin));\n        return step(length(pos), length(pos2));\n    } else if (uShapeType == TRIANGLE_FILLED_DOWN || uShapeType == TRIANGLE_LINED_DOWN) {\n        pos = rMin + borderWidth - distTriangleSelected(vec2(rMin, rMin));\n        pos2 = distTriangleDown(posPixelSpace, vec2(rMin, rMin));\n        return step(length(pos), length(pos2));\n    } else if (uShapeType == TRIANGLE_FILLED_UP || uShapeType == TRIANGLE_LINED_UP) {\n        pos = rMin + borderWidth - distTriangleSelected(vec2(rMin, rMin));\n        pos2 = distTriangleDown(posPixelSpace * rot180, vec2(rMin, rMin));\n        return step(length(pos), length(pos2));\n    } else if (uShapeType == CROSS_FILLED || uShapeType == CROSS_LINED) {\n        return featherRangeCrossLined(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == X_FILLED) {\n        return featherRangeCrossLined(posPixelSpace * rot45, rMin, rMax);\n    } else if (uShapeType == LineSegment_FILLED) {\n        return featherLineSegmentLined(posPixelSpace, rMin, rMax);\n    } else {\n        return 0.0;\n    }\n}\n\nfloat getAlphaValue(vec2 posPixelSpace, float rMin, float rMax) {\n    if (uShapeType == BOX_FILLED) {\n        return featherRangeSquare(posPixelSpace, rMax);\n    } else if (uShapeType == BOX_LINED) {\n        return featherRangeSquare(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == CIRCLE_FILLED) {\n        return featherRange(posPixelSpace, rMax);\n    } else if (uShapeType == CIRCLE_LINED) {\n        return featherRange(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == HEXAGON_FILLED) {\n        return featherRangeHex(posPixelSpace, rMax);\n    } else if (uShapeType == HEXAGON_LINED) {\n        return featherRangeHex(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == RHOMB_FILLED) {\n        return featherRangeRhomb(posPixelSpace, rMax);\n    } else if (uShapeType == RHOMB_LINED) {\n        return featherRangeRhomb(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == TRIANGLE_FILLED_UP) {\n        return featherRangeTriangleUp(posPixelSpace, rMax);\n    } else if (uShapeType == TRIANGLE_LINED_UP) {\n        return featherRangeTriangleUp(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == ELLIPSE_FILLED) {\n        return featherRangeEllipse(posPixelSpace, rMax);\n    } else if (uShapeType == ELLIPSE_LINED) {\n        return featherRangeEllipse(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == TRIANGLE_FILLED_DOWN) {\n        return featherRangeTriangleDown(posPixelSpace, rMax);\n    } else if (uShapeType == TRIANGLE_LINED_DOWN) {\n        return featherRangeTriangleDown(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == HEXAGON_FILLED_2) {\n        return featherRangeHex2(posPixelSpace, rMax);\n    } else if (uShapeType == HEXAGON_LINED_2) {\n        return featherRangeHex2(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == CROSS_FILLED) {\n        return featherRangeCross(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == CROSS_LINED) {\n        return featherRangeCrossLined(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == X_FILLED) {\n        return featherRangeX(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == X_LINED) {\n        return featherRangeXLined(posPixelSpace, rMin, rMax);\n    } else if (uShapeType == LineSegment_FILLED) {\n        return featherLineSegment(posPixelSpace, rMin, rMax);\n    } else {\n        return 0.0;\n    }\n}\n\nvoid main() {\n    float side = v_pointSize;\n    if (v_minorSize > v_pointSize) {\n        side = v_minorSize;\n    }\n    vec2 posPixelSpace = (0.5 - gl_PointCoord) * (side + v_featherWidth);\n    float rMax = v_pointSize * 0.5;\n    float rMin = rMax - uLineThickness;\n    float outline = 0.0;\n    float alpha2 = 0.0;\n    // orientation\n    if(uOmapEnabled){\n        posPixelSpace*= rotateMat(v_orientation);\n    }\n\n    // highlight selected source\n    gl_FragDepth = 0.5;\n    if(v_selected == 1.0){\n        rMax = rMax - uLineThickness;\n        rMin = rMin - uLineThickness;\n        float borderWidth = uLineThickness * 0.5;\n        outline = drawOutline(posPixelSpace, borderWidth, rMin, rMax);\n        alpha2 = getAlphaValue(posPixelSpace, rMin, rMax + uLineThickness);\n        if(outline > 0.5 && alpha2 == 1.0) {\n            gl_FragDepth = 0.0;\n        } \n    }\n    float alpha = getAlphaValue(posPixelSpace, rMin, rMax);\n\n    // Blending\n    outColor = (1.0 - outline) * vec4(v_colour, alpha) + outline * vec4(uSelectedSourceColor, alpha2);\n}`};const yx={vertexShader:`#version 300 es\n${gx}\nprecision highp float;\n\n//Data from bufferData\nin vec3 aVertexPosition;\nin vec2 aVertexUV;\nout vec2 vUV;\nuniform float uCanvasWidth;\nuniform float uCanvasHeight;\nuniform vec2 uRotationOrigin;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\nuniform float uPixelAspectRatio;\n\n// Tiling parameters\nuniform vec2 uTileSize;\nuniform vec2 uTileScaling;\nuniform vec2 uTileOffset;\nuniform float uTileTextureSize;\n\nvec2 rotateAboutPoint2D(vec2 vector, vec2 origin, float theta) {\n    return rotate2D(vector - origin, theta) + origin;\n}\n\nvec2 scaleAboutPoint2D(vec2 vector, vec2 origin, float scale) {\n    return (vector - origin) * scale + origin;\n}\n\nvoid main(void) {\n    vec2 tilePosition = aVertexPosition.xy * uTileScaling * uTileSize + uTileOffset;\n    tilePosition = rotateAboutPoint2D(tilePosition, uRotationOrigin, uRotationAngle);\n    // adjust based on pixel scales\n    tilePosition = scaleAboutPoint2D(tilePosition, uRotationOrigin, uScaleAdjustment);\n\n    // Handle pixel rounding while respecting pixel aspect ratios\n    vec2 roundingVector = vec2(1.0, 1.0);\n    if (uPixelAspectRatio > 1.0) {\n        roundingVector = vec2(uPixelAspectRatio, 1.0);\n    } else if (uPixelAspectRatio < 1.0) {\n        roundingVector = vec2(1.0, 1.0/uPixelAspectRatio);\n    }\n    tilePosition = floor(tilePosition * roundingVector) / roundingVector;\n\n    // convert XY from canvas space to [-1, 1]\n    vec2 adjustedPosition = vec2(tilePosition.x / (uCanvasWidth / uPixelAspectRatio), tilePosition.y / uCanvasHeight) * 2.0 - 1.0;\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, aVertexPosition.z, 1.0);\n    vUV = aVertexUV * uTileSize / uTileTextureSize;\n}`,fragmentShader:"#version 300 es\n\n#define LINEAR 0\n#define LOG 1\n#define SQRT 2\n#define SQUARE 3\n#define POWER 4\n#define GAMMA 5\n#define EXP 6\n#define CUSTOM 7\n#define FLT_MAX 3.402823466e+38\n\nprecision highp float;\n\nin vec2 vUV;\nout vec4 outColor;\n// Textures\nuniform sampler2D uDataTexture;\nuniform sampler2D uCmapTexture;\n// Render parameters\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform int uScaleType;\nuniform int uInverted;\nuniform int uUseSmoothedBiasContrast;\nuniform float uMinVal;\nuniform float uMaxVal;\nuniform float uPixelHighlightVal;\nuniform float uBias;\nuniform float uContrast;\nuniform float uGamma;\nuniform float uAlpha;\nuniform vec4 uNaNColor;\n\n// Tile texture parameters in pixels\nuniform float uTileBorder;\nuniform vec2 uTileTextureOffset;\nuniform float uTextureSize;\nuniform float uTileTextureSize;\n\n// Pixel grid\nuniform float uPixelGridCutoff;\nuniform vec4 uPixelGridColor;\nuniform float uPixelGridOpacity;\nuniform float uPixelAspectRatio;\n\n// Some shader compilers have trouble with NaN checks, so we instead use a dummy value of -FLT_MAX\nbool isNaN(float val) {\n    return val <= -FLT_MAX;\n}\n\nfloat errorFunction(float x, float c, float x0) {\n    float y = exp(c * (x - x0));\n    return y / (y + 1.0);\n}\n\nvoid main(void) {\n    // Tile border\n    if (uTileBorder > 0.0 && (vUV.x < uTileBorder || vUV.y < uTileBorder)) {\n        outColor = vec4(1.0, 1.0, 1.0, 1.0);\n        return;\n    }\n    vec2 texCoords;\n\n    // Mimics texel fetch in WebGL1\n    vec2 tileCoordsPixel = vUV * uTileTextureSize;\n    // Prevent edge artefacts\n    vec2 texCoordsPixel = clamp(tileCoordsPixel, 0.5, uTileTextureSize - 0.5) + uTileTextureOffset;\n    vec2 f = fract(tileCoordsPixel);\n\n    // Pixel grid: 1.1px feather on line width. 1.1 instead of 1.0 to reduce Moire effects\n    float edgeX = min(f.x, 1.0 - f.x);\n    float edgeY = min(f.y, 1.0 - f.y);\n    float featherWidth = 1.1;\n    float opA = smoothstep(uPixelGridCutoff * (1.0 + featherWidth / 2.0), uPixelGridCutoff * (1.0 - featherWidth / 2.0), edgeX * uPixelAspectRatio);\n    float opB = smoothstep(uPixelGridCutoff * (1.0 + featherWidth / 2.0), uPixelGridCutoff * (1.0 - featherWidth / 2.0), edgeY);\n    float gridOpacity = max(opA, opB) * uPixelGridOpacity;\n\n    texCoords = texCoordsPixel / uTextureSize;\n\n    float range = uMaxVal - uMinVal;\n    float rawVal = texture(uDataTexture, texCoords).r;\n\n    // Scaling types\n    // LINEAR (Default: uScaleType == LINEAR)\n    float x = clamp((rawVal - uMinVal) / range, 0.0, 1.0);\n    // Other scaling types\n    // normalized to [0, 1] for LOG and POWER, different from the scaling in ds9\n    if (uScaleType == SQUARE) {\n        x = x * x;\n    }\n    else if (uScaleType == SQRT) {\n        x = sqrt(x);\n    }\n    else if (uScaleType == LOG) {\n        x = log(uAlpha * x + 1.0) / log(uAlpha + 1.0);\n    }\n    else if (uScaleType == POWER) {\n        x = (pow(uAlpha, x) - 1.0) / (uAlpha - 1.0);\n    }\n    else if (uScaleType == GAMMA) {\n        x = pow(x, uGamma);\n    }\n\n    if (uUseSmoothedBiasContrast > 0) {\n        if (uContrast <= 1.0) {\n            float smoothedBias = 0.5 - uBias / 2.0; // [-1, 1] map to [1, 0]\n            x = clamp((x - smoothedBias) * uContrast + smoothedBias, 0.0, 1.0);\n        } else {\n            float smoothedBias = uBias / 2.0 + 0.5; // [-1, 1] map to [0, 1]\n            float smoothedContrast = uContrast < 1.0 ? 0.0 : uContrast - 1.0; // [1, 2] map to [0, 1]\n            smoothedContrast = (smoothedContrast == 0.0) ? 0.001 : smoothedContrast * 12.0;\n            float offset = errorFunction(0.0, smoothedContrast, smoothedBias);\n            float denominator = errorFunction(1.0, smoothedContrast, smoothedBias) - offset;\n            if (denominator <= 0.0) {\n                denominator = 0.1;\n            }\n            x = (errorFunction(x, smoothedContrast, smoothedBias) - offset) / denominator;\n        }\n    } else {\n        // bias mod\n        x = clamp(x - uBias, 0.0, 1.0);\n        // contrast mod\n        x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n    }\n    \n    // invert mod\n    if (uInverted > 0) {\n        x = 1.0 - x;\n    }\n\n    float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n    vec2 cmapCoords = vec2(x, cmapYVal);\n\n    // Apply pixel highlight\n    if (isNaN(rawVal)) {\n        outColor = uNaNColor * uNaNColor.a;\n    } else if (rawVal < uPixelHighlightVal) {\n        outColor = vec4(x, x, x, 1);\n    } else {\n        outColor = texture(uCmapTexture, cmapCoords);\n    }\n\n    // Apply pixel grid\n    outColor = mix(outColor, uPixelGridColor, gridOpacity);\n}"};const Ox={vertexShader:`#version 300 es\n\n#define PI radians(180.0)\n\n\n#define SQRT3 sqrt(3.0)\n#define SIN_60 0.86602540378\n\n${gx}\nprecision highp float;\n\nuniform vec2 uRangeScale;\nuniform vec2 uRangeOffset;\nuniform float uRotationOffset;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\nuniform float uZoomLevel;\nuniform float uCanvasSpaceLineWidth;\nuniform float uFeatherWidth;\nuniform sampler2D uDataTexture;\nuniform bool uIntensityPlot;\n\n// Length scaling\nuniform float uLengthMin;\nuniform float uLengthMax;\nuniform float uIntensityMin;\nuniform float uIntensityMax;\n\n// Control-map based transformation\nuniform int uControlMapEnabled;\nuniform vec2 uControlMapMin;\nuniform vec2 uControlMapMax;\nuniform vec2 uControlMapSize;\nuniform highp sampler2D uControlMapTexture;\n\n// Color\nuniform vec4 uLineColor;\nuniform int uCmapEnabled;\nuniform sampler2D uCmapTexture;\nuniform float uCmapValue;\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform float uBias;\nuniform float uContrast;\n\nout vec4 v_colour;\nout vec2 v_location;\nout float v_length;\n\n#define PI radians(180.0)\n\nfloat calculateScaledIntensity(float intensity) {\n    float intensityRange = uIntensityMax - uIntensityMin;\n    float scaledIntensity = (intensity - uIntensityMin) / intensityRange;\n    return scaledIntensity;\n}\nfloat calculateLength(float intensity) {\n    return mix(uLengthMin, uLengthMax, clamp(calculateScaledIntensity(intensity), 0.0, 1.0));\n}\n\n// Get vertex offset in units of length, based on the vertex ID\nvec2 getOffsetFromId(int id) {\n    int index = id % 6;\n    switch(index) {\n        // First triangle is TRC, TLC, BRC\n        case 0:\n        return vec2(0.5, 0.5);\n        case 1:\n        return vec2(-0.5, 0.5);\n        case 2:\n        return vec2(0.5, -0.5);\n        // Second triangle is BRC, TLC, BLC\n        case 3:\n        return vec2(0.5, -0.5);\n        case 4:\n        return vec2(-0.5, 0.5);\n        case 5:\n        default:\n        return vec2(-0.5, -0.5);\n    }\n}\n\nvoid main() {\n    int dataPointIndex = gl_VertexID / 6;\n    vec4 data = getValueByIndexFromTexture(uDataTexture, dataPointIndex);\n    vec2 centerPoint = data.xy;\n\n    if (uControlMapEnabled > 0) {\n        centerPoint = controlMapLookup(uControlMapTexture, centerPoint, uControlMapSize, uControlMapMin, uControlMapMax);\n    }\n\n    float lineLength = calculateLength(data.z) / (uZoomLevel * uScaleAdjustment);\n    float lineWidth = uCanvasSpaceLineWidth / (uZoomLevel * uScaleAdjustment);\n    float angle = -data.w * PI / 180.0 - uRotationAngle - uRotationOffset;\n\n    if (uIntensityPlot) {\n        angle = -uRotationAngle;\n        lineWidth = lineLength;\n    }\n\n    vec2 offset = getOffsetFromId(gl_VertexID);\n    offset = vec2((lineWidth + uFeatherWidth / uZoomLevel) * offset.x, (lineLength + uFeatherWidth / uZoomLevel) * offset.y);\n    // location vertex attribute is in line space before rotation\n    v_location = offset;\n    // position is in canvas space\n    // Scale and rotate\n    vec2 posImageSpace = centerPoint + rotate2D(offset, angle);\n    vec2 posRefSpace = scaleAndRotate2D(posImageSpace, uRotationAngle, uScaleAdjustment);\n    // Convert from image space to GL space [-1, 1]\n    vec2 adjustedPosition = (posRefSpace * uRangeScale + uRangeOffset) * 2.0 - 1.0;\n\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, 0, 1);\n    v_length = lineLength;\n\n    if (uCmapEnabled > 0) {\n        float x = calculateScaledIntensity(data.z);\n        // bias mod\n        x = clamp(x - uBias, 0.0, 1.0);\n        // contrast mod\n        x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n        float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n        vec2 cmapCoords = vec2(x, cmapYVal);\n        v_colour = texture(uCmapTexture, cmapCoords);\n    } else {\n        v_colour = uLineColor;\n    }\n\n    if (lineLength <= 0.0) {\n        gl_Position = vec4(0);\n    }\n\n}`,fragmentShader:"#version 300 es\n\n#define PI radians(180.0)\n\n\n#define SIN_0 0.0\n#define COS_0 1.0\n#define COS_45 0.70710678118\n#define SIN_60 0.86602540378\n#define COS_60 0.5\n#define SIN_90 1.0\n#define COS_90 0.0\n\nprecision highp float;\n\nuniform float uZoomLevel;\nuniform float uCanvasSpaceLineWidth;\nuniform float uFeatherWidth;\nuniform bool uIntensityPlot;\n\nin vec4 v_colour;\nin vec2 v_location;\nin float v_length;\n\nout vec4 outColor;\n\nvoid main() {\n    float W = uIntensityPlot ? v_length : uCanvasSpaceLineWidth / uZoomLevel;\n    float L = v_length;\n    float F = uFeatherWidth;\n    float x = abs(v_location.x);\n    float y = abs(v_location.y);\n    float alphaX, alphaY;\n    if (x < 0.5 * W - F) {\n        alphaX = 1.0;\n    } else {\n        alphaX = 1.0 - smoothstep(x, 0.5 * W - F, 0.5 * W + F);\n    }\n\n    if (y < 0.5 * L - F) {\n        alphaY = 1.0;\n    } else {\n        alphaY = 1.0 - smoothstep(y, 0.5 * L - F, 0.5 * L + F);\n    }\n\n    float alpha = alphaX * alphaY;\n    outColor = vec4(v_colour.rgb, v_colour.a * alpha);\n}"};class jx{static get Instance(){return jx.staticInstance||(jx.staticInstance=new jx),jx.staticInstance}initShaders(){this.gl&&(this.shaderProgram=Im(this.gl,yx.vertexShader,yx.fragmentShader),this.gl.useProgram(this.shaderProgram),this.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),this.vertexUVAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexUV"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.gl.enableVertexAttribArray(this.vertexUVAttribute),this.shaderUniforms={MinVal:this.gl.getUniformLocation(this.shaderProgram,"uMinVal"),MaxVal:this.gl.getUniformLocation(this.shaderProgram,"uMaxVal"),PixelHighlightVal:this.gl.getUniformLocation(this.shaderProgram,"uPixelHighlightVal"),NaNColor:this.gl.getUniformLocation(this.shaderProgram,"uNaNColor"),Bias:this.gl.getUniformLocation(this.shaderProgram,"uBias"),Contrast:this.gl.getUniformLocation(this.shaderProgram,"uContrast"),UseSmoothedBiasContrast:this.gl.getUniformLocation(this.shaderProgram,"uUseSmoothedBiasContrast"),Gamma:this.gl.getUniformLocation(this.shaderProgram,"uGamma"),Alpha:this.gl.getUniformLocation(this.shaderProgram,"uAlpha"),ScaleType:this.gl.getUniformLocation(this.shaderProgram,"uScaleType"),Inverted:this.gl.getUniformLocation(this.shaderProgram,"uInverted"),DataTexture:this.gl.getUniformLocation(this.shaderProgram,"uDataTexture"),CmapTexture:this.gl.getUniformLocation(this.shaderProgram,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(this.shaderProgram,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(this.shaderProgram,"uCmapIndex"),CanvasWidth:this.gl.getUniformLocation(this.shaderProgram,"uCanvasWidth"),CanvasHeight:this.gl.getUniformLocation(this.shaderProgram,"uCanvasHeight"),ScaleAdjustment:this.gl.getUniformLocation(this.shaderProgram,"uScaleAdjustment"),RotationOrigin:this.gl.getUniformLocation(this.shaderProgram,"uRotationOrigin"),RotationAngle:this.gl.getUniformLocation(this.shaderProgram,"uRotationAngle"),TileSize:this.gl.getUniformLocation(this.shaderProgram,"uTileSize"),TileScaling:this.gl.getUniformLocation(this.shaderProgram,"uTileScaling"),TileOffset:this.gl.getUniformLocation(this.shaderProgram,"uTileOffset"),TileTextureOffset:this.gl.getUniformLocation(this.shaderProgram,"uTileTextureOffset"),TextureSize:this.gl.getUniformLocation(this.shaderProgram,"uTextureSize"),TileTextureSize:this.gl.getUniformLocation(this.shaderProgram,"uTileTextureSize"),TileBorder:this.gl.getUniformLocation(this.shaderProgram,"uTileBorder"),PixelGridCutoff:this.gl.getUniformLocation(this.shaderProgram,"uPixelGridCutoff"),PixelGridColor:this.gl.getUniformLocation(this.shaderProgram,"uPixelGridColor"),PixelGridOpacity:this.gl.getUniformLocation(this.shaderProgram,"uPixelGridOpacity"),PixelAspectRatio:this.gl.getUniformLocation(this.shaderProgram,"uPixelAspectRatio")},this.gl.uniform1i(this.shaderUniforms.DataTexture,0),this.gl.uniform1i(this.shaderUniforms.CmapTexture,1),this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapIndex,2),this.gl.uniform1f(this.shaderUniforms.MinVal,3.4),this.gl.uniform1f(this.shaderUniforms.MaxVal,5.5),this.gl.uniform1f(this.shaderUniforms.Bias,0),this.gl.uniform1f(this.shaderUniforms.Contrast,1),this.gl.uniform1i(this.shaderUniforms.UseSmoothedBiasContrast,1),this.gl.uniform1f(this.shaderUniforms.Gamma,1),this.gl.uniform1f(this.shaderUniforms.Alpha,1e3),this.gl.uniform1i(this.shaderUniforms.Inverted,0),this.gl.uniform1f(this.shaderUniforms.TileBorder,0/hx),this.gl.uniform2f(this.shaderUniforms.TileSize,1,1),this.gl.uniform2f(this.shaderUniforms.TileScaling,1,1),this.gl.uniform2f(this.shaderUniforms.TileOffset,0,0),this.gl.uniform2f(this.shaderUniforms.TileTextureOffset,0,0),this.gl.uniform1f(this.shaderUniforms.TextureSize,px),this.gl.uniform1f(this.shaderUniforms.TileTextureSize,hx),this.gl.uniform4f(this.shaderUniforms.NaNColor,0,0,1,1),this.gl.uniform1f(this.shaderUniforms.PixelGridCutoff,0),this.gl.uniform4f(this.shaderUniforms.PixelGridColor,1,1,1,1),this.gl.uniform1f(this.shaderUniforms.PixelGridOpacity,0),this.gl.uniform1f(this.shaderUniforms.PixelAspectRatio,1))}initBuffers(){if(!this.gl)return;this.vertexPositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(vm.ARRAY_BUFFER,this.vertexPositionBuffer);const e=new Float32Array([0,0,0,1,0,0,0,1,0,1,1,0]);this.gl.bufferData(vm.ARRAY_BUFFER,e,vm.STATIC_DRAW),this.vertexUVBuffer=this.gl.createBuffer(),this.gl.bindBuffer(vm.ARRAY_BUFFER,this.vertexUVBuffer);const t=new Float32Array([0,0,1,0,0,1,1,1]);this.gl.bufferData(vm.ARRAY_BUFFER,t,vm.STATIC_DRAW)}constructor(){this.gl=void 0,this.cmapTexture=void 0,this.vertexPositionBuffer=void 0,this.vertexUVBuffer=void 0,this.vertexPositionAttribute=void 0,this.vertexUVAttribute=void 0,this.shaderProgram=void 0,this.shaderUniforms=void 0,this.setCanvasSize=(e,t)=>{!this.gl||this.gl.canvas.width===e&&this.gl.canvas.height===t||(this.gl.canvas.width=e,this.gl.canvas.height=t)},this.gl=Rm(),this.gl&&(this.initShaders(),this.initBuffers(),wm(this.gl,D,vm.TEXTURE1).then((e=>{this.cmapTexture=e})))}}jx.staticInstance=void 0;class xx{static get Instance(){return xx.staticInstance||(xx.staticInstance=new xx),xx.staticInstance}initShaders(){if(!this.gl)return;const e=Im(this.gl,fx.vertexShader,fx.fragmentShader);this.gl.useProgram(e),this.vertexPositionAttribute=this.gl.getAttribLocation(e,"aVertexPosition"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexNormalAttribute=this.gl.getAttribLocation(e,"aVertexNormal"),this.gl.enableVertexAttribArray(this.vertexNormalAttribute),this.shaderUniforms={RangeScale:this.gl.getUniformLocation(e,"uRangeScale"),RangeOffset:this.gl.getUniformLocation(e,"uRangeOffset"),ScaleAdjustment:this.gl.getUniformLocation(e,"uScaleAdjustment"),RotationAngle:this.gl.getUniformLocation(e,"uRotationAngle"),DashLength:this.gl.getUniformLocation(e,"uDashLength"),LineColor:this.gl.getUniformLocation(e,"uLineColor"),LineThickness:this.gl.getUniformLocation(e,"uLineThickness"),PixelRatio:this.gl.getUniformLocation(e,"uPixelRatio"),CmapEnabled:this.gl.getUniformLocation(e,"uCmapEnabled"),CmapValue:this.gl.getUniformLocation(e,"uCmapValue"),CmapTexture:this.gl.getUniformLocation(e,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(e,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(e,"uCmapIndex"),Contrast:this.gl.getUniformLocation(e,"uContrast"),Bias:this.gl.getUniformLocation(e,"uBias"),ControlMapEnabled:this.gl.getUniformLocation(e,"uControlMapEnabled"),ControlMapSize:this.gl.getUniformLocation(e,"uControlMapSize"),ControlMapMin:this.gl.getUniformLocation(e,"uControlMapMin"),ControlMapMax:this.gl.getUniformLocation(e,"uControlMapMax"),ControlMapTexture:this.gl.getUniformLocation(e,"uControlMapTexture")},this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapTexture,0)}constructor(){this.cmapTexture=void 0,this.gl=void 0,this.shaderUniforms=void 0,this.vertexPositionAttribute=void 0,this.vertexNormalAttribute=void 0,this.setCanvasSize=(e,t)=>{!this.gl||this.gl.canvas.width===e&&this.gl.canvas.height===t||(this.gl.canvas.width=e,this.gl.canvas.height=t)},this.gl=Rm(),this.gl&&(this.initShaders(),wm(this.gl,D,vm.TEXTURE0).then((e=>{this.cmapTexture=e})))}}xx.staticInstance=void 0;class Sx{static get Instance(){return Sx.staticInstance||(Sx.staticInstance=new Sx),Sx.staticInstance}initShaders(){if(!this.gl)return;const e=Im(this.gl,Ox.vertexShader,Ox.fragmentShader);this.gl.useProgram(e),this.shaderUniforms={DataTexture:this.gl.getUniformLocation(e,"uDataTexture"),RangeScale:this.gl.getUniformLocation(e,"uRangeScale"),RangeOffset:this.gl.getUniformLocation(e,"uRangeOffset"),RotationOffset:this.gl.getUniformLocation(e,"uRotationOffset"),ScaleAdjustment:this.gl.getUniformLocation(e,"uScaleAdjustment"),RotationAngle:this.gl.getUniformLocation(e,"uRotationAngle"),ZoomLevel:this.gl.getUniformLocation(e,"uZoomLevel"),CanvasSpaceLineWidth:this.gl.getUniformLocation(e,"uCanvasSpaceLineWidth"),FeatherWidth:this.gl.getUniformLocation(e,"uFeatherWidth"),LengthMin:this.gl.getUniformLocation(e,"uLengthMin"),LengthMax:this.gl.getUniformLocation(e,"uLengthMax"),IntensityMin:this.gl.getUniformLocation(e,"uIntensityMin"),IntensityMax:this.gl.getUniformLocation(e,"uIntensityMax"),IntensityPlot:this.gl.getUniformLocation(e,"uIntensityPlot"),CmapEnabled:this.gl.getUniformLocation(e,"uCmapEnabled"),CmapTexture:this.gl.getUniformLocation(e,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(e,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(e,"uCmapIndex"),Contrast:this.gl.getUniformLocation(e,"uContrast"),Bias:this.gl.getUniformLocation(e,"uBias"),LineColor:this.gl.getUniformLocation(e,"uLineColor"),ControlMapEnabled:this.gl.getUniformLocation(e,"uControlMapEnabled"),ControlMapSize:this.gl.getUniformLocation(e,"uControlMapSize"),ControlMapMin:this.gl.getUniformLocation(e,"uControlMapMin"),ControlMapMax:this.gl.getUniformLocation(e,"uControlMapMax"),ControlMapTexture:this.gl.getUniformLocation(e,"uControlMapTexture")},this.gl.uniform1i(this.shaderUniforms.DataTexture,0),this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapTexture,2)}constructor(){this.gl=void 0,this.cmapTexture=void 0,this.shaderUniforms=void 0,this.setCanvasSize=(e,t)=>{!this.gl||this.gl.canvas.width===e&&this.gl.canvas.height===t||(this.gl.canvas.width=e,this.gl.canvas.height=t)},this.gl=Rm(),this.gl&&(this.initShaders(),wm(this.gl,D,vm.TEXTURE2).then((e=>{this.cmapTexture=e})))}}Sx.staticInstance=void 0;class vx{constructor(){this.target=void 0,this.action=void 0,this.parameters=void 0,this.valid=void 0,this.async=void 0,this.mapMacro=e=>{if("object"===typeof e&&e.macroVariable){const t=e.macroTarget?`${e.macroTarget}.${e.macroVariable}`:e.macroVariable;return vx.GetTargetObject(gC.Instance,t)}return e}}static FromString(e){const t=new vx;e=e.trim();const i=/^(\+?)((?:[\w[\]]+\.)*)(\w+)\(([^)]*)\);?$/gm.exec(e);return i&&5===i.length&&i[3].length?(t.async=i[1].length>0,i[2].length&&(t.target=i[2].substring(0,i[2].length-1)),t.action=i[3],t.valid=t.parseParameters(i[4],!0)):t.valid=!1,t}static FromScriptingRequest(e){const t=new vx;return t.async=e.async,t.target=e.target,t.action=e.action,t.valid=t.parseParameters(e.parameters,!1),t}parseParameters(e,t){if(!e)return this.parameters=[],!0;try{let i=e.replace(/\$((?:[\w[\]]+\.)*)([\w[\]]+)/gm,((e,t,i)=>`{"macroTarget": "${t.slice(0,-1)}", "macroVariable": "${i}"}`));t&&(i=`[${i}]`),this.parameters=JSON.parse(i)}catch(i){return console.log(i),!1}return!0}async execute(){const e=vx.GetTargetObject(gC.Instance,this.target);if(null==e)throw new Error(`Missing target object: ${this.target}`);const t=this.parameters.map(this.mapMacro);let i,n=e[this.action];if(!n||"function"!==typeof n)throw new Error(`Missing action function: ${this.action}`);return n=n.bind(e),i=this.async?n(...t):await n(...t),i}static GetTargetObject(e,t){if(!t)return e;let i=e;const n=t.split(".");console.log(n);for(const r of n){const e=/(\w+)(?:\[(\d+)])?/gm.exec(r);if(e&&3===e.length&&void 0!==e[2]){if(console.log(i),console.log(e),i=i[e[1]],null==i)return null;if(i instanceof Map){const t=JSON.parse(e[2]);i=i.get(t)}else{if(!Array.isArray(i))return null;i=i[e[2]]}}else i=i[r];if(null==i)return null}return i}}class Cx{constructor(){this.handleScriptingRequest=async e=>{const t=vx.FromScriptingRequest(e);if(!t.valid)return{scriptingRequestId:e.scriptingRequestId,success:!1,message:"Failed to parse scripting request"};try{let i;return i=t.async?t.execute():await t.execute(),"object"===typeof i&&e.returnPath&&(i=T.get(i,e.returnPath)),{scriptingRequestId:e.scriptingRequestId,success:!0,response:JSON.stringify(Object(m.u)(i))}}catch(i){return{scriptingRequestId:e.scriptingRequestId,success:!1,message:i}}},this.executeEntries=async e=>{if(e&&e.length)for(const i of e)try{if(i.async){const e=i.execute();console.log(e)}else{const e=await i.execute();console.log(e),await Cx.Delay(10)}}catch(t){console.log(t)}}}static get Instance(){return Cx.staticInstance||(Cx.staticInstance=new Cx),Cx.staticInstance}static Delay(e){return new Promise((t=>{setTimeout(t,e)}))}}let Ix,wx;Cx.staticInstance=void 0,function(e){e[e.Size=0]="Size",e[e.Color=1]="Color",e[e.Orientation=2]="Orientation",e[e.SelectedSource=3]="SelectedSource",e[e.SizeMinor=4]="SizeMinor"}(Ix||(Ix={}));class Tx{static get Instance(){return Tx.staticInstance||(Tx.staticInstance=new Tx),Tx.staticInstance}initShaders(){if(!this.gl)return;const e=Im(this.gl,mx.vertexShader,mx.fragmentShader);this.gl.useProgram(e),this.vertexPositionAttribute=this.gl.getAttribLocation(e,"a_position"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.shaderUniforms={LineThickness:this.gl.getUniformLocation(e,"uLineThickness"),FeatherWidth:this.gl.getUniformLocation(e,"uFeatherWidth"),ShapeType:this.gl.getUniformLocation(e,"uShapeType"),SelectedSourceColor:this.gl.getUniformLocation(e,"uSelectedSourceColor"),ShowSelectedSource:this.gl.getUniformLocation(e,"uShowSelectedSource"),PointColor:this.gl.getUniformLocation(e,"uPointColor"),PointSize:this.gl.getUniformLocation(e,"uPointSize"),CmapIndex:this.gl.getUniformLocation(e,"uCmapIndex"),NumCmaps:this.gl.getUniformLocation(e,"uNumCmaps"),AreaMode:this.gl.getUniformLocation(e,"uAreaMode"),AreaModeMinor:this.gl.getUniformLocation(e,"uAreaModeMinor"),SizeMajorMapEnabled:this.gl.getUniformLocation(e,"uSizeMajorMapEnabled"),SizeMinorMapEnabled:this.gl.getUniformLocation(e,"uSizeMinorMapEnabled"),OmapEnabled:this.gl.getUniformLocation(e,"uOmapEnabled"),CmapEnabled:this.gl.getUniformLocation(e,"uCmapEnabled"),RotationAngle:this.gl.getUniformLocation(e,"uRotationAngle"),RangeOffset:this.gl.getUniformLocation(e,"uRangeOffset"),RangeScale:this.gl.getUniformLocation(e,"uRangeScale"),ScaleAdjustment:this.gl.getUniformLocation(e,"uScaleAdjustment"),ControlMapEnabled:this.gl.getUniformLocation(e,"uControlMapEnabled"),ControlMapSize:this.gl.getUniformLocation(e,"uControlMapSize"),ControlMapMin:this.gl.getUniformLocation(e,"uControlMapMin"),ControlMapMax:this.gl.getUniformLocation(e,"uControlMapMax"),ControlMapTexture:this.gl.getUniformLocation(e,"uControlMapTexture"),CmapTexture:this.gl.getUniformLocation(e,"uCmapTexture"),OrientationTexture:this.gl.getUniformLocation(e,"uOrientationTexture"),SizeTexture:this.gl.getUniformLocation(e,"uSizeTexture"),ColorTexture:this.gl.getUniformLocation(e,"uColorTexture"),SelectedSourceTexture:this.gl.getUniformLocation(e,"uSelectedSourceTexture"),SizeMinorTexture:this.gl.getUniformLocation(e,"uSizeMinorTexture")},this.vertexBuffers=new Map,this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapTexture,0),this.selectedSourceTextures=new Map,this.orientationTextures=new Map,this.sizeTextures=new Map,this.colorTextures=new Map,this.sizeMinorTextures=new Map}constructor(){this.cmapTexture=void 0,this.vertexBuffers=void 0,this.sizeTextures=void 0,this.colorTextures=void 0,this.orientationTextures=void 0,this.selectedSourceTextures=void 0,this.sizeMinorTextures=void 0,this.gl=void 0,this.shaderUniforms=void 0,this.vertexPositionAttribute=void 0,this.setCanvasSize=(e,t)=>{this.gl&&(this.gl.canvas.width=e,this.gl.canvas.height=t,this.gl.viewport(0,0,e,t))},this.updateBuffer=(e,t,i)=>{const n=this.vertexBuffers.get(e);n?(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,n),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,4*i,t)):this.vertexBuffers.set(e,function(e,t,i){const n=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,t,i),n}(this.gl,t,this.gl.STATIC_DRAW))},this.bindBuffer=e=>{const t=this.vertexBuffers.get(e);return!(!this.vertexBuffers||!t)&&(this.gl.bindBuffer(vm.ARRAY_BUFFER,t),!0)},this.updateDataTexture=(e,t,i)=>{if(this.gl)switch(i){case Ix.Size:this.sizeTextures.set(e,Am(this.gl,t,vm.TEXTURE2,1));break;case Ix.Color:this.colorTextures.set(e,Am(this.gl,t,vm.TEXTURE3,1));break;case Ix.Orientation:this.orientationTextures.set(e,Am(this.gl,t,vm.TEXTURE4,1));break;case Ix.SelectedSource:this.selectedSourceTextures.set(e,Am(this.gl,t,vm.TEXTURE5,1));break;case Ix.SizeMinor:this.sizeMinorTextures.set(e,Am(this.gl,t,vm.TEXTURE6,1))}},this.getDataTexture=(e,t)=>{switch(t){case Ix.Size:return this.sizeTextures.get(e);case Ix.Color:return this.colorTextures.get(e);case Ix.Orientation:return this.orientationTextures.get(e);case Ix.SelectedSource:return this.selectedSourceTextures.get(e);case Ix.SizeMinor:return this.sizeMinorTextures.get(e);default:return}},this.clearTexture=e=>{this.selectedSourceTextures.delete(e),this.sizeTextures.delete(e),this.colorTextures.delete(e),this.orientationTextures.delete(e),this.sizeMinorTextures.delete(e),this.vertexBuffers.delete(e)},this.gl=Rm(),this.gl&&(this.initShaders(),wm(this.gl,D,vm.TEXTURE0).then((e=>{this.cmapTexture=e})))}}Tx.staticInstance=void 0,function(e){e.SIMBAD="SIMBAD",e.VIZIER="VizieR"}(wx||(wx={}));class Rx{static get Instance(){return Rx.staticInstance||(Rx.staticInstance=new Rx),Rx.staticInstance}constructor(){this.axiosInstanceSimbad=void 0,this.axiosInstanceVizier=void 0,this.cancelTokenSourceSimbad=void 0,this.cancelTokenSourceVizier=void 0,this.getSimbadCatalog=e=>this.axiosInstanceSimbad.get(`sync?request=doQuery&lang=adql&format=json&query=${e}`),this.queryVizierTableName=async(e,t,i,n)=>{let r=new Map,o=this.getRadiusUnits(i),s=`votable?-c=${e.x} ${e.y}&-c.eq=J2000&-c.${o}=${t}&-corr=pos&-out.meta=hud&-meta.all=1&-meta.max=100000`;n&&(s=`${s}&-words=${n}`);try{const e=await this.axiosInstanceVizier.get(s);200===(null===e||void 0===e?void 0:e.status)&&(null===e||void 0===e?void 0:e.data)&&(r=Xm.ProcessVizierData(e.data))}catch(l){a.a.isCancel(l)?(v.show(w(null===l||void 0===l?void 0:l.message)),Rx.Instance.resetCancelTokenSource(wx.VIZIER)):(null===l||void 0===l?void 0:l.message)?v.show(I(l.message)):console.log("Vizier Resource Error: "+l)}return r},this.queryVizierSource=async(e,t,i,n,r)=>{let o=new Map,s=this.getRadiusUnits(i),l="-source=";r.forEach((e=>{l+=`${e.table.name},`}));let c=`votable?${l}&-c=${e.x} ${e.y}&-c.eq=J2000&-c.${s}=${t}&-out.max=${n}&-sort=_r&-corr=pos&-out.add=_r,_RA,_DE&-oc.form=d&-out.meta=hud`;try{const e=await this.axiosInstanceVizier.get(c);200===(null===e||void 0===e?void 0:e.status)&&(null===e||void 0===e?void 0:e.data)&&(o=Xm.ProcessVizierData(e.data))}catch(d){a.a.isCancel(d)?(v.show(w(null===d||void 0===d?void 0:d.message)),Rx.Instance.resetCancelTokenSource(wx.VIZIER)):(null===d||void 0===d?void 0:d.message)?v.show(I(d.message)):console.log("VizieR Table Error: "+d)}return o},this.appendVizierCatalog=e=>{const t=gC.Instance;e.forEach((e=>{const i=t.catalogNextFileId,{headers:n,dataMap:r,size:o}=Xm.ProcessVizierTableData(e.table.tableElement),s=hD.Instance,a={system:e.coosys.system};let l={fileId:i,fileInfo:{name:`${s.catalogDB}_${e.coosys.system}_${e.table.name}_${s.searchRadius}${s.radiusUnits}`,type:Nt.CatalogFileType.VOTable,description:"Online VizieR Catalog",coosys:[a]},dataSize:o,directory:""};this.loadCatalog(i,l,n,r,Hn.VIZIER)}))},this.loadCatalog=(e,t,i,n,r)=>{const o=gC.Instance;Object(m.t)((()=>{const s=o.updateCatalogProfile(e,o.activeFrame);if(s){o.catalogStore.catalogWidgets.set(e,s),o.catalogStore.addCatalog(e,t.dataSize),o.fileBrowserStore.hideFileBrowser();const a=new Uk(t,i,n,r);o.catalogStore.catalogProfileStores.set(e,a),o.dialogStore.hideCatalogQueryDialog()}}))},this.appendSimbadCatalog=async e=>{const t=gC.Instance,i=t.activeFrame;if(!i)throw v.show(I("Please load the image file")),new Error("No image file");const n=t.catalogNextFileId;let r=0;try{var o,s,l,c;const t=await this.getSimbadCatalog(e);if(i&&200===(null===t||void 0===t?void 0:t.status)&&(null===t||void 0===t||null===(o=t.data)||void 0===o||null===(s=o.data)||void 0===s?void 0:s.length)){var d,p,h,u,g;const e=hD.Instance,i=Xm.ProcessSimbadMetaData(null===(d=t.data)||void 0===d?void 0:d.metadata),r=Xm.ProcessSimbadData(null===(p=t.data)||void 0===p?void 0:p.data,i),o={system:e.coordsType},s=e.convertToDeg(e.centerPixelCoordAsPoint2D,tA.ICRS),a=`${e.catalogDB}_${e.coordsType}_${s.x}_${s.y}_${e.searchRadius}${e.radiusUnits}`;let l={fileId:n,fileInfo:{name:a,type:Nt.CatalogFileType.VOTable,description:"Online Simbad Catalog",coosys:[o]},dataSize:null!==(h=null===(u=t.data)||void 0===u||null===(g=u.data)||void 0===g?void 0:g.length)&&void 0!==h?h:0,directory:""};this.loadCatalog(n,l,i,r,Hn.SIMBAD)}r=null===t||void 0===t||null===(l=t.data)||void 0===l||null===(c=l.data)||void 0===c?void 0:c.length}catch(f){a.a.isCancel(f)?(v.show(w(null===f||void 0===f?void 0:f.message)),Rx.Instance.resetCancelTokenSource(wx.SIMBAD)):(null===f||void 0===f?void 0:f.message)?v.show(I(f.message)):console.log("Append Simbad Error: "+f)}return r},this.cancelTokenSourceSimbad=a.a.CancelToken.source(),this.cancelTokenSourceVizier=a.a.CancelToken.source(),this.axiosInstanceSimbad=a.a.create({baseURL:Rx.DBMap.get(wx.SIMBAD).baseURL,cancelToken:this.cancelTokenSourceSimbad.token}),this.axiosInstanceVizier=a.a.create({baseURL:Rx.DBMap.get(wx.VIZIER).baseURL,cancelToken:this.cancelTokenSourceVizier.token})}cancleQuery(e){e===wx.SIMBAD?this.cancelTokenSourceSimbad.cancel("Simbad query canceled by the user."):e===wx.VIZIER&&this.cancelTokenSourceVizier.cancel("VizieR query canceled by the user.")}resetCancelTokenSource(e){e===wx.SIMBAD?(this.cancelTokenSourceSimbad=a.a.CancelToken.source(),this.axiosInstanceSimbad.defaults.cancelToken=this.cancelTokenSourceSimbad.token):e===wx.VIZIER&&(this.cancelTokenSourceVizier=a.a.CancelToken.source(),this.axiosInstanceVizier.defaults.cancelToken=this.cancelTokenSourceVizier.token)}getRadiusUnits(e){let t;switch(e){case pD.ARCMINUTES:t="rm";break;case pD.ARCSECONDS:t="rs";break;default:t="rd"}return t}}var Ax,Px,Ex,Mx,Fx,kx,Dx,Lx,Nx,_x,zx,Vx,Wx;let Gx;Rx.SimbadHyperLink={bibcode:"https://ui.adsabs.harvard.edu/abs/",mainId:"https://simbad.u-strasbg.fr/simbad/sim-id?Ident="},Rx.staticInstance=void 0,Rx.DBMap=new Map([[wx.SIMBAD,{baseURL:"https://simbad.u-strasbg.fr/simbad/sim-tap/"}],[wx.VIZIER,{baseURL:"https://vizier.u-strasbg.fr/viz-bin/"}]]),function(e){e[e.Info=0]="Info",e[e.Interactive=1]="Interactive",e[e.Retry=2]="Retry"}(Gx||(Gx={}));let Bx=(Wx=Vx=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"alertVisible",Px,this),Object(f.a)(this,"alertText",Ex,this),Object(f.a)(this,"alertIcon",Mx,this),Object(f.a)(this,"alertType",Fx,this),Object(f.a)(this,"interactiveAlertText",kx,this),this.interactionPromise=void 0,Object(f.a)(this,"showAlert",Dx,this),Object(f.a)(this,"dismissAlert",Lx,this),Object(f.a)(this,"showInteractiveAlert",Nx,this),Object(f.a)(this,"showRetryAlert",_x,this),Object(f.a)(this,"handleInteractiveAlertClosed",zx,this),Object(m.p)(this),this.alertVisible=!1}},Vx.staticInstance=void 0,Ax=Wx,Px=Object(b.a)(Ax.prototype,"alertVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ex=Object(b.a)(Ax.prototype,"alertText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mx=Object(b.a)(Ax.prototype,"alertIcon",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fx=Object(b.a)(Ax.prototype,"alertType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kx=Object(b.a)(Ax.prototype,"interactiveAlertText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dx=Object(b.a)(Ax.prototype,"showAlert",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.alertText=e,this.alertIcon=t,this.alertType=Gx.Info,this.alertVisible=!0}}}),Lx=Object(b.a)(Ax.prototype,"dismissAlert",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.alertVisible=!1}}}),Nx=Object(b.a)(Ax.prototype,"showInteractiveAlert",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>(this.interactiveAlertText=e,this.alertIcon=t,this.alertType=Gx.Interactive,this.alertVisible=!0,this.interactionPromise=new ex,this.interactionPromise.promise)}}),_x=Object(b.a)(Ax.prototype,"showRetryAlert",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>(this.interactiveAlertText=e,this.alertIcon=t,this.alertType=Gx.Retry,this.alertVisible=!0,this.interactionPromise=new ex,this.interactionPromise.promise)}}),zx=Object(b.a)(Ax.prototype,"handleInteractiveAlertClosed",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.alertVisible=!1,this.interactionPromise&&(this.interactionPromise.resolve(e),this.interactionPromise=null)}}}),Ax);var qx,Hx,Yx,Ux,Xx,$x,Kx,Qx,Zx,Jx,eS,tS,iS,nS,rS,oS,sS,aS;let lS,cS;!function(e){e[e.CHANNEL=0]="CHANNEL",e[e.STOKES=1]="STOKES",e[e.FRAME=2]="FRAME"}(lS||(lS={})),function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD",e[e.BOUNCING=2]="BOUNCING",e[e.BLINK=3]="BLINK"}(cS||(cS={}));let dS=(aS=sS=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"frameRate",Hx,this),Object(f.a)(this,"maxFrameRate",Yx,this),Object(f.a)(this,"minFrameRate",Ux,this),Object(f.a)(this,"step",Xx,this),Object(f.a)(this,"maxStep",$x,this),Object(f.a)(this,"minStep",Kx,this),Object(f.a)(this,"animationMode",Qx,this),Object(f.a)(this,"animationActive",Zx,this),Object(f.a)(this,"playMode",Jx,this),Object(f.a)(this,"setAnimationMode",eS,this),Object(f.a)(this,"setFrameRate",tS,this),Object(f.a)(this,"setStep",iS,this),Object(f.a)(this,"startAnimation",nS,this),Object(f.a)(this,"stopAnimation",rS,this),Object(f.a)(this,"animate",oS,this),this.animateHandle=void 0,this.stopHandle=void 0,this.genAnimationFrames=e=>{if(!e)return null;let t,i,n,r={channel:e.channel,stokes:e.requiredPolarizationIndex};switch(this.animationMode===lS.CHANNEL?(t={channel:e.animationChannelRange[0],stokes:e.stokes},i={channel:e.animationChannelRange[1],stokes:e.stokes},n={channel:this.step,stokes:0}):this.animationMode===lS.STOKES&&(t={channel:e.channel,stokes:0},i={channel:e.channel,stokes:e.polarizations.length-1},n={channel:0,stokes:this.step}),this.playMode){case cS.FORWARD:case cS.BOUNCING:default:this.animationMode===lS.CHANNEL?(r.channel<t.channel||r.channel>i.channel)&&(r.channel=t.channel):this.animationMode===lS.STOKES&&(r.stokes<t.stokes||r.stokes>i.stokes)&&(r.stokes=t.stokes);break;case cS.BACKWARD:this.animationMode===lS.CHANNEL?((r.channel<t.channel||r.channel>i.channel)&&(r.channel=i.channel),n.channel=-1*this.step):this.animationMode===lS.STOKES&&((r.stokes<t.stokes||r.stokes>i.stokes)&&(r.stokes=i.stokes),n.stokes=-1*this.step);break;case cS.BLINK:this.animationMode===lS.CHANNEL?r.channel=t.channel:this.animationMode===lS.STOKES&&(r.stokes=t.stokes),this.animationMode===lS.CHANNEL?n.channel=Math.abs(t.channel-i.channel):this.animationMode===lS.STOKES&&(n.stokes=Math.abs(t.stokes-i.stokes))}return{startFrame:r,firstFrame:t,lastFrame:i,deltaFrame:n}},Object(m.p)(this),this.frameRate=5,this.maxFrameRate=15,this.minFrameRate=1,this.step=1,this.maxStep=50,this.minStep=1,this.animationMode=lS.CHANNEL,this.animationActive=!1,this.animateHandle=null,this.playMode=cS.FORWARD}get frameInterval(){return 1e3/Gi(this.frameRate,this.minFrameRate,this.maxFrameRate)}get serverAnimationActive(){return this.animationActive&&this.animationMode!==lS.FRAME}},sS.staticInstance=void 0,qx=aS,Hx=Object(b.a)(qx.prototype,"frameRate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yx=Object(b.a)(qx.prototype,"maxFrameRate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ux=Object(b.a)(qx.prototype,"minFrameRate",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xx=Object(b.a)(qx.prototype,"step",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$x=Object(b.a)(qx.prototype,"maxStep",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kx=Object(b.a)(qx.prototype,"minStep",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qx=Object(b.a)(qx.prototype,"animationMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zx=Object(b.a)(qx.prototype,"animationActive",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jx=Object(b.a)(qx.prototype,"playMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eS=Object(b.a)(qx.prototype,"setAnimationMode",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.animationActive||(this.animationMode=e)}}}),tS=Object(b.a)(qx.prototype,"setFrameRate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.frameRate=e}}}),iS=Object(b.a)(qx.prototype,"setStep",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.step=e}}}),nS=Object(b.a)(qx.prototype,"startAnimation",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{const e=gC.Instance,t=JA.Instance,i=e.activeFrame;if(!i)return;if(this.animationMode===lS.FRAME)return clearInterval(this.animateHandle),this.animationActive=!0,this.animate(),void(this.animateHandle=setInterval(this.animate,this.frameInterval));const n=this.genAnimationFrames(i);if(!n)return;const r=i.requiredFrameView,o=jm({xMin:Math.max(0,r.xMin),xMax:Math.min(i.frameInfo.fileInfoExtended.width,r.xMax),yMin:Math.max(0,r.yMin),yMax:Math.min(i.frameInfo.fileInfoExtended.height,r.yMax),mip:r.mip},{x:i.frameInfo.fileInfoExtended.width,y:i.frameInfo.fileInfoExtended.height},{x:256,y:256}).map((e=>e.encode())),s={fileId:i.frameInfo.fileId,tiles:o,compressionType:Nt.CompressionType.ZFP,compressionQuality:t.animationCompressionQuality},a=new Map;for(const d of i.spectralSiblings){const e=Nm(i.wcsInfo3D,d.wcsInfo3D,t.spectralMatchingType,n.firstFrame.channel,n.lastFrame.channel);a.set(d.frameInfo.fileId,{frameNumbers:e})}const l={fileId:i.frameInfo.fileId,startFrame:n.startFrame,firstFrame:n.firstFrame,lastFrame:n.lastFrame,deltaFrame:n.deltaFrame,requiredTiles:s,looping:!0,reverse:this.playMode===cS.BOUNCING,frameRate:this.frameRate,matchedFrames:rn(a),stokesIndices:i.polarizations.map(((e,t)=>t<i.frameInfo.fileInfoExtended.stokes&&t>=0?t:e))};this.animationActive=!0;try{await e.backendService.startAnimation(l),e.tileService.setAnimationEnabled(!0),console.log("Animation started successfully")}catch(c){console.log(c),e.tileService.setAnimationEnabled(!1)}clearTimeout(this.stopHandle),this.stopHandle=setTimeout(this.stopAnimation,6e4*t.stopAnimationPlaybackMinutes)}}}),rS=Object(b.a)(qx.prototype,"stopAnimation",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(!this.animationActive)return;const e=gC.Instance,t=e.activeFrame;if(t)if(this.animationActive=!1,e.tileService.setAnimationEnabled(!1),this.animationMode===lS.FRAME)clearInterval(this.animateHandle);else{const i={channel:t.channel,stokes:t.stokes},n={fileId:t.frameInfo.fileId,endFrame:i};e.backendService.stopAnimation(n),t.setChannels(t.channel,t.stokes,!0);const r=[{frame:t,channel:t.requiredChannel,stokes:t.requiredStokes}];t.spectralSiblings.forEach((e=>{r.push({frame:e,channel:e.requiredChannel,stokes:e.requiredStokes})})),e.updateChannels(r)}}}}),oS=Object(b.a)(qx.prototype,"animate",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.animationActive&&this.animationMode===lS.FRAME&&gC.Instance.nextFrame()}}}),Object(b.a)(qx.prototype,"frameInterval",[m.i],Object.getOwnPropertyDescriptor(qx.prototype,"frameInterval"),qx.prototype),Object(b.a)(qx.prototype,"serverAnimationActive",[m.i],Object.getOwnPropertyDescriptor(qx.prototype,"serverAnimationActive"),qx.prototype),qx);var pS=i(437),hS=i(5),uS=i(27);var gS,fS,bS,mS,yS,OS,jS,xS,SS,vS,CS,IS,wS,TS,RS,AS,PS,ES,MS,FS,kS,DS,LS,NS,_S,zS,VS,WS,GS,BS,qS,HS,YS,US,XS,$S,KS,QS,ZS,JS,ev,tv,iv,nv,rv,ov,sv,av,lv,cv,dv,pv,hv,uv,gv,fv,bv,mv,yv,Ov,jv,xv,Sv,vv,Cv,Iv,wv,Tv,Rv,Av,Pv,Ev,Mv,Fv,kv,Dv,Lv,Nv,_v,zv,Vv,Wv,Gv,Bv,qv,Hv,Yv,Uv,Xv,$v,Kv,Qv,Zv,Jv,eC,tC,iC,nC,rC,oC,sC,aC,lC,cC,dC,pC,hC,uC={logMessage:"27a932e9 Mylin/1617 support spatial profile line polyline (#1812)"};let gC=(hC=pC=class e{static get Instance(){return e.staticInstance||new e}get estimatedTaskRemainingTime(){if(this.taskProgress<=0||this.taskProgress>=1)return;const e=this.taskCurrentTime-this.taskStartTime;return e/this.taskProgress-e}get modifierString(){return"linux"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002",REACT_APP_SKIP_TELEMETRY:"false"}).REACT_APP_TARGET?"ctrl + ":"darwin"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002",REACT_APP_SKIP_TELEMETRY:"false"}).REACT_APP_TARGET?"cmd +":"alt + "}get darkTheme(){return this.preferenceStore.theme===Ti.AUTO?this.systemTheme===Ti.DARK:this.preferenceStore.theme===Ti.DARK}get openFileDisabled(){var e;return(null===(e=this.backendService)||void 0===e?void 0:e.connectionStatus)!==Jj.ACTIVE||this.fileLoading}get appendFileDisabled(){return this.openFileDisabled||!this.activeFrame}get activeFrameFileId(){var e;return null===(e=this.activeFrame)||void 0===e?void 0:e.frameInfo.fileId}get activeFrameIndex(){return this.activeFrame?this.frames.findIndex((e=>e.frameInfo.fileId===this.activeFrame.frameInfo.fileId)):-1}get frameNum(){return this.frames.length}get frameMap(){const e=new Map;for(const t of this.frames)e.set(t.frameInfo.fileId,t);return e}get catalogNum(){return this.catalogStore.catalogProfileStores.size}get catalogNextFileId(){let e=1;const t=Array.from(this.catalogStore.catalogProfileStores.keys());for(;(null===t||void 0===t?void 0:t.includes(e))&&t.length;)e+=1;return e}get frameNames(){var e;return null===(e=this.frames)||void 0===e?void 0:e.map(((e,t)=>({label:t+": "+e.filename,value:e.frameInfo.fileId})))}get frameOptions(){var e;return null===(e=this.frames)||void 0===e?void 0:e.map(((e,t)=>({label:t+": "+e.filename,value:e.frameInfo.fileId,hasZAxis:void 0!==(null===e||void 0===e?void 0:e.channelInfo)&&null!==(null===e||void 0===e?void 0:e.channelInfo)})))}get frameChannels(){return this.frames.map((e=>e.requiredChannel))}get frameStokes(){return this.frames.map((e=>e.requiredStokes))}spatialGroup(e){if(!this.frames||!this.frames.length||!this.activeFrame)return[];const t=[];for(const i of this.frames){(i===e||i===e.spatialReference||i.spatialReference===e||i.spatialReference&&i.spatialReference===e.spatialReference)&&t.push(i)}return t}get spatialAndSpectalMatchedFileIds(){var e,t,i,n;let r=[];this.spatialReference&&r.push(this.spatialReference.frameInfo.fileId);const o=null===(e=this.spatialReference)||void 0===e||null===(t=e.spatialSiblings)||void 0===t?void 0:t.map((e=>e.frameInfo.fileId)),s=null===(i=this.spatialReference)||void 0===i||null===(n=i.spectralSiblings)||void 0===n?void 0:n.map((e=>e.frameInfo.fileId));return null===o||void 0===o||o.forEach((e=>{(null===s||void 0===s?void 0:s.includes(e))&&r.push(e)})),r}get contourFrames(){const e=new Map;for(const t of this.visibleFrames){const i=this.spatialGroup(t).filter((e=>e.contourConfig.enabled&&e.contourConfig.visible));e.set(t,i)}return e}get vectorOverlayFrames(){const e=new Map;for(const t of this.visibleFrames){const i=this.spatialGroup(t).filter((e=>e.vectorOverlayConfig.enabled&&e.vectorOverlayConfig.visible));e.set(t,i)}return e}removeCatalog(e,t,i){if(e>-1&&this.backendService.closeCatalogFile(e)){const n=hM.Instance;if(n.clearCatalogPlotsByFileId(e),this.catalogStore.catalogWidgets.delete(e),this.widgetsStore.catalogWidgets.delete(t),n.removeCatalog(e,i),n.catalogProfileStores.delete(e),!this.activeFrame)return}}sendCatalogFilter(e){this.activeFrame&&this.backendService.setCatalogFilterRequest(e)}updateASTColors(){if(this.astReady){var e;const t=[Jb(this.overlayStore.global.color),Jb(this.overlayStore.title.color),Jb(this.overlayStore.grid.color),Jb(this.overlayStore.border.color),Jb(this.overlayStore.ticks.color),Jb(this.overlayStore.axes.color),Jb(this.overlayStore.numbers.color),Jb(this.overlayStore.labels.color),Jb(this.activeFrame?null===(e=this.activeFrame.distanceMeasuring)||void 0===e?void 0:e.color:Et.DEFAULT_COLOR)];Pt.setColors(t)}}constructor(){this.backendService=void 0,this.tileService=void 0,this.scriptingService=void 0,this.apiService=void 0,this.telemetryService=void 0,this.alertStore=void 0,this.animatorStore=void 0,this.catalogStore=void 0,this.dialogStore=void 0,this.fileBrowserStore=void 0,this.helpStore=void 0,this.layoutStore=void 0,this.snippetStore=void 0,this.logStore=void 0,this.overlayStore=void 0,this.preferenceStore=void 0,this.widgetsStore=void 0,this.imageFittingStore=void 0,Object(f.a)(this,"astReady",fS,this),Object(f.a)(this,"cartaComputeReady",bS,this),Object(f.a)(this,"frames",mS,this),Object(f.a)(this,"activeFrame",yS,this),Object(f.a)(this,"hoveredFrame",OS,this),Object(f.a)(this,"contourDataSource",jS,this),Object(f.a)(this,"syncContourToFrame",xS,this),Object(f.a)(this,"syncFrameToContour",SS,this),Object(f.a)(this,"spatialProfiles",vS,this),Object(f.a)(this,"spectralProfiles",CS,this),Object(f.a)(this,"regionStats",IS,this),Object(f.a)(this,"regionHistograms",wS,this),Object(f.a)(this,"spatialReference",TS,this),Object(f.a)(this,"spectralReference",RS,this),Object(f.a)(this,"rasterScalingReference",AS,this),Object(f.a)(this,"activeLayer",PS,this),Object(f.a)(this,"cursorFrozen",ES,this),Object(f.a)(this,"toolbarExpanded",MS,this),Object(f.a)(this,"imageRatio",FS,this),Object(f.a)(this,"isExportingImage",kS,this),Object(f.a)(this,"isCanvasUpdated",DS,this),this.appContainer=void 0,this.fileCounter=0,this.previousConnectionStatus=void 0,this.canvasUpdatedTimer=void 0,this.getAppContainer=()=>this.appContainer,this.setAppContainer=e=>{this.appContainer=e},Object(f.a)(this,"splashScreenVisible",LS,this),Object(f.a)(this,"showSplashScreen",NS,this),Object(f.a)(this,"hideSplashScreen",_S,this),Object(f.a)(this,"setImageViewDimensions",zS,this),Object(f.a)(this,"username",VS,this),Object(f.a)(this,"setUsername",WS,this),Object(f.a)(this,"isLoadingMultipleFiles",GS,this),Object(f.a)(this,"setLoadingMultipleFiles",BS,this),this.connectToServer=async()=>{let e=window.location.href.replace(window.location.search,"").replace(/^http/,"ws").replace(/\/$/,"");e=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002",REACT_APP_SKIP_TELEMETRY:"false"}).REACT_APP_DEFAULT_ADDRESS_PROD?Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002",REACT_APP_SKIP_TELEMETRY:"false"}).REACT_APP_DEFAULT_ADDRESS_PROD:e;const t=new URL(window.location.href).searchParams.get("socketUrl");t?(e=t,console.log(`Connecting to override URL: ${e}`)):console.log(`Connecting to default URL: ${e}`);try{await Pt.onReady,this.setAstReady(!0);const t=await this.backendService.connect(e);console.log(`Connected with session ID ${t.sessionId}`),this.logStore.addInfo(`Connected to server ${e} with session ID ${t.sessionId}`,["network"])}catch(i){console.error(i)}},this.loadDefaultFiles=async()=>{const e=new URL(window.location.href),t=e.searchParams.get("folder");let i;if(e.searchParams.has("files")){var n;let t=e.searchParams.get("files");t.startsWith("[")&&t.endsWith("]")&&(t=t.slice(1,-1)),i=null===(n=t.split(","))||void 0===n?void 0:n.map((e=>e.trim()))}else e.searchParams.has("file")&&(i=[e.searchParams.get("file")]);try{var r;if(null===(r=i)||void 0===r?void 0:r.length){this.setLoadingMultipleFiles(!0);for(const e of i)await this.loadFile(t,e,"",!1);this.setLoadingMultipleFiles(!1)}else this.preferenceStore.autoLaunch&&(t&&this.fileBrowserStore.setStartingDirectory(t),this.fileBrowserStore.showFileBrowser(DI.File))}catch(o){console.error(o)}},Object(f.a)(this,"handleThemeChange",qS,this),Object(f.a)(this,"taskProgress",HS,this),Object(f.a)(this,"taskStartTime",YS,this),Object(f.a)(this,"taskCurrentTime",US,this),Object(f.a)(this,"fileLoading",XS,this),Object(f.a)(this,"fileSaving",$S,this),Object(f.a)(this,"resumingSession",KS,this),Object(f.a)(this,"restartTaskProgress",QS,this),Object(f.a)(this,"updateTaskProgress",ZS,this),Object(f.a)(this,"startFileLoading",JS,this),Object(f.a)(this,"endFileLoading",ev,this),Object(f.a)(this,"startFileSaving",tv,this),Object(f.a)(this,"endFileSaving",iv,this),Object(f.a)(this,"systemTheme",nv,this),Object(f.a)(this,"addFrame",rv,this),this.loadFile=async(e,t,i,n)=>{var r;if(this.startFileLoading(),n)i="";else if(t){if(!e&&t.includes("/")){const i=t.lastIndexOf("/");i>=0&&(e=t.substring(0,i),t=t.substring(i+1))}}else{const i=e.lastIndexOf("/");i>=0&&(t=e.substring(i+1),e=e.substring(0,i))}if(!(null===(r=i)||void 0===r?void 0:r.length)){const e=/^(.*)\[(\S+)]$/.exec(t);3===(null===e||void 0===e?void 0:e.length)&&(t=e[1],i=e[2])}try{const r=await this.backendService.loadFile(e,t,i,this.fileCounter,n);return this.fileCounter++,this.addFrame(r,e,i)||v.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3}),this.endFileLoading(),this.fileBrowserStore.hideFileBrowser(),WP.ResetWidgetPlotXYBounds(this.widgetsStore.spatialProfileWidgets),WP.ResetWidgetPlotXYBounds(this.widgetsStore.spectralProfileWidgets),WP.ResetWidgetPlotXYBounds(this.widgetsStore.stokesAnalysisWidgets),await this.delay(10),this.getFrame(r.fileId)}catch(o){throw this.alertStore.showAlert(`Error loading file: ${o}`),this.endFileLoading(),o}},this.loadConcatStokes=async(t,i,n)=>{this.startFileLoading();try{const r=await this.backendService.loadStokeFiles(t,this.fileCounter,Nt.RenderMode.RASTER);return this.fileCounter++,this.addFrame(r.openFileAck,i,n)||v.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3}),this.endFileLoading(),this.fileBrowserStore.hideFileBrowser(),e.Instance.dialogStore.hideStokesDialog(),WP.ResetWidgetPlotXYBounds(this.widgetsStore.spatialProfileWidgets),WP.ResetWidgetPlotXYBounds(this.widgetsStore.spectralProfileWidgets),WP.ResetWidgetPlotXYBounds(this.widgetsStore.stokesAnalysisWidgets),r.openFileAck.fileId}catch(r){throw console.log(r),this.alertStore.showAlert(`Error loading files: ${r}`),this.endFileLoading(),r}},Object(f.a)(this,"appendConcatFile",ov,this),Object(f.a)(this,"openConcatFile",sv,this),Object(f.a)(this,"appendFile",av,this),Object(f.a)(this,"openFile",lv,this),this.saveFile=async(e,t,i,n,r,o,s,a)=>{if(!this.activeFrame)throw new Error("No active image");this.startFileSaving();const l=this.activeFrame.frameInfo.fileId;try{const c=await this.backendService.saveFile(l,e,t,i,n,r,o,!s,a);return v.show({icon:"saved",message:`${t} saved.`,intent:"success",timeout:3e3}),this.fileBrowserStore.hideFileBrowser(),this.endFileSaving(),c.fileId}catch(c){throw console.error(c),v.show({icon:"warning-sign",message:c,intent:"danger",timeout:3e3}),this.endFileSaving(),c}},Object(f.a)(this,"closeFile",cv,this),Object(f.a)(this,"closeCurrentFile",dv,this),Object(f.a)(this,"closeOtherFiles",pv,this),Object(f.a)(this,"removeFrame",hv,this),Object(f.a)(this,"removeAllFrames",uv,this),Object(f.a)(this,"shiftFrame",gv,this),Object(f.a)(this,"nextFrame",fv,this),Object(f.a)(this,"prevFrame",bv,this),this.appendCatalog=async(e,t,i,n)=>new Promise(((r,o)=>{if(!this.activeFrame)throw v.show(I("Please load the image file")),new Error("No image file");if(n!==Nt.CatalogFileType.VOTable)throw v.show(I("Catalog type not supported")),new Error("Catalog type not supported");this.startFileLoading();const s=this.activeFrame,a=this.catalogNextFileId;this.backendService.loadCatalogFile(e,t,a,i).then((t=>Object(m.t)((()=>{if(this.endFileLoading(),s&&t.success&&t.dataSize){let i={fileId:a,directory:e,fileInfo:t.fileInfo,dataSize:t.dataSize};const n=$m.ProcessCatalogData(t.previewData);let l=this.updateCatalogProfile(a,s);if(l){this.catalogStore.catalogWidgets.set(a,l),this.catalogStore.addCatalog(a,t.dataSize),this.fileBrowserStore.hideFileBrowser();const e=new LM(i,t.headers,n,Hn.FILE);this.catalogStore.catalogProfileStores.set(a,e),r(a)}else o()}else o()}))),(e=>{console.error(e),v.show(I(e)),this.endFileLoading(),o(e)}))})),this.updateCatalogProfile=(t,i)=>{let n,r=[];const o=hM.Instance,s=o.catalogProfiles.size;let a=o.imageAssociatedCatalogId.get(i.frameInfo.fileId);if((null===a||void 0===a?void 0:a.length)?r=a:o.catalogProfiles.forEach(((e,i)=>{o.catalogProfiles.set(i,t)})),r.push(t),o.updateImageAssociatedCatalogId(e.Instance.activeFrame.frameInfo.fileId,r),0===s){const e=this.widgetsStore.createFloatingCatalogWidget(t);n=e.widgetStoreId,o.catalogProfiles.set(e.widgetComponentId,t)}else{n=this.widgetsStore.addCatalogWidget(t);const e=o.catalogProfiles.keys().next().value;o.catalogProfiles.set(e,t)}return n},Object(f.a)(this,"reorderFrame",mv,this),this.importRegion=async(e,t,i)=>{if(!this.activeFrame||i!==Nt.FileType.CRTF&&i!==Nt.FileType.DS9_REG)return void v.show(I("Region type not supported"));const n=this.activeFrame;try{const r=await this.backendService.importRegion(e,t,i,n.frameInfo.fileId);if(n&&r.success&&r.regions){const e=Object.entries(r.regions),t=new Map(Object.entries(r.regionStyles));let i=0;for(;i<e.length;)this.addRegionsInBatch(e,t,i,100),i+=100,await this.delay(0);this.fileBrowserStore.setImportingRegions(!1),this.fileBrowserStore.resetLoadingStates(),this.fileBrowserStore.hideFileBrowser()}}catch(r){console.error(r),this.fileBrowserStore.setImportingRegions(!1),this.fileBrowserStore.resetLoadingStates(),v.show(I(r))}},Object(f.a)(this,"addRegionsInBatch",yv,this),this.exportRegions=async(e,t,i,n,r)=>{var o;const s=this.activeFrame;if(!(null===(o=s.regionSet)||void 0===o?void 0:o.regions)||s.regionSet.regions.length<=1||(null===r||void 0===r?void 0:r.length)<1)return;const a=new Map;for(const c of r.map((e=>s.regionSet.regions[e])))a.set(c.regionId,{name:c.name,color:c.color,lineWidth:c.lineWidth,dashList:c.dashLength?[c.dashLength]:[]});try{await this.backendService.exportRegion(e,t,n,i,s.frameInfo.fileId,a),v.show(C("saved",`Exported regions for ${s.filename} using ${i===Nt.CoordinateType.WORLD?"world":"pixel"} coordinates`)),this.fileBrowserStore.hideFileBrowser()}catch(l){console.error(l),v.show(I(l))}},Object(f.a)(this,"requestCubeHistogram",Ov,this),Object(f.a)(this,"cancelCubeHistogramRequest",jv,this),Object(f.a)(this,"requestMoment",xv,this),Object(f.a)(this,"cancelRequestingMoment",Sv,this),Object(f.a)(this,"requestPV",vv,this),Object(f.a)(this,"cancelRequestingPV",Cv,this),this.requestFitting=async e=>{if(e){try{const t=await this.backendService.requestFitting(e);t.success&&this.imageFittingStore.setResultString(t.resultValues,t.resultErrors,t.log),t.message&&v.show(w(`Image fitting: ${t.message}.`))}catch(t){v.show(I(`Image fitting failed: ${t}.`))}this.imageFittingStore.setIsFitting(!1)}},Object(f.a)(this,"setAstReady",Iv,this),Object(f.a)(this,"setDarkTheme",wv,this),Object(f.a)(this,"setLightTheme",Tv,this),Object(f.a)(this,"setAutoTheme",Rv,this),Object(f.a)(this,"setTheme",Av,this),Object(f.a)(this,"toggleCursorFrozen",Pv,this),Object(f.a)(this,"setCursorFrozen",Ev,this),Object(f.a)(this,"toggleToolbarExpanded",Mv,this),Object(f.a)(this,"setToolbarExpanded",Fv,this),Object(f.a)(this,"updateActiveLayer",kv,this),Object(f.a)(this,"toggleActiveLayer",Dv,this),Object(f.a)(this,"setImageRatio",Lv,this),Object(f.a)(this,"setIsExportingImage",Nv,this),Object(f.a)(this,"setIsCanvasUpdated",_v,this),this.spectralRequirements=void 0,this.spatialRequirements=void 0,this.statsRequirements=void 0,this.histogramRequirements=void 0,this.pendingChannelHistograms=void 0,Object(f.a)(this,"updateChannels",zv,this),this.updateViews=e=>{for(const t of e)this.updateView(t.tiles,t.fileId,t.channel,t.stokes,t.focusPoint)},this.updateView=(e,t,i,n,r)=>{this.animatorStore.serverAnimationActive?this.backendService.addRequiredTiles(t,e.map((e=>e.encode())),this.preferenceStore.animationCompressionQuality):this.tileService.requestTiles(e,t,i,n,r,this.preferenceStore.imageCompressionQuality)},this.initCarta=async(e,t,i,n)=>{if(e&&t&&i&&n)try{await this.preferenceStore.fetchPreferences(),await this.telemetryService.checkAndGenerateId(),await this.telemetryService.flushTelemetry(),await this.connectToServer(),await this.fileBrowserStore.restoreStartingDirectory(),await this.layoutStore.fetchLayouts(),await this.snippetStore.fetchSnippets(),this.tileService.setCache(this.preferenceStore.gpuTileCache,this.preferenceStore.systemTileCache),this.layoutStore.applyLayout(this.preferenceStore.layout)||(Bx.Instance.showAlert(`Applying preference layout "${this.preferenceStore.layout}" failed! Resetting preference layout to default.`),this.layoutStore.applyLayout(Ri.DEFAULT),this.preferenceStore.setPreference(QA.GLOBAL_LAYOUT,Ri.DEFAULT)),await this.loadDefaultFiles(),this.setCursorFrozen(this.preferenceStore.isCursorFrozen),this.updateASTColors()}catch(r){console.error(r)}},Object(f.a)(this,"handleSpatialProfileStream",Vv,this),this.handleSpectralProfileStream=e=>{if(this.frames.find((t=>t.frameInfo.fileId===e.fileId))){let t=this.spectralProfiles.get(e.fileId);t||(t=new m.b,this.spectralProfiles.set(e.fileId,t));let i=t.get(e.regionId);i||(i=new RA(e.fileId,e.regionId),t.set(e.regionId,i));for(let n of e.profiles)i.setProfile($m.ProcessSpectralProfile(n,e.progress))}},this.handleRegionHistogramStream=e=>{if(!e)return;let t=this.regionHistograms.get(e.fileId);t||(t=new m.b,this.regionHistograms.set(e.fileId,t));let i=t.get(e.regionId);if(i||(i=new m.b,t.set(e.regionId,i)),i.set(e.stokes,e),-1===e.regionId){const t=`${e.fileId}_${e.stokes}_${e.channel}`;this.pendingChannelHistograms.set(t,e)}else if(-2===e.regionId){const t=this.getFrame(e.fileId);if(t){const i=e.histograms;i&&(t.renderConfig.useCubeHistogram||t.renderConfig.useCubeHistogramContours)&&(t.renderConfig.updateCubeHistogram(i,e.progress),this.updateTaskProgress(e.progress))}}},Object(f.a)(this,"handleTileStream",Wv,this),Object(f.a)(this,"handleRegionStatsStream",Gv,this),this.handleContourImageStream=e=>{const t=this.getFrame(e.fileId);t&&t.updateFromContourData(e)},Object(f.a)(this,"handleCatalogFilterStream",Bv,this),this.handleMomentProgressStream=e=>{if(!e)return;const t=this.getFrame(e.fileId);t&&(t.updateRequestingMomentsProgress(e.progress),this.updateTaskProgress(e.progress))},this.handleFileProgressStream=e=>{e&&(this.fileBrowserStore.updateLoadingState(e.percentage,e.checkedCount,e.totalCount),this.fileBrowserStore.showLoadingDialog(),this.updateTaskProgress(e.percentage))},this.handlePvProgressStream=e=>{if(!e)return;const t=this.getFrame(e.fileId);t&&(t.updateRequestingPvProgress(e.progress),this.updateTaskProgress(e.progress))},this.handleVectorTileStream=e=>{const t=this.getFrame(e.fileId);t&&t.updateFromVectorOverlayData(e)},this.handleErrorStream=e=>{if(e){const t={level:e.severity,message:e.message,tags:e.tags.concat(["server-sent"]),title:null};this.logStore.addLog(t)}},this.handleScriptingRequest=e=>{this.scriptingService.handleScriptingRequest(e).then(this.backendService.sendScriptingResponse)},this.onReconnectAlertClosed=async()=>{try{const e=await this.backendService.connect(this.backendService.serverUrl);e.sessionType===Nt.SessionType.RESUMED&&(console.log(`Reconnected with session ID ${e.sessionId}`),this.logStore.addInfo(`Reconnected to server with session ID ${e.sessionId}`,["network"]),this.resumeSession())}catch(e){console.log(e)}},Object(f.a)(this,"resumeSession",qv,this),Object(f.a)(this,"onSessionResumed",Hv,this),Object(f.a)(this,"setActiveFrame",Yv,this),Object(f.a)(this,"setActiveFrameById",Uv,this),Object(f.a)(this,"setContourDataSource",Xv,this),Object(f.a)(this,"toggleFrameContourLock",$v,this),Object(f.a)(this,"deleteSelectedRegion",Kv,this),Object(f.a)(this,"deleteRegion",Qv,this),this.setCursor=(e,t)=>{const i=this.getFrame(e);null===i||void 0===i||i.updateCursorRegion(t)},Object(f.a)(this,"setSpatialReference",Zv,this),Object(f.a)(this,"clearSpatialReference",Jv,this),Object(f.a)(this,"setSpatialMatchingEnabled",eC,this),Object(f.a)(this,"toggleSpatialMatching",tC,this),Object(f.a)(this,"setSpectralReference",iC,this),Object(f.a)(this,"clearSpectralReference",nC,this),Object(f.a)(this,"setSpectralMatchingEnabled",rC,this),Object(f.a)(this,"toggleSpectralMatching",oC,this),this.setSpectralMatchingType=e=>{this.preferenceStore.setPreference(QA.GLOBAL_SPECTRAL_MATCHING_TYPE,e);for(const t of this.frames)t.spectralReference&&this.setSpectralMatchingEnabled(t,!0)},Object(f.a)(this,"setRasterScalingReference",sC,this),Object(f.a)(this,"clearRasterScalingReference",aC,this),Object(f.a)(this,"setRasterScalingMatchingEnabled",lC,this),Object(f.a)(this,"toggleRasterScalingMatching",cC,this),Object(f.a)(this,"setMatchingEnabled",dC,this),this.exportImage=e=>{if(this.activeFrame){if(-1===this.visibleFrames.indexOf(this.activeFrame))return;this.setIsExportingImage(!0),this.setImageRatio(e),this.waitForImageData().then((()=>{const e=this.preferenceStore.transparentImageBackground?"rgba(255, 255, 255, 0)":this.darkTheme?L.a.DARK_GRAY3:L.a.LIGHT_GRAY5,t=zG(this.overlayStore.padding,this.overlayStore.colorbar.position,e);t&&t.toBlob((e=>{const t=document.createElement("a"),i=this.visibleFrames.map((e=>e.filename)).join("-");t.download=`${i}-image`.substring(0,200)+`-${Bm()}.png`,t.href=URL.createObjectURL(e),t.dispatchEvent(new MouseEvent("click"))}),"image/png"),this.setIsExportingImage(!1)}))}},this.updateLayerPixelRatio=e=>{var t;const i=devicePixelRatio*this.imageRatio,n=null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.getCanvas();n&&n.pixelRatio!==i&&n.setPixelRatio(i)},this.resetImageRatio=()=>{1!==this.imageRatio&&!1===this.isExportingImage&&this.setImageRatio(1)},this.decreaseImageRatio=()=>{1!==this.imageRatio&&!0===this.isExportingImage&&(v.show(w(`Exceeded the maximum canvas size; exporting image with ${this.imageRatio-1}00% resolution instead.`)),this.setImageRatio(this.imageRatio-1))},this.getImageDataUrl=e=>{if(this.activeFrame){const t=zG(this.overlayStore.padding,this.overlayStore.colorbar.position,e);if(t)return t.toDataURL()}return null},this.waitForImageData=async()=>(await this.delay(500),new Promise((e=>{Object(m.w)((()=>{const e=this.tileService.remainingTiles>0;let t=!1;for(const i of this.visibleFrames)if(i.contourProgress>=0&&i.contourProgress<1){t=!0;break}return!e&&!t}),(()=>{this.setIsCanvasUpdated(!1),this.setCanvasUpdated(),Object(m.w)((()=>this.isCanvasUpdated),(async()=>e()))}))}))),this.setCanvasUpdated=()=>{clearTimeout(this.canvasUpdatedTimer),this.canvasUpdatedTimer=setTimeout((()=>this.setIsCanvasUpdated(!0)),500)},this.fetchParameter=e=>{if(e&&e instanceof Map){const t={},i=e;for(let[e,n]of i)t[e]=n;return t}return e},this.getFileList=async e=>await this.backendService.getFileList(e,rr(this.preferenceStore.fileFilterMode)),this.initRequirements=()=>{this.spectralRequirements=new Map,this.spatialRequirements=new Map,this.statsRequirements=new Map,this.histogramRequirements=new Map},this.recalculateRequirements=()=>{this.recalculateSpatialRequirements(),this.recalculateSpectralRequirements(),this.recalculateStatsRequirements(),this.recalculateHistogramRequirements()},this.activateStatsPanel=e=>{e&&i.e(5).then(i.t.bind(null,1048,7)).then((({default:e})=>{const t=new e;t.showPanel(this.preferenceStore.statsPanelMode),document.body.appendChild(t.dom),requestAnimationFrame((function e(){t.begin(),t.end(),requestAnimationFrame(e)})),t.dom.style.right="0",t.dom.style.left="initial"})).catch((e=>{console.log(e)}))},this.resetCursorRegionSpectralProfileProgress=e=>{var t,i;null===(t=this.spectralProfiles.get(e))||void 0===t||null===(i=t.get(0))||void 0===i||i.resetProfilesProgress()},this.resetRegionSpectralProfileProgress=e=>{var t;null===(t=this.spectralProfiles)||void 0===t||t.forEach((t=>{var i;null===(i=t.get(e))||void 0===i||i.resetProfilesProgress()}))},Object(m.p)(this),e.staticInstance=this,window.app=this,window.carta=this,this.backendService=tx.Instance,this.tileService=ux.Instance,this.scriptingService=Cx.Instance,this.apiService=pj.Instance,this.telemetryService=Cj.Instance,this.alertStore=Bx.Instance,this.animatorStore=dS.Instance,this.catalogStore=hM.Instance,this.dialogStore=tM.Instance,this.fileBrowserStore=NI.Instance,this.helpStore=SM.Instance,this.layoutStore=eE.Instance,this.snippetStore=Nk.Instance,this.logStore=qI.Instance,this.preferenceStore=JA.Instance,this.overlayStore=bA.Instance,this.widgetsStore=WP.Instance,this.imageFittingStore=ND.Instance,this.astReady=!1,this.cartaComputeReady=!1,this.spatialProfiles=new Map,this.spectralProfiles=new Map,this.regionStats=new Map,this.regionHistograms=new Map,this.pendingChannelHistograms=new Map,this.frames=[],this.activeFrame=null,this.hoveredFrame=null,this.contourDataSource=null,this.syncFrameToContour=!0,this.syncContourToFrame=!0,this.initRequirements(),this.activeLayer=_G.RegionMoving,this.toolbarExpanded=!0,this.imageRatio=1,this.isExportingImage=!1,Pt.onReady.then(Object(m.g)((()=>{this.setAstReady(!0),this.logStore.addInfo("AST library loaded",["ast"])}))),X.onReady.then(Object(m.g)((()=>{this.cartaComputeReady=!0,this.logStore.addInfo("Compute module loaded",["compute"])}))),this.logStore.addDebug(`Current frontend version: ${uC.logMessage}`,["version"]),this.previousConnectionStatus=Jj.CLOSED,Object(m.h)((()=>{document.body.style.backgroundColor=this.darkTheme?L.a.DARK_GRAY4:L.a.WHITE;const e=this.darkTheme?hS.a.DARK:"";Object(u.W)({className:e})}));const t=window.matchMedia("(prefers-color-scheme: dark)");t&&(t.addEventListener?t.addEventListener("change",(e=>this.handleThemeChange(e.matches))):t.addListener&&t.addListener((e=>handleThemeChange(e.matches)))),this.handleThemeChange(t.matches),Object(m.h)((()=>{const e=this.backendService.connectionStatus,t=this.username?` as ${this.username}`:"";switch(e){case Jj.ACTIVE:v.clear(),this.backendService.connectionDropped?v.show(w(`Reconnected to server${t}. Some errors may occur`)):v.show(C("swap-vertical",`Connected to CARTA server${t}`));break;case Jj.CLOSED:this.previousConnectionStatus!==Jj.ACTIVE&&this.previousConnectionStatus!==Jj.PENDING||(v.show(I("Disconnected from server")),this.alertStore.showRetryAlert("You have been disconnected from the server. Do you want to reconnect? Please note that temporary images such as moment images or PV images generated via the GUI will be unloaded.").then(this.onReconnectAlertClosed))}this.previousConnectionStatus=e}));const n=T.throttle(this.updateViews,e.ImageThrottleTime),r=T.throttle(this.updateChannels,e.ImageChannelThrottleTime),o=T.throttle(this.setCursor,e.CursorThrottleTimeRotated),s=T.throttle(this.setCursor,e.CursorThrottleTime),a=T.throttle(this.setCursor,2*e.CursorThrottleTime);Object(m.h)((()=>{if(this.activeFrame&&(!this.activeFrame.zooming||this.preferenceStore.streamContoursWhileZooming)){const e=[];for(const t of this.visibleFrames){const i=t.requiredFrameView;const n=jm({xMin:Math.max(0,i.xMin),xMax:Math.min(t.frameInfo.fileInfoExtended.width,i.xMax),yMin:Math.max(0,i.yMin),yMax:Math.min(t.frameInfo.fileInfoExtended.height,i.yMax),mip:i.mip},{x:t.frameInfo.fileInfoExtended.width,y:t.frameInfo.fileInfoExtended.height},{x:256,y:256}),r={x:(i.xMax+i.xMin)/2,y:(i.yMin+i.yMax)/2},o=256*i.mip,s={x:r.x/o-.5,y:r.y/o-.5};n.length&&e.push({tiles:n,fileId:t.frameInfo.fileId,channel:t.channel,stokes:t.stokes,focusPoint:s})}n(e)}})),Object(m.h)((()=>{if(this.activeFrame){const e=[],t=this.activeFrame.requiredChannel!==this.activeFrame.channel||this.activeFrame.requiredStokes!==this.activeFrame.stokes;!this.animatorStore.animationActive&&t&&e.push({frame:this.activeFrame,channel:this.activeFrame.requiredChannel,stokes:this.activeFrame.requiredStokes}),this.activeFrame.spectralSiblings.forEach((t=>{(t.requiredChannel!==t.channel||t.requiredStokes!==t.stokes)&&e.push({frame:t,channel:t.requiredChannel,stokes:t.requiredStokes})})),e.length&&r(e)}})),Object(m.h)((()=>{var e,t;const i=null===(e=this.hoveredFrame)||void 0===e||null===(t=e.cursorInfo)||void 0===t?void 0:t.posImageSpace;i&&(this.preferenceStore.lowBandwidthMode?a(this.hoveredFrame.frameInfo.fileId,i):this.hoveredFrame.frameInfo.fileFeatureFlags&Nt.FileFeatureFlags.ROTATED_DATASET?o(this.hoveredFrame.frameInfo.fileId,i):s(this.hoveredFrame.frameInfo.fileId,i))})),Object(m.h)((()=>{this.activeFrame&&this.overlayStore.setDefaultsFromAST(this.activeFrame)})),Object(m.h)((()=>{this.activeFrame&&this.numImageColumns&&this.numImageRows&&this.widgetsStore.updateImagePanelPageButtons()})),setInterval(this.recalculateRequirements,e.RequirementsCheckInterval),this.backendService.spatialProfileStream.subscribe(this.handleSpatialProfileStream),this.backendService.spectralProfileStream.subscribe(this.handleSpectralProfileStream),this.backendService.histogramStream.subscribe(this.handleRegionHistogramStream),this.backendService.contourStream.subscribe(this.handleContourImageStream),this.backendService.catalogStream.subscribe(this.handleCatalogFilterStream),this.backendService.errorStream.subscribe(this.handleErrorStream),this.backendService.statsStream.subscribe(this.handleRegionStatsStream),this.backendService.momentProgressStream.subscribe(this.handleMomentProgressStream),this.backendService.scriptingStream.subscribe(this.handleScriptingRequest),this.tileService.tileStream.subscribe(this.handleTileStream),this.backendService.listProgressStream.subscribe(this.handleFileProgressStream),this.backendService.pvProgressStream.subscribe(this.handlePvProgressStream),this.backendService.vectorTileStream.subscribe(this.handleVectorTileStream);const l=new URL(window.location.href).searchParams.get("token");l&&this.apiService.setToken(l),Object(m.h)((()=>{var e,t;this.initCarta(this.astReady,null===(e=this.tileService)||void 0===e?void 0:e.zfpReady,this.cartaComputeReady,null===(t=this.apiService)||void 0===t?void 0:t.authenticated)})),Object(m.h)((()=>{this.backendService.connectionStatus===Jj.ACTIVE?setTimeout(this.hideSplashScreen,500):this.showSplashScreen()})),Object(m.h)((()=>{this.activateStatsPanel(this.preferenceStore.statsPanelEnabled)}))}setActiveFrameByIndex(e){e>=0&&this.frames.length>e?this.setActiveFrame(this.frames[e]):console.log(`Invalid frame index ${e}`)}changeActiveFrame(e){e!==this.activeFrame&&this.overlayStore.setDefaultsFromAST(e),this.activeFrame=e,this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout),this.catalogStore.resetActiveCatalogFile(e.frameInfo.fileId),this.syncContourToFrame&&(this.contourDataSource=e)}setHoveredFrame(e){e&&(this.hoveredFrame=e)}get frameLockedToContour(){return this.syncFrameToContour&&this.syncContourToFrame}getFrame(e){return-1===e?this.activeFrame:this.frames.find((t=>t.frameInfo.fileId===e))}getFrameName(e){var t;return null===(t=this.getFrame(e))||void 0===t?void 0:t.filename}getFrameIndex(e){var t;return null===(t=this.frames)||void 0===t?void 0:t.findIndex((t=>(null===t||void 0===t?void 0:t.frameInfo.fileId)===e))}get selectedRegion(){return this.activeFrame&&this.activeFrame.regionSet&&this.activeFrame.regionSet.selectedRegion&&0!==this.activeFrame.regionSet.selectedRegion.regionId?this.activeFrame.regionSet.selectedRegion:null}get numImagePages(){return this.numImageColumns<=0||this.numImageRows<=0||!this.frames?0:Math.ceil(this.frames.length/this.imagesPerPage)}get currentImagePage(){var e;if(!(null===(e=this.frames)||void 0===e?void 0:e.length)||!this.activeFrame)return 0;const t=this.frames.indexOf(this.activeFrame);return Math.floor(t/this.imagesPerPage)}get visibleFrames(){var e;if(!(null===(e=this.frames)||void 0===e?void 0:e.length))return[];const t=Gi(this.currentImagePage,0,this.numImagePages)*this.imagesPerPage,i=Math.min(t+this.imagesPerPage,this.frames.length),n=[];for(let r=t;r<i;r++)n.push(this.frames[r]);return n}get numImageColumns(){var e,t;switch(this.imagePanelMode){case Xn.None:return 1;case Xn.Fixed:return Math.max(1,this.preferenceStore.imagePanelColumns);default:return Gi(null!==(e=null===(t=this.frames)||void 0===t?void 0:t.length)&&void 0!==e?e:0,1,this.preferenceStore.imagePanelColumns)}}get numImageRows(){var e,t;switch(this.imagePanelMode){case Xn.None:return 1;case Xn.Fixed:return Math.max(1,this.preferenceStore.imagePanelRows);default:const i=null!==(e=null===(t=this.frames)||void 0===t?void 0:t.length)&&void 0!==e?e:0;return Gi(Math.ceil(i/this.preferenceStore.imagePanelColumns),1,this.preferenceStore.imagePanelRows)}}get imagesPerPage(){return this.numImageColumns*this.numImageRows}get imagePanelMode(){const e=JA.Instance;return e.imageMultiPanelEnabled?e.imagePanelMode:Xn.None}delay(e){return new Promise((t=>{setTimeout(t,e)}))}recalculateStatsRequirements(){if(!this.activeFrame)return;const e=ks.CalculateRequirementsMap(this.widgetsStore.statsWidgets),t=ks.DiffStatsRequirements(this.statsRequirements,e);if(this.statsRequirements=e,t.length)for(const i of t)this.backendService.setStatsRequirements(i)}recalculateHistogramRequirements(){if(!this.activeFrame)return;const e=pa.CalculateRequirementsMap(this.widgetsStore.histogramWidgets),t=pa.DiffHistoRequirements(this.histogramRequirements,e);if(this.histogramRequirements=e,t.length)for(const i of t)this.backendService.setHistogramRequirements(i)}recalculateSpectralRequirements(){if(!this.activeFrame)return;const e=lh.CalculateRequirementsMap(this.widgetsStore.spectralProfileWidgets);this.widgetsStore.stokesAnalysisWidgets.size>0&&Sc.addToRequirementsMap(e,this.widgetsStore.stokesAnalysisWidgets);const t=lh.DiffSpectralRequirements(this.spectralRequirements,e);this.spectralRequirements=e,t.length&&t.forEach((e=>this.backendService.setSpectralRequirements(e)))}recalculateSpatialRequirements(){if(!this.activeFrame)return;const e=Fo.CalculateRequirementsMap(this.widgetsStore.spatialProfileWidgets),t=Fo.DiffSpatialRequirements(this.spatialRequirements,e);this.spatialRequirements=e,t.length&&t.forEach((e=>this.backendService.setSpatialRequirements(e)))}get pixelRatio(){return devicePixelRatio}},pC.staticInstance=void 0,pC.DEFAULT_STATS_TYPES=[Nt.StatsType.NumPixels,Nt.StatsType.Sum,Nt.StatsType.FluxDensity,Nt.StatsType.Mean,Nt.StatsType.RMS,Nt.StatsType.Sigma,Nt.StatsType.SumSq,Nt.StatsType.Min,Nt.StatsType.Max,Nt.StatsType.Extrema],pC.CursorThrottleTime=200,pC.CursorThrottleTimeRotated=100,pC.ImageThrottleTime=50,pC.ImageChannelThrottleTime=500,pC.RequirementsCheckInterval=200,gS=hC,fS=Object(b.a)(gS.prototype,"astReady",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bS=Object(b.a)(gS.prototype,"cartaComputeReady",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mS=Object(b.a)(gS.prototype,"frames",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yS=Object(b.a)(gS.prototype,"activeFrame",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OS=Object(b.a)(gS.prototype,"hoveredFrame",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jS=Object(b.a)(gS.prototype,"contourDataSource",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xS=Object(b.a)(gS.prototype,"syncContourToFrame",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SS=Object(b.a)(gS.prototype,"syncFrameToContour",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vS=Object(b.a)(gS.prototype,"spatialProfiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CS=Object(b.a)(gS.prototype,"spectralProfiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IS=Object(b.a)(gS.prototype,"regionStats",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wS=Object(b.a)(gS.prototype,"regionHistograms",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TS=Object(b.a)(gS.prototype,"spatialReference",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RS=Object(b.a)(gS.prototype,"spectralReference",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AS=Object(b.a)(gS.prototype,"rasterScalingReference",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PS=Object(b.a)(gS.prototype,"activeLayer",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ES=Object(b.a)(gS.prototype,"cursorFrozen",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MS=Object(b.a)(gS.prototype,"toolbarExpanded",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FS=Object(b.a)(gS.prototype,"imageRatio",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kS=Object(b.a)(gS.prototype,"isExportingImage",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DS=Object(b.a)(gS.prototype,"isCanvasUpdated",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LS=Object(b.a)(gS.prototype,"splashScreenVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),NS=Object(b.a)(gS.prototype,"showSplashScreen",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.splashScreenVisible=!0}}}),_S=Object(b.a)(gS.prototype,"hideSplashScreen",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.splashScreenVisible=!1}}}),zS=Object(b.a)(gS.prototype,"setImageViewDimensions",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.overlayStore.setViewDimension(e,t)}}}),VS=Object(b.a)(gS.prototype,"username",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),WS=Object(b.a)(gS.prototype,"setUsername",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.username=e}}}),GS=Object(b.a)(gS.prototype,"isLoadingMultipleFiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),BS=Object(b.a)(gS.prototype,"setLoadingMultipleFiles",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isLoadingMultipleFiles=e}}}),qS=Object(b.a)(gS.prototype,"handleThemeChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.systemTheme=e?"dark":"light"}}}),HS=Object(b.a)(gS.prototype,"taskProgress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YS=Object(b.a)(gS.prototype,"taskStartTime",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),US=Object(b.a)(gS.prototype,"taskCurrentTime",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XS=Object(b.a)(gS.prototype,"fileLoading",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$S=Object(b.a)(gS.prototype,"fileSaving",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KS=Object(b.a)(gS.prototype,"resumingSession",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QS=Object(b.a)(gS.prototype,"restartTaskProgress",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.taskProgress=0,this.taskStartTime=performance.now()}}}),ZS=Object(b.a)(gS.prototype,"updateTaskProgress",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.taskProgress=e,this.taskCurrentTime=performance.now()}}}),Object(b.a)(gS.prototype,"estimatedTaskRemainingTime",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"estimatedTaskRemainingTime"),gS.prototype),JS=Object(b.a)(gS.prototype,"startFileLoading",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileLoading=!0}}}),ev=Object(b.a)(gS.prototype,"endFileLoading",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileLoading=!1}}}),tv=Object(b.a)(gS.prototype,"startFileSaving",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileSaving=!0}}}),iv=Object(b.a)(gS.prototype,"endFileSaving",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileSaving=!1}}}),Object(b.a)(gS.prototype,"modifierString",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"modifierString"),gS.prototype),nv=Object(b.a)(gS.prototype,"systemTheme",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(gS.prototype,"darkTheme",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"darkTheme"),gS.prototype),Object(b.a)(gS.prototype,"openFileDisabled",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"openFileDisabled"),gS.prototype),Object(b.a)(gS.prototype,"appendFileDisabled",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"appendFileDisabled"),gS.prototype),Object(b.a)(gS.prototype,"activeFrameFileId",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"activeFrameFileId"),gS.prototype),Object(b.a)(gS.prototype,"activeFrameIndex",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"activeFrameIndex"),gS.prototype),Object(b.a)(gS.prototype,"frameNum",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameNum"),gS.prototype),Object(b.a)(gS.prototype,"frameMap",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameMap"),gS.prototype),Object(b.a)(gS.prototype,"catalogNum",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"catalogNum"),gS.prototype),Object(b.a)(gS.prototype,"catalogNextFileId",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"catalogNextFileId"),gS.prototype),Object(b.a)(gS.prototype,"frameNames",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameNames"),gS.prototype),Object(b.a)(gS.prototype,"frameOptions",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameOptions"),gS.prototype),Object(b.a)(gS.prototype,"frameChannels",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameChannels"),gS.prototype),Object(b.a)(gS.prototype,"frameStokes",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameStokes"),gS.prototype),Object(b.a)(gS.prototype,"spatialAndSpectalMatchedFileIds",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"spatialAndSpectalMatchedFileIds"),gS.prototype),Object(b.a)(gS.prototype,"contourFrames",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"contourFrames"),gS.prototype),Object(b.a)(gS.prototype,"vectorOverlayFrames",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"vectorOverlayFrames"),gS.prototype),rv=Object(b.a)(gS.prototype,"addFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>{if(!e)return!1;let r=`${e.fileInfoExtended.width}\xd7${e.fileInfoExtended.height}`;e.fileInfoExtended.dimensions>2&&(r+=`\xd7${e.fileInfoExtended.depth}`,e.fileInfoExtended.dimensions>3&&(r+=` (${e.fileInfoExtended.stokes} Stokes cubes)`)),this.logStore.addInfo(`Loaded file ${e.fileInfo.name} with dimensions ${r}`,["file"]);const o={fileId:e.fileId,directory:t,hdu:i,fileInfo:new Nt.FileInfo(e.fileInfo),fileInfoExtended:new Nt.FileInfoExtended(e.fileInfoExtended),fileFeatureFlags:e.fileFeatureFlags,renderMode:Nt.RenderMode.RASTER,beamTable:e.beamTable};this.telemetryService.addFileOpenEntry(e.fileId,e.fileInfoExtended.width,e.fileInfoExtended.height,e.fileInfoExtended.depth,e.fileInfoExtended.stokes,n);let s=new vg(o);const a=this.frames.findIndex((t=>t.frameInfo.fileId===e.fileId));return-1!==a?(this.frames[a].clearContours(!1),this.frames[a]=s):this.frames.push(s),1===this.frames.length&&(this.setSpatialReference(this.frames[0]),this.setRasterScalingReference(this.frames[0]),this.setContourDataSource(this.frames[0])),s.frameInfo.fileInfoExtended.depth>1&&(1===this.frames.length||!this.spectralReference)&&this.setSpectralReference(s),this.setActiveFrame(s),this.catalogStore.updateImageAssociatedCatalogId(s.frameInfo.fileId,[]),s.frameInfo.fileInfoExtended.depth<=1&&s.frameInfo.fileInfoExtended.stokes<=1?this.animatorStore.setAnimationMode(lS.FRAME):s.frameInfo.fileInfoExtended.depth>1?this.animatorStore.setAnimationMode(lS.CHANNEL):s.frameInfo.fileInfoExtended.stokes>1&&this.animatorStore.setAnimationMode(lS.STOKES),this.frames.length>1&&(this.preferenceStore.autoWCSMatching&mn.SPATIAL&&this.spatialReference!==s&&this.setSpatialMatchingEnabled(s,!0),this.preferenceStore.autoWCSMatching&mn.SPECTRAL&&this.spectralReference!==s&&s.frameInfo.fileInfoExtended.depth>1&&this.setSpectralMatchingEnabled(s,!0)),this.fileBrowserStore.saveStartingDirectory(s.frameInfo.directory),!0}}}),ov=Object(b.a)(gS.prototype,"appendConcatFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>(this.animatorStore.stopAnimation(),this.loadConcatStokes(e,t,i))}}),sv=Object(b.a)(gS.prototype,"openConcatFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>(this.removeAllFrames(),this.loadConcatStokes(e,t,i))}}),av=Object(b.a)(gS.prototype,"appendFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t,i,n)=>(this.animatorStore.stopAnimation(),this.loadFile(e,t,i,n))}}),lv=Object(b.a)(gS.prototype,"openFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>(this.removeAllFrames(),this.loadFile(e,t,i,n))}}),cv=Object(b.a)(gS.prototype,"closeFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t=!0)=>{if(!e)return;const i=e.secondarySpatialImages.concat(e.secondarySpectralImages).filter(E).length;if(t&&i){await this.alertStore.showInteractiveAlert(`${i} image${i>1?"s that are":" that is"} matched to this image will be unmatched.`)&&this.removeFrame(e)}else this.removeFrame(e);this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout)}}}),dv=Object(b.a)(gS.prototype,"closeCurrentFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!1)=>{this.appendFileDisabled||this.closeFile(this.activeFrame,e)}}}),pv=Object(b.a)(gS.prototype,"closeOtherFiles",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{const i=this.frames.filter((t=>t!==e));for(const n of i)this.closeFile(n,t)}}}),hv=Object(b.a)(gS.prototype,"removeFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){this.animatorStore.stopAnimation();const t=e.secondarySpatialImages.slice();for(const e of t)e.clearSpatialReference();const i=e.secondarySpectralImages.slice();for(const e of i)e.clearSpectralReference();const n=e===this.spatialReference,r=e===this.spectralReference,o=e===this.rasterScalingReference,s=e.frameInfo.fileId;if(WP.RemoveFrameFromRegionWidgets(this.widgetsStore.statsWidgets,s),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.histogramWidgets,s),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.spatialProfileWidgets,s),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.spectralProfileWidgets,s),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets,s),this.spectralRequirements.delete(s),this.spatialRequirements.delete(s),this.statsRequirements.delete(s),this.histogramRequirements.delete(s),this.tileService.handleFileClosed(s),this.telemetryService.addFileCloseEntry(s),this.backendService.closeFile(s)){e.clearSpatialReference(),e.clearSpectralReference(),e.clearContours(!1),this.frames=this.frames.filter((e=>e.frameInfo.fileId!==s));const t=this.frames.length?this.frames[0]:null;if(this.activeFrame.frameInfo.fileId===s&&(this.activeFrame=t),this.contourDataSource.frameInfo.fileId===s&&(this.contourDataSource=t),n){const e=t;e?this.setSpatialReference(e):this.clearSpatialReference()}if(r){const e=this.frames.filter((e=>e.frameInfo.fileInfoExtended.depth>1)),t=e.length?e[0]:null;t?this.setSpectralReference(t):this.clearSpectralReference()}if(o){const e=t;e?this.setRasterScalingReference(e):this.clearRasterScalingReference()}this.tileService.handleFileClosed(s),this.catalogNum&&(hM.Instance.closeAssociatedCatalog(s),t&&hM.Instance.resetActiveCatalogFile(t.frameInfo.fileId))}}}}}),uv=Object(b.a)(gS.prototype,"removeAllFrames",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.animatorStore.stopAnimation(),this.backendService.closeFile(-1)&&(this.activeFrame=null,this.tileService.clearCompressedCache(-1),this.frames.forEach((e=>{e.clearContours(!1);const t=e.frameInfo.fileId;this.telemetryService.addFileCloseEntry(t),this.tileService.handleFileClosed(t),this.catalogNum&&hM.Instance.closeAssociatedCatalog(t)})),this.frames=[],WP.RemoveFrameFromRegionWidgets(this.widgetsStore.statsWidgets),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.histogramWidgets),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.spatialProfileWidgets),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.spectralProfileWidgets),WP.RemoveFrameFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets))}}}),gv=Object(b.a)(gS.prototype,"shiftFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.activeFrame&&this.frames.length>1){const t=this.frames.map((e=>e.frameInfo.fileId)).indexOf(this.activeFrame.frameInfo.fileId),i=(this.frames.length+t+e)%this.frames.length;this.setActiveFrameByIndex(i)}}}}),fv=Object(b.a)(gS.prototype,"nextFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.shiftFrame(1)}}}),bv=Object(b.a)(gS.prototype,"prevFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.shiftFrame(-1)}}}),Object(b.a)(gS.prototype,"removeCatalog",[m.g],Object.getOwnPropertyDescriptor(gS.prototype,"removeCatalog"),gS.prototype),Object(b.a)(gS.prototype,"sendCatalogFilter",[m.g],Object.getOwnPropertyDescriptor(gS.prototype,"sendCatalogFilter"),gS.prototype),mv=Object(b.a)(gS.prototype,"reorderFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{!Number.isInteger(e)||e<0||e>=this.frameNum||!Number.isInteger(t)||t<0||t>=this.frameNum||!Number.isInteger(i)||i<=0||i>=this.frameNum||e===t||(this.frames=uS.a.reorderArray(this.frames,e,t,i))}}}),yv=Object(b.a)(gS.prototype,"addRegionsInBatch",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{if(!e||!t||!isFinite(i))return;const r=this.activeFrame,o=Math.min(i+n,e.length);for(let s=i;s<o;s++){const[i,n]=e[s],o=t.get(i);r.regionSet.addExistingRegion(n.controlPoints,n.rotation,n.regionType,parseInt(i),null===o||void 0===o?void 0:o.name,null===o||void 0===o?void 0:o.color,null===o||void 0===o?void 0:o.lineWidth,null===o||void 0===o?void 0:o.dashList)}this.fileBrowserStore.updateLoadingState(o/e.length,o,e.length)}}}),Ov=Object(b.a)(gS.prototype,"requestCubeHistogram",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.renderConfig.cubeHistogramProgress<1&&(this.backendService.setHistogramRequirements({fileId:t.frameInfo.fileId,regionId:-2,histograms:[{channel:-2,numBins:-1}]}),this.restartTaskProgress())}}}),jv=Object(b.a)(gS.prototype,"cancelCubeHistogramRequest",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.renderConfig.cubeHistogramProgress<1&&(t.renderConfig.updateCubeHistogram(null,0),this.backendService.setHistogramRequirements({fileId:t.frameInfo.fileId,regionId:-2,histograms:[]}))}}}),xv=Object(b.a)(gS.prototype,"requestMoment",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{if(e&&t){this.startFileLoading(),t.momentImages&&t.momentImages.length>0&&t.momentImages.forEach((e=>this.closeFile(e))),t.removeMomentImage(),this.restartTaskProgress();try{const i=await this.backendService.requestMoment(e);if(!i.cancel&&i.openFileAcks)for(const e of i.openFileAcks)this.addFrame(Nt.OpenFileAck.create(e),this.fileBrowserStore.startingDirectory,"",!0)?(this.fileCounter++,t.addMomentImage(this.frames.find((t=>t.frameInfo.fileId===e.fileId)))):v.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3});t.resetMomentRequestState(),this.endFileLoading()}catch(i){t.resetMomentRequestState(),this.endFileLoading(),console.error(i)}}}}}),Sv=Object(b.a)(gS.prototype,"cancelRequestingMoment",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.requestingMomentsProgress<1&&this.backendService.cancelRequestingMoment(e)}}}),vv=Object(b.a)(gS.prototype,"requestPV",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{if(e&&t){this.startFileLoading(),t.pvImage&&this.closeFile(t.pvImage),t.removePvImage(),this.restartTaskProgress();try{const i=await this.backendService.requestPV(e);!i.cancel&&i.openFileAck&&(this.addFrame(Nt.OpenFileAck.create(i.openFileAck),this.fileBrowserStore.startingDirectory,"",!0)?(this.fileCounter++,t.addPvImage(this.frames.find((e=>e.frameInfo.fileId===i.openFileAck.fileId)))):v.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3})),t.resetPvRequestState(),t.setIsRequestPVCancelling(!1),this.endFileLoading()}catch(i){t.resetPvRequestState(),t.setIsRequestPVCancelling(!1),this.endFileLoading(),console.error(i),v.show(I(i))}}}}}),Cv=Object(b.a)(gS.prototype,"cancelRequestingPV",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.requestingPVProgress<1&&this.backendService.cancelRequestingPV(e)}}}),Iv=Object(b.a)(gS.prototype,"setAstReady",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.astReady=e}}}),wv=Object(b.a)(gS.prototype,"setDarkTheme",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setTheme(Ti.DARK)}}}),Tv=Object(b.a)(gS.prototype,"setLightTheme",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setTheme(Ti.LIGHT)}}}),Rv=Object(b.a)(gS.prototype,"setAutoTheme",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setTheme(Ti.AUTO)}}}),Av=Object(b.a)(gS.prototype,"setTheme",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{Ti.isValid(e)&&(this.preferenceStore.setPreference(QA.GLOBAL_THEME,e),this.updateASTColors())}}}),Pv=Object(b.a)(gS.prototype,"toggleCursorFrozen",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.cursorFrozen=!this.cursorFrozen}}}),Ev=Object(b.a)(gS.prototype,"setCursorFrozen",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorFrozen=e}}}),Mv=Object(b.a)(gS.prototype,"toggleToolbarExpanded",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.toolbarExpanded=!this.toolbarExpanded}}}),Fv=Object(b.a)(gS.prototype,"setToolbarExpanded",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.toolbarExpanded=e}}}),kv=Object(b.a)(gS.prototype,"updateActiveLayer",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.activeLayer=e}}}),Dv=Object(b.a)(gS.prototype,"toggleActiveLayer",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.activeLayer=this.activeLayer===_G.RegionCreating?_G.RegionMoving:_G.RegionCreating}}}),Lv=Object(b.a)(gS.prototype,"setImageRatio",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{for(const t of this.frames)t.spatialReference||t.setZoom(t.zoomLevel*e/this.imageRatio);this.imageRatio=e}}}),Nv=Object(b.a)(gS.prototype,"setIsExportingImage",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isExportingImage=e}}}),_v=Object(b.a)(gS.prototype,"setIsCanvasUpdated",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isCanvasUpdated=e}}}),zv=Object(b.a)(gS.prototype,"updateChannels",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e&&e.length)for(const t of e){const e=t.frame;if(!e)return;if(e.channel=t.channel,e.stokes=t.stokes,this.visibleFrames.includes(e)){const t=e.requiredFrameView,i=jm({xMin:Math.max(0,t.xMin),xMax:Math.min(e.frameInfo.fileInfoExtended.width,t.xMax),yMin:Math.max(0,t.yMin),yMax:Math.min(e.frameInfo.fileInfoExtended.height,t.yMax),mip:t.mip},{x:e.frameInfo.fileInfoExtended.width,y:e.frameInfo.fileInfoExtended.height},{x:256,y:256}),n={x:(t.xMax+t.xMin)/2,y:(t.yMin+t.yMax)/2},r=256*t.mip,o={x:n.x/r-.5,y:n.y/r-.5};this.tileService.requestTiles(i,e.frameInfo.fileId,e.channel,e.stokes,o,this.preferenceStore.imageCompressionQuality,!0)}else this.tileService.updateHiddenFileChannels(e.frameInfo.fileId,e.channel,e.stokes)}}}}),Vv=Object(b.a)(gS.prototype,"handleSpatialProfileStream",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.frames.find((t=>t.frameInfo.fileId===e.fileId))){const t=`${e.fileId}-${e.regionId}`;let i=this.spatialProfiles.get(t);i||(i=new vA(e.fileId,e.regionId),this.spatialProfiles.set(t,i)),i.updateFromStream(e),0===e.regionId&&this.getFrame(e.fileId).setCursorValue({x:e.x,y:e.y},e.channel,e.value)}}}}),Wv=Object(b.a)(gS.prototype,"handleTileStream",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.animatorStore.serverAnimationActive){var t;const i=this.getFrame(e.fileId),n={fileId:e.fileId,animationId:0,receivedFrame:{channel:e.channel,stokes:null!==(t=null===i||void 0===i?void 0:i.requiredPolarizationIndex)&&void 0!==t?t:e.stokes},timestamp:pS.fromNumber(Date.now())};this.backendService.sendAnimationFlowControl(n),i&&(i.setChannels(e.channel,e.stokes,!1),i.channel=e.channel,i.stokes=e.stokes)}const i=`${e.fileId}_${e.stokes}_${e.channel}`,n=this.pendingChannelHistograms.get(i);if(null===n||void 0===n?void 0:n.histograms){const t=this.getFrame(n.fileId),r=n.histograms;if(t&&r){const i=Qn.has(n.stokes)&&t.polarizations.includes(n.stokes)?t.polarizations.indexOf(n.stokes):n.stokes;t.renderConfig.setStokesIndex(i),t.renderConfig.setHistChannel(n.channel),t.renderConfig.updateChannelHistogram(r),t.channel=e.channel,t.stokes=e.stokes}this.pendingChannelHistograms.delete(i)}}}}),Gv=Object(b.a)(gS.prototype,"handleRegionStatsStream",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!e)return;let t=this.regionStats.get(e.fileId);t||(t=new m.b,this.regionStats.set(e.fileId,t));let i=t.get(e.regionId);i||(i=new m.b,t.set(e.regionId,i)),i.set(e.stokes,e)}}}),Bv=Object(b.a)(gS.prototype,"handleCatalogFilterStream",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.fileId,i=this.catalogStore.catalogProfileStores.get(t),n=this.catalogStore.catalogWidgets.get(t),r=e.progress;if(i){const o=$m.ProcessCatalogData(e.columns);if(i.updateCatalogData(e,o),i.setProgress(r),1===r&&(i.setLoadingDataStatus(!1),i.setUpdatingDataStream(!1)),i.updateMode===DM.ViewUpdate){const r=this.widgetsStore.catalogWidgets.get(n),s=r.xAxis,a=r.yAxis,l=this.getFrame(this.catalogStore.getFrameIdByCatalogId(t));if(s&&a&&l){const n=i.get2DPlotData(s,a,o),r=l.validWcs?l.wcsInfo:0;this.catalogStore.convertToImageCoordinate(t,n.wcsX,n.wcsY,r,n.xHeaderInfo.units,n.yHeaderInfo.units,i.catalogCoordinateSystem.system,e.subsetEndIndex,e.subsetDataSize)}}}}}}),qv=Object(b.a)(gS.prototype,"resumeSession",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{this.animatorStore.stopAnimation(),this.tileService.clearRequestQueue();this.frames.filter((e=>e.frameInfo.fileId>=1e3)).forEach((e=>this.removeFrame(e)));const e=this.frames.map((e=>{const t=e.frameInfo;let i,n=new Map;if(!e.spatialReference){n=new Map;for(const t of e.regionSet.regions)n.set(t.regionId.toFixed(),{regionType:t.regionType,controlPoints:t.controlPoints,rotation:t.rotation})}return e.contourConfig.enabled&&(i={fileId:e.frameInfo.fileId,levels:e.contourConfig.levels,smoothingMode:e.contourConfig.smoothingMode,smoothingFactor:e.contourConfig.smoothingFactor,decimationFactor:this.preferenceStore.contourDecimation,compressionLevel:this.preferenceStore.contourCompressionLevel,contourChunkSize:this.preferenceStore.contourChunkSize}),{file:t.fileInfo.name,directory:t.directory,hdu:t.hdu,fileId:t.fileId,renderMode:t.renderMode,channel:e.requiredChannel,stokes:e.requiredStokes,regions:rn(n),contourSettings:i,stokesFiles:e.stokesFiles}})),t=[];this.catalogStore.catalogProfileStores.forEach((e=>{const i=e.catalogInfo;t.find((e=>e.fileId===i.fileId))||t.push({fileId:i.fileId,name:i.fileInfo.name,directory:i.directory})})),this.resumingSession=!0;try{await this.backendService.resumeSession({images:e,catalogFiles:t}),this.onSessionResumed()}catch(i){console.error(i),this.alertStore.showAlert("Error resuming session")}}}}),Hv=Object(b.a)(gS.prototype,"onSessionResumed",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{console.log("Resumed successfully"),this.initRequirements(),this.resumingSession=!1,this.backendService.connectionDropped=!1}}}),Yv=Object(b.a)(gS.prototype,"setActiveFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.animatorStore.serverAnimationActive||this.changeActiveFrame(e))}}}),Uv=Object(b.a)(gS.prototype,"setActiveFrameById",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.getFrame(e);t?this.setActiveFrame(t):console.log(`Can't find required frame ${e}`)}}}),Object(b.a)(gS.prototype,"setActiveFrameByIndex",[m.g],Object.getOwnPropertyDescriptor(gS.prototype,"setActiveFrameByIndex"),gS.prototype),Object(b.a)(gS.prototype,"setHoveredFrame",[m.g],Object.getOwnPropertyDescriptor(gS.prototype,"setHoveredFrame"),gS.prototype),Xv=Object(b.a)(gS.prototype,"setContourDataSource",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.contourDataSource=e,this.syncFrameToContour&&this.setActiveFrame(e)}}}),Object(b.a)(gS.prototype,"frameLockedToContour",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"frameLockedToContour"),gS.prototype),$v=Object(b.a)(gS.prototype,"toggleFrameContourLock",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.frameLockedToContour?(this.syncFrameToContour=!1,this.syncContourToFrame=!1):(this.syncContourToFrame=!0,this.syncFrameToContour=!0,this.contourDataSource=this.activeFrame)}}}),Object(b.a)(gS.prototype,"selectedRegion",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"selectedRegion"),gS.prototype),Kv=Object(b.a)(gS.prototype,"deleteSelectedRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.activeFrame&&this.activeFrame.regionSet&&this.activeFrame.regionSet.selectedRegion&&!this.activeFrame.regionSet.selectedRegion.locked&&this.deleteRegion(this.activeFrame.regionSet.selectedRegion)}}}),Qv=Object(b.a)(gS.prototype,"deleteRegion",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){const t=this.getFrame(e.fileId),i=e.regionId;WP.RemoveRegionFromRegionWidgets(this.widgetsStore.statsWidgets,e.fileId,i),WP.RemoveRegionFromRegionWidgets(this.widgetsStore.histogramWidgets,e.fileId,i),WP.RemoveRegionFromRegionWidgets(this.widgetsStore.spectralProfileWidgets,e.fileId,i),WP.RemoveRegionFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets,e.fileId,i),t&&t.regionSet.deleteRegion(e)}}}}),Zv=Object(b.a)(gS.prototype,"setSpatialReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.spatialReference,i=t&&t.secondarySpatialImages.includes(e);this.spatialReference=e,i&&t.setSpatialReference(e);for(const n of this.frames)n===e?n.clearSpatialReference():n.spatialReference&&n.setSpatialReference(e);(null===t||void 0===t?void 0:t.secondarySpatialImages.length)&&(t.secondarySpatialImages=[])}}}),Jv=Object(b.a)(gS.prototype,"clearSpatialReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spatialReference=null;for(const e of this.frames)e.clearSpatialReference()}}}),eC=Object(b.a)(gS.prototype,"setSpatialMatchingEnabled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.spatialReference&&(t?e.setSpatialReference(this.spatialReference)||v.show(w(`Could not enable spatial matching of ${e.filename} to reference image ${this.spatialReference.filename}. No valid transform was found.`)):e.clearSpatialReference())}}}),tC=Object(b.a)(gS.prototype,"toggleSpatialMatching",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.spatialReference&&this.setSpatialMatchingEnabled(e,!e.spatialReference)}}}),iC=Object(b.a)(gS.prototype,"setSpectralReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.spectralReference,i=t&&t.secondarySpectralImages.includes(e);this.spectralReference=e,i&&t.setSpectralReference(e);for(const n of this.frames)n===e?n.clearSpectralReference():n.spectralReference&&n.setSpectralReference(e)}}}),nC=Object(b.a)(gS.prototype,"clearSpectralReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralReference=null;for(const e of this.frames)e.clearSpectralReference()}}}),rC=Object(b.a)(gS.prototype,"setSpectralMatchingEnabled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.spectralReference&&(t?e.setSpectralReference(this.spectralReference)||v.show(w(`Could not enable spectral matching (velocity system) of ${e.filename} to reference image ${this.spectralReference.filename}. No valid transform was found`)):e.clearSpectralReference())}}}),oC=Object(b.a)(gS.prototype,"toggleSpectralMatching",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.spectralReference&&this.setSpectralMatchingEnabled(e,!e.spectralReference)}}}),sC=Object(b.a)(gS.prototype,"setRasterScalingReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.rasterScalingReference,i=t&&t.secondaryRasterScalingImages.includes(e);this.rasterScalingReference=e,i&&t.setRasterScalingReference(e);for(const n of this.frames)n===e?n.clearRasterScalingReference():n.rasterScalingReference&&n.setRasterScalingReference(e)}}}),aC=Object(b.a)(gS.prototype,"clearRasterScalingReference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.rasterScalingReference=null;for(const e of this.frames)e.clearRasterScalingReference()}}}),lC=Object(b.a)(gS.prototype,"setRasterScalingMatchingEnabled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.rasterScalingReference&&(t?e.setRasterScalingReference(this.rasterScalingReference):e.clearRasterScalingReference())}}}),cC=Object(b.a)(gS.prototype,"toggleRasterScalingMatching",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.rasterScalingReference&&this.setRasterScalingMatchingEnabled(e,!e.rasterScalingReference)}}}),dC=Object(b.a)(gS.prototype,"setMatchingEnabled",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.setSpatialMatchingEnabled(this.activeFrame,e),this.setSpectralMatchingEnabled(this.activeFrame,t)}}}),Object(b.a)(gS.prototype,"numImagePages",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"numImagePages"),gS.prototype),Object(b.a)(gS.prototype,"currentImagePage",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"currentImagePage"),gS.prototype),Object(b.a)(gS.prototype,"visibleFrames",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"visibleFrames"),gS.prototype),Object(b.a)(gS.prototype,"numImageColumns",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"numImageColumns"),gS.prototype),Object(b.a)(gS.prototype,"numImageRows",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"numImageRows"),gS.prototype),Object(b.a)(gS.prototype,"imagesPerPage",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"imagesPerPage"),gS.prototype),Object(b.a)(gS.prototype,"imagePanelMode",[m.i],Object.getOwnPropertyDescriptor(gS.prototype,"imagePanelMode"),gS.prototype),gS);var fC,bC,mC,yC,OC,jC,xC,SC,vC,CC,IC,wC,TC,RC,AC,PC,EC,MC,FC,kC,DC,LC,NC,_C,zC,VC,WC,GC,BC,qC,HC,YC,UC,XC,$C,KC,QC,ZC,JC,eI,tI,iI,nI,rI,oI,sI,aI,lI,cI,dI,pI,hI,uI,gI,fI,bI,mI,yI,OI,jI,xI,SI,vI,CI,II,wI,TI,RI,AI,PI,EI,MI,FI,kI;let DI,LI;!function(e){e[e.File=0]="File",e[e.SaveFile=1]="SaveFile",e[e.RegionImport=2]="RegionImport",e[e.RegionExport=3]="RegionExport",e[e.Catalog=4]="Catalog"}(DI||(DI={})),function(e){e.Fuzzy="fuzzy",e.Unix="unix",e.Regex="regex"}(LI||(LI={}));let NI=(kI=FI=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"browserMode",bC,this),Object(f.a)(this,"appendingFrame",mC,this),Object(f.a)(this,"fileList",yC,this),Object(f.a)(this,"selectedFile",OC,this),Object(f.a)(this,"selectedHDU",jC,this),Object(f.a)(this,"HDUfileInfoExtended",xC,this),Object(f.a)(this,"regionFileInfo",SC,this),Object(f.a)(this,"selectedTab",vC,this),Object(f.a)(this,"loadingList",CC,this),Object(f.a)(this,"isImportingRegions",IC,this),Object(f.a)(this,"extendedLoading",wC,this),Object(f.a)(this,"loadingInfo",TC,this),Object(f.a)(this,"fileInfoResp",RC,this),Object(f.a)(this,"responseErrorMessage",AC,this),Object(f.a)(this,"startingDirectory",PC,this),Object(f.a)(this,"exportFilename",EC,this),Object(f.a)(this,"exportCoordinateType",MC,this),Object(f.a)(this,"exportFileType",FC,this),Object(f.a)(this,"exportRegionIndexes",kC,this),Object(f.a)(this,"catalogFileList",DC,this),Object(f.a)(this,"selectedCatalogFile",LC,this),Object(f.a)(this,"catalogFileInfo",NC,this),Object(f.a)(this,"catalogHeaders",_C,this),Object(f.a)(this,"saveFilename",zC,this),Object(f.a)(this,"saveFileType",VC,this),Object(f.a)(this,"saveSpectralRange",WC,this),Object(f.a)(this,"saveStokesOption",GC,this),Object(f.a)(this,"saveRegionId",BC,this),Object(f.a)(this,"saveRestFreq",qC,this),Object(f.a)(this,"shouldDropDegenerateAxes",HC,this),this.extendedDelayHandle=void 0,Object(f.a)(this,"selectedFiles",YC,this),Object(f.a)(this,"isLoadingDialogOpen",UC,this),Object(f.a)(this,"loadingProgress",XC,this),Object(f.a)(this,"loadingCheckedCount",$C,this),Object(f.a)(this,"loadingTotalCount",KC,this),Object(f.a)(this,"setImportingRegions",QC,this),Object(f.a)(this,"showFileBrowser",ZC,this),Object(f.a)(this,"hideFileBrowser",JC,this),Object(f.a)(this,"setFileList",eI,this),Object(f.a)(this,"setCatalogFileList",tI,this),Object(f.a)(this,"setExtendedLoading",iI,this),Object(f.a)(this,"getFileList",nI,this),Object(f.a)(this,"getFileInfo",rI,this),Object(f.a)(this,"getRegionFileInfo",oI,this),Object(f.a)(this,"getCatalogFileInfo",sI,this),Object(f.a)(this,"initialSaveSpectralRange",aI,this),this.getConcatFilesHeader=async(e,t,i)=>{const n=await tx.Instance.getFileInfo(e,t,i);return{file:n.fileInfo.name,info:n.fileInfoExtended}},Object(f.a)(this,"selectFile",lI,this),Object(f.a)(this,"selectFolder",cI,this),Object(f.a)(this,"selectHDU",dI,this),Object(f.a)(this,"setExportFilename",pI,this),Object(f.a)(this,"setExportCoordinateType",hI,this),Object(f.a)(this,"setExportFileType",uI,this),Object(f.a)(this,"resetExportRegionIndexes",gI,this),Object(f.a)(this,"clearExportRegionIndexes",fI,this),Object(f.a)(this,"addExportRegionIndex",bI,this),Object(f.a)(this,"deleteExportRegionIndex",mI,this),Object(f.a)(this,"setSaveFilename",yI,this),Object(f.a)(this,"setSaveFileType",OI,this),Object(f.a)(this,"setSortingConfig",jI,this),Object(f.a)(this,"setSaveRegionId",xI,this),Object(f.a)(this,"setSaveSpectralRangeMin",SI,this),Object(f.a)(this,"setSaveSpectralRangeMax",vI,this),Object(f.a)(this,"setSelectedFiles",CI,this),Object(f.a)(this,"showLoadingDialog",II,this),Object(f.a)(this,"updateLoadingState",wI,this),Object(f.a)(this,"resetLoadingStates",TI,this),Object(f.a)(this,"cancelRequestingFileList",RI,this),Object(f.a)(this,"showExportRegions",AI,this),Object(f.a)(this,"setSaveRestFreqVal",PI,this),Object(f.a)(this,"setSaveRestFreqUnit",EI,this),Object(f.a)(this,"setSaveRestFreq",MI,this),this.resetSaveRestFreq=()=>{var e;const t=null===(e=gC.Instance.activeFrame)||void 0===e?void 0:e.restFreqStore;t&&this.setSaveRestFreq(t.headerRestFreq)},Object(m.p)(this),this.exportCoordinateType=Nt.CoordinateType.WORLD,this.exportFileType=Nt.FileType.CRTF,Object(m.h)((()=>{const t=gC.Instance.activeFrame;var i;t&&(e.Instance.initialSaveSpectralRange(),this.setSaveFileType((null===(i=t.frameInfo)||void 0===i?void 0:i.fileInfo.type)===Nt.FileType.CASA?Nt.FileType.CASA:Nt.FileType.FITS),this.resetExportRegionIndexes(),this.setSaveRestFreq(Object.assign({},t.restFreqStore.customRestFreq)))}))}setExtendedDelayTimer(){this.clearExtendedDelayTimer(),this.extendedDelayHandle=setTimeout((()=>this.setExtendedLoading(!0)),e.ExtendedLoadingDelay)}clearExtendedDelayTimer(e=!1){this.extendedDelayHandle&&(clearTimeout(this.extendedDelayHandle),this.extendedDelayHandle=null),e&&this.setExtendedLoading(!1)}selectParent(){const e=this.getfileListByMode;e&&e.parent&&this.getFileList(e.parent)}setSelectedTab(e){this.selectedTab=e}saveStartingDirectory(e){this.setStartingDirectory(e);const t=JA.Instance;t.keepLastUsedFolder?t.setPreference(QA.GLOBAL_SAVED_LAST_FOLDER,this.startingDirectory):t.setPreference(QA.GLOBAL_SAVED_LAST_FOLDER,"")}setStartingDirectory(e){void 0!==e?this.startingDirectory=e:this.browserMode===DI.Catalog?this.startingDirectory=this.catalogFileList.directory:this.startingDirectory=this.fileList.directory}restoreStartingDirectory(){const e=JA.Instance;var t;e.keepLastUsedFolder&&((null===(t=e.lastUsedFolder)||void 0===t?void 0:t.length)>0?this.startingDirectory=e.lastUsedFolder:e.setPreference(QA.GLOBAL_SAVED_LAST_FOLDER,""))}get saveRestFreqInHz(){if(isFinite(this.saveRestFreq.value))return or.convertUnitToHz(this.saveRestFreq)}get HDUList(){var e;return this.HDUfileInfoExtended?null===(e=Object.keys(this.HDUfileInfoExtended))||void 0===e?void 0:e.map((e=>{var t,i,n,r;return{label:`${e}${(null===(t=this.HDUfileInfoExtended[e])||void 0===t||null===(i=t.computedEntries)||void 0===i?void 0:i.length)>=3&&"Extension name"===(null===(n=this.HDUfileInfoExtended[e].computedEntries[2])||void 0===n?void 0:n.name)?`: ${null===(r=this.HDUfileInfoExtended[e].computedEntries[2])||void 0===r?void 0:r.value}`:""}`,value:e}})):null}get fileInfoExtended(){return this.HDUfileInfoExtended&&this.selectedHDU in this.HDUfileInfoExtended?this.HDUfileInfoExtended[this.selectedHDU]:null}get isComplexImage(){var e,t;const i=null===(e=this.fileInfoExtended)||void 0===e||null===(t=e.computedEntries)||void 0===t?void 0:t.find((e=>"Data type"===e.name));return"Complex"===(null===i||void 0===i?void 0:i.value)}get fileInfo(){var e;let t="";return(null===(e=this.fileInfoExtended)||void 0===e?void 0:e.computedEntries)&&this.fileInfoExtended.computedEntries.forEach((e=>{t+=`${e.name} = ${e.value}\n`})),t}get headers(){var e;let t="";return(null===(e=this.fileInfoExtended)||void 0===e?void 0:e.headerEntries)&&this.fileInfoExtended.headerEntries.forEach((e=>{"END"===e.name?t+=`${e.name}\n`:t+=`${e.name} = ${e.value}\n`})),t}get getfileListByMode(){switch(this.browserMode){case DI.Catalog:return this.catalogFileList;default:return this.fileList}}get getBrowserMode(){switch(this.browserMode){case DI.File:return DL.IMAGE_FILE;case DI.SaveFile:return DL.SAVE_IMAGE;case DI.Catalog:return DL.CATALOG_FILE;case DI.RegionExport:return DL.SELECT_REGION;default:return DL.REGION_FILE}}get catalogHeaderDataset(){const e=[],t=[],i=[],n=[];for(let s=0;s<this.catalogHeaders.length;s++){const r=this.catalogHeaders[s];e.push(r.name),t.push(r.units),i.push(Wm(r.dataType)),n.push(r.description)}const r=Nt.ColumnType.String,o=new Map([[0,{dataType:r,data:e}],[1,{dataType:r,data:t}],[2,{dataType:r,data:i}],[3,{dataType:r,data:n}]]);return{columnHeaders:[new Nt.CatalogHeader({name:"Name",dataType:r,columnIndex:0}),new Nt.CatalogHeader({name:"Unit",dataType:r,columnIndex:1}),new Nt.CatalogHeader({name:"Data Type",dataType:r,columnIndex:2}),new Nt.CatalogHeader({name:"Description",dataType:r,columnIndex:3})],columnsData:o}}get saveStokesRange(){return[[],[0,0,1],[1,1,1],[2,2,1],[3,3,1],[0,1,1],[1,2,1],[2,3,1],[0,2,2],[0,3,3],[1,3,2],[0,2,1],[1,3,1]][this.saveStokesOption]}get exportRegionOptions(){var e;let t=[];const i=gC.Instance,n=i.activeFrame;if(null===n||void 0===n||null===(e=n.regionSet)||void 0===e?void 0:e.regions){const e=i.selectedRegion?i.selectedRegion.regionId:Br.CURSOR;n.regionSet.regions.forEach(((i,n)=>{i.regionId!==Br.CURSOR&&t.push({value:n,label:i.nameString,active:i.regionId===e,icon:Ob.RegionIconString(i.regionType),isCustomIcon:Ob.IsRegionCustomIcon(i.regionType)})}))}return t}get regionOptionNum(){var e;return null===(e=this.exportRegionOptions)||void 0===e?void 0:e.length}get exportRegionNum(){var e;return null===(e=this.exportRegionIndexes)||void 0===e?void 0:e.length}},FI.staticInstance=void 0,FI.ExtendedLoadingDelay=500,fC=kI,bC=Object(b.a)(fC.prototype,"browserMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return DI.File}}),mC=Object(b.a)(fC.prototype,"appendingFrame",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),yC=Object(b.a)(fC.prototype,"fileList",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OC=Object(b.a)(fC.prototype,"selectedFile",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jC=Object(b.a)(fC.prototype,"selectedHDU",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xC=Object(b.a)(fC.prototype,"HDUfileInfoExtended",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SC=Object(b.a)(fC.prototype,"regionFileInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vC=Object(b.a)(fC.prototype,"selectedTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return DL.IMAGE_FILE}}),CC=Object(b.a)(fC.prototype,"loadingList",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),IC=Object(b.a)(fC.prototype,"isImportingRegions",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),wC=Object(b.a)(fC.prototype,"extendedLoading",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),TC=Object(b.a)(fC.prototype,"loadingInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),RC=Object(b.a)(fC.prototype,"fileInfoResp",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AC=Object(b.a)(fC.prototype,"responseErrorMessage",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),PC=Object(b.a)(fC.prototype,"startingDirectory",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$BASE"}}),EC=Object(b.a)(fC.prototype,"exportFilename",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MC=Object(b.a)(fC.prototype,"exportCoordinateType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FC=Object(b.a)(fC.prototype,"exportFileType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kC=Object(b.a)(fC.prototype,"exportRegionIndexes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),DC=Object(b.a)(fC.prototype,"catalogFileList",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LC=Object(b.a)(fC.prototype,"selectedCatalogFile",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NC=Object(b.a)(fC.prototype,"catalogFileInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_C=Object(b.a)(fC.prototype,"catalogHeaders",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zC=Object(b.a)(fC.prototype,"saveFilename",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),VC=Object(b.a)(fC.prototype,"saveFileType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Nt.FileType.CASA}}),WC=Object(b.a)(fC.prototype,"saveSpectralRange",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return["0","0"]}}),GC=Object(b.a)(fC.prototype,"saveStokesOption",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BC=Object(b.a)(fC.prototype,"saveRegionId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qC=Object(b.a)(fC.prototype,"saveRestFreq",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{value:0,unit:Ht.MHZ}}}),HC=Object(b.a)(fC.prototype,"shouldDropDegenerateAxes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YC=Object(b.a)(fC.prototype,"selectedFiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UC=Object(b.a)(fC.prototype,"isLoadingDialogOpen",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XC=Object(b.a)(fC.prototype,"loadingProgress",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$C=Object(b.a)(fC.prototype,"loadingCheckedCount",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KC=Object(b.a)(fC.prototype,"loadingTotalCount",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QC=Object(b.a)(fC.prototype,"setImportingRegions",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isImportingRegions=e}}}),ZC=Object(b.a)(fC.prototype,"showFileBrowser",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{var i;switch(e){case DI.SaveFile:if(gC.Instance.appendFileDisabled||(null===(i=gC.Instance.backendService)||void 0===i?void 0:i.serverFeatureFlags)===Nt.ServerFeatureFlags.READ_ONLY)return;break;case DI.File:if(!t&&gC.Instance.openFileDisabled)return;if(t&&gC.Instance.appendFileDisabled)return;break;case DI.Catalog:default:if(gC.Instance.appendFileDisabled)return}this.appendingFrame=t,this.browserMode=e,tM.Instance.showFileBrowserDialog(),this.fileList=null,this.selectedTab=this.getBrowserMode,this.responseErrorMessage="",this.exportFilename="",this.catalogFileList=null,this.getFileList(this.startingDirectory),gC.Instance.activeFrame&&e===DI.SaveFile&&(this.saveFilename=gC.Instance.activeFrame.frameInfo.fileInfo.name),this.initialSaveSpectralRange(),this.saveRegionId=0,this.shouldDropDegenerateAxes=!1}}}),JC=Object(b.a)(fC.prototype,"hideFileBrowser",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{tM.Instance.hideFileBrowserDialog()}}}),eI=Object(b.a)(fC.prototype,"setFileList",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileList=e}}}),tI=Object(b.a)(fC.prototype,"setCatalogFileList",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogFileList=e}}}),iI=Object(b.a)(fC.prototype,"setExtendedLoading",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.extendedLoading=e}}}),nI=Object(b.a)(fC.prototype,"getFileList",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e="")=>{const t=gC.Instance;this.loadingList=!0,this.setExtendedDelayTimer(),this.selectedFile=null,this.selectedHDU=null,this.HDUfileInfoExtended=null,this.regionFileInfo=null,this.catalogFileInfo=null;const i=rr(t.preferenceStore.fileFilterMode);gC.Instance.restartTaskProgress();try{if(this.browserMode===DI.File||this.browserMode===DI.SaveFile){const n=await t.backendService.getFileList(e,i);this.setFileList(n)}else if(this.browserMode===DI.Catalog){const n=await t.backendService.getCatalogList(e,i);this.setCatalogFileList(n)}else{const n=await t.backendService.getRegionList(e,i);this.setFileList(n)}}catch(n){console.log(n),v.show(I(`Error loading file list for directory ${e}`))}this.loadingList=!1,this.resetLoadingStates()}}}),rI=Object(b.a)(fC.prototype,"getFileInfo",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t,i)=>{const n=tx.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.HDUfileInfoExtended=null,this.responseErrorMessage="";try{const r=await n.getFileInfo(e,t,i);Object(m.t)((()=>{if(r.fileInfo&&this.selectedFile&&r.fileInfo.name===this.selectedFile.name){this.HDUfileInfoExtended=r.fileInfoExtended;const e=Object.keys(this.HDUfileInfoExtended);(null===e||void 0===e?void 0:e.length)>=1&&(this.selectedHDU=e[0]),this.loadingInfo=!1}this.fileInfoResp=!0}))}catch(r){Object(m.t)((()=>{console.log(r),this.responseErrorMessage=r,this.fileInfoResp=!1,this.HDUfileInfoExtended=null,this.loadingInfo=!1}))}}}}),oI=Object(b.a)(fC.prototype,"getRegionFileInfo",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{const i=tx.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.regionFileInfo=null,this.responseErrorMessage="";try{const n=await i.getRegionFileInfo(e,t);Object(m.t)((()=>{n.fileInfo&&this.selectedFile&&n.fileInfo.name===this.selectedFile.name&&(this.loadingInfo=!1,this.regionFileInfo=n.contents),this.fileInfoResp=!0}))}catch(n){Object(m.t)((()=>{console.log(n),this.responseErrorMessage=n,this.fileInfoResp=!1,this.regionFileInfo=null,this.loadingInfo=!1}))}}}}),sI=Object(b.a)(fC.prototype,"getCatalogFileInfo",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{const i=tx.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.catalogFileInfo=null,this.catalogHeaders=[],this.responseErrorMessage="";try{const n=await i.getCatalogFileInfo(e,t);Object(m.t)((()=>{n.fileInfo&&this.selectedFile&&n.fileInfo.name===this.selectedFile.name&&(this.loadingInfo=!1,this.catalogFileInfo=n.fileInfo,this.catalogHeaders=n.headers.sort(((e,t)=>e.columnIndex-t.columnIndex))),this.fileInfoResp=!0}))}catch(n){console.log(n),this.responseErrorMessage=n,this.fileInfoResp=!1,this.catalogFileInfo=null,this.loadingInfo=!1}}}}),aI=Object(b.a)(fC.prototype,"initialSaveSpectralRange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=gC.Instance.activeFrame;if(e&&e.numChannels>1){const t=Math.min(e.channelValueBounds.max,e.channelValueBounds.min),i=Math.max(e.channelValueBounds.max,e.channelValueBounds.min),n=(i-t)/(e.numChannels-1);this.saveSpectralRange=[t.toString(),i.toString(),n.toString()]}}}}),lI=Object(b.a)(fC.prototype,"selectFile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.getfileListByMode;this.selectedFile=e.fileInfo,e.hdu&&(this.selectedHDU=e.hdu),this.browserMode===DI.File?this.getFileInfo(t.directory,e.fileInfo.name,e.hdu):this.browserMode===DI.SaveFile?(this.getFileInfo(t.directory,e.fileInfo.name,e.hdu),this.saveFilename=e.fileInfo.name):this.browserMode===DI.Catalog?this.getCatalogFileInfo(t.directory,e.fileInfo.name):(this.setExportFilename(e.fileInfo.name),this.getRegionFileInfo(t.directory,e.fileInfo.name))}}}),cI=Object(b.a)(fC.prototype,"selectFolder",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{if(t)return void this.getFileList(e);const i=this.getfileListByMode;if(".."===e)this.selectParent();else if(i){const t=i.directory;let n=e;!(null===t||void 0===t?void 0:t.length)||1===t.length&&"/"===t[0]||(n=`${t}/${e}`),this.getFileList(n)}}}}),Object(b.a)(fC.prototype,"selectParent",[m.g],Object.getOwnPropertyDescriptor(fC.prototype,"selectParent"),fC.prototype),dI=Object(b.a)(fC.prototype,"selectHDU",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e in this.HDUfileInfoExtended&&(this.selectedHDU=e)}}}),Object(b.a)(fC.prototype,"setSelectedTab",[m.g],Object.getOwnPropertyDescriptor(fC.prototype,"setSelectedTab"),fC.prototype),Object(b.a)(fC.prototype,"saveStartingDirectory",[m.g],Object.getOwnPropertyDescriptor(fC.prototype,"saveStartingDirectory"),fC.prototype),Object(b.a)(fC.prototype,"setStartingDirectory",[m.g],Object.getOwnPropertyDescriptor(fC.prototype,"setStartingDirectory"),fC.prototype),Object(b.a)(fC.prototype,"restoreStartingDirectory",[m.g],Object.getOwnPropertyDescriptor(fC.prototype,"restoreStartingDirectory"),fC.prototype),pI=Object(b.a)(fC.prototype,"setExportFilename",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportFilename=e}}}),hI=Object(b.a)(fC.prototype,"setExportCoordinateType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportCoordinateType=e}}}),uI=Object(b.a)(fC.prototype,"setExportFileType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportFileType=e}}}),gI=Object(b.a)(fC.prototype,"resetExportRegionIndexes",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e,t;(null===(e=gC.Instance.activeFrame)||void 0===e||null===(t=e.regionSet)||void 0===t?void 0:t.regions)?this.exportRegionIndexes=Array.from(gC.Instance.activeFrame.regionSet.regions.keys()).slice(1):this.exportRegionIndexes=[]}}}),fI=Object(b.a)(fC.prototype,"clearExportRegionIndexes",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.exportRegionIndexes=[]}}}),bI=Object(b.a)(fC.prototype,"addExportRegionIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportRegionIndexes.includes(e)||(this.exportRegionIndexes.push(e),this.exportRegionIndexes.sort())}}}),mI=Object(b.a)(fC.prototype,"deleteExportRegionIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.exportRegionIndexes.indexOf(e);t>-1&&this.exportRegionIndexes.splice(t,1)}}}),yI=Object(b.a)(fC.prototype,"setSaveFilename",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFilename=e}}}),OI=Object(b.a)(fC.prototype,"setSaveFileType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFileType=e}}}),jI=Object(b.a)(fC.prototype,"setSortingConfig",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=(t>=0?"+":"-")+e.toLowerCase();JA.Instance.setPreference(QA.SILENT_FILE_SORTING_STRING,i)}}}),xI=Object(b.a)(fC.prototype,"setSaveRegionId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{0<=e&&isFinite(e)&&(this.saveRegionId=e)}}}),SI=Object(b.a)(fC.prototype,"setSaveSpectralRangeMin",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveSpectralRange[0]=e}}}),vI=Object(b.a)(fC.prototype,"setSaveSpectralRangeMax",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveSpectralRange[1]=e}}}),CI=Object(b.a)(fC.prototype,"setSelectedFiles",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFiles=e}}}),II=Object(b.a)(fC.prototype,"showLoadingDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isLoadingDialogOpen=!0}}}),wI=Object(b.a)(fC.prototype,"updateLoadingState",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.loadingProgress=e,this.loadingCheckedCount=t,this.loadingTotalCount=i}}}),TI=Object(b.a)(fC.prototype,"resetLoadingStates",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loadingList=!1,this.clearExtendedDelayTimer(!0),this.isLoadingDialogOpen=!1,this.updateLoadingState(0,0,0)}}}),RI=Object(b.a)(fC.prototype,"cancelRequestingFileList",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.loadingList=!1,this.loadingProgress<1&&(this.browserMode===DI.Catalog?tx.Instance.cancelRequestingFileList(Nt.FileListType.Catalog):tx.Instance.cancelRequestingFileList(Nt.FileListType.Image))}}}),AI=Object(b.a)(fC.prototype,"showExportRegions",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.showFileBrowser(DI.RegionExport,!1),e){var t;this.clearExportRegionIndexes();const i=gC.Instance.activeFrame;if(null===i||void 0===i||null===(t=i.regionSet)||void 0===t?void 0:t.regions){const t=i.regionSet.regions.findIndex((t=>t.regionId===e));this.addExportRegionIndex(t)}}else this.resetExportRegionIndexes()}}}),PI=Object(b.a)(fC.prototype,"setSaveRestFreqVal",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveRestFreq.value=e}}}),EI=Object(b.a)(fC.prototype,"setSaveRestFreqUnit",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveRestFreq.unit=e}}}),MI=Object(b.a)(fC.prototype,"setSaveRestFreq",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveRestFreq=e}}}),Object(b.a)(fC.prototype,"saveRestFreqInHz",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"saveRestFreqInHz"),fC.prototype),Object(b.a)(fC.prototype,"HDUList",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"HDUList"),fC.prototype),Object(b.a)(fC.prototype,"fileInfoExtended",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"fileInfoExtended"),fC.prototype),Object(b.a)(fC.prototype,"isComplexImage",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"isComplexImage"),fC.prototype),Object(b.a)(fC.prototype,"fileInfo",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"fileInfo"),fC.prototype),Object(b.a)(fC.prototype,"headers",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"headers"),fC.prototype),Object(b.a)(fC.prototype,"getfileListByMode",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"getfileListByMode"),fC.prototype),Object(b.a)(fC.prototype,"getBrowserMode",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"getBrowserMode"),fC.prototype),Object(b.a)(fC.prototype,"catalogHeaderDataset",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"catalogHeaderDataset"),fC.prototype),Object(b.a)(fC.prototype,"saveStokesRange",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"saveStokesRange"),fC.prototype),Object(b.a)(fC.prototype,"exportRegionOptions",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"exportRegionOptions"),fC.prototype),Object(b.a)(fC.prototype,"regionOptionNum",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"regionOptionNum"),fC.prototype),Object(b.a)(fC.prototype,"exportRegionNum",[m.i],Object.getOwnPropertyDescriptor(fC.prototype,"exportRegionNum"),fC.prototype),fC);var _I,zI,VI,WI,GI,BI;let qI=(BI=GI=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"logEntries",zI,this),Object(f.a)(this,"hiddenTags",VI,this),Object(f.a)(this,"logLevel",WI,this),this.logLimit=1e3,Object(m.p)(this),this.logEntries=[],this.hiddenTags=[],this.logLevel=Nt.ErrorSeverity.INFO}get newestMsg(){return this.logEntries.length>0?this.logEntries[this.logEntries.length-1].message:""}addLog(e){this.logEntries.push(e),this.logEntries.length>this.logLimit&&this.logEntries.shift()}addDebug(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:Nt.ErrorSeverity.DEBUG})}addInfo(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:Nt.ErrorSeverity.INFO})}addWarning(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:Nt.ErrorSeverity.WARNING})}addError(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:Nt.ErrorSeverity.ERROR})}toggleTag(e){-1===this.hiddenTags.indexOf(e)?this.hiddenTags.push(e):this.hiddenTags=this.hiddenTags.filter((t=>t!==e))}setLevel(e){this.logLevel=e}clearLog(){this.logEntries=[]}},GI.staticInstance=void 0,_I=BI,zI=Object(b.a)(_I.prototype,"logEntries",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VI=Object(b.a)(_I.prototype,"hiddenTags",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WI=Object(b.a)(_I.prototype,"logLevel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(_I.prototype,"newestMsg",[m.i],Object.getOwnPropertyDescriptor(_I.prototype,"newestMsg"),_I.prototype),Object(b.a)(_I.prototype,"addLog",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"addLog"),_I.prototype),Object(b.a)(_I.prototype,"addDebug",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"addDebug"),_I.prototype),Object(b.a)(_I.prototype,"addInfo",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"addInfo"),_I.prototype),Object(b.a)(_I.prototype,"addWarning",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"addWarning"),_I.prototype),Object(b.a)(_I.prototype,"addError",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"addError"),_I.prototype),Object(b.a)(_I.prototype,"toggleTag",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"toggleTag"),_I.prototype),Object(b.a)(_I.prototype,"setLevel",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"setLevel"),_I.prototype),Object(b.a)(_I.prototype,"clearLog",[m.g],Object.getOwnPropertyDescriptor(_I.prototype,"clearLog"),_I.prototype),_I);var HI,YI,UI,XI,$I,KI,QI,ZI,JI,ew,tw,iw,nw,rw,ow,sw,aw,lw,cw,dw,pw,hw,uw,gw,fw,bw,mw,yw,Ow,jw,xw,Sw,vw,Cw,Iw,ww,Tw,Rw,Aw,Pw,Ew,Mw,Fw,kw,Dw,Lw,Nw,_w,zw,Vw,Ww,Gw,Bw,qw,Hw,Yw,Uw,Xw,$w,Kw,Qw,Zw,Jw,eT,tT,iT,nT,rT,oT,sT,aT,lT,cT,dT,pT,hT,uT,gT,fT,bT,mT,yT,OT,jT,xT,ST,vT,CT,IT,wT,TT,RT,AT,PT,ET,MT,FT,kT,DT,LT,NT,_T,zT,VT,WT,GT,BT,qT,HT,YT,UT,XT,$T,KT,QT,ZT,JT,eR,tR,iR,nR,rR,oR,sR,aR,lR,cR,dR,pR,hR,uR,gR,fR,bR,mR,yR,OR,jR,xR,SR,vR,CR,IR,wR,TR,RR,AR,PR,ER,MR,FR,kR,DR,LR,NR,_R,zR,VR,WR,GR,BR,qR,HR,YR,UR,XR,$R,KR,QR;const ZR="auto-blue";let JR,eA,tA,iA;!function(e){e[e.GLOBAL=0]="GLOBAL",e[e.TITLE=1]="TITLE",e[e.GRID=2]="GRID",e[e.BORDER=3]="BORDER",e[e.TICK=4]="TICK",e[e.AXIS=5]="AXIS",e[e.NUMBER=6]="NUMBER",e[e.LABEL=7]="LABEL",e[e.DISTANCE_MEASURE=8]="DISTANCE_MEASURE"}(JR||(JR={})),function(e){e.Interior="Interior",e.Exterior="Exterior"}(eA||(eA={})),function(e){e.Auto="AUTO",e.Ecliptic="ECLIPTIC",e.FK4="FK4",e.FK5="FK5",e.Galactic="GALACTIC",e.ICRS="ICRS"}(tA||(tA={})),function(e){e.HMS="hms",e.DMS="dms",e.Degrees="d"}(iA||(iA={}));const nA=new Map([[iA.HMS,"H:M:S"],[iA.DMS,"D:M:S"],[iA.Degrees,"Degrees"]]);let rA;!function(e){e.Open="open",e.Solid="solid"}(rA||(rA={}));class oA{constructor(){this.stringList=void 0,this.stringList=[]}add(e,t,i=!0){if(void 0!==t&&i){let i="boolean"===typeof t?t?1:0:t;this.stringList.push(`${e}=${i}`)}}addSection(e){void 0!==e&&this.stringList.push(e)}toString(){return this.stringList.filter((e=>e.length>0)).join(", ")}}let sA=(HI=class{get styleString(){let e=new oA;return e.add("Labelling",this.labelType),e.add("Color",JR.GLOBAL),e.add("Tol",fi(this.tolerance/100,2),this.tolerance>=.001),e.add("System",this.explicitSystem),e.toString()}get explicitSystem(){if(this.validWcs)return this.system===tA.Auto?this.defaultSystem:this.system}constructor(){Object(f.a)(this,"labelType",YI,this),Object(f.a)(this,"color",UI,this),Object(f.a)(this,"tolerance",XI,this),Object(f.a)(this,"system",$I,this),Object(f.a)(this,"defaultSystem",KI,this),Object(f.a)(this,"validWcs",QI,this),Object(f.a)(this,"setColor",ZI,this),Object(m.p)(this),this.system=tA.Auto,this.labelType=eA.Exterior,this.setColor(JA.Instance.astColor),this.tolerance=2,this.defaultSystem=tA.Auto,this.validWcs=!1}setTolerance(e){this.tolerance=e}setLabelType(e){this.labelType=e}setSystem(e){var t;this.system=e;const i=null===(t=gC.Instance.activeFrame)||void 0===t?void 0:t.wcsInfo;i&&this.explicitSystem&&Pt.set(i,`System=${this.explicitSystem}`)}setDefaultSystem(e){this.defaultSystem=e}setValidWcs(e){this.validWcs=e}},YI=Object(b.a)(HI.prototype,"labelType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UI=Object(b.a)(HI.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XI=Object(b.a)(HI.prototype,"tolerance",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$I=Object(b.a)(HI.prototype,"system",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KI=Object(b.a)(HI.prototype,"defaultSystem",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QI=Object(b.a)(HI.prototype,"validWcs",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(HI.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(HI.prototype,"styleString"),HI.prototype),Object(b.a)(HI.prototype,"explicitSystem",[m.i],Object.getOwnPropertyDescriptor(HI.prototype,"explicitSystem"),HI.prototype),ZI=Object(b.a)(HI.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.GLOBAL)}}}),Object(b.a)(HI.prototype,"setTolerance",[m.g],Object.getOwnPropertyDescriptor(HI.prototype,"setTolerance"),HI.prototype),Object(b.a)(HI.prototype,"setLabelType",[m.g],Object.getOwnPropertyDescriptor(HI.prototype,"setLabelType"),HI.prototype),Object(b.a)(HI.prototype,"setSystem",[m.g],Object.getOwnPropertyDescriptor(HI.prototype,"setSystem"),HI.prototype),Object(b.a)(HI.prototype,"setDefaultSystem",[m.g],Object.getOwnPropertyDescriptor(HI.prototype,"setDefaultSystem"),HI.prototype),Object(b.a)(HI.prototype,"setValidWcs",[m.g],Object.getOwnPropertyDescriptor(HI.prototype,"setValidWcs"),HI.prototype),HI),aA=(JI=class{get styleString(){let e=new oA;return e.add("DrawTitle",this.show),e.add("Font(Title)",this.font),e.add("Size(Title)",this.fontSize*gC.Instance.imageRatio),e.add("Color(Title)",JR.TITLE,this.customColor),e.toString()}constructor(){Object(f.a)(this,"visible",ew,this),Object(f.a)(this,"font",tw,this),Object(f.a)(this,"fontSize",iw,this),Object(f.a)(this,"customColor",nw,this),Object(f.a)(this,"color",rw,this),Object(f.a)(this,"hidden",ow,this),Object(f.a)(this,"customText",sw,this),Object(f.a)(this,"setFont",aw,this),Object(f.a)(this,"setColor",lw,this),Object(f.a)(this,"setCustomText",cw,this),Object(m.p)(this),this.visible=!1,this.hidden=!1,this.customColor=!1,this.color=ZR,this.font=2,this.fontSize=18,this.customText=!1}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setFontSize(e){this.fontSize=e}setCustomColor(e){this.customColor=e}},ew=Object(b.a)(JI.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tw=Object(b.a)(JI.prototype,"font",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iw=Object(b.a)(JI.prototype,"fontSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nw=Object(b.a)(JI.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rw=Object(b.a)(JI.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ow=Object(b.a)(JI.prototype,"hidden",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sw=Object(b.a)(JI.prototype,"customText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(JI.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(JI.prototype,"styleString"),JI.prototype),Object(b.a)(JI.prototype,"show",[m.i],Object.getOwnPropertyDescriptor(JI.prototype,"show"),JI.prototype),Object(b.a)(JI.prototype,"setVisible",[m.g],Object.getOwnPropertyDescriptor(JI.prototype,"setVisible"),JI.prototype),Object(b.a)(JI.prototype,"setHidden",[m.g],Object.getOwnPropertyDescriptor(JI.prototype,"setHidden"),JI.prototype),aw=Object(b.a)(JI.prototype,"setFont",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(b.a)(JI.prototype,"setFontSize",[m.g],Object.getOwnPropertyDescriptor(JI.prototype,"setFontSize"),JI.prototype),Object(b.a)(JI.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(JI.prototype,"setCustomColor"),JI.prototype),lw=Object(b.a)(JI.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.TITLE)}}}),cw=Object(b.a)(JI.prototype,"setCustomText",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customText=e}}}),JI),lA=(dw=class{get styleString(){let e=new oA;return e.add("Grid",this.visible),e.add("Color(Grid)",JR.GRID,this.customColor),e.add("Width(Grid)",this.width*gC.Instance.imageRatio,this.width>0),e.add("Gap(1)",this.gapX*gC.Instance.imageRatio,this.customGap),e.add("Gap(2)",this.gapY*gC.Instance.imageRatio,this.customGap),e.toString()}constructor(){Object(f.a)(this,"visible",pw,this),Object(f.a)(this,"customColor",hw,this),Object(f.a)(this,"color",uw,this),Object(f.a)(this,"width",gw,this),Object(f.a)(this,"customGap",fw,this),Object(f.a)(this,"gapX",bw,this),Object(f.a)(this,"gapY",mw,this),Object(f.a)(this,"setColor",yw,this),Object(m.p)(this),this.visible=JA.Instance.astGridVisible,this.customColor=!1,this.color=ZR,this.width=1,this.customGap=!1,this.gapX=.2,this.gapY=.2}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}setCustomGap(e=!0){this.customGap=e}setGapX(e){this.gapX=e}setGapY(e){this.gapY=e}},pw=Object(b.a)(dw.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hw=Object(b.a)(dw.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uw=Object(b.a)(dw.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gw=Object(b.a)(dw.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fw=Object(b.a)(dw.prototype,"customGap",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bw=Object(b.a)(dw.prototype,"gapX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mw=Object(b.a)(dw.prototype,"gapY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(dw.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(dw.prototype,"styleString"),dw.prototype),Object(b.a)(dw.prototype,"setVisible",[m.g],Object.getOwnPropertyDescriptor(dw.prototype,"setVisible"),dw.prototype),Object(b.a)(dw.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(dw.prototype,"setCustomColor"),dw.prototype),yw=Object(b.a)(dw.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.GRID)}}}),Object(b.a)(dw.prototype,"setWidth",[m.g],Object.getOwnPropertyDescriptor(dw.prototype,"setWidth"),dw.prototype),Object(b.a)(dw.prototype,"setCustomGap",[m.g],Object.getOwnPropertyDescriptor(dw.prototype,"setCustomGap"),dw.prototype),Object(b.a)(dw.prototype,"setGapX",[m.g],Object.getOwnPropertyDescriptor(dw.prototype,"setGapX"),dw.prototype),Object(b.a)(dw.prototype,"setGapY",[m.g],Object.getOwnPropertyDescriptor(dw.prototype,"setGapY"),dw.prototype),dw),cA=(Ow=class{get styleString(){let e=new oA;return e.add("Border",this.visible),e.add("Color(Border)",JR.BORDER,this.customColor),e.add("Width(Border)",this.width*gC.Instance.imageRatio,this.width>0),e.toString()}constructor(){Object(f.a)(this,"visible",jw,this),Object(f.a)(this,"customColor",xw,this),Object(f.a)(this,"color",Sw,this),Object(f.a)(this,"width",vw,this),Object(f.a)(this,"setColor",Cw,this),Object(m.p)(this),this.visible=!0,this.customColor=!1,this.color=ZR,this.width=1}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}},jw=Object(b.a)(Ow.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xw=Object(b.a)(Ow.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sw=Object(b.a)(Ow.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vw=Object(b.a)(Ow.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Ow.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(Ow.prototype,"styleString"),Ow.prototype),Object(b.a)(Ow.prototype,"setVisible",[m.g],Object.getOwnPropertyDescriptor(Ow.prototype,"setVisible"),Ow.prototype),Object(b.a)(Ow.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(Ow.prototype,"setCustomColor"),Ow.prototype),Cw=Object(b.a)(Ow.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.BORDER)}}}),Object(b.a)(Ow.prototype,"setWidth",[m.g],Object.getOwnPropertyDescriptor(Ow.prototype,"setWidth"),Ow.prototype),Ow),dA=(Iw=class{get styleString(){let e=new oA;return e.add("TickAll",this.drawAll),e.add("MinTick(1)",this.densityX,this.customDensity),e.add("MinTick(2)",this.densityY,this.customDensity),e.add("Color(Ticks)",JR.TICK,this.customColor),e.add("Width(Ticks)",this.width*gC.Instance.imageRatio,this.width>0),e.add("MinTickLen",fi(this.length/100,2)),e.add("MajTickLen",fi(this.majorLength/100,2)),e.toString()}constructor(){Object(f.a)(this,"drawAll",ww,this),Object(f.a)(this,"densityX",Tw,this),Object(f.a)(this,"densityY",Rw,this),Object(f.a)(this,"customDensity",Aw,this),Object(f.a)(this,"customColor",Pw,this),Object(f.a)(this,"color",Ew,this),Object(f.a)(this,"width",Mw,this),Object(f.a)(this,"length",Fw,this),Object(f.a)(this,"majorLength",kw,this),Object(f.a)(this,"setColor",Dw,this),Object(m.p)(this),this.drawAll=!0,this.customDensity=!1,this.densityX=4,this.densityY=4,this.customColor=!1,this.color=ZR,this.width=1,this.length=1,this.majorLength=2}setDrawAll(e=!0){this.drawAll=e}setCustomDensity(e=!0){this.customDensity=e}setDensityX(e){this.densityX=e}setDensityY(e){this.densityY=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}setLength(e){this.length=e}setMajorLength(e){this.majorLength=e}},ww=Object(b.a)(Iw.prototype,"drawAll",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tw=Object(b.a)(Iw.prototype,"densityX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rw=Object(b.a)(Iw.prototype,"densityY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Aw=Object(b.a)(Iw.prototype,"customDensity",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pw=Object(b.a)(Iw.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ew=Object(b.a)(Iw.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mw=Object(b.a)(Iw.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fw=Object(b.a)(Iw.prototype,"length",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kw=Object(b.a)(Iw.prototype,"majorLength",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Iw.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(Iw.prototype,"styleString"),Iw.prototype),Object(b.a)(Iw.prototype,"setDrawAll",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setDrawAll"),Iw.prototype),Object(b.a)(Iw.prototype,"setCustomDensity",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setCustomDensity"),Iw.prototype),Object(b.a)(Iw.prototype,"setDensityX",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setDensityX"),Iw.prototype),Object(b.a)(Iw.prototype,"setDensityY",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setDensityY"),Iw.prototype),Object(b.a)(Iw.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setCustomColor"),Iw.prototype),Dw=Object(b.a)(Iw.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.TICK)}}}),Object(b.a)(Iw.prototype,"setWidth",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setWidth"),Iw.prototype),Object(b.a)(Iw.prototype,"setLength",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setLength"),Iw.prototype),Object(b.a)(Iw.prototype,"setMajorLength",[m.g],Object.getOwnPropertyDescriptor(Iw.prototype,"setMajorLength"),Iw.prototype),Iw),pA=(Lw=class{constructor(){Object(f.a)(this,"visible",Nw,this),Object(f.a)(this,"customColor",_w,this),Object(f.a)(this,"color",zw,this),Object(f.a)(this,"width",Vw,this),Object(f.a)(this,"setColor",Ww,this),Object(m.p)(this),this.visible=!1,this.customColor=!1,this.color=ZR,this.width=1}get styleString(){let e=new oA;return e.add("DrawAxes",this.visible),e.add("Color(Axes)",JR.AXIS,this.customColor),e.add("Width(Axes)",this.width*gC.Instance.imageRatio,this.width>0),e.toString()}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}},Nw=Object(b.a)(Lw.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_w=Object(b.a)(Lw.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zw=Object(b.a)(Lw.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vw=Object(b.a)(Lw.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Lw.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(Lw.prototype,"styleString"),Lw.prototype),Object(b.a)(Lw.prototype,"setVisible",[m.g],Object.getOwnPropertyDescriptor(Lw.prototype,"setVisible"),Lw.prototype),Object(b.a)(Lw.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(Lw.prototype,"setCustomColor"),Lw.prototype),Ww=Object(b.a)(Lw.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.AXIS)}}}),Object(b.a)(Lw.prototype,"setWidth",[m.g],Object.getOwnPropertyDescriptor(Lw.prototype,"setWidth"),Lw.prototype),Lw),hA=(Gw=class{constructor(){Object(f.a)(this,"visible",Bw,this),Object(f.a)(this,"hidden",qw,this),Object(f.a)(this,"font",Hw,this),Object(f.a)(this,"fontSize",Yw,this),Object(f.a)(this,"customColor",Uw,this),Object(f.a)(this,"color",Xw,this),Object(f.a)(this,"customFormat",$w,this),Object(f.a)(this,"formatX",Kw,this),Object(f.a)(this,"formatY",Qw,this),Object(f.a)(this,"customPrecision",Zw,this),Object(f.a)(this,"precision",Jw,this),Object(f.a)(this,"defaultFormatX",eT,this),Object(f.a)(this,"defaultFormatY",tT,this),Object(f.a)(this,"validWcs",iT,this),Object(f.a)(this,"setFont",nT,this),Object(f.a)(this,"setColor",rT,this),Object(m.p)(this),this.visible=!0,this.hidden=!1,this.fontSize=12,this.font=0,this.customColor=!1,this.color=ZR,this.customFormat=!1,this.defaultFormatX=iA.Degrees,this.defaultFormatY=iA.Degrees,this.formatX=iA.Degrees,this.formatY=iA.Degrees,this.customPrecision=!1,this.precision=3,this.validWcs=!1}get formatTypeX(){if(this.validWcs)return this.customFormat?this.formatX:this.defaultFormatX}get formatTypeY(){if(this.validWcs)return this.customFormat?this.formatY:this.defaultFormatY}get formatStringX(){if(!this.validWcs)return;const e=this.customPrecision?this.precision:"*";return`${this.formatTypeX}.${e}`}get formatStringY(){if(!this.validWcs)return;const e=this.customPrecision?this.precision:"*";return`${this.formatTypeY}.${e}`}cursorFormatStringX(e){if(!this.validWcs)return;return`${this.customFormat?this.formatX:this.defaultFormatX}.${e}`}cursorFormatStringY(e){if(!this.validWcs)return;return`${this.customFormat?this.formatY:this.defaultFormatY}.${e}`}get styleString(){let e=new oA;return e.add("NumLab",this.show),e.add("Font(NumLab)",this.font),e.add("Size(NumLab)",this.fontSize*gC.Instance.imageRatio),e.add("Color(NumLab)",JR.NUMBER,this.customColor),e.add("Format(1)",this.formatStringX),e.add("Format(2)",this.formatStringY),e.toString()}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setFontSize(e){this.fontSize=e}setCustomColor(e){this.customColor=e}setCustomFormat(e){this.customFormat=e}setFormatX(e){this.formatX=e}setFormatY(e){this.formatY=e}setDefaultFormatX(e){this.defaultFormatX=e}setDefaultFormatY(e){this.defaultFormatY=e}setCustomPrecision(e){this.customPrecision=e}setPrecision(e){this.precision=e}setValidWcs(e){this.validWcs=e}},Bw=Object(b.a)(Gw.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qw=Object(b.a)(Gw.prototype,"hidden",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hw=Object(b.a)(Gw.prototype,"font",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yw=Object(b.a)(Gw.prototype,"fontSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Uw=Object(b.a)(Gw.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xw=Object(b.a)(Gw.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$w=Object(b.a)(Gw.prototype,"customFormat",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kw=Object(b.a)(Gw.prototype,"formatX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qw=Object(b.a)(Gw.prototype,"formatY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zw=Object(b.a)(Gw.prototype,"customPrecision",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jw=Object(b.a)(Gw.prototype,"precision",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eT=Object(b.a)(Gw.prototype,"defaultFormatX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tT=Object(b.a)(Gw.prototype,"defaultFormatY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iT=Object(b.a)(Gw.prototype,"validWcs",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Gw.prototype,"formatTypeX",[m.i],Object.getOwnPropertyDescriptor(Gw.prototype,"formatTypeX"),Gw.prototype),Object(b.a)(Gw.prototype,"formatTypeY",[m.i],Object.getOwnPropertyDescriptor(Gw.prototype,"formatTypeY"),Gw.prototype),Object(b.a)(Gw.prototype,"formatStringX",[m.i],Object.getOwnPropertyDescriptor(Gw.prototype,"formatStringX"),Gw.prototype),Object(b.a)(Gw.prototype,"formatStringY",[m.i],Object.getOwnPropertyDescriptor(Gw.prototype,"formatStringY"),Gw.prototype),Object(b.a)(Gw.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(Gw.prototype,"styleString"),Gw.prototype),Object(b.a)(Gw.prototype,"show",[m.i],Object.getOwnPropertyDescriptor(Gw.prototype,"show"),Gw.prototype),Object(b.a)(Gw.prototype,"setVisible",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setVisible"),Gw.prototype),Object(b.a)(Gw.prototype,"setHidden",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setHidden"),Gw.prototype),nT=Object(b.a)(Gw.prototype,"setFont",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(b.a)(Gw.prototype,"setFontSize",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setFontSize"),Gw.prototype),Object(b.a)(Gw.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setCustomColor"),Gw.prototype),rT=Object(b.a)(Gw.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.NUMBER)}}}),Object(b.a)(Gw.prototype,"setCustomFormat",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setCustomFormat"),Gw.prototype),Object(b.a)(Gw.prototype,"setFormatX",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setFormatX"),Gw.prototype),Object(b.a)(Gw.prototype,"setFormatY",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setFormatY"),Gw.prototype),Object(b.a)(Gw.prototype,"setDefaultFormatX",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setDefaultFormatX"),Gw.prototype),Object(b.a)(Gw.prototype,"setDefaultFormatY",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setDefaultFormatY"),Gw.prototype),Object(b.a)(Gw.prototype,"setCustomPrecision",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setCustomPrecision"),Gw.prototype),Object(b.a)(Gw.prototype,"setPrecision",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setPrecision"),Gw.prototype),Object(b.a)(Gw.prototype,"setValidWcs",[m.g],Object.getOwnPropertyDescriptor(Gw.prototype,"setValidWcs"),Gw.prototype),Gw),uA=(oT=class{constructor(){Object(f.a)(this,"visible",sT,this),Object(f.a)(this,"hidden",aT,this),Object(f.a)(this,"customColor",lT,this),Object(f.a)(this,"color",cT,this),Object(f.a)(this,"font",dT,this),Object(f.a)(this,"fontSize",pT,this),Object(f.a)(this,"customText",hT,this),Object(f.a)(this,"customLabelX",uT,this),Object(f.a)(this,"customLabelY",gT,this),Object(f.a)(this,"setColor",fT,this),Object(f.a)(this,"setFont",bT,this),Object(f.a)(this,"setCustomText",mT,this),Object(f.a)(this,"setCustomLabelX",yT,this),Object(f.a)(this,"setCustomLabelY",OT,this),Object(m.p)(this),this.visible=JA.Instance.astLabelsVisible,this.hidden=!1,this.fontSize=15,this.font=0,this.customColor=!1,this.color=ZR,this.customText=!1,this.customLabelX="",this.customLabelY=""}get styleString(){let e=new oA;return e.add("TextLab",this.show),e.add("Font(TextLab)",this.font),e.add("Size(TextLab)",this.fontSize*gC.Instance.imageRatio),e.add("Color(TextLab)",JR.LABEL,this.customColor),e.add("Label(1)",this.customLabelX,this.customText),e.add("Label(2)",this.customLabelY,this.customText),e.toString()}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setCustomColor(e){this.customColor=e}setFontSize(e){this.fontSize=e}},sT=Object(b.a)(oT.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aT=Object(b.a)(oT.prototype,"hidden",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lT=Object(b.a)(oT.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cT=Object(b.a)(oT.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dT=Object(b.a)(oT.prototype,"font",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pT=Object(b.a)(oT.prototype,"fontSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hT=Object(b.a)(oT.prototype,"customText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uT=Object(b.a)(oT.prototype,"customLabelX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gT=Object(b.a)(oT.prototype,"customLabelY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(oT.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(oT.prototype,"styleString"),oT.prototype),Object(b.a)(oT.prototype,"show",[m.i],Object.getOwnPropertyDescriptor(oT.prototype,"show"),oT.prototype),Object(b.a)(oT.prototype,"setVisible",[m.g],Object.getOwnPropertyDescriptor(oT.prototype,"setVisible"),oT.prototype),Object(b.a)(oT.prototype,"setHidden",[m.g],Object.getOwnPropertyDescriptor(oT.prototype,"setHidden"),oT.prototype),Object(b.a)(oT.prototype,"setCustomColor",[m.g],Object.getOwnPropertyDescriptor(oT.prototype,"setCustomColor"),oT.prototype),fT=Object(b.a)(oT.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e,Pt.setColor(Jb(e),JR.LABEL)}}}),bT=Object(b.a)(oT.prototype,"setFont",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(b.a)(oT.prototype,"setFontSize",[m.g],Object.getOwnPropertyDescriptor(oT.prototype,"setFontSize"),oT.prototype),mT=Object(b.a)(oT.prototype,"setCustomText",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customText=e}}}),yT=Object(b.a)(oT.prototype,"setCustomLabelX",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customLabelX=e}}}),OT=Object(b.a)(oT.prototype,"setCustomLabelY",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customLabelY=e}}}),oT),gA=(jT=class{constructor(){Object(f.a)(this,"visible",xT,this),Object(f.a)(this,"interactive",ST,this),Object(f.a)(this,"width",vT,this),Object(f.a)(this,"offset",CT,this),Object(f.a)(this,"position",IT,this),Object(f.a)(this,"customColor",wT,this),Object(f.a)(this,"color",TT,this),Object(f.a)(this,"borderVisible",RT,this),Object(f.a)(this,"borderWidth",AT,this),Object(f.a)(this,"borderCustomColor",PT,this),Object(f.a)(this,"borderColor",ET,this),Object(f.a)(this,"tickVisible",MT,this),Object(f.a)(this,"tickDensity",FT,this),Object(f.a)(this,"tickLen",kT,this),Object(f.a)(this,"tickWidth",DT,this),Object(f.a)(this,"tickCustomColor",LT,this),Object(f.a)(this,"tickColor",NT,this),Object(f.a)(this,"numberVisible",_T,this),Object(f.a)(this,"numberRotation",zT,this),Object(f.a)(this,"numberFont",VT,this),Object(f.a)(this,"numberFontSize",WT,this),Object(f.a)(this,"numberCustomPrecision",GT,this),Object(f.a)(this,"numberPrecision",BT,this),Object(f.a)(this,"numberCustomColor",qT,this),Object(f.a)(this,"numberColor",HT,this),Object(f.a)(this,"labelVisible",YT,this),Object(f.a)(this,"labelRotation",UT,this),Object(f.a)(this,"labelFont",XT,this),Object(f.a)(this,"labelFontSize",$T,this),Object(f.a)(this,"labelCustomText",KT,this),Object(f.a)(this,"labelCustomColor",QT,this),Object(f.a)(this,"labelColor",ZT,this),this.textRatio=[.56,.51,.56,.51,.6],Object(f.a)(this,"setVisible",JT,this),Object(f.a)(this,"setInteractive",eR,this),Object(f.a)(this,"setWidth",tR,this),Object(f.a)(this,"setOffset",iR,this),Object(f.a)(this,"setPosition",nR,this),Object(f.a)(this,"setCustomColor",rR,this),Object(f.a)(this,"setColor",oR,this),Object(f.a)(this,"setBorderVisible",sR,this),Object(f.a)(this,"setBorderWidth",aR,this),Object(f.a)(this,"setBorderCustomColor",lR,this),Object(f.a)(this,"setBorderColor",cR,this),Object(f.a)(this,"setTickVisible",dR,this),Object(f.a)(this,"setTickDensity",pR,this),Object(f.a)(this,"setTickLen",hR,this),Object(f.a)(this,"setTickWidth",uR,this),Object(f.a)(this,"setTickCustomColor",gR,this),Object(f.a)(this,"setTickColor",fR,this),Object(f.a)(this,"setNumberVisible",bR,this),Object(f.a)(this,"setNumberRotation",mR,this),Object(f.a)(this,"setNumberFont",yR,this),Object(f.a)(this,"setNumberFontSize",OR,this),Object(f.a)(this,"setNumberCustomPrecision",jR,this),Object(f.a)(this,"setNumberPrecision",xR,this),Object(f.a)(this,"setNumberCustomColor",SR,this),Object(f.a)(this,"setNumberColor",vR,this),Object(f.a)(this,"setLabelVisible",CR,this),Object(f.a)(this,"setLabelRotation",IR,this),Object(f.a)(this,"setLabelFont",wR,this),Object(f.a)(this,"setLabelFontSize",TR,this),Object(f.a)(this,"setLabelCustomText",RR,this),Object(f.a)(this,"setLabelCustomColor",AR,this),Object(f.a)(this,"setLabelColor",PR,this),Object(m.p)(this);const e=JA.Instance;this.visible=e.colorbarVisible,this.interactive=e.colorbarInteractive,this.width=e.colorbarWidth,this.offset=5,this.position=e.colorbarPosition,this.customColor=!1,this.color=ZR,this.borderVisible=!0,this.borderWidth=1,this.borderCustomColor=!1,this.borderColor=ZR,this.tickVisible=!0,this.tickDensity=e.colorbarTicksDensity,this.tickLen=6,this.tickWidth=1,this.tickCustomColor=!1,this.tickColor=ZR,this.numberVisible=!0,this.numberRotation=-90,this.numberFont=0,this.numberFontSize=12,this.numberCustomPrecision=!1,this.numberPrecision=3,this.numberCustomColor=!1,this.numberColor=ZR,this.labelVisible=e.colorbarLabelVisible,this.labelRotation=-90,this.labelFont=0,this.labelFontSize=15,this.labelCustomText=!1,this.labelCustomColor=!1,this.labelColor=ZR}get yOffset(){var e,t;const i=null===(e=gC.Instance)||void 0===e||null===(t=e.overlayStore)||void 0===t?void 0:t.padding;return"right"===this.position?null===i||void 0===i?void 0:i.top:null===i||void 0===i?void 0:i.left}get height(){var e;const t=null===(e=gC.Instance)||void 0===e?void 0:e.overlayStore;return"right"===this.position?null===t||void 0===t?void 0:t.renderHeight:null===t||void 0===t?void 0:t.renderWidth}get tickNum(){const e=Math.round(this.height/100*this.tickDensity);return this.height&&e>3?e:3}get rightBorderPos(){return"top"===this.position?this.stageWidth-this.offset-this.width:this.offset+this.width}get textGap(){return 5}get numberWidth(){let e=1;if(!this.numberRotation&&"right"===this.position){e=0;const t=Gi(Math.floor(this.numberFont/4),0,this.textRatio.length);for(const i of gC.Instance.visibleFrames){const n=Math.max(...i.colorbarStore.texts.map((e=>{var i;return e.length-(4===t?0:.5*(null===(i=e.match(/[.-]/g))||void 0===i?void 0:i.length)||0)})))*this.textRatio[t];e=Math.max(e,n)}}return this.numberVisible?this.numberFontSize*e+this.textGap:0}get labelWidth(){return this.labelVisible?this.labelFontSize+this.textGap:0}get totalWidth(){return this.offset+this.width+this.numberWidth+this.labelWidth}get stageWidth(){return this.totalWidth+5}},xT=Object(b.a)(jT.prototype,"visible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ST=Object(b.a)(jT.prototype,"interactive",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vT=Object(b.a)(jT.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CT=Object(b.a)(jT.prototype,"offset",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IT=Object(b.a)(jT.prototype,"position",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wT=Object(b.a)(jT.prototype,"customColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TT=Object(b.a)(jT.prototype,"color",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RT=Object(b.a)(jT.prototype,"borderVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AT=Object(b.a)(jT.prototype,"borderWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PT=Object(b.a)(jT.prototype,"borderCustomColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ET=Object(b.a)(jT.prototype,"borderColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),MT=Object(b.a)(jT.prototype,"tickVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FT=Object(b.a)(jT.prototype,"tickDensity",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kT=Object(b.a)(jT.prototype,"tickLen",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),DT=Object(b.a)(jT.prototype,"tickWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),LT=Object(b.a)(jT.prototype,"tickCustomColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NT=Object(b.a)(jT.prototype,"tickColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_T=Object(b.a)(jT.prototype,"numberVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zT=Object(b.a)(jT.prototype,"numberRotation",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VT=Object(b.a)(jT.prototype,"numberFont",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WT=Object(b.a)(jT.prototype,"numberFontSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GT=Object(b.a)(jT.prototype,"numberCustomPrecision",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BT=Object(b.a)(jT.prototype,"numberPrecision",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qT=Object(b.a)(jT.prototype,"numberCustomColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HT=Object(b.a)(jT.prototype,"numberColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YT=Object(b.a)(jT.prototype,"labelVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UT=Object(b.a)(jT.prototype,"labelRotation",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XT=Object(b.a)(jT.prototype,"labelFont",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$T=Object(b.a)(jT.prototype,"labelFontSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KT=Object(b.a)(jT.prototype,"labelCustomText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QT=Object(b.a)(jT.prototype,"labelCustomColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZT=Object(b.a)(jT.prototype,"labelColor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JT=Object(b.a)(jT.prototype,"setVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),eR=Object(b.a)(jT.prototype,"setInteractive",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.interactive=e}}}),tR=Object(b.a)(jT.prototype,"setWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.width=e}}}),iR=Object(b.a)(jT.prototype,"setOffset",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.offset=e}}}),nR=Object(b.a)(jT.prototype,"setPosition",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.position=e}}}),rR=Object(b.a)(jT.prototype,"setCustomColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customColor=e}}}),oR=Object(b.a)(jT.prototype,"setColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),sR=Object(b.a)(jT.prototype,"setBorderVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.borderVisible=e}}}),aR=Object(b.a)(jT.prototype,"setBorderWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.borderWidth=e}}}),lR=Object(b.a)(jT.prototype,"setBorderCustomColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.borderCustomColor=e}}}),cR=Object(b.a)(jT.prototype,"setBorderColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.borderColor=e}}}),dR=Object(b.a)(jT.prototype,"setTickVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.tickVisible=e}}}),pR=Object(b.a)(jT.prototype,"setTickDensity",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.tickDensity=e}}}),hR=Object(b.a)(jT.prototype,"setTickLen",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.tickLen=e}}}),uR=Object(b.a)(jT.prototype,"setTickWidth",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.tickWidth=e}}}),gR=Object(b.a)(jT.prototype,"setTickCustomColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.tickCustomColor=e}}}),fR=Object(b.a)(jT.prototype,"setTickColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.tickColor=e}}}),bR=Object(b.a)(jT.prototype,"setNumberVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberVisible=e}}}),mR=Object(b.a)(jT.prototype,"setNumberRotation",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberRotation=e}}}),yR=Object(b.a)(jT.prototype,"setNumberFont",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberFont=e}}}),OR=Object(b.a)(jT.prototype,"setNumberFontSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberFontSize=e}}}),jR=Object(b.a)(jT.prototype,"setNumberCustomPrecision",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberCustomPrecision=e}}}),xR=Object(b.a)(jT.prototype,"setNumberPrecision",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberPrecision=e}}}),SR=Object(b.a)(jT.prototype,"setNumberCustomColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberCustomColor=e}}}),vR=Object(b.a)(jT.prototype,"setNumberColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numberColor=e}}}),CR=Object(b.a)(jT.prototype,"setLabelVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelVisible=e}}}),IR=Object(b.a)(jT.prototype,"setLabelRotation",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelRotation=e}}}),wR=Object(b.a)(jT.prototype,"setLabelFont",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelFont=e}}}),TR=Object(b.a)(jT.prototype,"setLabelFontSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelFontSize=e}}}),RR=Object(b.a)(jT.prototype,"setLabelCustomText",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelCustomText=e}}}),AR=Object(b.a)(jT.prototype,"setLabelCustomColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelCustomColor=e}}}),PR=Object(b.a)(jT.prototype,"setLabelColor",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.labelColor=e}}}),Object(b.a)(jT.prototype,"yOffset",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"yOffset"),jT.prototype),Object(b.a)(jT.prototype,"height",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"height"),jT.prototype),Object(b.a)(jT.prototype,"tickNum",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"tickNum"),jT.prototype),Object(b.a)(jT.prototype,"rightBorderPos",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"rightBorderPos"),jT.prototype),Object(b.a)(jT.prototype,"textGap",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"textGap"),jT.prototype),Object(b.a)(jT.prototype,"numberWidth",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"numberWidth"),jT.prototype),Object(b.a)(jT.prototype,"labelWidth",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"labelWidth"),jT.prototype),Object(b.a)(jT.prototype,"totalWidth",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"totalWidth"),jT.prototype),Object(b.a)(jT.prototype,"stageWidth",[m.i],Object.getOwnPropertyDescriptor(jT.prototype,"stageWidth"),jT.prototype),jT),fA=(ER=class{constructor(){Object(f.a)(this,"selectedFileId",MR,this),Object(f.a)(this,"settingsForDisplay",FR,this),Object(f.a)(this,"setSelectedFrame",kR,this),Object(m.p)(this),this.selectedFileId=-1,this.settingsForDisplay=null,Object(m.h)((()=>{const e=gC.Instance;e.activeFrame&&e.activeFrame.frameInfo&&e.activeFrame.frameInfo.fileInfo&&this.setSelectedFrame(e.activeFrame.frameInfo.fileId)}))}get isSelectedFrameValid(){return this.selectedFileId>=0&&null!==this.settingsForDisplay}},MR=Object(b.a)(ER.prototype,"selectedFileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FR=Object(b.a)(ER.prototype,"settingsForDisplay",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(ER.prototype,"isSelectedFrameValid",[m.i],Object.getOwnPropertyDescriptor(ER.prototype,"isSelectedFrameValid"),ER.prototype),kR=Object(b.a)(ER.prototype,"setSelectedFrame",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileId=e;const t=gC.Instance.getFrame(e);t&&t.overlayBeamSettings&&(this.settingsForDisplay=t.overlayBeamSettings)}}}),ER),bA=(QR=KR=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"fullViewWidth",LR,this),Object(f.a)(this,"fullViewHeight",NR,this),Object(f.a)(this,"global",_R,this),Object(f.a)(this,"title",zR,this),Object(f.a)(this,"grid",VR,this),Object(f.a)(this,"border",WR,this),Object(f.a)(this,"axes",GR,this),Object(f.a)(this,"numbers",BR,this),Object(f.a)(this,"labels",qR,this),Object(f.a)(this,"ticks",HR,this),Object(f.a)(this,"colorbar",YR,this),Object(f.a)(this,"beam",UR,this),Object(f.a)(this,"setViewDimension",XR,this),Object(f.a)(this,"toggleLabels",$R,this),Object(m.p)(this),this.global=new sA,this.title=new aA,this.grid=new lA,this.border=new cA,this.axes=new pA,this.numbers=new hA,this.labels=new uA,this.ticks=new dA,this.colorbar=new gA,this.beam=new fA,this.fullViewWidth=1,this.fullViewHeight=1,Object(m.h)((()=>{this.global.system;this.setFormatsFromSystem();const e=gC.Instance.activeFrame;(null===e||void 0===e?void 0:e.validWcs)&&(null===e||void 0===e?void 0:e.wcsInfoForTransformation)&&this.global.explicitSystem&&Pt.set(e.wcsInfoForTransformation,`System=${this.global.explicitSystem}`)})),Object(m.h)((()=>{this.numbers.formatTypeX;const e=gC.Instance.activeFrame;(null===e||void 0===e?void 0:e.validWcs)&&(null===e||void 0===e?void 0:e.wcsInfoForTransformation)&&this.numbers.formatTypeX&&Pt.set(e.wcsInfoForTransformation,`Format(1)=${this.numbers.formatTypeX}.10`)})),Object(m.h)((()=>{this.numbers.formatTypeY;const e=gC.Instance.activeFrame;(null===e||void 0===e?void 0:e.validWcs)&&(null===e||void 0===e?void 0:e.wcsInfoForTransformation)&&this.numbers.formatTypeY&&Pt.set(e.wcsInfoForTransformation,`Format(2)=${this.numbers.formatTypeY}.10`)}))}setFormatsFromSystem(){if(this.global.validWcs)switch(JA.Instance.wcsType){case Mi.DEGREES:this.numbers.setDefaultFormatX(iA.Degrees),this.numbers.setDefaultFormatY(iA.Degrees);break;case Mi.SEXAGESIMAL:this.numbers.setDefaultFormatX(iA.HMS),this.numbers.setDefaultFormatY(iA.DMS);break;case Mi.AUTOMATIC:default:[tA.FK4,tA.FK5,tA.ICRS].indexOf(this.global.explicitSystem)>-1?(this.numbers.setDefaultFormatX(iA.HMS),this.numbers.setDefaultFormatY(iA.DMS)):(this.numbers.setDefaultFormatX(iA.Degrees),this.numbers.setDefaultFormatY(iA.Degrees))}else this.numbers.setDefaultFormatX(void 0),this.numbers.setDefaultFormatY(void 0);this.numbers.customFormat||(this.numbers.setFormatX(this.numbers.defaultFormatX),this.numbers.setFormatY(this.numbers.defaultFormatY))}setDefaultsFromAST(e){this.global.setValidWcs(e.validWcs),this.numbers.setValidWcs(e.validWcs),this.global.setDefaultSystem(Pt.getString(e.wcsInfo,"System")),this.setFormatsFromSystem()}get labelsHidden(){return this.labels.hidden&&this.numbers.hidden&&this.title.hidden}get styleString(){var e,t;let i=new oA;return i.addSection(this.global.styleString),i.addSection(this.title.styleString),i.addSection(this.grid.styleString),i.addSection(this.border.styleString),i.addSection(this.ticks.styleString),i.addSection(this.axes.styleString),i.addSection(this.numbers.styleString),i.addSection(this.labels.styleString),i.addSection(null===(e=gC.Instance.activeFrame)||void 0===e||null===(t=e.distanceMeasuring)||void 0===t?void 0:t.styleString),i.add("LabelUp",0),i.add("TitleGap",this.titleGap/this.minSize),i.add("NumLabGap",this.defaultGap/this.minSize),i.add("TextLabGap",this.cumulativeLabelGap/this.minSize),i.add("TextGapType","plot"),i.toString()}get minSize(){return Math.min(this.renderWidth,this.renderHeight)}get showNumbers(){return this.numbers.show&&this.global.labelType===eA.Exterior}get defaultGap(){return 5}get titleGap(){return 2*this.defaultGap+(this.colorbar.visible&&"top"===this.colorbar.position?this.colorbar.totalWidth:0)}get cumulativeLabelGap(){return(this.showNumbers?this.defaultGap:0)+(this.showNumbers?this.numbers.fontSize:0)+this.defaultGap}get base(){return 5}get numberWidth(){return this.showNumbers?this.defaultGap+this.numbers.fontSize:0}get labelWidth(){return this.labels.show?this.defaultGap+this.labels.fontSize:0}get colorbarHoverInfoHeight(){return!this.colorbar.visible||this.colorbar.visible&&"bottom"!==this.colorbar.position&&this.labels.show||this.colorbar.visible&&"bottom"===this.colorbar.position&&this.colorbar.labelVisible?0:10}get paddingLeft(){return this.base+this.numberWidth+this.labelWidth}get paddingRight(){return this.base+(this.colorbar.visible&&"right"===this.colorbar.position?this.colorbar.totalWidth:0)}get paddingTop(){return this.base+(this.title.show?this.titleGap+this.title.fontSize:this.colorbar.visible&&"top"===this.colorbar.position?this.colorbar.totalWidth:0)}get paddingBottom(){return this.base+this.numberWidth+this.labelWidth+(this.colorbar.visible&&"bottom"===this.colorbar.position?this.colorbar.totalWidth:0)+this.colorbarHoverInfoHeight}get padding(){return{left:this.paddingLeft,right:this.paddingRight,top:this.paddingTop,bottom:this.paddingBottom}}get viewWidth(){return Math.floor(this.fullViewWidth/gC.Instance.numImageColumns)}get viewHeight(){return Math.floor(this.fullViewHeight/gC.Instance.numImageRows)}get renderWidth(){const e=this.viewWidth-this.paddingLeft-this.paddingRight;return e>1?e:1}get renderHeight(){const e=this.viewHeight-this.paddingTop-this.paddingBottom;return e>1?e:1}},KR.staticInstance=void 0,DR=QR,LR=Object(b.a)(DR.prototype,"fullViewWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),NR=Object(b.a)(DR.prototype,"fullViewHeight",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_R=Object(b.a)(DR.prototype,"global",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zR=Object(b.a)(DR.prototype,"title",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VR=Object(b.a)(DR.prototype,"grid",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WR=Object(b.a)(DR.prototype,"border",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GR=Object(b.a)(DR.prototype,"axes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BR=Object(b.a)(DR.prototype,"numbers",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qR=Object(b.a)(DR.prototype,"labels",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HR=Object(b.a)(DR.prototype,"ticks",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YR=Object(b.a)(DR.prototype,"colorbar",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UR=Object(b.a)(DR.prototype,"beam",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XR=Object(b.a)(DR.prototype,"setViewDimension",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.fullViewWidth=e,this.fullViewHeight=t}}}),Object(b.a)(DR.prototype,"setFormatsFromSystem",[m.g],Object.getOwnPropertyDescriptor(DR.prototype,"setFormatsFromSystem"),DR.prototype),Object(b.a)(DR.prototype,"setDefaultsFromAST",[m.g],Object.getOwnPropertyDescriptor(DR.prototype,"setDefaultsFromAST"),DR.prototype),$R=Object(b.a)(DR.prototype,"toggleLabels",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=!this.labelsHidden;this.labels.setHidden(e),this.numbers.setHidden(e),this.title.setHidden(e)}}}),Object(b.a)(DR.prototype,"labelsHidden",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"labelsHidden"),DR.prototype),Object(b.a)(DR.prototype,"styleString",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"styleString"),DR.prototype),Object(b.a)(DR.prototype,"minSize",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"minSize"),DR.prototype),Object(b.a)(DR.prototype,"showNumbers",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"showNumbers"),DR.prototype),Object(b.a)(DR.prototype,"defaultGap",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"defaultGap"),DR.prototype),Object(b.a)(DR.prototype,"titleGap",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"titleGap"),DR.prototype),Object(b.a)(DR.prototype,"cumulativeLabelGap",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"cumulativeLabelGap"),DR.prototype),Object(b.a)(DR.prototype,"base",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"base"),DR.prototype),Object(b.a)(DR.prototype,"numberWidth",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"numberWidth"),DR.prototype),Object(b.a)(DR.prototype,"labelWidth",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"labelWidth"),DR.prototype),Object(b.a)(DR.prototype,"colorbarHoverInfoHeight",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"colorbarHoverInfoHeight"),DR.prototype),Object(b.a)(DR.prototype,"paddingLeft",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"paddingLeft"),DR.prototype),Object(b.a)(DR.prototype,"paddingRight",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"paddingRight"),DR.prototype),Object(b.a)(DR.prototype,"paddingTop",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"paddingTop"),DR.prototype),Object(b.a)(DR.prototype,"paddingBottom",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"paddingBottom"),DR.prototype),Object(b.a)(DR.prototype,"padding",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"padding"),DR.prototype),Object(b.a)(DR.prototype,"viewWidth",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"viewWidth"),DR.prototype),Object(b.a)(DR.prototype,"viewHeight",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"viewHeight"),DR.prototype),Object(b.a)(DR.prototype,"renderWidth",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"renderWidth"),DR.prototype),Object(b.a)(DR.prototype,"renderHeight",[m.i],Object.getOwnPropertyDescriptor(DR.prototype,"renderHeight"),DR.prototype),DR);var mA,yA,OA,jA,xA,SA;let vA=(mA=class{constructor(e=0,t=0){this.regionId=void 0,this.fileId=void 0,Object(f.a)(this,"channel",yA,this),Object(f.a)(this,"value",OA,this),Object(f.a)(this,"x",jA,this),Object(f.a)(this,"y",xA,this),Object(f.a)(this,"profiles",SA,this),this.getProfile=e=>{var t;return null===(t=this.profiles)||void 0===t?void 0:t.get(e)},Object(m.p)(this),this.fileId=e,this.regionId=t,this.profiles=new Map}updateFromStream(e){var t;e&&(this.channel=e.channel,this.value=e.value,this.x=e.x,this.y=e.y,null===(t=e.profiles)||void 0===t||t.forEach((e=>this.profiles.set(e.coordinate,$m.ProcessSpatialProfile(e)))))}setProfile(e,t){this.profiles.set(e,t)}setProfiles(e){this.profiles=e}},yA=Object(b.a)(mA.prototype,"channel",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OA=Object(b.a)(mA.prototype,"value",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jA=Object(b.a)(mA.prototype,"x",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xA=Object(b.a)(mA.prototype,"y",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SA=Object(b.a)(mA.prototype,"profiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(mA.prototype,"updateFromStream",[m.g],Object.getOwnPropertyDescriptor(mA.prototype,"updateFromStream"),mA.prototype),Object(b.a)(mA.prototype,"setProfile",[m.g],Object.getOwnPropertyDescriptor(mA.prototype,"setProfile"),mA.prototype),Object(b.a)(mA.prototype,"setProfiles",[m.g],Object.getOwnPropertyDescriptor(mA.prototype,"setProfiles"),mA.prototype),mA);var CA,IA,wA,TA;let RA=(CA=class{constructor(e=0,t=0){this.fileId=void 0,this.regionId=void 0,Object(f.a)(this,"profiles",IA,this),this.getProfile=(e,t)=>{let i=this.profiles.get(e);return i?i.get(t):null},Object(f.a)(this,"resetProfilesProgress",wA,this),Object(f.a)(this,"setProfile",TA,this),Object(m.p)(this),this.fileId=e,this.regionId=t,this.profiles=new Map}},IA=Object(b.a)(CA.prototype,"profiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wA=Object(b.a)(CA.prototype,"resetProfilesProgress",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.profiles.forEach((e=>{null===e||void 0===e||e.forEach((e=>{e&&(e.progress=0)}))}))}}}),TA=Object(b.a)(CA.prototype,"setProfile",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{let t=this.profiles.get(e.coordinate);t||(t=new m.b,this.profiles.set(e.coordinate,t)),t.set(e.statsType,e)}}}),CA);var AA,PA,EA,MA,FA,kA,DA,LA,NA,_A,zA,VA,WA,GA,BA,qA,HA,YA,UA,XA,$A=i(72),KA=i.n($A);let QA;!function(e){e.SILENT_FILE_SORTING_STRING="fileSortingString",e.SILENT_FILE_FILTERING_TYPE="fileFilteringType",e.GLOBAL_THEME="theme",e.GLOBAL_AUTOLAUNCH="autoLaunch",e.GLOBAL_FILE_FILTER_MODE="fileFilterMode",e.GLOBAL_LAYOUT="layout",e.GLOBAL_CURSOR_POSITION="cursorPosition",e.GLOBAL_ZOOM_MODE="zoomMode",e.GLOBAL_ZOOM_POINT="zoomPoint",e.GLOBAL_DRAG_PANNING="dragPanning",e.GLOBAL_SPECTRAL_MATCHING_TYPE="spectralMatchingType",e.GLOBAL_AUTO_WCS_MATCHING="autoWCSMatching",e.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND="transparentImageBackground",e.GLOBAL_CODE_SNIPPETS_ENABLED="codeSnippetsEnabled",e.GLOBAL_KEEP_LAST_USED_FOLDER="keepLastUsedFolder",e.GLOBAL_SAVED_LAST_FOLDER="lastUsedFolder",e.RENDER_CONFIG_SCALING="scaling",e.RENDER_CONFIG_COLORMAP="colormap",e.RENDER_CONFIG_PERCENTILE="percentile",e.RENDER_CONFIG_SCALING_ALPHA="scalingAlpha",e.RENDER_CONFIG_SCALING_GAMMA="scalingGamma",e.RENDER_CONFIG_NAN_COLOR_HEX="nanColorHex",e.RENDER_CONFIG_NAN_ALPHA="nanAlpha",e.RENDER_CONFIG_USE_SMOOTHED_BIAS_CONTRAST="useSmoothedBiasContrast",e.CONTOUR_CONFIG_GENERATOR_TYPE="contourGeneratorType",e.CONTOUR_CONFIG_SMOOTHING_MODE="contourSmoothingMode",e.CONTOUR_CONFIG_SMOOTHING_FACTOR="contourSmoothingFactor",e.CONTOUR_CONFIG_NUM_LEVELS="contourNumLevels",e.CONTOUR_CONFIG_THICKNESS="contourThickness",e.CONTOUR_CONFIG_COLORMAP_ENABLED="contourColormapEnabled",e.CONTOUR_CONFIG_COLOR="contourColor",e.CONTOUR_CONFIG_COLORMAP="contourColormap",e.VECTOR_OVERLAY_PIXEL_AVERAGING="vectorOverlayPixelAveraging",e.VECTOR_OVERLAY_FRACTIONAL_INTENSITY="vectorOverlayFractionalIntensity",e.VECTOR_OVERLAY_THICKNESS="vectorOverlayThickness",e.VECTOR_OVERLAY_COLORMAP_ENABLED="vectorOverlayColormapEnabled",e.VECTOR_OVERLAY_COLOR="vectorOverlayColor",e.VECTOR_OVERLAY_COLORMAP="vectorOverlayColormap",e.WCS_OVERLAY_AST_COLOR="astColor",e.WCS_OVERLAY_AST_GRID_VISIBLE="astGridVisible",e.WCS_OVERLAY_AST_LABELS_VISIBLE="astLabelsVisible",e.WCS_OVERLAY_WCS_TYPE="wcsType",e.WCS_OVERLAY_COLORBAR_VISIBLE="colorbarVisible",e.WCS_OVERLAY_COLORBAR_INTERACTIVE="colorbarInteractive",e.WCS_OVERLAY_COLORBAR_POSITION="colorbarPosition",e.WCS_OVERLAY_COLORBAR_WIDTH="colorbarWidth",e.WCS_OVERLAY_COLORBAR_TICKS_DENSITY="colorbarTicksDensity",e.WCS_OVERLAY_COLORBAR_LABEL_VISIBLE="colorbarLabelVisible",e.WCS_OVERLAY_BEAM_VISIBLE="beamVisible",e.WCS_OVERLAY_BEAM_COLOR="beamColor",e.WCS_OVERLAY_BEAM_TYPE="beamType",e.WCS_OVERLAY_BEAM_WIDTH="beamWidth",e.WCS_OVERLAY_CURSOR_INFO="cursorInfoVisible",e.REGION_COLOR="regionColor",e.REGION_LINE_WIDTH="regionLineWidth",e.REGION_DASH_LENGTH="regionDashLength",e.REGION_TYPE="regionType",e.REGION_CREATION_MODE="regionCreationMode",e.REGION_SIZE="regionSize",e.PERFORMANCE_IMAGE_COMPRESSION_QUALITY="imageCompressionQuality",e.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY="animationCompressionQuality",e.PERFORMANCE_GPU_TILE_CACHE="GPUTileCache",e.PERFORMANCE_SYSTEM_TILE_CACHE="systemTileCache",e.PERFORMANCE_CONTOUR_DECIMATION="contourDecimation",e.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL="contourCompressionLevel",e.PERFORMANCE_CONTOUR_CHUNK_SIZE="contourChunkSize",e.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH="contourControlMapWidth",e.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING="streamContoursWhileZooming",e.PERFORMANCE_LOW_BAND_WIDTH_MODE="lowBandwidthMode",e.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES="stopAnimationPlaybackMinutes",e.PERFORMANCE_LIMIT_OVERLAY_REDRAW="limitOverlayRedraw",e.LOG_EVENT="logEventList",e.CATALOG_DISPLAYED_COLUMN_SIZE="catalogDisplayedColumnSize",e.CATALOG_TABLE_SEPARATOR_POSITION="catalogTableSeparatorPosition",e.PIXEL_GRID_VISIBLE="pixelGridVisible",e.PIXEL_GRID_COLOR="pixelGridColor",e.IMAGE_MULTI_PANEL_ENABLED="imageMultiPanelEnabled",e.IMAGE_PANEL_MODE="imagePanelMode",e.IMAGE_PANEL_COLUMNS="imagePanelColumns",e.IMAGE_PANEL_ROWS="imagePanelRows",e.STATS_PANEL_ENABLED="statsPanelEnabled",e.STATS_PANEL_MODE="statsPanelMode",e.TELEMETRY_UUID="telemetryUuid",e.TELEMETRY_MODE="telemetryMode",e.TELEMETRY_CONSENT_SHOWN="telemetryConsentShown",e.TELEMETRY_LOGGING="telemetryLogging"}(QA||(QA={}));const ZA={SILENT:{fileSortingString:"-date",fileFilteringType:LI.Fuzzy,pixelGridVisible:!1,pixelGridColor:"#FFFFFF",imageMultiPanelEnabled:!1,imagePanelMode:Xn.Dynamic,imagePanelColumns:2,imagePanelRows:2},GLOBAL:{theme:Ti.AUTO,autoLaunch:!0,fileFilterMode:nr.Content,layout:Ri.DEFAULT,cursorPosition:Ai.TRACKING,zoomMode:Pi.FIT,zoomPoint:Ei.CURSOR,dragPanning:!0,spectralMatchingType:Wt.VRAD,autoWCSMatching:mn.NONE,transparentImageBackground:!1,codeSnippetsEnabled:!1,keepLastUsedFolder:!1,lastUsedFolder:""},RENDER_CONFIG:{scaling:Rf.LINEAR,colormap:"inferno",percentile:99.9,scalingAlpha:1e3,scalingGamma:1,nanColorHex:"#137CBD",nanAlpha:1,useSmoothedBiasContrast:!0},CONTOUR_CONFIG:{contourGeneratorType:xe.StartStepMultiplier,contourSmoothingMode:Nt.SmoothingMode.GaussianBlur,contourSmoothingFactor:4,contourNumLevels:5,contourThickness:1,contourColormapEnabled:!1,contourColor:L.a.GREEN3,contourColormap:"viridis"},VECTOR_OVERLAY:{vectorOverlayPixelAveraging:4,vectorOverlayFractionalIntensity:!1,vectorOverlayThickness:1,vectorOverlayColormapEnabled:!1,vectorOverlayColor:L.a.GREEN3,vectorOverlayColormap:"viridis"},WCS_OVERLAY:{astColor:"auto-blue",astGridVisible:!1,astLabelsVisible:!0,wcsType:Mi.AUTOMATIC,colorbarVisible:!0,colorbarInteractive:!0,colorbarPosition:"right",colorbarWidth:15,colorbarTicksDensity:1,colorbarLabelVisible:!1,beamVisible:!0,beamColor:"auto-gray",beamType:rA.Open,beamWidth:1,cursorInfoVisible:_t.ActiveImage},REGION:{regionColor:"#2EE6D6",regionLineWidth:2,regionDashLength:0,regionType:Nt.RegionType.RECTANGLE,regionCreationMode:Fi.CENTER,regionSize:30},PERFORMANCE:{imageCompressionQuality:ki.IMAGE_DEFAULT,animationCompressionQuality:ki.ANIMATION_DEFAULT,GPUTileCache:Di.GPU_DEFAULT,systemTileCache:Di.SYSTEM_DEFAULT,contourDecimation:4,contourCompressionLevel:8,contourChunkSize:1e5,contourControlMapWidth:256,streamContoursWhileZooming:!1,lowBandwidthMode:!1,stopAnimationPlaybackMinutes:5,limitOverlayRedraw:!0},LOG_EVENT:{eventLoggingEnabled:[]},CATALOG:{catalogDisplayedColumnSize:10,catalogTableSeparatorPosition:"60%"},STATS_PANEL:{statsPanelEnabled:!1,statsPanelMode:0},TELEMETRY:{telemetryConsentShown:!1,telemetryMode:Sj.Usage,telemetryLogging:!1}};let JA=(XA=UA=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get theme(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_THEME))&&void 0!==e?e:ZA.GLOBAL.theme}get autoLaunch(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_AUTOLAUNCH))&&void 0!==e?e:ZA.GLOBAL.autoLaunch}get fileFilterMode(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_FILE_FILTER_MODE))&&void 0!==e?e:ZA.GLOBAL.fileFilterMode}get fileSortingString(){var e;return null!==(e=this.preferences.get(QA.SILENT_FILE_SORTING_STRING))&&void 0!==e?e:ZA.SILENT.fileSortingString}get fileFilteringType(){var e;return null!==(e=this.preferences.get(QA.SILENT_FILE_FILTERING_TYPE))&&void 0!==e?e:ZA.SILENT.fileFilteringType}get layout(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_LAYOUT))&&void 0!==e?e:ZA.GLOBAL.layout}get cursorPosition(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_CURSOR_POSITION))&&void 0!==e?e:ZA.GLOBAL.cursorPosition}get zoomMode(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_ZOOM_MODE))&&void 0!==e?e:ZA.GLOBAL.zoomMode}get zoomPoint(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_ZOOM_POINT))&&void 0!==e?e:ZA.GLOBAL.zoomPoint}get dragPanning(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_DRAG_PANNING))&&void 0!==e?e:ZA.GLOBAL.dragPanning}get spectralMatchingType(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_SPECTRAL_MATCHING_TYPE))&&void 0!==e?e:ZA.GLOBAL.spectralMatchingType}get autoWCSMatching(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_AUTO_WCS_MATCHING))&&void 0!==e?e:ZA.GLOBAL.autoWCSMatching}get transparentImageBackground(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND))&&void 0!==e?e:ZA.GLOBAL.transparentImageBackground}get codeSnippetsEnabled(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_CODE_SNIPPETS_ENABLED))&&void 0!==e?e:ZA.GLOBAL.codeSnippetsEnabled}get keepLastUsedFolder(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_KEEP_LAST_USED_FOLDER))&&void 0!==e?e:ZA.GLOBAL.keepLastUsedFolder}get lastUsedFolder(){var e;return null!==(e=this.preferences.get(QA.GLOBAL_SAVED_LAST_FOLDER))&&void 0!==e?e:ZA.GLOBAL.lastUsedFolder}get scaling(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_SCALING))&&void 0!==e?e:ZA.RENDER_CONFIG.scaling}get colormap(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_COLORMAP))&&void 0!==e?e:ZA.RENDER_CONFIG.colormap}get percentile(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_PERCENTILE))&&void 0!==e?e:ZA.RENDER_CONFIG.percentile}get scalingAlpha(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_SCALING_ALPHA))&&void 0!==e?e:ZA.RENDER_CONFIG.scalingAlpha}get scalingGamma(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_SCALING_GAMMA))&&void 0!==e?e:ZA.RENDER_CONFIG.scalingGamma}get nanColorHex(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_NAN_COLOR_HEX))&&void 0!==e?e:ZA.RENDER_CONFIG.nanColorHex}get nanAlpha(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_NAN_ALPHA))&&void 0!==e?e:ZA.RENDER_CONFIG.nanAlpha}get useSmoothedBiasContrast(){var e;return null!==(e=this.preferences.get(QA.RENDER_CONFIG_USE_SMOOTHED_BIAS_CONTRAST))&&void 0!==e?e:ZA.RENDER_CONFIG.useSmoothedBiasContrast}get contourGeneratorType(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_GENERATOR_TYPE))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourGeneratorType}get contourColormapEnabled(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_COLORMAP_ENABLED))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourColormapEnabled}get contourColormap(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_COLORMAP))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourColormap}get contourColor(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_COLOR))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourColor}get contourSmoothingMode(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_SMOOTHING_MODE))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourSmoothingMode}get contourSmoothingFactor(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_SMOOTHING_FACTOR))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourSmoothingFactor}get contourNumLevels(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_NUM_LEVELS))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourNumLevels}get contourThickness(){var e;return null!==(e=this.preferences.get(QA.CONTOUR_CONFIG_THICKNESS))&&void 0!==e?e:ZA.CONTOUR_CONFIG.contourThickness}get contourDecimation(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_CONTOUR_DECIMATION))&&void 0!==e?e:ZA.PERFORMANCE.contourDecimation}get contourCompressionLevel(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL))&&void 0!==e?e:ZA.PERFORMANCE.contourCompressionLevel}get contourChunkSize(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_CONTOUR_CHUNK_SIZE))&&void 0!==e?e:ZA.PERFORMANCE.contourChunkSize}get vectorOverlayPixelAveraging(){var e;return null!==(e=this.preferences.get(QA.VECTOR_OVERLAY_PIXEL_AVERAGING))&&void 0!==e?e:ZA.VECTOR_OVERLAY.vectorOverlayPixelAveraging}get vectorOverlayFractionalIntensity(){var e;return null!==(e=this.preferences.get(QA.VECTOR_OVERLAY_FRACTIONAL_INTENSITY))&&void 0!==e?e:ZA.VECTOR_OVERLAY.vectorOverlayFractionalIntensity}get vectorOverlayThickness(){var e;return null!==(e=this.preferences.get(QA.VECTOR_OVERLAY_THICKNESS))&&void 0!==e?e:ZA.VECTOR_OVERLAY.vectorOverlayThickness}get vectorOverlayColormapEnabled(){var e;return null!==(e=this.preferences.get(QA.VECTOR_OVERLAY_COLORMAP_ENABLED))&&void 0!==e?e:ZA.VECTOR_OVERLAY.vectorOverlayColormapEnabled}get vectorOverlayColor(){var e;return null!==(e=this.preferences.get(QA.VECTOR_OVERLAY_COLOR))&&void 0!==e?e:ZA.VECTOR_OVERLAY.vectorOverlayColor}get vectorOverlayColormap(){var e;return null!==(e=this.preferences.get(QA.VECTOR_OVERLAY_COLORMAP))&&void 0!==e?e:ZA.VECTOR_OVERLAY.vectorOverlayColormap}get astColor(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_AST_COLOR))&&void 0!==e?e:ZA.WCS_OVERLAY.astColor}get astGridVisible(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_AST_GRID_VISIBLE))&&void 0!==e?e:ZA.WCS_OVERLAY.astGridVisible}get astLabelsVisible(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_AST_LABELS_VISIBLE))&&void 0!==e?e:ZA.WCS_OVERLAY.astLabelsVisible}get wcsType(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_WCS_TYPE))&&void 0!==e?e:ZA.WCS_OVERLAY.wcsType}get colorbarVisible(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_COLORBAR_VISIBLE))&&void 0!==e?e:ZA.WCS_OVERLAY.colorbarVisible}get colorbarInteractive(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_COLORBAR_INTERACTIVE))&&void 0!==e?e:ZA.WCS_OVERLAY.colorbarInteractive}get colorbarPosition(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_COLORBAR_POSITION))&&void 0!==e?e:ZA.WCS_OVERLAY.colorbarPosition}get colorbarWidth(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_COLORBAR_WIDTH))&&void 0!==e?e:ZA.WCS_OVERLAY.colorbarWidth}get colorbarTicksDensity(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_COLORBAR_TICKS_DENSITY))&&void 0!==e?e:ZA.WCS_OVERLAY.colorbarTicksDensity}get colorbarLabelVisible(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_COLORBAR_LABEL_VISIBLE))&&void 0!==e?e:ZA.WCS_OVERLAY.colorbarLabelVisible}get beamVisible(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_BEAM_VISIBLE))&&void 0!==e?e:ZA.WCS_OVERLAY.beamVisible}get beamColor(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_BEAM_COLOR))&&void 0!==e?e:ZA.WCS_OVERLAY.beamColor}get beamType(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_BEAM_TYPE))&&void 0!==e?e:ZA.WCS_OVERLAY.beamType}get beamWidth(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_BEAM_WIDTH))&&void 0!==e?e:ZA.WCS_OVERLAY.beamWidth}get cursorInfoVisible(){var e;return null!==(e=this.preferences.get(QA.WCS_OVERLAY_CURSOR_INFO))&&void 0!==e?e:ZA.WCS_OVERLAY.cursorInfoVisible}get regionColor(){var e;return null!==(e=this.preferences.get(QA.REGION_COLOR))&&void 0!==e?e:ZA.REGION.regionColor}get regionLineWidth(){var e;return null!==(e=this.preferences.get(QA.REGION_LINE_WIDTH))&&void 0!==e?e:ZA.REGION.regionLineWidth}get regionDashLength(){var e;return null!==(e=this.preferences.get(QA.REGION_DASH_LENGTH))&&void 0!==e?e:ZA.REGION.regionDashLength}get regionType(){var e;return null!==(e=this.preferences.get(QA.REGION_TYPE))&&void 0!==e?e:ZA.REGION.regionType}get regionCreationMode(){var e;return null!==(e=this.preferences.get(QA.REGION_CREATION_MODE))&&void 0!==e?e:ZA.REGION.regionCreationMode}get regionSize(){var e;return null!==(e=this.preferences.get(QA.REGION_SIZE))&&void 0!==e?e:ZA.REGION.regionSize}get imageCompressionQuality(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_IMAGE_COMPRESSION_QUALITY))&&void 0!==e?e:ZA.PERFORMANCE.imageCompressionQuality}get animationCompressionQuality(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY))&&void 0!==e?e:ZA.PERFORMANCE.animationCompressionQuality}get gpuTileCache(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_GPU_TILE_CACHE))&&void 0!==e?e:ZA.PERFORMANCE.GPUTileCache}get systemTileCache(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_SYSTEM_TILE_CACHE))&&void 0!==e?e:ZA.PERFORMANCE.systemTileCache}get contourControlMapWidth(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH))&&void 0!==e?e:ZA.PERFORMANCE.contourControlMapWidth}get streamContoursWhileZooming(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING))&&void 0!==e?e:ZA.PERFORMANCE.streamContoursWhileZooming}get lowBandwidthMode(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_LOW_BAND_WIDTH_MODE))&&void 0!==e?e:ZA.PERFORMANCE.lowBandwidthMode}get stopAnimationPlaybackMinutes(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES))&&void 0!==e?e:ZA.PERFORMANCE.stopAnimationPlaybackMinutes}get isSelectingAllLogEvents(){var e;return(null===(e=this.preferences.get(QA.LOG_EVENT))||void 0===e?void 0:e.length)===Li.EVENT_NUMBER}get isSelectingIndeterminateLogEvents(){var e;const t=null===(e=this.preferences.get(QA.LOG_EVENT))||void 0===e?void 0:e.length;return t>0&&t<Li.EVENT_NUMBER}get isZoomRAWMode(){return this.zoomMode===Pi.FULL}get isRegionCornerMode(){return this.regionCreationMode===Fi.CORNER}get isCursorFrozen(){return this.cursorPosition===Ai.FIXED}get enabledLoggingEventNames(){var e;return null!==(e=this.preferences.get(QA.LOG_EVENT))&&void 0!==e?e:[]}get catalogDisplayedColumnSize(){var e;return null!==(e=this.preferences.get(QA.CATALOG_DISPLAYED_COLUMN_SIZE))&&void 0!==e?e:ZA.CATALOG.catalogDisplayedColumnSize}get catalogTableSeparatorPosition(){var e;return null!==(e=this.preferences.get(QA.CATALOG_TABLE_SEPARATOR_POSITION))&&void 0!==e?e:ZA.CATALOG.catalogTableSeparatorPosition}get pixelGridVisible(){var e;return null!==(e=this.preferences.get(QA.PIXEL_GRID_VISIBLE))&&void 0!==e?e:ZA.SILENT.pixelGridVisible}get pixelGridColor(){var e;return null!==(e=this.preferences.get(QA.PIXEL_GRID_COLOR))&&void 0!==e?e:ZA.SILENT.pixelGridColor}get limitOverlayRedraw(){var e;return null!==(e=this.preferences.get(QA.PERFORMANCE_LIMIT_OVERLAY_REDRAW))&&void 0!==e?e:ZA.PERFORMANCE.limitOverlayRedraw}get imageMultiPanelEnabled(){var e;return null!==(e=this.preferences.get(QA.IMAGE_MULTI_PANEL_ENABLED))&&void 0!==e?e:ZA.SILENT.imagePanelMode}get imagePanelMode(){var e;return null!==(e=this.preferences.get(QA.IMAGE_PANEL_MODE))&&void 0!==e?e:ZA.SILENT.imagePanelMode}get imagePanelColumns(){var e;return null!==(e=this.preferences.get(QA.IMAGE_PANEL_COLUMNS))&&void 0!==e?e:ZA.SILENT.imagePanelColumns}get imagePanelRows(){var e;return null!==(e=this.preferences.get(QA.IMAGE_PANEL_ROWS))&&void 0!==e?e:ZA.SILENT.imagePanelRows}get statsPanelEnabled(){var e;return null!==(e=this.preferences.get(QA.STATS_PANEL_ENABLED))&&void 0!==e?e:ZA.STATS_PANEL.statsPanelEnabled}get statsPanelMode(){var e;return null!==(e=this.preferences.get(QA.STATS_PANEL_MODE))&&void 0!==e?e:ZA.STATS_PANEL.statsPanelMode}get telemetryConsentShown(){var e;return null!==(e=this.preferences.get(QA.TELEMETRY_CONSENT_SHOWN))&&void 0!==e?e:ZA.TELEMETRY.telemetryConsentShown}get telemetryMode(){var e;return null!==(e=this.preferences.get(QA.TELEMETRY_MODE))&&void 0!==e?e:ZA.TELEMETRY.telemetryMode}get telemetryLogging(){var e;return null!==(e=this.preferences.get(QA.TELEMETRY_LOGGING))&&void 0!==e?e:ZA.TELEMETRY.telemetryLogging}get telemetryUuid(){return this.preferences.get(QA.TELEMETRY_UUID)}constructor(){Object(f.a)(this,"preferences",PA,this),Object(f.a)(this,"supportsServer",EA,this),this.isEventLoggingEnabled=e=>{if(Li.isEventTypeValid(e)){const t=this.preferences.get(QA.LOG_EVENT);if(t&&Array.isArray(t))return t.includes(e)}return!1},Object(f.a)(this,"setPreference",MA,this),Object(f.a)(this,"clearPreferences",FA,this),Object(f.a)(this,"resetSilentSettings",kA,this),Object(f.a)(this,"resetGlobalSettings",DA,this),Object(f.a)(this,"resetRenderConfigSettings",LA,this),Object(f.a)(this,"resetContourConfigSettings",NA,this),Object(f.a)(this,"resetVectorOverlayConfigSettings",_A,this),Object(f.a)(this,"resetOverlayConfigSettings",zA,this),Object(f.a)(this,"resetRegionSettings",VA,this),Object(f.a)(this,"resetPerformanceSettings",WA,this),Object(f.a)(this,"selectAllLogEvents",GA,this),Object(f.a)(this,"resetLogEventSettings",BA,this),Object(f.a)(this,"resetCatalogSettings",qA,this),Object(f.a)(this,"resetTelemetrySettings",HA,this),Object(f.a)(this,"fetchPreferences",YA,this),this.getPreferences=async()=>{const e=await pj.Instance.getPreferences();if(e){const t=Object.keys(e);for(const i of t){const t=e[i];this.preferences.set(i,t)}}},this.upgradePreferences=async()=>{if(!localStorage.getItem("preferences")){const n=[QA.GLOBAL_THEME,QA.GLOBAL_LAYOUT,QA.GLOBAL_CURSOR_POSITION,QA.GLOBAL_ZOOM_MODE,QA.GLOBAL_ZOOM_POINT,QA.GLOBAL_SPECTRAL_MATCHING_TYPE,QA.RENDER_CONFIG_COLORMAP,QA.RENDER_CONFIG_NAN_COLOR_HEX,QA.CONTOUR_CONFIG_GENERATOR_TYPE,QA.CONTOUR_CONFIG_COLOR,QA.CONTOUR_CONFIG_COLORMAP,QA.WCS_OVERLAY_WCS_TYPE,QA.WCS_OVERLAY_COLORBAR_POSITION,QA.WCS_OVERLAY_BEAM_COLOR,QA.WCS_OVERLAY_BEAM_TYPE,QA.REGION_COLOR,QA.REGION_CREATION_MODE,QA.WCS_OVERLAY_AST_COLOR,QA.CATALOG_TABLE_SEPARATOR_POSITION,QA.PIXEL_GRID_COLOR],r=[QA.GLOBAL_AUTO_WCS_MATCHING,QA.RENDER_CONFIG_SCALING,QA.CONTOUR_CONFIG_SMOOTHING_MODE,QA.CONTOUR_CONFIG_SMOOTHING_FACTOR,QA.CONTOUR_CONFIG_NUM_LEVELS,QA.REGION_DASH_LENGTH,QA.REGION_TYPE,QA.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,QA.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,QA.PERFORMANCE_GPU_TILE_CACHE,QA.PERFORMANCE_SYSTEM_TILE_CACHE,QA.PERFORMANCE_CONTOUR_DECIMATION,QA.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,QA.PERFORMANCE_CONTOUR_CHUNK_SIZE,QA.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,QA.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,QA.CATALOG_DISPLAYED_COLUMN_SIZE],o=[QA.RENDER_CONFIG_PERCENTILE,QA.RENDER_CONFIG_SCALING_ALPHA,QA.RENDER_CONFIG_SCALING_GAMMA,QA.RENDER_CONFIG_NAN_ALPHA,QA.CONTOUR_CONFIG_THICKNESS,QA.WCS_OVERLAY_COLORBAR_WIDTH,QA.WCS_OVERLAY_COLORBAR_TICKS_DENSITY,QA.WCS_OVERLAY_BEAM_WIDTH,QA.REGION_LINE_WIDTH],s=[QA.GLOBAL_AUTOLAUNCH,QA.GLOBAL_DRAG_PANNING,QA.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND,QA.RENDER_CONFIG_USE_SMOOTHED_BIAS_CONTRAST,QA.CONTOUR_CONFIG_COLORMAP_ENABLED,QA.WCS_OVERLAY_AST_GRID_VISIBLE,QA.WCS_OVERLAY_AST_LABELS_VISIBLE,QA.WCS_OVERLAY_COLORBAR_VISIBLE,QA.WCS_OVERLAY_COLORBAR_INTERACTIVE,QA.WCS_OVERLAY_COLORBAR_LABEL_VISIBLE,QA.WCS_OVERLAY_BEAM_VISIBLE,QA.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,QA.PERFORMANCE_LOW_BAND_WIDTH_MODE,QA.PIXEL_GRID_VISIBLE],a={};for(const e of n){const t=localStorage.getItem(e);t&&(a[e]=t)}for(const e of r){const t=parseInt(localStorage.getItem(e));isFinite(t)&&(a[e]=t)}for(const e of o){const t=parseFloat(localStorage.getItem(e));isFinite(t)&&(a[e]=t)}for(const i of s){localStorage.getItem(i)&&(a[i]=(e=localStorage.getItem(i),t=!1,"true"===e||"false"!==e&&t))}const l=localStorage.getItem(QA.LOG_EVENT);if(l)try{const e=JSON.parse(l);e&&Array.isArray(e)&&(a[QA.LOG_EVENT]=e)}catch(i){console.log("Problem parsing log events")}a[QA.WCS_OVERLAY_BEAM_TYPE]&&(a[QA.WCS_OVERLAY_BEAM_TYPE]=a[QA.WCS_OVERLAY_BEAM_TYPE].toLowerCase()),"1.0x"===a[QA.GLOBAL_ZOOM_MODE]&&(a[QA.GLOBAL_ZOOM_MODE]="full");for(const e of Object.keys(a))this.preferences.set(e,a[e]);a.version=1,await pj.Instance.setPreferences(a)}var e,t},Object(m.p)(this),this.preferences=new Map}},UA.staticInstance=void 0,AA=XA,PA=Object(b.a)(AA.prototype,"preferences",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),EA=Object(b.a)(AA.prototype,"supportsServer",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(AA.prototype,"theme",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"theme"),AA.prototype),Object(b.a)(AA.prototype,"autoLaunch",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"autoLaunch"),AA.prototype),Object(b.a)(AA.prototype,"fileFilterMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"fileFilterMode"),AA.prototype),Object(b.a)(AA.prototype,"fileSortingString",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"fileSortingString"),AA.prototype),Object(b.a)(AA.prototype,"fileFilteringType",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"fileFilteringType"),AA.prototype),Object(b.a)(AA.prototype,"layout",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"layout"),AA.prototype),Object(b.a)(AA.prototype,"cursorPosition",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"cursorPosition"),AA.prototype),Object(b.a)(AA.prototype,"zoomMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"zoomMode"),AA.prototype),Object(b.a)(AA.prototype,"zoomPoint",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"zoomPoint"),AA.prototype),Object(b.a)(AA.prototype,"dragPanning",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"dragPanning"),AA.prototype),Object(b.a)(AA.prototype,"spectralMatchingType",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"spectralMatchingType"),AA.prototype),Object(b.a)(AA.prototype,"autoWCSMatching",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"autoWCSMatching"),AA.prototype),Object(b.a)(AA.prototype,"transparentImageBackground",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"transparentImageBackground"),AA.prototype),Object(b.a)(AA.prototype,"codeSnippetsEnabled",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"codeSnippetsEnabled"),AA.prototype),Object(b.a)(AA.prototype,"keepLastUsedFolder",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"keepLastUsedFolder"),AA.prototype),Object(b.a)(AA.prototype,"lastUsedFolder",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"lastUsedFolder"),AA.prototype),Object(b.a)(AA.prototype,"scaling",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"scaling"),AA.prototype),Object(b.a)(AA.prototype,"colormap",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colormap"),AA.prototype),Object(b.a)(AA.prototype,"percentile",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"percentile"),AA.prototype),Object(b.a)(AA.prototype,"scalingAlpha",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"scalingAlpha"),AA.prototype),Object(b.a)(AA.prototype,"scalingGamma",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"scalingGamma"),AA.prototype),Object(b.a)(AA.prototype,"nanColorHex",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"nanColorHex"),AA.prototype),Object(b.a)(AA.prototype,"nanAlpha",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"nanAlpha"),AA.prototype),Object(b.a)(AA.prototype,"useSmoothedBiasContrast",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"useSmoothedBiasContrast"),AA.prototype),Object(b.a)(AA.prototype,"contourGeneratorType",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourGeneratorType"),AA.prototype),Object(b.a)(AA.prototype,"contourColormapEnabled",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourColormapEnabled"),AA.prototype),Object(b.a)(AA.prototype,"contourColormap",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourColormap"),AA.prototype),Object(b.a)(AA.prototype,"contourColor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourColor"),AA.prototype),Object(b.a)(AA.prototype,"contourSmoothingMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourSmoothingMode"),AA.prototype),Object(b.a)(AA.prototype,"contourSmoothingFactor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourSmoothingFactor"),AA.prototype),Object(b.a)(AA.prototype,"contourNumLevels",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourNumLevels"),AA.prototype),Object(b.a)(AA.prototype,"contourThickness",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourThickness"),AA.prototype),Object(b.a)(AA.prototype,"contourDecimation",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourDecimation"),AA.prototype),Object(b.a)(AA.prototype,"contourCompressionLevel",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourCompressionLevel"),AA.prototype),Object(b.a)(AA.prototype,"contourChunkSize",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourChunkSize"),AA.prototype),Object(b.a)(AA.prototype,"vectorOverlayPixelAveraging",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"vectorOverlayPixelAveraging"),AA.prototype),Object(b.a)(AA.prototype,"vectorOverlayFractionalIntensity",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"vectorOverlayFractionalIntensity"),AA.prototype),Object(b.a)(AA.prototype,"vectorOverlayThickness",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"vectorOverlayThickness"),AA.prototype),Object(b.a)(AA.prototype,"vectorOverlayColormapEnabled",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"vectorOverlayColormapEnabled"),AA.prototype),Object(b.a)(AA.prototype,"vectorOverlayColor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"vectorOverlayColor"),AA.prototype),Object(b.a)(AA.prototype,"vectorOverlayColormap",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"vectorOverlayColormap"),AA.prototype),Object(b.a)(AA.prototype,"astColor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"astColor"),AA.prototype),Object(b.a)(AA.prototype,"astGridVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"astGridVisible"),AA.prototype),Object(b.a)(AA.prototype,"astLabelsVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"astLabelsVisible"),AA.prototype),Object(b.a)(AA.prototype,"wcsType",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"wcsType"),AA.prototype),Object(b.a)(AA.prototype,"colorbarVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colorbarVisible"),AA.prototype),Object(b.a)(AA.prototype,"colorbarInteractive",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colorbarInteractive"),AA.prototype),Object(b.a)(AA.prototype,"colorbarPosition",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colorbarPosition"),AA.prototype),Object(b.a)(AA.prototype,"colorbarWidth",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colorbarWidth"),AA.prototype),Object(b.a)(AA.prototype,"colorbarTicksDensity",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colorbarTicksDensity"),AA.prototype),Object(b.a)(AA.prototype,"colorbarLabelVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"colorbarLabelVisible"),AA.prototype),Object(b.a)(AA.prototype,"beamVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"beamVisible"),AA.prototype),Object(b.a)(AA.prototype,"beamColor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"beamColor"),AA.prototype),Object(b.a)(AA.prototype,"beamType",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"beamType"),AA.prototype),Object(b.a)(AA.prototype,"beamWidth",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"beamWidth"),AA.prototype),Object(b.a)(AA.prototype,"cursorInfoVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"cursorInfoVisible"),AA.prototype),Object(b.a)(AA.prototype,"regionColor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"regionColor"),AA.prototype),Object(b.a)(AA.prototype,"regionLineWidth",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"regionLineWidth"),AA.prototype),Object(b.a)(AA.prototype,"regionDashLength",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"regionDashLength"),AA.prototype),Object(b.a)(AA.prototype,"regionType",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"regionType"),AA.prototype),Object(b.a)(AA.prototype,"regionCreationMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"regionCreationMode"),AA.prototype),Object(b.a)(AA.prototype,"regionSize",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"regionSize"),AA.prototype),Object(b.a)(AA.prototype,"imageCompressionQuality",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"imageCompressionQuality"),AA.prototype),Object(b.a)(AA.prototype,"animationCompressionQuality",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"animationCompressionQuality"),AA.prototype),Object(b.a)(AA.prototype,"gpuTileCache",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"gpuTileCache"),AA.prototype),Object(b.a)(AA.prototype,"systemTileCache",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"systemTileCache"),AA.prototype),Object(b.a)(AA.prototype,"contourControlMapWidth",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"contourControlMapWidth"),AA.prototype),Object(b.a)(AA.prototype,"streamContoursWhileZooming",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"streamContoursWhileZooming"),AA.prototype),Object(b.a)(AA.prototype,"lowBandwidthMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"lowBandwidthMode"),AA.prototype),Object(b.a)(AA.prototype,"stopAnimationPlaybackMinutes",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"stopAnimationPlaybackMinutes"),AA.prototype),Object(b.a)(AA.prototype,"isSelectingAllLogEvents",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"isSelectingAllLogEvents"),AA.prototype),Object(b.a)(AA.prototype,"isSelectingIndeterminateLogEvents",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"isSelectingIndeterminateLogEvents"),AA.prototype),Object(b.a)(AA.prototype,"isZoomRAWMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"isZoomRAWMode"),AA.prototype),Object(b.a)(AA.prototype,"isRegionCornerMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"isRegionCornerMode"),AA.prototype),Object(b.a)(AA.prototype,"isCursorFrozen",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"isCursorFrozen"),AA.prototype),Object(b.a)(AA.prototype,"enabledLoggingEventNames",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"enabledLoggingEventNames"),AA.prototype),Object(b.a)(AA.prototype,"catalogDisplayedColumnSize",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"catalogDisplayedColumnSize"),AA.prototype),Object(b.a)(AA.prototype,"catalogTableSeparatorPosition",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"catalogTableSeparatorPosition"),AA.prototype),Object(b.a)(AA.prototype,"pixelGridVisible",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"pixelGridVisible"),AA.prototype),Object(b.a)(AA.prototype,"pixelGridColor",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"pixelGridColor"),AA.prototype),Object(b.a)(AA.prototype,"limitOverlayRedraw",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"limitOverlayRedraw"),AA.prototype),Object(b.a)(AA.prototype,"imageMultiPanelEnabled",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"imageMultiPanelEnabled"),AA.prototype),Object(b.a)(AA.prototype,"imagePanelMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"imagePanelMode"),AA.prototype),Object(b.a)(AA.prototype,"imagePanelColumns",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"imagePanelColumns"),AA.prototype),Object(b.a)(AA.prototype,"imagePanelRows",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"imagePanelRows"),AA.prototype),Object(b.a)(AA.prototype,"statsPanelEnabled",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"statsPanelEnabled"),AA.prototype),Object(b.a)(AA.prototype,"statsPanelMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"statsPanelMode"),AA.prototype),Object(b.a)(AA.prototype,"telemetryConsentShown",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"telemetryConsentShown"),AA.prototype),Object(b.a)(AA.prototype,"telemetryMode",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"telemetryMode"),AA.prototype),Object(b.a)(AA.prototype,"telemetryLogging",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"telemetryLogging"),AA.prototype),Object(b.a)(AA.prototype,"telemetryUuid",[m.i],Object.getOwnPropertyDescriptor(AA.prototype,"telemetryUuid"),AA.prototype),MA=Object(b.a)(AA.prototype,"setPreference",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{if(!e)return!1;if(e===QA.LOG_EVENT){if(!Li.isEventTypeValid(t))return!1;let e=this.preferences.get(QA.LOG_EVENT);return e&&Array.isArray(e)||(e=[]),e.includes(t)?e=e.filter((e=>e!==t)):e.push(t),this.preferences.set(QA.LOG_EVENT,e),await pj.Instance.setPreference(QA.LOG_EVENT,e)}return this.preferences.set(e,t),await pj.Instance.setPreference(e,t)}}}),FA=Object(b.a)(AA.prototype,"clearPreferences",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async e=>{for(const t of e)this.preferences.delete(t);await pj.Instance.clearPreferences(e)}}}),kA=Object(b.a)(AA.prototype,"resetSilentSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.SILENT_FILE_SORTING_STRING,QA.SILENT_FILE_FILTERING_TYPE,QA.PIXEL_GRID_VISIBLE,QA.PIXEL_GRID_COLOR,QA.IMAGE_MULTI_PANEL_ENABLED,QA.IMAGE_PANEL_MODE,QA.IMAGE_PANEL_COLUMNS,QA.IMAGE_PANEL_ROWS])}}}),DA=Object(b.a)(AA.prototype,"resetGlobalSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.GLOBAL_THEME,QA.GLOBAL_AUTOLAUNCH,QA.GLOBAL_FILE_FILTER_MODE,QA.GLOBAL_LAYOUT,QA.GLOBAL_CURSOR_POSITION,QA.GLOBAL_ZOOM_MODE,QA.GLOBAL_ZOOM_POINT,QA.GLOBAL_DRAG_PANNING,QA.GLOBAL_SPECTRAL_MATCHING_TYPE,QA.GLOBAL_AUTO_WCS_MATCHING,QA.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND,QA.GLOBAL_CODE_SNIPPETS_ENABLED,QA.GLOBAL_KEEP_LAST_USED_FOLDER,QA.GLOBAL_SAVED_LAST_FOLDER])}}}),LA=Object(b.a)(AA.prototype,"resetRenderConfigSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.RENDER_CONFIG_COLORMAP,QA.RENDER_CONFIG_NAN_ALPHA,QA.RENDER_CONFIG_NAN_COLOR_HEX,QA.RENDER_CONFIG_PERCENTILE,QA.RENDER_CONFIG_SCALING,QA.RENDER_CONFIG_SCALING_ALPHA,QA.RENDER_CONFIG_SCALING_GAMMA,QA.RENDER_CONFIG_USE_SMOOTHED_BIAS_CONTRAST])}}}),NA=Object(b.a)(AA.prototype,"resetContourConfigSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.CONTOUR_CONFIG_COLOR,QA.CONTOUR_CONFIG_COLORMAP,QA.CONTOUR_CONFIG_COLORMAP_ENABLED,QA.CONTOUR_CONFIG_GENERATOR_TYPE,QA.CONTOUR_CONFIG_NUM_LEVELS,QA.CONTOUR_CONFIG_SMOOTHING_FACTOR,QA.CONTOUR_CONFIG_SMOOTHING_MODE,QA.CONTOUR_CONFIG_THICKNESS])}}}),_A=Object(b.a)(AA.prototype,"resetVectorOverlayConfigSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.VECTOR_OVERLAY_PIXEL_AVERAGING,QA.VECTOR_OVERLAY_FRACTIONAL_INTENSITY,QA.VECTOR_OVERLAY_COLOR,QA.VECTOR_OVERLAY_COLORMAP,QA.VECTOR_OVERLAY_COLORMAP_ENABLED,QA.VECTOR_OVERLAY_THICKNESS])}}}),zA=Object(b.a)(AA.prototype,"resetOverlayConfigSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.WCS_OVERLAY_AST_COLOR,QA.WCS_OVERLAY_AST_GRID_VISIBLE,QA.WCS_OVERLAY_AST_LABELS_VISIBLE,QA.WCS_OVERLAY_COLORBAR_VISIBLE,QA.WCS_OVERLAY_COLORBAR_INTERACTIVE,QA.WCS_OVERLAY_COLORBAR_POSITION,QA.WCS_OVERLAY_COLORBAR_WIDTH,QA.WCS_OVERLAY_COLORBAR_TICKS_DENSITY,QA.WCS_OVERLAY_COLORBAR_LABEL_VISIBLE,QA.WCS_OVERLAY_BEAM_COLOR,QA.WCS_OVERLAY_BEAM_TYPE,QA.WCS_OVERLAY_BEAM_VISIBLE,QA.WCS_OVERLAY_BEAM_WIDTH,QA.WCS_OVERLAY_WCS_TYPE,QA.WCS_OVERLAY_CURSOR_INFO])}}}),VA=Object(b.a)(AA.prototype,"resetRegionSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.REGION_COLOR,QA.REGION_CREATION_MODE,QA.REGION_DASH_LENGTH,QA.REGION_LINE_WIDTH,QA.REGION_TYPE,QA.REGION_SIZE])}}}),WA=Object(b.a)(AA.prototype,"resetPerformanceSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,QA.PERFORMANCE_CONTOUR_CHUNK_SIZE,QA.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,QA.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,QA.PERFORMANCE_CONTOUR_DECIMATION,QA.PERFORMANCE_GPU_TILE_CACHE,QA.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,QA.PERFORMANCE_LOW_BAND_WIDTH_MODE,QA.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,QA.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,QA.PERFORMANCE_SYSTEM_TILE_CACHE,QA.PERFORMANCE_LIMIT_OVERLAY_REDRAW])}}}),GA=Object(b.a)(AA.prototype,"selectAllLogEvents",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isSelectingAllLogEvents||this.isSelectingIndeterminateLogEvents?this.resetLogEventSettings():Li.EVENT_TYPES.forEach((e=>this.setPreference(QA.LOG_EVENT,e)))}}}),BA=Object(b.a)(AA.prototype,"resetLogEventSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.LOG_EVENT])}}}),qA=Object(b.a)(AA.prototype,"resetCatalogSettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.CATALOG_DISPLAYED_COLUMN_SIZE,QA.CATALOG_TABLE_SEPARATOR_POSITION])}}}),HA=Object(b.a)(AA.prototype,"resetTelemetrySettings",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([QA.TELEMETRY_CONSENT_SHOWN,QA.TELEMETRY_MODE,QA.TELEMETRY_LOGGING])}}}),YA=Object(b.a)(AA.prototype,"fetchPreferences",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{await this.upgradePreferences(),await this.getPreferences()}}}),AA);var eP,tP,iP,nP,rP,oP,sP,aP,lP,cP,dP,pP,hP,uP,gP,fP,bP,mP,yP,OP,jP,xP,SP,vP,CP,IP,wP,TP,RP,AP,PP,EP,MP,FP,kP,DP,LP,NP,_P;let zP;!function(e){e.Region="Region List Widget",e.Log="Log Widget",e.SpatialProfiler="Spatial Profiler",e.SpectralProfiler="Spectral Profiler",e.Statistics="Statistics Widget",e.Histogram="Histogram Widget",e.Animator="Animator Widget",e.RenderConfig="Render Config Widget",e.StokesAnalysis="Stokes Analysis Widget",e.ImageList="Image List Widget",e.Catalog="Catalog Widget",e.SpectralLineQuery="Spectral Line Query Widget",e.CursorInfo="Cursor Info Widget",e.PvGenerator="PV Generator"}(zP||(zP={}));let VP=(eP=class{constructor(e,t){this.id=void 0,this.type=void 0,this.minWidth=void 0,this.minHeight=void 0,Object(f.a)(this,"defaultWidth",tP,this),Object(f.a)(this,"defaultHeight",iP,this),Object(f.a)(this,"defaultX",nP,this),Object(f.a)(this,"defaultY",rP,this),this.isCloseable=void 0,Object(f.a)(this,"title",oP,this),this.parentId=void 0,this.parentType=void 0,this.helpType=void 0,this.componentId=void 0,this.zIndex=0,Object(f.a)(this,"setDefaultPosition",sP,this),Object(f.a)(this,"setDefaultSize",aP,this),Object(m.p)(this),this.id=e,this.type=t.type,this.minWidth=t.minWidth,this.minHeight=t.minHeight,this.defaultWidth=t.defaultWidth||t.minWidth,this.defaultHeight=t.defaultHeight||t.minHeight,this.defaultX=t.defaultX,this.defaultY=t.defaultY,this.isCloseable=t.isCloseable,this.title=t.title,this.parentId=t.parentId,this.parentType=t.parentType,this.helpType=t.helpType,this.componentId=t.componentId}},tP=Object(b.a)(eP.prototype,"defaultWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iP=Object(b.a)(eP.prototype,"defaultHeight",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nP=Object(b.a)(eP.prototype,"defaultX",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rP=Object(b.a)(eP.prototype,"defaultY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oP=Object(b.a)(eP.prototype,"title",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sP=Object(b.a)(eP.prototype,"setDefaultPosition",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultX=e,this.defaultY=t}}}),aP=Object(b.a)(eP.prototype,"setDefaultSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultWidth=e,this.defaultHeight=t}}}),eP);let WP=(_P=NP=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}static RemoveFrameFromRegionWidgets(e,t=-1){t===Gr?e.forEach((e=>{e.clearRegionMap(),e.setFileId(Gr)})):e.forEach((e=>{e.clearFrameEntry(t),e.fileId===t&&e.setFileId(Gr)}))}static ResetWidgetPlotXYBounds(e,t=-1){t===Gr?e.forEach((e=>{e.clearXYBounds()})):e.forEach((e=>{e.fileId===t&&e.clearXYBounds()}))}constructor(){Object(f.a)(this,"floatingWidgets",cP,this),Object(f.a)(this,"renderConfigWidgets",dP,this),Object(f.a)(this,"spatialProfileWidgets",pP,this),Object(f.a)(this,"spectralProfileWidgets",hP,this),Object(f.a)(this,"statsWidgets",uP,this),Object(f.a)(this,"histogramWidgets",gP,this),Object(f.a)(this,"layerListWidgets",fP,this),Object(f.a)(this,"logWidgets",bP,this),Object(f.a)(this,"regionListWidgets",mP,this),Object(f.a)(this,"animatorWidgets",yP,this),Object(f.a)(this,"stokesAnalysisWidgets",OP,this),Object(f.a)(this,"floatingSettingsWidgets",jP,this),Object(f.a)(this,"catalogWidgets",xP,this),Object(f.a)(this,"catalogPlotWidgets",SP,this),Object(f.a)(this,"spectralLineQueryWidgets",vP,this),Object(f.a)(this,"cursorInfoWidgets",CP,this),Object(f.a)(this,"pvGeneratorWidgets",IP,this),this.widgetsMap=void 0,this.defaultFloatingWidgetOffset=void 0,this.CARTAWidgets=new Map([[zP.Region,{isCustomIcon:!0,icon:"regionList",onClick:()=>e.Instance.createFloatingRegionListWidget(),widgetConfig:kB.WIDGET_CONFIG}],[zP.Log,{isCustomIcon:!1,icon:"application",onClick:()=>e.Instance.createFloatingLogWidget(),widgetConfig:BG.WIDGET_CONFIG}],[zP.SpatialProfiler,{isCustomIcon:!0,icon:"spatialProfiler",onClick:()=>e.Instance.createFloatingSpatialProfilerWidget(),widgetConfig:qB.WIDGET_CONFIG}],[zP.SpectralProfiler,{isCustomIcon:!0,icon:"spectralProfiler",onClick:()=>e.Instance.createFloatingSpectralProfilerWidget(),widgetConfig:bq.WIDGET_CONFIG}],[zP.Statistics,{isCustomIcon:!1,icon:"calculator",onClick:()=>e.Instance.createFloatingStatsWidget(),widgetConfig:Tq.WIDGET_CONFIG}],[zP.Histogram,{isCustomIcon:!1,icon:"timeline-bar-chart",onClick:()=>e.Instance.createFloatingHistogramWidget(),widgetConfig:Dq.WIDGET_CONFIG}],[zP.Animator,{isCustomIcon:!1,icon:"video",onClick:()=>e.Instance.createFloatingAnimatorWidget(),widgetConfig:UD.WIDGET_CONFIG}],[zP.RenderConfig,{isCustomIcon:!1,icon:"style",onClick:()=>e.Instance.createFloatingRenderWidget(),widgetConfig:SB.WIDGET_CONFIG}],[zP.StokesAnalysis,{isCustomIcon:!0,icon:"stokes",onClick:()=>e.Instance.createFloatingStokesWidget(),widgetConfig:Hq.WIDGET_CONFIG}],[zP.ImageList,{isCustomIcon:!1,icon:"layers",onClick:()=>e.Instance.createFloatingLayerListWidget(),widgetConfig:QG.WIDGET_CONFIG}],[zP.Catalog,{isCustomIcon:!1,icon:"heatmap",onClick:()=>e.Instance.reloadFloatingCatalogWidget(),widgetConfig:oH.WIDGET_CONFIG}],[zP.SpectralLineQuery,{isCustomIcon:!0,icon:"spectralLineQuery",onClick:()=>e.Instance.createFloatingSpectralLineQueryWidget(),widgetConfig:nq.WIDGET_CONFIG}],[zP.CursorInfo,{isCustomIcon:!0,icon:"cursor",onClick:()=>e.Instance.createFloatingCursorInfoWidget(),widgetConfig:JD.WIDGET_CONFIG}],[zP.PvGenerator,{isCustomIcon:!0,icon:"pv",onClick:()=>e.Instance.createFloatingPvGeneratorWidget(),widgetConfig:ZV.WIDGET_CONFIG}]]),this.getNextId=e=>{const t=this.widgetsMap.get(e);if(!t)return null;let i=0;for(;;){const n=`${e}-${i}`;if(!t.has(n))return n;i++}},this.getNextSettingId=(e,t)=>{const i=this.floatingSettingsWidgets;if(!i)return null;let n=!1;if(i.forEach((e=>{e===t&&(n=!0)})),n)return null;let r=0;for(;;){const n=`${t}-${e}-${r}`;if(!i.has(n))return n;r++}},this.getFloatingWidgetOffset=()=>(this.defaultFloatingWidgetOffset+=25,this.defaultFloatingWidgetOffset=(this.defaultFloatingWidgetOffset-100)%300+100,this.defaultFloatingWidgetOffset),this.removeWidget=(e,t)=>{const i=this.widgetsMap.get(t);i&&(this.removeAssociatedFloatingSetting(e),i.delete(e));this.floatingSettingsWidgets.has(e)&&this.floatingSettingsWidgets.delete(e)},this.addWidgetByType=(e,t=null)=>{let i;switch(e){case VG.WIDGET_CONFIG.type:i=VG.WIDGET_CONFIG.id;break;case SB.WIDGET_CONFIG.type:i=this.addRenderConfigWidget(null,t);break;case qB.WIDGET_CONFIG.type:i=this.addSpatialProfileWidget(null,t);break;case bq.WIDGET_CONFIG.type:i=this.addSpectralProfileWidget(null,t);break;case Tq.WIDGET_CONFIG.type:i=this.addStatsWidget();break;case Dq.WIDGET_CONFIG.type:i=this.addHistogramWidget(null,t);break;case UD.WIDGET_CONFIG.type:i=this.addAnimatorWidget();break;case QG.WIDGET_CONFIG.type:i=this.addLayerListWidget();break;case BG.WIDGET_CONFIG.type:i=this.addLogWidget();break;case kB.WIDGET_CONFIG.type:i=this.addRegionListWidget();break;case Hq.WIDGET_CONFIG.type:i=this.addStokesWidget(null,t);break;case nq.WIDGET_CONFIG.type:i=this.addSpectralLineQueryWidget();break;case JD.WIDGET_CONFIG.type:i=this.addCursorInfoWidget();break;case ZV.WIDGET_CONFIG.type:i=this.addPvGeneratorWidget();break;case oH.WIDGET_CONFIG.type:i=this.getNextComponentId(oH.WIDGET_CONFIG),hM.Instance.catalogProfiles.set(i,1),t&&this.addCatalogWidget(t.catalogFileId,null,t);break;case xd.D2Scatter:const n={xColumnName:"None",yColumnName:"None",plotType:xd.D2Scatter};i=this.addCatalogPlotWidget(n);const r=this.getNextComponentId(ZU.WIDGET_CONFIG);hM.Instance.setCatalogPlots(r,1,i);break;case xd.Histogram:const o={xColumnName:"None",yColumnName:void 0,plotType:xd.Histogram};i=this.addCatalogPlotWidget(o);const s=this.getNextComponentId(ZU.WIDGET_CONFIG);hM.Instance.setCatalogPlots(s,1,i);break;default:this.floatingWidgets.find((t=>t.id===e))&&this.removeFloatingWidget(e,!0),i=null}return i},this.removeFloatingWidgets=()=>{this.floatingWidgets&&this.floatingWidgets.forEach((e=>this.removeFloatingWidget(e.id)))},this.createFloatingWidget=t=>{if(t.id){let i=t.id;t.plotType&&(i=t.plotType);const n=this.addWidgetByType(i,t.widgetSettings);let r=new VP(n,e.GetDefaultWidgetConfig(t.id));if(r.setDefaultSize(t.defaultWidth||r.defaultWidth,t.defaultHeight||r.defaultHeight),r.componentId&&(r.componentId=r.id),t.defaultX>0&&t.defaultY>0)r.setDefaultPosition(t.defaultX,t.defaultY);else{const e=this.getFloatingWidgetOffset();r.setDefaultPosition(e,e)}this.floatingWidgets.push(r)}},this.initWidgets=(e,t)=>{e.forEach((e=>{if(e.id&&e.props){let t=e.id;"plotType"in e&&(t=e.plotType);const i=this.addWidgetByType(t,"widgetSettings"in e?e.widgetSettings:null);i&&(e.id=i,e.props.id=i)}})),t.forEach((e=>this.createFloatingWidget(e)))},this.initLayoutWithWidgets=t=>{if(!t)return void console.log("Invalid parameters!");t.registerComponent("placeholder",oB),t.registerComponent("image-view",VG),t.registerComponent("spatial-profiler",qB),t.registerComponent("spectral-profiler",bq),t.registerComponent("spectral-line-query",nq),t.registerComponent("stats",Tq),t.registerComponent("histogram",Dq),t.registerComponent("render-config",SB),t.registerComponent("region-list",kB),t.registerComponent("layer-list",QG),t.registerComponent("cursor-info",JD),t.registerComponent("pv-generator",ZV),t.registerComponent("log",BG),t.registerComponent("animator",UD),t.registerComponent("stokes",Hq),t.registerComponent("catalog-overlay",oH),t.registerComponent("catalog-plot",ZU);const i=["image-view","spatial-profiler","spectral-profiler","histogram","render-config","stokes","catalog-overlay","layer-list"];this.CARTAWidgets.forEach(((i,n)=>{const r=n.replace(/\s+/g,"")+"Button";e.CreateDragSource(t,i.widgetConfig,r)})),t.on("stackCreated",(t=>{const n=this.getControlButton("lm-pin","detach","unpin").on("click",(()=>this.unpinWidget(t.getActiveContentItem()))),r=this.getControlButton("lm-help","help","help").on("click",(e=>this.onHelpPinedClick(e,t.getActiveContentItem()))),o=this.getControlButton("lm_settings","settings","cog").on("click",(i=>e.Instance.onCogPinedClick(t.getActiveContentItem()))),s=this.getControlButton("lm-image-panel-next","next image","step-forward").on("click",this.onNextPageClick),a=this.getControlButton("lm-image-panel","switch to multi-panel","square").on("click",this.onImagePanelButtonClick);this.updateImagePanelButton();const l=this.getControlButton("lm-image-panel-previous","previous image","step-backward").on("click",this.onPreviousPageClick);t.header.controlsContainer.prepend([l,a,s,o,r,n]),t.on("activeContentItemChanged",(e=>{if(t&&t.config&&t.header.controlsContainer&&t.config.content.length){var n,r,o,s,a,l;const e=t.getActiveContentItem().config.component,c=t.header.controlsContainer[0];null===(n=KA()(c))||void 0===n||null===(r=n.find("li.lm_settings"))||void 0===r||r.attr("style",i.includes(e)?"":"display:none;"),null===(o=KA()(c))||void 0===o||null===(s=o.find("li.lm-image-panel-next, li.lm-image-panel, li.lm-image-panel-previous"))||void 0===s||s.attr("style","image-view"===e?"":"display:none;"),null===(a=KA()(c))||void 0===a||null===(l=a.find("li.lm-pin"))||void 0===l||l.attr("style","image-view"===e?"display:none;":""),"image-view"===e&&this.updateImagePanelPageButtons()}}))})),t.on("componentCreated",this.handleItemCreation),t.on("itemDestroyed",this.handleItemRemoval),t.on("stateChanged",this.handleStateUpdates)},this.getControlButton=(e,t,i)=>KA()(`<li class="${e}" title="${t}"><span class="bp3-icon-standard bp3-icon-${i}" style/></li>`),this.toWidgetSettingsConfig=(e,t)=>{var i,n;if(!e||!t)return null;let r=null;switch(e){case SB.WIDGET_CONFIG.type:r=this.renderConfigWidgets.get(t);break;case qB.WIDGET_CONFIG.type:r=this.spatialProfileWidgets.get(t);break;case bq.WIDGET_CONFIG.type:r=this.spectralProfileWidgets.get(t);break;case Dq.WIDGET_CONFIG.type:r=this.histogramWidgets.get(t);break;case Hq.WIDGET_CONFIG.type:r=this.stokesAnalysisWidgets.get(t);break;case oH.WIDGET_CONFIG.type:r=this.catalogWidgets.get(t)}return null===(i=r)||void 0===i||null===(n=i.toConfig)||void 0===n?void 0:n.call(i)},Object(f.a)(this,"onCogPinedClick",wP,this),Object(f.a)(this,"unpinWidget",TP,this),Object(f.a)(this,"onHelpPinedClick",RP,this),this.onImagePanelButtonClick=()=>{this.setImageMultiPanelEnabled(!JA.Instance.imageMultiPanelEnabled)},this.setImageMultiPanelEnabled=e=>{JA.Instance.setPreference(QA.IMAGE_MULTI_PANEL_ENABLED,e),this.updateImagePanelButton()},this.updateImagePanelButton=()=>{var e;const t=gC.Instance.imagePanelMode,i=null===(e=KA()(".lm_goldenlayout"))||void 0===e?void 0:e.find("li.lm-image-panel[style!='display:none;']");var n;i&&(i.attr("title",this.getImagePanelButtonTooltip(t)),null===(n=i.find(".bp3-icon-standard"))||void 0===n||n.attr("class",`bp3-icon-standard ${this.getImagePanelButtonIcon(t)}`))},this.getImagePanelButtonTooltip=e=>e===Xn.None?"switch to multi-panel":"switch to single panel",this.getImagePanelButtonIcon=e=>e===Xn.None?"bp3-icon-square":"bp3-icon-grid-view",this.onNextPageClick=()=>{var e;const t=gC.Instance,i=(t.currentImagePage+1)*t.imagesPerPage;(null===(e=t.frames)||void 0===e?void 0:e.length)>i&&t.setActiveFrameByIndex(i)},this.onPreviousPageClick=()=>{const e=gC.Instance;if(e.currentImagePage>0){const t=(e.currentImagePage-1)*e.imagesPerPage;e.setActiveFrameByIndex(t)}},this.updateImagePanelPageButtons=()=>{var e,t;const i=gC.Instance,n=null===(e=KA()(".lm_goldenlayout"))||void 0===e?void 0:e.find("li.lm-image-panel-next[style!='display:none;']");if(n){var r;const e=(i.currentImagePage+1)*i.imagesPerPage;n.attr("style",(null===(r=i.frames)||void 0===r?void 0:r.length)>e?"":"cursor: not-allowed; opacity: 0.2"),n.attr("title",i.imagePanelMode===Xn.None?"next image":"next page")}const o=null===(t=KA()(".lm_goldenlayout"))||void 0===t?void 0:t.find("li.lm-image-panel-previous[style!='display:none;']");o&&(o.attr("style",i.currentImagePage>0?"":"cursor: not-allowed; opacity: 0.2"),o.attr("title",i.imagePanelMode===Xn.None?"previous image":"previous page"))},Object(f.a)(this,"handleItemCreation",AP,this),Object(f.a)(this,"handleItemRemoval",PP,this),Object(f.a)(this,"handleStateUpdates",EP,this),this.createFloatingSpatialProfilerWidget=()=>{this.addFloatingWidget(new VP(this.addSpatialProfileWidget(),qB.WIDGET_CONFIG))},this.createFloatingSpectralProfilerWidget=()=>{this.addFloatingWidget(new VP(this.addSpectralProfileWidget(),bq.WIDGET_CONFIG))},this.getSpectralWidgetStoreByID=e=>this.spectralProfileWidgets.get(e),this.createFloatingStokesWidget=()=>{this.addFloatingWidget(new VP(this.addStokesWidget(),Hq.WIDGET_CONFIG))},this.getNextComponentId=e=>{let t=0,i=[];for(e.type===ZU.WIDGET_CONFIG.type?hM.Instance.catalogPlots.forEach(((e,t)=>{i.push(t)})):e.type===oH.WIDGET_CONFIG.type&&hM.Instance.catalogProfiles.forEach(((e,t)=>{i.push(t)}));;){const n=`${e.componentId}-${t}`;if(!i.includes(n))return n;t++}},this.createFloatingCatalogWidget=e=>{const t=this.addCatalogWidget(e),i=this.getNextComponentId(oH.WIDGET_CONFIG);let n=new VP(i,oH.WIDGET_CONFIG);return n.componentId=i,this.addFloatingWidget(n),{widgetStoreId:t,widgetComponentId:i}},this.reloadFloatingCatalogWidget=()=>{const e=gC.Instance.catalogNum,t=this.getNextComponentId(oH.WIDGET_CONFIG);let i=new VP(t,oH.WIDGET_CONFIG);i.componentId=t,e&&hM.Instance.catalogProfiles.set(t,e),this.addFloatingWidget(i)},this.createFloatingCatalogPlotWidget=e=>{const t=ZU.WIDGET_CONFIG,i=this.addCatalogPlotWidget(e),n=this.getNextComponentId(t),r=new VP(i,t);return r.id=i,r.componentId=n,r.helpType=e.plotType===xd.Histogram?xM.CATALOG_HISTOGRAM_PLOT:xM.CATALOG_SCATTER_PLOT,this.addFloatingWidget(r),{widgetStoreId:i,widgetComponentId:n}},this.createFloatingSpectralLineQueryWidget=()=>{this.addFloatingWidget(new VP(this.addSpectralLineQueryWidget(),nq.WIDGET_CONFIG))},this.createFloatingSettingsWidget=(t,i,n)=>{const r=e.GetDefaultWidgetSettingsConfig(n),o=new VP(this.addFloatingSettingsWidget(null,i,r.type),r);o.title=t+" Settings",o.parentId=i,o.parentType=n,o.id&&this.addFloatingWidget(o)},this.createFloatingStatsWidget=()=>{this.addFloatingWidget(new VP(this.addStatsWidget(),Tq.WIDGET_CONFIG))},this.createFloatingHistogramWidget=()=>{this.addFloatingWidget(new VP(this.addHistogramWidget(),Dq.WIDGET_CONFIG))},this.createFloatingRenderWidget=()=>{this.addFloatingWidget(new VP(this.addRenderConfigWidget(),SB.WIDGET_CONFIG))},this.createFloatingLogWidget=()=>{this.addFloatingWidget(new VP(this.addLogWidget(),BG.WIDGET_CONFIG))},this.createFloatingAnimatorWidget=()=>{this.addFloatingWidget(new VP(this.addAnimatorWidget(),UD.WIDGET_CONFIG))},this.createFloatingRegionListWidget=()=>{this.addFloatingWidget(new VP(this.addRegionListWidget(),kB.WIDGET_CONFIG))},this.createFloatingLayerListWidget=()=>{this.addFloatingWidget(new VP(this.addLayerListWidget(),QG.WIDGET_CONFIG))},this.createFloatingCursorInfoWidget=()=>{this.addFloatingWidget(new VP(this.addCursorInfoWidget(),JD.WIDGET_CONFIG))},this.createFloatingPvGeneratorWidget=()=>{this.addFloatingWidget(new VP(this.addPvGeneratorWidget(),ZV.WIDGET_CONFIG))},Object(f.a)(this,"selectFloatingWidget",MP,this),Object(f.a)(this,"updateSelectFloatingWidgetzIndex",FP,this),Object(f.a)(this,"addFloatingWidget",kP,this),Object(f.a)(this,"removeFloatingWidget",DP,this),Object(f.a)(this,"removeFloatingWidgetComponent",LP,this),this.removeAssociatedFloatingSetting=e=>{var t;if(null===(t=this.floatingSettingsWidgets)||void 0===t?void 0:t.size){let t=null;this.floatingSettingsWidgets.forEach(((i,n)=>{i===e&&(t=n)})),t&&(this.removeFloatingWidget(t,!0),this.floatingSettingsWidgets.delete(t))}},Object(m.p)(this),this.spatialProfileWidgets=new Map,this.spectralProfileWidgets=new Map,this.statsWidgets=new Map,this.histogramWidgets=new Map,this.renderConfigWidgets=new Map,this.animatorWidgets=new Map,this.layerListWidgets=new Map,this.logWidgets=new Map,this.regionListWidgets=new Map,this.stokesAnalysisWidgets=new Map,this.catalogWidgets=new Map,this.floatingSettingsWidgets=new Map,this.catalogPlotWidgets=new Map,this.spectralLineQueryWidgets=new Map,this.cursorInfoWidgets=new Map,this.pvGeneratorWidgets=new Map,this.widgetsMap=new Map([[qB.WIDGET_CONFIG.type,this.spatialProfileWidgets],[bq.WIDGET_CONFIG.type,this.spectralProfileWidgets],[Tq.WIDGET_CONFIG.type,this.statsWidgets],[Dq.WIDGET_CONFIG.type,this.histogramWidgets],[SB.WIDGET_CONFIG.type,this.renderConfigWidgets],[UD.WIDGET_CONFIG.type,this.animatorWidgets],[QG.WIDGET_CONFIG.type,this.layerListWidgets],[BG.WIDGET_CONFIG.type,this.logWidgets],[kB.WIDGET_CONFIG.type,this.regionListWidgets],[Hq.WIDGET_CONFIG.type,this.stokesAnalysisWidgets],[oH.WIDGET_CONFIG.type,this.catalogWidgets],[ZU.WIDGET_CONFIG.type,this.catalogPlotWidgets],[nq.WIDGET_CONFIG.type,this.spectralLineQueryWidgets],[JD.WIDGET_CONFIG.type,this.cursorInfoWidgets],[ZV.WIDGET_CONFIG.type,this.pvGeneratorWidgets]]),this.floatingWidgets=[],this.defaultFloatingWidgetOffset=100}static GetDefaultWidgetConfig(e){switch(e){case VG.WIDGET_CONFIG.type:return VG.WIDGET_CONFIG;case SB.WIDGET_CONFIG.type:return SB.WIDGET_CONFIG;case QG.WIDGET_CONFIG.type:return QG.WIDGET_CONFIG;case BG.WIDGET_CONFIG.type:return BG.WIDGET_CONFIG;case UD.WIDGET_CONFIG.type:return UD.WIDGET_CONFIG;case qB.WIDGET_CONFIG.type:return qB.WIDGET_CONFIG;case bq.WIDGET_CONFIG.type:return bq.WIDGET_CONFIG;case Tq.WIDGET_CONFIG.type:return Tq.WIDGET_CONFIG;case Dq.WIDGET_CONFIG.type:return Dq.WIDGET_CONFIG;case kB.WIDGET_CONFIG.type:return kB.WIDGET_CONFIG;case Hq.WIDGET_CONFIG.type:return Hq.WIDGET_CONFIG;case oH.WIDGET_CONFIG.type:return oH.WIDGET_CONFIG;case ZU.WIDGET_CONFIG.type:return ZU.WIDGET_CONFIG;case nq.WIDGET_CONFIG.type:return nq.WIDGET_CONFIG;case JD.WIDGET_CONFIG.type:return JD.WIDGET_CONFIG;case ZV.WIDGET_CONFIG.type:return ZV.WIDGET_CONFIG;default:return oB.WIDGET_CONFIG}}static GetDefaultWidgetSettingsConfig(e){switch(e){case VG.WIDGET_CONFIG.type:return hL.WIDGET_CONFIG;case Hq.WIDGET_CONFIG.type:return cH.WIDGET_CONFIG;case bq.WIDGET_CONFIG.type:return bH.WIDGET_CONFIG;case qB.WIDGET_CONFIG.type:return jH.WIDGET_CONFIG;case SB.WIDGET_CONFIG.type:return vH.WIDGET_CONFIG;case Dq.WIDGET_CONFIG.type:return wH.WIDGET_CONFIG;case oH.WIDGET_CONFIG.type:return cX.WIDGET_CONFIG;case QG.WIDGET_CONFIG.type:return uX.WIDGET_CONFIG;default:return oB.WIDGET_CONFIG}}static CreateDragSource(e,t,i){const n={type:"react-component",component:t.type,title:t.title,id:t.id,isClosable:t.isCloseable,props:{appStore:gC.Instance,id:t.id,docked:!0}},r=document.getElementById(i);r&&e.createDragSource(r,n)}updateImageWidgetTitle(e){const t=gC.Instance;let i;if(i=t.activeFrame?t.activeFrame.filename:"No image loaded",null===e||void 0===e?void 0:e.root){const t=e.root.getItemsByFilter((e=>e.config.component===VG.WIDGET_CONFIG.type));t.length&&t[0].config&&t[0].config.title!==i&&t[0].setTitle(i)}const n=this.floatingWidgets.find((e=>e.type===VG.WIDGET_CONFIG.type));n&&n.title!==i&&this.setWidgetTitle(n.id,i)}setWidgetTitle(e,t){const i=eE.Instance;if(i.dockedLayout&&i.dockedLayout.root){const n=i.dockedLayout.root.getItemsByFilter((t=>t.config.id===e));n.length&&n[0].setTitle(t)}const n=this.floatingWidgets.find((t=>t.id===e));n&&(n.title=t)}setWidgetComponentTitle(e,t){const i=eE.Instance;if(i.dockedLayout&&i.dockedLayout.root){const n=i.dockedLayout.root.getItemsById(e);n.length&&n[0].setTitle(t)}const n=this.floatingWidgets.find((t=>t.componentId===e));n&&(n.title=t)}changeWidgetId(e,t){const i=this.floatingWidgets.find((t=>t.id===e));i&&(i.id=t)}addSpatialProfileWidget(e=null,t=null){if(e||(e=this.getNextId(qB.WIDGET_CONFIG.type)),e){const i=new Fo;t&&i.init(t),this.spatialProfileWidgets.set(e,i)}return e}addSpectralProfileWidget(e=null,t=null){if(e||(e=this.getNextId(bq.WIDGET_CONFIG.type)),e){const i=new lh;t&&i.init(t),this.spectralProfileWidgets.set(e,i)}return e}get spectralProfilerList(){return Array.from(this.spectralProfileWidgets.keys())}get hasSpectralProfiler(){return this.spectralProfileWidgets&&this.spectralProfileWidgets.size>0}get isSpectralWidgetStreamingData(){let e=!1;return this.spectralProfileWidgets.forEach((t=>{e=e||t.isStreamingData})),e}addStokesWidget(e=null,t=null){if(e||(e=this.getNextId(Hq.WIDGET_CONFIG.type)),e){const i=new Sc;t&&i.init(t),this.stokesAnalysisWidgets.set(e,i)}return e}addCatalogWidget(e,t=null,i=null){const n=hM.Instance,r=n.catalogWidgets.get(e);if(r)return r;if(t||(t=this.getNextId(oH.WIDGET_CONFIG.type)),t){const n=new Cd(e);i&&n.init(i),this.catalogWidgets.set(t,n)}return n.catalogWidgets.set(e,t),t}addCatalogPlotWidget(e,t=null){return t||(t=this.getNextId(ZU.WIDGET_CONFIG.type)),t&&this.catalogPlotWidgets.set(t,new Bd(e)),t}addSpectralLineQueryWidget(e=null){return e||(e=this.getNextId(nq.WIDGET_CONFIG.type)),e&&this.spectralLineQueryWidgets.set(e,new Ps),e}addFloatingSettingsWidget(e=null,t,i){return e||(e=this.getNextSettingId(i,t)),e&&this.floatingSettingsWidgets.set(e,t),e}addStatsWidget(e=null){return e||(e=this.getNextId(Tq.WIDGET_CONFIG.type)),e&&this.statsWidgets.set(e,new ks),e}addHistogramWidget(e=null,t=null){if(e||(e=this.getNextId(Dq.WIDGET_CONFIG.type)),e){const i=new pa;t&&i.init(t),this.histogramWidgets.set(e,i)}return e}addRenderConfigWidget(e=null,t=null){if(e||(e=this.getNextId(SB.WIDGET_CONFIG.type)),e){const i=new kr;t&&i.init(t),this.renderConfigWidgets.set(e,i)}return e}addLogWidget(e=null){return e||(e=this.getNextId(BG.WIDGET_CONFIG.type)),e&&this.logWidgets.set(e,new ha),e}addAnimatorWidget(e=null){return e||(e=this.getNextId(UD.WIDGET_CONFIG.type)),e&&this.animatorWidgets.set(e,new ha),e}addRegionListWidget(e=null){return e||(e=this.getNextId(kB.WIDGET_CONFIG.type)),e&&this.regionListWidgets.set(e,new ha),e}addLayerListWidget(e=null){return e||(e=this.getNextId(QG.WIDGET_CONFIG.type)),e&&this.layerListWidgets.set(e,new Nh),e}addCursorInfoWidget(e=null){return e||(e=this.getNextId(JD.WIDGET_CONFIG.type)),e&&this.cursorInfoWidgets.set(e,new ha),e}addPvGeneratorWidget(e=null){return e||(e=this.getNextId(ZV.WIDGET_CONFIG.type)),e&&this.pvGeneratorWidgets.set(e,new Bh),e}updateFloatingWidgetzIndexOnRemove(e){const t=this.floatingWidgets.length;if(e<t)for(let i=0;i<t;i++){const t=this.floatingWidgets[i].zIndex;t>e&&(this.floatingWidgets[i].zIndex=t-1)}}},NP.staticInstance=void 0,NP.RemoveRegionFromRegionWidgets=(e,t,i)=>{e.forEach((e=>{const n=e.regionIdMap.get(t);isFinite(n)&&n===i&&e.clearFrameEntry(t)}))},lP=_P,cP=Object(b.a)(lP.prototype,"floatingWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dP=Object(b.a)(lP.prototype,"renderConfigWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pP=Object(b.a)(lP.prototype,"spatialProfileWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hP=Object(b.a)(lP.prototype,"spectralProfileWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uP=Object(b.a)(lP.prototype,"statsWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gP=Object(b.a)(lP.prototype,"histogramWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fP=Object(b.a)(lP.prototype,"layerListWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bP=Object(b.a)(lP.prototype,"logWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mP=Object(b.a)(lP.prototype,"regionListWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yP=Object(b.a)(lP.prototype,"animatorWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OP=Object(b.a)(lP.prototype,"stokesAnalysisWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jP=Object(b.a)(lP.prototype,"floatingSettingsWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xP=Object(b.a)(lP.prototype,"catalogWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SP=Object(b.a)(lP.prototype,"catalogPlotWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vP=Object(b.a)(lP.prototype,"spectralLineQueryWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),CP=Object(b.a)(lP.prototype,"cursorInfoWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),IP=Object(b.a)(lP.prototype,"pvGeneratorWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wP=Object(b.a)(lP.prototype,"onCogPinedClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=t.component,r=t.title;if(-1===[VG.WIDGET_CONFIG.type,Hq.WIDGET_CONFIG.type,bq.WIDGET_CONFIG.type,qB.WIDGET_CONFIG.type,SB.WIDGET_CONFIG.type,Dq.WIDGET_CONFIG.type,oH.WIDGET_CONFIG.type,QG.WIDGET_CONFIG.type].indexOf(n))return;const o=WP.GetDefaultWidgetSettingsConfig(n);let s=new VP(this.addFloatingSettingsWidget(null,i,o.type),o);s.title="image-view"===n?"Image View Settings":r+" Settings",s.parentId=i,s.parentType=n,s.id&&this.addFloatingWidget(s)}}}),TP=Object(b.a)(lP.prototype,"unpinWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=t.component,r=t.title;if(n===VG.WIDGET_CONFIG.type)return;let o=new VP(i,WP.GetDefaultWidgetConfig(n));o.title=r,n===oH.WIDGET_CONFIG.type&&(o.componentId=i);const s=this.catalogPlotWidgets.get(i);s&&(o.helpType=s.plotType===xd.Histogram?xM.CATALOG_HISTOGRAM_PLOT:xM.CATALOG_SCATTER_PLOT);const a=e.container;if(a&&a.width&&a.height){o.setDefaultSize(25*Math.round(a.width/25),25*Math.round(a.height/25));const e=a._element[0];o.setDefaultPosition(25*Math.round(e.offsetLeft/25)+5,25*Math.round(e.offsetTop/25)-25)}this.addFloatingWidget(o);e.config.component="floated",e.remove()}}}),RP=Object(b.a)(lP.prototype,"onHelpPinedClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=t.config,n=i.component;let r=WP.GetDefaultWidgetConfig(n);const o=t.container;let s=0;if(o&&o.width&&(s=e.target.getBoundingClientRect().right+36-.5*o.width),r.helpType&&!Array.isArray(r.helpType))SM.Instance.showHelpDrawer(r.helpType,s);else{const e=i.id,t=this.catalogPlotWidgets.get(e);t&&SM.Instance.showHelpDrawer(t.plotType===xd.Histogram?xM.CATALOG_HISTOGRAM_PLOT:xM.CATALOG_SCATTER_PLOT,s)}}}}),AP=Object(b.a)(lP.prototype,"handleItemCreation",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=this.addWidgetByType(i);n&&(t.id=n,t.props.id=n)}}}),PP=Object(b.a)(lP.prototype,"handleItemRemoval",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if("component"===e.config.type){const t=e.config,i=t.component===oH.WIDGET_CONFIG.type,n=t.component===ZU.WIDGET_CONFIG.type,r=t.id;"floated"===t.component||i||n||this.removeWidget(r,t.component),i&&(hM.Instance.catalogProfiles.delete(r),this.removeAssociatedFloatingSetting(r)),n&&hM.Instance.clearCatalogPlotsByWidgetId(r)}}}}),EP=Object(b.a)(lP.prototype,"handleStateUpdates",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e&&e.origin&&e.origin.isMaximised&&e.origin.header){const t=e.origin.header;if(t.controlsContainer&&t.controlsContainer.length){const e=t.controlsContainer[0];if(e.children&&e.children.length){const t=e.children[e.children.length-1];t&&t.setAttribute("title","restore")}}}}}}),Object(b.a)(lP.prototype,"updateImageWidgetTitle",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"updateImageWidgetTitle"),lP.prototype),Object(b.a)(lP.prototype,"setWidgetTitle",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"setWidgetTitle"),lP.prototype),Object(b.a)(lP.prototype,"setWidgetComponentTitle",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"setWidgetComponentTitle"),lP.prototype),Object(b.a)(lP.prototype,"changeWidgetId",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"changeWidgetId"),lP.prototype),Object(b.a)(lP.prototype,"addSpatialProfileWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addSpatialProfileWidget"),lP.prototype),Object(b.a)(lP.prototype,"addSpectralProfileWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addSpectralProfileWidget"),lP.prototype),Object(b.a)(lP.prototype,"spectralProfilerList",[m.i],Object.getOwnPropertyDescriptor(lP.prototype,"spectralProfilerList"),lP.prototype),Object(b.a)(lP.prototype,"hasSpectralProfiler",[m.i],Object.getOwnPropertyDescriptor(lP.prototype,"hasSpectralProfiler"),lP.prototype),Object(b.a)(lP.prototype,"isSpectralWidgetStreamingData",[m.i],Object.getOwnPropertyDescriptor(lP.prototype,"isSpectralWidgetStreamingData"),lP.prototype),Object(b.a)(lP.prototype,"addStokesWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addStokesWidget"),lP.prototype),Object(b.a)(lP.prototype,"addCatalogWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addCatalogWidget"),lP.prototype),Object(b.a)(lP.prototype,"addCatalogPlotWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addCatalogPlotWidget"),lP.prototype),Object(b.a)(lP.prototype,"addSpectralLineQueryWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addSpectralLineQueryWidget"),lP.prototype),Object(b.a)(lP.prototype,"addFloatingSettingsWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addFloatingSettingsWidget"),lP.prototype),Object(b.a)(lP.prototype,"addStatsWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addStatsWidget"),lP.prototype),Object(b.a)(lP.prototype,"addHistogramWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addHistogramWidget"),lP.prototype),Object(b.a)(lP.prototype,"addRenderConfigWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addRenderConfigWidget"),lP.prototype),Object(b.a)(lP.prototype,"addLogWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addLogWidget"),lP.prototype),Object(b.a)(lP.prototype,"addAnimatorWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addAnimatorWidget"),lP.prototype),Object(b.a)(lP.prototype,"addRegionListWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addRegionListWidget"),lP.prototype),Object(b.a)(lP.prototype,"addLayerListWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addLayerListWidget"),lP.prototype),Object(b.a)(lP.prototype,"addCursorInfoWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addCursorInfoWidget"),lP.prototype),Object(b.a)(lP.prototype,"addPvGeneratorWidget",[m.g],Object.getOwnPropertyDescriptor(lP.prototype,"addPvGeneratorWidget"),lP.prototype),MP=Object(b.a)(lP.prototype,"selectFloatingWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.findIndex((t=>t.id===e)),i=this.floatingWidgets.length;if(i>1&&t>=0&&t<i-1){const e=this.floatingWidgets[t];for(let n=0;n<i-1;n++)n>=t&&(this.floatingWidgets[n]=this.floatingWidgets[n+1]);this.floatingWidgets[i-1]=e}}}}),FP=Object(b.a)(lP.prototype,"updateSelectFloatingWidgetzIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.findIndex((t=>t.id===e)),i=this.floatingWidgets[t],n=this.floatingWidgets.length;if(n>1&&t>=0&&i.zIndex<n){for(let e=0;e<n;e++){let t=this.floatingWidgets[e].zIndex;t>=i.zIndex&&(this.floatingWidgets[e].zIndex=t-1)}this.floatingWidgets[t].zIndex=this.floatingWidgets.length}}}}),kP=Object(b.a)(lP.prototype,"addFloatingWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!((null===e||void 0===e?void 0:e.defaultX)>0&&(null===e||void 0===e?void 0:e.defaultY)>0)){const t=this.getFloatingWidgetOffset();e.setDefaultPosition(t,t)}e.zIndex=this.floatingWidgets.length+1,this.floatingWidgets.push(e)}}}),DP=Object(b.a)(lP.prototype,"removeFloatingWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{const i=this.floatingWidgets.find((t=>t.id===e));if(i){if(this.updateFloatingWidgetzIndexOnRemove(i.zIndex),this.floatingWidgets=this.floatingWidgets.filter((t=>t.id!==e)),t)return;this.removeWidget(e,i.type)}}}}),LP=Object(b.a)(lP.prototype,"removeFloatingWidgetComponent",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.find((t=>t.componentId===e));t&&(this.updateFloatingWidgetzIndexOnRemove(t.zIndex),this.floatingWidgets=this.floatingWidgets.filter((t=>t.componentId!==e)),this.removeAssociatedFloatingSetting(e))}}}),lP);var GP,BP,qP,HP,YP,UP,XP,$P,KP,QP,ZP,JP=i(438);let eE=(ZP=QP=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){this.layoutNameToBeSaved=void 0,Object(f.a)(this,"dockedLayout",BP,this),Object(f.a)(this,"currentLayoutName",qP,this),Object(f.a)(this,"layouts",HP,this),Object(f.a)(this,"supportsServer",YP,this),this.layoutExists=e=>e&&this.allLayoutNames.includes(e),this.setLayoutToBeSaved=e=>{this.layoutNameToBeSaved=e||"Empty"},Object(f.a)(this,"fetchLayouts",UP,this),this.initLayoutsFromPresets=()=>{Ri.PRESETS.forEach((e=>{const t=fn.GetPresetConfig(e);t&&(this.layouts[e]=t)}))},Object(f.a)(this,"applyLayout",XP,this),Object(f.a)(this,"saveLayout",$P,this),this.handleSaveResult=t=>{t?(v.show(C("layout-grid",`Layout ${this.layoutNameToBeSaved} saved successfully.`,e.ToasterTimeout)),this.currentLayoutName=this.layoutNameToBeSaved):(delete this.layouts[this.layoutNameToBeSaved],Bx.Instance.showAlert("Saving user-defined layout failed! "))},Object(f.a)(this,"deleteLayout",KP,this),this.handleDeleteResult=(t,i)=>{i?(v.show(C("layout-grid",`Layout ${t} deleted successfully.`,e.ToasterTimeout)),t===this.currentLayoutName&&(this.currentLayoutName="")):Bx.Instance.showAlert("Deleting user-defined layout failed!")},Object(m.p)(this),this.dockedLayout=null,this.layouts={},this.supportsServer=!1,this.initLayoutsFromPresets()}get allLayoutNames(){return this.layouts?Object.keys(this.layouts):[]}get userLayoutNames(){return this.layouts?Object.keys(this.layouts).filter((e=>!Ri.isPreset(e))):[]}get orderedLayoutNames(){var e;let t=[...Ri.PRESETS];return(null===(e=this.userLayoutNames)||void 0===e?void 0:e.length)?t.concat(this.userLayoutNames):t}get numSavedLayouts(){return this.userLayoutNames.length}},QP.staticInstance=void 0,QP.ToasterTimeout=1500,GP=ZP,BP=Object(b.a)(GP.prototype,"dockedLayout",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qP=Object(b.a)(GP.prototype,"currentLayoutName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HP=Object(b.a)(GP.prototype,"layouts",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YP=Object(b.a)(GP.prototype,"supportsServer",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UP=Object(b.a)(GP.prototype,"fetchLayouts",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{try{const e=await pj.Instance.getLayouts();for(const t of Object.keys(e))t&&(this.layouts[t]=e[t])}catch(e){Bx.Instance.showAlert("Loading user-defined layout failed!"),console.log(e)}}}}),Object(b.a)(GP.prototype,"allLayoutNames",[m.i],Object.getOwnPropertyDescriptor(GP.prototype,"allLayoutNames"),GP.prototype),Object(b.a)(GP.prototype,"userLayoutNames",[m.i],Object.getOwnPropertyDescriptor(GP.prototype,"userLayoutNames"),GP.prototype),Object(b.a)(GP.prototype,"orderedLayoutNames",[m.i],Object.getOwnPropertyDescriptor(GP.prototype,"orderedLayoutNames"),GP.prototype),Object(b.a)(GP.prototype,"numSavedLayouts",[m.i],Object.getOwnPropertyDescriptor(GP.prototype,"numSavedLayouts"),GP.prototype),XP=Object(b.a)(GP.prototype,"applyLayout",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!e||!this.layoutExists(e))return Bx.Instance.showAlert(`Applying layout failed! Layout ${e} not found.`),!1;const t=this.layouts[e],i=gC.Instance;this.dockedLayout&&(i.widgetsStore.removeFloatingWidgets(),this.dockedLayout.destroy());let n={type:t.docked.type,content:[]},r=[];return fn.CreateConfigToApply(n.content,t.docked.content,r),i.widgetsStore.initWidgets(r,t.floating),this.dockedLayout=new JP({settings:{showPopoutIcon:!1,showCloseIcon:!1},dimensions:{minItemWidth:250,minItemHeight:200,dragProxyWidth:600,dragProxyHeight:270},content:[n]},i.getAppContainer()),i.widgetsStore.initLayoutWithWidgets(this.dockedLayout),this.dockedLayout.init(),this.currentLayoutName=e,!0}}}),$P=Object(b.a)(GP.prototype,"saveLayout",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{const e=gC.Instance;if(!this.layouts||!this.layoutNameToBeSaved||!this.dockedLayout)return void e.alertStore.showAlert("Save layout failed! Empty layouts or name.");if(Ri.isPreset(this.layoutNameToBeSaved))return void e.alertStore.showAlert("Layout name cannot be the same as system presets.");if(!this.layoutExists(this.layoutNameToBeSaved)&&this.numSavedLayouts>=10)return void e.alertStore.showAlert("Maximum user-defined layout quota exceeded! (10 layouts)");const t=this.dockedLayout.toConfig();if(!t||!t.content||t.content.length<=0)return void e.alertStore.showAlert("Saving layout failed! Something is wrong with current layout.");const i=fn.CreateConfigToSave(e,t.content[0]);if(i){if(this.layouts[this.layoutNameToBeSaved]=i,!Ri.isPreset(this.layoutNameToBeSaved))try{const t=await e.apiService.setLayout(this.layoutNameToBeSaved,i);t&&this.handleSaveResult(t)}catch(n){console.log(n),this.handleSaveResult(!1)}}else e.alertStore.showAlert("Saving layout failed! Creat layout configuration for saving failed.")}}}),KP=Object(b.a)(GP.prototype,"deleteLayout",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=gC.Instance;e&&this.layoutExists(e)?t.apiService.clearLayout(e).then((t=>{t&&(delete this.layouts[e],e===this.currentLayoutName&&(this.currentLayoutName="")),this.handleDeleteResult(e,t)}),(t=>{console.log(t),this.handleDeleteResult(e,!1)})):t.alertStore.showAlert(`Cannot delete layout ${e}! It does not exist.`)}}}),GP);var tE,iE,nE,rE,oE,sE,aE,lE,cE,dE,pE,hE,uE,gE,fE,bE,mE,yE,OE,jE,xE,SE,vE,CE,IE,wE,TE,RE,AE,PE,EE,ME,FE,kE,DE,LE,NE,_E,zE,VE,WE,GE,BE,qE,HE,YE,UE,XE,$E,KE,QE,ZE,JE,eM;let tM=(eM=JE=class e{constructor(){Object(f.a)(this,"regionDialogVisible",iE,this),Object(f.a)(this,"showRegionDialog",nE,this),Object(f.a)(this,"hideRegionDialog",rE,this),Object(f.a)(this,"hotkeyDialogVisible",oE,this),Object(f.a)(this,"showHotkeyDialog",sE,this),Object(f.a)(this,"hideHotkeyDialog",aE,this),Object(f.a)(this,"aboutDialogVisible",lE,this),Object(f.a)(this,"showAboutDialog",cE,this),Object(f.a)(this,"hideAboutDialog",dE,this),Object(f.a)(this,"preferenceDialogVisible",pE,this),Object(f.a)(this,"showPreferenceDialog",hE,this),Object(f.a)(this,"hidePreferenceDialog",uE,this),Object(f.a)(this,"saveLayoutDialogVisible",gE,this),Object(f.a)(this,"deleteLayoutDialogVisible",fE,this),Object(f.a)(this,"showSaveLayoutDialog",bE,this),Object(f.a)(this,"hideSaveLayoutDialog",mE,this),Object(f.a)(this,"showDeleteLayoutDialog",yE,this),Object(f.a)(this,"hideDeleteLayoutDialog",OE,this),Object(f.a)(this,"fileBrowserDialogVisible",jE,this),Object(f.a)(this,"showFileBrowserDialog",xE,this),Object(f.a)(this,"hideFileBrowserDialog",SE,this),Object(f.a)(this,"fileInfoDialogVisible",vE,this),Object(f.a)(this,"selectedFileInfoDialogTab",CE,this),Object(f.a)(this,"showFileInfoDialog",IE,this),Object(f.a)(this,"hideFileInfoDialog",wE,this),Object(f.a)(this,"setSelectedFileInfoDialogTab",TE,this),Object(f.a)(this,"contourDialogVisible",RE,this),Object(f.a)(this,"showContourDialog",AE,this),Object(f.a)(this,"hideContourDialog",PE,this),Object(f.a)(this,"vectorOverlayDialogVisible",EE,this),Object(f.a)(this,"showVectorOverlayDialog",ME,this),Object(f.a)(this,"hideVectorOverlayDialog",FE,this),Object(f.a)(this,"codeSnippetDialogVisible",kE,this),Object(f.a)(this,"showExistingCodeSnippet",DE,this),Object(f.a)(this,"showNewCodeSnippet",LE,this),Object(f.a)(this,"showCodeSnippetDialog",NE,this),Object(f.a)(this,"hideCodeSnippetDialog",_E,this),Object(f.a)(this,"externalPageDialogVisible",zE,this),Object(f.a)(this,"externalPageDialogUrl",VE,this),Object(f.a)(this,"externalPageDialogTitle",WE,this),Object(f.a)(this,"showExternalPageDialog",GE,this),Object(f.a)(this,"hideExternalPageDialog",BE,this),Object(f.a)(this,"stokesDialogVisible",qE,this),Object(f.a)(this,"showStokesDialog",HE,this),Object(f.a)(this,"hideStokesDialog",YE,this),Object(f.a)(this,"catalogQueryDialogVisible",UE,this),Object(f.a)(this,"showCatalogQueryDialog",XE,this),Object(f.a)(this,"hideCatalogQueryDialog",$E,this),Object(f.a)(this,"fittingDialogVisible",KE,this),Object(f.a)(this,"showFittingDialog",QE,this),Object(f.a)(this,"hideFittingDialog",ZE,this),Object(m.p)(this)}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}},JE.staticInstance=void 0,tE=eM,iE=Object(b.a)(tE.prototype,"regionDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nE=Object(b.a)(tE.prototype,"showRegionDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionDialogVisible=!0}}}),rE=Object(b.a)(tE.prototype,"hideRegionDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionDialogVisible=!1}}}),oE=Object(b.a)(tE.prototype,"hotkeyDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sE=Object(b.a)(tE.prototype,"showHotkeyDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hotkeyDialogVisible=!0}}}),aE=Object(b.a)(tE.prototype,"hideHotkeyDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hotkeyDialogVisible=!1}}}),lE=Object(b.a)(tE.prototype,"aboutDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cE=Object(b.a)(tE.prototype,"showAboutDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.aboutDialogVisible=!0}}}),dE=Object(b.a)(tE.prototype,"hideAboutDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.aboutDialogVisible=!1}}}),pE=Object(b.a)(tE.prototype,"preferenceDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hE=Object(b.a)(tE.prototype,"showPreferenceDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceDialogVisible=!0}}}),uE=Object(b.a)(tE.prototype,"hidePreferenceDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceDialogVisible=!1}}}),gE=Object(b.a)(tE.prototype,"saveLayoutDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fE=Object(b.a)(tE.prototype,"deleteLayoutDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bE=Object(b.a)(tE.prototype,"showSaveLayoutDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveLayoutDialogVisible=!0}}}),mE=Object(b.a)(tE.prototype,"hideSaveLayoutDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveLayoutDialogVisible=!1}}}),yE=Object(b.a)(tE.prototype,"showDeleteLayoutDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.deleteLayoutDialogVisible=!0}}}),OE=Object(b.a)(tE.prototype,"hideDeleteLayoutDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.deleteLayoutDialogVisible=!1}}}),jE=Object(b.a)(tE.prototype,"fileBrowserDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),xE=Object(b.a)(tE.prototype,"showFileBrowserDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileBrowserDialogVisible=!0}}}),SE=Object(b.a)(tE.prototype,"hideFileBrowserDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileBrowserDialogVisible=!1}}}),vE=Object(b.a)(tE.prototype,"fileInfoDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CE=Object(b.a)(tE.prototype,"selectedFileInfoDialogTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return DL.IMAGE_HEADER}}),IE=Object(b.a)(tE.prototype,"showFileInfoDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileInfoDialogVisible=!0}}}),wE=Object(b.a)(tE.prototype,"hideFileInfoDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileInfoDialogVisible=!1}}}),TE=Object(b.a)(tE.prototype,"setSelectedFileInfoDialogTab",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileInfoDialogTab=e}}}),RE=Object(b.a)(tE.prototype,"contourDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),AE=Object(b.a)(tE.prototype,"showContourDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contourDialogVisible=!0}}}),PE=Object(b.a)(tE.prototype,"hideContourDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contourDialogVisible=!1}}}),EE=Object(b.a)(tE.prototype,"vectorOverlayDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ME=Object(b.a)(tE.prototype,"showVectorOverlayDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.vectorOverlayDialogVisible=!0}}}),FE=Object(b.a)(tE.prototype,"hideVectorOverlayDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.vectorOverlayDialogVisible=!1}}}),kE=Object(b.a)(tE.prototype,"codeSnippetDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),DE=Object(b.a)(tE.prototype,"showExistingCodeSnippet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&Nk.Instance.setActiveSnippet(e,t),this.codeSnippetDialogVisible=!0}}}),LE=Object(b.a)(tE.prototype,"showNewCodeSnippet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{Nk.Instance.clearActiveSnippet(),this.codeSnippetDialogVisible=!0}}}),NE=Object(b.a)(tE.prototype,"showCodeSnippetDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.codeSnippetDialogVisible=!0}}}),_E=Object(b.a)(tE.prototype,"hideCodeSnippetDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.codeSnippetDialogVisible=!1}}}),zE=Object(b.a)(tE.prototype,"externalPageDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),VE=Object(b.a)(tE.prototype,"externalPageDialogUrl",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WE=Object(b.a)(tE.prototype,"externalPageDialogTitle",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GE=Object(b.a)(tE.prototype,"showExternalPageDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.externalPageDialogUrl=e,this.externalPageDialogTitle=t,this.externalPageDialogVisible=!0}}}),BE=Object(b.a)(tE.prototype,"hideExternalPageDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.externalPageDialogVisible=!1}}}),qE=Object(b.a)(tE.prototype,"stokesDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),HE=Object(b.a)(tE.prototype,"showStokesDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.stokesDialogVisible=!0}}}),YE=Object(b.a)(tE.prototype,"hideStokesDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.stokesDialogVisible=!1}}}),UE=Object(b.a)(tE.prototype,"catalogQueryDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),XE=Object(b.a)(tE.prototype,"showCatalogQueryDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.catalogQueryDialogVisible=!0}}}),$E=Object(b.a)(tE.prototype,"hideCatalogQueryDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.catalogQueryDialogVisible=!1}}}),KE=Object(b.a)(tE.prototype,"fittingDialogVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),QE=Object(b.a)(tE.prototype,"showFittingDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fittingDialogVisible=!0}}}),ZE=Object(b.a)(tE.prototype,"hideFittingDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fittingDialogVisible=!1}}}),tE);var iM,nM,rM,oM,sM,aM,lM,cM,dM,pM;let hM=(pM=dM=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){this._catalogGLData=void 0,Object(f.a)(this,"catalogCounts",nM,this),Object(f.a)(this,"imageAssociatedCatalogId",rM,this),Object(f.a)(this,"catalogProfiles",oM,this),Object(f.a)(this,"catalogPlots",sM,this),Object(f.a)(this,"catalogProfileStores",aM,this),Object(f.a)(this,"catalogWidgets",lM,this),Object(f.a)(this,"updateCatalogProfiles",cM,this),Object(m.p)(this),this._catalogGLData=new Map,this.imageAssociatedCatalogId=new Map,this.catalogProfiles=new Map,this.catalogPlots=new Map,this.catalogProfileStores=new Map,this.catalogWidgets=new Map,this.catalogCounts=new Map}get catalogGLData(){return this._catalogGLData}addCatalog(e,t){this.catalogGLData.set(e,{x:new Float32Array(t),y:new Float32Array(t)}),this.catalogCounts.set(e,0)}convertToImageCoordinate(t,i,n,r,o,s,a,l,c){const d=this.catalogGLData.get(t),p=new Float32Array(2*i.length);if(d&&i&&n){const h=l-c;switch(a){case Yn.Pixel0:for(let e=0;e<i.length;e++)d.x[h+e]=i[e],d.y[h+e]=n[e],p[2*e]=i[e],p[2*e+1]=n[e];break;case Yn.Pixel1:for(let e=0;e<i.length;e++)d.x[h+e]=i[e]-1,d.y[h+e]=n[e]-1,p[2*e]=i[e]-1,p[2*e+1]=n[e]-1;break;default:const t=e.TransformCatalogData(i,n,r,o,s,a);for(let e=0;e<t.xImageCoords.length;e++)d.x[h+e]=t.xImageCoords[e],d.y[h+e]=t.yImageCoords[e],p[2*e]=t.xImageCoords[e],p[2*e+1]=t.yImageCoords[e]}this.catalogCounts.set(t,this.catalogCounts.get(t)+i.length),Tx.Instance.updateBuffer(t,p,2*h)}}clearImageCoordsData(e){const t=this.catalogGLData.get(e);if(t){t.x=new Float32Array(t.x.length),t.y=new Float32Array(t.y.length);const i=new Float32Array(2*t.x.length);this.catalogCounts.set(e,0),Tx.Instance.updateBuffer(e,i,0)}}removeCatalog(e,t){this.catalogGLData.delete(e),Tx.Instance.clearTexture(e);const i=gC.Instance.getFrame(this.getFrameIdByCatalogId(e)),n=this.imageAssociatedCatalogId.get(null===i||void 0===i?void 0:i.frameInfo.fileId);let r=[];n&&(r=n.filter((t=>t!==e)),this.updateImageAssociatedCatalogId(i.frameInfo.fileId,r)),t&&r.length&&this.catalogProfiles.forEach(((t,i)=>{t===e&&this.catalogProfiles.set(i,r[0])}))}updateImageAssociatedCatalogId(e,t){this.imageAssociatedCatalogId.set(e,t)}resetActiveCatalogFile(e){const t=this.imageAssociatedCatalogId.get(e),i=t||[];this.catalogProfiles.size&&(null===i||void 0===i?void 0:i.length)&&this.catalogProfiles.forEach(((e,t)=>{this.catalogProfiles.set(t,i[0])}))}getImageIdByCatalog(e){let t;return this.imageAssociatedCatalogId.forEach(((i,n)=>{i.includes(e)&&(t=n)})),t}setCatalogPlots(e,t,i){let n=this.catalogPlots.get(e);n?n.set(t,i):(n=new m.b,n.set(t,i),this.catalogPlots.set(e,n))}clearCatalogPlotsByFileId(e){this.catalogPlots.forEach(((t,i)=>{const n=t.get(e);WP.Instance.catalogPlotWidgets.delete(n),t.delete(e)}))}clearCatalogPlotsByComponentId(e){const t=this.catalogPlots.get(e);t&&(t.forEach(((e,t)=>{WP.Instance.catalogPlotWidgets.delete(e)})),this.catalogPlots.delete(e))}clearCatalogPlotsByWidgetId(e){const t=this.getAssociatedIdByWidgetId(e);t.catalogPlotComponentId&&this.clearCatalogPlotsByComponentId(t.catalogPlotComponentId)}closeAssociatedCatalog(e){const t=gC.Instance,i=this.imageAssociatedCatalogId.get(e);(null===i||void 0===i?void 0:i.length)&&(i.forEach((e=>{const i=this.catalogWidgets.get(e);var n;i&&(null===(n=t.widgetsStore.catalogWidgets.get(i))||void 0===n||n.resetMaps(),t.removeCatalog(e,i))})),this.imageAssociatedCatalogId.delete(e))}get activeCatalogFiles(){const e=gC.Instance.activeFrame;var t;return e&&null!==(t=this.visibleCatalogFiles.get(e))&&void 0!==t?t:[]}get visibleCatalogFiles(){const e=gC.Instance,t=new Map;for(const n of e.visibleFrames){var i;const e=n.frameInfo.fileId;let r=[...this.imageAssociatedCatalogId.get(e)];null===(i=n.spatialSiblings)||void 0===i||i.forEach((e=>{const t=[...this.imageAssociatedCatalogId.get(e.frameInfo.fileId)];r=[...new Set([].concat(r,t))].filter((e=>this.catalogGLData.has(e)))})),t.set(n,r.sort(((e,t)=>e-t)))}return t}getFrameIdByCatalogId(e){let t=-1;return this.imageAssociatedCatalogId.forEach(((i,n)=>{i.includes(e)&&(t=n)})),t}getAssociatedIdByWidgetId(e){let t,i;return this.catalogPlots.forEach(((n,r)=>{n.forEach(((n,o)=>{n===e&&(t=r,i=o)}))})),{catalogPlotComponentId:t,catalogFileId:i}}getCatalogFileNames(e){let t=new Map;return e.forEach((e=>{const i=this.catalogProfileStores.get(e);if(i){const e=i.catalogInfo;t.set(e.fileId,e.fileInfo.name)}})),t}getCatalogWidgetStore(e){const t=WP.Instance;if(this.catalogWidgets.has(e)){const i=this.catalogWidgets.get(e);return t.catalogWidgets.get(i)}{const i=t.addCatalogWidget(e);return t.catalogWidgets.get(i)}}static GetFractionFromUnit(t){return e.ArcminUnits.includes(t)?Math.PI/10800:e.ArcsecUnits.includes(t)?Math.PI/648e3:Math.PI/180}static TransformCatalogData(t,i,n,r,o,s){if((null===t||void 0===t?void 0:t.length)===(null===i||void 0===i?void 0:i.length)&&(null===t||void 0===t?void 0:t.length)>0){const a=t.length;let l=e.GetFractionFromUnit(r.toLocaleLowerCase()),c=e.GetFractionFromUnit(o.toLocaleLowerCase()),d=Pt.copy(n),p="System="+s;Pt.set(d,p),s===Yn.FK4&&(Pt.set(d,"Epoch=B1950"),Pt.set(d,"Equinox=1950")),s===Yn.FK5&&(Pt.set(d,"Epoch=J2000"),Pt.set(d,"Equinox=2000"));const h=new Float64Array(a),u=new Float64Array(a);for(let e=0;e<a;e++)h[e]=t[e]*l,u[e]=i[e]*c;const g=Pt.transformPointArrays(d,h,u,!1);return Pt.deleteObject(d),{xImageCoords:g.x,yImageCoords:g.y}}return{xImageCoords:new Float64Array(0),yImageCoords:new Float64Array(0)}}getFrameMinMaxPoints(e){var t;let i={minX:Number.MAX_VALUE,maxX:-Number.MAX_VALUE,minY:Number.MAX_VALUE,maxY:-Number.MAX_VALUE};return null===(t=this.imageAssociatedCatalogId.get(e))||void 0===t||t.forEach((e=>{const t=this.catalogGLData.get(e);if((null===t||void 0===t?void 0:t.x)&&(null===t||void 0===t?void 0:t.y)){const e=Qi(t.x),n=Qi(t.y);e.minVal<i.minX&&(i.minX=e.minVal),e.maxVal>i.maxX&&(i.maxX=e.maxVal),n.minVal<i.minY&&(i.minY=n.minVal),n.maxVal>i.maxY&&(i.maxY=n.maxVal)}})),i}},dM.staticInstance=void 0,dM.DegreeUnits=["deg","degrees"],dM.ArcsecUnits=["arcsec","arcsecond"],dM.ArcminUnits=["arcmin","arcminute"],iM=pM,nM=Object(b.a)(iM.prototype,"catalogCounts",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rM=Object(b.a)(iM.prototype,"imageAssociatedCatalogId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oM=Object(b.a)(iM.prototype,"catalogProfiles",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sM=Object(b.a)(iM.prototype,"catalogPlots",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aM=Object(b.a)(iM.prototype,"catalogProfileStores",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lM=Object(b.a)(iM.prototype,"catalogWidgets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(iM.prototype,"addCatalog",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"addCatalog"),iM.prototype),Object(b.a)(iM.prototype,"convertToImageCoordinate",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"convertToImageCoordinate"),iM.prototype),Object(b.a)(iM.prototype,"clearImageCoordsData",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"clearImageCoordsData"),iM.prototype),Object(b.a)(iM.prototype,"removeCatalog",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"removeCatalog"),iM.prototype),Object(b.a)(iM.prototype,"updateImageAssociatedCatalogId",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"updateImageAssociatedCatalogId"),iM.prototype),Object(b.a)(iM.prototype,"resetActiveCatalogFile",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"resetActiveCatalogFile"),iM.prototype),cM=Object(b.a)(iM.prototype,"updateCatalogProfiles",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.catalogProfiles.size>0){const t=Array.from(this.catalogProfiles.keys());Array.from(this.catalogProfiles.values()).includes(e)||this.catalogProfiles.set(t[0],e)}}}}),Object(b.a)(iM.prototype,"setCatalogPlots",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"setCatalogPlots"),iM.prototype),Object(b.a)(iM.prototype,"clearCatalogPlotsByFileId",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"clearCatalogPlotsByFileId"),iM.prototype),Object(b.a)(iM.prototype,"clearCatalogPlotsByComponentId",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"clearCatalogPlotsByComponentId"),iM.prototype),Object(b.a)(iM.prototype,"clearCatalogPlotsByWidgetId",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"clearCatalogPlotsByWidgetId"),iM.prototype),Object(b.a)(iM.prototype,"closeAssociatedCatalog",[m.g],Object.getOwnPropertyDescriptor(iM.prototype,"closeAssociatedCatalog"),iM.prototype),Object(b.a)(iM.prototype,"activeCatalogFiles",[m.i],Object.getOwnPropertyDescriptor(iM.prototype,"activeCatalogFiles"),iM.prototype),Object(b.a)(iM.prototype,"visibleCatalogFiles",[m.i],Object.getOwnPropertyDescriptor(iM.prototype,"visibleCatalogFiles"),iM.prototype),iM);var uM,gM,fM,bM,mM,yM,OM,jM;let xM;!function(e){e.CONTOUR="Contour Configuration",e.PREFERENCES="Preferences",e.FILE_BROWSER="File Browser",e.FILE_INFO="File Header",e.SAVE_LAYOUT="Save Layout",e.REGION_DIALOG="Region Dialog",e.STOKES="Stokes Hypercube Dialog",e.ONLINE_CATALOG_QUERY="Online Catalog Query",e.VECTOR_OVERLAY="Vector Overlay Configuration",e.ANIMATOR="Animator",e.HISTOGRAM="Histogram",e.HISTOGRAM_SETTINGS="Histogram Settings",e.IMAGE_VIEW="Image View",e.IMAGE_VIEW_SETTINGS="Image View Settings",e.LAYER_LIST="Image List",e.LAYER_LIST_SETTINGS="Image List Settings",e.LOG="Log",e.PLACEHOLDER="Placeholder",e.REGION_LIST="Region List",e.RENDER_CONFIG="Render Configuration",e.RENDER_CONFIG_SETTINGS="Render Configuration Settings",e.SPATIAL_PROFILER="Spatial Profiler",e.SPATIAL_PROFILER_SETTINGS_STYLING="Spatial Profiler Style Settings",e.SPATIAL_PROFILER_SETTINGS_SMOOTHING="Spatial Profiler Smoothing Settings",e.SPATIAL_PROFILER_SETTINGS_COMPUTATION="Spatial Profiler Computation Settings",e.SPECTRAL_PROFILER="Spectral Profiler",e.SPECTRAL_PROFILER_SETTINGS_CONVERSION="Spectral Profiler Conversion Settings",e.SPECTRAL_PROFILER_SETTINGS_STYLING="Spectral Profiler Style Settings",e.SPECTRAL_PROFILER_SETTINGS_SMOOTHING="Spectral Profiler Smoothing Settings",e.SPECTRAL_PROFILER_SETTINGS_MOMENTS="Spectral Profiler Moments Settings",e.SPECTRAL_PROFILER_SETTINGS_FITTING="Spectral Profiler Fitting Settings",e.STATS="Statistics",e.STOKES_ANALYSIS="Stokes Analysis",e.STOKES_ANALYSIS_SETTINGS_CONVERSION="Stokes Conversion Settings",e.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING="Stokes Line Plot Settings",e.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING="Stokes Scatter Plot Settings",e.STOKES_ANALYSIS_SETTINGS_SMOOTHING="Stokes Smoothing Settings",e.CATALOG_OVERLAY="Catalog Overlay",e.CATALOG_HISTOGRAM_PLOT="Catalog Histogram Plot",e.CATALOG_SCATTER_PLOT="Catalog Scatter Plot",e.CATALOG_SETTINGS_GOLBAL="Catalog Global Settings",e.CATALOG_SETTINGS_OVERLAY="Catalog Overlay Settings",e.CATALOG_SETTINGS_COLOR="Catalog Color Settings",e.CATALOG_SETTINGS_SIZE="Catalog Size Settings",e.CATALOG_SETTINGS_ORIENTATION="Catalog Orientation Settings",e.SPECTRAL_LINE_QUERY="Spectral Line Query",e.PV_GENERATOR="PV Generator"}(xM||(xM={}));let SM=(jM=OM=class e{constructor(){Object(f.a)(this,"type",gM,this),Object(f.a)(this,"helpVisible",fM,this),Object(f.a)(this,"position",bM,this),Object(f.a)(this,"showHelpDrawer",mM,this),Object(f.a)(this,"hideHelpDrawer",yM,this),Object(m.p)(this)}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}},OM.staticInstance=void 0,uM=jM,gM=Object(b.a)(uM.prototype,"type",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fM=Object(b.a)(uM.prototype,"helpVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),bM=Object(b.a)(uM.prototype,"position",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return y.a.RIGHT}}),mM=Object(b.a)(uM.prototype,"showHelpDrawer",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.type=e,this.position=t>.5*document.body.clientWidth?y.a.LEFT:y.a.RIGHT,this.helpVisible=!0}}}),yM=Object(b.a)(uM.prototype,"hideHelpDrawer",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.helpVisible=!1}}}),uM);var vM,CM,IM,wM,TM,RM,AM,PM,EM,MM,FM;let kM,DM;!function(e){e.X="X",e.Y="Y",e.PlotSize="Size",e.PlotShape="Shape",e.NONE="None"}(kM||(kM={})),function(e){e.TableUpdate="TableUpdate",e.ViewUpdate="ViewUpdate",e.PlotsUpdate="PlotsUpdate"}(DM||(DM={}));let LM=(vM=m.g.bound,FM=MM=class e extends $n{constructor(t,i,n,r=Hn.FILE){super(r,n),this.InitialedColumnsKeyWords=["ANGULAR DISTANCE","MAIN IDENTIFIER","RADIAL VELOCITY","REDSHIFT"],this.InitialedExcludeColumnsKeyWords=["PROPER MOTION","SIGMA"],this.InitialedRAColumnsKeyWords=["RIGHT ASCENSION","RA","R.A"],this.InitialedDECColumnsKeyWords=["DECLINATION","DEC","Dec."],Object(f.a)(this,"catalogInfo",IM,this),Object(f.a)(this,"catalogControlHeader",wM,this),Object(f.a)(this,"catalogHeader",TM,this),Object(f.a)(this,"numVisibleRows",RM,this),Object(f.a)(this,"subsetEndIndex",AM,this),Object(f.a)(this,"maxRows",PM,this),Object(f.a)(this,"resetCatalogFilterRequest",EM,this),Object(m.p)(this),this.catalogInfo=t,this.catalogHeader=i.sort(((e,t)=>e.columnIndex-t.columnIndex)),this.catalogControlHeader=this.initCatalogControlHeader,this.catalogFilterRequest=this.initCatalogFilterRequest,this.updatingDataStream=!1,this.updateMode=DM.TableUpdate,this.selectedPointIndices=[],this.filterDataSize=void 0,this.maxRows=t.dataSize;const o=t.fileInfo.coosys[0];if(o){const e=$n.getCatalogSystem(o.system);this.catalogCoordinateSystem={system:e,equinox:o.equinox,epoch:o.epoch,coordinate:this.systemCoordinateMap.get(Yn.ICRS)}}else this.catalogCoordinateSystem={system:Yn.ICRS,equinox:null,epoch:null,coordinate:this.systemCoordinateMap.get(Yn.ICRS)};const s=e.InitTableRows;t.dataSize<s?(this.numVisibleRows=t.dataSize,this.subsetEndIndex=t.dataSize):(this.numVisibleRows=s,this.subsetEndIndex=s)}setUserFilter(e){this.catalogFilterRequest=e}setCatalogHeader(e){this.catalogHeader=e}static FillAllocatedArray(e,t,i,n){const r=t.length;let o;if(e.length===n){o=e;for(let e=0;e<r;e++)o[e+i]=t[e]}else{o=new Array(n);for(let t=0;t<i;t++)o[t]=e[t];for(let e=0;e<r;e++)o[e+i]=t[e]}return o}updateCatalogData(t,i){let n=t.subsetDataSize;const r=t.subsetEndIndex,o=r-n,s=t.requestEndIndex;if(this.filterDataSize=t.filterDataSize,this.subsetEndIndex<=this.filterDataSize){let t=this.numVisibleRows+n;i.forEach(((t,i)=>{let n=this.catalogData.get(i);if(n)if(n.dataType===Nt.ColumnType.String){const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,s)}else if(n.dataType===Nt.ColumnType.Bool){const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,s)}else{if(n.dataType===Nt.ColumnType.UnsupportedType)return;{const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,s)}}else this.catalogData.set(i,t)})),this.setNumVisibleRows(t),this.subsetEndIndex=r}}setNumVisibleRows(e){this.numVisibleRows=e}setSubsetEndIndex(e){this.subsetEndIndex=e}resetFilterRequest(){this.setUpdateMode(DM.TableUpdate),this.clearData(),this.setNumVisibleRows(0),this.setSubsetEndIndex(0),this.setLoadingDataStatus(!0)}setSortingInfo(e,t){this.sortingInfo={columnName:e,sortingType:t}}get loadOntoImage(){return this.loadingData||this.updatingDataStream}get initCatalogControlHeader(){const e=new Map,t=this.catalogHeader;if(t.length)for(let i=0;i<t.length;i++){const n=t[i];let r=!1;i<JA.Instance.catalogDisplayedColumnSize&&(r=!0);let o={columnIndex:n.columnIndex,dataIndex:i,display:r,filter:"",columnWidth:null};e.set(n.name,o)}return e}setMaxRows(e){this.updateTableStatus(!0),this.maxRows=e}get initCatalogFilterRequest(){let t=new Nt.CatalogFilterRequest,i=new Nt.CatalogImageBounds,n=e.InitTableRows;return t.fileId=this.catalogInfo.fileId,t.filterConfigs=null,t.columnIndices=this.columnIndices,t.subsetStartIndex=0,t.imageBounds=i,t.regionId=null,t.sortColumn=null,t.sortingType=null,n>this.maxRows&&(n=this.maxRows),this.catalogInfo.dataSize<n?t.subsetDataSize=this.catalogInfo.dataSize:t.subsetDataSize=n,t}get updateRequestDataSize(){if(this.catalogFilterRequest.subsetStartIndex=this.subsetEndIndex,this.maxRows<=this.numVisibleRows)return this.catalogFilterRequest.subsetStartIndex=0,this.catalogFilterRequest.subsetDataSize=this.maxRows,this.catalogFilterRequest;const t=this.maxRows-this.numVisibleRows;if(this.updateMode===DM.TableUpdate){let i=e.DataChunkSize;t<i&&t>0&&(i=t),this.catalogFilterRequest.subsetDataSize=i}else this.catalogFilterRequest.subsetDataSize=t;return this.catalogFilterRequest}get shouldUpdateData(){return isFinite(this.filterDataSize)?this.subsetEndIndex<this.filterDataSize&&this.subsetEndIndex<this.maxRows:this.subsetEndIndex<this.catalogInfo.dataSize&&this.subsetEndIndex<this.maxRows}get columnIndices(){let e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.display&&e.push(t.columnIndex)})),e}findKeywords(e){const t=this.InitialedColumnsKeyWords,i=this.InitialedRAColumnsKeyWords,n=this.InitialedDECColumnsKeyWords,r=this.InitialedExcludeColumnsKeyWords,o=e.toUpperCase();for(let s=0;s<t.length;s++){const e=t[s];if(o.includes(e))return!0}if(o.includes(r[0])||o.includes(r[1]))return!1;for(let s=0;s<i.length;s++){const e=i[s];if(o.includes(e))return!0}for(let s=0;s<n.length;s++){const e=n[s];if(o.includes(e))return!0}return!1}},MM.InitTableRows=50,MM.DataChunkSize=50,CM=FM,IM=Object(b.a)(CM.prototype,"catalogInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wM=Object(b.a)(CM.prototype,"catalogControlHeader",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),TM=Object(b.a)(CM.prototype,"catalogHeader",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RM=Object(b.a)(CM.prototype,"numVisibleRows",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AM=Object(b.a)(CM.prototype,"subsetEndIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PM=Object(b.a)(CM.prototype,"maxRows",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(CM.prototype,"setUserFilter",[m.g],Object.getOwnPropertyDescriptor(CM.prototype,"setUserFilter"),CM.prototype),Object(b.a)(CM.prototype,"setCatalogHeader",[m.g],Object.getOwnPropertyDescriptor(CM.prototype,"setCatalogHeader"),CM.prototype),Object(b.a)(CM.prototype,"setNumVisibleRows",[vM],Object.getOwnPropertyDescriptor(CM.prototype,"setNumVisibleRows"),CM.prototype),Object(b.a)(CM.prototype,"setSubsetEndIndex",[m.g],Object.getOwnPropertyDescriptor(CM.prototype,"setSubsetEndIndex"),CM.prototype),EM=Object(b.a)(CM.prototype,"resetCatalogFilterRequest",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.resetFilterRequest(),this.resetUserFilters(),this.loadingData=!1,this.catalogFilterRequest=this.initCatalogFilterRequest,this.updatingDataStream=!1,this.sortingInfo.columnName=null,this.sortingInfo.sortingType=null,this.maxRows=this.catalogInfo.dataSize}}}),Object(b.a)(CM.prototype,"resetFilterRequest",[m.g],Object.getOwnPropertyDescriptor(CM.prototype,"resetFilterRequest"),CM.prototype),Object(b.a)(CM.prototype,"setSortingInfo",[m.g],Object.getOwnPropertyDescriptor(CM.prototype,"setSortingInfo"),CM.prototype),Object(b.a)(CM.prototype,"loadOntoImage",[m.i],Object.getOwnPropertyDescriptor(CM.prototype,"loadOntoImage"),CM.prototype),Object(b.a)(CM.prototype,"initCatalogControlHeader",[m.i],Object.getOwnPropertyDescriptor(CM.prototype,"initCatalogControlHeader"),CM.prototype),Object(b.a)(CM.prototype,"setMaxRows",[m.g],Object.getOwnPropertyDescriptor(CM.prototype,"setMaxRows"),CM.prototype),Object(b.a)(CM.prototype,"initCatalogFilterRequest",[m.i],Object.getOwnPropertyDescriptor(CM.prototype,"initCatalogFilterRequest"),CM.prototype),Object(b.a)(CM.prototype,"updateRequestDataSize",[m.i],Object.getOwnPropertyDescriptor(CM.prototype,"updateRequestDataSize"),CM.prototype),Object(b.a)(CM.prototype,"shouldUpdateData",[m.i],Object.getOwnPropertyDescriptor(CM.prototype,"shouldUpdateData"),CM.prototype),Object(b.a)(CM.prototype,"columnIndices",[m.i],Object.getOwnPropertyDescriptor(CM.prototype,"columnIndices"),CM.prototype),CM);var NM,_M,zM,VM,WM;i(826);let GM,BM;!function(e){e[e.GAUSSIAN=0]="GAUSSIAN",e[e.LORENTZIAN=1]="LORENTZIAN"}(GM||(GM={})),function(e){e[e.NONE=-1]="NONE",e[e.ZEROTH_ORDER=0]="ZEROTH_ORDER",e[e.FIRST_ORDER=1]="FIRST_ORDER"}(BM||(BM={}));let qM=Object(p.a)((_M=class extends n.Component{setIsShowingLog(e){this.isShowingLog=e}setIsShowingResultButton(e){this.isShowingResultButton=e}constructor(e){super(e),Object(f.a)(this,"isShowingLog",zM,this),Object(f.a)(this,"isShowingResultButton",VM,this),this.onFunctionChanged=e=>{this.reset(),this.props.fittingStore.setFunction(parseInt(e.target.value))},this.onContinuumValueChanged=e=>{this.props.fittingStore.setYIntercept(0),this.props.fittingStore.setSlope(0),this.props.fittingStore.setContinuum(parseInt(e.target.value))},this.onYInterceptValueChanged=e=>{this.props.fittingStore.setYIntercept(e)},this.onSlopeValueChanged=e=>{this.props.fittingStore.setSlope(e)},this.onYInterceptValueLocked=()=>{this.props.fittingStore.setLockedYIntercept(!this.props.fittingStore.lockedYIntercept)},this.onSlopeValueLocked=()=>{this.props.fittingStore.setLockedSlope(!this.props.fittingStore.lockedSlope)},this.cursorSelectingYIntercept=()=>{this.props.fittingStore.setIsCursorSelectingYIntercept(!this.props.fittingStore.isCursorSelectingYIntercept)},this.cursorSelectingSlope=()=>{this.props.fittingStore.setIsCursorSelectingSlope(!this.props.fittingStore.isCursorSelectingSlope)},this.onCenterValueChanged=e=>{this.props.fittingStore.selectedComponent.setCenter(e)},this.onAmpValueChanged=e=>{this.props.fittingStore.selectedComponent.setAmp(e)},this.onFwhmValueChanged=e=>{this.props.fittingStore.selectedComponent.setFwhm(e)},this.onMouseOverResult=()=>{this.setIsShowingResultButton(!0)},this.onMouseLeaveResult=()=>{this.setIsShowingResultButton(!1)},this.autoDetect=()=>{var e,t;this.props.fittingStore.setHasResult(!1),this.props.fittingStore.setComponents(1,!0),(null===(e=this.props.widgetStore)||void 0===e||null===(t=e.plotData)||void 0===t?void 0:t.fittingData)&&(this.props.fittingStore.autoDetect(),this.props.fittingStore.isAutoDetectWithFitting&&this.fitData()),this.props.fittingStore.setHasAutoDetectResult(!0)},this.deleteComponent=()=>{this.props.fittingStore.deleteSelectedComponent()},this.cursorSelecting=()=>{this.props.fittingStore.setIsCursorSelectingComponentOn(!this.props.fittingStore.isCursorSelectingComponent)},this.onCenterLocked=()=>{this.props.fittingStore.selectedComponent.setLockedCenter(!this.props.fittingStore.selectedComponent.lockedCenter)},this.onAmpLocked=()=>{this.props.fittingStore.selectedComponent.setLockedAmp(!this.props.fittingStore.selectedComponent.lockedAmp)},this.onFwhmLocked=()=>{this.props.fittingStore.selectedComponent.setLockedFwhm(!this.props.fittingStore.selectedComponent.lockedFwhm)},this.showLog=()=>{this.setIsShowingLog(!0)},this.handleLogClose=()=>{this.setIsShowingLog(!1)},this.saveLog=()=>{let e="";const t=this.props.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){e+=`# image: ${t.filename}\n`;const i=this.props.widgetStore.effectiveRegionId,n=t.regionSet.regions.find((e=>e.regionId===i));0!==i&&(e+=`# statistic: ${this.props.widgetStore.profileSelectionStore.selectedStatsTypes[0]}\n`),n&&(e+=`# ${n.regionProperties}\n`,t.validWcs&&(e+=`# ${t.getRegionWcsProperties(n)}\n`))}const i=`${e}\n${this.props.fittingStore.resultLog}`;Ym(`Profile Fitting Result Log-${Bm()}`,i)},Object(f.a)(this,"reset",WM,this),this.fitData=()=>{this.props.fittingStore.readyToFit&&this.props.fittingStore.fitData()},this.autoButtonTooltip=()=>Object(xm.jsx)("span",{children:Object(xm.jsxs)("i",{children:["Automatically detect features in the spectrum ",Object(xm.jsx)("br",{}),"and set initial guess for each component.",Object(xm.jsx)("br",{}),"[Experimental]"]})}),this.isShowingLog=!1,Object(m.p)(this),Object(m.h)((()=>{var e,t,i,n;(null===(e=this.props.widgetStore)||void 0===e||null===(t=e.profileSelectionStore)||void 0===t?void 0:t.profiles[0])&&this.reset(),(null===(i=this.props.widgetStore)||void 0===i||null===(n=i.smoothingStore)||void 0===n?void 0:n.type)&&this.reset()}))}render(){const e=gC.Instance,t=this.props.fittingStore,i=this.props.widgetStore.profileNum>1,n=Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:Object(xm.jsx)("i",{children:t.isCursorSelectingComponent?"Disable cursor selection":"Enable cursor selection"})}),children:Object(xm.jsx)(u.b,{onClick:this.cursorSelecting,active:t.isCursorSelectingComponent,icon:"select",disabled:i})});return Object(xm.jsx)("div",{className:"profile-fitting-panel",children:Object(xm.jsx)(j.a,{disabled:!i,content:"Profile fitting is not available when there are multiple profiles in the plot.",children:Object(xm.jsxs)(u.p,{disabled:i,children:[Object(xm.jsxs)("div",{className:"profile-fitting-form",children:[Object(xm.jsx)(u.p,{label:"Data source",inline:!0,children:Object(xm.jsx)(u.r,{value:e.activeFrameIndex,options:e.frames.map((e=>({label:e.filename,value:e.frameInfo.fileId}))),onChange:t=>e.setActiveFrameById(parseInt(t.target.value)),disabled:i})}),Object(xm.jsx)(u.p,{label:"Profile function",inline:!0,children:Object(xm.jsx)(u.r,{value:t.function,options:[{label:"Gaussian",value:GM.GAUSSIAN},{label:"Lorentzian",value:GM.LORENTZIAN}],onChange:this.onFunctionChanged,disabled:i})}),Object(xm.jsx)(u.p,{label:"Auto detect",inline:!0,children:Object(xm.jsxs)("div",{className:"component-input",children:[Object(xm.jsx)(j.a,{content:this.autoButtonTooltip(),children:Object(xm.jsx)(u.b,{onClick:this.autoDetect,icon:"series-search",disabled:i})}),Object(xm.jsx)(u.P,{label:"w/ cont.",checked:t.isAutoDetectWithCont,onChange:e=>t.setIsAutoDetectWithCont(!t.isAutoDetectWithCont),disabled:i}),Object(xm.jsx)(u.P,{label:"auto fit",checked:t.isAutoDetectWithFitting,onChange:e=>t.setIsAutoDetectWithFitting(!t.isAutoDetectWithFitting),disabled:i})]})}),t.hasAutoDetectResult&&Object(xm.jsx)(u.p,{label:" ",inline:!0,children:Object(xm.jsx)("div",{children:t.autoDetectResultText})}),Object(xm.jsx)(u.p,{label:"Components",inline:!0,children:Object(xm.jsxs)("div",{className:"components-input",children:[Object(xm.jsx)(pO,{value:t.components.length,min:1,max:20,stepSize:1,onValueChange:e=>t.setComponents(Math.round(e)),disabled:i}),t.components.length>1&&Object(xm.jsxs)("div",{className:"components-slider",children:[Object(xm.jsx)(u.N,{value:t.selectedIndex+1,min:1,stepSize:1,max:t.components.length,showTrackFill:!1,onChange:e=>t.setSelectedIndex(e-1),disabled:t.components.length<=1}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:Object(xm.jsx)("i",{children:"Delete Current Component"})}),children:Object(xm.jsx)(u.b,{intent:g.a.NONE,icon:"trash",onClick:this.deleteComponent})})]})]})}),Object(xm.jsx)(u.p,{label:"Center",inline:!0,children:Object(xm.jsxs)("div",{className:"component-input",children:[Object(xm.jsx)(pO,{value:t.selectedComponent.center,onValueChange:this.onCenterValueChanged,disabled:t.selectedComponent.lockedCenter||i,allowNumericCharactersOnly:!1,buttonPosition:"none"}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:Object(xm.jsx)("i",{children:t.selectedComponent.lockedCenter?"Unlock center":"Lock center"})}),children:Object(xm.jsx)(u.b,{onClick:this.onCenterLocked,icon:t.selectedComponent.lockedCenter?"lock":"unlock",disabled:i})}),n]})}),Object(xm.jsx)(u.p,{label:"Amplitude",inline:!0,children:Object(xm.jsxs)("div",{className:"component-input",children:[Object(xm.jsx)(pO,{value:t.selectedComponent.amp,onValueChange:this.onAmpValueChanged,disabled:t.selectedComponent.lockedAmp||i,allowNumericCharactersOnly:!1,buttonPosition:"none"}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:Object(xm.jsx)("i",{children:t.selectedComponent.lockedAmp?"Unlock amplitude":"Lock amplitude"})}),children:Object(xm.jsx)(u.b,{onClick:this.onAmpLocked,icon:t.selectedComponent.lockedAmp?"lock":"unlock",disabled:i})}),n]})}),Object(xm.jsx)(u.p,{label:"FWHM",inline:!0,children:Object(xm.jsxs)("div",{className:"component-input",children:[Object(xm.jsx)(pO,{value:t.selectedComponent.fwhm,onValueChange:this.onFwhmValueChanged,disabled:t.selectedComponent.lockedFwhm||i,allowNumericCharactersOnly:!1,buttonPosition:"none"}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:Object(xm.jsx)("i",{children:t.selectedComponent.lockedFwhm?"Unlock FWHM":"Lock FWHM"})}),children:Object(xm.jsx)(u.b,{onClick:this.onFwhmLocked,icon:t.selectedComponent.lockedFwhm?"lock":"unlock",disabled:i})}),n]})}),Object(xm.jsx)(u.p,{label:"Continuum",inline:!0,children:Object(xm.jsx)("div",{className:"component-input",children:Object(xm.jsx)(u.r,{value:t.continuum,options:[{label:"None",value:BM.NONE},{label:"0th order",value:BM.ZEROTH_ORDER},{label:"1st order",value:BM.FIRST_ORDER}],onChange:this.onContinuumValueChanged,disabled:i})})}),(t.continuum===BM.ZEROTH_ORDER||t.continuum===BM.FIRST_ORDER)&&Object(xm.jsx)(u.p,{label:"Y intercept",inline:!0,children:Object(xm.jsxs)("div",{className:"component-input",children:[Object(xm.jsx)(pO,{value:t.yIntercept,onValueChange:this.onYInterceptValueChanged,disabled:t.lockedYIntercept||i,allowNumericCharactersOnly:!1,buttonPosition:"none"}),Object(xm.jsx)(u.b,{onClick:this.onYInterceptValueLocked,icon:t.lockedYIntercept?"lock":"unlock",disabled:i}),t.continuum===BM.ZEROTH_ORDER&&Object(xm.jsx)(u.b,{onClick:this.cursorSelectingYIntercept,active:t.isCursorSelectingYIntercept,icon:"select",disabled:i}),t.continuum===BM.FIRST_ORDER&&Object(xm.jsx)(u.b,{onClick:this.cursorSelectingSlope,active:t.isCursorSelectingSlope,icon:"select",disabled:i})]})}),t.continuum===BM.FIRST_ORDER&&Object(xm.jsx)(u.p,{label:"Slope",inline:!0,children:Object(xm.jsxs)("div",{className:"component-input",children:[Object(xm.jsx)(pO,{value:t.slope,onValueChange:this.onSlopeValueChanged,disabled:t.lockedSlope||i,allowNumericCharactersOnly:!1,buttonPosition:"none"}),Object(xm.jsx)(u.b,{onClick:this.onSlopeValueLocked,icon:t.lockedSlope?"lock":"unlock",disabled:i}),Object(xm.jsx)(u.b,{onClick:this.cursorSelectingSlope,active:t.isCursorSelectingSlope,icon:"select",disabled:i})]})}),Object(xm.jsx)(u.p,{label:"Fitting result",inline:!0,children:Object(xm.jsxs)("div",{onMouseOver:this.onMouseOverResult,onMouseLeave:this.onMouseLeaveResult,children:[Object(xm.jsx)("div",{className:"fitting-result",children:Object(xm.jsx)(u.I,{className:"fitting-result-pre",disabled:i,children:Object(xm.jsx)(u.U,{className:"fitting-result-text",children:t.resultString})})}),this.isShowingResultButton?Object(xm.jsx)(u.e,{icon:"th",onClick:this.saveLog,className:"fitting-result-hover-button"}):Object(xm.jsx)("div",{style:{height:"30px"}})]})})]}),Object(xm.jsxs)("div",{className:"profile-fitting-footer",children:[Object(xm.jsx)(u.b,{text:"Reset",intent:g.a.PRIMARY,onClick:this.reset,disabled:i}),Object(xm.jsx)(u.b,{text:"Fit",intent:g.a.PRIMARY,onClick:this.fitData,disabled:!t.readyToFit||i}),Object(xm.jsx)(O.a,{isOpen:this.isShowingLog,onClose:this.handleLogClose,content:Object(xm.jsxs)("div",{className:"fitting-popover",children:[Object(xm.jsx)("div",{className:"fitting-log",children:Object(xm.jsx)(u.I,{className:"fitting-log-pre",children:Object(xm.jsx)(u.U,{className:"fitting-log-text",children:t.resultLog})})}),Object(xm.jsx)("div",{className:"fitting-popover-footer",children:Object(xm.jsx)(u.e,{text:"Save log",onClick:this.saveLog,className:"fitting-log-button"})})]}),children:Object(xm.jsx)(u.b,{text:"View log",onClick:this.showLog,intent:g.a.PRIMARY,disabled:!t.hasResult||i})}),Object(xm.jsx)("div",{className:"switch-wrapper",children:Object(xm.jsx)(u.P,{label:"residual",checked:t.enableResidual,onChange:e=>t.setEnableResidual(e.currentTarget.checked),disabled:i})})]})]})})})}},zM=Object(b.a)(_M.prototype,"isShowingLog",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VM=Object(b.a)(_M.prototype,"isShowingResultButton",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WM=Object(b.a)(_M.prototype,"reset",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.props.fittingStore;e.setComponents(1,!0),e.setHasResult(!1),e.setContinuum(BM.NONE),e.setYIntercept(0),e.setSlope(0),e.setResultYIntercept(0),e.setResultSlope(0),e.setIsCursorSelectingYIntercept(!1),e.setIsCursorSelectingSlope(!1),e.setIsCursorSelectingComponentOn(!1),e.setHasAutoDetectResult(!1)}}}),Object(b.a)(_M.prototype,"setIsShowingLog",[m.g],Object.getOwnPropertyDescriptor(_M.prototype,"setIsShowingLog"),_M.prototype),Object(b.a)(_M.prototype,"setIsShowingResultButton",[m.g],Object.getOwnPropertyDescriptor(_M.prototype,"setIsShowingResultButton"),_M.prototype),NM=_M))||NM;function HM(e){const t=[];t.push(e[0]);for(let i=1;i<e.length-1;i++){const n=.25*e[i-1]+.5*e[i]+.25*e[i+1];t.push(n)}return t.push(e[e.length-1]),t}function YM(e,t){for(let i=0;i<e.length-1;i++){if(e[i]<=t&&t<e[i+1])return i;if(e[i]>=t&&t>e[i+1])return i;if(t===e[i+1])return i+1}return null}function UM(e){let t=function(e,t){const i=[];for(let n=0;n<e.length-t;n+=t)i.push(T.mean(e.slice(n,n+t>e.length?e.length:n+t)));return i}(e,Math.floor(e.length/128)+1);return t=HM(t),t=HM(t),t}function XM(e,t){const i=function(e,t){isFinite(t);const i=[],n=T.min(e),r=T.max(e),o=(r-n)/t;for(let a=0;a<t;a++)i.push(n+a*o);i.push(r);const s=new Array(t).fill(0);for(const a of e)for(let e=0;e<t;e++){if(a>=i[e]&&a<i[e+1]){s[e]=s[e]+1;break}if(a===i[t]){s[t-1]=s[t-1]+1;break}}return{hist:s,binEdges:i}}(e,t),n=[0,...i.hist,0],r=[];for(let d=0;d<i.binEdges.length-2;d++)r.push((i.binEdges[d]+i.binEdges[d+1])/2);const o=r[1]-r[0],s=[r[0]-o,...r,r[r.length-1]+o],a=T.findIndex(n,(e=>e===T.max(n)));if(1===a||a===n.length-2)return{center:s[a],stddev:o};const l=[T.max(n),s[a],2*Math.sqrt(2*Math.log(10))*.5*o],c=qa.fitting(GM.GAUSSIAN,new Float64Array(s),new Float64Array(n),l,[0,0,0],[0,0],[1,1]);return{center:c.center[0],stddev:c.fwhm[0]/(2*Math.sqrt(2*Math.log(2)))}}function $M(e,t,i){let n,r,o,s,a=e,l=t;const c=function(e,t){const i=t.map(((e,i)=>e+t[t.length-1-i])),n=XM(i,Math.floor(Math.sqrt(i.length))),r=n.center,o=n.stddev;let s,a,l=!1;const c=[],d=[],p=r-2*o,h=r+2*o;for(let u=0;u<i.length;u++){const n=i[u];if(n<h&&n>p&&!1===l&&u<=i.length-2)s=u,l=!0;else if((n>h||n<p)&&!0===l)a=u,l=!1,c.push(T.mean(e.slice(s,a))),d.push(T.mean(t.slice(s,a)));else if(n<h&&n>p&&!0===l&&u===i.length-1){a=u,c.push(T.mean(e.slice(s,a))),d.push(T.mean(t.slice(s,a)));break}}return c.length<=1&&(c.push(T.mean(e.slice(0,Math.floor(e.length)/2))),c.push(T.mean(e.slice(Math.floor(e.length/2),e.length))),d.push(T.mean(t.slice(0,Math.floor(t.length)/2))),d.push(T.mean(t.slice(Math.floor(t.length/2),t.length)))),[{x:c[0],y:d[0]},{x:c[c.length-1],y:d[d.length-1]}]}(a,l),d=c[0],p=c[1];i?(o=i.slope,s=i.yIntercept):(r=(d.y+p.y)/2,o=(p.y-d.y)/(p.x-d.x),s=d.y-o*d.x),l=t.map(((e,t)=>e-(o*a[t]+s)));const h=UM(a),u=UM(l),g=Math.floor(Math.sqrt(l.length)),f=XM(u,g<=8?8:g),b=f.center,m=f.stddev;if(i)n=i.order;else{const e=3*m;-e<d.y&&d.y<e&&-e<p.y&&p.y<e?(n=-1,s=0,o=0):r-e<d.y&&d.y<r+e&&r-e<p.y&&p.y<r+e?(n=0,s=r,o=0):n=1}const y=[];let O=!1;const j=b-2*m,x=b+2*m;let S,v,C=0,I=0;for(let A=0;A<u.length;A++){const e=u[A];if((e>x||e<j)&&!1===O)C=A,O=!0;else if(e<x&&e>j&&!0===O)I=A-1,O=!1,S=YM(a,h[C]),v=YM(a,h[I]),v-S+1>=4&&(T.mean(u.slice(C,I+1))>b+3*m||T.mean(u.slice(C,I+1))<b-3*m)&&y.push({fromIndexOri:S,toIndexOri:v,fromIndex:C,toIndex:I});else if((e>x||e<j)&&!0===O&&A===u.length-1){I=A,S=YM(a,h[C]),v=YM(a,h[I]),v-S+1>=4&&(T.mean(u.slice(C,I+1))>b+3*m||T.mean(u.slice(C,I+1))<b-3*m)&&y.push({fromIndexOri:S,toIndexOri:v,fromIndex:C,toIndex:I});break}}const w=[];for(let A=0;A<y.length;A++){const e=y[A],t=(T.mean(u.slice(e.fromIndex,e.toIndex))-b)/m,i=e.toIndex-e.fromIndex+1,n=[];let r=[];const o=[],s=[],l=[],c=[],d=[];if(Math.abs(t)>=4&&i>=12){for(let t=e.fromIndex;t<e.toIndex-4;t++){const e=u.slice(t,t+5).map(((e,t)=>({data:e,index:t}))),i=T.sortBy(e,(e=>e.data)).map((e=>e.index));(0===i[3]&&4===i[4]||4===i[3]&&0===i[4])&&(l.push(YM(a,h[t+2])),d.push(u[t+2])),(0===i[0]&&4===i[1]||4===i[0]&&0===i[1])&&(s.push(YM(a,h[t+2])),c.push(u[t+2]))}for(const e of l)r.push(e);for(const e of s)r.push(e);r=r.sort(((e,t)=>e-t));for(const e of r)-1!==l.indexOf(e)?o.push(d[l.indexOf(e)]):o.push(c[s.indexOf[e]]);if(n.push(e.fromIndexOri),0===r.length);else if(1===r.length){const e=r[0];t>0?-1!==l.indexOf(e)&&n.push(e):-1!==s.indexOf(e)&&n.push(e)}else if(2===r.length){const e=r[0],i=r[1];t>0?-1!==l.indexOf(e)?-1!==l.indexOf(i)?(n.push(e),n.push(i)):-1!==s.indexOf(i)&&n.push(e):-1!==s.indexOf(e)&&(-1!==l.indexOf(i)?n.push(i):-1!==s.indexOf(i)&&n.push(Math.floor((e+i)/2))):-1!==l.indexOf(e)?-1!==l.indexOf(i)?n.push(Math.floor((e+i)/2)):-1!==s.indexOf(i)&&n.push(i):-1!==s.indexOf(e)&&(-1!==l.indexOf(i)?n.push(e):-1!==s.indexOf(i)&&(n.push(e),n.push(i)))}else if(r.length>=3)if(t>0){for(let o=0;o<r.length-2;o++){const e=r[o],t=r[o+1],i=r[o+2];-1!==l.indexOf(e)?(-1!==l.indexOf(t)||-1!==s.indexOf(t)&&0===o)&&n.push(e):-1!==s.indexOf(e)&&(-1!==l.indexOf(t)&&-1!==s.indexOf(i)?n.push(t):-1!==s.indexOf(t)&&n.push(Math.floor((e+t)/2)))}const e=r[r.length-1];-1!==l.indexOf(e)&&n.push(e);const t=r[r.length-2];-1!==s.indexOf(t)&&-1!==s.indexOf(e)&&n.push(Math.floor((t+e)/2));const i=r[r.length-3];-1!==l.indexOf(i)&&-1!==l.indexOf(t)&&-1!==s.indexOf(e)&&n.push(t)}else{for(let o=0;o<r.length-2;o++){const e=r[o],t=r[o+1],i=r[o+2];-1!==s.indexOf(e)?(-1!==s.indexOf(t)||-1!==l.indexOf(t)&&0===o)&&n.push(e):-1!==l.indexOf(e)&&(-1!==s.indexOf(t)&&-1!==l.indexOf(i)?n.push(t):-1!==l.indexOf(t)&&n.push(Math.floor((e+t)/2)))}const e=r[r.length-1];-1!==s.indexOf(e)&&n.push(e);const t=r[r.length-2];-1!==l.indexOf(t)&&-1!==l.indexOf(e)&&n.push(Math.floor((t+e)/2));const i=r[r.length-3];-1!==s.indexOf(i)&&-1!==s.indexOf(t)&&-1!==l.indexOf(e)&&n.push(t)}n.push(e.toIndexOri);for(let e=0;e<n.length-1;e++){const t=n[e],i=n[e+1],r=YM(h,a[n[e]]),o=YM(h,a[n[e+1]]);w.push({fromIndexOri:t,toIndexOri:i,fromIndex:r,toIndex:o})}}else w.push(e)}const R=[];for(const A of w){const e=new jk;e.setFwhm(Math.abs(a[A.toIndexOri]-a[A.fromIndexOri])/2);const t=u.slice(A.fromIndex,A.toIndex+1),i=T.mean(t)>b?T.max(t):T.min(t);e.setAmp(i);const n=t.indexOf(i);e.setCenter(h[A.fromIndex+n]),R.push(e)}return{components:R,order:n,yIntercept:s,slope:o}}var KM,QM,ZM,JM,eF,tF,iF,nF,rF,oF,sF,aF,lF,cF,dF,pF,hF,uF,gF,fF,bF,mF,yF,OF,jF,xF,SF,vF,CF,IF,wF,TF,RF,AF,PF,EF,MF,FF,kF,DF,LF,NF,_F,zF,VF,WF,GF,BF,qF,HF,YF,UF,XF,$F,KF,QF,ZF,JF,ek,tk,ik,nk,rk,ok,sk,ak,lk,ck,dk,pk,hk,uk,gk,fk,bk,mk,yk;let Ok=(KM=class{setComponents(e,t){this.setSelectedIndex(e-1);const i=[];for(let n=0;n<e;n++)t?i.push(new jk):i.push(n<this.components.length?this.components[n]:new jk);this.components=i}deleteSelectedComponent(){this.components.length>1&&(this.components=this.components.slice(0,this.selectedIndex).concat(this.components.slice(this.selectedIndex+1)),this.selectedIndex=0===this.selectedIndex?0:this.selectedIndex-1)}setComponentByCursor(e,t,i,n){const r=this.selectedComponent,o=(e+t)/2,s=(i+n)/2>=this.slope*o+this.yIntercept;r.setAmp(s?n-i:i-n),r.setCenter(o),r.setFwhm(t-e),this.isCursorSelectingComponent=!1}get selectedComponent(){return this.components&&this.selectedIndex<this.components.length?this.components[this.selectedIndex]:null}get fittingData(){if(this.widgetStore.plotData.fittingData){let e=this.widgetStore.plotData.fittingData.x,t=this.widgetStore.plotData.fittingData.y,i=t.findIndex((e=>!isNaN(e)));return i>0&&(e=e.slice(i,e.length-i),t=t.slice(i,t.length-i)),{x:e,y:t}}return null}get componentPlottingBoxes(){const e=[];if(this.components)for(let t=0;t<this.components.length;t++){const i=this.components[t];if(i.isReadyToFit&&!(isFinite(i.resultCenter)&&isFinite(i.resultAmp)&&isFinite(i.resultFwhm))){const n=i.center*this.slope+this.yIntercept,r={boundary:{xMin:i.center-.5*i.fwhm,xMax:i.center+.5*i.fwhm,yMin:0+n,yMax:i.amp+n},color:Jb("auto-lime"),opacity:t===this.selectedIndex?.5:.2,strokeColor:t===this.selectedIndex?Jb("auto-grey"):null,text:`${t+1}`};e.push(r)}}return e}get componentResultNumber(){const e=[];if(this.components&&this.hasResult)for(let t=0;t<this.components.length;t++){const i=this.components[t];if(isFinite(i.resultCenter)&&isFinite(i.resultAmp)&&isFinite(i.resultFwhm)){const n=i.resultCenter*this.resultSlope+this.resultYIntercept,r={x:i.resultCenter,y:n+.5*i.resultAmp,text:`${t+1}`};e.push(r)}}return e}get resultString(){var e;if(!(null===(e=this.widgetStore)||void 0===e?void 0:e.effectiveFrame))return"";let t="";const i=this.widgetStore.effectiveFrame.spectralUnitStr,n=this.widgetStore.yUnit;if(this.components&&this.hasResult){this.continuum!==BM.NONE&&(t+=`Y Intercept = ${fi(this.resultYIntercept,6)} (${n})\n`,t+=this.resultYInterceptError?`Y Intercept Error = ${fi(this.resultYInterceptError,6)} (${fi(Math.abs(100*this.resultYInterceptError/this.resultYIntercept),3)}%)\n`:""),this.continuum===BM.FIRST_ORDER&&(t+=`Slope = ${fi(this.resultSlope,6)} (${n} / ${i})\n`,t+=this.resultSlopeError?`Slope Error = ${fi(this.resultSlopeError,6)} (${fi(Math.abs(100*this.resultSlopeError/this.resultSlope),3)}%)\n`:""),this.continuum!==BM.NONE&&(t+="\n");for(let e=0;e<this.components.length;e++){const r=this.components[e];t+=`Component #${e+1}\n`,t+=`Center = ${fi(r.resultCenter,6)} (${i})\n`,t+=r.resultCenterError?`Center Error = ${fi(r.resultCenterError,6)} (${fi(Math.abs(100*r.resultCenterError/r.resultCenter),3)}%)\n`:"",t+=`Amplitude = ${fi(r.resultAmp,6)} (${n})\n`,t+=r.resultAmpError?`Amplitude Error = ${fi(r.resultAmpError,6)} (${fi(Math.abs(100*r.resultAmpError/r.resultAmp),3)}%)\n`:"",t+=`FWHM = ${fi(r.resultFwhm,6)} (${i})\n`,t+=r.resultFwhmError?`FWHM Error = ${fi(r.resultFwhmError,6)} (${fi(Math.abs(100*r.resultFwhmError/r.resultFwhm),3)}%)\n`:"",t+=`Integral = ${fi(r.resultIntegral,6)} (${n} * ${i})\n`,t+=r.resultIntegralError?`Integral Error ~= ${fi(r.resultIntegralError,6)} (${fi(Math.abs(100*r.resultIntegralError/r.resultIntegral),3)}%)\n\n`:""}}return t}get readyToFit(){if(!this.components)return!1;let e=0;for(const t of this.components){if(!t.isReadyToFit)return!1;t.lockedCenter&&e++,t.lockedAmp&&e++,t.lockedFwhm&&e++}return e!==3*this.components.length}get autoDetectResultText(){let e="";return this.hasAutoDetectResult&&(e=`detected ${this.detectedComponentN} component${this.detectedComponentN>1?"s":""}.`),e}get baseLinePoint2DArray(){if(this.components&&this.continuum!==BM.NONE){const e=this.widgetStore.plotData.fittingData.x,t=new Array(e.length);for(let i=0;i<e.length;i++){let n=this.yIntercept;this.continuum===BM.FIRST_ORDER&&(n+=e[i]*this.slope),t[i]={x:e[i],y:n}}return t}return[]}get modelPoint2DArray(){if(this.components&&this.hasResult){const e=this.originData.x,t=new Array(e.length);for(let i=0;i<e.length;i++){let n=0;for(const t of this.components)this.function===GM.GAUSSIAN?n+=Zi(e[i],t.resultAmp,t.resultCenter,t.resultFwhm):this.function===GM.LORENTZIAN&&(n+=Ji(e[i],t.resultAmp,t.resultCenter,t.resultFwhm));t[i]={x:e[i],y:n+(this.resultSlope*e[i]+this.resultYIntercept)}}return t}return[]}get individualModelPoint2DArrays(){if(this.components&&this.hasResult){const e=this.originData.x,t=new Array;for(const i of this.components){let n=[];for(let t=0;t<e.length;t++){const r=this.function===GM.GAUSSIAN?Zi(e[t],i.resultAmp,i.resultCenter,i.resultFwhm):Ji(e[t],i.resultAmp,i.resultCenter,i.resultFwhm);n.push({x:e[t],y:r+(this.resultSlope*e[t]+this.resultYIntercept)})}t.push(n)}return t}return[]}get residualPoint2DArray(){if(this.components&&this.hasResult){const e=this.originData.x,t=new Array(e.length);for(let i=0;i<e.length;i++)t[i]={x:e[i],y:this.resultResidual[i]};return t}return[]}constructor(e){Object(f.a)(this,"function",QM,this),Object(f.a)(this,"components",ZM,this),Object(f.a)(this,"continuum",JM,this),Object(f.a)(this,"yIntercept",eF,this),Object(f.a)(this,"slope",tF,this),Object(f.a)(this,"lockedYIntercept",iF,this),Object(f.a)(this,"lockedSlope",nF,this),Object(f.a)(this,"resultYIntercept",rF,this),Object(f.a)(this,"resultSlope",oF,this),Object(f.a)(this,"resultYInterceptError",sF,this),Object(f.a)(this,"resultSlopeError",aF,this),Object(f.a)(this,"selectedIndex",lF,this),Object(f.a)(this,"hasResult",cF,this),Object(f.a)(this,"resultLog",dF,this),Object(f.a)(this,"resultResidual",pF,this),Object(f.a)(this,"isCursorSelectingYIntercept",hF,this),Object(f.a)(this,"isCursorSelectingSlope",uF,this),Object(f.a)(this,"isCursorSelectingComponent",gF,this),Object(f.a)(this,"isAutoDetectWithCont",fF,this),Object(f.a)(this,"isAutoDetectWithFitting",bF,this),Object(f.a)(this,"hasAutoDetectResult",mF,this),Object(f.a)(this,"detectedComponentN",yF,this),Object(f.a)(this,"enableResidual",OF,this),Object(f.a)(this,"originData",jF,this),this.widgetStore=void 0,this.autoDetect=()=>{var e;const t=$M(this.fittingData.x,Array.prototype.slice.call(this.fittingData.y),this.isAutoDetectWithCont?null:{order:this.continuum,yIntercept:this.yIntercept,slope:this.slope});if((null===(e=t.components)||void 0===e?void 0:e.length)>0){this.setComponents(t.components.length,!0);for(let e=0;e<t.components.length;e++)this.components[e].setAmp(t.components[e].amp),this.components[e].setCenter(t.components[e].center),this.components[e].setFwhm(t.components[e].fwhm);this.setContinuum(t.order),this.setYIntercept(t.yIntercept),this.setSlope(t.slope)}this.setDetectedComponentN(t.components?t.components.length:0)},this.fitData=()=>{var e,t;if(!(null===(e=this.widgetStore)||void 0===e||null===(t=e.plotData)||void 0===t?void 0:t.fittingData)||!this.widgetStore.effectiveFrame)return;const i=this.fittingData.x,n=this.fittingData.y;this.setOriginData(i,n);const r=[],o=[];this.components.forEach((e=>{r.push(e.amp),r.push(e.center),r.push(e.fwhm),o.push(e.lockedAmp?1:0),o.push(e.lockedCenter?1:0),o.push(e.lockedFwhm?1:0)}));const s=[],a=[];this.continuum===BM.NONE?(s.push(0),s.push(0),a.push(1),a.push(1)):this.continuum===BM.ZEROTH_ORDER?(s.push(this.yIntercept),s.push(0),a.push(this.lockedYIntercept?1:0),a.push(1)):this.continuum===BM.FIRST_ORDER&&(s.push(this.yIntercept),s.push(this.slope),a.push(this.lockedYIntercept?1:0),a.push(this.lockedSlope?1:0));const l=qa.fitting(this.function,i,n,r,o,s,a);this.setResultYIntercept(l.yIntercept),this.setResultYInterceptError(l.yInterceptError),this.setResultSlope(l.slope),this.setResultSlopeError(l.slopeError);for(let h=0;h<this.components.length;h++){const e=this.components[h];e.setResultCenter(l.center[2*h]),e.setResultCenterError(l.center[2*h+1]),e.setResultAmp(l.amp[2*h]),e.setResultAmpError(l.amp[2*h+1]),e.setResultFwhm(l.fwhm[2*h]),e.setResultFwhmError(l.fwhm[2*h+1]),e.setResultIntegral(l.integral[2*h]),e.setResultIntegralError(l.integral[2*h+1])}const c=this.widgetStore.effectiveFrame.spectralUnitStr,d=this.widgetStore.yUnit;let p=l.log;p=p.replaceAll("@yUnit",d?`(${d})`:""),p=p.replaceAll("@xUnit",c?`(${c})`:""),p=p.replace("@slopeUnit",d&&c?`(${d} / ${c})`:""),p=p.replaceAll("@integralUnit",d&&c?`(${d} * ${c})`:""),this.setResultLog(p),this.setResultResidual(l.residual),this.setHasResult(!0)},Object(f.a)(this,"setFunction",xF,this),Object(f.a)(this,"setContinuum",SF,this),Object(f.a)(this,"setYIntercept",vF,this),Object(f.a)(this,"setSlope",CF,this),Object(f.a)(this,"setLockedYIntercept",IF,this),Object(f.a)(this,"setLockedSlope",wF,this),Object(f.a)(this,"setResultYIntercept",TF,this),Object(f.a)(this,"setResultSlope",RF,this),Object(f.a)(this,"setResultYInterceptError",AF,this),Object(f.a)(this,"setResultSlopeError",PF,this),Object(f.a)(this,"setSelectedIndex",EF,this),Object(f.a)(this,"setHasResult",MF,this),Object(f.a)(this,"setResultLog",FF,this),Object(f.a)(this,"setResultResidual",kF,this),Object(f.a)(this,"setIsCursorSelectingYIntercept",DF,this),Object(f.a)(this,"setIsCursorSelectingSlope",LF,this),Object(f.a)(this,"setIsCursorSelectingComponentOn",NF,this),Object(f.a)(this,"setIsAutoDetectWithCont",_F,this),Object(f.a)(this,"setIsAutoDetectWithFitting",zF,this),Object(f.a)(this,"setHasAutoDetectResult",VF,this),Object(f.a)(this,"setDetectedComponentN",WF,this),Object(f.a)(this,"setEnableResidual",GF,this),Object(f.a)(this,"setOriginData",BF,this),Object(m.p)(this),this.widgetStore=e,this.function=GM.GAUSSIAN,this.components=[new jk],this.continuum=BM.NONE,this.yIntercept=0,this.slope=0,this.selectedIndex=0,this.isAutoDetectWithCont=!1,this.isAutoDetectWithFitting=!1,this.enableResidual=!0}},QM=Object(b.a)(KM.prototype,"function",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZM=Object(b.a)(KM.prototype,"components",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JM=Object(b.a)(KM.prototype,"continuum",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eF=Object(b.a)(KM.prototype,"yIntercept",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tF=Object(b.a)(KM.prototype,"slope",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iF=Object(b.a)(KM.prototype,"lockedYIntercept",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nF=Object(b.a)(KM.prototype,"lockedSlope",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rF=Object(b.a)(KM.prototype,"resultYIntercept",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oF=Object(b.a)(KM.prototype,"resultSlope",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sF=Object(b.a)(KM.prototype,"resultYInterceptError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aF=Object(b.a)(KM.prototype,"resultSlopeError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lF=Object(b.a)(KM.prototype,"selectedIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cF=Object(b.a)(KM.prototype,"hasResult",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dF=Object(b.a)(KM.prototype,"resultLog",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pF=Object(b.a)(KM.prototype,"resultResidual",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hF=Object(b.a)(KM.prototype,"isCursorSelectingYIntercept",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uF=Object(b.a)(KM.prototype,"isCursorSelectingSlope",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gF=Object(b.a)(KM.prototype,"isCursorSelectingComponent",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fF=Object(b.a)(KM.prototype,"isAutoDetectWithCont",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bF=Object(b.a)(KM.prototype,"isAutoDetectWithFitting",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mF=Object(b.a)(KM.prototype,"hasAutoDetectResult",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yF=Object(b.a)(KM.prototype,"detectedComponentN",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OF=Object(b.a)(KM.prototype,"enableResidual",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jF=Object(b.a)(KM.prototype,"originData",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(KM.prototype,"setComponents",[m.g],Object.getOwnPropertyDescriptor(KM.prototype,"setComponents"),KM.prototype),Object(b.a)(KM.prototype,"deleteSelectedComponent",[m.g],Object.getOwnPropertyDescriptor(KM.prototype,"deleteSelectedComponent"),KM.prototype),Object(b.a)(KM.prototype,"setComponentByCursor",[m.g],Object.getOwnPropertyDescriptor(KM.prototype,"setComponentByCursor"),KM.prototype),Object(b.a)(KM.prototype,"selectedComponent",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"selectedComponent"),KM.prototype),Object(b.a)(KM.prototype,"fittingData",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"fittingData"),KM.prototype),Object(b.a)(KM.prototype,"componentPlottingBoxes",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"componentPlottingBoxes"),KM.prototype),Object(b.a)(KM.prototype,"componentResultNumber",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"componentResultNumber"),KM.prototype),Object(b.a)(KM.prototype,"resultString",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"resultString"),KM.prototype),Object(b.a)(KM.prototype,"readyToFit",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"readyToFit"),KM.prototype),Object(b.a)(KM.prototype,"autoDetectResultText",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"autoDetectResultText"),KM.prototype),Object(b.a)(KM.prototype,"baseLinePoint2DArray",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"baseLinePoint2DArray"),KM.prototype),Object(b.a)(KM.prototype,"modelPoint2DArray",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"modelPoint2DArray"),KM.prototype),Object(b.a)(KM.prototype,"individualModelPoint2DArrays",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"individualModelPoint2DArrays"),KM.prototype),Object(b.a)(KM.prototype,"residualPoint2DArray",[m.i],Object.getOwnPropertyDescriptor(KM.prototype,"residualPoint2DArray"),KM.prototype),xF=Object(b.a)(KM.prototype,"setFunction",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.function=e}}}),SF=Object(b.a)(KM.prototype,"setContinuum",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.continuum=e}}}),vF=Object(b.a)(KM.prototype,"setYIntercept",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.yIntercept=e}}}),CF=Object(b.a)(KM.prototype,"setSlope",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.slope=e}}}),IF=Object(b.a)(KM.prototype,"setLockedYIntercept",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lockedYIntercept=e}}}),wF=Object(b.a)(KM.prototype,"setLockedSlope",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lockedSlope=e}}}),TF=Object(b.a)(KM.prototype,"setResultYIntercept",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultYIntercept=e}}}),RF=Object(b.a)(KM.prototype,"setResultSlope",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultSlope=e}}}),AF=Object(b.a)(KM.prototype,"setResultYInterceptError",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultYInterceptError=e}}}),PF=Object(b.a)(KM.prototype,"setResultSlopeError",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultSlopeError=e}}}),EF=Object(b.a)(KM.prototype,"setSelectedIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedIndex=e}}}),MF=Object(b.a)(KM.prototype,"setHasResult",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hasResult=e}}}),FF=Object(b.a)(KM.prototype,"setResultLog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultLog=e}}}),kF=Object(b.a)(KM.prototype,"setResultResidual",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultResidual=e}}}),DF=Object(b.a)(KM.prototype,"setIsCursorSelectingYIntercept",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isCursorSelectingYIntercept=e}}}),LF=Object(b.a)(KM.prototype,"setIsCursorSelectingSlope",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isCursorSelectingSlope=e}}}),NF=Object(b.a)(KM.prototype,"setIsCursorSelectingComponentOn",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isCursorSelectingComponent=e}}}),_F=Object(b.a)(KM.prototype,"setIsAutoDetectWithCont",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isAutoDetectWithCont=e}}}),zF=Object(b.a)(KM.prototype,"setIsAutoDetectWithFitting",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isAutoDetectWithFitting=e}}}),VF=Object(b.a)(KM.prototype,"setHasAutoDetectResult",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hasAutoDetectResult=e}}}),WF=Object(b.a)(KM.prototype,"setDetectedComponentN",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.detectedComponentN=e}}}),GF=Object(b.a)(KM.prototype,"setEnableResidual",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.enableResidual=e}}}),BF=Object(b.a)(KM.prototype,"setOriginData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.originData={x:e,y:t}}}}),KM),jk=(qF=class{get isReadyToFit(){return isFinite(this.center)&&isFinite(this.amp)&&isFinite(this.fwhm)&&0!==this.amp&&0!==this.fwhm}constructor(){Object(f.a)(this,"center",HF,this),Object(f.a)(this,"amp",YF,this),Object(f.a)(this,"fwhm",UF,this),Object(f.a)(this,"lockedCenter",XF,this),Object(f.a)(this,"lockedAmp",$F,this),Object(f.a)(this,"lockedFwhm",KF,this),Object(f.a)(this,"resultCenter",QF,this),Object(f.a)(this,"resultAmp",ZF,this),Object(f.a)(this,"resultFwhm",JF,this),Object(f.a)(this,"resultCenterError",ek,this),Object(f.a)(this,"resultAmpError",tk,this),Object(f.a)(this,"resultFwhmError",ik,this),Object(f.a)(this,"resultIntegral",nk,this),Object(f.a)(this,"resultIntegralError",rk,this),Object(f.a)(this,"setCenter",ok,this),Object(f.a)(this,"setAmp",sk,this),Object(f.a)(this,"setFwhm",ak,this),Object(f.a)(this,"setLockedCenter",lk,this),Object(f.a)(this,"setLockedAmp",ck,this),Object(f.a)(this,"setLockedFwhm",dk,this),Object(f.a)(this,"setResultCenter",pk,this),Object(f.a)(this,"setResultAmp",hk,this),Object(f.a)(this,"setResultFwhm",uk,this),Object(f.a)(this,"setResultCenterError",gk,this),Object(f.a)(this,"setResultAmpError",fk,this),Object(f.a)(this,"setResultFwhmError",bk,this),Object(f.a)(this,"setResultIntegral",mk,this),Object(f.a)(this,"setResultIntegralError",yk,this),Object(m.p)(this),this.center=0,this.amp=0,this.fwhm=0,this.lockedCenter=!1,this.lockedAmp=!1,this.lockedFwhm=!1}},HF=Object(b.a)(qF.prototype,"center",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YF=Object(b.a)(qF.prototype,"amp",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),UF=Object(b.a)(qF.prototype,"fwhm",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),XF=Object(b.a)(qF.prototype,"lockedCenter",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$F=Object(b.a)(qF.prototype,"lockedAmp",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KF=Object(b.a)(qF.prototype,"lockedFwhm",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QF=Object(b.a)(qF.prototype,"resultCenter",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZF=Object(b.a)(qF.prototype,"resultAmp",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JF=Object(b.a)(qF.prototype,"resultFwhm",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ek=Object(b.a)(qF.prototype,"resultCenterError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tk=Object(b.a)(qF.prototype,"resultAmpError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ik=Object(b.a)(qF.prototype,"resultFwhmError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nk=Object(b.a)(qF.prototype,"resultIntegral",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rk=Object(b.a)(qF.prototype,"resultIntegralError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(qF.prototype,"isReadyToFit",[m.i],Object.getOwnPropertyDescriptor(qF.prototype,"isReadyToFit"),qF.prototype),ok=Object(b.a)(qF.prototype,"setCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.center=e}}}),sk=Object(b.a)(qF.prototype,"setAmp",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.amp=e}}}),ak=Object(b.a)(qF.prototype,"setFwhm",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fwhm=e}}}),lk=Object(b.a)(qF.prototype,"setLockedCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lockedCenter=e}}}),ck=Object(b.a)(qF.prototype,"setLockedAmp",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lockedAmp=e}}}),dk=Object(b.a)(qF.prototype,"setLockedFwhm",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lockedFwhm=e}}}),pk=Object(b.a)(qF.prototype,"setResultCenter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultCenter=e}}}),hk=Object(b.a)(qF.prototype,"setResultAmp",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultAmp=e}}}),uk=Object(b.a)(qF.prototype,"setResultFwhm",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultFwhm=e}}}),gk=Object(b.a)(qF.prototype,"setResultCenterError",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultCenterError=e}}}),fk=Object(b.a)(qF.prototype,"setResultAmpError",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultAmpError=e}}}),bk=Object(b.a)(qF.prototype,"setResultFwhmError",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultFwhmError=e}}}),mk=Object(b.a)(qF.prototype,"setResultIntegral",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultIntegral=e}}}),yk=Object(b.a)(qF.prototype,"setResultIntegralError",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.resultIntegralError=e}}}),qF);const xk=[{name:"01. Basics",section:"Tutorial",code:'// 01. Basics\n\n// Code snippets are regular ES6-based JavaScript (JS) code blocks\n// Any valid JS should work.\n// Lines starting with "//" are treated as comments.\n/* you can also comment in \n* multiple lines using C-style comments\n*/\n\n// To log to the development console, use console.log\nconsole.log("hello world");\n\n// Variables can be defined using let/const\nlet x = 1;\nconst y = "hello world";\nx += 15;'},{name:"02. Functions",section:"Tutorial",code:'// 02. Functions\n\n// Functions can be defined in a number of ways\nfunction squared (x) {\n    return x * x;\n}\n\nconst cubed = (x) => x * x * x;\n\nconst sqrt = (x) => {\n    // You can use and builtin JS library functions\n    return Math.sqrt(x);\n}\n\n// Functions can also be asynchronous. \n// Any functions that wait for user input or interact with the\n// backend will be asynchronous\nfunction delay(time) {\n    return new Promise((resolve, reject) => {\n        if (time < 0) {\n            reject("Invalid delay duration");\n        } else {\n            setTimeout(resolve, time);\n        }\n    });\n}\n\n// You can "await" asynchronous functions within another async function,\n// or at the top level\nasync function pauseForOneSecond() {\n    await delay(1000);\n    return true;\n}\n\n// Awaiting is necessary to ensure that return values can be used correctly.\n// Compare the following outputs:\nconsole.log("Awaiting properly:"); \nconst resultWithAwait = await pauseForOneSecond();\nconsole.log(resultWithAwait);\nconsole.log();\n\nconsole.log("No await:");\nconst resultWithoutAwait = pauseForOneSecond();\nconsole.log(resultWithoutAwait);\nconsole.log();\n\n// Asynchronous functions can also be used with promise syntax:\ndelay(100).then(() => console.log("Looks promising"));\ndelay(-100).catch(err => console.log(err));\n\n// Notice that the response to the first "delay" call is printed after\n// the second one, because execution is non-blocking'},{name:"03. Loading images",section:"Tutorial",code:'// 03. Loading images\n\n// CARTA functions and objects can be accessed via the top-level "app" object\n// (or the "carta" alias).\ncarta.showSplashScreen();\nawait carta.delay(1000);\napp.hideSplashScreen();\n\n// Images in the frontend are referred to as frames. Each frame is represented\n// by a FrameStore object, accessible via the array "frames". The currently\n// active frame is accessible at "activeFrame".\nconsole.log(app.frames);\nconsole.log(app.activeFrame);\n\n// "openFile" takes up to three arguments: directory, filename and HDU\n// If no HDU is provided, the first HDU is provided. The directory and filename can\n// also be combined into a single argument. "openFile" must be called with "await",\n// as it is an asynchronous function that requires communicating with the backend.\nawait app.openFile("test_directory", "testfile.fits", "0");\nawait app.openFile("test_directory", "testfile.fits");\nawait app.openFile("test_directory/testfile.fits");\n\n// Additional images can be appended using "appendFile". The arguments are the\n// same as "openFile".\nconst file1 = await app.openFile("testfile1.fits");\nconst file2 = await app.appendFile("testfile2.fits");\nconst file3 = await app.appendFile("testfile3.fits");\n\n// The active image can be changed with "setActiveImage", as well as the wrapper\n// functions "setActiveImageById" and "setActiveImageByIndex".\napp.setActiveFrameByIndex(0);\napp.setActiveFrameById(file2.frameInfo.fileId);\napp.setActiveFrame(file3);\n\n// "closeCurrentFile" closes the active image.\napp.closeCurrentFile();\n\n// "closeFile" takes an optional argument controlling whether user confirmation is\n// required if other images are matched to the given file. This defaults to true.\n// "await" is required to delay execution until the user confirms.\nawait app.closeFile(file1);\n\n// "closeOtherFiles" closes all images other than the given file.\napp.closeOtherFiles(file2);'}];var Sk,vk,Ck,Ik,wk,Tk,Rk,Ak,Pk,Ek,Mk,Fk,kk,Dk,Lk;let Nk=(Lk=Dk=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(f.a)(this,"snippets",vk,this),Object(f.a)(this,"activeSnippet",Ck,this),Object(f.a)(this,"activeSnippetName",Ik,this),Object(f.a)(this,"isExecuting",wk,this),this.snippetExists=e=>e&&this.snippets.has(e),Object(f.a)(this,"setDefaultSnippets",Tk,this),Object(f.a)(this,"fetchSnippets",Rk,this),Object(f.a)(this,"setActiveSnippet",Ak,this),Object(f.a)(this,"clearActiveSnippet",Pk,this),Object(f.a)(this,"setSnippetString",Ek,this),Object(f.a)(this,"saveSnippet",Mk,this),Object(f.a)(this,"deleteSnippet",Fk,this),Object(f.a)(this,"setSnippetExecuting",kk,this),Object(m.p)(this),this.setDefaultSnippets(),this.clearActiveSnippet(),this.isExecuting=!1}get numSavedSnippets(){return this.snippets.size}get validInput(){return void 0!==this.functionToExecute}get functionToExecute(){const e=Object.getPrototypeOf((async function(){})).constructor;if(this.activeSnippet&&e){let i;try{i=new e(this.activeSnippet.code)}catch(t){i=void 0}return i}}async executeCurrentSnippet(){if(!this.functionToExecute||this.isExecuting)return!1;this.setSnippetExecuting(!0);try{var e;await this.functionToExecute(),this.setSnippetExecuting(!1);const t={snippetVersion:1,frontendVersion:"v2.0.0",tags:["previous"],categories:["hidden"],requires:[],code:null===(e=this.activeSnippet)||void 0===e?void 0:e.code};return await this.saveSnippet("_previous",t,!0),!0}catch(t){return this.setSnippetExecuting(!1),console.warn(t),!1}}},Dk.staticInstance=void 0,Dk.ToasterTimeout=1500,Sk=Lk,vk=Object(b.a)(Sk.prototype,"snippets",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ck=Object(b.a)(Sk.prototype,"activeSnippet",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ik=Object(b.a)(Sk.prototype,"activeSnippetName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wk=Object(b.a)(Sk.prototype,"isExecuting",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tk=Object(b.a)(Sk.prototype,"setDefaultSnippets",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.snippets||(this.snippets=new Map),this.snippets.clear();for(const e of xk){let t="Examples";e.section&&(t+=`/${e.section}`);const i={tags:["example"],categories:[t],code:e.code,frontendVersion:vn.FrontendVersion,snippetVersion:vn.SnippetVersion};this.snippets.set(e.name,i)}}}}),Rk=Object(b.a)(Sk.prototype,"fetchSnippets",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{this.setDefaultSnippets();try{const e=await pj.Instance.getSnippets();Object(m.t)((()=>{for(const[i,n]of e)this.snippets.set(i,n);const t=this.snippets.get("_previous");t&&this.setActiveSnippet(t,"")}))}catch(e){Bx.Instance.showAlert("Loading user-defined snippets failed!"),console.log(e)}}}}),Object(b.a)(Sk.prototype,"numSavedSnippets",[m.i],Object.getOwnPropertyDescriptor(Sk.prototype,"numSavedSnippets"),Sk.prototype),Object(b.a)(Sk.prototype,"validInput",[m.i],Object.getOwnPropertyDescriptor(Sk.prototype,"validInput"),Sk.prototype),Object(b.a)(Sk.prototype,"functionToExecute",[m.i],Object.getOwnPropertyDescriptor(Sk.prototype,"functionToExecute"),Sk.prototype),Ak=Object(b.a)(Sk.prototype,"setActiveSnippet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i;this.activeSnippet={...e},this.activeSnippet.categories||(this.activeSnippet.categories=[]),this.activeSnippet.categories=this.activeSnippet.categories.filter((e=>"hidden"!==e)),(null===(i=e.tags)||void 0===i?void 0:i.includes("example"))?this.activeSnippetName="":this.activeSnippetName=t}}}),Pk=Object(b.a)(Sk.prototype,"clearActiveSnippet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.activeSnippet={code:"",frontendVersion:vn.FrontendVersion,snippetVersion:vn.FrontendVersion,categories:[]},this.activeSnippetName=""}}}),Ek=Object(b.a)(Sk.prototype,"setSnippetString",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.activeSnippet||this.clearActiveSnippet(),this.activeSnippet.code=e}}}),Mk=Object(b.a)(Sk.prototype,"saveSnippet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t,i=!1)=>{this.snippets.set(e,t);try{return await pj.Instance.setSnippet(e,t)?(i||v.show(C("console",`Snippet ${e} saved successfully.`,Nk.ToasterTimeout)),!0):(Bx.Instance.showAlert(`Saving snippet ${e} failed!`),!1)}catch(n){return Bx.Instance.showAlert(`Saving snippet ${e} failed!`),!1}}}}),Fk=Object(b.a)(Sk.prototype,"deleteSnippet",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t=!1)=>{this.snippets.delete(e);try{return await pj.Instance.clearSnippet(e)?(t||v.show(C("console",`Snippet ${e} deleted successfully.`,Nk.ToasterTimeout)),!0):(Bx.Instance.showAlert(`Deleting snippet ${e} failed!`),!1)}catch(i){return Bx.Instance.showAlert(`Deleting snippet ${e} failed!`),!1}}}}),kk=Object(b.a)(Sk.prototype,"setSnippetExecuting",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isExecuting=e}}}),Sk);var _k,zk,Vk,Wk,Gk,Bk,qk,Hk,Yk;let Uk=(Yk=Hk=class e extends $n{constructor(e,t,i,n){super(n,i),Object(f.a)(this,"catalogInfo",zk,this),Object(f.a)(this,"catalogHeader",Vk,this),Object(f.a)(this,"catalogControlHeader",Wk,this),Object(f.a)(this,"numVisibleRows",Gk,this),Object(f.a)(this,"filterColumnData",Bk,this),Object(f.a)(this,"resetCatalogFilterRequest",qk,this),Object(m.p)(this),this.catalogInfo=e,this.catalogHeader=t.sort(((e,t)=>e.columnIndex-t.columnIndex)),this.catalogControlHeader=this.initCatalogControlHeader,this.numVisibleRows=e.dataSize;const r=e.fileInfo.coosys[0],o=$n.getCatalogSystem(r.system);this.catalogCoordinateSystem={system:o,equinox:null,epoch:null,coordinate:this.systemCoordinateMap.get(o)},this.initSortedIndexMap(),this.initFilterIndexMap()}get updateRequestDataSize(){return this.catalogFilterRequest}get shouldUpdateData(){return!1}get loadOntoImage(){return this.loadingData}get maxRows(){return this.numVisibleRows}get initCatalogControlHeader(){const t=new Map,i=this.catalogHeader;if(i.length)for(let n=0;n<i.length;n++){const r=i[n];let o=!1;(this.catalogType===Hn.SIMBAD&&e.SimbadInitialedColumnsKeyWords.includes(r.name)||this.catalogType===Hn.VIZIER&&(e.VizierInitialedColumnsKeyWords.includes(r.name)||n<JA.Instance.catalogDisplayedColumnSize))&&(o=!0);let s={columnIndex:r.columnIndex,dataIndex:n,display:o,filter:"",columnWidth:null};t.set(r.name,s)}return t}setSortingInfo(e,t){this.sortingInfo={columnName:e,sortingType:t},this.updateSortedIndexMap()}updateSortedIndexMap(){var e;const t=null===(e=this.catalogControlHeader.get(this.sortingInfo.columnName))||void 0===e?void 0:e.dataIndex;if(t>=0){let e=0;const i=this.sortingInfo.sortingType;if(0===i?e=1:1===i&&(e=-1),0===e&&0===this.getUserFilters().length)return void this.initSortedIndexMap();let n=this.catalogData.get(t);switch(this.hasFilter&&this.initSortedIndexMap(),null===n||void 0===n?void 0:n.dataType){case Nt.ColumnType.String:this.sortedIndexMap.sort(((t,i)=>{const r=String(n.data[t]),o=String(n.data[i]);return r?o?e*r.localeCompare(o):1*e:-1*e}));break;case Nt.ColumnType.UnsupportedType:console.log("Data type is not supported");break;default:this.sortedIndexMap.sort(((t,i)=>{const r=Number(n.data[t]),o=Number(n.data[i]);return e*(r<o?-1:1)}))}}}initSortedIndexMap(){this.sortedIndexMap=[];for(let e=0;e<this.numVisibleRows;e++)this.sortedIndexMap.push(e)}initFilterIndexMap(){this.filterIndexMap=[];for(let e=0;e<this.catalogInfo.dataSize;e++)this.filterIndexMap.push(e)}resetFilterRequest(e){this.initFilterIndexMap(),e.forEach((e=>{const t=this.catalogControlHeader.get(e.columnName),i=t.dataIndex;if(i>-1&&t.display){const t=this.catalogOriginalData.get(i);switch(t.dataType){case Nt.ColumnType.String:const i=t.data;""!==e.subString&&(this.filterIndexMap=this.filterIndexMap.filter((t=>{var n;return null===(n=i[t])||void 0===n?void 0:n.includes(e.subString)})));break;default:const n=t.data;this.filterIndexMap=this.filterColumnData(n,e)}}})),this.numVisibleRows=this.filterIndexMap.length,null!==this.sortingInfo.columnName&&null!==this.sortingInfo.sortingType&&this.updateSortedIndexMap()}setMaxRows(e){this.numVisibleRows=e}updateCatalogData(e,t){console.log(e,t)}},Hk.SimbadInitialedColumnsKeyWords=["ra","dec","main_id","coo_bibcode","dist","otype_txt"],Hk.VizierInitialedColumnsKeyWords=["_r","_RAJ2000","_DEJ2000"],_k=Yk,zk=Object(b.a)(_k.prototype,"catalogInfo",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vk=Object(b.a)(_k.prototype,"catalogHeader",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wk=Object(b.a)(_k.prototype,"catalogControlHeader",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gk=Object(b.a)(_k.prototype,"numVisibleRows",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(_k.prototype,"initCatalogControlHeader",[m.i],Object.getOwnPropertyDescriptor(_k.prototype,"initCatalogControlHeader"),_k.prototype),Object(b.a)(_k.prototype,"setSortingInfo",[m.g],Object.getOwnPropertyDescriptor(_k.prototype,"setSortingInfo"),_k.prototype),Object(b.a)(_k.prototype,"updateSortedIndexMap",[m.g],Object.getOwnPropertyDescriptor(_k.prototype,"updateSortedIndexMap"),_k.prototype),Object(b.a)(_k.prototype,"initSortedIndexMap",[m.g],Object.getOwnPropertyDescriptor(_k.prototype,"initSortedIndexMap"),_k.prototype),Object(b.a)(_k.prototype,"initFilterIndexMap",[m.g],Object.getOwnPropertyDescriptor(_k.prototype,"initFilterIndexMap"),_k.prototype),Object(b.a)(_k.prototype,"resetFilterRequest",[m.g],Object.getOwnPropertyDescriptor(_k.prototype,"resetFilterRequest"),_k.prototype),Bk=Object(b.a)(_k.prototype,"filterColumnData",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{switch(t.comparisonOperator){case Nt.ComparisonOperator.Equal:return this.filterIndexMap.filter((i=>e[i]===t.value));case Nt.ComparisonOperator.NotEqual:return this.filterIndexMap.filter((i=>e[i]!==t.value));case Nt.ComparisonOperator.Lesser:return this.filterIndexMap.filter((i=>e[i]<t.value));case Nt.ComparisonOperator.LessorOrEqual:return this.filterIndexMap.filter((i=>e[i]<=t.value));case Nt.ComparisonOperator.Greater:return this.filterIndexMap.filter((i=>e[i]>t.value));case Nt.ComparisonOperator.GreaterOrEqual:return this.filterIndexMap.filter((i=>e[i]>=t.value));case Nt.ComparisonOperator.RangeOpen:return this.filterIndexMap.filter((i=>e[i]>t.value&&e[i]<t.secondaryValue));case Nt.ComparisonOperator.RangeClosed:return this.filterIndexMap.filter((i=>e[i]>=t.value&&e[i]<=t.secondaryValue));default:return[]}}}}),qk=Object(b.a)(_k.prototype,"resetCatalogFilterRequest",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.numVisibleRows=this.catalogInfo.dataSize,this.initSortedIndexMap(),this.initFilterIndexMap(),this.resetUserFilters(),this.sortingInfo.columnName=null,this.sortingInfo.sortingType=null}}}),Object(b.a)(_k.prototype,"setMaxRows",[m.g],Object.getOwnPropertyDescriptor(_k.prototype,"setMaxRows"),_k.prototype),_k);var Xk,$k,Kk,Qk,Zk,Jk,eD,tD,iD,nD,rD,oD,sD,aD,lD,cD,dD;let pD;!function(e){e.DEGREES="deg",e.ARCMINUTES="arcmin",e.ARCSECONDS="arcsec"}(pD||(pD={}));let hD=(dD=cD=class e{constructor(){Object(f.a)(this,"isQuerying",$k,this),Object(f.a)(this,"catalogDB",Kk,this),Object(f.a)(this,"searchRadius",Qk,this),Object(f.a)(this,"coordsType",Zk,this),Object(f.a)(this,"coordsFormat",Jk,this),Object(f.a)(this,"centerPixelCoord",eD,this),Object(f.a)(this,"maxObject",tD,this),Object(f.a)(this,"enablePointSelection",iD,this),Object(f.a)(this,"radiusUnits",nD,this),Object(f.a)(this,"objectName",rD,this),Object(f.a)(this,"isObjectQuerying",oD,this),Object(f.a)(this,"vizierResource",sD,this),Object(f.a)(this,"vizierSelectedTableName",aD,this),Object(f.a)(this,"vizierKeyWords",lD,this),Object(m.p)(this),this.isQuerying=!1,this.catalogDB=wx.SIMBAD,this.searchRadius=1,this.coordsType=Yn.ICRS,this.centerPixelCoord={x:void 0,y:void 0},this.maxObject=e.OBJECT_SIZE,this.enablePointSelection=!1,this.radiusUnits=pD.DEGREES,this.coordsFormat=iA.Degrees,this.objectName="",this.isObjectQuerying=!1,this.vizierSelectedTableName=[],this.vizierResource=new Map,this.vizierKeyWords="",Object(m.s)((()=>gC.Instance.activeFrame),(()=>{this.resetSearchRadius()})),Object(m.s)((()=>gC.Instance.cursorFrozen),(e=>{var t;const i=this.activeFrame;e&&(null===i||void 0===i||null===(t=i.cursorInfo)||void 0===t?void 0:t.posImageSpace)&&(this.updateCenterPixelCoord(i.cursorInfo.posImageSpace),this.resetObjectName())}))}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}setFrameCenter(){const e=this.activeFrame;(null===e||void 0===e?void 0:e.center)&&(this.updateCenterPixelCoord(e.center),this.resetObjectName())}setVizierKeyWords(e){this.vizierKeyWords=e}setVizierQueryResult(e){this.vizierResource=e}updateVizierSelectedTable(e){this.vizierSelectedTableName.includes(e)||this.vizierSelectedTableName.push(e)}removeVizierSelectedTable(e){this.vizierSelectedTableName=this.vizierSelectedTableName.filter((t=>e!==t.name))}resetVizierSelectedTable(){this.vizierSelectedTableName=[]}resetVizier(){this.vizierResource.clear(),this.resetVizierSelectedTable()}setQueryStatus(e){this.isQuerying=e}setCatalogDB(e){this.catalogDB=e}setSearchRadius(e){this.searchRadius=e}setCoordsType(e){this.coordsType=e}updateCenterPixelCoord(e){this.centerPixelCoord.x=e.x.toString(),this.centerPixelCoord.y=e.y.toString()}setMaxObjects(e){this.maxObject=e}resetMaxObjects(){this.maxObject=e.OBJECT_SIZE}setPointSelection(){this.enablePointSelection=!this.enablePointSelection}setRadiusUnits(e){switch(e){case pD.ARCMINUTES:this.setSearchRadius(this.radiusAsArcm);break;case pD.ARCSECONDS:this.setSearchRadius(this.radiusAsArcs);break;default:this.setSearchRadius(this.radiusAsDeg)}this.radiusUnits=e}setCoordsFormat(e){this.coordsFormat=e}setObjectName(e){this.objectName=e}resetObjectName(){this.objectName=""}setObjectQueryStatus(e){this.isObjectQuerying=e}resetSearchRadius(){let e=this.searchRadiusInDegree;switch(this.radiusUnits){case pD.ARCMINUTES:e*=60;break;case pD.ARCSECONDS:e*=3600}this.setSearchRadius(e),this.setFrameCenter()}get radiusAsDeg(){let e=this.searchRadius;switch(this.radiusUnits){case pD.ARCMINUTES:e*=1/60;break;case pD.ARCSECONDS:e*=1/3600}return Number(e.toPrecision(6))}get radiusAsArcm(){let e=this.searchRadius;switch(this.radiusUnits){case pD.DEGREES:e*=60;break;case pD.ARCSECONDS:e*=1/60}return Number(e.toPrecision(6))}get radiusAsArcs(){let e=this.searchRadius;switch(this.radiusUnits){case pD.ARCMINUTES:e*=60;break;case pD.DEGREES:e*=3600}return Number(e.toPrecision(6))}get maxRadius(){switch(this.radiusUnits){case pD.ARCMINUTES:return 5400;case pD.ARCSECONDS:return 324e3;default:return 90}}get disableObjectSearch(){return""===this.objectName}get searchRadiusInDegree(){const e=this.activeFrame;if(e){const t=e.requiredFrameView,i=this.calculateDistanceFromPixelCoord({x:t.xMax,y:t.yMax},{x:t.xMin,y:t.yMin},!0),n=this.calculateDistanceFromPixelCoord({x:t.xMin,y:t.yMax},{x:t.xMax,y:t.yMin},!0),r=this.calculateDistanceFromPixelCoord({x:t.xMax,y:t.yMax},{x:t.xMin,y:t.yMin},!1),o=Math.max(i,n,r);return isNaN(o)?90:Gi(o/2,0,90)}return 90}get centerPixelCoordAsPoint2D(){return{x:Number(this.centerPixelCoord.x),y:Number(this.centerPixelCoord.y)}}get activeFrame(){var e,t,i;return null!==(e=null===(t=gC.Instance)||void 0===t||null===(i=t.activeFrame)||void 0===i?void 0:i.spatialReference)&&void 0!==e?e:gC.Instance.activeFrame}get showVizierResult(){return 0!==this.vizierResource.size&&this.catalogDB===wx.VIZIER}get selectedVizierSource(){const e=[];return this.vizierSelectedTableName.forEach((t=>e.push(this.vizierResource.get(t.name)))),e}get enableLoadVizier(){return this.vizierSelectedTableName.length>0&&this.showVizierResult}get vizierTable(){const e=[];return this.vizierResource.forEach((t=>{e.push({name:t.table.name,description:t.description})})),e}convertToDeg(e,t){const i=this.activeFrame,n=bA.Instance;let r={x:void 0,y:void 0};if(i&&n){const o=n.numbers.customPrecision?n.numbers.precision:"*",s=`${iA.Degrees}.${o}`,a=Pt.copy(i.wcsInfo);let l=new oA;const c=t||(n.global.explicitSystem?n.global.explicitSystem:tA.ICRS);Pt.set(a,`System=${c}`),l.add("Format(1)",s),l.add("Format(2)",s);const d=Mm(a,e),p=Pt.normalizeCoordinates(a,d.x,d.y);r=Pt.getFormattedCoordinates(a,p.x,p.y,l.toString(),!0),Pt.deleteObject(a)}return r}convertToPixel(e){const t=this.activeFrame,i=bA.Instance;let n={x:void 0,y:void 0};if(t&&i){const r=i.numbers.customPrecision?i.numbers.precision:"*",o=`${iA.Degrees}.${r}`,s=Pt.copy(t.wcsInfo);Pt.set(s,`System=${tA.ICRS}`),Pt.set(s,`Format(1)=${o}`),Pt.set(s,`Format(2)=${o}`),n=Dm(s,{x:e.x.toString(),y:e.y.toString()}),Pt.deleteObject(s)}return n}calculateDistanceFromPixelCoord(e,t,i){const n=this.convertToDeg(e),r=this.convertToDeg(t),o=Number(n.x)-Number(r.x),s=Number(n.y)-Number(r.y);return i?Math.sqrt(o*o+s*s):Math.abs(o)>Math.abs(s)?Math.abs(o):Math.abs(s)}},cD.staticInstance=void 0,cD.MIN_OBJECTS=1,cD.MAX_OBJECTS=1e7,cD.OBJECT_SIZE=1e3,Xk=dD,$k=Object(b.a)(Xk.prototype,"isQuerying",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kk=Object(b.a)(Xk.prototype,"catalogDB",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qk=Object(b.a)(Xk.prototype,"searchRadius",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zk=Object(b.a)(Xk.prototype,"coordsType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jk=Object(b.a)(Xk.prototype,"coordsFormat",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eD=Object(b.a)(Xk.prototype,"centerPixelCoord",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tD=Object(b.a)(Xk.prototype,"maxObject",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iD=Object(b.a)(Xk.prototype,"enablePointSelection",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nD=Object(b.a)(Xk.prototype,"radiusUnits",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rD=Object(b.a)(Xk.prototype,"objectName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oD=Object(b.a)(Xk.prototype,"isObjectQuerying",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sD=Object(b.a)(Xk.prototype,"vizierResource",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aD=Object(b.a)(Xk.prototype,"vizierSelectedTableName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lD=Object(b.a)(Xk.prototype,"vizierKeyWords",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Xk.prototype,"setVizierKeyWords",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setVizierKeyWords"),Xk.prototype),Object(b.a)(Xk.prototype,"setVizierQueryResult",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setVizierQueryResult"),Xk.prototype),Object(b.a)(Xk.prototype,"updateVizierSelectedTable",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"updateVizierSelectedTable"),Xk.prototype),Object(b.a)(Xk.prototype,"removeVizierSelectedTable",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"removeVizierSelectedTable"),Xk.prototype),Object(b.a)(Xk.prototype,"resetVizierSelectedTable",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"resetVizierSelectedTable"),Xk.prototype),Object(b.a)(Xk.prototype,"resetVizier",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"resetVizier"),Xk.prototype),Object(b.a)(Xk.prototype,"setQueryStatus",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setQueryStatus"),Xk.prototype),Object(b.a)(Xk.prototype,"setCatalogDB",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setCatalogDB"),Xk.prototype),Object(b.a)(Xk.prototype,"setSearchRadius",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setSearchRadius"),Xk.prototype),Object(b.a)(Xk.prototype,"setCoordsType",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setCoordsType"),Xk.prototype),Object(b.a)(Xk.prototype,"updateCenterPixelCoord",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"updateCenterPixelCoord"),Xk.prototype),Object(b.a)(Xk.prototype,"setMaxObjects",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setMaxObjects"),Xk.prototype),Object(b.a)(Xk.prototype,"resetMaxObjects",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"resetMaxObjects"),Xk.prototype),Object(b.a)(Xk.prototype,"setPointSelection",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setPointSelection"),Xk.prototype),Object(b.a)(Xk.prototype,"setRadiusUnits",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setRadiusUnits"),Xk.prototype),Object(b.a)(Xk.prototype,"setCoordsFormat",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setCoordsFormat"),Xk.prototype),Object(b.a)(Xk.prototype,"setObjectName",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setObjectName"),Xk.prototype),Object(b.a)(Xk.prototype,"resetObjectName",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"resetObjectName"),Xk.prototype),Object(b.a)(Xk.prototype,"setObjectQueryStatus",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"setObjectQueryStatus"),Xk.prototype),Object(b.a)(Xk.prototype,"resetSearchRadius",[m.g],Object.getOwnPropertyDescriptor(Xk.prototype,"resetSearchRadius"),Xk.prototype),Object(b.a)(Xk.prototype,"radiusAsDeg",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"radiusAsDeg"),Xk.prototype),Object(b.a)(Xk.prototype,"radiusAsArcm",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"radiusAsArcm"),Xk.prototype),Object(b.a)(Xk.prototype,"radiusAsArcs",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"radiusAsArcs"),Xk.prototype),Object(b.a)(Xk.prototype,"maxRadius",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"maxRadius"),Xk.prototype),Object(b.a)(Xk.prototype,"disableObjectSearch",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"disableObjectSearch"),Xk.prototype),Object(b.a)(Xk.prototype,"searchRadiusInDegree",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"searchRadiusInDegree"),Xk.prototype),Object(b.a)(Xk.prototype,"centerPixelCoordAsPoint2D",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"centerPixelCoordAsPoint2D"),Xk.prototype),Object(b.a)(Xk.prototype,"activeFrame",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"activeFrame"),Xk.prototype),Object(b.a)(Xk.prototype,"showVizierResult",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"showVizierResult"),Xk.prototype),Object(b.a)(Xk.prototype,"selectedVizierSource",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"selectedVizierSource"),Xk.prototype),Object(b.a)(Xk.prototype,"enableLoadVizier",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"enableLoadVizier"),Xk.prototype),Object(b.a)(Xk.prototype,"vizierTable",[m.i],Object.getOwnPropertyDescriptor(Xk.prototype,"vizierTable"),Xk.prototype),Xk);var uD,gD,fD,bD,mD,yD,OD,jD,xD,SD,vD,CD,ID,wD,TD,RD,AD,PD,ED,MD,FD,kD,DD,LD;let ND=(ID=CD=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get frameOptions(){var e;return[{value:Gr,label:"Active"},...null!==(e=gC.Instance.frameNames)&&void 0!==e?e:[]]}get effectiveFrame(){var e;const t=gC.Instance;var i;return t.activeFrame&&(null===(e=t.frames)||void 0===e?void 0:e.length)>0?this.selectedFileId===Gr?t.activeFrame:null!==(i=t.getFrame(this.selectedFileId))&&void 0!==i?i:t.activeFrame:null}get fitDisabled(){var e,t,i;const n=(null===(e=this.effectiveFrame)||void 0===e?void 0:e.frameInfo)&&(null===(t=this.effectiveFrame)||void 0===t||null===(i=t.frameInfo)||void 0===i?void 0:i.fileId)>=0,r=this.components.every((e=>!0===e.validParams));return!(n&&r)||this.isFitting}constructor(){Object(f.a)(this,"selectedFileId",gD,this),Object(f.a)(this,"components",fD,this),Object(f.a)(this,"selectedComponentIndex",bD,this),Object(f.a)(this,"isFitting",mD,this),Object(f.a)(this,"setSelectedFileId",yD,this),Object(f.a)(this,"setComponents",OD,this),Object(f.a)(this,"clearComponents",jD,this),Object(f.a)(this,"deleteSelectedComponent",xD,this),Object(f.a)(this,"setSelectedComponentIndex",SD,this),Object(f.a)(this,"setIsFitting",vD,this),this.fitImage=()=>{if(this.fitDisabled)return;this.setIsFitting(!0);const e=[];for(const i of this.components)e.push({center:i.center,amp:i.amplitude,fwhm:i.fwhm,pa:i.pa});const t={fileId:this.effectiveFrame.frameInfo.fileId,initialValues:e,fixedParams:[]};gC.Instance.requestFitting(t)},this.setResultString=(e,t,i)=>{var n,r;const o=this.effectiveFrame;if(!o||!e||!t)return;let s="";i+="\n";const a=(e,t,i,n)=>`${e} = ${"string"===typeof t?t:null===t||void 0===t?void 0:t.toFixed(6)} +/- ${null===i||void 0===i?void 0:i.toFixed(6)}${n?` (${n})`:""}\n`,l=(e,t,i,n)=>`${e} = ${"string"===typeof t?t:gi(t,12)} +/- ${gi(i,12)}${n?` (${n})`:""}\n`,c=(null===(n=gC.Instance.overlayStore.numbers)||void 0===n?void 0:n.formatTypeX)===iA.Degrees,d=(null===(r=gC.Instance.overlayStore.numbers)||void 0===r?void 0:r.formatTypeY)===iA.Degrees;for(let D=0;D<e.length;D++){const n=e[D],r=t[D];if(n&&r){if(s+=`Component #${D+1}:\n`,i+=`Component #${D+1}:\n`,o.wcsInfoForTransformation&&o.pixelUnitSizeArcsec){var p,h,u,g,f,b,m,y;const e=km(o.wcsInfoForTransformation,n.center);c&&(e.x+=" (deg)"),d&&(e.y+=" (deg)");const t=o.getWcsSizeInArcsec(r.center),O=o.getWcsSizeInArcsec(n.fwhm),j=o.getWcsSizeInArcsec(r.fwhm);s+=a("Center X ",null===e||void 0===e?void 0:e.x,null===t||void 0===t?void 0:t.x,"arcsec"),s+=a("Center Y ",null===e||void 0===e?void 0:e.y,null===t||void 0===t?void 0:t.y,"arcsec"),s+=a("Amplitude",n.amp,r.amp,o.requiredUnit),s+=a("FWHM X   ",null===O||void 0===O?void 0:O.x,null===j||void 0===j?void 0:j.x,"arcsec"),s+=a("FWHM Y   ",null===O||void 0===O?void 0:O.y,j.y,"arcsec"),s+=a("P.A.     ",n.pa,r.pa,"deg"),i+=l("Center X ",null===e||void 0===e?void 0:e.x,null===t||void 0===t?void 0:t.x,"arcsec"),i+=l("         ",null===(p=n.center)||void 0===p?void 0:p.x,null===(h=r.center)||void 0===h?void 0:h.x,"px"),i+=l("Center Y ",null===e||void 0===e?void 0:e.y,null===t||void 0===t?void 0:t.y,"arcsec"),i+=l("         ",null===(u=n.center)||void 0===u?void 0:u.y,null===(g=r.center)||void 0===g?void 0:g.y,"px"),i+=l("Amplitude",n.amp,r.amp,o.requiredUnit),i+=l("FWHM X   ",null===O||void 0===O?void 0:O.x,null===j||void 0===j?void 0:j.x,"arcsec"),i+=l("         ",null===(f=n.fwhm)||void 0===f?void 0:f.x,null===(b=r.fwhm)||void 0===b?void 0:b.x,"px"),i+=l("FWHM Y   ",null===O||void 0===O?void 0:O.y,j.y,"arcsec"),i+=l("         ",null===(m=n.fwhm)||void 0===m?void 0:m.y,null===(y=r.fwhm)||void 0===y?void 0:y.y,"px"),i+=l("P.A.     ",n.pa,r.pa,"deg")}else{var O,j,x,S,v,C,I,w,T,R,A,P,E,M,F,k;s+=a("Center X ",null===(O=n.center)||void 0===O?void 0:O.x,null===(j=r.center)||void 0===j?void 0:j.x,"px"),s+=a("Center Y ",null===(x=n.center)||void 0===x?void 0:x.y,null===(S=r.center)||void 0===S?void 0:S.y,"px"),s+=a("Amplitude",n.amp,r.amp,o.requiredUnit),s+=a("FWHM X   ",null===(v=n.fwhm)||void 0===v?void 0:v.x,null===(C=r.fwhm)||void 0===C?void 0:C.x,"px"),s+=a("FWHM Y   ",null===(I=n.fwhm)||void 0===I?void 0:I.y,null===(w=r.fwhm)||void 0===w?void 0:w.y,"px"),s+=a("P.A.     ",n.pa,r.pa,"deg"),i+=l("Center X ",null===(T=n.center)||void 0===T?void 0:T.x,null===(R=r.center)||void 0===R?void 0:R.x,"px"),i+=l("Center Y ",null===(A=n.center)||void 0===A?void 0:A.y,null===(P=r.center)||void 0===P?void 0:P.y,"px"),i+=l("Amplitude",n.amp,r.amp,o.requiredUnit),i+=l("FWHM X   ",null===(E=n.fwhm)||void 0===E?void 0:E.x,null===(M=r.fwhm)||void 0===M?void 0:M.x,"px"),i+=l("FWHM Y   ",null===(F=n.fwhm)||void 0===F?void 0:F.y,null===(k=r.fwhm)||void 0===k?void 0:k.y,"px"),i+=l("P.A.     ",n.pa,r.pa,"deg")}D!==e.length-1&&(s+="\n",i+="\n")}}o.setFittingResult(s),o.setFittingLog(i)},Object(m.p)(this),this.selectedFileId=Gr,this.clearComponents(),this.selectedComponentIndex=0}},CD.staticInstance=void 0,uD=ID,gD=Object(b.a)(uD.prototype,"selectedFileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fD=Object(b.a)(uD.prototype,"components",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bD=Object(b.a)(uD.prototype,"selectedComponentIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mD=Object(b.a)(uD.prototype,"isFitting",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yD=Object(b.a)(uD.prototype,"setSelectedFileId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileId=e}}}),OD=Object(b.a)(uD.prototype,"setComponents",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e>this.components.length)for(let t=this.components.length;t<e;t++)this.components.push(new _D),this.selectedComponentIndex=this.components.length-1;else e<this.components.length&&(this.components=this.components.slice(0,e),this.selectedComponentIndex>=this.components.length&&(this.selectedComponentIndex=this.components.length-1))}}}),jD=Object(b.a)(uD.prototype,"clearComponents",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.components=[new _D],this.selectedComponentIndex=0}}}),xD=Object(b.a)(uD.prototype,"deleteSelectedComponent",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.components.length>1&&(this.components.splice(this.selectedComponentIndex,1),this.selectedComponentIndex=0===this.selectedComponentIndex?0:this.selectedComponentIndex-1)}}}),SD=Object(b.a)(uD.prototype,"setSelectedComponentIndex",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedComponentIndex=e}}}),vD=Object(b.a)(uD.prototype,"setIsFitting",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isFitting=e}}}),Object(b.a)(uD.prototype,"frameOptions",[m.i],Object.getOwnPropertyDescriptor(uD.prototype,"frameOptions"),uD.prototype),Object(b.a)(uD.prototype,"effectiveFrame",[m.i],Object.getOwnPropertyDescriptor(uD.prototype,"effectiveFrame"),uD.prototype),Object(b.a)(uD.prototype,"fitDisabled",[m.i],Object.getOwnPropertyDescriptor(uD.prototype,"fitDisabled"),uD.prototype),uD),_D=(wD=class{constructor(){Object(f.a)(this,"center",TD,this),Object(f.a)(this,"amplitude",RD,this),Object(f.a)(this,"fwhm",AD,this),Object(f.a)(this,"pa",PD,this),Object(f.a)(this,"setCenterX",ED,this),Object(f.a)(this,"setCenterY",MD,this),Object(f.a)(this,"setAmplitude",FD,this),Object(f.a)(this,"setFwhmX",kD,this),Object(f.a)(this,"setFwhmY",DD,this),Object(f.a)(this,"setPa",LD,this),Object(m.p)(this),this.center={x:NaN,y:NaN},this.amplitude=NaN,this.fwhm={x:NaN,y:NaN},this.pa=NaN}get validParams(){var e,t,i,n;return isFinite(null===(e=this.center)||void 0===e?void 0:e.x)&&isFinite(null===(t=this.center)||void 0===t?void 0:t.y)&&isFinite(this.amplitude)&&isFinite(null===(i=this.fwhm)||void 0===i?void 0:i.x)&&isFinite(null===(n=this.fwhm)||void 0===n?void 0:n.y)&&isFinite(this.pa)}},TD=Object(b.a)(wD.prototype,"center",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RD=Object(b.a)(wD.prototype,"amplitude",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),AD=Object(b.a)(wD.prototype,"fwhm",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),PD=Object(b.a)(wD.prototype,"pa",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ED=Object(b.a)(wD.prototype,"setCenterX",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.center.x=e}}}),MD=Object(b.a)(wD.prototype,"setCenterY",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.center.y=e}}}),FD=Object(b.a)(wD.prototype,"setAmplitude",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.amplitude=e}}}),kD=Object(b.a)(wD.prototype,"setFwhmX",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fwhm.x=e}}}),DD=Object(b.a)(wD.prototype,"setFwhmY",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fwhm.y=e}}}),LD=Object(b.a)(wD.prototype,"setPa",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.pa=e}}}),Object(b.a)(wD.prototype,"validParams",[m.i],Object.getOwnPropertyDescriptor(wD.prototype,"validParams"),wD.prototype),wD);var zD,VD,WD,GD,BD,qD,HD,YD;i(827);!function(e){e.FrameRate="Frame Rate",e.Step="Step"}(YD||(YD={}));let UD=Object(p.a)((VD=class extends n.Component{static get WIDGET_CONFIG(){return{id:"animator",type:"animator",minWidth:250,minHeight:200,defaultWidth:650,defaultHeight:200,title:"Animator",isCloseable:!0,helpType:xM.ANIMATOR}}constructor(e){super(e),Object(f.a)(this,"width",WD,this),Object(f.a)(this,"height",GD,this),Object(f.a)(this,"numericInputType",BD,this),Object(f.a)(this,"onResize",qD,this),Object(f.a)(this,"onNumericInputTypeChange",HD,this),this.onChannelChanged=e=>{const t=gC.Instance.activeFrame;t&&(e<0&&(e+=t.frameInfo.fileInfoExtended.depth),e>=t.frameInfo.fileInfoExtended.depth&&(e=0),t.setChannels(e,t.requiredStokes,!0))},this.onRangeChanged=e=>{const t=gC.Instance.activeFrame;e&&2===e.length&&t&&e[0]>=0&&e[0]<e[1]&&e[1]<t.frameInfo.fileInfoExtended.depth&&t.setAnimationRange(e)},this.onStokesChanged=e=>{const t=gC.Instance.activeFrame,i=e>=t.frameInfo.fileInfoExtended.stokes;null===t||void 0===t||t.setChannels(t.requiredChannel,i?t.polarizations[e]:e,!0)},this.onFrameChanged=e=>{const t=gC.Instance;e<0&&(e+=t.frames.length),e>=t.frames.length&&(e=0),t.setActiveFrameByIndex(e)},this.onAnimationModeChanged=e=>{const t=parseInt(e.currentTarget.value);dS.Instance.setAnimationMode(t)},this.onFirstClicked=()=>{const e=gC.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case lS.FRAME:e.setActiveFrameByIndex(0);break;case lS.CHANNEL:t.setChannels(0,t.stokes,!0);break;case lS.STOKES:t.setChannels(t.channel,0,!0)}},this.onLastClicked=()=>{const e=gC.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case lS.FRAME:e.setActiveFrameByIndex(e.frames.length-1);break;case lS.CHANNEL:t.setChannels(t.frameInfo.fileInfoExtended.depth-1,t.stokes,!0);break;case lS.STOKES:t.setChannels(t.channel,t.frameInfo.fileInfoExtended.stokes<t.polarizations.length?t.polarizations[t.polarizations.length-1]:t.frameInfo.fileInfoExtended.stokes-1,!0)}},this.onNextClicked=()=>{const e=gC.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case lS.FRAME:e.nextFrame();break;case lS.CHANNEL:t.incrementChannels(1,0);break;case lS.STOKES:t.incrementChannels(0,1)}},this.onPrevClicked=()=>{const e=gC.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case lS.FRAME:e.prevFrame();break;case lS.CHANNEL:t.incrementChannels(-1,0);break;case lS.STOKES:t.incrementChannels(0,-1)}},this.getPlayModeIcon=()=>{switch(dS.Instance.playMode){case cS.FORWARD:default:return"arrow-right";case cS.BACKWARD:return"arrow-left";case cS.BOUNCING:return"swap-horizontal";case cS.BLINK:return"exchange"}},Object(m.p)(this),this.numericInputType=YD.FrameRate}render(){const e=gC.Instance,t=e.activeFrame,i=t?t.frameInfo.fileInfoExtended.depth:0,r=t?t.frameInfo.fileInfoExtended.stokes:0,o=this.width<625,s=this.width<450;let a,l,c,p;if(e.frames.length>1){const i=e.frames.findIndex((e=>e.frameInfo.fileId===t.frameInfo.fileId));p=Object(xm.jsxs)("div",{className:"animator-slider",children:[Object(xm.jsx)(u.K,{value:lS.FRAME,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===lS.FRAME,onChange:this.onAnimationModeChanged,label:"Image"}),s&&Object(xm.jsx)(pO,{value:i,min:-1,max:e.frames.length,stepSize:1,onValueChange:this.onFrameChanged,fill:!0,disabled:e.animatorStore.animationActive}),!s&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.N,{value:i,min:0,max:e.frames.length-1,showTrackFill:!1,stepSize:1,onChange:this.onFrameChanged,disabled:e.animatorStore.animationActive}),Object(xm.jsx)("div",{className:"slider-info",children:t.filename})]})]})}if(i>1){const r=5,o=i>10?(i-1)/(r-1):1;a=Object(xm.jsxs)("div",{className:"animator-slider",children:[Object(xm.jsx)(u.K,{value:lS.CHANNEL,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===lS.CHANNEL,onChange:this.onAnimationModeChanged,label:"Channel"}),s&&Object(xm.jsx)(pO,{value:t.requiredChannel,min:-1,max:i,stepSize:1,onValueChange:this.onChannelChanged,fill:!0,disabled:e.animatorStore.animationActive}),!s&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.N,{className:"channel-slider",value:t.requiredChannel,min:0,max:i-1,labelStepSize:o,labelPrecision:0,showTrackFill:!1,onChange:this.onChannelChanged,disabled:e.animatorStore.animationActive}),Object(xm.jsx)("div",{className:"slider-info",children:Object(xm.jsx)("pre",{children:t.simpleSpectralInfo})})]})]}),l=Object(xm.jsxs)("div",{className:"animator-slider range-slider",children:[Object(xm.jsx)("div",{className:"range-label"}),!s&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.M,{value:t.animationChannelRange,min:0,max:i-1,labelStepSize:o,labelPrecision:0,onChange:this.onRangeChanged,disabled:e.animatorStore.animationActive}),Object(xm.jsx)("div",{className:"slider-info"})]})]})}r>1&&(c=Object(xm.jsxs)("div",{className:d()("animator-slider","stokes-slider",{"tiled-label":this.width<750}),children:[Object(xm.jsx)(u.K,{value:lS.STOKES,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===lS.STOKES,onChange:this.onAnimationModeChanged,label:"Polarization"}),s&&Object(xm.jsx)(pO,{value:t.requiredStokes,min:-1,max:t.frameInfo.fileInfoExtended.stokes,stepSize:1,onValueChange:this.onStokesChanged,disabled:e.animatorStore.animationActive,fill:!0}),!s&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.N,{value:t.requiredPolarizationIndex,min:0,showTrackFill:!1,max:t.polarizations.length-1,labelRenderer:e=>{var i;return isFinite(e)&&e>=0&&e<(null===t||void 0===t||null===(i=t.polarizationInfo)||void 0===i?void 0:i.length)?t.polarizationInfo[e]:`${e}`},onChange:this.onStokesChanged,disabled:e.animatorStore.animationActive}),Object(xm.jsx)("div",{className:"slider-info"})]})]}));const g=d()("animator-playback",{wrap:s}),f=d()("playback-mode",{"bp3-dark":e.darkTheme}),b=Object(xm.jsx)(O.a,{className:f,content:Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{icon:"arrow-right",text:"Play Forward",active:e.animatorStore.playMode===cS.FORWARD,onClick:()=>e.animatorStore.playMode=cS.FORWARD}),Object(xm.jsx)(u.B,{icon:"arrow-left",text:"Play Backwards",active:e.animatorStore.playMode===cS.BACKWARD,onClick:()=>e.animatorStore.playMode=cS.BACKWARD}),Object(xm.jsx)(u.B,{icon:"swap-horizontal",text:"Bouncing",active:e.animatorStore.playMode===cS.BOUNCING,onClick:()=>e.animatorStore.playMode=cS.BOUNCING}),Object(xm.jsx)(u.B,{icon:"exchange",text:"Blink",active:e.animatorStore.playMode===cS.BLINK,onClick:()=>e.animatorStore.playMode=cS.BLINK})]}),position:y.a.TOP,children:Object(xm.jsx)(j.a,{content:"Playback Mode",position:y.a.TOP,children:Object(xm.jsx)(u.b,{icon:this.getPlayModeIcon(),disabled:e.animatorStore.animationActive,children:!o&&"Mode"})})}),m=Object(xm.jsxs)(u.f,{fill:!0,className:"playback-buttons",children:[Object(xm.jsx)(u.e,{icon:"chevron-backward",onClick:this.onFirstClicked,children:!o&&"First"}),Object(xm.jsx)(u.e,{icon:"step-backward",onClick:this.onPrevClicked,children:!o&&"Prev"}),e.animatorStore.animationActive&&Object(xm.jsx)(u.e,{icon:"stop",onClick:e.animatorStore.stopAnimation,children:!o&&"Stop"}),!e.animatorStore.animationActive&&Object(xm.jsx)(u.e,{icon:"play",onClick:e.animatorStore.startAnimation,children:!o&&"Play"}),Object(xm.jsx)(u.e,{icon:"step-forward",onClick:this.onNextClicked,children:!o&&"Next"}),Object(xm.jsx)(u.e,{icon:"chevron-forward",onClick:this.onLastClicked,children:!o&&"Last"})]}),x=Object(xm.jsxs)(u.l,{className:"playback-numeric-control",children:[Object(xm.jsx)(u.r,{options:[YD.FrameRate,YD.Step],onChange:e=>this.onNumericInputTypeChange(e.currentTarget.value)}),this.numericInputType===YD.FrameRate?Object(xm.jsx)(pO,{value:e.animatorStore.frameRate,min:e.animatorStore.minFrameRate,max:e.animatorStore.maxFrameRate,stepSize:1,minorStepSize:1,majorStepSize:1,onValueChange:e.animatorStore.setFrameRate,disabled:e.animatorStore.animationActive}):Object(xm.jsx)(pO,{value:e.animatorStore.step,min:e.animatorStore.minStep,max:e.animatorStore.maxStep,stepSize:1,minorStepSize:1,majorStepSize:1,onValueChange:e.animatorStore.setStep,disabled:e.animatorStore.animationActive})]});return Object(xm.jsxs)("div",{className:"animator-widget",children:[!t&&Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),t&&Object(xm.jsxs)("div",{className:g,children:[m,b,x]}),t&&this.width>0&&Object(xm.jsxs)("div",{className:"animator-sliders",children:[p,a,l,c]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},WD=Object(b.a)(VD.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GD=Object(b.a)(VD.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BD=Object(b.a)(VD.prototype,"numericInputType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qD=Object(b.a)(VD.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),HD=Object(b.a)(VD.prototype,"onNumericInputTypeChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numericInputType=e}}}),zD=VD))||zD;var XD,$D,KD,QD,ZD;i(828);let JD=Object(p.a)(($D=class extends n.Component{static get WIDGET_CONFIG(){return{id:"cursor-info",type:"cursor-info",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Cursor Info",isCloseable:!0,helpType:xM.PLACEHOLDER}}constructor(e){super(e),this.columnWidths=[90,95,50,95,95,128,70,95],Object(f.a)(this,"width",KD,this),Object(f.a)(this,"height",QD,this),Object(f.a)(this,"onResize",ZD,this),this.onColumnWidthChanged=(e,t)=>{!Number.isInteger(e)||e<0||e>=this.columnWidths.length||t<=0||(this.columnWidths[e]=t)},this.genValueContent=e=>{var t;if(!(null===e||void 0===e||null===(t=e.cursorInfo)||void 0===t?void 0:t.isInsideImage)||void 0===(null===e||void 0===e?void 0:e.cursorValue))return"-";let i="%"===e.requiredUnit?fi(e.cursorValue.value,1):mi(e.cursorValue.value,5,"",!0,!0);return isNaN(e.cursorValue.value)&&(i="NaN"),e.isCursorValueCurrent||(i+="*"),void 0!==e.requiredUnit&&e.requiredUnit.length?Object(xm.jsxs)(n.Fragment,{children:[i,Object(xm.jsx)("br",{}),e.requiredUnit]}):i},this.genWorldCoordContent=e=>{var t;const i=null===e||void 0===e||null===(t=e.cursorInfo)||void 0===t?void 0:t.infoWCS;return i?Object(xm.jsxs)(n.Fragment,{children:[i.x,Object(xm.jsx)("br",{}),i.y]}):"-"},this.genImageCoordContent=e=>{var t,i,r,o;const s=null===e||void 0===e||null===(t=e.cursorInfo)||void 0===t||null===(i=t.posImageSpace)||void 0===i?void 0:i.x,a=null===e||void 0===e||null===(r=e.cursorInfo)||void 0===r||null===(o=r.posImageSpace)||void 0===o?void 0:o.y;return!isFinite(s)||!isFinite(a)||s===-Number.MAX_VALUE&&a===-Number.MAX_VALUE?"-":Object(xm.jsxs)(n.Fragment,{children:[fi(s,3),Object(xm.jsx)("br",{}),fi(a,3)]})},this.genZCoordContent=e=>{var t;if(null===e||void 0===e||null===(t=e.spectralInfo)||void 0===t?void 0:t.spectralString){var i;let t=[];return t.push(null===(i=e.spectralInfo.spectralString.replace(/\w+\s\(/,""))||void 0===i?void 0:i.replace(/\):\s/,"\n")),e.spectralInfo.freqString&&(t.push(Object(xm.jsx)("br",{},0)),t.push(e.spectralInfo.freqString.replace(/\w+:\s/,"\n"))),e.spectralInfo.velocityString&&(t.push(Object(xm.jsx)("br",{},1)),t.push(e.spectralInfo.velocityString.replace(/\w+:\s/,"\n"))),Object(xm.jsx)(n.Fragment,{children:t})}return"NaN"},Object(m.p)(this)}render(){var e;const t=gC.Instance,i=t.frames.length,n=null!==(e=t.hoveredFrame)&&void 0!==e?e:t.activeFrame;if(i<=0)return Object(xm.jsx)("div",{className:"region-list-widget",children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});const r=Nt.ColumnType.String,o=["Image","Value","WCS","XY (World)","XY (Image)","Z","Channel","Polarization"].map(((e,t)=>new Nt.CatalogHeader({name:e,dataType:r,columnIndex:t}))),s=t.frames.map((e=>e.filename));let a=Array(i).fill("-"),l=Array(i).fill("-"),c=Array(i).fill("-"),d=Array(i).fill("-");const p=t.frames.map((e=>this.genZCoordContent(e))),g=t.frames.map((e=>e.requiredChannel)),f=t.frames.map((e=>e.requiredPolarizationInfo)),b=(n.spatialReference?[n.spatialReference,...n.spatialReference.secondarySpatialImages]:[n,...n.secondarySpatialImages]).map((e=>e.frameInfo.fileId));t.frames.forEach(((e,i)=>{var n;b.includes(e.frameInfo.fileId)&&(a[i]=this.genValueContent(e),l[i]=null!==(n=t.overlayStore.global.explicitSystem)&&void 0!==n?n:"-",c[i]=this.genWorldCoordContent(e),d[i]=this.genImageCoordContent(e))}));const m=new Map([[0,{dataType:r,data:s}],[1,{dataType:r,data:a}],[2,{dataType:r,data:l}],[3,{dataType:r,data:c}],[4,{dataType:r,data:d}],[5,{dataType:r,data:p}],[6,{dataType:r,data:g}],[7,{dataType:r,data:f}]]);return Object(xm.jsxs)("div",{className:"cursor-info-widget",children:[this.width>0&&Object(xm.jsx)(ij,{dataset:m,columnHeaders:o,numVisibleRows:t.frames.length,columnWidths:this.columnWidths,onColumnWidthChanged:this.onColumnWidthChanged,enableGhostCells:!1,defaultRowHeight:40,isIndexZero:!0,boldIndex:[t.activeFrameIndex]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},KD=Object(b.a)($D.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),QD=Object(b.a)($D.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ZD=Object(b.a)($D.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),XD=$D))||XD;var eL,tL=i(193);i(832);let iL=Object(p.a)(eL=class extends n.Component{constructor(...e){super(...e),this.pinElementRef=void 0,this.rnd=void 0,this.onClickHelpButton=()=>{const e=this.rnd.draggable.state.x+.5*this.rnd.resizable.size.width;if(Array.isArray(this.props.widgetConfig.helpType)){const t=gC.Instance.widgetsStore,i=this.props.widgetConfig.parentType,n=t.floatingSettingsWidgets.get(this.props.widgetConfig.id);let r;switch(i){case"spatial-profiler":r=t.spatialProfileWidgets.get(n).settingsTabId;break;case"spectral-profiler":r=t.spectralProfileWidgets.get(n).settingsTabId;break;case"catalog-overlay":const e=hM.Instance,i=e.catalogProfiles.get(n);if(i){const n=e.catalogWidgets.get(i);r=t.catalogWidgets.get(n).settingsTabId}break;case"stokes":default:r=t.stokesAnalysisWidgets.get(n).settingsTabId}SM.Instance.showHelpDrawer(this.props.widgetConfig.helpType[r],e)}else SM.Instance.showHelpDrawer(this.props.widgetConfig.helpType,e)}}componentDidMount(){this.updateDragSource(),this.rnd.updateSize({width:this.props.widgetConfig.defaultWidth,height:this.props.widgetConfig.defaultHeight}),this.rnd.updatePosition({x:this.props.widgetConfig.defaultX,y:this.props.widgetConfig.defaultY})}componentDidUpdate(){this.updateDragSource(),this.rnd.updateSize({width:this.props.widgetConfig.defaultWidth,height:this.props.widgetConfig.defaultHeight}),this.rnd.updatePosition({x:this.props.widgetConfig.defaultX,y:this.props.widgetConfig.defaultY})}updateDragSource(){const e=eE.Instance;if(e.dockedLayout&&this.pinElementRef){const t=e.dockedLayout;if(t._dragSources.filter((e=>e._itemConfig.id===this.props.widgetConfig.id)).find((e=>e._element[0]===this.pinElementRef)))return;let i;i={type:"react-component",component:this.props.widgetConfig.type,title:this.props.widgetConfig.title,id:this.props.widgetConfig.id,isClosable:this.props.widgetConfig.isCloseable,props:{id:this.props.widgetConfig.id,docked:!0}},this.props.widgetConfig.type===oB.WIDGET_CONFIG.type&&(i.props.label=this.props.widgetConfig.title),this.pinElementRef&&i&&t.createDragSource(this.pinElementRef,i)}}render(){const e=gC.Instance,t=d()("floating-widget",{"bp3-dark":e.darkTheme}),i=d()("floating-header",{selected:this.props.isSelected,"bp3-dark":e.darkTheme}),n=d()("floating-header-button",{"bp3-dark":e.darkTheme}),r=d()("floating-content",{"bp3-dark":e.darkTheme,"floating-settings-content":!this.props.showPinButton}),o=this.props.widgetConfig;return Object(xm.jsxs)(tL.a,{ref:e=>this.rnd=e,className:t,style:{zIndex:this.props.zIndex},default:{x:o.defaultX,y:o.defaultY,width:o.defaultWidth,height:o.defaultHeight+25},resizeGrid:[25,25],dragGrid:[25,25],minWidth:o.minWidth,minHeight:o.minHeight+25,bounds:".gl-container-app",dragHandleClassName:"floating-title",onMouseDown:this.props.onSelected,onDragStop:(e,t)=>{o.setDefaultPosition(t.lastX,t.lastY)},onResizeStop:(e,t,i,n,r)=>{o.setDefaultPosition(r.x,r.y),o.setDefaultSize(o.defaultWidth+n.width,o.defaultHeight+n.height)},children:[Object(xm.jsxs)("div",{className:i,children:[Object(xm.jsx)("div",{className:"floating-title",children:o.title}),this.props.showFloatingSettingsButton&&Object(xm.jsx)("div",{className:n,onClick:()=>e.widgetsStore.createFloatingSettingsWidget(o.title,o.id,o.type),children:Object(xm.jsx)(j.a,{content:"Settings",position:y.a.BOTTOM_RIGHT,children:Object(xm.jsx)(u.w,{icon:"cog"})})}),o.helpType&&Object(xm.jsx)("div",{className:n,onClick:this.onClickHelpButton,children:Object(xm.jsx)(j.a,{content:"Help",position:y.a.BOTTOM_RIGHT,children:Object(xm.jsx)(u.w,{icon:"help"})})}),this.props.showPinButton&&Object(xm.jsx)("div",{className:n,ref:e=>this.pinElementRef=e,onClick:()=>console.log("pin!"),children:Object(xm.jsx)(j.a,{content:"Drag pin to dock this widget",position:y.a.BOTTOM_RIGHT,children:Object(xm.jsx)(u.w,{icon:"pin"})})}),o.isCloseable&&Object(xm.jsx)("div",{onMouseDown:this.props.onClosed,className:n,children:Object(xm.jsx)(u.w,{icon:"cross"})})]}),Object(xm.jsx)("div",{className:r,children:this.props.children})]})}})||eL;var nL,rL,oL,sL,aL;i(833);!function(e){e.GLOBAL="Global",e.TITLE="Title",e.TICKS="Ticks",e.GRIDS="Grids",e.BORDER="Border",e.AXES="Axes",e.NUMBERS="Numbers",e.LABELS="Labels",e.BEAM="Beam",e.COLORBAR="Colorbar",e.CONVERSION="Conversion"}(aL||(aL={}));class lL{constructor(e,t){this.name=void 0,this.id=void 0,this.style=void 0,this.weight=void 0,this.family=void 0,this.name=e.replace("{size} ",""),this.id=t;let i=this.name;0===i.indexOf("bold")?(i=i.replace("bold ",""),this.weight=700):this.weight=400,0===i.indexOf("italic")?(i=i.replace("italic ",""),this.style="italic"):this.style="",this.family=i}}const cL=Pt.fonts.map(((e,t)=>new lL(e,t))),dL=A.a.ofType(),pL=(e,{handleClick:t,modifiers:i,query:n})=>Object(xm.jsx)(u.B,{active:i.active,disabled:i.disabled,onClick:t,text:Object(xm.jsx)("span",{style:{fontFamily:e.family,fontWeight:e.weight,fontStyle:e.style},children:e.name})},e.id);let hL=Object(p.a)((rL=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"selectedTab",oL,this),Object(f.a)(this,"setSelectedTab",sL,this),Object(m.p)(this),Object(m.h)((()=>{var e;(null===(e=gC.Instance.activeFrame)||void 0===e?void 0:e.isPVImage)||this.selectedTab!==aL.CONVERSION||(this.selectedTab=aL.GLOBAL)}))}fontSelect(e,t,i){let n=cL[t];return"undefined"===typeof n&&(n=cL[0]),Object(xm.jsx)(dL,{activeItem:n,itemRenderer:pL,items:cL,disabled:!e,filterable:!1,popoverProps:{minimal:!0,placement:"bottom",popoverClassName:"fontselect"},onItemSelect:e=>i(e.id),children:Object(xm.jsx)(u.e,{text:Object(xm.jsx)("span",{style:{fontFamily:n.family,fontWeight:n.weight,fontStyle:n.style},children:n.name}),disabled:!e,rightIcon:"double-caret-vertical"})})}static get WIDGET_CONFIG(){return{id:"image-view-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:650,defaultHeight:420,title:"image-view-settings",isCloseable:!0,parentId:"image-view",parentType:"image-view",helpType:xM.IMAGE_VIEW_SETTINGS}}render(){var e,t;const i=gC.Instance,n=i.overlayStore,r=n.global,o=n.title,s=n.grid,a=n.border,l=n.ticks,c=n.axes,p=n.numbers,h=n.labels,g=n.colorbar,f=n.beam,b=f.settingsForDisplay,m=i.preferenceStore,y=r.labelType===eA.Interior,O=y&&"Does not apply to interior labelling.",j=!y&&"Does not apply to exterior labelling.",x=!r.validWcs&&"This image has no valid WCS data.",S=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Enable multi-panel",children:Object(xm.jsx)(u.P,{checked:m.imageMultiPanelEnabled,onChange:e=>i.widgetsStore.setImageMultiPanelEnabled(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Multi-panel mode",disabled:!m.imageMultiPanelEnabled,children:Object(xm.jsxs)(u.r,{value:m.imagePanelMode,disabled:!m.imageMultiPanelEnabled,onChange:e=>m.setPreference(QA.IMAGE_PANEL_MODE,e.currentTarget.value),children:[Object(xm.jsx)("option",{value:Xn.Dynamic,children:"Dynamic grid size"}),Object(xm.jsx)("option",{value:Xn.Fixed,children:"Fixed grid size"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Columns",labelInfo:m.imagePanelMode===Xn.Dynamic?"(Maximum)":"(Fixed)",disabled:!m.imageMultiPanelEnabled,children:Object(xm.jsx)(pO,{placeholder:"Columns",min:1,value:m.imagePanelColumns,disabled:!m.imageMultiPanelEnabled,stepSize:1,minorStepSize:null,onValueChange:e=>m.setPreference(QA.IMAGE_PANEL_COLUMNS,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Rows",labelInfo:m.imagePanelMode===Xn.Dynamic?"(Maximum)":"(Fixed)",disabled:!m.imageMultiPanelEnabled,children:Object(xm.jsx)(pO,{placeholder:"Rows",min:1,disabled:!m.imageMultiPanelEnabled,value:m.imagePanelRows,stepSize:1,minorStepSize:null,onValueChange:e=>m.setPreference(QA.IMAGE_PANEL_ROWS,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Overlay color",children:Object(xm.jsx)(ny,{color:r.color,presetColors:Gb,setColor:r.setColor,disableAlpha:!0})}),Object(xm.jsx)(u.p,{inline:!0,label:"Tolerance",labelInfo:"(%)",children:Object(xm.jsx)(pO,{placeholder:"Tolerance",min:.1,value:r.tolerance,stepSize:.1,minorStepSize:null,majorStepSize:10,onValueChange:e=>r.setTolerance(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Labelling",children:Object(xm.jsx)(u.r,{options:Object.keys(eA).map((e=>({label:e,value:eA[e]}))),value:r.labelType,onChange:e=>r.setLabelType(e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Coordinate system",disabled:!r.validWcs,helperText:x,children:Object(xm.jsx)(u.r,{options:Object.keys(tA).map((e=>({label:e,value:tA[e]}))),value:r.system,disabled:!r.validWcs,onChange:e=>r.setSystem(e.currentTarget.value)})})]}),v=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Visible",children:Object(xm.jsx)(u.P,{checked:o.visible,onChange:e=>o.setVisible(e.currentTarget.checked)})}),Object(xm.jsxs)(u.p,{inline:!0,className:"font-group",label:"Font",disabled:!o.visible,children:[this.fontSelect(o.visible,o.font,o.setFont),Object(xm.jsx)(pO,{min:7,max:96,placeholder:"Font size",value:o.fontSize,disabled:!o.visible,onValueChange:e=>o.setFontSize(e)})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom text",disabled:!o.visible,children:Object(xm.jsx)(u.P,{checked:o.customText,disabled:!o.visible,onChange:e=>o.setCustomText(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:o.customText,children:Object(xm.jsx)(u.p,{inline:!0,label:"Text",labelInfo:"(Current image only)",disabled:!o.visible,children:Object(xm.jsx)(u.x,{disabled:!o.visible,value:null===(e=i.activeFrame)||void 0===e?void 0:e.titleCustomText,placeholder:"Enter title text",onChange:e=>{var t;return null===(t=i.activeFrame)||void 0===t?void 0:t.setTitleCustomText(e.currentTarget.value)}})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!o.visible,children:Object(xm.jsx)(u.P,{checked:o.customColor,disabled:!o.visible,onChange:e=>o.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:o.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:!o.visible,children:o.visible&&Object(xm.jsx)(ny,{color:o.color,presetColors:Gb,setColor:o.setColor,disableAlpha:!0})})})]}),C=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Draw on all edges",disabled:y,helperText:O,children:Object(xm.jsx)(u.P,{checked:l.drawAll,disabled:y,onChange:e=>l.setDrawAll(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom density",children:Object(xm.jsx)(u.P,{checked:l.customDensity,onChange:e=>l.setCustomDensity(e.currentTarget.checked)})}),Object(xm.jsxs)(u.j,{isOpen:l.customDensity,children:[Object(xm.jsx)(u.p,{inline:!0,label:"Density",labelInfo:"(X)",children:Object(xm.jsx)(pO,{placeholder:"Density",min:0,value:l.densityX,onValueChange:e=>l.setDensityX(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Density",labelInfo:"(Y)",children:Object(xm.jsx)(pO,{placeholder:"Density",min:0,value:l.densityY,onValueChange:e=>l.setDensityY(e)})})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",children:Object(xm.jsx)(u.P,{checked:l.customColor,onChange:e=>l.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:l.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",children:Object(xm.jsx)(ny,{color:l.color,presetColors:Gb,setColor:l.setColor,disableAlpha:!0})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Width",min:.001,max:30,value:l.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>l.setWidth(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Minor length",labelInfo:"(%)",children:Object(xm.jsx)(pO,{placeholder:"Length",min:0,max:100,value:l.length,stepSize:1,minorStepSize:null,majorStepSize:10,onValueChange:e=>l.setLength(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Major length",labelInfo:"(%)",children:Object(xm.jsx)(pO,{placeholder:"Length",min:0,max:100,value:l.majorLength,stepSize:1,minorStepSize:null,majorStepSize:10,onValueChange:e=>l.setMajorLength(e)})})]}),I=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"WCS grid",children:Object(xm.jsx)(u.P,{checked:s.visible,onChange:e=>s.setVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!s.visible,children:Object(xm.jsx)(u.P,{checked:s.customColor,disabled:!s.visible,onChange:e=>s.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:s.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:!s.visible,children:s.visible&&Object(xm.jsx)(ny,{color:s.color,presetColors:Gb,setColor:s.setColor,disableAlpha:!0})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!s.visible,children:Object(xm.jsx)(pO,{placeholder:"Width",min:.001,value:s.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!s.visible,onValueChange:e=>s.setWidth(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom gap",disabled:!s.visible,children:Object(xm.jsx)(u.P,{checked:s.customGap,disabled:!s.visible,onChange:e=>s.setCustomGap(e.currentTarget.checked)})}),Object(xm.jsxs)(u.j,{isOpen:s.customGap,children:[Object(xm.jsx)(u.p,{inline:!0,label:"Gap",labelInfo:"(X)",disabled:!s.visible,children:Object(xm.jsx)(pO,{placeholder:"Gap",min:.001,stepSize:.01,minorStepSize:.001,majorStepSize:.1,value:s.gapX,disabled:!s.visible,onValueChange:e=>s.setGapX(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Gap",labelInfo:"(Y)",disabled:!s.visible,children:Object(xm.jsx)(pO,{placeholder:"Gap",min:.001,stepSize:.01,minorStepSize:.001,majorStepSize:.1,value:s.gapY,disabled:!s.visible,onValueChange:e=>s.setGapY(e)})})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Pixel grid",children:Object(xm.jsx)(u.P,{checked:m.pixelGridVisible,onChange:e=>m.setPreference(QA.PIXEL_GRID_VISIBLE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Pixel grid color",children:Object(xm.jsx)(ny,{color:m.pixelGridColor,presetColors:Gb,setColor:e=>m.setPreference(QA.PIXEL_GRID_COLOR,e),disableAlpha:!0})})]}),w=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Visible",children:Object(xm.jsx)(u.P,{checked:a.visible,onChange:e=>a.setVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!a.visible,children:Object(xm.jsx)(u.P,{checked:a.customColor,disabled:!a.visible,onChange:e=>a.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:a.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:!a.visible,children:a.visible&&Object(xm.jsx)(ny,{color:a.color,presetColors:Gb,setColor:a.setColor,disableAlpha:!0})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!a.visible,children:Object(xm.jsx)(pO,{placeholder:"Width",min:.5,max:30,value:a.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!a.visible,onValueChange:e=>a.setWidth(e)})})]}),T=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Visible",disabled:!y,helperText:j,children:Object(xm.jsx)(u.P,{checked:c.visible,disabled:!y,onChange:e=>c.setVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!y||!c.visible,children:Object(xm.jsx)(u.P,{checked:c.customColor,disabled:!y||!c.visible,onChange:e=>c.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:c.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:!y||!c.visible,helperText:j,children:y&&c.visible&&Object(xm.jsx)(ny,{color:c.color,presetColors:Gb,setColor:c.setColor,disableAlpha:!0})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!y||!c.visible,helperText:j,children:Object(xm.jsx)(pO,{placeholder:"Width",min:.001,value:c.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!y||!c.visible,onValueChange:e=>c.setWidth(e)})})]}),R=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Visible",children:Object(xm.jsx)(u.P,{checked:p.visible,onChange:e=>p.setVisible(e.currentTarget.checked)})}),Object(xm.jsxs)(u.p,{inline:!0,className:"font-group",label:"Font",disabled:!p.visible,children:[this.fontSelect(p.visible,p.font,p.setFont),Object(xm.jsx)(pO,{min:7,max:96,placeholder:"Font size",value:p.fontSize,disabled:!p.visible,onValueChange:e=>p.setFontSize(e)})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!p.visible,children:Object(xm.jsx)(u.P,{checked:p.customColor,disabled:!p.visible,onChange:e=>p.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:p.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:!p.visible,children:p.visible&&Object(xm.jsx)(ny,{color:p.color,presetColors:Gb,setColor:p.setColor,disableAlpha:!0})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom format",disabled:!p.validWcs,helperText:x,children:Object(xm.jsx)(u.P,{checked:p.customFormat,disabled:!p.validWcs,onChange:e=>p.setCustomFormat(e.currentTarget.checked)})}),Object(xm.jsxs)(u.j,{isOpen:p.customFormat&&p.validWcs,children:[Object(xm.jsx)(u.p,{inline:!0,label:"Format",labelInfo:"(X)",children:Object(xm.jsx)(u.r,{options:[{label:nA.get(iA.HMS),value:iA.HMS},{label:nA.get(iA.DMS),value:iA.DMS},{label:nA.get(iA.Degrees),value:iA.Degrees}],value:p.formatX,onChange:e=>p.setFormatX(e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Format",labelInfo:"(Y)",children:Object(xm.jsx)(u.r,{options:[{label:nA.get(iA.HMS),value:iA.HMS},{label:nA.get(iA.DMS),value:iA.DMS},{label:nA.get(iA.Degrees),value:iA.Degrees}],value:p.formatY,onChange:e=>p.setFormatY(e.currentTarget.value)})})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom precision",disabled:!p.validWcs,helperText:x,children:Object(xm.jsx)(u.P,{checked:p.customPrecision,disabled:!p.validWcs,onChange:e=>p.setCustomPrecision(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:p.customPrecision&&p.validWcs,children:Object(xm.jsx)(u.p,{inline:!0,label:"Precision",children:Object(xm.jsx)(pO,{placeholder:"Precision",min:0,value:p.precision,onValueChange:e=>p.setPrecision(e)})})})]}),A=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Visible",children:Object(xm.jsx)(u.P,{checked:h.visible,onChange:e=>h.setVisible(e.currentTarget.checked)})}),Object(xm.jsxs)(u.p,{inline:!0,className:"font-group",label:"Font",disabled:!h.visible,children:[this.fontSelect(h.visible,h.font,h.setFont),Object(xm.jsx)(pO,{min:7,max:96,placeholder:"Font size",value:h.fontSize,disabled:!h.visible,onValueChange:e=>h.setFontSize(e)})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom text",disabled:!h.visible,children:Object(xm.jsx)(u.P,{checked:h.customText,disabled:!h.visible,onChange:e=>h.setCustomText(e.currentTarget.checked)})}),Object(xm.jsxs)(u.j,{isOpen:h.customText,children:[Object(xm.jsx)(u.p,{inline:!0,label:"Label Text (X)",disabled:!h.visible,children:Object(xm.jsx)(u.x,{disabled:!h.visible,value:h.customLabelX,placeholder:"Enter label text",onChange:e=>h.setCustomLabelX(e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Label Text (Y)",disabled:!h.visible,children:Object(xm.jsx)(u.x,{disabled:!h.visible,value:h.customLabelY,placeholder:"Enter label text",onChange:e=>h.setCustomLabelY(e.currentTarget.value)})})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!h.visible,children:Object(xm.jsx)(u.P,{checked:h.customColor,disabled:!h.visible,onChange:e=>h.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:h.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:!h.visible,children:h.visible&&Object(xm.jsx)(ny,{color:h.color,presetColors:Gb,setColor:h.setColor,disableAlpha:!0})})})]}),P=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Visible",children:Object(xm.jsx)(u.P,{checked:g.visible,onChange:e=>g.setVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Interactive",disabled:!g.visible,children:Object(xm.jsx)(u.P,{disabled:!g.visible,checked:g.interactive,onChange:e=>g.setInteractive(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Position",disabled:!g.visible,children:Object(xm.jsxs)(u.r,{value:g.position,disabled:!g.visible,onChange:e=>g.setPosition(e.currentTarget.value),children:[Object(xm.jsx)("option",{value:"right",children:"right"}),Object(xm.jsx)("option",{value:"top",children:"top"}),Object(xm.jsx)("option",{value:"bottom",children:"bottom"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!g.visible,children:Object(xm.jsx)(pO,{placeholder:"Width",min:1,max:100,value:g.width,stepSize:1,minorStepSize:1,majorStepSize:2,disabled:!g.visible,onValueChange:e=>g.setWidth(e),intOnly:!0})}),Object(xm.jsx)(u.p,{inline:!0,label:"Offset",labelInfo:"(px)",disabled:!g.visible,children:Object(xm.jsx)(pO,{placeholder:"Offset",min:0,max:100,value:g.offset,stepSize:1,minorStepSize:1,majorStepSize:5,disabled:!g.visible,onValueChange:e=>g.setOffset(e),intOnly:!0})}),Object(xm.jsx)(u.p,{inline:!0,label:"Ticks density",labelInfo:"(per 100px)",disabled:!g.visible||!g.tickVisible&&!g.numberVisible,children:Object(xm.jsx)(pO,{placeholder:"Ticks density",min:.2,max:20,value:g.tickDensity,stepSize:.2,minorStepSize:.1,majorStepSize:1,disabled:!g.visible||!g.tickVisible&&!g.numberVisible,onValueChange:e=>g.setTickDensity(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Custom color",disabled:!g.visible,children:Object(xm.jsx)(u.P,{checked:g.customColor,disabled:!g.visible,onChange:e=>g.setCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.customColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"color",disabled:!g.visible,children:g.visible&&Object(xm.jsx)(ny,{color:g.color,presetColors:Gb,setColor:g.setColor,disableAlpha:!0})})}),Object(xm.jsx)("hr",{}),Object(xm.jsx)(u.p,{inline:!0,label:"Label",disabled:!g.visible,children:Object(xm.jsx)(u.P,{checked:g.labelVisible,disabled:!g.visible,onChange:e=>g.setLabelVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Label rotation",disabled:!g.visible||!g.labelVisible||"right"!==g.position,children:Object(xm.jsxs)(u.r,{value:g.labelRotation,disabled:!g.visible||!g.labelVisible||"right"!==g.position,onChange:e=>{g.setLabelRotation(Number(e.currentTarget.value)),0===g.numberRotation||90!==Number(e.currentTarget.value)&&-90!==Number(e.currentTarget.value)||g.setNumberRotation(Number(e.currentTarget.value))},children:[Object(xm.jsx)("option",{value:-90,children:"-90"}),Object(xm.jsx)("option",{value:90,children:"90"})]})}),Object(xm.jsxs)(u.p,{inline:!0,className:"font-group",label:"Label font",disabled:!g.visible||!g.labelVisible,children:[this.fontSelect(g.visible&&g.labelVisible,g.labelFont,g.setLabelFont),Object(xm.jsx)(pO,{min:7,max:96,value:g.labelFontSize,disabled:!g.visible||!g.labelVisible,onValueChange:e=>g.setLabelFontSize(e)})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Label custom text",disabled:!g.visible||!g.labelVisible,children:Object(xm.jsx)(u.P,{checked:g.labelCustomText,disabled:!g.visible||!g.labelVisible,onChange:e=>g.setLabelCustomText(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.labelCustomText,children:Object(xm.jsx)(u.p,{inline:!0,label:"Label text",disabled:!g.visible||!g.labelVisible,children:Object(xm.jsx)(u.x,{disabled:!g.visible||!g.labelVisible,value:null===(t=i.activeFrame)||void 0===t?void 0:t.colorbarLabelCustomText,placeholder:"Enter label text",onChange:e=>{var t;return null===(t=i.activeFrame)||void 0===t?void 0:t.setColorbarLabelCustomText(e.currentTarget.value)}})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Label custom color",disabled:!g.visible||!g.labelVisible,children:Object(xm.jsx)(u.P,{checked:g.labelCustomColor,disabled:!g.visible||!g.labelVisible,onChange:e=>g.setLabelCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.labelCustomColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Label color",disabled:!g.visible||!g.labelVisible,children:g.visible&&g.labelVisible&&Object(xm.jsx)(ny,{color:g.labelColor,presetColors:Gb,setColor:g.setLabelColor,disableAlpha:!0})})}),Object(xm.jsx)("hr",{}),Object(xm.jsx)(u.p,{inline:!0,label:"Numbers",disabled:!g.visible,children:Object(xm.jsx)(u.P,{checked:g.numberVisible,disabled:!g.visible,onChange:e=>g.setNumberVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Numbers rotation",disabled:!g.visible||!g.numberVisible||"right"!==g.position,children:Object(xm.jsxs)(u.r,{value:g.numberRotation,disabled:!g.visible||!g.numberVisible||"right"!==g.position,onChange:e=>g.setNumberRotation(Number(e.currentTarget.value)),children:[Object(xm.jsx)("option",{value:-90,children:"-90"}),Object(xm.jsx)("option",{value:0,children:"0"}),Object(xm.jsx)("option",{value:90,children:"90"})]})}),Object(xm.jsxs)(u.p,{inline:!0,className:"font-group",label:"Numbers font",disabled:!g.visible||!g.numberVisible,children:[this.fontSelect(g.visible&&g.numberVisible,g.numberFont,g.setNumberFont),Object(xm.jsx)(pO,{min:7,max:96,value:g.numberFontSize,disabled:!g.visible||!g.numberVisible,onValueChange:e=>g.setNumberFontSize(e)})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Numbers custom precision",disabled:!g.visible||!g.numberVisible,children:Object(xm.jsx)(u.P,{checked:g.numberCustomPrecision,disabled:!g.visible||!g.numberVisible,onChange:e=>g.setNumberCustomPrecision(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.numberCustomPrecision,children:Object(xm.jsx)(u.p,{inline:!0,label:"Numbers precision",disabled:!g.visible||!g.numberVisible,children:Object(xm.jsx)(pO,{min:0,max:N.PRECISION_MAX,stepSize:1,value:g.numberPrecision,disabled:!g.visible||!g.numberVisible,onValueChange:e=>g.setNumberPrecision(e),intOnly:!0})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Numbers custom color",disabled:!g.visible||!g.numberVisible,children:Object(xm.jsx)(u.P,{checked:g.numberCustomColor,disabled:!g.visible||!g.numberVisible,onChange:e=>g.setNumberCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.numberCustomColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Numbers color",disabled:!g.visible||!g.numberVisible,children:g.visible&&g.numberVisible&&Object(xm.jsx)(ny,{color:g.numberColor,presetColors:Gb,setColor:g.setNumberColor,disableAlpha:!0})})}),Object(xm.jsx)("hr",{}),Object(xm.jsx)(u.p,{inline:!0,label:"Ticks",disabled:!g.visible,children:Object(xm.jsx)(u.P,{checked:g.tickVisible,disabled:!g.visible,onChange:e=>g.setTickVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Ticks length",labelInfo:"(px)",disabled:!g.visible||!g.tickVisible,children:Object(xm.jsx)(pO,{placeholder:"Ticks length",min:.5,max:g.width,value:g.tickLen,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!g.visible||!g.tickVisible,onValueChange:e=>g.setTickLen(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Ticks width",labelInfo:"(px)",disabled:!g.visible||!g.tickVisible,children:Object(xm.jsx)(pO,{placeholder:"Ticks width",min:.5,max:30,value:g.tickWidth,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!g.visible||!g.tickVisible,onValueChange:e=>g.setTickWidth(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Ticks custom color",disabled:!g.visible||!g.tickVisible,children:Object(xm.jsx)(u.P,{checked:g.tickCustomColor,disabled:!g.visible||!g.tickVisible,onChange:e=>g.setTickCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.tickCustomColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Ticks color",disabled:!g.visible||!g.tickVisible,children:g.visible&&g.tickVisible&&Object(xm.jsx)(ny,{color:g.tickColor,presetColors:Gb,setColor:g.setTickColor,disableAlpha:!0})})}),Object(xm.jsx)("hr",{}),Object(xm.jsx)(u.p,{inline:!0,label:"Border",disabled:!g.visible,children:Object(xm.jsx)(u.P,{checked:g.borderVisible,disabled:!g.visible,onChange:e=>g.setBorderVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Border width",labelInfo:"(px)",disabled:!g.visible||!g.borderVisible,children:Object(xm.jsx)(pO,{placeholder:"Border width",min:.5,max:30,value:g.borderWidth,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!g.visible||!g.borderVisible,onValueChange:e=>g.setBorderWidth(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Border custom color",disabled:!g.visible||!g.borderVisible,children:Object(xm.jsx)(u.P,{checked:g.borderCustomColor,disabled:!g.visible||!g.borderVisible,onChange:e=>g.setBorderCustomColor(e.currentTarget.checked)})}),Object(xm.jsx)(u.j,{isOpen:g.borderCustomColor,children:Object(xm.jsx)(u.p,{inline:!0,label:"Border color",disabled:!g.visible||!g.borderVisible,children:g.visible&&g.borderVisible&&Object(xm.jsx)(ny,{color:g.borderColor,presetColors:Gb,setColor:g.setBorderColor,disableAlpha:!0})})})]}),E=f.isSelectedFrameValid?Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Image",children:Object(xm.jsx)(u.r,{options:i.frameNames,value:f.selectedFileId,onChange:e=>f.setSelectedFrame(parseInt(e.currentTarget.value))})}),Object(xm.jsx)(u.p,{inline:!0,label:"Visible",children:Object(xm.jsx)(u.P,{checked:b.visible,onChange:e=>b.setVisible(e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Color",children:Object(xm.jsx)(ny,{color:b.color,presetColors:Gb,setColor:b.setColor,disableAlpha:!0})}),Object(xm.jsx)(u.p,{inline:!0,label:"Type",children:Object(xm.jsx)(u.r,{options:Object.keys(rA).map((e=>({label:e,value:rA[e]}))),value:b.type,onChange:e=>b.setType(e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Width",min:.5,max:10,value:b.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>b.setWidth(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Position (X)",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Position (X)",min:0,max:n.renderWidth,value:b.shiftX,stepSize:5,minorStepSize:1,majorStepSize:10,onValueChange:e=>b.setShiftX(e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Position (Y)",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Position (Y)",min:0,max:n.renderHeight,value:b.shiftY,stepSize:5,minorStepSize:1,majorStepSize:10,onValueChange:e=>b.setShiftY(e)})})]}):null,M=i.activeFrame,F=null===M||void 0===M?void 0:M.isPVImage,k=F?Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)("p",{children:"For spatial-spectral image"}),Object(xm.jsx)(u.n,{}),Object(xm.jsx)("p",{children:"Spectral axis"}),Object(xm.jsx)(HO,{frame:i.activeFrame,onSpectralCoordinateChange:M.setSpectralCoordinate,onSpectralSystemChange:M.setSpectralSystem,disable:!F,disableChannelOption:!0})]}):null,D=d()("image-view-settings",{"bp3-dark":i.darkTheme});return Object(xm.jsx)("div",{className:D,children:Object(xm.jsxs)(u.R,{id:"imageViewSettingsTabs",vertical:!0,selectedTabId:this.selectedTab,onChange:this.setSelectedTab,children:[Object(xm.jsx)(u.Q,{id:aL.GLOBAL,title:aL.GLOBAL,panel:S}),Object(xm.jsx)(u.Q,{id:aL.TITLE,title:aL.TITLE,panel:v}),Object(xm.jsx)(u.Q,{id:aL.TICKS,title:aL.TICKS,panel:C}),Object(xm.jsx)(u.Q,{id:aL.GRIDS,title:aL.GRIDS,panel:I}),Object(xm.jsx)(u.Q,{id:aL.BORDER,title:aL.BORDER,panel:w}),Object(xm.jsx)(u.Q,{id:aL.AXES,title:aL.AXES,panel:T}),Object(xm.jsx)(u.Q,{id:aL.NUMBERS,title:aL.NUMBERS,panel:R}),Object(xm.jsx)(u.Q,{id:aL.LABELS,title:aL.LABELS,panel:A}),Object(xm.jsx)(u.Q,{id:aL.COLORBAR,title:aL.COLORBAR,panel:P}),Object(xm.jsx)(u.Q,{id:aL.BEAM,title:aL.BEAM,panel:E,disabled:i.frameNum<=0}),Object(xm.jsx)(u.Q,{id:aL.CONVERSION,title:aL.CONVERSION,panel:k,disabled:!F})]})})}},oL=Object(b.a)(rL.prototype,"selectedTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return aL.GLOBAL}}),sL=Object(b.a)(rL.prototype,"setSelectedTab",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTab=e}}}),nL=rL))||nL;var uL;i(834);let gL=Object(p.a)(uL=class extends n.Component{render(){const e=tM.Instance,t={icon:"info-sign",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!0,lazy:!0,isOpen:e.aboutDialogVisible,onClose:e.hideAboutDialog,className:"about-dialog",canEscapeKeyClose:!0,title:"About CARTA"};return Object(xm.jsxs)(fL,{dialogProps:t,defaultWidth:620,defaultHeight:700,enableResizing:!1,children:[Object(xm.jsxs)("div",{className:hS.a.DIALOG_BODY,children:[Object(xm.jsxs)("div",{className:"image-div",children:[Object(xm.jsx)("img",{src:"carta_logo.png",width:80}),Object(xm.jsxs)("h3",{children:[Vi.acronym," ",Vi.version," (",Vi.date,")"]}),Object(xm.jsx)("p",{children:Vi.fullName})]}),Object(xm.jsx)("h3",{children:"Development team:"}),Object(xm.jsx)("p",{children:"The development of the CARTA project is a joint effort from:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:Object(xm.jsx)("a",{href:"https://www.asiaa.sinica.edu.tw/",rel:"noopener noreferrer",target:"_blank",children:"Academia Sinica, Institute of Astronomy and Astrophysics (ASIAA)"})}),Object(xm.jsx)("li",{children:Object(xm.jsx)("a",{href:"https://idia.ac.za/",rel:"noopener noreferrer",target:"_blank",children:"Inter-University Institute for Data Intensive Astronomy (IDIA)"})}),Object(xm.jsx)("li",{children:Object(xm.jsx)("a",{href:"https://science.nrao.edu/",rel:"noopener noreferrer",target:"_blank",children:"National Radio Astronomy Observatory (NRAO)"})}),Object(xm.jsx)("li",{children:Object(xm.jsx)("a",{href:"https://www.ualberta.ca/physics",rel:"noopener noreferrer",target:"_blank",children:"Department of Physics, University of Alberta"})})]}),Object(xm.jsx)("h3",{children:"Useful links:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:["Source code for CARTA is available on"," ",Object(xm.jsx)("a",{href:"https://github.com/cartavis",rel:"noopener noreferrer",target:"_blank",children:"GitHub"})]}),Object(xm.jsxs)("li",{children:["Please report bugs or suggestions to the"," ",Object(xm.jsx)("a",{href:"mailto:support@carta.freshdesk.com",rel:"noopener noreferrer",target:"_blank",children:"CARTA helpdesk"})," ","or file a"," ",Object(xm.jsx)("a",{href:"https://github.com/CARTAvis/carta/issues",rel:"noopener noreferrer",target:"_blank",children:"GitHub issue"})]}),Object(xm.jsxs)("li",{children:["Documentation is available"," ",Object(xm.jsx)("a",{href:"https://carta.readthedocs.io/en/3.0",rel:"noopener noreferrer",target:"_blank",children:"online"})]})]}),Object(xm.jsx)("h3",{children:"License"}),Object(xm.jsxs)("p",{className:hS.a.TEXT_SMALL,children:["Copyright (C) 2018-2022 ASIAA, IDIA, NRAO, and Department of Physics, University of Alberta. This program is free software; you can redistribute it and/or modify it under the terms of the\xa0",Object(xm.jsx)("a",{href:"http://www.gnu.org/copyleft/gpl.html",rel:"noopener noreferrer",target:"_blank",children:"GNU General Public License version 3"}),"\xa0 as published by the Free Software Foundation."]})]}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:Object(xm.jsx)(u.b,{intent:g.a.NONE,onClick:e.hideAboutDialog,text:"Close"})})})]})}})||uL;i(835);class fL extends n.Component{constructor(...e){super(...e),this.dd=void 0,this.rnd=void 0,this.onClickHelpButton=()=>{const e=this.rnd.draggable.state.x+.5*this.rnd.resizable.size.width;SM.Instance.showHelpDrawer(this.props.helpType,e)},this.onResizeStop=(e,t,i)=>{this.props.onResizeStop&&this.props.onResizeStop(i.offsetWidth,i.offsetHeight)}}componentDidUpdate(){const e=this.dd.getElementsByClassName("bp3-dialog-header");if(this.props.helpType&&e.length>0&&0===this.dd.getElementsByClassName("help-button").length){const t=Object(xm.jsx)(u.e,{icon:"help",minimal:!0,onClick:this.onClickHelpButton}),i=document.createElement("div");i.setAttribute("class","help-button"),o.render(t,i);const n=this.dd.getElementsByClassName("bp3-dialog-close-button");n.length>0?n[0].before(i):e[0].append(i)}}render(){const e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0],r=e.innerWidth||i.clientWidth||n.clientWidth,o=e.innerHeight||i.clientHeight||n.clientHeight,s=this.props.enableResizing,a={top:s,bottom:s,left:s,right:s,topLeft:s,topRight:s,bottomLeft:s,bottomRight:s};return Object(xm.jsx)("div",{className:"draggable-dialog",ref:e=>this.dd=e,children:this.props.dialogProps.isOpen&&Object(xm.jsx)(tL.a,{enableResizing:a,bounds:".gl-container-app",dragGrid:[1,1],resizeGrid:[25,25],default:{x:Math.floor(Math.max((r-this.props.defaultWidth)/2,0)),y:Math.floor(Math.max((o-this.props.defaultHeight)/2,0)),width:Math.min(this.props.defaultWidth,r),height:Math.min(this.props.defaultHeight,o)},minWidth:this.props.minWidth,minHeight:this.props.minHeight,dragHandleClassName:"bp3-dialog-header",ref:e=>{this.rnd=e},onResizeStop:this.onResizeStop,children:Object(xm.jsx)(u.m,{portalClassName:"dialog-portal",hasBackdrop:!1,usePortal:!1,enforceFocus:!1,autoFocus:!0,...this.props.dialogProps,children:this.props.children})})})}}var bL,mL=i(440);i(836);let yL=Object(p.a)(bL=class extends n.Component{render(){const e=gC.Instance,t={icon:"info-sign",className:d()("iframe-dialog",{"bp3-dark":e.darkTheme}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.externalPageDialogVisible,onClose:e.dialogStore.hideExternalPageDialog,title:e.dialogStore.externalPageDialogTitle};return Object(xm.jsx)(fL,{dialogProps:t,minWidth:400,minHeight:400,defaultWidth:800,defaultHeight:600,enableResizing:!0,children:Object(xm.jsx)("div",{className:"bp3-dialog-body",children:Object(xm.jsx)(mL.a,{url:e.dialogStore.externalPageDialogUrl})})})}})||bL;var OL,jL,xL,SL,vL,CL,IL,wL,TL,RL,AL,PL,EL,ML,FL=i(150),kL=i(441);i(837);let DL;!function(e){e.IMAGE_FILE="image-file",e.IMAGE_HEADER="image-header",e.SAVE_IMAGE="save-image",e.REGION_FILE="region-file",e.SELECT_REGION="select-region",e.CATALOG_FILE="catalog-file",e.CATALOG_HEADER="catalog-header"}(DL||(DL={}));let LL=Object(p.a)((jL=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"searchString",xL,this),Object(f.a)(this,"matchedIter",SL,this),Object(f.a)(this,"isMouseEntered",vL,this),this.isSearchOpened=!1,this.matchedTotal=0,this.matchedIterLocation={line:-1,num:-1},this.selectedFile=void 0,this.splitLengthArray=[],this.matchedLocationArray=[],this.listRef=n.createRef(),this.clickMatchedTimer=void 0,this.clickMatchedTimerStart=void 0,Object(f.a)(this,"onMouseEnter",CL,this),Object(f.a)(this,"onMouseLeave",IL,this),Object(f.a)(this,"resetSearchString",wL,this),Object(f.a)(this,"setSearchString",TL,this),Object(f.a)(this,"resetMatchedIter",RL,this),Object(f.a)(this,"addMatchedIter",AL,this),Object(f.a)(this,"minusMatchedIter",PL,this),Object(f.a)(this,"initMatchedIter",EL,this),Object(f.a)(this,"addMatchedTotal",ML,this),this.updateMatchedIterLocation=()=>{this.matchedIterLocation=this.matchedTotal>0?this.matchedLocationArray[this.matchedIter-1]:{line:-1,num:-1}},this.scrollToPosition=()=>{const e=this.listRef.current;if(!e)return;const t=e.state.scrollOffset,i=e.props.height,n=e.props.itemSize,r=10+this.matchedIterLocation.line*n;(r>t+i-n||r<t)&&this.listRef.current.scrollTo(r-i/2)},this.handleSearchPanelClicked=e=>{this.isSearchOpened=!!e,this.resetSearchString(),this.resetMatchedIter(),this.matchedTotal=0,this.matchedIterLocation={line:-1,num:-1}},this.handleSearchStringChanged=e=>{if(this.setSearchString(e.target.value),this.resetMatchedIter(),this.matchedTotal=0,""!==this.searchString){const e=new RegExp(this.searchString.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i");this.splitLengthArray=[],this.matchedLocationArray=[],this.props.fileInfoExtended.headerEntries.forEach(((t,i)=>{let n="END"!==t.name?`${t.name} = ${t.value}${t.comment&&" / "+t.comment}`.split(e):t.name.split(e);if(this.splitLengthArray.push(n.map((e=>e.length))),this.matchedTotal+=n.length-1,n.length>1){let e=0;for(;e<n.length-1;)this.matchedLocationArray.push({line:i,num:e}),e+=1}})),this.initMatchedIter(),this.updateMatchedIterLocation(),this.scrollToPosition()}},this.handleClickMatched=(e,t)=>{if(!(t&&13!==(null===t||void 0===t?void 0:t.keyCode)||""===this.searchString))if(0===e)clearTimeout(this.clickMatchedTimerStart),clearInterval(this.clickMatchedTimer);else{let t=()=>{-1===e||-99===e?this.minusMatchedIter():this.addMatchedIter(),this.updateMatchedIterLocation(),this.scrollToPosition()};if(99===e||-99===e)t(),this.clickMatchedTimerStart=setTimeout((()=>{this.clickMatchedTimer=setInterval(t,100)}),500);else{if(1!==e&&-1!==e)return;t()}}},this.renderInfoTabs=()=>{const e=this.props.infoTypes.map((e=>{switch(e){case DL.IMAGE_FILE:return Object(xm.jsx)(u.Q,{id:e,title:"File Information"},e);case DL.IMAGE_HEADER:return Object(xm.jsx)(u.Q,{id:e,title:"Header"},e);case DL.SAVE_IMAGE:return Object(xm.jsx)(u.Q,{id:e,title:"Save Image"},e);case DL.CATALOG_FILE:return Object(xm.jsx)(u.Q,{id:e,title:"Catalog Information"},e);case DL.CATALOG_HEADER:return Object(xm.jsx)(u.Q,{id:e,title:"Catalog Header"},e);case DL.REGION_FILE:return Object(xm.jsx)(u.Q,{id:e,title:"Region Information"},e);case DL.SELECT_REGION:return Object(xm.jsx)(u.Q,{id:e,title:"Select Regions"},e);default:return""}}));return Object(xm.jsx)(u.R,{id:"file-info-tabs",onChange:e=>this.props.handleTabChange(e),selectedTabId:this.props.selectedTab,children:e})},this.renderHDUList=()=>{var e;return this.props.HDUOptions&&(null===(e=this.props.HDUOptions.HDUList)||void 0===e?void 0:e.length)>1?Object(xm.jsxs)(u.l,{vertical:!1,children:[Object(xm.jsx)(u.n,{}),Object(xm.jsx)(u.p,{inline:!0,label:"HDU",children:Object(xm.jsx)(u.r,{options:this.props.HDUOptions.HDUList,onChange:e=>this.props.HDUOptions.handleSelectedHDUChange(e.currentTarget.value)})})]}):void 0},this.renderInfoPanel=()=>{switch(this.props.selectedTab){case DL.SAVE_IMAGE:case DL.SELECT_REGION:if(!gC.Instance.activeFrame)return Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"});break;default:if(this.props.isLoading)return Object(xm.jsx)(u.C,{className:"non-ideal-state-file",icon:Object(xm.jsx)(u.O,{className:"astLoadingSpinner"}),title:"Loading file info..."});if(this.props.errorMessage)return Object(xm.jsx)(u.C,{className:"non-ideal-state-file",icon:"document",title:"Cannot open file!",description:this.props.errorMessage+" Select another file from the folder."});if(!this.props.fileInfoExtended&&!this.props.regionFileInfo&&!this.props.catalogFileInfo)return Object(xm.jsx)(u.C,{className:"non-ideal-state-file",icon:"document",title:"No file selected.",description:"Select a file from the folder."})}switch(this.props.selectedTab){case DL.SAVE_IMAGE:return Object(xm.jsx)(ON,{});case DL.SELECT_REGION:return Object(xm.jsx)(zN,{});case DL.IMAGE_FILE:return this.renderImageHeaderList(this.props.fileInfoExtended.computedEntries);case DL.IMAGE_HEADER:return this.renderImageHeaderList(this.props.fileInfoExtended.headerEntries);case DL.REGION_FILE:return Object(xm.jsx)(u.I,{className:"file-info-pre",children:this.props.regionFileInfo});case DL.CATALOG_FILE:return Object(xm.jsx)(u.I,{className:"file-info-pre",children:Object(xm.jsx)(u.U,{children:this.props.catalogFileInfo.description})});case DL.CATALOG_HEADER:return this.props.catalogHeaderTable?Object(xm.jsx)(u.I,{className:"file-header-table",children:Object(xm.jsx)(ij,{...this.props.catalogHeaderTable})}):"";default:return""}},this.highlightString=(e,t,i,n)=>{if(!isFinite(e)||e<0||!t)return null;const r=this.splitLengthArray[e],o=t.length+3+i.length;let s=[],a=0,l="",c="header-name",d=0,p=(e,r)=>{isFinite(e)&&isFinite(r)&&(s.push(Object(xm.jsx)("span",{className:c+l,children:("END"!==t?`${t} = ${i}${n&&" / "+n}`:t).slice(e,r)},a.toString())),a+=1)};return r.forEach(((i,r)=>{l="";for(const s of[i,this.searchString.length]){const i=d;d+=s,"END"===t?p(i,i+s):n&&"header-name"===c&&d>=o?(p(i,t.length),c="header-value",p(t.length,o),c="header-comment",p(o,i+s)):"header-name"===c&&d>=t.length?(p(i,t.length),c="header-value",p(t.length,i+s)):n&&"header-value"===c&&d>o?(p(i,o),c="header-comment",p(o,i+s)):p(i,i+s),l=e===this.matchedIterLocation.line&&r===this.matchedIterLocation.num?" info-highlight-selected":" info-highlight"}})),s.pop(),s},this.renderImageHeaderList=e=>{this.props.selectedFile!==this.selectedFile&&(this.isSearchOpened=!1),this.selectedFile=this.props.selectedFile;const t=({index:t,style:i})=>{if(t<0||t>=(null===e||void 0===e?void 0:e.length))return null;const n=e[t];return this.isSearchOpened&&this.props.selectedTab===DL.IMAGE_HEADER&&""!==this.searchString?Object(xm.jsx)("div",{style:i,className:"header-entry",children:this.highlightString(t,n.name,n.value,n.comment)}):"END"===n.name?Object(xm.jsx)("div",{style:i,className:"header-name",children:`${n.name}`}):Object(xm.jsxs)("div",{style:i,className:"header-entry",children:[Object(xm.jsx)("span",{className:"header-name",children:n.name}),Object(xm.jsxs)("span",{className:"header-value",children:[" = ",`${n.value}`]}),n.comment&&Object(xm.jsxs)("span",{className:"header-comment",children:[" / ",n.comment," "]})]})},i=(null===e||void 0===e?void 0:e.length)||0;return Object(xm.jsx)(kL.a,{children:({height:e,width:n})=>Object(xm.jsx)(FL.a,{className:"header-list bp3-code-block",itemCount:i,itemSize:18,height:e,width:n,ref:this.listRef,children:t})})},this.renderHeaderToolbar=()=>{const e=Object(xm.jsxs)(u.f,{className:"header-search",children:[Object(xm.jsxs)("span",{className:"header-search-iter",children:["\xa0",this.matchedIter," of ",this.matchedTotal,"\xa0"]}),Object(xm.jsx)(u.e,{icon:"caret-left",minimal:!0,onMouseDown:()=>this.handleClickMatched(-99),onMouseUp:()=>this.handleClickMatched(0),onKeyDown:e=>this.handleClickMatched(-1,e),disabled:0===this.matchedIter||1===this.matchedTotal}),Object(xm.jsx)(u.e,{icon:"caret-right",minimal:!0,onMouseDown:()=>this.handleClickMatched(99),onMouseUp:()=>this.handleClickMatched(0),onKeyDown:e=>this.handleClickMatched(1,e),disabled:0===this.matchedIter||1===this.matchedTotal})]});return this.props.isLoading||this.props.errorMessage||!this.props.fileInfoExtended||this.props.selectedTab!==DL.IMAGE_HEADER?null:Object(xm.jsxs)(u.f,{className:"header-search-button",style:{opacity:this.isMouseEntered||this.isSearchOpened?1:0},children:[Object(xm.jsx)(O.a,{position:y.a.LEFT,interactionKind:O.b.CLICK_TARGET_ONLY,modifiers:{arrow:{enabled:!1},offset:{enabled:!0,options:{offset:[0,10]}}},onOpening:()=>this.handleSearchPanelClicked(!0),onClosing:()=>this.handleSearchPanelClicked(!1),content:Object(xm.jsx)(u.x,{className:"header-search-input",autoFocus:!0,placeholder:"Search text",leftIcon:"search-text",rightElement:e,onChange:this.handleSearchStringChanged,onKeyDown:e=>this.handleClickMatched(1,e)}),children:Object(xm.jsx)(u.e,{icon:"search-text"})}),Object(xm.jsx)(u.e,{icon:"th",onClick:this.exportHeader})]})},this.exportHeader=()=>{const e=this.props.fileInfoExtended.headerEntries,t=`${this.props.fileInfoExtended.computedEntries[0].value}-Header`;let i="";i+=`# ${this.props.fileInfoExtended.computedEntries[0].value}\n`,e.forEach(((e,t)=>{e.comment?i+=`${e.name} = ${e.value} / ${e.comment}\n`:i+=`${e.name} = ${e.value}\n`})),Ym(t,i)},Object(m.p)(this)}render(){return Object(xm.jsxs)("div",{className:"file-info",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(xm.jsxs)("div",{className:"file-info-panel-top",children:[this.renderInfoTabs(),this.renderHDUList()]}),this.renderInfoPanel(),this.renderHeaderToolbar()]})}},xL=Object(b.a)(jL.prototype,"searchString",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),SL=Object(b.a)(jL.prototype,"matchedIter",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),vL=Object(b.a)(jL.prototype,"isMouseEntered",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),CL=Object(b.a)(jL.prototype,"onMouseEnter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0}}}),IL=Object(b.a)(jL.prototype,"onMouseLeave",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1}}}),wL=Object(b.a)(jL.prototype,"resetSearchString",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.searchString=""}}}),TL=Object(b.a)(jL.prototype,"setSearchString",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.searchString=e.replace("\b","")}}}),RL=Object(b.a)(jL.prototype,"resetMatchedIter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.matchedIter=0}}}),AL=Object(b.a)(jL.prototype,"addMatchedIter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{0!==this.matchedIter&&(this.matchedIter>=this.matchedTotal?this.matchedIter=1:this.matchedIter+=1)}}}),PL=Object(b.a)(jL.prototype,"minusMatchedIter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{0!==this.matchedIter&&(1===this.matchedIter?this.matchedIter=this.matchedTotal:this.matchedIter-=1)}}}),EL=Object(b.a)(jL.prototype,"initMatchedIter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.matchedIter=this.matchedTotal>0?1:0}}}),ML=Object(b.a)(jL.prototype,"addMatchedTotal",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.matchedTotal+=e}}}),OL=jL))||OL;var NL,_L,zL,VL,WL,GL,BL,qL,HL,YL=i(442),UL=i.n(YL),XL=i(67);i(838);let $L=Object(p.a)((HL=qL=class e extends n.Component{static GetFileTypeDisplay(t){return e.FileTypeMap.get(t)||{type:"Unknown",description:"An unknown file format"}}static GeCatalogFileTypeDisplay(t){return e.CatalogFileTypeMap.get(t)||{type:"Unknown",description:"An unknown file format"}}static GetFileSizeDisplay(e){return e>=1e12?`${fi(e/1e12,2)} TB`:e>=1e9?`${fi(e/1e9,1)} GB`:e>=1e6?`${fi(e/1e6,1)} MB`:e>=1e3?`${fi(e/1e3,1)} kB`:`${e} B`}get tableEntries(){var t,i;const n=this.props.listResponse;if(!n)return[];const r=this.props.fileBrowserMode;let o=null===n||void 0===n||null===(t=n.subdirectories)||void 0===t?void 0:t.slice(),s=null===n||void 0===n||null===(i=n.files)||void 0===i?void 0:i.slice();const a=this.props.filterString,l=this.props.filterType;if(a)try{let e;if(l===LI.Fuzzy){o=new XL.a(o,["name"]).search(a);s=new XL.a(s,["name"]).search(a)}else if(l===LI.Unix){var c,d;e=RegExp(UL()(a.toLowerCase())),o=null===(c=o)||void 0===c?void 0:c.filter((t=>t.name.toLowerCase().match(e))),s=null===(d=s)||void 0===d?void 0:d.filter((t=>t.name.toLowerCase().match(e)))}else{var p,h;e=RegExp(a),o=null===(p=o)||void 0===p?void 0:p.filter((t=>t.name.match(e))),s=null===(h=s)||void 0===h?void 0:h.filter((t=>t.name.match(e)))}}catch(f){"SyntaxError"!==f.name&&console.log(f)}const u=[],g={direction:this.props.sortingString.startsWith("+")?1:-1,columnName:this.props.sortingString.substring(1).toLowerCase()};if(o&&o.length){switch(null===g||void 0===g?void 0:g.columnName){case"filename":o.sort(((e,t)=>g.direction*(e.name.toLowerCase()<t.name.toLowerCase()?-1:1)));break;case"size":o.sort(((e,t)=>g.direction*(e.itemCount<t.itemCount?-1:1)));break;case"date":o.sort(((e,t)=>g.direction*(e.date<t.date?-1:1)))}for(const e of o)u.push({filename:e.name,size:e.itemCount>0?e.itemCount:void 0,date:e.date,isDirectory:!0})}if(s&&s.length){switch(null===g||void 0===g?void 0:g.columnName){case"filename":s.sort(((e,t)=>g.direction*(e.name.toLowerCase()<t.name.toLowerCase()?-1:1)));break;case"type":s.sort(((e,t)=>g.direction*(e.type<t.type?-1:1)));break;case"size":s.sort(((e,t)=>g.direction*(e.size<t.size?-1:1)));break;case"date":s.sort(((e,t)=>g.direction*(e.date<t.date?-1:1)))}if(r===DI.Catalog)for(const t of s)u.push({filename:t.name,typeInfo:e.GeCatalogFileTypeDisplay(t.type),size:t.fileSize,date:t.date,fileInfo:t});else if(r===DI.File)for(const t of s)for(const i of t.HDUList){const n=t.HDUList.length>1?`${t.name}: HDU ${i}`:t.name;u.push({filename:n,typeInfo:e.GetFileTypeDisplay(t.type),size:t.size,date:t.date,fileInfo:t,hdu:i})}else for(const t of s)u.push({filename:t.name,typeInfo:e.GetFileTypeDisplay(t.type),size:t.size,date:t.date,fileInfo:t})}return u}get selectedFiles(){var e,t;if(!(null===(e=this.tableEntries)||void 0===e?void 0:e.length)||!(null===(t=this.selectedRegions)||void 0===t?void 0:t.length))return[];const i=[];for(const n of this.selectedRegions)for(let e=n.rows[0];e<=n.rows[1];e++)if(e>=0&&e<this.tableEntries.length){const t=this.tableEntries[e];i.push(t)}return i}constructor(t){super(t),Object(f.a)(this,"selectedRegions",zL,this),Object(f.a)(this,"columnWidths",VL,this),this.tableRef=void 0,this.cachedFilterString=void 0,this.cachedSortingString=void 0,this.cachedFileResponse=void 0,this.rowPivotIndex=-1,Object(f.a)(this,"selectEntry",WL,this),Object(f.a)(this,"handleColumnWidthChanged",GL,this),this.renderColumnHeader=(e,t)=>{const i={direction:this.props.sortingString.startsWith("+")?1:-1,columnName:this.props.sortingString.substring(1).toLowerCase()},n=e.toLowerCase()===(null===i||void 0===i?void 0:i.columnName),r=(null===i||void 0===i?void 0:i.direction)<0;return Object(xm.jsx)(XO.a,{className:"column-name",nameRenderer:()=>n?Object(xm.jsx)("div",{className:"sort-label",onClick:()=>this.props.onSortingChanged(e,-i.direction),children:Object(xm.jsxs)(u.y,{className:"bp3-inline label",children:[Object(xm.jsx)(u.w,{className:"sort-icon",icon:r?"sort-desc":"sort-asc"}),e]})}):Object(xm.jsx)("div",{className:"sort-label",onClick:()=>this.props.onSortingChanged(e,1),children:Object(xm.jsxs)(u.y,{className:"bp3-inline label",children:[Object(xm.jsx)(u.w,{className:"sort-icon inactive",icon:"sort"}),e]})})})},this.renderFilenames=e=>{const t=this.tableEntries[e];return t?Object(xm.jsx)($O.a,{className:t.isDirectory?"folder-cell":"filename-cell",tooltip:null===t||void 0===t?void 0:t.filename,children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsxs)("div",{onClick:i=>this.handleEntryClicked(i,t,e),onDoubleClick:()=>this.handleEntryDoubleClicked(t),children:[(null===t||void 0===t?void 0:t.isDirectory)&&Object(xm.jsx)(u.w,{icon:"folder-close"}),Object(xm.jsx)("span",{className:"cell-text",children:null===t||void 0===t?void 0:t.filename})]})})}):Object(xm.jsx)($O.a,{loading:!0})},this.renderTypes=e=>{var t,i;const r=this.tableEntries[e];return r?Object(xm.jsx)($O.a,{tooltip:null===(t=r.typeInfo)||void 0===t?void 0:t.description,children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsx)("div",{onClick:t=>this.handleEntryClicked(t,r,e),onDoubleClick:()=>this.handleEntryDoubleClicked(r),children:null===(i=r.typeInfo)||void 0===i?void 0:i.type})})}):Object(xm.jsx)($O.a,{loading:!0})},this.renderSizes=t=>{const i=this.tableEntries[t];if(!i)return Object(xm.jsx)($O.a,{loading:!0});const r=null===i||void 0===i?void 0:i.size;return Object(xm.jsx)($O.a,{children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsxs)("div",{onClick:e=>this.handleEntryClicked(e,i,t),onDoubleClick:()=>this.handleEntryDoubleClicked(i),children:[isFinite(r)&&!i.isDirectory&&e.GetFileSizeDisplay(r),isFinite(r)&&i.isDirectory&&`${r} items`]})})})},this.renderDates=e=>{const t=this.tableEntries[e];if(!t)return Object(xm.jsx)($O.a,{loading:!0});const i=t.date;let r;if(i>0){const e=_i.a.unix(i);r=_i()(0,"HH").diff(e)<=0?e.format("HH:mm"):e.format("D MMM YYYY")}return Object(xm.jsx)($O.a,{className:"time-cell",children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsx)("div",{onClick:i=>this.handleEntryClicked(i,t,e),onDoubleClick:()=>this.handleEntryDoubleClicked(t),children:r})})})},this.handleEntryDoubleClicked=e=>{(null===e||void 0===e?void 0:e.isDirectory)||this.props.onFileDoubleClicked(e)},Object(f.a)(this,"handleEntryClicked",BL,this),Object(m.p)(this),Object(m.h)((()=>{const e=this.props.listResponse,t=this.props.sortingString,i=this.props.filterString;e===this.cachedFileResponse&&t===this.cachedSortingString&&i===this.cachedFilterString||(this.cachedSortingString=t,this.cachedFilterString=i,this.cachedFileResponse=e,Object(m.t)((()=>this.selectedRegions=[])),this.rowPivotIndex=-1,this.props.onSelectionChanged([]),setTimeout((()=>{var e;return null===(e=this.tableRef)||void 0===e?void 0:e.scrollToRegion(qn.c.row(0,0))}),20))}))}render(){var t,i;const n=this.props.listResponse,r=(this.props.sortingString,["browser-table"]);this.props.darkTheme&&r.push("bp3-dark");const o=this.tableEntries.length,s=((null===n||void 0===n||null===(t=n.files)||void 0===t?void 0:t.length)||0)+((null===n||void 0===n||null===(i=n.subdirectories)||void 0===i?void 0:i.length)||0);let a;if(this.props.extendedLoading||!s&&this.props.loading){let e,t;const i=this.props.fileProgress;(null===i||void 0===i?void 0:i.total)>0&&(e=`Loading ${i.checked} / ${i.total}`,t=i.checked/i.total),a=Object(xm.jsx)(u.C,{icon:Object(xm.jsx)(u.O,{value:t,intent:"primary"}),title:"Loading file list",description:e,children:Object(xm.jsx)(u.e,{intent:"warning",onClick:this.props.onListCancelled,children:"Cancel"})})}else s?o||(a=Object(xm.jsx)(u.C,{icon:"search",title:"No results",description:"There are no files or subdirectories matching the filter expression"})):a=Object(xm.jsx)(u.C,{icon:"folder-open",title:"Empty folder",description:"There are no files or subdirectories in this folder"});const l=Object(xm.jsxs)(QO.a,{ref:e=>this.tableRef=e,className:r.join(" "),enableRowReordering:!1,renderMode:ZO.a.NONE,selectionModes:qn.d.NONE,enableGhostCells:!1,columnWidths:this.columnWidths,minColumnWidth:80,enableMultipleSelection:!0,enableRowResizing:!1,defaultRowHeight:e.RowHeight,onColumnWidthChanged:this.handleColumnWidthChanged,selectedRegions:this.selectedRegions,enableRowHeader:!1,numRows:this.tableEntries.length,loadingOptions:this.props.loading?[qn.e.CELLS]:[],children:[Object(xm.jsx)(KO.a,{name:"Filename",columnHeaderCellRenderer:()=>this.renderColumnHeader("Filename"),cellRenderer:this.renderFilenames}),Object(xm.jsx)(KO.a,{name:"Type",columnHeaderCellRenderer:()=>this.renderColumnHeader("Type"),cellRenderer:this.renderTypes}),Object(xm.jsx)(KO.a,{name:"Size",columnHeaderCellRenderer:()=>this.renderColumnHeader("Size"),cellRenderer:this.renderSizes}),Object(xm.jsx)(KO.a,{name:"Date",columnHeaderCellRenderer:()=>this.renderColumnHeader("Date"),cellRenderer:this.renderDates})]});return Object(xm.jsxs)("div",{className:"file-table-container",children:[a,l]})}},qL.RowHeight=22,qL.FileTypeMap=new Map([[Nt.FileType.CASA,{type:"CASA",description:"CASA Image"}],[Nt.FileType.CRTF,{type:"CRTF",description:"CASA Region Text Format"}],[Nt.FileType.DS9_REG,{type:"DS9",description:"DS9 Region Format"}],[Nt.FileType.FITS,{type:"FITS",description:"Flexible Image Transport System"}],[Nt.FileType.HDF5,{type:"HDF5",description:"HDF5 File (IDIA Schema)"}],[Nt.FileType.MIRIAD,{type:"Miriad",description:"Miriad Image"}]]),qL.CatalogFileTypeMap=new Map([[Nt.CatalogFileType.FITSTable,{type:"FITS",description:"Flexible Image Transport System"}],[Nt.CatalogFileType.VOTable,{type:"VOTable",description:"XML-Based Table Format"}]]),_L=HL,zL=Object(b.a)(_L.prototype,"selectedRegions",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VL=Object(b.a)(_L.prototype,"columnWidths",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[350,80,90,95]}}),Object(b.a)(_L.prototype,"tableEntries",[m.i],Object.getOwnPropertyDescriptor(_L.prototype,"tableEntries"),_L.prototype),Object(b.a)(_L.prototype,"selectedFiles",[m.i],Object.getOwnPropertyDescriptor(_L.prototype,"selectedFiles"),_L.prototype),WL=Object(b.a)(_L.prototype,"selectEntry",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&(e.isDirectory?(this.props.onFolderClicked(e.filename),this.selectedRegions=void 0,this.rowPivotIndex=-1,this.props.onSelectionChanged([])):(this.props.onFileClicked(e),this.selectedRegions=[qn.c.row(t)],this.rowPivotIndex=t,this.props.onSelectionChanged(this.selectedFiles)))}}}),GL=Object(b.a)(_L.prototype,"handleColumnWidthChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e>=0&&e<this.columnWidths.length&&(this.columnWidths[e]=t)}}}),BL=Object(b.a)(_L.prototype,"handleEntryClicked",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(t)if(t.isDirectory)this.props.onFolderClicked(t.filename),this.selectedRegions=[],this.rowPivotIndex=-1;else{var n;if((e.ctrlKey||e.metaKey)&&this.selectedRegions.length){const e=qn.c.row(i),t=qn.c.findMatchingRegion(this.selectedRegions,e);-1===t?(this.selectedRegions.push(e),this.selectedRegions=this.selectedRegions.slice()):(this.selectedRegions=this.selectedRegions.filter((e=>e!==this.selectedRegions[t])),this.selectedRegions.length||(this.selectedRegions=[qn.c.row(i)]))}else if(e.shiftKey&&this.selectedRegions.length){const e=qn.c.row(this.rowPivotIndex,i);this.selectedRegions=[];for(let t=e.rows[0];t<=e.rows[1];t++)this.selectedRegions.push(qn.c.row(t))}else this.selectedRegions=[qn.c.row(i)],this.rowPivotIndex=i;1===(null===(n=this.selectedRegions)||void 0===n?void 0:n.length)&&this.props.onFileClicked(this.tableEntries[this.selectedRegions[0].rows[0]])}this.props.onSelectionChanged(this.selectedFiles)}}}),NL=_L))||NL;var KL,QL,ZL,JL,eN,tN,iN,nN,rN,oN,sN,aN,lN,cN,dN,pN,hN,uN,gN,fN;i(839);let bN=Object(p.a)((QL=class e extends n.Component{constructor(e){super(e),Object(f.a)(this,"overwriteExistingFileAlertVisible",ZL,this),Object(f.a)(this,"fileFilterString",JL,this),Object(f.a)(this,"debouncedFilterString",eN,this),Object(f.a)(this,"defaultWidth",tN,this),Object(f.a)(this,"defaultHeight",iN,this),Object(f.a)(this,"enableImageArithmetic",nN,this),Object(f.a)(this,"imageArithmeticString",rN,this),this.imageArithmeticInputRef=void 0,this.handleTabChange=e=>{NI.Instance.setSelectedTab(e)},Object(f.a)(this,"handleFileClicked",oN,this),this.loadSelectedFiles=async()=>{const e=gC.Instance,t=e.fileBrowserStore;if(t.selectedFiles.length>1){e.setLoadingMultipleFiles(!0);for(let e=0;e<t.selectedFiles.length;e++)try{await this.loadFile(t.selectedFiles[e],e>0)}catch(i){console.log(i)}e.setLoadingMultipleFiles(!1)}else await this.loadFile({fileInfo:t.selectedFile,hdu:t.selectedHDU})},this.loadExpression=async()=>{const e=gC.Instance,t=e.frames,i=e.fileBrowserStore;let n;return n=i.appendingFrame&&t.length?await e.appendFile(i.fileList.directory,this.imageArithmeticString,"",!0):await e.openFile(i.fileList.directory,this.imageArithmeticString,"",!0),i.saveStartingDirectory(),this.clearArithmeticString(),this.setEnableImageArithmetic(!1),n},this.loadComplexImage=async(e,t)=>{const i=`${t}("${e}")`,n=gC.Instance,r=n.frames,o=n.fileBrowserStore;let s;return s=o.appendingFrame&&r.length?await n.appendFile(o.fileList.directory,i,"",!0):await n.openFile(o.fileList.directory,i,"",!0),o.saveStartingDirectory(),s},this.loadFile=async(e,t=!1)=>{const i=gC.Instance,n=i.fileBrowserStore;let r;switch(n.browserMode){case DI.RegionExport:case DI.SaveFile:return}if(n.browserMode===DI.File){const o=i.frames;r=(t||n.appendingFrame)&&o.length?await i.appendFile(n.fileList.directory,e.fileInfo.name,e.hdu):await i.openFile(n.fileList.directory,e.fileInfo.name,e.hdu)}else n.browserMode===DI.Catalog?await i.appendCatalog(n.catalogFileList.directory,e.fileInfo.name,LM.InitTableRows,Nt.CatalogFileType.VOTable):(n.setImportingRegions(!0),n.showLoadingDialog(),await i.importRegion(n.fileList.directory,e.fileInfo.name,e.fileInfo.type),n.resetLoadingStates());return n.saveStartingDirectory(),r},this.handleSaveFile=async()=>{const e=gC.Instance,t=NI.Instance,i=e.activeFrame,n=t.saveFilename.trim(),r=t.saveSpectralRange?i.findChannelIndexByValue(parseFloat(t.saveSpectralRange[0])):0,o=t.saveSpectralRange?i.findChannelIndexByValue(parseFloat(t.saveSpectralRange[1])):i.numChannels-1,s=Math.min(r,o),a=Math.max(r,o);let l=[];i.numChannels>1&&(l=[Math.max(s,0),Math.min(a,i.numChannels-1),1]);const c=t.saveStokesRange,d=i.headerRestFreq===t.saveRestFreqInHz?NaN:t.saveRestFreqInHz;await e.saveFile(t.fileList.directory,n,t.saveFileType,t.saveRegionId,l,c,t.shouldDropDegenerateAxes,d)},this.handleSaveFileClicked=()=>{const e=NI.Instance,t=e.saveFilename.trim();e.fileList&&e.fileList.files&&e.fileList.files.find((e=>e.name.trim()===t))?this.overwriteExistingFileAlertVisible=!0:this.handleSaveFile()},this.handleSaveFileNameChanged=e=>{NI.Instance.setSaveFilename(e.target.value)},this.handleExportRegionsClicked=()=>{const e=NI.Instance,t=e.exportFilename.trim();e.fileList&&e.fileList.files&&e.fileList.files.find((e=>e.name.trim()===t))?this.overwriteExistingFileAlertVisible=!0:this.exportRegion(e.fileList.directory,t)},this.exportRegion=(e,t)=>{if(!t||!e)return;t=t.trim();const i=gC.Instance,n=NI.Instance;i.exportRegions(e,t,n.exportCoordinateType,n.exportFileType,n.exportRegionIndexes),console.log(`Exporting regions to ${e}/${t}`)},this.handleOverwriteAlertConfirmed=()=>{this.overwriteExistingFileAlertVisible=!1;const e=NI.Instance;if(e.browserMode===DI.RegionExport){const t=e.exportFilename.trim();this.exportRegion(e.fileList.directory,t)}else e.browserMode===DI.SaveFile&&this.handleSaveFile()},this.handleOverwriteAlertDismissed=()=>{this.overwriteExistingFileAlertVisible=!1},this.handleExportInputChanged=e=>{NI.Instance.setExportFilename(e.target.value)},this.handleFileListRequestCancelled=()=>{const e=NI.Instance;e.cancelRequestingFileList(),e.resetLoadingStates()},Object(f.a)(this,"handleFilterStringInputChanged",sN,this),Object(f.a)(this,"handleImageArithmeticStringChanged",aN,this),this.setFilterString=T.debounce((e=>Object(m.t)((()=>{this.debouncedFilterString=e}))),500),Object(f.a)(this,"clearFilterString",lN,this),Object(f.a)(this,"clearArithmeticString",cN,this),Object(f.a)(this,"handleFolderClicked",dN,this),Object(f.a)(this,"handleBreadcrumbClicked",pN,this),Object(f.a)(this,"setFilterType",hN,this),Object(f.a)(this,"setEnableImageArithmetic",uN,this),this.handleImageArithmeticKeyDown=e=>{"Enter"===e.key&&this.loadExpression()},Object(f.a)(this,"refreshFileList",gN,this),Object(f.a)(this,"updateDefaultSize",fN,this),this.closeFileBrowser=()=>{const e=gC.Instance,t=e.fileBrowserStore;e.dialogStore.stokesDialogVisible&&e.dialogStore.hideStokesDialog(),t.hideFileBrowser()},this.renderBreadcrumb=e=>Object(xm.jsxs)(u.c,{onClick:e.onClick,className:"folder-breadcrumb",children:[e.icon&&Object(xm.jsx)(u.w,{iconSize:14,icon:e.icon}),e.text]}),Object(m.p)(this),this.defaultWidth=1200,this.defaultHeight=600,this.imageArithmeticInputRef=n.createRef()}static ValidateFilename(e){return e&&e.length&&!e.match(/(\.\.)|(\\)+/gm)}renderActionButton(t,i){const n=gC.Instance,r=n.fileBrowserStore;switch(t){case DI.File:let t,f;if(this.enableImageArithmetic?(t=n.fileLoading||!this.imageArithmeticString,f=this.loadExpression):(t=n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo,f=this.loadSelectedFiles),i){var o,s;let e;if(e=this.enableImageArithmetic?"Append expression":(null===(o=r.selectedFiles)||void 0===o?void 0:o.length)>1?"Append selected":"Append",r.isComplexImage&&1===(null===(s=r.selectedFiles)||void 0===s?void 0:s.length)){const e=Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"Amplitude",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"AMPLITUDE")}),Object(xm.jsx)(u.B,{text:"Phase",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"PHASE")}),Object(xm.jsx)(u.B,{text:"Real",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"REAL")}),Object(xm.jsx)(u.B,{text:"Imaginary",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"IMAG")})]});return Object(xm.jsx)("div",{children:Object(xm.jsx)(O.a,{content:e,placement:"right-end",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t,text:"Append as"})})})}var a,l;return Object(xm.jsxs)("div",{children:[Object(xm.jsx)(j.a,{content:"Append this image while keeping other images open",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t,onClick:f,text:e})}),!this.enableImageArithmetic&&(null===(a=r.selectedFiles)||void 0===a?void 0:a.length)>1&&(null===(l=r.selectedFiles)||void 0===l?void 0:l.length)<5&&Object(xm.jsx)(j.a,{content:"Append this image while keeping other images open",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t,onClick:n.dialogStore.showStokesDialog,text:"Load as hypercube"})})]})}{var c,d;let e;if(e=this.enableImageArithmetic?"Load expression":(null===(c=r.selectedFiles)||void 0===c?void 0:c.length)>1?"Load selected":"Load",r.isComplexImage&&1===(null===(d=r.selectedFiles)||void 0===d?void 0:d.length)){const e=Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"Amplitude",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"AMPLITUDE")}),Object(xm.jsx)(u.B,{text:"Phase",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"PHASE")}),Object(xm.jsx)(u.B,{text:"Real",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"REAL")}),Object(xm.jsx)(u.B,{text:"Imaginary",intent:g.a.PRIMARY,disabled:t,onClick:()=>this.loadComplexImage(r.selectedFile.name,"IMAG")})]});return Object(xm.jsx)("div",{children:Object(xm.jsx)(O.a,{content:e,placement:"right-end",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t,text:"Load as"})})})}var p,h;return Object(xm.jsxs)("div",{children:[Object(xm.jsx)(j.a,{content:"Close any existing images and load this image",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t,onClick:f,text:e})}),!this.enableImageArithmetic&&(null===(p=r.selectedFiles)||void 0===p?void 0:p.length)>1&&(null===(h=r.selectedFiles)||void 0===h?void 0:h.length)<5&&Object(xm.jsx)(j.a,{content:"Close any existing images and load this image",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t,onClick:n.dialogStore.showStokesDialog,text:"Load as hypercube"})})]})}case DI.SaveFile:return Object(xm.jsx)(j.a,{content:"Save this file",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:n.fileLoading||r.loadingInfo||n.fileSaving,onClick:this.handleSaveFileClicked,text:"Save"})});case DI.RegionImport:return Object(xm.jsx)(j.a,{content:"Load a region file for the currently active image",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo,onClick:this.loadSelectedFiles,text:"Load Region"})});case DI.Catalog:return Object(xm.jsx)(j.a,{content:"Load a catalog file for the currently active image",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo||!n.activeFrame,onClick:this.loadSelectedFiles,text:"Load Catalog"})});case DI.RegionExport:const b=n.activeFrame;return Object(xm.jsx)(j.a,{content:"Export regions for the currently active image",children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:!e.ValidateFilename(r.exportFilename)||!b||b.regionSet.regions.length<=1||r.exportRegionNum<1,onClick:this.handleExportRegionsClicked,text:"Export Regions"})});default:return""}}renderExportFilenameInput(){const e=NI.Instance,t=Object(xm.jsx)(O.a,{minimal:!0,content:Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"World Coordinates",onClick:()=>e.setExportCoordinateType(Nt.CoordinateType.WORLD)}),Object(xm.jsx)(u.B,{text:"Pixel Coordinates",onClick:()=>e.setExportCoordinateType(Nt.CoordinateType.PIXEL)})]}),position:y.a.BOTTOM_RIGHT,children:Object(xm.jsx)(u.e,{minimal:!0,rightIcon:"caret-down",children:e.exportCoordinateType===Nt.CoordinateType.WORLD?"World":"Pixel"})}),i=Object(xm.jsx)(O.a,{minimal:!0,content:Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"CRTF Region File",onClick:()=>e.setExportFileType(Nt.FileType.CRTF)}),Object(xm.jsx)(u.B,{text:"DS9 Region File",onClick:()=>e.setExportFileType(Nt.FileType.DS9_REG)})]}),position:y.a.BOTTOM_RIGHT,children:Object(xm.jsx)(u.e,{minimal:!0,rightIcon:"caret-down",children:e.exportFileType===Nt.FileType.CRTF?"CRTF":"DS9"})});let n=Object(xm.jsxs)("div",{children:[i,t]});return Object(xm.jsx)(u.x,{autoFocus:!0,placeholder:"Enter file name",value:e.exportFilename,onChange:this.handleExportInputChanged,rightElement:n})}renderSaveFilenameInput(){const e=NI.Instance,t=Object(xm.jsx)(O.a,{minimal:!0,content:Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"CASA",onClick:()=>e.setSaveFileType(Nt.FileType.CASA)}),Object(xm.jsx)(u.B,{text:"FITS",onClick:()=>e.setSaveFileType(Nt.FileType.FITS)})]}),position:y.a.BOTTOM_RIGHT,children:Object(xm.jsx)(u.e,{minimal:!0,rightIcon:"caret-down",children:e.saveFileType===Nt.FileType.CASA?"CASA":"FITS"})});return Object(xm.jsx)(u.x,{autoFocus:!0,placeholder:"Enter file name",value:e.saveFilename,onChange:this.handleSaveFileNameChanged,rightElement:t})}renderOpenFilenameInput(e){let t,i;switch(JA.Instance.fileFilteringType){case LI.Fuzzy:t="Fuzzy search",i="Filter by filename with fuzzy search";break;case LI.Unix:t="Unix pattern",i="Filter by filename using unix-style pattern";break;case LI.Regex:t="Regular expression",i="Filter by filename using regular expression"}const n=Object(xm.jsx)(O.a,{minimal:!0,content:Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"Fuzzy search",onClick:()=>this.setFilterType(LI.Fuzzy)}),Object(xm.jsx)(u.B,{text:"Unix pattern",onClick:()=>this.setFilterType(LI.Unix)}),Object(xm.jsx)(u.B,{text:"Regular expression",onClick:()=>this.setFilterType(LI.Regex)})]}),placement:"bottom-end",children:Object(xm.jsx)(u.e,{minimal:!0,icon:"filter",rightIcon:"caret-down",children:t})});if(e===DI.File){const e=Object(xm.jsx)(O.a,{minimal:!0,content:Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:"List filtering",onClick:()=>this.setEnableImageArithmetic(!1)}),Object(xm.jsx)(u.B,{text:"Image arithmetic",onClick:()=>this.setEnableImageArithmetic(!0)})]}),placement:"bottom-start",children:Object(xm.jsx)(u.e,{minimal:!0,icon:this.enableImageArithmetic?"calculator":"search",rightIcon:"caret-down",children:this.enableImageArithmetic?"Image arithmetic":"Filter"})});return this.enableImageArithmetic?Object(xm.jsx)(u.x,{inputRef:this.imageArithmeticInputRef,autoFocus:!0,placeholder:"Enter an image arithmetic expression",value:this.imageArithmeticString,onChange:this.handleImageArithmeticStringChanged,leftElement:e,onKeyDown:this.handleImageArithmeticKeyDown}):Object(xm.jsx)(u.x,{autoFocus:!1,placeholder:i,value:this.fileFilterString,onChange:this.handleFilterStringInputChanged,leftElement:e,rightElement:n})}return Object(xm.jsx)(u.x,{autoFocus:!1,placeholder:i,value:this.fileFilterString,onChange:this.handleFilterStringInputChanged,leftIcon:"search",rightElement:n})}render(){const t=gC.Instance,i=t.fileBrowserStore,r={icon:"folder-open",className:d()("file-browser-dialog",{"bp3-dark":t.darkTheme}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.fileBrowserDialogVisible,onClose:this.closeFileBrowser,onOpened:this.refreshFileList,title:"File Browser"},o=this.renderActionButton(i.browserMode,i.appendingFrame);let s;s=i.browserMode===DI.SaveFile?this.renderSaveFilenameInput():i.browserMode===DI.RegionExport?this.renderExportFilenameInput():this.renderOpenFilenameInput(i.browserMode);let a,l=null;if(i.browserMode===DI.Catalog&&i.catalogHeaders&&i.catalogHeaders.length){const e=i.catalogHeaderDataset;l={dataset:e.columnsData,columnHeaders:e.columnHeaders,numVisibleRows:i.catalogHeaders.length}}i.loadingProgress&&(a={total:i.loadingTotalCount,checked:i.loadingCheckedCount});const c=i.getfileListByMode;return Object(xm.jsxs)(fL,{dialogProps:r,helpType:xM.FILE_BROWSER,minWidth:400,minHeight:400,defaultWidth:this.defaultWidth,defaultHeight:this.defaultHeight,enableResizing:!0,onResizeStop:this.updateDefaultSize,children:[Object(xm.jsx)("div",{className:"file-path",children:this.pathItems&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(j.a,{content:"Refresh current directory",children:Object(xm.jsx)(u.b,{className:"refresh-button",icon:"repeat",onClick:()=>i.selectFolder(c.directory,!0),minimal:!0})}),Object(xm.jsx)(u.d,{className:"path-breadcrumbs",breadcrumbRenderer:this.renderBreadcrumb,items:this.pathItems})]})}),Object(xm.jsxs)("div",{className:"bp3-dialog-body",children:[Object(xm.jsxs)("div",{className:"file-panes",children:[Object(xm.jsx)("div",{className:"file-list",children:Object(xm.jsx)($L,{darkTheme:t.darkTheme,loading:i.loadingList,extendedLoading:i.extendedLoading,fileProgress:a,listResponse:i.getfileListByMode,fileBrowserMode:i.browserMode,selectedFile:i.selectedFile,selectedHDU:i.selectedHDU,filterString:this.debouncedFilterString,filterType:t.preferenceStore.fileFilteringType,sortingString:t.preferenceStore.fileSortingString,onSortingChanged:i.setSortingConfig,onFileClicked:this.handleFileClicked,onSelectionChanged:i.setSelectedFiles,onFileDoubleClicked:this.loadFile,onFolderClicked:this.handleFolderClicked,onListCancelled:this.handleFileListRequestCancelled})}),Object(xm.jsx)("div",{className:"file-info-pane",children:Object(xm.jsx)(LL,{infoTypes:e.GetFileInfoTypes(i.browserMode),HDUOptions:{HDUList:i.HDUList,handleSelectedHDUChange:i.selectHDU},fileInfoExtended:i.fileInfoExtended,regionFileInfo:i.regionFileInfo?i.regionFileInfo.join("\n"):"",catalogFileInfo:i.catalogFileInfo,selectedTab:i.selectedTab,handleTabChange:this.handleTabChange,isLoading:i.loadingInfo,errorMessage:i.responseErrorMessage,catalogHeaderTable:l,selectedFile:i.selectedFile})})]}),s]}),Object(xm.jsx)("div",{className:"bp3-dialog-footer",children:Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(u.b,{intent:g.a.NONE,onClick:this.closeFileBrowser,disabled:t.fileLoading,text:"Close"}),o]})}),Object(xm.jsx)(u.a,{className:t.darkTheme?"bp3-dark":"",isOpen:this.overwriteExistingFileAlertVisible,confirmButtonText:"Yes",cancelButtonText:"Cancel",intent:g.a.DANGER,onConfirm:this.handleOverwriteAlertConfirmed,onCancel:this.handleOverwriteAlertDismissed,canEscapeKeyCancel:!0,children:"This file exists. Are you sure to overwrite it?"}),Object(xm.jsx)(WN,{isOpen:i.isImportingRegions&&i.isLoadingDialogOpen&&i.loadingProgress<1,progress:i.loadingProgress,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!1,text:"Importing regions",contentText:`loading ${i.loadingCheckedCount} / ${i.loadingTotalCount}`})]})}static GetFileInfoTypes(e){switch(e){case DI.File:return[DL.IMAGE_FILE,DL.IMAGE_HEADER];case DI.SaveFile:return[DL.SAVE_IMAGE,DL.IMAGE_FILE,DL.IMAGE_HEADER];case DI.Catalog:return[DL.CATALOG_FILE,DL.CATALOG_HEADER];case DI.RegionExport:return[DL.SELECT_REGION,DL.REGION_FILE];default:return[DL.REGION_FILE]}}get pathItems(){let e=[{icon:"desktop",onClick:()=>this.handleBreadcrumbClicked("")}];const t=NI.Instance.getfileListByMode;if(t){const i=t.directory;if(i&&"."!==i){const t=i.split("/");let n="";if(t.length)for(const i of t){if(!i)continue;n+=`/${i}`;const t=n;e.push({text:i,onClick:()=>this.handleBreadcrumbClicked(t)})}}}return e}},ZL=Object(b.a)(QL.prototype,"overwriteExistingFileAlertVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JL=Object(b.a)(QL.prototype,"fileFilterString",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),eN=Object(b.a)(QL.prototype,"debouncedFilterString",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),tN=Object(b.a)(QL.prototype,"defaultWidth",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iN=Object(b.a)(QL.prototype,"defaultHeight",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nN=Object(b.a)(QL.prototype,"enableImageArithmetic",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),rN=Object(b.a)(QL.prototype,"imageArithmeticString",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),oN=Object(b.a)(QL.prototype,"handleFileClicked",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(NI.Instance.selectFile(e),this.enableImageArithmetic){var t,i,n,r,o;const s=/(["'])+/gm,a=(null===(t=this.imageArithmeticString.match(s))||void 0===t?void 0:t.length)%2!==0,l=/([+\-*/(,])\s*$/gm;(null===(i=this.imageArithmeticString.match(l))||void 0===i?void 0:i.length)>0?this.imageArithmeticString+=`"${e.fileInfo.name}"`:(null===(n=this.imageArithmeticString)||void 0===n?void 0:n.endsWith('"'))&&a?this.imageArithmeticString+=`${e.fileInfo.name}"`:(null===(r=this.imageArithmeticString)||void 0===r?void 0:r.endsWith("'"))&&a?this.imageArithmeticString+=`${e.fileInfo.name}'`:this.imageArithmeticString=`"${e.fileInfo.name}"`,null===(o=this.imageArithmeticInputRef.current)||void 0===o||o.focus()}}}}),sN=Object(b.a)(QL.prototype,"handleFilterStringInputChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileFilterString=e.target.value,this.setFilterString(this.fileFilterString)}}}),aN=Object(b.a)(QL.prototype,"handleImageArithmeticStringChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.imageArithmeticString=e.target.value}}}),lN=Object(b.a)(QL.prototype,"clearFilterString",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileFilterString="",this.debouncedFilterString=""}}}),cN=Object(b.a)(QL.prototype,"clearArithmeticString",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageArithmeticString=""}}}),dN=Object(b.a)(QL.prototype,"handleFolderClicked",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),gC.Instance.fileBrowserStore.selectFolder(e)}}}),pN=Object(b.a)(QL.prototype,"handleBreadcrumbClicked",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),gC.Instance.fileBrowserStore.selectFolder(e,!0)}}}),hN=Object(b.a)(QL.prototype,"setFilterType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),JA.Instance.setPreference(QA.SILENT_FILE_FILTERING_TYPE,e)}}}),uN=Object(b.a)(QL.prototype,"setEnableImageArithmetic",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.enableImageArithmetic=e,e&&this.clearFilterString()}}}),gN=Object(b.a)(QL.prototype,"refreshFileList",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearFilterString();const e=NI.Instance;switch(e.browserMode){case DI.Catalog:e.catalogFileList={...e.catalogFileList};break;default:e.fileList={...e.fileList}}}}}),fN=Object(b.a)(QL.prototype,"updateDefaultSize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultWidth=e,this.defaultHeight=t}}}),Object(b.a)(QL.prototype,"pathItems",[m.i],Object.getOwnPropertyDescriptor(QL.prototype,"pathItems"),QL.prototype),KL=QL))||KL;var mN,yN;i(840);let ON=Object(p.a)((yN=class extends n.Component{constructor(e){super(e),this.onChangeShouldDropDegenerateAxes=()=>{const e=NI.Instance;e.shouldDropDegenerateAxes=!e.shouldDropDegenerateAxes},this.handleRegionChanged=e=>{var t;null===(t=NI.Instance)||void 0===t||t.setSaveRegionId(parseInt(e.target.value))},this.handleSaveSpectralRangeStartChanged=(e,t)=>{var i;null===(i=NI.Instance)||void 0===i||i.setSaveSpectralRangeMin(t)},this.handleSaveSpectralRangeEndChanged=(e,t)=>{var i;null===(i=NI.Instance)||void 0===i||i.setSaveSpectralRangeMax(t)},Object(m.p)(this),Object(m.h)((()=>{var e;const t=gC.Instance;(null===(e=t.activeFrame)||void 0===e?void 0:e.numChannels)<=1||this.validSaveSpectralRangeStart&&this.validSaveSpectralRangeEnd?t.endFileSaving():t.startFileSaving()}))}get validSaveSpectralRangeStart(){var e;const t=gC.Instance,i=NI.Instance,n=null===(e=t.activeFrame)||void 0===e?void 0:e.channelValueBounds,r=parseFloat(i.saveSpectralRange[0]);return(null===n||void 0===n?void 0:n.min)<=r&&r<=parseFloat(i.saveSpectralRange[1])}get validSaveSpectralRangeEnd(){var e;const t=gC.Instance,i=NI.Instance,n=null===(e=t.activeFrame)||void 0===e?void 0:e.channelValueBounds,r=parseFloat(i.saveSpectralRange[1]);return parseFloat(i.saveSpectralRange[0])<=r&&r<=(null===n||void 0===n?void 0:n.max)}updateSpectralCoordinate(e){const t=gC.Instance.activeFrame;(null===t||void 0===t?void 0:t.setSpectralCoordinate(e))&&NI.Instance.initialSaveSpectralRange()}updateSpectralSystem(e){const t=gC.Instance.activeFrame;(null===t||void 0===t?void 0:t.setSpectralSystem(e))&&NI.Instance.initialSaveSpectralRange()}updateStokes(e){NI.Instance.saveStokesOption=e}get stokesOptions(){var e;const t=null===(e=gC.Instance.activeFrame)||void 0===e?void 0:e.stokesInfo;if(t){let e=[];const i=(t,i)=>{e.push({value:t,label:i.join(", ").replace(/, Stokes/g,", ")})},n=()=>{i(4,[t[3]]),i(7,t.slice(2,4)),i(9,[t[0],t[3]]),i(10,[t[1],t[3]]),i(11,t.slice(0,3)),i(12,t.slice(1,4))},r=()=>{i(3,[t[2]]),i(5,t.slice(0,2)),i(6,t.slice(1,3)),i(8,[t[0],t[2]])},o=()=>{i(1,[t[0]]),i(2,[t[1]])};switch(i(0,t),t.length){case 4:n(),r(),o();break;case 3:r(),o();break;case 2:o()}return e.sort(((e,t)=>e.value-t.value))}return[]}render(){var e,t,i,r,o;const s=NI.Instance,a=gC.Instance.activeFrame,l=null===a||void 0===a||null===(e=a.regionSet)||void 0===e?void 0:e.regions.filter((e=>e.regionId>0&&e.isClosedRegion)),c=[{value:0,label:"Image"}].concat(null===l||void 0===l?void 0:l.map((e=>({value:e.regionId,label:`${e.name?e.name:e.regionId} (${Nt.RegionType[e.regionType]})`})))),d=a?a.nativeSpectralCoordinate:void 0,p=a&&a.spectralCoordsSupported?Array.from(a.spectralCoordsSupported.keys()).map((e=>({value:e,label:e===d?e+" (Native WCS)":e}))):[],h=a&&a.spectralSystemsSupported?a.spectralSystemsSupported.map((e=>({value:e,label:e}))):[],f=null===a||void 0===a?void 0:a.numChannels,b=null!==(t=null===a||void 0===a||null===(i=a.channelValueBounds)||void 0===i?void 0:i.min)&&void 0!==t?t:0,m=null!==(r=null===a||void 0===a||null===(o=a.channelValueBounds)||void 0===o?void 0:o.max)&&void 0!==r?r:1,y=.1*(f>1?Math.abs(m-b)/(f-1):Math.abs(m-b));return Object(xm.jsx)(n.Fragment,{children:a&&Object(xm.jsxs)("div",{className:"file-save",children:[Object(xm.jsx)(u.p,{className:"file-name",label:"Source",inline:!0,children:Object(xm.jsx)(u.U,{className:"text",ellipsize:!0,title:a.frameInfo.fileInfo.name,children:a.frameInfo.fileInfo.name})}),Object(xm.jsx)(u.p,{className:"region-select",label:"Region",inline:!0,children:Object(xm.jsx)(u.r,{value:s.saveRegionId,onChange:this.handleRegionChanged,options:c})}),f>1&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)("div",{className:"coordinate-select",children:Object(xm.jsxs)(u.p,{label:"Range unit",inline:!0,children:[Object(xm.jsx)(u.r,{value:a&&(a.spectralCoordinate||""),options:p,onChange:e=>this.updateSpectralCoordinate(e.currentTarget.value)}),Object(xm.jsx)(u.r,{value:a&&(a.spectralSystem||""),options:h,onChange:e=>this.updateSpectralSystem(e.currentTarget.value)})]})}),Object(xm.jsxs)("div",{className:"range-select",children:[Object(xm.jsxs)(u.p,{label:"Range from",inline:!0,children:[Object(xm.jsx)(u.D,{value:s.saveSpectralRange[0],buttonPosition:"none",placeholder:"First channel",onValueChange:this.handleSaveSpectralRangeStartChanged,majorStepSize:null,stepSize:y,minorStepSize:null,selectAllOnIncrement:!0,intent:this.validSaveSpectralRangeStart?g.a.NONE:g.a.DANGER}),Object(xm.jsx)(u.y,{children:a.spectralUnit?`(${a.spectralUnit})`:""})]}),Object(xm.jsxs)(u.p,{label:"Range to",inline:!0,children:[Object(xm.jsx)(u.D,{value:s.saveSpectralRange[1],buttonPosition:"none",placeholder:"Last channel",onValueChange:this.handleSaveSpectralRangeEndChanged,majorStepSize:null,stepSize:y,minorStepSize:null,selectAllOnIncrement:!0,intent:this.validSaveSpectralRangeEnd?g.a.NONE:g.a.DANGER}),Object(xm.jsx)(u.y,{children:a.spectralUnit?`(${a.spectralUnit})`:""})]})]})]}),a.hasStokes&&Object(xm.jsx)("div",{className:"stokes-select",children:Object(xm.jsx)(u.p,{label:"Polarization",inline:!0,children:Object(xm.jsx)(u.r,{value:s.saveStokesOption||"",options:this.stokesOptions,onChange:e=>this.updateStokes(parseInt(e.currentTarget.value))})})}),a.isRestFreqEditable&&Object(xm.jsxs)("div",{className:"freq-input",children:[Object(xm.jsx)(hy,{label:"Rest frequency",value:s.saveRestFreq.value,placeholder:"rest frequency",selectAllOnFocus:!0,onValueChanged:s.setSaveRestFreqVal,onValueCleared:s.resetSaveRestFreq,resetDisabled:a.restFreqStore.resetDisable,tooltipContent:a.restFreqStore.defaultInfo,tooltipPlacement:"bottom"}),Object(xm.jsx)(u.r,{options:Object.values(Ht),value:s.saveRestFreq.unit,onChange:e=>s.setSaveRestFreqUnit(e.currentTarget.value)})]}),Object(xm.jsx)(u.P,{className:"drop-degenerate",checked:s.shouldDropDegenerateAxes,label:"Drop degenerate axes",onChange:this.onChangeShouldDropDegenerateAxes})]})})}},Object(b.a)(yN.prototype,"validSaveSpectralRangeStart",[m.i],Object.getOwnPropertyDescriptor(yN.prototype,"validSaveSpectralRangeStart"),yN.prototype),Object(b.a)(yN.prototype,"validSaveSpectralRangeEnd",[m.i],Object.getOwnPropertyDescriptor(yN.prototype,"validSaveSpectralRangeEnd"),yN.prototype),Object(b.a)(yN.prototype,"updateStokes",[m.g],Object.getOwnPropertyDescriptor(yN.prototype,"updateStokes"),yN.prototype),Object(b.a)(yN.prototype,"stokesOptions",[m.i],Object.getOwnPropertyDescriptor(yN.prototype,"stokesOptions"),yN.prototype),mN=yN))||mN;i(841);class jN extends n.Component{render(){const e=d()("custom-icon","bp3-icon",{"dark-theme":gC.Instance.darkTheme}),t=(this.props.size?this.props.size:jN.SIZE_STANDARD)+"px",i=Object(xm.jsx)("span",{className:e,children:Object(xm.jsx)("svg",{width:t,height:t,viewBox:"0 0 16 16",children:LN[this.props.icon]})});return Object(xm.jsx)(u.w,{icon:i})}}jN.SIZE_STANDARD=16,jN.SIZE_LARGE=20;const xN=Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 13.3086,13.326331 A 7.489923,8.4952736 45 0 1 2.0053593,14.037221 7.489923,8.4952736 45 0 1 2.7162497,2.7339802 7.489923,8.4952736 45 0 1 14.01949,2.02309 7.489923,8.4952736 45 0 1 13.3086,13.326331 Z M 13.148613,12.347604 A 6.6468272,7.6124401 40 0 1 3.1636657,13.906573 6.6468272,7.6124401 40 0 1 2.9650831,3.8026076 6.6468272,7.6124401 40 0 1 12.95003,2.2436383 6.6468272,7.6124401 40 0 1 13.148613,12.347604 Z M 10.882979,12.264102 A 4.8685541,5.7219758 50 0 1 3.3702451,12.212588 4.8685541,5.7219758 50 0 1 4.6240863,4.8050444 4.8685541,5.7219758 50 0 1 12.136821,4.8565581 4.8685541,5.7219758 50 0 1 10.882979,12.264102 Z M 10.33713,11.668778 A 4.0524521,4.8181229 50 0 1 4.0413674,11.66145 4.0524521,4.8181229 50 0 1 5.1273981,5.4600614 4.0524521,4.8181229 50 0 1 11.42316,5.4673901 4.0524521,4.8181229 50 0 1 10.33713,11.668778 Z M 7.9142814,10.852556 A 2.047241,2.547725 60 0 1 4.6842662,10.353456 2.047241,2.547725 60 0 1 5.8670405,7.3066306 2.047241,2.547725 60 0 1 9.0970556,7.8057308 2.047241,2.547725 60 0 1 7.9142814,10.852556 Z M 7.5029842,10.217581 A 1.2341059,1.684913 60 0 1 5.426754,9.9912708 1.2341059,1.684913 60 0 1 6.2688783,8.0800472 1.2341059,1.684913 60 0 1 8.3451088,8.3063578 1.2341059,1.684913 60 0 1 7.5029842,10.217581 Z"}),SN=Object(xm.jsxs)("g",{fillRule:"evenodd",clipRule:"evenodd",children:[Object(xm.jsx)("circle",{className:"st0",cx:"8",cy:"8",r:"2"}),Object(xm.jsx)("path",{className:"st0",d:"M2.6,4H2C1.4,4,1,4.4,1,5s0.4,1,1,1h3c0.1,0,0.3,0,0.4-0.1c0.2-0.1,0.4-0.3,0.5-0.5C6,5.2,6,5.1,6,5V2 c0-0.6-0.4-1-1-1S4,1.4,4,2v0.6L1.7,0.3c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4L2.6,4z"}),Object(xm.jsx)("path",{className:"st0",d:"M10.1,5.4c0.1,0.2,0.3,0.4,0.5,0.5S10.9,6,11.1,6h3c0.6,0,1-0.4,1-1s-0.4-1-1-1h-0.6l2.3-2.3 c0.4-0.4,0.4-1,0-1.4c-0.4-0.4-1-0.4-1.4,0L12,2.6V2c0-0.6-0.4-1-1-1s-1,0.4-1,1v3C10,5.1,10,5.2,10.1,5.4z"}),Object(xm.jsx)("path",{className:"st0",d:"M13.4,12H14c0.6,0,1-0.4,1-1s-0.4-1-1-1h-3c-0.1,0-0.3,0-0.4,0.1c-0.2,0.1-0.4,0.3-0.5,0.5 C10,10.8,10,10.9,10,11v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-0.6l2.3,2.3c0.4,0.4,1,0.4,1.4,0c0.4-0.4,0.4-1,0-1.4L13.4,12z"}),Object(xm.jsx)("path",{className:"st0",d:"M5.9,10.6c-0.1-0.2-0.3-0.4-0.5-0.5C5.2,10,5.1,10,4.9,10H2c-0.6,0-1,0.4-1,1s0.4,1,1,1h0.6l-2.3,2.3 c-0.4,0.4-0.4,1,0,1.4c0.4,0.4,1,0.4,1.4,0L4,13.4V14c0,0.6,0.4,1,1,1s1-0.4,1-1v-3C6,10.9,6,10.8,5.9,10.6z"})]}),vN=Object(xm.jsxs)("g",{children:[Object(xm.jsx)("g",{id:"Layer_1-2","data-name":"Layer 1",children:Object(xm.jsx)("path",{className:"cls-1",d:"M1,6H8A.9448.9448,0,0,0,9,5,.9448.9448,0,0,0,8,4H1A1,1,0,0,0,1,6Zm9,6H1a1,1,0,0,0,0,2h9a1,1,0,0,0,0-2Zm0-4H1a1,1,0,0,0,0,2h9a.9448.9448,0,0,0,1-1A.9448.9448,0,0,0,10,8Z"})}),Object(xm.jsx)("path",{d:"M15.6169,5.6628a2.6806,2.6806,0,0,1-.0932-.4019,3.6675,3.6675,0,0,1-.04-.4307q-.0089-.2191-.0244-.43a3.8144,3.8144,0,0,0-.0694-.4062,1.2166,1.2166,0,0,0-.1382-.3533A.8941.8941,0,0,0,15,3.3679a1.0366,1.0366,0,0,0-.4106-.1623V3.1894a1.2325,1.2325,0,0,0,.7676-.5444,1.7581,1.7581,0,0,0,.24-.9262A1.3974,1.3974,0,0,0,15.13.6063,1.9077,1.9077,0,0,0,13.8339.2h-2.73V6h.7722V3.5223h1.8847a1.0267,1.0267,0,0,1,.4549.0852.7677.7677,0,0,1,.2763.2275.9485.9485,0,0,1,.154.3332q.0486.1908.0813.4022a2.9046,2.9046,0,0,1,.049.43q.0078.22.0158.41a2.4616,2.4616,0,0,0,.037.3455A.48.48,0,0,0,14.9386,6H15.8A.9979.9979,0,0,1,15.6169,5.6628ZM14.423,2.6735a1.1087,1.1087,0,0,1-.4264.1583,3.079,3.079,0,0,1-.5117.0406H11.8765V.85h1.9171a1.0026,1.0026,0,0,1,.788.276,1.0431,1.0431,0,0,1,.2433.7149,1.0608,1.0608,0,0,1-.11.516A.8646.8646,0,0,1,14.423,2.6735Z"})]}),CN=Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 8.3904279,2.3870306 6.5797618,4.9256964 h 0.961333 L 8.8850944,2.9283637 10.229094,4.9256964 h 1.017333 L 9.3797609,2.3216973 11.041094,0.10036468 h -0.952 L 8.8850944,1.7896974 7.7277615,0.10036468 h -1.017333 z M 13.818489,5.5696962 q -0.14,0.3546665 -0.28,0.5973331 -0.130667,0.2426666 -0.298667,0.3919999 -0.158666,0.1586666 -0.364,0.2239999 -0.196,0.074667 -0.457333,0.074667 -0.14,0 -0.28,-0.018667 -0.14,-0.018667 -0.270666, -0.065333 V 6.045696 q 0.102666,0.046667 0.233333,0.074667 0.14,0.037333 0.233333,0.037333 0.242667,0 0.401333,-0.1213333 0.168,-0.112 0.252,-0.3266666 L 13.314489,4.8976964 11.401156,0.10036468 h 0.896 l 1.409333, 3.94799862 h 0.01867 l 1.353333,-3.94799862 h 0.84 z"}),IN=Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 11.225128,5.0020008 v 0.6933355 h 4.650681 V 4.8953338 H 12.355798 L 15.726475,0.79932088 V 0.18065225 h -4.288013 v 0.80000253 h 3.114676 z"}),wN=Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 12.043082,4.1413775 h -0.906669 q 0.02133,0.5120017 0.213334,0.8746695 0.192,0.3520011 0.512001,0.5760018 0.320001,0.213334 0.736003,0.3093343 0.416001,0.096 0.874669,0.096 0.416002,0 0.832003,-0.085334 0.426668,-0.074667 0.757336, -0.2773342 0.341334,-0.2026673 0.544001,-0.533335 0.213334,-0.3306677 0.213334,-0.8320026 0,-0.394668 -0.16,-0.6613355 Q 15.50976,3.341375 15.253759,3.1707078 15.008425,2.9893739 14.677757,2.8827069 14.357756,2.7760399 14.016422, 2.701373 13.696421,2.6267061 13.37642,2.5627059 13.056419,2.488039 12.800418,2.3920387 12.544417,2.2853717 12.37375,2.1360379 q -0.16,-0.1600005 -0.16,-0.3946679 0,-0.213334 0.106667,-0.3413344 0.106667,-0.1386672 0.277334,-0.2133341 0.170667, -0.085334 0.373334,-0.1173337 0.213334,-0.032 0.416002,-0.032 0.224,0 0.437334,0.053334 0.224001,0.042667 0.405335,0.1493338 0.181334,0.1066671 0.298668,0.288001 0.117333,0.1706672 0.138667,0.4373347 H 15.57376 Q 15.54176,1.4640358 15.360426, 1.133368 15.179092,0.79203363 14.869758,0.60003303 14.57109,0.39736572 14.176422,0.32269882 13.781755,0.23736521 13.31242,0.23736521 q -0.362668,0 -0.736003,0.0960003 -0.362667,0.0853336 -0.661335,0.27733421 -0.288001,0.1813339 -0.480002, 0.48000147 -0.181333,0.2986677 -0.181333,0.714669 0,0.533335 0.266667,0.8320026 0.266668,0.2986676 0.661335,0.4693348 0.405335,0.1600005 0.87467,0.2560008 0.469335,0.085334 0.864003,0.2026673 0.405334,0.106667 0.672002,0.2880009 0.266667, 0.1813339 0.266667,0.5333351 0,0.2560008 -0.128,0.426668 -0.128001,0.1600005 -0.330668,0.2453341 -0.192,0.085334 -0.426668,0.1173337 -0.234667,0.032 -0.448001,0.032 -0.277334,0 -0.544002,-0.053334 -0.256001,-0.053333 -0.469335, -0.1706672 -0.202667,-0.1280004 -0.330668,-0.3306677 -0.128,-0.213334 -0.138667,-0.5120017 z"}),TN=Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M15.766554,6.815244l-1.355908,-1.360986c0.355481,-0.553535 0.563692,-1.208637 0.563692,-1.909443c0,-1.965304 -1.58951,-3.554814 -3.554814,-3.554814s-3.554814,1.58951 -3.554814,3.554814s1.58951,3.554814 3.554814,3.554814c0.705885,0 1.360986,-0.213289 1.909443,-0.563692l1.360986,1.355908c0.137114,0.137114 0.33009,0.223445 0.5383,0.223445c0.421499,0 0.761746,-0.340247 0.761746,-0.761746c0,-0.208211 -0.086331,-0.401186 -0.223445,-0.5383zm-4.34703,-0.731276c-1.401613,0 -2.539153,-1.137541 -2.539153,-2.539153s1.137541,-2.539153 2.539153,-2.539153s2.539153,1.137541 2.539153,2.539153s-1.137541,2.539153 -2.539153,2.539153z"}),RN=Object(xm.jsx)("path",{strokeWidth:"2.42095",strokeLinecap:"round",fill:"none",d:"M 1.413244,14.6062 H 3.9277429 V 8.378223 H 6.9751347 V 1.4946692 H 9.5085614 L 14.575415,14.576401"}),AN=Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 0.81609227,1.2562455 V 14.58427 H 3.5600972 V 5.2322526 h 0.037333 L 6.8641032,14.58427 H 9.1227739 L 12.389446,5.1389191 h 0.03733 V 14.58427 h 2.744005 V 1.2562455 H 11.045444 L 8.0961054,10.421595 H 8.058772 L 4.941433,1.2562455 Z"}),PN=Object(xm.jsx)("path",{transform:"scale(1.6, 1.6) translate(-2.5, -3)",d:"M 11.390625 11.390625 L 10.824219 11.960938 L 10.542969 11.679688 L 11.113281 11.113281 L 9.769531 9.769531 L 9.199219 10.335938 L 8.921875 10.054688 L 9.488281 9.488281 L 8.144531 8.144531 L 7.574219 8.710938 L 7.296875 8.433594 L 7.863281 7.863281 L 6.511719 6.511719 L 5.953125 7.078125 L 5.664062 6.800781 L 6.230469 6.230469 L 4.886719 4.886719 L 4.320312 5.457031 L 4.039062 5.167969 L 4.609375 4.601562 L 3.199219 3.199219 L 3.199219 11.601562 C 3.199219 12.265625 3.734375 12.800781 4.398438 12.800781 L 12.800781 12.800781 Z M 4.800781 11.199219 L 4.800781 7.0625 L 8.9375 11.199219 Z M 4.800781 11.199219 "}),EN=Object(xm.jsx)("path",{transform:"scale(0.9) translate(-1, -1)",d:"M17.09,18.5l-3.47-3.47L12.5,18L10,10l8,2.5l-2.97,1.11l3.47,3.47L17.09,18.5z M10,3.5c-3.58,0-6.5,2.92-6.5,6.5 s2.92,6.5,6.5,6.5c0.15,0,0.3-0.01,0.45-0.02l0.46,1.46C10.61,17.98,10.31,18,10,18c-4.42,0-8-3.58-8-8s3.58-8,8-8l0,0 c4.42,0,8,3.58,8,8c0,0.31-0.02,0.61-0.05,0.91l-1.46-0.46c0.01-0.15,0.02-0.3,0.02-0.45C16.5,6.42,13.58,3.5,10,3.5 M10,6.5 c-1.93,0-3.5,1.57-3.5,3.5c0,1.76,1.31,3.23,3.01,3.47L10,15c0,0-0.01,0-0.01,0C7.23,15,5,12.76,5,10c0-2.76,2.24-5,5-5l0,0 c2.76,0,5,2.23,5,4.99c0,0,0,0.01,0,0.01l-1.53-0.49C13.23,7.81,11.76,6.5,10,6.5"}),MN=Object(xm.jsx)("path",{transform:"translate(2.5, -3.5) rotate(45, 8, 8) scale(1.0, 1.6) rotate(-15, 8, 8)",fillRule:"evenodd",clipRule:"evenodd",d:"M10,2C9.54,2,9.15,2.31,9.04,2.73l-2.99,9.96C6.02,12.79,6,12.89,6,13 c0,0.55,0.45,1,1,1c0.46,0,0.85-0.31,0.96-0.73l2.99-9.96C10.98,3.21,11,3.11,11,3C11,2.45,10.55,2,10,2z"}),FN=Object(xm.jsx)("path",{transform:"scale(0.75) translate(-1.5, -1) rotate(-5, 9, 9)",d:"M23,8c0,1.1-0.9,2-2,2c-0.18,0-0.35-0.02-0.51-0.07l-3.56,3.55C16.98,13.64,17,13.82,17,14c0,1.1-0.9,2-2,2s-2-0.9-2-2 c0-0.18,0.02-0.36,0.07-0.52l-2.55-2.55C10.36,10.98,10.18,11,10,11s-0.36-0.02-0.52-0.07l-4.55,4.56C4.98,15.65,5,15.82,5,16 c0,1.1-0.9,2-2,2s-2-0.9-2-2s0.9-2,2-2c0.18,0,0.35,0.02,0.51,0.07l4.56-4.55C8.02,9.36,8,9.18,8,9c0-1.1,0.9-2,2-2s2,0.9,2,2 c0,0.18-0.02,0.36-0.07,0.52l2.55,2.55C14.64,12.02,14.82,12,15,12s0.36,0.02,0.52,0.07l3.55-3.56C19.02,8.35,19,8.18,19,8 c0-1.1,0.9-2,2-2S23,6.9,23,8z"}),kN=Object(xm.jsxs)(xm.Fragment,{children:[Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 0.10806581 2.6739215 H 4.3993143 q 1.2724428 0 2.0514895,0.794923 0.7790466 0.787763 0.7790466 2.220058 0,1.231773 -0.6946498 2.148442 -0.69465 0.909507 -2.1358863,0.909507 H 1.3999848 V 13.194128 H 0.10806581 Z m 5.81688139,3.022142 q 0 -1.160159 -0.7790465 -1.575524 Q 4.717425 3.8985335 3.9708386 3.8985335 H 1.3999848 v 3.645191 h 2.5708538 q 0.8699355 0 1.408776 -0.408204 0.5453326 -0.408205 0.5453326 -1.439457 Z"}),Object(xm.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m 8.6774259,2.6739215 2.8316891,8.9590055 2.798138,-8.9590055 h 1.496366 L 12.206973,13.194128 H 10.791128 L 7.2011905,2.6739215 Z"})]}),DN=Object(xm.jsx)("g",{transform:"translate(0, -12) scale(0.03, 0.03)",children:Object(xm.jsxs)("g",{className:"st0",children:[Object(xm.jsx)("path",{d:"M10.025,622.148c2.6,0,5.1-0.9,7-2.9l61.8-61.8c3.9-3.9,3.9-10.2,0-14.1c-3.9-3.9-10.2-3.9-14.1,0l-61.8,61.8 c-3.9,3.9-3.9,10.2,0,14.1C4.925,621.148,7.425,622.148,10.025,622.148z"}),Object(xm.jsx)("path",{d:"M145.725,622.148c2.6,0,5.1-0.9,7-2.9l61.8-61.8c3.9-3.9,3.9-10.2,0-14.1c-3.9-3.9-10.2-3.9-14.1,0l-61.8,61.8 c-3.9,3.9-3.9,10.2,0,14.1C140.625,621.148,143.125,622.148,145.725,622.148z"}),Object(xm.jsx)("path",{d:"M281.425,622.148c2.6,0,5.2-0.9,7.1-3l60.9-61.8c3.9-3.9,3.8-10.2-0.1-14.1c-3.9-3.9-10.2-3.8-14.1,0.1l-60.9,61.8 c-3.9,3.9-3.8,10.2,0.1,14.1C276.325,621.148,278.925,622.148,281.425,622.148z"}),Object(xm.jsx)("path",{d:"M416.225,622.148c2.5,0,5.1-0.9,7-2.9l61.8-61.8c3.9-3.9,3.9-10.2,0-14.1c-3.9-3.9-10.2-3.9-14.1,0l-61.8,61.8 c-3.9,3.9-3.9,10.2,0,14.1C411.125,621.148,413.625,622.148,416.225,622.148z"}),Object(xm.jsx)("path",{d:"M64.725,754.948c2,1.9,4.5,2.9,7.1,2.9c2.6,0,5.2-0.9,7-2.9l61.8-61.8c3.9-3.9,3.9-10.2,0-14.1c-3.9-3.9-10.2-3.9-14.1,0 l-61.8,61.8C60.825,744.748,60.825,751.048,64.725,754.948z"}),Object(xm.jsx)("path",{d:"M200.525,754.948c1.9,1.9,4.5,2.9,7,2.9h0c2.6,0,5.2-1,7.1-3l60.9-61.8c3.9-3.9,3.8-10.2-0.1-14.1 c-3.9-3.9-10.2-3.8-14.1,0.1l-60.9,61.8C196.525,744.748,196.625,751.048,200.525,754.948z"}),Object(xm.jsx)("path",{d:"M335.225,754.948c2,1.9,4.5,2.9,7.1,2.9c2.6,0,5.1-0.9,7-2.9l61.8-61.8c3.9-3.9,3.9-10.2,0-14.1 c-3.9-3.9-10.2-3.9-14.1,0l-61.8,61.8C331.325,744.748,331.325,751.048,335.225,754.948z"}),Object(xm.jsx)("path",{d:"M78.925,814.748c-3.8-3.9-10.2-4-14.1-0.1l-61.8,60.9c-3.9,3.8-4,10.2-0.1,14.1c1.9,2,4.5,3,7.1,3c2.5,0,5.1-0.9,7-2.9 l61.8-60.9C82.725,825.048,82.725,818.648,78.925,814.748z"}),Object(xm.jsx)("path",{d:"M214.625,814.748c-3.8-3.9-10.2-4-14.1-0.1l-61.8,60.9c-3.9,3.8-4,10.2-0.1,14.1c1.9,2,4.5,3,7.1,3c2.5,0,5.1-0.9,7-2.9 l61.8-60.9C218.425,825.048,218.425,818.648,214.625,814.748z"}),Object(xm.jsx)("path",{d:"M349.325,814.748c-3.9-3.9-10.2-3.9-14.1,0l-60.9,60.9c-3.9,3.9-3.9,10.2,0,14.1c2,1.9,4.5,2.9,7.1,2.9 c2.5,0,5.1-1,7-2.9l60.9-60.9C353.225,824.948,353.225,818.648,349.325,814.748z"}),Object(xm.jsx)("path",{d:"M485.125,814.748c-3.8-3.9-10.2-4-14.1-0.1l-61.8,60.9c-3.9,3.8-4,10.2-0.1,14.1c1.9,2,4.5,3,7.1,3c2.5,0,5-0.9,7-2.9 l61.8-60.9C488.925,825.048,489.025,818.648,485.125,814.748z"}),Object(xm.jsx)("path",{d:"M126.525,949.548l-61.8,61.8c-3.9,3.9-3.9,10.2,0,14.1c2,1.9,4.5,2.9,7.1,2.9c2.6,0,5.2-1,7-2.9l61.8-61.8 c3.9-3.9,3.9-10.2,0-14.1C136.725,945.648,130.425,945.648,126.525,949.548z"}),Object(xm.jsx)("path",{d:"M261.325,949.548l-60.9,61.8c-3.9,3.9-3.8,10.2,0.1,14.1c1.9,1.9,4.5,2.9,7,2.9h0c2.6,0,5.2-1,7.1-3l60.9-61.8 c3.9-3.9,3.8-10.2-0.1-14.1C271.525,945.548,265.225,945.648,261.325,949.548z"}),Object(xm.jsx)("path",{d:"M397.025,949.548l-61.8,61.8c-3.9,3.9-3.9,10.2,0,14.1c2,1.9,4.5,2.9,7.1,2.9c2.6,0,5.1-1,7-2.9l61.8-61.8 c3.9-3.9,3.9-10.2,0-14.1C407.225,945.648,400.925,945.648,397.025,949.548z"})]})}),LN={contour:xN,center:SN,regionList:vN,spatialProfiler:CN,spectralProfiler:IN,stokes:wN,spectralLineQuery:TN,smoothing:RN,moments:AN,distanceMeasuring:PN,cursor:EN,line:MN,polyline:FN,pv:kN,imageFitting:Object(xm.jsxs)(xm.Fragment,{children:[Object(xm.jsx)("path",{stroke:"null",id:"svg_2",d:"m9.68361,10.28122c0,0.60521 0.48941,1.09375 1.09571,1.09375s1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375zm-3.28712,-1.09375c0.60629,0 1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375s0.48942,1.09375 1.09571,1.09375zm0.36524,3.28126c0,0.60521 0.48942,1.09375 1.09571,1.09375s1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375zm-3.28712,-1.09375c0.60629,0 1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375s0.48942,1.09375 1.09571,1.09375zm7.66994,2.91667l-8.57572,0l8.78756,-6.26356l-0.42367,-0.59063l-9.28428,6.61356l0,-6.32189c0,-0.40104 -0.32871,-0.72917 -0.73047,-0.72917s-0.73047,0.32813 -0.73047,0.72917l0,7.29169c0,0.40104 0.32871,0.72917 0.73047,0.72917l10.22659,0c0.40176,0 0.73047,-0.32813 0.73047,-0.72917c0,-0.40104 -0.32871,-0.72917 -0.73047,-0.72917z",clipRule:"evenodd",fillRule:"evenodd"}),Object(xm.jsx)("text",{xmlSpace:"preserve",textAnchor:"start",fontFamily:"sans-serif",fontSize:"10",id:"svg_3",y:"5.21879",x:"6.26874",strokeWidth:"0",stroke:"#000",children:"xy"})]}),lineFitting:Object(xm.jsxs)(xm.Fragment,{children:[Object(xm.jsx)("path",{stroke:"null",id:"svg_2",d:"m9.68361,10.28122c0,0.60521 0.48941,1.09375 1.09571,1.09375s1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375zm-3.28712,-1.09375c0.60629,0 1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375s0.48942,1.09375 1.09571,1.09375zm0.36524,3.28126c0,0.60521 0.48942,1.09375 1.09571,1.09375s1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375zm-3.28712,-1.09375c0.60629,0 1.09571,-0.48854 1.09571,-1.09375s-0.48942,-1.09375 -1.09571,-1.09375s-1.09571,0.48854 -1.09571,1.09375s0.48942,1.09375 1.09571,1.09375zm7.66994,2.91667l-8.57572,0l8.78756,-6.26356l-0.42367,-0.59063l-9.28428,6.61356l0,-6.32189c0,-0.40104 -0.32871,-0.72917 -0.73047,-0.72917s-0.73047,0.32813 -0.73047,0.72917l0,7.29169c0,0.40104 0.32871,0.72917 0.73047,0.72917l10.22659,0c0.40176,0 0.73047,-0.32813 0.73047,-0.72917c0,-0.40104 -0.32871,-0.72917 -0.73047,-0.72917z",clipRule:"evenodd",fillRule:"evenodd"}),Object(xm.jsxs)("text",{xmlSpace:"preserve",textAnchor:"start",fontFamily:"sans-serif",fontSize:"10",id:"svg_3",y:"5.71879",x:"6.96874",strokeWidth:"0",stroke:"#000",children:[" ","z"]})]}),vectorOverlay:DN};var NN,_N;i(842);let zN=Object(p.a)((_N=class extends n.Component{get isSelectAll(){const e=NI.Instance;return e.exportRegionNum===e.regionOptionNum}get isIndeterminateSelectAll(){const e=NI.Instance;return e.exportRegionNum>0&&e.exportRegionNum<e.regionOptionNum}constructor(e){super(e),this.handleSelectAllChanged=()=>{const e=NI.Instance;this.isSelectAll||this.isIndeterminateSelectAll?e.clearExportRegionIndexes():e.resetExportRegionIndexes()},this.handleSelectRegionChanged=e=>{const t=NI.Instance;t.exportRegionIndexes.includes(e)?t.deleteExportRegionIndex(e):t.addExportRegionIndex(e)},this.renderSelectStatus=()=>{const e=NI.Instance;let t;switch(e.exportRegionNum){case 0:t="Please select regions to export.";break;case 1:t=`Selected 1 / ${e.regionOptionNum} region.`;break;default:t=`Selected ${e.exportRegionNum} / ${e.regionOptionNum} regions.`}return Object(xm.jsx)("pre",{className:"select-status",children:t})},this.renderSelectAll=()=>Object(xm.jsx)(u.h,{checked:this.isSelectAll,indeterminate:this.isIndeterminateSelectAll,label:"Select all",onChange:this.handleSelectAllChanged},0),this.renderRegionOptions=()=>{const e=NI.Instance;return e.exportRegionOptions.map((t=>{var i;return Object(xm.jsx)(u.h,{checked:null===(i=e.exportRegionIndexes)||void 0===i?void 0:i.includes(t.value),labelElement:Object(xm.jsxs)(n.Fragment,{children:[t.isCustomIcon?Object(xm.jsx)(jN,{icon:t.icon}):Object(xm.jsx)(u.w,{icon:t.icon}),Object(xm.jsx)("span",{children:"\u2002"}),t.active?Object(xm.jsxs)("b",{children:[t.label," (Active)"]}):t.label]}),onChange:()=>this.handleSelectRegionChanged(t.value)},t.value)}))},Object(m.p)(this)}render(){const e=NI.Instance.regionOptionNum;return Object(xm.jsx)("div",{className:"select-region",children:e>0?Object(xm.jsxs)(n.Fragment,{children:[this.renderSelectStatus(),e>1?this.renderSelectAll():null,this.renderRegionOptions()]}):Object(xm.jsx)("pre",{className:"select-status",children:"No regions in the active image."})})}},Object(b.a)(_N.prototype,"isSelectAll",[m.i],Object.getOwnPropertyDescriptor(_N.prototype,"isSelectAll"),_N.prototype),Object(b.a)(_N.prototype,"isIndeterminateSelectAll",[m.i],Object.getOwnPropertyDescriptor(_N.prototype,"isIndeterminateSelectAll"),_N.prototype),NN=_N))||NN;var VN;i(843);let WN=Object(p.a)(VN=class extends n.Component{render(){let e,t=this.props.text;if(this.props.timeRemaining){const i=.001*this.props.timeRemaining;if(i>60){const t=Math.floor(i/60),n=Math.floor(i-60*t);e=`${t}m${n>=10?fi(n):`0${fi(n)}`}s`}else{const t=Math.floor(i);e=`${t>=10?fi(t):`0${fi(t)}`}s`}t=`${this.props.text} (${e} left)`}const i=d()("task-progress-dialog",{"bp3-dark":gC.Instance.darkTheme}),n=this.props.isCancelling?`cancellation in progress${".".repeat(Math.floor(performance.now()/1e3)%4)}`:"";return Object(xm.jsxs)(u.m,{portalClassName:"dialog-portal",className:i,icon:"time",canEscapeKeyClose:!1,canOutsideClickClose:!1,isCloseButtonShown:!1,title:t,isOpen:this.props.isOpen,children:[Object(xm.jsxs)("div",{className:hS.a.DIALOG_BODY,children:[Object(xm.jsx)(u.J,{value:this.props.progress,animate:!isFinite(this.props.progress),stripes:!isFinite(this.props.progress),intent:"primary"}),Object(xm.jsx)(xm.Fragment,{children:this.props.contentText})]}),this.props.cancellable&&Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER,children:[Object(xm.jsx)("div",{className:"footer-text",children:n}),Object(xm.jsx)("div",{className:"footer-button",children:Object(xm.jsx)(j.a,{content:"Cancel the current task",children:Object(xm.jsx)(u.b,{onClick:this.props.onCancel,disabled:this.props.isCancelling,children:"Cancel"})})})]})]})}})||VN;var GN;i(844);let BN=Object(p.a)(GN=class extends n.Component{render(){const e=this.props.region;return Object(xm.jsxs)("div",{className:"coordinate-panel",children:[Object(xm.jsxs)(u.L,{inline:!0,onChange:t=>e.setCoordinate(t.currentTarget.value),selectedValue:e.coordinate,disabled:this.props.disableCooridnate,children:[Object(xm.jsx)(u.K,{label:yb.Image,value:yb.Image}),Object(xm.jsx)(u.K,{label:yb.World,value:yb.World})]}),Object(xm.jsx)(u.r,{options:Object.keys(tA).map((e=>({label:e,value:tA[e]}))),value:gC.Instance.overlayStore.global.system,onChange:e=>gC.Instance.overlayStore.global.setSystem(e.currentTarget.value)})]})}})||GN;var qN,HN,YN;i(845);let UN=Object(p.a)((YN=HN=class e extends n.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeX)){const t=Dm(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Bi(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeY)){const t=Dm(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Bi(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}}}render(){gC.Instance.overlayStore.global.explicitSystem;const e=gC.Instance.overlayStore.numbers.formatTypeX,t=gC.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||i.regionType!==Nt.RegionType.POINT)return null;const n=i.center,r=km(this.props.wcsInfo,n);let o,s;i.coordinate===yb.Image?(o=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),s=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(o=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(e)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),s=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const a=i.coordinate===yb.Image?`WCS: ${Ci.ToString(r)}`:`Image: ${vi.ToString(n,"px",3)}`,l=i.coordinate===yb.Image?Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(px)"}):"";return Object(xm.jsxs)("div",{className:"form-section point-region-form",children:[Object(xm.jsx)(u.q,{children:"Properties"}),Object(xm.jsx)("div",{className:"form-contents",children:Object(xm.jsx)("table",{children:Object(xm.jsxs)("tbody",{children:[Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Region Name"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(u.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Coordinate"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(BN,{region:i,disableCooridnate:!this.props.wcsInfo})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Center ",l]}),Object(xm.jsx)("td",{children:o}),Object(xm.jsx)("td",{children:s}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:a})})]})]})})})]})}},HN.REGION_PIXEL_EPS=.001,qN=YN))||qN;var XN,$N,KN,QN;i(846);const ZN=13;let JN=Object(p.a)((QN=KN=class e extends n.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeX)){const t=Dm(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Bi(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeY)){const t=Dm(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Bi(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleWidthChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.x;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=r},this.handleWidthWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.x)return;const n=this.props.frame.getImageXValueFromArcsec(Si(i)),r=this.props.region.size.x;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=this.sizeWCS.x},this.handleHeightChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.y;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=r},this.handleHeightWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.y)return;const n=this.props.frame.getImageYValueFromArcsec(Si(i)),r=this.props.region.size.y;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=this.sizeWCS.y},this.handleLeftValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.x+n.x/2,o={x:(t+r)/2,y:i.y},s={x:Math.abs(t-r),y:n.y};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleLeftChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.bottomLeftPoint.x;this.handleLeftValueChange(i,n)||(e.currentTarget.value=n)},this.handleLeftWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=km(this.props.wcsInfo,this.bottomLeftPoint),i=e.currentTarget.value;if(i!==t.x){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeX)){const e=Dm(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.bottomLeftPoint.x;if(this.handleLeftValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleBottomValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.y+n.y/2,o={x:i.x,y:(t+r)/2},s={x:n.x,y:Math.abs(t-r)};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleBottomChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.bottomLeftPoint.y;this.handleBottomValueChange(i,n)||(e.currentTarget.value=n)},this.handleBottomWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=km(this.props.wcsInfo,this.bottomLeftPoint),i=e.currentTarget.value;if(i!==t.y){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeY)){const e=Dm(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.bottomLeftPoint.y;if(this.handleBottomValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRightValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.x-n.x/2,o={x:(t+r)/2,y:i.y},s={x:Math.abs(t-r),y:n.y};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleRightChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.topRightPoint.x;this.handleRightValueChange(i,n)||(e.currentTarget.value=n)},this.handleRightWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=km(this.props.wcsInfo,this.topRightPoint),i=e.currentTarget.value;if(i!==t.x){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeX)){const e=Dm(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.topRightPoint.x;if(this.handleRightValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleTopValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.y-n.y/2,o={x:i.x,y:(t+r)/2},s={x:n.x,y:Math.abs(t-r)};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleTopChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.topRightPoint.y;this.handleTopValueChange(i,n)||(e.currentTarget.value=n)},this.handleTopWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==ZN)return;const t=km(this.props.wcsInfo,this.topRightPoint),i=e.currentTarget.value;if(i!==t.y){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeY)){const e=Dm(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.topRightPoint.y;if(this.handleTopValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRotationChange=t=>{if("keydown"===t.type&&t.keyCode!==ZN)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get topRightPoint(){const e=this.props.region;if(!e||2!==e.controlPoints.length)return{x:NaN,y:NaN};const t=e.center,i=e.size;return{x:t.x+i.x/2,y:t.y+i.y/2}}get bottomLeftPoint(){const e=this.props.region;if(!e||2!==e.controlPoints.length)return{x:NaN,y:NaN};const t=e.center,i=e.size;return{x:t.x-i.x/2,y:t.y-i.y/2}}get sizeWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?{x:ji(i.x,Sg),y:ji(i.y,Sg)}:null}render(){var e;gC.Instance.overlayStore.global.explicitSystem;const t=gC.Instance.overlayStore.numbers.formatTypeX,i=gC.Instance.overlayStore.numbers.formatTypeY,n=this.props.region;if(!n||2!==n.controlPoints.length||n.regionType!==Nt.RegionType.RECTANGLE)return null;const r=n.center,o=km(this.props.wcsInfo,r);let s,a;n.coordinate===yb.Image?(s=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:r.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),a=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:r.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(s=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),a=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const l=n.coordinate===yb.Image?`WCS: ${Ci.ToString(o)}`:`Image: ${vi.ToString(r,"px",3)}`,c=Math.abs(n.rotation)>.001,d=km(this.props.wcsInfo,this.bottomLeftPoint);let p,h;n.coordinate===yb.Image?(p=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.bottomLeftPoint.x,onBlur:this.handleLeftChange,onKeyDown:this.handleLeftChange,disabled:c}),h=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.bottomLeftPoint.y,onBlur:this.handleBottomChange,onKeyDown:this.handleBottomChange,disabled:c})):(p=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!d||c,value:d?d.x:"",onBlur:this.handleLeftWCSChange,onKeyDown:this.handleLeftWCSChange})}),h=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!d||c,value:d?d.y:"",onBlur:this.handleBottomWCSChange,onKeyDown:this.handleBottomWCSChange})}));const g=n.coordinate===yb.Image?`WCS: ${Ci.ToString(d)}`:`Image: ${vi.ToString(this.bottomLeftPoint,"px",3)}`,f=km(this.props.wcsInfo,this.topRightPoint);let b,m;n.coordinate===yb.Image?(b=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.topRightPoint.x,onBlur:this.handleRightChange,onKeyDown:this.handleRightChange,disabled:c}),m=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.topRightPoint.y,onBlur:this.handleTopChange,onKeyDown:this.handleTopChange,disabled:c})):(b=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!f||c,value:f?f.x:"",onBlur:this.handleRightWCSChange,onKeyDown:this.handleRightWCSChange})}),m=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!f||c,value:f?f.y:"",onBlur:this.handleTopWCSChange,onKeyDown:this.handleTopWCSChange})}));const O=n.coordinate===yb.Image?`WCS: ${Ci.ToString(f)}`:`Image: ${vi.ToString(this.topRightPoint,"px",3)}`,x=n.size;let S,v;n.coordinate===yb.Image?(S=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Width",value:x.x,onBlur:this.handleWidthChange,onKeyDown:this.handleWidthChange}),v=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Height",value:x.y,onBlur:this.handleHeightChange,onKeyDown:this.handleHeightChange})):(S=Object(xm.jsx)(j.a,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Width",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.x:"",onBlur:this.handleWidthWCSChange,onKeyDown:this.handleWidthWCSChange})}),v=Object(xm.jsx)(j.a,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Height",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.y:"",onBlur:this.handleHeightWCSChange,onKeyDown:this.handleHeightWCSChange})}));const C=n.coordinate===yb.Image?`WCS: ${Ci.ToString(this.sizeWCS)}`:`Image: ${vi.ToString(x,"px",3)}`,I=n.coordinate===yb.Image?Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(px)"}):"";return Object(xm.jsxs)("div",{className:"form-section rectangular-region-form",children:[Object(xm.jsx)(u.q,{children:"Properties"}),Object(xm.jsx)("div",{className:"form-contents",children:Object(xm.jsx)("table",{children:Object(xm.jsxs)("tbody",{children:[Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Region Name"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(u.x,{placeholder:"Enter a region name",value:n.name,onChange:this.handleNameChange})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Coordinate"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(BN,{region:n,disableCooridnate:!this.props.wcsInfo})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Center ",I]}),Object(xm.jsx)("td",{children:s}),Object(xm.jsx)("td",{children:a}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:l})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Size ",I]}),Object(xm.jsx)("td",{children:S}),Object(xm.jsx)("td",{children:v}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:C})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Bottom Left ",I]}),Object(xm.jsx)("td",{children:p}),Object(xm.jsx)("td",{children:h}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:g})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Top Right ",I]}),Object(xm.jsx)("td",{children:b}),Object(xm.jsx)("td",{children:m}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:O})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["P.A. ",Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(deg)"})]}),Object(xm.jsx)("td",{children:Object(xm.jsx)(pO,{disabled:!(null===(e=this.props.frame)||void 0===e?void 0:e.hasSquarePixels),selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:n.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})})]})]})})})]})}},KN.REGION_PIXEL_EPS=.001,$N=QN,Object(b.a)($N.prototype,"topRightPoint",[m.i],Object.getOwnPropertyDescriptor($N.prototype,"topRightPoint"),$N.prototype),Object(b.a)($N.prototype,"bottomLeftPoint",[m.i],Object.getOwnPropertyDescriptor($N.prototype,"bottomLeftPoint"),$N.prototype),Object(b.a)($N.prototype,"sizeWCS",[m.i],Object.getOwnPropertyDescriptor($N.prototype,"sizeWCS"),$N.prototype),XN=$N))||XN;var e_,t_,i_,n_;i(847);const r_=13;let o_=Object(p.a)((n_=i_=class e extends n.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeX)){const t=Dm(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Bi(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeY)){const t=Dm(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Bi(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleMajorAxisChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.x;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=r},this.handleMajorAxisWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.x)return;const n=this.props.frame.getImageXValueFromArcsec(Si(i)),r=this.props.region.size.x;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=this.sizeWCS.x},this.handleMinorAxisChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.y;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=r},this.handleMinorAxisWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.y)return;const n=this.props.frame.getImageYValueFromArcsec(Si(i)),r=this.props.region.size.y;isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=this.sizeWCS.y},this.handleRotationChange=t=>{if("keydown"===t.type&&t.keyCode!==r_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get sizeWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?{x:ji(i.x,Sg),y:ji(i.y,Sg)}:null}render(){var e;gC.Instance.overlayStore.global.explicitSystem;const t=gC.Instance.overlayStore.numbers.formatTypeX,i=gC.Instance.overlayStore.numbers.formatTypeY,n=this.props.region;if(!n||2!==n.controlPoints.length||n.regionType!==Nt.RegionType.ELLIPSE)return null;const r=n.center,o=km(this.props.wcsInfo,r);let s,a;n.coordinate===yb.Image?(s=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:r.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),a=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:r.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(s=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),a=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const l=n.coordinate===yb.Image?`WCS: ${Ci.ToString(o)}`:`Image: ${vi.ToString(r,"px",3)}`,c=n.size;let d,p;n.coordinate===yb.Image?(d=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Semi-major",value:c.x,onBlur:this.handleMajorAxisChange,onKeyDown:this.handleMajorAxisChange}),p=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Semi-minor",value:c.y,onBlur:this.handleMinorAxisChange,onKeyDown:this.handleMinorAxisChange})):(d=Object(xm.jsx)(j.a,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Semi-major",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.x:"",onBlur:this.handleMajorAxisWCSChange,onKeyDown:this.handleMajorAxisWCSChange})}),p=Object(xm.jsx)(j.a,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Semi-minor",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.y:"",onBlur:this.handleMinorAxisWCSChange,onKeyDown:this.handleMinorAxisWCSChange})}));const h=n.coordinate===yb.Image?`(Semi-major, Semi-minor): ${Ci.ToString(this.sizeWCS)}`:`Image: ${vi.ToString(c,"px",3)}`,g=n.coordinate===yb.Image?Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(px)"}):"";return Object(xm.jsxs)("div",{className:"form-section elliptical-region-form",children:[Object(xm.jsx)(u.q,{children:"Properties"}),Object(xm.jsx)("div",{className:"form-contents",children:Object(xm.jsx)("table",{children:Object(xm.jsxs)("tbody",{children:[Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Region Name"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(u.x,{placeholder:"Enter a region name",value:n.name,onChange:this.handleNameChange})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Coordinate"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(BN,{region:n,disableCooridnate:!this.props.wcsInfo})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Center ",g]}),Object(xm.jsx)("td",{children:s}),Object(xm.jsx)("td",{children:a}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:l})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Semi-axes ",g]}),Object(xm.jsx)("td",{children:d}),Object(xm.jsx)("td",{children:p}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:h})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["P.A. ",Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(deg)"})]}),Object(xm.jsx)("td",{children:Object(xm.jsx)(pO,{disabled:!(null===(e=this.props.frame)||void 0===e?void 0:e.hasSquarePixels),selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:n.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})})]})]})})})]})}},i_.REGION_PIXEL_EPS=.001,t_=n_,Object(b.a)(t_.prototype,"sizeWCS",[m.i],Object.getOwnPropertyDescriptor(t_.prototype,"sizeWCS"),t_.prototype),e_=t_))||e_;var s_,a_,l_;i(848);let c_=Object(p.a)((l_=a_=class e extends n.Component{constructor(...t){super(...t),this.handleLineWidthChange=T.throttle((e=>{this.props.region&&this.props.region.setLineWidth(Math.max(Ob.MIN_LINE_WIDTH,Math.min(Ob.MAX_LINE_WIDTH,e)))}),e.APPEARANCE_CHANGE_DELAY),this.handleDashLengthChange=T.throttle((e=>{this.props.region&&this.props.region.setDashLength(Math.max(0,Math.min(Ob.MAX_DASH_LENGTH,e)))}),e.APPEARANCE_CHANGE_DELAY)}render(){const e=this.props.region;return e&&e.isValid?Object(xm.jsxs)("div",{className:"form-section appearance-form",children:[Object(xm.jsx)(u.q,{children:"Appearance"}),Object(xm.jsxs)("div",{className:"form-contents",children:[Object(xm.jsx)(u.p,{label:"Color",inline:!0,children:Object(xm.jsx)(jy,{color:e.color,presetColors:Gb,setColor:t=>e.setColor(t.hex),disableAlpha:!0,darkTheme:this.props.darkTheme})}),e.regionType!==Nt.RegionType.POINT&&Object(xm.jsx)(u.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Line Width",min:Ob.MIN_LINE_WIDTH,max:Ob.MAX_LINE_WIDTH,value:e.lineWidth,stepSize:.5,onValueChange:this.handleLineWidthChange})}),e.regionType!==Nt.RegionType.POINT&&Object(xm.jsx)(u.p,{inline:!0,label:"Dash Length",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Dash Length",min:0,max:Ob.MAX_DASH_LENGTH,value:e.dashLength,stepSize:1,onValueChange:this.handleDashLengthChange})})]})]}):null}},a_.APPEARANCE_CHANGE_DELAY=100,s_=l_))||s_;var d_,p_,h_,u_,g_;i(849);let f_=Object(p.a)((g_=u_=class e extends n.Component{constructor(t){super(t),Object(f.a)(this,"displayColorPicker",h_,this),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handlePointChange=(t,i,n)=>{if("keydown"===n.type&&13!==n.keyCode)return;const r=this.props.region,o=n.currentTarget.value,s=parseFloat(o),a=i?r.controlPoints[t].x:r.controlPoints[t].y;!isFinite(s)||Bi(s,a,e.REGION_PIXEL_EPS)?n.currentTarget.value=a:i?this.props.region.setControlPoint(t,{x:s,y:this.props.region.controlPoints[t].y}):this.props.region.setControlPoint(t,{x:this.props.region.controlPoints[t].x,y:s})},this.handleWCSPointChange=(t,i,n)=>{if("keydown"===n.type&&13!==n.keyCode)return;const r=this.props.region,o=km(this.props.wcsInfo,r.controlPoints[t]);if(!o)return;const s=n.currentTarget.value;if(s!==(i?o.x:o.y)){if(Pm(s,i?gC.Instance.overlayStore.numbers.formatTypeX:gC.Instance.overlayStore.numbers.formatTypeY)){const n=Dm(this.props.wcsInfo,i?{x:s,y:o.y}:{x:o.x,y:s});if(!n)return;const a=i?n.x:n.y,l=i?r.controlPoints[t].x:r.controlPoints[t].y;if(isFinite(a)&&!Bi(a,l,e.REGION_PIXEL_EPS))return void this.props.region.setControlPoint(t,n)}n.currentTarget.value=i?o.x:o.y}},Object(m.p)(this)}render(){gC.Instance.overlayStore.global.explicitSystem;const e=gC.Instance.overlayStore.numbers.formatTypeX,t=gC.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||!i.isValid||i.regionType!==Nt.RegionType.POLYGON&&i.regionType!==Nt.RegionType.POLYLINE)return null;const n=i.coordinate===yb.Image?Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(px)"}):"",r=i.controlPoints.map(((r,o)=>{const s=km(this.props.wcsInfo,r);let a,l;i.coordinate===yb.Image?(a=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:r.x,onBlur:e=>this.handlePointChange(o,!0,e),onKeyDown:e=>this.handlePointChange(o,!0,e)}),l=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:r.y,onBlur:e=>this.handlePointChange(o,!1,e),onKeyDown:e=>this.handlePointChange(o,!1,e)})):(a=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(e)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!s,value:s?s.x:"",onBlur:e=>this.handleWCSPointChange(o,!0,e),onKeyDown:e=>this.handleWCSPointChange(o,!0,e)})}),l=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!s,value:s?s.y:"",onBlur:e=>this.handleWCSPointChange(o,!1,e),onKeyDown:e=>this.handleWCSPointChange(o,!1,e)})}));const c=i.coordinate===yb.Image?`WCS: ${Ci.ToString(s)}`:`Image: ${vi.ToString(r,"px",3)}`;return Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Point ",o," ",n]}),Object(xm.jsx)("td",{children:a}),Object(xm.jsx)("td",{children:l}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:c})})]},o)}));return Object(xm.jsxs)("div",{className:"form-section polygon-region-form",children:[Object(xm.jsx)(u.q,{children:"Properties"}),Object(xm.jsx)("div",{className:"form-contents",children:Object(xm.jsx)("table",{children:Object(xm.jsxs)("tbody",{children:[Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Region Name"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(u.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Coordinate"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(BN,{region:i,disableCooridnate:!this.props.wcsInfo})})]}),r]})})})]})}},u_.REGION_PIXEL_EPS=.001,p_=g_,h_=Object(b.a)(p_.prototype,"displayColorPicker",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d_=p_))||d_;var b_,m_,y_,O_;i(850);const j_=13;let x_=Object(p.a)((O_=y_=class e extends n.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeX)){const t=Dm(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Bi(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;const i=km(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Pm(n,gC.Instance.overlayStore.numbers.formatTypeY)){const t=Dm(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Bi(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleLengthChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;const i=t.currentTarget.value,n=parseFloat(i),r=sm(this.props.region.size);if(isFinite(n)&&n>0&&!Bi(n,r,e.REGION_PIXEL_EPS)){const e=this.props.region,t=e.rotation*Math.PI/180;e.setSize({x:n*Math.sin(t),y:-1*n*Math.cos(t)})}else t.currentTarget.value=r},this.handleLengthWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;if(!this.lengthWCS)return;const i=t.currentTarget.value;if(i===this.lengthWCS)return;const n=sm(this.props.region.size),r=n*Si(i)/sm(this.props.frame.getWcsSizeInArcsec(this.props.region.size));if(isFinite(r)&&r>0&&!Bi(r,n,e.REGION_PIXEL_EPS)){const e=this.props.region,t=e.rotation*Math.PI/180;e.setSize({x:r*Math.sin(t),y:-1*r*Math.cos(t)})}else t.currentTarget.value=this.lengthWCS},this.handleStartXValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i={x:Math.abs(t-e.controlPoints[1].x),y:e.size.y};if(i.x>0||i.y>0)return e.setControlPoint(0,{x:t,y:e.controlPoints[0].y}),!0}return!1},this.handleStartXChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.startPoint.x;this.handleStartXValueChange(i,n)||(e.currentTarget.value=n)},this.handleStartXWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=km(this.props.wcsInfo,this.startPoint),i=e.currentTarget.value;if(i!==t.x){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeX)){const e=Dm(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.startPoint.x;if(this.handleStartXValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleStartYValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i={x:e.size.x,y:Math.abs(t-e.controlPoints[1].y)};if(i.x>0||i.y>0)return e.setControlPoint(0,{x:e.controlPoints[0].x,y:t}),!0}return!1},this.handleStartYChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.startPoint.y;this.handleStartYValueChange(i,n)||(e.currentTarget.value=n)},this.handleStartYWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=km(this.props.wcsInfo,this.startPoint),i=e.currentTarget.value;if(i!==t.y){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeY)){const e=Dm(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.startPoint.y;if(this.handleStartYValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleEndXValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i={x:Math.abs(t-e.controlPoints[0].x),y:e.size.y};if(i.x>0||i.y>0)return e.setControlPoint(1,{x:t,y:e.controlPoints[1].y}),!0}return!1},this.handleEndXChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.endPoint.x;this.handleEndXValueChange(i,n)||(e.currentTarget.value=n)},this.handleEndXWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=km(this.props.wcsInfo,this.endPoint),i=e.currentTarget.value;if(i!==t.x){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeX)){const e=Dm(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.endPoint.x;if(this.handleEndXValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleEndYValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Bi(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i={x:e.size.x,y:Math.abs(t-e.controlPoints[0].y)};if(i.x>0||i.y>0)return e.setControlPoint(1,{x:e.controlPoints[1].x,y:t}),!0}return!1},this.handleEndYChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.endPoint.y;this.handleEndYValueChange(i,n)||(e.currentTarget.value=n)},this.handleEndYWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==j_)return;const t=km(this.props.wcsInfo,this.endPoint),i=e.currentTarget.value;if(i!==t.y){if(Pm(i,gC.Instance.overlayStore.numbers.formatTypeY)){const e=Dm(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.endPoint.y;if(this.handleEndYValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRotationChange=t=>{if("keydown"===t.type&&t.keyCode!==j_)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Bi(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get startPoint(){const e=this.props.region;return e&&2===e.controlPoints.length?{x:e.controlPoints[0].x,y:e.controlPoints[0].y}:{x:NaN,y:NaN}}get endPoint(){const e=this.props.region;return e&&2===e.controlPoints.length?{x:e.controlPoints[1].x,y:e.controlPoints[1].y}:{x:NaN,y:NaN}}get lengthWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?ji(sm(i),Sg):null}render(){var e;gC.Instance.overlayStore.global.explicitSystem;const t=gC.Instance.overlayStore.numbers.formatTypeX,i=gC.Instance.overlayStore.numbers.formatTypeY,r=this.props.region;if(!r||2!==r.controlPoints.length||r.regionType!==Nt.RegionType.LINE)return null;const o=km(this.props.wcsInfo,this.startPoint);let s,a;r.coordinate===yb.Image?(s=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.startPoint.x,onBlur:this.handleStartXChange,onKeyDown:this.handleStartXChange}),a=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.startPoint.y,onBlur:this.handleStartYChange,onKeyDown:this.handleStartYChange})):(s=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.x:"",onBlur:this.handleStartXWCSChange,onKeyDown:this.handleStartXWCSChange})}),a=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!o,value:o?o.y:"",onBlur:this.handleStartYWCSChange,onKeyDown:this.handleStartYWCSChange})}));const l=r.coordinate===yb.Image?`WCS: ${Ci.ToString(o)}`:`Image: ${vi.ToString(this.startPoint,"px",3)}`,c=km(this.props.wcsInfo,this.endPoint);let d,p;r.coordinate===yb.Image?(d=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.endPoint.x,onBlur:this.handleEndXChange,onKeyDown:this.handleEndXChange}),p=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.endPoint.y,onBlur:this.handleEndYChange,onKeyDown:this.handleEndYChange})):(d=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!c,value:c?c.x:"",onBlur:this.handleEndXWCSChange,onKeyDown:this.handleEndXWCSChange})}),p=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!c,value:c?c.y:"",onBlur:this.handleEndYWCSChange,onKeyDown:this.handleEndYWCSChange})}));const h=r.coordinate===yb.Image?`WCS: ${Ci.ToString(c)}`:`Image: ${vi.ToString(this.endPoint,"px",3)}`,g=r.center,f=km(this.props.wcsInfo,g);let b,m;r.coordinate===yb.Image?(b=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:g.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),m=Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:g.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(b=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(t)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!f,value:f?f.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),m=Object(xm.jsx)(j.a,{content:`Format: ${nA.get(i)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!f,value:f?f.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const O=r.coordinate===yb.Image?`WCS: ${Ci.ToString(f)}`:`Image: ${vi.ToString(g,"px",3)}`,x=sm(r.size);let S;S=r.coordinate===yb.Image?Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Length",value:x,onBlur:this.handleLengthChange,onKeyDown:this.handleLengthChange}):Object(xm.jsx)(j.a,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Length",disabled:!this.props.wcsInfo,value:this.lengthWCS?this.lengthWCS:"",onBlur:this.handleLengthWCSChange,onKeyDown:this.handleLengthWCSChange})});const v=r.coordinate===yb.Image?`WCS: ${this.lengthWCS}`:`Image: ${x.toFixed(3)} px`,C=r.coordinate===yb.Image?Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(px)"}):"";return Object(xm.jsxs)("div",{className:"form-section line-region-form",children:[Object(xm.jsx)(u.q,{children:"Properties"}),Object(xm.jsx)("div",{className:"form-contents",children:Object(xm.jsx)("table",{children:Object(xm.jsxs)("tbody",{children:[Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Region Name"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(u.x,{placeholder:"Enter a region name",value:r.name,onChange:this.handleNameChange})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{children:"Coordinate"}),Object(xm.jsx)("td",{colSpan:2,children:Object(xm.jsx)(BN,{region:r,disableCooridnate:!this.props.wcsInfo})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Start ",C]}),Object(xm.jsx)("td",{children:s}),Object(xm.jsx)("td",{children:a}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:l})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["End ",C]}),Object(xm.jsx)("td",{children:d}),Object(xm.jsx)("td",{children:p}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:h})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Center ",C]}),Object(xm.jsx)("td",{children:b}),Object(xm.jsx)("td",{children:m}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:O})})]}),(null===(e=this.props.frame)||void 0===e?void 0:e.hasSquarePixels)?Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["Length ",C]}),Object(xm.jsx)("td",{children:S}),Object(xm.jsx)("td",{}),Object(xm.jsx)("td",{children:Object(xm.jsx)("span",{className:"info-string",children:v})})]}),Object(xm.jsxs)("tr",{children:[Object(xm.jsxs)("td",{children:["P.A. ",Object(xm.jsx)("span",{className:hS.a.TEXT_MUTED,children:"(deg)"})]}),Object(xm.jsx)("td",{children:Object(xm.jsx)(pO,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:r.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})})]})]}):null]})})})]})}},y_.REGION_PIXEL_EPS=.001,m_=O_,Object(b.a)(m_.prototype,"startPoint",[m.i],Object.getOwnPropertyDescriptor(m_.prototype,"startPoint"),m_.prototype),Object(b.a)(m_.prototype,"endPoint",[m.i],Object.getOwnPropertyDescriptor(m_.prototype,"endPoint"),m_.prototype),Object(b.a)(m_.prototype,"lengthWCS",[m.i],Object.getOwnPropertyDescriptor(m_.prototype,"lengthWCS"),m_.prototype),b_=m_))||b_;var S_,v_,C_;i(851);let I_=Object(p.a)((C_=v_=class e extends n.Component{constructor(...e){super(...e),this.handleDeleteClicked=()=>{const e=gC.Instance;e.dialogStore.hideRegionDialog(),e.activeFrame&&e.activeFrame.regionSet.selectedRegion&&e.deleteRegion(e.activeFrame.regionSet.selectedRegion)},this.handleFocusClicked=()=>gC.Instance.activeFrame.regionSet.selectedRegion.focusCenter()}render(){const t=gC.Instance,i={icon:"info-sign",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!0,lazy:!0,isOpen:t.dialogStore.regionDialogVisible,onClose:t.dialogStore.hideRegionDialog,className:"region-dialog",canEscapeKeyClose:!0,title:"No region selected"};let r,o,s=!1;if(t.activeFrame&&t.activeFrame.regionSet.selectedRegion)if(0===t.activeFrame.regionSet.selectedRegion.regionId)r=e.InvalidRegionNode;else{var a;o=t.activeFrame.regionSet.selectedRegion;const l=null!==(a=t.activeFrame.spatialReference)&&void 0!==a?a:t.activeFrame;switch(i.title=`Editing ${o.nameString} (${l.filename})`,o.regionType){case Nt.RegionType.POINT:r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(c_,{region:o,darkTheme:t.darkTheme}),Object(xm.jsx)(UN,{region:o,wcsInfo:l.validWcs?l.wcsInfoForTransformation:0})]}),s=!0;break;case Nt.RegionType.RECTANGLE:r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(c_,{region:o,darkTheme:t.darkTheme}),Object(xm.jsx)(JN,{region:o,frame:l,wcsInfo:l.validWcs?l.wcsInfoForTransformation:0})]}),s=!0;break;case Nt.RegionType.ELLIPSE:r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(c_,{region:o,darkTheme:t.darkTheme}),Object(xm.jsx)(o_,{region:o,frame:l,wcsInfo:l.validWcs?l.wcsInfoForTransformation:0})]}),s=!0;break;case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(c_,{region:o,darkTheme:t.darkTheme}),Object(xm.jsx)(f_,{region:o,wcsInfo:l.validWcs?l.wcsInfoForTransformation:0})]}),s=!0;break;case Nt.RegionType.LINE:r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(c_,{region:o,darkTheme:t.darkTheme}),Object(xm.jsx)(x_,{region:o,frame:l,wcsInfo:l.validWcs?l.wcsInfoForTransformation:0})]}),s=!0;break;default:r=e.InvalidRegionNode}}else r=e.MissingRegionNode;let l=o&&0!==o.regionId&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(j.a,{content:"Region is "+(o.locked?"locked":"unlocked"),children:Object(xm.jsx)(u.b,{intent:g.a.WARNING,minimal:!0,icon:o.locked?"lock":"unlock",onClick:o.toggleLock})}),Object(xm.jsx)(j.a,{content:"Focus",children:Object(xm.jsx)(u.b,{intent:g.a.WARNING,minimal:!0,icon:Object(xm.jsx)(jN,{icon:"center"}),onClick:this.handleFocusClicked})})]});return Object(xm.jsxs)(fL,{dialogProps:i,helpType:xM.REGION_DIALOG,defaultWidth:775,defaultHeight:475,minHeight:300,minWidth:400,enableResizing:!0,children:[Object(xm.jsx)("div",{className:hS.a.DIALOG_BODY,children:r}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[l,s&&Object(xm.jsx)(u.b,{intent:g.a.DANGER,icon:"trash",text:"Delete",onClick:this.handleDeleteClicked}),Object(xm.jsx)(u.b,{intent:g.a.NONE,onClick:t.dialogStore.hideRegionDialog,text:"Close"})]})})]})}},v_.MissingRegionNode=Object(xm.jsx)(u.C,{icon:"folder-open",title:"No region selected",description:"Select a region using the list or image view"}),v_.InvalidRegionNode=Object(xm.jsx)(u.C,{icon:"error",title:"Region not supported",description:"The selected region does not have any editable properties"}),S_=C_))||S_;var w_,T_,R_,A_,P_;i(852);!function(e){e[e.GLOBAL=0]="GLOBAL",e[e.RENDER_CONFIG=1]="RENDER_CONFIG",e[e.CONTOUR_CONFIG=2]="CONTOUR_CONFIG",e[e.VECTOR_OVERLAY_CONFIG=3]="VECTOR_OVERLAY_CONFIG",e[e.WCS_OVERLAY_CONFIG=4]="WCS_OVERLAY_CONFIG",e[e.REGION=5]="REGION",e[e.PERFORMANCE=6]="PERFORMANCE",e[e.LOG_EVENT=7]="LOG_EVENT",e[e.CATALOG=8]="CATALOG",e[e.TELEMETRY=9]="TELEMETRY"}(P_||(P_={}));const E_=A.a.ofType();let M_=Object(p.a)((T_=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"selectedTab",R_,this),Object(f.a)(this,"setSelectedTab",A_,this),this.renderPercentileSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(xm.jsx)(u.B,{text:e+"%",onClick:t},e),this.handleImageCompressionQualityChange=T.throttle((e=>{JA.Instance.setPreference(QA.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,e)}),100),this.handleAnimationCompressionQualityChange=T.throttle((e=>{JA.Instance.setPreference(QA.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,e)}),100),this.handleGPUTileCacheChange=T.throttle((e=>{JA.Instance.setPreference(QA.PERFORMANCE_GPU_TILE_CACHE,e)}),100),this.handleSystemTileCacheChange=T.throttle((e=>{JA.Instance.setPreference(QA.PERFORMANCE_SYSTEM_TILE_CACHE,e)}),100),this.reset=()=>{const e=JA.Instance;switch(this.selectedTab){case P_.RENDER_CONFIG:e.resetRenderConfigSettings();break;case P_.CONTOUR_CONFIG:e.resetContourConfigSettings();break;case P_.VECTOR_OVERLAY_CONFIG:e.resetVectorOverlayConfigSettings();break;case P_.WCS_OVERLAY_CONFIG:e.resetOverlayConfigSettings();break;case P_.REGION:e.resetRegionSettings();break;case P_.PERFORMANCE:e.resetPerformanceSettings();break;case P_.LOG_EVENT:e.resetLogEventSettings();break;case P_.CATALOG:e.resetCatalogSettings();break;case P_.TELEMETRY:e.resetTelemetrySettings();break;case P_.GLOBAL:default:e.resetGlobalSettings()}},this.handleUserIdCopied=async()=>{const e=gC.Instance;try{var t;await(null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e.telemetryService.decodedUserId)),v.show(C("clipboard","Copied user ID to clipboard."))}catch(i){console.log(i)}},Object(m.p)(this)}render(){const e=gC.Instance,t=e.preferenceStore,i=e.layoutStore,r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Theme",children:Object(xm.jsxs)(u.r,{value:t.theme,onChange:t=>e.setTheme(t.currentTarget.value),children:[Object(xm.jsx)("option",{value:Ti.AUTO,children:"Automatic"}),Object(xm.jsx)("option",{value:Ti.LIGHT,children:"Light"}),Object(xm.jsx)("option",{value:Ti.DARK,children:"Dark"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Enable Code Snippets",children:Object(xm.jsx)(u.P,{checked:t.codeSnippetsEnabled,onChange:e=>t.setPreference(QA.GLOBAL_CODE_SNIPPETS_ENABLED,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Auto-launch File Browser",children:Object(xm.jsx)(u.P,{checked:t.autoLaunch,onChange:e=>t.setPreference(QA.GLOBAL_AUTOLAUNCH,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"File List",children:Object(xm.jsxs)(u.r,{value:t.fileFilterMode,onChange:e=>t.setPreference(QA.GLOBAL_FILE_FILTER_MODE,e.currentTarget.value),children:[Object(xm.jsx)("option",{value:nr.Content,children:"Filter by file content"}),Object(xm.jsx)("option",{value:nr.Extension,children:"Filter by extension"}),Object(xm.jsx)("option",{value:nr.All,children:"All files"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Initial Layout",children:Object(xm.jsx)(u.r,{value:t.layout,onChange:e=>t.setPreference(QA.GLOBAL_LAYOUT,e.currentTarget.value),children:i.orderedLayoutNames.map((e=>Object(xm.jsx)("option",{value:e,children:e},e)))})}),Object(xm.jsx)(u.p,{inline:!0,label:"Initial Cursor Position",children:Object(xm.jsxs)(u.L,{selectedValue:t.cursorPosition,onChange:e=>t.setPreference(QA.GLOBAL_CURSOR_POSITION,e.currentTarget.value),inline:!0,children:[Object(xm.jsx)(u.K,{label:"Fixed",value:Ai.FIXED}),Object(xm.jsx)(u.K,{label:"Tracking",value:Ai.TRACKING})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Initial Zoom Level",children:Object(xm.jsxs)(u.L,{selectedValue:t.zoomMode,onChange:e=>t.setPreference(QA.GLOBAL_ZOOM_MODE,e.currentTarget.value),inline:!0,children:[Object(xm.jsx)(u.K,{label:"Zoom to fit",value:Pi.FIT}),Object(xm.jsx)(u.K,{label:"Zoom to 1.0x",value:Pi.FULL})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Zoom to",children:Object(xm.jsxs)(u.L,{selectedValue:t.zoomPoint,onChange:e=>t.setPreference(QA.GLOBAL_ZOOM_POINT,e.currentTarget.value),inline:!0,children:[Object(xm.jsx)(u.K,{label:"Cursor",value:Ei.CURSOR}),Object(xm.jsx)(u.K,{label:"Current Center",value:Ei.CENTER})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Enable drag-to-pan",children:Object(xm.jsx)(u.P,{checked:t.dragPanning,onChange:e=>t.setPreference(QA.GLOBAL_DRAG_PANNING,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"WCS matching on append",children:Object(xm.jsxs)(u.r,{value:t.autoWCSMatching,onChange:e=>t.setPreference(QA.GLOBAL_AUTO_WCS_MATCHING,Number(e.currentTarget.value)),children:[Object(xm.jsx)("option",{value:mn.NONE,children:"None"}),Object(xm.jsx)("option",{value:mn.SPATIAL,children:"Spatial Only"}),Object(xm.jsx)("option",{value:mn.SPECTRAL,children:"Spectral Only"}),Object(xm.jsx)("option",{value:mn.SPATIAL|mn.SPECTRAL,children:"Spatial and Spectral"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Spectral Matching",children:Object(xm.jsx)(u.r,{value:t.spectralMatchingType,onChange:t=>e.setSpectralMatchingType(t.currentTarget.value),children:Bt.map((e=>Object(xm.jsx)("option",{value:e,children:$t.get(e)},e)))})}),Object(xm.jsx)(u.p,{inline:!0,label:"Transparent Image Background",children:Object(xm.jsx)(u.P,{checked:t.transparentImageBackground,onChange:e=>t.setPreference(QA.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Save last used directory",children:Object(xm.jsx)(u.P,{checked:t.keepLastUsedFolder,onChange:e=>t.setPreference(QA.GLOBAL_KEEP_LAST_USED_FOLDER,e.currentTarget.checked)})})]}),o=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Default Scaling",children:Object(xm.jsx)(SO,{selectedItem:t.scaling,onItemSelect:e=>t.setPreference(QA.RENDER_CONFIG_SCALING,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color Map",children:Object(xm.jsx)(vy,{inverted:!1,selectedItem:t.colormap,onItemSelect:e=>t.setPreference(QA.RENDER_CONFIG_COLORMAP,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Percentile Ranks",children:Object(xm.jsx)(E_,{activeItem:t.percentile.toString(10),onItemSelect:e=>t.setPreference(QA.RENDER_CONFIG_PERCENTILE,Number(e)),popoverProps:{minimal:!0,position:"auto"},filterable:!1,items:Af.PERCENTILE_RANKS.map(String),itemRenderer:this.renderPercentileSelectItem,children:Object(xm.jsx)(u.e,{text:t.percentile.toString(10)+"%",rightIcon:"double-caret-vertical",alignText:"right"})})}),(t.scaling===Rf.LOG||t.scaling===Rf.POWER)&&Object(xm.jsx)(u.p,{label:"Alpha",inline:!0,children:Object(xm.jsx)(pO,{buttonPosition:"none",value:t.scalingAlpha,onValueChange:e=>t.setPreference(QA.RENDER_CONFIG_SCALING_ALPHA,e)})}),t.scaling===Rf.GAMMA&&Object(xm.jsx)(u.p,{label:"Gamma",inline:!0,children:Object(xm.jsx)(pO,{min:Af.GAMMA_MIN,max:Af.GAMMA_MAX,stepSize:.1,minorStepSize:.01,majorStepSize:.5,value:t.scalingGamma,onValueChange:e=>t.setPreference(QA.RENDER_CONFIG_SCALING_GAMMA,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"NaN Color",children:Object(xm.jsx)(jy,{color:je()(t.nanColorHex).setAlpha(t.nanAlpha).toRgb(),presetColors:[...Gb,"transparent"],setColor:e=>{t.setPreference(QA.RENDER_CONFIG_NAN_COLOR_HEX,"transparent"===e.hex?"#000000":e.hex),t.setPreference(QA.RENDER_CONFIG_NAN_ALPHA,e.rgb.a)},disableAlpha:!1,darkTheme:e.darkTheme})}),Object(xm.jsx)(u.p,{inline:!0,label:"Smoothed Bias/Contrast",children:Object(xm.jsx)(u.P,{checked:t.useSmoothedBiasContrast,onChange:e=>t.setPreference(QA.RENDER_CONFIG_USE_SMOOTHED_BIAS_CONTRAST,e.currentTarget.checked)})})]}),s=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Generator Type",children:Object(xm.jsx)(u.r,{value:t.contourGeneratorType,options:Object.keys(xe).map((e=>({label:xe[e],value:xe[e]}))),onChange:e=>t.setPreference(QA.CONTOUR_CONFIG_GENERATOR_TYPE,e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Smoothing Mode",children:Object(xm.jsxs)(u.r,{value:t.contourSmoothingMode,onChange:e=>t.setPreference(QA.CONTOUR_CONFIG_SMOOTHING_MODE,Number(e.currentTarget.value)),children:[Object(xm.jsx)("option",{value:Nt.SmoothingMode.NoSmoothing,children:"No Smoothing"},Nt.SmoothingMode.NoSmoothing),Object(xm.jsx)("option",{value:Nt.SmoothingMode.BlockAverage,children:"Block"},Nt.SmoothingMode.BlockAverage),Object(xm.jsx)("option",{value:Nt.SmoothingMode.GaussianBlur,children:"Gaussian"},Nt.SmoothingMode.GaussianBlur)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Smoothing Factor",children:Object(xm.jsx)(pO,{placeholder:"Default Smoothing Factor",min:1,max:33,value:t.contourSmoothingFactor,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(QA.CONTOUR_CONFIG_SMOOTHING_FACTOR,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Contour Levels",children:Object(xm.jsx)(pO,{placeholder:"Default Contour Levels",min:1,max:15,value:t.contourNumLevels,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(QA.CONTOUR_CONFIG_NUM_LEVELS,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Thickness",children:Object(xm.jsx)(pO,{placeholder:"Thickness",min:.5,max:10,value:t.contourThickness,majorStepSize:.5,stepSize:.5,onValueChange:e=>t.setPreference(QA.CONTOUR_CONFIG_THICKNESS,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color Mode",children:Object(xm.jsxs)(u.r,{value:t.contourColormapEnabled?1:0,onChange:e=>t.setPreference(QA.CONTOUR_CONFIG_COLORMAP_ENABLED,parseInt(e.currentTarget.value)>0),children:[Object(xm.jsx)("option",{value:0,children:"Constant Color"},0),Object(xm.jsx)("option",{value:1,children:"Color-mapped"},1)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color Map",children:Object(xm.jsx)(vy,{inverted:!1,selectedItem:t.contourColormap,onItemSelect:e=>t.setPreference(QA.CONTOUR_CONFIG_COLORMAP,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color",children:Object(xm.jsx)(jy,{color:t.contourColor,presetColors:Gb,setColor:e=>t.setPreference(QA.CONTOUR_CONFIG_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})})]}),a=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Default Pixel Averaging",children:Object(xm.jsx)(pO,{placeholder:"Default Pixel Averaging",min:0,max:64,value:t.vectorOverlayPixelAveraging,majorStepSize:2,stepSize:2,onValueChange:e=>t.setPreference(QA.VECTOR_OVERLAY_PIXEL_AVERAGING,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Use Fractional Intensity",children:Object(xm.jsx)(u.P,{checked:t.vectorOverlayFractionalIntensity,onChange:e=>t.setPreference(QA.VECTOR_OVERLAY_FRACTIONAL_INTENSITY,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Thickness",children:Object(xm.jsx)(pO,{placeholder:"Thickness",min:.5,max:10,value:t.vectorOverlayThickness,majorStepSize:.5,stepSize:.5,onValueChange:e=>t.setPreference(QA.VECTOR_OVERLAY_THICKNESS,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color Mode",children:Object(xm.jsxs)(u.r,{value:t.vectorOverlayColormapEnabled?1:0,onChange:e=>t.setPreference(QA.VECTOR_OVERLAY_COLORMAP_ENABLED,parseInt(e.currentTarget.value)>0),children:[Object(xm.jsx)("option",{value:0,children:"Constant Color"},0),Object(xm.jsx)("option",{value:1,children:"Color-mapped"},1)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color Map",children:Object(xm.jsx)(vy,{inverted:!1,selectedItem:t.vectorOverlayColormap,onItemSelect:e=>t.setPreference(QA.VECTOR_OVERLAY_COLORMAP,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Default Color",children:Object(xm.jsx)(jy,{color:t.vectorOverlayColor,presetColors:Gb,setColor:e=>t.setPreference(QA.VECTOR_OVERLAY_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})})]}),l=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Color",children:Object(xm.jsx)(ny,{color:t.astColor,presetColors:Gb,setColor:e=>t.setPreference(QA.WCS_OVERLAY_AST_COLOR,e),disableAlpha:!0})}),Object(xm.jsx)(u.p,{inline:!0,label:"WCS Grid Visible",children:Object(xm.jsx)(u.P,{checked:t.astGridVisible,onChange:e=>t.setPreference(QA.WCS_OVERLAY_AST_GRID_VISIBLE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Labels Visible",children:Object(xm.jsx)(u.P,{checked:t.astLabelsVisible,onChange:e=>t.setPreference(QA.WCS_OVERLAY_AST_LABELS_VISIBLE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Cursor Info Visible",children:Object(xm.jsxs)(u.r,{value:t.cursorInfoVisible,onChange:e=>t.setPreference(QA.WCS_OVERLAY_CURSOR_INFO,e.currentTarget.value),children:[Object(xm.jsx)("option",{value:_t.Always,children:"Always"}),Object(xm.jsx)("option",{value:_t.ActiveImage,children:"Active image only"}),Object(xm.jsx)("option",{value:_t.HideTiled,children:"Hide when tiled"}),Object(xm.jsx)("option",{value:_t.Never,children:"Never"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"WCS Format",children:Object(xm.jsx)(u.r,{options:[Mi.AUTOMATIC,Mi.DEGREES,Mi.SEXAGESIMAL],value:t.wcsType,onChange:e=>t.setPreference(QA.WCS_OVERLAY_WCS_TYPE,e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Colorbar Visible",children:Object(xm.jsx)(u.P,{checked:t.colorbarVisible,onChange:e=>t.setPreference(QA.WCS_OVERLAY_COLORBAR_VISIBLE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Colorbar Interactive",children:Object(xm.jsx)(u.P,{checked:t.colorbarInteractive,onChange:e=>t.setPreference(QA.WCS_OVERLAY_COLORBAR_INTERACTIVE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Colorbar Position",children:Object(xm.jsxs)(u.r,{value:t.colorbarPosition,onChange:e=>t.setPreference(QA.WCS_OVERLAY_COLORBAR_POSITION,e.currentTarget.value),children:[Object(xm.jsx)("option",{value:"right",children:"right"}),Object(xm.jsx)("option",{value:"top",children:"top"}),Object(xm.jsx)("option",{value:"bottom",children:"bottom"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Colorbar Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Colorbar Width",min:1,max:100,value:t.colorbarWidth,stepSize:1,minorStepSize:1,majorStepSize:2,intOnly:!0,onValueChange:e=>t.setPreference(QA.WCS_OVERLAY_COLORBAR_WIDTH,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Colorbar Ticks Density",labelInfo:"(per 100px)",children:Object(xm.jsx)(pO,{placeholder:"Colorbar Ticks Density",min:.2,max:20,value:t.colorbarTicksDensity,stepSize:.2,minorStepSize:.1,majorStepSize:1,onValueChange:e=>t.setPreference(QA.WCS_OVERLAY_COLORBAR_TICKS_DENSITY,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Colorbar Label Visible",children:Object(xm.jsx)(u.P,{checked:t.colorbarLabelVisible,onChange:e=>t.setPreference(QA.WCS_OVERLAY_COLORBAR_LABEL_VISIBLE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Beam Visible",children:Object(xm.jsx)(u.P,{checked:t.beamVisible,onChange:e=>t.setPreference(QA.WCS_OVERLAY_BEAM_VISIBLE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Beam Color",children:Object(xm.jsx)(ny,{color:t.beamColor,presetColors:Gb,setColor:e=>t.setPreference(QA.WCS_OVERLAY_BEAM_COLOR,e),disableAlpha:!0})}),Object(xm.jsx)(u.p,{inline:!0,label:"Beam Type",children:Object(xm.jsxs)(u.r,{value:t.beamType,onChange:e=>t.setPreference(QA.WCS_OVERLAY_BEAM_TYPE,e.currentTarget.value),children:[Object(xm.jsx)("option",{value:rA.Open,children:"Open"},0),Object(xm.jsx)("option",{value:rA.Solid,children:"Solid"},1)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Beam Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Beam Width",min:.5,max:10,value:t.beamWidth,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>t.setPreference(QA.WCS_OVERLAY_BEAM_WIDTH,e)})})]});let c=[];Ob.AVAILABLE_REGION_TYPES.forEach(((e,t)=>{c.push(Object(xm.jsx)("option",{value:t,children:e},t))}));const p=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Color",children:Object(xm.jsx)(jy,{color:t.regionColor,presetColors:Gb,setColor:e=>t.setPreference(QA.REGION_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})}),Object(xm.jsx)(u.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Line Width",min:Ob.MIN_LINE_WIDTH,max:Ob.MAX_LINE_WIDTH,value:t.regionLineWidth,stepSize:.5,onValueChange:e=>t.setPreference(QA.REGION_LINE_WIDTH,Math.max(Ob.MIN_LINE_WIDTH,Math.min(Ob.MAX_LINE_WIDTH,e)))})}),Object(xm.jsx)(u.p,{inline:!0,label:"Dash Length",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Dash Length",min:0,max:Ob.MAX_DASH_LENGTH,value:t.regionDashLength,stepSize:1,onValueChange:e=>t.setPreference(QA.REGION_DASH_LENGTH,Math.max(0,Math.min(Ob.MAX_DASH_LENGTH,e)))})}),Object(xm.jsx)(u.p,{inline:!0,label:"Region Type",children:Object(xm.jsx)(u.r,{value:t.regionType,onChange:e=>t.setPreference(QA.REGION_TYPE,Number(e.currentTarget.value)),children:c})}),Object(xm.jsx)(u.p,{inline:!0,label:"Region size",labelInfo:"(px)",children:Object(xm.jsx)(pO,{placeholder:"Region size",min:1,value:t.regionSize,stepSize:1,onValueChange:e=>t.setPreference(QA.REGION_SIZE,Math.max(1,e))})}),Object(xm.jsx)(u.p,{inline:!0,label:"Creation Mode",children:Object(xm.jsxs)(u.L,{selectedValue:t.regionCreationMode,onChange:e=>t.setPreference(QA.REGION_CREATION_MODE,e.currentTarget.value),children:[Object(xm.jsx)(u.K,{label:"Center to corner",value:Fi.CENTER}),Object(xm.jsx)(u.K,{label:"Corner to corner",value:Fi.CORNER})]})})]}),h=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Low bandwidth mode",children:Object(xm.jsx)(u.P,{checked:t.lowBandwidthMode,onChange:e=>t.setPreference(QA.PERFORMANCE_LOW_BAND_WIDTH_MODE,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Limit overlay redraw",children:Object(xm.jsx)(u.P,{checked:t.limitOverlayRedraw,onChange:e=>t.setPreference(QA.PERFORMANCE_LIMIT_OVERLAY_REDRAW,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Compression Quality",labelInfo:"(Images)",children:Object(xm.jsx)(pO,{placeholder:"Compression Quality",min:ki.IMAGE_MIN,max:ki.IMAGE_MAX,value:t.imageCompressionQuality,stepSize:ki.IMAGE_STEP,onValueChange:this.handleImageCompressionQualityChange})}),Object(xm.jsx)(u.p,{inline:!0,label:"Compression Quality",labelInfo:"(Animation)",children:Object(xm.jsx)(pO,{placeholder:"Compression Quality",min:ki.ANIMATION_MIN,max:ki.ANIMATION_MAX,value:t.animationCompressionQuality,stepSize:ki.ANIMATION_STEP,onValueChange:this.handleAnimationCompressionQualityChange})}),Object(xm.jsx)(u.p,{inline:!0,label:"GPU Tile Cache Size",children:Object(xm.jsx)(pO,{placeholder:"GPU Tile Cache Size",min:Di.GPU_MIN,max:Di.GPU_MAX,value:t.gpuTileCache,majorStepSize:Di.GPU_STEP,stepSize:Di.GPU_STEP,onValueChange:this.handleGPUTileCacheChange})}),Object(xm.jsx)(u.p,{inline:!0,label:"System Tile Cache Size",children:Object(xm.jsx)(pO,{placeholder:"System Tile Cache Size",min:Di.SYSTEM_MIN,max:Di.SYSTEM_MAX,value:t.systemTileCache,majorStepSize:Di.SYSTEM_STEP,stepSize:Di.SYSTEM_STEP,onValueChange:this.handleSystemTileCacheChange})}),Object(xm.jsx)(u.p,{inline:!0,label:"Contour Rounding Factor",children:Object(xm.jsx)(pO,{placeholder:"Contour Rounding Factor",min:1,max:32,value:t.contourDecimation,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(QA.PERFORMANCE_CONTOUR_DECIMATION,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Contour Compression Level",children:Object(xm.jsx)(pO,{placeholder:"Contour Compression Level",min:0,max:19,value:t.contourCompressionLevel,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(QA.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,e)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Contour Chunk Size",children:Object(xm.jsxs)(u.r,{value:t.contourChunkSize,onChange:e=>t.setPreference(QA.PERFORMANCE_CONTOUR_CHUNK_SIZE,parseInt(e.currentTarget.value)),children:[Object(xm.jsx)("option",{value:25e3,children:"25K"},0),Object(xm.jsx)("option",{value:5e4,children:"50K"},1),Object(xm.jsx)("option",{value:1e5,children:"100K"},2),Object(xm.jsx)("option",{value:25e4,children:"250K"},3),Object(xm.jsx)("option",{value:5e5,children:"500K"},4),Object(xm.jsx)("option",{value:1e6,children:"1M"},5)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Control Map Resolution",children:Object(xm.jsxs)(u.r,{value:t.contourControlMapWidth,onChange:e=>t.setPreference(QA.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,parseInt(e.currentTarget.value)),children:[Object(xm.jsx)("option",{value:128,children:"128\xd7128 (128 KB)"},0),Object(xm.jsx)("option",{value:256,children:"256\xd7256 (512 KB)"},1),Object(xm.jsx)("option",{value:512,children:"512\xd7512 (2 MB)"},2),Object(xm.jsx)("option",{value:1024,children:"1024\xd71024 (8 MB)"},3)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Stream image tiles while zooming",children:Object(xm.jsx)(u.P,{checked:t.streamContoursWhileZooming,onChange:e=>t.setPreference(QA.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,e.currentTarget.checked)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Stop animation playback in",children:Object(xm.jsxs)(u.r,{value:t.stopAnimationPlaybackMinutes,onChange:e=>t.setPreference(QA.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,parseInt(e.currentTarget.value)),children:[Object(xm.jsx)("option",{value:5,children:"5 minutes"},0),Object(xm.jsx)("option",{value:10,children:"10 minutes"},1),Object(xm.jsx)("option",{value:15,children:"15 minutes"},2),Object(xm.jsx)("option",{value:20,children:"20 minutes"},3),Object(xm.jsx)("option",{value:30,children:"30 minutes"},4)]})})]}),f=Object(xm.jsxs)("div",{className:"log-event-panel",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Enable logged event type",className:"log-event-header",children:Object(xm.jsx)(u.h,{label:"Select all",checked:t.isSelectingAllLogEvents,indeterminate:t.isSelectingIndeterminateLogEvents,onChange:()=>t.selectAllLogEvents()})}),Object(xm.jsx)(u.p,{inline:!1,className:"log-event-list",children:Li.EVENT_TYPES.map((e=>Object(xm.jsx)(u.h,{className:"log-event-checkbox",checked:t.isEventLoggingEnabled(e),label:Li.getEventNameFromType(e),onChange:()=>t.setPreference(QA.LOG_EVENT,e)},e)))})]}),b=Object(xm.jsx)("div",{className:"panel-container",children:Object(xm.jsx)(u.p,{inline:!0,label:"Displayed columns",children:Object(xm.jsx)(pO,{placeholder:"Default Displayed Columns",min:1,value:t.catalogDisplayedColumnSize,stepSize:1,onValueChange:e=>t.setPreference(QA.CATALOG_DISPLAYED_COLUMN_SIZE,e)})})});let m;m=t.telemetryMode===Sj.Usage?"Operating system and browser information will be collected, as well as anonymous usage data.":t.telemetryMode===Sj.Minimal?"Operating system and browser information will be collected. No usage data will be collected.":"No data will be collected.";const O=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)("div",{className:"telemetry-callout",children:Object(xm.jsxs)(u.g,{intent:"primary",children:[Object(xm.jsxs)("p",{children:["CARTA can collect anonymous usage data, in order to help the development team prioritize additional features and platforms. No personal or scientific information will be collected. Please see our"," ",Object(xm.jsx)("a",{rel:"noopener noreferrer",href:"https://cartavis.org/telemetry",target:"_blank",children:"data collection policy"})," ","for more details."]}),t.telemetryUuid&&Object(xm.jsxs)("div",{className:"telemetry-id-text",children:[Object(xm.jsxs)("p",{children:["Anonymous user ID: ",e.telemetryService.decodedUserId]}),Object(xm.jsx)(u.e,{minimal:!0,intent:"primary",icon:"clipboard",onClick:this.handleUserIdCopied})]})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Telemetry mode",helperText:m,className:"telemetry-mode-form-group",children:Object(xm.jsxs)(u.r,{value:t.telemetryMode,onChange:e=>t.setPreference(QA.TELEMETRY_MODE,e.currentTarget.value),children:[Object(xm.jsx)("option",{value:Sj.None,children:"Disabled"}),Object(xm.jsx)("option",{value:Sj.Minimal,children:"Minimal"}),Object(xm.jsx)("option",{value:Sj.Usage,children:"Full"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Log telemetry output",children:Object(xm.jsx)(u.P,{checked:t.telemetryLogging,onChange:e=>t.setPreference(QA.TELEMETRY_LOGGING,e.currentTarget.checked)})})]}),x={icon:"wrench",backdropClassName:"minimal-dialog-backdrop",className:d()("preference-dialog",{"bp3-dark":e.darkTheme}),canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.preferenceDialogVisible,onClose:e.dialogStore.hidePreferenceDialog,title:"Preferences"};return Object(xm.jsxs)(fL,{dialogProps:x,helpType:xM.PREFERENCES,minWidth:450,minHeight:300,defaultWidth:775,defaultHeight:500,enableResizing:!0,children:[Object(xm.jsx)("div",{className:"bp3-dialog-body",children:Object(xm.jsxs)(u.R,{id:"preferenceTabs",vertical:!0,selectedTabId:this.selectedTab,onChange:this.setSelectedTab,children:[Object(xm.jsx)(u.Q,{id:P_.GLOBAL,title:"Global",panel:r}),Object(xm.jsx)(u.Q,{id:P_.RENDER_CONFIG,title:"Render Configuration",panel:o}),Object(xm.jsx)(u.Q,{id:P_.CONTOUR_CONFIG,title:"Contour Configuration",panel:s}),Object(xm.jsx)(u.Q,{id:P_.VECTOR_OVERLAY_CONFIG,title:"Vector Overlay Configuration",panel:a}),Object(xm.jsx)(u.Q,{id:P_.WCS_OVERLAY_CONFIG,title:"WCS and Image Overlay",panel:l}),Object(xm.jsx)(u.Q,{id:P_.CATALOG,title:"Catalog",panel:b}),Object(xm.jsx)(u.Q,{id:P_.REGION,title:"Region",panel:p}),Object(xm.jsx)(u.Q,{id:P_.PERFORMANCE,title:"Performance",panel:h}),Object(xm.jsx)(u.Q,{id:P_.TELEMETRY,title:"Telemetry",panel:O}),Object(xm.jsx)(u.Q,{id:P_.LOG_EVENT,title:"Log Events",panel:f})]})}),Object(xm.jsx)("div",{className:"bp3-dialog-footer",children:Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(j.a,{content:"Apply to current tab only.",position:y.a.TOP,children:Object(xm.jsx)(u.b,{intent:g.a.WARNING,icon:"refresh",onClick:this.reset,text:"Restore defaults"})}),Object(xm.jsx)(u.e,{intent:g.a.NONE,onClick:e.dialogStore.hidePreferenceDialog,text:"Close"})]})})]})}},R_=Object(b.a)(T_.prototype,"selectedTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return P_.GLOBAL}}),A_=Object(b.a)(T_.prototype,"setSelectedTab",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTab=e}}}),w_=T_))||w_;var F_;i(853);let k_=Object(p.a)(F_=class extends n.Component{render(){const e=gC.Instance,t={icon:"app-header",className:d()("file-info-dialog",{"bp3-dark":e.darkTheme}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.fileInfoDialogVisible,onClose:e.dialogStore.hideFileInfoDialog,title:"File Header"};return Object(xm.jsx)(fL,{dialogProps:t,helpType:xM.FILE_INFO,minWidth:400,minHeight:400,defaultWidth:800,defaultHeight:600,enableResizing:!0,children:Object(xm.jsx)("div",{className:"bp3-dialog-body",children:Object(xm.jsx)(LL,{infoTypes:[DL.IMAGE_FILE,DL.IMAGE_HEADER],fileInfoExtended:e.activeFrame?e.activeFrame.frameInfo.fileInfoExtended:null,regionFileInfo:"",catalogFileInfo:null,selectedTab:e.dialogStore.selectedFileInfoDialogTab,handleTabChange:e.dialogStore.setSelectedFileInfoDialogTab,isLoading:!1,errorMessage:""})})})}})||F_;var D_,L_,N_;i(854);let __=Object(p.a)((L_=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"layoutName",N_,this),this.handleInput=e=>{this.layoutName=e.currentTarget.value},this.clearInput=()=>{this.layoutName=""},this.handleKeyDown=e=>{13!==e.keyCode||this.isEmpty||this.saveLayout()},this.saveLayout=async()=>{const e=gC.Instance;if(e.dialogStore.hideSaveLayoutDialog(),e.layoutStore.setLayoutToBeSaved(this.layoutName),e.layoutStore.layoutExists(this.layoutName))if(Ri.isPreset(this.layoutName))e.alertStore.showAlert("Layout name cannot be the same as system presets.");else{await e.alertStore.showInteractiveAlert(`Are you sure to overwrite the existing layout ${this.layoutName}?`)&&await e.layoutStore.saveLayout()}else await e.layoutStore.saveLayout();this.clearInput()},Object(m.p)(this)}get isEmpty(){return!this.layoutName}render(){const e=gC.Instance,t={icon:"layout-grid",backdropClassName:"minimal-dialog-backdrop",className:d()("preference-dialog",{"bp3-dark":e.darkTheme}),canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.saveLayoutDialogVisible,onClose:e.dialogStore.hideSaveLayoutDialog,title:"Save Layout"};return Object(xm.jsxs)(fL,{dialogProps:t,helpType:xM.SAVE_LAYOUT,defaultWidth:400,defaultHeight:185,enableResizing:!0,children:[Object(xm.jsx)("div",{className:hS.a.DIALOG_BODY,children:Object(xm.jsx)(u.p,{inline:!0,label:"Save current layout as:",children:Object(xm.jsx)(u.x,{className:"layout-name-input",placeholder:"Enter layout name",value:this.layoutName,autoFocus:!0,onChange:this.handleInput,onKeyDown:this.handleKeyDown})})}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[Object(xm.jsx)(j.a,{content:"Layout name cannot be empty!",disabled:!this.isEmpty,children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,onClick:this.saveLayout,text:"Save",disabled:this.isEmpty})}),Object(xm.jsx)(u.e,{intent:g.a.NONE,text:"Close",onClick:()=>{e.dialogStore.hideSaveLayoutDialog(),this.clearInput()}})]})})]})}},N_=Object(b.a)(L_.prototype,"layoutName",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(b.a)(L_.prototype,"isEmpty",[m.i],Object.getOwnPropertyDescriptor(L_.prototype,"isEmpty"),L_.prototype),D_=L_))||D_;var z_;i(855);const V_=A.a.ofType();let W_=Object(p.a)(z_=class extends n.Component{constructor(...e){super(...e),this.renderDashModeSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(xm.jsx)(u.B,{text:Se[e],onClick:t},e)}render(){const e=this.props.frame;return Object(xm.jsxs)("div",{className:"contour-style-panel",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Thickness",children:Object(xm.jsx)(pO,{placeholder:"Thickness",min:.5,max:10,value:e.contourConfig.thickness,majorStepSize:.5,stepSize:.5,onValueChange:e.contourConfig.setThickness})}),Object(xm.jsx)(u.p,{inline:!0,label:"Dashes",children:Object(xm.jsx)(V_,{activeItem:e.contourConfig.dashMode,onItemSelect:e.contourConfig.setDashMode,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:[Se.None,Se.Dashed,Se.NegativeOnly],itemRenderer:this.renderDashModeSelectItem,children:Object(xm.jsx)(u.e,{text:Se[e.contourConfig.dashMode],rightIcon:"double-caret-vertical",alignText:"right"})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Color Mode",children:Object(xm.jsxs)(u.r,{value:e.contourConfig.colormapEnabled?1:0,onChange:t=>e.contourConfig.setColormapEnabled(parseInt(t.currentTarget.value)>0),children:[Object(xm.jsx)("option",{value:0,children:"Constant Color"},0),Object(xm.jsx)("option",{value:1,children:"Color-mapped"},1)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Color Map",disabled:!e.contourConfig.colormapEnabled,children:Object(xm.jsx)(vy,{inverted:!1,disabled:!e.contourConfig.colormapEnabled,selectedItem:e.contourConfig.colormap,onItemSelect:e.contourConfig.setColormap})}),Object(xm.jsx)(u.p,{inline:!0,label:"Bias",disabled:!e.contourConfig.colormapEnabled,children:Object(xm.jsx)(pO,{disabled:!e.contourConfig.colormapEnabled,placeholder:"Bias",min:-1,max:1,value:e.contourConfig.colormapBias,majorStepSize:.1,stepSize:.1,onValueChange:e.contourConfig.setColormapBias})}),Object(xm.jsx)(u.p,{inline:!0,label:"Contrast",disabled:!e.contourConfig.colormapEnabled,children:Object(xm.jsx)(pO,{disabled:!e.contourConfig.colormapEnabled,placeholder:"Contrast",min:0,max:3,value:e.contourConfig.colormapContrast,majorStepSize:.1,stepSize:.1,onValueChange:e.contourConfig.setColormapContrast})}),Object(xm.jsx)(u.p,{inline:!0,label:"Color",disabled:e.contourConfig.colormapEnabled,children:Object(xm.jsx)(jy,{color:e.contourConfig.color,presetColors:Gb,setColor:t=>e.contourConfig.setColor(t.rgb),disableAlpha:!0,disabled:e.contourConfig.colormapEnabled,darkTheme:this.props.darkTheme})})]})}})||z_;var G_,B_,q_,H_,Y_,U_,X_,$_,K_,Q_,Z_,J_,ez,tz,iz,nz,rz,oz;i(856);const sz=A.a.ofType();let az=Object(p.a)((B_=class extends n.Component{get minValue(){return void 0===this.enteredMinValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Hi(this.props.frame.renderConfig.contourHistogram,[.1])[0]:this.enteredMinValue}get maxValue(){return void 0===this.enteredMaxValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Hi(this.props.frame.renderConfig.contourHistogram,[99.9])[0]:this.enteredMaxValue}constructor(e){super(e),Object(f.a)(this,"generator",q_,this),Object(f.a)(this,"numLevels",H_,this),Object(f.a)(this,"enteredMinValue",Y_,this),Object(f.a)(this,"enteredMaxValue",U_,this),Object(f.a)(this,"scalingType",X_,this),this.generateMinMaxLevels=()=>{if(isFinite(this.minValue)&&isFinite(this.maxValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[(this.maxValue+this.minValue)/2];{const e=this.maxValue-this.minValue,t=this.numLevels-1,i=[];for(let n=0;n<this.numLevels;n++){const r=Xi(n/t,this.scalingType);i.push(this.minValue+e*r)}return i}}return[]},Object(f.a)(this,"enteredStartValue",$_,this),Object(f.a)(this,"enteredStepValue",K_,this),Object(f.a)(this,"multiplierValue",Q_,this),this.generateStartStepLevels=()=>{if(isFinite(this.startValue)&&isFinite(this.stepValue)&&isFinite(this.multiplierValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[this.startValue];{let e=this.stepValue,t=this.startValue;const i=[];for(let n=0;n<this.numLevels;n++)i.push(t),t+=e,e*=this.multiplierValue;return i}}return[]},Object(f.a)(this,"enteredRefValue",Z_,this),Object(f.a)(this,"lowerPercentage",J_,this),Object(f.a)(this,"upperPercentage",ez,this),this.generatePercentageRefLevels=()=>{if(isFinite(this.upperPercentage)&&isFinite(this.lowerPercentage)&&isFinite(this.refValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[this.refValue];{const e=(this.upperPercentage-this.lowerPercentage)/(this.numLevels-1),t=[];for(let i=0;i<this.numLevels;i++)t.push(this.refValue*(this.lowerPercentage+e*i)/100);return t}}return[]},Object(f.a)(this,"enteredMeanValue",tz,this),Object(f.a)(this,"enteredSigmaValue",iz,this),Object(f.a)(this,"sigmaLevels",nz,this),Object(f.a)(this,"handleLevelAdded",rz,this),Object(f.a)(this,"handleLevelRemoved",oz,this),this.generateMeanSigmaLevels=()=>this.sigmaLevels.map((e=>this.meanValue+this.sigmaValue*e)).filter((e=>isFinite(e))),this.renderGeneratorSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(xm.jsx)(u.B,{text:e,onClick:t},e),this.generateLevels=()=>{switch(this.generator){case xe.MinMaxNScaling:this.props.onLevelsGenerated(this.generateMinMaxLevels());break;case xe.StartStepMultiplier:this.props.onLevelsGenerated(this.generateStartStepLevels());break;case xe.PercentagesRefValue:this.props.onLevelsGenerated(this.generatePercentageRefLevels());break;case xe.MeanSigmaList:this.props.onLevelsGenerated(this.generateMeanSigmaLevels())}},Object(m.p)(this)}renderMinMaxParameterRow(){return this.props.frame?Object(xm.jsxs)("div",{className:"parameter-container",children:[Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(hy,{label:"Min",value:this.minValue,onValueChanged:e=>this.enteredMinValue=e,onValueCleared:()=>this.enteredMinValue=void 0,displayExponential:!0}),Object(xm.jsx)(hy,{label:"Max",value:this.maxValue,onValueChanged:e=>this.enteredMaxValue=e,onValueCleared:()=>this.enteredMaxValue=void 0,displayExponential:!0})]}),Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(u.p,{label:"N",inline:!0,children:Object(xm.jsx)(pO,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})}),Object(xm.jsx)(u.p,{label:"Scaling",inline:!0,children:Object(xm.jsx)(SO,{selectedItem:this.scalingType,onItemSelect:e=>this.scalingType=e})})]})]}):null}get startValue(){return void 0===this.enteredStartValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.mean+5*this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredStartValue}get stepValue(){return void 0===this.enteredStepValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?4*this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredStepValue}renderStartStepParameterRow(){return this.props.frame?Object(xm.jsxs)("div",{className:"parameter-container",children:[Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(hy,{label:"Start",value:this.startValue,onValueChanged:e=>this.enteredStartValue=e,onValueCleared:()=>this.enteredStartValue=void 0,displayExponential:!0}),Object(xm.jsx)(hy,{label:"Step",value:this.stepValue,onValueChanged:e=>this.enteredStepValue=e,onValueCleared:()=>this.enteredStepValue=void 0,displayExponential:!0})]}),Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(u.p,{label:"N",inline:!0,children:Object(xm.jsx)(pO,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})}),Object(xm.jsx)(u.p,{label:"Multiplier",inline:!0,children:Object(xm.jsx)(pO,{value:this.multiplierValue,min:.1,stepSize:1,className:"narrow",onValueChange:e=>this.multiplierValue=e})})]})]}):null}get refValue(){return void 0===this.enteredRefValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Hi(this.props.frame.renderConfig.contourHistogram,[99.9])[0]:this.enteredRefValue}renderPercentageRefParameterRow(){return this.props.frame?Object(xm.jsxs)("div",{className:"parameter-container",children:[Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(hy,{label:"Reference",value:this.refValue,onValueChanged:e=>this.enteredRefValue=e,onValueCleared:()=>this.enteredRefValue=void 0,displayExponential:!0}),Object(xm.jsx)(u.p,{label:"N",inline:!0,children:Object(xm.jsx)(pO,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})})]}),Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(u.p,{label:"Upper (%)",inline:!0,children:Object(xm.jsx)(pO,{value:this.upperPercentage,min:0,max:100,stepSize:1,className:"narrow",onValueChange:e=>this.upperPercentage=e})}),Object(xm.jsx)(u.p,{label:"Lower (%)",inline:!0,children:Object(xm.jsx)(pO,{value:this.lowerPercentage,min:0,max:100,stepSize:1,className:"narrow",onValueChange:e=>this.lowerPercentage=e})})]})]}):null}get meanValue(){return void 0===this.enteredMeanValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.mean:this.enteredMeanValue}get sigmaValue(){return void 0===this.enteredSigmaValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredSigmaValue}renderMeanSigmaParameterRow(){return this.props.frame?Object(xm.jsxs)("div",{className:"parameter-container",children:[Object(xm.jsxs)("div",{className:"parameter-line",children:[Object(xm.jsx)(hy,{label:"Mean",value:this.meanValue,onValueChanged:e=>this.enteredMeanValue=e,onValueCleared:()=>this.enteredMeanValue=void 0,displayExponential:!0}),Object(xm.jsx)(hy,{label:"Sigma",value:this.sigmaValue,onValueChanged:e=>this.enteredSigmaValue=e,onValueCleared:()=>this.enteredSigmaValue=void 0,displayExponential:!0})]}),Object(xm.jsx)("div",{className:"parameter-line",children:Object(xm.jsx)(u.p,{label:"Sigma List",inline:!0,children:Object(xm.jsx)(u.T,{addOnBlur:!0,fill:!0,tagProps:{minimal:!0},onAdd:this.handleLevelAdded,onRemove:this.handleLevelRemoved,values:this.sigmaLevels.map((e=>e.toString()))})})})]}):null}render(){if(!this.props.frame)return null;let e;switch(this.generator){case xe.MinMaxNScaling:e=this.renderMinMaxParameterRow();break;case xe.StartStepMultiplier:e=this.renderStartStepParameterRow();break;case xe.PercentagesRefValue:e=this.renderPercentageRefParameterRow();break;case xe.MeanSigmaList:e=this.renderMeanSigmaParameterRow()}return Object(xm.jsxs)("div",{className:"contour-generator-panel",children:[Object(xm.jsxs)("div",{className:"generator-select-row",children:[Object(xm.jsx)(u.p,{label:"Generator",inline:!0,children:Object(xm.jsx)(sz,{activeItem:this.generator,popoverProps:xO,filterable:!1,items:[xe.StartStepMultiplier,xe.MinMaxNScaling,xe.PercentagesRefValue,xe.MeanSigmaList],onItemSelect:e=>this.generator=e,itemRenderer:this.renderGeneratorSelectItem,children:Object(xm.jsx)(u.e,{text:this.generator,rightIcon:"double-caret-vertical",alignText:"right"})})}),Object(xm.jsx)(u.e,{intent:"success",className:"generate-button",onClick:this.generateLevels,children:"Generate"})]}),Object(xm.jsx)("div",{className:"generator-parameters-row",children:Object(xm.jsx)(u.p,{label:"Parameters",inline:!0,children:e})})]})}},q_=Object(b.a)(B_.prototype,"generator",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.props.generatorType?this.props.generatorType:xe.StartStepMultiplier}}),H_=Object(b.a)(B_.prototype,"numLevels",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Y_=Object(b.a)(B_.prototype,"enteredMinValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U_=Object(b.a)(B_.prototype,"enteredMaxValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X_=Object(b.a)(B_.prototype,"scalingType",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Rf.LINEAR}}),Object(b.a)(B_.prototype,"minValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"minValue"),B_.prototype),Object(b.a)(B_.prototype,"maxValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"maxValue"),B_.prototype),$_=Object(b.a)(B_.prototype,"enteredStartValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K_=Object(b.a)(B_.prototype,"enteredStepValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q_=Object(b.a)(B_.prototype,"multiplierValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Object(b.a)(B_.prototype,"startValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"startValue"),B_.prototype),Object(b.a)(B_.prototype,"stepValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"stepValue"),B_.prototype),Z_=Object(b.a)(B_.prototype,"enteredRefValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J_=Object(b.a)(B_.prototype,"lowerPercentage",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),ez=Object(b.a)(B_.prototype,"upperPercentage",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Object(b.a)(B_.prototype,"refValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"refValue"),B_.prototype),tz=Object(b.a)(B_.prototype,"enteredMeanValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),iz=Object(b.a)(B_.prototype,"enteredSigmaValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nz=Object(b.a)(B_.prototype,"sigmaLevels",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[-5,5,9,13,17]}}),Object(b.a)(B_.prototype,"meanValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"meanValue"),B_.prototype),Object(b.a)(B_.prototype,"sigmaValue",[m.i],Object.getOwnPropertyDescriptor(B_.prototype,"sigmaValue"),B_.prototype),rz=Object(b.a)(B_.prototype,"handleLevelAdded",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{try{for(const t of e){const e=parseFloat(t);isFinite(e)&&this.sigmaLevels.push(e)}}catch(t){console.log(t)}}}}),oz=Object(b.a)(B_.prototype,"handleLevelRemoved",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.sigmaLevels=this.sigmaLevels.filter(((e,i)=>i!==t))}}}),G_=B_))||G_;var lz,cz,dz,pz,hz,uz,gz,fz,bz,mz,yz,Oz,jz,xz;i(857);!function(e){e[e.Levels=0]="Levels",e[e.Configuration=1]="Configuration",e[e.Styling=2]="Styling"}(xz||(xz={}));const Sz=A.a.ofType(),vz=A.a.ofType();let Cz=Object(p.a)((jz=Oz=class e extends n.Component{constructor(e){super(e),Object(f.a)(this,"showCubeHistogramAlert",dz,this),Object(f.a)(this,"currentTab",pz,this),Object(f.a)(this,"levels",hz,this),Object(f.a)(this,"smoothingMode",uz,this),Object(f.a)(this,"smoothingFactor",gz,this),this.widgetStore=void 0,this.cachedFrame=void 0,this.cachedHistogram=void 0,this.renderDataSourceSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>e?Object(xm.jsx)(u.B,{text:e.filename,onClick:t},e.frameInfo.fileId):null,this.renderHistogramSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(xm.jsx)(u.B,{text:e?"Per-Cube":"Per-Channel",onClick:t},e?"cube":"channel"),this.handleHistogramChange=e=>{const t=gC.Instance;t&&t.contourDataSource&&(e&&!t.contourDataSource.renderConfig.cubeHistogram?t.contourDataSource.frameInfo.fileFeatureFlags&Nt.FileFeatureFlags.CUBE_HISTOGRAMS?this.handleAlertConfirm():this.showCubeHistogramAlert=!0:t.contourDataSource.renderConfig.setUseCubeHistogramContours(e))},this.handleAlertConfirm=()=>{const e=gC.Instance,t=e.contourDataSource;t&&t.renderConfig&&(t.renderConfig.setUseCubeHistogramContours(!0),t.renderConfig.cubeHistogramProgress<1&&e.requestCubeHistogram(t.frameInfo.fileId)),this.showCubeHistogramAlert=!1},this.handleAlertCancel=()=>{this.showCubeHistogramAlert=!1},this.handleCubeHistogramCancelled=()=>{const e=gC.Instance,t=e.contourDataSource;t&&t.renderConfig&&t.renderConfig.setUseCubeHistogramContours(!1),e.cancelCubeHistogramRequest(t.frameInfo.fileId)},this.handleApplyContours=()=>{const e=gC.Instance.contourDataSource;e&&(e.contourConfig.setContourConfiguration(this.levels.slice(),this.smoothingMode,this.smoothingFactor),e.applyContours())},this.handleClearContours=()=>{const e=gC.Instance;e.contourDataSource&&e.contourDataSource.clearContours()},this.handleGraphClicked=e=>{this.levels.push(e)},this.handleGraphRightClicked=e=>{let t=-1,i=Number.MAX_VALUE;for(let n=0;n<this.levels.length;n++){const r=Math.abs(e-this.levels[n]);r<i&&(i=r,t=n)}t>=0&&(this.levels=this.levels.filter(((e,i)=>i!==t)))},Object(f.a)(this,"handleLevelAdded",fz,this),Object(f.a)(this,"handleLevelRemoved",bz,this),Object(f.a)(this,"handleLevelDragged",mz,this),Object(f.a)(this,"handleLevelsGenerated",yz,this),Object(m.p)(this),this.widgetStore=new kr,this.setDefaultContourParameters(),Object(m.h)((()=>{const e=gC.Instance;if(e.contourDataSource){const t=e.contourDataSource.renderConfig.contourHistogram;t!==this.cachedHistogram&&(this.cachedHistogram=t,this.widgetStore.clearXYBounds())}const t=this.widgetStore;if(t){const e=this.plotData;e&&t.initXYBoundaries(e.xMin,e.xMax,e.yMin,e.yMax)}}))}setDefaultContourParameters(){const e=gC.Instance,t=e.contourDataSource;t?(this.levels=t.contourConfig.levels.slice(),this.smoothingMode=t.contourConfig.smoothingMode,this.smoothingFactor=t.contourConfig.smoothingFactor):(this.levels=[],this.smoothingMode=e.preferenceStore.contourSmoothingMode,this.smoothingFactor=e.preferenceStore.contourSmoothingFactor)}componentDidUpdate(){const e=gC.Instance;e.contourDataSource!==this.cachedFrame&&(this.cachedFrame=e.contourDataSource,this.widgetStore.clearXYBounds(),this.setDefaultContourParameters())}get contourConfigChanged(){const e=gC.Instance.contourDataSource;if(e){const t=this.levels.length;if(e.contourConfig.smoothingMode!==this.smoothingMode)return!0;if(e.contourConfig.smoothingFactor!==this.smoothingFactor)return!0;if(e.contourConfig.levels.length!==t)return!0;for(let i=0;i<t;i++)if(e.contourConfig.levels[i]!==this.levels[i])return!0}return!1}get plotData(){const e=gC.Instance.contourDataSource;if(e&&e.renderConfig.contourHistogram&&e.renderConfig.contourHistogram.bins&&e.renderConfig.contourHistogram.bins.length){const t=e.renderConfig.contourHistogram;let i=0,n=t.bins.length-1;this.widgetStore.isAutoScaledX||(i=Math.floor((this.widgetStore.minX-t.firstBinCenter)/t.binWidth),i=Gi(i,0,t.bins.length-1),n=Math.ceil((this.widgetStore.maxX-t.firstBinCenter)/t.binWidth),n=Gi(n,0,t.bins.length-1));let r,o=t.firstBinCenter+t.binWidth*i,s=t.firstBinCenter+t.binWidth*n,a=t.bins[i],l=a;const c=n-i;if(c>0&&!isNaN(c)){r=new Array(n-i);for(let e=i;e<=n;e++)r[e-i]={x:t.firstBinCenter+t.binWidth*e,y:t.bins[e]},a=Math.min(a,t.bins[e]),l=Math.max(l,t.bins[e])}return{values:r,xMin:o,xMax:s,yMin:a,yMax:l}}return null}render(){const t=gC.Instance,i={icon:Object(xm.jsx)(jN,{icon:"contour",size:jN.SIZE_LARGE}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.contourDialogVisible,onClose:t.dialogStore.hideContourDialog,className:"contour-dialog",canEscapeKeyClose:!0,title:"Contour Configuration"};if(!t||!t.contourDataSource)return Object(xm.jsx)(fL,{dialogProps:i,helpType:xM.CONTOUR,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});const n=t.contourDataSource;let r="Value";n.headerUnit&&(r=`Value (${n.headerUnit})`);const o={xLabel:r,darkMode:t.darkTheme,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,showYAxisTicks:!1,showYAxisLabel:!1,graphClicked:this.handleGraphClicked,graphRightClicked:this.handleGraphRightClicked,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2},s=this.plotData;if(s){let e=Jb(this.widgetStore.primaryLineColor);if(o.lineColor=e,this.widgetStore.isAutoScaledX){const e=Math.min(s.xMin,...this.levels),t=Math.max(s.xMax,...this.levels),i=t-e;o.xMin=e-.01*i,o.xMax=t+.01*i}else o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX;this.widgetStore.isAutoScaledY?(o.yMin=s.yMin,o.yMax=s.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5),o.data=s.values}const a=this.levels&&this.levels.filter((e=>isFinite(e))).length;o.markers=a?this.levels.map(((e,t)=>({value:e,id:`marker-${t}`,draggable:!0,dragMove:this.handleLevelDragged(t),horizontal:!1}))):[],this.widgetStore.meanRmsVisible&&n.renderConfig.contourHistogram&&n.renderConfig.contourHistogram.stdDev>0&&(o.markers.push({value:n.renderConfig.contourHistogram.mean,id:"marker-mean",draggable:!1,horizontal:!1,color:t.darkTheme?L.a.GREEN4:L.a.GREEN2,dash:[5]}),o.markers.push({value:n.renderConfig.contourHistogram.mean,id:"marker-rms",draggable:!1,horizontal:!1,width:n.renderConfig.contourHistogram.stdDev,opacity:.2,color:t.darkTheme?L.a.GREEN4:L.a.GREEN2}));let l=this.levels.slice().sort(((e,t)=>e-t)).map((e=>Math.abs(e)<.1?gi(e,2):fi(e,2)));const c=Object(xm.jsxs)("div",{className:"contour-level-panel",children:[n.frameInfo.fileInfoExtended.depth>1&&Object(xm.jsx)(u.p,{label:"Histogram",inline:!0,children:Object(xm.jsx)(vz,{activeItem:n.renderConfig.useCubeHistogramContours,popoverProps:xO,filterable:!1,items:[!0,!1],onItemSelect:this.handleHistogramChange,itemRenderer:this.renderHistogramSelectItem,children:Object(xm.jsx)(u.e,{text:n.renderConfig.useCubeHistogramContours?"Per-Cube":"Per-Channel",rightIcon:"double-caret-vertical",alignText:"right"})})}),Object(xm.jsx)("div",{className:"histogram-plot",children:Object(xm.jsx)(iO,{...o})}),Object(xm.jsx)(az,{frame:n,generatorType:t.preferenceStore.contourGeneratorType,onLevelsGenerated:this.handleLevelsGenerated}),Object(xm.jsx)("div",{className:"contour-level-panel-levels",children:Object(xm.jsx)(u.p,{label:"Levels",inline:!0,children:Object(xm.jsx)(u.T,{addOnBlur:!0,fill:!0,tagProps:{minimal:!0},onAdd:this.handleLevelAdded,onRemove:this.handleLevelRemoved,values:l})})})]}),d=Object(xm.jsxs)("div",{className:"contour-config-panel",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Smoothing Mode",children:Object(xm.jsxs)(u.r,{value:this.smoothingMode,onChange:e=>this.smoothingMode=Number(e.currentTarget.value),children:[Object(xm.jsx)("option",{value:Nt.SmoothingMode.NoSmoothing,children:"No Smoothing"},Nt.SmoothingMode.NoSmoothing),Object(xm.jsx)("option",{value:Nt.SmoothingMode.BlockAverage,children:"Block"},Nt.SmoothingMode.BlockAverage),Object(xm.jsx)("option",{value:Nt.SmoothingMode.GaussianBlur,children:"Gaussian"},Nt.SmoothingMode.GaussianBlur)]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Smoothing Factor",children:Object(xm.jsx)(pO,{placeholder:"Smoothing Factor",min:1,max:33,value:this.smoothingFactor,majorStepSize:1,stepSize:1,onValueChange:e=>Object(m.t)((()=>{this.smoothingFactor=e}))})})]});return Object(xm.jsxs)(fL,{dialogProps:i,helpType:xM.CONTOUR,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:[Object(xm.jsxs)("div",{className:hS.a.DIALOG_BODY,children:[Object(xm.jsxs)(u.p,{inline:!0,label:"Data Source",children:[Object(xm.jsx)(Sz,{activeItem:n,onItemSelect:t.setContourDataSource,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:t.frames,itemRenderer:this.renderDataSourceSelectItem,disabled:t.animatorStore.animationActive,children:Object(xm.jsx)(u.e,{text:n.filename,rightIcon:"double-caret-vertical",alignText:"right",disabled:t.animatorStore.animationActive})}),Object(xm.jsx)(j.a,{content:t.frameLockedToContour?"Data source is locked to active image":"Data source is independent of active image",children:Object(xm.jsx)(u.b,{className:"lock-button",icon:t.frameLockedToContour?"lock":"unlock",minimal:!0,onClick:t.toggleFrameContourLock})})]}),Object(xm.jsxs)(u.R,{defaultSelectedTabId:xz.Levels,renderActiveTabPanelOnly:!1,children:[Object(xm.jsx)(u.Q,{id:xz.Levels,title:"Levels",panel:c,panelClassName:"contour-level-panel"}),Object(xm.jsx)(u.Q,{id:xz.Configuration,title:"Configuration",panel:d,panelClassName:"contour-config-panel"}),Object(xm.jsx)(u.Q,{id:xz.Styling,title:"Styling",panel:Object(xm.jsx)(W_,{frame:n,darkTheme:t.darkTheme})})]})]}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[Object(xm.jsx)(u.b,{intent:g.a.WARNING,onClick:this.handleClearContours,disabled:!n.contourConfig.enabled,text:"Clear"}),Object(xm.jsx)(u.b,{intent:g.a.SUCCESS,onClick:this.handleApplyContours,disabled:!a||!this.contourConfigChanged&&n.contourConfig.enabled,text:"Apply"}),Object(xm.jsx)(u.b,{intent:g.a.NONE,onClick:t.dialogStore.hideContourDialog,text:"Close"})]})}),Object(xm.jsx)(u.a,{className:t.darkTheme?"bp3-dark":"",icon:"time",isOpen:this.showCubeHistogramAlert,onCancel:this.handleAlertCancel,onConfirm:this.handleAlertConfirm,cancelButtonText:"Cancel",children:Object(xm.jsx)("p",{children:"Calculating a cube histogram may take a long time, depending on the size of the file. Are you sure you want to continue?"})}),Object(xm.jsx)(WN,{isOpen:n.renderConfig.useCubeHistogramContours&&n.renderConfig.cubeHistogramProgress<1,progress:n.renderConfig.cubeHistogramProgress,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleCubeHistogramCancelled,text:"Calculating cube histogram"})]})}},Oz.DefaultWidth=600,Oz.DefaultHeight=660,cz=jz,dz=Object(b.a)(cz.prototype,"showCubeHistogramAlert",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pz=Object(b.a)(cz.prototype,"currentTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return xz.Levels}}),hz=Object(b.a)(cz.prototype,"levels",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),uz=Object(b.a)(cz.prototype,"smoothingMode",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gz=Object(b.a)(cz.prototype,"smoothingFactor",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(cz.prototype,"setDefaultContourParameters",[m.g],Object.getOwnPropertyDescriptor(cz.prototype,"setDefaultContourParameters"),cz.prototype),Object(b.a)(cz.prototype,"contourConfigChanged",[m.i],Object.getOwnPropertyDescriptor(cz.prototype,"contourConfigChanged"),cz.prototype),Object(b.a)(cz.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(cz.prototype,"plotData"),cz.prototype),fz=Object(b.a)(cz.prototype,"handleLevelAdded",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{try{for(const t of e){const e=parseFloat(t);isFinite(e)&&this.levels.push(e)}}catch(t){console.log(t)}}}}),bz=Object(b.a)(cz.prototype,"handleLevelRemoved",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.levels=this.levels.filter(((e,i)=>i!==t))}}}),mz=Object(b.a)(cz.prototype,"handleLevelDragged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>t=>{e>=0&&e<this.levels.length&&(this.levels[e]=t)}}}),yz=Object(b.a)(cz.prototype,"handleLevelsGenerated",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.levels=e.slice()}}}),lz=cz))||lz;var Iz,wz,Tz,Rz,Az,Pz,Ez,Mz,Fz,kz,Dz,Lz,Nz,_z,zz,Vz,Wz,Gz,Bz,qz,Hz,Yz,Uz,Xz,$z,Kz,Qz;i(858);!function(e){e[e.Configuration=0]="Configuration",e[e.Styling=1]="Styling"}(Qz||(Qz={}));const Zz=A.a.ofType();let Jz=Object(p.a)((Kz=$z=class e extends n.Component{componentDidUpdate(){const e=gC.Instance;e.activeFrame!==this.cachedFrame&&(this.cachedFrame=e.activeFrame,this.setDefaultVectorOverlayParameters())}constructor(e){super(e),Object(f.a)(this,"currentTab",Tz,this),Object(f.a)(this,"angularSource",Rz,this),Object(f.a)(this,"intensitySource",Az,this),Object(f.a)(this,"pixelAveragingEnabled",Pz,this),Object(f.a)(this,"pixelAveraging",Ez,this),Object(f.a)(this,"thresholdEnabled",Mz,this),Object(f.a)(this,"threshold",Fz,this),Object(f.a)(this,"fractionalIntensity",kz,this),Object(f.a)(this,"debiasing",Dz,this),Object(f.a)(this,"qError",Lz,this),Object(f.a)(this,"uError",Nz,this),this.cachedFrame=void 0,Object(f.a)(this,"setDefaultVectorOverlayParameters",_z,this),this.renderDataSourceSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>e?Object(xm.jsx)(u.B,{text:e.filename,onClick:t},e.frameInfo.fileId):null,this.handleApplyOverlay=()=>{const e=gC.Instance.activeFrame;e&&(e.vectorOverlayConfig.setVectorOverlayConfiguration(this.angularSource,this.intensitySource,this.pixelAveragingEnabled,this.pixelAveraging,this.fractionalIntensity,this.thresholdEnabled,this.threshold,this.debiasing,this.qError,this.uError),e.applyVectorOverlay())},this.handleClearOverlay=()=>{var e;null===(e=gC.Instance.activeFrame)||void 0===e||e.clearVectorOverlay()},Object(f.a)(this,"handleAngularSourceChanged",zz,this),Object(f.a)(this,"handleIntensitySourceChanged",Vz,this),Object(f.a)(this,"handlePixelAveragingEnabledChanged",Wz,this),Object(f.a)(this,"handlePixelAveragingChanged",Gz,this),Object(f.a)(this,"handleThresholdEnabledChanged",Bz,this),Object(f.a)(this,"handleThresholdChanged",qz,this),Object(f.a)(this,"handleQErrorChanged",Hz,this),Object(f.a)(this,"handleUErrorChanged",Yz,this),Object(f.a)(this,"handleFractionalIntensityChanged",Uz,this),Object(f.a)(this,"handleDebiasingChanged",Xz,this),Object(m.p)(this),this.setDefaultVectorOverlayParameters()}get configChanged(){var e;const t=null===(e=gC.Instance.activeFrame)||void 0===e?void 0:e.vectorOverlayConfig;if(t){if(t.angularSource!==this.angularSource||t.intensitySource!==this.intensitySource||t.pixelAveragingEnabled!==this.pixelAveragingEnabled||t.pixelAveraging!==this.pixelAveraging||t.thresholdEnabled!==this.thresholdEnabled||t.debiasing!==this.debiasing||t.fractionalIntensity!==this.fractionalIntensity)return!0;if(t.debiasing&&(t.qError!==this.qError||t.uError!==this.uError))return!0;if(t.thresholdEnabled&&t.threshold!==this.threshold)return!0}return!1}renderIntensityParameters(){const e=gC.Instance.activeFrame;if(!e)return null;const t=e.vectorOverlayConfig,i=isFinite(t.intensityMin)?t.intensityMin:e.vectorOverlayStore.intensityMin,n=isFinite(t.intensityMax)?t.intensityMax:e.vectorOverlayStore.intensityMax;return Object(xm.jsx)(u.p,{label:"Intensity",labelInfo:t.fractionalIntensity?"(%)":e.headerUnit?`(${e.headerUnit})`:"",inline:!0,children:Object(xm.jsx)("div",{className:"parameter-container",children:Object(xm.jsxs)("div",{className:"parameter-line parameter-intensity",children:[Object(xm.jsx)(hy,{label:"Min",value:i,placeholder:"Automatic",onValueChanged:e=>t.setIntensityRange(e,t.intensityMax),onValueCleared:()=>t.setIntensityRange(void 0,t.intensityMax),displayExponential:!0}),Object(xm.jsx)(hy,{label:"Max",value:n,placeholder:"Automatic",onValueChanged:e=>t.setIntensityRange(t.intensityMin,e),onValueCleared:()=>t.setIntensityRange(t.intensityMin,void 0),displayExponential:!0})]})})})}renderLengthParameters(){const e=gC.Instance.activeFrame;if(!e)return null;const t=e.vectorOverlayConfig,i=e.vectorOverlayConfig.intensitySource===mt.None,n=e.vectorOverlayConfig.angularSource===mt.None;return Object(xm.jsx)(u.p,{label:n?"Block Width":"Line Length",labelInfo:"(px)",inline:!0,children:Object(xm.jsx)("div",{className:"parameter-container",children:Object(xm.jsxs)("div",{className:"parameter-line parameter-length",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Min",children:Object(xm.jsx)(pO,{min:0,max:t.lengthMax,disabled:i,value:t.lengthMin,onValueChange:e=>t.setLengthRange(e,t.lengthMax)})}),Object(xm.jsx)(u.p,{inline:!0,label:"Max",children:Object(xm.jsx)(pO,{min:t.lengthMin,value:t.lengthMax,onValueChange:e=>t.setLengthRange(t.lengthMin,e)})})]})})})}render(){const t=gC.Instance,i={icon:Object(xm.jsx)(jN,{icon:"vectorOverlay",size:jN.SIZE_LARGE}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.vectorOverlayDialogVisible,onClose:t.dialogStore.hideVectorOverlayDialog,className:"vector-overlay-dialog",canEscapeKeyClose:!0,title:"Vector Overlay Configuration"};if(!(null===t||void 0===t?void 0:t.activeFrame))return Object(xm.jsx)(fL,{dialogProps:i,helpType:xM.VECTOR_OVERLAY,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});const r=t.activeFrame,o=r.vectorOverlayConfig.angularSource===mt.None,s=r.vectorOverlayConfig.intensitySource===mt.None,a=Object(xm.jsxs)("div",{className:"vector-overlay-config-panel",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Angular Source",children:Object(xm.jsxs)(u.r,{value:this.angularSource,onChange:this.handleAngularSourceChanged,children:[Object(xm.jsx)("option",{value:mt.None,children:"None"}),Object(xm.jsx)("option",{value:mt.Current,children:"Current image"}),r.hasLinearStokes&&Object(xm.jsx)("option",{value:mt.Computed,children:"Computed PA"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Intensity Source",children:Object(xm.jsxs)(u.r,{value:this.intensitySource,onChange:this.handleIntensitySourceChanged,children:[Object(xm.jsx)("option",{value:mt.None,children:"None"}),Object(xm.jsx)("option",{value:mt.Current,children:"Current image"}),r.hasLinearStokes&&Object(xm.jsx)("option",{value:mt.Computed,children:"Computed PI"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Pixel Averaging",children:Object(xm.jsx)(u.P,{checked:this.pixelAveragingEnabled,onChange:this.handlePixelAveragingEnabledChanged})}),Object(xm.jsx)(u.p,{inline:!0,label:"Averaging Width",labelInfo:"(px)",disabled:!this.pixelAveragingEnabled,children:Object(xm.jsx)(pO,{placeholder:"Width (px)",min:2,max:64,value:this.pixelAveraging,majorStepSize:2,stepSize:2,onValueChange:this.handlePixelAveragingChanged,disabled:!this.pixelAveragingEnabled})}),Object(xm.jsx)(u.p,{inline:!0,label:"Polarization Intensity",disabled:this.intensitySource===mt.None,children:Object(xm.jsxs)(u.L,{inline:!0,onChange:this.handleFractionalIntensityChanged,selectedValue:this.fractionalIntensity?1:0,disabled:this.intensitySource===mt.None,children:[Object(xm.jsx)(u.K,{label:"Absolute",value:0}),Object(xm.jsx)(u.K,{label:"Fractional",value:1})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Threshold Enabled",children:Object(xm.jsx)(u.P,{checked:this.thresholdEnabled,onChange:this.handleThresholdEnabledChanged})}),Object(xm.jsx)(u.p,{disabled:!this.thresholdEnabled,inline:!0,label:"Threshold",labelInfo:r.headerUnit?`(${r.headerUnit})`:"",children:Object(xm.jsx)(pO,{disabled:!this.thresholdEnabled,placeholder:"Threshold",buttonPosition:"none",value:this.threshold,onValueChange:this.handleThresholdChanged})}),Object(xm.jsx)(u.p,{inline:!0,label:"Debiasing",children:Object(xm.jsx)(u.P,{checked:this.debiasing,onChange:this.handleDebiasingChanged})}),Object(xm.jsx)(u.p,{disabled:!this.debiasing,inline:!0,label:"Stokes Q Error",children:Object(xm.jsx)(pO,{disabled:!this.debiasing,buttonPosition:"none",placeholder:"Value",value:this.qError,onValueChange:this.handleQErrorChanged})}),Object(xm.jsx)(u.p,{disabled:!this.debiasing,inline:!0,label:"Stokes U Error",children:Object(xm.jsx)(pO,{disabled:!this.debiasing,buttonPosition:"none",placeholder:"Value",value:this.uError,onValueChange:this.handleUErrorChanged})})]}),l=Object(xm.jsxs)("div",{className:"vector-overlay-style-panel",children:[Object(xm.jsx)(u.p,{disabled:o,inline:!0,label:"Line Thickness",labelInfo:"(px)",children:Object(xm.jsx)(pO,{disabled:o,placeholder:"Thickness",min:.5,max:10,value:r.vectorOverlayConfig.thickness,majorStepSize:.5,stepSize:.5,onValueChange:r.vectorOverlayConfig.setThickness})}),!s&&this.renderIntensityParameters(),this.renderLengthParameters(),Object(xm.jsx)(hy,{label:"Rotation offset",labelInfo:"(deg)",value:r.vectorOverlayConfig.rotationOffset,onValueChanged:r.vectorOverlayConfig.setRotationOffset,onValueCleared:()=>r.vectorOverlayConfig.setRotationOffset(0)}),Object(xm.jsx)(u.p,{inline:!0,label:"Color Mode",children:Object(xm.jsxs)(u.r,{value:r.vectorOverlayConfig.colormapEnabled?1:0,onChange:e=>r.vectorOverlayConfig.setColormapEnabled(parseInt(e.currentTarget.value)>0),children:[Object(xm.jsx)("option",{value:0,children:"Constant Color"},0),Object(xm.jsx)("option",{value:1,children:"Color-mapped"},1)]})}),r.vectorOverlayConfig.colormapEnabled?Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,label:"Color Map",children:Object(xm.jsx)(vy,{inverted:!1,selectedItem:r.vectorOverlayConfig.colormap,onItemSelect:r.vectorOverlayConfig.setColormap})}),Object(xm.jsx)(u.p,{inline:!0,label:"Bias",children:Object(xm.jsx)(pO,{placeholder:"Bias",min:-1,max:1,value:r.vectorOverlayConfig.colormapBias,majorStepSize:.1,stepSize:.1,onValueChange:r.vectorOverlayConfig.setColormapBias})}),Object(xm.jsx)(u.p,{inline:!0,label:"Contrast",children:Object(xm.jsx)(pO,{placeholder:"Contrast",min:0,max:3,value:r.vectorOverlayConfig.colormapContrast,majorStepSize:.1,stepSize:.1,onValueChange:r.vectorOverlayConfig.setColormapContrast})})]}):Object(xm.jsx)(u.p,{inline:!0,label:"Color",children:Object(xm.jsx)(jy,{color:r.vectorOverlayConfig.color,presetColors:Gb,setColor:e=>r.vectorOverlayConfig.setColor(e.rgb),disableAlpha:!0,darkTheme:t.darkTheme})})]});return Object(xm.jsxs)(fL,{dialogProps:i,helpType:xM.VECTOR_OVERLAY,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:[Object(xm.jsxs)("div",{className:hS.a.DIALOG_BODY,children:[Object(xm.jsx)(u.p,{inline:!0,label:"Data Source",children:Object(xm.jsx)(Zz,{activeItem:r,onItemSelect:t.setActiveFrame,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:t.frames,itemRenderer:this.renderDataSourceSelectItem,disabled:t.animatorStore.animationActive,children:Object(xm.jsx)(u.e,{text:r.filename,rightIcon:"double-caret-vertical",alignText:"right",disabled:t.animatorStore.animationActive})})}),Object(xm.jsxs)(u.R,{defaultSelectedTabId:Qz.Configuration,renderActiveTabPanelOnly:!1,children:[Object(xm.jsx)(u.Q,{id:Qz.Configuration,title:"Configuration",panel:a,panelClassName:"vector-overlay-config-panel"}),Object(xm.jsx)(u.Q,{id:Qz.Styling,title:"Styling",panel:l,panelClassName:"vector-overlay-styling-panel"})]})]}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[Object(xm.jsx)(u.b,{intent:g.a.WARNING,onClick:this.handleClearOverlay,disabled:!r.vectorOverlayConfig.enabled,text:"Clear"}),Object(xm.jsx)(u.b,{intent:g.a.SUCCESS,onClick:this.handleApplyOverlay,disabled:this.angularSource===mt.None&&this.intensitySource===mt.None||!this.configChanged&&r.vectorOverlayConfig.enabled,text:"Apply"}),Object(xm.jsx)(u.b,{intent:g.a.NONE,onClick:t.dialogStore.hideVectorOverlayDialog,text:"Close"})]})})]})}},$z.DefaultWidth=500,$z.DefaultHeight=720,wz=Kz,Tz=Object(b.a)(wz.prototype,"currentTab",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Qz.Configuration}}),Rz=Object(b.a)(wz.prototype,"angularSource",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Az=Object(b.a)(wz.prototype,"intensitySource",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pz=Object(b.a)(wz.prototype,"pixelAveragingEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ez=Object(b.a)(wz.prototype,"pixelAveraging",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mz=Object(b.a)(wz.prototype,"thresholdEnabled",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fz=Object(b.a)(wz.prototype,"threshold",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kz=Object(b.a)(wz.prototype,"fractionalIntensity",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dz=Object(b.a)(wz.prototype,"debiasing",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lz=Object(b.a)(wz.prototype,"qError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nz=Object(b.a)(wz.prototype,"uError",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_z=Object(b.a)(wz.prototype,"setDefaultVectorOverlayParameters",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;const t=gC.Instance,i=null===(e=t.activeFrame)||void 0===e?void 0:e.vectorOverlayConfig,n=t.preferenceStore;i?(this.angularSource=i.angularSource,this.intensitySource=i.intensitySource,this.pixelAveragingEnabled=i.pixelAveragingEnabled,this.pixelAveraging=i.pixelAveraging,this.fractionalIntensity=i.fractionalIntensity,this.threshold=i.threshold,this.thresholdEnabled=i.thresholdEnabled,this.debiasing=i.debiasing):(this.angularSource=mt.Current,this.intensitySource=mt.Current,this.pixelAveraging=n.vectorOverlayPixelAveraging,this.pixelAveragingEnabled=n.vectorOverlayPixelAveraging>0,this.fractionalIntensity=n.vectorOverlayFractionalIntensity,this.thresholdEnabled=!1,this.threshold=0,this.debiasing=!1)}}}),Object(b.a)(wz.prototype,"configChanged",[m.i],Object.getOwnPropertyDescriptor(wz.prototype,"configChanged"),wz.prototype),zz=Object(b.a)(wz.prototype,"handleAngularSourceChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.angularSource=parseInt(e.currentTarget.value)}}}),Vz=Object(b.a)(wz.prototype,"handleIntensitySourceChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.intensitySource=parseInt(e.currentTarget.value)}}}),Wz=Object(b.a)(wz.prototype,"handlePixelAveragingEnabledChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.pixelAveragingEnabled=e.currentTarget.checked}}}),Gz=Object(b.a)(wz.prototype,"handlePixelAveragingChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.pixelAveraging=2*Math.floor(.5*e)}}}),Bz=Object(b.a)(wz.prototype,"handleThresholdEnabledChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.thresholdEnabled=e.currentTarget.checked}}}),qz=Object(b.a)(wz.prototype,"handleThresholdChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.threshold=e}}}),Hz=Object(b.a)(wz.prototype,"handleQErrorChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.qError=e}}}),Yz=Object(b.a)(wz.prototype,"handleUErrorChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.uError=e}}}),Uz=Object(b.a)(wz.prototype,"handleFractionalIntensityChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fractionalIntensity=1===parseInt(e.currentTarget.value)}}}),Xz=Object(b.a)(wz.prototype,"handleDebiasingChanged",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.debiasing=e.currentTarget.checked}}}),Iz=wz))||Iz;var eV,tV,iV,nV,rV,oV=i(266),sV=i(443),aV=i.n(sV);i(859);let lV=Object(p.a)((tV=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"handleInput",iV,this),Object(f.a)(this,"handleCategoriesAdded",nV,this),Object(f.a)(this,"handleCategoryRemoved",rV,this),this.handleKeyDown=e=>{var t;13===e.keyCode&&(null===(t=Nk.Instance.activeSnippetName)||void 0===t?void 0:t.length)&&this.saveSnippet()},this.saveSnippet=async()=>{const e=Nk.Instance;if(e.snippets.has(e.activeSnippetName)){if(!await Bx.Instance.showInteractiveAlert(`Are you sure to overwrite the existing snippet ${e.activeSnippetName}?`))return}this.props.onSaveClicked(e.activeSnippetName,e.activeSnippet.categories)},Object(m.p)(this)}get validInput(){var e,t;const i=Nk.Instance;return(null===(e=i.activeSnippetName)||void 0===e?void 0:e.length)>0&&(null===(t=i.activeSnippet)||void 0===t?void 0:t.categories)}render(){const e=gC.Instance,t=e.snippetStore,i=t.activeSnippet,n=d()("snippet-save-dialog",{"bp3-dark":e.darkTheme});return Object(xm.jsxs)(u.m,{icon:"console",backdropClassName:"minimal-dialog-backdrop",className:n,canOutsideClickClose:!1,isOpen:this.props.isOpen,onClose:this.props.onCancelClicked,canEscapeKeyClose:!0,portalClassName:"save-dialog-portal",title:"Save Code Snippet",children:[Object(xm.jsxs)("div",{className:hS.a.DIALOG_BODY,children:[Object(xm.jsx)(u.p,{inline:!0,label:"Name",className:"snippet-save-dialog-formgroup",children:Object(xm.jsx)(u.x,{className:"snippet-name-input",fill:!0,placeholder:"Enter snippet name",value:t.activeSnippetName,autoFocus:!0,onChange:this.handleInput,onKeyDown:this.handleKeyDown})}),Object(xm.jsx)(u.p,{inline:!0,label:"Categories",className:"snippet-save-dialog-formgroup",children:Object(xm.jsx)(u.T,{intent:g.a.PRIMARY,fill:!0,placeholder:"Enter categories as comma-separated list",addOnBlur:!0,tagProps:{minimal:!0},values:i.categories,onAdd:this.handleCategoriesAdded,onRemove:this.handleCategoryRemoved})})]}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,onClick:this.saveSnippet,text:"Save",disabled:!this.validInput}),Object(xm.jsx)(u.e,{intent:g.a.NONE,text:"Close",onClick:this.props.onCancelClicked})]})})]})}},iV=Object(b.a)(tV.prototype,"handleInput",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{Nk.Instance.activeSnippetName=e.currentTarget.value}}}),nV=Object(b.a)(tV.prototype,"handleCategoriesAdded",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){const t=Nk.Instance.activeSnippet.categories;for(const i of e)t.includes(i)||t.push(i)}}}}),rV=Object(b.a)(tV.prototype,"handleCategoryRemoved",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=Nk.Instance.activeSnippet;if(t>=0&&t<i.categories.length){const e=i.categories[t];i.categories=i.categories.filter((t=>t!==e))}}}}),Object(b.a)(tV.prototype,"validInput",[m.i],Object.getOwnPropertyDescriptor(tV.prototype,"validInput"),tV.prototype),eV=tV))||eV;const cV=n.lazy((()=>i.e(4).then(i.bind(null,1049)))),dV=n.lazy((()=>i.e(3).then(i.bind(null,1050)))),pV=e=>Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsxs)(n.Suspense,{fallback:Object(xm.jsx)(n.Fragment,{}),children:[!e.darkTheme&&Object(xm.jsx)(cV,{}),e.darkTheme&&Object(xm.jsx)(dV,{})]}),e.children]});var hV,uV,gV,fV,bV;i(860);let mV=Object(p.a)((uV=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"saveDialogOpen",gV,this),this.editorRef=void 0,Object(f.a)(this,"hideSaveDialog",fV,this),Object(f.a)(this,"showSaveDialog",bV,this),this.tryRefocusEditor=()=>{var e,t;const i=null===(e=this.editorRef)||void 0===e||null===(t=e._input)||void 0===t?void 0:t.focus;i&&"function"===typeof i&&this.editorRef._input.focus()},this.applyHighlight=e=>oV.highlight(e,oV.languages.js,"js").split("\n").map(((e,t)=>`<span class='editor-line-number'>${t+1}</span>${e}`)).join("\n"),this.handleSaveClicked=async(e,t)=>{var i;const n=Nk.Instance,r={code:null===(i=n.activeSnippet)||void 0===i?void 0:i.code,categories:t,snippetVersion:vn.SnippetVersion,frontendVersion:vn.FrontendVersion};await n.saveSnippet(e,r)&&this.hideSaveDialog(),n.setActiveSnippet(r,e)},this.handleExecuteClicked=async()=>{const e=Nk.Instance;if(e.validInput&&!e.isExecuting){await e.executeCurrentSnippet()||v.show(w("Error encountered while executing snippet. See JavaScript console for details."))}this.tryRefocusEditor()},this.handleDeleteClicked=async()=>{const e=gC.Instance;await e.alertStore.showInteractiveAlert("Are you sure you want to delete this snippet?")&&(await e.snippetStore.deleteSnippet(e.snippetStore.activeSnippetName),e.snippetStore.clearActiveSnippet())},this.handleNewClicked=async()=>{const e=gC.Instance;await e.alertStore.showInteractiveAlert("Are you sure you want to clear the current snippet?")&&e.snippetStore.clearActiveSnippet()},this.handleKeyDown=e=>{"keydown"===e.type&&13!==e.keyCode||(e.ctrlKey||e.metaKey)&&this.handleExecuteClicked()},Object(m.p)(this)}render(){var e;const t=gC.Instance,i=t.snippetStore,n={icon:"console",className:d()("code-snippet-dialog",{"bp3-dark":t.darkTheme}),canEscapeKeyClose:!this.saveDialogOpen,canOutsideClickClose:!1,isOpen:t.dialogStore.codeSnippetDialogVisible,onClose:t.dialogStore.hideCodeSnippetDialog,isCloseButtonShown:!0,title:"Edit code snippet"},r=Object(xm.jsx)(aV.a,{className:"language-js line-numbers",value:null===(e=i.activeSnippet)||void 0===e?void 0:e.code,onValueChange:i.setSnippetString,onKeyDown:this.handleKeyDown,highlight:this.applyHighlight,tabSize:4,autoFocus:!0,textareaId:"codeArea",style:{fontFamily:"'Fira code', 'Fira Mono', monospace",fontSize:12},placeholder:"Enter execution string",ref:e=>this.editorRef=e});return Object(xm.jsxs)(fL,{dialogProps:n,defaultWidth:700,defaultHeight:400,enableResizing:!0,children:[Object(xm.jsx)("div",{className:hS.a.DIALOG_BODY,children:Object(xm.jsx)(pV,{darkTheme:t.darkTheme,children:r})}),Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER,children:[Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:Object(xm.jsx)(u.b,{icon:"play",intent:g.a.SUCCESS,onClick:this.handleExecuteClicked,disabled:!i.validInput||i.isExecuting,text:"Execute"})}),Object(xm.jsx)("div",{className:"spacer"}),Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[Object(xm.jsx)(u.b,{icon:"add",intent:g.a.SUCCESS,onClick:this.handleNewClicked,disabled:i.isExecuting,text:"New"}),Object(xm.jsx)(u.b,{icon:"trash",intent:g.a.WARNING,onClick:this.handleDeleteClicked,disabled:i.isExecuting||!i.activeSnippetName,text:"Delete"}),Object(xm.jsx)(u.b,{icon:"floppy-disk",intent:g.a.PRIMARY,onClick:this.showSaveDialog,disabled:i.isExecuting,text:"Save"}),Object(xm.jsx)(u.b,{intent:g.a.NONE,onClick:t.dialogStore.hideCodeSnippetDialog,text:"Close"})]})]}),Object(xm.jsx)(lV,{onSaveClicked:this.handleSaveClicked,onCancelClicked:this.hideSaveDialog,isOpen:this.saveDialogOpen})]})}},gV=Object(b.a)(uV.prototype,"saveDialogOpen",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fV=Object(b.a)(uV.prototype,"hideSaveDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveDialogOpen=!1,this.tryRefocusEditor()}}}),bV=Object(b.a)(uV.prototype,"showSaveDialog",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveDialogOpen=!0}}}),hV=uV))||hV;var yV,OV,jV,xV,SV,vV,CV;i(861);let IV=Object(p.a)((OV=class extends n.Component{get fileNames(){let e=[];return this.stokes.forEach(((t,i)=>{e.push(i)})),e}get stokesDialogVisible(){return gC.Instance.dialogStore.stokesDialogVisible}get noneType(){let e=!0;return this.stokes.forEach((t=>{t.polarizationType===Nt.PolarizationType.POLARIZATION_TYPE_NONE&&(e=!1)})),e}constructor(e){super(e),Object(f.a)(this,"stokes",jV,this),Object(f.a)(this,"stokesHeader",xV,this),Object(f.a)(this,"updateStokesType",SV,this),Object(f.a)(this,"setStokes",vV,this),Object(f.a)(this,"setStokesHeader",CV,this),this.loadSelectedFiles=async()=>{let e=[];this.stokes.forEach((t=>{e.push(t)})),await this.loadFile(e).then((()=>{var t;return null===(t=gC.Instance.activeFrame)||void 0===t?void 0:t.setStokesFiles(e)})).catch((()=>{var e;null===(e=gC.Instance.activeFrame)||void 0===e||e.setStokesFiles([])}))},this.loadFile=async e=>{const t=gC.Instance,i=t.fileBrowserStore;if(i.browserMode!==DI.RegionExport){if(i.browserMode===DI.File){const n=t.frames;i.appendingFrame&&n.length?await t.appendConcatFile(e,i.fileList.directory,e[0].hdu):await t.openConcatFile(e,i.fileList.directory,e[0].hdu)}i.saveStartingDirectory()}},this.getLabelFromValue=e=>{var t;return e===Nt.PolarizationType.POLARIZATION_TYPE_NONE?"None":null!==(t=Jn.get(Nt.PolarizationType[e]))&&void 0!==t?t:String(e)},this.renderPopOver=(e,t)=>{const i=this.getLabelFromValue(e);return Object(xm.jsx)(u.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},`${e}: ${i}`)},this.getStokeType=(e,t)=>{let i=this.getTypeFromHeader(null===e||void 0===e?void 0:e.headerEntries);return i===Nt.PolarizationType.POLARIZATION_TYPE_NONE&&(i=this.getTypeFromName(t)),i},Object(m.p)(this),this.stokes=new Map,this.stokesHeader=new Map,Object(m.s)((()=>this.stokesDialogVisible),(e=>{if(e){const e=gC.Instance.fileBrowserStore;this.stokes=new Map,e.selectedFiles.forEach((t=>{gC.Instance.fileBrowserStore.getConcatFilesHeader(gC.Instance.fileBrowserStore.fileList.directory,t.fileInfo.name,t.hdu).then((i=>{const n=Object.keys(i.info)[0],r={directory:e.fileList.directory,file:t.fileInfo.name,hdu:t.hdu,polarizationType:this.getStokeType(i.info[n],i.file)};this.setStokes(t.fileInfo.name,r)})).catch((e=>{console.log(e)}))}))}}))}render(){var e;const t=gC.Instance,i=t.fileBrowserStore,n=d()("stokes-dialog",{"bp3-dark":t.darkTheme}),r=Object.values(Nt.PolarizationType),o=this.fileNames,s=Object(xm.jsx)(KO.a,{name:"File name",cellRenderer:(e,t)=>Object(xm.jsx)($O.a,{className:"header-table-cell",interactive:!0,children:this.fileNames[e]},`cell_${t}_${e}`)},"FileName"),a=Object(xm.jsx)(KO.a,{name:"Polarization",cellRenderer:e=>{const t=o[e];return Object(xm.jsx)($O.a,{className:"cell-dropdown-menu",interactive:!0,children:Object(xm.jsx)(A.a,{filterable:!1,items:r,activeItem:this.stokes.get(t).polarizationType,onItemSelect:e=>this.updateStokesType(t,e),itemRenderer:this.renderPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{className:"bp3-minimal catalog-represent-as-select-button",text:this.getLabelFromValue(this.stokes.get(t).polarizationType),rightIcon:"double-caret-vertical"})})},`cell_drop_down_${e}`)}},"Stokes"),l={icon:"git-merge",className:n,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.stokesDialogVisible,onClose:t.dialogStore.hideStokesDialog,title:"Merging polarization hypercube"};return Object(xm.jsxs)(fL,{dialogProps:l,helpType:xM.STOKES,minWidth:300,minHeight:250,defaultWidth:602,defaultHeight:300,enableResizing:!0,children:[Object(xm.jsx)("div",{className:"bp3-dialog-body",children:Object(xm.jsx)(QO.a,{className:"file-table",numRows:this.stokes.size,enableRowHeader:!1,enableRowReordering:!1,selectionModes:qn.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,columnWidths:[440,120],enableRowResizing:!1,children:[s,a]})}),Object(xm.jsx)("div",{className:"bp3-dialog-footer",children:Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(u.b,{intent:g.a.NONE,disabled:t.fileLoading||!i.selectedFile||!i.fileInfoResp||i.loadingInfo,onClick:null===(e=gC.Instance.dialogStore)||void 0===e?void 0:e.hideStokesDialog,text:"Cancel"}),Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:t.fileLoading||!i.selectedFile||!i.fileInfoResp||i.loadingInfo||!this.noneType,onClick:this.loadSelectedFiles,text:"Load"})]})})]})}getTypeFromHeader(e){let t=Nt.PolarizationType.POLARIZATION_TYPE_NONE;const i=null===e||void 0===e?void 0:e.find((e=>"STOKES"===e.value.toUpperCase()));if(i&&-1!==i.name.indexOf("CTYPE")){const r=i.name.substring(5),o=e.find((e=>-1!==e.name.indexOf(`CRPIX${r}`))),s=e.find((e=>-1!==e.name.indexOf(`CRVAL${r}`))),a=e.find((e=>-1!==e.name.indexOf(`CDELT${r}`))),l=Em(s)+(1-Em(o))*Em(a);if(l){const e=Kn.get(l);var n;if(e)t=null!==(n=Nt.PolarizationType[e])&&void 0!==n?n:Nt.PolarizationType.POLARIZATION_TYPE_NONE}}return t}getTypeFromName(e){let t=Nt.PolarizationType.POLARIZATION_TYPE_NONE;return[".","_"].forEach((i=>{e.split(i).forEach((e=>{const i=Nt.PolarizationType[e];i&&(t=i)}))})),t}},jV=Object(b.a)(OV.prototype,"stokes",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xV=Object(b.a)(OV.prototype,"stokesHeader",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SV=Object(b.a)(OV.prototype,"updateStokesType",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{let i=this.stokes.get(e);if(i.polarizationType!==t){this.stokes.forEach(((i,n)=>{n!==e&&i.polarizationType===t&&(this.stokes.get(n).polarizationType=Nt.PolarizationType.POLARIZATION_TYPE_NONE)}));const n={directory:i.directory,file:i.file,hdu:i.hdu,polarizationType:t};this.stokes.set(e,n)}}}}),vV=Object(b.a)(OV.prototype,"setStokes",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.stokes.set(e,t)}}}),CV=Object(b.a)(OV.prototype,"setStokesHeader",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.stokesHeader.set(e,t)}}}),Object(b.a)(OV.prototype,"fileNames",[m.i],Object.getOwnPropertyDescriptor(OV.prototype,"fileNames"),OV.prototype),Object(b.a)(OV.prototype,"stokesDialogVisible",[m.i],Object.getOwnPropertyDescriptor(OV.prototype,"stokesDialogVisible"),OV.prototype),Object(b.a)(OV.prototype,"noneType",[m.i],Object.getOwnPropertyDescriptor(OV.prototype,"noneType"),OV.prototype),yV=OV))||yV;var wV,TV,RV;i(862);let AV=Object(p.a)((TV=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"allowUsageStats",RV,this),this.optInClicked=async()=>{await Cj.Instance.optIn(this.allowUsageStats?Sj.Usage:Sj.Minimal)},this.optOutClicked=async()=>{await Cj.Instance.optOut()},Object(m.p)(this)}render(){var e;const t=gC.Instance,i=null===(e=t.apiService)||void 0===e?void 0:e.authenticated,n=t.telemetryService.consentRequired,r=d()("telemetry-dialog",{"bp3-dark":t.darkTheme});return Object(xm.jsx)(u.m,{icon:"data-connection",canOutsideClickClose:!1,isCloseButtonShown:!1,lazy:!0,isOpen:i&&n,className:r,canEscapeKeyClose:!1,title:"CARTA Usage Data",children:Object(xm.jsx)("div",{className:hS.a.DIALOG_BODY,children:Object(xm.jsxs)("div",{className:"image-div",children:[Object(xm.jsx)("img",{src:"carta_logo.png",width:80,alt:"carta logo"}),Object(xm.jsx)("div",{className:"consent-note",children:Object(xm.jsxs)("p",{children:["CARTA would like to collect anonymous usage data, in order to help the development team prioritize additional features and platforms. No personal or scientific information will be collected. Please see our"," ",Object(xm.jsx)("a",{rel:"noopener noreferrer",href:"https://cartavis.org/telemetry",target:"_blank",children:"data collection policy"})," ","for more details."]})}),Object(xm.jsxs)("div",{className:"button-grid",children:[Object(xm.jsx)(u.e,{intent:g.a.PRIMARY,onClick:this.optInClicked,children:"Yes, send usage data"}),Object(xm.jsx)(u.e,{intent:g.a.PRIMARY,onClick:this.optOutClicked,children:"No, do not send usage data"}),Object(xm.jsx)("div",{className:"opt-note",children:"Metrics include session duration, number and size of images opened."}),Object(xm.jsx)("div",{className:"opt-note",children:"Only an anonymous opt-out message will be submitted."})]})]})})})}},RV=Object(b.a)(TV.prototype,"allowUsageStats",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),wV=TV))||wV;var PV,EV,MV,FV,kV,DV,LV=i(1040);i(863);let NV=Object(p.a)((DV=kV=class e extends n.Component{constructor(e){super(e),Object(f.a)(this,"resultSize",MV,this),Object(f.a)(this,"objectSize",FV,this),this.query=async()=>{const e=hD.Instance;if(e.catalogDB===wx.SIMBAD){const t=e.convertToDeg(e.centerPixelCoordAsPoint2D,tA.ICRS),i=`SELECT Top ${e.maxObject} *, DISTANCE(POINT('ICRS', ${t.x},${t.y}), POINT('ICRS', ra, dec)) as dist FROM basic WHERE CONTAINS(POINT('ICRS',ra,dec),CIRCLE('ICRS',${t.x},${t.y},${e.radiusAsDeg}))=1 AND ra IS NOT NULL AND dec IS NOT NULL order by dist`;e.setQueryStatus(!0);const n=await Rx.Instance.appendSimbadCatalog(i);e.setQueryStatus(!1),this.setResultSize(n)}else if(e.catalogDB===wx.VIZIER){e.setQueryStatus(!0),e.resetVizier();const t=e.convertToDeg(e.centerPixelCoordAsPoint2D,tA.FK5),i=await Rx.Instance.queryVizierTableName(t,e.searchRadius,e.radiusUnits,e.vizierKeyWords);e.setQueryStatus(!1),e.setVizierQueryResult(i),this.setResultSize(i.size)}},this.loadVizierCatalogs=async()=>{const e=hD.Instance,t=e.selectedVizierSource,i=e.convertToDeg(e.centerPixelCoordAsPoint2D,tA.FK5);e.setQueryStatus(!0);const n=await Rx.Instance.queryVizierSource(i,e.searchRadius,e.radiusUnits,e.maxObject,t);Rx.Instance.appendVizierCatalog(n),e.setQueryStatus(!1)},this.handleObjectUpdate=()=>{const e=hD.Instance,t=`SELECT basic.* FROM ident JOIN basic ON ident.oidref = basic.oid WHERE id = '${e.objectName}'`;e.setObjectQueryStatus(!0),Rx.Instance.getSimbadCatalog(t).then((t=>{var i,n;e.setObjectQueryStatus(!1);const r=null===(i=t.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.length;if(this.setObjectSize(r),200===t.status&&r){var o,s;const i=this.getDataIndex("ra",null===(o=t.data)||void 0===o?void 0:o.metadata),n=this.getDataIndex("dec",null===(s=t.data)||void 0===s?void 0:s.metadata);if(i&&n&&r){var a,l;const r=e.convertToPixel({x:null===(a=t.data)||void 0===a?void 0:a.data[0][i],y:null===(l=t.data)||void 0===l?void 0:l.data[0][n]});e.updateCenterPixelCoord(r)}}})).catch((t=>{this.setObjectSize(0),e.setObjectQueryStatus(!1),console.log(`Object search error ${t}`)}))},this.getDataIndex=(e,t)=>{for(let i=0;i<t.length;i++){if(t[i].name===e)return i}},this.renderDBPopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick},e),this.renderUnitsPopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick},e),this.renderSysTypePopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick},e),this.vizierItemRenderer=(e,t)=>{const i=hD.Instance.vizierSelectedTableName.filter((t=>t.name===e.name)).length>0;return Object(xm.jsx)(u.B,{active:t.modifiers.active,icon:i?"tick":"blank",label:e.name,onClick:t.handleClick,text:`${t.index+1}. ${e.description}`,shouldDismissPopover:!1},e.name)},this.filterVizierTable=(e,t)=>{const i=new XL.a([t.name]),n=new XL.a([t.description]);return i.search(e).length>0||n.search(e).length>0},this.handleRadiusChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=hD.Instance;isFinite(t)&&t<=i.maxRadius&&t>=0?i.setSearchRadius(t):e.currentTarget.value=Gi(t,0,i.maxRadius).toString()},this.handleCenterWcsXChange=e=>{var t;if("keydown"===e.type&&13!==e.keyCode)return;const i=null!==(t=gC.Instance.activeFrame.spatialReference)&&void 0!==t?t:gC.Instance.activeFrame,n=hD.Instance,r=i.validWcs?i.wcsInfoForTransformation:0,o=km(r,n.centerPixelCoordAsPoint2D);if(!o)return;const s=e.currentTarget.value;if(s!==o.x){if(Pm(s,gC.Instance.overlayStore.numbers.formatTypeX)){const e=Dm(r,{x:s,y:o.y});if(e&&isFinite(e.x))return void n.updateCenterPixelCoord(e)}e.currentTarget.value=o.x}},this.handleCenterWcsYChange=e=>{var t;if("keydown"===e.type&&13!==e.keyCode)return;const i=null!==(t=gC.Instance.activeFrame.spatialReference)&&void 0!==t?t:gC.Instance.activeFrame,n=hD.Instance,r=i.validWcs?i.wcsInfoForTransformation:0,o=km(r,n.centerPixelCoordAsPoint2D);if(!o)return;const s=e.currentTarget.value;if(s!==o.y){if(Pm(s,gC.Instance.overlayStore.numbers.formatTypeY)){const e=Dm(r,{x:o.x,y:s});if(e&&isFinite(e.y))return void n.updateCenterPixelCoord(e)}e.currentTarget.value=o.y}},Object(m.p)(this),this.resultSize=void 0,this.objectSize=void 0}setResultSize(e){this.resultSize=e}setObjectSize(e){this.objectSize=e}get resultInfo(){const e=hD.Instance;return e.isQuerying?`Querying ${e.catalogDB}`:e.isObjectQuerying?`Querying ${wx.SIMBAD}`:0===this.resultSize?"No objects found":this.resultSize>=1?e.catalogDB===wx.VIZIER?`Found ${this.resultSize} table(s)`:`Found ${this.resultSize} object(s)`:0===this.objectSize?`Object ${e.objectName} not found`:this.objectSize>=1?`Updated Center Coordinates according ${e.objectName}`:void 0}render(){var t;const i=gC.Instance,n=hD.Instance;let r="catalog-query-dialog";i.darkTheme&&(r+=" bp3-dark");const o={icon:"geosearch",className:r,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:i.dialogStore.catalogQueryDialogVisible,onClose:i.dialogStore.hideCatalogQueryDialog,title:"Online Catalog Query"};if(!i||!i.activeFrame)return Object(xm.jsx)(fL,{dialogProps:o,helpType:xM.ONLINE_CATALOG_QUERY,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});const s=n.isQuerying||n.isObjectQuerying;let a,l=this.objectSize;n.disableObjectSearch&&(l=void 0),0===l?a=Object(xm.jsx)(u.w,{icon:"cross",intent:"warning",iconSize:30}):1===l&&(a=Object(xm.jsx)(u.w,{icon:"tick",intent:"success",iconSize:30}));const c=null!==(t=i.activeFrame.spatialReference)&&void 0!==t?t:i.activeFrame,d=gC.Instance.overlayStore.numbers.formatTypeX,p=gC.Instance.overlayStore.numbers.formatTypeY,h=c.validWcs?c.wcsInfoForTransformation:0,f=km(h,n.centerPixelCoordAsPoint2D),b=n.catalogDB===wx.VIZIER,m=Object(xm.jsxs)("div",{className:"online-catalog-config",children:[Object(xm.jsx)(u.p,{inline:!1,label:"Database",disabled:s,className:b?"vizier-databse":"",children:Object(xm.jsx)(A.a,{items:Object.values(wx),activeItem:null,onItemSelect:e=>n.setCatalogDB(e),itemRenderer:this.renderDBPopOver,disabled:s,popoverProps:{minimal:!0},filterable:!1,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:n.catalogDB,disabled:s,rightIcon:"double-caret-vertical"})})}),b?Object(xm.jsx)(u.p,{inline:!1,label:"Key Words (Catalog Title)",disabled:s,className:b?"vizier-key-words":"",children:Object(xm.jsx)(u.x,{asyncControl:!1,disabled:s,onChange:e=>n.setVizierKeyWords(e.target.value),value:n.vizierKeyWords})}):null,Object(xm.jsxs)(u.p,{inline:!1,label:"Object",disabled:s,children:[Object(xm.jsx)(u.x,{asyncControl:!1,disabled:s,rightElement:void 0===l?null:a,onChange:e=>this.updateObjectName(e.target.value),value:n.objectName}),Object(xm.jsx)(j.a,{content:"Reset center coordinates by object",disabled:s||n.disableObjectSearch,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(u.e,{disabled:s||n.disableObjectSearch,text:"Resolve",intent:g.a.NONE,onClick:this.handleObjectUpdate})})]}),Object(xm.jsxs)(u.p,{inline:!1,label:"Search Radius",disabled:s,children:[Object(xm.jsx)(j.a,{content:`0 - ${n.maxRadius} ${n.radiusUnits}`,disabled:s,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{asyncControl:!0,disabled:s,buttonPosition:"none",value:n.searchRadius,onValueChange:e=>n.setSearchRadius(e),onBlur:e=>this.handleRadiusChange(e),onKeyDown:e=>this.handleRadiusChange(e)})}),Object(xm.jsx)(A.a,{items:Object.values(pD),activeItem:null,onItemSelect:e=>n.setRadiusUnits(e),itemRenderer:this.renderUnitsPopOver,disabled:s,popoverProps:{minimal:!0},filterable:!1,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:n.radiusUnits,disabled:s,rightIcon:"double-caret-vertical"})}),Object(xm.jsx)(j.a,{content:"Reset Center Coordinates and Search Radius according current image viewer",disabled:s,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(u.e,{disabled:s,onClick:()=>n.resetSearchRadius(),children:"Set to viewer"})})]}),Object(xm.jsxs)(u.p,{inline:!1,label:"Center Coordinates",disabled:s,children:[Object(xm.jsx)(A.a,{items:Object.keys(tA).map((e=>tA[e])),activeItem:null,onItemSelect:e=>i.overlayStore.global.setSystem(e),itemRenderer:this.renderSysTypePopOver,disabled:s,popoverProps:{minimal:!0},filterable:!1,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:i.overlayStore.global.system,disabled:s,rightIcon:"double-caret-vertical"})}),Object(xm.jsx)(j.a,{content:`Format: ${nA.get(d)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!h||!f||s,value:f?f.x:"",onBlur:this.handleCenterWcsXChange,onKeyDown:this.handleCenterWcsXChange})}),Object(xm.jsx)(j.a,{content:`Format: ${nA.get(p)}`,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!h||!f||s,value:f?f.y:"",onBlur:this.handleCenterWcsYChange,onKeyDown:this.handleCenterWcsYChange})}),Object(xm.jsx)(j.a,{content:"Reset to current view center",disabled:s,position:y.a.BOTTOM,hoverOpenDelay:300,children:Object(xm.jsx)(u.e,{icon:"locate",disabled:s,onClick:()=>n.setFrameCenter()})})]}),Object(xm.jsx)(hy,{label:b?"Max Number of Objects Per Catalog":"Max Number of Objects",min:hD.MIN_OBJECTS,max:hD.MAX_OBJECTS,integerOnly:!0,value:n.maxObject,onValueChanged:e=>n.setMaxObjects(e),onValueCleared:()=>n.resetMaxObjects(),displayExponential:!1,disabled:s,inline:!1}),n.showVizierResult?Object(xm.jsx)(u.p,{inline:!1,label:"VizieR Catalog",disabled:s,children:Object(xm.jsx)(LV.a,{placeholder:"Please select catalog tables",fill:!0,popoverProps:{popoverClassName:"vizier-mulit-select",minimal:!0,position:u.H.TOP},items:n.vizierTable,itemRenderer:this.vizierItemRenderer,onItemSelect:e=>n.updateVizierSelectedTable(e),selectedItems:n.vizierSelectedTableName,tagRenderer:e=>e.name,itemPredicate:this.filterVizierTable,noResults:Object(xm.jsx)(u.B,{disabled:!0,text:"No results."}),tagInputProps:{onRemove:e=>n.removeVizierSelectedTable(e.toString()),rightElement:Object(xm.jsx)(u.e,{icon:"cross",minimal:!0,onClick:()=>n.resetVizierSelectedTable()}),tagProps:{minimal:!0}}})}):null]}),O=Object(xm.jsx)("pre",{children:this.resultInfo});return Object(xm.jsxs)(fL,{dialogProps:o,helpType:xM.ONLINE_CATALOG_QUERY,minWidth:e.DefaultWidth,minHeight:e.DefaultHeight,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:[Object(xm.jsx)("div",{className:"bp3-dialog-body",children:m}),Object(xm.jsx)(u.E,{autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:s,usePortal:!1,children:Object(xm.jsx)("div",{className:"query-loading-overlay",children:Object(xm.jsx)(u.O,{intent:g.a.PRIMARY,size:30,value:null})})}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer",children:[Object(xm.jsx)("div",{className:"result-info",children:O}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(u.b,{intent:g.a.SUCCESS,disabled:s,onClick:()=>this.query(),text:"Query"}),Object(xm.jsx)(u.b,{intent:g.a.WARNING,disabled:!n.isQuerying,onClick:()=>Rx.Instance.cancleQuery(n.catalogDB),text:"Cancel"}),n.enableLoadVizier?Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,disabled:s,onClick:()=>this.loadVizierCatalogs(),text:"Load selected"}):null]})]})]})}updateObjectName(e){this.initTextInfo(),hD.Instance.setObjectName(e)}initTextInfo(){this.setObjectSize(void 0),this.setResultSize(void 0)}},kV.DefaultWidth=550,kV.DefaultHeight=550,EV=DV,MV=Object(b.a)(EV.prototype,"resultSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),FV=Object(b.a)(EV.prototype,"objectSize",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(EV.prototype,"setResultSize",[m.g],Object.getOwnPropertyDescriptor(EV.prototype,"setResultSize"),EV.prototype),Object(b.a)(EV.prototype,"setObjectSize",[m.g],Object.getOwnPropertyDescriptor(EV.prototype,"setObjectSize"),EV.prototype),Object(b.a)(EV.prototype,"resultInfo",[m.i],Object.getOwnPropertyDescriptor(EV.prototype,"resultInfo"),EV.prototype),PV=EV))||PV;var _V,zV,VV,WV,GV;i(864);!function(e){e[e.RESULT=0]="RESULT",e[e.LOG=1]="LOG"}(GV||(GV={}));let BV=Object(p.a)((zV=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"fittingResultTabId",VV,this),Object(f.a)(this,"setFittingResultTabId",WV,this),this.renderParamInput=(e,t,i)=>Object(xm.jsx)(pO,{value:isFinite(e)?e:"",placeholder:t,onValueChange:i,buttonPosition:"none"}),Object(m.p)(this),this.fittingResultTabId=GV.RESULT}render(){var e,t,i,n,r,o,s,a,l,c;const p=gC.Instance,h=p.imageFittingStore;let f=h.components[h.selectedComponentIndex];const b={icon:Object(xm.jsx)(jN,{icon:"imageFitting",size:jN.SIZE_LARGE}),className:"fitting-dialog",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:p.dialogStore.fittingDialogVisible,onClose:p.dialogStore.hideFittingDialog,title:"Image Fitting"};if(!p||p.frameNum<=0||!h.effectiveFrame)return Object(xm.jsx)(fL,{dialogProps:b,helpType:xM.PLACEHOLDER,minWidth:200,minHeight:140,defaultWidth:600,defaultHeight:660,enableResizing:!0,children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});const m=Object(xm.jsx)(u.I,{className:"fitting-result-pre",children:Object(xm.jsx)(u.U,{className:"fitting-result-text",children:null!==(e=null===(t=h.effectiveFrame)||void 0===t?void 0:t.fittingResult)&&void 0!==e?e:""})}),O=Object(xm.jsx)(u.I,{className:"fitting-result-pre",children:Object(xm.jsx)(u.U,{className:"log-text",children:null!==(i=null===(n=h.effectiveFrame)||void 0===n?void 0:n.fittingLog)&&void 0!==i?i:""})});return Object(xm.jsxs)(fL,{dialogProps:b,helpType:xM.PLACEHOLDER,minWidth:200,minHeight:140,defaultWidth:600,defaultHeight:660,enableResizing:!0,children:[Object(xm.jsxs)("div",{className:hS.a.DIALOG_BODY,children:[Object(xm.jsx)(u.p,{label:"Data Source",inline:!0,children:Object(xm.jsx)(u.r,{value:h.selectedFileId,options:h.frameOptions,onChange:e=>h.setSelectedFileId(parseInt(e.target.value))})}),Object(xm.jsxs)(u.p,{label:"Components",inline:!0,children:[Object(xm.jsx)(pO,{className:"components-input",value:h.components.length,min:1,max:20,stepSize:1,onValueChange:e=>h.setComponents(Math.round(e))}),h.components.length>1&&Object(xm.jsxs)(xm.Fragment,{children:[Object(xm.jsx)(u.N,{value:h.selectedComponentIndex+1,min:1,stepSize:1,max:h.components.length,showTrackFill:!1,onChange:e=>h.setSelectedComponentIndex(e-1),disabled:h.components.length<=1}),Object(xm.jsx)(j.a,{content:"Delete current component.",children:Object(xm.jsx)(u.b,{icon:"trash",onClick:h.deleteSelectedComponent})})]})]}),Object(xm.jsxs)(u.p,{label:"Center",inline:!0,labelInfo:"(px)",children:[this.renderParamInput(null===f||void 0===f||null===(r=f.center)||void 0===r?void 0:r.x,"Center X",null===f||void 0===f?void 0:f.setCenterX),this.renderParamInput(null===f||void 0===f||null===(o=f.center)||void 0===o?void 0:o.y,"Center Y",null===f||void 0===f?void 0:f.setCenterY)]}),Object(xm.jsx)(u.p,{label:"Amplitude",inline:!0,labelInfo:(null===(s=h.effectiveFrame)||void 0===s?void 0:s.requiredUnit)?`(${null===(a=h.effectiveFrame)||void 0===a?void 0:a.requiredUnit})`:"",children:this.renderParamInput(null===f||void 0===f?void 0:f.amplitude,"Amplitude",null===f||void 0===f?void 0:f.setAmplitude)}),Object(xm.jsxs)(u.p,{label:"FWHM",inline:!0,labelInfo:"(px)",children:[this.renderParamInput(null===f||void 0===f||null===(l=f.fwhm)||void 0===l?void 0:l.x,"Major Axis",null===f||void 0===f?void 0:f.setFwhmX),this.renderParamInput(null===f||void 0===f||null===(c=f.fwhm)||void 0===c?void 0:c.y,"Minor Axis",null===f||void 0===f?void 0:f.setFwhmY)]}),Object(xm.jsx)(u.p,{label:"P.A.",inline:!0,labelInfo:"(deg)",children:this.renderParamInput(null===f||void 0===f?void 0:f.pa,"Position Angle",null===f||void 0===f?void 0:f.setPa)})]}),Object(xm.jsx)("div",{className:hS.a.DIALOG_FOOTER,children:Object(xm.jsxs)("div",{className:hS.a.DIALOG_FOOTER_ACTIONS,children:[Object(xm.jsx)(j.a,{content:"Clear fitting parameters.",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{intent:g.a.WARNING,onClick:h.clearComponents,text:"Clear"})}),Object(xm.jsx)(j.a,{content:"Clear existing fitting results and fit the current channel of the image.",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,onClick:h.fitImage,text:"Fit",disabled:h.fitDisabled})})]})}),Object(xm.jsx)("div",{className:d()(hS.a.DIALOG_BODY,"fitting-result"),children:Object(xm.jsxs)(u.R,{id:"fittingResultTabs",vertical:!0,selectedTabId:this.fittingResultTabId,onChange:this.setFittingResultTabId,children:[Object(xm.jsx)(u.Q,{id:GV.RESULT,title:"Fitting Result",panel:m}),Object(xm.jsx)(u.Q,{id:GV.LOG,title:"Full Log",panel:O})]})}),Object(xm.jsx)(u.m,{className:d()(hS.a.ALERT,{"bp3-dark":p.darkTheme}),isOpen:h.isFitting,children:Object(xm.jsxs)("div",{className:hS.a.ALERT_BODY,children:[Object(xm.jsx)(u.w,{icon:"time",iconSize:40}),Object(xm.jsxs)("div",{className:hS.a.ALERT_CONTENTS,children:[Object(xm.jsx)("p",{children:"Image fitting processing ..."}),Object(xm.jsx)("p",{children:"Calculation may take a long time, depending on the size of the file and the number of Gaussian components."})]})]})})]})}},VV=Object(b.a)(zV.prototype,"fittingResultTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WV=Object(b.a)(zV.prototype,"setFittingResultTabId",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fittingResultTabId=e}}}),_V=zV))||_V;var qV,HV,YV,UV,XV,$V,KV;i(865);let QV;!function(e){e[e.PV_IMAGE=0]="PV_IMAGE",e[e.PREVIEW_CUBE=1]="PREVIEW_CUBE"}(QV||(QV={}));let ZV=Object(p.a)((HV=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"pv-generator",type:"pv-generator",minWidth:350,minHeight:200,defaultWidth:500,defaultHeight:300,title:"PV Generator",isCloseable:!0,helpType:xM.PV_GENERATOR}}get widgetStore(){const e=WP.Instance;if(e.pvGeneratorWidgets){const t=e.pvGeneratorWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Bh}get isLineIntersectedWithImage(){if(this.widgetStore.effectiveRegion){const e=this.widgetStore.effectiveRegion.controlPoints[0],t=this.widgetStore.effectiveRegion.controlPoints[1],i=this.widgetStore.effectiveFrame.frameInfo.fileInfoExtended.width,n=this.widgetStore.effectiveFrame.frameInfo.fileInfoExtended.height,r=[{x:-.5,y:-.5},{x:i-.5,y:-.5},{x:-.5,y:n-.5},{x:i-.5,y:n-.5}];let o=0;for(let s of r)o+=Math.sign((t.x-e.x)*(s.y-e.y)-(t.y-e.y)*(s.x-e.x));if(o<=2&&o>=-2)return!(e.x<-.5&&t.x<-.5||e.y<-.5&&t.y<-.5||e.x>i-.5&&t.x>i-.5||e.y>n-.5&&t.y>n-.5)}return!1}get isLineInOnePixel(){if(this.widgetStore.effectiveRegion){const e=this.widgetStore.effectiveRegion.controlPoints[0],t=this.widgetStore.effectiveRegion.controlPoints[1];if(Math.round(e.x)===Math.round(t.x)&&Math.round(e.y)===Math.round(t.y))return!0}return!1}constructor(t){super(t),Object(f.a)(this,"selectedTabId",YV,this),Object(f.a)(this,"setSelectedTab",UV,this),Object(f.a)(this,"width",XV,this),Object(f.a)(this,"height",$V,this),Object(f.a)(this,"onResize",KV,this),this.handleFrameChanged=e=>{if(this.widgetStore.effectiveFrame){const t=parseInt(e.target.value);this.widgetStore.setFileId(t),this.widgetStore.setRegionId(this.widgetStore.effectiveFrame.frameInfo.fileId,Br.ACTIVE)}},this.handleRegionChanged=e=>{if(this.widgetStore.effectiveFrame){const t=this.widgetStore.effectiveFrame.frameInfo.fileId;this.widgetStore.setFileId(t),this.widgetStore.setRegionId(t,parseInt(e.target.value))}},this.onGenerateButtonClicked=()=>{const e=this.widgetStore.effectiveFrame.frameInfo.fileId;this.widgetStore.setFileId(e),this.widgetStore.setRegionId(e,this.widgetStore.effectiveRegionId),this.widgetStore.requestPV()},Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.pvGeneratorWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.pvGeneratorWidgets.set(this.props.id,new Bh));else{const e=i.widgetsStore.addPvGeneratorWidget();i.widgetsStore.changeWidgetId(t.id,e)}}render(){var e;const t=gC.Instance,i=this.widgetStore.effectiveFrame,n=i?`${t.getFrameIndex(i.frameInfo.fileId)}: ${i.filename}`:void 0,r=this.widgetStore.effectiveRegionInfo;let o=Br.ACTIVE;(null===(e=this.widgetStore.effectiveFrame)||void 0===e?void 0:e.regionSet)&&(o=this.widgetStore.regionIdMap.get(this.widgetStore.effectiveFrame.frameInfo.fileId));const s=this.widgetStore.effectiveRegion&&!t.animatorStore.animationActive&&this.isLineIntersectedWithImage&&!this.isLineInOnePixel,a=Object(xm.jsx)("span",{children:Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Please ensure:",Object(xm.jsx)("br",{}),"1. Animation playback is stopped.",Object(xm.jsx)("br",{}),"2. Line region is selected.",Object(xm.jsx)("br",{}),"3. Line region has intersection with image.",Object(xm.jsx)("br",{}),"4. Line region is not in one pixel."]})})}),l=Object(xm.jsxs)("div",{className:"pv-image-panel",children:[Object(xm.jsx)(u.p,{className:"label-info-group",inline:!0,label:"Image",labelInfo:Object(xm.jsx)("span",{className:"label-info",title:n,children:n?`(${n})`:""}),children:Object(xm.jsx)(u.r,{value:this.widgetStore.fileId,options:this.widgetStore.frameOptions,onChange:this.handleFrameChanged})}),Object(xm.jsx)(u.p,{className:"label-info-group",inline:!0,label:"Region",labelInfo:Object(xm.jsx)("span",{className:"label-info",title:r,children:r?`(${r})`:""}),children:Object(xm.jsx)(u.r,{value:o,options:this.widgetStore.regionOptions,onChange:this.handleRegionChanged})}),Object(xm.jsx)(u.p,{inline:!0,label:"Average Width (px)",children:Object(xm.jsx)(pO,{min:1,max:10,stepSize:1,value:this.widgetStore.width,onValueChange:e=>this.widgetStore.setWidth(e)})}),Object(xm.jsx)("div",{className:"generate-button",children:Object(xm.jsx)(j.a,{disabled:s,content:a,position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{intent:"success",disabled:!s,text:"Generate",onClick:this.onGenerateButtonClicked})})})]});return Object(xm.jsxs)("div",{className:"pv-generator-widget",children:[Object(xm.jsx)("div",{className:"pv-generator-panel",children:Object(xm.jsx)(u.R,{id:"pvGeneratorTabs",selectedTabId:this.selectedTabId,onChange:this.setSelectedTab,animate:!1,children:Object(xm.jsx)(u.Q,{id:QV.PV_IMAGE,title:"Generate PV image",panel:l})})}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33}),Object(xm.jsx)(WN,{isOpen:(null===i||void 0===i?void 0:i.isRequestingPV)&&i.requestingPVProgress<1,progress:i?i.requestingPVProgress:0,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.widgetStore.requestingPVCancelled,text:"Generating PV",isCancelling:null===i||void 0===i?void 0:i.isRequestPVCancelling})]})}},YV=Object(b.a)(HV.prototype,"selectedTabId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return QV.PV_IMAGE}}),UV=Object(b.a)(HV.prototype,"setSelectedTab",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTabId=e}}}),XV=Object(b.a)(HV.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$V=Object(b.a)(HV.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(HV.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(HV.prototype,"widgetStore"),HV.prototype),Object(b.a)(HV.prototype,"isLineIntersectedWithImage",[m.i],Object.getOwnPropertyDescriptor(HV.prototype,"isLineIntersectedWithImage"),HV.prototype),Object(b.a)(HV.prototype,"isLineInOnePixel",[m.i],Object.getOwnPropertyDescriptor(HV.prototype,"isLineInOnePixel"),HV.prototype),KV=Object(b.a)(HV.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),qV=HV))||qV;var JV;let eW=Object(p.a)(JV=class extends n.Component{constructor(...e){super(...e),this.floatingSettingType="floating-settings",this.onFloatingWidgetSelected=e=>{WP.Instance.updateSelectFloatingWidgetzIndex(e.id)},this.onFloatingWidgetClosed=e=>{var t;const i=WP.Instance;switch(e.type){case oH.WIDGET_CONFIG.type:i.removeFloatingWidgetComponent(e.componentId),hM.Instance.catalogProfiles.delete(e.componentId);break;case ZU.WIDGET_CONFIG.type:i.removeFloatingWidgetComponent(e.componentId),hM.Instance.clearCatalogPlotsByComponentId(e.componentId);break;case uX.WIDGET_CONFIG.type:null===(t=i.layerListWidgets.get(e.parentId))||void 0===t||t.resetSelectedFrameIndex(),i.removeFloatingWidget(e.id);break;default:i.removeFloatingWidget(e.id)}}}getWidgetContent(e){switch(e.type){case VG.WIDGET_CONFIG.type:return Object(xm.jsx)(VG,{id:e.id,docked:!1});case QG.WIDGET_CONFIG.type:return Object(xm.jsx)(QG,{id:e.id,docked:!1});case BG.WIDGET_CONFIG.type:return Object(xm.jsx)(BG,{id:e.id,docked:!1});case SB.WIDGET_CONFIG.type:return Object(xm.jsx)(SB,{id:e.id,docked:!1});case UD.WIDGET_CONFIG.type:return Object(xm.jsx)(UD,{id:e.id,docked:!1});case qB.WIDGET_CONFIG.type:return Object(xm.jsx)(qB,{id:e.id,docked:!1});case bq.WIDGET_CONFIG.type:return Object(xm.jsx)(bq,{id:e.id,docked:!1});case nq.WIDGET_CONFIG.type:return Object(xm.jsx)(nq,{id:e.id,docked:!1});case Tq.WIDGET_CONFIG.type:return Object(xm.jsx)(Tq,{id:e.id,docked:!1});case Dq.WIDGET_CONFIG.type:return Object(xm.jsx)(Dq,{id:e.id,docked:!1});case kB.WIDGET_CONFIG.type:return Object(xm.jsx)(kB,{id:e.id,docked:!1});case Hq.WIDGET_CONFIG.type:return Object(xm.jsx)(Hq,{id:e.id,docked:!1});case JD.WIDGET_CONFIG.type:return Object(xm.jsx)(JD,{id:e.id,docked:!1});case oH.WIDGET_CONFIG.type:return Object(xm.jsx)(oH,{id:e.componentId,docked:!1});case ZU.WIDGET_CONFIG.type:return Object(xm.jsx)(ZU,{id:e.id,docked:!1});case ZV.WIDGET_CONFIG.type:return Object(xm.jsx)(ZV,{id:e.id,docked:!1});default:return Object(xm.jsx)(oB,{id:e.id,docked:!1,label:e.title})}}getWidgetSettings(e){if(e.parentId)switch(e.parentType){case VG.WIDGET_CONFIG.type:return Object(xm.jsx)(hL,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Hq.WIDGET_CONFIG.type:return Object(xm.jsx)(cH,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case bq.WIDGET_CONFIG.type:return Object(xm.jsx)(bH,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case qB.WIDGET_CONFIG.type:return Object(xm.jsx)(jH,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case SB.WIDGET_CONFIG.type:return Object(xm.jsx)(vH,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Dq.WIDGET_CONFIG.type:return Object(xm.jsx)(wH,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case oH.WIDGET_CONFIG.type:return Object(xm.jsx)(cX,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case QG.WIDGET_CONFIG.type:return Object(xm.jsx)(uX,{id:e.parentId,docked:!1,floatingSettingsId:e.id});default:return null}return null}showPin(e){return!e.type||e.type!==this.floatingSettingType}showFloatingSettingsButton(e){switch(e.type){case Hq.WIDGET_CONFIG.type:case bq.WIDGET_CONFIG.type:case qB.WIDGET_CONFIG.type:case SB.WIDGET_CONFIG.type:case Dq.WIDGET_CONFIG.type:case oH.WIDGET_CONFIG.type:case QG.WIDGET_CONFIG.type:return!0;default:return!1}}render(){const e=WP.Instance.floatingWidgets;return Object(xm.jsx)("div",{children:e.map((t=>{const i=this.showPin(t),n=t.componentId?t.componentId:t.id;return Object(xm.jsx)("div",{children:Object(xm.jsx)(iL,{isSelected:t.zIndex===e.length,widgetConfig:t,zIndex:t.zIndex,showPinButton:i,onSelected:()=>this.onFloatingWidgetSelected(t),onClosed:()=>this.onFloatingWidgetClosed(t),showFloatingSettingsButton:this.showFloatingSettingsButton(t),floatingWidgets:e.length,children:i?this.getWidgetContent(t):this.getWidgetSettings(t)},n)},n)}))})}})||JV;var tW;i(392),i(866);let iW=Object(p.a)(tW=class extends n.Component{constructor(...e){super(...e),this.canvas=void 0,this.renderCanvas=()=>{const e=this.props.overlaySettings,t=this.props.frame,i=devicePixelRatio*gC.Instance.imageRatio,n=t.spatialReference?t.transformedWcsInfo:t.wcsInfo,r=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView;if(n&&r&&this.canvas){var o;const s=Pt.copy(n);if(!s)return void console.log("Create wcs info copy failed.");if(this.updateImageDimensions(),Pt.setCanvas(this.canvas),!t.hasSquarePixels){const e=Pt.scaleMap2D(1,1/t.aspectRatio),i=Pt.frame(2,"Domain=PIXEL");Pt.addFrame(s,1,e,i),Pt.setI(s,"Base",3),Pt.setI(s,"Current",2)}const a=n=>{Pt.plot(s,r.xMin,r.xMax,r.yMin/t.aspectRatio,r.yMax/t.aspectRatio,e.viewWidth*i,e.viewHeight*i,e.padding.left*i,e.padding.right*i,e.padding.top*i,e.padding.bottom*i,n,t.distanceMeasuring.showCurve,t.isPVImage,t.distanceMeasuring.transformedStart.x,t.distanceMeasuring.transformedStart.y,t.distanceMeasuring.transformedFinish.x,t.distanceMeasuring.transformedFinish.y)};let l=e.styleString;if(t.moving){l+=`, Tol=${Math.max(2*e.global.tolerance/100,.1)}`}this.props.frame.validWcs||(l=l.replace(/System=.*?,/,"").replaceAll(/Format\(\d\)=.*?,/g,"")),e.title.customText&&(null===(o=t.titleCustomText)||void 0===o?void 0:o.length)&&(l+=`, Title=${t.titleCustomText}`),a(l),/No grid curves can be drawn for axis/.test(Pt.getLastErrorMessage())&&a(l.replace(/Gap\(\d\)=[^,]+, ?/g,"").replace("Grid=1","Grid=0")),Pt.deleteObject(s),Pt.clearLastErrorMessage()}},this.throttledRenderCanvas=T.throttle(this.renderCanvas,50),this.getRef=e=>{this.canvas=e}}componentDidMount(){this.canvas&&(JA.Instance.limitOverlayRedraw?this.throttledRenderCanvas():requestAnimationFrame(this.renderCanvas))}componentDidUpdate(){gC.Instance.resetImageRatio(),JA.Instance.limitOverlayRedraw?this.throttledRenderCanvas():requestAnimationFrame(this.renderCanvas)}updateImageDimensions(){this.canvas&&(this.canvas.width=this.props.overlaySettings.viewWidth*devicePixelRatio*gC.Instance.imageRatio,this.canvas.height=this.props.overlaySettings.viewHeight*devicePixelRatio*gC.Instance.imageRatio)}render(){var e,t;const i=this.props.overlaySettings.styleString,n=this.props.frame,r=null!==(e=n.spatialReference)&&void 0!==e?e:n,o=this.props.overlaySettings.viewWidth,s=this.props.overlaySettings.viewHeight;r.requiredFrameView,this.props.overlaySettings.padding,n.moving,this.props.overlaySettings.global.system,this.props.overlaySettings.global.color,this.props.overlaySettings.title.color,this.props.overlaySettings.grid.color,this.props.overlaySettings.border.color,this.props.overlaySettings.ticks.color,this.props.overlaySettings.axes.color,this.props.overlaySettings.numbers.color,this.props.overlaySettings.labels.color,gC.Instance.darkTheme,n.distanceMeasuring.showCurve,n.distanceMeasuring.transformedStart,n.distanceMeasuring.transformedFinish,n.titleCustomText,gC.Instance.imageRatio;n.isPVImage&&(null===(t=n.spectralAxis)||void 0===t?void 0:t.valid)&&Pt.set(n.wcsInfo,(n.spectralType?`System(2)=${n.spectralType},`:"")+(n.spectralUnit?`Unit(2)=${n.spectralUnit},`:"")+(n.spectralSystem?`StdOfRest=${n.spectralSystem},`:"")+(n.restFreqStore.restFreqInHz?`RestFreq=${n.restFreqStore.restFreqInHz} Hz,`:"")+(n.spectralType&&n.spectralSystem?`Label(2)=[${n.spectralSystem}] ${$t.get(n.spectralType)},`:""));const a=d()("overlay-canvas",{docked:this.props.docked});return Object(xm.jsx)("canvas",{className:a,style:{width:o,height:s},id:"overlay-canvas",ref:this.getRef},i)}})||tW;var nW;i(867);let rW=Object(p.a)(nW=class extends n.Component{render(){var e,t;const i=this.props.cursorInfo;let n=[];if(i.infoWCS&&n.push(`WCS:\xa0(${i.infoWCS.x},\xa0${i.infoWCS.y})`),(null===(e=i.posImageSpace)||void 0===e?void 0:e.x)===-Number.MAX_VALUE&&(null===(t=i.posImageSpace)||void 0===t?void 0:t.y)===-Number.MAX_VALUE||n.push(`Image:\xa0(${fi(i.posImageSpace.x)},\xa0${fi(i.posImageSpace.y)})`),void 0!==this.props.cursorValue){let e=`Value:\xa0${this.props.cursorValueToPercentage?fi(this.props.cursorValue,1)+" %":mi(this.props.cursorValue,5,this.props.unit,!0,!0)}`;isNaN(this.props.cursorValue)&&(e="NaN"),this.props.isValueCurrent?e+=" ":e+="*",n.push(e)}this.props.spectralInfo.spectralString&&(n.push(this.props.spectralInfo.spectralString.replace(/\s/g,"\xa0")),this.props.spectralInfo.freqString&&n.push(this.props.spectralInfo.freqString.replace(/\s/g,"\xa0")),this.props.spectralInfo.velocityString&&n.push(this.props.spectralInfo.velocityString.replace(/\s/g,"\xa0"))),this.props.currentStokes&&n.push(`Polarization:\xa0${this.props.currentStokes}`);let r={lineHeight:(void 0!==this.props.height&&this.props.height>=0?this.props.height:20)+"px"};(this.props.left>0||this.props.right>0)&&(r.width=this.props.width-this.props.left-this.props.right),void 0!==this.props.top?r.top=this.props.top:void 0!==this.props.bottom&&(r.bottom=this.props.bottom),void 0!==this.props.left&&(r.left=this.props.left);const o=d()("cursor-overlay-div",{docked:this.props.docked});return Object(xm.jsx)("div",{className:o,style:r,children:n.length?n.join("; "):"\xa0"})}})||nW;var oW,sW,aW,lW,cW,dW,pW,hW,uW,gW,fW,bW;i(868);let mW=Object(p.a)((bW=fW=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"hoverInfoText",aW,this),Object(f.a)(this,"isHovering",lW,this),Object(f.a)(this,"cursorY",cW,this),this.mouseEnterHandle=void 0,this.layerRef=n.createRef(),this.astFonts=Pt.fonts.map(((e,t)=>new lL(e,t))),Object(f.a)(this,"setHoverInfoText",dW,this),Object(f.a)(this,"setMouseHovering",pW,this),Object(f.a)(this,"onMouseEnter",hW,this),Object(f.a)(this,"onMouseLeave",uW,this),Object(f.a)(this,"setCursorY",gW,this),this.handleMouseMove=e=>{var t,i,n;const r=gC.Instance,o=null===(t=this.props.frame)||void 0===t?void 0:t.renderConfig,s=null===r||void 0===r||null===(i=r.overlayStore)||void 0===i?void 0:i.colorbar;if(!o||!s)return;const a=e.target.getStage();let l="right"===s.position?a.getPointerPosition().y:a.getPointerPosition().x,c=l-s.yOffset;"right"===s.position&&(c=s.height-c),c/=s.height,c=Gi(c,0,1),l=Gi(l,s.yOffset,s.yOffset+s.height),l=Math.floor(l)+.5;const d=o.scaleMinVal+c*(o.scaleMaxVal-o.scaleMinVal);this.setHoverInfoText("%"===(null===(n=this.props.frame)||void 0===n?void 0:n.requiredUnit)?d.toFixed(1):d.toExponential(5)),s.interactive&&this.isHovering?this.props.onCursorHoverValueChanged(d):this.props.onCursorHoverValueChanged(NaN),this.setCursorY(l)},Object(m.p)(this)}componentDidUpdate(){gC.Instance.resetImageRatio()}render(){const e=gC.Instance,t=this.props.frame,i=e.overlayStore.colorbar;e.updateLayerPixelRatio(this.layerRef);let r=(t,n)=>t?Jb(n):i.customColor?Jb(i.color):Jb(e.overlayStore.global.color);const o=i.borderWidth*e.imageRatio<=1;let s=e=>e*devicePixelRatio%1===0,a=i.stageWidth,l=e.overlayStore.viewHeight,c=0,d=0,p=i.offset+(o?.5/devicePixelRatio:0),h=i.yOffset-(o&&(s(i.yOffset)?.5/devicePixelRatio:0)),u=i.width,g=i.height+(o&&(s(i.height)?0:(s(i.yOffset)?.5:-.5)/devicePixelRatio)),f={x:0,y:0},b={x:0,y:i.height},m=i.rightBorderPos+i.numberWidth+i.textGap,y=i.yOffset,O=[i.offset,this.cursorY,i.rightBorderPos,this.cursorY];"right"===i.position?d=e.overlayStore.padding.left+e.overlayStore.renderWidth:"bottom"===i.position?c=e.overlayStore.viewHeight-e.overlayStore.colorbarHoverInfoHeight-i.stageWidth:"top"===i.position&&e.overlayStore.title.show&&(c=e.overlayStore.padding.top-i.stageWidth),"right"!==i.position&&(l=a,a=e.overlayStore.viewWidth,h=p,p=i.yOffset+(o&&(s(i.yOffset)?.5/devicePixelRatio:0)),[u,g]=[g,u],[f.x,f.y,b.x,b.y]=[b.y,b.x,f.y,f.x],[m,y]=[y,m],O=[O[1],O[0],O[3],O[2]]),"top"===i.position&&(h=i.stageWidth-h-i.width,y=i.rightBorderPos-i.numberWidth-i.textGap-i.labelFontSize,O[1]=i.stageWidth-O[1]);const j=Object(xm.jsx)(oy.g,{x:p,y:h,width:u,height:g,fillLinearGradientStartPoint:f,fillLinearGradientEndPoint:b,fillLinearGradientColorStops:t.renderConfig.colorscaleArray,stroke:i.borderVisible?r(i.borderCustomColor,i.borderColor):null,strokeWidth:i.borderWidth/devicePixelRatio});let x=[],S=[];if(i.tickVisible||i.numberVisible){const n=t.colorbarStore.texts,o=t.colorbarStore.positions;for(let t=0;t<o.length;t++){if(i.tickVisible){const n=o[t]-(i.tickWidth*e.imageRatio<=1&&o[t]-Math.floor(o[t])-.5/devicePixelRatio);let s=[i.rightBorderPos-i.tickLen,n,i.rightBorderPos,n];"right"!==i.position&&(s=[s[1],s[0],s[3],s[2]],"top"===i.position&&(s[1]=i.rightBorderPos+i.tickLen)),x.push(Object(xm.jsx)(oy.f,{points:s,stroke:r(i.tickCustomColor,i.tickColor),strokeWidth:i.tickWidth/devicePixelRatio},t.toString()))}if(i.numberVisible){let e=i.rightBorderPos+i.textGap,s=o[t]-i.height/2;if("right"!==i.position)[e,s]=[s,e],"top"===i.position&&(s=i.rightBorderPos-i.textGap-i.numberFontSize);else switch(i.numberRotation){case 90:e+=i.numberFontSize;break;case 0:s=o[t]-i.numberFontSize/2;break;case-90:s=o[t]+i.height/2}S.push(Object(xm.jsx)(oy.k,{text:n[t],x:e,y:s,width:0!==i.numberRotation||"right"!==i.position?i.height:null,align:"center",fill:r(i.numberCustomColor,i.numberColor),fontFamily:this.astFonts[i.numberFont].family,fontStyle:`${this.astFonts[i.numberFont].style} ${this.astFonts[i.numberFont].weight}`,fontSize:i.numberFontSize,rotation:"right"===i.position?i.numberRotation:0},t.toString()))}}}const v=void 0!==t.requiredUnit&&t.requiredUnit.length?t.requiredUnit:"arbitrary units";if("right"===i.position)switch(i.labelRotation){case 90:m+=i.labelFontSize;break;case-90:y+=i.height}const C=i.labelVisible?Object(xm.jsx)(oy.k,{text:i.labelCustomText?t.colorbarLabelCustomText:v,x:m,y:y,width:i.height,align:"center",fill:r(i.labelCustomColor,i.labelColor),fontFamily:this.astFonts[i.labelFont].family,fontSize:i.labelFontSize,fontStyle:`${this.astFonts[i.labelFont].style} ${this.astFonts[i.labelFont].weight}`,rotation:"right"===i.position?i.labelRotation:0},"0"):null,I=i.interactive&&this.isHovering?Object(xm.jsx)(oy.f,{points:O,stroke:i.customColor?Jb(i.color):Jb(e.overlayStore.global.color),strokeWidth:1/devicePixelRatio}):null,w=i.interactive&&this.isHovering?Object(xm.jsx)("div",{className:"colorbar-info",children:Object(xm.jsx)(lO,{info:[`Colorscale: ${this.hoverInfoText} ${t.requiredUnit}`]})}):null;return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsxs)(oy.j,{className:"colorbar-stage",width:a,height:l,style:{left:d,top:c},onMouseEnter:this.onMouseEnter,onMouseMove:this.handleMouseMove,onMouseLeave:this.onMouseLeave,children:[Object(xm.jsxs)(oy.e,{ref:this.layerRef,children:[j,x,S,C]}),Object(xm.jsx)(oy.e,{children:I})]}),w]})}},fW.HoverDelay=500,sW=bW,aW=Object(b.a)(sW.prototype,"hoverInfoText",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),lW=Object(b.a)(sW.prototype,"isHovering",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),cW=Object(b.a)(sW.prototype,"cursorY",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return-1}}),dW=Object(b.a)(sW.prototype,"setHoverInfoText",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hoverInfoText=e}}}),pW=Object(b.a)(sW.prototype,"setMouseHovering",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isHovering=e}}}),hW=Object(b.a)(sW.prototype,"onMouseEnter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.mouseEnterHandle&&clearTimeout(this.mouseEnterHandle),this.mouseEnterHandle=setTimeout((()=>{this.setMouseHovering(!0)}),mW.HoverDelay)}}}),uW=Object(b.a)(sW.prototype,"onMouseLeave",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setMouseHovering(!1),this.mouseEnterHandle&&clearTimeout(this.mouseEnterHandle),this.props.onCursorHoverValueChanged(NaN)}}}),gW=Object(b.a)(sW.prototype,"setCursorY",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorY=e}}}),oW=sW))||oW;var yW,OW,jW;i(869);let xW=Object(p.a)((jW=OW=class e extends n.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.updateCanvas=()=>{gC.Instance.setCanvasUpdated();const e=this.props.frame,t=jx.Instance;if(e&&this.canvas&&this.gl&&t.cmapTexture){const t=e.renderConfig.stokesIndex,i=e.renderConfig.histogram?e.renderConfig.histChannel:void 0;!e.renderConfig.useCubeHistogram&&e.channel!==i||e.stokes!==t&&e.polarizations.indexOf(e.stokes)!==t||(this.updateCanvasSize(),this.updateUniforms(),this.renderCanvas());const n=this.canvas.getContext("2d"),r=this.canvas.width,o=this.canvas.height;n.clearRect(0,0,r,o),n.drawImage(this.gl.canvas,this.props.column*r,this.props.row*o,r,o,0,0,r,o)}},this.getRef=e=>{this.canvas=e}}componentDidMount(){this.gl=jx.Instance.gl,this.canvas&&this.updateCanvas(),ux.Instance.tileStream.subscribe((()=>{requestAnimationFrame(this.updateCanvas)}))}componentDidUpdate(){requestAnimationFrame(this.updateCanvas)}updateUniforms(){const t=gC.Instance,i=jx.Instance.shaderUniforms,n=this.props.frame,r=n.renderConfig,o=devicePixelRatio*t.imageRatio;if(r&&i){this.gl.uniform1f(i.MinVal,r.scaleMinVal),this.gl.uniform1f(i.MaxVal,r.scaleMaxVal),this.gl.uniform1i(i.CmapIndex,r.colorMapIndex),this.gl.uniform1i(i.ScaleType,r.scaling),this.gl.uniform1i(i.Inverted,r.inverted?1:0),this.gl.uniform1f(i.Bias,r.bias),this.gl.uniform1f(i.Contrast,r.contrast),this.gl.uniform1i(i.UseSmoothedBiasContrast,t.preferenceStore.useSmoothedBiasContrast?1:0),this.gl.uniform1f(i.Gamma,r.gamma),this.gl.uniform1f(i.Alpha,r.alpha),this.gl.uniform1f(i.CanvasWidth,n.renderWidth*o),this.gl.uniform1f(i.CanvasHeight,n.renderHeight*o);const s=je()(t.preferenceStore.nanColorHex).setAlpha(t.preferenceStore.nanAlpha);if(s.isValid()){const e=s.toRgb();this.gl.uniform4f(i.NaNColor,e.r/255,e.g/255,e.b/255,e.a)}const a=je()(Jb(t.preferenceStore.pixelGridColor));if(a.isValid()){const e=a.toRgb();this.gl.uniform4f(i.PixelGridColor,e.r/255,e.g/255,e.b/255,e.a)}else this.gl.uniform4f(i.PixelGridColor,0,0,0,0);isFinite(this.props.pixelHighlightValue)&&!t.isExportingImage?this.gl.uniform1f(i.PixelHighlightVal,this.props.pixelHighlightValue):this.gl.uniform1f(i.PixelHighlightVal,-e.Float32Max)}}updateCanvasSize(){const e=this.props.frame;if(!e)return;const t=gC.Instance,i=devicePixelRatio*t.imageRatio,n=Math.max(1,e.renderWidth*i),r=Math.max(1,e.renderHeight*i),o=jx.Instance;!(null===e||void 0===e?void 0:e.isRenderable)||this.canvas.width===n&&this.canvas.height===r||(this.canvas.width=n,this.canvas.height=r),o.setCanvasSize(n*t.numImageColumns,r*t.numImageRows),this.gl.drawingBufferWidth===this.gl.canvas.width&&this.gl.drawingBufferHeight===this.gl.canvas.height||t.decreaseImageRatio()}renderCanvas(){const e=this.props.frame;if(null===e||void 0===e?void 0:e.isRenderable){const t=gC.Instance,i=devicePixelRatio*t.imageRatio,n=this.props.column*e.renderWidth*i,r=(t.numImageRows-1-this.props.row)*e.renderHeight*i;this.gl.viewport(n,r,e.renderWidth*i,e.renderHeight*i),this.gl.enable(vm.DEPTH_TEST),this.gl.enable(vm.SCISSOR_TEST),this.gl.scissor(n,r,e.renderWidth*i,e.renderHeight*i),this.gl.clear(vm.COLOR_BUFFER_BIT|vm.DEPTH_BUFFER_BIT),this.gl.disable(vm.SCISSOR_TEST),e.renderConfig.visible&&this.renderTiledCanvas()}}renderTiledCanvas(){const e=this.props.frame,t=jx.Instance;this.gl.bindBuffer(vm.ARRAY_BUFFER,t.vertexUVBuffer),this.gl.vertexAttribPointer(t.vertexUVAttribute,2,vm.FLOAT,!1,0,0),this.gl.bindBuffer(vm.ARRAY_BUFFER,t.vertexPositionBuffer),this.gl.vertexAttribPointer(t.vertexPositionAttribute,3,vm.FLOAT,!1,0,0);const i={x:e.frameInfo.fileInfoExtended.width,y:e.frameInfo.fileInfoExtended.height},n={xMin:Math.max(0,e.requiredFrameView.xMin),xMax:Math.min(e.requiredFrameView.xMax,i.x),yMin:Math.max(0,e.requiredFrameView.yMin),yMax:Math.min(e.requiredFrameView.yMax,i.y),mip:e.requiredFrameView.mip};this.gl.activeTexture(vm.TEXTURE0);const r=jm(n,i,{x:hx,y:hx});if(1===r.length&&0===r[0].layer){const e=function(e,t,i){const n=Math.ceil(t.x/i.x),r=Math.ceil(t.y/i.y),o=Math.max(n,r),s=Math.ceil(Math.log2(o));return Math.pow(2,s-e)}(0,i,{x:hx,y:hx});this.renderTiles(r,e,!1,3,!0)}else this.renderTiles(r,n.mip,!1,3,!0)}renderTiles(e,t,i=!1,n,r){const o=ux.Instance,s=this.props.frame;if(!o)return;const a=new Map,l=[];for(const c of e){const e=wi.EncodeCoordinate(c),d=o.getTile(e,s.frameInfo.fileId,s.channel,s.stokes,i);if(d)this.renderTile(c,d,t);else if(n>0&&t>=2&&(l.push({layer:c.layer+1,x:2*c.x,y:2*c.y}),l.push({layer:c.layer+1,x:2*c.x+1,y:2*c.y}),l.push({layer:c.layer+1,x:2*c.x,y:2*c.y+1}),l.push({layer:c.layer+1,x:2*c.x+1,y:2*c.y+1})),c.layer>0&&r){const e={layer:c.layer-1,x:Math.floor(c.x/2),y:Math.floor(c.y/2)};a.set(wi.EncodeCoordinate(e),!0)}}if(n>0&&l.length&&this.renderTiles(l,t/2,!0,n-1,!1),r){const e=[];a.forEach(((t,i)=>e.push(wi.Decode(i)))),e.length&&this.renderTiles(e,2*t,!0,0,!0)}}get panelIndex(){var e,t,i,n;const r=null===(e=this.canvas)||void 0===e||null===(t=e.parentElement)||void 0===t?void 0:t.parentElement,o=null===r||void 0===r?void 0:r.parentElement,s=(null!==(i=null===o||void 0===o||null===(n=o.children)||void 0===n?void 0:n.length)&&void 0!==i?i:0)-1;for(let a=0;a<s;a++)if(o.children[a]===r)return a;return-1}renderTile(e,t,i){const n=gC.Instance,r=this.props.frame,o=jx.Instance.shaderUniforms,s=ux.Instance;if(!t)return;t.data&&(s.uploadTileToGPU(t),delete t.data);const a=s.getTileTextureParameters(t);a&&(this.gl.bindTexture(vm.TEXTURE_2D,a.texture),this.gl.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MIN_FILTER,vm.NEAREST),this.gl.texParameteri(vm.TEXTURE_2D,vm.TEXTURE_MAG_FILTER,vm.NEAREST),this.gl.uniform2f(o.TileTextureOffset,a.offset.x,a.offset.y));const l=r.spatialReference||r,c=l.requiredFrameView,d=i*hx,p=e.x*d,h=e.y*d;e.x,e.y;let u,g={x:p-c.xMin-.5,y:h-c.yMin-.5},f=om({x:1,y:1},i*l.zoomLevel);if(r.spatialReference&&r.spatialTransform){g=im(g,r.spatialTransform.translation);const e=im(r.spatialTransform.origin,r.spatialTransform.translation),t={x:l.zoomLevel*(e.x-c.xMin),y:l.zoomLevel*(e.y-c.yMin)};this.gl.uniform2f(o.RotationOrigin,t.x,t.y),this.gl.uniform1f(o.RotationAngle,-r.spatialTransform.rotation),this.gl.uniform1f(o.ScaleAdjustment,r.spatialTransform.scale)}else this.gl.uniform2f(o.RotationOrigin,0,0),this.gl.uniform1f(o.RotationAngle,0),this.gl.uniform1f(o.ScaleAdjustment,1);let b=1,m=1;const y=devicePixelRatio*n.imageRatio;r.spatialReference?(b=r.spatialTransform.scale,u=r.spatialReference.zoomLevel/y*b):(m=r.aspectRatio,u=r.zoomLevel/y);if(u>=6&&1===i&&n.preferenceStore.pixelGridVisible){const e=.5/u,t=.25*Wi(u,6,12);this.gl.uniform1f(o.PixelGridCutoff,e),this.gl.uniform1f(o.PixelGridOpacity,t)}else this.gl.uniform1f(o.PixelGridOpacity,0);this.gl.uniform1f(o.PixelAspectRatio,m),g=om(g,l.zoomLevel),this.gl.uniform2f(o.TileSize,t.width,t.height),this.gl.uniform2f(o.TileOffset,g.x,g.y),this.gl.uniform2f(o.TileScaling,f.x,f.y),this.gl.drawArrays(vm.TRIANGLE_STRIP,0,4)}render(){const e=gC.Instance,t=this.props.frame;var i;if(t){const n=t.spatialReference||t;n.requiredFrameView,n.currentFrameView,t.renderConfig.scaleMinVal,t.renderConfig.scaleMaxVal,t.renderConfig.colorMapIndex,t.renderConfig.contrast,t.renderConfig.bias,null===(i=e.preferenceStore)||void 0===i||i.useSmoothedBiasContrast,t.renderConfig.scaling,t.renderConfig.gamma,t.renderConfig.alpha,t.renderConfig.inverted,t.renderConfig.visible,e.preferenceStore.nanColorHex,e.preferenceStore.nanAlpha,e.preferenceStore.pixelGridVisible,Jb(e.preferenceStore.pixelGridColor),e.imageRatio}const n=e.overlayStore.padding,r=d()("raster-div",{docked:this.props.docked});return Object(xm.jsx)("div",{className:r,children:Object(xm.jsx)("canvas",{className:"raster-canvas",id:"raster-canvas",ref:this.getRef,style:{top:n.top,left:n.left,width:(null===t||void 0===t?void 0:t.isRenderable)&&t.renderWidth||1,height:(null===t||void 0===t?void 0:t.isRenderable)&&t.renderHeight||1}})})}},OW.Float32Max=3402823466e29,yW=jW))||yW;var SW,vW,CW;i(870);let IW=Object(p.a)((CW=vW=class e extends n.Component{constructor(...e){super(...e),this.handleZoomToActualSizeClicked=()=>{this.props.frame.setZoom(1),this.props.onRegionViewZoom(1)},this.handleZoomInClicked=()=>{const e=this.props.frame.spatialReference||this.props.frame,t=2*e.zoomLevel;e.setZoom(t,!0),this.props.onRegionViewZoom(t)},this.handleZoomOutClicked=()=>{const e=this.props.frame.spatialReference||this.props.frame,t=e.zoomLevel/2;e.setZoom(t,!0),this.props.onRegionViewZoom(t)},this.handleRegionTypeClicked=e=>{this.props.frame.regionSet.setNewRegionType(e),this.props.frame.regionSet.setMode(Vb.CREATING)},this.handleCoordinateSystemClicked=e=>{bA.Instance.global.setSystem(e)},this.handleActiveLayerClicked=e=>{const t=gC.Instance;t.activeLayer!==_G.DistanceMeasuring&&e===_G.DistanceMeasuring&&t.frames.forEach((e=>e.distanceMeasuring.resetPos())),this.props.onActiveLayerChange(e),e===_G.RegionCreating?this.props.frame.regionSet.setMode(Vb.CREATING):this.props.frame.regionSet.setMode(Vb.MOVING)},this.exportImageTooltip=()=>Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Background color is ",gC.Instance.preferenceStore.transparentImageBackground?"transparent":"filled",".",Object(xm.jsx)("br",{}),gC.Instance.preferenceStore.transparentImageBackground?"Disable":"Enable"," transparent image background in Preferences.",Object(xm.jsx)("br",{})]})})]})}render(){const t=gC.Instance,i=t.preferenceStore,r=t.overlayStore,o=this.props.frame,s=r.grid,a={bottom:r.padding.bottom,right:r.padding.right,left:r.padding.left,opacity:this.props.visible?1:0,backgroundColor:"transparent"},l=d()("image-toolbar",{docked:this.props.docked,"bp3-dark":t.darkTheme}),c=o.spatialReference&&o.spatialTransform?o.spatialReference.zoomLevel*o.spatialTransform.scale:o.zoomLevel,p=Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Current: ",fi(c,2),"x"]})})]}),h="top",g=Object(xm.jsx)(u.z,{children:Array.from(Ob.AVAILABLE_REGION_TYPES).map((([e,t],i)=>{const n=Ob.RegionIconString(e),r=Ob.IsRegionCustomIcon(e)?Object(xm.jsx)(jN,{icon:n}):n;return Object(xm.jsx)(u.B,{icon:r,text:t,onClick:()=>this.handleRegionTypeClicked(e)},i)}))});let f=r.global.system;const b=Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:e.CoordinateSystemName.get(tA.Auto),onClick:()=>this.handleCoordinateSystemClicked(tA.Auto)}),Object(xm.jsx)(u.B,{text:e.CoordinateSystemName.get(tA.FK5),onClick:()=>this.handleCoordinateSystemClicked(tA.FK5)}),Object(xm.jsx)(u.B,{text:e.CoordinateSystemName.get(tA.FK4),onClick:()=>this.handleCoordinateSystemClicked(tA.FK4)}),Object(xm.jsx)(u.B,{text:e.CoordinateSystemName.get(tA.Galactic),onClick:()=>this.handleCoordinateSystemClicked(tA.Galactic)}),Object(xm.jsx)(u.B,{text:e.CoordinateSystemName.get(tA.Ecliptic),onClick:()=>this.handleCoordinateSystemClicked(tA.Ecliptic)}),Object(xm.jsx)(u.B,{text:e.CoordinateSystemName.get(tA.ICRS),onClick:()=>this.handleCoordinateSystemClicked(tA.ICRS)})]}),m=Ob.RegionIconString(o.regionSet.newRegionType),x=Ob.IsRegionCustomIcon(o.regionSet.newRegionType)?Object(xm.jsx)(jN,{icon:m}):m,S=!!o.spatialReference,v=!!o.spectralReference,C=t.spatialReference!==o,I=t.spectralReference&&t.spectralReference!==o&&o.frameInfo.fileInfoExtended.depth>1,w=(S?"x":"")+(v?"z":""),T=[];v&&T.push(`Spectral (${i.spectralMatchingType})`),S&&T.push("Spatial");const R=T.join(" and ")||"None",A=Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.B,{text:`Spectral (${i.spectralMatchingType}) and Spatial`,disabled:!C||!I,active:v&&S,onClick:()=>t.setMatchingEnabled(!0,!0)}),Object(xm.jsx)(u.B,{text:`Spectral (${i.spectralMatchingType})  only`,disabled:!I,active:v&&!S,onClick:()=>t.setMatchingEnabled(!1,!0)}),Object(xm.jsx)(u.B,{text:"Spatial only",disabled:!C,active:!v&&S,onClick:()=>t.setMatchingEnabled(!0,!1)}),Object(xm.jsx)(u.B,{text:"None",disabled:!C,active:!v&&!S,onClick:()=>t.setMatchingEnabled(!1,!1)})]}),P=Object(xm.jsx)(u.z,{children:Object(xm.jsx)(Iy,{})}),E=t.activeLayer===_G.Catalog,M=0===t.catalogNum;return Object(xm.jsxs)(u.f,{className:l,style:a,children:[t.toolbarExpanded&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Measure distance",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"Click to create geodesic curves."})})]}),children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"distanceMeasuring"}),active:t.activeLayer===_G.DistanceMeasuring,onClick:()=>this.handleActiveLayerClicked(_G.DistanceMeasuring)})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Catalog selection",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"Click to select single catalog source"})})]}),children:Object(xm.jsx)(u.b,{icon:"locate",active:E,onClick:()=>this.handleActiveLayerClicked(_G.Catalog),disabled:M})}),o.regionSet.mode===Vb.CREATING&&Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Create region",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"Click to select region type"})})]}),children:Object(xm.jsx)(O.a,{popoverClassName:"region-menu",content:g,position:y.a.TOP,minimal:!0,children:Object(xm.jsx)(u.b,{icon:x,active:t.activeLayer===_G.RegionCreating,onClick:()=>this.handleActiveLayerClicked(_G.RegionCreating)})})}),o.regionSet.mode===Vb.MOVING&&Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Create region",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Double-click to select region type.",Object(xm.jsx)("br",{}),"Press C to enter creation mode."]})})]}),children:Object(xm.jsx)(u.b,{icon:x,onClick:()=>this.handleActiveLayerClicked(_G.RegionCreating)})}),Object(xm.jsx)(j.a,{position:h,content:"Select and pan mode",children:Object(xm.jsx)(u.b,{icon:"hand",onClick:()=>this.handleActiveLayerClicked(_G.RegionMoving),active:o.regionSet.mode===Vb.MOVING&&t.activeLayer===_G.RegionMoving})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Zoom in (Scroll wheel up)",p]}),children:Object(xm.jsx)(u.b,{icon:"zoom-in",onClick:this.handleZoomInClicked})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Zoom out (Scroll wheel down)",p]}),children:Object(xm.jsx)(u.b,{icon:"zoom-out",onClick:this.handleZoomOutClicked})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Zoom to 1.0x",p]}),children:Object(xm.jsx)(u.b,{className:"full-zoom-button",onClick:this.handleZoomToActualSizeClicked,children:"1.0x"})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Zoom to fit",p]}),children:Object(xm.jsx)(u.b,{icon:"zoom-to-fit",onClick:this.props.onZoomToFit})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["WCS Matching ",Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:Object(xm.jsxs)("i",{children:["Current: ",R]})})]}),children:Object(xm.jsx)(O.a,{content:A,position:y.a.TOP,minimal:!0,children:Object(xm.jsx)(u.b,{icon:"link",className:"link-button",children:w})})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Overlay Coordinate ",Object(xm.jsx)("br",{}),Object(xm.jsx)("small",{children:Object(xm.jsxs)("i",{children:["Current: ",e.CoordinateSystemTooltip.get(f)]})})]}),children:Object(xm.jsx)(O.a,{content:b,position:y.a.TOP,minimal:!0,children:Object(xm.jsx)(u.b,{disabled:!o.validWcs,text:e.CoordinateSystemName.get(f)})})}),Object(xm.jsx)(j.a,{position:h,content:"Toggle grid",children:Object(xm.jsx)(u.b,{icon:"grid",active:s.visible,onClick:()=>s.setVisible(!s.visible)})}),Object(xm.jsx)(j.a,{position:h,content:"Toggle labels",children:Object(xm.jsx)(u.b,{icon:"numerical",active:!r.labelsHidden,onClick:r.toggleLabels})}),Object(xm.jsx)(j.a,{position:h,content:Object(xm.jsxs)("span",{children:["Export image",this.exportImageTooltip()]}),children:Object(xm.jsx)(O.a,{content:P,position:y.a.TOP,minimal:!0,children:Object(xm.jsx)(u.b,{disabled:t.isExportingImage,icon:"floppy-disk"})})})]}),Object(xm.jsx)(j.a,{position:h,content:t.toolbarExpanded?"Hide toolbar":"Show toolbar",children:Object(xm.jsx)(u.b,{active:t.toolbarExpanded,icon:t.toolbarExpanded?"double-chevron-right":"double-chevron-left",onClick:t.toggleToolbarExpanded})})]})}},vW.CoordinateSystemName=new Map([[tA.Auto,"WCS"],[tA.FK5,"FK5"],[tA.FK4,"FK4"],[tA.Galactic,"GAL"],[tA.Ecliptic,"ECL"],[tA.ICRS,"ICRS"]]),vW.CoordinateSystemTooltip=new Map([[tA.Auto,"Automatically select the coordinate system based on file headers"],[tA.FK5,"FK5 coordinates, J2000.0 equinox"],[tA.FK4,"FK4 coordinates, B1950.0 equinox"],[tA.Galactic,"Galactic coordinates"],[tA.Ecliptic,"Ecliptic coordinates"],[tA.ICRS,"International Celestial Reference System"]]),SW=CW))||SW;var wW;i(871);let TW=Object(p.a)(wW=class extends n.Component{constructor(...e){super(...e),this.layerRef=n.createRef(),this.getPlotProps=(e,t)=>{if(!e.hasVisibleBeam)return null;const i=e.frameInfo.fileId,n=(e.spatialReference?e.spatialReference.zoomLevel*e.spatialTransform.scale:e.zoomLevel)/gC.Instance.imageRatio,r=e.overlayBeamSettings,o=Jb(r.color),s=r.type===rA.Solid?L.a.WHITE:o,a=r.type,l=r.width,c=this.props.padding?this.props.padding*devicePixelRatio:0,d=r.shiftX,p=r.shiftY,h=e.beamProperties.x/2*n/devicePixelRatio,u=e.beamProperties.y/2*n/devicePixelRatio;let g=(90-e.beamProperties.angle)*Math.PI/180;e.spatialTransform&&(g-=e.spatialTransform.rotation);const f=Math.sin(g),b=Math.cos(g),m=2*Math.sqrt(h*h*b*b+u*u*f*f),y=2*Math.sqrt(h*h*f*f+u*u*b*b),O=e.renderWidth-m/2;let j=t?t.x:m/2+c+d;j>O&&(j=O);const x=y/2;let S=t?t.y:e.renderHeight-y/2-c-p;return S<x&&(S=x),{id:i,position:{x:j,y:S},a:h,b:u,theta:g,type:a,color:o,axisColor:s,strokeWidth:l}}}componentDidUpdate(){gC.Instance.resetImageRatio()}plotBeam(e){if(!e)return null;let t;switch(e.type){case rA.Open:default:t=Object(xm.jsx)(oy.c,{radiusX:e.a,radiusY:e.b,stroke:e.color,strokeWidth:e.strokeWidth});break;case rA.Solid:t=Object(xm.jsx)(oy.c,{radiusX:e.a,radiusY:e.b,fill:e.color,stroke:e.color,strokeWidth:e.strokeWidth})}return Object(xm.jsxs)(oy.d,{x:e.position.x,y:e.position.y,rotation:180*e.theta/Math.PI,children:[e.a>0&&e.b>0&&t,Object(xm.jsx)(oy.f,{points:[-e.a,0,e.a,0],stroke:e.axisColor,strokeWidth:e.strokeWidth}),Object(xm.jsx)(oy.f,{points:[0,-e.b,0,e.b],stroke:e.axisColor,strokeWidth:e.strokeWidth})]},e.id)}render(){var e;const t=gC.Instance,i=this.props.frame,n=null===(e=t.contourFrames.get(i))||void 0===e?void 0:e.filter((e=>e!==i&&e.hasVisibleBeam));if(!i.hasVisibleBeam&&!n.length)return null;let r;t.updateLayerPixelRatio(this.layerRef),i.hasVisibleBeam&&(r=this.getPlotProps(i));const o=[];n.forEach((e=>{const t=this.getPlotProps(e,r?r.position:null);o.push(this.plotBeam(t))}));const s=d()("beam-profile-stage",{docked:this.props.docked});return Object(xm.jsx)(oy.j,{className:s,width:i.renderWidth,height:i.renderHeight,style:{left:this.props.left,top:this.props.top},children:Object(xm.jsxs)(oy.e,{listening:!1,ref:this.layerRef,children:[this.plotBeam(r),o]})})}})||wW;function RW(e,t,i,n,r,o=null){let s={x:0,y:0};return o&&(s=om(dm(s,o.rotation),o.scale)),{x:e/n*(i.xMax-i.xMin)+i.xMin-s.x,y:t/r*(i.yMin-i.yMax)+i.yMax-s.y}}function AW(e,t,i,n,r,o=null){const s=i.xMax-i.xMin,a=i.yMax-i.yMin;return{x:(e-i.xMin)/s*n,y:r-(t-i.yMin)/a*r}}function PW(e,t,i,n,r){let o=RW(e,t,i.spatialReference?i.spatialReference.requiredFrameView:i.requiredFrameView,n,r,i.spatialTransform);return i.spatialReference&&(o=i.spatialTransform.transformCoordinate(o,!1)),o}function EW(e,t,i,n,r){const o=null===r||void 0===r?void 0:r.getPosition(),s=null===r||void 0===r?void 0:r.scaleX();if(o&&isFinite(s)){let r;if(t.spatialReference){const a=t.spatialTransform.transformCoordinate(e,!0),l=0===o.x&&0===o.y&&1===s?t.spatialReference.unitFrameView:t.spatialReference.requiredFrameViewForRegionRender;r=AW(a.x,a.y,l,i,n)}else{const a=0===o.x&&0===o.y&&1===s?t.unitFrameView:t.requiredFrameViewForRegionRender;r=AW(e.x,e.y,a,i,n)}if(r)return{x:(r.x-o.x)/s,y:(r.y-o.y)/s}}return{x:void 0,y:void 0}}function MW(e,t){const i=null===t||void 0===t?void 0:t.getPosition(),n=null===t||void 0===t?void 0:t.scaleX();if(e&&i&&isFinite(n))return{x:e.x*n+i.x,y:e.y*n+i.y}}const FW=7/Math.sqrt(2),kW=(e,t,i)=>{const n=1/t.getStage().scaleX(),r=.5*-i*n,o=i*n;e.beginPath(),e.rect(r,r,o,o),e.fillStrokeShape(t)},DW=e=>Object(xm.jsxs)(oy.d,{children:[Object(xm.jsx)(oy.i,{x:e.x,y:e.y,rotation:e.rotation,fill:e.color,sceneFunc:(e,t)=>{kW(e,t,6)}}),Object(xm.jsx)(oy.i,{x:e.x,y:e.y,rotation:e.rotation,sceneFunc:(e,t)=>{kW(e,t,13)},stroke:"white",strokeWidth:1,strokeScaleEnabled:!1,opacity:e.opacity,draggable:!0,listening:e.listening,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragMove:e.onDragMove,onClick:e.onClick,onDblClick:e.onDblClick})]}),LW=e=>Object(xm.jsx)(oy.i,{x:e.x,y:e.y,rotation:e.rotation,fill:"white",strokeWidth:1,stroke:"black",strokeScaleEnabled:!1,draggable:!0,id:e.anchor,onMouseEnter:e.onMouseEnter,onMouseOut:e.onMouseOut,onDragStart:e.onDragStart,onDragEnd:e.onDragEnd,onDragMove:e.onDragMove,onDblClick:e.onDblClick,sceneFunc:e.isRotator?(e,t)=>{const i=1/t.getStage().scaleX(),n=FW*i,r=-15/t.getStage().scaleX();e.beginPath(),e.arc(0,r,n,0,2*Math.PI,!1),e.fillStrokeShape(t)}:(e,t)=>{kW(e,t,7)}},e.anchor),NW=e=>Object(xm.jsx)(oy.i,{x:e.x,y:e.y,rotation:e.rotation,fill:"white",strokeWidth:1,stroke:"black",strokeScaleEnabled:!1,opacity:.5,listening:!1,sceneFunc:(e,t)=>{kW(e,t,7)}}),_W=e=>Object(xm.jsxs)(oy.d,{x:e.x,y:e.y,rotation:-e.rotation,children:[Object(xm.jsx)(oy.i,{listening:!1,strokeScaleEnabled:!1,strokeWidth:1,stroke:"black",sceneFunc:(e,t)=>{kW(e,t,6)}}),Object(xm.jsx)(oy.i,{listening:!1,strokeScaleEnabled:!1,fill:"white",strokeWidth:1,stroke:"black",sceneFunc:(e,t)=>{const i=1/t.getStage().scaleX(),n=-3*i,r=10*i,o=3*i;e.beginPath(),e.rect(-n,n/2,r,o),e.rect(n-r,n/2,r,o),e.rect(n/2,-n,o,r),e.rect(n/2,n-r,o,r),e.fillStrokeShape(t)}})]});var zW;let VW=Object(p.a)(zW=class extends r.a.Component{render(){var e;const t=this.props.frame,i=null===t||void 0===t||null===(e=t.cursorInfo)||void 0===e?void 0:e.posImageSpace;if(gC.Instance.cursorFrozen&&i){const e=t.spatialReference?180*t.spatialTransform.rotation/Math.PI:0,n=EW(i,t,this.props.width,this.props.height,this.props.stageRef.current);return Object(xm.jsx)(_W,{x:n.x,y:n.y,rotation:-e})}return null}})||zW;var WW;let GW=Object(p.a)(WW=class extends n.Component{constructor(...e){super(...e),this.handleDoubleClick=()=>{var e,t;null===(e=(t=this.props).onDoubleClick)||void 0===e||e.call(t,this.props.region)},this.handleClick=e=>{const t=e.evt;var i,n;0!==t.button||t.ctrlKey||t.metaKey||(null===(i=(n=this.props).onSelect)||void 0===i||i.call(n,this.props.region))},this.handleDragStart=()=>{var e,t;null===(e=(t=this.props).onSelect)||void 0===e||e.call(t,this.props.region),this.props.region.beginEditing()},this.handleDragEnd=()=>{this.props.region.endEditing()},this.handleDrag=e=>{if(e.target){const t=this.props.frame,i=MW(e.target.position(),this.props.stageRef.current);let n=PW(i.x,i.y,t,this.props.layerWidth,this.props.layerHeight);t.spatialReference&&(n=Mm(t.spatialTransformAST,n,!0)),this.props.region.setCenter(n)}}}componentDidUpdate(){gC.Instance.resetImageRatio()}render(){const e=this.props.region,t=this.props.frame;let i,n;gC.Instance.imageRatio;if(t.spatialReference){const r=e.center;i=EW(Mm(t.spatialTransformAST,r,!1),t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current),n=180*-t.spatialTransform.rotation/Math.PI}else i=EW(e.center,t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current),n=0;return Object(xm.jsx)(DW,{x:i.x,y:i.y,rotation:n,color:e.color,opacity:this.props.selected?1:0,listening:!e.locked,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,onClick:this.handleClick,onDblClick:this.handleDoubleClick})}})||WW;var BW,qW,HW;let YW=Object(p.a)((qW=class e extends n.Component{constructor(...t){super(...t),this.editAnchor=void 0,this.centerCanvasPos=void 0,this.editOppositeAnchorPoint=void 0,this.editOppositeAnchorCanvasPos=void 0,this.editStartCenterPoint=void 0,this.previousCursorStyle=void 0,this.handleContextMenu=e=>{e.evt.preventDefault()},this.handleDoubleClick=()=>{var e,t;null===(e=(t=this.props).onDoubleClick)||void 0===e||e.call(t,this.props.region)},this.handleClick=e=>{const t=e.evt;var i,n;0!==t.button||t.ctrlKey||t.metaKey||(null===(i=(n=this.props).onSelect)||void 0===i||i.call(n,this.props.region))},this.startEditing=e=>{this.editAnchor=e;const t=this.props.region,i=this.props.frame;let n=t.center;i.spatialReference&&(n=Mm(i.spatialTransformAST,n,!1));const r=EW(n,i,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);let o,s;this.centerCanvasPos=r,this.props.region.regionType===Nt.RegionType.RECTANGLE?(o=t.size.x,s=t.size.y):(o=t.size.y,s=t.size.x),this.editStartCenterPoint={x:t.center.x,y:t.center.y};const a={x:0,y:0},l=this.props.region.regionType===Nt.RegionType.RECTANGLE?.5:1;this.editAnchor.includes("left")?a.x=+o*l:this.editAnchor.includes("right")&&(a.x=-o*l),this.editAnchor.includes("top")?a.y=-s*l:this.editAnchor.includes("bottom")&&(a.y=+s*l);const c=dm(a,this.props.region.rotation*Math.PI/180);this.editOppositeAnchorPoint=im(this.editStartCenterPoint,c);let d=this.editOppositeAnchorPoint;i.spatialReference&&(d=Mm(i.spatialTransformAST,d,!1));const p=EW(d,i,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);this.editOppositeAnchorCanvasPos=p,this.props.region.beginEditing()},this.applyCornerScaling=(e,t,i,n)=>{const r=this.props.frame;let o,s,a,l=PW(t,i,r,this.props.layerWidth,this.props.layerHeight);r.spatialReference&&(l=Mm(r.spatialTransformAST,l,!0)),e.regionType===Nt.RegionType.RECTANGLE?(a=1,o=e.size.x,s=e.size.y):(a=.5,o=e.size.y,s=e.size.x);let c=nm(l,this.editOppositeAnchorPoint);const d=dm(c,-e.rotation*Math.PI/180);n.includes("left")||n.includes("right")?o=Math.abs(d.x)*a:d.x=0,n.includes("top")||n.includes("bottom")?s=Math.abs(d.y)*a:d.y=0,c=dm(d,e.rotation*Math.PI/180);const p=im(this.editOppositeAnchorPoint,om(c,.5)),h=e.regionType===Nt.RegionType.RECTANGLE?{x:Math.max(.001,o),y:Math.max(.001,s)}:{y:Math.max(.001,o),x:Math.max(.001,s)};e.setControlPoints([p,h])},this.applyCenterScaling=(e,t,i,n,r)=>{const o=this.props.frame;let s,a,l,c=PW(t,i,o,this.props.layerWidth,this.props.layerHeight);o.spatialReference&&(c=Mm(o.spatialTransformAST,c,!0)),e.regionType===Nt.RegionType.RECTANGLE?(l=2,s=e.size.x,a=e.size.y):(l=1,s=e.size.y,a=e.size.x);const d=dm(nm(c,e.center),-e.rotation*Math.PI/180);(n.includes("left")||n.includes("right"))&&(s=Math.abs(d.x)*l,r&&(a=s)),(n.includes("top")||n.includes("bottom"))&&(a=Math.abs(d.y)*l,r&&(s=a));const p=e.regionType===Nt.RegionType.RECTANGLE?{x:Math.max(.001,s),y:Math.max(.001,a)}:{y:Math.max(.001,s),x:Math.max(.001,a)};e.setSize(p)},this.handleDragStart=()=>{var e,t;null===(e=(t=this.props).onSelect)||void 0===e||e.call(t,this.props.region),this.props.region.beginEditing()},this.handleDragEnd=()=>{this.props.region.endEditing()},this.handleDrag=e=>{if(e.target){const t=this.props.frame,i=MW(e.target.position(),this.props.stageRef.current);let n=PW(i.x,i.y,t,this.props.layerWidth,this.props.layerHeight);t.spatialReference&&(n=Mm(t.spatialTransformAST,n,!0)),this.props.region.setCenter(n)}},this.handleAnchorMouseEnter=t=>{const i=t.target,n=null===i||void 0===i?void 0:i.getStage();n&&(this.previousCursorStyle=n.container().style.cursor,n.container().style.cursor=e.GetCursor(i.id(),this.props.region.rotation))},this.handleAnchorMouseOut=e=>{e.target&&e.target.getStage()&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)},this.handleAnchorDragStart=e=>{if(e.target){const t=e.target.id();this.startEditing(t)}},this.handleAnchorDragEnd=()=>{this.props.region.endEditing()},this.getDragBoundedAnchorPos=(e,t,i)=>{const n=this.props.frame;if(n&&("left"===t||"right"===t||"top"===t||"bottom"===t)){const r=e.size.x/devicePixelRatio,o=e.size.y/devicePixelRatio,s=e.regionType===Nt.RegionType.RECTANGLE?{x:r*n.aspectRatio,y:o}:{x:o*n.aspectRatio,y:r};let a;a="left"===t?{x:-s.x,y:0}:"right"===t?{x:s.x,y:0}:"top"===t?{x:0,y:-s.y}:{x:0,y:s.y};const l=dm(om(a,e.regionType===Nt.RegionType.RECTANGLE?.5:1),-e.rotation*Math.PI/180);return i?im(this.editOppositeAnchorCanvasPos,om(l,2)):im(this.centerCanvasPos,l)}},this.getDragBoundedDiagonalAnchorPos=(e,t)=>{const i=this.props.frame;if(i&&("top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t)){const n=dm(om({x:e.size.x/devicePixelRatio,y:e.size.y/devicePixelRatio},e.regionType===Nt.RegionType.RECTANGLE?.5:1),e.rotation*Math.PI/180);return im(this.centerCanvasPos,"top-left"===t?{x:-n.y*i.aspectRatio,y:-n.x}:"bottom-left"===t?{x:-n.x*i.aspectRatio,y:n.y}:"top-right"===t?{x:n.x*i.aspectRatio,y:-n.y}:{x:n.y*i.aspectRatio,y:n.x})}},Object(f.a)(this,"handleAnchorDrag",HW,this),this.genAnchors=()=>{const e=this.props.region,t=this.props.frame,i=e.regionType===Nt.RegionType.RECTANGLE?{x:e.size.x/2,y:e.size.y/2}:{x:e.size.y,y:e.size.x};let n=[{anchor:"top",offset:{x:0,y:i.y}},{anchor:"bottom",offset:{x:0,y:-i.y}},{anchor:"left",offset:{x:-i.x,y:0}},{anchor:"right",offset:{x:i.x,y:0}},{anchor:"top-left",offset:{x:-i.x,y:i.y}},{anchor:"bottom-left",offset:{x:-i.x,y:-i.y}},{anchor:"top-right",offset:{x:i.x,y:i.y}},{anchor:"bottom-right",offset:{x:i.x,y:-i.y}}];return t.hasSquarePixels&&n.push({anchor:"rotator",offset:{x:0,y:i.y}}),n.map((i=>{let n=im(e.center,dm(i.offset,e.rotation*Math.PI/180));t.spatialReference&&(n=Mm(t.spatialTransformAST,n,!1));const r=EW(n,t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);return Object(xm.jsx)(LW,{anchor:i.anchor,x:r.x,y:r.y,rotation:-e.rotation,isRotator:"rotator"===i.anchor,onMouseEnter:this.handleAnchorMouseEnter,onMouseOut:this.handleAnchorMouseOut,onDragStart:this.handleAnchorDragStart,onDragEnd:this.handleAnchorDragEnd,onDragMove:this.handleAnchorDrag},i.anchor)}))}}componentDidUpdate(){gC.Instance.resetImageRatio()}static GetCursor(e,t){let i;switch(e){case"rotator":return"all-scroll";case"top":case"bottom":i=0;break;case"left":case"right":i=90;break;case"top-left":case"bottom-right":i=45;break;default:i=135}for(i+=t,i=45*Math.round(i/45);i<0;)i+=180;for(;i>=180;)i-=180;switch(i){case 45:return"nwse-resize";case 90:return"ew-resize";case 135:return"nesw-resize";default:return"ns-resize"}}render(){const e=this.props.region,t=this.props.frame;let i;const n=e.center;gC.Instance.imageRatio;if(t.spatialReference){const r=EW(Mm(t.spatialTransformAST,n,!1),t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current),o=e.getRegionApproximation(t.spatialTransformAST),s=o.length,a=new Array(2*s);for(let e=0;e<s;e++){const i=EW(o[e],t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);a[2*e]=i.x-r.x,a[2*e+1]=i.y-r.y}i=Object(xm.jsx)(oy.f,{x:r.x,y:r.y,stroke:e.color,strokeWidth:e.lineWidth,strokeScaleEnabled:!1,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],closed:!0,listening:this.props.listening&&!e.locked,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,perfectDrawEnabled:!1,lineJoin:"round",draggable:!0,points:a})}else{const r=e.size.x/devicePixelRatio,o=e.size.y/devicePixelRatio,s=e.rotation,a=EW(n,t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current),l={rotation:-s,x:a.x,y:a.y,stroke:e.color,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],draggable:!0,listening:this.props.listening&&!e.locked,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,perfectDrawEnabled:!1,strokeScaleEnabled:!1};i=e.regionType===Nt.RegionType.RECTANGLE?Object(xm.jsx)(oy.g,{...l,width:r*t.aspectRatio,height:o,offsetX:r*t.aspectRatio/2,offsetY:o/2}):Object(xm.jsx)(oy.c,{...l,radiusY:r,radiusX:o*t.aspectRatio})}return Object(xm.jsxs)(oy.d,{children:[i,this.props.selected&&this.props.listening&&!e.locked?this.genAnchors():null]})}},HW=Object(b.a)(qW.prototype,"handleAnchorDrag",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.currentTarget){const t=this.props.frame,i=this.props.region,n=e.evt,r=e.target,o=r.id(),s=MW(r.position(),this.props.stageRef.current);if(o.includes("rotator")){let e=PW(s.x,s.y,t,this.props.layerWidth,this.props.layerHeight);t.spatialReference&&(e=Mm(t.spatialTransformAST,e,!0));const n=nm(e,i.center),r=dm({x:0,y:1},i.rotation*Math.PI/180),o=180/Math.PI*ym(r,n);i.setRotation(i.rotation+o)}else{const e=n.shiftKey,t=n.ctrlKey||n.metaKey,a=this.props.isRegionCornerMode&&!t||!this.props.isRegionCornerMode&&t;if(a?this.applyCornerScaling(i,s.x,s.y,o):this.applyCenterScaling(i,s.x,s.y,o,e),"left"===o||"right"===o||"top"===o||"bottom"===o){const e=this.getDragBoundedAnchorPos(i,o,a);r.position(e)}if(e&&("top-left"===o||"bottom-left"===o||"top-right"===o||"bottom-right"===o)){const e=this.getDragBoundedDiagonalAnchorPos(i,o);r.position(e)}}}}}}),BW=qW))||BW;var UW,XW,$W,KW,QW,ZW,JW,eG,tG,iG,nG,rG;const oG=L.a.ROSE4;let sG=Object(p.a)((XW=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"hoverIndex",$W,this),Object(f.a)(this,"hoverIntersection",KW,this),this.previousCursorStyle=void 0,this.addControlPointTimer=void 0,this.handleContextMenu=e=>{e.evt.preventDefault()},this.handleDoubleClick=()=>{var e,t;clearTimeout(this.addControlPointTimer),null===(e=(t=this.props).onDoubleClick)||void 0===e||e.call(t,this.props.region)},Object(f.a)(this,"handleClick",QW,this),this.handleAnchorDragStart=()=>{var e,t;null===(e=(t=this.props).onSelect)||void 0===e||e.call(t,this.props.region),this.props.region.beginEditing()},this.handleAnchorDragEnd=()=>{this.props.region.endEditing()},Object(f.a)(this,"handleAnchorDrag",ZW,this),this.handleAnchorDoubleClick=e=>{const t=e.target;if(t){const e=t.index,i=this.props.region;if(e>=0&&e<i.controlPoints.length&&i.controlPoints.length>=4){const t=i.controlPoints.slice(0);t.splice(e,1),i.setControlPoints(t)}}},Object(f.a)(this,"handleStrokeMouseEnter",JW,this),Object(f.a)(this,"handleStrokeMouseLeave",eG,this),Object(f.a)(this,"handleMouseMove",tG,this),this.handleAnchorMouseEnter=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.getStage())&&(this.previousCursorStyle=e.target.getStage().container().style.cursor,e.target.getStage().container().style.cursor="move")},this.handleAnchorMouseOut=e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.getStage())&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)},Object(f.a)(this,"handleDragStart",iG,this),Object(f.a)(this,"handleDragEnd",nG,this),Object(f.a)(this,"handleDrag",rG,this),Object(m.p)(this)}componentDidUpdate(){gC.Instance.resetImageRatio()}anchorNode(e,t,i=0,n,r=!1){return Object(xm.jsx)(LW,{anchor:r?"rotator":`anchor-${n}`,x:e,y:t,rotation:i,isRotator:r,onMouseEnter:this.handleAnchorMouseEnter,onMouseOut:this.handleAnchorMouseOut,onDragStart:this.handleAnchorDragStart,onDragEnd:this.handleAnchorDragEnd,onDragMove:this.handleAnchorDrag,onDblClick:this.props.region.regionType===Nt.RegionType.LINE?null:this.handleAnchorDoubleClick},n)}render(){const e=this.props.region,t=this.props.frame;let i,n,r=90-e.rotation,o=e.controlPoints,s=null,a=null;gC.Instance.imageRatio;if(t.spatialReference){const l=cm(o);i=EW(Mm(t.spatialTransformAST,l,!1),t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);const c=e.getRegionApproximation(t.spatialTransformAST),d=c.length;n=new Array(2*d);for(let e=0;e<d;e++){const r=EW(c[e],t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);n[2*e]=r.x-i.x,n[2*e+1]=r.y-i.y}if(this.props.selected&&this.props.listening&&!e.locked&&(s=o.map(((e,i)=>{const n=EW(Mm(t.spatialTransformAST,e,!1),t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);return this.anchorNode(n.x,n.y,r,i)})),e.regionType===Nt.RegionType.LINE&&t.hasSquarePixels)){const e=1,t=r*Math.PI/180;s.push(this.anchorNode(i.x+e*Math.sin(t),i.y-e*Math.cos(t),r,2,!0))}if(this.hoverIntersection&&!e.locked){const e=EW(Mm(t.spatialTransformAST,this.hoverIntersection,!1),t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);a=Object(xm.jsx)(NW,{x:e.x,y:e.y,rotation:r})}r=180*-t.spatialTransform.rotation/Math.PI}else{if(o=o.map((e=>EW(e,t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current))),i=cm(o),this.props.selected&&this.props.listening&&!e.locked){s=new Array(o.length);for(let e=0;e<o.length;e++)s[e]=this.anchorNode(o[e].x,o[e].y,r,e);if(e.regionType===Nt.RegionType.LINE&&t.hasSquarePixels){const e=1,t=r*Math.PI/180;s.push(this.anchorNode(i.x+e*Math.sin(t),i.y-e*Math.cos(t),r,2,!0))}}if(this.hoverIntersection&&!e.locked){const e=EW(this.hoverIntersection,t,this.props.layerWidth,this.props.layerHeight,this.props.stageRef.current);a=Object(xm.jsx)(NW,{x:e.x,y:e.y,rotation:r})}n=new Array(2*o.length);for(let e=0;e<n.length/2;e++)n[2*e]=o[e].x-i.x,n[2*e+1]=o[e].y-i.y}return Object(xm.jsxs)(oy.d,{children:[Object(xm.jsx)(oy.f,{x:i.x,y:i.y,stroke:e.isSimplePolygon?e.color:oG,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],closed:!e.creating&&e.regionType===Nt.RegionType.POLYGON,listening:this.props.listening&&!e.locked,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onMouseEnter:e.regionType===Nt.RegionType.LINE?null:this.handleStrokeMouseEnter,onMouseLeave:e.regionType===Nt.RegionType.LINE?null:this.handleStrokeMouseLeave,onMouseMove:e.regionType===Nt.RegionType.LINE?null:this.handleMouseMove,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,perfectDrawEnabled:!1,strokeScaleEnabled:!1,lineJoin:"round",draggable:!0,points:n,hitStrokeWidth:32}),Object(xm.jsxs)(oy.d,{children:[s,a]})]})}},$W=Object(b.a)(XW.prototype,"hoverIndex",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),KW=Object(b.a)(XW.prototype,"hoverIntersection",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),QW=Object(b.a)(XW.prototype,"handleClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.evt;if(0===t.button&&!t.ctrlKey&&!t.metaKey){var i,n;const e=this.props.region;if(null===(i=(n=this.props).onSelect)||void 0===i||i.call(n,e),e.regionType!==Nt.RegionType.LINE&&this.hoverIntersection&&this.hoverIndex>=0&&this.hoverIndex<e.controlPoints.length){const t=e.controlPoints.slice(0);t.splice(this.hoverIndex+1,0,this.hoverIntersection),clearTimeout(this.addControlPointTimer),this.addControlPointTimer=setTimeout((()=>{e.setControlPoints(t,!0,!1),this.hoverIntersection=null}),300)}}}}}),ZW=Object(b.a)(XW.prototype,"handleAnchorDrag",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.currentTarget){const t=e.target,i=this.props.region,n=this.props.frame,r=t.index,o=t.id(),s=e.evt,a=MW(t.position(),this.props.stageRef.current);if(o.includes("rotator")){let e=PW(a.x,a.y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Mm(n.spatialTransformAST,e,!0));const t=nm(e,i.center),r=dm({x:1,y:0},i.rotation*Math.PI/180),o=180/Math.PI*ym(r,t);i.setRotation(i.rotation+o)}else if(r>=0&&r<i.controlPoints.length){let e=PW(a.x,a.y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Mm(n.spatialTransformAST,e,!0));const t=s.ctrlKey||s.metaKey;i.regionType!==Nt.RegionType.LINE||this.props.isRegionCornerMode&&!t||!this.props.isRegionCornerMode&&t?(i.setControlPoint(r,e),this.hoverIntersection=null):(0===r?i.setControlPoints([e,{x:2*i.center.x-e.x,y:2*i.center.y-e.y}]):i.setControlPoints([{x:2*i.center.x-e.x,y:2*i.center.y-e.y},e]),this.hoverIntersection=null)}}}}}),JW=Object(b.a)(XW.prototype,"handleStrokeMouseEnter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;(null===(t=e.target)||void 0===t?void 0:t.getStage())&&(this.previousCursorStyle=e.target.getStage().container().style.cursor),this.handleMouseMove(e)}}}),eG=Object(b.a)(XW.prototype,"handleStrokeMouseLeave",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;this.hoverIntersection=null,(null===(t=e.target)||void 0===t?void 0:t.getStage())&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)}}}),tG=Object(b.a)(XW.prototype,"handleMouseMove",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.evt,i=this.props.region,n=this.props.frame;if(this.props.selected&&i.controlPoints.length>=2){let s=PW(t.offsetX,t.offsetY,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(s=Mm(n.spatialTransformAST,s,!0));let a=Number.MAX_VALUE,l=-1,c=null;for(let e=0;e<(i.regionType===Nt.RegionType.POLYLINE?i.controlPoints.length-1:i.controlPoints.length);e++){const t=um(s,i.controlPoints[e],i.controlPoints[(e+1)%i.controlPoints.length]);t.bounded&&t.distance<a&&(a=t.distance,c=t.point,l=e)}var r,o;if(l>=0&&a<=16)this.hoverIntersection=c,this.hoverIndex=l,(null===(r=e.target)||void 0===r?void 0:r.getStage())&&(e.target.getStage().container().style.cursor="crosshair");else this.hoverIntersection=null,(null===(o=e.target)||void 0===o?void 0:o.getStage())&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)}}}}),iG=Object(b.a)(XW.prototype,"handleDragStart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e,t;null===(e=(t=this.props).onSelect)||void 0===e||e.call(t,this.props.region),this.props.region.beginEditing(),this.hoverIntersection=null}}}),nG=Object(b.a)(XW.prototype,"handleDragEnd",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.props.region.endEditing()}}}),rG=Object(b.a)(XW.prototype,"handleDrag",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.target){const t=this.props.region,i=this.props.frame,n=cm(t.controlPoints),r=MW(e.target.position(),this.props.stageRef.current);let o=PW(r.x,r.y,i,this.props.layerWidth,this.props.layerHeight);i.spatialReference&&(o=Mm(i.spatialTransformAST,o,!0));const s=nm(o,n),a=t.controlPoints.map((e=>im(e,s)));t.setControlPoints(a,!1,!1)}}}}),UW=XW))||UW;var aG,lG,cG,dG,pG,hG,uG,gG,fG,bG,mG;i(872);let yG=Object(p.a)((lG=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"creatingRegion",cG,this),Object(f.a)(this,"currentCursorPos",dG,this),this.stageRef=void 0,this.stageResizeOffset=void 0,this.regionStartPoint=void 0,this.mousePreviousClick={x:-1e3,y:-1e3},this.mouseClickDistance=0,this.dragPanning=void 0,this.initialStagePosition=void 0,this.initialDragCenter=void 0,this.initialPinchZoom=void 0,this.initialPinchDistance=void 0,this.layerRef=n.createRef(),this.updateCursorPos=T.throttle(((e,t)=>{const i=this.props.frame;if(i.wcsInfo){const n=PW(e,t,i,this.props.width,this.props.height);this.props.frame.setCursorPosition(n)}}),100),this.updateDistanceMeasureFinishPos=T.throttle(((e,t)=>{const i=this.props.frame;i.distanceMeasuring.finish=this.getDistanceMeasureImagePos(e,t),i.distanceMeasuring.updateTransformedPos(i.spatialTransform)}),100),this.getCursorPosImageSpace=(e,t)=>{const i=this.props.frame;let n=PW(e,t,i,this.props.width,this.props.height);return i.spatialReference&&(n=Mm(i.spatialTransformAST,n,!0)),n},this.getDistanceMeasureImagePos=(e,t)=>{var i,n;const r=this.props.frame,o=r.spatialReference?r.spatialReference.requiredFrameView:r.requiredFrameView,s=null!==(i=null===(n=r.spatialReference)||void 0===n?void 0:n.spatialTransform)&&void 0!==i?i:r.spatialTransform;let a=RW(e,t,o,this.props.width,this.props.height,s);return r.spatialReference&&(a=r.spatialTransform.transformCoordinate(a,!1)),a},Object(f.a)(this,"regionCreationStart",pG,this),Object(f.a)(this,"regionCreationEnd",hG,this),Object(f.a)(this,"polygonRegionAddPoint",uG,this),Object(f.a)(this,"polygonRegionCreating",gG,this),this.handleDragStart=e=>{if(e.target===e.currentTarget&&this.props.dragPanningEnabled&&(this.dragPanning=!0,this.props.frame)){const t=this.props.frame.spatialReference||this.props.frame,i=e.target.getStage().getPosition();this.initialStagePosition=i,this.initialDragCenter=t.center,t.startMoving()}},this.handleDragMove=e=>{if(e.target===e.currentTarget){let t=!0;if("touchmove"===e.evt.type){const i=e.evt;if(i.touches.length>1&&i.target){t=!1;const e=i.target.getBoundingClientRect(),n={x:i.touches[0].pageX-e.left,y:i.touches[0].pageY-e.top},r={x:i.touches[1].pageX-e.left,y:i.touches[1].pageY-e.top};this.handlePinch(n,r)}else this.initialPinchDistance=-1,this.initialPinchZoom=-1}if(t){const t=e.target.getStage().getPosition();this.handlePan(t)}}},this.handleDragEnd=e=>{if(e.target===e.currentTarget){this.dragPanning=!1;const e=this.props.frame;e&&e.endMoving()}this.initialPinchDistance=-1,this.initialPinchZoom=-1},this.handlePinch=(e,t)=>{const i=this.props.frame;if(!i||!e||!t)return;const n=sm(nm(t,e)),r=cm([e,t]);if(isFinite(n)&&!(n<=0))if(this.initialPinchDistance>0){const e=n/this.initialPinchDistance,t=RW(r.x,r.y,i.requiredFrameView,this.props.width,this.props.height);i.zoomToPoint(t.x,t.y,this.initialPinchZoom*e)}else this.initialPinchDistance=n,this.initialPinchZoom=i.zoomLevel},this.handlePan=e=>{if(e&&isFinite(e.x)&&isFinite(e.y)&&this.props.frame){const t=this.props.frame.spatialReference||this.props.frame,i=nm(e,this.initialStagePosition),n=nm(AW(this.initialDragCenter.x,this.initialDragCenter.y,t.requiredFrameView,this.props.width,this.props.height),i),r=RW(n.x,n.y,t.requiredFrameView,this.props.width,this.props.height);t.setCenter(r.x,r.y)}},this.handleClick=e=>{var t,i;const n=e.evt,r=this.props.frame,o=0!==n.button||n.ctrlKey||n.metaKey;if(this.mouseClickDistance=mm(n,this.mousePreviousClick),this.mousePreviousClick={x:n.x,y:n.y},(e.target===e.currentTarget||o)&&(r.regionSet.mode!==Vb.CREATING||0!==n.button)){if(r.wcsInfo&&(null===(t=gC.Instance)||void 0===t?void 0:t.activeLayer)===_G.DistanceMeasuring&&!o){const e=this.getDistanceMeasureImagePos(n.offsetX,n.offsetY);if(!zm(Mm(r.wcsInfo,e))){const t=r.distanceMeasuring;t.isCreating||t.showCurve?t.isCreating?(t.finish=e,t.updateTransformedPos(r.spatialTransform),t.setIsCreating(!1)):(t.resetPos(),t.start=e,t.setIsCreating(!0)):(t.start=e,t.setIsCreating(!0))}}if(this.props.dragPanningEnabled&&!o&&r.regionSet.deselectRegion(),r.wcsInfo&&this.props.onClickToCenter&&(!this.props.dragPanningEnabled&&(null===(i=gC.Instance)||void 0===i?void 0:i.activeLayer)!==_G.DistanceMeasuring||o)){const e=PW(n.offsetX,n.offsetY,r,this.props.width,this.props.height);this.props.onClickToCenter(r.getCursorInfo(e))}}},this.syncStage=(e,t)=>{const i=this.stageRef.current;if(i&&e&&isFinite(e.x)&&isFinite(e.y)&&isFinite(t)){i.scale({x:t/gC.Instance.imageRatio,y:t/gC.Instance.imageRatio});const n=nm(im(om({x:this.props.width/2,y:this.props.height/2},1-t),om({x:e.x,y:-e.y},t/devicePixelRatio)),om(this.stageResizeOffset,t));i.position(n)}},this.centerStage=()=>{const e=this.stageRef.current;if(e){const t=e.scaleX(),i=nm(om({x:this.props.width/2,y:this.props.height/2},1-t),om(this.stageResizeOffset,t));e.position(i)}},this.stageZoomToPoint=(e,t,i)=>{const n=this.stageRef.current;if(n){const r=n.scaleX(),o=n.getPosition(),s={x:(e-o.x)/r,y:(t-o.y)/r},a={x:e-s.x*i,y:t-s.y*i};n.scale({x:i,y:i}),n.position(a)}},this.handleWheel=e=>{const t=e.evt,i=this.props.frame;if(i){const e=PW(t.offsetX,t.offsetY,i,this.props.width,this.props.height),n=this.props.frame.getCursorInfo(e),r=-t.deltaY*(t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?1:15),o=1+Math.abs(r/750),s=(i.spatialReference?i.spatialReference.zoomLevel:i.zoomLevel)*(r>0?o:1/o);i.zoomToPoint(n.posImageSpace.x,n.posImageSpace.y,s,!0);const a=JA.Instance.zoomPoint===Ei.CURSOR?{x:t.offsetX,y:t.offsetY}:{x:this.props.width/2,y:this.props.height/2};this.stageZoomToPoint(a.x,a.y,s)}},this.handleMouseDown=e=>{switch(this.props.frame.regionSet.newRegionType){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:case Nt.RegionType.LINE:this.regionCreationStart(e.evt);break;case Nt.RegionType.POINT:this.regionCreationStart(e.evt),this.regionCreationEnd()}},this.handleMouseUp=e=>{switch(this.dragPanning=!1,this.props.frame.regionSet.newRegionType){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:case Nt.RegionType.LINE:this.regionCreationEnd();break;case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:this.creatingRegion?this.polygonRegionAddPoint(e.evt):this.regionCreationStart(e.evt)}},this.handleMove=e=>{const t=e.evt;if(this.props.dragPanningEnabled&&this.dragPanning)return;const i=this.props.frame;var n;if(i.regionSet.mode===Vb.CREATING&&this.creatingRegion)switch(this.creatingRegion.regionType){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:case Nt.RegionType.LINE:this.RegionCreating(t);break;case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:this.polygonRegionCreating(t)}else i.wcsInfo&&(null===(n=gC.Instance)||void 0===n?void 0:n.activeLayer)===_G.DistanceMeasuring&&i.distanceMeasuring.isCreating&&this.updateDistanceMeasureFinishPos(t.offsetX,t.offsetY),gC.Instance.cursorFrozen||(this.updateCursorPos(t.offsetX,t.offsetY),this.props.frame!==gC.Instance.hoveredFrame&&gC.Instance.setHoveredFrame(this.props.frame))},Object(f.a)(this,"handleStageDoubleClick",fG,this),Object(f.a)(this,"onKeyDown",bG,this),Object(m.p)(this),this.stageRef=n.createRef(),this.stageResizeOffset={x:0,y:0},Object(m.s)((()=>{var e;return null===(e=this.props.frame)||void 0===e?void 0:e.spatialReference}),(e=>{e&&this.syncStage(e.centerMovement,e.zoomLevel)})),Object(m.s)((()=>{const e=this.props.frame;if(e)return e.spatialReference?{centerMovement:e.spatialReference.centerMovement,zoom:e.spatialReference.zoomLevel}:{centerMovement:e.centerMovement,zoom:e.zoomLevel}}),((e,t)=>{var i,n;const r=this.props.frame;e&&(e.centerMovement.x!==(null===t||void 0===t||null===(i=t.centerMovement)||void 0===i?void 0:i.x)||e.centerMovement.y!==(null===t||void 0===t||null===(n=t.centerMovement)||void 0===n?void 0:n.y)||e.zoom!==(null===t||void 0===t?void 0:t.zoom))&&r&&this.syncStage(e.centerMovement,e.zoom)}))}componentDidMount(){var e,t;const i=null!==(e=null===(t=this.props.frame)||void 0===t?void 0:t.spatialReference)&&void 0!==e?e:this.props.frame;i&&this.syncStage(i.centerMovement,i.zoomLevel)}componentDidUpdate(e){if(e.width!==this.props.width||e.height!==this.props.height){const t=this.stageRef.current;if(t){const i={x:(this.props.width-e.width)/2,y:(this.props.height-e.height)/2},n=t.scaleX(),r=om(i,(1-n)/n);this.stageResizeOffset=im(this.stageResizeOffset,r)}}}RegionCreating(e){if(!this.creatingRegion)return;const t=this.getCursorPosImageSpace(e.offsetX,e.offsetY);let i=t.x-this.regionStartPoint.x,n=t.y-this.regionStartPoint.y;if(e.shiftKey&&this.creatingRegion.regionType!==Nt.RegionType.LINE){const e=Math.max(Math.abs(i),Math.abs(n));i=Math.sign(i)*e,n=Math.sign(n)*e}const r=e.ctrlKey||e.metaKey,o=gC.Instance.preferenceStore.isRegionCornerMode;if(o&&!r||!o&&r){const e={x:this.regionStartPoint.x+i,y:this.regionStartPoint.y+n},r={x:(this.regionStartPoint.x+e.x)/2,y:(this.regionStartPoint.y+e.y)/2};switch(this.creatingRegion.regionType){case Nt.RegionType.RECTANGLE:this.creatingRegion.setControlPoints([r,{x:Math.abs(i),y:Math.abs(n)}]);break;case Nt.RegionType.ELLIPSE:this.creatingRegion.setControlPoints([r,{y:Math.abs(i)/2,x:Math.abs(n)/2}]);break;case Nt.RegionType.LINE:this.creatingRegion.setControlPoints([this.regionStartPoint,t])}}else switch(this.creatingRegion.regionType){case Nt.RegionType.RECTANGLE:this.creatingRegion.setControlPoints([this.regionStartPoint,{x:2*Math.abs(i),y:2*Math.abs(n)}]);break;case Nt.RegionType.ELLIPSE:this.creatingRegion.setControlPoints([this.regionStartPoint,{y:Math.abs(i),x:Math.abs(n)}]);break;case Nt.RegionType.LINE:this.creatingRegion.setControlPoints([{x:t.x-2*i,y:t.y-2*n},t])}}render(){var e,t,i,n;const r=this.props.frame,o=r.regionSet,s=d()("region-stage",{docked:this.props.docked});gC.Instance.updateLayerPixelRatio(this.layerRef);let a,l=null;if(this.currentCursorPos&&((null===(e=this.creatingRegion)||void 0===e?void 0:e.regionType)===Nt.RegionType.POLYGON||(null===(t=this.creatingRegion)||void 0===t?void 0:t.regionType)===Nt.RegionType.POLYLINE)&&this.creatingRegion.isValid){var c;let e=this.creatingRegion.controlPoints[0],t=this.creatingRegion.controlPoints[this.creatingRegion.controlPoints.length-1];r.spatialReference&&(e=Mm(r.spatialTransformAST,e,!1),t=Mm(r.spatialTransformAST,t,!1));const i=EW(e,r,this.props.width,this.props.height,this.stageRef.current),n=EW(t,r,this.props.width,this.props.height,this.stageRef.current),o=function(e,t){const i=null===t||void 0===t?void 0:t.getPosition(),n=null===t||void 0===t?void 0:t.scaleX();if(e&&i&&isFinite(n))return{x:(e.x-i.x)/n,y:(e.y-i.y)/n}}(this.currentCursorPos,this.stageRef.current);let s;s=this.creatingRegion.controlPoints.length>1&&(null===(c=this.creatingRegion)||void 0===c?void 0:c.regionType)!==Nt.RegionType.POLYLINE?[i.x,i.y,o.x,o.y,n.x,n.y]:[n.x,n.y,o.x,o.y],l=Object(xm.jsx)(oy.f,{points:s,dash:[5],stroke:this.creatingRegion.color,strokeWidth:this.creatingRegion.lineWidth,strokeScaleEnabled:!1,opacity:.5,lineJoin:"round",listening:!1,perfectDrawEnabled:!1})}return o.mode===Vb.CREATING||(null===(i=gC.Instance)||void 0===i?void 0:i.activeLayer)===_G.DistanceMeasuring?a="crosshair":o.selectedRegion&&o.selectedRegion.editing?a="move":o.selectedRegion!==o.regions[0]&&o.selectedRegion||(a="default"),Object(xm.jsx)("div",{onKeyDown:this.onKeyDown,tabIndex:0,children:Object(xm.jsx)(oy.j,{ref:this.stageRef,className:s,width:this.props.width,height:this.props.height,style:{left:this.props.left,top:this.props.top,cursor:a},onClick:this.handleClick,onWheel:this.handleWheel,onMouseMove:this.handleMove,onDblClick:this.handleStageDoubleClick,onMouseDown:o.mode===Vb.CREATING?this.handleMouseDown:null,onMouseUp:o.mode===Vb.CREATING?this.handleMouseUp:null,draggable:o.mode!==Vb.CREATING&&this.props.dragPanningEnabled,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd,x:0,y:0,children:Object(xm.jsxs)(oy.e,{ref:this.layerRef,children:[Object(xm.jsx)(OG,{frame:r,regions:null===r||void 0===r||null===(n=r.regionSet)||void 0===n?void 0:n.regionsForRender,width:this.props.width,height:this.props.height,stageRef:this.stageRef}),Object(xm.jsx)(VW,{frame:r,width:this.props.width,height:this.props.height,stageRef:this.stageRef}),l]})})})}},cG=Object(b.a)(lG.prototype,"creatingRegion",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dG=Object(b.a)(lG.prototype,"currentCursorPos",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pG=Object(b.a)(lG.prototype,"regionCreationStart",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.creatingRegion)return;const t=this.props.frame,i=t.regionSet.newRegionType,n=this.getCursorPosImageSpace(e.offsetX,e.offsetY);switch(i){case Nt.RegionType.POINT:this.creatingRegion=t.regionSet.addPointRegion(n,!1),this.regionStartPoint=n;break;case Nt.RegionType.RECTANGLE:this.creatingRegion=t.regionSet.addRectangularRegion(n,0,0,!0),this.regionStartPoint=n;break;case Nt.RegionType.ELLIPSE:this.creatingRegion=t.regionSet.addEllipticalRegion(n,0,0,!0),this.regionStartPoint=n;break;case Nt.RegionType.POLYGON:this.creatingRegion=t.regionSet.addPolygonalRegion([n],!0),this.polygonRegionCreating(e);break;case Nt.RegionType.LINE:this.creatingRegion=t.regionSet.addLineRegion([n,n],!0),this.regionStartPoint=n;break;case Nt.RegionType.POLYLINE:this.creatingRegion=t.regionSet.addPolylineRegion([n],!0),this.polygonRegionCreating(e);break;default:return}this.creatingRegion.beginCreating()}}}),hG=Object(b.a)(lG.prototype,"regionCreationEnd",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{let t=this.props.frame;if(!this.creatingRegion||t.regionSet.mode!==Vb.CREATING)return;const i=this.props.frame.regionSet.newRegionType;switch(i){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:case Nt.RegionType.LINE:if(t=this.props.frame.spatialReference||this.props.frame,this.creatingRegion.controlPoints.length>1&&0===sm(this.creatingRegion.size)){const e=JA.Instance.regionSize*(this.creatingRegion.regionType===Nt.RegionType.RECTANGLE?1:.5)/t.zoomLevel;this.creatingRegion.setSize(om(this.creatingRegion.regionType===Nt.RegionType.LINE?{x:2,y:0}:{x:1,y:1},e))}break;case Nt.RegionType.POINT:case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:break;default:return}this.creatingRegion.isValid&&(i!==Nt.RegionType.POLYGON&&i!==Nt.RegionType.POLYLINE||this.creatingRegion.controlPoints.length>2)&&(i!==Nt.RegionType.LINE||2===this.creatingRegion.controlPoints.length)?(this.creatingRegion.endCreating(),t.regionSet.selectRegion(this.creatingRegion)):t.regionSet.deleteRegion(this.creatingRegion),i===Nt.RegionType.POLYGON||i===Nt.RegionType.POLYLINE?setTimeout((()=>{this.creatingRegion=null}),1):this.creatingRegion=null,setTimeout((()=>{this.props.frame.regionSet.setMode(Vb.MOVING),gC.Instance.updateActiveLayer(_G.RegionMoving)}),1)}}}),uG=Object(b.a)(lG.prototype,"polygonRegionAddPoint",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!this.creatingRegion)return;const t=this.getCursorPosImageSpace(e.offsetX,e.offsetY);if(this.creatingRegion.controlPoints.length){const e=this.creatingRegion.controlPoints[this.creatingRegion.controlPoints.length-1];(Math.abs(e.x-t.x)>.01||Math.abs(e.y-t.y)>.01)&&this.creatingRegion.setControlPoints([...this.creatingRegion.controlPoints,t])}this.polygonRegionCreating(e)}}}),gG=Object(b.a)(lG.prototype,"polygonRegionCreating",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.currentCursorPos={x:e.offsetX,y:e.offsetY}}}}),fG=Object(b.a)(lG.prototype,"handleStageDoubleClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t,i;this.mouseClickDistance>25||(null===(t=this.creatingRegion)||void 0===t?void 0:t.regionType)!==Nt.RegionType.POLYGON&&(null===(i=this.creatingRegion)||void 0===i?void 0:i.regionType)!==Nt.RegionType.POLYLINE||this.regionCreationEnd()}}}),bG=Object(b.a)(lG.prototype,"onKeyDown",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;t&&t.regionSet.mode===Vb.CREATING&&this.creatingRegion&&27===e.keyCode&&(t.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null,t.regionSet.setMode(Vb.MOVING),gC.Instance.updateActiveLayer(_G.RegionMoving))}}}),aG=lG))||aG,OG=Object(p.a)(mG=class extends n.Component{constructor(...e){super(...e),this.handleRegionDoubleClicked=e=>{const t=gC.Instance;if(e){const i=t.getFrame(e.fileId);i&&(i.regionSet.selectRegion(e),t.dialogStore.showRegionDialog())}}}render(){const e=this.props.regions;if(!gC.Instance.fileBrowserStore.isLoadingDialogOpen&&(null===e||void 0===e?void 0:e.length)){var t;const i=null===(t=this.props.frame)||void 0===t?void 0:t.regionSet;return e.map((e=>{const t={key:e.regionId,region:e,frame:this.props.frame,layerWidth:this.props.width,layerHeight:this.props.height,stageRef:this.props.stageRef,selected:e===i.selectedRegion,onSelect:i.selectRegion,onDoubleClick:this.handleRegionDoubleClicked};if(e.regionType===Nt.RegionType.POINT)return Object(xm.jsx)(GW,{...t});{var n;const r={...t,listening:i.mode!==Vb.CREATING&&(null===(n=gC.Instance)||void 0===n?void 0:n.activeLayer)!==_G.DistanceMeasuring,isRegionCornerMode:gC.Instance.preferenceStore.isRegionCornerMode};return e.regionType===Nt.RegionType.POLYGON||e.regionType===Nt.RegionType.LINE||e.regionType===Nt.RegionType.POLYLINE?Object(xm.jsx)(sG,{...r}):Object(xm.jsx)(YW,{...r})}}))}return null}})||mG;var jG;i(873);let xG=Object(p.a)(jG=class extends n.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.contourWebGLService=void 0,this.updateCanvas=()=>{const e=gC.Instance,t=this.props.frame;if(t&&this.canvas&&this.gl&&this.contourWebGLService.shaderUniforms){e.setCanvasUpdated();const i=e.contourFrames.get(t);if(this.resizeAndClearCanvas(),i)for(let e=i.length-1;e>=0;--e)this.renderFrameContours(i[e],t);const n=this.canvas.getContext("2d"),r=this.canvas.width,o=this.canvas.height;n.clearRect(0,0,r,o),n.drawImage(this.gl.canvas,this.props.column*r,this.props.row*o,r,o,0,0,r,o)}},this.renderFrameContours=(e,t)=>{const i=devicePixelRatio*gC.Instance.imageRatio,n=e===t;let r,o;if(t.spatialReference){const n=t.spatialReference.requiredFrameView,s={x:1/(n.xMax-n.xMin),y:1/(n.yMax-n.yMin)},a=nm(t.spatialTransform.origin,om(dm(t.spatialTransform.origin,t.spatialTransform.rotation),t.spatialTransform.scale)),l={x:(t.spatialTransform.translation.x-n.xMin+a.x)*s.x,y:(t.spatialTransform.translation.y-n.yMin+a.y)*s.y};this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeScale,s.x,s.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeOffset,l.x,l.y),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.RotationAngle,-t.spatialTransform.rotation),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.ScaleAdjustment,t.spatialTransform.scale),r=i*e.contourConfig.thickness/(t.spatialReference.zoomLevel*t.spatialTransform.scale),o=Ki(1/t.spatialReference.zoomLevel,3)}else{const n=t.requiredFrameView,s={x:1/(n.xMax-n.xMin),y:1/(n.yMax-n.yMin)},a={x:-n.xMin*s.x,y:-n.yMin*s.y};this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeOffset,a.x,a.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeScale,s.x,s.y),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.RotationAngle,0),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.ScaleAdjustment,1),r=i*e.contourConfig.thickness/t.zoomLevel,o=Ki(1/t.zoomLevel,3)}if(n)this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapEnabled,0),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapTexture,0);else{const i=e.getControlMap(t);i?(this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapEnabled,1),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapMin,i.minPoint.x,i.minPoint.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapMax,i.maxPoint.x,i.maxPoint.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapSize,i.width,i.height)):console.error("Could not generate control map for contours"),this.gl.activeTexture(vm.TEXTURE1),this.gl.bindTexture(vm.TEXTURE_2D,i.getTextureX(this.gl)),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapTexture,1)}if(this.gl.uniform1f(this.contourWebGLService.shaderUniforms.LineThickness,r),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.PixelRatio,e.aspectRatio),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.CmapEnabled,e.contourConfig.colormapEnabled?1:0),e.contourConfig.colormapEnabled&&(this.gl.uniform1i(this.contourWebGLService.shaderUniforms.CmapIndex,Af.COLOR_MAPS_ALL.indexOf(e.contourConfig.colormap)),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.Bias,e.contourConfig.colormapBias),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.Contrast,e.contourConfig.colormapContrast)),e.contourStores){const t=[];e.contourStores.forEach(((e,i)=>t.push(i)));const n=Math.min(...t),r=Math.max(...t),s=e.contourConfig.color;s?this.gl.uniform4f(this.contourWebGLService.shaderUniforms.LineColor,s.r/255,s.g/255,s.b/255,s.a||1):this.gl.uniform4f(this.contourWebGLService.shaderUniforms.LineColor,1,1,1,1),e.contourStores.forEach(((t,s)=>{if(e.contourConfig.colormapEnabled){let e;e=n!==r?(s-n)/(r-n):1,this.gl.uniform1f(this.contourWebGLService.shaderUniforms.CmapValue,e)}const a=e.contourConfig.dashMode,l=a===Se.Dashed||a===Se.NegativeOnly&&s<0?8:0;this.gl.uniform1f(this.contourWebGLService.shaderUniforms.DashLength,i*l*o);for(let e=0;e<t.chunkCount;e++){t.bindBuffer(e);const i=t.numGeneratedVertices[e];this.gl.vertexAttribPointer(this.contourWebGLService.vertexPositionAttribute,3,vm.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.contourWebGLService.vertexNormalAttribute,2,vm.SHORT,!1,16,12),this.gl.drawArrays(vm.TRIANGLE_STRIP,0,i)}}))}},this.getRef=e=>{this.canvas=e}}componentDidMount(){this.contourWebGLService=xx.Instance,this.gl=this.contourWebGLService.gl,this.canvas&&this.updateCanvas()}componentDidUpdate(){gC.Instance.resetImageRatio(),requestAnimationFrame(this.updateCanvas)}resizeAndClearCanvas(){const e=this.props.frame;if(!e)return;const t=gC.Instance,i=devicePixelRatio*t.imageRatio,n=Math.max(1,e.renderWidth*i),r=Math.max(1,e.renderHeight*i);!(null===e||void 0===e?void 0:e.isRenderable)||this.canvas.width===n&&this.canvas.height===r||(this.canvas.width=n,this.canvas.height=r),this.contourWebGLService.setCanvasSize(n*t.numImageColumns,r*t.numImageRows),this.canvas.width===n&&this.canvas.height===r||(this.canvas.width=n,this.canvas.height=r);const o=this.props.column*e.renderWidth*i,s=(t.numImageRows-1-this.props.row)*e.renderHeight*i;this.gl.viewport(o,s,e.renderWidth*i,e.renderHeight*i),this.gl.clearColor(0,0,0,0),this.gl.enable(vm.SCISSOR_TEST),this.gl.scissor(o,s,e.renderWidth*i,e.renderHeight*i);const a=vm.COLOR_BUFFER_BIT|vm.DEPTH_BUFFER_BIT|vm.STENCIL_BUFFER_BIT;this.gl.clear(a),this.gl.disable(vm.SCISSOR_TEST)}render(){const e=gC.Instance,t=this.props.frame;if(t){t.requiredFrameView}const i=e.contourFrames.get(t);if(i)for(const o of i){const e=o.contourConfig;e.thickness,e.colormapEnabled?e.colormap:e.color,e.dashMode,e.colormapBias,e.colormapContrast;o.contourStores.forEach((e=>{e.vertexCount}))}const n=e.overlayStore.padding,r=d()("contour-div",{docked:this.props.docked});return Object(xm.jsx)("div",{className:r,children:Object(xm.jsx)("canvas",{id:"contour-canvas",className:"contour-canvas",ref:this.getRef,style:{top:n.top,left:n.left,width:t&&t.renderWidth||1,height:t&&t.renderHeight||1}})})}})||jG;var SG;i(874);let vG=Object(p.a)(SG=class extends n.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.catalogWebGLService=void 0,this.getRef=e=>{this.canvas=e},this.updateCanvas=()=>{if(this.props.frame&&this.canvas&&this.gl&&this.catalogWebGLService.shaderUniforms){this.resizeAndClearCanvas(),this.renderCatalog();const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.drawImage(this.gl.canvas,0,0,this.canvas.width,this.canvas.height)}},this.onClick=e=>{var t;const i=e.nativeEvent,n=hM.Instance;let r={fileId:void 0,minIndex:void 0,minDistanceSquared:Number.MAX_VALUE};if(null===(t=n.catalogGLData)||void 0===t||t.forEach(((e,t)=>{const o=gC.Instance.getFrame(n.getFrameIdByCatalogId(t)),s=function(e,t,i){let n=Number.MAX_VALUE,r=0;for(let o=0;o<t.length;o++){const s=mm(e,{x:t[o],y:i[o]});s<n&&(n=s,r=o)}return{minIndex:r,minDistanceSquared:n}}(PW(i.offsetX,i.offsetY,o,o.renderWidth,o.renderHeight),e.x,e.y);s.minDistanceSquared<r.minDistanceSquared&&(r.minIndex=s.minIndex,r.minDistanceSquared=s.minDistanceSquared,r.fileId=t)})),void 0!==r.fileId&&void 0!==r.minIndex){const e=n.catalogProfileStores.get(r.fileId),t=n.catalogWidgets.get(r.fileId),i=WP.Instance.catalogWidgets.get(t);n.updateCatalogProfiles(r.fileId);const o=e.getOriginIndices([r.minIndex]);e.setSelectedPointIndices(o,!1),i.setCatalogTableAutoScroll(!0)}}}componentDidMount(){this.catalogWebGLService=Tx.Instance,this.gl=this.catalogWebGLService.gl,this.canvas&&this.updateCanvas()}componentDidUpdate(){gC.Instance.resetImageRatio(),requestAnimationFrame(this.updateCanvas)}render(){const e=gC.Instance,t=this.props.frame;if(t){t.requiredFrameView}const i=e.catalogStore;i.visibleCatalogFiles.get(t);i.catalogGLData.forEach(((e,t)=>{var n;const r=i.getCatalogWidgetStore(t);i.catalogCounts.get(t),null===(n=i.catalogProfileStores.get(t))||void 0===n||n.selectedPointIndices.length,r.showSelectedData,r.catalogColor,r.highlightColor,r.catalogSize,r.catalogShape,r.thickness,r.sizeMapColumn,r.sizeMax.area,r.sizeMin.area,r.sizeMax.diameter,r.sizeMin.diameter,r.sizeColumnMax.clipd,r.sizeColumnMin.clipd,r.sizeArea,r.sizeScalingType,r.sizeMinorMapColumn,r.sizeMinorColumnMax.clipd,r.sizeMinorColumnMin.clipd,r.sizeMinorArea,r.sizeMinorScalingType,r.colorMapColumn,r.colorMap,r.colorScalingType,r.invertedColorMap,r.colorColumnMax.clipd,r.colorColumnMin.clipd,r.orientationMapColumn,r.orientationScalingType,r.angleMax,r.angleMin,r.orientationMax.clipd,r.orientationMin.clipd}));const n=e.overlayStore.padding,r=d()("catalog-div",{docked:this.props.docked,active:e.activeLayer===_G.Catalog});return Object(xm.jsx)("div",{className:r,children:Object(xm.jsx)("canvas",{id:"catalog-canvas",className:"catalog-canvas",ref:this.getRef,onClick:e=>this.onClick(e),onDoubleClick:this.onDoubleClick,style:{top:n.top,left:n.left,width:t&&t.renderWidth||1,height:t&&t.renderHeight||1}})})}resizeAndClearCanvas(){const e=this.props.frame;if(!e)return;const t=Math.round(Math.max(1,e.renderWidth*devicePixelRatio*gC.Instance.imageRatio)),i=Math.round(Math.max(1,e.renderHeight*devicePixelRatio*gC.Instance.imageRatio));this.canvas.width===t&&this.canvas.height===i||(this.canvas.width=t,this.canvas.height=i,this.catalogWebGLService.setCanvasSize(t,i)),this.gl.clearColor(0,0,0,0);const n=vm.COLOR_BUFFER_BIT|vm.DEPTH_BUFFER_BIT|vm.STENCIL_BUFFER_BIT;this.gl.clear(n)}renderCatalog(){var e;const t=gC.Instance,i=hM.Instance;this.gl.enable(vm.BLEND),this.gl.blendFunc(vm.SRC_ALPHA,vm.ONE_MINUS_SRC_ALPHA),this.gl.enable(vm.DEPTH_TEST),this.gl.depthFunc(vm.LEQUAL),this.gl.clear(vm.COLOR_BUFFER_BIT|vm.DEPTH_BUFFER_BIT);const n=this.catalogWebGLService.shaderUniforms;let r={x:1,y:1},o={x:0,y:0},s=0,a=1;const l=this.props.frame;null===(e=i.visibleCatalogFiles.get(l))||void 0===e||e.forEach((e=>{const c=i.catalogGLData.get(e),d=i.getCatalogWidgetStore(e),p=i.catalogCounts.get(e);if(c&&d&&p>0){const c=t.getFrame(i.getFrameIdByCatalogId(e)),h=c===l,u=d.shapeSettings,g=u.featherWidth*devicePixelRatio*gC.Instance.imageRatio,f=d.thickness*u.thicknessBase*devicePixelRatio*gC.Instance.imageRatio;let b=je()(d.catalogColor).toRgb(),m=je()(d.highlightColor).toRgb(),y=d.catalogSize+u.diameterBase;this.gl.uniform1f(n.LineThickness,f),this.gl.uniform1i(n.ShowSelectedSource,d.showSelectedData?1:0);let O=c;if(h||(O=l),O.spatialReference){const e=O.spatialReference.requiredFrameView,t=nm(O.spatialTransform.origin,om(dm(O.spatialTransform.origin,O.spatialTransform.rotation),O.spatialTransform.scale));r={x:1/(e.xMax-e.xMin),y:1/(e.yMax-e.yMin)},o={x:(O.spatialTransform.translation.x-e.xMin+t.x)*r.x,y:(O.spatialTransform.translation.y-e.yMin+t.y)*r.y},s=-O.spatialTransform.rotation,a=O.spatialTransform.scale}else{let e=O.requiredFrameView;r={x:1/(e.xMax-e.xMin),y:1/(e.yMax-e.yMin)},o={x:-e.xMin*r.x,y:-e.yMin*r.y},s=0,a=1}this.gl.uniform2f(n.RangeOffset,o.x,o.y),this.gl.uniform2f(n.RangeScale,r.x,r.y),this.gl.uniform1f(n.ScaleAdjustment,a),this.gl.uniform1f(n.RotationAngle,s),this.gl.uniform1i(n.SizeMajorMapEnabled,0),this.gl.uniform1i(n.AreaMode,d.sizeArea?1:0);const j=this.catalogWebGLService.getDataTexture(e,Ix.Size);!d.disableSizeMap&&j&&(this.gl.uniform1i(n.SizeMajorMapEnabled,1),this.gl.activeTexture(vm.TEXTURE2),this.gl.bindTexture(vm.TEXTURE_2D,j),this.gl.uniform1i(n.SizeTexture,2)),this.gl.uniform1i(n.CmapEnabled,0);const x=this.catalogWebGLService.getDataTexture(e,Ix.Color);!d.disableColorMap&&x&&(this.gl.uniform1i(n.CmapEnabled,1),this.gl.uniform1i(n.CmapIndex,Af.COLOR_MAPS_ALL.indexOf(d.colorMap)),this.gl.activeTexture(vm.TEXTURE3),this.gl.bindTexture(vm.TEXTURE_2D,x),this.gl.uniform1i(n.ColorTexture,3)),this.gl.uniform1f(n.FeatherWidth,g),this.gl.uniform1i(n.OmapEnabled,0);const S=this.catalogWebGLService.getDataTexture(e,Ix.Orientation);!d.disableOrientationMap&&S&&(this.gl.uniform1i(n.OmapEnabled,1),this.gl.activeTexture(vm.TEXTURE4),this.gl.bindTexture(vm.TEXTURE_2D,S),this.gl.uniform1i(n.OrientationTexture,4));const v=this.catalogWebGLService.getDataTexture(e,Ix.SelectedSource);v&&(this.gl.activeTexture(vm.TEXTURE5),this.gl.bindTexture(vm.TEXTURE_2D,v),this.gl.uniform1i(n.SelectedSourceTexture,5)),this.gl.uniform1i(n.SizeMinorMapEnabled,0),this.gl.uniform1i(n.AreaModeMinor,d.sizeMinorArea?1:0);const C=this.catalogWebGLService.getDataTexture(e,Ix.SizeMinor);if(!d.disableSizeMinorMap&&C&&d.catalogShape===Sd.ELLIPSE_LINED&&(this.gl.uniform1i(n.SizeMinorMapEnabled,1),this.gl.activeTexture(vm.TEXTURE6),this.gl.bindTexture(vm.TEXTURE_2D,C),this.gl.uniform1i(n.SizeMinorTexture,6)),h)this.gl.uniform1i(n.ControlMapEnabled,0),this.gl.uniform1i(n.ControlMapTexture,0);else{const e=c.getCatalogControlMap(l);e?(e.updateCatalogBoundary(),this.gl.uniform1i(n.ControlMapEnabled,1),this.gl.uniform2f(n.ControlMapMin,e.minPoint.x,e.minPoint.y),this.gl.uniform2f(n.ControlMapMax,e.maxPoint.x,e.maxPoint.y),this.gl.uniform2f(n.ControlMapSize,e.width,e.height)):console.error("Could not generate control map for contours"),this.gl.activeTexture(vm.TEXTURE1),this.gl.bindTexture(vm.TEXTURE_2D,e.getTextureX(this.gl)),this.gl.uniform1i(n.ControlMapTexture,1)}this.catalogWebGLService.bindBuffer(e)&&(this.gl.uniform3f(n.PointColor,b.r/255,b.g/255,b.b/255),this.gl.uniform3f(n.SelectedSourceColor,m.r/255,m.g/255,m.b/255),this.gl.uniform1i(n.ShapeType,d.catalogShape),this.gl.uniform1f(n.PointSize,y*devicePixelRatio*gC.Instance.imageRatio),this.gl.vertexAttribPointer(this.catalogWebGLService.vertexPositionAttribute,2,vm.FLOAT,!1,0,0),this.gl.drawArrays(vm.POINTS,0,p),this.gl.finish())}}))}onDoubleClick(){var e;const t=hM.Instance;var i;(null===t||void 0===t||null===(e=t.catalogGLData)||void 0===e?void 0:e.size)&&(null===(i=t.catalogProfileStores)||void 0===i||i.forEach((e=>{e.setSelectedPointIndices([],!1)})))}})||SG;var CG;i(875);let IG=Object(p.a)(CG=class extends n.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.vectorOverlayWebGLService=void 0,this.updateCanvas=()=>{const e=gC.Instance,t=this.props.frame;if(t&&this.canvas&&this.gl&&this.vectorOverlayWebGLService.shaderUniforms){e.setCanvasUpdated();const i=e.vectorOverlayFrames.get(t);if(this.resizeAndClearCanvas(),i)for(let e=i.length-1;e>=0;--e)this.renderFrameVectorOverlay(i[e],t);const n=this.canvas.getContext("2d"),r=this.canvas.width,o=this.canvas.height;n.clearRect(0,0,r,o),n.drawImage(this.gl.canvas,this.props.column*r,this.props.row*o,r,o,0,0,r,o)}},this.renderFrameVectorOverlay=(e,t)=>{var i;const n=this.vectorOverlayWebGLService.shaderUniforms,r=devicePixelRatio*gC.Instance.imageRatio,o=e===t;if(t.spatialReference){const e=t.spatialReference.requiredFrameView,i={x:1/(e.xMax-e.xMin),y:1/(e.yMax-e.yMin)},r=nm(t.spatialTransform.origin,om(dm(t.spatialTransform.origin,t.spatialTransform.rotation),t.spatialTransform.scale)),o={x:(t.spatialTransform.translation.x-e.xMin+r.x)*i.x,y:(t.spatialTransform.translation.y-e.yMin+r.y)*i.y};this.gl.uniform2f(n.RangeScale,i.x,i.y),this.gl.uniform2f(n.RangeOffset,o.x,o.y),this.gl.uniform1f(n.RotationAngle,-t.spatialTransform.rotation),this.gl.uniform1f(n.ScaleAdjustment,t.spatialTransform.scale),this.gl.uniform1f(n.ZoomLevel,t.spatialReference.zoomLevel)}else{const e=t.requiredFrameView,i={x:1/(e.xMax-e.xMin),y:1/(e.yMax-e.yMin)},r={x:-e.xMin*i.x,y:-e.yMin*i.y};this.gl.uniform2f(n.RangeOffset,r.x,r.y),this.gl.uniform2f(n.RangeScale,i.x,i.y),this.gl.uniform1f(n.RotationAngle,0),this.gl.uniform1f(n.ScaleAdjustment,1),this.gl.uniform1f(n.ZoomLevel,t.zoomLevel)}if(o)this.gl.uniform1i(n.ControlMapEnabled,0),this.gl.uniform1i(n.ControlMapTexture,0);else{const i=e.getControlMap(t);i?(this.gl.uniform1i(n.ControlMapEnabled,1),this.gl.uniform2f(n.ControlMapMin,i.minPoint.x,i.minPoint.y),this.gl.uniform2f(n.ControlMapMax,i.maxPoint.x,i.maxPoint.y),this.gl.uniform2f(n.ControlMapSize,i.width,i.height)):console.error("Could not generate control map for vector overlay"),this.gl.activeTexture(vm.TEXTURE1),this.gl.bindTexture(vm.TEXTURE_2D,i.getTextureX(this.gl)),this.gl.uniform1i(n.ControlMapTexture,1)}this.gl.uniform1i(n.DataTexture,0),this.gl.uniform1f(n.CanvasSpaceLineWidth,r*e.vectorOverlayConfig.thickness),this.gl.uniform1f(n.FeatherWidth,r),isFinite(e.vectorOverlayConfig.rotationOffset)?this.gl.uniform1f(n.RotationOffset,e.vectorOverlayConfig.rotationOffset*Math.PI/180):this.gl.uniform1f(n.RotationOffset,0);const s=isFinite(e.vectorOverlayConfig.intensityMin)?e.vectorOverlayConfig.intensityMin:e.vectorOverlayStore.intensityMin,a=isFinite(e.vectorOverlayConfig.intensityMax)?e.vectorOverlayConfig.intensityMax:e.vectorOverlayStore.intensityMax;if(e.vectorOverlayConfig.angularSource===mt.None?(this.gl.uniform1f(n.IntensityMin,s),this.gl.uniform1f(n.IntensityMax,a),this.gl.uniform1f(n.LengthMin,e.vectorOverlayConfig.lengthMin*r),this.gl.uniform1f(n.LengthMax,e.vectorOverlayConfig.lengthMax*r),this.gl.uniform1i(n.IntensityPlot,1)):e.vectorOverlayConfig.intensitySource===mt.None?(this.gl.uniform1f(n.IntensityMin,0),this.gl.uniform1f(n.IntensityMax,1),this.gl.uniform1f(n.LengthMin,e.vectorOverlayConfig.lengthMax*r),this.gl.uniform1f(n.LengthMax,e.vectorOverlayConfig.lengthMax*r),this.gl.uniform1i(n.IntensityPlot,0)):(this.gl.uniform1f(n.IntensityMin,s),this.gl.uniform1f(n.IntensityMax,a),this.gl.uniform1f(n.LengthMin,e.vectorOverlayConfig.lengthMin*r),this.gl.uniform1f(n.LengthMax,e.vectorOverlayConfig.lengthMax*r),this.gl.uniform1i(n.IntensityPlot,0)),this.gl.uniform1i(n.CmapEnabled,e.vectorOverlayConfig.colormapEnabled?1:0),e.vectorOverlayConfig.colormapEnabled)this.gl.uniform1i(n.CmapIndex,Af.COLOR_MAPS_ALL.indexOf(e.vectorOverlayConfig.colormap)),this.gl.uniform1f(n.Bias,e.vectorOverlayConfig.colormapBias),this.gl.uniform1f(n.Contrast,e.vectorOverlayConfig.colormapContrast);else{const t=e.vectorOverlayConfig.color;t?this.gl.uniform4f(n.LineColor,t.r/255,t.g/255,t.b/255,t.a||1):this.gl.uniform4f(n.LineColor,1,1,1,1)}if(null===(i=e.vectorOverlayStore)||void 0===i?void 0:i.tiles)for(const l of e.vectorOverlayStore.tiles)this.gl.activeTexture(vm.TEXTURE0),this.gl.bindTexture(vm.TEXTURE_2D,l.texture),this.gl.drawArrays(vm.TRIANGLES,0,6*l.numVertices)},this.getRef=e=>{this.canvas=e}}componentDidMount(){this.vectorOverlayWebGLService=Sx.Instance,this.gl=this.vectorOverlayWebGLService.gl,this.canvas&&this.updateCanvas()}componentDidUpdate(){gC.Instance.resetImageRatio(),requestAnimationFrame(this.updateCanvas)}resizeAndClearCanvas(){const e=this.props.frame;if(!e)return;const t=gC.Instance,i=devicePixelRatio*t.imageRatio,n=Math.max(1,e.renderWidth*i),r=Math.max(1,e.renderHeight*i);!(null===e||void 0===e?void 0:e.isRenderable)||this.canvas.width===n&&this.canvas.height===r||(this.canvas.width=n,this.canvas.height=r),this.vectorOverlayWebGLService.setCanvasSize(n*t.numImageColumns,r*t.numImageRows),this.canvas.width===n&&this.canvas.height===r||(this.canvas.width=n,this.canvas.height=r);const o=this.props.column*e.renderWidth*i,s=(t.numImageRows-1-this.props.row)*e.renderHeight*i;this.gl.viewport(o,s,e.renderWidth*i,e.renderHeight*i),this.gl.clearColor(0,0,0,0),this.gl.enable(vm.SCISSOR_TEST),this.gl.scissor(o,s,e.renderWidth*i,e.renderHeight*i);const a=vm.COLOR_BUFFER_BIT|vm.DEPTH_BUFFER_BIT|vm.STENCIL_BUFFER_BIT;this.gl.clear(a),this.gl.disable(vm.SCISSOR_TEST)}render(){const e=gC.Instance,t=this.props.frame;if(t){t.requiredFrameView}const i=e.vectorOverlayFrames.get(t);if(i)for(const s of i){var n;let{angularSource:e,intensitySource:t,thickness:i,rotationOffset:r,color:o,colormapBias:a,colormapContrast:l,colormapEnabled:c,colormap:d,intensityMin:p,intensityMax:h,lengthMin:u,lengthMax:g}=s.vectorOverlayConfig;s.vectorOverlayConfig;p=isFinite(p)?p:s.vectorOverlayStore.intensityMin,h=isFinite(h)?h:s.vectorOverlayStore.intensityMax,null===(n=s.vectorOverlayStore.tiles)||void 0===n||n.forEach((e=>{e.numVertices}))}const r=e.overlayStore.padding,o=d()("vector-overlay-div",{docked:this.props.docked});return Object(xm.jsx)("div",{className:o,children:Object(xm.jsx)("canvas",{id:"vector-overlay-canvas",className:"vector-overlay-canvas",ref:this.getRef,style:{top:r.top,left:r.left,width:t&&t.renderWidth||1,height:t&&t.renderHeight||1}})})}})||CG;var wG,TG,RG,AG,PG,EG,MG;i(876);let FG=Object(p.a)((TG=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"pixelHighlightValue",RG,this),Object(f.a)(this,"imageToolbarVisible",AG,this),this.activeLayer=void 0,this.regionViewRef=void 0,Object(f.a)(this,"setPixelHighlightValue",PG,this),this.fitZoomOfLoadingMultipleFiles=()=>{gC.Instance.isLoadingMultipleFiles&&gC.Instance.preferenceStore.zoomMode===Pi.FIT&&this.fitZoomFrameAndRegion()},this.fitZoomFrameAndRegion=()=>{const e=this.props.frame;if(e){const t=e.fitZoom();t&&this.onRegionViewZoom(t,!0)}},this.getRegionViewRef=e=>{this.regionViewRef=e},this.onRegionViewZoom=(e,t=!1)=>{const i=this.props.frame;if(i){var n,r;if(t)null===(r=this.regionViewRef)||void 0===r||r.centerStage();null===(n=this.regionViewRef)||void 0===n||n.stageZoomToPoint(i.renderWidth/2,i.renderHeight/2,e)}},this.onClickToCenter=e=>{var t;null===(t=this.props.frame)||void 0===t||t.setCenter(e.posImageSpace.x,e.posImageSpace.y)},Object(f.a)(this,"onMouseEnter",EG,this),Object(f.a)(this,"onMouseLeave",MG,this),this.onMouseDown=e=>{const t=gC.Instance;this.props.frame!==t.activeFrame&&(t.setActiveFrame(this.props.frame),e.stopPropagation())},this.onMouseWheel=e=>{const t=gC.Instance;this.props.frame!==t.activeFrame&&(t.setActiveFrame(this.props.frame),e.stopPropagation())},Object(m.p)(this),this.activeLayer=gC.Instance.activeLayer}componentDidMount(){this.fitZoomOfLoadingMultipleFiles()}componentDidUpdate(){this.fitZoomOfLoadingMultipleFiles()}get cursorInfoRequired(){const e=gC.Instance;switch(e.preferenceStore.cursorInfoVisible){case _t.Always:return!0;case _t.HideTiled:return e.numImageRows*e.numImageColumns===1;case _t.ActiveImage:return e.activeFrame===this.props.frame;default:return!1}}render(){const e=gC.Instance,t=e.overlayStore,i=this.props.frame;if((null===i||void 0===i?void 0:i.isRenderable)&&e.astReady){const n=i===e.activeFrame&&e.numImageRows*e.numImageColumns>1,r=d()("image-panel-div",{active:n});let o={width:t.viewWidth,height:t.viewHeight};return n&&(0!==this.props.row&&(o.borderTopLeftRadius=0,o.borderTopRightRadius=0),0!==this.props.column&&(o.borderTopLeftRadius=0,o.borderBottomLeftRadius=0),this.props.row!==e.numImageRows-1&&(o.borderBottomLeftRadius=0,o.borderBottomRightRadius=0),this.props.column!==e.numImageColumns-1&&(o.borderTopRightRadius=0,o.borderBottomRightRadius=0)),Object(xm.jsxs)("div",{id:`image-panel-${this.props.column}-${this.props.row}`,className:r,style:o,onWheel:this.onMouseWheel,onMouseDown:this.onMouseDown,onMouseOver:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(xm.jsx)(xW,{frame:i,docked:this.props.docked,pixelHighlightValue:this.pixelHighlightValue,row:this.props.row,column:this.props.column}),Object(xm.jsx)(xG,{frame:i,docked:this.props.docked,row:this.props.row,column:this.props.column}),Object(xm.jsx)(IG,{frame:i,docked:this.props.docked,row:this.props.row,column:this.props.column}),Object(xm.jsx)(iW,{frame:i,overlaySettings:t,docked:this.props.docked}),this.cursorInfoRequired&&i.cursorInfo&&Object(xm.jsx)(rW,{cursorInfo:i.cursorInfo,cursorValue:i.cursorInfo.isInsideImage?i.cursorValue.value:void 0,isValueCurrent:i.isCursorValueCurrent,spectralInfo:i.spectralInfo,width:t.viewWidth,left:t.padding.left,right:t.padding.right,docked:this.props.docked,unit:i.requiredUnit,top:t.padding.top,currentStokes:e.activeFrame.requiredPolarizationInfo,cursorValueToPercentage:"%"===i.requiredUnit}),t.colorbar.visible&&Object(xm.jsx)(mW,{frame:i,onCursorHoverValueChanged:this.setPixelHighlightValue}),Object(xm.jsx)(TW,{frame:i,top:t.padding.top,left:t.padding.left,docked:this.props.docked,padding:10}),Object(xm.jsx)(vG,{frame:i,docked:this.props.docked}),Object(xm.jsx)(yG,{ref:this.getRegionViewRef,frame:i,width:i.renderWidth,height:i.renderHeight,top:t.padding.top,left:t.padding.left,onClickToCenter:this.onClickToCenter,overlaySettings:t,dragPanningEnabled:e.preferenceStore.dragPanning,docked:this.props.docked&&this.activeLayer!==_G.Catalog}),Object(xm.jsx)(IW,{docked:this.props.docked,visible:this.imageToolbarVisible,frame:i,activeLayer:this.activeLayer,onActiveLayerChange:e.updateActiveLayer,onRegionViewZoom:this.onRegionViewZoom,onZoomToFit:this.fitZoomFrameAndRegion})]})}return null}},RG=Object(b.a)(TG.prototype,"pixelHighlightValue",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return NaN}}),AG=Object(b.a)(TG.prototype,"imageToolbarVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),PG=Object(b.a)(TG.prototype,"setPixelHighlightValue",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{gC.Instance.isExportingImage||(this.pixelHighlightValue=e)}}}),EG=Object(b.a)(TG.prototype,"onMouseEnter",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageToolbarVisible=!0}}}),MG=Object(b.a)(TG.prototype,"onMouseLeave",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageToolbarVisible=!1}}}),Object(b.a)(TG.prototype,"cursorInfoRequired",[m.i],Object.getOwnPropertyDescriptor(TG.prototype,"cursorInfoRequired"),TG.prototype),wG=TG))||wG;var kG,DG,LG,NG;let _G;function zG(e,t,i="rgba(255, 255, 255, 0)"){const n=gC.Instance,r=document.createElement("canvas"),o=devicePixelRatio*n.imageRatio;r.width=n.overlayStore.fullViewWidth*o,r.height=n.overlayStore.fullViewHeight*o;const s=r.getContext("2d");return s.fillStyle=i,s.fillRect(0,0,r.width,r.height),n.visibleFrames.forEach(((r,a)=>{const l=a%n.numImageColumns,c=Math.floor(a/n.numImageColumns),d=function(e,t,i,n,r="rgba(255, 255, 255, 0)"){var o,s,a,l,c,d,p,h,u,g,f,b,m,y,O;const j=null===(o=KA()(`#image-panel-${e}-${t}`))||void 0===o?void 0:o.first();if(!(null===j||void 0===j?void 0:j.length))return null;const x=null===(s=j.find(".raster-canvas"))||void 0===s?void 0:s[0],S=null===(a=j.find(".contour-canvas"))||void 0===a?void 0:a[0],v=null===(l=j.find(".overlay-canvas"))||void 0===l?void 0:l[0],C=null===(c=j.find(".catalog-canvas"))||void 0===c?void 0:c[0],I=null===(d=j.find(".vector-overlay-canvas"))||void 0===d?void 0:d[0];if(!x||!S||!v||!I)return null;const w=null===(p=j.find(".colorbar-stage"))||void 0===p||null===(h=p.children())||void 0===h||null===(u=h.children("canvas"))||void 0===u?void 0:u[0],T=null===(g=j.find(".beam-profile-stage"))||void 0===g||null===(f=g.children())||void 0===f||null===(b=f.children("canvas"))||void 0===b?void 0:b[0],R=null===(m=j.find(".region-stage"))||void 0===m||null===(y=m.children())||void 0===y||null===(O=y.children("canvas"))||void 0===O?void 0:O[0],A=devicePixelRatio*gC.Instance.imageRatio,P=document.createElement("canvas");P.width=v.width,P.height=v.height;const E=P.getContext("2d");if(E.fillStyle=r,E.fillRect(0,0,P.width,P.height),E.drawImage(x,i.left*A,i.top*A),E.drawImage(S,i.left*A,i.top*A),E.drawImage(I,i.left*A,i.top*A),w){let e,t;switch(n){case"top":e=0,t=i.top*A-w.height;break;case"bottom":e=0,t=v.height-w.height-gC.Instance.overlayStore.colorbarHoverInfoHeight*A;break;case"right":default:e=i.left*A+x.width,t=0}E.drawImage(w,e,t)}T&&E.drawImage(T,i.left*A,i.top*A);E.setTransform(1,0,0,1,0,0),E.drawImage(v,0,0),C&&E.drawImage(C,i.left*A,i.top*A);R&&E.drawImage(R,i.left*A,i.top*A);return P}(l,c,e,t,i);d&&s.drawImage(d,n.overlayStore.viewWidth*l*o,n.overlayStore.viewHeight*c*o)})),r}!function(e){e.RegionCreating="regionCreating",e.Catalog="catalog",e.RegionMoving="regionMoving",e.DistanceMeasuring="distanceMeasuring"}(_G||(_G={}));let VG=Object(p.a)((DG=class extends n.Component{static get WIDGET_CONFIG(){return{id:"image-view",type:"image-view",minWidth:500,minHeight:500,defaultWidth:600,defaultHeight:600,title:"Image view",isCloseable:!1,helpType:xM.IMAGE_VIEW}}constructor(e){super(e),this.imagePanelRefs=void 0,this.ratioIndicatorTimeoutHandle=void 0,this.cachedImageSize=void 0,this.cachedGridSize=void 0,Object(f.a)(this,"showRatioIndicator",LG,this),this.onResize=(e,t)=>{if(e>0&&t>0){const n=gC.Instance,r=n.preferenceStore.zoomMode===Pi.FIT&&n.overlayStore.fullViewWidth<=1&&n.overlayStore.fullViewHeight<=1;var i;if(n.setImageViewDimensions(e,t),r)null===(i=this.imagePanelRefs)||void 0===i||i.forEach((e=>null===e||void 0===e?void 0:e.fitZoomFrameAndRegion()))}},Object(f.a)(this,"setRatioIndicatorVisible",NG,this),this.collectImagePanelRef=e=>{this.imagePanelRefs.push(e)},Object(m.p)(this),this.imagePanelRefs=[];const t=gC.Instance;Object(m.h)((()=>{const e={x:t.overlayStore.renderWidth,y:t.overlayStore.renderHeight},i={x:t.numImageColumns,y:t.numImageRows},n=!this.cachedImageSize||this.cachedImageSize.x!==e.x||this.cachedImageSize.y!==e.y,r=!this.cachedGridSize||this.cachedGridSize.x!==i.x||this.cachedGridSize.y!==i.y;(n||r)&&(this.cachedImageSize=e,this.cachedGridSize=i,clearTimeout(this.ratioIndicatorTimeoutHandle),this.setRatioIndicatorVisible(!0),this.ratioIndicatorTimeoutHandle=setTimeout((()=>this.setRatioIndicatorVisible(!1)),1e3))}))}get panels(){const e=gC.Instance,t=e.visibleFrames;return this.imagePanelRefs=[],t?t.map(((t,i)=>{const n=i%e.numImageColumns,r=Math.floor(i/e.numImageColumns);return Object(xm.jsx)(FG,{ref:this.collectImagePanelRef,docked:this.props.docked,frame:t,row:r,column:n},t.frameInfo.fileId)})):[]}render(){const e=gC.Instance;let t;if(this.panels.length)if(e.astReady){const i={x:Math.floor(e.overlayStore.renderWidth),y:Math.floor(e.overlayStore.renderHeight)},r=i.x/i.y,o={x:e.numImageColumns,y:e.numImageRows};let s;o.x*o.y>1&&(s=Object(xm.jsxs)("p",{children:[o.x," \xd7 ",o.y]})),t=Object(xm.jsxs)(n.Fragment,{children:[this.panels,Object(xm.jsxs)("div",{style:{opacity:this.showRatioIndicator?1:0},className:"image-ratio-popup",children:[Object(xm.jsxs)("p",{children:[i.x," \xd7 ",i.y," (",fi(r,2),")"]}),s]})]})}else t=Object(xm.jsx)(u.C,{icon:Object(xm.jsx)(u.O,{className:"astLoadingSpinner"}),title:"Loading AST Library"});else t=Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"});return Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33,children:Object(xm.jsx)("div",{className:"image-view-div",style:{gridTemplateColumns:`repeat(${e.numImageColumns}, auto)`},children:t})})}},LG=Object(b.a)(DG.prototype,"showRatioIndicator",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),NG=Object(b.a)(DG.prototype,"setRatioIndicatorVisible",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.showRatioIndicator=e}}}),Object(b.a)(DG.prototype,"panels",[m.i],Object.getOwnPropertyDescriptor(DG.prototype,"panels"),DG.prototype),kG=DG))||kG;var WG,GG=i(457);i(992);let BG=Object(p.a)(WG=class extends n.Component{constructor(...e){super(...e),this.onClearClicked=()=>{qI.Instance.clearLog()},this.onTagClicked=e=>{qI.Instance.toggleTag(e)},this.onLogLevelChanged=e=>{qI.Instance.setLevel(parseInt(e.currentTarget.value))},this.isTagHidden=e=>-1!==qI.Instance.hiddenTags.indexOf(e)}static get WIDGET_CONFIG(){return{id:"log",type:"log",minWidth:300,minHeight:150,defaultWidth:425,defaultHeight:200,title:"Log",isCloseable:!0,helpType:xM.LOG}}colorFromSeverity(e){switch(e){case Nt.ErrorSeverity.WARNING:return L.a.ORANGE3;case Nt.ErrorSeverity.ERROR:case Nt.ErrorSeverity.CRITICAL:return L.a.RED3;default:return L.a.GRAY1}}intentFromSeverity(e){switch(e){case Nt.ErrorSeverity.WARNING:return"warning";case Nt.ErrorSeverity.ERROR:case Nt.ErrorSeverity.CRITICAL:return"danger";default:return"none"}}render(){const e=qI.Instance,t=e.logEntries,i=e.hiddenTags;let n=[],r=[];for(let s=0;s<t.length;s++){const o=t[s];if(o.level<e.logLevel)continue;let a=[],l=o.tags.filter((e=>-1===i.indexOf(e)));for(let e=0;e<o.tags.length;e++){const t=o.tags[e];a.push(Object(xm.jsx)(u.S,{intent:this.intentFromSeverity(o.level),children:o.tags[e]},e)),-1===n.indexOf(t)&&n.push(t)}l.length&&r.push(Object(xm.jsxs)("div",{children:[a,Object(xm.jsx)(u.i,{style:{color:this.colorFromSeverity(o.level)},children:o.message})]},s))}const o=n.map(((e,t)=>Object(xm.jsx)(u.S,{interactive:!0,minimal:this.isTagHidden(e),intent:this.isTagHidden(e)?"none":"primary",className:this.isTagHidden(e)?"tag-hidden":"",onClick:()=>this.onTagClicked(e),children:e},t)));return Object(xm.jsxs)("div",{className:"log",children:[r.length?Object(xm.jsx)(GG.a,{initialScrollBehavior:"auto",debug:!1,className:"log-entry-list",followButtonClassName:"log-entry-follow",children:r}):Object(xm.jsx)(u.C,{className:"log-entry-list",icon:"application",title:"No log entries"}),Object(xm.jsxs)("div",{className:"log-footer",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Log level:",className:"log-level",children:Object(xm.jsxs)(u.r,{value:e.logLevel,onChange:this.onLogLevelChanged,style:{color:this.colorFromSeverity(e.logLevel)},children:[Object(xm.jsx)("option",{value:Nt.ErrorSeverity.DEBUG,style:{color:this.colorFromSeverity(Nt.ErrorSeverity.DEBUG)},children:"Debug"}),Object(xm.jsx)("option",{value:Nt.ErrorSeverity.INFO,style:{color:this.colorFromSeverity(Nt.ErrorSeverity.INFO)},children:"Info"}),Object(xm.jsx)("option",{value:Nt.ErrorSeverity.WARNING,style:{color:this.colorFromSeverity(Nt.ErrorSeverity.WARNING)},children:"Warning"}),Object(xm.jsx)("option",{value:Nt.ErrorSeverity.ERROR,style:{color:this.colorFromSeverity(Nt.ErrorSeverity.ERROR)},children:"Error"}),Object(xm.jsx)("option",{value:Nt.ErrorSeverity.CRITICAL,style:{color:this.colorFromSeverity(Nt.ErrorSeverity.CRITICAL)},children:"Critical"})]})}),Object(xm.jsx)(u.p,{inline:!0,label:"Visible tags:",className:"tag-list",children:Object(xm.jsx)("div",{children:o.length>0?o:"None"})}),Object(xm.jsx)("div",{className:"log-footer-right",children:Object(xm.jsx)(u.e,{minimal:!0,intent:"warning",icon:"trash",onClick:this.onClearClicked})})]})]})}})||WG;var qG,HG,YG,UG,XG,$G,KG;i(993);let QG=Object(p.a)((HG=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"layer-list",type:"layer-list",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Image List",isCloseable:!0,helpType:xM.LAYER_LIST}}constructor(t){super(t),Object(f.a)(this,"width",YG,this),Object(f.a)(this,"height",UG,this),Object(f.a)(this,"columnWidths",XG,this),Object(f.a)(this,"onColumnWidthsChange",$G,this),Object(f.a)(this,"onResize",KG,this),this.handleFileReordered=(e,t,i)=>{e!==t&&gC.Instance.reorderFrame(e,t,i)},this.rowHeaderCellRenderer=e=>{const t=d()("row-cell",{active:e===gC.Instance.activeFrameIndex});return Object(xm.jsx)(tj.a,{name:e.toString(),className:t})},this.onFileSelected=e=>{gC.Instance.setActiveFrame(e)},this.fileNameRenderer=e=>{const t=gC.Instance;if(e<0||e>=t.frames.length)return Object(xm.jsx)($O.a,{});const i=t.frames[e],r=d()("row-cell",{active:e===t.activeFrameIndex});return Object(xm.jsx)($O.a,{className:r,children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsx)("div",{className:"name-cell",onClick:()=>this.onFileSelected(i),children:i.filename})})})},this.channelRenderer=e=>{const t=gC.Instance;if(e<0||e>=t.frames.length)return Object(xm.jsx)($O.a,{});const i=d()("row-cell",{active:e===t.activeFrameIndex});return Object(xm.jsx)($O.a,{className:i,children:t.frames[e].requiredChannel})},this.stokesRenderer=e=>{const t=gC.Instance;if(e<0||e>=t.frames.length)return Object(xm.jsx)($O.a,{});const i=d()("row-cell",{active:e===t.activeFrameIndex});return Object(xm.jsx)($O.a,{className:i,children:t.frames[e].requiredPolarizationInfo})},this.typeRenderer=e=>{const t=gC.Instance;if(e<0||e>=t.frames.length)return Object(xm.jsx)($O.a,{});const i=t.frames[e],r=d()("row-cell",{active:e===t.activeFrameIndex});return Object(xm.jsx)($O.a,{className:r,children:Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(j.a,{position:"bottom",content:Object(xm.jsxs)("span",{children:["Raster layer",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Click to ",i.renderConfig.visible?"hide":"show"]})})]}),children:Object(xm.jsx)(u.b,{minimal:!0,small:!0,active:i.renderConfig.visible,intent:i.renderConfig.visible?"success":"none",onClick:i.renderConfig.toggleVisibility,children:"R"})}),i.contourConfig.enabled&&Object(xm.jsx)(j.a,{position:"bottom",content:Object(xm.jsxs)("span",{children:["Contour layer",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Click to ",i.contourConfig.visible?"hide":"show"]})})]}),children:Object(xm.jsx)(u.b,{minimal:!0,small:!0,active:i.contourConfig.visible,intent:i.contourConfig.visible?"success":"none",onClick:i.contourConfig.toggleVisibility,children:"C"})}),i.vectorOverlayConfig.enabled&&Object(xm.jsx)(j.a,{position:"bottom",content:Object(xm.jsxs)("span",{children:["Vector overlay layer",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Click to ",i.vectorOverlayConfig.visible?"hide":"show"]})})]}),children:Object(xm.jsx)(u.b,{minimal:!0,small:!0,active:i.vectorOverlayConfig.visible,intent:i.vectorOverlayConfig.visible?"success":"none",onClick:i.vectorOverlayConfig.toggleVisibility,children:"V"})})]})})},this.matchingRenderer=e=>{const t=gC.Instance;if(e<0||e>=t.frames.length)return Object(xm.jsx)($O.a,{});const i=t.frames[e];let r,o,s;if(t.spatialReference){let e;e=i===t.spatialReference?`${i.filename} is the current spatial reference`:`Click to ${i.spatialReference?"disable":"enable"} matching to ${t.spatialReference.filename}`,r=Object(xm.jsx)(j.a,{position:"bottom",content:Object(xm.jsxs)("span",{children:["Spatial matching",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:e})})]}),children:Object(xm.jsx)(u.b,{className:d()({outlined:i===t.spatialReference}),minimal:!0,small:!0,active:!!i.spatialReference,intent:i.spatialReference?"success":"none",onClick:()=>t.toggleSpatialMatching(i),children:"XY"})})}if(i.frameInfo.fileInfoExtended.depth>1&&t.spectralReference){let e;e=i===t.spectralReference?`${i.filename} is the current spectral reference`:`Click to ${i.spectralReference?"disable":"enable"} matching to ${t.spectralReference.filename}`,o=Object(xm.jsx)(j.a,{position:"bottom",content:Object(xm.jsxs)("span",{children:["Spectral matching",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:e})})]}),children:Object(xm.jsx)(u.b,{className:d()({outlined:i===t.spectralReference}),minimal:!0,small:!0,active:!!i.spectralReference,intent:i.spectralReference?"success":"none",onClick:()=>t.toggleSpectralMatching(i),children:"Z"})})}if(t.rasterScalingReference){let e;e=i===t.rasterScalingReference?`${i.filename} is the current raster scaling reference`:`Click to ${i.rasterScalingReference?"disable":"enable"} matching to ${t.rasterScalingReference.filename}`,s=Object(xm.jsx)(j.a,{position:"bottom",content:Object(xm.jsxs)("span",{children:["Raster scaling matching",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:e})})]}),children:Object(xm.jsx)(u.b,{className:d()({outlined:i===t.rasterScalingReference}),minimal:!0,small:!0,active:!!i.rasterScalingReference,intent:i.rasterScalingReference?"success":"none",onClick:()=>t.toggleRasterScalingMatching(i),children:"R"})})}const a=d()("row-cell",{active:e===t.activeFrameIndex});return Object(xm.jsx)($O.a,{className:a,children:Object(xm.jsxs)(n.Fragment,{children:[r,o,s]})})},this.columnHeaderRenderer=e=>{let t;switch(e){case 0:t="Image";break;case 1:t="Layers";break;case 2:t="Matching";break;case 3:t="Channel";break;case 4:t="Polarization"}return Object(xm.jsx)(XO.a,{name:t,style:{fontSize:"12",fontWeight:"bold"}})},this.restFreqShortCutOnClick=t=>{var i;const n=gC.Instance.widgetsStore,r=null===(i=n.layerListWidgets)||void 0===i?void 0:i.get(this.props.id);n.createFloatingSettingsWidget(e.WIDGET_CONFIG.title,this.props.id,e.WIDGET_CONFIG.type),r&&(r.setSettingsTabId(Lh.REST_FREQ),r.setSelectedFrameIndex(t))},this.contextMenuRenderer=e=>{const t=e.getTarget().rows,i=gC.Instance;if(t&&t.length&&i.frames[t[0]]){const e=i.frames[t[0]];var n,r;if(e)return Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.A,{title:e.filename}),Object(xm.jsx)(u.B,{disabled:i.spatialReference===e,text:"Set as spatial reference",onClick:()=>i.setSpatialReference(e)}),Object(xm.jsx)(u.B,{disabled:i.spectralReference===e||e.frameInfo.fileInfoExtended.depth<=1,text:"Set as spectral reference",onClick:()=>i.setSpectralReference(e)}),Object(xm.jsx)(u.B,{disabled:i.rasterScalingReference===e,text:"Set as raster scaling reference",onClick:()=>i.setRasterScalingReference(e)}),Object(xm.jsx)(u.A,{}),Object(xm.jsx)(u.B,{disabled:!e.isRestFreqEditable,text:"Set rest frequency",onClick:()=>this.restFreqShortCutOnClick(t[0])}),Object(xm.jsx)(u.A,{}),Object(xm.jsx)(u.B,{text:"Close image",onClick:()=>i.closeFile(e)}),Object(xm.jsx)(u.B,{text:"Close other images",disabled:(null===(n=i.frames)||void 0===n?void 0:n.length)<=1,onClick:()=>i.closeOtherFiles(e)}),Object(xm.jsx)(u.B,{text:"Close all images",disabled:(null===(r=i.frames)||void 0===r?void 0:r.length)<=1,onClick:()=>i.closeOtherFiles(null,!1)})]})}return null},Object(m.p)(this)}render(){const e=gC.Instance,t=e.frameNum;if(t<=0)return Object(xm.jsxs)("div",{className:"layer-list-widget",children:[Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),";",Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]});e.frameChannels,e.frameStokes,e.activeFrameIndex,e.frames.map((e=>e.renderConfig.visible)),e.frames.map((e=>e.contourConfig.visible&&e.contourConfig.enabled)),e.frames.map((e=>e.vectorOverlayConfig.visible&&e.vectorOverlayConfig.enabled)),e.frames.map((e=>e.spatialReference)),e.frames.map((e=>e.spectralReference)),e.frames.map((e=>e.rasterScalingReference)),e.spectralReference,e.spatialReference,e.rasterScalingReference;return Object(xm.jsxs)("div",{className:"layer-list-widget",children:[this.width>0&&Object(xm.jsxs)(QO.a,{numRows:t,rowHeaderCellRenderer:this.rowHeaderCellRenderer,enableRowHeader:!0,enableRowReordering:!0,enableRowResizing:!1,selectionModes:qn.d.ROWS_ONLY,enableMultipleSelection:!0,onRowsReordered:this.handleFileReordered,columnWidths:this.columnWidths,enableColumnResizing:!0,onColumnWidthChanged:this.onColumnWidthsChange,bodyContextMenuRenderer:this.contextMenuRenderer,children:[Object(xm.jsx)(KO.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.fileNameRenderer}),Object(xm.jsx)(KO.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.typeRenderer}),Object(xm.jsx)(KO.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.matchingRenderer}),Object(xm.jsx)(KO.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.channelRenderer}),Object(xm.jsx)(KO.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.stokesRenderer})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},YG=Object(b.a)(HG.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),UG=Object(b.a)(HG.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),XG=Object(b.a)(HG.prototype,"columnWidths",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[132,97,110,75,95]}}),$G=Object(b.a)(HG.prototype,"onColumnWidthsChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{!Number.isInteger(e)||e<0||e>=this.columnWidths.length||t<=0||(this.columnWidths[e]=t,this.forceUpdate())}}}),KG=Object(b.a)(HG.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),qG=HG))||qG;var ZG;i(994);let JG=Object(p.a)(ZG=class extends n.Component{constructor(...e){super(...e),this.handleRegionTypeClicked=e=>{const t=gC.Instance;t.updateActiveLayer(_G.RegionCreating),t.activeFrame.regionSet.setNewRegionType(e),t.activeFrame.regionSet.setMode(Vb.CREATING)},this.regionTooltip=e=>{const t=gC.Instance.preferenceStore.regionCreationMode===Fi.CENTER;let i=null;switch(e){case Nt.RegionType.RECTANGLE:case Nt.RegionType.ELLIPSE:case Nt.RegionType.LINE:i=Object(xm.jsxs)("small",{children:["Click-and-drag to define a region (",t?"center to corner":"corner to corner",").",Object(xm.jsx)("br",{}),"Hold Ctrl/Cmd to define a region (",t?"corner to corner":"center to corner",").",Object(xm.jsx)("br",{}),"Change the default creation mode in Preferences.",Object(xm.jsx)("br",{}),e===Nt.RegionType.LINE?"":`Hold shift key to create a ${e===Nt.RegionType.RECTANGLE?"square":"circle"}.`]});break;case Nt.RegionType.POLYGON:case Nt.RegionType.POLYLINE:i=Object(xm.jsxs)("small",{children:["Define control points with a series of clicks.",Object(xm.jsx)("br",{}),"Double-click to ",e===Nt.RegionType.POLYLINE?"":"close the loop and"," finish creation.",Object(xm.jsx)("br",{}),"Double-click on a control point to delete it.",Object(xm.jsx)("br",{}),"Click on a side to create a new control point."]})}return Object(xm.jsxs)("span",{children:[Ob.RegionTypeString(e),Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:i})]})]})}}render(){const e=gC.Instance,t=e.dialogStore,i=d()("toolbar-menu",{"bp3-dark":e.darkTheme}),r=d()("dialog-toolbar-menu",{"bp3-dark":e.darkTheme}),o=d()("actions-toolbar-menu",{"bp3-dark":e.darkTheme}),s=!!e.activeFrame&&e.activeFrame.regionSet.mode===Vb.CREATING,a=e.activeFrame?e.activeFrame.regionSet.newRegionType:Nt.RegionType.RECTANGLE,l=!e.activeFrame||e.activeLayer===_G.Catalog,c=Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Drag to place docked widget",Object(xm.jsx)("br",{}),"Click to place a floating widget"]})})]});return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.f,{className:o,children:Array.from(Ob.AVAILABLE_REGION_TYPES.keys()).map(((e,t)=>{const i=Ob.RegionIconString(e),n=Ob.IsRegionCustomIcon(e)?Object(xm.jsx)(jN,{icon:i}):i;return Object(xm.jsx)(j.a,{content:this.regionTooltip(e),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:n,onClick:()=>this.handleRegionTypeClicked(e),active:s&&a===e,disabled:l})},t)}))}),Object(xm.jsx)(u.f,{className:i,children:Array.from(WP.Instance.CARTAWidgets.keys()).map((e=>{const t=WP.Instance.CARTAWidgets.get(e),i=e.replace(/\s+/g,"");return Object(xm.jsx)(j.a,{content:Object(xm.jsxs)("span",{children:[e,c]}),children:Object(xm.jsx)(u.b,{icon:t.isCustomIcon?Object(xm.jsx)(jN,{icon:t.icon}):t.icon,id:`${i}Button`,onClick:t.onClick})},`${i}Tooltip`)}))}),Object(xm.jsxs)(u.f,{className:r,children:[Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:"File Header"}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:"app-header",onClick:t.showFileInfoDialog,active:t.fileInfoDialogVisible})}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:"Preferences"}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:"wrench",onClick:t.showPreferenceDialog,active:t.preferenceDialogVisible})}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:"Contours"}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"contour"}),onClick:t.showContourDialog,active:t.contourDialogVisible})}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:"Vector Overlay"}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"vectorOverlay"}),onClick:t.showVectorOverlayDialog,active:t.vectorOverlayDialogVisible})}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:"Image Fitting"}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"imageFitting"}),onClick:t.showFittingDialog,active:t.fittingDialogVisible})}),Object(xm.jsx)(j.a,{content:Object(xm.jsx)("span",{children:"Online Catalog Query"}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:"geosearch",onClick:t.showCatalogQueryDialog,active:t.catalogQueryDialogVisible})}),e.preferenceStore.codeSnippetsEnabled&&Object(xm.jsx)(j.a,{content:Object(xm.jsxs)("span",{children:["Code Snippets",Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Use to save, load or run small code snippets,",Object(xm.jsx)("br",{}),"providing additional functionality to CARTA.",Object(xm.jsx)("br",{}),"Warning: Use at own risk!"]})})]})]}),position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:"console",onClick:e.dialogStore.showCodeSnippetDialog,active:t.codeSnippetDialogVisible})})]})]})}})||ZG;var eB,tB,iB;i(995);let nB=Object(p.a)((tB=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"documentationAlertVisible",iB,this),this.documentationAlertTimeoutHandle=void 0,this.handleDashboardClicked=()=>{window.open(pj.RuntimeConfig.dashboardAddress,"_blank")},this.handleWidgetExecuteClicked=async(e,t,i)=>{e.stopPropagation();const n=Nk.Instance;(null===t||void 0===t?void 0:t.code)&&(n.setActiveSnippet(t,i),await n.executeCurrentSnippet())},this.genWidgetsMenu=()=>{const e=WP.Instance.CARTAWidgets,t=e.get(zP.Region),i=e.get(zP.ImageList),n=e.get(zP.CursorInfo),r=e.get(zP.Log),o=e.get(zP.SpatialProfiler),s=e.get(zP.SpectralProfiler),a=Array.from(e.keys()).filter((e=>![zP.Region,zP.ImageList,zP.CursorInfo,zP.Log,zP.SpatialProfiler,zP.SpectralProfiler].includes(e)));return Object(xm.jsxs)(u.z,{className:"widgets-menu",children:[Object(xm.jsxs)(u.z.Item,{text:"Info Panels",icon:"panel-stats",children:[Object(xm.jsx)(u.z.Item,{text:zP.Region,icon:Object(xm.jsx)(jN,{icon:t.icon}),onClick:t.onClick}),Object(xm.jsx)(u.z.Item,{text:zP.ImageList,icon:i.icon,onClick:i.onClick}),Object(xm.jsx)(u.z.Item,{text:zP.CursorInfo,icon:Object(xm.jsx)(jN,{icon:n.icon}),onClick:n.onClick}),Object(xm.jsx)(u.z.Item,{text:zP.Log,icon:r.icon,onClick:r.onClick})]}),Object(xm.jsxs)(u.z.Item,{text:"Profiles",icon:"pulse",children:[Object(xm.jsx)(u.z.Item,{text:zP.SpatialProfiler,icon:Object(xm.jsx)(jN,{icon:o.icon}),onClick:o.onClick}),Object(xm.jsx)(u.z.Item,{text:zP.SpectralProfiler,icon:Object(xm.jsx)(jN,{icon:s.icon}),onClick:s.onClick})]}),a.map((t=>{const i=e.get(t),n=t.replace(/\s+/g,"");return Object(xm.jsx)(u.z.Item,{text:t,icon:i.isCustomIcon?Object(xm.jsx)(jN,{icon:i.icon}):i.icon,onClick:i.onClick},`${n}Menu`)}))]})},this.handleDocumentationClicked=()=>{window.open("https://carta.readthedocs.io/en/2.0","_blank","width=1024"),"linux"!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002",REACT_APP_SKIP_TELEMETRY:"false"}).REACT_APP_TARGET&&"darwin"!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002",REACT_APP_SKIP_TELEMETRY:"false"}).REACT_APP_TARGET&&(this.documentationAlertVisible=!0,clearTimeout(this.documentationAlertTimeoutHandle),this.documentationAlertTimeoutHandle=setTimeout((()=>this.documentationAlertVisible=!1),1e4))},this.handleAlertDismissed=()=>{this.documentationAlertVisible=!1},this.handleFrameSelect=e=>{const t=gC.Instance;t.activeFrame&&t.activeFrame===e||t.setActiveFrame(e)},Object(m.p)(this)}recurseSnippetMap(e){let t=[];for(const[i,n]of e)n instanceof Map?t.push(Object(xm.jsx)(u.z.Item,{text:i,children:this.recurseSnippetMap(n)},i)):t.push(n);return t.sort(((e,t)=>{var i,n,r,o,s,a;const l=null!==(i=null===(n=e.props)||void 0===n||null===(r=n.children)||void 0===r?void 0:r.length)&&void 0!==i?i:0,c=null!==(o=null===(s=t.props)||void 0===s||null===(a=s.children)||void 0===a?void 0:a.length)&&void 0!==o?o:0;return l>0&&c>0||l===c?e.key>t.key?1:-1:Math.sign(c-l)}))}get snippetsMenu(){const e=gC.Instance;if(!e.preferenceStore.codeSnippetsEnabled)return null;const t=new Map;for(const[o,s]of e.snippetStore.snippets){var i,n;if(null===s||void 0===s||null===(i=s.categories)||void 0===i?void 0:i.includes("hidden"))continue;const r=Object(xm.jsx)(u.e,{className:"snippet-run-button",small:!0,minimal:!0,icon:"play",intent:"success",disabled:e.snippetStore.isExecuting,onClick:e=>this.handleWidgetExecuteClicked(e,s,o)}),a=Object(xm.jsx)(u.z.Item,{text:o,icon:r,onClick:()=>e.dialogStore.showExistingCodeSnippet(s,o)},o);if(null===(n=s.categories)||void 0===n?void 0:n.length)for(const e of s.categories){const i=e.split("/");let n=t;for(const e of i)n.has(e)||n.set(e,new Map),n=n.get(e);n.set(o,a)}else t.set(o,a)}const r=this.recurseSnippetMap(t);return Object(xm.jsxs)(u.z,{children:[r,r.length>0&&Object(xm.jsx)(u.z.Divider,{}),Object(xm.jsx)(u.z.Item,{text:"Create new snippet",icon:"add",onClick:e.dialogStore.showNewCodeSnippet})]})}render(){var e,t,i,r,o;const s=gC.Instance,a=s.modifierString,l=s.backendService.connectionStatus;let c=[];let d;s.apiService.authenticated&&pj.RuntimeConfig.apiAddress&&c.push(Object(xm.jsx)(u.z.Item,{text:"Restart Service",disabled:!s.apiService.authenticated,onClick:s.apiService.stopServer},"restart")),(pj.RuntimeConfig.logoutAddress||pj.RuntimeConfig.googleClientId)&&c.push(Object(xm.jsx)(u.z.Item,{text:"Logout",disabled:!s.apiService.authenticated,onClick:s.apiService.logout},"logout")),pj.RuntimeConfig.dashboardAddress&&c.push(Object(xm.jsx)(u.z.Item,{text:"Dashboard",onClick:this.handleDashboardClicked},"dashboard")),c.length&&(d=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.z.Divider,{}),Object(xm.jsx)(u.z.Item,{text:"Server",children:c})]}));const p=Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.z.Item,{text:"Open image",label:`${a}O`,disabled:s.openFileDisabled,onClick:()=>s.fileBrowserStore.showFileBrowser(DI.File,!1)}),Object(xm.jsx)(u.z.Item,{text:"Append image",label:`${a}L`,disabled:s.appendFileDisabled,onClick:()=>s.fileBrowserStore.showFileBrowser(DI.File,!0)}),Object(xm.jsx)(j.a,{content:"not allowed in read-only mode",disabled:s.appendFileDisabled||(null===(e=s.backendService)||void 0===e?void 0:e.serverFeatureFlags)!==Nt.ServerFeatureFlags.READ_ONLY,position:y.a.LEFT,children:Object(xm.jsx)(u.z.Item,{text:"Save image",label:`${a}S`,disabled:s.appendFileDisabled||(null===(t=s.backendService)||void 0===t?void 0:t.serverFeatureFlags)===Nt.ServerFeatureFlags.READ_ONLY,onClick:()=>s.fileBrowserStore.showFileBrowser(DI.SaveFile,!1)})}),Object(xm.jsx)(u.z.Item,{text:"Close image",label:`${a}W`,disabled:s.appendFileDisabled,onClick:()=>s.closeCurrentFile(!0)}),Object(xm.jsx)(u.z.Divider,{}),Object(xm.jsx)(u.z.Item,{text:"Import regions",disabled:!s.activeFrame,onClick:()=>s.fileBrowserStore.showFileBrowser(DI.RegionImport,!1)}),Object(xm.jsx)(j.a,{content:"not allowed in read-only mode",disabled:!s.activeFrame||!s.activeFrame.regionSet.regions||s.activeFrame.regionSet.regions.length<=1||(null===(i=s.backendService)||void 0===i?void 0:i.serverFeatureFlags)!==Nt.ServerFeatureFlags.READ_ONLY,position:y.a.LEFT,children:Object(xm.jsx)(u.z.Item,{text:"Export regions",disabled:!s.activeFrame||!s.activeFrame.regionSet.regions||s.activeFrame.regionSet.regions.length<=1||s.backendService.serverFeatureFlags===Nt.ServerFeatureFlags.READ_ONLY,onClick:()=>s.fileBrowserStore.showExportRegions()})}),Object(xm.jsx)(u.z.Divider,{}),Object(xm.jsx)(u.z.Item,{text:"Import catalog",label:`${a}G`,disabled:s.appendFileDisabled,onClick:()=>s.fileBrowserStore.showFileBrowser(DI.Catalog,!1)}),Object(xm.jsx)(u.z.Divider,{}),Object(xm.jsx)(u.z.Item,{text:"Export image",disabled:!s.activeFrame||s.isExportingImage,children:Object(xm.jsx)(Iy,{})}),Object(xm.jsx)(u.z.Item,{text:"Preferences",onClick:s.dialogStore.showPreferenceDialog,disabled:s.preferenceStore.supportsServer&&l!==Jj.ACTIVE}),d]});let h=s.frames.map((e=>Object(xm.jsx)(u.z.Item,{text:e.filename,active:s.activeFrame&&s.activeFrame.frameInfo.fileId===e.frameInfo.fileId,onClick:()=>this.handleFrameSelect(e)},e.frameInfo.fileId)));const g=Ri.PRESETS,f=s.layoutStore,b=f.userLayoutNames,m=Object(xm.jsxs)(u.z,{children:[Object(xm.jsxs)(u.z.Item,{text:"Theme",icon:"media",children:[Object(xm.jsx)(u.z.Item,{text:"Automatic",icon:"contrast",onClick:s.setAutoTheme}),Object(xm.jsx)(u.z.Item,{text:"Light",icon:"flash",onClick:s.setLightTheme}),Object(xm.jsx)(u.z.Item,{text:"Dark",icon:"moon",onClick:s.setDarkTheme})]}),Object(xm.jsxs)(u.z.Item,{text:"Layouts",icon:"page-layout",disabled:f.supportsServer&&l!==Jj.ACTIVE,children:[Object(xm.jsxs)(u.z.Item,{text:"Existing Layouts",disabled:!g&&!b,children:[g&&g.length>0&&g.map((e=>Object(xm.jsx)(u.z.Item,{text:e,active:e===s.layoutStore.currentLayoutName,onClick:()=>s.layoutStore.applyLayout(e)},e))),b&&b.length>0&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.A,{}),b.map((e=>Object(xm.jsx)(u.z.Item,{text:e,active:e===s.layoutStore.currentLayoutName,onClick:()=>s.layoutStore.applyLayout(e)},e)))]})]}),Object(xm.jsx)(u.z.Item,{text:"Save Layout",onClick:s.dialogStore.showSaveLayoutDialog}),Object(xm.jsx)(u.z.Item,{text:"Delete Layout",disabled:!b||b.length<=0,children:b&&b.length>0&&b.map((e=>Object(xm.jsx)(u.z.Item,{text:e,active:e===s.layoutStore.currentLayoutName,onClick:()=>{s.layoutStore.deleteLayout(e),e===s.preferenceStore.layout&&s.preferenceStore.setPreference(QA.GLOBAL_LAYOUT,Ri.DEFAULT)}},e)))})]}),h.length>0&&Object(xm.jsxs)(u.z.Item,{text:"Images",icon:"multi-select",children:[h,Object(xm.jsx)(u.z.Divider,{}),Object(xm.jsx)(u.z.Item,{text:"Previous image",icon:"step-backward",disabled:h.length<2,onClick:s.prevFrame}),Object(xm.jsx)(u.z.Item,{text:"Next image",icon:"step-forward",disabled:h.length<2,onClick:s.nextFrame})]}),Object(xm.jsx)(u.z.Item,{text:"File header",icon:"app-header",disabled:!s.activeFrame,onClick:s.dialogStore.showFileInfoDialog}),Object(xm.jsx)(u.z.Item,{text:"Contours",icon:Object(xm.jsx)(jN,{icon:"contour"}),disabled:!s.activeFrame,onClick:s.dialogStore.showContourDialog}),Object(xm.jsx)(u.z.Item,{text:"Code snippets",icon:"console",onClick:s.dialogStore.showCodeSnippetDialog}),Object(xm.jsx)(u.z.Item,{text:"Online Catalog Query",icon:"geosearch",disabled:!s.activeFrame,onClick:s.dialogStore.showCatalogQueryDialog})]}),x=Object(xm.jsxs)(u.z,{children:[Object(xm.jsx)(u.z.Item,{text:"Online Manual",icon:"manual",onClick:this.handleDocumentationClicked}),Object(xm.jsx)(u.z.Item,{text:"Controls and Shortcuts",icon:"key-control",label:"Shift + ?",onClick:s.dialogStore.showHotkeyDialog}),Object(xm.jsx)(u.z.Item,{text:"About",icon:"info-sign",onClick:s.dialogStore.showAboutDialog})]});let S,v="connectivity-icon";const C=isFinite(s.backendService.endToEndPing)?`${fi(s.backendService.endToEndPing,1)} ms`:"Unknown",I=s.username?` as ${s.username}`:"";switch(l){case Jj.PENDING:S=Object(xm.jsxs)("span",{children:["Connecting to server",I]}),v+=" warning";break;case Jj.ACTIVE:s.backendService.connectionDropped?(S=Object(xm.jsxs)("span",{children:["Reconnected to server ",I," after disconnect. Some errors may occur",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Latency: ",C]})})]}),v+=" warning"):(S=Object(xm.jsxs)("span",{children:["Connected to server ",I,Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Latency: ",C,Object(xm.jsx)("br",{}),"Session ID: ",s.backendService.sessionId]})})]}),v+=" online");break;case Jj.CLOSED:default:S=Object(xm.jsx)("span",{children:"Disconnected from server"}),v+=" offline"}const w=s.tileService.remainingTiles>0,T=(null===(r=s.activeFrame)||void 0===r?void 0:r.contourProgress)>=0&&s.activeFrame.contourProgress<1,R=(null===(o=s.activeFrame)||void 0===o?void 0:o.vectorOverlayStore.progress)>=0&&s.activeFrame.vectorOverlayStore.progress<1;let A,P,E="contour-loading-icon";if(w||T||R){let e,t,i;w&&(e=Object(xm.jsxs)("span",{children:["Streaming image tiles. ",s.tileService.remainingTiles," remaining"]})),T&&(t=Object(xm.jsxs)("span",{children:["Streaming contours. ",fi(100*s.activeFrame.contourProgress,1),"% complete"]})),R&&(i=Object(xm.jsxs)("span",{children:["Streaming vector overlay. ",fi(100*s.activeFrame.vectorOverlayStore.progress,1),"% complete"]})),A=Object(xm.jsxs)(n.Fragment,{children:[e,T&&w&&Object(xm.jsx)("br",{}),t,i]}),E+=" icon-visible"}return P=A?Object(xm.jsx)(j.a,{content:A,children:Object(xm.jsx)(u.w,{icon:"cloud-download",className:E})}):Object(xm.jsx)(u.w,{icon:"cloud-download",className:E}),Object(xm.jsxs)("div",{className:"root-menu",children:[Object(xm.jsx)(O.a,{autoFocus:!1,minimal:!0,content:p,position:y.a.BOTTOM_LEFT,children:Object(xm.jsx)(u.z,{className:"root-menu-entry",children:Object(xm.jsx)(u.z.Item,{text:"File"})})}),Object(xm.jsx)(O.a,{autoFocus:!1,minimal:!0,content:m,position:y.a.BOTTOM_LEFT,children:Object(xm.jsx)(u.z,{className:"root-menu-entry",children:Object(xm.jsx)(u.z.Item,{text:"View"})})}),Object(xm.jsx)(O.a,{autoFocus:!1,minimal:!0,content:this.genWidgetsMenu(),position:y.a.BOTTOM_LEFT,children:Object(xm.jsx)(u.z,{className:"root-menu-entry",children:Object(xm.jsx)(u.z.Item,{text:"Widgets"})})}),s.preferenceStore.codeSnippetsEnabled&&Object(xm.jsx)(O.a,{autoFocus:!1,minimal:!0,content:this.snippetsMenu,position:y.a.BOTTOM_LEFT,children:Object(xm.jsx)(u.z,{className:"root-menu-entry",children:Object(xm.jsx)(u.z.Item,{text:"Snippets"})})}),Object(xm.jsx)(O.a,{autoFocus:!1,minimal:!0,content:x,position:y.a.BOTTOM_LEFT,children:Object(xm.jsx)(u.z,{className:"root-menu-entry",children:Object(xm.jsx)(u.z.Item,{text:"Help"})})}),Object(xm.jsx)(JG,{}),Object(xm.jsx)(u.a,{className:s.darkTheme?"bp3-dark":"",isOpen:this.documentationAlertVisible,onClose:this.handleAlertDismissed,canEscapeKeyCancel:!0,canOutsideClickCancel:!0,confirmButtonText:"Dismiss",children:"Documentation will open in a new tab. Please ensure any popup blockers are disabled."}),P,s.preferenceStore.lowBandwidthMode&&Object(xm.jsx)(j.a,{content:Object(xm.jsxs)("span",{children:["CARTA is running in low bandwidth mode",Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"Image resolution and cursor responsiveness will be reduced"})})]}),children:Object(xm.jsx)(u.w,{icon:"feed",className:"connectivity-icon warning"})}),s.snippetStore.isExecuting&&Object(xm.jsx)(j.a,{content:"CARTA is currently executing a code snippet.",children:Object(xm.jsx)(u.w,{icon:"console",intent:"warning"})}),Object(xm.jsx)(j.a,{content:S,children:Object(xm.jsx)(u.w,{icon:"symbol-circle",className:v})}),Object(xm.jsx)("div",{id:"hidden-status-info",children:Object(xm.jsx)("span",{id:"info-session-id",children:s.backendService.sessionId})})]})}},iB=Object(b.a)(tB.prototype,"documentationAlertVisible",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(tB.prototype,"snippetsMenu",[m.i],Object.getOwnPropertyDescriptor(tB.prototype,"snippetsMenu"),tB.prototype),eB=tB))||eB;var rB;i(996);let oB=Object(p.a)(rB=class extends n.Component{static get WIDGET_CONFIG(){return{id:"placeholder",type:"placeholder",minWidth:225,minHeight:225,defaultWidth:300,defaultHeight:225,title:"Placeholder",isCloseable:!0,helpType:xM.PLACEHOLDER}}render(){return Object(xm.jsx)("div",{className:"placeholder-container",children:Object(xm.jsx)("h1",{children:this.props.label})})}})||rB;var sB,aB,lB;const cB=A.a.ofType();let dB=Object(p.a)((aB=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"showCubeHistogramAlert",lB,this),this.renderHistogramSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(xm.jsx)(u.B,{text:e?"Per-Cube":"Per-Channel",onClick:t},e?"cube":"channel"),this.handleHistogramChange=e=>{e&&!this.props.renderConfig.cubeHistogram?this.props.warnOnCubeHistogram?this.showCubeHistogramAlert=!0:this.handleAlertConfirm():this.props.renderConfig.setUseCubeHistogram(e)},this.handleAlertConfirm=()=>{this.props.onCubeHistogramSelected(),this.showCubeHistogramAlert=!1},this.handleAlertCancel=()=>{this.showCubeHistogramAlert=!1},Object(m.p)(this)}render(){if(!this.props.renderConfig)return null;const e=this.props.renderConfig;return Object(xm.jsxs)(n.Fragment,{children:[this.props.showHistogramSelect&&Object(xm.jsx)(u.p,{label:"Histogram",inline:!0,disabled:this.props.disableHistogramSelect,children:Object(xm.jsx)(cB,{activeItem:e.useCubeHistogram,popoverProps:xO,filterable:!1,items:[!0,!1],onItemSelect:this.handleHistogramChange,itemRenderer:this.renderHistogramSelectItem,disabled:this.props.disableHistogramSelect,children:Object(xm.jsx)(u.e,{text:e.useCubeHistogram?"Per-Cube":"Per-Channel",rightIcon:"double-caret-vertical",alignText:"right",disabled:this.props.disableHistogramSelect})})}),Object(xm.jsx)(u.a,{className:gC.Instance.darkTheme?"bp3-dark":"",icon:"time",isOpen:this.showCubeHistogramAlert,onCancel:this.handleAlertCancel,onConfirm:this.handleAlertConfirm,cancelButtonText:"Cancel",children:Object(xm.jsx)("p",{children:"Calculating a cube histogram may take a long time, depending on the size of the file. Are you sure you want to continue?"})})]})}},lB=Object(b.a)(aB.prototype,"showCubeHistogramAlert",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sB=aB))||sB;var pB,hB,uB,gB;let fB=Object(p.a)((hB=class extends n.Component{constructor(e){super(e),Object(f.a)(this,"extendBiasContrast",uB,this),Object(f.a)(this,"switchExtendBiasContrast",gB,this),this.handleInvertedChanged=e=>{this.props.renderConfig.setInverted(e.currentTarget.checked)},Object(m.p)(this)}render(){if(!this.props.renderConfig)return null;const e=this.props.renderConfig;return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"Scaling",inline:!0,children:Object(xm.jsx)(SO,{selectedItem:e.scaling,onItemSelect:e.setScaling})}),Object(xm.jsx)(u.p,{label:"Color map",inline:!0,children:Object(xm.jsx)(vy,{inverted:e.inverted,selectedItem:e.colorMap,onItemSelect:e.setColorMap})}),Object(xm.jsx)(u.p,{label:"Invert color map",inline:!0,children:Object(xm.jsx)(u.P,{checked:e.inverted,onChange:this.handleInvertedChanged})}),(e.scaling===Rf.LOG||e.scaling===Rf.POWER)&&Object(xm.jsx)(u.p,{label:"Alpha",inline:!0,children:Object(xm.jsx)(pO,{min:Af.ALPHA_MIN,max:Af.ALPHA_MAX,buttonPosition:"none",value:e.alpha,onValueChange:e.setAlpha})}),e.scaling===Rf.GAMMA&&Object(xm.jsx)(u.p,{label:"Gamma",inline:!0,children:Object(xm.jsx)(pO,{className:"step-input",min:Af.GAMMA_MIN,max:Af.GAMMA_MAX,stepSize:.1,minorStepSize:.01,majorStepSize:.5,value:e.gamma,onValueChange:e.setGamma})}),Object(xm.jsx)(u.p,{inline:!0,children:Object(xm.jsx)(u.e,{minimal:!0,className:"bias-contrast-button",rightIcon:this.extendBiasContrast?"double-chevron-up":"double-chevron-down",alignText:"right",small:!0,onClick:this.switchExtendBiasContrast,children:"Bias / Contrast"})}),Object(xm.jsx)(u.j,{isOpen:this.extendBiasContrast,children:Object(xm.jsx)(sy,{bias:e.bias,contrast:e.contrast,setBias:e.setBias,setContrast:e.setContrast,resetBias:e.resetBias,resetContrast:e.resetContrast,boardWidth:130,boardHeight:130,biasMin:Af.BIAS_MIN,biasMax:Af.BIAS_MAX,contrastMin:Af.CONTRAST_MIN,contrastMax:Af.CONTRAST_MAX})})]})}},uB=Object(b.a)(hB.prototype,"extendBiasContrast",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),gB=Object(b.a)(hB.prototype,"switchExtendBiasContrast",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.extendBiasContrast=!this.extendBiasContrast}}}),pB=hB))||pB;var bB,mB,yB,OB,jB;i(997);const xB=2048;let SB=Object(p.a)((mB=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"render-config",type:"render-config",minWidth:250,minHeight:225,defaultWidth:650,defaultHeight:225,title:"Render Configuration",isCloseable:!0,helpType:xM.RENDER_CONFIG}}get widgetStore(){const e=WP.Instance;if(e.renderConfigWidgets){const t=e.renderConfigWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new kr}get plotData(){const e=gC.Instance.activeFrame;if(e&&e.renderConfig.histogram&&e.renderConfig.histogram.bins&&e.renderConfig.histogram.bins.length){const t=e.renderConfig.histogram;let i=0,n=t.bins.length-1;this.widgetStore.isAutoScaledX||(i=Math.floor((this.widgetStore.minX-t.firstBinCenter)/t.binWidth),i=Gi(i,0,t.bins.length-1),n=Math.ceil((this.widgetStore.maxX-t.firstBinCenter)/t.binWidth),n=Gi(n,0,t.bins.length-1));let r,o=t.firstBinCenter+t.binWidth*i,s=t.firstBinCenter+t.binWidth*n,a=t.bins[i],l=a;const c=n-i;if(c>0&&!isNaN(c)){r=new Array(n-i);for(let e=i;e<=n;e++)r[e-i]={x:t.firstBinCenter+t.binWidth*e,y:t.bins[e]},a=Math.min(a,t.bins[e]),l=Math.max(l,t.bins[e])}return{values:r,xMin:o,xMax:s,yMin:a,yMax:l}}return null}constructor(t){super(t),this.cachedFrame=void 0,this.cachedHistogram=void 0,Object(f.a)(this,"width",yB,this),Object(f.a)(this,"height",OB,this),this.handleScaleMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=gC.Instance.activeFrame;i&&isFinite(t)&&t!==i.renderConfig.scaleMinVal&&i.renderConfig.setCustomScale(t,i.renderConfig.scaleMaxVal)},this.handleScaleMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=gC.Instance.activeFrame;i&&isFinite(t)&&t!==i.renderConfig.scaleMaxVal&&i.renderConfig.setCustomScale(i.renderConfig.scaleMinVal,t)},Object(f.a)(this,"onResize",jB,this),this.handlePercentileRankClick=e=>{const t=gC.Instance;t.activeFrame.renderConfig.setPercentileRank(e)||(t.alertStore.showAlert(`Couldn't set percentile of rank ${e}%`),t.logStore.addError(`Couldn't set percentile of rank ${e}%`,["render"]))},this.handlePercentileRankSelectChanged=e=>{gC.Instance.activeFrame.renderConfig.setPercentileRank(+e.currentTarget.value)},this.setCustomPercentileRank=()=>{gC.Instance.activeFrame.renderConfig.setPercentileRank(-1)},this.handleCubeHistogramSelected=()=>{const e=gC.Instance,t=e.activeFrame;t&&t.renderConfig&&(t.renderConfig.setUseCubeHistogram(!0),t.renderConfig.cubeHistogramProgress<1&&e.requestCubeHistogram())},this.handleCubeHistogramCancelled=()=>{const e=gC.Instance,t=e.activeFrame;t&&t.renderConfig&&t.renderConfig.setUseCubeHistogram(!1),e.cancelCubeHistogramRequest()},this.onMinMoved=e=>{const t=gC.Instance.activeFrame;t&&t.renderConfig&&e<t.renderConfig.scaleMaxVal&&t.renderConfig.setCustomScale(e,t.renderConfig.scaleMaxVal)},this.onMaxMoved=e=>{const t=gC.Instance.activeFrame;t&&t.renderConfig&&e>t.renderConfig.scaleMinVal&&t.renderConfig.setCustomScale(t.renderConfig.scaleMinVal,e)},this.onGraphCursorMoved=T.throttle((e=>{this.widgetStore.setCursor(e)}),100),this.genProfilerInfo=()=>{let e=[];if(void 0!==this.widgetStore.cursorX){let t;t=this.widgetStore.cursorX<.01?gi(this.widgetStore.cursorX,2):fi(this.widgetStore.cursorX,2);const i=gC.Instance.activeFrame;i.requiredUnit&&(t+=` ${i.requiredUnit}`),e.push(`Cursor: ${t}`)}return e},Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.renderConfigWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.renderConfigWidgets.set(this.props.id,new kr));else{const e=i.widgetsStore.addRenderConfigWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)((()=>{if(i.activeFrame){const e=i.activeFrame.renderConfig.histogram;e!==this.cachedHistogram&&(this.cachedHistogram=e,this.widgetStore.clearXYBounds())}const e=this.widgetStore;if(e){const t=this.plotData;t&&e.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}}))}componentDidUpdate(){const e=gC.Instance.activeFrame;e!==this.cachedFrame&&(this.cachedFrame=e,this.widgetStore.clearXYBounds())}render(){var e,t;const i=gC.Instance,n=i.activeFrame;if(!n||!this.widgetStore)return Object(xm.jsx)("div",{className:"render-config-container",children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});let r="Value";n&&n.requiredUnit&&(r=`Value (${n.requiredUnit})`);const o=n.filename,s=`channel ${n.channel} histogram`;let a={xLabel:r,darkMode:i.darkTheme,imageName:o,plotName:s,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,showYAxisTicks:!1,showYAxisLabel:!1,graphClicked:this.onMinMoved,graphRightClicked:this.onMaxMoved,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2,multiPlotPropsMap:new Map};const l=null===(e=n.renderConfig)||void 0===e?void 0:e.scaleMinVal,c=null===(t=n.renderConfig)||void 0===t?void 0:t.scaleMaxVal,d=Jb(this.widgetStore.primaryLineColor);if(n.renderConfig.histogram&&n.renderConfig.histogram.bins&&n.renderConfig.histogram.bins.length){const e=this.plotData;if(e){let t={imageName:o,plotName:s,data:e.values,type:this.widgetStore.plotType,borderColor:d};a.multiPlotPropsMap.set("histogram",t),this.widgetStore.isAutoScaledX?(a.xMin=e.xMin,a.xMax=e.xMax):(a.xMin=this.widgetStore.minX,a.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(a.yMin=e.yMin,a.yMax=e.yMax):(a.yMin=this.widgetStore.minY,a.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&a.yMin<=0&&(a.yMin=.5)}}if(n.renderConfig&&(a.markers=[{value:l,id:"marker-min",label:this.widgetStore.markerTextVisible?"Min":void 0,draggable:!0,dragCustomBoundary:{xMax:c},dragMove:this.onMinMoved,horizontal:!1},{value:c,id:"marker-max",label:this.widgetStore.markerTextVisible?"Max":void 0,draggable:!0,dragCustomBoundary:{xMin:l},dragMove:this.onMaxMoved,horizontal:!1}],this.widgetStore.meanRmsVisible&&n.renderConfig.histogram&&n.renderConfig.histogram.stdDev>0&&(a.markers.push({value:n.renderConfig.histogram.mean,id:"marker-mean",draggable:!1,horizontal:!1,color:i.darkTheme?L.a.GREEN4:L.a.GREEN2,dash:[5]}),a.markers.push({value:n.renderConfig.histogram.mean,id:"marker-rms",draggable:!1,horizontal:!1,width:n.renderConfig.histogram.stdDev,opacity:.2,color:i.darkTheme?L.a.GREEN4:L.a.GREEN2})),isFinite(l)&&isFinite(c)&&l<c)){const e=Array.from(Array(xB).keys()).map((e=>l+e/2047*(c-l)));let t=Array.from(Array(xB).keys()).map((e=>e/2047));t=t.map((e=>{var t;return Xi(e,n.renderConfig.scaling,n.renderConfig.alpha,n.renderConfig.gamma,n.renderConfig.bias,n.renderConfig.contrast,null===(t=i.preferenceStore)||void 0===t?void 0:t.useSmoothedBiasContrast)})),t=a.logY?t.map((e=>Math.pow(10,Math.log10(a.yMin)+e*(Math.log10(a.yMax)-Math.log10(a.yMin))))):t.map((e=>a.yMin+e*(a.yMax-a.yMin)));let r=[];for(let i=0;i<xB;i++)r.push({x:e[i],y:t[i]});const d={imageName:o,plotName:s,data:r,type:oO.LINES,borderColor:i.darkTheme?L.a.GRAY5:L.a.GRAY1,borderWidth:.5,opacity:.5,noExport:!0};a.multiPlotPropsMap.set("colormapScaling",d)}const p=this.width>600;let g,f;if(p){const e=Af.PERCENTILE_RANKS.map((e=>Object(xm.jsx)(u.e,{small:!0,onClick:()=>this.handlePercentileRankClick(e),active:n.renderConfig.selectedPercentileVal===e,children:`${e}%`},e)));e.push(Object(xm.jsx)(u.e,{small:!0,onClick:this.setCustomPercentileRank,active:-1===n.renderConfig.selectedPercentileVal,children:"Custom"},-1)),g=Object(xm.jsx)("div",{className:"percentile-buttons",children:Object(xm.jsx)(u.f,{fill:!0,children:e})})}else{const e=Af.PERCENTILE_RANKS.map((e=>({label:`${e}%`,value:e})));e.push({label:"Custom",value:-1}),f=Object(xm.jsx)("div",{className:"percentile-select",children:Object(xm.jsx)(u.p,{label:"Clip Percentile",inline:!0,children:Object(xm.jsx)(u.r,{options:e,value:n.renderConfig.selectedPercentileVal,onChange:this.handlePercentileRankSelectChanged})})})}return Object(xm.jsxs)("div",{className:"render-config-container",children:[this.width>430&&Object(xm.jsxs)("div",{className:"histogram-container",children:[p?g:f,Object(xm.jsxs)("div",{className:"histogram-plot",children:[Object(xm.jsx)(iO,{...a}),this.width>=430&&Object(xm.jsx)(lO,{info:this.genProfilerInfo()})]})]}),Object(xm.jsxs)("div",{className:"options-container",children:[Object(xm.jsx)(dB,{darkTheme:i.darkTheme,renderConfig:n.renderConfig,onCubeHistogramSelected:this.handleCubeHistogramSelected,showHistogramSelect:n.frameInfo.fileInfoExtended.depth>1,disableHistogramSelect:i.animatorStore.animationActive,warnOnCubeHistogram:0===(n.frameInfo.fileFeatureFlags&Nt.FileFeatureFlags.CUBE_HISTOGRAMS)}),Object(xm.jsx)(u.p,{label:"Clip Min",inline:!0,children:Object(xm.jsx)(pO,{value:n.renderConfig.scaleMinVal,selectAllOnFocus:!0,buttonPosition:"none",onBlur:this.handleScaleMinChange,onKeyDown:this.handleScaleMinChange})}),Object(xm.jsx)(u.p,{label:"Clip Max",inline:!0,children:Object(xm.jsx)(pO,{value:n.renderConfig.scaleMaxVal,selectAllOnFocus:!0,buttonPosition:"none",onBlur:this.handleScaleMaxChange,onKeyDown:this.handleScaleMaxChange})}),Object(xm.jsx)(fB,{renderConfig:n.renderConfig}),this.width<430&&f]}),Object(xm.jsx)(WN,{isOpen:n.renderConfig.useCubeHistogram&&n.renderConfig.cubeHistogramProgress<1,progress:n.renderConfig.cubeHistogramProgress,timeRemaining:i.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleCubeHistogramCancelled,text:"Calculating cube histogram"}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle"})]})}},yB=Object(b.a)(mB.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),OB=Object(b.a)(mB.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(mB.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(mB.prototype,"widgetStore"),mB.prototype),Object(b.a)(mB.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(mB.prototype,"plotData"),mB.prototype),jB=Object(b.a)(mB.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),bB=mB))||bB;var vB,CB,IB,wB,TB,RB,AB,PB,EB,MB,FB;i(998);let kB=Object(p.a)((MB=EB=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"region-list",type:"region-list",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Region List",isCloseable:!0,helpType:xM.REGION_LIST}}get validRegions(){const e=gC.Instance.activeFrame;return e?e.regionSet.regions.filter((e=>!e.isTemporary)):[]}constructor(e){super(e),Object(f.a)(this,"width",IB,this),Object(f.a)(this,"height",wB,this),Object(f.a)(this,"firstVisibleRow",TB,this),Object(f.a)(this,"lastVisibleRow",RB,this),Object(f.a)(this,"onResize",AB,this),this.handleRegionLockClicked=(e,t)=>{t.toggleLock(),e.stopPropagation()},this.handleFocusClicked=(e,t)=>{t.focusCenter(),e.stopPropagation()},this.handleRegionExportClicked=(e,t)=>{NI.Instance.showExportRegions(t.regionId)},this.handleRegionImportClicked=()=>{NI.Instance.showFileBrowser(DI.RegionImport,!1)},this.handleRegionExportAllClicked=()=>{NI.Instance.showExportRegions()},this.handleRegionListDoubleClick=()=>{tM.Instance.showRegionDialog()},Object(f.a)(this,"onListRendered",PB,this),Object(m.p)(this)}render(){const t=gC.Instance,i=t.activeFrame,r=t.darkTheme;if(!i)return Object(xm.jsxs)("div",{className:"region-list-widget",children:[Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]});if(t.fileBrowserStore.isLoadingDialogOpen)return Object(xm.jsxs)("div",{className:"region-list-widget",children:[Object(xm.jsx)(u.C,{icon:Object(xm.jsx)(u.O,{}),title:"Loading regions",description:"Region list with be shown when regions have been loaded"}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]});const o=e.ROW_HEIGHT*(this.validRegions.length+1),s=isFinite(this.height)?Math.min(o,this.height):o;let a=e.NAME_COLUMN_DEFAULT_WIDTH;const l=this.width-10;let c=e.ACTIONS_COLUMN_DEFAULT_WIDTH+e.TYPE_COLUMN_DEFAULT_WIDTH+e.CENTER_COLUMN_DEFAULT_WIDTH+e.SIZE_COLUMN_DEFAULT_WIDTH+e.ROTATION_COLUMN_DEFAULT_WIDTH;a=l-c;let p=!0,g=!0;a<e.NAME_COLUMN_MIN_WIDTH&&(p=!1,c-=e.SIZE_COLUMN_DEFAULT_WIDTH,l>c&&(a=l-c),a<e.NAME_COLUMN_MIN_WIDTH&&(g=!1,c-=e.ROTATION_COLUMN_DEFAULT_WIDTH,a=l>c?l-c:e.NAME_COLUMN_MIN_WIDTH));const f=Gi(this.firstVisibleRow,0,i.regionSet.regions.length-1),b=Gi(this.lastVisibleRow,f,i.regionSet.regions.length-1);for(let e=f;e<=b;e++){const t=i.regionSet.regions[e];t.locked,t.name,t.rotation,t.size.x,t.size.y}const m=i.regionSet.selectedRegion;return Object(xm.jsxs)("div",{className:"region-list-widget",children:[Object(xm.jsxs)("div",{className:d()("region-list-table",{"bp3-dark":r}),children:[Object(xm.jsx)(FL.a,{itemSize:e.HEADER_ROW_HEIGHT,height:e.HEADER_ROW_HEIGHT,itemCount:1,width:"100%",className:"list-header",children:t=>{const n=d()("row-header",{"bp3-dark":r});return Object(xm.jsxs)("div",{className:n,style:t.style,children:[Object(xm.jsxs)("div",{className:"cell",style:{width:3*e.ACTION_COLUMN_DEFAULT_WIDTH},children:[Object(xm.jsx)(u.w,{icon:"blank",style:{width:16}}),Object(xm.jsx)(j.a,{content:"Import regions",position:y.a.BOTTOM,children:Object(xm.jsx)(u.w,{icon:"cloud-download",onClick:this.handleRegionImportClicked,style:{cursor:"pointer"}})}),Object(xm.jsx)(u.w,{icon:"blank",style:{width:5}}),Object(xm.jsx)(j.a,{content:"Export all regions",position:y.a.BOTTOM,children:this.validRegions.length>1?Object(xm.jsx)(u.w,{icon:"cloud-upload",onClick:this.handleRegionExportAllClicked,style:{cursor:"pointer"}}):Object(xm.jsx)(u.w,{icon:"cloud-upload",style:{opacity:.4}})})]}),Object(xm.jsx)("div",{className:"cell",style:{width:a},children:"Name"}),Object(xm.jsx)("div",{className:"cell",style:{width:e.TYPE_COLUMN_DEFAULT_WIDTH},children:"Type"}),Object(xm.jsx)("div",{className:"cell",style:{width:e.CENTER_COLUMN_DEFAULT_WIDTH},children:i.validWcs?"Center":"Pixel Center"}),p&&Object(xm.jsx)("div",{className:"cell",style:{width:e.SIZE_COLUMN_DEFAULT_WIDTH},children:i.validWcs?"Size":"Size (px)"}),g&&Object(xm.jsx)("div",{className:"cell",style:{width:e.ROTATION_COLUMN_DEFAULT_WIDTH},children:"P.A. (deg)"})]})}}),Object(xm.jsx)(FL.a,{onItemsRendered:this.onListRendered,height:s-e.HEADER_ROW_HEIGHT-10,itemCount:this.validRegions.length,itemSize:e.ROW_HEIGHT,width:"100%",children:t=>{var o;const s=null===(o=this.validRegions)||void 0===o?void 0:o[t.index];if(!s)return null;const l=d()("row",{"bp3-dark":r,selected:(null===m||void 0===m?void 0:m.regionId)===s.regionId});let c;var h;isFinite(s.center.x)&&isFinite(s.center.y)?c=i.validWcs?(null===(h=i.spatialReference)||void 0===h?void 0:h.regionSet.regions.find((e=>e.modifiedTimestamp===s.modifiedTimestamp)))?Object(xm.jsx)(DB,{region:s,frame:i.spatialReference}):Object(xm.jsx)(DB,{region:s,frame:i}):`(${fi(s.center.x,1)}, ${fi(s.center.y,1)})`:c="Invalid";const f=Object(xm.jsx)("div",{className:"cell",style:{width:e.CENTER_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:c});let b,O,x,S;if(p){let t;var v,C;if(s.size)if(i.validWcs)t=s.regionType===Nt.RegionType.LINE?ji(s.wcsSize?sm(s.wcsSize):void 0,Sg):Object(xm.jsxs)(n.Fragment,{children:[ji(null===(v=s.wcsSize)||void 0===v?void 0:v.x,Sg),Object(xm.jsx)("br",{}),ji(null===(C=s.wcsSize)||void 0===C?void 0:C.y,Sg)]});else t=s.regionType===Nt.RegionType.LINE?fi(s.size?sm(s.size):void 0,1):`(${fi(s.size.x,1)}, ${fi(s.size.y,1)})`;let r="";switch(s.regionType){case Nt.RegionType.ELLIPSE:r="Semi-major and semi-minor axes";break;case Nt.RegionType.LINE:r="Length";break;default:r="Width and height"}b=Object(xm.jsx)("div",{className:"cell",style:{width:e.SIZE_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:s.regionType!==Nt.RegionType.POINT&&Object(xm.jsx)(j.a,{content:r,position:y.a.BOTTOM,children:t})})}O=s.regionId?Object(xm.jsx)("div",{className:"cell",style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleRegionLockClicked(e,s),children:Object(xm.jsx)(u.w,{icon:s.locked?"lock":"unlock"})}):Object(xm.jsxs)("div",{className:"cell",style:{width:e.ACTIONS_COLUMN_DEFAULT_WIDTH},children:[Object(xm.jsx)(u.w,{icon:"blank"}),Object(xm.jsx)(u.w,{icon:"blank"}),Object(xm.jsx)(u.w,{icon:"blank"})]}),s.regionId&&(x=Object(xm.jsx)("div",{className:"cell",style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleFocusClicked(e,s),children:Object(xm.jsx)(jN,{icon:"center"})})),s.regionId&&(S=Object(xm.jsx)("div",{className:"cell",style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleRegionExportClicked(e,s),children:Object(xm.jsx)(j.a,{content:"Export region",position:y.a.BOTTOM,children:Object(xm.jsx)(u.w,{icon:"cloud-upload"})})}));const I={...t.style};return I.overflowX="hidden",Object(xm.jsxs)("div",{className:l,onClick:()=>i.regionSet.selectRegion(s),style:I,children:[O,x,S,Object(xm.jsx)("div",{className:"cell",style:{width:a},onDoubleClick:this.handleRegionListDoubleClick,children:s.nameString}),Object(xm.jsx)("div",{className:"cell",style:{width:e.TYPE_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:Ob.RegionTypeString(s.regionType)}),f,p&&b,g&&Object(xm.jsx)("div",{className:"cell",style:{width:e.ROTATION_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:fi(s.rotation,1)})]},s.regionId)}})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},EB.ACTION_COLUMN_DEFAULT_WIDTH=25,EB.ACTIONS_COLUMN_DEFAULT_WIDTH=75,EB.NAME_COLUMN_MIN_WIDTH=50,EB.NAME_COLUMN_DEFAULT_WIDTH=150,EB.TYPE_COLUMN_DEFAULT_WIDTH=90,EB.CENTER_COLUMN_DEFAULT_WIDTH=140,EB.SIZE_COLUMN_DEFAULT_WIDTH=160,EB.ROTATION_COLUMN_DEFAULT_WIDTH=80,EB.ROW_HEIGHT=35,EB.HEADER_ROW_HEIGHT=25,CB=MB,Object(b.a)(CB.prototype,"validRegions",[m.i],Object.getOwnPropertyDescriptor(CB.prototype,"validRegions"),CB.prototype),IB=Object(b.a)(CB.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),wB=Object(b.a)(CB.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),TB=Object(b.a)(CB.prototype,"firstVisibleRow",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),RB=Object(b.a)(CB.prototype,"lastVisibleRow",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),AB=Object(b.a)(CB.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),PB=Object(b.a)(CB.prototype,"onListRendered",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&this.firstVisibleRow!==e.overscanStopIndex&&this.lastVisibleRow!==e.overscanStopIndex&&(this.firstVisibleRow=e.overscanStartIndex,this.lastVisibleRow=e.overscanStopIndex)}}}),vB=CB))||vB,DB=Object(p.a)(FB=class extends n.Component{render(){var e;gC.Instance.overlayStore.global.explicitSystem,gC.Instance.overlayStore.numbers.formatTypeX,gC.Instance.overlayStore.numbers.formatTypeY;const t=this.props.frame,i=this.props.region;if(!i||!i.center||!(isFinite(i.center.x)&&isFinite(i.center.y)&&this.props.frame.validWcs))return null;if(0===i.regionId&&(null===(e=t.cursorInfo)||void 0===e?void 0:e.infoWCS))return Object(xm.jsxs)(n.Fragment,{children:[t.cursorInfo.infoWCS.x,Object(xm.jsx)("br",{}),t.cursorInfo.infoWCS.y]});const r=km(this.props.frame.wcsInfoForTransformation,i.center);return r?Object(xm.jsxs)(n.Fragment,{children:[r.x,Object(xm.jsx)("br",{}),r.y]}):null}})||FB;var LB,NB,_B,zB,VB,WB,GB,BB;i(999);let qB=Object(p.a)((NB=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"spatial-profiler",type:"spatial-profiler",minWidth:250,minHeight:250,defaultWidth:650,defaultHeight:250,title:"X Profile: Cursor",isCloseable:!0,helpType:xM.SPATIAL_PROFILER}}get widgetStore(){const e=WP.Instance;if(e.spatialProfileWidgets){const t=e.spatialProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Fo}get profileStore(){const e=this.widgetStore;if(e.effectiveFrame){const t=`${e.effectiveFrame.frameInfo.fileId}-${e.effectiveRegionId}`;return gC.Instance.spatialProfiles.get(t)}}get frame(){return this.widgetStore?gC.Instance.getFrame(this.widgetStore.fileId):void 0}get plotData(){if(!this.frame||!this.width||!this.profileStore)return null;const e=this.profileStore.getProfile(this.widgetStore.fullCoordinate);if(e&&e.values&&e.values.length){let i,n;this.lineAxis?this.widgetStore.isAutoScaledX?(i=this.autoScaleHorizontalMin,n=this.autoScaleHorizontalMax):(i=Gi(this.widgetStore.minX,this.lineAxis.min,this.lineAxis.max),n=Gi(this.widgetStore.maxX,this.lineAxis.min,this.lineAxis.max)):(this.widgetStore.isAutoScaledX?(i=this.autoScaleHorizontalMin,n=this.autoScaleHorizontalMax):(i=Gi(this.widgetStore.minX,0,this.frame.frameInfo.fileInfoExtended.width),n=Gi(this.widgetStore.maxX,0,this.widgetStore.isXProfile?this.frame.frameInfo.fileInfoExtended.width:this.frame.frameInfo.fileInfoExtended.height)),i=Math.floor(i),n=Math.floor(n));let r,o,s,a,l,c=Number.MAX_VALUE,d=-Number.MAX_VALUE,p=0,h=0,u=0;if(this.lineAxis){l=e.values.length,s=new Array(l);let r=new Array(l);const o=this.width,g=Math.round(l/o);let f,b;for(let a=0;a<l;a++){var t;const o=e.values[a],l=(null===(t=this.widgetStore.effectiveRegion)||void 0===t?void 0:t.regionType)===Nt.RegionType.LINE?(a-e.lineAxis.crpix)*e.lineAxis.cdelt:a*e.lineAxis.cdelt;l>=i&&l<=n&&isFinite(o)&&(c=Math.min(c,o),d=Math.max(d,o),u++,p+=o,h+=o*o,void 0===f&&(f=a),b=a),r[a]=l,g<=1&&(s[a]={x:l,y:o})}g>1&&(s=this.widgetStore.smoothingStore.getDecimatedPoint2DArray(r,e.values,g,f,b)),a=this.widgetStore.smoothingStore.getSmoothingPoint2DArray(r,e.values)}else if(e.mip>1||e.start>0||e.end<n){l=e.values.length,s=new Array(l);for(let t=0;t<l;t++){const r=e.values[t],o=e.start+t*e.mip;o>=i&&o<=n&&isFinite(r)&&(c=Math.min(c,r),d=Math.max(d,r),u++,p+=r,h+=r*r),s[t]={x:o,y:r}}}else if(l=Math.floor(Math.min(n-i+1,e.values.length)),l>0){let t=new Array(e.values.length);for(let i=0;i<e.values.length;i++)t[i]=i;const r=this.width,o=Math.round(l/r);if(o<=1||this.widgetStore.plotType===oO.POINTS){s=new Array(l);for(let t=0;t<l;t++){const r=e.values[t+i],o=e.start+t+i;o>=i&&o<=n&&isFinite(r)&&(c=Math.min(c,r),d=Math.max(d,r),u++,p+=r,h+=r*r),s[t]={x:o,y:r}}}else{for(let t=0;t<l;t++){const n=e.values[t+i];isFinite(n)&&(c=Math.min(c,n),d=Math.max(d,n),u++,p+=n,h+=n*n)}s=this.widgetStore.smoothingStore.getDecimatedPoint2DArray(t,e.values,o,i,n)}a=this.widgetStore.smoothingStore.getSmoothingPoint2DArray(t,e.values,i,n)}if(u>0&&(r=p/u,o=Math.sqrt(h/u-r*r)),c===Number.MAX_VALUE)c=void 0,d=void 0;else{const e=d-c;c-=e*tO,d+=e*tO}return{values:s,smoothingValues:a,xMin:i,xMax:n,yMin:c,yMax:d,yMean:r,yRms:o}}return null}get exportHeader(){const e=[];return this.widgetStore.effectiveRegion&&e.push(...this.widgetStore.effectiveFrame.getRegionProperties(this.widgetStore.effectiveRegionId)),e}get lineAxis(){var e;const t=null===(e=this.profileStore)||void 0===e?void 0:e.getProfile(this.widgetStore.fullCoordinate);if((null===t||void 0===t?void 0:t.lineAxis)&&this.widgetStore.isLineOrPolyline){const e=t.lineAxis,i=e.axisType===Nt.ProfileAxisType.Offset?(0-e.crpix)*e.cdelt:0,n=e.axisType===Nt.ProfileAxisType.Offset?(t.end-e.crpix)*e.cdelt:t.end*e.cdelt;return{label:e.axisType===Nt.ProfileAxisType.Offset?"Offset":"Distance",min:i,max:n,unit:e.unit}}return null}constructor(t){super(t),this.cachedFormattedCoordinates=void 0,Object(f.a)(this,"width",_B,this),Object(f.a)(this,"height",zB,this),Object(f.a)(this,"autoScaleHorizontalMin",VB,this),Object(f.a)(this,"autoScaleHorizontalMax",WB,this),Object(f.a)(this,"setAutoScaleBounds",GB,this),Object(f.a)(this,"onResize",BB,this),this.formatProfileAst=(e,t,i)=>this.frame&&this.profileStore?(0===t&&this.calculateFormattedValues(i),this.cachedFormattedCoordinates[t]):e,this.genProfilerInfo=()=>{let e=[];if(this.plotData){var t;const r=this.widgetStore.coordinate.indexOf("x")>=0;if(this.widgetStore.isMouseMoveIntoLinePlots){const t=P(this.plotData.values,this.widgetStore.cursorX);if(null===t||void 0===t?void 0:t.point){var i;const n=r?{x:t.point.x,y:this.profileStore.y}:{x:this.profileStore.x,y:t.point.x},o=this.frame.getCursorInfo(n),s=(null===o||void 0===o?void 0:o.infoWCS)&&!this.lineAxis?`WCS: ${r?o.infoWCS.x:o.infoWCS.y}, `:"",a=this.lineAxis?`${this.lineAxis.label}: ${mi(t.point.x,5)} ${null!==(i=this.lineAxis.unit)&&void 0!==i?i:""}, `:`Image: ${t.point.x} px, `,l=`${void 0!==t.point.y?mi(t.point.y,5):""}`;e.push("Cursor: ("+s+a+l+")")}}else if((null===(t=this.widgetStore.effectiveRegion)||void 0===t?void 0:t.regionType)===Nt.RegionType.POINT){const t=this.frame.getCursorInfo(this.widgetStore.effectiveRegion.center);if(null===t||void 0===t?void 0:t.posImageSpace){var n;const i=(null===t||void 0===t?void 0:t.infoWCS)?`WCS: ${r?t.infoWCS.x:t.infoWCS.y}, `:"",o=`Image: ${fi(r?t.posImageSpace.x:t.posImageSpace.y)} px, `,s=`${void 0!==(null===(n=this.profileStore)||void 0===n?void 0:n.value)?mi(this.profileStore.value,5):""}`;e.push("Data: ("+i+o+s+")")}}this.widgetStore.meanRmsVisible&&e.push("Mean/RMS: "+(mi(this.plotData.yMean,2)+" / "+mi(this.plotData.yRms,2)))}return e},this.onGraphCursorMoved=T.throttle((e=>{this.widgetStore.setCursor(e)}),33),Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.spatialProfileWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.spatialProfileWidgets.set(this.props.id,new Fo));else{const e=i.widgetsStore.addSpatialProfileWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)((()=>{if(this.widgetStore){const e=this.widgetStore.coordinate,t=this.plotData;if(i&&e){const t=this.widgetStore.isLineOrPolyline?"":e.toUpperCase(),n=this.widgetStore.effectiveRegionId===Br.CURSOR?"Cursor":`Region #${this.widgetStore.effectiveRegionId}`;i.widgetsStore.setWidgetTitle(this.props.id,`${t} Profile: ${n}`)}t&&this.widgetStore.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}else i.widgetsStore.setWidgetTitle(this.props.id,"X Profile: Cursor")})),Object(m.h)((()=>{if(!this.frame||!this.width)return null;this.lineAxis?this.setAutoScaleBounds(this.lineAxis.min,this.lineAxis.max):this.widgetStore.isXProfile?this.setAutoScaleBounds(Gi(this.frame.requiredFrameView.xMin,0,this.frame.frameInfo.fileInfoExtended.width),Gi(this.frame.requiredFrameView.xMax,0,this.frame.frameInfo.fileInfoExtended.width)):this.setAutoScaleBounds(Gi(this.frame.requiredFrameView.yMin,0,this.frame.frameInfo.fileInfoExtended.height),Gi(this.frame.requiredFrameView.yMax,0,this.frame.frameInfo.fileInfoExtended.height))}),{delay:100})}calculateFormattedValues(e){if(this.cachedFormattedCoordinates&&this.cachedFormattedCoordinates.length===e.length||(this.cachedFormattedCoordinates=new Array(e.length)),!this.frame||!this.profileStore||!this.widgetStore)return;let t=new oA;if(t.add("System",bA.Instance.global.explicitSystem),this.widgetStore.isXProfile)for(let i=0;i<e.length;i++){const n=Mm(this.frame.wcsInfo,{x:e[i].value,y:this.profileStore.y}),r=Pt.normalizeCoordinates(this.frame.wcsInfo,n.x,n.y);this.cachedFormattedCoordinates[i]=Pt.getFormattedCoordinates(this.frame.wcsInfo,r.x,void 0,t.toString(),!0).x}else for(let i=0;i<e.length;i++){const n=Mm(this.frame.wcsInfo,{x:this.profileStore.x,y:e[i].value}),r=Pt.normalizeCoordinates(this.frame.wcsInfo,n.x,n.y);this.cachedFormattedCoordinates[i]=Pt.getFormattedCoordinates(this.frame.wcsInfo,void 0,r.y,t.toString(),!0).y}this.trimDecimals()}trimDecimals(){if(!this.cachedFormattedCoordinates||!this.cachedFormattedCoordinates.length)return;if(e.hasRepeats(this.cachedFormattedCoordinates))return;const t=this.cachedFormattedCoordinates[0].indexOf(".");if(-1===t)return;const i=this.cachedFormattedCoordinates[0].length-t;for(let n=i;n>0;n--){let t=this.cachedFormattedCoordinates.slice();for(let e=0;e<t.length;e++)t[e]=t[e].slice(0,-n);if(!e.hasRepeats(t))return void(this.cachedFormattedCoordinates=t);n===i&&n--}}static hasRepeats(e){if(!e||e.length<2)return!1;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];if(t===n)return!0;t=n}return!1}render(){var e,t;const i=gC.Instance,n=this.widgetStore;if(!n)return Object(xm.jsx)(u.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const r=n.isXProfile,o=this.lineAxis?`${this.lineAxis.label} (${null!==(e=this.lineAxis.unit)&&void 0!==e?e:""})`:(r?"X":"Y")+" coordinate",s=i.activeFrame?i.activeFrame.filename:void 0,a=(this.lineAxis?"":r?"X ":"Y ")+"profile";let l={xLabel:o,yLabel:"Value",darkMode:i.darkTheme,imageName:s,plotName:a,plotType:n.plotType,tickTypeY:Ry.Scientific,graphZoomedX:n.setXBounds,graphZoomedY:n.setYBounds,graphZoomedXY:n.setXYBounds,graphZoomReset:n.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,mouseEntered:n.setMouseMoveIntoLinePlots,zeroLineWidth:2,borderWidth:n.lineWidth,pointRadius:n.linePlotPointSize,multiPlotPropsMap:new Map,order:1};if(i.activeFrame&&this.profileStore&&this.frame){if(this.frame.headerUnit){let e;e=[er.PFtotal,er.PFlinear].includes(this.widgetStore.effectivePolarization)?"%":this.widgetStore.effectivePolarization===er.Pangle?"degree":this.frame.headerUnit,l.yLabel=`Value (${e})`}this.widgetStore.isLineOrPolyline||(this.frame.validWcs&&n.wcsAxisVisible?(l.showTopAxis=!0,l.topAxisTickFormatter=this.formatProfileAst):l.showTopAxis=!1);const e=this.plotData;if(e){l.data=e.values;let t=Jb(n.primaryLineColor);l.lineColor=t;const i=n.smoothingStore;if(i.type!==GO.NONE&&(null===e||void 0===e?void 0:e.smoothingValues)){i.isOverlayOn||(l.lineColor="#00000000");let t={imageName:s,plotName:`${a}-smoothed`,data:e.smoothingValues,type:i.lineType,borderColor:Jb(i.lineColor),borderWidth:i.lineWidth,pointRadius:i.pointRadius,order:0,comments:i.comments};l.multiPlotPropsMap.set("smoothed",t)}n.isAutoScaledX?(l.xMin=e.xMin,l.xMax=e.xMax):(l.xMin=n.minX,l.xMax=n.maxX),n.isAutoScaledY?(l.yMin=e.yMin,l.yMax=e.yMax):(l.yMin=n.minY,l.yMax=n.maxY),e.values&&e.values.length>1.5*this.width&&(l.plotType=oO.LINES)}const t={profiler:n.cursorX,image:r?this.profileStore.x:this.profileStore.y,unit:"px"};l.markers=[{value:t.image,id:"marker-image-cursor",draggable:!1,horizontal:!1,opacity:this.widgetStore.isLineOrPolyline?.1:1}],l.markers.push({value:t.profiler,id:"marker-profiler-cursor",draggable:!1,horizontal:!1,color:i.darkTheme?L.a.GRAY4:L.a.GRAY2,opacity:.8,isMouseMove:!0}),n.meanRmsVisible&&e&&isFinite(e.yMean)&&isFinite(e.yRms)&&(l.markers.push({value:e.yMean,id:"marker-mean",draggable:!1,horizontal:!0,color:i.darkTheme?L.a.GREEN4:L.a.GREEN2,dash:[5]}),l.markers.push({value:e.yMean,id:"marker-rms",draggable:!1,horizontal:!0,width:e.yRms,opacity:.2,color:i.darkTheme?L.a.GREEN4:L.a.GREEN2})),i.activeFrame.cursorInfo&&(l.comments=this.exportHeader)}return Object(xm.jsxs)("div",{className:"spatial-profiler-widget",children:[Object(xm.jsxs)("div",{className:"profile-container",children:[Object(xm.jsxs)("div",{className:"profile-toolbar",children:[Object(xm.jsx)(dO,{widgetStore:n}),(null===(t=n.effectiveFrame)||void 0===t?void 0:t.hasStokes)&&Object(xm.jsx)(u.p,{label:"Polarization",inline:!0,children:Object(xm.jsx)(u.r,{value:n.selectedStokes,options:n.stokesOptions,onChange:e=>n.setSelectedStokes(e.currentTarget.value)})})]}),Object(xm.jsx)("div",{className:"profile-plot",children:Object(xm.jsx)(iO,{...l})}),Object(xm.jsx)("div",{className:"profile-info",children:Object(xm.jsx)(lO,{info:this.genProfilerInfo()})})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},_B=Object(b.a)(NB.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zB=Object(b.a)(NB.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),VB=Object(b.a)(NB.prototype,"autoScaleHorizontalMin",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),WB=Object(b.a)(NB.prototype,"autoScaleHorizontalMax",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(NB.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(NB.prototype,"widgetStore"),NB.prototype),Object(b.a)(NB.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(NB.prototype,"profileStore"),NB.prototype),Object(b.a)(NB.prototype,"frame",[m.i],Object.getOwnPropertyDescriptor(NB.prototype,"frame"),NB.prototype),Object(b.a)(NB.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(NB.prototype,"plotData"),NB.prototype),Object(b.a)(NB.prototype,"exportHeader",[m.i],Object.getOwnPropertyDescriptor(NB.prototype,"exportHeader"),NB.prototype),Object(b.a)(NB.prototype,"lineAxis",[m.i],Object.getOwnPropertyDescriptor(NB.prototype,"lineAxis"),NB.prototype),GB=Object(b.a)(NB.prototype,"setAutoScaleBounds",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.autoScaleHorizontalMin=e,this.autoScaleHorizontalMax=t}}}),BB=Object(b.a)(NB.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),LB=NB))||LB;var HB,YB=i(69),UB=i.p+"static/media/splatalogue_logo.3ba0579e.png";i(1001);let XB=Object(p.a)(HB=class extends n.Component{render(){const e=gC.Instance,t=d()("spectral-line-query-splash-screen",{"bp3-dark":e.darkTheme});return Object(xm.jsx)("div",{className:t,children:Object(xm.jsxs)("div",{className:"content",children:[Object(xm.jsx)("a",{href:"https://splatalogue.online/",target:"_blank",rel:"noopener noreferrer",children:Object(xm.jsx)("img",{src:UB,width:250})}),Object(xm.jsx)("a",{href:"https://splatalogue.online/",target:"_blank",rel:"noopener noreferrer",children:"https://splatalogue.online/"}),this.props.splataloguePingStatus===xs.Checking?Object(xm.jsx)(u.O,{intent:g.a.PRIMARY,size:30,value:null}):Object(xm.jsx)(u.f,{vertical:!1,children:Object(xm.jsx)(j.a,{content:"Reconnect to Splatalogue",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{icon:"repeat",onClick:this.props.onReload})})}),Object(xm.jsx)("div",{className:"loadingInfo-div",children:Object(xm.jsx)("p",{children:this.props.splataloguePingStatus===xs.Checking?"Checking Splatalogue status...":"Connecting to Splatalogue failed! The service might be offline or your internet connection is interrupted. Please check and try again."})})]})})}})||HB;var $B,KB,QB,ZB,JB,eq,tq,iq;i(1002);!function(e){e.Name="Name",e.Description="Description",e.Display="Display"}(iq||(iq={}));let nq=Object(p.a)((KB=class extends n.Component{static get WIDGET_CONFIG(){return{id:"spectral-line-query",type:"spectral-line-query",minWidth:500,minHeight:400,defaultWidth:750,defaultHeight:600,title:"Spectral Line Query",isCloseable:!0,helpType:xM.SPECTRAL_LINE_QUERY}}constructor(e){super(e),Object(f.a)(this,"width",QB,this),Object(f.a)(this,"height",ZB,this),Object(f.a)(this,"widgetId",JB,this),Object(f.a)(this,"headerTableColumnWidths",eq,this),this.headerTableRef=void 0,this.resultTableRef=void 0,this.scrollToTopHandle=void 0,Object(f.a)(this,"onResize",tq,this),this.onTableResize=()=>{this.headerTableRef&&this.updateTableSize(this.headerTableRef,!1),this.resultTableRef&&this.updateTableSize(this.resultTableRef,!1)},this.handleRedshiftChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.widgetStore.redshiftInput;isFinite(i)&&i!==n&&(this.widgetStore.redshiftType===Rs.Z&&i>=0||this.widgetStore.redshiftType===Rs.V)?this.widgetStore.setRedshiftInput(i):e.currentTarget.value=n},this.updateHeaderTableColumnSize=(e,t)=>{this.headerTableColumnWidths&&(this.headerTableColumnWidths[e]=t)},this.handleEnterWidgetOption=(e,t)=>{if(t){const i=gC.Instance.widgetsStore.getSpectralWidgetStoreByID(t);i&&i.setHighlighted(e)}},this.handleFilter=()=>{this.widgetStore.filter(),clearTimeout(this.scrollToTopHandle),this.scrollToTopHandle=setTimeout((()=>{var e;return null===(e=this.resultTableRef)||void 0===e?void 0:e.scrollToRegion(qn.c.row(0))}),20)},this.handleResetFilter=()=>{this.widgetStore.resetFilter(),clearTimeout(this.scrollToTopHandle),this.scrollToTopHandle=setTimeout((()=>{var e;return null===(e=this.resultTableRef)||void 0===e?void 0:e.scrollToRegion(qn.c.row(0))}),20)},this.handlePlot=()=>{const e=this.widgetStore,t=gC.Instance,i=t.activeFrame,n=e.getSelectedLines();var r;e.selectedSpectralProfilerID&&i&&(null===n||void 0===n?void 0:n.length)>0&&(null===(r=t.widgetsStore.getSpectralWidgetStoreByID(e.selectedSpectralProfilerID))||void 0===r||r.addSpectralLines(n))},this.handleClear=()=>{const e=this.widgetStore,t=gC.Instance;if(e.selectedSpectralProfilerID){const i=t.widgetsStore.getSpectralWidgetStoreByID(e.selectedSpectralProfilerID);i&&i.clearSpectralLines()}},Object(m.p)(this),this.headerTableColumnWidths=[150,70,300]}get widgetStore(){const e=WP.Instance;if(e.spectralLineQueryWidgets){const t=e.spectralLineQueryWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}updateTableSize(e,t){const i=e.locator.getViewportRect();e.updateViewportRect(i),t&&e.scrollToRegion(qn.c.column(0))}setHeaderTableColumnWidts(e){this.headerTableColumnWidths=e}renderDataColumn(e,t){return Object(xm.jsx)(KO.a,{name:e,cellRenderer:(e,i)=>Object(xm.jsx)($O.a,{className:"header-table-cell",interactive:!0,children:t[e]},`cell_${i}_${e}`)},e)}renderSwitchButtonCell(e,t){var i,r;const o=this.widgetStore,s=null===(i=o.controlHeader)||void 0===i||null===(r=i.get(t))||void 0===r?void 0:r.display;return Object(xm.jsx)($O.a,{className:"header-table-cell",children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsx)(u.P,{className:"cell-switch-button",checked:null!==s&&void 0!==s&&s,onChange:e=>o.setHeaderDisplay(e.currentTarget.checked,t)},`cell_switch_button_${e}`)})},`cell_switch_${e}`)}renderButtonColumns(e,t){return Object(xm.jsx)(KO.a,{name:e,cellRenderer:e=>this.renderSwitchButtonCell(e,t[e])},e)}createHeaderTable(){var e,t;const i=[],n=[];null===(e=this.widgetStore.columnHeaders)||void 0===e||e.forEach((e=>{i.push(e.name),n.push(e.description)}));const r=[],o=this.renderDataColumn(iq.Name,i);r.push(o);const s=this.renderButtonColumns(iq.Display,i);r.push(s);const a=this.renderDataColumn(iq.Description,n);return r.push(a),Object(xm.jsx)(QO.a,{ref:e=>this.headerTableRef=e,numRows:null===(t=this.widgetStore.columnHeaders)||void 0===t?void 0:t.length,enableRowReordering:!1,renderMode:ZO.a.BATCH,selectionModes:qn.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,enableGhostCells:!0,numFrozenColumns:1,columnWidths:this.headerTableColumnWidths,onColumnWidthChanged:this.updateHeaderTableColumnSize,enableRowResizing:!1,children:r})}render(){const e=gC.Instance,t=this.widgetStore,i=(t.filters,Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"From",inline:!0,children:Object(xm.jsx)(pO,{value:t.queryRange[0],buttonPosition:"none",onValueChange:e=>t.setQueryRange([e,t.queryRange[1]])})}),Object(xm.jsx)(u.p,{label:"To",inline:!0,children:Object(xm.jsx)(pO,{value:t.queryRange[1],buttonPosition:"none",onValueChange:e=>t.setQueryRange([t.queryRange[0],e])})})]})),r=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{inline:!0,children:Object(xm.jsx)(pO,{value:t.queryRangeByCenter[0],buttonPosition:"none",onValueChange:e=>t.setQueryRangeByCenter([e,t.queryRangeByCenter[1]])})}),Object(xm.jsx)(u.p,{label:"\xb1",inline:!0,children:Object(xm.jsx)(pO,{value:t.queryRangeByCenter[1],buttonPosition:"none",onValueChange:e=>t.setQueryRangeByCenter([t.queryRangeByCenter[0],e])})})]}),o=Object(xm.jsxs)("div",{className:"query-panel",children:[Object(xm.jsxs)("div",{className:"query-panel-input",children:[Object(xm.jsx)(u.p,{inline:!0,children:Object(xm.jsx)(u.r,{options:[Ss.Range,Ss.Center],value:t.queryRangeType,onChange:e=>t.setQueryRangeType(e.currentTarget.value)})}),t.queryRangeType===Ss.Range?i:r,Object(xm.jsx)(u.p,{inline:!0,children:Object(xm.jsx)(u.r,{options:Object.values(vs),value:t.queryUnit,onChange:e=>t.setQueryUnit(e.currentTarget.value)})}),Object(xm.jsxs)(u.l,{className:"intensity-limit",children:[Object(xm.jsx)(u.p,{label:"Intensity Limit",inline:!0,children:Object(xm.jsx)(u.P,{checked:t.intensityLimitEnabled,onChange:()=>t.toggleIntensityLimit()})}),t.intensityLimitEnabled&&Object(xm.jsx)(j.a,{content:"CDMS/JPL intensity (log)",position:y.a.BOTTOM,children:Object(xm.jsx)(pO,{value:t.intensityLimitValue,buttonPosition:"none",onValueChange:e=>t.setIntensityLimitValue(e)})})]})]}),Object(xm.jsx)("div",{children:Object(xm.jsx)(u.e,{intent:g.a.PRIMARY,onClick:t.query,disabled:t.splataloguePingStatus!==xs.Success,children:"Query"})})]}),s=Object(xm.jsxs)("div",{className:"redshift-panel",children:[Object(xm.jsx)(u.p,{inline:!0,children:Object(xm.jsx)(u.r,{options:[Rs.V,Rs.Z],value:t.redshiftType,onChange:e=>t.setRedshiftType(e.currentTarget.value)})}),Object(xm.jsx)(u.p,{inline:!0,children:Object(xm.jsx)(pO,{value:t.redshiftInput,buttonPosition:"none",onBlur:this.handleRedshiftChange,onKeyDown:this.handleRedshiftChange})})]}),a=t.selectedSpectralProfilerID&&gC.Instance.widgetsStore.getSpectralWidgetStoreByID(t.selectedSpectralProfilerID),l=Object(xm.jsx)(O.a,{content:Object(xm.jsx)(u.z,{children:gC.Instance.widgetsStore.spectralProfilerList.map((e=>Object(xm.jsx)(u.B,{text:e,onMouseEnter:()=>this.handleEnterWidgetOption(!0,e),onMouseLeave:()=>this.handleEnterWidgetOption(!1,e),onClick:()=>{this.handleEnterWidgetOption(!1,e),t.setSelectedSpectralProfiler(e)}},e)))}),position:y.a.BOTTOM,minimal:!0,children:Object(xm.jsx)(u.e,{disabled:gC.Instance.widgetsStore.spectralProfilerList.length<=0,rightIcon:"caret-down",children:a?t.selectedSpectralProfilerID:"----"})}),c={filter:t.controlHeader,dataset:t.filterResult,columnHeaders:t.displayedColumnHeaders,numVisibleRows:t.numVisibleRows>0?t.numVisibleRows+3:t.numVisibleRows,flipRowSelection:t.selectSingleLine,updateTableRef:e=>{this.resultTableRef=e},disableSort:!0,updateColumnFilter:t.setColumnFilter,columnWidths:t.resultTableColumnWidths,updateTableColumnWidth:t.setResultTableColumnWidth,tableHeaders:t.columnHeaders},p=d()("spectral-line-query-widget",{"bp3-dark":e.darkTheme}),f=t.numSelectedLines<=1e3,b=Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:[f?"":"Please select no greater than 1000 lines.",f||a?"":Object(xm.jsx)("br",{}),a?"":"Please select one spectral profiler."]})})]}),m=Object(xm.jsxs)("span",{children:["Plot lines to selected profiler",b]});return Object(xm.jsxs)("div",{className:p,children:[t.splataloguePingStatus!==xs.Success&&Object(xm.jsx)(XB,{splataloguePingStatus:t.splataloguePingStatus,onReload:t.pingSplatalogue}),t.splataloguePingStatus===xs.Success&&Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsxs)("div",{className:"bp3-dialog-body",children:[o,Object(xm.jsxs)(YB.b,{className:"body-split-pane",split:"horizontal",primary:"second",defaultSize:"60%",minSize:"5%",onChange:this.onTableResize,children:[Object(xm.jsx)(YB.a,{className:"header-table-container",children:this.width>0&&this.createHeaderTable()}),Object(xm.jsxs)(YB.a,{className:"result-table-container",children:[s,Object(xm.jsx)("div",{className:"result-table",children:this.width>0&&Object(xm.jsx)(JO,{...c})})]})]})]}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer",children:[Object(xm.jsx)("div",{className:"result-table-info",children:Object(xm.jsx)("pre",{children:t.resultTableInfo})}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(u.p,{inline:!0,label:this.width<450?"":"Spectral Profiler",children:l}),Object(xm.jsx)(j.a,{content:"Apply filter",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{text:"Filter",intent:g.a.PRIMARY,disabled:t.numDataRows<=0,onClick:this.handleFilter})}),Object(xm.jsx)(j.a,{content:"Reset filter",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{text:"Reset",intent:g.a.PRIMARY,onClick:this.handleResetFilter})}),Object(xm.jsx)(j.a,{content:m,position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{text:"Plot",intent:g.a.PRIMARY,disabled:!e.activeFrame||t.filterResult.size<=0||!a||!f,onClick:this.handlePlot})}),Object(xm.jsx)(j.a,{content:"Clear plotted lines",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{text:"Clear",intent:g.a.PRIMARY,disabled:!e.activeFrame||!a||t.filterResult.size<=0,onClick:this.handleClear})})]})]})]}),Object(xm.jsx)(u.E,{className:hS.a.OVERLAY_SCROLL_CONTAINER,autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:t.isQuerying,usePortal:!1,children:Object(xm.jsx)("div",{className:"query-loading-overlay",children:Object(xm.jsx)(u.O,{intent:g.a.PRIMARY,size:30,value:null})})}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},QB=Object(b.a)(KB.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ZB=Object(b.a)(KB.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),JB=Object(b.a)(KB.prototype,"widgetId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eq=Object(b.a)(KB.prototype,"headerTableColumnWidths",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(KB.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(KB.prototype,"widgetStore"),KB.prototype),tq=Object(b.a)(KB.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t,this.headerTableRef&&this.updateTableSize(this.headerTableRef,this.props.docked),this.resultTableRef&&this.updateTableSize(this.resultTableRef,this.props.docked)}}}),Object(b.a)(KB.prototype,"setHeaderTableColumnWidts",[m.g],Object.getOwnPropertyDescriptor(KB.prototype,"setHeaderTableColumnWidts"),KB.prototype),$B=KB))||$B;var rq,oq,sq;i(1003);let aq=Object(p.a)(rq=class extends n.Component{render(){var e;const t=this.props.itemOptions,i=this.props.itemSelected;let n="";t&&(null===i||void 0===i?void 0:i.length)>0&&i.forEach(((e,r)=>{const o=t.find((t=>t.value===e));(null===o||void 0===o?void 0:o.label)&&(n+=`${o.label}${r!==i.length-1?",":""}`)}));let r="";var o;if(!this.props.disabled&&this.props.dropdownTooltip)if(this.props.disableOptions)r=null!==(o=this.props.dropdownTooltip.disabled)&&void 0!==o?o:"Selection is disabled.";else if(this.props.isActiveCategory){var s;r=null!==(s=this.props.dropdownTooltip.active)&&void 0!==s?s:"Click to select multiple items."}else{var a;r=null!==(a=this.props.dropdownTooltip.nonActive)&&void 0!==a?a:"Click to select an item."}const l=d()("category-set",{"bp3-dark":gC.Instance.darkTheme});return Object(xm.jsxs)("div",{className:l,children:[Object(xm.jsx)(j.a,{content:this.props.categoryTooltip,position:y.a.TOP,children:Object(xm.jsx)(u.h,{className:"category-checkbox",label:this.props.categoryName,checked:this.props.isActiveCategory,onChange:e=>this.props.onCategorySelect(),disabled:this.props.disabled})}),Object(xm.jsx)(O.a,{content:Object(xm.jsx)(u.z,{children:null===(e=this.props.itemOptions)||void 0===e?void 0:e.map(((e,t)=>{var i;return Object(xm.jsx)(u.B,{text:e.active?Object(xm.jsx)("b",{children:e.label}):e.label,disabled:null===e||void 0===e?void 0:e.disabled,intent:e.hightlight?g.a.PRIMARY:g.a.NONE,onClick:i=>this.props.onItemSelect(e.value,t),icon:(null===(i=this.props.itemSelected)||void 0===i?void 0:i.includes(e.value))?"tick":"blank",shouldDismissPopover:!1},e.value)}))}),minimal:!0,placement:y.a.BOTTOM,disabled:this.props.disabled||this.props.disableOptions,children:Object(xm.jsx)(j.a,{disabled:!r,content:r,position:y.a.TOP,children:Object(xm.jsx)(u.b,{text:Object(xm.jsx)("span",{className:"overflow-text",title:n,children:this.props.isSelectingSpecificItem?Object(xm.jsx)("b",{children:n}):n}),className:"dropdown-button",rightIcon:"caret-down",disabled:this.props.disabled||this.props.disableOptions})})})]})}})||rq,lq=Object(p.a)(oq=class extends n.Component{constructor(...e){super(...e),this.onFrameItemClick=(e,t)=>{this.props.profileSelectionStore.selectFrame(e)},this.onRegionItemClick=(e,t)=>{const i=this.props.profileSelectionStore;i.activeProfileCategory!==Rh.REGION?i.selectRegionSingleMode(e):i.selectRegionMultiMode(e,t+1)},this.onStatsItemClick=(e,t)=>{const i=this.props.profileSelectionStore;i.activeProfileCategory!==Rh.STATISTIC?i.selectStatSingleMode(e):i.selectStatMultiMode(e,t+1)},this.onStokesItemClick=(e,t)=>{const i=this.props.profileSelectionStore;i.activeProfileCategory!==Rh.STOKES?i.selectCoordinateSingleMode(e):i.selectCoordinateMultiMode(e,t+1)}}render(){const e=this.props.profileSelectionStore,t=e.selectedFrame,i=!(null===t||void 0===t?void 0:t.channelInfo);return Object(xm.jsxs)("div",{className:"profile-selection-panel",children:[Object(xm.jsx)(aq,{categoryName:Rh.IMAGE,isActiveCategory:e.activeProfileCategory===Rh.IMAGE,itemOptions:e.frameOptions,itemSelected:[e.selectedFrameWidgetFileId],disabled:!t,isSelectingSpecificItem:e.isSelectingActiveFrame,onCategorySelect:()=>{e.setActiveProfileCategory(e.activeProfileCategory!==Rh.IMAGE?Rh.IMAGE:Rh.NONE)},onItemSelect:this.onFrameItemClick,categoryTooltip:Object(xm.jsxs)("span",{children:[`Click to enable/disable multiple profiles of ${Rh.IMAGE}`,Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["When enabled, Spectral Profiler will show multiple profiles from",Object(xm.jsx)("br",{}),"different images which are matched both spatially and spectrally.",Object(xm.jsx)("br",{}),"Toggle both spatial(XY) and spectral(Z) matching in Image List widget."]})})]})]}),dropdownTooltip:{nonActive:"Click to select an image.",active:"Click to select an image. Images matched by toggling both spatial(XY) and spectral(Z) matching via Image List widget are highlighted.",disabled:void 0}}),Object(xm.jsx)(aq,{categoryName:Rh.REGION,isActiveCategory:e.activeProfileCategory===Rh.REGION,itemOptions:e.regionOptions,itemSelected:e.selectedRegionIds,disabled:i,isSelectingSpecificItem:e.isSelectingActiveRegion,onCategorySelect:()=>{e.setActiveProfileCategory(e.activeProfileCategory!==Rh.REGION?Rh.REGION:Rh.NONE)},onItemSelect:this.onRegionItemClick,categoryTooltip:Object(xm.jsxs)("span",{children:[`Click to enable/disable multiple selections of ${Rh.REGION}`,Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"When enabled, Spectral Profiler will show multiple profiles from different selected regions."})})]})]}),dropdownTooltip:{nonActive:"Click to select a region.",active:"Click to select multiple regions.",disabled:void 0}}),Object(xm.jsx)(aq,{categoryName:Rh.STATISTIC,isActiveCategory:e.activeProfileCategory===Rh.STATISTIC,itemOptions:e.statsTypeOptions,itemSelected:e.isStatsTypeSelectionAvailable?e.selectedStatsTypes:[Nt.StatsType.Mean],disabled:i,disableOptions:!e.isStatsTypeSelectionAvailable,onCategorySelect:()=>{e.setActiveProfileCategory(e.activeProfileCategory!==Rh.STATISTIC?Rh.STATISTIC:Rh.NONE)},onItemSelect:this.onStatsItemClick,categoryTooltip:Object(xm.jsxs)("span",{children:[`Click to enable/disable multiple selections of ${Rh.STATISTIC}`,Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"When enabled, Spectral Profiler will show multiple profiles with different selected statistic quantities."})})]})]}),dropdownTooltip:{nonActive:"Click to select a statistic quantity.",active:"Click to select multiple statistic quantities.",disabled:"Statistic options are available only for non-point regions."}}),Object(xm.jsx)(aq,{categoryName:Rh.STOKES,isActiveCategory:e.activeProfileCategory===Rh.STOKES,itemOptions:e.coordinateOptions,itemSelected:e.selectedCoordinates,disabled:i,disableOptions:!(null===t||void 0===t?void 0:t.hasStokes),onCategorySelect:()=>{e.setActiveProfileCategory(e.activeProfileCategory!==Rh.STOKES?Rh.STOKES:Rh.NONE)},onItemSelect:this.onStokesItemClick,categoryTooltip:Object(xm.jsxs)("span",{children:[`Click to enable/disable multiple selections of ${Rh.STOKES}`,Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsx)("small",{children:"When enabled, Spectral Profiler will show multiple profiles with different selected Stokes."})})]})]}),dropdownTooltip:{nonActive:"Click to select a Stokes parameter.",active:"Click to select multiple Stokes parameters.",disabled:"There is no other Stokes parameter in the selected image."}})]})}})||oq,cq=Object(p.a)(sq=class extends n.Component{constructor(...e){super(...e),this.smoothingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(fH.SMOOTHING),gC.Instance.widgetsStore.createFloatingSettingsWidget(bq.WIDGET_CONFIG.title,this.props.id,bq.WIDGET_CONFIG.type)},this.momentsShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(fH.MOMENTS),gC.Instance.widgetsStore.createFloatingSettingsWidget(bq.WIDGET_CONFIG.title,this.props.id,bq.WIDGET_CONFIG.type)},this.fittingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(fH.FITTING),gC.Instance.widgetsStore.createFloatingSettingsWidget(bq.WIDGET_CONFIG.title,this.props.id,bq.WIDGET_CONFIG.type)}}render(){const e=this.props.widgetStore;return Object(xm.jsxs)("div",{className:"spectral-profiler-toolbar",children:[Object(xm.jsx)(lq,{profileSelectionStore:e.profileSelectionStore}),Object(xm.jsxs)(u.f,{className:"shortcut-buttons",children:[Object(xm.jsx)(j.a,{content:"Smoothing",children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"smoothing"}),onClick:this.smoothingShortcutClick})}),Object(xm.jsx)(j.a,{content:"Moments",children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"moments"}),onClick:this.momentsShortcutClick})}),Object(xm.jsx)(j.a,{content:"Fitting",children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"lineFitting"}),onClick:this.fittingShortcutClick})})]})]})}})||sq;i(1004);const dq=e=>{var t;return Object(xm.jsx)("div",{className:"spectral-profiler-info",children:null===(t=e.profileInfo)||void 0===t?void 0:t.map(((e,t)=>{const i=(null===e||void 0===e?void 0:e.color)?Object(xm.jsx)("div",{style:{height:"12px",width:"12px",margin:"0 5px 0 0",background:e.color}}):null;return Object(xm.jsx)("div",{className:"profile-legend",children:Object(xm.jsxs)("div",{className:"profile-info",children:[i,Object(xm.jsx)("pre",{children:e.infoString})]})},t)}))})};var pq,hq,uq,gq,fq;i(1005);let bq=Object(p.a)((hq=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"spectral-profiler",type:"spectral-profiler",minWidth:880,minHeight:300,defaultWidth:870,defaultHeight:300,title:"Z Profile: Cursor",isCloseable:!0,helpType:xM.SPECTRAL_PROFILER}}get widgetStore(){const e=WP.Instance;if(e.spectralProfileWidgets){const t=e.spectralProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new lh}get plotData(){return this.widgetStore.plotData}get isMeanRmsVisible(){var e;return this.widgetStore.meanRmsVisible&&1===(null===(e=this.plotData)||void 0===e?void 0:e.numProfiles)}constructor(t){super(t),Object(f.a)(this,"width",uq,this),Object(f.a)(this,"height",gq,this),Object(f.a)(this,"onResize",fq,this),this.onChannelChanged=e=>{const t=this.widgetStore.effectiveFrame;if(null===e||void 0===e||!isFinite(e)||dS.Instance.animationActive||this.widgetStore.fittingStore.isCursorSelectingComponent)return;const i=t.findChannelIndexByValue(e);t&&isFinite(i)&&i>=0&&i<t.numChannels&&t.setChannels(i,t.requiredStokes,!0)},this.onGraphCursorMoved=T.throttle((e=>{this.widgetStore.setCursor(e)}),33),this.genCursoInfoString=(e,t,i,n)=>{var r;let o;const s=P(e,t);if((null===s||void 0===s?void 0:s.point)&&(null===s||void 0===s?void 0:s.index)>=0&&(null===s||void 0===s?void 0:s.index)<(null===e||void 0===e?void 0:e.length)){let t="";const n=s.index-1>=0?Math.abs(s.point.x-e[s.index-1].x):0;t=n>0&&n<1e-6?bi(s.point.x):fi(s.point.x,n>=1e-6&&n<.001?6:3);o=`(${"Channel"===i?`Channel ${fi(s.point.x)}`:`${t}${i?` ${i}`:""}`}, ${gi(s.point.y,2)})`}return`${n}: ${null!==(r=o)&&void 0!==r?r:"---"}`},this.genProfilerInfo=()=>{var e,t;let i=[];const n=this.widgetStore.effectiveFrame;if(n&&(null===(e=this.plotData)||void 0===e?void 0:e.numProfiles)>0&&(null===(t=this.plotData)||void 0===t?void 0:t.data)){const e=this.widgetStore.isMouseMoveIntoLinePlots,t=e?"Cursor":"Data",c=e?this.widgetStore.cursorX:this.currentChannelValue,d=n.spectralUnitStr;if(1===this.plotData.numProfiles){const e=this.plotData.data[0],n=this.genCursoInfoString(e,c,d,t);i.push({infoString:this.isMeanRmsVisible?`${n}, Mean/RMS: ${mi(this.plotData.yMean,2)}/${mi(this.plotData.yRms,2)}`:n})}else for(let n=0;n<this.plotData.numProfiles;n++){var r,o,s,a,l;const e=this.plotData.data[n],p=this.genCursoInfoString(e,c,d,t);i.push({color:null===(r=this.plotData.colors)||void 0===r?void 0:r[n],infoString:`${p}, ${null===(o=this.plotData.labels)||void 0===o||null===(s=o[n])||void 0===s?void 0:s.image}, ${null===(a=this.plotData.labels)||void 0===a||null===(l=a[n])||void 0===l?void 0:l.plot}`})}}return i},this.setSelectedRange=(e,t)=>{isFinite(e)&&isFinite(t)&&(this.widgetStore.isSelectingMomentChannelRange?this.widgetStore.setSelectedChannelRange(e,t):this.widgetStore.isSelectingMomentMaskRange&&this.widgetStore.setSelectedMaskRange(e,t))},this.setSelectedLine=(e,t,i,n)=>{if(isFinite(e)&&isFinite(t)&&isFinite(i)&&isFinite(n))if(this.widgetStore.fittingStore.isCursorSelectingYIntercept)this.widgetStore.fittingStore.setYIntercept((i+n)/2),this.widgetStore.fittingStore.setIsCursorSelectingYIntercept(!1);else if(this.widgetStore.fittingStore.isCursorSelectingSlope){const r=(n-i)/(t-e);this.widgetStore.fittingStore.setYIntercept(i-r*e),this.widgetStore.fittingStore.setSlope(r),this.widgetStore.fittingStore.setIsCursorSelectingSlope(!1)}},this.setSelectedBox=(e,t,i,n)=>{isFinite(e)&&isFinite(t)&&isFinite(i)&&isFinite(n)&&this.widgetStore.fittingStore.setComponentByCursor(e,t,i,n)},this.fillVisibleSpectralLines=()=>{let e=[];const t=this.widgetStore.transformedSpectralLines;if((null===t||void 0===t?void 0:t.length)>0){let i,n;this.plotData&&(i=this.widgetStore.isAutoScaledX?this.plotData.xMin:this.widgetStore.minX,n=this.widgetStore.isAutoScaledX?this.plotData.xMax:this.widgetStore.maxX);for(let r=0;r<t.length;r++){const o=t[r];isFinite(i)&&isFinite(n)&&o&&isFinite(o.value)&&o.value>=i&&o.value<=n&&e.push({value:o.value,id:`spectral-line-${r}`,label:`${o.species} ${o.qn}`,draggable:!1,horizontal:!1,color:gC.Instance.darkTheme?L.a.GREEN4:L.a.GREEN2})}}return e},Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.spectralProfileWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.addSpectralProfileWidget(this.props.id));else{const e=i.widgetsStore.addSpectralProfileWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)((()=>{let e="Z Profile";const t=this.plotData;if(this.widgetStore&&t&&isFinite(t.progress))if(t.progress<1){const i=100*t.numProfiles;e+=`: [${fi(t.progress*i)}%/${i}% complete]`,this.widgetStore.updateStreamingDataStatus(!0)}else this.widgetStore.updateStreamingDataStatus(!1);i.widgetsStore.setWidgetTitle(this.props.id,e)}))}get currentChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.channel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get requiredChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.requiredChannel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get linePlotSelectingMode(){return this.widgetStore.isSelectingMomentChannelRange?Zy.HORIZONTAL:this.widgetStore.isSelectingMomentMaskRange?Zy.VERTICAL:this.widgetStore.fittingStore.isCursorSelectingYIntercept||this.widgetStore.fittingStore.isCursorSelectingSlope?Zy.LINE:(this.widgetStore.fittingStore.isCursorSelectingComponent,Zy.BOX)}render(){var e;const t=gC.Instance;if(!this.widgetStore)return Object(xm.jsx)(u.C,{icon:"error",title:"Missing profile",description:"Profile not found"});let i={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,tickTypeY:Ry.Scientific,graphClicked:this.onChannelChanged,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,markers:this.fillVisibleSpectralLines(),mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,selectingMode:this.linePlotSelectingMode,setSelectedRange:this.setSelectedRange,isSelectingInsideBox:this.widgetStore.fittingStore.isCursorSelectingComponent,setSelectedInsideBox:this.setSelectedBox,setSelectedLine:this.setSelectedLine,insideBoxes:this.widgetStore.fittingStore.componentPlottingBoxes,insideTexts:this.widgetStore.fittingStore.componentResultNumber,zeroLineWidth:2,order:1,multiPlotPropsMap:new Map};const n=this.widgetStore.effectiveFrame;if(n){n.spectralAxis&&!n.isCoordChannel&&(i.xLabel=n.spectralLabel),this.widgetStore.yUnit&&(i.yLabel=`Value (${this.widgetStore.yUnit})`);const e=this.plotData,d=this.widgetStore.fittingStore;if((null===e||void 0===e?void 0:e.numProfiles)>0){var r,o;i.imageName=null===(r=e.plotName)||void 0===r?void 0:r.image,i.plotName=null===(o=e.plotName)||void 0===o?void 0:o.plot;for(let n=0;n<e.numProfiles;n++){var s,a,l,c,p;const t=this.widgetStore.smoothingStore,r=null===(s=e.labels[n])||void 0===s?void 0:s.image,o=null===(a=`Z-profile-${null===(l=e.labels[n])||void 0===l?void 0:l.plot}`.replace(/,\s/g,"-"))||void 0===a?void 0:a.replace(/\s/g,"_");n<(null===(c=e.data)||void 0===c?void 0:c.length)&&i.multiPlotPropsMap.set(`profile${n}`,{imageName:r,plotName:o,data:e.data[n],type:this.widgetStore.plotType,borderColor:e.colors[n],comments:e.comments[n],order:1,hidden:t.type!==GO.NONE&&!t.isOverlayOn,followingData:1===this.widgetStore.profileNum&&d.hasResult&&t.type===GO.NONE?["fittingModel","fittingResidual"]:null}),t.type!==GO.NONE&&n<(null===(p=e.smoothedData)||void 0===p?void 0:p.length)&&i.multiPlotPropsMap.set(`smoothedProfile${n}`,{imageName:r,plotName:`${o}-smoothed`,data:e.smoothedData[n],type:t.lineType,borderColor:e.numProfiles>1?e.colors[n]:Jb(t.lineColor),borderWidth:e.numProfiles>1?this.widgetStore.lineWidth+1:t.lineWidth,pointRadius:t.pointRadius,order:0,comments:[...e.comments[n],...t.comments],followingData:1===this.widgetStore.profileNum&&d.hasResult?["fittingModel","fittingResidual"]:null})}i.opacity=e.progress<1?.15+e.progress/4:1;let t=Jb(this.widgetStore.primaryLineColor);if(i.lineColor=t,1===this.widgetStore.profileNum){if(d.continuum!==BM.NONE&&!d.hasResult){let t={imageName:e.plotName.image,plotName:e.plotName.plot,data:d.baseLinePoint2DArray,type:oO.LINES,borderColor:Jb("auto-lime"),borderWidth:2,pointRadius:1,order:0,noExport:!0};i.multiPlotPropsMap.set("fittingBaseline",t)}if(d.hasResult){let t={imageName:e.plotName.image,plotName:e.plotName.plot,data:d.modelPoint2DArray,type:oO.LINES,borderColor:Jb("auto-orange"),borderWidth:2,pointRadius:1,order:0,noExport:!0};i.multiPlotPropsMap.set("fittingModel",t);for(let n=0;n<d.individualModelPoint2DArrays.length;n++){const t={imageName:e.plotName.image,plotName:e.plotName.plot,data:d.individualModelPoint2DArrays[n],type:oO.LINES,borderColor:Jb("auto-orange"),borderWidth:2,pointRadius:1,order:0,opacity:.6,noExport:!0};i.multiPlotPropsMap.set(`fittingModel(${n+1})`,t)}if(d.enableResidual){let t={imageName:e.plotName.image,plotName:e.plotName.plot,data:d.residualPoint2DArray,type:oO.POINTS,borderColor:Jb("auto-orange"),borderWidth:2,pointRadius:1,order:0,noExport:!0};i.multiPlotPropsMap.set("fittingResidual",t)}}}this.widgetStore.isAutoScaledX?(i.xMin=e.xMin,i.xMax=e.xMax):(i.xMin=this.widgetStore.minX,i.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(i.yMin=e.yMin,i.yMax=e.yMax):(i.yMin=this.widgetStore.minY,i.yMax=this.widgetStore.maxY)}isNaN(this.widgetStore.cursorX)||i.markers.push({value:this.widgetStore.cursorX,id:"marker-profiler-cursor",draggable:!1,horizontal:!1,color:t.darkTheme?L.a.GRAY4:L.a.GRAY2,opacity:.8,isMouseMove:!0}),isNaN(this.currentChannelValue)||i.markers.push({value:this.currentChannelValue,id:"marker-channel-current",opacity:.4,draggable:!1,horizontal:!1}),isNaN(this.requiredChannelValue)||i.markers.push({value:this.requiredChannelValue,id:"marker-channel-required",draggable:!dS.Instance.animationActive,dragMove:this.onChannelChanged,horizontal:!1}),this.isMeanRmsVisible&&isFinite(e.yMean)&&isFinite(e.yRms)&&(i.markers.push({value:e.yMean,id:"marker-mean",draggable:!1,horizontal:!0,color:t.darkTheme?L.a.GREEN4:L.a.GREEN2,dash:[5]}),i.markers.push({value:e.yMean,id:"marker-rms",draggable:!1,horizontal:!0,width:e.yRms,opacity:.2,color:t.darkTheme?L.a.GREEN4:L.a.GREEN2}));const h=this.widgetStore.selectedRange;h&&isFinite(h.center)&&isFinite(h.width)&&i.markers.push({value:h.center,id:"marker-range",draggable:!1,horizontal:h.isHorizontal,width:h.width/2,opacity:.2,color:t.darkTheme?L.a.GRAY4:L.a.GRAY2})}const g=d()("spectral-profiler-widget",{"bp3-dark":t.darkTheme,"linked-to-widget-highlighted":this.widgetStore.isHighlighted});return Object(xm.jsxs)("div",{className:g,children:[Object(xm.jsxs)("div",{className:"profile-container",children:[Object(xm.jsx)("div",{className:"profile-toolbar",children:Object(xm.jsx)(cq,{widgetStore:this.widgetStore,id:this.props.id})}),Object(xm.jsxs)(YB.b,{className:"body-split-pane",split:"horizontal",primary:"second",defaultSize:Gi((null===(e=this.plotData)||void 0===e?void 0:e.numProfiles)>0?20*this.plotData.numProfiles:28,28,100),minSize:28,children:[Object(xm.jsx)(YB.a,{className:"line-plot-container",children:Object(xm.jsx)(iO,{...i})}),Object(xm.jsx)(YB.a,{className:"info-container",children:Object(xm.jsx)(dq,{profileInfo:this.genProfilerInfo()})})]})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},uq=Object(b.a)(hq.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gq=Object(b.a)(hq.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(hq.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(hq.prototype,"widgetStore"),hq.prototype),Object(b.a)(hq.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(hq.prototype,"plotData"),hq.prototype),Object(b.a)(hq.prototype,"isMeanRmsVisible",[m.i],Object.getOwnPropertyDescriptor(hq.prototype,"isMeanRmsVisible"),hq.prototype),fq=Object(b.a)(hq.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Object(b.a)(hq.prototype,"currentChannelValue",[m.i],Object.getOwnPropertyDescriptor(hq.prototype,"currentChannelValue"),hq.prototype),Object(b.a)(hq.prototype,"requiredChannelValue",[m.i],Object.getOwnPropertyDescriptor(hq.prototype,"requiredChannelValue"),hq.prototype),Object(b.a)(hq.prototype,"linePlotSelectingMode",[m.i],Object.getOwnPropertyDescriptor(hq.prototype,"linePlotSelectingMode"),hq.prototype),pq=hq))||pq;var mq,yq,Oq,jq,xq,Sq,vq,Cq,Iq,wq;i(1006);let Tq=Object(p.a)((wq=Iq=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"stats",type:"stats",minWidth:400,minHeight:200,defaultWidth:475,defaultHeight:325,title:"Statistics",isCloseable:!0,helpType:xM.STATS}}get widgetStore(){const e=WP.Instance;if(e.statsWidgets){const t=e.statsWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new ks}get statsData(){const e=gC.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId,i=this.widgetStore.effectiveRegionId,n=this.widgetStore.coordinate;const r=e.regionStats.get(t);if(!r)return null;const o=r.get(i);if(!o)return null;const s=this.widgetStore.effectiveFrame.polarizationInfo.findIndex((e=>e.replace("Stokes ","")===n.slice(0,n.length-1))),a=s>=this.widgetStore.effectiveFrame.frameInfo.fileInfoExtended.stokes?this.widgetStore.effectiveFrame.polarizations[s]:s;return o.get(-1===a?this.widgetStore.effectiveFrame.requiredStokes:a)}return null}constructor(t){super(t),Object(f.a)(this,"width",Oq,this),Object(f.a)(this,"height",jq,this),Object(f.a)(this,"isMouseEntered",xq,this),Object(f.a)(this,"showMouseEnterWidget",Sq,this),Object(f.a)(this,"hideMouseEnterWidget",vq,this),this.handleCoordinateChanged=e=>{this.widgetStore.setCoordinate(e.target.value)},Object(f.a)(this,"onResize",Cq,this),this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget()},this.getTableValue=(e,t)=>{var i;let n="",r="";if(this.statsData&&isFinite(e)&&e>=0&&e<(null===(i=this.statsData.statistics)||void 0===i?void 0:i.length)){const i=this.widgetStore.effectiveFrame;if(i&&i.headerUnit){let e;e=[er.PFtotal,er.PFlinear].includes(this.widgetStore.effectivePolarization)?"%":this.widgetStore.effectivePolarization===er.Pangle?"degree":i.headerUnit,r=t===Nt.StatsType.NumPixels?"pixel(s)":t===Nt.StatsType.SumSq?`(${e})^2`:t===Nt.StatsType.FluxDensity?e.replace(/\/beam/i,""):e}const o=this.statsData.statistics[e].value;n=gi(o,12),r=isFinite(o)?r:""}return{num:n,unit:r}},this.exportData=()=>{const t=this.widgetStore.effectiveFrame;if(this.statsData&&t){const i=t.filename,n="statistics",r=`# ${i} ${n}\n`;let o="";const s=this.widgetStore.effectiveRegionId;if(-1!==s){const e=t.getRegionProperties(s);null===e||void 0===e||e.forEach((e=>o+=`# ${e}\n`))}else o+="# full image\n";let a=`${t.channelInfo?`# channel: ${t.spectralInfo.channel}\n`:""}${t.hasStokes?`# stokes: ${t.requiredPolarizationInfo}\n`:""}${o}`;const l="# Statistic\tValue\tUnit\n";let c="";e.STATS_NAME_MAP.forEach(((e,t)=>{var i,n;const r=null===(i=this.statsData.statistics)||void 0===i?void 0:i.findIndex((e=>e.statsType===t));if(r>=0&&r<(null===(n=this.statsData.statistics)||void 0===n?void 0:n.length)){const i=this.getTableValue(r,t);i.unit=""===i.unit?"N/A":i.unit,c+=`${e.padEnd(12)}\t${i.num}\t${i.unit}\n`}})),Hm(i,n,`${r}${a}${l}${c}`)}},Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.statsWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.statsWidgets.set(this.props.id,new ks));else{const e=i.widgetsStore.addStatsWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)((()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){let e="Unknown";const t=this.widgetStore.effectiveRegionId,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";if(-1===t)e="Image";else if(this.widgetStore.effectiveFrame.regionSet){const i=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===t));i&&(e=i.nameString)}i.widgetsStore.setWidgetTitle(this.props.id,`Statistics: ${e} ${n}`)}else i.widgetsStore.setWidgetTitle(this.props.id,"Statistics")})),Object(m.h)((()=>{!this.widgetStore.effectiveFrame||this.widgetStore.effectiveFrame.coordinateOptionsZ.find((e=>e.value===this.widgetStore.coordinate))&&this.widgetStore.effectiveFrame.polarizationInfo||this.widgetStore.setCoordinate("z")}))}render(){var t;const i=gC.Instance,n=this.widgetStore;let r=!1,o="unlinked-to-selected";const s=[{value:"z",label:"Current"}];let a;(null===(t=n.effectiveFrame)||void 0===t?void 0:t.regionSet)&&(r=n.effectiveFrame.hasStokes,s.push(...n.effectiveFrame.coordinateOptionsZ),r&&n.isEffectiveFrameEqualToActiveFrame&&n.coordinate===Zn.get(n.effectiveFrame.requiredPolarization)+"z"&&(o=d()("linked-to-selected-stokes",{"dark-theme":i.darkTheme})));let l=null;if(this.statsData){const t=Math.max(0,this.width-e.NAME_COLUMN_WIDTH);let n=[];e.STATS_NAME_MAP.forEach(((i,r)=>{var o;const s=null===(o=this.statsData.statistics)||void 0===o?void 0:o.findIndex((e=>e.statsType===r));if(s>=0&&s<this.statsData.statistics.length){const o=this.getTableValue(s,r);n.push(Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("td",{style:{width:e.NAME_COLUMN_WIDTH},children:i}),Object(xm.jsxs)("td",{style:{width:t},children:[o.num," ",o.unit]})]},r))}})),a=Object(xm.jsxs)(u.s,{children:[Object(xm.jsx)("thead",{className:i.darkTheme?"dark-theme":"",children:Object(xm.jsxs)("tr",{children:[Object(xm.jsx)("th",{style:{width:e.NAME_COLUMN_WIDTH},children:"Statistic"}),Object(xm.jsx)("th",{style:{width:t},children:"Value"})]})}),Object(xm.jsx)("tbody",{className:i.darkTheme?"dark-theme":"",children:n})]}),l=Object(xm.jsx)("div",{className:"stats-export-data",children:Object(xm.jsx)(Ey,{darkMode:i.darkTheme,visible:this.isMouseEntered,exportData:this.exportData})})}else a=Object(xm.jsx)(u.C,{icon:"folder-open",title:"No stats data",description:"Select a valid region from the dropdown"});const c=d()("stats-widget",{"dark-theme":i.darkTheme});return Object(xm.jsxs)("div",{className:c,children:[Object(xm.jsxs)("div",{className:"stats-toolbar",children:[Object(xm.jsx)(dO,{widgetStore:this.widgetStore}),Object(xm.jsx)(u.p,{label:"Polarization",inline:!0,disabled:!r,children:Object(xm.jsx)(u.r,{className:o,value:n.coordinate,options:s,onChange:this.handleCoordinateChanged,disabled:!r})})]}),Object(xm.jsxs)("div",{className:"stats-display",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[a,l]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},Iq.STATS_NAME_MAP=new Map([[Nt.StatsType.NumPixels,"NumPixels"],[Nt.StatsType.Sum,"Sum"],[Nt.StatsType.FluxDensity,"FluxDensity"],[Nt.StatsType.Mean,"Mean"],[Nt.StatsType.Sigma,"StdDev"],[Nt.StatsType.Min,"Min"],[Nt.StatsType.Max,"Max"],[Nt.StatsType.Extrema,"Extrema"],[Nt.StatsType.RMS,"RMS"],[Nt.StatsType.SumSq,"SumSq"]]),Iq.NAME_COLUMN_WIDTH=90,yq=wq,Oq=Object(b.a)(yq.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),jq=Object(b.a)(yq.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),xq=Object(b.a)(yq.prototype,"isMouseEntered",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(b.a)(yq.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(yq.prototype,"widgetStore"),yq.prototype),Object(b.a)(yq.prototype,"statsData",[m.i],Object.getOwnPropertyDescriptor(yq.prototype,"statsData"),yq.prototype),Sq=Object(b.a)(yq.prototype,"showMouseEnterWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0}}}),vq=Object(b.a)(yq.prototype,"hideMouseEnterWidget",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1}}}),Cq=Object(b.a)(yq.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),mq=yq))||mq;var Rq;i(1007);let Aq=Object(p.a)(Rq=class extends n.Component{constructor(e){super(e),this.handleCoordinateChanged=e=>{this.props.widgetStore.setCoordinate(e.target.value)};const t=this.props.widgetStore;Object(m.h)((()=>{!t.effectiveFrame||t.effectiveFrame.coordinateOptionsZ.find((e=>e.value===t.coordinate))&&t.effectiveFrame.polarizationInfo||t.setCoordinate("z")}))}render(){var e;const t=this.props.widgetStore;let i=!1,n="unlinked-to-selected";const r=[{value:"z",label:"Current"}];if((null===(e=t.effectiveFrame)||void 0===e?void 0:e.regionSet)&&(i=t.effectiveFrame.hasStokes,r.push(...t.effectiveFrame.coordinateOptionsZ),i&&t.isEffectiveFrameEqualToActiveFrame&&t.coordinate===Zn.get(t.effectiveFrame.requiredPolarization)+"z")){const e="linked-to-selected-stokes";n=gC.Instance.darkTheme?`${e} dark-theme`:e}return Object(xm.jsxs)("div",{className:"spectral-profiler-toolbar",children:[Object(xm.jsx)(dO,{widgetStore:this.props.widgetStore}),Object(xm.jsx)(u.p,{label:"Polarization",inline:!0,disabled:!i,children:Object(xm.jsx)(u.r,{className:n,value:t.coordinate,options:r,onChange:this.handleCoordinateChanged,disabled:!i})})]})}})||Rq;var Pq,Eq,Mq,Fq,kq;i(1008);let Dq=Object(p.a)((Eq=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"histogram",type:"histogram",minWidth:400,minHeight:225,defaultWidth:650,defaultHeight:225,title:"Histogram",isCloseable:!0,helpType:xM.HISTOGRAM}}get widgetStore(){const e=WP.Instance;if(e.histogramWidgets){const t=e.histogramWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new pa}get histogramData(){const e=gC.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId,i=this.widgetStore.effectiveRegionId,n=this.widgetStore.coordinate;const r=e.regionHistograms.get(t);if(!r)return null;const o=r.get(i);if(!o)return null;const s=this.widgetStore.effectiveFrame.polarizationInfo.findIndex((e=>e.replace("Stokes ","")===n.slice(0,n.length-1))),a=s>=this.widgetStore.effectiveFrame.frameInfo.fileInfoExtended.stokes?this.widgetStore.effectiveFrame.polarizations[s]:s,l=o.get(-1===a?this.widgetStore.effectiveFrame.requiredStokes:a);return l?l.histograms:null}return null}get plotData(){const e=this.histogramData;if(e){let t=0,i=e.bins.length-1;this.widgetStore.isAutoScaledX||(t=Math.floor((this.widgetStore.minX-e.firstBinCenter)/e.binWidth),t=Gi(t,0,e.bins.length-1),i=Math.ceil((this.widgetStore.maxX-e.firstBinCenter)/e.binWidth),i=Gi(i,0,e.bins.length-1));let n,r=e.firstBinCenter+e.binWidth*t,o=e.firstBinCenter+e.binWidth*i,s=e.bins[t],a=s;const l=i-t;if(l>0&&!isNaN(l)){n=new Array(i-t);for(let r=t;r<=i;r++)n[r-t]={x:e.firstBinCenter+e.binWidth*r,y:e.bins[r]},s=Math.min(s,e.bins[r]),a=Math.max(a,e.bins[r])}return{values:n,xMin:r,xMax:o,yMin:s,yMax:a}}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find((e=>e.regionId===i));n&&e.push(n.regionProperties)}return e}constructor(t){super(t),this.cachedFrame=void 0,Object(f.a)(this,"width",Mq,this),Object(f.a)(this,"height",Fq,this),Object(f.a)(this,"onResize",kq,this),this.onGraphCursorMoved=T.throttle((e=>{this.widgetStore.setCursor(e)}),100),this.genProfilerInfo=e=>{let t=[];if(this.plotData&&this.widgetStore.isMouseMoveIntoLinePlots){let i;i=this.widgetStore.cursorX<1e-5?gi(this.widgetStore.cursorX,5):fi(this.widgetStore.cursorX,5);const n=P(this.plotData.values,this.widgetStore.cursorX);if(null===n||void 0===n?void 0:n.point){let r=`${.5!==n.point.y?n.point.y:0}`;e&&(i+=` ${e}`),n.point.y<=1?r+=" Count":r+=" Counts",(this.widgetStore.cursorX>this.plotData.xMax||this.widgetStore.cursorX<this.plotData.xMin)&&(r="NaN"),t.push(`Cursor: ${i}, ${r}`)}}return t},Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.histogramWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.histogramWidgets.set(this.props.id,new pa));else{const e=i.widgetsStore.addHistogramWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)((()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){let e="Unknown";const t=this.widgetStore.effectiveRegionId;if(-1===t)e="Image";else if(this.widgetStore.effectiveFrame.regionSet){const i=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===t));i&&(e=i.nameString)}const n=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`Histogram: ${e} ${n}`)}else i.widgetsStore.setWidgetTitle(this.props.id,"Histogram");const e=this.widgetStore;if(e){const t=this.plotData;t&&e.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}}))}componentDidUpdate(){const e=this.widgetStore.effectiveFrame;e!==this.cachedFrame&&(this.cachedFrame=e,this.widgetStore.clearXYBounds())}render(){const e=gC.Instance,t=this.widgetStore.effectiveFrame;if(!t||!this.widgetStore)return Object(xm.jsx)("div",{className:"histogram-widget",children:Object(xm.jsx)(u.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});let i="";t&&t.headerUnit&&(i=[er.PFtotal,er.PFlinear].includes(this.widgetStore.effectivePolarization)?"%":this.widgetStore.effectivePolarization===er.Pangle?"degree":t.headerUnit);const n=t.filename,r=`channel ${t.channel} histogram`;let o={xLabel:i?`Value (${i})`:"Value",yLabel:"Count",darkMode:e.darkTheme,imageName:n,plotName:r,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,tickTypeY:Ry.Scientific,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2};if(t.renderConfig.histogram&&t.renderConfig.histogram.bins&&t.renderConfig.histogram.bins.length){const e=this.plotData;if(e){o.data=e.values;let t=Jb(this.widgetStore.primaryLineColor);o.lineColor=t,this.widgetStore.isAutoScaledX?(o.xMin=e.xMin,o.xMax=e.xMax):(o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(o.yMin=e.yMin,o.yMax=e.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5)}o.comments=this.exportHeaders}const s=d()("histogram-widget",{"bp3-dark":e.darkTheme});return Object(xm.jsxs)("div",{className:s,children:[Object(xm.jsxs)("div",{className:"histogram-container",children:[Object(xm.jsx)(Aq,{widgetStore:this.widgetStore}),Object(xm.jsx)("div",{className:"histogram-plot",children:Object(xm.jsx)(iO,{...o})}),Object(xm.jsx)("div",{children:Object(xm.jsx)(lO,{info:this.genProfilerInfo(i)})})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle"})]})}},Mq=Object(b.a)(Eq.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fq=Object(b.a)(Eq.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Eq.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Eq.prototype,"widgetStore"),Eq.prototype),Object(b.a)(Eq.prototype,"histogramData",[m.i],Object.getOwnPropertyDescriptor(Eq.prototype,"histogramData"),Eq.prototype),Object(b.a)(Eq.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(Eq.prototype,"plotData"),Eq.prototype),Object(b.a)(Eq.prototype,"exportHeaders",[m.i],Object.getOwnPropertyDescriptor(Eq.prototype,"exportHeaders"),Eq.prototype),kq=Object(b.a)(Eq.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Pq=Eq))||Pq;var Lq;i(1009);let Nq=Object(p.a)(Lq=class extends n.Component{constructor(...e){super(...e),this.handleFractionalPolChanged=e=>{this.props.widgetStore.setFractionalPolVisible(e.target.checked)},this.smoothingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(lH.SMOOTHING),gC.Instance.widgetsStore.createFloatingSettingsWidget(Hq.WIDGET_CONFIG.title,this.props.id,Hq.WIDGET_CONFIG.type)},this.handleFrameChanged=e=>{!e||!e.regionSet||e.frameInfo.fileInfoExtended.stokes>1||this.props.widgetStore.setFractionalPolVisible(!1)}}render(){var e,t;const i=this.props.widgetStore,n=gC.Instance;let r=!1;var o;(null===n||void 0===n||null===(e=n.activeFrame)||void 0===e||null===(t=e.stokesFiles)||void 0===t?void 0:t.length)?n.activeFrame.stokesFiles.forEach((e=>{e.polarizationType===Nt.PolarizationType.I&&(r=!0)})):(null===(o=i.effectiveFrame)||void 0===o?void 0:o.regionSet)&&(r=i.effectiveFrame.frameInfo.fileInfoExtended.stokes>1);return Object(xm.jsxs)("div",{className:"stokes-analysis-toolbar",children:[Object(xm.jsx)(dO,{widgetStore:this.props.widgetStore,onFrameChanged:this.handleFrameChanged}),Object(xm.jsx)(u.p,{label:"Frac. Pol.",inline:!0,disabled:!r,children:Object(xm.jsx)(u.P,{checked:i.fractionalPolVisible,onChange:this.handleFractionalPolChanged,disabled:!r})}),Object(xm.jsx)(u.f,{className:"profile-buttons",children:Object(xm.jsx)(j.a,{content:"Smoothing",children:Object(xm.jsx)(u.b,{icon:Object(xm.jsx)(jN,{icon:"smoothing"}),onClick:this.smoothingShortcutClick})})})]})}})||Lq;var _q,zq,Vq,Wq,Gq,Bq,qq;i(1010);let Hq=Object(p.a)((qq=Bq=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"stokes",type:"stokes",minWidth:320,minHeight:400,defaultWidth:520,defaultHeight:650,title:"Stokes Analysis",isCloseable:!0,helpType:xM.STOKES_ANALYSIS}}get widgetStore(){const e=WP.Instance;if(e.stokesAnalysisWidgets){const t=e.stokesAnalysisWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Sc}get profileStore(){const e=gC.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId;const i=this.widgetStore.effectiveRegionId,n=e.spectralProfiles.get(t);if(n)return n.get(i)}return null}get exportHeaders(){var e;let t=[];const i=null===(e=this.widgetStore.effectiveFrame)||void 0===e?void 0:e.getRegionProperties(this.widgetStore.effectiveRegionId);return null===i||void 0===i||i.forEach((e=>t.push(e))),t}get exportQUScatterHeaders(){return this.widgetStore.smoothingStore.type===GO.NONE?this.exportHeaders:this.exportHeaders.concat(this.widgetStore.smoothingStore.comments)}constructor(t){super(t),this.pointDefaultColor=L.a.GRAY2,this.opacityOutRange=.1,this.channelBorder=void 0,this.minProgress=0,this.cursorInfo=void 0,this.multicolorLineColorOutRange="hsla(0, 0%, 50%, 0.5)",Object(f.a)(this,"width",Vq,this),Object(f.a)(this,"height",Wq,this),Object(f.a)(this,"onResize",Gq,this),this.onChannelChanged=e=>{const t=this.widgetStore.effectiveFrame;if(!dS.Instance.animationActive&&t&&t.channelInfo){let i,n=t.channelInfo;if(t.isCoordChannel)i=n.getChannelIndexSimple(e);else if(t.spectralAxis&&!t.spectralAxis.valid||t.isSpectralPropsEqual)i=n.getChannelIndexWCS(e);else{const r=t.convertToNativeWCS(e);isFinite(r)&&(i=n.getChannelIndexWCS(r))}null!==i&&void 0!==i&&t.setChannels(i,t.requiredStokes,!0)}},this.onScatterChannelChanged=(e,t,i)=>{const n=this.widgetStore.effectiveFrame;if(!dS.Instance.animationActive&&i.length>0&&n&&n.channelInfo){let r=n.channelInfo;const o=this.matchZindex(e,t,i);let s;if(n.isCoordChannel)s=r.getChannelIndexSimple(o);else if(n.isSpectralPropsEqual)s=r.getChannelIndexWCS(o);else{const t=n.convertToNativeWCS(e);isFinite(t)&&(s=r.getChannelIndexWCS(t))}null!==s&&void 0!==s&&n.setChannels(s,n.requiredStokes,!0)}},this.onGraphCursorMoved=T.throttle((e=>{this.widgetStore.setlinePlotCursorX(e)}),33),this.onScatterGraphCursorMoved=T.throttle(((e,t)=>{this.widgetStore.setScatterPlotCursor({x:e,y:t})}),33),this.fillProfilerDataInLinePlots=(e,t,i,n,r)=>{const o=P(t,n),s=P(i,n);if(o&&o.point&&s&&s.point){const t=this.matchXYindex(o.point.x,e);r.q=t.x,r.u=t.y,r.channel=t.z,r.pi=o.point.y,r.pa=s.point.y}},this.fillProfilerDataInScatterPlots=(e,t,i,n,r)=>{const o=function(e,t){let i=Number.MAX_VALUE,n=0;for(let r=0;r<t.length;r++){const o=mm(e,t[r]);o<i&&(i=o,n=r)}return n}(n,e);if(o>=0){const n=e[o];if(n){const e=P(t,n.z),o=P(i,n.z);r.q=n.x,r.u=n.y,e&&e.point&&o&&o.point&&(r.channel=e.point.x,r.pi=e.point.y,r.pa=o.point.y)}}},this.getCursorInfo=(e,t,i,n,r,o,s)=>{let a=null;const l=this.widgetStore.isMouseMoveIntoLinePlots||this.widgetStore.isMouseMoveIntoScatterPlots,c=this.widgetStore.effectiveFrame?this.widgetStore.effectiveFrame.spectralUnitStr:"Channel";if(l){let o={q:NaN,u:NaN,pi:NaN,pa:NaN,channel:NaN};this.widgetStore.isMouseMoveIntoLinePlots&&this.fillProfilerDataInLinePlots(e,t,i,r,o),this.widgetStore.isMouseMoveIntoScatterPlots&&this.fillProfilerDataInScatterPlots(e,t,i,n,o),a={isMouseEntered:l,quValue:{x:o.q,y:o.u},channel:o.channel,pi:o.pi,pa:o.pa,xUnit:c}}else{const e=P(t,s),n=P(i,s);a={isMouseEntered:l,quValue:{x:o?o.x:NaN,y:o?o.y:NaN},channel:s,pi:e&&e.point?e.point.y:NaN,pa:n&&n.point?n.point.y:NaN,xUnit:c}}return a},this.genProfilerInfo=()=>{let e=[];if(!this.cursorInfo||null===this.cursorInfo.quValue.x||null===this.cursorInfo.quValue.y||isNaN(this.cursorInfo.quValue.x)||isNaN(this.cursorInfo.quValue.y))return e;if(this.widgetStore.effectiveFrame&&this.plotData){const t="Channel"===this.cursorInfo.xUnit?"Channel "+fi(this.cursorInfo.channel):bi(this.cursorInfo.channel)+" "+this.cursorInfo.xUnit,i=this.widgetStore.fractionalPolVisible,n=i?", U/I: ":", U: ",r=i?", PI/I: ":", PI: ",o="("+t+(i?", Q/I: ":", Q: ")+gi(this.cursorInfo.quValue.x,2)+n+gi(this.cursorInfo.quValue.y,2)+r+gi(this.cursorInfo.pi,2)+", PA: "+fi(this.cursorInfo.pa,2)+")";e.push(`${this.cursorInfo.isMouseEntered?"Cursor:":"Data:"} ${o}`)}return e},Object(m.p)(this);const i=gC.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.stokesAnalysisWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.stokesAnalysisWidgets.set(this.props.id,new Sc));else{const e=i.widgetsStore.addStokesWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(m.h)((()=>{if(this.widgetStore){const e=this.widgetStore.effectiveFrame;let t="";const n=this.plotData;if(n&&isFinite(n.qProgress)&&isFinite(n.uProgress)){const e=Math.min(n.qProgress,n.uProgress,n.iProgress);e<1&&(t=`[${fi(100*e)}% complete]`),this.minProgress=e}if(e){const e=this.widgetStore.effectiveRegionId,n=0===e?"Cursor":`Region #${e}`,r=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`Stokes Analysis : ${n} ${r} ${t}`)}}else i.widgetsStore.setWidgetTitle(this.props.id,"Stokes Analysis: Cursor")}))}getColorMapOrder(e){var t,i;const n=null===e||void 0===e||null===(t=e.spectralAxis)||void 0===t?void 0:t.type.code;let r=null!==(i=null===e||void 0===e?void 0:e.spectralType)&&void 0!==i?i:n;switch(r===Wt.CHANNEL&&(r=n),r){case Vt.FREQ:case Vt.ENER:case Vt.WAVE:return!0;default:return!1}}get currentChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.channel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get requiredChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.requiredChannel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}matchZindex(e,t,i){let n=0;for(let r=0;r<i.length;r++){const o=i[r];if(o.x===e&&o.y===t){n=o.z;break}}return n}matchXYindex(e,t){let i=t[0];for(let n=0;n<t.length;n++){const r=t[n];if(r.z===e){i=r;break}}return i}static calculatePA(e,t){let i=[];if(e&&t&&e.length===t.length)for(let o=0;o<e.length;o++)i[o]=(n=e[o],r=t[o],.5*Math.atan2(r,n)*180/Math.PI);var n,r;return i}static calculatePI(e,t){let i=[];if(e&&t&&e.length===t.length)for(let o=0;o<e.length;o++)i[o]=(n=e[o],r=t[o],Math.sqrt(Math.pow(n,2)+Math.pow(r,2)));var n,r;return i}static calculateFractionalPol(e,t){let i=[];if(e&&t&&e.length===t.length)for(let o=0;o<e.length;o++)i[o]=(n=e[o],r=t[o],n/r*100);var n,r;return i}calculateCompositeProfile(t){if(this.profileStore){let i=this.profileStore.getProfile(dc.LinearPolarizationQ,t),n=this.profileStore.getProfile(dc.LinearPolarizationU,t);if(i&&n&&i.values&&n.values){let r=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,i.values),o=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,n.values),s=[],a=[],l=[],c=[],d=[],p=[],h=[],u=[],g=[],f=[];if(s=Array.prototype.slice.call(i.values),a=Array.prototype.slice.call(n.values),l=e.calculatePI(i.values,n.values),c=e.calculatePA(i.values,n.values),this.widgetStore.smoothingStore.type!==GO.NONE&&(d=Array.prototype.slice.call(r.y),p=Array.prototype.slice.call(o.y),h=r.x,u=o.x,g=e.calculatePI(r.y,o.y),f=e.calculatePA(r.y,o.y)),this.widgetStore.fractionalPolVisible){let r=this.profileStore.getProfile(dc.TotalIntensity,t);if(r&&r.values){if(l=e.calculateFractionalPol(l,r.values),s=e.calculateFractionalPol(s,r.values),a=e.calculateFractionalPol(a,r.values),this.widgetStore.smoothingStore.type!==GO.NONE){let t=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,r.values);g=e.calculateFractionalPol(g,t.y),d=e.calculateFractionalPol(d,t.y),p=e.calculateFractionalPol(p,t.y)}return{qProfile:s,qProfileSmoothed:d,qSmoothedX:h,uProfile:a,uProfileSmoothed:p,uSmoothedX:u,piProfile:l,piProfileSmoothed:g,paProfile:c,paProfileSmoothed:f,qProgress:i.progress,uProgress:n.progress,iProgress:r.progress}}}return{qProfile:s,qProfileSmoothed:d,qSmoothedX:h,uProfile:a,uProfileSmoothed:p,uSmoothedX:u,piProfile:l,piProfileSmoothed:g,paProfile:c,paProfileSmoothed:f,qProgress:i.progress,uProgress:n.progress,iProgress:1}}}return null}getChartAreaWH(e){return e&&e.right&&e.bottom?{width:Math.abs(e.right-e.left),height:Math.abs(e.bottom-e.top)}:{width:0,height:0}}resizeScatterData(e,t,i,n){if(!this.widgetStore.equalAxes)return{xMin:e,xMax:t,yMin:i,yMax:n};let r=Math.max(Math.abs(e),Math.abs(t)),o=Math.max(Math.abs(i),Math.abs(n));if(this.widgetStore.scatterChartArea){let e=this.getChartAreaWH(this.widgetStore.scatterChartArea);if(0!==e.width&&0!==e.height){let t=e.width/e.height;t<1&&(o*=1/t),t>1&&(r*=t)}}return{xMin:-r,xMax:r,yMin:-o,yMax:o}}calculateXYborder(e,t,i,n){const r=Qi(e),o=Qi(t);let s=r.minVal,a=r.maxVal,l=o.minVal,c=o.maxVal;if(!this.widgetStore.isLinePlotsAutoScaledX&&i){const e=Gi(this.widgetStore.sharedMinX,s,a),t=Gi(this.widgetStore.sharedMaxX,s,a);s=e,a=t}if(!this.widgetStore.isQUScatterPlotAutoScaledX&&!i&&n===dc.PolarizationQU){const e=Gi(this.widgetStore.quScatterMinX,s,a),t=Gi(this.widgetStore.quScatterMaxX,s,a);s=e,a=t}if(!this.widgetStore.isQUScatterPlotAutoScaledY&&!i&&n===dc.PolarizationQU){const e=Gi(this.widgetStore.quScatterMinY,l,c),t=Gi(this.widgetStore.quScatterMaxY,l,c);l=e,c=t}if(l===Number.MAX_VALUE&&(l=void 0,c=void 0),!this.widgetStore.isPolAngleAutoScaledY&&i&&n===dc.PolarizationAngle){const e=Gi(this.widgetStore.polAngleMinY,l,c),t=Gi(this.widgetStore.polAngleMaxY,l,c);l=e,c=t}if(!this.widgetStore.isPolIntensityAutoScaledY&&i&&n===dc.PolarizedIntensity){const e=Gi(this.widgetStore.polIntensityMinY,l,c),t=Gi(this.widgetStore.polIntensityMaxY,l,c);l=e,c=t}if(this.widgetStore.isQULinePlotAutoScaledY||!i||n!==dc.LinearPolarizationQ&&n!==dc.LinearPolarizationU){if(i){const e=c-l;l-=e*tO,c+=e*tO}}else{const e=Gi(this.widgetStore.quMinY,l,c),t=Gi(this.widgetStore.quMaxY,l,c);l=e,c=t}return{xMin:s,xMax:a,yMin:l,yMax:c}}assembleLinePlotData(e,t,i){if(e&&e.length&&t&&e.length===t.length){let n=this.calculateXYborder(t,e,!0,i),r=[];for(let i=0;i<t.length;i++){const o=t[i],s=e[i];o<n.xMin||o>n.xMax||s<n.yMin||s>n.yMax?r.push({x:o,y:NaN}):r.push({x:o,y:s})}return{dataset:r,border:n}}return null}assembleScatterPlotData(e,t,i){const n=this.widgetStore.effectiveFrame;if(e&&e.length&&t&&t.length&&n.channelValues&&n.channelValues.length&&e.length===t.length&&(e.length===n.channelValues.length||this.widgetStore.smoothingStore.type===GO.BINNING)){const r=n.channelValues;let o=this.calculateXYborder(e,t,!1,i),s=[],a=this.resizeScatterData(o.xMin,o.xMax,o.yMin,o.yMax);this.widgetStore.scatterOutRangePointsZIndex=[];for(let i=0;i<r.length;i++){const n=e[i],a=t[i],l=r[i];s.push({x:n,y:a,z:l}),(n<o.xMin||n>o.xMax||a<o.yMin||a>o.yMax)&&this.widgetStore.scatterOutRangePointsZIndex.push(l)}return{dataset:s,border:a}}return null}compareVariable(e,t,i,n){return e===t&&e===i&&e===n&&null!==e}getScatterColor(e,t){const i=this.widgetStore.colorPixel.color,n=this.widgetStore.colorPixel.size;t&&(e=1-e);const r=4*Math.round(e*(n-1)),o=this.widgetStore.pointTransparency?this.widgetStore.pointTransparency:1;return`rgba(${i[r]}, ${i[r+1]}, ${i[r+2]}, ${o})`}fillScatterColor(e,t,i){let n=[];const r=this.widgetStore;if(e&&e.length&&i&&t&&r){let i=t;const o=`hsla(0, 0%, 50%, ${this.opacityOutRange})`,s=r.effectiveFrame,a=this.getColorMapOrder(s),l=[];for(let t=0;t<e.length;t++){const n=e[t];n.z>=i.xMin&&n.z<=i.xMax&&l.push(n)}const c=function(e){let t=-Number.MAX_VALUE,i=Number.MAX_VALUE;for(const n of e)n&&!isNaN(n.z)&&(t=Math.max(t,n.z),i=Math.min(i,n.z));return{maxVal:t,minVal:i}}(l);for(let t=0;t<e.length;t++){const s=e[t];let l=this.pointDefaultColor,d=!0;s.z>=i.xMin&&s.z<=i.xMax&&(d=!1);let p=(s.z-c.minVal)/(c.maxVal-c.minVal);r.invertedColorMap&&(p=1-p),l=d?o:this.getScatterColor(p,a),n.push(l)}}return n}fillLineColor(e,t){let i=[];if(this.widgetStore.plotType!==oO.POINTS&&i.push(""),e&&e.length&&t)for(let n=0;n<e.length;n++){const r=e[n];this.widgetStore.scatterOutRangePointsZIndex&&this.widgetStore.scatterOutRangePointsZIndex.indexOf(r.x)>=0?i.push(this.multicolorLineColorOutRange):i.push(t)}return i}closestChannel(e,t){for(var i,n=0,r=t.length-1;r-n>1;)t[i=Math.floor((n+r)/2)].z<e?n=i:r=i;return e-t[n].z<=t[r].z-e?t[n].z:t[r].z}getScatterChannel(e,t,i){let n={currentChannel:e[0],hoveredChannel:e[0]};if(e&&e.length&&i&&t){let i=t.channelCurrent,r=t.channelHovered;if(i){let t=i;r&&(t=this.closestChannel(r,e),this.channelBorder&&0!==this.channelBorder.xMin&&(t>this.channelBorder.xMax||t<this.channelBorder.xMin||!this.widgetStore.isMouseMoveIntoLinePlots)&&(t=i));for(let r=0;r<e.length;r++){const o=e[r];o.z===t&&(n.hoveredChannel=o),o.z===i&&(n.currentChannel=o)}}}return n}get plotData(){const e=this.widgetStore.effectiveFrame;if(!e)return null;let t,i=this.widgetStore.effectiveRegionId;if(e.regionSet){const n=e.regionSet.regions.find((e=>e.regionId===i));n&&(t=this.calculateCompositeProfile(n.isClosedRegion?this.widgetStore.statsType:Nt.StatsType.Sum))}let n=e.channelInfo;if(t&&n){let i=this.assembleScatterPlotData(t.qProfile,t.uProfile,dc.PolarizationQU),n=this.assembleScatterPlotData(t.qProfileSmoothed,t.uProfileSmoothed,dc.PolarizationQU),r=this.assembleLinePlotData(t.piProfile,e.channelValues,dc.PolarizedIntensity),o=this.assembleLinePlotData(t.paProfile,e.channelValues,dc.PolarizationAngle),s=this.assembleLinePlotData(t.qProfile,e.channelValues,dc.LinearPolarizationQ),a=this.assembleLinePlotData(t.uProfile,e.channelValues,dc.LinearPolarizationU),l=this.assembleLinePlotData(t.piProfileSmoothed,t.qSmoothedX,dc.PolarizedIntensity),c=this.assembleLinePlotData(t.paProfileSmoothed,t.qSmoothedX,dc.PolarizationAngle);return{qValues:s,uValues:a,piValues:r,paValues:o,qSmoothedValues:this.assembleLinePlotData(t.qProfileSmoothed,t.qSmoothedX,dc.LinearPolarizationQ),uSmoothedValues:this.assembleLinePlotData(t.uProfileSmoothed,t.uSmoothedX,dc.LinearPolarizationU),piSmoothedValues:l,paSmoothedValues:c,quValues:i,quSmoothedValues:n,qProgress:t.qProgress,uProgress:t.uProgress,iProgress:t.iProgress}}return null}render(){const t=gC.Instance;if(!this.widgetStore)return Object(xm.jsx)(u.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const i=this.widgetStore.effectiveFrame,n=this.widgetStore.effectiveFrame?this.widgetStore.effectiveFrame.filename:void 0;let r={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"quLine",tickTypeY:Ry.Scientific,showXAxisTicks:!1,showXAxisLabel:!1,showLegend:!0,xTickMarkLength:0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setQULinePlotYBounds,graphZoomedXY:this.widgetStore.setQULinePlotsXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,multiColorMultiLinesColors:new Map,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map},o={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"piLine",tickTypeY:Ry.Scientific,showXAxisTicks:!1,showXAxisLabel:!1,xTickMarkLength:0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setPolIntensityYBounds,graphZoomedXY:this.widgetStore.setPolIntensityXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1},s={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"paLine",tickTypeY:Ry.Integer,showXAxisTicks:!0,showXAxisLabel:!0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setPolAngleYBounds,graphZoomedXY:this.widgetStore.setPolAngleXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1},a={xLabel:"Channel",yLabel:"Channel",darkMode:t.darkTheme,imageName:n,plotName:"quScatter",tickTypeX:Ry.Scientific,tickTypeY:Ry.Scientific,showXAxisTicks:!0,showXAxisLabel:!0,plotType:oO.POINTS,zeroLineWidth:2,isGroupSubPlot:!0,colorRangeEnd:240,zIndex:!0,graphCursorMoved:this.onScatterGraphCursorMoved,graphClicked:this.onScatterChannelChanged,graphZoomReset:this.widgetStore.clearScatterPlotXYBounds,mouseEntered:this.widgetStore.setMouseMoveIntoScatterPlots,scrollZoom:!0,graphZoomedXY:this.widgetStore.setQUScatterPlotXYBounds,updateChartArea:this.widgetStore.setScatterChartAres,pointRadius:this.widgetStore.scatterPlotPointSize},l="profile-container-"+e.calculateLayout(this.width,this.height),c={xMin:0,xMax:0};if(this.profileStore&&i){const e={profiler:this.widgetStore.linePlotcursorX,image:this.currentChannelValue,unit:i.spectralUnitStr},l=this.plotData;let d={channelCurrent:0,channelHovered:0};if(l&&l.piValues&&l.paValues&&l.qValues&&l.uValues&&l.quValues){o.data=l.piValues.dataset,s.data=l.paValues.dataset,a.data=this.widgetStore.smoothingStore.type===GO.NONE?l.quValues.dataset:l.quSmoothedValues.dataset;const d=this.minProgress<1?.15+this.minProgress/4:1;r.opacity=d,o.opacity=d,s.opacity=d,r.opacity=d;let p=Jb(this.widgetStore.primaryLineColor),h=Jb(this.widgetStore.secondaryLineColor);t.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(p=L.a.BLUE4),this.widgetStore.secondaryLineColor.fixed||(h=L.a.ORANGE4)),o.lineColor=p,s.lineColor=p;let u={imageName:n,plotName:"q",data:l.qValues.dataset,type:this.widgetStore.plotType,borderColor:p,order:1,comments:[dc.LinearPolarizationQ]},g={imageName:n,plotName:"u",data:l.uValues.dataset,type:this.widgetStore.plotType,borderColor:h,order:1,comments:[dc.LinearPolarizationU]};r.multiPlotPropsMap.set(dc.LinearPolarizationQ,u),r.multiPlotPropsMap.set(dc.LinearPolarizationU,g);const f=this.widgetStore.smoothingStore;if(f.type!==GO.NONE&&l.qSmoothedValues&&l.uSmoothedValues&&l.piSmoothedValues&&l.piSmoothedValues){let e={imageName:n,plotName:"q-smoothed",data:l.qSmoothedValues.dataset,type:f.lineType,borderColor:p,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},t={imageName:n,plotName:"u-smoothed",data:l.uSmoothedValues.dataset,type:f.lineType,borderColor:h,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},i={imageName:n,plotName:"pi-smoothed",data:l.piSmoothedValues.dataset,type:f.lineType,borderColor:p,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},a={imageName:n,plotName:"pa-smoothed",data:l.paSmoothedValues.dataset,type:f.lineType,borderColor:Jb(f.colorMap.get(dc.PolarizationAngle)?Jb(f.colorMap.get(dc.PolarizationAngle)):p),borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1};r.multiPlotPropsMap.set(dc.LinearPolarizationQ+"_smoothed",e),r.multiPlotPropsMap.set(dc.LinearPolarizationU+"_smoothed",t),o.multiPlotPropsMap.set("smoothed",i),s.multiPlotPropsMap.set("smoothed",a)}const b=1===l.qProgress&&1===l.uProgress&&1===l.iProgress;let m,y;f.type===GO.NONE||f.isOverlayOn?(m=b?this.fillLineColor(l.qValues.dataset,p):[],y=b?this.fillLineColor(l.uValues.dataset,h):[],o.multiColorSingleLineColors=b?this.fillLineColor(l.piValues.dataset,p):[],s.multiColorSingleLineColors=b?this.fillLineColor(l.paValues.dataset,p):[]):(m=b?this.fillLineColor(l.qValues.dataset,"#00000000"):[],y=b?this.fillLineColor(l.uValues.dataset,"#00000000"):[],o.multiColorSingleLineColors=b?this.fillLineColor(l.piValues.dataset,"#00000000"):[],s.multiColorSingleLineColors=b?this.fillLineColor(l.paValues.dataset,"#00000000"):[]),r.multiColorMultiLinesColors.set(dc.LinearPolarizationQ,m),r.multiColorMultiLinesColors.set(dc.LinearPolarizationU,y);let O=l.qValues.border,j=l.uValues.border,x=l.piValues.border,S=l.paValues.border,v=l.quValues.border;if(this.compareVariable(O.xMin,j.xMin,x.xMin,S.xMin)&&this.compareVariable(O.xMax,j.xMax,x.xMax,S.xMax)){c={xMin:S.xMin,xMax:S.xMax},this.channelBorder={xMin:S.xMin,xMax:S.xMax},this.widgetStore.isLinePlotsAutoScaledX?(r.xMin=O.xMin,r.xMax=O.xMax,o.xMin=x.xMin,o.xMax=x.xMax,s.xMin=S.xMin,s.xMax=S.xMax):(r.xMin=this.widgetStore.sharedMinX,r.xMax=this.widgetStore.sharedMaxX,o.xMin=this.widgetStore.sharedMinX,o.xMax=this.widgetStore.sharedMaxX,s.xMin=this.widgetStore.sharedMinX,s.xMax=this.widgetStore.sharedMaxX,c={xMin:this.widgetStore.sharedMinX,xMax:this.widgetStore.sharedMaxX});let e=this.fillScatterColor(a.data,c,!0);a.dataBackgroundColor=e,this.widgetStore.isQULinePlotAutoScaledY?(r.yMin=O.yMin<j.yMin?O.yMin:j.yMin,r.yMax=O.yMax>j.yMax?O.yMax:j.yMax):(r.yMin=this.widgetStore.quMinY,r.yMax=this.widgetStore.quMaxY),this.widgetStore.isPolIntensityAutoScaledY?(o.yMin=x.yMin,o.yMax=x.yMax):(o.yMin=this.widgetStore.polIntensityMinY,o.yMax=this.widgetStore.polIntensityMaxY),this.widgetStore.isPolAngleAutoScaledY?(s.yMin=S.yMin,s.yMax=S.yMax):(s.yMin=this.widgetStore.polAngleMinY,s.yMax=this.widgetStore.polAngleMaxY)}this.widgetStore.isQUScatterPlotAutoScaledX?(a.xMin=v.xMin,a.xMax=v.xMax):(a.xMin=this.widgetStore.quScatterMinX,a.xMax=this.widgetStore.quScatterMaxX),this.widgetStore.isQUScatterPlotAutoScaledY?(a.yMin=v.yMin,a.yMax=v.yMax):(a.yMin=this.widgetStore.quScatterMinY,a.yMax=this.widgetStore.quScatterMaxY);let C={profiler:{x:this.widgetStore.scatterPlotCursorX,y:this.widgetStore.scatterPlotCursorY},image:this.matchXYindex(e.image,a.data),unit:i.spectralUnitStr};a.cursorXY=C,this.cursorInfo=this.getCursorInfo(a.data,this.widgetStore.smoothingStore.type===GO.NONE?l.piValues.dataset:l.piSmoothedValues.dataset,this.widgetStore.smoothingStore.type===GO.NONE?l.paValues.dataset:l.paSmoothedValues.dataset,C.profiler,e.profiler,C.image,e.image),this.cursorInfo&&this.cursorInfo.quValue&&(a.cursorNearestPoint=this.cursorInfo.quValue)}if(s.yLabel="PA (Degrees)",this.widgetStore.fractionalPolVisible?(r.yLabel="Value (%)",o.yLabel="PI/I (%)",a.xLabel="Q/I (%)",a.yLabel="U/I (%)"):(r.yLabel="Value ("+i.headerUnit+")",o.yLabel="PI ("+i.headerUnit+")",a.xLabel="Stokes Q ("+i.headerUnit+")",a.yLabel="Stokes U ("+i.headerUnit+")"),i.spectralAxis&&!i.isCoordChannel&&(s.xLabel=o.xLabel=r.xLabel=i.spectralLabel),s.markers=[],o.markers=[],r.markers=[],this.cursorInfo&&this.cursorInfo.channel&&this.widgetStore.isMouseMoveIntoScatterPlots){let e={value:this.cursorInfo.channel,id:"marker-profiler-cursor-stokes2",draggable:!1,horizontal:!1,color:t.darkTheme?L.a.GRAY4:L.a.GRAY2,opacity:.8,isMouseMove:!this.widgetStore.isMouseMoveIntoLinePlots,interactionMarker:!0};s.markers.push(e),o.markers.push(e),r.markers.push(e)}if(null!==e.profiler){let i={value:e.profiler,id:"marker-profiler-cursor-stokes",draggable:!1,horizontal:!1,color:t.darkTheme?L.a.GRAY4:L.a.GRAY2,opacity:.8,isMouseMove:!this.widgetStore.isMouseMoveIntoLinePlots};s.markers.push(i),o.markers.push(i),r.markers.push(i),i&&i.value&&void 0!==typeof i.value&&(d.channelHovered=i.value)}if(null!==e.image){let t={value:e.image,id:"marker-channel-current",opacity:.4,draggable:!1,horizontal:!1},i={value:this.requiredChannelValue,id:"marker-channel-required",draggable:!dS.Instance.animationActive,dragMove:this.onChannelChanged,horizontal:!1};s.markers.push(t,i),o.markers.push(t,i),r.markers.push(t,i),t&&t.value&&void 0!==typeof t.value&&(d.channelCurrent=t.value)}if(a.data&&a.data.length&&c){const e=this.getScatterChannel(a.data,d,!0);a.indicatorInteractionChannel={currentChannel:e.currentChannel,hoveredChannel:e.hoveredChannel,start:this.widgetStore.isMouseMoveIntoLinePlots}}s.comments=this.exportHeaders,o.comments=this.exportHeaders,r.comments=this.exportHeaders,a.comments=this.exportQUScatterHeaders}return Object(xm.jsxs)("div",{className:"stokes-widget",children:[Object(xm.jsxs)("div",{className:l,children:[Object(xm.jsx)("div",{className:"profile-plot-toolbar",children:Object(xm.jsx)(Nq,{widgetStore:this.widgetStore,id:this.props.id})}),Object(xm.jsxs)("div",{className:"profile-plot-qup",children:[Object(xm.jsx)("div",{className:"profile-plot-qu",children:Object(xm.jsx)(iO,{...r})}),Object(xm.jsx)("div",{className:"profile-plot-pi",children:Object(xm.jsx)(iO,{...o})}),Object(xm.jsx)("div",{className:"profile-plot-pa",children:Object(xm.jsx)(iO,{...s})})]}),Object(xm.jsx)("div",{className:"profile-plot-qvsu",children:Object(xm.jsx)(NO,{...a})}),Object(xm.jsx)(lO,{info:this.genProfilerInfo()})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},Bq.layoutRatioCutoffs={vertical:.5,horizontal:2},Bq.calculateLayout=(e,t)=>{if(e&&t){let i=e/t,n=Math.abs(i-Bq.layoutRatioCutoffs.vertical),r=Math.abs(i-Bq.layoutRatioCutoffs.horizontal),o=Math.min(n,r);return o===n?"vertical":o===r?"horizontal":null}return null},zq=qq,Vq=Object(b.a)(zq.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wq=Object(b.a)(zq.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(zq.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"widgetStore"),zq.prototype),Object(b.a)(zq.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"profileStore"),zq.prototype),Object(b.a)(zq.prototype,"exportHeaders",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"exportHeaders"),zq.prototype),Object(b.a)(zq.prototype,"exportQUScatterHeaders",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"exportQUScatterHeaders"),zq.prototype),Gq=Object(b.a)(zq.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t,this.widgetStore.clearScatterPlotXYBounds()}}}),Object(b.a)(zq.prototype,"currentChannelValue",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"currentChannelValue"),zq.prototype),Object(b.a)(zq.prototype,"requiredChannelValue",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"requiredChannelValue"),zq.prototype),Object(b.a)(zq.prototype,"plotData",[m.i],Object.getOwnPropertyDescriptor(zq.prototype,"plotData"),zq.prototype),_q=zq))||_q;var Yq,Uq,Xq,$q,Kq,Qq,Zq,Jq,eH,tH,iH,nH,rH=i(109);i(1011);!function(e){e.Name="Name",e.Unit="Unit",e.Type="Type",e.Display="Display",e.Description="Description"}(nH||(nH={}));let oH=Object(p.a)((iH=tH=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"catalog-overlay",type:"catalog-overlay",minWidth:720,minHeight:400,defaultWidth:720,defaultHeight:400,title:"Catalog",isCloseable:!0,helpType:xM.CATALOG_OVERLAY,componentId:"catalog-overlay-component"}}get catalogFileId(){var e;return null===(e=hM.Instance.catalogProfiles)||void 0===e?void 0:e.get(this.props.id)}get widgetStore(){const e=hM.Instance.catalogWidgets.get(this.catalogFileId);return WP.Instance.catalogWidgets.get(e)}get profileStore(){return hM.Instance.catalogProfileStores.get(this.catalogFileId)}get catalogDataInfo(){const e=this.profileStore,t=this.widgetStore;let i,n=0;return e&&t&&(i=e.catalogData,n=e.numVisibleRows,e.regionSelected&&t.showSelectedData&&(e.isFileBasedCatalog&&(i=e.selectedData),n=e.regionSelected)),{dataset:i,numVisibleRows:n}}get enablePlotButton(){const e=this.profileStore,t=this.widgetStore,i=!e.loadingData&&!e.updatingDataStream&&t.xAxis!==Un.NONE;return(t.catalogPlotType===xd.Histogram||t.yAxis!==Un.NONE)&&i}constructor(t){super(t),Object(f.a)(this,"catalogTableRef",Xq,this),Object(f.a)(this,"height",$q,this),Object(f.a)(this,"width",Kq,this),this.catalogHeaderTableRef=void 0,this.catalogFileNames=void 0,Object(f.a)(this,"handleCatalogFileChange",Qq,this),Object(f.a)(this,"handleFileCloseClick",Zq,this),this.scrollToRegion=(e,t)=>{if(e){var i,n;const r=e.state,o=null===r||void 0===r?void 0:r.numFrozenColumnsClamped,s=null===r||void 0===r?void 0:r.numFrozenRowsClamped;let a=e.state.viewportRect;a||(a=e.locator.getViewportRect());const l=null===(i=a)||void 0===i?void 0:i.left,c=null===(n=a)||void 0===n?void 0:n.top,{scrollLeft:d,scrollTop:p}=rH.a(t,l,c,e.grid.getCumulativeWidthBefore,e.grid.getCumulativeHeightBefore,s,o),h=e.shouldDisableHorizontalScroll()?0:d,u=e.shouldDisableVerticalScroll()?0:p;e.quadrantStackInstance.scrollToPosition(h,u)}},Object(f.a)(this,"onCatalogDataTableRefUpdated",Jq,this),this.onControlHeaderTableRef=e=>{this.catalogHeaderTableRef=e},Object(f.a)(this,"onResize",eH,this),this.renderColumnNamePopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick},e),this.filterColumn=(e,t)=>new XL.a([t]).search(e).length>0,this.updateHeaderTableColumnSize=(e,t)=>{const i=this.widgetStore;i.headerTableColumnWidts&&(i.headerTableColumnWidts[e]=t)},this.resetSelectedPointIndices=()=>{const e=this.profileStore,t=this.widgetStore;e.setSelectedPointIndices([],!1),t.setShowSelectedData(!1)},this.handleFilterRequest=()=>{const e=this.profileStore,t=this.widgetStore,i=gC.Instance;if(e&&i)if(this.resetSelectedPointIndices(),i.catalogStore.clearImageCoordsData(this.catalogFileId),e.isFileBasedCatalog){e.updateTableStatus(!1),e.resetFilterRequest();let n=e.updateRequestDataSize;n.imageBounds.xColumnName=t.xAxis,n.imageBounds.yColumnName=t.yAxis,n.fileId=e.catalogInfo.fileId,n.filterConfigs=e.getUserFilters(),n.columnIndices=e.displayedColumnHeaders.map((e=>e.columnIndex)),i.sendCatalogFilter(n)}else e.resetFilterRequest(e.getUserFilters())},this.updateSortRequest=(e,t,i)=>{const n=this.profileStore,r=gC.Instance;if(n&&r&&(this.resetSelectedPointIndices(),r.catalogStore.clearImageCoordsData(this.catalogFileId),n.setSortingInfo(e,t),n.isFileBasedCatalog)){n.resetFilterRequest();let i=n.updateRequestDataSize;i.sortColumn=e,i.sortingType=t,r.sendCatalogFilter(i)}},this.updateByInfiniteScroll=()=>{const e=this.profileStore,t=this.widgetStore.showSelectedData;if(!1===e.loadingData&&e.updateMode===DM.TableUpdate&&e.shouldUpdateData&&!t){e.setUpdateMode(DM.TableUpdate);const t=this.profileStore.updateRequestDataSize;t.columnIndices=e.displayedColumnHeaders.map((e=>e.columnIndex)),gC.Instance.sendCatalogFilter(t),e.setLoadingDataStatus(!0)}},this.handleResetClick=()=>{const e=this.profileStore,t=this.widgetStore,i=gC.Instance;e&&t&&(e.resetCatalogFilterRequest(),this.resetSelectedPointIndices(),i.catalogStore.clearImageCoordsData(this.catalogFileId),e.isFileBasedCatalog&&i.sendCatalogFilter(e.catalogFilterRequest),t.resetMaps())},this.handlePlotClick=()=>{const e=this.profileStore,t=gC.Instance,i=hM.Instance,n=this.widgetStore;switch(n.catalogPlotType){case xd.ImageOverlay:e.setUpdateMode(DM.ViewUpdate);const r=t.getFrame(i.getFrameIdByCatalogId(this.catalogFileId));if(r){const t=e.get2DPlotData(n.xAxis,n.yAxis,e.catalogData),o=r.validWcs?r.wcsInfo:0,s=this.catalogFileId;i.clearImageCoordsData(s),i.convertToImageCoordinate(s,t.wcsX,t.wcsY,o,t.xHeaderInfo.units,t.yHeaderInfo.units,e.catalogCoordinateSystem.system,0,0),e.setSelectedPointIndices(e.selectedPointIndices,!1)}if(e.shouldUpdateData){e.setUpdatingDataStream(!0);let i=e.updateRequestDataSize;t.sendCatalogFilter(i)}break;case xd.D2Scatter:const o={xColumnName:n.xAxis,yColumnName:n.yAxis,plotType:n.catalogPlotType},s=t.widgetsStore.createFloatingCatalogPlotWidget(o);i.setCatalogPlots(s.widgetComponentId,this.catalogFileId,s.widgetStoreId);break;case xd.Histogram:const a={xColumnName:n.xAxis,plotType:n.catalogPlotType},l=t.widgetsStore.createFloatingCatalogPlotWidget(a);i.setCatalogPlots(l.widgetComponentId,this.catalogFileId,l.widgetStoreId)}},this.handlePlotTypeChange=e=>{this.widgetStore.setCatalogPlotType(e)},this.onCatalogTableDataSelected=e=>{const t=this.profileStore;if(!this.widgetStore.showSelectedData)if(1===e.length){const i=t.selectedPointIndices;let n=!1;1===i.length&&(n=i.includes(e[0])),n?t.setSelectedPointIndices([],!1):t.setSelectedPointIndices(e,!0)}else t.setSelectedPointIndices(e,!0)},this.renderFileIdPopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return Object(xm.jsx)(u.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.renderPlotTypePopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick,active:t.modifiers.active},e),this.onTableResize=e=>{const t=Math.floor(e/(this.height-130)*100);t<=Cd.MaxTableSeparatorPosition&&t>=Cd.MinTableSeparatorPosition&&(this.widgetStore.setTableSeparatorPosition(`${t}%`),JA.Instance.setPreference(QA.CATALOG_TABLE_SEPARATOR_POSITION,`${t}%`));const i=this.profileStore;i&&this.catalogHeaderTableRef&&this.updateTableSize(this.catalogHeaderTableRef,!1),i&&this.catalogTableRef&&this.updateTableSize(this.catalogTableRef,!1)},this.renderSystemPopOver=(e,t)=>{const i=Object(xm.jsx)(u.B,{text:$n.CoordinateSystemName.get(e),onClick:t.handleClick,active:t.modifiers.active},e);switch(e){case Yn.Pixel0:return Object(xm.jsx)("div",{children:Object(xm.jsx)(j.a,{position:"auto-end",content:Object(xm.jsx)("small",{children:"PIX0: 0-based image coordinates"}),children:i})},e);case Yn.Pixel1:return Object(xm.jsx)("div",{children:Object(xm.jsx)(j.a,{position:"auto-end",content:Object(xm.jsx)("small",{children:"PIX1: 1-based image coordinates"}),children:i})},e);default:return i}},this.shortcutoOnClick=t=>{this.widgetStore.setSettingsTabId(t),gC.Instance.widgetsStore.createFloatingSettingsWidget(e.WIDGET_CONFIG.title,this.props.id,e.WIDGET_CONFIG.type)},this.onCompleteRender=()=>{this.profileStore.regionSelected&&(this.widgetStore.showSelectedData?this.scrollToRegion(this.catalogTableRef,qn.c.row(0)):this.widgetStore.catalogTableAutoScroll&&(this.scrollToRegion(this.catalogTableRef,this.profileStore.autoScrollRowNumber),this.widgetStore.setCatalogTableAutoScroll(!1)))},Object(m.p)(this),hM.Instance.catalogProfiles.has(this.props.id)||hM.Instance.catalogProfiles.set(this.props.id,1),this.catalogFileNames=new Map,Object(m.h)((()=>{const e=gC.Instance.activeFrame,t=hM.Instance.activeCatalogFiles,i=this.profileStore;if(i){let n="";const r=i.catalogInfo.fileInfo.name,o=i.progress;o&&isFinite(o)&&o<1&&(n=`[${fi(100*o)}% complete]`),e&&(null===t||void 0===t?void 0:t.length)?WP.Instance.setWidgetComponentTitle(this.props.id,`Catalog : ${r} ${n}`):WP.Instance.setWidgetComponentTitle(this.props.id,"Catalog")}else WP.Instance.setWidgetComponentTitle(this.props.id,"Catalog")}))}updateTableSize(e,t){const i=e.locator.getViewportRect();e.updateViewportRect(i),t&&e.scrollToRegion(qn.c.column(0))}handleHeaderDisplayChange(e,t){const i=this.profileStore,n=this.widgetStore,r=e.target.checked,o=i.catalogControlHeader.get(t);i.setHeaderDisplay(r,t),(!0===r||""!==o.filter&&!1===r)&&i.isFileBasedCatalog&&this.handleFilterRequest(),n.xAxis===t&&n.setxAxis(Un.NONE),n.yAxis===t&&n.setyAxis(Un.NONE)}renderDataColumn(e,t){return Object(xm.jsx)(KO.a,{name:e,cellRenderer:(e,i)=>Object(xm.jsx)($O.a,{className:"header-table-cell",interactive:!0,children:t[e]},`cell_${i}_${e}`)},e)}renderSwitchButtonCell(e,t){const i=this.profileStore,r=i.catalogControlHeader.get(t).display;let o=i.loadingData;return Object(xm.jsx)($O.a,{className:"header-table-cell",children:Object(xm.jsx)(n.Fragment,{children:Object(xm.jsx)(u.P,{className:"cell-switch-button",disabled:o,checked:r,onChange:e=>this.handleHeaderDisplayChange(e,t)},`cell_switch_button_${e}`)})},`cell_switch_${e}`)}get axisOption(){const t=this.profileStore;let i=[];return i.push(Un.NONE),t.catalogControlHeader.forEach(((n,r)=>{const o=t.catalogHeader[n.dataIndex].dataType;e.axisDataType.includes(o)&&n.display&&i.push(r)})),i}get xAxisLable(){switch(this.widgetStore.catalogPlotType){case xd.ImageOverlay:return this.profileStore.activedSystem.x;default:return Un.X}}get yAxisLable(){switch(this.widgetStore.catalogPlotType){case xd.ImageOverlay:return this.profileStore.activedSystem.y;default:return Un.Y}}renderButtonColumns(e,t){switch(e){case nH.Display:return Object(xm.jsx)(KO.a,{name:e,cellRenderer:e=>this.renderSwitchButtonCell(e,t[e])},e);default:return Object(xm.jsx)(KO.a,{name:e},e)}}static GetDataType(e){switch(e){case Nt.ColumnType.Bool:return"bool";case Nt.ColumnType.Int8:return"byte";case Nt.ColumnType.Int16:return"short";case Nt.ColumnType.Int32:return"int";case Nt.ColumnType.Int64:return"long";case Nt.ColumnType.Uint8:return"unsigned byte";case Nt.ColumnType.Uint16:return"unsigned short";case Nt.ColumnType.Uint32:return"unsigned int";case Nt.ColumnType.Uint64:return"unsigned long";case Nt.ColumnType.Double:return"double";case Nt.ColumnType.Float:return"float";case Nt.ColumnType.String:return"string";default:return"unsupported"}}createHeaderTable(){const t=[],i=[],n=[],r=[],o=[],s=this.profileStore.catalogHeader,a=s.length;for(let u=0;u<s.length;u++){const t=s[u];i.push(t.name),n.push(t.description),r.push(t.units),o.push(e.GetDataType(t.dataType))}const l=this.renderDataColumn(nH.Name,i);t.push(l);const c=this.renderDataColumn(nH.Unit,r);t.push(c);const d=this.renderDataColumn(nH.Type,o);t.push(d);const p=this.renderButtonColumns(nH.Display,i);t.push(p);const h=this.renderDataColumn(nH.Description,n);return t.push(h),Object(xm.jsx)(QO.a,{ref:e=>this.onControlHeaderTableRef(e),numRows:a,enableRowReordering:!1,renderMode:ZO.a.BATCH,selectionModes:qn.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,enableGhostCells:!0,numFrozenColumns:1,columnWidths:this.widgetStore.headerTableColumnWidts,onColumnWidthChanged:this.updateHeaderTableColumnSize,enableRowResizing:!1,children:t})}render(){const e=this.widgetStore,t=this.profileStore,i=hM.Instance.activeCatalogFiles;if(!t||void 0===i||0===(null===i||void 0===i?void 0:i.length)||!e)return Object(xm.jsxs)("div",{className:"catalog-overlay",children:[Object(xm.jsx)(u.C,{icon:"folder-open",title:"No catalog file loaded",description:"Load a catalog file using the menu"}),";"]});const n=this.catalogDataInfo,r={dataset:n.dataset,filter:t.catalogControlHeader,columnHeaders:t.displayedColumnHeaders,numVisibleRows:n.numVisibleRows,columnWidths:t.tableColumnWidts,loadingCell:t.loadingData,selectedDataIndex:t.selectedPointIndices,showSelectedData:e.showSelectedData,updateTableRef:this.onCatalogDataTableRefUpdated,updateColumnFilter:t.setColumnFilter,updateByInfiniteScroll:this.updateByInfiniteScroll,updateTableColumnWidth:t.setTableColumnWidth,updateSelectedRow:this.onCatalogTableDataSelected,updateSortRequest:this.updateSortRequest,sortingInfo:t.sortingInfo,disableSort:t.loadOntoImage,tableHeaders:t.catalogHeader,onCompleteRender:this.onCompleteRender,catalogType:t.catalogType};if(!t.isFileBasedCatalog){const e=t;r.sortedIndexMap=e.sortedIndexMap;const i=t.selectedPointIndices.slice().sort(((e,t)=>e-t));r.sortedIndices=t.getSortedIndices(i)}let o=0;t.numVisibleRows&&(o=1);const s=t.catalogInfo.dataSize,a=t.maxRows,l=n.numVisibleRows;let c=`Showing ${o} to ${l} of total ${s} entries`;t.hasFilter&&isFinite(t.filterDataSize)&&(c=`Showing ${o} to ${l} of ${t.filterDataSize} filtered entries. Total ${s} entries`),a<s&&a>0&&(c=`Showing ${o} to ${l} of top ${a} entries. Total ${s} entries`),a<s&&a>0&&t.hasFilter&&isFinite(t.filterDataSize)&&(c=t.filterDataSize>=a?`Showing ${o} to ${l} of top ${a} entries. Total ${t.filterDataSize} filtered entries. Total ${s} entries`:`Showing ${o} to ${l} of ${t.filterDataSize} filtered entries. Total ${s} entries`);const d=s?Object(xm.jsx)("tr",{children:Object(xm.jsx)("td",{className:"td-label",children:Object(xm.jsx)("pre",{children:c})})}):null;let p=[];i.forEach((e=>{p.push(e)})),this.catalogFileNames=hM.Instance.getCatalogFileNames(i);let f=[];$n.CoordinateSystemName.forEach(((e,t)=>{f.push(t)}));const b=$n.CoordinateSystemName.get(t.catalogCoordinateSystem.system),m=e.catalogPlotType===xd.ImageOverlay,y=e.catalogPlotType===xd.Histogram,O=t.loadOntoImage;let j="footer-action-large";this.width<=600&&(j="footer-action-small");const x=Object(xm.jsx)(u.B,{disabled:!0,text:"No results"});return Object(xm.jsxs)("div",{className:"catalog-overlay",children:[Object(xm.jsxs)("div",{className:"catalog-overlay-filter-settings",children:[Object(xm.jsx)(u.p,{inline:!0,label:"File",children:Object(xm.jsx)(A.a,{className:"bp3-fill",filterable:!1,items:p,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFileIdPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{text:this.catalogFileId,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(u.p,{className:"catalog-system",disabled:!m,inline:!0,label:"System",children:Object(xm.jsx)(A.a,{filterable:!1,items:f,activeItem:t.catalogCoordinateSystem.system,onItemSelect:e=>t.setCatalogCoordinateSystem(e),itemRenderer:this.renderSystemPopOver,disabled:!m,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{text:b,disabled:!m,rightIcon:"double-caret-vertical"})})}),Object(xm.jsxs)(u.f,{className:"catalog-map-buttons",children:[Object(xm.jsx)(u.b,{onClick:()=>this.shortcutoOnClick(vd.SIZE),children:"Size"}),Object(xm.jsx)(u.b,{onClick:()=>this.shortcutoOnClick(vd.COLOR),children:"Color"}),Object(xm.jsx)(u.b,{onClick:()=>this.shortcutoOnClick(vd.ORIENTATION),children:"Orientation"})]})]}),Object(xm.jsxs)(YB.b,{className:"catalog-table",split:"horizontal",primary:"second",minSize:`${Cd.MinTableSeparatorPosition}%`,maxSize:`${Cd.MaxTableSeparatorPosition}%`,size:e.tableSeparatorPosition,onChange:this.onTableResize,children:[Object(xm.jsx)(YB.a,{className:"catalog-overlay-column-header-container",children:this.createHeaderTable()}),Object(xm.jsx)(YB.a,{className:"catalog-overlay-data-container",children:Object(xm.jsx)(JO,{...r})})]}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer",children:[Object(xm.jsx)("div",{className:"table-info",children:Object(xm.jsx)("table",{className:"info-display",children:Object(xm.jsx)("tbody",{children:d})})}),Object(xm.jsx)("div",{className:"footer-action-container",children:Object(xm.jsxs)("div",{className:j,children:[Object(xm.jsx)(A.a,{className:"catalog-type-button",filterable:!1,items:Object.values(xd),activeItem:e.catalogPlotType,onItemSelect:this.handlePlotTypeChange,itemRenderer:this.renderPlotTypePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{className:"bp3",text:e.catalogPlotType,rightIcon:"double-caret-vertical"})}),Object(xm.jsx)(u.p,{className:"catalog-axis",inline:!0,label:this.xAxisLable,disabled:O,children:Object(xm.jsx)(A.a,{className:"catalog-axis-select",items:this.axisOption,activeItem:null,onItemSelect:t=>e.setxAxis(t),itemRenderer:this.renderColumnNamePopOver,disabled:O,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:x,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{className:"catalog-axis-button",text:e.xAxis,disabled:O,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(u.p,{className:"catalog-axis",inline:!0,label:this.yAxisLable,disabled:y||O,children:Object(xm.jsx)(A.a,{className:"catalog-axis-select",items:this.axisOption,activeItem:null,onItemSelect:t=>e.setyAxis(t),itemRenderer:this.renderColumnNamePopOver,disabled:y||O,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:x,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{className:"catalog-axis-button",text:e.yAxis,disabled:y||O,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(hy,{className:"catalog-max-rows",label:"Max Rows",value:t.maxRows,onValueChanged:e=>t.setMaxRows(e),onValueCleared:()=>t.setMaxRows(t.catalogInfo.dataSize),displayExponential:!1,disabled:O||!t.isFileBasedCatalog})]})}),Object(xm.jsx)("div",{className:"bp3-dialog-footer",children:Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,text:"Filter",onClick:this.handleFilterRequest,disabled:O||!t.updateTableView||!t.hasFilter}),Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,text:"Reset",onClick:this.handleResetClick,disabled:O}),Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,text:"Close",onClick:this.handleFileCloseClick,disabled:O}),Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,text:"Plot",onClick:this.handlePlotClick,disabled:!this.enablePlotButton})]})})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},tH.axisDataType=[Nt.ColumnType.Double,Nt.ColumnType.Float,Nt.ColumnType.Int8,Nt.ColumnType.Uint8,Nt.ColumnType.Int16,Nt.ColumnType.Uint16,Nt.ColumnType.Int32,Nt.ColumnType.Uint32,Nt.ColumnType.Int64,Nt.ColumnType.Uint64],Uq=iH,Xq=Object(b.a)(Uq.prototype,"catalogTableRef",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),$q=Object(b.a)(Uq.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kq=Object(b.a)(Uq.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(b.a)(Uq.prototype,"catalogFileId",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"catalogFileId"),Uq.prototype),Object(b.a)(Uq.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"widgetStore"),Uq.prototype),Object(b.a)(Uq.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"profileStore"),Uq.prototype),Qq=Object(b.a)(Uq.prototype,"handleCatalogFileChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{hM.Instance.catalogProfiles.set(this.props.id,e)}}}),Zq=Object(b.a)(Uq.prototype,"handleFileCloseClick",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=gC.Instance,t=this.widgetStore,i=hM.Instance.catalogWidgets.get(this.catalogFileId);e.removeCatalog(this.catalogFileId,i,this.props.id),null===t||void 0===t||t.resetMaps()}}}),Object(b.a)(Uq.prototype,"catalogDataInfo",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"catalogDataInfo"),Uq.prototype),Object(b.a)(Uq.prototype,"enablePlotButton",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"enablePlotButton"),Uq.prototype),Jq=Object(b.a)(Uq.prototype,"onCatalogDataTableRefUpdated",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogTableRef=e}}}),eH=Object(b.a)(Uq.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=this.profileStore,n=this.widgetStore;this.height=t,this.width=e,i&&this.catalogHeaderTableRef&&this.updateTableSize(this.catalogHeaderTableRef,this.props.docked),i&&this.catalogTableRef&&n&&(this.updateTableSize(this.catalogTableRef,this.props.docked),i.regionSelected&&n.catalogTableAutoScroll&&!n.showSelectedData&&this.scrollToRegion(this.catalogTableRef,i.autoScrollRowNumber))}}}),Object(b.a)(Uq.prototype,"axisOption",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"axisOption"),Uq.prototype),Object(b.a)(Uq.prototype,"xAxisLable",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"xAxisLable"),Uq.prototype),Object(b.a)(Uq.prototype,"yAxisLable",[m.i],Object.getOwnPropertyDescriptor(Uq.prototype,"yAxisLable"),Uq.prototype),Yq=Uq))||Yq;var sH,aH;i(1012);let lH;!function(e){e[e.CONVERSION=0]="CONVERSION",e[e.LINE_PLOT_STYLING=1]="LINE_PLOT_STYLING",e[e.SCATTER_PLOT_STYLING=2]="SCATTER_PLOT_STYLING",e[e.SMOOTHING=3]="SMOOTHING"}(lH||(lH={}));let cH=Object(p.a)((aH=class extends n.Component{static get WIDGET_CONFIG(){return{id:"stokes-floating-settings",type:"floating-settings",minWidth:350,minHeight:300,defaultWidth:550,defaultHeight:450,title:"stokes-settings",isCloseable:!0,parentId:"stokes",parentType:"stokes",helpType:[xM.STOKES_ANALYSIS_SETTINGS_CONVERSION,xM.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING,xM.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING,xM.STOKES_ANALYSIS_SETTINGS_SMOOTHING]}}get widgetStore(){const e=WP.Instance;if(e.stokesAnalysisWidgets){const t=e.stokesAnalysisWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleEqualAxesValuesChanged=e=>{this.widgetStore.setEqualAxesValue(e.target.checked)},this.handleInvertedColorMapChanged=e=>{this.widgetStore.setInvertedColorMap(e.target.checked)},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=gC.Instance;Object(m.h)((()=>{if(this.widgetStore){if(this.widgetStore.effectiveFrame){const e=this.widgetStore.effectiveRegionId,i=0===e?"Cursor":`Region #${e}`,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Stokes Analysis Settings: ${i} ${n}`)}}}))}render(){const e=this.widgetStore,t={lineColorMap:new Map([["Primary",e.primaryLineColor],["Secondary",e.secondaryLineColor]]),lineOptions:[{value:"Primary",label:"Primary"},{value:"Secondary",label:"Secondary"}],lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setLineColor:(t,i)=>{"Primary"===t?e.setPrimaryLineColor(i):"Secondary"===t&&e.setSecondaryLineColor(i)},setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType},i={colorMap:e.colorMap,scatterPlotPointSize:e.scatterPlotPointSize,pointTransparency:e.pointTransparency,equalAxes:e.equalAxes,setPointTransparency:e.setPointTransparency,setScatterPlotPointSize:e.setScatterPlotPointSize,setColormap:e.setColormap,handleEqualAxesValuesChanged:this.handleEqualAxesValuesChanged,invertedColorMap:e.invertedColorMap,handleInvertedColorMapChanged:this.handleInvertedColorMapChanged},n=e.effectiveFrame&&e.effectiveFrame.hasStokes;return Object(xm.jsx)("div",{className:"stokes-settings",children:Object(xm.jsxs)(u.R,{id:"spectralSettingTabs",selectedTabId:e.settingsTabId,onChange:this.handleSelectedTabChanged,children:[Object(xm.jsx)(u.Q,{id:lH.CONVERSION,title:"Conversion",panel:Object(xm.jsx)(HO,{frame:e.effectiveFrame,onSpectralCoordinateChange:e.setSpectralCoordinate,onSpectralSystemChange:e.setSpectralSystem,disable:!n})}),Object(xm.jsx)(u.Q,{id:lH.LINE_PLOT_STYLING,title:"Line Plot Styling",panel:Object(xm.jsx)(sO,{...t})}),Object(xm.jsx)(u.Q,{id:lH.SCATTER_PLOT_STYLING,title:"Scatter Plot Styling",panel:Object(xm.jsx)(VO,{...i})}),Object(xm.jsx)(u.Q,{id:lH.SMOOTHING,title:"Smoothing",panel:Object(xm.jsx)(BO,{smoothingStore:e.smoothingStore,diableStyle:!0,diableDecimation:!0})})]})})}},Object(b.a)(aH.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(aH.prototype,"widgetStore"),aH.prototype),sH=aH))||sH;var dH;i(1013);const pH=LV.a.ofType();let hH=Object(p.a)(dH=class extends n.Component{constructor(...e){super(...e),this.onChannelFromChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedChannelRange(e,t.channelValueRange[1])},this.onChannelToChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedChannelRange(t.channelValueRange[0],e)},this.handleChannelSelectionClicked=()=>{const e=this.props.widgetStore;e.setMomentRangeSelectingMode(e.isSelectingMomentChannelRange?ah.NONE:ah.CHANNEL)},this.onMaskFromChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedMaskRange(e,t.maskRange[1])},this.onMaskToChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedMaskRange(t.maskRange[0],e)},this.handleMaskSelectionClicked=()=>{const e=this.props.widgetStore;e.setMomentRangeSelectingMode(e.isSelectingMomentMaskRange?ah.NONE:ah.MASK)},this.filterMoment=(e,t,i,n)=>{const r=yn.get(t),o=r.tag.toLowerCase(),s=e.toLowerCase();return n?o===s:r.tag.indexOf(s)>=0},this.renderMomentTag=e=>{const t=yn.get(e);return t?t.tag:void 0},this.renderMomentSelectItem=(e,{modifiers:t,handleClick:i})=>{const n=yn.get(e);return n?Object(xm.jsx)(u.B,{text:`${n.tag}: ${n.text}`,onClick:i,icon:this.props.widgetStore.isMomentSelected(e)?"tick":"blank"},e):void 0},this.handleMomentTagRemove=(e,t)=>{this.props.widgetStore.removeMomentByIndex(t)},this.handleMomentsClear=()=>{this.props.widgetStore.clearSelectedMoments()},this.handleRequestMoment=()=>{this.props.widgetStore.requestMoment()},this.handleRequestingMomentCancelled=()=>{this.props.widgetStore.requestingMomentCancelled()}}render(){const e=gC.Instance,t=this.props.widgetStore,i=t.effectiveFrame,r=i?`${e.getFrameIndex(i.frameInfo.fileId)}: ${i.filename}`:void 0,o=t.momentRegionInfo,s=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{className:"image-region-select",label:"Image",inline:!0,labelInfo:r?Object(xm.jsxs)(n.Fragment,{children:["(",Object(xm.jsx)("span",{className:"label-info",title:r,children:r}),")"]}):void 0,disabled:!i,children:Object(xm.jsx)(u.r,{value:t.fileId,options:t.frameOptions,onChange:e=>t.selectFrame(parseInt(e.target.value)),disabled:!i})}),Object(xm.jsx)(u.p,{className:"image-region-select",label:"Region",inline:!0,labelInfo:o?Object(xm.jsxs)(n.Fragment,{children:["(",Object(xm.jsx)("span",{className:"label-info",title:o,children:o}),")"]}):void 0,disabled:!i,children:Object(xm.jsx)(u.r,{value:t.momentRegionId,options:t.momentRegionOptions,onChange:e=>t.selectMomentRegion(parseInt(e.target.value)),disabled:!i})})]}),a=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(HO,{frame:i,onSpectralCoordinateChange:t.setSpectralCoordinate,onSpectralSystemChange:t.setSpectralSystem,disable:null===i||void 0===i?void 0:i.isPVImage}),i&&i.numChannels>1&&Object(xm.jsx)(u.p,{label:"Range",inline:!0,labelInfo:(null===i||void 0===i?void 0:i.spectralUnit)?`(${i.spectralUnit})`:"",children:Object(xm.jsxs)("div",{className:"range-select",children:[Object(xm.jsx)(u.p,{label:"From",inline:!0,children:Object(xm.jsx)(pO,{value:t.channelValueRange[0],buttonPosition:"none",onValueChange:e=>this.onChannelFromChanged(e)})}),Object(xm.jsx)(u.p,{label:"To",inline:!0,children:Object(xm.jsx)(pO,{value:t.channelValueRange[1],buttonPosition:"none",onValueChange:e=>this.onChannelToChanged(e)})}),Object(xm.jsx)("div",{className:"cursor-select",children:Object(xm.jsx)(j.a,{content:"Use cursor to select channel range in profiler",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{className:t.isSelectingMomentChannelRange?"bp3-active":"",icon:"select",onClick:this.handleChannelSelectionClicked})})})]})})]}),l=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"Mask",inline:!0,disabled:!i,children:Object(xm.jsx)(u.r,{value:t.momentMask,options:Object.keys(Nt.MomentMask).map((e=>({label:e,value:Nt.MomentMask[e]}))),onChange:e=>t.setMomentMask(parseInt(e.currentTarget.value)),disabled:!i})}),i&&i.numChannels>1&&Object(xm.jsx)(u.p,{label:"Range",inline:!0,labelInfo:`(${i.requiredUnit})`,children:Object(xm.jsxs)("div",{className:"range-select",children:[Object(xm.jsx)(u.p,{label:"From",inline:!0,children:Object(xm.jsx)(pO,{value:t.maskRange[0],buttonPosition:"none",onValueChange:e=>this.onMaskFromChanged(e)})}),Object(xm.jsx)(u.p,{label:"To",inline:!0,children:Object(xm.jsx)(pO,{value:t.maskRange[1],buttonPosition:"none",onValueChange:e=>this.onMaskToChanged(e)})}),Object(xm.jsx)("div",{className:"cursor-select",children:Object(xm.jsx)(j.a,{content:"Use cursor to select mask range in profiler",position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{className:t.isSelectingMomentMaskRange?"bp3-active":"",icon:"select",onClick:this.handleMaskSelectionClicked})})})]})})]}),c=i&&i.numChannels>1&&!e.animatorStore.animationActive&&!e.widgetsStore.isSpectralWidgetStreamingData&&t.isMomentRegionValid,d=Object(xm.jsxs)("span",{children:[Object(xm.jsx)("br",{}),Object(xm.jsx)("i",{children:Object(xm.jsxs)("small",{children:["Please ensure:",Object(xm.jsx)("br",{}),"1. Animation playback is stopped.",Object(xm.jsx)("br",{}),"2. Spectral profile generation is complete.",Object(xm.jsx)("br",{}),"3. Point region is not selected."]})})]}),p=Object(xm.jsxs)("span",{children:["Unable to generate moment images",d]}),h=Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(u.p,{label:"Moments",inline:!0,children:Object(xm.jsx)(pH,{placeholder:"Select...",items:Object.values(Nt.Moment),itemPredicate:this.filterMoment,itemRenderer:this.renderMomentSelectItem,onItemSelect:e=>t.isMomentSelected(e)?t.deselectMoment(e):t.selectMoment(e),selectedItems:t.selectedMoments,resetOnSelect:!0,fill:!0,popoverProps:{minimal:!0,position:"bottom"},tagRenderer:this.renderMomentTag,tagInputProps:{onRemove:this.handleMomentTagRemove,tagProps:{minimal:!0},rightElement:Object(xm.jsx)(u.e,{icon:"cross",minimal:!0,onClick:this.handleMomentsClear})}})}),Object(xm.jsx)("div",{className:"moment-generate",children:Object(xm.jsx)(j.a,{disabled:c,content:p,position:y.a.BOTTOM,children:Object(xm.jsx)(u.b,{intent:"success",onClick:this.handleRequestMoment,disabled:!c,children:"Generate"})})})]});return Object(xm.jsxs)("div",{className:"moment-generator",children:[Object(xm.jsxs)("div",{className:"moment-panel",children:[s,Object(xm.jsx)(u.n,{}),a,Object(xm.jsx)(u.n,{}),l,Object(xm.jsx)(u.n,{}),h]}),Object(xm.jsx)(WN,{isOpen:i&&i.isRequestingMoments&&i.requestingMomentsProgress<1,progress:i?i.requestingMomentsProgress:0,timeRemaining:e.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleRequestingMomentCancelled,text:"Generating moments"})]})}})||dH;var uH,gH;i(1014);let fH;!function(e){e[e.CONVERSION=0]="CONVERSION",e[e.STYLING=1]="STYLING",e[e.SMOOTHING=2]="SMOOTHING",e[e.MOMENTS=3]="MOMENTS",e[e.FITTING=4]="FITTING"}(fH||(fH={}));let bH=Object(p.a)((gH=class extends n.Component{static get WIDGET_CONFIG(){return{id:"spectral-profiler-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:550,defaultHeight:600,title:"spectral-profiler-settings",isCloseable:!0,parentId:"spectal-profiler",parentType:"spectral-profiler",helpType:[xM.SPECTRAL_PROFILER_SETTINGS_CONVERSION,xM.SPECTRAL_PROFILER_SETTINGS_STYLING,xM.SPECTRAL_PROFILER_SETTINGS_SMOOTHING,xM.SPECTRAL_PROFILER_SETTINGS_MOMENTS,xM.SPECTRAL_PROFILER_SETTINGS_FITTING]}}get widgetStore(){const e=WP.Instance;if(e.spectralProfileWidgets){const t=e.spectralProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=gC.Instance;Object(m.h)((()=>{if(this.widgetStore){if(this.widgetStore.effectiveFrame){const e=this.widgetStore.effectiveRegionId,i=0===e?"Cursor":`Region #${e}`,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Z Profile Settings: ${i} ${n}`)}}}))}render(){var e;const t=this.widgetStore,i={lineColorMap:t.lineColorMap,lineOrderedKeys:t.profileSelectionStore.profileOrderedKeys,lineOptions:t.profileSelectionStore.profileOptions,lineWidth:t.lineWidth,plotType:t.plotType,linePlotPointSize:t.linePlotPointSize,setLineColor:t.setProfileColor,setLineWidth:t.setLineWidth,setLinePlotPointSize:t.setLinePlotPointSize,setPlotType:t.setPlotType,meanRmsVisible:t.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,isAutoScaledX:t.isAutoScaledX,isAutoScaledY:t.isAutoScaledY,clearXYBounds:t.clearXYBounds,xMinVal:tn(t.minX,t.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:tn(t.maxX,t.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:tn(t.minY,t.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:tn(t.maxY,t.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(xm.jsx)("div",{className:"spectral-settings",children:Object(xm.jsxs)(u.R,{id:"spectralSettingTabs",selectedTabId:t.settingsTabId,onChange:this.handleSelectedTabChanged,children:[Object(xm.jsx)(u.Q,{id:fH.CONVERSION,panelClassName:"conversion-tab-panel",title:"Conversion",panel:Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(HO,{frame:t.effectiveFrame,onSpectralCoordinateChange:t.setSpectralCoordinate,onSpectralSystemChange:t.setSpectralSystem,disable:null===(e=t.effectiveFrame)||void 0===e?void 0:e.isPVImage}),Object(xm.jsx)(u.p,{label:"Intensity unit",inline:!0,children:Object(xm.jsx)(u.r,{disabled:!t.isIntensityConvertible,value:t.intensityUnit,options:t.intensityOptions,onChange:e=>t.setIntensityUnit(e.currentTarget.value)})})]})}),Object(xm.jsx)(u.Q,{id:fH.STYLING,panelClassName:"styling-tab-panel",title:"Styling",panel:Object(xm.jsx)(sO,{...i})}),Object(xm.jsx)(u.Q,{id:fH.SMOOTHING,title:"Smoothing",panel:Object(xm.jsx)(BO,{smoothingStore:t.smoothingStore,disableColorAndLineWidth:t.profileNum>1})}),Object(xm.jsx)(u.Q,{id:fH.MOMENTS,panelClassName:"moment-tab-panel",title:"Moments",panel:Object(xm.jsx)(hH,{widgetStore:t})}),Object(xm.jsx)(u.Q,{id:fH.FITTING,panelClassName:"fitting-tab-panel",title:"Fitting",panel:Object(xm.jsx)(qM,{fittingStore:t.fittingStore,widgetStore:t})})]})})}},Object(b.a)(gH.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(gH.prototype,"widgetStore"),gH.prototype),uH=gH))||uH;var mH,yH;i(1015);let OH;!function(e){e[e.STYLING=0]="STYLING",e[e.SMOOTHING=1]="SMOOTHING",e[e.COMPUTATION=2]="COMPUTATION"}(OH||(OH={}));let jH=Object(p.a)((yH=class extends n.Component{static get WIDGET_CONFIG(){return{id:"spatial-profiler-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:400,defaultHeight:450,title:"spatial-profiler-settings",isCloseable:!0,parentId:"spatial-profiler",parentType:"spatial-profiler",helpType:[xM.SPATIAL_PROFILER_SETTINGS_STYLING,xM.SPATIAL_PROFILER_SETTINGS_SMOOTHING,xM.SPATIAL_PROFILER_SETTINGS_COMPUTATION]}}get widgetStore(){const e=WP.Instance;if(e.spatialProfileWidgets){const t=e.spatialProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleWcsAxisChanged=e=>{this.widgetStore.setWcsAxisVisible(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleCoordinateChanged=e=>{this.widgetStore.setCoordinate(e.target.value)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=gC.Instance;Object(m.h)((()=>{if(this.widgetStore){const e=this.widgetStore.coordinate;if(t&&e){const i=this.widgetStore.isLineOrPolyline?"":e.toUpperCase(),n=this.widgetStore.effectiveRegionId===Br.CURSOR?"Cursor":`Region #${this.widgetStore.effectiveRegionId}`;t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`${i} Spatial Profile Settings: ${n}`)}}else t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"X Spatial Profile Settings: Cursor")}))}render(){const e=this.widgetStore,t={lineColorMap:new Map([["Primary",e.primaryLineColor]]),lineOptions:[{value:"Primary",label:"Primary"}],lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,showWCSAxis:e.wcsAxisVisible,setLineColor:(t,i)=>e.setPrimaryLineColor(i),setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,handleWcsAxisChanged:this.handleWcsAxisChanged,setPlotType:e.setPlotType,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,userSelectedCoordinate:e.coordinate,handleCoordinateChanged:this.handleCoordinateChanged,profileCoordinateOptions:[{value:"x",label:"X"},{value:"y",label:"Y"}],xMinVal:tn(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:tn(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:tn(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:tn(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(xm.jsx)("div",{className:"spatial-profiler-settings",children:Object(xm.jsxs)(u.R,{id:"spatialSettingTabs",selectedTabId:e.settingsTabId,onChange:this.handleSelectedTabChanged,children:[Object(xm.jsx)(u.Q,{id:OH.STYLING,title:"Styling",panel:Object(xm.jsx)(sO,{...t})}),Object(xm.jsx)(u.Q,{id:OH.SMOOTHING,title:"Smoothing",panel:Object(xm.jsx)(BO,{smoothingStore:e.smoothingStore})}),Object(xm.jsx)(u.Q,{id:OH.COMPUTATION,title:"Computation",panel:Object(xm.jsx)(u.p,{label:"Width",inline:!0,children:Object(xm.jsx)(pO,{min:1,max:10,stepSize:1,value:this.widgetStore.lineRegionSampleWidth,onValueChange:e=>this.widgetStore.setLineRegionSampleWidth(e)})})})]})})}},Object(b.a)(yH.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(yH.prototype,"widgetStore"),yH.prototype),mH=yH))||mH;var xH,SH;i(1016);let vH=Object(p.a)((SH=class extends n.Component{constructor(...e){super(...e),this.handleLogScaleChanged=e=>{this.widgetStore.setLogScale(e.target.checked)},this.handleMarkerTextChanged=e=>{this.widgetStore.setMarkerTextVisible(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()}}static get WIDGET_CONFIG(){return{id:"render-config-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:350,defaultHeight:375,title:"render-config-settings",isCloseable:!0,parentId:"render-config",parentType:"render-config",helpType:xM.RENDER_CONFIG_SETTINGS}}get widgetStore(){const e=WP.Instance;if(e.renderConfigWidgets){const t=e.renderConfigWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}render(){const e=this.widgetStore,t={lineColorMap:new Map([["Primary",e.primaryLineColor]]),lineOptions:[{value:"Primary",label:"Primary"}],lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setLineColor:(t,i)=>e.setPrimaryLineColor(i),setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,logScaleY:e.logScaleY,handleLogScaleChanged:this.handleLogScaleChanged,markerTextVisible:e.markerTextVisible,handleMarkerTextChanged:this.handleMarkerTextChanged,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,xMinVal:tn(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:tn(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:tn(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:tn(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(xm.jsx)("div",{className:"render-config-settings-panel",children:Object(xm.jsx)(sO,{...t})})}},Object(b.a)(SH.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(SH.prototype,"widgetStore"),SH.prototype),xH=SH))||xH;var CH,IH;i(1017);let wH=Object(p.a)((IH=class extends n.Component{static get WIDGET_CONFIG(){return{id:"histogram-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:350,defaultHeight:320,title:"histogram-settings",isCloseable:!0,parentId:"histogram",parentType:"histogram",helpType:xM.HISTOGRAM_SETTINGS}}get widgetStore(){const e=WP.Instance;if(e.histogramWidgets){const t=e.histogramWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleLogScaleChanged=e=>{this.widgetStore.setLogScale(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minX,i.linePlotInitXYBoundaries.minXVal),r=tn(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=tn(i.minY,i.linePlotInitXYBoundaries.minYVal),r=tn(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},Object(m.h)((()=>{const e=gC.Instance;if(this.widgetStore&&this.widgetStore.effectiveFrame){let t="Unknown";const i=this.widgetStore.effectiveRegionId;if(-1===i)t="Image";else if(this.widgetStore.effectiveFrame.regionSet){const e=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===i));e&&(t=e.nameString)}const n=this.widgetStore.matchesSelectedRegion?"(Active)":"";e.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Histogram Settings: ${t} ${n}`)}else e.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Histogram Settings")}))}render(){const e=this.widgetStore,t={lineColorMap:new Map([["Primary",e.primaryLineColor]]),lineOptions:[{value:"Primary",label:"Primary"}],lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setLineColor:(t,i)=>e.setPrimaryLineColor(i),setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,logScaleY:e.logScaleY,handleLogScaleChanged:this.handleLogScaleChanged,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,xMinVal:tn(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:tn(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:tn(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:tn(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(xm.jsx)("div",{className:"histogram-settings-panel",children:Object(xm.jsx)(sO,{...t})})}},Object(b.a)(IH.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(IH.prototype,"widgetStore"),IH.prototype),CH=IH))||CH;var TH;i(1018);let RH=Object(p.a)(TH=class extends n.Component{render(){const e=gC.Instance,t=d()("splash-screen",{"bp3-dark":e.darkTheme});return Object(xm.jsx)(u.E,{className:hS.a.OVERLAY_SCROLL_CONTAINER,autoFocus:!1,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:e.splashScreenVisible,usePortal:!0,children:Object(xm.jsxs)("div",{className:t,children:[Object(xm.jsx)("div",{className:"image-div",children:Object(xm.jsx)("img",{src:"carta_logo.png",width:150})}),Object(xm.jsxs)("div",{className:"appInfo-div",children:[Object(xm.jsxs)("h1",{children:[Vi.acronym," ",Vi.version," (",Vi.date,")"]}),Object(xm.jsx)("p",{children:Vi.fullName})]}),Object(xm.jsx)(u.O,{intent:g.a.PRIMARY,size:30,value:null}),Object(xm.jsx)("div",{className:"loadingInfo-div",children:Object(xm.jsx)("p",{children:e.logStore.newestMsg})})]})})}})||TH;var AH;let PH=Object(p.a)(AH=class extends n.Component{render(){return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsx)(nB,{}),Object(xm.jsx)(I_,{}),Object(xm.jsx)(NV,{}),Object(xm.jsx)(Cz,{}),Object(xm.jsx)(Jz,{}),Object(xm.jsx)(k_,{}),Object(xm.jsx)(bN,{}),Object(xm.jsx)(M_,{}),Object(xm.jsx)(__,{}),Object(xm.jsx)(mV,{}),Object(xm.jsx)(gL,{}),Object(xm.jsx)(yL,{}),Object(xm.jsx)(_U,{}),Object(xm.jsx)(IV,{}),Object(xm.jsx)(AV,{}),Object(xm.jsx)(RH,{}),Object(xm.jsx)(BV,{})]})}})||AH;class EH extends n.Component{render(){const e=gC.Instance;return Object(xm.jsx)("img",{src:e.darkTheme?this.props.dark:this.props.light,style:{width:this.props.width,height:"auto"}})}}var MH=i.p+"static/media/head_contour_button.57f566f7.png",FH=i.p+"static/media/head_contour_button_d.19bb31ae.png";const kH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:MH,dark:FH,width:"90%"})}),Object(xm.jsxs)("p",{children:["Contour configuration dialog allows you to generate a contour layer on top of a raster image in the image viewer. Steps to create a contour layer with the ",Object(xm.jsx)("code",{children:"Levels"})," tab are:"]}),Object(xm.jsxs)("ol",{children:[Object(xm.jsx)("li",{children:Object(xm.jsxs)("p",{children:["Select an image from the ",Object(xm.jsx)("code",{children:"Data source"})," dropdown. A per-channel histogram of the current channel and current Stokes as indicated in the animator will be displayed with visualization of mean (in dashed line) and mean +/- one standard deviation (in shaded area). Optionally, you can request per-cube histogram if necessary."]})}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("p",{children:"Define a set of contour levels to be calculated and rendered. There are various ways to define levels:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"Click"})," on the histogram plot to create a level. \xa0",Object(xm.jsx)("code",{children:"Right-Click"})," on a line to remove a level. Numerical values of levels are displayed in the ",Object(xm.jsx)("code",{children:"Levels"})," field."]}),Object(xm.jsxs)("li",{children:["Use the level generator. There are four preset generators. The generator will create a set of levels based on the control parameters by clicking the ",Object(xm.jsx)("code",{children:"Generate"})," button."]}),Object(xm.jsxs)("li",{children:["Manually input levels in the ",Object(xm.jsx)("code",{children:"Levels"})," field. Note that this field can be modified at any time, for example, after using the level generator."]})]})]}),Object(xm.jsx)("li",{children:Object(xm.jsxs)("p",{children:["When a set of levels is defined, clicking the ",Object(xm.jsx)("code",{children:"Apply"})," button will trigger the contour calculations and render in the image viewer."]})})]}),Object(xm.jsxs)("p",{children:["To remove a contour layer, click the ",Object(xm.jsx)("code",{children:"Clear"})," button."]}),Object(xm.jsx)("p",{children:"You may use the lock button next to the data source dropdown to disable or enable synchronization of data source with the image slider in the animator."}),Object(xm.jsx)("h3",{id:"contour-smoothness",children:"Contour smoothness"}),Object(xm.jsxs)("p",{children:["By default, the image is Gaussian-smoothed with a kernel size of four by four pixels before contour vertices are calculated. This can be customized in the ",Object(xm.jsx)("code",{children:"Configuration"})," tab. Suppored smoothing modes are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"No smoothing"}),Object(xm.jsx)("li",{children:"Block (faster, not ideal for compact objects)"}),Object(xm.jsx)("li",{children:"Gaussian (default, slower, better appearance)"})]}),Object(xm.jsx)("h3",{id:"contour-cosmetics",children:"Contour styling"}),Object(xm.jsxs)("p",{children:["The styling of contours can be customized with the ",Object(xm.jsx)("code",{children:"Styling"})," tab. Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Line thickness"}),Object(xm.jsx)("li",{children:"Representation of dashed line"}),Object(xm.jsx)("li",{children:"Color as constant color or color-mapped"}),Object(xm.jsx)("li",{children:"Bias"}),Object(xm.jsx)("li",{children:"Contrast"})]}),Object(xm.jsx)("p",{children:"Note that changes in styling will be applied immediately if the contour level set does not change."}),Object(xm.jsx)("h3",{id:"customizing-the-contour-configuration-dialog",children:"Customizing the contour configuration dialog"}),Object(xm.jsxs)("p",{children:["The defaults of many options in the contour configuration dialog are customizable via the ",Object(xm.jsx)("code",{children:"Contour configuration"})," tab in the preference dialog."]}),Object(xm.jsxs)("p",{children:["Performance-related options are included in the ",Object(xm.jsx)("code",{children:"Performance"})," tab of the preferences dialog. ",Object(xm.jsx)("em",{children:"Note that we do not recommend modifying the factory defaults. Change with caution."})]})]}),DH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"File browser allows you to"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Load images in CASA, FITS, MIRIAD, or HDF5-IDIA schema formats as raster"}),Object(xm.jsx)("li",{children:"Save images or subimages in CASA or FITS formats"}),Object(xm.jsx)("li",{children:"Import and export region text files in CASA (.crtf) or ds9 (.reg) formats"}),Object(xm.jsx)("li",{children:"Import catalogue files in VOTable or FITS formats"})]}),Object(xm.jsx)("h3",{id:"fileFiltering",children:"File filtering"}),Object(xm.jsx)("p",{children:"A file filter can be applied to the current directory. Three methods are provided:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Fuzzy search: free typing"}),Object(xm.jsx)("li",{children:"Unix-style search: e.g., *.fits"}),Object(xm.jsx)("li",{children:"Regular expression search: e.g., colou?r"})]}),Object(xm.jsx)("h3",{id:"images",children:"Images"}),Object(xm.jsxs)("p",{children:["Images can be loaded as raster via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Load image"}),", or appended as raster via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Append image"}),". All loaded images will be closed if you load an image with ",Object(xm.jsx)("strong",{children:"Load image"}),". The image shown in the image viewer can be closed via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Close image"}),". Images or subimages can be saved in CASA or FITS format via"," ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Save image"}),". Note that images can only be saved if the appropriate write permissions are enabled on the server."]}),Object(xm.jsxs)("p",{children:["When an image file is selected, its basic image properties are summarized in the ",Object(xm.jsx)("code",{children:"File Information"})," tab on the right-hand side. Full image header is shown in the ",Object(xm.jsx)("code",{children:"Header"})," tab."]}),Object(xm.jsxs)("p",{children:["You can load multiple images at once by selecting multiple images with ",Object(xm.jsx)("code",{children:"ctrl/cmd+click"})," or ",Object(xm.jsx)("code",{children:"shift+click"})," from the file list, and then clicking the ",Object(xm.jsx)("code",{children:"Load selected"})," button."]}),Object(xm.jsx)("p",{children:'If you would like to use the Stokes analysis widget, but your image is split into individual files (one per Stokes), you can create a Stokes hypercube by selecting the desired Stokes image files and clicking the "Load as hypercube" button. CARTA will load the files combined into a single image.'}),Object(xm.jsx)("h3",{id:"regions",children:"Regions"}),Object(xm.jsxs)("p",{children:["Region files can be imported via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Import regions"}),". When a region file is selected, its content is shown in the ",Object(xm.jsx)("code",{children:"Region Information"})," tab. Regions can be exported as region text files via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Export regions"}),". CASA and ds9 region text file definitions in world or image coordinates are supported. Note that regions can only be exported if the appropriate write permissions are enabled on the server."]}),Object(xm.jsxs)("p",{children:["You can load multiple region files at once by selecting multiple region files with ",Object(xm.jsx)("code",{children:"ctrl/cmd+click"})," or ",Object(xm.jsx)("code",{children:"shift+click"})," from the file list, and then clicking the ",Object(xm.jsx)("code",{children:"Load Region"})," button."]}),Object(xm.jsx)("h3",{id:"catalogs",children:"Catalogs"}),Object(xm.jsxs)("p",{children:["Catalogs can be loaded and visualized as tables via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Import catalog"}),". When a catalog file is selected, its basic catalog properties are summarized in the"," ",Object(xm.jsx)("code",{children:"Catalog Information"})," tab on the right-hand side. Full catalog column header is shown in the ",Object(xm.jsx)("code",{children:"Catalog Header"})," tab."]}),Object(xm.jsxs)("p",{children:["You can load multiple catalog files at once by selecting multiple catalog files with ",Object(xm.jsx)("code",{children:"ctrl/cmd+click"})," or ",Object(xm.jsx)("code",{children:"shift+click"})," from the file list, and then clicking the ",Object(xm.jsx)("code",{children:"Load Catalog"})," button."]})]});var LH=i.p+"static/media/head_fileinfo_button.2ba534d4.png",NH=i.p+"static/media/head_fileinfo_button_d.ed7099e2.png";const _H=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:LH,dark:NH,width:"90%"})}),Object(xm.jsx)("p",{children:"File header dialog provides full image header and a summary of the properties of the image in the current image view. To switch to other images, use the image slider in the animator widget, or use the image list widget."}),Object(xm.jsx)("p",{children:"Search function is available in the header tab. The search button appears when you hover over the header context. Matches are case-insensitive, and partial words are matched."})]}),zH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"With this dialog, the current layout can be saved and re-used in the future. The widgets in a layout can be either docked or undocked."}),Object(xm.jsx)("h3",{id:"layout-management",children:"Layout management"}),Object(xm.jsxs)("p",{children:["Load a preset layout or a custom layout: ",Object(xm.jsx)("strong",{children:"View"})," -> ",Object(xm.jsx)("strong",{children:"Layouts"})," -> ",Object(xm.jsx)("strong",{children:"Existing layouts"})]}),Object(xm.jsxs)("p",{children:["Set a layout as the default layout: ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Preferences"})," -> ",Object(xm.jsx)("strong",{children:"Global"})," tab -> ",Object(xm.jsx)("strong",{children:"Initial layout"}),"."]}),Object(xm.jsxs)("p",{children:["Delete a custom layout: ",Object(xm.jsx)("strong",{children:"View"})," -> ",Object(xm.jsx)("strong",{children:"Layouts"})," -> ",Object(xm.jsx)("strong",{children:"Delete layout"}),"."]})]});var VH=i.p+"static/media/head_preference_button.46e61f44.png",WH=i.p+"static/media/head_preference_button_d.9c3f5485.png";const GH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:VH,dark:WH,width:"90%"})}),Object(xm.jsx)("p",{children:"The preferences dialog provides a centralized place to customize the entire graphical user interface and performance control parameters. All settings are recorded and applied to new CARTA sessions. Some settings are effective immediately."}),Object(xm.jsx)("h3",{id:"global",children:"Global"}),Object(xm.jsx)("p",{children:"This section provides usability customization."}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Theme: the color theme of the graphical user interface (effective immediately)"}),Object(xm.jsx)("li",{children:"Auto-launch file browser: launch file browser when CARTA is initialized"}),Object(xm.jsx)("li",{children:"Initial layout: the default layout for a new CARTA session"}),Object(xm.jsx)("li",{children:"Initial cursor position: fix cursor at the image center or have cursor free to move"}),Object(xm.jsx)("li",{children:"Initial zoom level: view full image or view image with one image pixel to one screen pixel ratio"}),Object(xm.jsx)("li",{children:"Zoom to: control the focus of zooming with scrolling wheel"}),Object(xm.jsx)("li",{children:"Enable drag-to-pan: when enabled, pan action is achieved by click-and-dragging. When disabled, pan action is achieved by a click where the clicked pixel will be centered in the image viewer."}),Object(xm.jsx)("li",{children:"WCS matching on append: trigger WCS matching automatically for newly appended images"}),Object(xm.jsx)("li",{children:"Spectral matching: spectral convention to be used for spectral matching of image cubes"}),Object(xm.jsx)("li",{children:"Transparent image background: when this is enabled, the exported png image will have a transparent background. When it is disabled (default), a white or a black background is added depending on the GUI theme."}),Object(xm.jsx)("li",{children:"Save last used directory: when this is enabled, the file browser will start in the same folder the next session."})]}),Object(xm.jsx)("h3",{id:"render-configuration",children:"Render configuration"}),Object(xm.jsx)("p",{children:"This section provides customization of how a raster image is rendered by default."}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Default scaling: scaling function to be applied to a colormap"}),Object(xm.jsx)("li",{children:"Default colormap: colormap for rendering a raster image"}),Object(xm.jsx)("li",{children:"Default percentile ranks: clip level to be applied to the pixel value-to-color mapping"}),Object(xm.jsx)("li",{children:"NaN color: color to render a NaN (not a number) pixel"}),Object(xm.jsx)("li",{children:"Smoothed bias/contrast: when this is enabled (default), smooth bias and contrast functions are applied, resulting a smooth scaling function. When it is disabled, the final scaling function contains kinks."})]}),Object(xm.jsx)("h3",{id:"contour-configuration",children:"Contour configuration"}),Object(xm.jsx)("p",{children:"This section provides customization of how a contour layer is calculated and rendered by default."}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Generator type: default level generator type"}),Object(xm.jsx)("li",{children:"Smoothing mode: smoothing method to be applied before calculating contour vertices"}),Object(xm.jsx)("li",{children:"Default smoothing factor: kernel size of the selected smoothing mode"}),Object(xm.jsx)("li",{children:"Default contour levels: number of contour levels to be generated"}),Object(xm.jsx)("li",{children:"Thickness: contour line thickness"}),Object(xm.jsx)("li",{children:"Default color mode: to render contours with constant color or to render color-mapped contours"}),Object(xm.jsx)("li",{children:"Default color map: colormap for rendering color-mapped contours"}),Object(xm.jsx)("li",{children:"Default color: color for rendering contours with constant color"})]}),Object(xm.jsx)("h3",{id:"overlay-configuration",children:"Overlay configuration"}),Object(xm.jsx)("p",{children:"This section provides customization of the image overlay in the image viewer."}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Color: the default color of the grid layers including the coordinate bound box"}),Object(xm.jsx)("li",{children:"WCS grid visible: grid line rendering"}),Object(xm.jsx)("li",{children:"Label visible: grid x and y labels rendering"}),Object(xm.jsx)("li",{children:"WCS format: show world coordinates in degrees or sexagesimal or auto-formatted"}),Object(xm.jsx)("li",{children:"Beam visible: beam rendering at the bottom-left corner of the image viewer"}),Object(xm.jsx)("li",{children:"Beam color: the color to render a beam element"}),Object(xm.jsx)("li",{children:"Beam type: render a beam as open shape or filled shape"}),Object(xm.jsx)("li",{children:"Beam width: line width to render an open-shape beam"})]}),Object(xm.jsx)("h3",{children:"Catalog"}),Object(xm.jsx)("p",{children:"This section provides options to configure the catalog widget."}),Object(xm.jsx)("ul",{children:Object(xm.jsx)("li",{children:"Displayed columns: default displayed number of columns of a catalog in the widget."})}),Object(xm.jsx)("h3",{id:"region",children:"Region"}),Object(xm.jsx)("p",{children:"This section provides customization of region rendering properties and region creation interactivity."}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Color: default color to render a region"}),Object(xm.jsx)("li",{children:"Line width: default line width to render a region"}),Object(xm.jsx)("li",{children:"Dash length: when greater than zero, region is rendered in dashed line"}),Object(xm.jsx)("li",{children:"Region type: default region type"}),Object(xm.jsx)("li",{children:"Creation mode: the way how rectangle and ellipse regions are created with cursor"})]}),Object(xm.jsx)("h3",{id:"performance",children:"Performance"}),Object(xm.jsxs)("p",{children:["Performance related control parameters are included here. We do not recommend you to change the settings here. If the bandwidth connecting to a CARTA server is limited, you may enable the ",Object(xm.jsx)("code",{children:"low bandwidth mode"})," which reduces displayed image resolution and cursor responsiveness."]}),Object(xm.jsx)("h3",{id:"log-events",children:"Log events"}),Object(xm.jsx)("p",{children:"This is for development and debugging purpose. General users should not enable anything here."})]}),BH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"The region configuration dialog allows you to change the appearance of a region, such as"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color"}),Object(xm.jsx)("li",{children:"linewidth"}),Object(xm.jsx)("li",{children:"line style (solid or dashed)"})]}),Object(xm.jsx)("p",{children:"and region properties, such as"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"region name"}),Object(xm.jsx)("li",{children:"region location and shape properties in image or world coordinate"})]}),Object(xm.jsxs)("p",{children:["Region properties can be defined in world coordinate. If the coordinate reference system is FK4, FK5, or ICRS, the coordinate format is sexagesimal. If the coordinate system is Galactic or Ecliptic, the coordinate format is decimal degree. Region size can be defined in arcsecond with ",Object(xm.jsx)("code",{children:'"'}),", in arcminute with ",Object(xm.jsx)("code",{children:"'"}),", or in degree with ",Object(xm.jsx)("code",{children:"deg"}),"."]}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{id:"note",children:"NOTE"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"The displayed image coordinates refer to the spatial reference image as indicated in the title of the dialog."}),Object(xm.jsx)("li",{children:"The appearance of a region on a spatially matched image may be distorted due to projection effects."})]}),Object(xm.jsx)("h4",{id:"tip",children:"TIP"}),Object(xm.jsxs)("p",{children:[Object(xm.jsx)("code",{children:"Double-Click"})," on a region in the image viewer or on an entry in the region list widget will bring up this region configuration dialog."]})]});var qH=i.p+"static/media/head_animator_button.cfa001f3.png",HH=i.p+"static/media/head_animator_button_d.5f3989e8.png";const YH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:qH,dark:HH,width:"90%"})}),Object(xm.jsxs)("p",{children:["The animator widget controls which im\bage, which channel (if it exists per image file), and which Stokes (if exists per image file) to view in the image viewer. You may also enable animation playback for image, channel, or Stokes, via the ",Object(xm.jsx)("code",{children:"Play"})," button. The radio buttons control which one to animate. Playback mode includes"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Forward: with index increasing"}),Object(xm.jsx)("li",{children:"Backward: with index decreasing"}),Object(xm.jsx)("li",{children:"Bouncing: with index increasing and decreasing so on and so forth between the boundary"}),Object(xm.jsx)("li",{children:"Blink: with index jumping between the boundary"})]}),Object(xm.jsx)("p",{children:"For channel, you may limit a channel range for animation playback via the double slider."}),Object(xm.jsx)("p",{children:"A desired frame rate per second (fps) can be defined in the frame rate spinbox. Note that the real fps depends on computer performance and network performance."}),Object(xm.jsxs)("p",{children:["A step for animation playback (default 1) can be set with the step spinbox. Click the frame rate dropdown to select ",Object(xm.jsx)("code",{children:"Step"})," and use the spinbox to define a step."]}),Object(xm.jsxs)("p",{children:["For performance reasons and resource management, animation playback will be automatically stopped after 5 minutes by default. This can be customized in the ",Object(xm.jsx)("code",{children:"Performance"})," tab of the preferences dialog (",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Preferences"}),"). Maximum playback time is 30 mins."]})]});var UH=i.p+"static/media/head_histogram_button.42144255.png",XH=i.p+"static/media/head_histogram_button_d.3a13afc0.png";const $H=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:UH,dark:XH,width:"90%"})}),Object(xm.jsx)("p",{children:"Histogram widget displays a histogram plot derived from a 2D region. When no region is created or selected, it displays a histogram derived from the current full image in the image viewer."}),Object(xm.jsx)("h3",{id:"images",children:"Images"}),Object(xm.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(xm.jsx)("h3",{id:"regions",children:"Regions"}),Object(xm.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. You can select a region by clicking one in the image viewer, or by clicking a region entry on the region list widget. Histogram plot of the selected region will be updated accordingly.'}),Object(xm.jsx)("h3",{id:"interactivity-zoom-and-pan",children:"Interactivity: zoom and pan"}),Object(xm.jsx)("p",{children:"The x and y ranges of the histogram plot can be modified by"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"drag-and-drop"})," horizontally to zoom in x"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"drag-and-drop"})," vertically to zoom in y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"drag-and-drop"})," diagonally to zoom in both x and y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(xm.jsx)("p",{children:"In addition, the x and y ranges can be explicitly set in the histogram settings dialog."}),Object(xm.jsx)("h3",{id:"exports",children:"Exports"}),Object(xm.jsx)("p",{children:"The histogram plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(xm.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(xm.jsx)("p",{children:"The appearance of the histogram plot is customizable via the histogram settings dialog (the cog icon). Supported options are:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"}),Object(xm.jsx)("li",{children:"display y in logarithmic scale (default)"})]}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{id:"note",children:"Note"}),Object(xm.jsx)("p",{children:"In the current release, the number of histogram bins is automatically derived as the square root of the product of region bound box sizes in x and y. The development team will improve this in future releases."}),Object(xm.jsx)("h4",{id:"tip",children:"TIP"}),Object(xm.jsx)("p",{children:"Multiple histogram widgets can be created to show histograms for different images with different regions."})]}),KH=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"Histogram settings dialog allows you to customize the appearance of the histogram plot, and set x and y ranges of the plot explicitly."}),Object(xm.jsx)("p",{children:"Supported options are:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"}),Object(xm.jsx)("li",{children:"display y in logarithmic scale (default)"})]})]});var QH=i.p+"static/media/catalogue_selection_button.6c5c75ad.png",ZH=i.p+"static/media/catalogue_selection_button_d.d60042bc.png",JH=i.p+"static/media/contour_button.57f566f7.png",eY=i.p+"static/media/contour_button_d.19bb31ae.png",tY=i.p+"static/media/export_png_button.ad3d7040.png",iY=i.p+"static/media/export_png_button_d.3314b4ac.png",nY=i.p+"static/media/image_info_button.2ba534d4.png",rY=i.p+"static/media/image_info_button_d.ed7099e2.png",oY=i.p+"static/media/image_tools.3b0bc13d.png",sY=i.p+"static/media/image_tools_d.86185081.png",aY=i.p+"static/media/region_button.a95e8b71.png",lY=i.p+"static/media/region_button_d.7533887d.png",cY=i.p+"static/media/wcs_match_button.0c2c1335.png",dY=i.p+"static/media/wcs_match_button_d.9bf58e92.png",pY=i.p+"static/media/zoom_button.8cec85be.png",hY=i.p+"static/media/zoom_button_d.5312a073.png",uY=i.p+"static/media/head_catalogue_button.89097734.png",gY=i.p+"static/media/head_catalogue_button_d.b6535928.png";const fY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"The image viewer widget serves as the core component of CARTA. It allows you to visualize images in rasters and in contours. Region of interests can be defined interactively with the image viewer and subsequent image analysis can be performed with other widgets. Catalogue files can be loaded and visualized in the image viewer with the Catalogue widget."}),Object(xm.jsxs)("p",{children:["Images can be loaded via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Open image"})," (will close all loaded image first). You may load multiple images via ",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Append image"}),". All images are loaded as raster by default. Contour layers can be further generated via the contour configuration dialog."]}),Object(xm.jsxs)("p",{children:["Information of world coordinates and image coordinates at the cursor position is shown at the top of the image viewer. To freeze/unfreeze the cursor position, press ",Object(xm.jsx)("code",{children:"F"})," key."]}),Object(xm.jsx)("h3",{id:"image-tool-buttons",children:"Image tool buttons"}),Object(xm.jsx)("p",{children:"A set of tool buttons is provided at the bottom-right corner when hovering over the image viewer. You may use these buttons to"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Select a source from catalog overlay"}),Object(xm.jsx)("li",{children:"Create regions"}),Object(xm.jsx)("li",{children:"Change image zoom scale"}),Object(xm.jsx)("li",{children:"Trigger WCS matching"}),Object(xm.jsx)("li",{children:"Change grid overlay reference frame"}),Object(xm.jsx)("li",{children:"Enable/disable grid lines and coordinate labels"}),Object(xm.jsx)("li",{children:"Export image"})]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:oY,dark:sY,width:"90%"})}),Object(xm.jsx)("h3",{id:"zoom-and-pan",children:"Zoom and pan"}),Object(xm.jsx)("p",{children:"Zoom actions can be triggered in different ways. The most common one is to use mouse and scroll wheel. By scrolling up, image is zoomed in, while by scrolling down, image is zoomed out. Alternatively, you may use the tool buttons at the bottom-right corner of the image viewer to zoom in, zoom out, zoom to fit screen resolution, or zoom to fit image view."}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:pY,dark:hY,width:"70%"})}),Object(xm.jsxs)("p",{children:["Panning is achieved by ",Object(xm.jsx)("code",{children:"drag-end-drop"})," as default. This default can be changed via the preferences dialog (",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Preferences"})," -> ",Object(xm.jsx)("strong",{children:"Global"}),"). The alternative mode is ",Object(xm.jsx)("code",{children:"click"}),", which causes the clicked pixel to be centered in the image viewer."]}),Object(xm.jsx)("h3",{id:"matching-image-spatially-and-spectrally",children:"Matching image spatially and spectrally"}),Object(xm.jsxs)("p",{children:["Different images may be matched in world coordinate spatially and/or spectrally. This can be triggered by the ",Object(xm.jsx)("code",{children:"WCS matching"})," button. Matching WCS on appending can be enabled in the preferences dialog."]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:cY,dark:dY,width:"70%"})}),Object(xm.jsx)("p",{children:"CARTA supports the following matching schemes:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"None: zoom levels of different images are independent. No matching in the spectral domain."}),Object(xm.jsx)("li",{children:"Spatial only: images are matched to the reference image in the spatial domain by translation, rotation, and scaling."}),Object(xm.jsx)("li",{children:"Spectral only: images are matched to the reference image in the spectral domain with nearest interpolation."}),Object(xm.jsx)("li",{children:"Spatial and spectral: images are matched to the reference image both in the spatial domain and spectral domain."})]}),Object(xm.jsx)("p",{children:"Note that images are spatially matched through application of translation, rotation, and scaling. You may see prominent inconsistencies if you attempt to match wide field images or images with different projection schemes. However, grid lines are still accurate per image. If contour layers exist, they will match the raster image in the current image view with high position accuracy. Spectral matching is performed with nearest interpolation."}),Object(xm.jsx)("h3",{id:"contour-layers",children:"Contour layers"}),Object(xm.jsx)("p",{children:"A contour layer can be generated via the contour configuration dialog. Contours of spatially matched image are re-projected precisely to other spatially matched raster images."}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:JH,dark:eY,width:"85%"})}),Object(xm.jsx)("h3",{id:"region-of-interest",children:"Region of interest"}),Object(xm.jsx)("p",{children:"Four types of region of interest are supported, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Point"}),Object(xm.jsx)("li",{children:"Rectangle (rotatable)"}),Object(xm.jsx)("li",{children:"Ellipse (rotatable)"}),Object(xm.jsx)("li",{children:"Polygon"})]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:aY,dark:lY,width:"70%"})}),Object(xm.jsx)("p",{children:"The default region type and the default region creation mode are customizable in the preferences dialog. Region shortcut buttons are available at the top of the CARTA GUI. The tooltip of a region shortcut button provides instructions to create a region."}),Object(xm.jsx)("h3",{id:"catalogue-layers",children:"Catalog overlay"}),Object(xm.jsx)("p",{children:"A catalog overlay can be generated via the Catalog widget."}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:uY,dark:gY,width:"85%"})}),Object(xm.jsx)("p",{children:"To select a source, use the Catalog selection button. The selected source will be highlighted in the table of the Catalog widget."}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:QH,dark:ZH,width:"70%"})}),Object(xm.jsx)("h3",{id:"customizing-the-image-plot",children:"Image plot cosmetics"}),Object(xm.jsx)("p",{children:" Elements of the image plot such as grid line style, label style, colorbar style, etc., can be customized via the image viewer settings dialog."}),Object(xm.jsx)("h3",{id:"exports",children:"Image plot export"}),Object(xm.jsxs)("p",{children:["What you see in the current image view can be exported as a PNG file with the ",Object(xm.jsx)("code",{children:"Export image"})," button in the image tool bar."]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:tY,dark:iY,width:"70%"})}),Object(xm.jsx)("h3",{id:"image-information-and-header",children:"Image information and header"}),Object(xm.jsx)("p",{children:"Basic image information and full image headers are displayed in the file header dialog."}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:nY,dark:rY,width:"85%"})})]});var bY=i.p+"static/media/image_overlay_demo.60946b95.png",mY=i.p+"static/media/image_overlay_demo_d.c9072eba.png";const yY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"The image view settings dialog allows you to customize coordinate grid related properties in the image viewer."}),Object(xm.jsx)("h3",{id:"global",children:"Global"}),Object(xm.jsx)("p",{children:"This section allows you to"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"set a global color theme for the grid overlay"}),Object(xm.jsx)("li",{children:"configure grid line rendering accuracy"}),Object(xm.jsx)("li",{children:"put coordinate labels inside or outside the image"}),Object(xm.jsx)("li",{children:"select a coordinate reference frame to generate the grid overlay"})]}),Object(xm.jsx)("h3",{id:"title",children:"Title"}),Object(xm.jsx)("p",{children:"A custom title can be added in the image view. Its font type, font size, and color are configurable."}),Object(xm.jsx)("h3",{id:"ticks",children:"Ticks"}),Object(xm.jsx)("p",{children:"This section allows you to changes the ticks properties, including location, density, color, line width, and length of major and minor ticks"}),Object(xm.jsx)("h3",{id:"grid",children:"Grid"}),Object(xm.jsx)("p",{children:"The appearance of the coordinate grid lines is customizable, including visibility, color, and line width."}),Object(xm.jsx)("h3",{id:"border",children:"Border"}),Object(xm.jsx)("p",{children:"This section allows you to change the style of the axis border, including visibility, color, and width."}),Object(xm.jsx)("h3",{id:"axes",children:"Axes"}),Object(xm.jsx)("p",{children:"This section allows you to adjust the appearance of an interior axis overlay, including visibility, color, and line width."}),Object(xm.jsx)("h3",{id:"numbers",children:"Numbers"}),Object(xm.jsx)("p",{children:"This section allows you to customize the appearance of tick values, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"visibility"}),Object(xm.jsx)("li",{children:"font type"}),Object(xm.jsx)("li",{children:"font size"}),Object(xm.jsx)("li",{children:"color"}),Object(xm.jsx)("li",{children:"format as sexagesimal or decimal degree"}),Object(xm.jsx)("li",{children:"coordinate precision"})]}),Object(xm.jsx)("h3",{id:"labels",children:"Labels"}),Object(xm.jsx)("p",{children:"This section allows you to modify the styles of the x and y labels, such as font type, font size, and color. A custom label can be defined."}),Object(xm.jsx)("h3",{children:"Colorbar"}),Object(xm.jsx)("p",{children:"The appearance of the colorbar is highly configurable. This includes:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"visibility"}),Object(xm.jsx)("li",{children:"bar width"}),Object(xm.jsx)("li",{children:"offset"}),Object(xm.jsx)("li",{children:"position"}),Object(xm.jsx)("li",{children:"ticks density"}),Object(xm.jsx)("li",{children:"border style"}),Object(xm.jsx)("li",{children:"label style"}),Object(xm.jsx)("li",{children:"tick value style"}),Object(xm.jsx)("li",{children:"tick style"})]}),Object(xm.jsx)("h3",{id:"beam",children:"Beam"}),Object(xm.jsx)("p",{children:"This section allows you to change the appearance of a beam overlay (color, type, and line width) and adjust its position in the image viewer."}),Object(xm.jsx)("h3",{children:"Conversion"}),Object(xm.jsx)("p",{children:"This allows conversions of the spectral axis of a position-velocity image. For example, if the image header supports sufficient information, the axis labels can be displayed as offset v.s. velocity, offset v.s. frequency, or offset v.s. wavelength, etc.."}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{children:"EXAMPLE"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:bY,dark:mY,width:"100%"})})]});var OY=i.p+"static/media/head_layer_button.8539a494.png",jY=i.p+"static/media/head_layer_button_d.1559fdd2.png";const xY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:OY,dark:jY,width:"90%"})}),Object(xm.jsx)("p",{children:"The image list widget displays loaded images as a list, which includes the image name, rendering layers (R for raster and C for contours), layer visibility state, WCS matching state, color range matching state, channel index, and Stokes index. The channel index and Stokes index are synchronized with the animator."}),Object(xm.jsxs)("p",{children:["You may click ",Object(xm.jsx)("code",{children:"R"})," and/or ",Object(xm.jsx)("code",{children:"C"})," to hide/show a layer. For example, if you want to generate an image with contours only, you can hide raster layers by clicking ",Object(xm.jsx)("code",{children:"R"}),"."]}),Object(xm.jsxs)("p",{children:["Per image, you can click the ",Object(xm.jsx)("code",{children:"XY"})," button to enable/disable spatial matching and click the ",Object(xm.jsx)("code",{children:"Z"})," button to enable/disable spectral matching. To match color range to the reference image, click the"," ",Object(xm.jsx)("code",{children:"R"})," button."]}),Object(xm.jsxs)("p",{children:["To change reference image, ",Object(xm.jsx)("code",{children:"right-click"})," on a row to bring up the menu."]}),Object(xm.jsxs)("p",{children:["To close an image (or images), ",Object(xm.jsx)("code",{children:"right-click"})," on a row to bring up the menu."]}),Object(xm.jsxs)("p",{children:["The list order reflects the order of the image slider in the animator. To change the order, ",Object(xm.jsx)("code",{children:"click"})," to select an entry and ",Object(xm.jsx)("code",{children:"drag-and-drop"})," it to the desired position."]})]}),SY=Object(xm.jsx)("div",{children:"Image list setting help content"});var vY=i.p+"static/media/head_log_button.897ea179.png",CY=i.p+"static/media/head_log_button_d.cd2866be.png";const IY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:vY,dark:CY,width:"90%"})}),Object(xm.jsx)("p",{children:"Log widget provides information for diagnostics when something went wrong. The log levels include:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Debug"}),Object(xm.jsx)("li",{children:"Info (default)"}),Object(xm.jsx)("li",{children:"Warning"}),Object(xm.jsx)("li",{children:"Error"}),Object(xm.jsx)("li",{children:"Critical"})]}),Object(xm.jsxs)("p",{children:["When you believe there is something wrong, please contact the ",Object(xm.jsx)("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw",children:"helpdesk"})," or file an issue on ",Object(xm.jsx)("a",{href:"https://github.com/CARTAvis/carta/issues",children:"Github"})," (recommended)."]})]});var wY=i.p+"static/media/under_construction.b72aea0a.png";const TY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"To be added."}),Object(xm.jsx)("img",{src:wY,style:{width:"20%",height:"auto"}})]});var RY=i.p+"static/media/head_region_button.b4bd51b5.png",AY=i.p+"static/media/head_region_button_d.2f9691e6.png";const PY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:RY,dark:AY,width:"90%"})}),Object(xm.jsxs)("p",{children:["The region list widget provides you a list of regions created via the graphical user interface and/or via region import (",Object(xm.jsx)("strong",{children:"File"})," -> ",Object(xm.jsx)("strong",{children:"Import regions"}),"). The basic information of a region is shown as an entry in the list. The current active region is highlighted in the list and region control points are shown in the image viewer. To unselect a region, press the ",Object(xm.jsx)("code",{children:"Esc"})," key."]}),Object(xm.jsxs)("p",{children:[Object(xm.jsx)("code",{children:"double-click"})," on a list entry or on a region in the image viewer to bring up the region configuration dialog, where you can adjust region appearance and region properties."]}),Object(xm.jsxs)("p",{children:["The ",Object(xm.jsx)("code",{children:"lock"})," button for each region entry is to prevent editing a region accidentally. Locked regions will appear slightly dimmer in the image viewer. The ",Object(xm.jsx)("code",{children:"center"})," button is to center a region in the current field of view of the image viewer."]}),Object(xm.jsxs)("p",{children:["To delete an active (selected) region, press ",Object(xm.jsx)("code",{children:"delete"})," key."]})]});var EY=i.p+"static/media/head_renderconfig_button.1c688181.png",MY=i.p+"static/media/head_renderconfig_button_d.2793ba77.png";const FY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:EY,dark:MY,width:"90%"})}),Object(xm.jsxs)("p",{children:["The render configuration widget controls how a raster image is rendered in color space. The widget contains a set of clip levels as buttons on the top. The clip boundaries are displayed in the ",Object(xm.jsx)("code",{children:"Clip Min"})," and"," ",Object(xm.jsx)("code",{children:"Clip Max"})," fields. These fields can be manually edited and the clip level will switch to ",Object(xm.jsx)("code",{children:"Custom"}),". The clip boundaries are visualized as two vertical lines (draggable) in red in the histogram."]}),Object(xm.jsxs)("p",{children:["By default, a per-channel histogram is shown, and optionally a per-cube histogram can be displayed via the ",Object(xm.jsx)("code",{children:"Histogram"})," dropdown."]}),Object(xm.jsxs)("p",{children:["Different scaling functions and colormaps can be chosen via the ",Object(xm.jsx)("code",{children:"Scaling"})," and ",Object(xm.jsx)("code",{children:"Color map"})," dropdowns, respectively. A color map might be inverted via the ",Object(xm.jsx)("code",{children:"Invert color map"})," toggle."]}),Object(xm.jsxs)("p",{children:["Bias and contrast can be adjusted jointly via the 2D box (x as bias and y as contrast). The effective scaling function is visualized as a grey curve between the two red vertical lines. By default, smooth bias and contrast functions are applied so that the resulting scaling function is a smooth curve. You may disable this feature with the ",Object(xm.jsx)("code",{children:"Render configuration"})," tab of the preferences dialog."]}),Object(xm.jsx)("p",{children:"The appearance of the histogram plot can be configured through the render configuration settings dialog, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"}),Object(xm.jsx)("li",{children:"display y in logarithmic scale (default)"}),Object(xm.jsx)("li",{children:"display mean and RMS"}),Object(xm.jsx)("li",{children:"display clip labels"})]}),Object(xm.jsx)("h3",{id:"interactivity-zoom-and-pan",children:"Interactivity: zoom and pan"}),Object(xm.jsx)("p",{children:"The x and y ranges of the histogram plot can be modified by"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"shift + drag-and-drop"})," to pan in x"]})]}),Object(xm.jsx)("p",{children:"In addition, the x and y ranges can be explicitly set in the render configuration settings dialog."})]}),kY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:"The appearance of the histogram plot in the render configuration widget can be customized through this settings dialog, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"}),Object(xm.jsx)("li",{children:"display y in logarithmic scale (default)"}),Object(xm.jsx)("li",{children:"display mean and RMS"}),Object(xm.jsx)("li",{children:"display clip labels"})]})]});var DY=i.p+"static/media/head_spatial_button.938f9058.png",LY=i.p+"static/media/head_spatial_button_d.d1c466e7.png";const NY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:DY,dark:LY,width:"90%"})}),Object(xm.jsxs)("p",{children:["Spatial profiler widget allows you to view a profile from a horizontal cut or a vertical cut at the cursor position in the image viewer. The cursor position may be fixed in the image viewer by pressing ",Object(xm.jsx)("code",{children:"F"})," key. Pressing again will unfreeze the cursor."]}),Object(xm.jsx)("p",{children:"The cursor position in the image viewer is displayed as a red vertical line in the spatial profile plot."}),Object(xm.jsx)("p",{children:"When cursor is in the image viewer, the cursor position and pointed pixel value in image and world coordinates are reported at the bottom-left corner of the spatial profiler widget. When cursor moves into the spatial profile plot, numerical values of the profile at the cursor position (displayed as a grey vertical line) will be reported instead."}),Object(xm.jsx)("h3",{id:"profile-mean-and-rms",children:"Profile mean and RMS"}),Object(xm.jsxs)("p",{children:["As an option in the ",Object(xm.jsx)("code",{children:"Styling"})," tab of the spatial profiler settings dialog, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too."]}),Object(xm.jsx)("h3",{id:"profile-smoothing",children:"Profile smoothing"}),Object(xm.jsxs)("p",{children:["The displayed profile can be smoothed via the ",Object(xm.jsx)("code",{children:"Smoothing"})," tab of the spatial profiler settings dialog (the cog icon)."]}),Object(xm.jsx)("h3",{id:"interactivity-zoom-and-pan",children:"Interactivity: zoom and pan"}),Object(xm.jsx)("p",{children:"The x and y ranges of the spatial profile plot can be modified by"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"shift + drag-and-drop"})," to pan in x"]})]}),Object(xm.jsx)("p",{children:"In addition, the x and y ranges can be explicitly set in the spatial profiler settings dialog."}),Object(xm.jsx)("h3",{id:"exports",children:"Profile plot export"}),Object(xm.jsx)("p",{children:"The spatial profile plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(xm.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(xm.jsxs)("p",{children:["The appearance of the spatial profile plot is customizable via the ",Object(xm.jsx)("code",{children:"Styling"})," tab of the spatial profiler settings dialog (the cog icon). Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"}),Object(xm.jsx)("li",{children:"display alternative horizontal axis in world coordinate"})]}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{id:"note",children:"NOTE"}),Object(xm.jsxs)("p",{children:['For performance reasons, a profile is min-max decimated before rendering if the number of points of the profile is greater than the screen resolution of the spatial profiler widget. The kernel size of profile decimation is dynamically adjusted so that profile features are mostly preserved. When decimation is applied, the line style of the profile plot is switched to "line", regardless the setting in the spatial profiler settings dialog. When no decimation is applied (e.g., at higher profile zoom level, or profile has fewer points than the screen resolution), the line style becomes "step" (as default in the ',Object(xm.jsx)("code",{children:"Styling"})," tab of the settings dialog)."]})]}),_Y=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Styling"}),Object(xm.jsx)("p",{children:"The Styling tab allows you to adjust the appearance of the profile plot, and set x and y ranges of the plot explicitly. In addition, users can select which cut (horizontal or vertical) at cursor to use to generate a spatial profile. You may also enable visualization of mean and RMS values of the current profile in the plot."}),Object(xm.jsx)("p",{children:"Supported options for plot appearance are:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"}),Object(xm.jsx)("li",{children:"display alternative horizontal axis in world coordinate"})]})]});var zY=i.p+"static/media/smoothing_boxcar.2fe55f1c.png",VY=i.p+"static/media/smoothing_gaussian.dd0ec9a5.png",WY=i.p+"static/media/smoothing_hanning.a9ee32b3.png",GY=i.p+"static/media/smoothing_binning.780b507a.png",BY=i.p+"static/media/smoothing_SG.51c7ccc2.png",qY=i.p+"static/media/smoothing_decimation.96925a9d.png",HY=i.p+"static/media/smoothing_boxcar_d.7beaf6b3.png",YY=i.p+"static/media/smoothing_gaussian_d.1d6a6c39.png",UY=i.p+"static/media/smoothing_hanning_d.068e1feb.png",XY=i.p+"static/media/smoothing_binning_d.22137628.png",$Y=i.p+"static/media/smoothing_SG_d.9c0bf41f.png",KY=i.p+"static/media/smoothing_decimation_d.c27e29ba.png";const QY=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Smoothing"}),Object(xm.jsx)("p",{children:"Smoothing may be applied to profiles to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Boxcar"}),": convolution with a boxcar function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Gaussian"}),": convolution with a Gaussian function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Hanning"}),": convolution with a Hanning function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Binning"}),": averaging channels with a given width"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Savitzky-Golay"}),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Decimation"}),": min-max decimation with a given width"]})]}),Object(xm.jsx)("p",{children:"Optionally, the original profile can be overplotted with the smoothed profile. The appearance of the smoothed profile, including color, style, width, and size, can be customized."}),Object(xm.jsx)("p",{children:"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied."}),Object(xm.jsx)("h3",{children:"Examples"}),Object(xm.jsx)("p",{children:"Boxcar: Kernel = 2"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:zY,dark:HY,width:"90%"})}),Object(xm.jsx)("p",{children:"Gaussian: Sigma = 1"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:VY,dark:YY,width:"90%"})}),Object(xm.jsx)("p",{children:"Hanning: Kernel = 5"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:WY,dark:UY,width:"90%"})}),Object(xm.jsx)("p",{children:"Binning: Binning width = 3"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:GY,dark:XY,width:"90%"})}),Object(xm.jsx)("p",{children:"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:BY,dark:$Y,width:"90%"})}),Object(xm.jsx)("p",{children:"Decimation: Decimation width = 3"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:qY,dark:KY,width:"90%"})})]}),ZY=Object(xm.jsx)("div",{children:Object(xm.jsx)("h3",{children:"Computation"})});var JY=i.p+"static/media/head_spectral_button.5dc8cd0c.png",eU=i.p+"static/media/head_spectral_button_d.dd25d4cd.png";const tU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:JY,dark:eU,width:"90%"})}),Object(xm.jsxs)("p",{children:["The spectral profiler widget provides two different modes of viewing spectral profiles, depending on the states of the ",Object(xm.jsx)("code",{children:"Image"})," checkbox, the ",Object(xm.jsx)("code",{children:"Region"})," checkbox, the ",Object(xm.jsx)("code",{children:"Statistic"})," checkbox, and the"," ",Object(xm.jsx)("code",{children:"Stokes"})," checkbox."," "]}),Object(xm.jsxs)("p",{children:["When none of the checkboxes are selected, the spectral profiler widget displays one spectrum at a time only. You can view a region spectral profile (via the ",Object(xm.jsx)("code",{children:"Region"})," dropdown) of an image cube (via the"," ",Object(xm.jsx)("code",{children:"Image"})," dropdown) with a specific statistic (via the ",Object(xm.jsx)("code",{children:"Statistic"})," dropdown; default as mean). If Stokes axis exists, you may view a specific Stokes via the ",Object(xm.jsx)("code",{children:"Stokes"})," dropdown. You may have multiple widgets to view spectra side by side."]}),Object(xm.jsx)("p",{children:"When one of the checkboxes (Image/Region/Statistic/Stokes) is selected, the spectral profiler widget can display multiple spectra in one plot, depending on the selection in the dropdown menu of the selected checkbox. You can compare different spectra with same x and y ranges directly."}),Object(xm.jsx)("p",{children:"The spectral profiler widget supports four modes of multi-profile plot:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:["When the ",Object(xm.jsx)("code",{children:"Image"})," checkbox is selected: spectra from ",Object(xm.jsx)("em",{children:"different spatially and spectrally matched images"}),", from the selected region with the selected statistic, and the selected Stokes (if applicable), are displayed."]}),Object(xm.jsxs)("li",{children:["When the ",Object(xm.jsx)("code",{children:"Region"})," checkbox is selected: spectra from ",Object(xm.jsx)("em",{children:"different regions"})," of the selected image (and the selected Stokes if applicable) are displayed. The region spectra are computed with the selected statistic."]}),Object(xm.jsxs)("li",{children:["When the ",Object(xm.jsx)("code",{children:"Statistic"})," checkbox is selected: spectra with ",Object(xm.jsx)("em",{children:"different statistic quantities"})," from the selected region of the selected image (and the selected Stokes if applicable) are displayed."]}),Object(xm.jsxs)("li",{children:["When the ",Object(xm.jsx)("code",{children:"Stokes"})," checkbox is selected: spectra with ",Object(xm.jsx)("em",{children:"different Stokes parameters"})," from the selected image, the selected region and the selected statistic are displayed."]})]}),Object(xm.jsx)("p",{children:"In short, if multiple spectra are plotted, only one property (Image, Region, Statistic or Stokes) can be varied at a time. All other properties are fixed to a single value."}),Object(xm.jsx)("p",{children:"The cursor information of each profile is displayed at the bottom-left corner. The cursor information box is resizible when necessary."}),Object(xm.jsx)("h4",{children:"LIMITATION"}),Object(xm.jsxs)("p",{children:["If the intensity units of different matched cubes are different (e.g., Jy/beam vs Kelvin), ",Object(xm.jsx)("em",{children:"no"})," unit conversion is applied in the multi-profile plot. Intensity unit conversion will be available in a future release."]}),Object(xm.jsx)("h3",{id:"images",children:"Image dropdown menu"}),Object(xm.jsx)("p",{children:'The image dropdown menu defaults to "Active" image which means the current image in the image viewer. You may use the animator widget or the image list widget to change the active image.'}),Object(xm.jsx)("p",{children:"When the image checkbox is selected and if there are spatially and spectrally matched images (apply matching via the image list widget), the dropdown menu will display an image list with information about the matching state. You can select one of the images to view its spectral profile. If the selected image is matched to other images, spectra from those images will be displayed in the spectral profiler widget too, allowing a direct comparison of spectra from different image cubes."}),Object(xm.jsx)("h3",{id:"regions",children:"Region dropdown menu"}),Object(xm.jsx)("p",{children:'The region dropdown menu defaults to "Active" region which means the selected region in the image viewer. You can select an active region by clicking one on the image viewer, or by clicking a region entry in the region list widget. The spectral profile plot of the selected active region will be updated accordingly. If no region is selected, the region defaults to cursor.'}),Object(xm.jsx)("p",{children:"When the region checkbox is selected, the dropdown menu allows multiple selection. You can select different regions for profile calculations. "}),Object(xm.jsx)("h3",{children:"Statistic dropdown menu"}),Object(xm.jsx)("p",{children:'The statistic dropdown menu defaults to "Mean". When the statistic checkbox is selected, the dropdown menu allows multiple selection. You can select different statistic quantities for region spectral profile calculations.'}),Object(xm.jsx)("h3",{children:"Stokes dropdown menu"}),Object(xm.jsx)("p",{children:'When the image in the view contains multiple Stokes parameters, you can use this dropdown menu to view profiles from different Stokes. The dropdown menu defaults to "Current", meaning the selected Stokes via the animator.'}),Object(xm.jsx)("p",{children:"When the Stokes checkbox is selected, the dropdown menu allows multiple selection. You can select different Stokes parameters for region spectral profile calculations."}),Object(xm.jsx)("h3",{id:"spectral-conventions-and-reference-frame",children:"Spectral conventions and reference frame"}),Object(xm.jsxs)("p",{children:["With the ",Object(xm.jsx)("code",{children:"Conversion"})," tab of the spectral profiler settings dialog, you can change the spectral convention, including:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(xm.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Channel"})]}),Object(xm.jsx)("p",{children:"and spectral reference frame, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(xm.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(xm.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(xm.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(xm.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."}),Object(xm.jsx)("h3",{id:"profile-smoothing",children:"Profile smoothing"}),Object(xm.jsxs)("p",{children:["The displayed profile can be smoothed via the ",Object(xm.jsx)("code",{children:"Smoothing"})," tab of the spectral profiler settings dialog (the cog icon). A shortcut button of the ",Object(xm.jsx)("code",{children:"Smoothing"})," tab can be found at the top-right corner of the widget."]}),Object(xm.jsx)("h3",{id:"moment-image-generator",children:"Moment image generator"}),Object(xm.jsxs)("p",{children:["Moment images can be generated via the ",Object(xm.jsx)("code",{children:"Moments"})," tab of the spectral profiler settings dialog (the cog icon). A shortcut button of the ",Object(xm.jsx)("code",{children:"Moments"})," tab can be found at the top-right corner of the widget."]}),Object(xm.jsx)("h3",{children:"Profile fitting"}),Object(xm.jsxs)("p",{children:["You can fit a profile to a spectrum in the view via the ",Object(xm.jsx)("code",{children:"Fitting"})," tab of the spectral profiler settings dialog (the cog icon). You can find a shortcut button to the ",Object(xm.jsx)("code",{children:"Fitting"})," tab at the top-right corner of the widget. Note that profile fitting is not allowed when there are multiple profiles in the plot."]}),Object(xm.jsx)("h3",{id:"responsive-and-progressive-profile-update",children:"Responsive and progressive profile update"}),Object(xm.jsx)("p",{children:"When a region spectral profile is requested, depending on the performance of the server, you may see profiles are updated piece by piece with a regular interval. This feature provides a visual progress update for better user experience. In addition, if you move a region while its spectral profile is being updated, the old calculations will be terminated immediately and calculations of the new region spectral profile will start. You will see a partial profile in seconds."}),Object(xm.jsx)("h3",{id:"profile-mean-and-rms",children:"Profile mean and RMS"}),Object(xm.jsxs)("p",{children:["As an option in the ",Object(xm.jsx)("code",{children:"Styling"})," tab of the spectral profiler settings dialog, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If the zoom level changes, mean and RMS values will be updated too."]}),Object(xm.jsx)("h3",{id:"interactivity-zoom-pan-changing-channel",children:"Interactivity: zoom, pan, changing channel"}),Object(xm.jsx)("p",{children:"The x and y ranges of the spectral profile plot can be modified by"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(xm.jsxs)("p",{children:["In addition, the x and y ranges can be explicitly set in the ",Object(xm.jsx)("code",{children:"Styling"})," tab of the spectral profile settings dialog."]}),Object(xm.jsx)("p",{children:"You may click on the spectral profile plot to switch to a channel (as indicated by a red vertical line) and view the image in the image viewer. The red line is draggable and acts equivalently like the channel slider in the animator widget."}),Object(xm.jsx)("h3",{id:"exports",children:"Profile export"}),Object(xm.jsx)("p",{children:"The spectral profile plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(xm.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(xm.jsxs)("p",{children:["The appearance of the spectral profile plot is customizable via the ",Object(xm.jsx)("code",{children:"Styling"})," tab of the spectral profile settings dialog (the cog icon). Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"})]}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{id:"note",children:"NOTE"}),Object(xm.jsxs)("p",{children:['For performance concerns, a profile is decimated before rendering if the number of points of the profile is greater than the screen resolution of the spectral profiler widget. The kernel size of profile decimation is dynamically adjusted so that profile features are mostly preserved. When decimation is applied, the line style of the profile plot is switched to "line", regardless the setting in the spectral profiler settings dialog. When no decimation is applied (e.g., at higher profile zoom level, or profile has fewer points than the screen resolution), the line style becomes "step" (as default in the ',Object(xm.jsx)("code",{children:"Styling"})," tab of the settings dialog)."]})]}),iU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Conversion"}),Object(xm.jsxs)("p",{children:["With the ",Object(xm.jsx)("code",{children:"Conversion"})," tab, you can change the spectral convention, including:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(xm.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Channel"})]}),Object(xm.jsx)("p",{children:"and spectral reference frame, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(xm.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(xm.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(xm.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(xm.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."})]}),nU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Styling"}),Object(xm.jsxs)("p",{children:["The appearance of a spectral profile plot is customizable via the ",Object(xm.jsx)("code",{children:"Styling"})," tab. Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"})]}),Object(xm.jsx)("h4",{children:"Profile mean and RMS"}),Object(xm.jsx)("p",{children:"As an option in the spectral profiler settings dialog, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too."})]}),rU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Smoothing"}),Object(xm.jsx)("p",{children:"Smoothing may be applied to profiles to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Boxcar"}),": convolution with a boxcar function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Gaussian"}),": convolution with a Gaussian function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Hanning"}),": convolution with a Hanning function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Binning"}),": averaging channels with a given width"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Savitzky-Golay"}),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Decimation"}),": min-max decimation with a given width"]})]}),Object(xm.jsx)("p",{children:"Optionally, the original profile can be overplotted with the smoothed profile. The appearance of the smoothed profile, including color, style, width, and size, can be customized."}),Object(xm.jsx)("p",{children:"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied."}),Object(xm.jsx)("h3",{children:"Examples"}),Object(xm.jsx)("p",{children:"Boxcar: Kernel = 2"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:zY,dark:HY,width:"90%"})}),Object(xm.jsx)("p",{children:"Gaussian: Sigma = 1"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:VY,dark:YY,width:"90%"})}),Object(xm.jsx)("p",{children:"Hanning: Kernel = 5"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:WY,dark:UY,width:"90%"})}),Object(xm.jsx)("p",{children:"Binning: Binning width = 3"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:GY,dark:XY,width:"90%"})}),Object(xm.jsx)("p",{children:"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:BY,dark:$Y,width:"90%"})}),Object(xm.jsx)("p",{children:"Decimation: Decimation width = 3"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:qY,dark:KY,width:"90%"})})]}),oU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Moments"}),Object(xm.jsxs)("p",{children:["Moment images can be generated and viewed with CARTA. The ",Object(xm.jsx)("code",{children:"Moments"})," tab provides several control parameters to define how moment images are calculated, including:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Image"}),': the image file for moment calculations. "Active" refers to the image displayed in the image viewer.']}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Region"}),': a region can be selected so that moment calculations are limited inside the region. "Active" refers to the selected region in the image viewer. If no region is selected, full image is included in the moment calculations.']}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Coordinate, System, and Range"}),": the spectral range (e.g., velocity range) used for moment calculations is defined with these options. The range can be defined either via the text input fields, or via the cursor by dragging horizontally in the spectral profiler widget."]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Mask and Range"}),': these options define a pixel value range used for moment calculations. If mask is "None", all pixels are included. If mask is "Include" or "Exclude", the pixel value range defined in the text input fields is included or excluded, respectively. Alternatively, the pixel value range can be defined via the cursor by dragging vertically in the spectral profiler widget.']}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Moments"}),": which moment images to be calculated are defined here. Supported options are:",Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"-1: Mean value of the spectrum"}),Object(xm.jsx)("li",{children:"0: Integrated value of the spectrum"}),Object(xm.jsx)("li",{children:"1: Intensity weighted coordinate"}),Object(xm.jsx)("li",{children:"2: Intensity weighted dispersion of the coordinate"}),Object(xm.jsx)("li",{children:"3: Median value of the spectrum"}),Object(xm.jsx)("li",{children:"4: Median coordinate"}),Object(xm.jsx)("li",{children:"5: Standard deviation about the mean of the spectrum"}),Object(xm.jsx)("li",{children:"6: Root mean square of the spectrum"}),Object(xm.jsx)("li",{children:"7: Absolute mean deviation of the spectrum"}),Object(xm.jsx)("li",{children:"8: Maximum value of the spectrum"}),Object(xm.jsx)("li",{children:"9: Coordinate of the maximum value of the spectrum"}),Object(xm.jsx)("li",{children:"10: Minimum value of the spectrum"}),Object(xm.jsx)("li",{children:"11: Coordinate of the minimum value of the spectrum"})]})]})]}),Object(xm.jsxs)("p",{children:["When all the parameters are defined, by clicking the ",Object(xm.jsx)("code",{children:"Generate"})," button moment calculations will begin. Depending on the file size, moment calculations may take a while. If that happens, you may consider to cancel the calculations and re-define a proper region and/or spectral range."]}),Object(xm.jsx)("p",{children:'Once moment images are generated, they will be loaded and displayed in the image viewer. They are named as $image_filename.moment.$keyword. For example, if moment 0, 1 and 2 images are generated from the image M51.fits, they will be named as M51.fits.moment.integrated, M51.fits.moment.weighted_coord, and M51.fits.moment.weighted_dispersion_coord, respectively. These images are kept in RAM per session and if there is a new request of moment calculations, these images will be deleted first. Optionally, calculated moment images can be exported in CASA or FITS format via "File" -> "Save image".'}),Object(xm.jsx)("h4",{children:"NOTE"}),Object(xm.jsx)("p",{children:'Due to a CASA issue, image of "Median coordinate" cannot be generated. The request of "Median coordinate" is ignored automatically.'})]}),sU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Profile Fitting"}),Object(xm.jsx)("p",{children:"With the fitting tab, you can fit the observed spectrum with a model profile. Please ensure that there is only one spectral profile in the plot. Fitting multiple observed spectra is not supported. The supported profile functions are:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Gaussian"}),Object(xm.jsx)("li",{children:"Lorentzian"})]}),Object(xm.jsx)("p",{children:"In addition, an optional continuum profile can be added in the fit, including a constant profile and a linear profile."}),Object(xm.jsx)("h3",{children:"Set up initial solution for the fitter"}),Object(xm.jsxs)("p",{children:["In order to work correctly, the profiler fitting engine must be supplied with a good set of initial solutions of the free parameters. CARTA includes an ",Object(xm.jsx)("em",{children:"experimental"})," algorithm which analyzes the input profile and makes an educated guess of the initial solution. To use it, click the ",Object(xm.jsx)("code",{children:"auto detect"})," button. If there is a prominent continuum emission, please enable the ",Object(xm.jsx)("code",{children:"w/cont."})," toggle before clicking the"," ",Object(xm.jsx)("code",{children:"auto detect"})," button."]}),Object(xm.jsxs)("p",{children:["The auto-detect function will report how many components are found in the spectrum and visualize them as green boxes in the plot. Their numerical values are provided too. To see the initial values of different components, please use the slider for navigation. New components may be added via the component spinbox. A component may be removed with the ",Object(xm.jsx)("code",{children:"delete"})," button."]}),Object(xm.jsxs)("p",{children:["You may use the GUI to define the initial solution ",Object(xm.jsx)("em",{children:"manually"})," by entering the values with the text fields, or by using the mouse to draw a ",Object(xm.jsx)("em",{children:"box"})," on the plot. The height, width, and center position of the box represent the amplitude, FWHM, and center of a model profile, respectively. The lock button can be used to lock a parameter so that the parameter is fixed during the fitting process. You can define the initial solution of a continuum manually by entering the values with the text fields, or by using mouse to draw a ",Object(xm.jsx)("em",{children:"line"})," on the plot (recommended)."]}),Object(xm.jsx)("h4",{children:"NOTE"}),Object(xm.jsxs)("p",{children:["If the auto-detect function does not return a sensible solution (e.g., unexpected number of components), you can still edit it manually before clicking the ",Object(xm.jsx)("code",{children:"Fit"})," button. Please note that the initial solution does not need to be set precisely with respect to the true solution. The profile fitting engine can tolerate errors to some extent."]}),Object(xm.jsx)("h3",{children:"Trigger the fitting engine and view fitting results"}),Object(xm.jsxs)("p",{children:["Once you have set up a good set of initial solution, you can trigger the fitting process by clicking the ",Object(xm.jsx)("code",{children:"Fit"})," button. If you would like to trigger the fitter right after set of initial solutions are found by the auto-detect function, please enable the ",Object(xm.jsx)("code",{children:"auto fit"})," toggle. The fitting engine will include all the data in the current profile view. If you would like to exclude a certain feature in the fit, please try to zoom or pan the profile so that only the feature in interest is in the view."]}),Object(xm.jsxs)("p",{children:["The fitting results are summarized in the ",Object(xm.jsx)("code",{children:"Fitting result"})," box. The best-fit model is visualized in the plot including the residual profle. The full log can be viewed with the ",Object(xm.jsx)("code",{children:"View log"})," button."]})]});var aU=i.p+"static/media/head_statistics_button.6bdac5f7.png",lU=i.p+"static/media/head_statistics_button_d.6bdcaf7c.png";const cU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:aU,dark:lU,width:"90%"})}),Object(xm.jsx)("p",{children:"Statistics widget allows you to view statistical quantities over a 2D region. When no region is created or selected, it displays statistical quantities of the full image in the image viewer."}),Object(xm.jsx)("h3",{id:"images",children:"Images"}),Object(xm.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(xm.jsx)("h3",{id:"regions",children:"Regions"}),Object(xm.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. You can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Statistics of the selected region will be updated accordingly.'}),Object(xm.jsx)("h3",{id:"statistic",children:"Statistic"}),Object(xm.jsx)("p",{children:"CARTA provides the following statistical quantities:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"NumPixels: number of pixels in a region"}),Object(xm.jsx)("li",{children:"Sum: summation of pixel values in a region"}),Object(xm.jsx)("li",{children:"FluxDensity: total flux density in a region"}),Object(xm.jsx)("li",{children:"Mean: average of pixel values in a region"}),Object(xm.jsx)("li",{children:"StdDev: standard deviation of pixel values in a region"}),Object(xm.jsx)("li",{children:"Min: minimum pixel value in a region"}),Object(xm.jsx)("li",{children:"Max: maximum pixel value in a region"}),Object(xm.jsx)("li",{children:"Extrema: the maximum or minimum value in a region, depending on which absolute value is greater"}),Object(xm.jsx)("li",{children:"RMS: root mean square of pixel values in a region"}),Object(xm.jsx)("li",{children:"SumSq: summation of squared pixel values in a region"})]}),Object(xm.jsx)("h3",{children:"Text export"}),Object(xm.jsxs)("p",{children:["The statistics table can be exported as a text file. The ",Object(xm.jsx)("code",{children:"Export"})," button shows up at the bottom-right corner of the widget when you hover over the table."]}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{id:"tip",children:"TIP"}),Object(xm.jsx)("p",{children:"Multiple statistics widgets can be created to show statistics for different images and different regions."})]});var dU=i.p+"static/media/head_stokes_button.554491a0.png",pU=i.p+"static/media/head_stokes_button_d.7498c691.png";const hU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:dU,dark:pU,width:"90%"})}),Object(xm.jsxs)("p",{children:["The Stokes analysis widget is specifically made for efficient visualization of a cube with ",Object(xm.jsx)("em",{children:"multiple channels and multiple Stokes parameters (at least QU)"}),". If you have Stokes images as individual files, please use the file browser to select them (multiple selection) in the file list first and click the ",Object(xm.jsx)("code",{children:"Load as hypercube"})," button to form a Stokes hypercube."]}),Object(xm.jsx)("p",{children:"The widget includes plots, such as:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Region spectral profiles for Stokes Q and Stokes U, as absolute or fractional values (if Stokes I is present)"}),Object(xm.jsx)("li",{children:"Polarized intensity spectral profile, as absolute or fractional values (if Stokes I is present)"}),Object(xm.jsx)("li",{children:"Linearly polarized angle spectral profile"}),Object(xm.jsx)("li",{children:"Stokes Q vs Stokes U scatter plot"})]}),Object(xm.jsx)("p",{children:"All these plots are inter-linked so that when zooming profiles, data in the visible range will be highlighted in the scatter plot, and vice versa."}),Object(xm.jsx)("h3",{id:"images",children:"Image dropdown menu"}),Object(xm.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(xm.jsx)("h3",{id:"regions",children:"Region dropdown menu"}),Object(xm.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. You can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Stokes profile plot of the selected region will be updated accordingly. If no region is selected, "Active" region defaults to cursor.'}),Object(xm.jsx)("h3",{id:"spectral-conventions-and-reference-frame",children:"Spectral conventions and reference frame"}),Object(xm.jsxs)("p",{children:["With the ",Object(xm.jsx)("code",{children:"Conversion"})," tab of the Stokes analysis settings dialog, you can change the spectral convention, including:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(xm.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Channel"})]}),Object(xm.jsx)("p",{children:"and spectral reference frame, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(xm.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(xm.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(xm.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(xm.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."}),Object(xm.jsx)("h3",{id:"data-smoothing",children:"Data smoothing"}),Object(xm.jsxs)("p",{children:["The displayed profiles and the scatter plot can be smoothed via the ",Object(xm.jsx)("code",{children:"Smoothing"})," tab of the Stokes analysis settings dialog (the cog icon). A shortcut button of the ",Object(xm.jsx)("code",{children:"Smoothing"})," tab can be found at the top-right corner of the widget."]}),Object(xm.jsx)("h3",{id:"responsive-and-progressive-profile-update",children:"Responsive and progressive profile update"}),Object(xm.jsx)("p",{children:"When region Stokes profiles are requested, depending on the performance of the server, you may see profiles are updated piece by piece in regular interval. This feature provides a visual progress update for better user experience. In addition, if you move a region while profiles are being updating, the old calculations will be terminated immediately and calculations of the new region Stokes profiles will start. You will see partial profiles in seconds."}),Object(xm.jsx)("h3",{id:"interactivity-zoom-pan-changing-channel",children:"Interactivity: zoom, pan, changing channel"}),Object(xm.jsx)("p",{children:"The x and y ranges of the Stokes profile plot can be modified by"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"shift + drag-and-drop"})," to pan in x"]})]}),Object(xm.jsx)("p",{children:"You may click on the Stokes profile plot to switch to a channel (as indicated by a red vertical line) and view the image in the image viewer. The red line is draggable and acts equivalently like the channel slider in the animator widget."}),Object(xm.jsx)("h3",{id:"exports",children:"Profile plot and scatter plot export"}),Object(xm.jsx)("p",{children:"The Stokes profile plots and the QU scatter plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when you hover over the plot)."}),Object(xm.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(xm.jsxs)("p",{children:["The appearance of the Stokes profile plot is customizable via the ",Object(xm.jsx)("code",{children:"Line Plot Styling"})," tab of the Stokes analysis settings dialog (the cog icon). Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"colors of Stokes Q and Stokes U profiles"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"})]}),Object(xm.jsxs)("p",{children:["In addition, the appearance of the scatter plot can be customized with the ",Object(xm.jsx)("code",{children:"Scatter Plot Styling"})," tab too, including:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Colormap"}),Object(xm.jsx)("li",{children:"Symbol size"}),Object(xm.jsx)("li",{children:"Symbol transparency"}),Object(xm.jsx)("li",{children:"Q-to-U scale ratio as unity"})]})]}),uU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Conversion"}),Object(xm.jsxs)("p",{children:["With the ",Object(xm.jsx)("code",{children:"Conversion"})," tab, you can change the spectral convention, including:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(xm.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(xm.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(xm.jsx)("li",{children:"Channel"})]}),Object(xm.jsx)("p",{children:"and spectral reference frame, including:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(xm.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(xm.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(xm.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(xm.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."})]}),gU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Line Plot Styling"}),Object(xm.jsxs)("p",{children:["The appearance of the spectral profile plot is customizable via the ",Object(xm.jsx)("code",{children:"Line Plot Styling"})," tab. Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"color of the plot"}),Object(xm.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(xm.jsx)("li",{children:"line width for steps or lines"}),Object(xm.jsx)("li",{children:"point size for dots"})]})]}),fU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Scatter Plot Styling"}),Object(xm.jsxs)("p",{children:["The appearance of the scatter plot is customizable via the ",Object(xm.jsx)("code",{children:"Scatter Plot Styling"})," tab. Supported options are:"]}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"Colormap"}),Object(xm.jsx)("li",{children:"Symbol size"}),Object(xm.jsx)("li",{children:"Symbol transparency"}),Object(xm.jsx)("li",{children:"Q-to-U scale ratio as unity"})]})]}),bU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Smoothing"}),Object(xm.jsx)("p",{children:"Smoothing may be applied to profiles and the scatter plot to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Boxcar"}),": convolution with a boxcar function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Gaussian"}),": convolution with a Gaussian function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Hanning"}),": convolution with a Hanning function"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Binning"}),": averaging channels with a given width"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("b",{children:"Savitzky-Golay"}),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"]})]}),Object(xm.jsx)("p",{children:"Optionally, the original profile can be overplotted with the smoothed profile. "}),Object(xm.jsx)("p",{children:"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied. The tsv file of the scatter plot only contains the smoothed data if smoothing is applied."}),Object(xm.jsx)("h3",{children:"Examples"}),Object(xm.jsx)("p",{children:"Boxcar: Kernel = 2"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:zY,dark:HY,width:"90%"})}),Object(xm.jsx)("p",{children:"Gaussian: Sigma = 1"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:VY,dark:YY,width:"90%"})}),Object(xm.jsx)("p",{children:"Hanning: Kernel = 5"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:WY,dark:UY,width:"90%"})}),Object(xm.jsx)("p",{children:"Binning: Binning width = 3"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:GY,dark:XY,width:"90%"})}),Object(xm.jsx)("p",{children:"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:BY,dark:$Y,width:"90%"})})]});var mU=i.p+"static/media/demo_catalog_marker_mapping.6bd1d8e4.png",yU=i.p+"static/media/demo_catalog_marker_mapping_d.d695efa3.png";const OU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:uY,dark:gY,width:"90%"})}),Object(xm.jsxs)("p",{children:["Source catalog files in VOTable or FITS format can be loaded in CARTA (via ",Object(xm.jsx)("code",{children:"File"}),"-> ",Object(xm.jsx)("code",{children:"Import catalog"}),") for visualization as an image overlay, or a 2D scatter plot, or a histogram."]}),Object(xm.jsx)("p",{children:"Once a source catalog file is loaded, the information of each column will be shown in the upper table, while the actual catalog entries are displayed in the lower table. By default, only the first 10 columns are enabled and displayed. You may configure it to show or hide certain columns to be displayed in the lower table."}),Object(xm.jsx)("p",{children:"The source catalog table accepts sub-filters such as partial string match or value range. For numeric columns, supported operators are:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:">"})," greater than"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:">="})," greater than or equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"<"})," less than"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"<="})," less than or equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"=="})," equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"!="})," not equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:".."})," between (exclusive)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"..."})," between (inclusive)"]})]}),Object(xm.jsx)("p",{children:"Examples:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"< 10"})," (everything less than 10)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"== 1.23"})," (entries equal to 1.23)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"10..50"})," (everything between 10 and 50, exclusive)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"10...50"})," (everything between 10 and 50, inclusive)"]})]}),Object(xm.jsxs)("p",{children:["For string columns, partial match is adopted. For example, ",Object(xm.jsx)("code",{children:"gal"}),' (no quotation) will return entries containing the "gal" string.']}),Object(xm.jsxs)("p",{children:["Once filters are set, when the ",Object(xm.jsx)("code",{children:"Update"})," button is clicked, the filters will be applied and a filtered source catalog will be displayed up to a number of entries defined in the ",Object(xm.jsx)("code",{children:"Max Rows"})," text input field. When the ",Object(xm.jsx)("code",{children:"Reset"})," button is clicked, all filters will be removed and the image overlay (if exists) will be removed too. For the histogram plot or the 2D scatter plot, the plot will be reset so that only the first 50 entries are rendered."]}),Object(xm.jsx)("p",{children:"To visualize a source catalog, use the dropdown menu at the bottom of the widget to select a rendering type. CARTA supports three catalog rendering types including 1) image overlay, 2) 2D scatter plot, and 3) histogram plot. For image overlay, you need to identify two columns as the coordinates. Two numeric columns are needed to render a 2D scatter plot, and one numeric column is required to compute a histogram."}),Object(xm.jsx)("p",{children:"CARTA supports marker-based image overlay. You may render the marker with variable size, color, or orientation by mapping data columns to these rendering options. To set up the column mapping, please use the buttons at the top-right corner of the widget to launch the dialog."}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:mU,dark:yU,width:"100%"})}),Object(xm.jsx)("p",{children:"The source catalog table, the image overlay, the 2D scatter plot, and the histogram plot are inter-linked or cross-referenced. This means, for example, selecting a source or a set of source in the catalog table will trigger source highlight in other places. Or, selecting a source or a set of sources in the 2D scatter plot will trigger source highlight in other plots and in the catalog table."}),Object(xm.jsxs)("p",{children:["Multiple catalog files can be loaded and you may use the ",Object(xm.jsx)("code",{children:"File"})," dropdown at the top of the widget to switch in between. Multiple catalog widgets may be launched to display different catalog files. The"," ",Object(xm.jsx)("code",{children:"Close"})," button at the bottom of the widget will close the selected catalog file in the ",Object(xm.jsx)("code",{children:"File"})," dropdown. If there are spatially matched images, catalog image overlays are shared between matched images with proper coordinate transformations."]})]}),jU=Object(xm.jsxs)("div",{children:[Object(xm.jsxs)("p",{children:["The catalog histogram plot widget shows a histogram of one numeric column of a catalog file. The available numeric columns are determined by the ",Object(xm.jsx)("code",{children:"Display"})," column of the upper table in the Catalog widget."]}),Object(xm.jsxs)("p",{children:["The data used for plotting the histogram is determined by the lower table in the Catalog widget. The table may not show all entries because of the dynamic loading feature. Thus, the histogram plot may not include all entries (after filtering). The ",Object(xm.jsx)("code",{children:"Plot"})," button will request a full download of all entries and the histogram plot will then include all entries (after filtering). The number of bins and the scale of the y-axis (linear or log) can be customized."]}),Object(xm.jsxs)("p",{children:["When you click on a specific histogram bin, source entries of that bin will be highlighted in the source catalog table, in the 2D scatter plot (if it exists), and in the image viewer (if the catalog overlay is enabled). A certain histogram bin will be highlighted if source entries of that bin are selected in the source catalog table, in the 2D scatter plot (if exists), and in the image viewer (if the catalog overlay is enabled). The"," ",Object(xm.jsx)("code",{children:"Selected only"})," toggle will update the source catalog table to show only the selected sources."]})]}),xU=Object(xm.jsxs)("div",{children:[Object(xm.jsxs)("p",{children:["The Catalog 2D scatter plot widget shows a 2D scatter plot of two numeric columns of a catalog file. The available numeric columns in the dropdown menus at the bottom of the widget are determined by the ",Object(xm.jsx)("code",{children:"Display"})," ","column of the upper table in the Catalog widget."]}),Object(xm.jsxs)("p",{children:["The data used for rendering a 2D scatter plot is determined by the lower table in the Catalog widget. The table may not show all entries because of the dynamic loading feature. Thus, the 2D scatter plot may not include all entries (after filtering). The ",Object(xm.jsx)("code",{children:"Plot"})," button will request a full download of all entries and the 2D scatter plot will then include all entries (after filtering)."]}),Object(xm.jsxs)("p",{children:["Click on a point or use the selection tools from the top-right corner of the plot to highlight selected sources in the source catalog table, in the histogram plot (if exists), and in the image viewer (if the catalog overlay is enabled). Points on the plot will be highlighted if sources are selected in the source catalog table, in the histogram plot (if it exists), and in the image viewer (if the catalog overlay is enabled). The"," ",Object(xm.jsx)("code",{children:"Selected only"})," toggle will update the source catalog table to show only the selected sources."]})]});var SU=i.p+"static/media/demo_image_overlay_color_mapping.d08dc414.png",vU=i.p+"static/media/demo_image_overlay_color_mapping_d.3cb658ef.png";const CU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Marker color"}),Object(xm.jsxs)("p",{children:["This dialog provides options to set the color or colormap to source markers of an image overlay. If the ",Object(xm.jsx)("code",{children:"Column"})," dropdown menu is None, all markers are rendered with a single color as set with the ",Object(xm.jsx)("code",{children:"Color"})," ","dropdown menu. You may assign a numeric data column for color mapping. Different scaling, colormap, or clip bounds can be applied."]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:SU,dark:vU,width:"100%"})})]});var IU=i.p+"static/media/demo_image_overlay_Size_mapping.236ff2fd.png",wU=i.p+"static/media/demo_image_overlay_Size_mapping_d.a1caa573.png";const TU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Marker size"}),Object(xm.jsxs)("p",{children:["This dialog provides options to set the size of source markers of an image overlay. If the ",Object(xm.jsx)("code",{children:"Column"})," dropdown menu is None, all markers are rendered with a uniform size as set with the ",Object(xm.jsx)("code",{children:"Size"})," dropdown menu. You may assign a numeric data column for size mapping. Different scaling, size mode, size range, or clip bounds can be applied."]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:IU,dark:wU,width:"100%"})})]});var RU=i.p+"static/media/demo_image_overlay_orientation_mapping.5bf01bb0.png",AU=i.p+"static/media/demo_image_overlay_orientation_mapping_d.aaadbb04.png";const PU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Marker orientation"}),Object(xm.jsxs)("p",{children:["This dialog provides options to set the orientation of source markers of an image overlay. If the ",Object(xm.jsx)("code",{children:"Column"})," dropdown menu is None, all markers are rendered without applying an additional rotation applied. You may assign a numeric data column for orientation mapping. Different scaling, orientation range, or clip bounds can be applied."]}),Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:RU,dark:AU,width:"100%"})})]});var EU=i.p+"static/media/head_linequery_button.2a49bd33.png",MU=i.p+"static/media/head_linequery_button_d.3396c139.png";const FU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("p",{children:Object(xm.jsx)(EH,{light:EU,dark:MU,width:"90%"})}),Object(xm.jsx)("h3",{children:"Spectral line query"}),Object(xm.jsx)("p",{children:"CARTA supports an initial implementation of spectral line ID overlay on a spectral profiler widget with line data from the Splatalogue service (https://splatalogue.online). The query is made using a spectral range defined by defining in frequency or wavelength (rest frame) and optionally a lower limit of CDMS/JPL line intensity (log). The spectral range can be defined as from-to or center-width."}),Object(xm.jsx)("h4",{children:"QUERY LIMITATION"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsx)("li",{children:"The allowed maximum query range, equivalent in frequency, is 20 GHz."}),Object(xm.jsx)("li",{children:"The actual query is made with a frequency range in MHz rounded to integer."}),Object(xm.jsx)("li",{children:"When an intensity limit is applied, only the lines from CDMS and JPL catalogues will be returned."}),Object(xm.jsx)("li",{children:"Up to 100000 lines are displayed."})]}),Object(xm.jsx)("h4",{children:"NOTE"}),Object(xm.jsxs)("p",{children:["Currently, the Splatalogue query service is under active development. Unexpected query results might happen. If you believe there is something wrong, please contact the"," ",Object(xm.jsx)("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw",children:"helpdesk"})," or file an issue on ",Object(xm.jsx)("a",{href:"https://github.com/CARTAvis/carta/issues",children:"Github"})," (recommended)."]}),Object(xm.jsx)("h3",{children:"Spectral line filtering"}),Object(xm.jsx)("p",{children:"Once a query is successfully made, the line catalogue will be displayed in the tables. The upper table shows the column information in the catalogue with options to show or hide a specific column. The actual line catalogue is displayed in the lower table."}),Object(xm.jsx)("p",{children:"The spectral line catalogue table accepts sub-filters such as partial string match or value range. For numeric columns, supported operators are:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:">"})," greater than"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:">="})," greater than or equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"<"})," less than"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"<="})," less than or equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"=="})," equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"!="})," not equal to"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:".."})," between (exclusive)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"..."})," between (inclusive)"]})]}),Object(xm.jsx)("p",{children:"Examples:"}),Object(xm.jsxs)("ul",{children:[Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"< 10"})," (everything less than 10)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"== 1.23"})," (entries equal to 1.23)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"10..50"})," (everything between 10 and 50, exclusive)"]}),Object(xm.jsxs)("li",{children:[Object(xm.jsx)("code",{children:"10...50"})," (everything between 10 and 50, inclusive)"]})]}),Object(xm.jsxs)("p",{children:["For string columns, partial match is adopted. For example, ",Object(xm.jsx)("code",{children:"CH3"}),' (no quotation) will return entries containing the "CH3" string.']}),Object(xm.jsxs)("p",{children:["Once a set of filters is set, you can click the ",Object(xm.jsx)("code",{children:"Filter"})," button to apply it to the line table."]}),Object(xm.jsx)("h3",{children:"Spectral line ID visualization"}),Object(xm.jsx)("p",{children:'The "Shifted Frequency" column is computed based on the user input of a velocity or a redshift. This "Shifted Frequency" is adopted for line ID overlay on a spectral profiler widget.'}),Object(xm.jsx)("p",{children:"You can use the checkbox to select a set of lines to be overplotted in a spectral profiler widget. The maximum number of line ID overlays is 1000."}),Object(xm.jsxs)("p",{children:["The text labels of the line ID overlay are shown dynamically based on the zoom level of a profile. Different line ID overlays (with different velocity shifts) can be created on different spectral profilers widgets via the"," ",Object(xm.jsx)("code",{children:"Spectral Profiler"})," dropdown. By clicking the ",Object(xm.jsx)("code",{children:"Clear"}),' button, the line ID overlay on the selected "Spectral Profiler" will be removed.']}),Object(xm.jsx)("br",{}),Object(xm.jsx)("h4",{children:"NOTE"}),Object(xm.jsx)("p",{children:"The sorting functions in the line table will be available in a future release."})]}),kU=Object(xm.jsxs)("div",{children:[Object(xm.jsx)("h3",{children:"Form a Stokes hypercube"}),Object(xm.jsx)("p",{children:"This dialog allows user to confirm the auto-identification of the Stokes parameters from the image list and make corrections when necessary. The auto-identification obtains information from the image headers. If Stokes information is not available in the headers, CARTA will make a guess from the file names. Otherwise, you need to assign the Stokes parameters manually."})]}),DU=Object(xm.jsx)("div",{children:"PV Generator help content"});var LU;const NU=new Map([[xM.CONTOUR,kH],[xM.FILE_BROWSER,DH],[xM.FILE_INFO,_H],[xM.SAVE_LAYOUT,zH],[xM.PREFERENCES,GH],[xM.REGION_DIALOG,BH],[xM.STOKES,kU],[xM.ANIMATOR,YH],[xM.HISTOGRAM,$H],[xM.HISTOGRAM_SETTINGS,KH],[xM.IMAGE_VIEW,fY],[xM.IMAGE_VIEW_SETTINGS,yY],[xM.LAYER_LIST,xY],[xM.LAYER_LIST_SETTINGS,SY],[xM.LOG,IY],[xM.PLACEHOLDER,TY],[xM.REGION_LIST,PY],[xM.RENDER_CONFIG,FY],[xM.RENDER_CONFIG_SETTINGS,kY],[xM.SPATIAL_PROFILER,NY],[xM.SPATIAL_PROFILER_SETTINGS_STYLING,_Y],[xM.SPATIAL_PROFILER_SETTINGS_SMOOTHING,QY],[xM.SPATIAL_PROFILER_SETTINGS_COMPUTATION,ZY],[xM.SPECTRAL_PROFILER,tU],[xM.SPECTRAL_PROFILER_SETTINGS_CONVERSION,iU],[xM.SPECTRAL_PROFILER_SETTINGS_STYLING,nU],[xM.SPECTRAL_PROFILER_SETTINGS_SMOOTHING,rU],[xM.SPECTRAL_PROFILER_SETTINGS_MOMENTS,oU],[xM.SPECTRAL_PROFILER_SETTINGS_FITTING,sU],[xM.STATS,cU],[xM.STOKES_ANALYSIS,hU],[xM.STOKES_ANALYSIS_SETTINGS_CONVERSION,uU],[xM.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING,gU],[xM.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING,fU],[xM.STOKES_ANALYSIS_SETTINGS_SMOOTHING,bU],[xM.CATALOG_OVERLAY,OU],[xM.CATALOG_HISTOGRAM_PLOT,jU],[xM.CATALOG_SCATTER_PLOT,xU],[xM.CATALOG_SETTINGS_GOLBAL,void 0],[xM.CATALOG_SETTINGS_OVERLAY,void 0],[xM.CATALOG_SETTINGS_COLOR,CU],[xM.CATALOG_SETTINGS_SIZE,TU],[xM.CATALOG_SETTINGS_ORIENTATION,PU],[xM.SPECTRAL_LINE_QUERY,FU],[xM.PV_GENERATOR,DU]]);let _U=Object(p.a)(LU=class extends n.Component{render(){var e,t;const i=SM.Instance,n={icon:"help",className:d()("help-drawer",{"bp3-dark":gC.Instance.darkTheme}),lazy:!0,isOpen:i.helpVisible,onClose:i.hideHelpDrawer,title:null!==(e=i.type)&&void 0!==e?e:"",position:i.position,size:"33%",hasBackdrop:!1};return Object(xm.jsx)(u.o,{...n,children:Object(xm.jsx)("div",{className:hS.a.DRAWER_BODY,children:Object(xm.jsx)("div",{className:hS.a.DIALOG_BODY,children:null!==(t=NU.get(i.type))&&void 0!==t?t:""})})})}})||LU;var zU,VU,WU,GU,BU,qU,HU,YU,UU,XU,$U,KU=i(456),QU=i.n(KU);i(1021);let ZU=Object(p.a)(($U=XU=class e extends n.Component{static get WIDGET_CONFIG(){return{id:"catalog-plot",type:"catalog-plot",minWidth:320,minHeight:400,defaultWidth:680,defaultHeight:350,title:"Catalog Plot",isCloseable:!0,componentId:"catalog-plot-component"}}constructor(t){super(t),Object(f.a)(this,"width",WU,this),Object(f.a)(this,"height",GU,this),Object(f.a)(this,"profileId",BU,this),Object(f.a)(this,"catalogFileId",qU,this),Object(f.a)(this,"componentId",HU,this),this.plotType=void 0,this.histogramY=void 0,this.catalogFileNames=void 0,Object(f.a)(this,"onResize",YU,this),Object(f.a)(this,"handleCatalogFileChange",UU,this),this.addNewWidgetStore=()=>{const t=gC.Instance,i=hM.Instance;switch(this.plotType){case xd.D2Scatter:const n={xColumnName:e.emptyColumn,yColumnName:e.emptyColumn,plotType:this.plotType},r=t.widgetsStore.addCatalogPlotWidget(n);return i.setCatalogPlots(this.componentId,this.catalogFileId,r),r;case xd.Histogram:const o={xColumnName:e.emptyColumn,plotType:this.plotType},s=t.widgetsStore.addCatalogPlotWidget(o);return i.setCatalogPlots(this.componentId,this.catalogFileId,s),s;default:return}},this.updateStatistic=()=>{const e=this.profileStore,t=this.widgetStore;if((null===t||void 0===t?void 0:t.enableStatistic)&&e){const i=e.getSortedIndices(e.selectedPointIndices),n=e.get1DPlotData(t.statisticColumnName);let r=[],o=n.wcsData.length,s=o;const a=i.length;if(a>0){s=o=a;for(let e=0;e<a;e++){const t=i[e];isNaN(n.wcsData[t])?s-=1:r.push(n.wcsData[t])}}else for(let e=0;e<n.wcsData.length;e++)isNaN(n.wcsData[e])?s-=1:r.push(n.wcsData[e]);const l=T.mean(r),c=Math.sqrt(T.sum(T.map(r,(e=>Math.pow(e-l,2))))/s),d=Math.sqrt(T.sum(T.map(r,(e=>Math.pow(e,2))))/s),p=Qi(r);t.setStatistic({mean:l,count:o,validCount:s,std:c,min:p.minVal,max:p.maxVal,rms:d})}},this.handleColumnNameChange=(t,i)=>{const n=this.widgetStore;if("X"===t?n.setColumnX(i):"Y"===t?n.setColumnY(i):"S"===t&&n.setStatisticColumn(i),n.plotType===xd.D2Scatter){if(n.xColumnName===e.emptyColumn||n.yColumnName===e.emptyColumn||"S"===t)return;n.setScatterborder(this.initScatterBorder),n.initLinearFitting()}else if(n.plotType===xd.Histogram){if(i===e.emptyColumn)return;n.setHistogramXBorder(this.initHistogramXBorder)}},this.handleShowSelectedDataChanged=e=>{const t=this.widgetStore,i=this.catalogWidgetStore,n=e.target.checked;t&&i&&(i.setShowSelectedData(n),i.setCatalogTableAutoScroll(!0))},this.handleLogScaleYChanged=e=>{const t=e.target.checked;this.widgetStore.setLogScaleY(t)},this.onHover=e=>{const t=this.widgetStore,i=e.points;if(i.length&&t){const e=i[0];t.setIndicator({x:e.x,y:e.y})}},this.onDoubleClick=()=>{const e=this.widgetStore;e.plotType===xd.D2Scatter?e.setScatterborder(this.initScatterBorder):e.setHistogramXBorder(this.initHistogramXBorder)},this.onRelayout=e=>{const t=this.widgetStore;if(t){if(e.dragmode&&t.setDragmode(e.dragmode),t.plotType===xd.D2Scatter){const i=e["xaxis.range[0]"],n=e["xaxis.range[1]"],r=e["yaxis.range[0]"],o=e["yaxis.range[1]"];if(isFinite(i)||isFinite(r)){const e={xMin:isFinite(i)?i:t.scatterborder.xMin,xMax:isFinite(n)?n:t.scatterborder.xMax,yMin:isFinite(r)?r:t.scatterborder.yMin,yMax:isFinite(o)?o:t.scatterborder.yMax};t.setScatterborder(e)}e["xaxis.autorange"]&&e["yaxis.autorange"]&&t.setScatterborder(this.initScatterBorder)}if(t.plotType===xd.Histogram){const i=e["xaxis.range[0]"],n=e["xaxis.range[1]"];if(isFinite(i)||isFinite(n)){const e={xMin:isFinite(i)?i:t.histogramBorder.xMin,xMax:isFinite(n)?n:t.histogramBorder.xMax};this.widgetStore.setHistogramXBorder(e)}e["xaxis.autorange"]&&t.setHistogramXBorder(this.initHistogramXBorder)}}},this.handlePlotClick=()=>{const e=gC.Instance,t=this.profileStore;if(null===t||void 0===t?void 0:t.shouldUpdateData){t.setUpdateMode(DM.PlotsUpdate),t.setUpdatingDataStream(!0);let i=t.updateRequestDataSize;e.sendCatalogFilter(i)}},this.onLassoSelected=e=>{if(e&&e.points&&e.points.length>0){var t;const i=hM.Instance,n=this.profileStore,r=n.catalogInfo.fileId,o=this.catalogWidgetStore;let s;if(i.updateCatalogProfiles(r),this.widgetStore.plotType===xd.D2Scatter){const t=e.points;s=new Array(t.length);for(let e=0;e<t.length;e++)s[e]=t[e].pointIndex}else if(this.widgetStore.plotType===xd.Histogram){const t=e.points;let i=0;for(let e=0;e<t.length;e++){i+=t[e].pointIndices.length}s=new Array(i);let n=0;for(let e=0;e<t.length;e++){const i=t[e].pointIndices,r=i.length;for(let e=0;e<r;e++)s[n]=i[e],n+=1}}if(null===(t=s)||void 0===t?void 0:t.length){const e=n.getOriginIndices(s);n.setSelectedPointIndices(e,!0),o.setCatalogTableAutoScroll(!0)}}},this.onDeselect=()=>{const e=hM.Instance,t=this.profileStore,i=this.widgetStore,n=this.catalogWidgetStore;e.updateCatalogProfiles(this.catalogFileId),t.setSelectedPointIndices([],!1),n.setShowSelectedData(!1),i.initLinearFitting(),i.initStatistic(),this.updateStatistic()},this.onSingleSourceClick=e=>{var t;const i=["select","lasso"].includes(this.widgetStore.dragmode),n=this.profileStore,r=this.catalogWidgetStore;if((null===e||void 0===e||null===(t=e.points)||void 0===t?void 0:t.length)>0&&i){const t=hM.Instance,i=n.catalogInfo.fileId;t.updateCatalogProfiles(i);let o=[];const s=e.points[0];this.widgetStore.plotType===xd.D2Scatter?o.push(s.pointIndex):this.widgetStore.plotType===xd.Histogram&&s.pointIndices.length&&(o=s.pointIndices);const a=n.getOriginIndices(o);n.setSelectedPointIndices(a,!0),r.setCatalogTableAutoScroll(!0)}},this.renderColumnNamePopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick,active:t.modifiers.active},e),this.filterColumn=(e,t)=>new XL.a([t]).search(e).length>0,this.updateHistogramYrange=(e,t)=>{if(this.widgetStore.plotType===xd.Histogram){const t=e.layout.yaxis.range;this.histogramY={yMin:t[0],yMax:t[1]}}},this.onNumBinChange=e=>{this.widgetStore.setNumBinsX(e),this.onDeselect()},this.renderFilePopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return Object(xm.jsx)(u.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.handleFittingClick=e=>{const t=this.widgetStore,i=this.profileStore,n=i.get2DPlotData(t.xColumnName,t.yColumnName,i.catalogData);let r=[],o=[];if(0===e.length)for(let l=0;l<n.wcsX.length;l++)isNaN(n.wcsX[l])||isNaN(n.wcsY[l])||(r.push(n.wcsX[l]),o.push(n.wcsY[l]));else for(let l=0;l<e.length;l++){const t=e[l];isNaN(n.wcsX[t])||isNaN(n.wcsY[t])||(r.push(n.wcsX[t]),o.push(n.wcsY[t]))}const s=qa.getFittingParameters(new Float64Array(r),new Float64Array(o)),a=Qi(r);t.setMinMaxX(a),t.setFitting(s)},Object(m.p)(this),this.histogramY={yMin:void 0,yMax:void 0};const i=hM.Instance.getAssociatedIdByWidgetId(this.props.id);this.componentId=i.catalogPlotComponentId,this.catalogFileId=i.catalogFileId,this.catalogFileNames=new Map,Object(m.h)((()=>{const e=this.profileStore,t=this.widgetStore,i=hM.Instance.activeCatalogFiles;if(!(null===i||void 0===i?void 0:i.includes(this.catalogFileId))&&(null===i||void 0===i?void 0:i.length)>0&&Object(m.t)((()=>{this.catalogFileId=i[0]})),t&&(this.plotType=t.plotType),e){let t="";const n=e.catalogInfo.fileInfo.name||"",r=gC.Instance.activeFrame,o=e.progress;o&&isFinite(o)&&o<1&&(t=`[${fi(100*o)}% complete]`),r&&(null===i||void 0===i?void 0:i.length)?WP.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType} : ${n} ${t}`):WP.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType}`)}else WP.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType}`)})),Object(m.s)((()=>{var e;return null===(e=this.widgetStore)||void 0===e?void 0:e.statisticColumnName}),(()=>{var e;(null===(e=this.widgetStore)||void 0===e?void 0:e.enableStatistic)&&this.updateStatistic()})),Object(m.s)((()=>{var e;return null===(e=this.profileStore)||void 0===e?void 0:e.selectedPointIndices}),(()=>{this.updateStatistic()}))}get widgetStore(){const e=hM.Instance.catalogPlots.get(this.componentId);if(!e)return;let t=e.get(this.catalogFileId);t||(t=this.addNewWidgetStore());return WP.Instance.catalogPlotWidgets.get(t)}get profileStore(){return hM.Instance.catalogProfileStores.get(this.catalogFileId)}get catalogWidgetStore(){const e=hM.Instance.catalogWidgets.get(this.catalogFileId);return WP.Instance.catalogWidgets.get(e)}getScatterBorder(e,t){const i=Qi(e),n=Qi(t);return{xMin:i.minVal,xMax:i.maxVal,yMin:n.minVal,yMax:n.maxVal}}getHistogramXBorder(e){const t=Qi(e);return{xMin:t.minVal,xMax:t.maxVal}}get initScatterBorder(){const e=this.widgetStore,t=this.profileStore,i=t.get2DPlotData(e.xColumnName,e.yColumnName,t.catalogData);return this.getScatterBorder(i.wcsX,i.wcsY)}get initHistogramXBorder(){const e=this.widgetStore,t=this.profileStore.get1DPlotData(e.xColumnName);return this.getHistogramXBorder(t.wcsData)}get scatterData(){var e,t;const i=this.widgetStore,n=this.profileStore,r=n.numVisibleRows,o=n.get2DPlotData(i.xColumnName,i.yColumnName,n.catalogData);let s=[],a={type:"scattergl",mode:"markers"};a.marker={symbol:"circle",color:L.a.BLUE2,opacity:1},a.hoverinfo="none",a.x=null===(e=o.wcsX)||void 0===e?void 0:e.slice(0,r),a.y=null===(t=o.wcsY)||void 0===t?void 0:t.slice(0,r),s.push(a);return{data:s,border:this.getScatterBorder(o.wcsX,o.wcsY)}}get histogramData(){var e;const t=this.widgetStore,i=this.profileStore,n=i.numVisibleRows,r=i.get1DPlotData(t.xColumnName);let o=[],s={};const a=this.getHistogramXBorder(r.wcsData),l=a.xMin,c=t.nBinx?t.nBinx:this.numBinsX,d=l+1.001*(a.xMax-a.xMin),p=(d-l)/c;return s.type="histogram",s.hoverinfo="none",s.x=null===(e=r.wcsData)||void 0===e?void 0:e.slice(0,n),s.marker={color:L.a.BLUE2},s.xbins={start:l,size:p,end:d},o.push(s),{data:o,border:a}}get enablePlotButton(){const t=e.emptyColumn,i=this.profileStore,n=this.widgetStore;return(null===n||void 0===n?void 0:n.plotType)===xd.Histogram?n.xColumnName!==t&&!i.loadingData&&!i.updatingDataStream:(null===n||void 0===n?void 0:n.plotType)===xd.D2Scatter&&(n.xColumnName!==t&&n.yColumnName!==t&&!i.loadingData&&!i.updatingDataStream)}get genProfilerInfo(){let e="";const t=this.widgetStore,i=t.indicatorInfo;return i&&(t.plotType===xd.D2Scatter?e=`${t.xColumnName}: ${i.x}, ${t.yColumnName}: ${i.y}`:t.plotType===xd.Histogram&&(e=`${t.xColumnName}: ${i.x}, Count: ${i.y}`)),e}get numBinsX(){var e;const t=this.widgetStore,i=this.profileStore.get1DPlotData(t.xColumnName);return Math.ceil(Math.sqrt(null===(e=i.wcsData)||void 0===e?void 0:e.length))}render(){const t=this.profileStore,i=this.widgetStore,n=this.catalogWidgetStore,r=hM.Instance.activeCatalogFiles,o=1/devicePixelRatio;if(!i||!t||!n||void 0===r||0===(null===r||void 0===r?void 0:r.length))return Object(xm.jsxs)("div",{className:"catalog-plot",children:[Object(xm.jsx)(u.C,{icon:"folder-open",title:"No catalog file loaded",description:"Load a catalog file using the menu"}),";"]});const s=t.displayedColumnHeaders,a=[e.emptyColumn],l=!this.enablePlotButton,c=this.plotType===xd.D2Scatter,d=this.plotType===xd.Histogram,p=c?devicePixelRatio:1,f="'Helvetica Neue', 'Helvetica', 'Arial', sans-serif";let b=L.a.LIGHT_GRAY5,m=L.a.GRAY1,y=L.a.LIGHT_GRAY1,O=L.a.GRAY2,x="catalog-plotly",S=[];r.forEach((e=>{S.push(e)})),this.catalogFileNames=hM.Instance.getCatalogFileNames(r);for(let h=0;h<s.length;h++){const t=s[h];e.UnsupportedDataTypes.includes(t.dataType)||a.push(t.name)}const v=Object(xm.jsx)(u.B,{disabled:!0,text:"No results"}),C=Object(xm.jsx)(u.p,{inline:!0,label:"File",children:Object(xm.jsx)(A.a,{className:"bp3-fill",filterable:!1,items:S,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFilePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{text:this.catalogFileId,rightIcon:"double-caret-vertical"})})}),I=Object(xm.jsx)(u.p,{inline:!0,label:"X",children:Object(xm.jsx)(A.a,{className:"bp3-fill",items:a,activeItem:i.xColumnName,onItemSelect:e=>this.handleColumnNameChange("X",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:v,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:i.xColumnName,rightIcon:"double-caret-vertical"})})}),w=Object(xm.jsx)(u.p,{label:"Log Scale",inline:!0,disabled:l,children:Object(xm.jsx)(u.P,{checked:i.logScaleY,onChange:this.handleLogScaleYChanged,disabled:l})}),T=Object(xm.jsx)(u.p,{inline:!0,label:"Y",children:Object(xm.jsx)(A.a,{className:"bp3-fill",items:a,activeItem:i.yColumnName,onItemSelect:e=>this.handleColumnNameChange("Y",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:v,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:i.yColumnName,rightIcon:"double-caret-vertical"})})}),R=Object(xm.jsx)(u.p,{inline:!0,label:"Statistic Source",children:Object(xm.jsx)(A.a,{className:"bp3-fill",items:a,activeItem:i.statisticColumnName,onItemSelect:e=>this.handleColumnNameChange("S",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:v,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:i.statisticColumnName,rightIcon:"double-caret-vertical"})})});if(i.xColumnName===e.emptyColumn||i.yColumnName===e.emptyColumn)return Object(xm.jsxs)("div",{className:"catalog-plot",children:[Object(xm.jsxs)("div",{className:"catalog-plot-option",children:[C,I,c&&T]}),Object(xm.jsx)(u.C,{className:"non-ideal-state",icon:"folder-open",title:"No column selected",description:"Please select columns"}),";"]});gC.Instance.darkTheme&&(y=L.a.DARK_GRAY5,m=L.a.LIGHT_GRAY5,b=L.a.DARK_GRAY3,O=L.a.GRAY4,x="catalog-plotly-dark");let P,E={width:this.width*p,height:(this.height-110)*p,paper_bgcolor:b,plot_bgcolor:b,hovermode:"closest",xaxis:{title:i.xColumnName,titlefont:{family:f,size:12*p,color:m},showticklabels:!0,tickfont:{family:f,size:12*p,color:m},tickcolor:y,gridcolor:y,zerolinecolor:y,zerolinewidth:2*p,mirror:!0,linecolor:y,showline:!0,spikemode:"across",spikedash:"solid",spikecolor:O,spikethickness:1*p,tickformat:".2e"},yaxis:{titlefont:{family:f,size:12*p,color:m},showticklabels:!0,tickfont:{family:f,size:12*p,color:m},tickcolor:y,gridcolor:y,zerolinecolor:y,zerolinewidth:2*p,mirror:!0,linecolor:y,showline:!0,spikemode:"across",spikedash:"solid",spikecolor:O,spikethickness:1*p},margin:{t:5*p,b:40*p,l:80*p,r:5*p,pad:0},showlegend:!1,dragmode:i.dragmode};if(i.showFittingResult){const e=i.fitting,t=i.minMaxX;E.shapes=[{type:"line",layer:"above",x0:t.minVal,y0:e.intercept+e.slope*t.minVal,x1:t.maxVal,y1:e.intercept+e.slope*t.maxVal,line:{color:L.a.GREEN2,width:2.5*devicePixelRatio}}],E.annotations=[{xref:"paper",yref:"paper",x:0,xanchor:"left",y:1,yanchor:"top",align:"left",text:i.fittingResultString,showarrow:!1,font:{size:9*devicePixelRatio,family:"monospace",color:gC.Instance.darkTheme?"#f5f8fa":"#182026"}}]}if(i.plotType===xd.D2Scatter){const e=this.scatterData;let t;P=e.data,P[0].marker.size=5*p,t=i.isScatterAutoScaled?e.border:i.scatterborder,E.xaxis.range=[t.xMin,t.xMax],E.yaxis.range=[t.yMin,t.yMax],E.yaxis.title=i.yColumnName,E.yaxis.tickformat=".2e"}else{var M,F;let e;P=this.histogramData.data,e=i.isHistogramAutoScaledX?this.histogramData.border:i.histogramBorder,E.xaxis.range=[e.xMin,e.xMax],E.yaxis.range=[null===(M=this.histogramY)||void 0===M?void 0:M.yMin,null===(F=this.histogramY)||void 0===F?void 0:F.yMax],E.yaxis.fixedrange=!0,E.yaxis.autorange=!0,E.yaxis.rangemode="tozero",E.yaxis.title="Count",i.logScaleY&&(E.yaxis.type="log")}const k=t.getSortedIndices(t.selectedPointIndices);let D=P[0].marker;k.length>0?(P[0].selectedpoints=k,P[0].selected={marker:{color:L.a.RED2}},P[0].unselected={marker:{opacity:.5}}):(P[0].selectedpoints=[],D.color=L.a.BLUE2,P[0].unselected={marker:{opacity:1}});const N=Object(xm.jsx)(hy,{className:"catalog-bins",label:"Bins",min:1,integerOnly:!0,value:i.nBinx?i.nBinx:this.numBinsX,onValueChanged:e=>this.onNumBinChange(e),onValueCleared:()=>this.onNumBinChange(this.numBinsX),displayExponential:!1,disabled:l}),_=Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,text:"Linear Fit",onClick:()=>this.handleFittingClick(k),disabled:l||1===(null===k||void 0===k?void 0:k.length)}),z=[this.genProfilerInfo];return i.showStatisticResult&&i.enableStatistic&&z.push(i.statisticString),Object(xm.jsxs)("div",{className:"catalog-plot",children:[Object(xm.jsxs)("div",{className:"catalog-plot-option",children:[C,I,d&&N,d&&w,c&&T,R]}),Object(xm.jsx)("div",{className:`${x} ${c&&devicePixelRatio>1?"catalog-scatter":""}`,children:Object(xm.jsx)(QU.a,{data:P,layout:E,config:{displaylogo:!1,scrollZoom:!0,showTips:!1,doubleClick:!1,showAxisDragHandles:!1,modeBarButtonsToRemove:["zoomIn2d","zoomOut2d","resetScale2d","toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]},onHover:this.onHover,onDoubleClick:this.onDoubleClick,onRelayout:this.onRelayout,onSelected:this.onLassoSelected,onDeselect:this.onDeselect,onClick:this.onSingleSourceClick,onInitialized:this.updateHistogramYrange,onUpdate:this.updateHistogramYrange,style:{transform:c?`scale(${o})`:"scale(1)",transformOrigin:"top left"}})}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer",children:[Object(xm.jsx)("div",{className:"scatter-info",children:Object(xm.jsx)(lO,{info:z,type:"pre-line",separator:"newLine"})}),Object(xm.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(xm.jsx)(j.a,{content:"Show only selected sources at image and table viewer",children:Object(xm.jsx)(u.p,{label:"Selected only",inline:!0,disabled:l,children:Object(xm.jsx)(u.P,{checked:n.showSelectedData,onChange:this.handleShowSelectedDataChanged,disabled:l})})}),c&&_,Object(xm.jsx)(u.b,{intent:g.a.PRIMARY,text:"Plot",onClick:this.handlePlotClick,disabled:l||!t.isFileBasedCatalog})]})]}),Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},XU.emptyColumn="None",XU.UnsupportedDataTypes=[Nt.ColumnType.String,Nt.ColumnType.Bool,Nt.ColumnType.UnsupportedType],VU=$U,WU=Object(b.a)(VU.prototype,"width",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),GU=Object(b.a)(VU.prototype,"height",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),BU=Object(b.a)(VU.prototype,"profileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qU=Object(b.a)(VU.prototype,"catalogFileId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),HU=Object(b.a)(VU.prototype,"componentId",[m.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),YU=Object(b.a)(VU.prototype,"onResize",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Object(b.a)(VU.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"widgetStore"),VU.prototype),Object(b.a)(VU.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"profileStore"),VU.prototype),Object(b.a)(VU.prototype,"catalogWidgetStore",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"catalogWidgetStore"),VU.prototype),UU=Object(b.a)(VU.prototype,"handleCatalogFileChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogFileId=e;const t=WP.Instance,i=hM.Instance,n=i.catalogPlots.get(this.componentId).get(e);if(n){const e=t.catalogPlotWidgets.get(n),r=i.catalogProfileStores.get(this.catalogFileId),o=e.xColumnName===ZU.emptyColumn,s=e.yColumnName===ZU.emptyColumn;switch(e.plotType){case xd.D2Scatter:if(!o&&!s&&void 0===e.scatterborder){const t=r.get2DPlotData(e.xColumnName,e.yColumnName,r.catalogData),i=this.getScatterBorder(t.wcsX,t.wcsY);e.setScatterborder(i)}break;case xd.Histogram:if(!o&&void 0===e.histogramBorder){const t=r.get1DPlotData(e.xColumnName),i=this.getHistogramXBorder(t.wcsData);e.setHistogramXBorder(i)}}}else this.addNewWidgetStore()}}}),Object(b.a)(VU.prototype,"initScatterBorder",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"initScatterBorder"),VU.prototype),Object(b.a)(VU.prototype,"initHistogramXBorder",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"initHistogramXBorder"),VU.prototype),Object(b.a)(VU.prototype,"scatterData",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"scatterData"),VU.prototype),Object(b.a)(VU.prototype,"histogramData",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"histogramData"),VU.prototype),Object(b.a)(VU.prototype,"enablePlotButton",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"enablePlotButton"),VU.prototype),Object(b.a)(VU.prototype,"genProfilerInfo",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"genProfilerInfo"),VU.prototype),Object(b.a)(VU.prototype,"numBinsX",[m.i],Object.getOwnPropertyDescriptor(VU.prototype,"numBinsX"),VU.prototype),zU=VU))||zU;var JU,eX,tX;i(1022);const iX=(e,t,i,n=2,r=16)=>{let o=t;return i||(o="none"),Object(xm.jsx)("span",{className:"bp3-icon",children:Object(xm.jsx)("svg",{"data-icon":"triangle-up-open",width:"16",height:"16",viewBox:`0 0 ${r} ${r}`,style:{stroke:t,fill:o,strokeWidth:n},children:e})})},nX=Object(xm.jsx)("path",{d:"M 2 14 L 14 14 L 8 3 Z"}),rX=Object(xm.jsx)("path",{d:"M 2 2 L 14 2 L 8 13 Z"}),oX=Object(xm.jsx)("path",{d:"M 8 14 L 14 8 L 8 2 L 2 8 Z"}),sX=Object(xm.jsx)("path",{d:"M 12.33 5.5 L 12.33 10.5 L 8 13 L 3.67 10.5 L 3.67 5.5 L 8 3 Z"}),aX=Object(xm.jsx)("path",{d:"M 3 8 L 5.5 3.67 L 10.5 3.67 L 13 8 L 10.5 12.33 L 5.5 12.33 Z"}),lX=Object(xm.jsx)("ellipse",{cx:"8",cy:"8",rx:"4",ry:"7"});let cX=Object(p.a)((eX=class extends n.Component{static get WIDGET_CONFIG(){return{id:"catalog-overlay-floating-settings",type:"floating-settings",minWidth:350,minHeight:250,defaultWidth:350,defaultHeight:560,title:"catalog-overlay-settings",isCloseable:!0,parentId:"catalog-overlay",parentType:"catalog-overlay",helpType:[xM.CATALOG_SETTINGS_GOLBAL,xM.CATALOG_SETTINGS_OVERLAY,xM.CATALOG_SETTINGS_COLOR,xM.CATALOG_SETTINGS_SIZE,xM.CATALOG_SETTINGS_ORIENTATION]}}get widgetStore(){const e=hM.Instance.catalogWidgets.get(this.catalogFileId);return WP.Instance.catalogWidgets.get(e)}get catalogFileId(){var e;return null===(e=hM.Instance.catalogProfiles)||void 0===e?void 0:e.get(this.props.id)}get profileStore(){return hM.Instance.catalogProfileStores.get(this.catalogFileId)}get axisOption(){var e;const t=this.profileStore;let i=[];return i.push(Un.NONE),null===t||void 0===t||null===(e=t.catalogControlHeader)||void 0===e||e.forEach(((e,n)=>{const r=t.catalogHeader[e.dataIndex].dataType;oH.axisDataType.includes(r)&&e.display&&i.push(n)})),i}constructor(e){super(e),this.catalogFileNames=void 0,this.catalogOverlayShape=[Sd.BOX_LINED,Sd.CIRCLE_FILLED,Sd.CIRCLE_LINED,Sd.CROSS_FILLED,Sd.ELLIPSE_LINED,Sd.HEXAGON_LINED,Sd.HEXAGON_LINED_2,Sd.RHOMB_LINED,Sd.TRIANGLE_LINED_DOWN,Sd.TRIANGLE_LINED_UP,Sd.X_FILLED,Sd.LineSegment_FILLED],Object(f.a)(this,"handleCatalogFileChange",tX,this),this.renderAxisPopOver=(e,t)=>Object(xm.jsx)(u.B,{text:e,onClick:t.handleClick},e),this.filterColumn=(e,t)=>new XL.a([t]).search(e).length>0,this.handleChange=(e,t)=>{if("keydown"===e.type&&13!==e.keyCode)return;const i=parseFloat(e.currentTarget.value),n=this.widgetStore,r=n.sizeMajor?n.pointSizebyType:n.minorPointSizebyType;switch(t){case"size-min":isFinite(i)&&i!==r.min&&i<r.max&&i>=Cd.SizeMapMin?n.setSizeMin(i):e.currentTarget.value=r.min.toString();break;case"size-max":isFinite(i)&&i!==r.max&&i>r.min&&i<=n.maxPointSizebyType?n.setSizeMax(i):e.currentTarget.value=r.max.toString();break;case"angle-min":isFinite(i)&&i<n.angleMax?n.setAngleMin(i):e.currentTarget.value=n.angleMin.toString();break;case"angle-max":isFinite(i)&&i>n.angleMin?n.setAngleMax(i):e.currentTarget.value=n.angleMax.toString()}},this.renderFileIdPopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return Object(xm.jsx)(u.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.renderShapePopOver=(e,t)=>{const i=this.getCatalogShape(e);return Object(xm.jsx)(u.B,{icon:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))},this.handleSelectedAxisTabChanged=e=>{this.widgetStore.setSizeAxisTab(Number.parseInt(e.toString()))},this.getCatalogShape=e=>{let t=this.widgetStore.catalogColor;switch(e){case Sd.CIRCLE_LINED:return Object(xm.jsx)(u.w,{icon:"circle",color:t});case Sd.CIRCLE_FILLED:return Object(xm.jsx)(u.w,{icon:"full-circle",color:t});case Sd.BOX_LINED:return Object(xm.jsx)(u.w,{icon:"square",color:t});case Sd.CROSS_FILLED:return Object(xm.jsx)(u.w,{icon:"plus",color:t});case Sd.X_FILLED:return Object(xm.jsx)(u.w,{icon:"cross",color:t});case Sd.TRIANGLE_LINED_UP:return iX(nX,t,!1);case Sd.TRIANGLE_LINED_DOWN:return iX(rX,t,!1);case Sd.RHOMB_LINED:return iX(oX,t,!1);case Sd.HEXAGON_LINED_2:return iX(sX,t,!1);case Sd.HEXAGON_LINED:return iX(aX,t,!1);case Sd.ELLIPSE_LINED:return iX(lX,t,!1);case Sd.LineSegment_FILLED:return Object(xm.jsx)(u.w,{icon:"minus",style:{transform:"rotate(90deg)"},color:t});default:return Object(xm.jsx)(u.w,{icon:"circle",color:t})}},Object(m.p)(this);const t=gC.Instance;this.catalogFileNames=new Map,Object(m.h)((()=>{const e=hM.Instance,i=e.catalogWidgets.get(this.catalogFileId),n=e.activeCatalogFiles;if(i||WP.Instance.addCatalogWidget(this.catalogFileId),null===n||void 0===n?void 0:n.includes(this.catalogFileId)){const i=e.getCatalogFileNames([this.catalogFileId]).get(this.catalogFileId);i&&t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Catalog Settings: ${i}`)}else t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Catalog Settings")}))}render(){const e=gC.Instance,t=this.widgetStore,i=hM.Instance.activeCatalogFiles;let n=[];i.forEach((e=>{n.push(e)})),this.catalogFileNames=hM.Instance.getCatalogFileNames(i);const r=this.catalogFileNames.get(this.catalogFileId);let o="";void 0!==r&&(o=`${this.catalogFileId}: ${r}`);const s=i.length<=0,a=s||t.disableSizeMap,l=s||t.disableColorMap,c=s||t.disableOrientationMap,p=a||t.disableSizeMinorMap,h=Object(xm.jsx)(u.B,{disabled:!0,text:"No results"}),g=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Column",disabled:s,children:Object(xm.jsx)(A.a,{items:this.axisOption,activeItem:null,onItemSelect:e=>t.setSizeMap(e),itemRenderer:this.renderAxisPopOver,disabled:s,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:h,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:t.sizeMapColumn,disabled:s,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(u.p,{label:"Scaling",inline:!0,disabled:a,children:Object(xm.jsx)(SO,{selectedItem:t.sizeScalingType,onItemSelect:e=>t.setSizeScalingType(e),disabled:a})}),Object(xm.jsx)(u.p,{inline:!0,label:"Size Mode",disabled:a,children:Object(xm.jsxs)(u.f,{children:[Object(xm.jsx)(u.b,{disabled:a,text:"Diameter",active:!t.sizeArea,onClick:()=>t.setSizeArea(!1)}),Object(xm.jsx)(u.b,{disabled:a,text:"Area",active:t.sizeArea,onClick:()=>t.setSizeArea(!0)})]})}),Object(xm.jsxs)("div",{className:"numeric-input-lock",children:[Object(xm.jsx)(hy,{label:"Clip Min",max:t.sizeColumnMax.clipd,integerOnly:!1,value:t.sizeColumnMin.clipd,onValueChanged:e=>t.setSizeColumnMin(e,"clipd"),onValueCleared:()=>t.resetSizeColumnValue("min"),displayExponential:!0,disabled:a||t.sizeMinorColumnMinLocked}),Object(xm.jsx)(u.b,{className:"lock-button",icon:t.sizeColumnMinLocked||t.sizeMinorColumnMinLocked?"lock":"unlock",intent:t.sizeColumnMinLocked?"success":"none",disabled:p||t.sizeMinorColumnMinLocked,minimal:!0,onClick:t.toggleSizeColumnMinLock})]}),Object(xm.jsxs)("div",{className:"numeric-input-lock",children:[Object(xm.jsx)(hy,{label:"Clip Max",min:t.sizeColumnMin.clipd,integerOnly:!1,value:t.sizeColumnMax.clipd,onValueChanged:e=>t.setSizeColumnMax(e,"clipd"),onValueCleared:()=>t.resetSizeColumnValue("max"),displayExponential:!0,disabled:a||t.sizeMinorColumnMaxLocked}),Object(xm.jsx)(u.b,{className:"lock-button",icon:t.sizeColumnMaxLocked||t.sizeMinorColumnMaxLocked?"lock":"unlock",intent:t.sizeColumnMaxLocked?"success":"none",disabled:p||t.sizeMinorColumnMaxLocked,minimal:!0,onClick:t.toggleSizeColumnMaxLock})]})]}),f=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Column",disabled:s,children:Object(xm.jsx)(A.a,{items:this.axisOption,activeItem:null,onItemSelect:e=>t.setSizeMinorMap(e),itemRenderer:this.renderAxisPopOver,disabled:s,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:h,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:t.sizeMinorMapColumn,disabled:s,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(u.p,{label:"Scaling",inline:!0,disabled:p,children:Object(xm.jsx)(SO,{selectedItem:t.sizeMinorScalingType,onItemSelect:e=>t.setSizeMinorScalingType(e),disabled:p})}),Object(xm.jsx)(u.p,{inline:!0,label:"Size Mode",disabled:p,children:Object(xm.jsxs)(u.f,{children:[Object(xm.jsx)(u.b,{disabled:p,text:"Diameter",active:!t.sizeMinorArea,onClick:()=>t.setSizeMinorArea(!1)}),Object(xm.jsx)(u.b,{disabled:p,text:"Area",active:t.sizeMinorArea,onClick:()=>t.setSizeMinorArea(!0)})]})}),Object(xm.jsxs)("div",{className:"numeric-input-lock",children:[Object(xm.jsx)(hy,{label:"Clip Min",max:t.sizeMinorColumnMax.clipd,integerOnly:!1,value:t.sizeMinorColumnMin.clipd,onValueChanged:e=>t.setSizeMinorColumnMin(e,"clipd"),onValueCleared:()=>t.resetSizeMinorColumnValue("min"),displayExponential:!0,disabled:p||t.sizeColumnMinLocked}),Object(xm.jsx)(u.b,{className:"lock-button",icon:t.sizeColumnMinLocked||t.sizeMinorColumnMinLocked?"lock":"unlock",intent:t.sizeMinorColumnMinLocked?"success":"none",disabled:p||t.sizeColumnMinLocked,minimal:!0,onClick:t.toggleSizeMinorColumnMinLock})]}),Object(xm.jsxs)("div",{className:"numeric-input-lock",children:[Object(xm.jsx)(hy,{label:"Clip Max",min:t.sizeMinorColumnMin.clipd,integerOnly:!1,value:t.sizeMinorColumnMax.clipd,onValueChanged:e=>t.setSizeMinorColumnMax(e,"clipd"),onValueCleared:()=>t.resetSizeMinorColumnValue("max"),displayExponential:!0,disabled:p||t.sizeColumnMaxLocked}),Object(xm.jsx)(u.b,{className:"lock-button",icon:t.sizeColumnMaxLocked||t.sizeMinorColumnMaxLocked?"lock":"unlock",intent:t.sizeMinorColumnMaxLocked?"success":"none",disabled:p||t.sizeColumnMaxLocked,minimal:!0,onClick:t.toggleSizeMinorColumnMaxLock})]})]}),b=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Size",labelInfo:"(px)",disabled:s,children:Object(xm.jsx)(j.a,{disabled:s||!t.disableSizeMap,content:`${Cd.MinOverlaySize} ~ ${Cd.MaxOverlaySize}`,children:Object(xm.jsx)(pO,{placeholder:"Size",disabled:s||!t.disableSizeMap,min:Cd.MinOverlaySize,max:Cd.MaxOverlaySize,clampValueOnBlur:!0,value:t.catalogSize,stepSize:.5,onValueChange:e=>t.setCatalogSize(e)})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Thickness",disabled:s,children:Object(xm.jsx)(j.a,{disabled:s,content:`${Cd.MinThickness} ~ ${Cd.MaxThickness}`,children:Object(xm.jsx)(pO,{placeholder:"Thickness",disabled:s,min:Cd.MinThickness,max:Cd.MaxThickness,clampValueOnBlur:!0,value:t.thickness,stepSize:.5,onValueChange:e=>t.setThickness(e)})})}),Object(xm.jsxs)(u.R,{id:"catalogSettings",vertical:!1,selectedTabId:t.sizeAxisTabId,onChange:e=>this.handleSelectedAxisTabChanged(e),children:[Object(xm.jsx)(u.Q,{id:vd.SIZE_MAJOR,title:"Major",panel:g}),Object(xm.jsx)(u.Q,{id:vd.SIZE_MINOR,title:"Minor",panel:f,disabled:!t.enableSizeMinorTab})]}),Object(xm.jsx)(u.p,{inline:!0,label:"Size Min",labelInfo:"(px)",disabled:a,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!0,asyncControl:!0,placeholder:"Min",disabled:a,buttonPosition:"none",value:t.sizeMajor?t.pointSizebyType.min:t.minorPointSizebyType.min,onBlur:e=>this.handleChange(e,"size-min"),onKeyDown:e=>this.handleChange(e,"size-min")})}),Object(xm.jsx)(u.p,{inline:!0,label:"Size Max",labelInfo:"(px)",disabled:a,children:Object(xm.jsx)(j.a,{content:`Maximum size ${t.maxPointSizebyType}`,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!0,asyncControl:!0,placeholder:"Max",disabled:a,buttonPosition:"none",value:t.sizeMajor?t.pointSizebyType.max:t.minorPointSizebyType.max,onBlur:e=>this.handleChange(e,"size-max"),onKeyDown:e=>this.handleChange(e,"size-max")})})})]}),m=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{label:"Color",inline:!0,disabled:s||!t.disableColorMap,children:Object(xm.jsx)(ny,{color:t.catalogColor,presetColors:[...Gb,"transparent"],setColor:e=>{t.setCatalogColor("transparent"===e?"#000000":Jb(e))},disableAlpha:!0,disabled:s||!t.disableColorMap})}),Object(xm.jsx)(u.p,{label:"Overlay Highlight",inline:!0,disabled:s,children:Object(xm.jsx)(ny,{color:t.highlightColor,presetColors:[...Gb,"transparent"],setColor:e=>{t.setHighlightColor("transparent"===e?"#000000":Jb(e))},disableAlpha:!0,disabled:s})}),Object(xm.jsx)(u.p,{inline:!0,label:"Column",disabled:s,children:Object(xm.jsx)(A.a,{items:this.axisOption,activeItem:null,onItemSelect:e=>t.setColorMapColumn(e),itemRenderer:this.renderAxisPopOver,disabled:s,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:h,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:t.colorMapColumn,disabled:s,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(u.p,{label:"Scaling",inline:!0,disabled:l,children:Object(xm.jsx)(SO,{selectedItem:t.colorScalingType,onItemSelect:e=>t.setColorScalingType(e),disabled:l})}),Object(xm.jsx)(u.p,{inline:!0,label:"Color Map",disabled:l,children:Object(xm.jsx)(vy,{inverted:!1,selectedItem:t.colorMap,onItemSelect:e=>t.setColorMap(e),disabled:l})}),Object(xm.jsx)(u.p,{label:"Invert Color Map",inline:!0,disabled:l,children:Object(xm.jsx)(u.P,{checked:t.invertedColorMap,onChange:e=>t.setColorMapDirection(e.currentTarget.checked),disabled:l})}),Object(xm.jsx)(hy,{label:"Clip Min",max:t.colorColumnMax.clipd,integerOnly:!1,value:t.colorColumnMin.clipd,onValueChanged:e=>t.setColorColumnMin(e,"clipd"),onValueCleared:()=>t.resetColorColumnValue("min"),displayExponential:!0,disabled:l}),Object(xm.jsx)(hy,{label:"Clip Max",min:t.colorColumnMin.clipd,integerOnly:!1,value:t.colorColumnMax.clipd,onValueChanged:e=>t.setColorColumnMax(e,"clipd"),onValueCleared:()=>t.resetColorColumnValue("max"),displayExponential:!0,disabled:l})]}),y=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Column",disabled:s,children:Object(xm.jsx)(A.a,{items:this.axisOption,activeItem:null,onItemSelect:e=>t.setOrientationMapColumn(e),itemRenderer:this.renderAxisPopOver,disabled:s,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},filterable:!0,noResults:h,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(xm.jsx)(u.e,{text:t.orientationMapColumn,disabled:s,rightIcon:"double-caret-vertical"})})}),Object(xm.jsx)(u.p,{label:"Scaling",inline:!0,disabled:c,children:Object(xm.jsx)(SO,{selectedItem:t.orientationScalingType,onItemSelect:e=>t.setOrientationScalingType(e),disabled:c})}),Object(xm.jsx)(u.p,{inline:!0,label:"Orientation Min",labelInfo:"(degree)",disabled:c,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!0,asyncControl:!0,placeholder:"Min",disabled:c,buttonPosition:"none",value:t.angleMin,onBlur:e=>this.handleChange(e,"angle-min"),onKeyDown:e=>this.handleChange(e,"angle-min")})}),Object(xm.jsx)(u.p,{inline:!0,label:"Orientation Max",labelInfo:"(degree)",disabled:c,children:Object(xm.jsx)(pO,{allowNumericCharactersOnly:!0,asyncControl:!0,placeholder:"Max",disabled:c,buttonPosition:"none",value:t.angleMax,onBlur:e=>this.handleChange(e,"angle-max"),onKeyDown:e=>this.handleChange(e,"angle-max")})}),Object(xm.jsx)(hy,{label:"Clip Min",max:t.orientationMax.clipd,integerOnly:!1,value:t.orientationMin.clipd,onValueChanged:e=>t.setOrientationMin(e,"clipd"),onValueCleared:()=>t.resetOrientationValue("min"),displayExponential:!0,disabled:c}),Object(xm.jsx)(hy,{label:"Clip Max",min:t.orientationMin.clipd,integerOnly:!1,value:t.orientationMax.clipd,onValueChanged:e=>t.setOrientationMax(e,"clipd"),onValueCleared:()=>t.resetOrientationValue("max"),displayExponential:!0,disabled:c})]}),O=d()("catalog-settings",{"bp3-dark":e.darkTheme});return Object(xm.jsxs)("div",{className:O,children:[Object(xm.jsx)(u.p,{className:"file-menu",inline:!0,label:"File",disabled:s,children:Object(xm.jsx)(A.a,{className:"bp3-fill",disabled:s,filterable:!1,items:n,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFileIdPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{text:o,rightIcon:"double-caret-vertical",disabled:s})})}),Object(xm.jsx)(u.p,{inline:!0,label:"Shape",disabled:s,children:Object(xm.jsx)(A.a,{className:"bp3-fill",disabled:s,filterable:!1,items:this.catalogOverlayShape,activeItem:t.catalogShape,onItemSelect:e=>t.setCatalogShape(e),itemRenderer:this.renderShapePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{icon:this.getCatalogShape(t.catalogShape),rightIcon:"double-caret-vertical",disabled:s})})}),Object(xm.jsxs)(u.R,{id:"catalogSettings",vertical:!1,selectedTabId:t.settingsTabId,onChange:e=>this.handleSelectedTabChanged(e),children:[Object(xm.jsx)(u.Q,{id:vd.SIZE,title:"Size",panel:b,disabled:s}),Object(xm.jsx)(u.Q,{id:vd.COLOR,title:"Color",panel:m,disabled:s}),Object(xm.jsx)(u.Q,{id:vd.ORIENTATION,title:"Orientation",panel:y,disabled:s})]})]})}},Object(b.a)(eX.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(eX.prototype,"widgetStore"),eX.prototype),Object(b.a)(eX.prototype,"catalogFileId",[m.i],Object.getOwnPropertyDescriptor(eX.prototype,"catalogFileId"),eX.prototype),Object(b.a)(eX.prototype,"profileStore",[m.i],Object.getOwnPropertyDescriptor(eX.prototype,"profileStore"),eX.prototype),Object(b.a)(eX.prototype,"axisOption",[m.i],Object.getOwnPropertyDescriptor(eX.prototype,"axisOption"),eX.prototype),tX=Object(b.a)(eX.prototype,"handleCatalogFileChange",[m.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{hM.Instance.catalogProfiles.set(this.props.id,e)}}}),JU=eX))||JU;var dX,pX,hX=i(141);i(1023);let uX=Object(p.a)((pX=class extends n.Component{static get WIDGET_CONFIG(){return{id:"layer-list-settings",type:"floating-settings",minWidth:360,minHeight:225,defaultWidth:400,defaultHeight:375,title:"layer-list-settings",isCloseable:!0,parentId:"layer-list",parentType:"layer-list",helpType:xM.LAYER_LIST_SETTINGS}}get widgetStore(){const e=WP.Instance;if(e.layerListWidgets){const t=e.layerListWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.renderFrameOptions=(e,t)=>{const i=this.widgetStore.restFreqFrameOptions.find((t=>t.frameIndex===e));return Object(xm.jsx)(u.B,{text:null===i||void 0===i?void 0:i.label,disabled:null===i||void 0===i?void 0:i.disable,onClick:t.handleClick,active:t.modifiers.active},null===i||void 0===i?void 0:i.frameIndex)},this.renderRestFreqInput=e=>{var t;const i=null===(t=gC.Instance.frames[e.frameIndex])||void 0===t?void 0:t.restFreqStore;return Object(xm.jsxs)("div",{className:"freq-input",children:[Object(xm.jsx)(hy,{label:"Rest frequency",value:i.customRestFreq.value,disabled:e.disable,placeholder:"rest frequency",selectAllOnFocus:!0,onValueChanged:e=>{i.setCustomVal(e),gC.Instance.frameNum<=10&&this.widgetStore.resetSelectedFrameIndex()},onValueCleared:i.restoreDefaults,resetDisabled:i.resetDisable,tooltipContent:i.defaultInfo,tooltipPlacement:"bottom",focused:e.frameIndex===this.widgetStore.selectedFrameIndex}),Object(xm.jsx)(u.r,{disabled:e.disable,options:Object.values(Ht),value:i.customRestFreq.unit,onChange:e=>i.setCustomUnit(e.currentTarget.value)})]})},Object(m.p)(this)}render(){const e=gC.Instance,t=Object(xm.jsx)("div",{className:"panel-container",children:Object(xm.jsx)(u.p,{inline:!0,label:"Spectral Matching Type",children:Object(xm.jsx)(u.r,{value:e.preferenceStore.spectralMatchingType,onChange:t=>e.setSpectralMatchingType(t.currentTarget.value),children:Bt.map((e=>Object(xm.jsx)("option",{value:e,children:$t.get(e)},e)))})})}),i=this.widgetStore.selectedFrameIndex,r=this.widgetStore.restFreqFrameOptions;let o=null;if(e.frameNum>10){var s;const t=null===(s=r.find((e=>e.frameIndex===i)))||void 0===s?void 0:s.label,n=r.find((t=>t.frameIndex===(-1===i?e.activeFrameIndex:i)));o=Object(xm.jsxs)("div",{className:"panel-container",children:[Object(xm.jsx)(u.p,{inline:!0,label:"Source",className:"name-text",children:Object(xm.jsx)(A.a,{filterable:!1,items:this.widgetStore.restFreqFrameOptions.map((e=>e.frameIndex)),activeItem:i,onItemSelect:this.widgetStore.setSelectedFrameIndex,itemRenderer:this.renderFrameOptions,popoverProps:{minimal:!0,position:u.H.AUTO_END},children:Object(xm.jsx)(u.e,{text:t,rightIcon:"double-caret-vertical",alignText:hX.a.LEFT})})}),this.renderRestFreqInput(n)]})}else o=Object(xm.jsx)("div",{className:"panel-container",children:r.slice(1).map(((t,i)=>{const r=d()({disabled:t.disable},{dark:e.darkTheme},{active:t.active});return Object(xm.jsxs)(n.Fragment,{children:[Object(xm.jsxs)(u.p,{inline:!0,label:"Source",className:"name-text",disabled:t.disable,children:[Object(xm.jsx)(u.U,{className:r,ellipsize:!0,title:t.label,children:t.label.slice(0,-15)}),Object(xm.jsx)(u.U,{className:d()(r,"end-part"),title:t.label,children:t.label.slice(-15)})]}),this.renderRestFreqInput(t),i!==e.frames.length-1?Object(xm.jsx)(u.A,{}):null]},i)}))});return Object(xm.jsx)("div",{className:"layer-list-settings-panel",children:Object(xm.jsxs)(u.R,{id:"layerListSettingsTabs",selectedTabId:this.widgetStore.settingsTabId,onChange:this.widgetStore.setSettingsTabId,children:[Object(xm.jsx)(u.Q,{id:Lh.MATCHING,title:"Matching",panel:t}),Object(xm.jsx)(u.Q,{id:Lh.REST_FREQ,title:"Rest Frequency",panel:o})]})})}},Object(b.a)(pX.prototype,"widgetStore",[m.i],Object.getOwnPropertyDescriptor(pX.prototype,"widgetStore"),pX.prototype),dX=pX))||dX;var gX,fX,bX;let mX=Object(p.a)((bX=fX=class e extends n.Component{render(){const t=gC.Instance,i=d()("bp3-hotkey-dialog",{"bp3-dark":t.darkTheme});return Object(xm.jsx)(u.m,{portalClassName:"dialog-portal",isOpen:t.dialogStore.hotkeyDialogVisible,className:i,canEscapeKeyClose:!0,canOutsideClickClose:!0,onClose:t.dialogStore.hideHotkeyDialog,children:Object(xm.jsx)("div",{className:hS.a.DIALOG_BODY,children:e.RenderHotkeys()})})}static RenderHotkeys(){const t=gC.Instance,i=t.modifierString,n="1) Navigation",r="2) Regions",o="3) Frame controls",s="4) File controls",a="5) Other",l=[Object(xm.jsx)(u.t,{group:n,global:!0,combo:"click",label:"Pan image"},0),Object(xm.jsx)(u.t,{group:n,global:!0,combo:"middle-click",label:"Pan image (inside region)"},1),Object(xm.jsx)(u.t,{group:n,global:!0,combo:"mod+click",label:"Pan image (inside region)"},2),Object(xm.jsx)(u.t,{group:n,global:!0,combo:"mouse-wheel",label:"Zoom image"},3)],c=[Object(xm.jsx)(u.t,{group:r,global:!0,combo:"c",label:"Toggle region creation mode",onKeyDown:e.ToggleCreateMode},0),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"l",label:"Toggle current region lock",onKeyDown:e.ToggleRegionLock},1),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"shift + l",label:"Unlock all regions",onKeyDown:e.UnlockAllRegions},2),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"del",label:"Delete selected region",onKeyDown:t.deleteSelectedRegion},3),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"backspace",label:"Delete selected region",onKeyDown:t.deleteSelectedRegion},4),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"esc",label:"Deselect region/Cancel region creation",onKeyDown:e.HandleRegionEsc},5),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"mod",label:"Switch region creation mode"},6),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"shift",label:"Symmetric region creation"},7),Object(xm.jsx)(u.t,{group:r,global:!0,combo:"double-click",label:"Region properties"},8)],d=[Object(xm.jsx)(u.t,{group:o,global:!0,combo:`${i}]`,label:"Next image",onKeyDown:t.nextFrame},0),Object(xm.jsx)(u.t,{group:o,global:!0,combo:`${i}[`,label:"Previous image",onKeyDown:t.prevFrame},1),Object(xm.jsx)(u.t,{group:o,global:!0,combo:`${i}up`,label:"Next channel",onKeyDown:e.NextChannel},2),Object(xm.jsx)(u.t,{group:o,global:!0,combo:`${i}down`,label:"Previous channel",onKeyDown:e.PrevChannel},3),Object(xm.jsx)(u.t,{group:o,global:!0,combo:`${i}shift + up`,label:"Next Stokes cube",onKeyDown:e.NextStokes},4),Object(xm.jsx)(u.t,{group:o,global:!0,combo:`${i}shift + down`,label:"Previous Stokes cube",onKeyDown:e.PrevStokes},5)],p=[Object(xm.jsx)(u.t,{group:s,global:!0,combo:`${i}O`,label:"Open image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(DI.File)},0),Object(xm.jsx)(u.t,{group:s,global:!0,combo:`${i}L`,label:"Append image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(DI.File,!0)},1),Object(xm.jsx)(u.t,{group:s,global:!0,combo:`${i}W`,label:"Close image",onKeyDown:()=>t.closeCurrentFile(!0)},2),Object(xm.jsx)(u.t,{group:s,global:!0,combo:`${i}S`,label:"Save image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(DI.SaveFile,!1)},3),Object(xm.jsx)(u.t,{group:s,global:!0,combo:`${i}G`,label:"Import catalog",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(DI.Catalog,!1)},4),Object(xm.jsx)(u.t,{group:s,global:!0,combo:`${i}E`,label:"Export image",onKeyDown:()=>t.exportImage(1)},5)],h=[Object(xm.jsx)(u.t,{group:a,global:!0,combo:"shift + D",label:"Toggle light/dark theme",onKeyDown:e.ToggleDarkTheme},0),Object(xm.jsx)(u.t,{group:a,global:!0,combo:"F",label:"Freeze/unfreeze cursor position",onKeyDown:t.toggleCursorFrozen},1)];return Object(xm.jsxs)(u.u,{children:[c,l,d,p,h]})}},fX.NextChannel=()=>{const e=gC.Instance;e.activeFrame&&e.activeFrame.incrementChannels(1,0)},fX.PrevChannel=()=>{const e=gC.Instance;e.activeFrame&&e.activeFrame.incrementChannels(-1,0)},fX.NextStokes=()=>{const e=gC.Instance;e.activeFrame&&e.activeFrame.incrementChannels(0,1)},fX.PrevStokes=()=>{const e=gC.Instance;e.activeFrame&&e.activeFrame.incrementChannels(0,-1)},fX.ToggleDarkTheme=()=>{const e=gC.Instance;e.darkTheme?e.setLightTheme():e.setDarkTheme()},fX.ToggleCreateMode=()=>{const e=gC.Instance;e.activeFrame&&(e.toggleActiveLayer(),e.activeFrame.regionSet.toggleMode())},fX.ToggleRegionLock=()=>{const e=gC.Instance;if(e.activeFrame){const t=e.activeFrame.regionSet;t.selectedRegion&&t.selectedRegion.toggleLock()}},fX.UnlockAllRegions=()=>{const e=gC.Instance;if(e.activeFrame){const t=e.activeFrame.regionSet;for(const e of t.regions)e.setLocked(!1)}},fX.HandleRegionEsc=()=>{const e=gC.Instance;if(e.activeFrame&&e.activeFrame.regionSet){const t=e.activeFrame.regionSet;t.selectedRegion?t.deselectRegion():t.mode===Vb.CREATING&&(t.setMode(Vb.MOVING),e.updateActiveLayer(_G.RegionMoving))}},gX=bX))||gX;function yX(){}yX.prototype=Object.create(mX.prototype),yX.prototype.renderHotkeys=mX.RenderHotkeys;const OX=Object(u.v)(yX);var jX;i(1024),i(1025),i(1026);let xX=Object(p.a)(jX=class extends n.Component{constructor(...e){super(...e),this.onContainerResize=(e,t)=>{const i=gC.Instance;i.layoutStore.dockedLayout&&i.layoutStore.dockedLayout.updateSize(e,t)},this.renderAlertComponent=(e,t)=>{switch(e.alertType){case Gx.Info:return Object(xm.jsx)(u.a,{icon:e.alertIcon,className:t?"bp3-dark":"",isOpen:e.alertVisible,onClose:e.dismissAlert,canEscapeKeyCancel:!0,children:Object(xm.jsx)("p",{children:e.alertText})});case Gx.Interactive:return Object(xm.jsx)(u.a,{icon:e.alertIcon,className:t?"bp3-dark":"",isOpen:e.alertVisible,confirmButtonText:"OK",cancelButtonText:"Cancel",intent:g.a.DANGER,onClose:e.handleInteractiveAlertClosed,children:Object(xm.jsx)("p",{children:e.interactiveAlertText})});case Gx.Retry:return Object(xm.jsx)(u.a,{icon:e.alertIcon,className:t?"bp3-dark":"",isOpen:e.alertVisible,confirmButtonText:"Retry",intent:g.a.DANGER,onClose:e.handleInteractiveAlertClosed,canEscapeKeyCancel:!1,children:Object(xm.jsx)("p",{children:e.interactiveAlertText})});default:return null}}}render(){const e=gC.Instance,t=d()("App",{"bp3-dark":e.darkTheme}),i=d()("gl-container-app",{"dark-theme":e.darkTheme}),n=this.renderAlertComponent(e.alertStore,e.darkTheme);return Object(xm.jsxs)("div",{className:t,children:[Object(xm.jsx)(PH,{}),n,Object(xm.jsx)(WN,{progress:void 0,timeRemaining:0,isOpen:e.resumingSession,cancellable:!1,text:"Resuming session..."}),Object(xm.jsx)("div",{className:i,ref:t=>e.setAppContainer(t),children:Object(xm.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onContainerResize,refreshMode:"throttle",refreshRate:200})}),Object(xm.jsx)(OX,{}),Object(xm.jsx)(eW,{})]})}})||jX;i(1027);for(const SX of[D,hO,uO,gO,fO,bO,mO])(new Image).src=SX;l.a.onlyShowFocusOnTabs(),window.React=n,window.ReactDOM=o,async function(){const e=window.location.href.replace(window.location.search,"").replace("index.html",""),t=e+(e.endsWith("/")?"":"/")+"config";try{const e=await a.a.get(t);pj.SetRuntimeConfig(null===e||void 0===e?void 0:e.data)}catch(i){console.log("No runtime config provided. Using default configuration"),pj.SetRuntimeConfig({})}if(pj.RuntimeConfig.googleClientId){const e=document.createElement("script");e.src="https://apis.google.com/js/client.js",e.onload=()=>{o.render(Object(xm.jsx)(xX,{}),document.getElementById("root"))},document.body.appendChild(e)}else o.render(Object(xm.jsx)(xX,{}),document.getElementById("root"))}().then((()=>{console.log("Configuration complete. Rendering frontend")}))},384:function(e){e.exports=JSON.parse('{"name":"carta-frontend","version":"3.0.0-beta.3","repository":"https://github.com/CARTAvis/carta-frontend","description":"The browser-based frontend component of CARTA, a radio-astronomy visualization tool designed for the ALMA, the VLA and the SKA pathfinders.","homepage":"./","devDependencies":{"@blueprintjs/core":"^3.38.2","@blueprintjs/icons":"^3.24.0","@blueprintjs/popover2":"^0.11.0","@blueprintjs/select":"^3.15.4","@blueprintjs/table":"3.7.1","@testing-library/jest-dom":"^5.11.9","@testing-library/react":"^12.0.0","@testing-library/user-event":"^13.1.9","@types/gapi":"^0.0.40","@types/gapi.auth2":"^0.0.55","@types/jest":"^26.0.20","@types/jquery":"^3.5.5","@types/lodash":"^4.14.168","@types/node":"^16.3.2","@types/plotly.js":"^1.54.8","@types/prismjs":"^1.16.5","@types/react":"^17.0.2","@types/react-color":"^3.0.1","@types/react-dom":"^17.0.1","@types/react-plotly.js":"^2.2.4","@types/react-virtualized-auto-sizer":"^1.0.0","@types/react-window":"^1.8.2","@types/tinycolor2":"^1.4.2","ajv":"^8.6.1","axios":"^0.21.1","chart.js":"^3.7.1","classnames":"^2.3.1","fuzzy-search":"^3.2.1","glob-to-regexp":"^0.4.1","golden-layout":"^1.5.9","idb":"^6.1.3","jwt-decode":"^3.1.2","konva":"^8.1.1","lodash":"^4.17.15","mnemonist":"^0.38.1","mobx":"^6.1.7","mobx-react":"^7.1.0","moment":"^2.27.0","node-sass":"^7.0.0","npm-run-all":"^4.1.3","plotly.js":"^1.58.4","prettier":"2.3.2","preval.macro":"^5.0.0","prismjs":"^1.23.0","protobufjs":"6.9.0","raw-loader":"^4.0.2","react":"^17.0.1","react-chartjs-2":"^3.1.1","react-color":"^2.17.3","react-dom":"^17.0.1","react-iframe":"^1.8.0","react-konva":"^17.0.2-4","react-plotly.js":"^2.5.1","react-resize-detector":"^6.6.0","react-rnd":"^9.2.0","react-scripts":"^4.0.2","react-scroll-to-bottom":"^4.1.0","react-simple-code-editor":"^0.11.0","react-split-pane":"^0.1.91","react-virtualized-auto-sizer":"^1.0.4","react-window":"^1.8.6","rxjs":"^7.2.0","source-map-explorer":"^2.5.2","stats-js":"^1.0.1","tinycolor2":"^1.4.1","typescript":"^4.1.5","uuid":"^8.3.2","worker-loader":"^3.0.8"},"scripts":{"git-info":"./git-info.sh","analyze":"source-map-explorer build/static/js/main.*","start":"npm run git-info; react-scripts start","build":"npm run git-info; npm-run-all build-wrappers build-protobuf build-ts","build-docker":"npm run git-info; npm-run-all build-wrappers-docker build-protobuf build-ts","build-singularity":"npm run git-info; npm-run-all build-wrappers-singularity build-protobuf build-ts","build-ts":"react-scripts --max_old_space_size=4096 build","build-libs":"./wasm_libs/build_libs.sh","build-libs-docker":"./build_wasm_libs_docker.sh","build-libs-singularity":"./build_wasm_libs_singularity.sh","build-wrappers":"./wasm_src/build_wrappers.sh","build-wrappers-docker":"./build_wasm_wrappers_docker.sh","build-wrappers-singularity":"./build_wasm_wrappers_singularity.sh","build-protobuf":"./protobuf/build_proto.sh","test":"react-scripts test --env=jsdom","eject":"react-scripts eject","reformat":"npx prettier --write ./src","checkformat":"npx prettier --check ./src","prepack":"npm run build-libs-docker; npm run build-docker"},"eslintConfig":{"extends":"react-app","rules":{"no-unused-expressions":"off","@typescript-eslint/no-unused-expressions":"error","import/no-webpack-loader-syntax":"off","no-unused-vars":"off","@typescript-eslint/no-unused-vars":["error",{"args":"none"}],"jsx-a11y/alt-text":"off"}},"browserslist":{"production":["last 2 chrome versions","last 2 firefox versions","last 2 safari versions"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},392:function(e,t,i){},41:function(e,t,i){(function(t,n){var r="undefined"!==typeof r?r:{};r.locateFile=function(e,t){return"./"+e};var o,s={};for(o in r)r.hasOwnProperty(o)&&(s[o]=r[o]);var a=[],l=!1,c=!1,d=!1,p=!1;l="object"===typeof window,c="function"===typeof importScripts,d="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,p=!l&&!d&&!c;var h,u,g,f,b,m="";function y(e){return r.locateFile?r.locateFile(e,m):m+e}d?(m=c?i(113).dirname(m)+"/":n+"/",h=function(e,t){return f||(f=i(221)),b||(b=i(113)),e=b.normalize(e),f.readFileSync(e,t?null:"utf8")},g=function(e){var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),w(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),a=t.argv.slice(2),e.exports=r,t.on("uncaughtException",(function(e){if(!(e instanceof ke))throw e})),t.on("unhandledRejection",ae),function(e){t.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(h=function(e){return read(e)}),g=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(w("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?a=scriptArgs:"undefined"!=typeof arguments&&(a=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(l||c)&&(c?m=self.location.href:"undefined"!==typeof document&&document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),u=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var O=r.print||console.log.bind(console),j=r.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(r[o]=s[o]);s=null,r.arguments&&(a=r.arguments),r.thisProgram&&r.thisProgram,r.quit&&r.quit;var x,S=function(e){e};r.wasmBinary&&(x=r.wasmBinary);var v;r.noExitRuntime;function C(e,t,i){switch("*"===(t=t||"i8").charAt(t.length-1)&&(t="i32"),t){case"i1":case"i8":return L[e>>0];case"i16":return _[e>>1];case"i32":case"i64":return z[e>>2];case"float":return V[e>>2];case"double":return W[e>>3];default:ae("invalid type for getValue: "+t)}return null}"object"!==typeof WebAssembly&&ae("no native wasm support detected");var I=!1;function w(e,t){e||ae("Assertion failed: "+t)}function T(e){var t=r["_"+e];return w(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function R(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);k(e,t=Fe(i),i)}return t},array:function(e){var t=Fe(e.length);return G(e,t),t}};var s=T(e),a=[],l=0;if(n)for(var c=0;c<n.length;c++){var d=o[i[c]];d?(0===l&&(l=Ee()),a[c]=d(n[c])):a[c]=n[c]}var p=s.apply(null,a);return p=function(e){return"string"===t?M(e):"boolean"===t?Boolean(e):e}(p),0!==l&&Me(l),p}function A(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?T(e):function(){return R(e,t,i,arguments)}}var P="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&P)return P.decode(e.subarray(t,r));for(var o="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function M(e,t){return e?E(N,e,t):""}function F(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-r}function k(e,t,i){return F(e,N,t,i)}var D,L,N,_,z,V,W;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function G(e,t){L.set(e,t)}function B(e,t){return e%t>0&&(e+=t-e%t),e}function q(e){D=e,r.HEAP8=L=new Int8Array(e),r.HEAP16=_=new Int16Array(e),r.HEAP32=z=new Int32Array(e),r.HEAPU8=N=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=V=new Float32Array(e),r.HEAPF64=W=new Float64Array(e)}r.INITIAL_MEMORY;var H,Y=[],U=[],X=[],$=[];function K(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)ee(r.preRun.shift());me(Y)}function Q(){!0,me(U)}function Z(){me(X)}function J(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)te(r.postRun.shift());me($)}function ee(e){Y.unshift(e)}function te(e){$.unshift(e)}U.push({func:function(){Pe()}});var ie=0,ne=null,re=null;function oe(e){ie++,r.monitorRunDependencies&&r.monitorRunDependencies(ie)}function se(e){if(ie--,r.monitorRunDependencies&&r.monitorRunDependencies(ie),0==ie&&(null!==ne&&(clearInterval(ne),ne=null),re)){var t=re;re=null,t()}}function ae(e){throw r.onAbort&&r.onAbort(e),j(e+=""),I=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function le(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}r.preloadedImages={},r.preloadedAudios={};var ce="data:application/octet-stream;base64,";function de(e){return le(e,ce)}var pe="file://";function he(e){return le(e,pe)}var ue="gsl_wrapper.wasm";function ge(e){try{if(e==ue&&x)return new Uint8Array(x);if(g)return g(e);throw"both async and sync fetching of the wasm failed"}catch(j){ae(j)}}function fe(){if(!x&&(l||c)){if("function"===typeof fetch&&!he(ue))return fetch(ue,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ue+"'";return e.arrayBuffer()})).catch((function(){return ge(ue)}));if(u)return new Promise((function(e,t){u(ue,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ge(ue)}))}function be(){var e={env:Ae,wasi_snapshot_preview1:Ae};function t(e,t){var i=e.exports;r.asm=i,q((v=r.asm.memory).buffer),H=r.asm.__indirect_function_table,se()}function i(e){t(e.instance)}function n(t){return fe().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){j("failed to asynchronously prepare wasm: "+e),ae(e)}))}if(oe(),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(o){return j("Module.instantiateWasm callback failed with error: "+o),!1}return x||"function"!==typeof WebAssembly.instantiateStreaming||de(ue)||he(ue)||"function"!==typeof fetch?n(i):fetch(ue,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return j("wasm streaming compile failed: "+e),j("falling back to ArrayBuffer instantiation"),n(i)}))})),{}}function me(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?H.get(i)():H.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(r)}}function ye(){ae()}function Oe(e,t,i){N.copyWithin(e,t,t+i)}function je(){return N.length}function xe(e){try{return v.grow(e-D.byteLength+65535>>>16),q(v.buffer),1}catch(t){}}function Se(e){var t=je(),i=2147483648;if(e>i)return!1;for(var n=1;n<=4;n*=2){var r=t*(1+.2/n);if(r=Math.min(r,e+100663296),xe(Math.min(i,B(Math.max(e,r),65536))))return!0}return!1}de(ue)||(ue=y(ue));var ve={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var i=ve.buffers[e];0===t||10===t?((1===e?O:j)(E(i,0)),i.length=0):i.push(t)},varargs:void 0,get:function(){return ve.varargs+=4,z[ve.varargs-4>>2]},getStr:function(e){return M(e)},get64:function(e,t){return e}};function Ce(e){return 0}function Ie(e,t,i,n,r){}function we(e,t,i,n){for(var r=0,o=0;o<i;o++){for(var s=z[t+8*o>>2],a=z[t+(8*o+4)>>2],l=0;l<a;l++)ve.printChar(e,N[s+l]);r+=a}return z[n>>2]=r,0}function Te(e){S(0|e)}var Re,Ae={abort:ye,emscripten_memcpy_big:Oe,emscripten_resize_heap:Se,fd_close:Ce,fd_seek:Ie,fd_write:we,setTempRet0:Te},Pe=(be(),r.___wasm_call_ctors=function(){return(Pe=r.___wasm_call_ctors=r.asm.__wasm_call_ctors).apply(null,arguments)}),Ee=(r._linearRegression=function(){return(r._linearRegression=r.asm.linearRegression).apply(null,arguments)},r._filterBoxcar=function(){return(r._filterBoxcar=r.asm.filterBoxcar).apply(null,arguments)},r._filterGaussian=function(){return(r._filterGaussian=r.asm.filterGaussian).apply(null,arguments)},r._filterHanning=function(){return(r._filterHanning=r.asm.filterHanning).apply(null,arguments)},r._filterDecimation=function(){return(r._filterDecimation=r.asm.filterDecimation).apply(null,arguments)},r._filterBinning=function(){return(r._filterBinning=r.asm.filterBinning).apply(null,arguments)},r._filterSavitzkyGolay=function(){return(r._filterSavitzkyGolay=r.asm.filterSavitzkyGolay).apply(null,arguments)},r._fitting=function(){return(r._fitting=r.asm.fitting).apply(null,arguments)},r._malloc=function(){return(r._malloc=r.asm.malloc).apply(null,arguments)},r._free=function(){return(r._free=r.asm.free).apply(null,arguments)},r.___errno_location=function(){return(r.___errno_location=r.asm.__errno_location).apply(null,arguments)},r.stackSave=function(){return(Ee=r.stackSave=r.asm.stackSave).apply(null,arguments)}),Me=r.stackRestore=function(){return(Me=r.stackRestore=r.asm.stackRestore).apply(null,arguments)},Fe=r.stackAlloc=function(){return(Fe=r.stackAlloc=r.asm.stackAlloc).apply(null,arguments)};r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.dynCall_jiji).apply(null,arguments)};function ke(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function De(e){function t(){Re||(Re=!0,r.calledRun=!0,I||(Q(),Z(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),J()))}e=e||a,ie>0||(K(),ie>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}if(r.ccall=R,r.cwrap=A,r.getValue=C,re=function e(){Re||De(),Re||(re=e)},r.run=De,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();De(),r.linearRegression=r.cwrap("linearRegression","number",["number","number","number","number","number","number","number","number","number"]),r.filterBoxcar=r.cwrap("filterBoxcar","number",["number","number","number","number"]),r.filterGaussian=r.cwrap("filterGaussian","number",["number","number","number","number","number"]),r.filterHanning=r.cwrap("filterHanning","number",["number","number","number","number"]),r.filterDecimation=r.cwrap("filterDecimation","number",["number","number","number","number","number"]),r.filterBinning=r.cwrap("filterBinning","number",["number","number","number","number"]),r.filterSavitzkyGolay=r.cwrap("filterSavitzkyGolay","number",["number","number","number","number","number","number"]),r.fittingGaussian=r.cwrap("fitting","string",["number","number","number","number","number","number","number","number","number","number","number","number","number","number"]),r.getFittingParameters=function(e,t){var i=e.length;r.xIn=r._malloc(8*i),r.yIn=r._malloc(8*i);var n=r._malloc(8),o=r._malloc(8),s=r._malloc(8),a=r._malloc(8),l=r._malloc(8),c=r._malloc(8);r.HEAPF64.set(e,r.xIn/8),r.HEAPF64.set(t,r.yIn/8),r.linearRegression(r.xIn,r.yIn,i,n,o,s,a,l,c);var d=r.getValue(n,"double"),p=r.getValue(o,"double"),h=r.getValue(s,"double"),u=r.getValue(a,"double"),g=r.getValue(l,"double"),f=r.getValue(c,"double");return r._free(n),r._free(o),r._free(s),r._free(a),r._free(l),r._free(c),r._free(r.xIn),r._free(r.yIn),{intercept:d,slope:p,cov00:h,cov01:u,cov11:g,rss:f}},r.boxcarSmooth=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.yIn=r._malloc(8*i),r.yOut=r._malloc(8*i),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterBoxcar(r.yIn,i,r.yOut,t);var n=new Float64Array(r.HEAPF64.buffer,r.yOut,i).slice();return r._free(r.yIn),r._free(r.yOut),n},r.gaussianSmooth=function(e,t,i){if(!e)return new Float64Array(1);var n=e.length;r.yIn=r._malloc(8*n),r.yOut=r._malloc(8*n),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterGaussian(r.yIn,n,r.yOut,t,i);var o=new Float64Array(r.HEAPF64.buffer,r.yOut,n).slice();return r._free(r.yIn),r._free(r.yOut),o},r.hanningSmooth=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.yIn=r._malloc(8*i),r.yOut=r._malloc(8*i),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterHanning(r.yIn,i,r.yOut,t);var n=new Float64Array(r.HEAPF64.buffer,r.yOut,i).slice();return r._free(r.yIn),r._free(r.yOut),n},r.decimation=function(e,t,i){if(!t)return new Float64Array(1);var n=t.length;r.xIn=r._malloc(8*n),r.yIn=r._malloc(8*n);var o=n%i===1?2*Math.ceil(n/i)-1:2*Math.ceil(n/i);r.xOut=r._malloc(8*o),r.yOut=r._malloc(8*o),r.HEAPF64.set(new Float64Array(e),r.xIn/8),r.HEAPF64.set(new Float64Array(t),r.yIn/8),r.filterDecimation(r.xIn,r.yIn,n,r.xOut,r.yOut,o,i);var s=new Float64Array(r.HEAPF64.buffer,r.xOut,o).slice(),a=new Float64Array(r.HEAPF64.buffer,r.yOut,o).slice();return r._free(r.xIn),r._free(r.yIn),r._free(r.xOut),r._free(r.yOut),{x:s,y:a}},r.binning=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.input=r._malloc(8*i);var n=Math.ceil(i/t);r.output=r._malloc(8*n),r.HEAPF64.set(new Float64Array(e),r.input/8),r.filterBinning(r.input,i,r.output,t);var o=new Float64Array(r.HEAPF64.buffer,r.output,n).slice();return r._free(r.input),r._free(r.output),o},r.savitzkyGolaySmooth=function(e,t,i,n){if(!e||!t||n>=i)return new Float64Array(1);var o=e.length;r.xIn=r._malloc(8*o),r.yIn=r._malloc(8*o),r.yOut=r._malloc(8*o),r.HEAPF64.set(new Float64Array(e),r.xIn/8),r.HEAPF64.set(new Float64Array(t),r.yIn/8),r.filterSavitzkyGolay(r.xIn,r.yIn,o,r.yOut,i,n);var s=new Float64Array(r.HEAPF64.buffer,r.yOut,o).slice();return r._free(r.xIn),r._free(r.yIn),r._free(r.yOut),s},r.fitting=function(e,t,i,n,o,s,a){if(!t||!i||!n||!o)return null;var l=t.length;r.xIn=r._malloc(8*l),r.yIn=r._malloc(8*l),r.HEAPF64.set(new Float64Array(t),r.xIn/8),r.HEAPF64.set(new Float64Array(i),r.yIn/8);var c=n.length/3;r.orderValues=r._malloc(16),r.lockedOrderValues=r._malloc(8),r.HEAPF64.set(new Float64Array(s),r.orderValues/8),r.HEAP32.set(new Int32Array(a),r.lockedOrderValues/4),r.inputData=r._malloc(3*c*8),r.HEAPF64.set(new Float64Array(n),r.inputData/8);for(var d=[],p=0;p<c;p++)d.push(r.inputData+3*p*8);r.inputArray=r._malloc(4*c),r.HEAPU32.set(new Uint32Array(d),r.inputArray/4),r.lockedInputData=r._malloc(3*c*4),r.HEAP32.set(new Int32Array(o),r.lockedInputData/4);var h=[];for(p=0;p<c;p++)h.push(r.lockedInputData+3*p*4);r.lockedInputArray=r._malloc(4*c),r.HEAPU32.set(new Uint32Array(h),r.lockedInputArray/4),r.resultOrderValues=r._malloc(32),r.resultAmp=r._malloc(8*c*2),r.resultCenter=r._malloc(8*c*2),r.resultFwhm=r._malloc(8*c*2),r.resultIntegral=r._malloc(8*c*2),r.resultResidual=r._malloc(8*l);var u=r.fittingGaussian(r.xIn,r.yIn,l,r.inputArray,r.lockedInputArray,c,e,r.orderValues,r.lockedOrderValues,r.resultAmp,r.resultCenter,r.resultFwhm,r.resultOrderValues,r.resultIntegral,r.resultResidual),g=new Float64Array(r.HEAPF64.buffer,r.resultOrderValues,4).slice(),f=new Float64Array(r.HEAPF64.buffer,r.resultCenter,2*c).slice(),b=new Float64Array(r.HEAPF64.buffer,r.resultAmp,2*c).slice(),m=new Float64Array(r.HEAPF64.buffer,r.resultFwhm,2*c).slice(),y=new Float64Array(r.HEAPF64.buffer,r.resultIntegral,2*c).slice(),O=new Float64Array(r.HEAPF64.buffer,r.resultResidual,l).slice(),j={yIntercept:g[0],yInterceptError:g[1],slope:g[2],slopeError:g[3],center:f,amp:b,fwhm:m,log:u,integral:y,residual:O};return r._free(r.xIn),r._free(r.yIn),r._free(r.orderValues),r._free(r.lockedOrderValues),r._free(r.inputArray),r._free(r.inputData),r._free(r.lockedInputArray),r._free(r.lockedInputData),r._free(r.resultOrderValues),r._free(r.resultCenter),r._free(r.resultAmp),r._free(r.resultFwhm),r._free(r.resultIntegral),r._free(r.resultResidual),j},e.exports=r}).call(this,i(39),"/")},60:function(e,t,i){(function(t,n){var r="undefined"!==typeof r?r:{};r.locateFile=function(e,t){return"./"+e};var o,s={};for(o in r)r.hasOwnProperty(o)&&(s[o]=r[o]);var a=[],l=!1,c=!1,d=!1,p=!1;l="object"===typeof window,c="function"===typeof importScripts,d="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,p=!l&&!d&&!c;var h,u,g,f,b,m="";function y(e){return r.locateFile?r.locateFile(e,m):m+e}d?(m=c?i(113).dirname(m)+"/":n+"/",h=function(e,t){return f||(f=i(221)),b||(b=i(113)),e=b.normalize(e),f.readFileSync(e,t?null:"utf8")},g=function(e){var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),v(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),a=t.argv.slice(2),e.exports=r,t.on("uncaughtException",(function(e){if(!(e instanceof xe))throw e})),t.on("unhandledRejection",ee),function(e){t.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(h=function(e){return read(e)}),g=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(v("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?a=scriptArgs:"undefined"!=typeof arguments&&(a=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(l||c)&&(c?m=self.location.href:"undefined"!==typeof document&&document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),u=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});r.print||console.log.bind(console);var O,j=r.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(r[o]=s[o]);s=null,r.arguments&&(a=r.arguments),r.thisProgram&&r.thisProgram,r.quit&&r.quit,r.wasmBinary&&(O=r.wasmBinary);var x;r.noExitRuntime;"object"!==typeof WebAssembly&&ee("no native wasm support detected");var S=!1;function v(e,t){e||ee("Assertion failed: "+t)}function C(e){var t=r["_"+e];return v(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function I(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);k(e,t=je(i),i)}return t},array:function(e){var t=je(e.length);return D(e,t),t}};var s=C(e),a=[],l=0;if(n)for(var c=0;c<n.length;c++){var d=o[i[c]];d?(0===l&&(l=ye()),a[c]=d(n[c])):a[c]=n[c]}var p=s.apply(null,a);return p=function(e){return"string"===t?M(e):"boolean"===t?Boolean(e):e}(p),0!==l&&Oe(l),p}function w(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?C(e):function(){return I(e,t,i,arguments)}}var T,R,A,P="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&P)return P.decode(e.subarray(t,r));for(var o="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function M(e,t){return e?E(A,e,t):""}function F(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-r}function k(e,t,i){return F(e,A,t,i)}function D(e,t){R.set(e,t)}function L(e,t){return e%t>0&&(e+=t-e%t),e}function N(e){T=e,r.HEAP8=R=new Int8Array(e),r.HEAP16=new Int16Array(e),r.HEAP32=new Int32Array(e),r.HEAPU8=A=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=new Float32Array(e),r.HEAPF64=new Float64Array(e)}r.INITIAL_MEMORY;var _,z=[],V=[],W=[],G=[];function B(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)U(r.preRun.shift());de(z)}function q(){!0,de(V)}function H(){de(W)}function Y(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)X(r.postRun.shift());de(G)}function U(e){z.unshift(e)}function X(e){G.unshift(e)}V.push({func:function(){me()}});var $=0,K=null,Q=null;function Z(e){$++,r.monitorRunDependencies&&r.monitorRunDependencies($)}function J(e){if($--,r.monitorRunDependencies&&r.monitorRunDependencies($),0==$&&(null!==K&&(clearInterval(K),K=null),Q)){var t=Q;Q=null,t()}}function ee(e){throw r.onAbort&&r.onAbort(e),j(e+=""),S=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function te(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}r.preloadedImages={},r.preloadedAudios={};var ie="data:application/octet-stream;base64,";function ne(e){return te(e,ie)}var re="file://";function oe(e){return te(e,re)}var se="carta_computation.wasm";function ae(e){try{if(e==se&&O)return new Uint8Array(O);if(g)return g(e);throw"both async and sync fetching of the wasm failed"}catch(j){ee(j)}}function le(){if(!O&&(l||c)){if("function"===typeof fetch&&!oe(se))return fetch(se,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+se+"'";return e.arrayBuffer()})).catch((function(){return ae(se)}));if(u)return new Promise((function(e,t){u(se,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ae(se)}))}function ce(){var e={a:be};function t(e,t){var i=e.exports;r.asm=i,N((x=r.asm.c).buffer),_=r.asm.m,J()}function i(e){t(e.instance)}function n(t){return le().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){j("failed to asynchronously prepare wasm: "+e),ee(e)}))}if(Z(),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(o){return j("Module.instantiateWasm callback failed with error: "+o),!1}return O||"function"!==typeof WebAssembly.instantiateStreaming||ne(se)||oe(se)||"function"!==typeof fetch?n(i):fetch(se,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return j("wasm streaming compile failed: "+e),j("falling back to ArrayBuffer instantiation"),n(i)}))})),{}}function de(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?_.get(i)():_.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(r)}}function pe(e,t,i){A.copyWithin(e,t,t+i)}function he(){return A.length}function ue(e){try{return x.grow(e-T.byteLength+65535>>>16),N(x.buffer),1}catch(t){}}function ge(e){var t=he(),i=2147483648;if(e>i)return!1;for(var n=1;n<=4;n*=2){var r=t*(1+.2/n);if(r=Math.min(r,e+100663296),ue(Math.min(i,L(Math.max(e,r),65536))))return!0}return!1}ne(se)||(se=y(se));var fe,be={a:pe,b:ge},me=(ce(),r.___wasm_call_ctors=function(){return(me=r.___wasm_call_ctors=r.asm.d).apply(null,arguments)}),ye=(r._decodeArray=function(){return(r._decodeArray=r.asm.e).apply(null,arguments)},r._generateVertexData=function(){return(r._generateVertexData=r.asm.f).apply(null,arguments)},r._calculateCatalogMap=function(){return(r._calculateCatalogMap=r.asm.g).apply(null,arguments)},r._convertInt64Array=function(){return(r._convertInt64Array=r.asm.h).apply(null,arguments)},r._convertUint64Array=function(){return(r._convertUint64Array=r.asm.i).apply(null,arguments)},r._malloc=function(){return(r._malloc=r.asm.j).apply(null,arguments)},r._free=function(){return(r._free=r.asm.k).apply(null,arguments)},r._ZSTD_decompress=function(){return(r._ZSTD_decompress=r.asm.l).apply(null,arguments)},r.stackSave=function(){return(ye=r.stackSave=r.asm.n).apply(null,arguments)}),Oe=r.stackRestore=function(){return(Oe=r.stackRestore=r.asm.o).apply(null,arguments)},je=r.stackAlloc=function(){return(je=r.stackAlloc=r.asm.p).apply(null,arguments)};function xe(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Se(e){function t(){fe||(fe=!0,r.calledRun=!0,S||(q(),H(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Y()))}e=e||a,$>0||(B(),$>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}if(r.ccall=I,r.cwrap=w,Q=function e(){fe||Se(),fe||(Q=e)},r.run=Se,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();Se();var ve=r.cwrap("ZSTD_decompress","number",["number","number","number","number"]),Ce=r.cwrap("decodeArray","number",["number","number","number"]),Ie=r.cwrap("generateVertexData","number",["number","number","number","number","number","number"]),we=r.cwrap("calculateCatalogMap",null,["number","number","number","number","number","number","number","number","number","number","number","number"]),Te=r.cwrap("convertInt64Array",null,["number","number"]),Re=r.cwrap("convertUint64Array",null,["number","number"]),Ae=8;function Pe(e,t){var i=e.byteLength;i>r.srcAllocated&&(r._free(r.srcPtr),r.srcPtr=r._malloc(i),r.srcAllocated=i),t>r.destAllocated&&(r._free(r.destPtr),r.destPtr=r._malloc(t),r.destAllocated=t),new Uint8Array(r.HEAPU8.buffer,r.srcPtr,i).set(e)}r.srcAllocated=0,r.srcPtr=0,r.destAllocated=0,r.destPtr=0,X((function(){console.log("Zstd WebAssembly module loaded")})),r.ZstdReady=!1,r.onReady=new Promise((function(e){if(r.calledRun)e(r);else{var t=r.onRuntimeInitialized;r.onRuntimeInitialized=function(){t&&t(),e(r)}}r.ZstdReady=!0})),r.Decompress=function(e,t){var i=e.byteLength;Pe(e,t);var n=new Uint8Array(r.HEAPU8.buffer,r.destPtr,t);ve(r.destPtr,t,r.srcPtr,i);return n.slice()},r.Decode=function(e,t,i){var n=e.byteLength;Pe(e,t);ve(r.destPtr,t,r.srcPtr,n);var o=new Float32Array(r.HEAPU8.buffer,r.destPtr,t/4);return Ce(r.destPtr,t,i),o.slice()},r.GenerateVertexData=function(e,t){var i=t.length,n=e.length/2,o=(n+i-1)*Ae*4;Pe(new Uint8Array(e.buffer),o);var s=t.byteLength,a=r._malloc(s);new Int32Array(r.HEAPU8.buffer,a,t.length).set(t);var l=new Float32Array(r.HEAPU8.buffer,r.destPtr,o/4);return Ie(r.destPtr,o/4,r.srcPtr,n,a,i),r._free(a),l},r.CalculateCatalogSize=function(e,t,i,n,o,s,a,l,c,d){void 0===c&&(c=1e3),void 0===d&&(d=1.5);var p=e.length,h=e.BYTES_PER_ELEMENT,u=r._malloc(p*h);r.HEAPF32.set(e,u/h),we(a?1:0,u,p,t,i,n,o,s,c,d,l,!1);var g=new Float32Array(r.HEAPF32.buffer,u,p);return r._free(u),g.slice()},r.CalculateCatalogColor=function(e,t,i,n,o,s,a){void 0===s&&(s=1e3),void 0===a&&(a=1.5);var l=e.length,c=e.BYTES_PER_ELEMENT,d=r._malloc(l*c);r.HEAPF32.set(e,d/c),we(2,d,l,i,n,0,0,o,s,a,1,t);var p=new Float32Array(r.HEAPF32.buffer,d,l);return r._free(d),p.slice()},r.CalculateCatalogOrientation=function(e,t,i,n,o,s,a,l){void 0===a&&(a=1e3),void 0===l&&(l=1.5);var c=e.length,d=e.BYTES_PER_ELEMENT,p=r._malloc(c*d);r.HEAPF32.set(e,p/d),we(3,p,c,t,i,n,o,s,a,l,1,!1);var h=new Float32Array(r.HEAPF32.buffer,p,c);return r._free(p),h.slice()},r.ConvertInt64Array=function(e,t){var i=e.byteLength/8,n=r._malloc(e.byteLength);new Uint8Array(r.HEAPU8.buffer,n,e.byteLength).set(e),t?Te(n,i):Re(n,i);var o=new Float64Array(r.HEAPF64.buffer,n,i).slice();return r._free(n),o},e.exports=r}).call(this,i(39),"/")},679:function(e,t){},681:function(e,t){},693:function(e,t){},695:function(e,t){},722:function(e,t){},723:function(e,t){},728:function(e,t){},730:function(e,t){},737:function(e,t){},756:function(e,t){},786:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Layout","description":"Schema for CARTA Layout (Version 2)","$id":"carta_layout_2","definitions":{"percentage-value":{"description":"Describes a percentage value from 0 to 100","type":"number","minimum":0,"maximum":100},"plot-type":{"description":"Describes a plot type","enum":["Steps","Lines","Points"]},"line-width":{"description":"Describes a plot line width","type":"number","minimum":0.5,"maximum":10},"point-size":{"description":"Describes a plot point size","type":"number","minimum":0.5,"maximum":10},"opacity":{"description":"Describes an opacity value between zero and one","type":"number","minimum":0,"maximum":1},"spatial-coord":{"description":"Spatial coordinate","type":"string","enum":["x","Ix","Qx","Ux","Vx","y","Iy","Qy","Uy","Vy"]},"spectral-coord":{"description":"Spectral coordinate","type":"string","enum":["z","Iz","Qz","Uz","Vz"]},"basic-widget":{"description":"Widgets that have no associated settings","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"type":"string","enum":["floating-settings","layer-list","log","animator","region-list","image-view","stats","spectral-line-query","cursor-info","catalog-overlay","catalog-plot"]},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"spectral-profiler":{"description":"Spectral profiler widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"spectral-profiler"},"widgetSettings":{"properties":{"coordinate":{"$ref":"#/definitions/spectral-coord"},"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"spatial-profiler":{"description":"Spatial profiler widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"spatial-profiler"},"widgetSettings":{"properties":{"coordinate":{"$ref":"#/definitions/spatial-coord"},"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"wcsAxisVisible":{"type":"boolean"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"coord":{"description":"Legacy V1 entry (replaced by widgetSettings.coordinate","$ref":"#/definitions/spatial-coord"},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"render-config":{"description":"Render config widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"render-config"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"logScaleY":{"type":"boolean"},"markerTextVisible":{"type":"boolean"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"histogram":{"description":"Histogram widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"histogram"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"logScaleY":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"stokes":{"description":"Stokes analysis widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"stokes"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"secondaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"plotType":{"$ref":"#/definitions/plot-type"},"colorMap":{"type":"string"},"scatterPlotPointSize":{"$ref":"#/definitions/point-size"},"pointTransparency":{"$ref":"#/definitions/opacity"},"equalAxes":{"type":"boolean"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"carta-widget":{"description":"A CARTA widget","oneOf":[{"$ref":"#/definitions/basic-widget"},{"$ref":"#/definitions/spectral-profiler"},{"$ref":"#/definitions/spatial-profiler"},{"$ref":"#/definitions/render-config"},{"$ref":"#/definitions/histogram"},{"$ref":"#/definitions/stokes"}]},"gl-container":{"description":"A GoldenLayout container","type":"object","required":["type","content"],"additionalProperties":false,"properties":{"type":{"enum":["row","column","stack"]},"content":{"type":"array","minItems":1,"items":{"oneOf":[{"$ref":"#/definitions/gl-container"},{"$ref":"#/definitions/carta-widget"}]}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"},"activeItemIndex":{"type":"integer","minimum":0}}}},"required":["layoutVersion","docked","floating"],"properties":{"layoutVersion":{"description":"The version of the layout contained","type":"integer","minimum":1,"maximum":2},"docked":{"description":"GoldenLayout widget hierarchy","$ref":"#/definitions/gl-container"},"floating":{"description":"List of floating widgets","type":"array","items":{"allOf":[{"$ref":"#/definitions/carta-widget"},{"properties":{"defaultX":{"type":"number"},"defaultY":{"type":"number"},"defaultWidth":{"type":"number"},"defaultHeight":{"type":"number"}}}]}}}}')},788:function(e,t,i){},790:function(e,t,i){},811:function(e,t,i){},812:function(e,t,i){},813:function(e,t,i){},814:function(e,t,i){},815:function(e,t,i){},816:function(e,t,i){},817:function(e,t,i){},818:function(e,t,i){},819:function(e,t,i){},820:function(e,t,i){},821:function(e,t,i){},822:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Preferences","description":"Schema for CARTA Preferences (Version 2)","$id":"carta_preferences_2","required":["version"],"properties":{"version":{"description":"The version of the preferences contained","type":"integer","minimum":1,"maximum":2},"username":{"type":"string","minLength":1},"theme":{"type":"string","enum":["auto","light","dark"]},"autoLaunch":{"type":"boolean"},"fileSortingString":{"type":"string","pattern":"^([+\\\\-])(date|filename|type|size)$"},"fileFilteringType":{"type":"string","enum":["fuzzy","unix","regex"]},"layout":{"type":"string"},"cursorPosition":{"type":"string","enum":["fixed","tracking"]},"zoomMode":{"type":"string","enum":["fit","full"]},"zoomPoint":{"type":"string","enum":["cursor","center"]},"dragPanning":{"type":"boolean"},"spectralMatchingType":{"type":"string","enum":["VRAD","VOPT","FREQ","WAVE","AWAV","CHANNEL"]},"wcsMatchingType":{"type":"integer","minimum":0,"maximum":3},"transparentImageBackground":{"type":"boolean"},"scaling":{"type":"integer","minimum":0,"maximum":7},"colormap":{"type":"string"},"percentile":{"type":"number","exclusiveMaximum":100,"exclusiveMinimum":0},"scalingAlpha":{"type":"number","minimum":1},"scalingGamma":{"type":"number","exclusiveMinimum":0},"nanColorHex":{"type":"string","description":"TODO: validate color string"},"nanAlpha":{"type":"number","minimum":0,"maximum":1},"useSmoothedBiasContrast":{"type":"boolean"},"contourGeneratorType":{"type":"string","enum":["start-step-multiplier","min-max-scaling","percentages-ref.value","mean-sigma-list"]},"contourSmoothingMode":{"type":"integer","minimum":0,"maximum":2},"contourSmoothingFactor":{"type":"integer","minimum":0},"contourNumLevels":{"type":"integer","minimum":1},"contourThickness":{"type":"number","minimum":0},"contourColormapEnabled":{"type":"boolean"},"contourColor":{"type":"string","description":"TODO: validate color string"},"contourColormap":{"type":"string"},"vectorOverlayPixelAveraging":{"type":"number","minimum":2,"default":4},"vectorOverlayFractionalIntensity":{"type":"boolean","default":false},"vectorOverlayThickness":{"type":"number","minimum":0},"vectorOverlayColormapEnabled":{"type":"boolean"},"vectorOverlayColor":{"type":"string","description":"TODO: validate color string","default":"#ffffff"},"vectorOverlayColormap":{"type":"string","default":"viridis"},"astColor":{"type":"string","description":"TODO: validate color string"},"astGridVisible":{"type":"boolean"},"astLabelsVisible":{"type":"boolean"},"wcsType":{"type":"string","enum":["automatic","degrees","sexagesimal"]},"colorbarVisible":{"type":"boolean"},"colorbarInteractive":{"type":"boolean"},"colorbarPosition":{"type":"string","enum":["right","top","bottom"]},"colorbarWidth":{"type":"integer","minimum":1,"maximum":100},"colorbarTicksDensity":{"type":"number","minimum":0.2,"maximum":20},"colorbarLabelVisible":{"type":"boolean"},"beamVisible":{"type":"boolean"},"beamColor":{"type":"string"},"beamType":{"type":"string","enum":["open","solid"]},"beamWidth":{"type":"number","minimum":0},"regionColor":{"type":"string","description":"TODO: validate color string"},"regionLineWidth":{"type":"number","minimum":0},"regionDashLength":{"type":"integer","minimum":0},"regionType":{"type":"integer","minimum":0,"maximum":6},"regionCreationMode":{"type":"string","enum":["center","corner"]},"regionSize":{"type":"number","minimum":1},"imageCompressionQuality":{"type":"integer","minimum":4,"maximum":32},"animationCompressionQuality":{"type":"integer","minimum":4,"maximum":32},"GPUTileCache":{"type":"integer","multipleOf":256,"minimum":1024},"systemTileCache":{"type":"integer","multipleOf":128,"minimum":1024},"contourDecimation":{"type":"integer","minimum":1,"maximum":32},"contourCompressionLevel":{"type":"integer","minimum":0,"maximum":19},"contourChunkSize":{"type":"integer","multipleOf":25000,"minimum":25000,"maximum":1000000},"contourControlMapWidth":{"type":"integer","multipleOf":128,"minimum":128,"maximum":1024},"streamContoursWhileZooming":{"type":"boolean"},"lowBandwidthMode":{"type":"boolean"},"stopAnimationPlayback":{"type":"integer","minimum":5,"maximum":30},"pixelGridVisible":{"type":"boolean"},"pixelGridColor":{"type":"string"},"codeSnippetsEnabled":{"type":"boolean"},"limitOverlayRedraw":{"type":"boolean","default":true},"cursorInfoVisible":{"type":"string","enum":["always","activeImage","hideTiled","never"],"default":"activeImage"},"keepLastUsedFolder":{"type":"boolean","default":false},"lastUsedFolder":{"type":"string","default":""},"imageMultiPanelEnabled":{"type":"boolean","default":false},"imagePanelMode":{"type":"string","enum":["dynamic","fixed"],"default":"dynamic"},"imagePanelColumns":{"type":"number","minimum":1,"default":2},"imagePanelRows":{"type":"number","minimum":1,"default":2},"statsPanelEnabled":{"type":"boolean","default":false},"statsPanelMode":{"type":"integer","minimum":0,"default":0},"telemetryUuid":{"type":"string"},"telemetryMode":{"type":"string","enum":["none","minimal","usage"],"default":"usage"},"telemetryConsentShown":{"type":"boolean","default":false},"telemetryLogging":{"type":"boolean","default":false},"fileFilterMode":{"type":"string","enum":["content","extension","all"],"default":"content"}}}')},823:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Snippet","description":"Schema for CARTA Snippet (Version 1)","$id":"carta_snippet_1","required":["snippetVersion","frontendVersion","code"],"properties":{"snippetVersion":{"description":"The version of the snippet contained","type":"integer","minimum":1,"maximum":1},"frontendVersion":{"description":"The version of the frontend targeted by this snippet","type":"string"},"code":{"description":"Snippet source code","type":"string"},"tags":{"description":"List of tags associated with this snippet","type":"array","items":{"type":"string"}},"categories":{"description":"List of categories under which to place this snippet","type":"array","items":{"type":"string"}},"requires":{"description":"List of snippets (by name) which need to be run before running this snippet","type":"array","items":{"type":"string"}}}}')},826:function(e,t,i){},827:function(e,t,i){},828:function(e,t,i){},832:function(e,t,i){},833:function(e,t,i){},834:function(e,t,i){},835:function(e,t,i){},836:function(e,t,i){},837:function(e,t,i){},838:function(e,t,i){},839:function(e,t,i){},840:function(e,t,i){},841:function(e,t,i){},842:function(e,t,i){},843:function(e,t,i){},844:function(e,t,i){},845:function(e,t,i){},846:function(e,t,i){},847:function(e,t,i){},848:function(e,t,i){},849:function(e,t,i){},850:function(e,t,i){},851:function(e,t,i){},852:function(e,t,i){},853:function(e,t,i){},854:function(e,t,i){},855:function(e,t,i){},856:function(e,t,i){},857:function(e,t,i){},858:function(e,t,i){},859:function(e,t,i){},860:function(e,t,i){},861:function(e,t,i){},862:function(e,t,i){},863:function(e,t,i){},864:function(e,t,i){},865:function(e,t,i){},866:function(e,t,i){},867:function(e,t,i){},868:function(e,t,i){},869:function(e,t,i){},870:function(e,t,i){},871:function(e,t,i){},872:function(e,t,i){},873:function(e,t,i){},874:function(e,t,i){},875:function(e,t,i){},876:function(e,t,i){},992:function(e,t,i){},993:function(e,t,i){},994:function(e,t,i){},995:function(e,t,i){},996:function(e,t,i){},997:function(e,t,i){},998:function(e,t,i){},999:function(e,t,i){}},[[1028,1,2]]]);