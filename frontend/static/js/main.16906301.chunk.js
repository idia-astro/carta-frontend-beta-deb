(this["webpackJsonpcarta-frontend"]=this["webpackJsonpcarta-frontend"]||[]).push([[0],{11:function(e,t,i){"use strict";var n=i(262);i.o(n,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return n.CARTA_INFO})),i.o(n,"CHANNEL_TYPES")&&i.d(t,"CHANNEL_TYPES",(function(){return n.CHANNEL_TYPES})),i.o(n,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return n.CompressionQuality})),i.o(n,"ControlMap")&&i.d(t,"ControlMap",(function(){return n.ControlMap})),i.o(n,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return n.CursorPosition})),i.o(n,"Event")&&i.d(t,"Event",(function(){return n.Event})),i.o(n,"GenCoordinateLabel")&&i.d(t,"GenCoordinateLabel",(function(){return n.GenCoordinateLabel})),i.o(n,"IsSpectralSystemSupported")&&i.d(t,"IsSpectralSystemSupported",(function(){return n.IsSpectralSystemSupported})),i.o(n,"IsSpectralTypeSupported")&&i.d(t,"IsSpectralTypeSupported",(function(){return n.IsSpectralTypeSupported})),i.o(n,"IsSpectralUnitSupported")&&i.d(t,"IsSpectralUnitSupported",(function(){return n.IsSpectralUnitSupported})),i.o(n,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return n.LayoutConfig})),i.o(n,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return n.MOMENT_TEXT})),i.o(n,"Point2D")&&i.d(t,"Point2D",(function(){return n.Point2D})),i.o(n,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return n.PresetLayout})),i.o(n,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return n.ProtobufProcessing})),i.o(n,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return n.RegionCreationMode})),i.o(n,"SPECTRAL_COORDS_SUPPORTED")&&i.d(t,"SPECTRAL_COORDS_SUPPORTED",(function(){return n.SPECTRAL_COORDS_SUPPORTED})),i.o(n,"SPECTRAL_DEFAULT_UNIT")&&i.d(t,"SPECTRAL_DEFAULT_UNIT",(function(){return n.SPECTRAL_DEFAULT_UNIT})),i.o(n,"SPECTRAL_MATCHING_TYPES")&&i.d(t,"SPECTRAL_MATCHING_TYPES",(function(){return n.SPECTRAL_MATCHING_TYPES})),i.o(n,"SPECTRAL_TYPE_STRING")&&i.d(t,"SPECTRAL_TYPE_STRING",(function(){return n.SPECTRAL_TYPE_STRING})),i.o(n,"SpectralColorMap")&&i.d(t,"SpectralColorMap",(function(){return n.SpectralColorMap})),i.o(n,"SpectralSystem")&&i.d(t,"SpectralSystem",(function(){return n.SpectralSystem})),i.o(n,"SpectralType")&&i.d(t,"SpectralType",(function(){return n.SpectralType})),i.o(n,"SpectralUnit")&&i.d(t,"SpectralUnit",(function(){return n.SpectralUnit})),i.o(n,"Theme")&&i.d(t,"Theme",(function(){return n.Theme})),i.o(n,"TileCache")&&i.d(t,"TileCache",(function(){return n.TileCache})),i.o(n,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return n.TileCoordinate})),i.o(n,"Transform2D")&&i.d(t,"Transform2D",(function(){return n.Transform2D})),i.o(n,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return n.WCSMatchingType})),i.o(n,"WCSPoint2D")&&i.d(t,"WCSPoint2D",(function(){return n.WCSPoint2D})),i.o(n,"WCSType")&&i.d(t,"WCSType",(function(){return n.WCSType})),i.o(n,"Zoom")&&i.d(t,"Zoom",(function(){return n.Zoom})),i.o(n,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return n.ZoomPoint}));var r=i(263);i.o(r,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return r.CARTA_INFO})),i.o(r,"CHANNEL_TYPES")&&i.d(t,"CHANNEL_TYPES",(function(){return r.CHANNEL_TYPES})),i.o(r,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return r.CompressionQuality})),i.o(r,"ControlMap")&&i.d(t,"ControlMap",(function(){return r.ControlMap})),i.o(r,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return r.CursorPosition})),i.o(r,"Event")&&i.d(t,"Event",(function(){return r.Event})),i.o(r,"GenCoordinateLabel")&&i.d(t,"GenCoordinateLabel",(function(){return r.GenCoordinateLabel})),i.o(r,"IsSpectralSystemSupported")&&i.d(t,"IsSpectralSystemSupported",(function(){return r.IsSpectralSystemSupported})),i.o(r,"IsSpectralTypeSupported")&&i.d(t,"IsSpectralTypeSupported",(function(){return r.IsSpectralTypeSupported})),i.o(r,"IsSpectralUnitSupported")&&i.d(t,"IsSpectralUnitSupported",(function(){return r.IsSpectralUnitSupported})),i.o(r,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return r.LayoutConfig})),i.o(r,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return r.MOMENT_TEXT})),i.o(r,"Point2D")&&i.d(t,"Point2D",(function(){return r.Point2D})),i.o(r,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return r.PresetLayout})),i.o(r,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return r.ProtobufProcessing})),i.o(r,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return r.RegionCreationMode})),i.o(r,"SPECTRAL_COORDS_SUPPORTED")&&i.d(t,"SPECTRAL_COORDS_SUPPORTED",(function(){return r.SPECTRAL_COORDS_SUPPORTED})),i.o(r,"SPECTRAL_DEFAULT_UNIT")&&i.d(t,"SPECTRAL_DEFAULT_UNIT",(function(){return r.SPECTRAL_DEFAULT_UNIT})),i.o(r,"SPECTRAL_MATCHING_TYPES")&&i.d(t,"SPECTRAL_MATCHING_TYPES",(function(){return r.SPECTRAL_MATCHING_TYPES})),i.o(r,"SPECTRAL_TYPE_STRING")&&i.d(t,"SPECTRAL_TYPE_STRING",(function(){return r.SPECTRAL_TYPE_STRING})),i.o(r,"SpectralColorMap")&&i.d(t,"SpectralColorMap",(function(){return r.SpectralColorMap})),i.o(r,"SpectralSystem")&&i.d(t,"SpectralSystem",(function(){return r.SpectralSystem})),i.o(r,"SpectralType")&&i.d(t,"SpectralType",(function(){return r.SpectralType})),i.o(r,"SpectralUnit")&&i.d(t,"SpectralUnit",(function(){return r.SpectralUnit})),i.o(r,"Theme")&&i.d(t,"Theme",(function(){return r.Theme})),i.o(r,"TileCache")&&i.d(t,"TileCache",(function(){return r.TileCache})),i.o(r,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return r.TileCoordinate})),i.o(r,"Transform2D")&&i.d(t,"Transform2D",(function(){return r.Transform2D})),i.o(r,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return r.WCSMatchingType})),i.o(r,"WCSPoint2D")&&i.d(t,"WCSPoint2D",(function(){return r.WCSPoint2D})),i.o(r,"WCSType")&&i.d(t,"WCSType",(function(){return r.WCSType})),i.o(r,"Zoom")&&i.d(t,"Zoom",(function(){return r.Zoom})),i.o(r,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return r.ZoomPoint}));var o=i(264);i.d(t,"CHANNEL_TYPES",(function(){return o.a})),i.d(t,"GenCoordinateLabel",(function(){return o.b})),i.d(t,"IsSpectralSystemSupported",(function(){return o.c})),i.d(t,"IsSpectralTypeSupported",(function(){return o.d})),i.d(t,"IsSpectralUnitSupported",(function(){return o.e})),i.d(t,"SPECTRAL_COORDS_SUPPORTED",(function(){return o.f})),i.d(t,"SPECTRAL_DEFAULT_UNIT",(function(){return o.g})),i.d(t,"SPECTRAL_MATCHING_TYPES",(function(){return o.h})),i.d(t,"SPECTRAL_TYPE_STRING",(function(){return o.i})),i.d(t,"SpectralColorMap",(function(){return o.j})),i.d(t,"SpectralSystem",(function(){return o.k})),i.d(t,"SpectralType",(function(){return o.l})),i.d(t,"SpectralUnit",(function(){return o.m}));var s=i(265);i.o(s,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return s.CARTA_INFO})),i.o(s,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return s.CompressionQuality})),i.o(s,"ControlMap")&&i.d(t,"ControlMap",(function(){return s.ControlMap})),i.o(s,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return s.CursorPosition})),i.o(s,"Event")&&i.d(t,"Event",(function(){return s.Event})),i.o(s,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return s.LayoutConfig})),i.o(s,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return s.MOMENT_TEXT})),i.o(s,"Point2D")&&i.d(t,"Point2D",(function(){return s.Point2D})),i.o(s,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return s.PresetLayout})),i.o(s,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return s.ProtobufProcessing})),i.o(s,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return s.RegionCreationMode})),i.o(s,"Theme")&&i.d(t,"Theme",(function(){return s.Theme})),i.o(s,"TileCache")&&i.d(t,"TileCache",(function(){return s.TileCache})),i.o(s,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return s.TileCoordinate})),i.o(s,"Transform2D")&&i.d(t,"Transform2D",(function(){return s.Transform2D})),i.o(s,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return s.WCSMatchingType})),i.o(s,"WCSPoint2D")&&i.d(t,"WCSPoint2D",(function(){return s.WCSPoint2D})),i.o(s,"WCSType")&&i.d(t,"WCSType",(function(){return s.WCSType})),i.o(s,"Zoom")&&i.d(t,"Zoom",(function(){return s.Zoom})),i.o(s,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return s.ZoomPoint}));var a=i(266);i.d(t,"Point2D",(function(){return a.a})),i.d(t,"WCSPoint2D",(function(){return a.b}));var l=i(267);i.d(t,"Transform2D",(function(){return l.a}));var c=i(268);i.o(c,"CARTA_INFO")&&i.d(t,"CARTA_INFO",(function(){return c.CARTA_INFO})),i.o(c,"CompressionQuality")&&i.d(t,"CompressionQuality",(function(){return c.CompressionQuality})),i.o(c,"ControlMap")&&i.d(t,"ControlMap",(function(){return c.ControlMap})),i.o(c,"CursorPosition")&&i.d(t,"CursorPosition",(function(){return c.CursorPosition})),i.o(c,"Event")&&i.d(t,"Event",(function(){return c.Event})),i.o(c,"LayoutConfig")&&i.d(t,"LayoutConfig",(function(){return c.LayoutConfig})),i.o(c,"MOMENT_TEXT")&&i.d(t,"MOMENT_TEXT",(function(){return c.MOMENT_TEXT})),i.o(c,"PresetLayout")&&i.d(t,"PresetLayout",(function(){return c.PresetLayout})),i.o(c,"ProtobufProcessing")&&i.d(t,"ProtobufProcessing",(function(){return c.ProtobufProcessing})),i.o(c,"RegionCreationMode")&&i.d(t,"RegionCreationMode",(function(){return c.RegionCreationMode})),i.o(c,"Theme")&&i.d(t,"Theme",(function(){return c.Theme})),i.o(c,"TileCache")&&i.d(t,"TileCache",(function(){return c.TileCache})),i.o(c,"TileCoordinate")&&i.d(t,"TileCoordinate",(function(){return c.TileCoordinate})),i.o(c,"WCSMatchingType")&&i.d(t,"WCSMatchingType",(function(){return c.WCSMatchingType})),i.o(c,"WCSType")&&i.d(t,"WCSType",(function(){return c.WCSType})),i.o(c,"Zoom")&&i.d(t,"Zoom",(function(){return c.Zoom})),i.o(c,"ZoomPoint")&&i.d(t,"ZoomPoint",(function(){return c.ZoomPoint}));var d=i(269);i.d(t,"TileCoordinate",(function(){return d.a}));var u=i(270);i.d(t,"Theme",(function(){return u.a}));var h=i(271);i.d(t,"PresetLayout",(function(){return h.a}));var p=i(272);i.d(t,"CursorPosition",(function(){return p.a}));var g=i(273);i.d(t,"Zoom",(function(){return g.a}));var f=i(274);i.d(t,"ZoomPoint",(function(){return f.a}));var b=i(275);i.d(t,"WCSType",(function(){return b.a}));var m=i(276);i.d(t,"RegionCreationMode",(function(){return m.a}));var y=i(277);i.d(t,"CompressionQuality",(function(){return y.a}));var O=i(278);i.d(t,"TileCache",(function(){return O.a}));var j=i(279);i.d(t,"ProtobufProcessing",(function(){return j.a}));var S=i(280);i.d(t,"Event",(function(){return S.a}));var x=i(281);i.d(t,"CARTA_INFO",(function(){return x.a}));var C=i(282);i.d(t,"LayoutConfig",(function(){return C.a}));var I=i(289);i.d(t,"ControlMap",(function(){return I.a}));var w=i(342);i.d(t,"WCSMatchingType",(function(){return w.a}));var T=i(343);i.d(t,"MOMENT_TEXT",(function(){return T.a}))},12:function(e,t,i){"use strict";i.d(t,"n",(function(){return _})),i.d(t,"o",(function(){return Ae})),i.d(t,"p",(function(){return ht})),i.d(t,"q",(function(){return pt})),i.d(t,"j",(function(){return mt})),i.d(t,"r",(function(){return yt})),i.d(t,"i",(function(){return Fi})),i.d(t,"s",(function(){return Mi})),i.d(t,"a",(function(){return ct.a})),i.d(t,"k",(function(){return ct.b})),i.d(t,"m",(function(){return ct.d})),i.d(t,"l",(function(){return ct.c})),i.d(t,"t",(function(){return ki})),i.d(t,"h",(function(){return ln})),i.d(t,"g",(function(){return cn})),i.d(t,"v",(function(){return An.b})),i.d(t,"u",(function(){return An.a})),i.d(t,"c",(function(){return Pn})),i.d(t,"b",(function(){return En})),i.d(t,"e",(function(){return Fn})),i.d(t,"f",(function(){return kn})),i.d(t,"d",(function(){return qn}));var n,r,o,s,a,l,c,d,u,h,p,g,f,b,m,y,O,j,S,x,C,I,w,T,v,A,R,P,E=i(4),F=i(2),M=(i(28),i(1)),k=i(74),D=i(43),N=i.n(D),L=i(8);let _=(n=class{constructor(){Object(E.a)(this,"minX",r,this),Object(E.a)(this,"maxX",o,this),Object(E.a)(this,"minY",s,this),Object(E.a)(this,"maxY",a,this),Object(E.a)(this,"cursorX",l,this),Object(E.a)(this,"plotType",c,this),Object(E.a)(this,"primaryLineColor",d,this),Object(E.a)(this,"lineWidth",u,this),Object(E.a)(this,"linePlotPointSize",h,this),Object(E.a)(this,"logScaleY",p,this),Object(E.a)(this,"markerTextVisible",g,this),Object(E.a)(this,"meanRmsVisible",f,this),Object(E.a)(this,"linePlotInitXYBoundaries",b,this),Object(E.a)(this,"setXBounds",m,this),Object(E.a)(this,"clearXBounds",y,this),Object(E.a)(this,"setYBounds",O,this),Object(E.a)(this,"clearYBounds",j,this),Object(E.a)(this,"setXYBounds",S,this),Object(E.a)(this,"clearXYBounds",x,this),Object(E.a)(this,"setMarkerTextVisible",C,this),Object(E.a)(this,"setMeanRmsVisible",I,this),Object(E.a)(this,"setLogScale",w,this),Object(E.a)(this,"setPlotType",T,this),Object(E.a)(this,"setCursor",v,this),Object(E.a)(this,"setPrimaryLineColor",A,this),Object(E.a)(this,"setLineWidth",R,this),Object(E.a)(this,"setLinePlotPointSize",P,this),this.init=e=>{if(!e)return;const t=N()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=L.i.MIN_WIDTH&&e.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=L.i.MIN_POINT_SIZE&&e.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.logScaleY&&(this.logScaleY=e.logScaleY),"boolean"===typeof e.markerTextVisible&&(this.markerTextVisible=e.markerTextVisible),"boolean"===typeof e.meanRmsVisible&&(this.meanRmsVisible=e.meanRmsVisible),"string"!==typeof e.plotType||e.plotType!==L.j.STEPS&&e.plotType!==L.j.LINES&&e.plotType!==L.j.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,logScaleY:this.logScaleY,markerTextVisible:this.markerTextVisible,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(M.p)(this),this.logScaleY=!0,this.plotType=L.j.STEPS,this.markerTextVisible=!0,this.meanRmsVisible=!0,this.primaryLineColor={colorHex:k.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0}}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},r=Object(F.a)(n.prototype,"minX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(F.a)(n.prototype,"maxX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(F.a)(n.prototype,"minY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(F.a)(n.prototype,"maxY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(F.a)(n.prototype,"cursorX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(F.a)(n.prototype,"plotType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(F.a)(n.prototype,"primaryLineColor",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(F.a)(n.prototype,"lineWidth",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(F.a)(n.prototype,"linePlotPointSize",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(F.a)(n.prototype,"logScaleY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(F.a)(n.prototype,"markerTextVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(F.a)(n.prototype,"meanRmsVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(F.a)(n.prototype,"linePlotInitXYBoundaries",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(F.a)(n.prototype,"setXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),y=Object(F.a)(n.prototype,"clearXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),O=Object(F.a)(n.prototype,"setYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),j=Object(F.a)(n.prototype,"clearYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),S=Object(F.a)(n.prototype,"setXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),x=Object(F.a)(n.prototype,"clearXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),C=Object(F.a)(n.prototype,"setMarkerTextVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),I=Object(F.a)(n.prototype,"setMeanRmsVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),w=Object(F.a)(n.prototype,"setLogScale",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logScaleY=e}}}),T=Object(F.a)(n.prototype,"setPlotType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),v=Object(F.a)(n.prototype,"setCursor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Object(F.a)(n.prototype,"isAutoScaledX",[M.i],Object.getOwnPropertyDescriptor(n.prototype,"isAutoScaledX"),n.prototype),Object(F.a)(n.prototype,"isAutoScaledY",[M.i],Object.getOwnPropertyDescriptor(n.prototype,"isAutoScaledY"),n.prototype),A=Object(F.a)(n.prototype,"setPrimaryLineColor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),R=Object(F.a)(n.prototype,"setLineWidth",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),P=Object(F.a)(n.prototype,"setLinePlotPointSize",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(F.a)(n.prototype,"initXYBoundaries",[M.g],Object.getOwnPropertyDescriptor(n.prototype,"initXYBoundaries"),n.prototype),n);var z,W,G,V,B,H,q,Y,U,X,$,K,Q,Z,J,ee,te,ie,ne,re,oe,se,ae,le,ce,de,ue,he,pe,ge,fe,be,me,ye,Oe,je,Se,xe,Ce,Ie,we=i(5),Te=i(6),ve=i(13);let Ae=(Ie=Ce=class e{constructor(t="x",i=-1,n=0){Object(E.a)(this,"fileId",W,this),Object(E.a)(this,"regionId",G,this),Object(E.a)(this,"coordinate",V,this),Object(E.a)(this,"minX",B,this),Object(E.a)(this,"maxX",H,this),Object(E.a)(this,"minY",q,this),Object(E.a)(this,"maxY",Y,this),Object(E.a)(this,"cursorX",U,this),Object(E.a)(this,"markerTextVisible",X,this),Object(E.a)(this,"isMouseMoveIntoLinePlots",$,this),Object(E.a)(this,"wcsAxisVisible",K,this),Object(E.a)(this,"plotType",Q,this),Object(E.a)(this,"meanRmsVisible",Z,this),Object(E.a)(this,"primaryLineColor",J,this),Object(E.a)(this,"lineWidth",ee,this),Object(E.a)(this,"linePlotPointSize",te,this),Object(E.a)(this,"linePlotInitXYBoundaries",ie,this),this.smoothingStore=void 0,Object(E.a)(this,"settingsTabId",ne,this),Object(E.a)(this,"setFileId",re,this),Object(E.a)(this,"setRegionId",oe,this),Object(E.a)(this,"setCoordinate",se,this),Object(E.a)(this,"setXBounds",ae,this),Object(E.a)(this,"clearXBounds",le,this),Object(E.a)(this,"setYBounds",ce,this),Object(E.a)(this,"clearYBounds",de,this),Object(E.a)(this,"setXYBounds",ue,this),Object(E.a)(this,"clearXYBounds",he,this),Object(E.a)(this,"setMarkerTextVisible",pe,this),Object(E.a)(this,"setMeanRmsVisible",ge,this),Object(E.a)(this,"setWcsAxisVisible",fe,this),Object(E.a)(this,"setPlotType",be,this),Object(E.a)(this,"setCursor",me,this),Object(E.a)(this,"setMouseMoveIntoLinePlots",ye,this),Object(E.a)(this,"setSettingsTabId",Oe,this),Object(E.a)(this,"setPrimaryLineColor",je,this),Object(E.a)(this,"setLineWidth",Se,this),Object(E.a)(this,"setLinePlotPointSize",xe,this),this.init=t=>{if(!t)return;"string"===typeof t.coordinate&&e.ValidCoordinates.includes(t.coordinate)&&(this.coordinate=t.coordinate);const i=N()(t.primaryLineColor);i.isValid()&&(this.primaryLineColor.colorHex=i.toHexString()),"number"===typeof t.lineWidth&&t.lineWidth>=L.i.MIN_WIDTH&&t.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=t.lineWidth),"number"===typeof t.linePlotPointSize&&t.linePlotPointSize>=L.i.MIN_POINT_SIZE&&t.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=t.linePlotPointSize),"boolean"===typeof t.wcsAxisVisible&&(this.wcsAxisVisible=t.wcsAxisVisible),"boolean"===typeof t.meanRmsVisible&&(this.meanRmsVisible=t.meanRmsVisible),"string"!==typeof t.plotType||t.plotType!==L.j.STEPS&&t.plotType!==L.j.LINES&&t.plotType!==L.j.POINTS||(this.plotType=t.plotType),"number"===typeof t.minXVal&&(this.linePlotInitXYBoundaries.minXVal=t.minXVal),"number"===typeof t.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=t.maxXVal),"number"===typeof t.minYVal&&(this.linePlotInitXYBoundaries.minYVal=t.minYVal),"number"===typeof t.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=t.maxYVal)},this.toConfig=()=>({coordinate:this.coordinate,primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,wcsAxisVisible:this.wcsAxisVisible,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(M.p)(this),this.coordinate=t,this.fileId=i,this.regionId=n,this.plotType=L.j.STEPS,this.meanRmsVisible=!1,this.markerTextVisible=!1,this.wcsAxisVisible=!0,this.primaryLineColor={colorHex:k.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.smoothingStore=new we.I,this.settingsTabId=ve.x.STYLING}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}static CalculateRequirementsMap(e,t){const i=new Map;return t.forEach((t=>{const n=e.frameInfo.fileId,r=t.coordinate;if(!e.regionSet)return;if(e.regionSet.regions.find((e=>0===e.regionId))){let e=i.get(n);e||(e=new Map,i.set(n,e));let t=e.get(0);t||(t=new Te.a.SetSpatialRequirements({regionId:0,fileId:n}),e.set(0,t)),t.spatialProfiles||(t.spatialProfiles=[]),-1===t.spatialProfiles.indexOf(r)&&t.spatialProfiles.push(r)}})),i}static DiffSpatialRequirements(e,t){const i=[];return e.forEach(((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach(((e,t)=>{let r=n.get(t);r||(r=new Te.a.SetSpatialRequirements({fileId:i,regionId:t,spatialProfiles:[]}),n.set(t,r))}))})),t.forEach(((t,n)=>{let r=e.get(n);r?t.forEach(((e,t)=>{let n=r.get(t);if(n){const t=n.spatialProfiles?n.spatialProfiles.length:0,r=e.spatialProfiles?e.spatialProfiles.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.spatialProfiles.sort(),s=n.spatialProfiles.sort();for(let n=0;n<r;n++){if(o[n]!==s[n])return void i.push(e)}}else i.push(e)})):t.forEach((e=>i.push(e)))})),i.sort(((e,t)=>e.spatialProfiles.length>t.spatialProfiles.length?1:-1))}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ce.ValidCoordinates=["x","y","Ix","Iy","Qx","Qy","Ux","Uy","Vx","Vy"],z=Ie,W=Object(F.a)(z.prototype,"fileId",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=Object(F.a)(z.prototype,"regionId",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=Object(F.a)(z.prototype,"coordinate",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),B=Object(F.a)(z.prototype,"minX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=Object(F.a)(z.prototype,"maxX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=Object(F.a)(z.prototype,"minY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=Object(F.a)(z.prototype,"maxY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),U=Object(F.a)(z.prototype,"cursorX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),X=Object(F.a)(z.prototype,"markerTextVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Object(F.a)(z.prototype,"isMouseMoveIntoLinePlots",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(F.a)(z.prototype,"wcsAxisVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=Object(F.a)(z.prototype,"plotType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(F.a)(z.prototype,"meanRmsVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(F.a)(z.prototype,"primaryLineColor",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Object(F.a)(z.prototype,"lineWidth",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Object(F.a)(z.prototype,"linePlotPointSize",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=Object(F.a)(z.prototype,"linePlotInitXYBoundaries",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(F.a)(z.prototype,"settingsTabId",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(F.a)(z.prototype,"setFileId",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearXYBounds(),this.fileId=e}}}),oe=Object(F.a)(z.prototype,"setRegionId",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearXYBounds(),this.regionId=e}}}),se=Object(F.a)(z.prototype,"setCoordinate",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{Ae.ValidCoordinates.includes(e)&&(this.clearXYBounds(),this.coordinate=e)}}}),ae=Object(F.a)(z.prototype,"setXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),le=Object(F.a)(z.prototype,"clearXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),ce=Object(F.a)(z.prototype,"setYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),de=Object(F.a)(z.prototype,"clearYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),ue=Object(F.a)(z.prototype,"setXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),he=Object(F.a)(z.prototype,"clearXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),pe=Object(F.a)(z.prototype,"setMarkerTextVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),ge=Object(F.a)(z.prototype,"setMeanRmsVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),fe=Object(F.a)(z.prototype,"setWcsAxisVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.wcsAxisVisible=e}}}),be=Object(F.a)(z.prototype,"setPlotType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),me=Object(F.a)(z.prototype,"setCursor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),ye=Object(F.a)(z.prototype,"setMouseMoveIntoLinePlots",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),Oe=Object(F.a)(z.prototype,"setSettingsTabId",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(F.a)(z.prototype,"isAutoScaledX",[M.i],Object.getOwnPropertyDescriptor(z.prototype,"isAutoScaledX"),z.prototype),Object(F.a)(z.prototype,"isAutoScaledY",[M.i],Object.getOwnPropertyDescriptor(z.prototype,"isAutoScaledY"),z.prototype),je=Object(F.a)(z.prototype,"setPrimaryLineColor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),Se=Object(F.a)(z.prototype,"setLineWidth",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),xe=Object(F.a)(z.prototype,"setLinePlotPointSize",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(F.a)(z.prototype,"initXYBoundaries",[M.g],Object.getOwnPropertyDescriptor(z.prototype,"initXYBoundaries"),z.prototype),z);var Re,Pe,Ee,Fe,Me,ke,De,Ne,Le,_e,ze,We,Ge,Ve,Be,He,qe,Ye,Ue,Xe,$e,Ke,Qe,Ze,Je,et,tt,it,nt,rt,ot,st,at,lt=i(27),ct=i(62),dt=i(11),ut=i(7);let ht,pt,gt;!function(e){e.Range="Range",e.Center="Center"}(ht||(ht={})),function(e){e.GHz="GHz",e.MHz="MHz",e.CM="cm",e.MM="mm"}(pt||(pt={})),function(e){e.Species="Species",e.ChemicalName="Chemical Name",e.ShiftedFrequency="Shifted Frequency",e.RestFrequencySPLA="Freq-MHz(rest frame,redshifted)",e.RestFrequency="Rest Frequency",e.RestFrequencyErrSPLA="Freq Err(rest frame,redshifted)",e.RestFrequencyErr="Rest Frequency Error",e.MeasuredFrequencySPLA="Meas Freq-MHz(rest frame,redshifted)",e.MeasuredFrequency="Measured Frequency",e.MeasuredFrequencyErrSPLA="Meas Freq Err(rest frame,redshifted)",e.MeasuredFrequencyErr="Measured Frequency Error",e.ResolvedQN="Resolved QNs",e.UnresolvedQN="Unresolved QNs",e.IntensityCDMS="CDMS/JPL Intensity",e.IntensitySijm2SPLA="S<sub>ij</sub>&#956;<sup>2</sup> (D<sup>2</sup>)",e.IntensitySijm2="Sij \u03bc^2",e.IntensitySijSPLA="S<sub>ij</sub>",e.IntensitySij="Sij",e.IntensityAijSPLA="Log<sub>10</sub> (A<sub>ij</sub>)",e.IntensityAij="Log10(Aij)",e.IntensityLovas="Lovas/AST Intensity",e.EnergyLowerCM="E_L (cm^-1)",e.EnergyLowerK="E_L (K)",e.EnergyUpperCM="E_U (cm^-1)",e.EnergyUpperK="E_U (K)",e.LineList="Linelist"}(gt||(gt={}));const ft=new Map([[gt.RestFrequencySPLA,gt.RestFrequency],[gt.RestFrequencyErrSPLA,gt.RestFrequencyErr],[gt.MeasuredFrequencySPLA,gt.MeasuredFrequency],[gt.MeasuredFrequencyErrSPLA,gt.MeasuredFrequencyErr],[gt.IntensitySijm2SPLA,gt.IntensitySijm2],[gt.IntensitySijSPLA,gt.IntensitySij],[gt.IntensityAijSPLA,gt.IntensityAij]]),bt=new Map([[gt.Species,"Descriptive formula of molecular species"],[gt.ChemicalName,"Common chemical name for species"],[gt.ShiftedFrequency,"Shifted frequency according to the input velocity or redshift"],[gt.RestFrequency,"Frequency at the rest frame"],[gt.RestFrequencyErr,"Frequency error at the rest frame"],[gt.MeasuredFrequency,"Frequency measured from laboratories"],[gt.MeasuredFrequencyErr,"Frequency error measured from laboratories"],[gt.ResolvedQN,"Rotational/rovibrational quantum numbers associated with the transition"],[gt.IntensityCDMS,"Boltzmann-weighted logarithmic intensity of transition, given at 300 K"],[gt.IntensitySijm2,"Dipole-weighted transition dipole matrix elements (Debye^2)"],[gt.IntensitySij,"Line strength"],[gt.IntensityAij,"Base-10 logarithm of the Einstein A coefficient (s^-1)"],[gt.IntensityLovas,"Observed astronomical intensity for given transition"],[gt.EnergyLowerCM,"Lower level energy in wave number"],[gt.EnergyLowerK,"Lower level energy in K"],[gt.EnergyUpperCM,"Upper level energy in wave number"],[gt.EnergyUpperK,"Upper level energy in K"],[gt.LineList,"Originated catalogue"]]);let mt;!function(e){e.V="Velocity (km/s)",e.Z="Redshift"}(mt||(mt={}));let yt=(Re=class extends ct.c{setQueryResultTableRef(e){this.queryResultTableRef=e}clearData(){this.queryResult.clear()}get formalizedHeaders(){let e=[];return this.columnHeaders.forEach((t=>{Object.values(gt).includes(t.name)&&e.push({name:t.name,desc:bt.get(t.name)})})),e}get redshiftFactor(){return this.redshiftType===mt.V?Math.sqrt((1-1e3*this.redshiftInput/ut.d)/(1+1e3*this.redshiftInput/ut.d)):1/(this.redshiftInput+1)}get displayedColumnHeaders(){let e=[];return this.columnHeaders.forEach((t=>{this.headerDisplay.get(t.name)&&e.push(t)})),e}get isSelectingAllLines(){let e=!0;if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0)for(let t=0;t<this.isLineSelectedArray.length;t++)e=e&&this.isLineSelectedArray[t];return e}get isSelectingIndeterminatedLines(){let e=!1;if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0)for(let t=0;t<this.isLineSelectedArray.length;t++)e=e||this.isLineSelectedArray[t];return e&&!this.isSelectingAllLines}get manualSelectionData(){return this.isLineSelectedArray&&this.isLineSelectedArray.length>0?[...this.isLineSelectedArray]:[]}get selectedLines(){const e=[];if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0)for(let t=0;t<this.isLineSelectedArray.length;t++)if(this.isLineSelectedArray[t]){const i=this.queryResult.get(0),n=this.queryResult.get(2),r=this.queryResult.get(7);e.push({species:i.data[t],value:n.data[t],qn:r.data[t]})}return e}constructor(){super(ct.d.CLOSED),Object(E.a)(this,"queryRangeType",Pe,this),Object(E.a)(this,"queryRange",Ee,this),Object(E.a)(this,"queryRangeByCenter",Fe,this),Object(E.a)(this,"queryUnit",Me,this),Object(E.a)(this,"intensityLimitEnabled",ke,this),Object(E.a)(this,"intensityLimitValue",De,this),Object(E.a)(this,"isQuerying",Ne,this),Object(E.a)(this,"columnHeaders",Le,this),Object(E.a)(this,"headerDisplay",_e,this),Object(E.a)(this,"redshiftType",ze,this),Object(E.a)(this,"redshiftInput",We,this),Object(E.a)(this,"queryResultTableRef",Ge,this),Object(E.a)(this,"queryResult",Ve,this),Object(E.a)(this,"isLineSelectedArray",Be,this),Object(E.a)(this,"restFreqColumn",He,this),Object(E.a)(this,"measuredFreqColumn",qe,this),Object(E.a)(this,"sortingInfo",Ye,this),Object(E.a)(this,"numDataRows",Ue,this),Object(E.a)(this,"selectedSpectralProfilerID",Xe,this),Object(E.a)(this,"setQueryRangeType",$e,this),Object(E.a)(this,"setQueryRange",Ke,this),Object(E.a)(this,"setQueryRangeByCenter",Qe,this),Object(E.a)(this,"setQueryUnit",Ze,this),Object(E.a)(this,"toggleIntensityLimit",Je,this),Object(E.a)(this,"setIntensityLimitValue",et,this),Object(E.a)(this,"setHeaderDisplay",tt,this),Object(E.a)(this,"setRedshiftType",it,this),Object(E.a)(this,"setRedshiftInput",nt,this),Object(E.a)(this,"selectAllLines",rt,this),Object(E.a)(this,"selectSingleLine",ot,this),Object(E.a)(this,"setSelectedSpectralProfiler",st,this),Object(E.a)(this,"query",at,this),this.calculateFreqMHz=(e,t)=>{if(isFinite(e)&&null!==e&&!(e<0)&&t)return t===pt.CM?Object(ut.pb)(e/100)/1e6:t===pt.MM?Object(ut.pb)(e/1e3)/1e6:t===pt.GHz?1e3*e:t===pt.MHz?e:void 0},Object(M.p)(this),this.queryRangeType=ht.Range,this.queryRange=[0,0],this.queryRangeByCenter=[0,0],this.queryUnit=pt.MHz,this.intensityLimitEnabled=!0,this.intensityLimitValue=-5,this.isQuerying=!1,this.columnHeaders=[],this.headerDisplay=new Map,Object.values(gt).forEach((e=>this.headerDisplay.set(e,!0))),this.redshiftType=mt.V,this.redshiftInput=0,this.queryResultTableRef=void 0,this.queryResult=new Map,this.restFreqColumn=void 0,this.measuredFreqColumn=void 0,this.numDataRows=0,this.isLineSelectedArray=[],this.selectedSpectralProfilerID=we.e.Instance.widgetsStore.spectralProfilerList.length>0?we.e.Instance.widgetsStore.spectralProfilerList[0]:void 0,this.sortingInfo={columnName:null,sortingType:null},Object(M.h)((()=>{var e,t;if(this.queryResult.size>0&&(null===(e=this.restFreqColumn)||void 0===e?void 0:e.data)&&(null===(t=this.measuredFreqColumn)||void 0===t?void 0:t.data)){const e=this.restFreqColumn.data.map(((e,t)=>{let i=parseFloat(e);return!isFinite(i)&&t<this.measuredFreqColumn.data.length&&(i=parseFloat(this.measuredFreqColumn.data[t])),isFinite(i)?i*this.redshiftFactor:void 0}));this.queryResult.set(2,{dataType:Te.a.ColumnType.Double,data:e})}})),Object(M.h)((()=>{we.e.Instance.widgetsStore.getSpectralWidgetStoreByID(this.selectedSpectralProfilerID)||(this.selectedSpectralProfilerID=we.e.Instance.widgetsStore.spectralProfilerList.length>0?we.e.Instance.widgetsStore.spectralProfilerList[0]:void 0)}))}},Pe=Object(F.a)(Re.prototype,"queryRangeType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ee=Object(F.a)(Re.prototype,"queryRange",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=Object(F.a)(Re.prototype,"queryRangeByCenter",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Object(F.a)(Re.prototype,"queryUnit",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke=Object(F.a)(Re.prototype,"intensityLimitEnabled",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=Object(F.a)(Re.prototype,"intensityLimitValue",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ne=Object(F.a)(Re.prototype,"isQuerying",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le=Object(F.a)(Re.prototype,"columnHeaders",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(F.a)(Re.prototype,"headerDisplay",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Object(F.a)(Re.prototype,"redshiftType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=Object(F.a)(Re.prototype,"redshiftInput",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=Object(F.a)(Re.prototype,"queryResultTableRef",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Object(F.a)(Re.prototype,"queryResult",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=Object(F.a)(Re.prototype,"isLineSelectedArray",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),He=Object(F.a)(Re.prototype,"restFreqColumn",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qe=Object(F.a)(Re.prototype,"measuredFreqColumn",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ye=Object(F.a)(Re.prototype,"sortingInfo",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ue=Object(F.a)(Re.prototype,"numDataRows",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xe=Object(F.a)(Re.prototype,"selectedSpectralProfilerID",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=Object(F.a)(Re.prototype,"setQueryRangeType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRangeType=e}}}),Ke=Object(F.a)(Re.prototype,"setQueryRange",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRange=e}}}),Qe=Object(F.a)(Re.prototype,"setQueryRangeByCenter",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryRangeByCenter=e}}}),Ze=Object(F.a)(Re.prototype,"setQueryUnit",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.queryUnit=e}}}),Je=Object(F.a)(Re.prototype,"toggleIntensityLimit",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.intensityLimitEnabled=!this.intensityLimitEnabled}}}),et=Object(F.a)(Re.prototype,"setIntensityLimitValue",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.intensityLimitValue=e}}}),tt=Object(F.a)(Re.prototype,"setHeaderDisplay",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.headerDisplay.set(e,!this.headerDisplay.get(e))}}}),it=Object(F.a)(Re.prototype,"setRedshiftType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.redshiftType=e,e===mt.Z&&this.redshiftInput<0&&(this.redshiftInput=0)}}}),nt=Object(F.a)(Re.prototype,"setRedshiftInput",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{isFinite(e)&&(this.redshiftInput=e)}}}),Object(F.a)(Re.prototype,"setQueryResultTableRef",[M.g],Object.getOwnPropertyDescriptor(Re.prototype,"setQueryResultTableRef"),Re.prototype),rt=Object(F.a)(Re.prototype,"selectAllLines",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.isLineSelectedArray&&this.isLineSelectedArray.length>0){const e=this.isSelectingAllLines;for(let t=0;t<this.isLineSelectedArray.length;t++)this.isLineSelectedArray[t]=!e}}}}),ot=Object(F.a)(Re.prototype,"selectSingleLine",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isLineSelectedArray&&this.isLineSelectedArray.length>0&&isFinite(e)&&e>=0&&e<this.isLineSelectedArray.length&&(this.isLineSelectedArray[e]=!this.isLineSelectedArray[e])}}}),st=Object(F.a)(Re.prototype,"setSelectedSpectralProfiler",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedSpectralProfilerID=e}}}),at=Object(F.a)(Re.prototype,"query",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e=0,t=0;this.queryRangeType===ht.Range?(e=this.queryRange[0],t=this.queryRange[1]):(e=this.queryRangeByCenter[0]-this.queryRangeByCenter[1],t=this.queryRangeByCenter[0]+this.queryRangeByCenter[1]);const i=this.calculateFreqMHz(e,this.queryUnit),n=this.calculateFreqMHz(t,this.queryUnit);if(!isFinite(i)||!isFinite(n)||i<0||n<0)we.e.Instance.alertStore.showAlert("Invalid frequency range.");else if(i===n)we.e.Instance.alertStore.showAlert("Please specify a frequency range.");else if(Math.abs(n-i)>2e4)we.e.Instance.alertStore.showAlert(`Frequency range ${i<=n?i:n} MHz to ${i<=n?n:i} MHz is too wide.Please specify a frequency range within 20 GHz.`);else{this.isQuerying=!0;lt.b.Instance.requestSpectralLine(new Te.a.DoubleBounds({min:i,max:n}),this.intensityLimitEnabled?this.intensityLimitValue:NaN).subscribe((e=>{this.isQuerying=!1,e.success&&e.dataSize>=0?(e.dataSize>0?(this.numDataRows=e.dataSize,this.isLineSelectedArray=new Array(this.numDataRows).fill(!1),this.queryResult=dt.ProtobufProcessing.ProcessCatalogData(e.spectralLineData),this.restFreqColumn=this.queryResult.get(3),this.measuredFreqColumn=this.queryResult.get(5)):(this.numDataRows=0,this.isLineSelectedArray=[],this.queryResult=new Map,this.restFreqColumn=void 0,this.measuredFreqColumn=void 0),e.headers.forEach((e=>{ft.has(e.name)&&(e.name=ft.get(e.name))})),this.columnHeaders=e.headers.sort(((e,t)=>e.columnIndex-t.columnIndex))):we.e.Instance.alertStore.showAlert(e.message)}),(e=>{this.isQuerying=!1,console.error(e),we.e.Instance.alertStore.showAlert(e)}))}}}}),Object(F.a)(Re.prototype,"clearData",[M.g],Object.getOwnPropertyDescriptor(Re.prototype,"clearData"),Re.prototype),Object(F.a)(Re.prototype,"formalizedHeaders",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"formalizedHeaders"),Re.prototype),Object(F.a)(Re.prototype,"redshiftFactor",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"redshiftFactor"),Re.prototype),Object(F.a)(Re.prototype,"displayedColumnHeaders",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"displayedColumnHeaders"),Re.prototype),Object(F.a)(Re.prototype,"isSelectingAllLines",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"isSelectingAllLines"),Re.prototype),Object(F.a)(Re.prototype,"isSelectingIndeterminatedLines",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"isSelectingIndeterminatedLines"),Re.prototype),Object(F.a)(Re.prototype,"manualSelectionData",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"manualSelectionData"),Re.prototype),Object(F.a)(Re.prototype,"selectedLines",[M.i],Object.getOwnPropertyDescriptor(Re.prototype,"selectedLines"),Re.prototype),Re);var Ot,jt,St,xt,Ct,It,wt,Tt,vt,At,Rt,Pt,Et,Ft,Mt,kt,Dt,Nt,Lt,_t,zt,Wt,Gt,Vt,Bt,Ht,qt,Yt,Ut,Xt,$t,Kt,Qt,Zt,Jt,ei,ti,ii,ni,ri,oi,si,ai,li,ci,di,ui,hi,pi,gi,fi,bi,mi,yi,Oi,ji,Si,xi,Ci,Ii,wi,Ti,vi,Ai,Ri,Pi,Ei=i(123);let Fi;!function(e){e[e.NONE=1]="NONE",e[e.CHANNEL=2]="CHANNEL",e[e.MASK=3]="MASK"}(Fi||(Fi={}));let Mi=(Pi=Ri=class extends ct.c{static StatsTypeString(e){switch(e){case Te.a.StatsType.Sum:return"Sum";case Te.a.StatsType.FluxDensity:return"FluxDensity";case Te.a.StatsType.Mean:return"Mean";case Te.a.StatsType.Sigma:return"StdDev";case Te.a.StatsType.Min:return"Min";case Te.a.StatsType.Max:return"Max";case Te.a.StatsType.Extrema:return"Extrema";case Te.a.StatsType.RMS:return"RMS";case Te.a.StatsType.SumSq:return"SumSq";default:return"Not Implemented"}}constructor(e="z"){super(ct.d.CLOSED_AND_POINT),Object(E.a)(this,"coordinate",jt,this),Object(E.a)(this,"statsType",St,this),Object(E.a)(this,"minX",xt,this),Object(E.a)(this,"maxX",Ct,this),Object(E.a)(this,"minY",It,this),Object(E.a)(this,"maxY",wt,this),Object(E.a)(this,"cursorX",Tt,this),Object(E.a)(this,"channel",vt,this),Object(E.a)(this,"markerTextVisible",At,this),Object(E.a)(this,"isMouseMoveIntoLinePlots",Rt,this),Object(E.a)(this,"isStreamingData",Pt,this),Object(E.a)(this,"isHighlighted",Et,this),Object(E.a)(this,"spectralLinesMHz",Ft,this),Object(E.a)(this,"plotType",Mt,this),Object(E.a)(this,"meanRmsVisible",kt,this),Object(E.a)(this,"primaryLineColor",Dt,this),Object(E.a)(this,"lineWidth",Nt,this),Object(E.a)(this,"linePlotPointSize",Lt,this),Object(E.a)(this,"linePlotInitXYBoundaries",_t,this),this.smoothingStore=void 0,Object(E.a)(this,"settingsTabId",zt,this),Object(E.a)(this,"selectingMode",Wt,this),Object(E.a)(this,"channelValueRange",Gt,this),Object(E.a)(this,"momentMask",Vt,this),Object(E.a)(this,"maskRange",Bt,this),Object(E.a)(this,"selectedMoments",Ht,this),Object(E.a)(this,"setRegionId",qt,this),Object(E.a)(this,"setStatsType",Yt,this),Object(E.a)(this,"setCoordinate",Ut,this),Object(E.a)(this,"setSpectralCoordinate",Xt,this),Object(E.a)(this,"setSpectralSystem",$t,this),Object(E.a)(this,"setMomentRangeSelectingMode",Kt,this),Object(E.a)(this,"clearMomentRangeSelectingMode",Qt,this),Object(E.a)(this,"setSelectedChannelRange",Zt,this),Object(E.a)(this,"setSelectedMaskRange",Jt,this),Object(E.a)(this,"updateRanges",ei,this),Object(E.a)(this,"setMomentMask",ti,this),Object(E.a)(this,"selectMoment",ii,this),Object(E.a)(this,"deselectMoment",ni,this),Object(E.a)(this,"removeMomentByIndex",ri,this),Object(E.a)(this,"clearSelectedMoments",oi,this),Object(E.a)(this,"isMomentSelected",si,this),Object(E.a)(this,"requestMoment",ai,this),Object(E.a)(this,"requestingMomentCancelled",li,this),Object(E.a)(this,"setHighlighted",ci,this),Object(E.a)(this,"addSpectralLines",di,this),Object(E.a)(this,"clearSpectralLines",ui,this),Object(E.a)(this,"setXBounds",hi,this),Object(E.a)(this,"clearXBounds",pi,this),Object(E.a)(this,"setYBounds",gi,this),Object(E.a)(this,"clearYBounds",fi,this),Object(E.a)(this,"setXYBounds",bi,this),Object(E.a)(this,"clearXYBounds",mi,this),Object(E.a)(this,"setMarkerTextVisible",yi,this),Object(E.a)(this,"setMeanRmsVisible",Oi,this),Object(E.a)(this,"setPlotType",ji,this),Object(E.a)(this,"setChannel",Si,this),Object(E.a)(this,"setCursor",xi,this),Object(E.a)(this,"setMouseMoveIntoLinePlots",Ci,this),Object(E.a)(this,"updateStreamingDataStatus",Ii,this),Object(E.a)(this,"setSettingsTabId",wi,this),Object(E.a)(this,"setPrimaryLineColor",Ti,this),Object(E.a)(this,"setLineWidth",vi,this),Object(E.a)(this,"setLinePlotPointSize",Ai,this),this.init=e=>{if(!e)return;const t=N()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=L.i.MIN_WIDTH&&e.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=L.i.MIN_POINT_SIZE&&e.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.meanRmsVisible&&(this.meanRmsVisible=e.meanRmsVisible),"string"!==typeof e.plotType||e.plotType!==L.j.STEPS&&e.plotType!==L.j.LINES&&e.plotType!==L.j.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,meanRmsVisible:this.meanRmsVisible,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(M.p)(this),this.coordinate=e,this.statsType=Te.a.StatsType.Mean,this.isStreamingData=!1,this.isHighlighted=!1,this.spectralLinesMHz=[],this.plotType=L.j.STEPS,this.meanRmsVisible=!1,this.markerTextVisible=!1,this.primaryLineColor={colorHex:k.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0},this.smoothingStore=new Ei.a,this.selectingMode=Fi.NONE,this.channelValueRange=[0,0],this.momentMask=Te.a.MomentMask.None,this.maskRange=[0,1],this.selectedMoments=[Te.a.Moment.INTEGRATED_OF_THE_SPECTRUM],this.settingsTabId=ve.B.CONVERSION,Object(M.h)((()=>{this.effectiveFrame&&this.updateRanges()}))}get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}get isSelectingMomentChannelRange(){return this.selectingMode===Fi.CHANNEL}get isSelectingMomentMaskRange(){return this.selectingMode===Fi.MASK}get selectedRange(){return this.isSelectingMomentChannelRange?{isHorizontal:!1,center:(this.channelValueRange[0]+this.channelValueRange[1])/2,width:Math.abs(this.channelValueRange[0]-this.channelValueRange[1])}:this.isSelectingMomentMaskRange?{isHorizontal:!0,center:(this.maskRange[0]+this.maskRange[1])/2,width:Math.abs(this.maskRange[0]-this.maskRange[1])}:null}get transformedSpectralLines(){let e=[];const t=this.effectiveFrame;return t&&this.spectralLinesMHz&&this.spectralLinesMHz.forEach((i=>{const n=t.convertFreqMHzToSettingWCS(i.value);isFinite(n)&&e.push({species:i.species,value:n,qn:i.qn})})),e}static CalculateRequirementsMap(e){const t=new Map;return e.forEach((e=>{const i=e.effectiveFrame;if(!i||!i.regionSet)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=e.coordinate;let s=e.statsType;const a=i.regionSet.regions.find((e=>e.regionId===r));if(a){a.regionType===Te.a.RegionType.POINT&&(s=Te.a.StatsType.Sum);let e=t.get(n);e||(e=new Map,t.set(n,e));let i=e.get(r);i||(i=new Te.a.SetSpectralRequirements({regionId:r,fileId:n}),e.set(r,i)),i.spectralProfiles||(i.spectralProfiles=[]);let l=i.spectralProfiles.find((e=>e.coordinate===o));l?-1===l.statsTypes.indexOf(s)&&l.statsTypes.push(s):i.spectralProfiles.push({coordinate:o,statsTypes:[s]})}})),t}static DiffSpectralRequirements(e,t){const i=[];return e.forEach(((e,i)=>{let n=t.get(i);n||(n=new Map,t.set(i,n)),e.forEach(((e,t)=>{let r=n.get(t);r||(r=new Te.a.SetSpectralRequirements({fileId:i,regionId:t,spectralProfiles:[]}),n.set(t,r))}))})),t.forEach(((t,n)=>{let r=e.get(n);r?t.forEach(((e,t)=>{let n=r.get(t);if(n){const t=n.spectralProfiles?n.spectralProfiles.length:0,r=e.spectralProfiles?e.spectralProfiles.length:0;if(t!==r)return void i.push(e);if(0===t)return;const o=e.spectralProfiles.sort(((e,t)=>e.coordinate>t.coordinate?1:-1)),s=n.spectralProfiles.sort(((e,t)=>e.coordinate>t.coordinate?1:-1));for(let n=0;n<r;n++){const t=o[n],r=s[n];if(t.coordinate!==r.coordinate)return void i.push(e);const a=r.statsTypes?r.statsTypes.length:0,l=t.statsTypes?t.statsTypes.length:0;if(a!==l)return void i.push(e);if(0===a)return;const c=t.statsTypes.sort(),d=r.statsTypes.sort();for(let n=0;n<l;n++)if(c[n]!==d[n])return void i.push(e)}}else i.push(e)})):t.forEach((e=>i.push(e)))})),i.sort(((e,t)=>e.spectralProfiles.length>t.spectralProfiles.length?1:-1))}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ri.ValidCoordinates=["z","Iz","Qz","Uz","Vz"],Ri.ValidStatsTypes=[Te.a.StatsType.Sum,Te.a.StatsType.FluxDensity,Te.a.StatsType.Mean,Te.a.StatsType.Sigma,Te.a.StatsType.Min,Te.a.StatsType.Max,Te.a.StatsType.Extrema,Te.a.StatsType.RMS,Te.a.StatsType.SumSq],Ot=Pi,jt=Object(F.a)(Ot.prototype,"coordinate",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=Object(F.a)(Ot.prototype,"statsType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Object(F.a)(Ot.prototype,"minX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ct=Object(F.a)(Ot.prototype,"maxX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=Object(F.a)(Ot.prototype,"minY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=Object(F.a)(Ot.prototype,"maxY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=Object(F.a)(Ot.prototype,"cursorX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Object(F.a)(Ot.prototype,"channel",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Object(F.a)(Ot.prototype,"markerTextVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=Object(F.a)(Ot.prototype,"isMouseMoveIntoLinePlots",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=Object(F.a)(Ot.prototype,"isStreamingData",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=Object(F.a)(Ot.prototype,"isHighlighted",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=Object(F.a)(Ot.prototype,"spectralLinesMHz",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=Object(F.a)(Ot.prototype,"plotType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=Object(F.a)(Ot.prototype,"meanRmsVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=Object(F.a)(Ot.prototype,"primaryLineColor",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(F.a)(Ot.prototype,"lineWidth",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=Object(F.a)(Ot.prototype,"linePlotPointSize",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=Object(F.a)(Ot.prototype,"linePlotInitXYBoundaries",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=Object(F.a)(Ot.prototype,"settingsTabId",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=Object(F.a)(Ot.prototype,"selectingMode",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=Object(F.a)(Ot.prototype,"channelValueRange",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=Object(F.a)(Ot.prototype,"momentMask",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt=Object(F.a)(Ot.prototype,"maskRange",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=Object(F.a)(Ot.prototype,"selectedMoments",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Object(F.a)(Ot.prototype,"setRegionId",[M.r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.regionIdMap.set(e,t),this.clearXYBounds()}}}),Yt=Object(F.a)(Ot.prototype,"setStatsType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==Mi.ValidStatsTypes.indexOf(e)&&(this.statsType=e)}}}),Ut=Object(F.a)(Ot.prototype,"setCoordinate",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==Mi.ValidCoordinates.indexOf(e)&&(this.clearXYBounds(),this.coordinate=e)}}}),Xt=Object(F.a)(Ot.prototype,"setSpectralCoordinate",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;if(t&&t.spectralCoordsSupported&&t.spectralCoordsSupported.has(e)){const i=t.spectralCoordsSupported.get(e);t.spectralType=i.type,t.spectralUnit=i.unit,this.clearXBounds()}}}}),$t=Object(F.a)(Ot.prototype,"setSpectralSystem",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;t&&t.spectralSystemsSupported&&t.spectralSystemsSupported.includes(e)&&(t.spectralSystem=e,this.clearXBounds())}}}),Kt=Object(F.a)(Ot.prototype,"setMomentRangeSelectingMode",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.selectingMode=e)}}}),Qt=Object(F.a)(Ot.prototype,"clearMomentRangeSelectingMode",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectingMode=Fi.NONE}}}),Zt=Object(F.a)(Ot.prototype,"setSelectedChannelRange",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{isFinite(e)&&isFinite(t)&&(this.channelValueRange[0]=e,this.channelValueRange[1]=t),this.selectingMode=Fi.NONE}}}),Jt=Object(F.a)(Ot.prototype,"setSelectedMaskRange",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{isFinite(e)&&isFinite(t)&&(this.maskRange[0]=e,this.maskRange[1]=t),this.selectingMode=Fi.NONE}}}),ei=Object(F.a)(Ot.prototype,"updateRanges",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&e.channelValueBounds&&(this.channelValueRange[0]=e.channelValueBounds.min,this.channelValueRange[1]=e.channelValueBounds.max,this.maskRange[0]=0,this.maskRange[1]=1)}}}),ti=Object(F.a)(Ot.prototype,"setMomentMask",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.momentMask=e}}}),ii=Object(F.a)(Ot.prototype,"selectMoment",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedMoments.includes(e)||this.selectedMoments.push(e)}}}),ni=Object(F.a)(Ot.prototype,"deselectMoment",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedMoments.includes(e)&&(this.selectedMoments=this.selectedMoments.filter((t=>t!==e)))}}}),ri=Object(F.a)(Ot.prototype,"removeMomentByIndex",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=0&&e<this.selectedMoments.length&&(this.selectedMoments=this.selectedMoments.filter(((t,i)=>i!==e)))}}}),oi=Object(F.a)(Ot.prototype,"clearSelectedMoments",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedMoments=[]}}}),si=Object(F.a)(Ot.prototype,"isMomentSelected",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>this.selectedMoments.includes(e)}}),ai=Object(F.a)(Ot.prototype,"requestMoment",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame,t=e.findChannelIndexByValue(this.channelValueRange[0]),i=e.findChannelIndexByValue(this.channelValueRange[1]);if(e&&isFinite(t)&&isFinite(i)){const n={min:t<=i?t:i,max:t<=i?i:t},r={fileId:e.frameInfo.fileId,moments:this.selectedMoments,axis:Te.a.MomentAxis.SPECTRAL,regionId:this.fileId===ct.a&&0===this.effectiveRegionId?-1:this.effectiveRegionId,spectralRange:n,mask:this.momentMask,pixelRange:new Te.a.FloatBounds({min:this.maskRange[0],max:this.maskRange[1]})};e.resetMomentRequestState(),e.setIsRequestingMoments(!0),we.e.Instance.requestMoment(r,e)}}}}),li=Object(F.a)(Ot.prototype,"requestingMomentCancelled",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=this.effectiveFrame;e&&we.e.Instance.cancelRequestingMoment(e.frameInfo.fileId)}}}),ci=Object(F.a)(Ot.prototype,"setHighlighted",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isHighlighted=e}}}),di=Object(F.a)(Ot.prototype,"addSpectralLines",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.spectralLinesMHz=e)}}}),ui=Object(F.a)(Ot.prototype,"clearSpectralLines",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralLinesMHz=[]}}}),hi=Object(F.a)(Ot.prototype,"setXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),pi=Object(F.a)(Ot.prototype,"clearXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),gi=Object(F.a)(Ot.prototype,"setYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),fi=Object(F.a)(Ot.prototype,"clearYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),bi=Object(F.a)(Ot.prototype,"setXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),mi=Object(F.a)(Ot.prototype,"clearXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),yi=Object(F.a)(Ot.prototype,"setMarkerTextVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.markerTextVisible=e}}}),Oi=Object(F.a)(Ot.prototype,"setMeanRmsVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),ji=Object(F.a)(Ot.prototype,"setPlotType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),Si=Object(F.a)(Ot.prototype,"setChannel",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channel=e}}}),xi=Object(F.a)(Ot.prototype,"setCursor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Ci=Object(F.a)(Ot.prototype,"setMouseMoveIntoLinePlots",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),Ii=Object(F.a)(Ot.prototype,"updateStreamingDataStatus",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isStreamingData=e}}}),wi=Object(F.a)(Ot.prototype,"setSettingsTabId",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(F.a)(Ot.prototype,"isAutoScaledX",[M.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isAutoScaledX"),Ot.prototype),Object(F.a)(Ot.prototype,"isAutoScaledY",[M.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isAutoScaledY"),Ot.prototype),Object(F.a)(Ot.prototype,"isSelectingMomentChannelRange",[M.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isSelectingMomentChannelRange"),Ot.prototype),Object(F.a)(Ot.prototype,"isSelectingMomentMaskRange",[M.i],Object.getOwnPropertyDescriptor(Ot.prototype,"isSelectingMomentMaskRange"),Ot.prototype),Object(F.a)(Ot.prototype,"selectedRange",[M.i],Object.getOwnPropertyDescriptor(Ot.prototype,"selectedRange"),Ot.prototype),Object(F.a)(Ot.prototype,"transformedSpectralLines",[M.i],Object.getOwnPropertyDescriptor(Ot.prototype,"transformedSpectralLines"),Ot.prototype),Ti=Object(F.a)(Ot.prototype,"setPrimaryLineColor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),vi=Object(F.a)(Ot.prototype,"setLineWidth",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),Ai=Object(F.a)(Ot.prototype,"setLinePlotPointSize",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),Object(F.a)(Ot.prototype,"initXYBoundaries",[M.g],Object.getOwnPropertyDescriptor(Ot.prototype,"initXYBoundaries"),Ot.prototype),Ot);class ki extends ct.c{constructor(){super(ct.d.CLOSED)}static DiffRequirementsArray(e,t){const i=[];return e.forEach(((e,n)=>{const r=t.get(n);if(r){for(const t of e)-1===r.indexOf(t)&&i.push(Te.a.SetStatsRequirements.create({fileId:n,regionId:t,stats:[]}));for(const t of r)-1===e.indexOf(t)&&i.push(Te.a.SetStatsRequirements.create({fileId:n,regionId:t,stats:we.e.DEFAULT_STATS_TYPES}))}else for(const t of e)i.push(Te.a.SetStatsRequirements.create({fileId:n,regionId:t,stats:[]}))})),t.forEach(((t,n)=>{if(!e.get(n))for(const e of t)i.push(Te.a.SetStatsRequirements.create({fileId:n,regionId:e,stats:we.e.DEFAULT_STATS_TYPES}))})),i}}var Di,Ni,Li,_i,zi,Wi,Gi,Vi,Bi,Hi,qi,Yi,Ui,Xi,$i,Ki,Qi,Zi,Ji,en,tn,nn,rn,on,sn,an;let ln=(Di=class extends ct.c{get isAutoScaledX(){return void 0===this.minX||void 0===this.maxX}get isAutoScaledY(){return void 0===this.minY||void 0===this.maxY}static DiffRequirementsArray(e,t){const i=[];return e.forEach(((e,n)=>{const r=t.get(n);if(r){for(const t of e)-1===r.indexOf(t)&&i.push({fileId:n,regionId:t,histograms:[]});for(const t of r)-1===e.indexOf(t)&&i.push({fileId:n,regionId:t,histograms:[{channel:-1,numBins:-1}]})}else for(const t of e)i.push({fileId:n,regionId:t,histograms:[]})})),t.forEach(((t,n)=>{if(!e.get(n))for(const e of t)i.push({fileId:n,regionId:e,histograms:[{channel:-1,numBins:-1}]})})),i}constructor(){super(ct.d.CLOSED),Object(E.a)(this,"minX",Ni,this),Object(E.a)(this,"maxX",Li,this),Object(E.a)(this,"minY",_i,this),Object(E.a)(this,"maxY",zi,this),Object(E.a)(this,"cursorX",Wi,this),Object(E.a)(this,"logScaleY",Gi,this),Object(E.a)(this,"plotType",Vi,this),Object(E.a)(this,"primaryLineColor",Bi,this),Object(E.a)(this,"lineWidth",Hi,this),Object(E.a)(this,"linePlotPointSize",qi,this),Object(E.a)(this,"meanRmsVisible",Yi,this),Object(E.a)(this,"linePlotInitXYBoundaries",Ui,this),Object(E.a)(this,"setXBounds",Xi,this),Object(E.a)(this,"clearXBounds",$i,this),Object(E.a)(this,"setYBounds",Ki,this),Object(E.a)(this,"clearYBounds",Qi,this),Object(E.a)(this,"setXYBounds",Zi,this),Object(E.a)(this,"clearXYBounds",Ji,this),Object(E.a)(this,"setLogScale",en,this),Object(E.a)(this,"setPlotType",tn,this),Object(E.a)(this,"setCursor",nn,this),Object(E.a)(this,"setPrimaryLineColor",rn,this),Object(E.a)(this,"setLineWidth",on,this),Object(E.a)(this,"setLinePlotPointSize",sn,this),Object(E.a)(this,"setMeanRmsVisible",an,this),this.init=e=>{if(!e)return;const t=N()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=L.i.MIN_WIDTH&&e.lineWidth<=L.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=L.i.MIN_POINT_SIZE&&e.linePlotPointSize<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"boolean"===typeof e.logScaleY&&(this.logScaleY=e.logScaleY),"string"!==typeof e.plotType||e.plotType!==L.j.STEPS&&e.plotType!==L.j.LINES&&e.plotType!==L.j.POINTS||(this.plotType=e.plotType),"number"===typeof e.minXVal&&(this.linePlotInitXYBoundaries.minXVal=e.minXVal),"number"===typeof e.maxXVal&&(this.linePlotInitXYBoundaries.maxXVal=e.maxXVal),"number"===typeof e.minYVal&&(this.linePlotInitXYBoundaries.minYVal=e.minYVal),"number"===typeof e.maxYVal&&(this.linePlotInitXYBoundaries.maxYVal=e.maxYVal)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,logScaleY:this.logScaleY,plotType:this.plotType,minXVal:this.linePlotInitXYBoundaries.minXVal,maxXVal:this.linePlotInitXYBoundaries.maxXVal,minYVal:this.linePlotInitXYBoundaries.minYVal,maxYVal:this.linePlotInitXYBoundaries.maxYVal}),Object(M.p)(this),this.logScaleY=!0,this.plotType=L.j.STEPS,this.primaryLineColor={colorHex:k.a.BLUE2,fixed:!1},this.linePlotPointSize=1.5,this.lineWidth=1,this.linePlotInitXYBoundaries={minXVal:0,maxXVal:0,minYVal:0,maxYVal:0}}initXYBoundaries(e,t,i,n){this.linePlotInitXYBoundaries={minXVal:e,maxXVal:t,minYVal:i,maxYVal:n}}},Ni=Object(F.a)(Di.prototype,"minX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Li=Object(F.a)(Di.prototype,"maxX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i=Object(F.a)(Di.prototype,"minY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zi=Object(F.a)(Di.prototype,"maxY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wi=Object(F.a)(Di.prototype,"cursorX",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gi=Object(F.a)(Di.prototype,"logScaleY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vi=Object(F.a)(Di.prototype,"plotType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=Object(F.a)(Di.prototype,"primaryLineColor",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi=Object(F.a)(Di.prototype,"lineWidth",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qi=Object(F.a)(Di.prototype,"linePlotPointSize",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yi=Object(F.a)(Di.prototype,"meanRmsVisible",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ui=Object(F.a)(Di.prototype,"linePlotInitXYBoundaries",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=Object(F.a)(Di.prototype,"setXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minX=e,this.maxX=t}}}),$i=Object(F.a)(Di.prototype,"clearXBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Ki=Object(F.a)(Di.prototype,"setYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.minY=e,this.maxY=t}}}),Qi=Object(F.a)(Di.prototype,"clearYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0}}}),Zi=Object(F.a)(Di.prototype,"setXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.minX=e,this.maxX=t,this.minY=i,this.maxY=n}}}),Ji=Object(F.a)(Di.prototype,"clearXYBounds",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.minX=void 0,this.maxX=void 0,this.minY=void 0,this.maxY=void 0}}}),en=Object(F.a)(Di.prototype,"setLogScale",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.logScaleY=e}}}),tn=Object(F.a)(Di.prototype,"setPlotType",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),nn=Object(F.a)(Di.prototype,"setCursor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.cursorX=e}}}),Object(F.a)(Di.prototype,"isAutoScaledX",[M.i],Object.getOwnPropertyDescriptor(Di.prototype,"isAutoScaledX"),Di.prototype),Object(F.a)(Di.prototype,"isAutoScaledY",[M.i],Object.getOwnPropertyDescriptor(Di.prototype,"isAutoScaledY"),Di.prototype),rn=Object(F.a)(Di.prototype,"setPrimaryLineColor",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),on=Object(F.a)(Di.prototype,"setLineWidth",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_WIDTH&&e<=L.i.MAX_WIDTH&&(this.lineWidth=e)}}}),sn=Object(F.a)(Di.prototype,"setLinePlotPointSize",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=L.i.MIN_POINT_SIZE&&e<=L.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),an=Object(F.a)(Di.prototype,"setMeanRmsVisible",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.meanRmsVisible=e}}}),Object(F.a)(Di.prototype,"initXYBoundaries",[M.g],Object.getOwnPropertyDescriptor(Di.prototype,"initXYBoundaries"),Di.prototype),Di);class cn{}var dn,un,hn,pn,gn,fn,bn,mn,yn,On,jn,Sn,xn,Cn,In,wn,Tn,vn,An=i(144),Rn=i(145);let Pn,En,Fn;!function(e){e.ImageOverlay="Image Overlay",e.Histogram="Histogram",e.D2Scatter="2D Scatter"}(Pn||(Pn={})),function(e){e.Circle="circle-open",e.FullCircle="circle",e.Star="star-open",e.FullStar="star",e.Square="square-open",e.Plus="cross-thin-open",e.Cross="x-thin-open",e.TriangleUp="triangle-up-open",e.TriangleDown="triangle-down-open",e.Diamond="diamond-open",e.hexagon2="hexagon2-open",e.hexagon="hexagon-open"}(En||(En={})),function(e){e[e.GLOBAL=0]="GLOBAL",e[e.IMAGE_OVERLAY=1]="IMAGE_OVERLAY",e[e.COLOR=2]="COLOR"}(Fn||(Fn={}));const Mn={headerTableColumnWidts:[150,75,65,100,230],showSelectedData:!1,catalogTableAutoScroll:!1,catalogPlotType:Pn.ImageOverlay,catalogColor:k.a.TURQUOISE3,catalogSize:10,catalogShape:En.Circle,xAxis:Rn.a.NONE,yAxis:Rn.a.NONE,highlightColor:k.a.RED2,settingsTabId:Fn.GLOBAL};let kn=(vn=Tn=class e{constructor(t){Object(E.a)(this,"catalogFileId",un,this),Object(E.a)(this,"headerTableColumnWidts",hn,this),Object(E.a)(this,"dataTableColumnWidts",pn,this),Object(E.a)(this,"showSelectedData",gn,this),Object(E.a)(this,"catalogTableAutoScroll",fn,this),Object(E.a)(this,"catalogPlotType",bn,this),Object(E.a)(this,"catalogSize",mn,this),Object(E.a)(this,"catalogColor",yn,this),Object(E.a)(this,"catalogShape",On,this),Object(E.a)(this,"xAxis",jn,this),Object(E.a)(this,"yAxis",Sn,this),Object(E.a)(this,"tableSeparatorPosition",xn,this),Object(E.a)(this,"highlightColor",Cn,this),Object(E.a)(this,"settingsTabId",In,this),Object(E.a)(this,"setSettingsTabId",wn,this),this.init=t=>{if(!t)return;const i=t.catalogFileId;"number"===typeof i&&i>0&&(this.catalogFileId=i);const n=t.catalogSize;"number"===typeof n&&n>=e.MinOverlaySize&&n<=e.MaxOverlaySize&&(this.catalogSize=n),this.catalogShape=t.catalogShape,this.catalogColor=t.catalogColor,this.highlightColor=t.highlightColor,this.tableSeparatorPosition=t.tableSeparatorPosition},this.toConfig=()=>({catalogFileId:this.catalogFileId,catalogColor:this.catalogColor,highlightColor:this.highlightColor,catalogSize:this.catalogSize,catalogShape:this.catalogShape,tableSeparatorPosition:this.tableSeparatorPosition}),Object(M.p)(this),this.catalogFileId=t,this.headerTableColumnWidts=Mn.headerTableColumnWidts,this.showSelectedData=Mn.showSelectedData,this.catalogTableAutoScroll=Mn.catalogTableAutoScroll,this.catalogPlotType=Mn.catalogPlotType,this.catalogColor=Mn.catalogColor,this.catalogSize=Mn.catalogSize,this.catalogShape=Mn.catalogShape,this.xAxis=Mn.xAxis,this.yAxis=Mn.yAxis,this.tableSeparatorPosition=we.H.Instance.catalogTableSeparatorPosition,this.highlightColor=Mn.highlightColor,this.settingsTabId=Mn.settingsTabId}setHeaderTableColumnWidts(e){this.headerTableColumnWidts=e}setDataTableColumnWidts(e){this.dataTableColumnWidts=e}setShowSelectedData(e){this.showSelectedData=e}setCatalogTableAutoScroll(e){this.catalogTableAutoScroll=e}setCatalogPlotType(e){this.catalogPlotType=e}setCatalogSize(e){this.catalogSize=e}setCatalogColor(e){this.catalogColor=e}setCatalogShape(e){this.catalogShape=e}setxAxis(e){this.xAxis=e}setyAxis(e){this.yAxis=e}setTableSeparatorPosition(e){this.tableSeparatorPosition=e}setHighlightColor(e){this.highlightColor=e}},Tn.MinOverlaySize=1,Tn.MaxOverlaySize=100,Tn.MinTableSeparatorPosition=5,Tn.MaxTableSeparatorPosition=95,dn=vn,un=Object(F.a)(dn.prototype,"catalogFileId",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=Object(F.a)(dn.prototype,"headerTableColumnWidts",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pn=Object(F.a)(dn.prototype,"dataTableColumnWidts",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gn=Object(F.a)(dn.prototype,"showSelectedData",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=Object(F.a)(dn.prototype,"catalogTableAutoScroll",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bn=Object(F.a)(dn.prototype,"catalogPlotType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=Object(F.a)(dn.prototype,"catalogSize",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(F.a)(dn.prototype,"catalogColor",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),On=Object(F.a)(dn.prototype,"catalogShape",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jn=Object(F.a)(dn.prototype,"xAxis",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=Object(F.a)(dn.prototype,"yAxis",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xn=Object(F.a)(dn.prototype,"tableSeparatorPosition",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=Object(F.a)(dn.prototype,"highlightColor",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=Object(F.a)(dn.prototype,"settingsTabId",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(F.a)(dn.prototype,"setHeaderTableColumnWidts",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setHeaderTableColumnWidts"),dn.prototype),Object(F.a)(dn.prototype,"setDataTableColumnWidts",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setDataTableColumnWidts"),dn.prototype),Object(F.a)(dn.prototype,"setShowSelectedData",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setShowSelectedData"),dn.prototype),Object(F.a)(dn.prototype,"setCatalogTableAutoScroll",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setCatalogTableAutoScroll"),dn.prototype),Object(F.a)(dn.prototype,"setCatalogPlotType",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setCatalogPlotType"),dn.prototype),Object(F.a)(dn.prototype,"setCatalogSize",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setCatalogSize"),dn.prototype),Object(F.a)(dn.prototype,"setCatalogColor",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setCatalogColor"),dn.prototype),Object(F.a)(dn.prototype,"setCatalogShape",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setCatalogShape"),dn.prototype),Object(F.a)(dn.prototype,"setxAxis",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setxAxis"),dn.prototype),Object(F.a)(dn.prototype,"setyAxis",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setyAxis"),dn.prototype),Object(F.a)(dn.prototype,"setTableSeparatorPosition",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setTableSeparatorPosition"),dn.prototype),Object(F.a)(dn.prototype,"setHighlightColor",[M.g],Object.getOwnPropertyDescriptor(dn.prototype,"setHighlightColor"),dn.prototype),wn=Object(F.a)(dn.prototype,"setSettingsTabId",[M.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),dn);var Dn,Nn,Ln,_n,zn,Wn,Gn,Vn,Bn,Hn;let qn=(Dn=class{constructor(e){Object(E.a)(this,"indicatorInfo",Nn,this),Object(E.a)(this,"scatterborder",Ln,this),Object(E.a)(this,"dragmode",_n,this),Object(E.a)(this,"plotType",zn,this),Object(E.a)(this,"histogramBorder",Wn,this),Object(E.a)(this,"logScaleY",Gn,this),Object(E.a)(this,"nBinx",Vn,this),Object(E.a)(this,"xColumnName",Bn,this),Object(E.a)(this,"yColumnName",Hn,this),Object(M.p)(this),this.indicatorInfo=void 0,this.dragmode="select",this.plotType=e.plotType,this.logScaleY=!0,this.scatterborder=void 0,this.histogramBorder=void 0,this.nBinx=void 0,this.xColumnName=e.xColumnName,this.yColumnName=e.yColumnName}setColumnX(e){this.xColumnName=e}setColumnY(e){this.yColumnName=e}setIndicator(e){this.indicatorInfo=e}setScatterborder(e){this.scatterborder=e}setHistogramXBorder(e){this.histogramBorder=e}setDragmode(e){this.dragmode=e}setLogScaleY(e){this.logScaleY=e}setNumBinsX(e){this.nBinx=e}get isScatterAutoScaled(){return void 0===this.scatterborder}get isHistogramAutoScaledX(){return void 0===this.histogramBorder}},Nn=Object(F.a)(Dn.prototype,"indicatorInfo",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Object(F.a)(Dn.prototype,"scatterborder",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Object(F.a)(Dn.prototype,"dragmode",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Object(F.a)(Dn.prototype,"plotType",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wn=Object(F.a)(Dn.prototype,"histogramBorder",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gn=Object(F.a)(Dn.prototype,"logScaleY",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vn=Object(F.a)(Dn.prototype,"nBinx",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bn=Object(F.a)(Dn.prototype,"xColumnName",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=Object(F.a)(Dn.prototype,"yColumnName",[M.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(F.a)(Dn.prototype,"setColumnX",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setColumnX"),Dn.prototype),Object(F.a)(Dn.prototype,"setColumnY",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setColumnY"),Dn.prototype),Object(F.a)(Dn.prototype,"setIndicator",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setIndicator"),Dn.prototype),Object(F.a)(Dn.prototype,"setScatterborder",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setScatterborder"),Dn.prototype),Object(F.a)(Dn.prototype,"setHistogramXBorder",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setHistogramXBorder"),Dn.prototype),Object(F.a)(Dn.prototype,"setDragmode",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setDragmode"),Dn.prototype),Object(F.a)(Dn.prototype,"setLogScaleY",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setLogScaleY"),Dn.prototype),Object(F.a)(Dn.prototype,"setNumBinsX",[M.g],Object.getOwnPropertyDescriptor(Dn.prototype,"setNumBinsX"),Dn.prototype),Object(F.a)(Dn.prototype,"isScatterAutoScaled",[M.i],Object.getOwnPropertyDescriptor(Dn.prototype,"isScatterAutoScaled"),Dn.prototype),Object(F.a)(Dn.prototype,"isHistogramAutoScaledX",[M.i],Object.getOwnPropertyDescriptor(Dn.prototype,"isHistogramAutoScaledX"),Dn.prototype),Dn)},123:function(e,t,i){"use strict";i.d(t,"a",(function(){return W}));var n,r,o,s,a,l,c,d,u,h,p,g,f,b,m,y,O,j,S,x,C,I,w,T,v,A,R,P,E,F,M,k=i(4),D=i(2),N=(i(28),i(1)),L=i(74),_=i(8),z=i(60);let W=(n=class{constructor(){Object(k.a)(this,"type",r,this),Object(k.a)(this,"lineColor",o,this),Object(k.a)(this,"selectedLine",s,this),Object(k.a)(this,"lineType",a,this),Object(k.a)(this,"lineWidth",l,this),Object(k.a)(this,"pointRadius",c,this),Object(k.a)(this,"isOverlayOn",d,this),Object(k.a)(this,"boxcarSize",u,this),Object(k.a)(this,"gaussianSigma",h,this),Object(k.a)(this,"hanningSize",p,this),Object(k.a)(this,"decimationWidth",g,this),Object(k.a)(this,"binWidth",f,this),Object(k.a)(this,"savitzkyGolaySize",b,this),Object(k.a)(this,"savitzkyGolayOrder",m,this),Object(k.a)(this,"colorMap",y,this),Object(k.a)(this,"setType",O,this),Object(k.a)(this,"setLineColor",j,this),Object(k.a)(this,"setSelectedLine",S,this),Object(k.a)(this,"setLineType",x,this),Object(k.a)(this,"setLineWidth",C,this),Object(k.a)(this,"setPointRadius",I,this),Object(k.a)(this,"setIsOverlayOn",w,this),Object(k.a)(this,"setBoxcarSize",T,this),Object(k.a)(this,"setGaussianSigma",v,this),Object(k.a)(this,"setHanningSize",A,this),Object(k.a)(this,"setDecimationWidth",R,this),Object(k.a)(this,"setBinWidth",P,this),Object(k.a)(this,"setSavitzkyGolaySize",E,this),Object(k.a)(this,"setSavitzkyGolayOrder",F,this),Object(k.a)(this,"setColorMap",M,this),Object(N.p)(this),this.type=_.t.NONE,this.lineColor={colorHex:L.a.ROSE3,fixed:!1},this.lineType=_.j.STEPS,this.lineWidth=1,this.pointRadius=1,this.isOverlayOn=!1,this.boxcarSize=2,this.gaussianSigma=1,this.hanningSize=3,this.decimationWidth=3,this.binWidth=2,this.savitzkyGolaySize=5,this.savitzkyGolayOrder=0,this.colorMap=new Map}get exportData(){let e=new Map;return e.set("smooth",this.type),this.type===_.t.BOXCAR?e.set("kernel",String(this.boxcarSize)):this.type===_.t.GAUSSIAN?e.set("sigma",String(this.gaussianSigma)):this.type===_.t.HANNING?e.set("kernel",String(this.hanningSize)):this.type===_.t.DECIMATION?e.set("decimation width",String(this.decimationWidth)):this.type===_.t.BINNING?e.set("bin width",String(this.binWidth)):this.type===_.t.SAVITZKY_GOLAY&&(e.set("kernel",String(this.savitzkyGolaySize)),e.set("order",String(this.savitzkyGolayOrder))),e}get comments(){let e=[];return this.exportData&&this.exportData.forEach(((t,i)=>{e.push(`${i}: ${t}`)})),e}get gaussianKernel(){if(this.gaussianSigma<3)return 3;const e=Math.ceil(this.gaussianSigma);return e%2===0?e+1:e}get gaussianAlpha(){return(this.gaussianKernel-1)/(2*this.gaussianSigma)}getLocalStartEndIndexes(e,t,i,n){let r,o;n%2===1?(r=(n-1)/2,o=(n-1)/2):(r=n/2-1,o=n/2);const s=t<r?t:r;return{startSmoothing:t<r?0:t-r,endSmoothing:i+o>e-1?e-1:i+o,smoothedStart:s,smoothedEnd:s+i-t}}getLocalGroupStartEndIndexes(e,t,i,n){let r=i%n===n-1?i:i-i%n+(n-1);return r>e-1&&(r=e-1),{firstIndex:t%n===0?t:t-t%n,lastIndex:r}}getSmoothingValues(e,t,i,n){let r,o=e;if(this.type===_.t.BOXCAR)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.boxcarSize),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=z.boxcarSmooth(a,this.boxcarSize).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.boxcarSmooth(t,this.boxcarSize);else if(this.type===_.t.GAUSSIAN){if(this.gaussianSigma&&this.gaussianSigma>=1)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.gaussianKernel),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=z.gaussianSmooth(a,this.gaussianKernel,this.gaussianAlpha).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.gaussianSmooth(t,this.gaussianKernel,this.gaussianAlpha)}else if(this.type===_.t.HANNING)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.hanningSize),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=z.hanningSmooth(a,this.hanningSize).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.hanningSmooth(t,this.hanningSize);else if(this.type===_.t.DECIMATION)if((i||0===n)&&n){const s=this.getLocalGroupStartEndIndexes(e.length,i,n,this.decimationWidth),a=t.subarray(s.firstIndex,s.lastIndex+1),l=e.slice(s.firstIndex,s.lastIndex+1);let c=z.decimation(l,a,this.decimationWidth);o=c.x,r=c.y}else{let i=z.decimation(e,t,this.decimationWidth);o=i.x,r=i.y}else if(this.type===_.t.BINNING)if((i||0===n)&&n){const s=this.getLocalGroupStartEndIndexes(e.length,i,n,this.binWidth),a=t.subarray(s.firstIndex,s.lastIndex+1),l=e.slice(s.firstIndex,s.lastIndex+1);o=z.binning(l,this.binWidth),r=z.binning(a,this.binWidth)}else o=z.binning(e,this.binWidth),r=z.binning(t,this.binWidth);else if(this.type===_.t.SAVITZKY_GOLAY)if((i||0===n)&&n){const s=this.getLocalStartEndIndexes(e.length,i,n,this.savitzkyGolaySize),a=t.subarray(s.startSmoothing,s.endSmoothing+1);r=z.savitzkyGolaySmooth(e,a,this.savitzkyGolaySize,this.savitzkyGolayOrder).subarray(s.smoothedStart,s.smoothedEnd+1),o=e.slice(i,n+1)}else r=z.savitzkyGolaySmooth(e,t,this.savitzkyGolaySize,this.savitzkyGolayOrder);return{x:o,y:r}}getSmoothingPoint2DArray(e,t,i,n){if(this.type===_.t.NONE)return[];const r=this.getSmoothingValues(e,t,i,n);let o=new Array(r.x.length);for(let s=0;s<r.x.length;s++)o[s]={x:r.x[s],y:r.y[s]};return o}getDecimatedPoint2DArray(e,t,i,n,r){if(!e||!t||e.length!==t.length)return[];let o;if((n||0===r)&&r){const s=this.getLocalGroupStartEndIndexes(e.length,n,r,i),a=t.subarray(s.firstIndex,s.lastIndex+1),l=e.slice(s.firstIndex,s.lastIndex+1);o=z.decimation(l,a,i)}else o=z.decimation(e,t,i);let s=new Array(o.x.length);for(let a=0;a<o.x.length;a++)s[a]={x:o.x[a],y:o.y[a]};return s}},r=Object(D.a)(n.prototype,"type",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(D.a)(n.prototype,"lineColor",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(D.a)(n.prototype,"selectedLine",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(D.a)(n.prototype,"lineType",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(D.a)(n.prototype,"lineWidth",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(D.a)(n.prototype,"pointRadius",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(D.a)(n.prototype,"isOverlayOn",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(D.a)(n.prototype,"boxcarSize",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(D.a)(n.prototype,"gaussianSigma",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(D.a)(n.prototype,"hanningSize",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(D.a)(n.prototype,"decimationWidth",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(D.a)(n.prototype,"binWidth",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(D.a)(n.prototype,"savitzkyGolaySize",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(D.a)(n.prototype,"savitzkyGolayOrder",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(D.a)(n.prototype,"colorMap",[N.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(D.a)(n.prototype,"setType",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.type=e}}}),j=Object(D.a)(n.prototype,"setLineColor",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.lineColor={colorHex:e,fixed:t}}}}),S=Object(D.a)(n.prototype,"setSelectedLine",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedLine=e}}}),x=Object(D.a)(n.prototype,"setLineType",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineType=e}}}),C=Object(D.a)(n.prototype,"setLineWidth",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=_.i.MIN_WIDTH&&e<=_.i.MAX_WIDTH&&(this.lineWidth=e)}}}),I=Object(D.a)(n.prototype,"setPointRadius",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=_.i.MIN_POINT_SIZE&&e<=_.i.MAX_POINT_SIZE&&(this.pointRadius=e)}}}),w=Object(D.a)(n.prototype,"setIsOverlayOn",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isOverlayOn=e}}}),T=Object(D.a)(n.prototype,"setBoxcarSize",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.boxcarSize=e}}}),v=Object(D.a)(n.prototype,"setGaussianSigma",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.gaussianSigma=e}}}),A=Object(D.a)(n.prototype,"setHanningSize",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.hanningSize=e}}}),R=Object(D.a)(n.prototype,"setDecimationWidth",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.decimationWidth=e}}}),P=Object(D.a)(n.prototype,"setBinWidth",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.binWidth=e}}}),E=Object(D.a)(n.prototype,"setSavitzkyGolaySize",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.savitzkyGolaySize=e}}}),F=Object(D.a)(n.prototype,"setSavitzkyGolayOrder",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.savitzkyGolayOrder=e}}}),M=Object(D.a)(n.prototype,"setColorMap",[N.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.colorMap.set(e,t)}}}),Object(D.a)(n.prototype,"exportData",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"exportData"),n.prototype),Object(D.a)(n.prototype,"comments",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"comments"),n.prototype),Object(D.a)(n.prototype,"gaussianKernel",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"gaussianKernel"),n.prototype),Object(D.a)(n.prototype,"gaussianAlpha",[N.i],Object.getOwnPropertyDescriptor(n.prototype,"gaussianAlpha"),n.prototype),n)},124:function(e,t,i){(function(t,n){var r="undefined"!==typeof r?r:{};r.locateFile=function(e,t){return"./"+e};var o,s={};for(o in r)r.hasOwnProperty(o)&&(s[o]=r[o]);var a=[],l=!1,c=!1,d=!1,u=!1;l="object"===typeof window,c="function"===typeof importScripts,d="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,u=!l&&!d&&!c;var h,p,g,f,b,m="";function y(e){return r.locateFile?r.locateFile(e,m):m+e}d?(m=c?i(113).dirname(m)+"/":n+"/",h=function(e,t){return f||(f=i(191)),b||(b=i(113)),e=b.normalize(e),f.readFileSync(e,t?null:"utf8")},g=function(e){var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),C(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),a=t.argv.slice(2),e.exports=r,t.on("uncaughtException",(function(e){if(!(e instanceof Se))throw e})),t.on("unhandledRejection",ee),function(e){t.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(h=function(e){return read(e)}),g=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(C("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?a=scriptArgs:"undefined"!=typeof arguments&&(a=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(l||c)&&(c?m=self.location.href:"undefined"!==typeof document&&document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),p=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});r.print||console.log.bind(console);var O,j=r.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(r[o]=s[o]);s=null,r.arguments&&(a=r.arguments),r.thisProgram&&r.thisProgram,r.quit&&r.quit,r.wasmBinary&&(O=r.wasmBinary);var S;r.noExitRuntime;"object"!==typeof WebAssembly&&ee("no native wasm support detected");var x=!1;function C(e,t){e||ee("Assertion failed: "+t)}function I(e){var t=r["_"+e];return C(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function w(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);k(e,t=je(i),i)}return t},array:function(e){var t=je(e.length);return D(e,t),t}};var s=I(e),a=[],l=0;if(n)for(var c=0;c<n.length;c++){var d=o[i[c]];d?(0===l&&(l=ye()),a[c]=d(n[c])):a[c]=n[c]}var u=s.apply(null,a);return u=function(e){return"string"===t?F(e):"boolean"===t?Boolean(e):e}(u),0!==l&&Oe(l),u}function T(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?I(e):function(){return w(e,t,i,arguments)}}var v,A,R,P="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function E(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&P)return P.decode(e.subarray(t,r));for(var o="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function F(e,t){return e?E(R,e,t):""}function M(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-r}function k(e,t,i){return M(e,R,t,i)}function D(e,t){A.set(e,t)}function N(e,t){return e%t>0&&(e+=t-e%t),e}function L(e){v=e,r.HEAP8=A=new Int8Array(e),r.HEAP16=new Int16Array(e),r.HEAP32=new Int32Array(e),r.HEAPU8=R=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=new Float32Array(e),r.HEAPF64=new Float64Array(e)}r.INITIAL_MEMORY;var _,z=[],W=[],G=[],V=[];function B(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)U(r.preRun.shift());de(z)}function H(){!0,de(W)}function q(){de(G)}function Y(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)X(r.postRun.shift());de(V)}function U(e){z.unshift(e)}function X(e){V.unshift(e)}W.push({func:function(){me()}});var $=0,K=null,Q=null;function Z(e){$++,r.monitorRunDependencies&&r.monitorRunDependencies($)}function J(e){if($--,r.monitorRunDependencies&&r.monitorRunDependencies($),0==$&&(null!==K&&(clearInterval(K),K=null),Q)){var t=Q;Q=null,t()}}function ee(e){throw r.onAbort&&r.onAbort(e),j(e+=""),x=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function te(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}r.preloadedImages={},r.preloadedAudios={};var ie="data:application/octet-stream;base64,";function ne(e){return te(e,ie)}var re="file://";function oe(e){return te(e,re)}var se="carta_computation.wasm";function ae(e){try{if(e==se&&O)return new Uint8Array(O);if(g)return g(e);throw"both async and sync fetching of the wasm failed"}catch(j){ee(j)}}function le(){if(!O&&(l||c)){if("function"===typeof fetch&&!oe(se))return fetch(se,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+se+"'";return e.arrayBuffer()})).catch((function(){return ae(se)}));if(p)return new Promise((function(e,t){p(se,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return ae(se)}))}function ce(){var e={a:be};function t(e,t){var i=e.exports;r.asm=i,L((S=r.asm.c).buffer),_=r.asm.j,J()}function i(e){t(e.instance)}function n(t){return le().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){j("failed to asynchronously prepare wasm: "+e),ee(e)}))}if(Z(),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(o){return j("Module.instantiateWasm callback failed with error: "+o),!1}return O||"function"!==typeof WebAssembly.instantiateStreaming||ne(se)||oe(se)||"function"!==typeof fetch?n(i):fetch(se,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return j("wasm streaming compile failed: "+e),j("falling back to ArrayBuffer instantiation"),n(i)}))})),{}}function de(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?_.get(i)():_.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(r)}}function ue(e,t,i){R.copyWithin(e,t,t+i)}function he(){return R.length}function pe(e){try{return S.grow(e-v.byteLength+65535>>>16),L(S.buffer),1}catch(t){}}function ge(e){var t=he(),i=2147483648;if(e>i)return!1;for(var n=1;n<=4;n*=2){var r=t*(1+.2/n);if(r=Math.min(r,e+100663296),pe(Math.min(i,N(Math.max(e,r),65536))))return!0}return!1}ne(se)||(se=y(se));var fe,be={a:ue,b:ge},me=(ce(),r.___wasm_call_ctors=function(){return(me=r.___wasm_call_ctors=r.asm.d).apply(null,arguments)}),ye=(r._decodeArray=function(){return(r._decodeArray=r.asm.e).apply(null,arguments)},r._generateVertexData=function(){return(r._generateVertexData=r.asm.f).apply(null,arguments)},r._malloc=function(){return(r._malloc=r.asm.g).apply(null,arguments)},r._free=function(){return(r._free=r.asm.h).apply(null,arguments)},r._ZSTD_decompress=function(){return(r._ZSTD_decompress=r.asm.i).apply(null,arguments)},r.stackSave=function(){return(ye=r.stackSave=r.asm.k).apply(null,arguments)}),Oe=r.stackRestore=function(){return(Oe=r.stackRestore=r.asm.l).apply(null,arguments)},je=r.stackAlloc=function(){return(je=r.stackAlloc=r.asm.m).apply(null,arguments)};function Se(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function xe(e){function t(){fe||(fe=!0,r.calledRun=!0,x||(H(),q(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Y()))}e=e||a,$>0||(B(),$>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}if(r.ccall=w,r.cwrap=T,Q=function e(){fe||xe(),fe||(Q=e)},r.run=xe,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();xe();var Ce=r.cwrap("ZSTD_decompress","number",["number","number","number","number"]),Ie=r.cwrap("decodeArray","number",["number","number","number"]),we=r.cwrap("generateVertexData","number",["number","number","number","number","number","number"]),Te=8;function ve(e,t){var i=e.byteLength;i>r.srcAllocated&&(r._free(r.srcPtr),r.srcPtr=r._malloc(i),r.srcAllocated=i),t>r.destAllocated&&(r._free(r.destPtr),r.destPtr=r._malloc(t),r.destAllocated=t),new Uint8Array(r.HEAPU8.buffer,r.srcPtr,i).set(e)}r.srcAllocated=0,r.srcPtr=0,r.destAllocated=0,r.destPtr=0,X((function(){console.log("Zstd WebAssembly module loaded")})),r.ZstdReady=!1,r.onReady=new Promise((function(e){if(r.calledRun)e(r);else{var t=r.onRuntimeInitialized;r.onRuntimeInitialized=function(){t&&t(),e(r)}}r.ZstdReady=!0})),r.Decompress=function(e,t){var i=e.byteLength;ve(e,t);var n=new Uint8Array(r.HEAPU8.buffer,r.destPtr,t);Ce(r.destPtr,t,r.srcPtr,i);return n.slice()},r.Decode=function(e,t,i){var n=e.byteLength;ve(e,t);Ce(r.destPtr,t,r.srcPtr,n);var o=new Float32Array(r.HEAPU8.buffer,r.destPtr,t/4);return Ie(r.destPtr,t,i),o.slice()},r.GenerateVertexData=function(e,t){var i=t.length,n=e.length/2,o=(n+i-1)*Te*4;ve(new Uint8Array(e.buffer),o);var s=t.byteLength,a=r._malloc(s);new Int32Array(r.HEAPU8.buffer,a,t.length).set(t);var l=new Float32Array(r.HEAPU8.buffer,r.destPtr,o/4);return we(r.destPtr,o/4,r.srcPtr,n,a,i),r._free(a),l},e.exports=r}).call(this,i(46),"/")},126:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));var n,r=i(3),o=i(15),s=i(36),a=i(5),l=(i(796),i(0));let c=Object(o.a)(n=class extends r.Component{constructor(...e){super(...e),this.exportImageTooltip=()=>Object(l.jsxs)("span",{children:[Object(l.jsx)("br",{}),Object(l.jsx)("i",{children:Object(l.jsxs)("small",{children:["Background color is ",a.e.Instance.preferenceStore.transparentImageBackground?"transparent":"filled",".",Object(l.jsx)("br",{}),a.e.Instance.preferenceStore.transparentImageBackground?"Disable":"Enable"," transparent image background in Preferences.",Object(l.jsx)("br",{})]})})]})}render(){let e={opacity:this.props.visible?1:0},t="profiler-toolbar";return this.props.darkMode&&(t+=" bp3-dark"),Object(l.jsxs)(s.f,{className:t,style:e,children:[this.props.exportImage?Object(l.jsx)(s.W,{content:Object(l.jsxs)("span",{children:["Export image ",this.exportImageTooltip()]}),children:Object(l.jsx)(s.b,{icon:"floppy-disk",onClick:this.props.exportImage})}):null,Object(l.jsx)(s.W,{content:"Export data",children:Object(l.jsx)(s.b,{icon:"th",onClick:this.props.exportData})})]})}})||n},13:function(e,t,i){"use strict";i.d(t,"a",(function(){return x})),i.d(t,"f",(function(){return w})),i.d(t,"g",(function(){return V})),i.d(t,"I",(function(){return it})),i.d(t,"l",(function(){return nt})),i.d(t,"k",(function(){return rt})),i.d(t,"m",(function(){return W})),i.d(t,"o",(function(){return lt})),i.d(t,"n",(function(){return xt})),i.d(t,"u",(function(){return Rt})),i.d(t,"p",(function(){return Et})),i.d(t,"s",(function(){return Bt})),i.d(t,"q",(function(){return Zt})),i.d(t,"v",(function(){return ci})),i.d(t,"y",(function(){return xi})),i.d(t,"z",(function(){return Pi})),i.d(t,"D",(function(){return Vi})),i.d(t,"i",(function(){return Ki})),i.d(t,"E",(function(){return an})),i.d(t,"b",(function(){return Cn})),i.d(t,"G",(function(){return Tn})),i.d(t,"F",(function(){return vn})),i.d(t,"B",(function(){return kn})),i.d(t,"A",(function(){return Dn})),i.d(t,"x",(function(){return _n})),i.d(t,"w",(function(){return zn})),i.d(t,"t",(function(){return Vn})),i.d(t,"j",(function(){return qn})),i.d(t,"C",(function(){return Xn})),i.d(t,"e",(function(){return Kn.b})),i.d(t,"H",(function(){return Qn})),i.d(t,"r",(function(){return Jn})),i.d(t,"h",(function(){return qo})),i.d(t,"d",(function(){return ns})),i.d(t,"c",(function(){return ps}));var n,r,o,s,a,l,c,d,u=i(4),h=i(2),p=(i(28),i(3)),g=i(15),f=i(1),b=i(36),m=i(44),y=i(42),O=i(5),j=i(8),S=(i(808),i(0));!function(e){e.FrameRate="Frame Rate",e.Step="Step"}(d||(d={}));let x=Object(g.a)((r=class extends p.Component{static get WIDGET_CONFIG(){return{id:"animator",type:"animator",minWidth:250,minHeight:200,defaultWidth:650,defaultHeight:200,title:"Animator",isCloseable:!0,helpType:O.x.ANIMATOR}}constructor(e){super(e),Object(u.a)(this,"width",o,this),Object(u.a)(this,"height",s,this),Object(u.a)(this,"numericInputType",a,this),Object(u.a)(this,"onResize",l,this),Object(u.a)(this,"onNumericInputTypeChange",c,this),this.onChannelChanged=e=>{const t=O.e.Instance.activeFrame;t&&(e<0&&(e+=t.frameInfo.fileInfoExtended.depth),e>=t.frameInfo.fileInfoExtended.depth&&(e=0),t.setChannels(e,t.requiredStokes,!0))},this.onRangeChanged=e=>{const t=O.e.Instance.activeFrame;e&&2===e.length&&t&&e[0]>=0&&e[0]<e[1]&&e[1]<t.frameInfo.fileInfoExtended.depth&&t.setAnimationRange(e)},this.onStokesChanged=e=>{const t=O.e.Instance.activeFrame;t&&(e<0&&(e+=t.frameInfo.fileInfoExtended.stokes),e>=t.frameInfo.fileInfoExtended.stokes&&(e=0),t.setChannels(t.requiredChannel,e,!0))},this.onFrameChanged=e=>{const t=O.e.Instance;e<0&&(e+=t.frames.length),e>=t.frames.length&&(e=0),t.setActiveFrameByIndex(e)},this.onAnimationModeChanged=e=>{const t=parseInt(e.currentTarget.value);O.d.Instance.setAnimationMode(t)},this.onFirstClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.setActiveFrameByIndex(0);break;case O.c.CHANNEL:t.setChannels(0,t.stokes,!0);break;case O.c.STOKES:t.setChannels(t.channel,0,!0)}},this.onLastClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.setActiveFrameByIndex(e.frames.length-1);break;case O.c.CHANNEL:t.setChannels(t.frameInfo.fileInfoExtended.depth-1,t.stokes,!0);break;case O.c.STOKES:t.setChannels(t.channel,t.frameInfo.fileInfoExtended.stokes-1,!0)}},this.onNextClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.nextFrame();break;case O.c.CHANNEL:t.incrementChannels(1,0);break;case O.c.STOKES:t.incrementChannels(0,1)}},this.onPrevClicked=()=>{const e=O.e.Instance,t=e.activeFrame;if(t)switch(e.animatorStore.animationMode){case O.c.FRAME:e.prevFrame();break;case O.c.CHANNEL:t.incrementChannels(-1,0);break;case O.c.STOKES:t.incrementChannels(0,-1)}},this.getPlayModeIcon=()=>{switch(O.d.Instance.playMode){case O.F.FORWARD:default:return"arrow-right";case O.F.BACKWARD:return"arrow-left";case O.F.BOUNCING:return"swap-horizontal";case O.F.BLINK:return"exchange"}},Object(f.p)(this),this.numericInputType=d.FrameRate}roundToClosestPreferredStep(e){const t=Math.floor(Math.log10(e)),i=e/Math.pow(10,t);return i<1.5?1*Math.pow(10,t):i<3.5?2*Math.pow(10,t):5*Math.pow(10,t)}render(){const e=O.e.Instance,t=e.activeFrame,i=t?t.frameInfo.fileInfoExtended.depth:0,n=t?t.frameInfo.fileInfoExtended.stokes:0,r=this.width<625,o=this.width<450;let s,a,l,c;if(e.frames.length>1){const i=e.frames.findIndex((e=>e.frameInfo.fileId===t.frameInfo.fileId));c=Object(S.jsxs)("div",{className:"animator-slider",children:[Object(S.jsx)(b.K,{value:O.c.FRAME,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===O.c.FRAME,onChange:this.onAnimationModeChanged,label:"Image"}),o&&Object(S.jsx)(j.n,{value:i,min:-1,max:e.frames.length,stepSize:1,onValueChange:this.onFrameChanged,fill:!0,disabled:e.animatorStore.animationActive}),!o&&Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.N,{value:i,min:0,max:e.frames.length-1,showTrackFill:!1,stepSize:1,onChange:this.onFrameChanged,disabled:e.animatorStore.animationActive}),Object(S.jsx)("div",{className:"slider-info",children:t.filename})]})]})}if(i>1){const n=5,r=i>10?(i-1)/(n-1):1;s=Object(S.jsxs)("div",{className:"animator-slider",children:[Object(S.jsx)(b.K,{value:O.c.CHANNEL,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===O.c.CHANNEL,onChange:this.onAnimationModeChanged,label:"Channel"}),o&&Object(S.jsx)(j.n,{value:t.requiredChannel,min:-1,max:i,stepSize:1,onValueChange:this.onChannelChanged,fill:!0,disabled:e.animatorStore.animationActive}),!o&&Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.N,{className:"channel-slider",value:t.requiredChannel,min:0,max:i-1,labelStepSize:r,labelPrecision:0,showTrackFill:!1,onChange:this.onChannelChanged,disabled:e.animatorStore.animationActive}),Object(S.jsx)("div",{className:"slider-info",children:Object(S.jsx)("pre",{children:t.simpleSpectralInfo})})]})]}),a=Object(S.jsxs)("div",{className:"animator-slider range-slider",children:[Object(S.jsx)("div",{className:"range-label"}),!o&&Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.M,{value:t.animationChannelRange,min:0,max:i-1,labelStepSize:r,labelPrecision:0,onChange:this.onRangeChanged,disabled:e.animatorStore.animationActive}),Object(S.jsx)("div",{className:"slider-info"})]})]})}n>1&&(l=Object(S.jsxs)("div",{className:"animator-slider",children:[Object(S.jsx)(b.K,{value:O.c.STOKES,disabled:e.animatorStore.animationActive,checked:e.animatorStore.animationMode===O.c.STOKES,onChange:this.onAnimationModeChanged,label:"Stokes"}),o&&Object(S.jsx)(j.n,{value:t.requiredStokes,min:-1,max:t.frameInfo.fileInfoExtended.stokes,stepSize:1,onValueChange:this.onStokesChanged,disabled:e.animatorStore.animationActive,fill:!0}),!o&&Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.N,{value:t.requiredStokes,min:0,showTrackFill:!1,max:t.frameInfo.fileInfoExtended.stokes-1,onChange:this.onStokesChanged,disabled:e.animatorStore.animationActive}),Object(S.jsx)("div",{className:"slider-info"})]})]}));let u="animator-playback";o&&(u+=" wrap");const h=Object(S.jsx)(b.F,{className:"playback-mode",content:Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.B,{icon:"arrow-right",text:"Play Forward",active:e.animatorStore.playMode===O.F.FORWARD,onClick:()=>e.animatorStore.playMode=O.F.FORWARD}),Object(S.jsx)(b.B,{icon:"arrow-left",text:"Play Backwards",active:e.animatorStore.playMode===O.F.BACKWARD,onClick:()=>e.animatorStore.playMode=O.F.BACKWARD}),Object(S.jsx)(b.B,{icon:"swap-horizontal",text:"Bouncing",active:e.animatorStore.playMode===O.F.BOUNCING,onClick:()=>e.animatorStore.playMode=O.F.BOUNCING}),Object(S.jsx)(b.B,{icon:"exchange",text:"Blink",active:e.animatorStore.playMode===O.F.BLINK,onClick:()=>e.animatorStore.playMode=O.F.BLINK})]}),position:m.a.TOP,children:Object(S.jsx)(b.W,{content:"Playback Mode",position:m.a.TOP,children:Object(S.jsx)(b.b,{icon:this.getPlayModeIcon(),disabled:e.animatorStore.animationActive,children:!r&&"Mode"})})}),g=Object(S.jsxs)(b.f,{fill:!0,className:"playback-buttons",children:[Object(S.jsx)(b.e,{icon:"chevron-backward",onClick:this.onFirstClicked,children:!r&&"First"}),Object(S.jsx)(b.e,{icon:"step-backward",onClick:this.onPrevClicked,children:!r&&"Prev"}),e.animatorStore.animationActive&&Object(S.jsx)(b.e,{icon:"stop",onClick:e.animatorStore.stopAnimation,children:!r&&"Stop"}),!e.animatorStore.animationActive&&Object(S.jsx)(b.e,{icon:"play",onClick:e.animatorStore.startAnimation,children:!r&&"Play"}),Object(S.jsx)(b.e,{icon:"step-forward",onClick:this.onNextClicked,children:!r&&"Next"}),Object(S.jsx)(b.e,{icon:"chevron-forward",onClick:this.onLastClicked,children:!r&&"Last"})]}),f=Object(S.jsxs)(b.k,{className:"playback-numeric-control",children:[Object(S.jsx)(b.r,{options:[d.FrameRate,d.Step],onChange:e=>this.onNumericInputTypeChange(e.currentTarget.value)}),this.numericInputType===d.FrameRate?Object(S.jsx)(j.n,{value:e.animatorStore.frameRate,min:e.animatorStore.minFrameRate,max:e.animatorStore.maxFrameRate,stepSize:1,minorStepSize:1,majorStepSize:1,onValueChange:e.animatorStore.setFrameRate,disabled:e.animatorStore.animationActive}):Object(S.jsx)(j.n,{value:e.animatorStore.step,min:e.animatorStore.minStep,max:e.animatorStore.maxStep,stepSize:1,minorStepSize:1,majorStepSize:1,onValueChange:e.animatorStore.setStep,disabled:e.animatorStore.animationActive})]});return Object(S.jsxs)("div",{className:"animator-widget",children:[!t&&Object(S.jsx)(b.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),t&&Object(S.jsxs)("div",{className:u,children:[g,h,f]}),t&&this.width>0&&Object(S.jsxs)("div",{className:"animator-sliders",children:[c,s,a,l]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},o=Object(h.a)(r.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(h.a)(r.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(h.a)(r.prototype,"numericInputType",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(h.a)(r.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),c=Object(h.a)(r.prototype,"onNumericInputTypeChange",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.numericInputType=e}}}),n=r))||n;var C,I=i(186);i(812);let w=Object(g.a)(C=class extends p.Component{constructor(...e){super(...e),this.pinElementRef=void 0,this.rnd=void 0,this.onClickHelpButton=()=>{const e=this.rnd.draggable.state.x+.5*this.rnd.resizable.size.width;if(Array.isArray(this.props.widgetConfig.helpType)){const t=O.e.Instance.widgetsStore,i=this.props.widgetConfig.parentType,n=t.floatingSettingsWidgets.get(this.props.widgetConfig.id);let r;switch(i){case"spatial-profiler":r=t.spatialProfileWidgets.get(n).settingsTabId;break;case"spectral-profiler":r=t.spectralProfileWidgets.get(n).settingsTabId;break;case"catalog-overlay":const e=O.k.Instance,i=e.catalogProfiles.get(n);if(i){const n=e.catalogWidgets.get(i);r=t.catalogWidgets.get(n).settingsTabId}break;case"stokes":default:r=t.stokesAnalysisWidgets.get(n).settingsTabId}O.w.Instance.showHelpDrawer(this.props.widgetConfig.helpType[r],e)}else O.w.Instance.showHelpDrawer(this.props.widgetConfig.helpType,e)}}componentDidMount(){this.updateDragSource(),this.rnd.updateSize({width:this.props.widgetConfig.defaultWidth,height:this.props.widgetConfig.defaultHeight}),this.rnd.updatePosition({x:this.props.widgetConfig.defaultX,y:this.props.widgetConfig.defaultY})}componentDidUpdate(){this.updateDragSource(),this.rnd.updateSize({width:this.props.widgetConfig.defaultWidth,height:this.props.widgetConfig.defaultHeight}),this.rnd.updatePosition({x:this.props.widgetConfig.defaultX,y:this.props.widgetConfig.defaultY})}updateDragSource(){const e=O.z.Instance;if(e.dockedLayout&&this.pinElementRef){const t=e.dockedLayout;if(t._dragSources.filter((e=>e._itemConfig.id===this.props.widgetConfig.id)).find((e=>e._element[0]===this.pinElementRef)))return;let i;i={type:"react-component",component:this.props.widgetConfig.type,title:this.props.widgetConfig.title,id:this.props.widgetConfig.id,isClosable:this.props.widgetConfig.isCloseable,props:{id:this.props.widgetConfig.id,docked:!0}},this.props.widgetConfig.type===Et.WIDGET_CONFIG.type&&(i.props.label=this.props.widgetConfig.title),this.pinElementRef&&i&&t.createDragSource(this.pinElementRef,i)}}render(){const e=O.e.Instance;let t="floating-widget",i="floating-content",n=this.props.isSelected?"floating-header selected":"floating-header",r="floating-header-button";e.darkTheme&&(t+=" bp3-dark",n+=" bp3-dark",r+=" bp3-dark"),this.props.showPinButton||(i="floating-settings-content");const o=this.props.widgetConfig;return Object(S.jsxs)(I.a,{ref:e=>this.rnd=e,className:t,style:{zIndex:this.props.zIndex},default:{x:o.defaultX,y:o.defaultY,width:o.defaultWidth,height:o.defaultHeight+25},resizeGrid:[25,25],dragGrid:[25,25],minWidth:o.minWidth,minHeight:o.minHeight+25,bounds:".gl-container-app",dragHandleClassName:"floating-title",onMouseDown:this.props.onSelected,onDragStop:(e,t)=>{o.setDefaultPosition(t.lastX,t.lastY)},onResizeStop:(e,t,i,n,r)=>{o.setDefaultPosition(r.x,r.y),o.setDefaultSize(o.defaultWidth+n.width,o.defaultHeight+n.height)},children:[Object(S.jsxs)("div",{className:n,children:[Object(S.jsx)("div",{className:"floating-title",children:o.title}),this.props.showFloatingSettingsButton&&Object(S.jsx)("div",{className:r,onClick:()=>e.widgetsStore.createFloatingSettingsWidget(o.title,o.id,o.type),children:Object(S.jsx)(b.W,{content:"Settings",position:m.a.BOTTOM_RIGHT,children:Object(S.jsx)(b.w,{icon:"cog"})})}),o.helpType&&Object(S.jsx)("div",{className:r,onClick:this.onClickHelpButton,children:Object(S.jsx)(b.W,{content:"Help",position:m.a.BOTTOM_RIGHT,children:Object(S.jsx)(b.w,{icon:"help"})})}),this.props.showPinButton&&Object(S.jsx)("div",{className:r,ref:e=>this.pinElementRef=e,onClick:()=>console.log("pin!"),children:Object(S.jsx)(b.W,{content:"Drag pin to dock this widget",position:m.a.BOTTOM_RIGHT,children:Object(S.jsx)(b.w,{icon:"pin"})})}),o.isCloseable&&Object(S.jsx)("div",{onMouseDown:this.props.onClosed,className:r,children:Object(S.jsx)(b.w,{icon:"cross"})})]}),Object(S.jsx)("div",{className:i,children:this.props.children})]})}})||C;var T,v,A,R,P=i(20),E=i(43),F=i.n(E),M=i(424),k=i(75),D=i(7);i(814);class N{constructor(e,t){this.name=void 0,this.id=void 0,this.style=void 0,this.weight=void 0,this.family=void 0,this.name=e.replace("{size} ",""),this.id=t;let i=this.name;0===i.indexOf("bold")?(i=i.replace("bold ",""),this.weight=700):this.weight=400,0===i.indexOf("italic")?(i=i.replace("italic ",""),this.style="italic"):this.style="",this.family=i}}const L=P.fonts.map(((e,t)=>new N(e,t))),_=M.a.ofType(),z=(e,{handleClick:t,modifiers:i,query:n})=>Object(S.jsx)(b.B,{active:i.active,disabled:i.disabled,onClick:t,text:Object(S.jsx)("span",{style:{fontFamily:e.family,fontWeight:e.weight,fontStyle:e.style},children:e.name})},e.id);let W=Object(g.a)((v=class extends p.Component{constructor(e){super(e),Object(u.a)(this,"selectedTab",A,this),Object(u.a)(this,"setSelectedTab",R,this),Object(f.p)(this)}fontSelect(e,t,i){let n=L[t];return"undefined"===typeof n&&(n=L[0]),Object(S.jsx)(_,{activeItem:n,itemRenderer:z,items:L,disabled:!e,filterable:!1,popoverProps:{minimal:!0,position:"auto-end",popoverClassName:"fontselect"},onItemSelect:e=>i(e.id),children:Object(S.jsx)(b.e,{text:Object(S.jsx)("span",{style:{fontFamily:n.family,fontWeight:n.weight,fontStyle:n.style},children:n.name}),disabled:!e,rightIcon:"double-caret-vertical"})})}static get WIDGET_CONFIG(){return{id:"image-view-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:600,defaultHeight:420,title:"image-view-settings",isCloseable:!0,parentId:"image-view",parentType:"image-view",helpType:O.x.IMAGE_VIEW_SETTINGS}}render(){const e=O.e.Instance,t=e.overlayStore,i=t.global,n=t.title,r=t.grid,o=t.border,s=t.ticks,a=t.axes,l=t.numbers,c=t.labels,d=t.beam,u=d.settingsForDisplay,h=i.labelType===O.y.Interior,p=h&&"Does not apply to interior labelling.",g=!h&&"Does not apply to exterior labelling.",f=!i.validWcs&&"This image has no valid WCS data.",m=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Color",children:Object(S.jsx)(k.a,{selectedItem:i.color,onItemSelect:i.setColor})}),Object(S.jsx)(b.p,{inline:!0,label:"Tolerance",labelInfo:"(%)",children:Object(S.jsx)(j.n,{placeholder:"Tolerance",min:.1,value:i.tolerance,stepSize:.1,minorStepSize:null,majorStepSize:10,onValueChange:e=>i.setTolerance(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Labelling",children:Object(S.jsx)(b.r,{options:Object.keys(O.y).map((e=>({label:e,value:O.y[e]}))),value:i.labelType,onChange:e=>i.setLabelType(e.currentTarget.value)})}),Object(S.jsx)(b.p,{inline:!0,label:"Coordinate system",disabled:!i.validWcs,helperText:f,children:Object(S.jsx)(b.r,{options:Object.keys(O.R).map((e=>({label:e,value:O.R[e]}))),value:i.system,disabled:!i.validWcs,onChange:e=>i.setSystem(e.currentTarget.value)})})]}),y=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Visible",children:Object(S.jsx)(b.P,{checked:n.visible,onChange:e=>n.setVisible(e.currentTarget.checked)})}),Object(S.jsxs)(b.p,{inline:!0,className:"font-group",label:"Font",disabled:!n.visible,children:[this.fontSelect(n.visible,n.font,n.setFont),Object(S.jsx)(j.n,{min:7,placeholder:"Font size",value:n.fontSize,disabled:!n.visible,onValueChange:e=>n.setFontSize(e)})]}),Object(S.jsx)(b.p,{inline:!0,label:"Custom text",disabled:!n.visible,children:Object(S.jsx)(b.P,{checked:n.customText,disabled:!n.visible,onChange:e=>n.setCustomText(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:n.customText,children:Object(S.jsx)(b.p,{inline:!0,label:"Title Text",disabled:!n.visible,children:Object(S.jsx)(b.x,{disabled:!n.visible,value:n.customTitleString,placeholder:"Enter title text",onChange:e=>n.setCustomTitleString(e.currentTarget.value)})})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",disabled:!n.visible,children:Object(S.jsx)(b.P,{checked:n.customColor,disabled:!n.visible,onChange:e=>n.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:n.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",disabled:!n.visible,children:n.visible&&Object(S.jsx)(k.a,{selectedItem:n.color,onItemSelect:n.setColor})})})]}),x=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Draw on all edges",disabled:h,helperText:p,children:Object(S.jsx)(b.P,{checked:s.drawAll,disabled:h,onChange:e=>s.setDrawAll(e.currentTarget.checked)})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom density",children:Object(S.jsx)(b.P,{checked:s.customDensity,onChange:e=>s.setCustomDensity(e.currentTarget.checked)})}),Object(S.jsxs)(b.i,{isOpen:s.customDensity,children:[Object(S.jsx)(b.p,{inline:!0,label:"Density",labelInfo:"(X)",children:Object(S.jsx)(j.n,{placeholder:"Density",min:0,value:s.densityX,onValueChange:e=>s.setDensityX(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Density",labelInfo:"(Y)",children:Object(S.jsx)(j.n,{placeholder:"Density",min:0,value:s.densityY,onValueChange:e=>s.setDensityY(e)})})]}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",children:Object(S.jsx)(b.P,{checked:s.customColor,onChange:e=>s.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:s.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",children:Object(S.jsx)(k.a,{selectedItem:s.color,onItemSelect:s.setColor})})}),Object(S.jsx)(b.p,{inline:!0,label:"Width",labelInfo:"(px)",children:Object(S.jsx)(j.n,{placeholder:"Width",min:.001,value:s.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>s.setWidth(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Minor length",labelInfo:"(%)",children:Object(S.jsx)(j.n,{placeholder:"Length",min:0,max:100,value:s.length,stepSize:1,minorStepSize:null,majorStepSize:10,onValueChange:e=>s.setLength(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Major length",labelInfo:"(%)",children:Object(S.jsx)(j.n,{placeholder:"Length",min:0,max:100,value:s.majorLength,stepSize:1,minorStepSize:null,majorStepSize:10,onValueChange:e=>s.setMajorLength(e)})})]}),C=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Visible",children:Object(S.jsx)(b.P,{checked:r.visible,onChange:e=>r.setVisible(e.currentTarget.checked)})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",disabled:!r.visible,children:Object(S.jsx)(b.P,{checked:r.customColor,disabled:!r.visible,onChange:e=>r.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:r.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",disabled:!r.visible,children:r.visible&&Object(S.jsx)(k.a,{selectedItem:r.color,onItemSelect:r.setColor})})}),Object(S.jsx)(b.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!r.visible,children:Object(S.jsx)(j.n,{placeholder:"Width",min:.001,value:r.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!r.visible,onValueChange:e=>r.setWidth(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom gap",disabled:!r.visible,children:Object(S.jsx)(b.P,{checked:r.customGap,disabled:!r.visible,onChange:e=>r.setCustomGap(e.currentTarget.checked)})}),Object(S.jsxs)(b.i,{isOpen:r.customGap,children:[Object(S.jsx)(b.p,{inline:!0,label:"Gap",labelInfo:"(X)",disabled:!r.visible,children:Object(S.jsx)(j.n,{placeholder:"Gap",min:.001,stepSize:.01,minorStepSize:.001,majorStepSize:.1,value:r.gapX,disabled:!r.visible,onValueChange:e=>r.setGapX(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Gap",labelInfo:"(Y)",disabled:!r.visible,children:Object(S.jsx)(j.n,{placeholder:"Gap",min:.001,stepSize:.01,minorStepSize:.001,majorStepSize:.1,value:r.gapY,disabled:!r.visible,onValueChange:e=>r.setGapY(e)})})]})]}),I=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Visible",children:Object(S.jsx)(b.P,{checked:o.visible,onChange:e=>o.setVisible(e.currentTarget.checked)})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",disabled:!o.visible,children:Object(S.jsx)(b.P,{checked:o.customColor,disabled:!o.visible,onChange:e=>o.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:o.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",disabled:!o.visible,children:o.visible&&Object(S.jsx)(k.a,{selectedItem:o.color,onItemSelect:o.setColor})})}),Object(S.jsx)(b.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!o.visible,children:Object(S.jsx)(j.n,{placeholder:"Width",min:.001,value:o.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!o.visible,onValueChange:e=>o.setWidth(e)})})]}),w=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Visible",disabled:!h,helperText:g,children:Object(S.jsx)(b.P,{checked:a.visible,disabled:!h,onChange:e=>a.setVisible(e.currentTarget.checked)})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",disabled:!h||!a.visible,children:Object(S.jsx)(b.P,{checked:a.customColor,disabled:!h||!a.visible,onChange:e=>a.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:a.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",disabled:!h||!a.visible,helperText:g,children:h&&a.visible&&Object(S.jsx)(k.a,{selectedItem:a.color,onItemSelect:a.setColor})})}),Object(S.jsx)(b.p,{inline:!0,label:"Width",labelInfo:"(px)",disabled:!h||!a.visible,helperText:g,children:Object(S.jsx)(j.n,{placeholder:"Width",min:.001,value:a.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,disabled:!h||!a.visible,onValueChange:e=>a.setWidth(e)})})]}),T=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Visible",children:Object(S.jsx)(b.P,{checked:l.visible,onChange:e=>l.setVisible(e.currentTarget.checked)})}),Object(S.jsxs)(b.p,{inline:!0,className:"font-group",label:"Font",disabled:!l.visible,children:[this.fontSelect(l.visible,l.font,l.setFont),Object(S.jsx)(j.n,{min:7,placeholder:"Font size",value:l.fontSize,disabled:!l.visible,onValueChange:e=>l.setFontSize(e)})]}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",disabled:!l.visible,children:Object(S.jsx)(b.P,{checked:l.customColor,disabled:!l.visible,onChange:e=>l.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:l.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",disabled:!l.visible,children:l.visible&&Object(S.jsx)(k.a,{selectedItem:l.color,onItemSelect:l.setColor})})}),Object(S.jsx)(b.p,{inline:!0,label:"Custom format",disabled:!l.validWcs,helperText:f,children:Object(S.jsx)(b.P,{checked:l.customFormat,disabled:!l.validWcs,onChange:e=>l.setCustomFormat(e.currentTarget.checked)})}),Object(S.jsxs)(b.i,{isOpen:l.customFormat&&l.validWcs,children:[Object(S.jsx)(b.p,{inline:!0,label:"Format",labelInfo:"(X)",children:Object(S.jsx)(b.r,{options:[{label:O.B.get(O.C.HMS),value:O.C.HMS},{label:O.B.get(O.C.DMS),value:O.C.DMS},{label:O.B.get(O.C.Degrees),value:O.C.Degrees}],value:l.formatX,onChange:e=>l.setFormatX(e.currentTarget.value)})}),Object(S.jsx)(b.p,{inline:!0,label:"Format",labelInfo:"(Y)",children:Object(S.jsx)(b.r,{options:[{label:O.B.get(O.C.HMS),value:O.C.HMS},{label:O.B.get(O.C.DMS),value:O.C.DMS},{label:O.B.get(O.C.Degrees),value:O.C.Degrees}],value:l.formatY,onChange:e=>l.setFormatY(e.currentTarget.value)})})]}),Object(S.jsx)(b.p,{inline:!0,label:"Custom precision",disabled:!l.validWcs,helperText:f,children:Object(S.jsx)(b.P,{checked:l.customPrecision,disabled:!l.validWcs,onChange:e=>l.setCustomPrecision(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:l.customPrecision&&l.validWcs,children:Object(S.jsx)(b.p,{inline:!0,label:"Precision",children:Object(S.jsx)(j.n,{placeholder:"Precision",min:0,value:l.precision,onValueChange:e=>l.setPrecision(e)})})})]}),v=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Visible",children:Object(S.jsx)(b.P,{checked:c.visible,onChange:e=>c.setVisible(e.currentTarget.checked)})}),Object(S.jsxs)(b.p,{inline:!0,className:"font-group",label:"Font",disabled:!c.visible,children:[this.fontSelect(c.visible,c.font,c.setFont),Object(S.jsx)(j.n,{min:7,placeholder:"Font size",value:c.fontSize,disabled:!c.visible,onValueChange:e=>c.setFontSize(e)})]}),Object(S.jsx)(b.p,{inline:!0,label:"Custom text",disabled:!c.visible,children:Object(S.jsx)(b.P,{checked:c.customText,disabled:!c.visible,onChange:e=>c.setCustomText(e.currentTarget.checked)})}),Object(S.jsxs)(b.i,{isOpen:c.customText,children:[Object(S.jsx)(b.p,{inline:!0,label:"Label Text (X)",disabled:!c.visible,children:Object(S.jsx)(b.x,{disabled:!c.visible,value:c.customLabelX,placeholder:"Enter label text",onChange:e=>c.setCustomLabelX(e.currentTarget.value)})}),Object(S.jsx)(b.p,{inline:!0,label:"Label Text (Y)",disabled:!c.visible,children:Object(S.jsx)(b.x,{disabled:!c.visible,value:c.customLabelY,placeholder:"Enter label text",onChange:e=>c.setCustomLabelY(e.currentTarget.value)})})]}),Object(S.jsx)(b.p,{inline:!0,label:"Custom color",disabled:!c.visible,children:Object(S.jsx)(b.P,{checked:c.customColor,disabled:!c.visible,onChange:e=>c.setCustomColor(e.currentTarget.checked)})}),Object(S.jsx)(b.i,{isOpen:c.customColor,children:Object(S.jsx)(b.p,{inline:!0,label:"Color",disabled:!c.visible,children:c.visible&&Object(S.jsx)(k.a,{selectedItem:c.color,onItemSelect:c.setColor})})})]}),A=d.isSelectedFrameValid?Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{inline:!0,label:"Image",children:Object(S.jsx)(b.r,{options:e.frameNames,value:d.selectedFileId,onChange:e=>d.setSelectedFrame(parseInt(e.currentTarget.value))})}),Object(S.jsx)(b.p,{inline:!0,label:"Visible",children:Object(S.jsx)(b.P,{checked:u.visible,onChange:e=>u.setVisible(e.currentTarget.checked)})}),Object(S.jsx)(b.p,{inline:!0,label:"Color",children:Object(S.jsx)(j.c,{color:F()(u.color).toHexString(),presetColors:D.e,setColor:e=>u.setColor(e.hex),disableAlpha:!0,darkTheme:e.darkTheme})}),Object(S.jsx)(b.p,{inline:!0,label:"Type",children:Object(S.jsx)(b.r,{options:Object.keys(O.f).map((e=>({label:e,value:O.f[e]}))),value:u.type,onChange:e=>u.setType(e.currentTarget.value)})}),Object(S.jsx)(b.p,{inline:!0,label:"Width",labelInfo:"(px)",children:Object(S.jsx)(j.n,{placeholder:"Width",min:.5,max:10,value:u.width,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>u.setWidth(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Position (X)",labelInfo:"(px)",children:Object(S.jsx)(j.n,{placeholder:"Position (X)",min:0,max:t.renderWidth,value:u.shiftX,stepSize:5,minorStepSize:1,majorStepSize:10,onValueChange:e=>u.setShiftX(e)})}),Object(S.jsx)(b.p,{inline:!0,label:"Position (Y)",labelInfo:"(px)",children:Object(S.jsx)(j.n,{placeholder:"Position (Y)",min:0,max:t.renderHeight,value:u.shiftY,stepSize:5,minorStepSize:1,majorStepSize:10,onValueChange:e=>u.setShiftY(e)})})]}):null;let R="image-view-settings";return e.darkTheme&&(R+=" bp3-dark"),Object(S.jsx)("div",{className:R,children:Object(S.jsxs)(b.R,{id:"imageViewSettingsTabs",vertical:!0,selectedTabId:this.selectedTab,onChange:this.setSelectedTab,children:[Object(S.jsx)(b.Q,{id:"global",title:"Global",panel:m}),Object(S.jsx)(b.Q,{id:"title",title:"Title",panel:y}),Object(S.jsx)(b.Q,{id:"ticks",title:"Ticks",panel:x}),Object(S.jsx)(b.Q,{id:"grid",title:"Grid",panel:C}),Object(S.jsx)(b.Q,{id:"border",title:"Border",panel:I}),Object(S.jsx)(b.Q,{id:"axes",title:"Axes",panel:w}),Object(S.jsx)(b.Q,{id:"numbers",title:"Numbers",panel:T}),Object(S.jsx)(b.Q,{id:"labels",title:"Labels",panel:v}),Object(S.jsx)(b.Q,{id:"beam",title:"Beam",panel:A,disabled:e.frameNum<=0})]})})}},A=Object(h.a)(v.prototype,"selectedTab",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"global"}}),R=Object(h.a)(v.prototype,"setSelectedTab",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTab=e}}}),T=v))||T;var G;let V=Object(g.a)(G=class extends p.Component{constructor(...e){super(...e),this.floatingSettingType="floating-settings",this.onFloatingWidgetSelected=e=>{O.U.Instance.updateSelectFloatingWidgetzIndex(e.id)},this.onFloatingWidgetClosed=e=>{const t=O.U.Instance;switch(e.type){case Cn.WIDGET_CONFIG.type:t.removeFloatingWidgetComponent(e.componentId),O.k.Instance.catalogProfiles.delete(e.componentId);break;case ns.WIDGET_CONFIG.type:t.removeFloatingWidgetComponent(e.componentId),O.k.Instance.clearCatalogPlotsByComponentId(e.componentId);break;default:t.removeFloatingWidget(e.id)}}}getWidgetContent(e){switch(e.type){case rt.WIDGET_CONFIG.type:return Object(S.jsx)(rt,{id:e.id,docked:!1});case xt.WIDGET_CONFIG.type:return Object(S.jsx)(xt,{id:e.id,docked:!1});case lt.WIDGET_CONFIG.type:return Object(S.jsx)(lt,{id:e.id,docked:!1});case Bt.WIDGET_CONFIG.type:return Object(S.jsx)(Bt,{id:e.id,docked:!1});case x.WIDGET_CONFIG.type:return Object(S.jsx)(x,{id:e.id,docked:!1});case ci.WIDGET_CONFIG.type:return Object(S.jsx)(ci,{id:e.id,docked:!1});case Pi.WIDGET_CONFIG.type:return Object(S.jsx)(Pi,{id:e.id,docked:!1});case xi.WIDGET_CONFIG.type:return Object(S.jsx)(xi,{id:e.id,docked:!1});case Vi.WIDGET_CONFIG.type:return Object(S.jsx)(Vi,{id:e.id,docked:!1});case Ki.WIDGET_CONFIG.type:return Object(S.jsx)(Ki,{id:e.id,docked:!1});case Zt.WIDGET_CONFIG.type:return Object(S.jsx)(Zt,{id:e.id,docked:!1});case an.WIDGET_CONFIG.type:return Object(S.jsx)(an,{id:e.id,docked:!1});case Cn.WIDGET_CONFIG.type:return Object(S.jsx)(Cn,{id:e.componentId,docked:!1});case ns.WIDGET_CONFIG.type:return Object(S.jsx)(ns,{id:e.id,docked:!1});default:return Object(S.jsx)(Et,{id:e.id,docked:!1,label:e.title})}}getWidgetSettings(e){if(e.parentId)switch(e.parentType){case rt.WIDGET_CONFIG.type:return Object(S.jsx)(W,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case an.WIDGET_CONFIG.type:return Object(S.jsx)(vn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Pi.WIDGET_CONFIG.type:return Object(S.jsx)(Dn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case ci.WIDGET_CONFIG.type:return Object(S.jsx)(zn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Bt.WIDGET_CONFIG.type:return Object(S.jsx)(Vn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Ki.WIDGET_CONFIG.type:return Object(S.jsx)(qn,{id:e.parentId,docked:!1,floatingSettingsId:e.id});case Cn.WIDGET_CONFIG.type:return Object(S.jsx)(ps,{id:e.parentId,docked:!1,floatingSettingsId:e.id});default:return null}return null}showPin(e){return!e.type||e.type!==this.floatingSettingType}showFloatingSettingsButton(e){switch(e.type){case an.WIDGET_CONFIG.type:case Pi.WIDGET_CONFIG.type:case ci.WIDGET_CONFIG.type:case Bt.WIDGET_CONFIG.type:case Ki.WIDGET_CONFIG.type:case Cn.WIDGET_CONFIG.type:return!0;default:return!1}}render(){const e=O.U.Instance.floatingWidgets;return Object(S.jsx)("div",{children:e.map((t=>{const i=this.showPin(t),n=t.componentId?t.componentId:t.id;return Object(S.jsx)("div",{children:Object(S.jsx)(w,{isSelected:t.zIndex===e.length,widgetConfig:t,zIndex:t.zIndex,showPinButton:i,onSelected:()=>this.onFloatingWidgetSelected(t),onClosed:()=>this.onFloatingWidgetClosed(t),showFloatingSettingsButton:this.showFloatingSettingsButton(t),floatingWidgets:e.length,children:i?this.getWidgetContent(t):this.getWidgetSettings(t)},n)},n)}))})}})||G;var B,H=i(82),q=i.n(H),Y=i(33);i(815);let U=Object(g.a)(B=class extends p.Component{constructor(...e){super(...e),this.canvas=void 0,this.renderCanvas=Y.throttle((()=>{const e=this.props.overlaySettings,t=this.props.frame,i=devicePixelRatio;if(t.wcsInfo){const n=t.spatialReference?t.transformedWcsInfo:t.wcsInfo,r=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView;this.updateImageDimensions(),P.setCanvas(this.canvas);const o=t=>{P.plot(n,r.xMin,r.xMax,r.yMin,r.yMax,e.viewWidth*i,e.viewHeight*i,e.padding.left*i,e.padding.right*i,e.padding.top*i,e.padding.bottom*i,t)};let s=e.styleString;if(t.moving){s+=`, Tol=${Math.max(2*e.global.tolerance/100,.1)}`}o(s),/No grid curves can be drawn for axis/.test(P.getLastErrorMessage())&&o(s.replace(/Gap\(\d\)=[^,]+, ?/g,"").replace("Grid=1","Grid=0")),P.clearLastErrorMessage()}}),50)}componentDidMount(){this.canvas&&this.renderCanvas()}componentDidUpdate(){this.canvas&&this.renderCanvas()}updateImageDimensions(){this.canvas.width=this.props.overlaySettings.viewWidth*devicePixelRatio,this.canvas.height=this.props.overlaySettings.viewHeight*devicePixelRatio}render(){const e=this.props.overlaySettings.styleString;(this.props.frame.spatialReference||this.props.frame).requiredFrameView,this.props.overlaySettings.padding,this.props.overlaySettings.viewWidth,this.props.overlaySettings.viewHeight,this.props.frame.moving;let t="overlay-canvas";return this.props.docked&&(t+=" docked"),Object(S.jsx)("canvas",{className:t,id:"overlay-canvas",ref:e=>this.canvas=e},e)}})||B;var X;i(816);let $=Object(g.a)(X=class extends p.Component{render(){const e=this.props.cursorInfo;let t=[];if(this.props.showWCS&&e.infoWCS&&t.push(`WCS:\xa0(${e.infoWCS.x},\xa0${e.infoWCS.y})`),this.props.showImage&&t.push(`Image:\xa0(${Object(D.mb)(e.posImageSpace.x)},\xa0${Object(D.mb)(e.posImageSpace.y)})`),this.props.showValue&&void 0!==this.props.cursorValue){let e=`Value:\xa0${Object(D.v)(this.props.cursorValue,5,this.props.unit,!0,!0)}`;isNaN(this.props.cursorValue)&&(e="NaN"),this.props.isValueCurrent?e+=" ":e+="*",t.push(e)}this.props.showChannel&&void 0!==this.props.spectralInfo.channel&&t.push(`Channel:\xa0${this.props.spectralInfo.channel}`),this.props.showSpectral&&this.props.spectralInfo.spectralString&&(t.push(this.props.spectralInfo.spectralString.replace(/\s/g,"\xa0")),this.props.spectralInfo.freqString&&t.push(this.props.spectralInfo.freqString.replace(/\s/g,"\xa0")),this.props.spectralInfo.velocityString&&t.push(this.props.spectralInfo.velocityString.replace(/\s/g,"\xa0"))),this.props.showStokes&&this.props.currentStokes&&t.push(`Stokes:\xa0${this.props.currentStokes}`);let i={lineHeight:(void 0!==this.props.height&&this.props.height>=0?this.props.height:20)+"px"};(this.props.left>0||this.props.right>0)&&(i.width=this.props.width-this.props.left-this.props.right),void 0!==this.props.top?i.top=this.props.top:void 0!==this.props.bottom&&(i.bottom=this.props.bottom),void 0!==this.props.left&&(i.left=this.props.left);let n="cursor-overlay-div";return this.props.docked&&(n+=" docked"),Object(S.jsx)("div",{className:n,style:i,children:t.join("; ")})}})||X;var K,Q=i(11),Z=i(27);i(817);let J=Object(g.a)(K=class extends p.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.updateCanvas=()=>{const e=O.e.Instance.activeFrame,t=Z.i.Instance;if(e&&this.canvas&&this.gl&&t.cmapTexture){const t=e.renderConfig.stokes,i=e.renderConfig.histogram?e.renderConfig.histogram.channel:void 0;!e.renderConfig.useCubeHistogram&&e.channel!==i||e.stokes!==t||(this.updateCanvasSize(),this.updateUniforms(),this.renderCanvas());const n=this.canvas.getContext("2d");n.clearRect(0,0,this.canvas.width,this.canvas.height),n.drawImage(this.gl.canvas,0,0,this.canvas.width,this.canvas.height)}}}componentDidMount(){this.gl=Z.i.Instance.gl,this.canvas&&this.updateCanvas(),Z.h.Instance.tileStream.subscribe((()=>{requestAnimationFrame(this.updateCanvas)}))}componentDidUpdate(){requestAnimationFrame(this.updateCanvas)}updateUniforms(){const e=O.e.Instance,t=Z.i.Instance.shaderUniforms,i=e.activeFrame,n=i.renderConfig;if(n&&t){this.gl.uniform1f(t.MinVal,n.scaleMinVal),this.gl.uniform1f(t.MaxVal,n.scaleMaxVal),this.gl.uniform1i(t.CmapIndex,n.colorMapIndex),this.gl.uniform1i(t.ScaleType,n.scaling),this.gl.uniform1i(t.Inverted,n.inverted?1:0),this.gl.uniform1f(t.Bias,n.bias),this.gl.uniform1f(t.Contrast,n.contrast),this.gl.uniform1f(t.Gamma,n.gamma),this.gl.uniform1f(t.Alpha,n.alpha),this.gl.uniform1f(t.CanvasWidth,i.renderWidth*devicePixelRatio),this.gl.uniform1f(t.CanvasHeight,i.renderHeight*devicePixelRatio);const r=F()(e.preferenceStore.nanColorHex).setAlpha(e.preferenceStore.nanAlpha);if(r.isValid()){const e=r.toRgb();this.gl.uniform4f(t.NaNColor,e.r/255,e.g/255,e.b/255,e.a)}}}updateCanvasSize(){const e=O.e.Instance.activeFrame,t=Z.i.Instance;e&&e.isRenderable&&(this.canvas.width!==e.renderWidth*devicePixelRatio||this.canvas.height!==e.renderHeight*devicePixelRatio)&&(this.canvas.width=e.renderWidth*devicePixelRatio,this.canvas.height=e.renderHeight*devicePixelRatio,t.setCanvasSize(e.renderWidth*devicePixelRatio,e.renderHeight*devicePixelRatio))}renderCanvas(){const e=O.e.Instance.activeFrame;if(e&&e.isRenderable&&e.renderType!==O.J.NONE){if(this.gl.viewport(0,0,e.renderWidth*devicePixelRatio,e.renderHeight*devicePixelRatio),this.gl.enable(WebGLRenderingContext.DEPTH_TEST),this.gl.clear(WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT),!e.renderConfig.visible)return;e.renderType===O.J.TILED&&this.renderTiledCanvas()}}renderTiledCanvas(){const e=O.e.Instance.activeFrame,t=Z.i.Instance;this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,t.vertexUVBuffer),this.gl.vertexAttribPointer(t.vertexUVAttribute,2,WebGLRenderingContext.FLOAT,!1,0,0),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,t.vertexPositionBuffer),this.gl.vertexAttribPointer(t.vertexPositionAttribute,3,WebGLRenderingContext.FLOAT,!1,0,0);const i={x:e.frameInfo.fileInfoExtended.width,y:e.frameInfo.fileInfoExtended.height},n={xMin:Math.max(0,e.requiredFrameView.xMin),xMax:Math.min(e.requiredFrameView.xMax,i.x),yMin:Math.max(0,e.requiredFrameView.yMin),yMax:Math.min(e.requiredFrameView.yMax,i.y),mip:e.requiredFrameView.mip};this.gl.activeTexture(WebGLRenderingContext.TEXTURE0);const r=Object(D.b)(n,i,{x:Z.g,y:Z.g});if(1===r.length&&0===r[0].layer){const e=Object(D.c)(0,i,{x:Z.g,y:Z.g});this.renderTiles(r,e,!1,3,!0)}else this.renderTiles(r,n.mip,!1,3,!0)}renderTiles(e,t,i=!1,n,r){const o=Z.h.Instance,s=O.e.Instance.activeFrame;if(!o)return;const a=new Map,l=[];for(const c of e){const e=Q.TileCoordinate.EncodeCoordinate(c),d=o.getTile(e,s.frameInfo.fileId,s.channel,s.stokes,i);if(d)this.renderTile(c,d,t);else if(n>0&&t>=2&&(l.push({layer:c.layer+1,x:2*c.x,y:2*c.y}),l.push({layer:c.layer+1,x:2*c.x+1,y:2*c.y}),l.push({layer:c.layer+1,x:2*c.x,y:2*c.y+1}),l.push({layer:c.layer+1,x:2*c.x+1,y:2*c.y+1})),c.layer>0&&r){const e={layer:c.layer-1,x:Math.floor(c.x/2),y:Math.floor(c.y/2)};a.set(Q.TileCoordinate.EncodeCoordinate(e),!0)}}if(n>0&&l.length&&this.renderTiles(l,t/2,!0,n-1,!1),r){const e=[];a.forEach(((t,i)=>e.push(Q.TileCoordinate.Decode(i)))),e.length&&this.renderTiles(e,2*t,!0,0,!0)}}renderTile(e,t,i){const n=O.e.Instance.activeFrame,r=Z.i.Instance,o=Z.h.Instance;if(!t)return;t.data&&(o.uploadTileToGPU(t),delete t.data);const s=o.getTileTextureParameters(t);s&&(this.gl.bindTexture(WebGLRenderingContext.TEXTURE_2D,s.texture),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MIN_FILTER,D.a.NEAREST),this.gl.texParameteri(WebGLRenderingContext.TEXTURE_2D,WebGLRenderingContext.TEXTURE_MAG_FILTER,D.a.NEAREST),this.gl.uniform2f(r.shaderUniforms.TileTextureOffset,s.offset.x,s.offset.y));const a=n.spatialReference||n,l=a.requiredFrameView,c=i*Z.g,d=e.x*c,u=e.y*c;e.x,e.y;let h={x:d-l.xMin-.5,y:u-l.yMin-.5},p=Object(D.eb)({x:1,y:1},i*a.zoomLevel);if(n.spatialReference&&n.spatialTransform){h=Object(D.f)(h,n.spatialTransform.translation);const e=Object(D.f)(n.spatialTransform.origin,n.spatialTransform.translation),t={x:a.zoomLevel*(e.x-l.xMin),y:a.zoomLevel*(e.y-l.yMin)};this.gl.uniform2f(r.shaderUniforms.RotationOrigin,t.x,t.y),this.gl.uniform1f(r.shaderUniforms.RotationAngle,-n.spatialTransform.rotation),this.gl.uniform1f(r.shaderUniforms.ScaleAdjustment,n.spatialTransform.scale)}else this.gl.uniform1f(r.shaderUniforms.RotationAngle,0),this.gl.uniform1f(r.shaderUniforms.ScaleAdjustment,1);h=Object(D.eb)(h,a.zoomLevel),this.gl.uniform2f(r.shaderUniforms.TileSize,t.width,t.height),this.gl.uniform2f(r.shaderUniforms.TileOffset,h.x,h.y),this.gl.uniform2f(r.shaderUniforms.TileScaling,p.x,p.y),this.gl.drawArrays(WebGLRenderingContext.TRIANGLE_STRIP,0,4)}render(){const e=O.e.Instance,t=e.activeFrame;if(t){const i=t.spatialReference||t;i.requiredFrameView,i.currentFrameView,t.renderType,t.renderConfig.scaleMinVal,t.renderConfig.scaleMaxVal,t.renderConfig.colorMapIndex,t.renderConfig.contrast,t.renderConfig.bias,t.renderConfig.scaling,t.renderConfig.gamma,t.renderConfig.alpha,t.renderConfig.inverted,t.renderConfig.visible,e.preferenceStore.nanColorHex,e.preferenceStore.nanAlpha}const i=e.overlayStore.padding;let n="raster-div";return this.props.docked&&(n+=" docked"),Object(S.jsx)("div",{className:n,children:Object(S.jsx)("canvas",{className:"raster-canvas",id:"raster-canvas",ref:e=>this.canvas=e,style:{top:i.top,left:i.left,width:t&&t.isRenderable&&t.renderWidth||1,height:t&&t.isRenderable&&t.renderHeight||1}})})}})||K;var ee,te,ie,ne=i(6);i(818);let re=Object(g.a)((ie=te=class e extends p.Component{constructor(...e){super(...e),this.handleZoomToActualSizeClicked=()=>{O.e.Instance.activeFrame.setZoom(1)},this.handleZoomInClicked=()=>{const e=O.e.Instance,t=e.activeFrame.spatialReference||e.activeFrame;t.setZoom(2*t.zoomLevel,!0)},this.handleZoomOutClicked=()=>{const e=O.e.Instance,t=e.activeFrame.spatialReference||e.activeFrame;t.setZoom(t.zoomLevel/2,!0)},this.handleRegionTypeClicked=e=>{const t=O.e.Instance;t.activeFrame.regionSet.setNewRegionType(e),t.activeFrame.regionSet.setMode(O.L.CREATING)},this.handleCoordinateSystemClicked=e=>{O.E.Instance.global.setSystem(e)},this.handelActiveLayerClicked=e=>{this.props.onActiveLayerChange(e),e===nt.RegionMoving&&O.e.Instance.activeFrame.regionSet.setMode(O.L.MOVING)},this.exportImageTooltip=()=>Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Background color is ",O.e.Instance.preferenceStore.transparentImageBackground?"transparent":"filled",".",Object(S.jsx)("br",{}),O.e.Instance.preferenceStore.transparentImageBackground?"Disable":"Enable"," transparent image background in Preferences.",Object(S.jsx)("br",{})]})})]})}render(){const t=O.e.Instance,i=t.preferenceStore,n=t.overlayStore,r=t.activeFrame,o=n.grid;let s={bottom:n.padding.bottom,right:n.padding.right,opacity:this.props.visible?1:0},a="image-toolbar";t.darkTheme&&(a+=" bp3-dark"),this.props.docked&&(a+=" docked");const l=r.spatialReference&&r.spatialTransform?r.spatialReference.zoomLevel*r.spatialTransform.scale:r.zoomLevel,c=Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Current: ",Object(D.mb)(l,2),"x"]})})]}),d=this.props.vertical?"left":"bottom",u=Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.B,{icon:"symbol-square",text:"Point",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.POINT)}),Object(S.jsx)(b.B,{icon:"square",text:"Rectangle",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.RECTANGLE)}),Object(S.jsx)(b.B,{icon:"circle",text:"Ellipse",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.ELLIPSE)}),Object(S.jsx)(b.B,{icon:"polygon-filter",text:"Polygon",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.POLYGON)})]});let h=n.global.system;const p=Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.B,{text:e.CoordinateSystemName.get(O.R.Auto),onClick:()=>this.handleCoordinateSystemClicked(O.R.Auto)}),Object(S.jsx)(b.B,{text:e.CoordinateSystemName.get(O.R.FK5),onClick:()=>this.handleCoordinateSystemClicked(O.R.FK5)}),Object(S.jsx)(b.B,{text:e.CoordinateSystemName.get(O.R.FK4),onClick:()=>this.handleCoordinateSystemClicked(O.R.FK4)}),Object(S.jsx)(b.B,{text:e.CoordinateSystemName.get(O.R.Galactic),onClick:()=>this.handleCoordinateSystemClicked(O.R.Galactic)}),Object(S.jsx)(b.B,{text:e.CoordinateSystemName.get(O.R.Ecliptic),onClick:()=>this.handleCoordinateSystemClicked(O.R.Ecliptic)}),Object(S.jsx)(b.B,{text:e.CoordinateSystemName.get(O.R.ICRS),onClick:()=>this.handleCoordinateSystemClicked(O.R.ICRS)})]});let g;switch(r.regionSet.newRegionType){case ne.a.RegionType.POINT:g="symbol-square";break;case ne.a.RegionType.RECTANGLE:g="square";break;case ne.a.RegionType.ELLIPSE:g="circle";break;case ne.a.RegionType.POLYGON:g="polygon-filter";break;default:g="error"}const f=!!r.spatialReference,y=!!r.spectralReference,j=t.spatialReference!==r,x=t.spectralReference&&t.spectralReference!==r&&r.frameInfo.fileInfoExtended.depth>1,C=(f?"x":"")+(y?"z":""),I=[];y&&I.push(`Spectral (${i.spectralMatchingType})`),f&&I.push("Spatial");const w=I.join(" and ")||"None",T=Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.B,{text:`Spectral (${i.spectralMatchingType}) and Spatial`,disabled:!j||!x,active:y&&f,onClick:()=>t.setMatchingEnabled(!0,!0)}),Object(S.jsx)(b.B,{text:`Spectral (${i.spectralMatchingType})  only`,disabled:!x,active:y&&!f,onClick:()=>t.setMatchingEnabled(!1,!0)}),Object(S.jsx)(b.B,{text:"Spatial only",disabled:!j,active:!y&&f,onClick:()=>t.setMatchingEnabled(!0,!1)}),Object(S.jsx)(b.B,{text:"None",disabled:!j,active:!y&&!f,onClick:()=>t.setMatchingEnabled(!1,!1)})]}),v=t.activeLayer===nt.Catalog,A=0===t.catalogNum;return Object(S.jsxs)(b.f,{className:a,style:s,vertical:this.props.vertical,children:[Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Catalog selection",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsx)("small",{children:"Click to select single catalog source"})})]}),children:Object(S.jsx)(b.b,{icon:"locate",active:v,onClick:()=>this.handelActiveLayerClicked(nt.Catalog),disabled:A})}),r.regionSet.mode===O.L.CREATING&&Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Create region",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsx)("small",{children:"Click to select region type"})})]}),children:Object(S.jsx)(b.F,{content:u,position:m.a.TOP,minimal:!0,children:Object(S.jsx)(b.b,{icon:g,active:!v,onClick:()=>this.handelActiveLayerClicked(nt.RegionCreating)})})}),r.regionSet.mode===O.L.MOVING&&Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Create region",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Double-click to select region type.",Object(S.jsx)("br",{}),"Press C to enter creation mode."]})})]}),children:Object(S.jsx)(b.b,{icon:g,onClick:()=>r.regionSet.setMode(O.L.CREATING)})}),Object(S.jsx)(b.W,{position:d,content:"Select and pan mode",children:Object(S.jsx)(b.b,{icon:"hand",onClick:()=>this.handelActiveLayerClicked(nt.RegionMoving),active:r.regionSet.mode===O.L.MOVING&&!v})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Zoom in (Scroll wheel up)",c]}),children:Object(S.jsx)(b.b,{icon:"zoom-in",onClick:this.handleZoomInClicked})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Zoom out (Scroll wheel down)",c]}),children:Object(S.jsx)(b.b,{icon:"zoom-out",onClick:this.handleZoomOutClicked})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Zoom to 1.0x",c]}),children:Object(S.jsx)(b.b,{className:"full-zoom-button",onClick:this.handleZoomToActualSizeClicked,children:"1.0x"})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Zoom to fit",c]}),children:Object(S.jsx)(b.b,{icon:"zoom-to-fit",onClick:r.fitZoom})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["WCS Matching ",Object(S.jsx)("br",{}),Object(S.jsx)("small",{children:Object(S.jsxs)("i",{children:["Current: ",w]})})]}),children:Object(S.jsx)(b.F,{content:T,position:m.a.TOP,minimal:!0,children:Object(S.jsx)(b.b,{icon:"link",className:"link-button",children:C})})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:["Overlay Coordinate ",Object(S.jsx)("br",{}),Object(S.jsx)("small",{children:Object(S.jsxs)("i",{children:["Current: ",e.CoordinateSystemTooltip.get(h)]})})]}),children:Object(S.jsx)(b.F,{content:p,position:m.a.TOP,minimal:!0,children:Object(S.jsx)(b.b,{disabled:!r.validWcs,text:e.CoordinateSystemName.get(h)})})}),Object(S.jsx)(b.W,{position:d,content:"Toggle grid",children:Object(S.jsx)(b.b,{icon:"grid",active:o.visible,onClick:()=>o.setVisible(!o.visible)})}),Object(S.jsx)(b.W,{position:d,content:"Toggle labels",children:Object(S.jsx)(b.b,{icon:"numerical",active:!n.labelsHidden,onClick:n.toggleLabels})}),Object(S.jsx)(b.W,{position:d,content:Object(S.jsxs)("span",{children:[`Export image (${t.modifierString}E)`,this.exportImageTooltip()]}),children:Object(S.jsx)(b.b,{icon:"floppy-disk",onClick:t.exportImage})})]})}},te.CoordinateSystemName=new Map([[O.R.Auto,"WCS"],[O.R.FK5,"FK5"],[O.R.FK4,"FK4"],[O.R.Galactic,"GAL"],[O.R.Ecliptic,"ECL"],[O.R.ICRS,"ICRS"]]),te.CoordinateSystemTooltip=new Map([[O.R.Auto,"Automatically select the coordinate system based on file headers"],[O.R.FK5,"FK5 coordinates, J2000.0 equinox"],[O.R.FK4,"FK4 coordinates, B1950.0 equinox"],[O.R.Galactic,"Galactic coordinates"],[O.R.Ecliptic,"Ecliptic coordinates"],[O.R.ICRS,"International Celestial Reference System"]]),ee=ie))||ee;var oe,se=i(24),ae=i(74);i(819);let le=Object(g.a)(oe=class extends p.Component{constructor(...e){super(...e),this.getPlotProps=(e,t)=>{if(!e.hasVisibleBeam)return null;const i=e.frameInfo.fileId,n=e.spatialReference?e.spatialReference.zoomLevel*e.spatialTransform.scale:e.zoomLevel,r=e.overlayBeamSettings,o=r.color,s=r.type===O.f.Solid?ae.a.WHITE:o,a=r.type,l=r.width,c=this.props.padding?this.props.padding*devicePixelRatio:0,d=r.shiftX,u=r.shiftY,h=e.beamProperties.x/2*n/devicePixelRatio,p=e.beamProperties.y/2*n/devicePixelRatio;let g=(90-e.beamProperties.angle)*Math.PI/180;e.spatialTransform&&(g-=e.spatialTransform.rotation);const f=Math.sin(g),b=Math.cos(g),m=2*Math.sqrt(h*h*b*b+p*p*f*f),y=2*Math.sqrt(h*h*f*f+p*p*b*b),j=e.renderWidth-m/2;let S=t?t.x:m/2+c+d;S>j&&(S=j);const x=y/2;let C=t?t.y:e.renderHeight-y/2-c-u;return C<x&&(C=x),{id:i,position:{x:S,y:C},a:h,b:p,theta:g,type:a,color:o,axisColor:s,strokeWidth:l}}}plotBeam(e){if(!e)return null;let t;switch(e.type){case O.f.Open:default:t=Object(S.jsx)(se.c,{radiusX:e.a,radiusY:e.b,stroke:e.color,strokeWidth:e.strokeWidth});break;case O.f.Solid:t=Object(S.jsx)(se.c,{radiusX:e.a,radiusY:e.b,fill:e.color,stroke:e.color,strokeWidth:e.strokeWidth})}return Object(S.jsxs)(se.d,{x:e.position.x,y:e.position.y,rotation:180*e.theta/Math.PI,children:[e.a>0&&e.b>0&&t,Object(S.jsx)(se.f,{points:[-e.a,0,e.a,0],stroke:e.axisColor,strokeWidth:e.strokeWidth}),Object(S.jsx)(se.f,{points:[0,-e.b,0,e.b],stroke:e.axisColor,strokeWidth:e.strokeWidth})]},e.id)}render(){let e="beam-profile-stage";this.props.docked&&(e+=" docked");const t=O.e.Instance,i=t.activeFrame,n=t.contourFrames.filter((e=>e.frameInfo.fileId!==t.activeFrame.frameInfo.fileId&&e.hasVisibleBeam));if(!i.hasVisibleBeam&&!n.length)return null;let r;i.hasVisibleBeam&&(r=this.getPlotProps(i));const o=[];return n.forEach((e=>{const t=this.getPlotProps(e,r?r.position:null);o.push(this.plotBeam(t))})),Object(S.jsx)(se.i,{className:e,width:i.renderWidth,height:i.renderHeight,style:{left:this.props.left,top:this.props.top},children:Object(S.jsxs)(se.e,{listening:!1,children:[this.plotBeam(r),o]})})}})||oe;function ce(e,t,i,n,r,o=null){let s={x:0,y:0};return o&&(s=Object(D.eb)(Object(D.cb)(s,o.rotation),o.scale)),{x:e/n*(i.xMax-i.xMin)+i.xMin-s.x,y:t/r*(i.yMin-i.yMax)+i.yMax-s.y}}function de(e,t,i,n,r,o=null){const s=i.xMax-i.xMin,a=i.yMax-i.yMin;return{x:(e-i.xMin)/s*n,y:r-(t-i.yMin)/a*r}}function ue(e,t,i,n,r){let o=ce(e,t,i.spatialReference?i.spatialReference.requiredFrameView:i.requiredFrameView,n,r,i.spatialTransform);return i.spatialReference&&(o=i.spatialTransform.transformCoordinate(o,!1)),o}function he(e,t,i,n,r){let o={x:e,y:t};return i.spatialReference?(o=i.spatialTransform.transformCoordinate(o,!0),de(o.x,o.y,i.spatialReference.requiredFrameView,n,r,i.spatialTransform)):de(o.x,o.y,i.requiredFrameView,n,r,i.spatialTransform)}var pe,ge,fe,be,me;let ye=Object(g.a)((me=be=class e extends p.Component{constructor(...t){super(...t),this.editAnchor=void 0,this.editOppositeAnchorPoint=void 0,this.editStartCenterPoint=void 0,this.previousCursorStyle=void 0,this.handleContextMenu=e=>{e.evt.preventDefault(),console.log("context click!")},this.handleDoubleClick=()=>{this.props.onDoubleClick&&this.props.onDoubleClick(this.props.region)},this.handleClick=e=>{const t=e.evt;0!==t.button||t.ctrlKey||t.metaKey||this.props.onSelect&&this.props.onSelect(this.props.region)},this.startEditing=e=>{this.editAnchor=e;const t=this.props.region;let i,n;this.props.region.regionType===ne.a.RegionType.RECTANGLE?(i=t.size.x,n=t.size.y):(i=t.size.y,n=t.size.x),this.editStartCenterPoint={x:t.center.x,y:t.center.y};const r={x:0,y:0},o=this.props.region.regionType===ne.a.RegionType.RECTANGLE?.5:1;this.editAnchor.includes("left")?r.x=+i*o:this.editAnchor.includes("right")&&(r.x=-i*o),this.editAnchor.includes("top")?r.y=-n*o:this.editAnchor.includes("bottom")&&(r.y=+n*o);const s=Object(D.cb)(r,this.props.region.rotation*Math.PI/180);this.editOppositeAnchorPoint=Object(D.f)(this.editStartCenterPoint,s),this.props.region.beginEditing()},this.handleAnchorDragEnd=()=>{this.props.region.endEditing()},this.applyCornerScaling=(e,t,i,n)=>{const r=this.props.frame;let o,s,a,l=ue(t,i,r,this.props.layerWidth,this.props.layerHeight);r.spatialReference&&(l=Object(D.nb)(r.spatialTransformAST,l,!0)),e.regionType===ne.a.RegionType.RECTANGLE?(a=1,o=e.size.x,s=e.size.y):(a=.5,o=e.size.y,s=e.size.x);let c=Object(D.kb)(l,this.editOppositeAnchorPoint);const d=Object(D.cb)(c,-e.rotation*Math.PI/180);n.includes("left")||n.includes("right")?o=Math.abs(d.x)*a:d.x=0,n.includes("top")||n.includes("bottom")?s=Math.abs(d.y)*a:d.y=0,c=Object(D.cb)(d,e.rotation*Math.PI/180);const u=Object(D.f)(this.editOppositeAnchorPoint,Object(D.eb)(c,.5));e.regionType===ne.a.RegionType.RECTANGLE?e.setControlPoints([u,{x:Math.max(.001,o),y:Math.max(.001,s)}]):e.setControlPoints([u,{y:Math.max(.001,o),x:Math.max(.001,s)}])},this.applyCenterScaling=(e,t,i,n,r)=>{const o=this.props.frame;let s=ue(t,i,o,this.props.layerWidth,this.props.layerHeight);o.spatialReference&&(s=Object(D.nb)(o.spatialTransformAST,s,!0));const a=e.center;let l,c,d;e.regionType===ne.a.RegionType.RECTANGLE?(d=2,l=e.size.x,c=e.size.y):(d=1,l=e.size.y,c=e.size.x);let u=Object(D.kb)(s,a);const h=Object(D.cb)(u,-e.rotation*Math.PI/180);if((n.includes("left")||n.includes("right"))&&(l=Math.abs(h.x)*d),(n.includes("top")||n.includes("bottom"))&&(c=Math.abs(h.y)*d),r){const e=Math.max(l,c);l=e,c=e}e.regionType===ne.a.RegionType.RECTANGLE?e.setControlPoints([this.editStartCenterPoint,{x:Math.max(.001,l),y:Math.max(.001,c)}]):e.setControlPoints([this.editStartCenterPoint,{y:Math.max(.001,l),x:Math.max(.001,c)}])},this.handleDragStart=()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing()},this.handleDragEnd=()=>{this.props.region.endEditing()},this.handleDrag=e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame;let r=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(r=Object(D.nb)(n.spatialTransformAST,r,!0)),i.setCenter(r)}},this.handleAnchorMouseEnter=t=>{const i=t.target,n=null===i||void 0===i?void 0:i.getStage();n&&(this.previousCursorStyle=n.container().style.cursor,n.container().style.cursor=e.GetCursor(i.id(),this.props.region.rotation))},this.handleAnchorMouseOut=e=>{e.target&&e.target.getStage()&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)},this.handleAnchorDragStart=e=>{if(e.target){const t=e.target.id();this.startEditing(t)}},Object(u.a)(this,"handleAnchorDrag",fe,this)}static GetCursor(e,t){let i;switch(e){case"rotator":return"all-scroll";case"top":case"bottom":i=0;break;case"left":case"right":i=90;break;case"top-left":case"bottom-right":i=45;break;default:i=135}for(i+=t,i=45*Math.round(i/45);i<0;)i+=180;for(;i>=180;)i-=180;switch(i){case 45:return"nwse-resize";case 90:return"ew-resize";case 135:return"nesw-resize";default:return"ns-resize"}}anchorNode(t,i,n,r=0){const o={x:t,y:i,rotation:r,fill:"white",strokeWidth:1,stroke:"black",draggable:!0,key:n,id:n,onMouseEnter:this.handleAnchorMouseEnter,onMouseOut:this.handleAnchorMouseOut,onDragStart:this.handleAnchorDragStart,onDragEnd:this.handleAnchorDragEnd,onDragMove:this.handleAnchorDrag};if("rotator"===n)return Object(S.jsx)(se.b,{...o,radius:e.AnchorWidth/Math.sqrt(2)});const s=e.AnchorWidth/2;return Object(S.jsx)(se.g,{...o,offsetX:s,offsetY:s,width:2*s,height:2*s})}render(){const e=this.props.region,t=this.props.frame;let i;const n=e.center;if(t.spatialReference){const r=Object(D.nb)(t.spatialTransformAST,n,!1),o=he(r.x,r.y,t,this.props.layerWidth,this.props.layerHeight),s=e.getRegionApproximation(t.spatialTransformAST),a=s.length,l=new Array(2*a);for(let e=0;e<a;e++){const i=he(s[e].x,s[e].y,t,this.props.layerWidth,this.props.layerHeight);l[2*e]=i.x-o.x,l[2*e+1]=i.y-o.y}i=Object(S.jsx)(se.f,{x:o.x,y:o.y,stroke:e.color,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],closed:!0,listening:this.props.listening&&!e.locked,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,perfectDrawEnabled:!1,lineJoin:"round",draggable:!0,points:l})}else{const r=e.rotation,o=t.zoomLevel,s=he(n.x,n.y,t,this.props.layerWidth,this.props.layerHeight);let a=e.size.x*o/devicePixelRatio,l=e.size.y*o/devicePixelRatio;const c={rotation:-r,x:s.x,y:s.y,stroke:e.color,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],draggable:!0,listening:this.props.listening&&!e.locked,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,perfectDrawEnabled:!1};i=e.regionType===ne.a.RegionType.RECTANGLE?Object(S.jsx)(se.g,{...c,width:a,height:l,offsetX:a/2,offsetY:l/2}):Object(S.jsx)(se.c,{...c,radiusY:a,radiusX:l})}let r;if(this.props.selected&&this.props.listening&&!e.locked){var o;let i,s;e.regionType===ne.a.RegionType.RECTANGLE?(i=e.size.x/2,s=e.size.y/2):(i=e.size.y,s=e.size.x);r=[{anchor:"rotator",offset:{x:0,y:s+15/(null!==(o=t.spatialReference)&&void 0!==o?o:t).zoomLevel*devicePixelRatio}},{anchor:"top",offset:{x:0,y:s}},{anchor:"bottom",offset:{x:0,y:-s}},{anchor:"left",offset:{x:-i,y:0}},{anchor:"right",offset:{x:i,y:0}},{anchor:"top-left",offset:{x:-i,y:s}},{anchor:"bottom-left",offset:{x:-i,y:-s}},{anchor:"top-right",offset:{x:i,y:s}},{anchor:"bottom-right",offset:{x:i,y:-s}}].map((i=>{let r=Object(D.f)(n,Object(D.cb)(i.offset,e.rotation*Math.PI/180));t.spatialReference&&(r=Object(D.nb)(t.spatialTransformAST,r,!1));const o=he(r.x,r.y,t,this.props.layerWidth,this.props.layerHeight);return this.anchorNode(o.x,o.y,i.anchor,-e.rotation)}))}return Object(S.jsxs)(se.d,{children:[i,r]})}},be.AnchorWidth=7,ge=me,fe=Object(h.a)(ge.prototype,"handleAnchorDrag",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.currentTarget){const t=e.target.id(),i=this.props.region,n=this.props.frame,r=e.evt,o={x:r.offsetX,y:r.offsetY};if(t.includes("rotator")){let e=ue(o.x,o.y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Object(D.nb)(n.spatialTransformAST,e,!0));const t=Object(D.kb)(e,i.center),r=Object(D.cb)({x:0,y:1},i.rotation*Math.PI/180),s=180/Math.PI*Object(D.g)(r,t);i.setRotation(i.rotation+s)}else{const e=r.ctrlKey||r.metaKey;this.props.isRegionCornerMode&&!e||!this.props.isRegionCornerMode&&e?this.applyCornerScaling(i,r.offsetX,r.offsetY,t):this.applyCenterScaling(i,r.offsetX,r.offsetY,t,r.shiftKey)}}}}}),pe=ge))||pe;var Oe,je,Se,xe,Ce,Ie,we,Te,ve,Ae,Re,Pe;const Ee=ae.a.ROSE4;let Fe=Object(g.a)((je=class extends p.Component{constructor(e){super(e),Object(u.a)(this,"hoverIndex",Se,this),Object(u.a)(this,"hoverIntersection",xe,this),this.previousCursorStyle=void 0,this.handleContextMenu=e=>{e.evt.preventDefault(),console.log("context click!")},this.handleDoubleClick=()=>{this.props.onDoubleClick&&this.props.onDoubleClick(this.props.region)},Object(u.a)(this,"handleClick",Ce,this),this.handleAnchorDragStart=()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing()},this.handleAnchorDragEnd=()=>{this.props.region.endEditing()},Object(u.a)(this,"handleAnchorDrag",Ie,this),this.handleAnchorDoubleClick=e=>{const t=e.target;if(t){const e=t.index,i=this.props.region;if(e>=0&&e<i.controlPoints.length&&i.controlPoints.length>=4){const t=i.controlPoints.slice(0);t.splice(e,1),i.setControlPoints(t)}}},Object(u.a)(this,"handleStrokeMouseEnter",we,this),Object(u.a)(this,"handleStrokeMouseLeave",Te,this),Object(u.a)(this,"handleMouseMove",ve,this),this.handleAnchorMouseEnter=e=>{e.target&&e.target.getStage()&&(this.previousCursorStyle=e.target.getStage().container().style.cursor,e.target.getStage().container().style.cursor="move")},this.handleAnchorMouseOut=e=>{e.target&&e.target.getStage()&&(e.target.getStage().container().style.cursor=this.previousCursorStyle)},Object(u.a)(this,"handleDragStart",Ae,this),Object(u.a)(this,"handleDragEnd",Re,this),Object(u.a)(this,"handleDrag",Pe,this),Object(f.p)(this)}getCanvasPointArray(e){if(!e||!e.length)return null;const t=this.props.frame,i=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView,n=i.xMax-i.xMin,r=i.yMax-i.yMin;let o={x:1,y:1};t.spatialReference&&(o=Object(D.eb)(Object(D.cb)(o,t.spatialTransform.rotation),t.spatialTransform.scale));const s=new Array(2*e.length);for(let a=0;a<e.length;a++){const t=(e[a].x+o.x-i.xMin)/n*this.props.layerWidth,l=this.props.layerHeight-(e[a].y+o.y-i.yMin)/r*this.props.layerHeight;s[2*a]=t,s[2*a+1]=l}return s}anchorNode(e,t,i=0,n,r=!1){let o={x:e,y:t,offsetX:3.5,offsetY:3.5,width:7,height:7,fill:"white",strokeWidth:1,stroke:"black",rotation:i};return r?o={...o,draggable:!0,key:n,onMouseEnter:this.handleAnchorMouseEnter,onMouseOut:this.handleAnchorMouseOut,onDragStart:this.handleAnchorDragStart,onDragEnd:this.handleAnchorDragEnd,onDragMove:this.handleAnchorDrag,onDblClick:this.handleAnchorDoubleClick}:(o.opacity=.5,o.listening=!1),Object(S.jsx)(se.g,{...o})}render(){const e=this.props.region,t=this.props.frame,i=t.spatialReference?t.spatialReference.requiredFrameView:t.requiredFrameView;let n,r,o=0,s=e.controlPoints,a=null,l=null;if(t.spatialReference){const i=Object(D.h)(s),c=Object(D.nb)(t.spatialTransformAST,i,!1);n=he(c.x,c.y,t,this.props.layerWidth,this.props.layerHeight);const d=e.getRegionApproximation(t.spatialTransformAST),u=d.length;r=new Array(2*u);for(let e=0;e<u;e++){const i=he(d[e].x,d[e].y,t,this.props.layerWidth,this.props.layerHeight);r[2*e]=i.x-n.x,r[2*e+1]=i.y-n.y}if(this.props.selected&&!e.locked&&(a=s.map(((e,i)=>{const n=Object(D.nb)(t.spatialTransformAST,e,!1),r=he(n.x,n.y,t,this.props.layerWidth,this.props.layerHeight);return this.anchorNode(r.x,r.y,o,i,!0)}))),this.hoverIntersection&&!e.locked){const e=Object(D.nb)(t.spatialTransformAST,this.hoverIntersection,!1),i=he(e.x,e.y,t,this.props.layerWidth,this.props.layerHeight);l=this.anchorNode(i.x,i.y,o)}o=180*-t.spatialTransform.rotation/Math.PI}else{if(o=0,s=s.map((e=>de(e.x,e.y,i,this.props.layerWidth,this.props.layerHeight,t.spatialTransform))),n=Object(D.h)(s),this.props.selected&&!e.locked){a=new Array(s.length);for(let e=0;e<s.length;e++)a[e]=this.anchorNode(s[e].x,s[e].y,o,e,!0)}if(this.hoverIntersection&&!e.locked){const e=he(this.hoverIntersection.x,this.hoverIntersection.y,t,this.props.layerWidth,this.props.layerHeight);l=this.anchorNode(e.x,e.y,o)}r=new Array(2*s.length);for(let e=0;e<r.length/2;e++)r[2*e]=s[e].x-n.x,r[2*e+1]=s[e].y-n.y}return Object(S.jsxs)(se.d,{children:[Object(S.jsx)(se.f,{x:n.x,y:n.y,stroke:e.isSimplePolygon?e.color:Ee,strokeWidth:e.lineWidth,opacity:e.isTemporary?.5:e.locked?.7:1,dash:[e.dashLength],closed:!e.creating,listening:this.props.listening&&!e.locked,onClick:this.handleClick,onDblClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onMouseEnter:this.handleStrokeMouseEnter,onMouseLeave:this.handleStrokeMouseLeave,onMouseMove:this.handleMouseMove,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,perfectDrawEnabled:!1,lineJoin:"round",draggable:!0,points:r,hitStrokeWidth:32}),Object(S.jsxs)(se.d,{children:[a,l]})]})}},Se=Object(h.a)(je.prototype,"hoverIndex",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe=Object(h.a)(je.prototype,"hoverIntersection",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=Object(h.a)(je.prototype,"handleClick",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.evt;if(0===t.button&&!t.ctrlKey&&!t.metaKey){const e=this.props.region;if(this.props.onSelect&&this.props.onSelect(e),this.hoverIntersection&&this.hoverIndex>=0&&this.hoverIndex<e.controlPoints.length){const t=e.controlPoints.slice(0);t.splice(this.hoverIndex+1,0,this.hoverIntersection),e.setControlPoints(t,!0,!1),this.hoverIntersection=null}}}}}),Ie=Object(h.a)(je.prototype,"handleAnchorDrag",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame,r=t.index;if(r>=0&&r<i.controlPoints.length){let e=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Object(D.nb)(n.spatialTransformAST,e,!0)),i.setControlPoint(r,e),this.hoverIntersection=null}}}}}),we=Object(h.a)(je.prototype,"handleStrokeMouseEnter",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.handleMouseMove(e)}}}),Te=Object(h.a)(je.prototype,"handleStrokeMouseLeave",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hoverIntersection=null}}}),ve=Object(h.a)(je.prototype,"handleMouseMove",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.evt,i=this.props.region,n=this.props.frame;if(this.props.selected&&i.controlPoints.length>=2){let e=ue(t.offsetX,t.offsetY,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(e=Object(D.nb)(n.spatialTransformAST,e,!0));let r=Number.MAX_VALUE,o=-1,s=null;for(let t=0;t<i.controlPoints.length;t++){const n=Object(D.n)(e,i.controlPoints[t],i.controlPoints[(t+1)%i.controlPoints.length]);n.bounded&&n.distance<r&&(r=n.distance,s=n.point,o=t)}o>=0&&r<=16?(this.hoverIntersection=s,this.hoverIndex=o):this.hoverIntersection=null}}}}),Ae=Object(h.a)(je.prototype,"handleDragStart",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing(),this.hoverIntersection=null}}}),Re=Object(h.a)(je.prototype,"handleDragEnd",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.props.region.endEditing()}}}),Pe=Object(h.a)(je.prototype,"handleDrag",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame,r=Object(D.h)(i.controlPoints);let o=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(o=Object(D.nb)(n.spatialTransformAST,o,!0));const s=Object(D.kb)(o,r),a=i.controlPoints.map((e=>Object(D.f)(e,s)));i.setControlPoints(a,!1,!1)}}}}),Oe=je))||Oe;var Me;let ke=Object(g.a)(Me=class extends p.Component{constructor(...e){super(...e),this.handleDoubleClick=()=>{this.props.onDoubleClick&&this.props.onDoubleClick(this.props.region)},this.handleClick=e=>{const t=e.evt;0!==t.button||t.ctrlKey||t.metaKey||this.props.onSelect&&this.props.onSelect(this.props.region)},this.handleDragStart=()=>{this.props.onSelect&&this.props.onSelect(this.props.region),this.props.region.beginEditing()},this.handleDragEnd=()=>{this.props.region.endEditing()},this.handleDrag=e=>{if(e.target){const t=e.target,i=this.props.region,n=this.props.frame;let r=ue(t.position().x,t.position().y,n,this.props.layerWidth,this.props.layerHeight);n.spatialReference&&(r=Object(D.nb)(n.spatialTransformAST,r,!0)),i.setCenter(r)}}}render(){const e=this.props.region,t=this.props.frame;let i,n;if(t.spatialReference){const r=e.center,o=Object(D.nb)(t.spatialTransformAST,r,!1);i=he(o.x,o.y,t,this.props.layerWidth,this.props.layerHeight),n=180*-t.spatialTransform.rotation/Math.PI}else i=he(e.center.x,e.center.y,t,this.props.layerWidth,this.props.layerHeight),n=0;return Object(S.jsxs)(se.d,{children:[Object(S.jsx)(se.g,{rotation:n,x:i.x,y:i.y,width:6,height:6,offsetX:3,offsetY:3,fill:e.color}),Object(S.jsx)(se.g,{rotation:n,x:i.x,y:i.y,width:13,stroke:"white",strokeWidth:1,height:13,offsetX:6.5,offsetY:6.5,opacity:this.props.selected?1:0,draggable:!0,listening:!e.locked,onDragStart:this.handleDragStart,onDragEnd:this.handleDragEnd,onDragMove:this.handleDrag,onClick:this.handleClick,onDblClick:this.handleDoubleClick})]})}})||Me;var De,Ne,Le,_e,ze,We,Ge,Ve,Be;i(820);let He=Object(g.a)((Ne=class extends p.Component{constructor(e){super(e),Object(u.a)(this,"creatingRegion",Le,this),Object(u.a)(this,"currentCursorPos",_e,this),this.regionStartPoint=void 0,this.mousePreviousClick={x:-1e3,y:-1e3},this.mouseClickDistance=0,this.dragPanning=void 0,this.dragOffset=void 0,this.initialDragPointCanvasSpace=void 0,this.initialDragCenter=void 0,this.initialPinchZoom=void 0,this.initialPinchDistance=void 0,this.updateCursorPos=Y.throttle(((e,t)=>{const i=this.props.frame;if(i.wcsInfo){const n=ue(e,t,i,this.props.width,this.props.height);this.props.frame.setCursorPosition(n)}}),100),Object(u.a)(this,"regionCreationStart",ze,this),this.regionCreationEnd=e=>{this.dragPanning=!1;switch(this.props.frame.regionSet.newRegionType){case ne.a.RegionType.RECTANGLE:case ne.a.RegionType.ELLIPSE:case ne.a.RegionType.POINT:this.handleMouseUpRegularRegion();break;case ne.a.RegionType.POLYGON:this.handleMouseUpPolygonRegion(e.evt)}},this.handleDragStart=e=>{if(e.target===e.currentTarget&&this.props.dragPanningEnabled){this.dragPanning=!0;let t=e.target.getStage().getPointerPosition();if(this.props.frame){const e=this.props.frame.spatialReference||this.props.frame;this.initialDragPointCanvasSpace=t,this.initialDragCenter=e.center,e.startMoving()}}},this.handleDragMove=e=>{if(e.target===e.currentTarget){let t=e.target.getStage().getPointerPosition(),i=!0;if("touchmove"===e.evt.type){const t=e.evt;if(t.touches.length>1&&t.target){i=!1;const e=t.target.getBoundingClientRect(),n={x:t.touches[0].pageX-e.left,y:t.touches[0].pageY-e.top},r={x:t.touches[1].pageX-e.left,y:t.touches[1].pageY-e.top};this.handlePinch(n,r)}else this.initialPinchDistance=-1,this.initialPinchZoom=-1}i&&this.handlePan(t),e.target.x(0),e.target.y(0)}},this.handleDragEnd=e=>{if(e.target===e.currentTarget){this.dragPanning=!1,this.dragOffset=null;const e=this.props.frame;e&&e.endMoving()}this.initialPinchDistance=-1,this.initialPinchZoom=-1},this.handlePinch=(e,t)=>{const i=this.props.frame;if(!i||!e||!t)return;const n=Object(D.kb)(t,e),r=Object(D.P)(n),o=Object(D.h)([e,t]);if(isFinite(r)&&!(r<=0))if(this.initialPinchDistance>0){const e=r/this.initialPinchDistance,t=ce(o.x,o.y,i.requiredFrameView,this.props.width,this.props.height);i.zoomToPoint(t.x,t.y,this.initialPinchZoom*e)}else this.initialPinchDistance=r,this.initialPinchZoom=i.zoomLevel},this.handlePan=e=>{if(e&&isFinite(e.x)&&isFinite(e.y)&&this.props.frame){const t=this.props.frame.spatialReference||this.props.frame;if(this.dragOffset){this.dragOffset=Object(D.kb)(e,this.initialDragPointCanvasSpace);const i=de(this.initialDragCenter.x,this.initialDragCenter.y,t.requiredFrameView,this.props.width,this.props.height),n=Object(D.kb)(i,this.dragOffset),r=ce(n.x,n.y,t.requiredFrameView,this.props.width,this.props.height);t.setCenter(r.x,r.y)}else this.dragOffset={x:0,y:0}}},Object(u.a)(this,"handleMouseUpPolygonRegion",We,this),this.handleClick=e=>{const t=e.evt,i=this.props.frame,n=0!==t.button||t.ctrlKey||t.metaKey;if(this.mouseClickDistance=Object(D.Z)(t,this.mousePreviousClick),this.mousePreviousClick={x:t.x,y:t.y},(e.target===e.currentTarget||n)&&(this.props.frame.regionSet.mode!==O.L.CREATING||0!==t.button)&&(this.props.dragPanningEnabled&&!n&&this.props.frame.regionSet.deselectRegion(),this.props.frame.wcsInfo&&this.props.onClicked&&(!this.props.dragPanningEnabled||n))){const e=ue(t.offsetX,t.offsetY,i,this.props.width,this.props.height);this.props.onClicked(this.props.frame.getCursorInfo(e))}},this.handleWheel=e=>{const t=e.evt,i=this.props.frame,n=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:15*t.deltaY;if(this.props.frame.wcsInfo&&this.props.onZoomed){const e=ue(t.offsetX,t.offsetY,i,this.props.width,this.props.height);this.props.onZoomed(this.props.frame.getCursorInfo(e),-n)}},this.handleMove=e=>{const t=e.evt;if(this.props.dragPanningEnabled&&this.dragPanning)return;if(this.props.frame.regionSet.mode===O.L.CREATING&&this.creatingRegion)switch(this.creatingRegion.regionType){case ne.a.RegionType.RECTANGLE:case ne.a.RegionType.ELLIPSE:this.handleRegularRegionMouseMove(t);break;case ne.a.RegionType.POLYGON:this.handlePolygonRegionMouseMove(t)}else this.props.cursorFrozen||this.updateCursorPos(t.offsetX,t.offsetY)},Object(u.a)(this,"handlePolygonRegionMouseMove",Ge,this),this.handleRegionDoubleClick=e=>{this.props.onRegionDoubleClicked&&this.props.onRegionDoubleClicked(e)},Object(u.a)(this,"handleStageDoubleClick",Ve,this),Object(u.a)(this,"onKeyDown",Be,this),Object(f.p)(this)}getCursorCanvasPos(e,t){const i=he(e,t,this.props.frame,this.props.width,this.props.height),n=this.props.width,r=this.props.height;return i.x<0||i.x>n||i.y<0||i.y>r?null:i}handleMouseUpRegularRegion(){const e=this.props.frame.spatialReference||this.props.frame;if(this.creatingRegion){if(this.creatingRegion.controlPoints.length>1&&0===Object(D.P)(this.creatingRegion.size)){const t=O.H.Instance.regionSize*(this.creatingRegion.regionType===ne.a.RegionType.RECTANGLE?1:.5)/e.zoomLevel;this.creatingRegion.setSize(Object(D.eb)({x:1,y:1},t))}this.creatingRegion.isValid?(this.creatingRegion.endCreating(),e.regionSet.selectRegion(this.creatingRegion)):e.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null}setTimeout((()=>this.props.frame.regionSet.setMode(O.L.MOVING)),1)}handleRegularRegionMouseMove(e){const t=this.props.frame;let i=ue(e.offsetX,e.offsetY,t,this.props.width,this.props.height);t.spatialReference&&(i=Object(D.nb)(t.spatialTransformAST,i,!0));let n=i.x-this.regionStartPoint.x,r=i.y-this.regionStartPoint.y;if(e.shiftKey){const e=Math.max(Math.abs(n),Math.abs(r));n=Math.sign(n)*e,r=Math.sign(r)*e}const o=e.ctrlKey||e.metaKey;if(this.props.isRegionCornerMode&&!o||!this.props.isRegionCornerMode&&o){const e={x:this.regionStartPoint.x+n,y:this.regionStartPoint.y+r},t={x:(this.regionStartPoint.x+e.x)/2,y:(this.regionStartPoint.y+e.y)/2};switch(this.creatingRegion.regionType){case ne.a.RegionType.RECTANGLE:this.creatingRegion.setControlPoints([t,{x:Math.abs(n),y:Math.abs(r)}]);break;case ne.a.RegionType.ELLIPSE:this.creatingRegion.setControlPoints([t,{y:Math.abs(n)/2,x:Math.abs(r)/2}])}}else switch(this.creatingRegion.regionType){case ne.a.RegionType.RECTANGLE:this.creatingRegion.setControlPoints([this.regionStartPoint,{x:2*Math.abs(n),y:2*Math.abs(r)}]);break;case ne.a.RegionType.ELLIPSE:this.creatingRegion.setControlPoints([this.regionStartPoint,{y:Math.abs(n),x:Math.abs(r)}])}}render(){const e=this.props.frame,t=e.regionSet;let i="region-stage";this.props.docked&&(i+=" docked");let n=null;t&&t.regions.length&&(n=t.regions.filter((e=>e.isValid&&0!==e.regionId)).sort(((e,t)=>e.boundingBoxArea>t.boundingBoxArea?-1:1)).map((i=>i.regionType===ne.a.RegionType.POLYGON?Object(S.jsx)(Fe,{region:i,frame:e,layerWidth:this.props.width,layerHeight:this.props.height,selected:i===t.selectedRegion,onSelect:t.selectRegion,onDoubleClick:this.handleRegionDoubleClick,listening:t.mode!==O.L.CREATING},i.regionId):i.regionType===ne.a.RegionType.POINT?Object(S.jsx)(ke,{region:i,frame:e,layerWidth:this.props.width,layerHeight:this.props.height,selected:i===t.selectedRegion,onSelect:t.selectRegion,onDoubleClick:this.handleRegionDoubleClick},i.regionId):Object(S.jsx)(ye,{region:i,frame:e,layerWidth:this.props.width,layerHeight:this.props.height,selected:i===t.selectedRegion,onSelect:t.selectRegion,onDoubleClick:this.handleRegionDoubleClick,listening:t.mode!==O.L.CREATING,isRegionCornerMode:this.props.isRegionCornerMode},i.regionId))));let r=null;if(this.props.cursorFrozen&&this.props.cursorPoint){const t=this.getCursorCanvasPos(this.props.cursorPoint.x,this.props.cursorPoint.y),i=e.spatialReference?180*e.spatialTransform.rotation/Math.PI:0;if(t){const e=20,n=3,o=1,s=7;r=Object(S.jsxs)(se.d,{x:Math.floor(t.x)+.5,y:Math.floor(t.y)+.5,rotation:-i,children:[Object(S.jsx)(se.f,{listening:!1,points:[-e/2-n/2,0,-s/2,0],strokeWidth:n,stroke:"black"}),Object(S.jsx)(se.f,{listening:!1,points:[s/2,0,e/2+n/2,0],strokeWidth:n,stroke:"black"}),Object(S.jsx)(se.f,{listening:!1,points:[0,-e/2-n/2,0,-s/2],strokeWidth:n,stroke:"black"}),Object(S.jsx)(se.f,{listening:!1,points:[0,s/2,0,e/2+n/2],strokeWidth:n,stroke:"black"}),Object(S.jsx)(se.g,{listening:!1,width:s-1,height:s-1,offsetX:s/2-.5,offsetY:s/2-.5,strokeWidth:1,stroke:"black"}),Object(S.jsx)(se.f,{listening:!1,points:[-e/2-o/2,0,-s/2,0],strokeWidth:o,stroke:"white"}),Object(S.jsx)(se.f,{listening:!1,points:[s/2,0,e/2+o/2,0],strokeWidth:o,stroke:"white"}),Object(S.jsx)(se.f,{listening:!1,points:[0,-e/2-o/2,0,-s/2],strokeWidth:o,stroke:"white"}),Object(S.jsx)(se.f,{listening:!1,points:[0,s/2,0,e/2+o/2],strokeWidth:o,stroke:"white"})]})}}let o,s=null;if(this.currentCursorPos&&this.creatingRegion&&this.creatingRegion.regionType===ne.a.RegionType.POLYGON&&this.creatingRegion.isValid){let t=this.creatingRegion.controlPoints[0],i=this.creatingRegion.controlPoints[this.creatingRegion.controlPoints.length-1];e.spatialReference&&(t=Object(D.nb)(e.spatialTransformAST,t,!1),i=Object(D.nb)(e.spatialTransformAST,i,!1));const n=this.getCursorCanvasPos(t.x,t.y),r=this.getCursorCanvasPos(i.x,i.y);let o;o=this.creatingRegion.controlPoints.length>1?[n.x,n.y,this.currentCursorPos.x,this.currentCursorPos.y,r.x,r.y]:[n.x,n.y,this.currentCursorPos.x,this.currentCursorPos.y],s=Object(S.jsx)(se.f,{points:o,dash:[5],stroke:this.creatingRegion.color,strokeWidth:this.creatingRegion.lineWidth,opacity:.5,lineJoin:"round",listening:!1,perfectDrawEnabled:!1})}return e.regionSet.mode===O.L.CREATING?o="crosshair":e.regionSet.selectedRegion&&e.regionSet.selectedRegion.editing&&(o="move"),Object(S.jsx)("div",{onKeyDown:this.onKeyDown,tabIndex:0,children:Object(S.jsx)(se.i,{className:i,width:this.props.width,height:this.props.height,style:{left:this.props.left,top:this.props.top,cursor:o},onClick:this.handleClick,onWheel:this.handleWheel,onMouseMove:this.handleMove,onDblClick:this.handleStageDoubleClick,onMouseDown:t.mode===O.L.CREATING?this.regionCreationStart:null,onMouseUp:t.mode===O.L.CREATING?this.regionCreationEnd:null,draggable:t.mode!==O.L.CREATING&&this.props.dragPanningEnabled,onDragStart:this.handleDragStart,onDragMove:this.handleDragMove,onDragEnd:this.handleDragEnd,x:0,y:0,children:Object(S.jsxs)(se.e,{children:[n,s,r]})})})}},Le=Object(h.a)(Ne.prototype,"creatingRegion",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=Object(h.a)(Ne.prototype,"currentCursorPos",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Object(h.a)(Ne.prototype,"regionCreationStart",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.creatingRegion)return;const t=e.evt,i=this.props.frame,n=i.regionSet.newRegionType;let r=ue(t.offsetX,t.offsetY,i,this.props.width,this.props.height);switch(i.spatialReference&&(r=Object(D.nb)(i.spatialTransformAST,r,!0)),n){case ne.a.RegionType.POINT:this.creatingRegion=i.regionSet.addPointRegion(r,!1);break;case ne.a.RegionType.RECTANGLE:this.creatingRegion=i.regionSet.addRectangularRegion(r,0,0,!0);break;case ne.a.RegionType.ELLIPSE:this.creatingRegion=i.regionSet.addEllipticalRegion(r,0,0,!0);break;default:return}this.regionStartPoint=r,this.creatingRegion.beginCreating()}}}),Object(h.a)(Ne.prototype,"handleMouseUpRegularRegion",[f.g],Object.getOwnPropertyDescriptor(Ne.prototype,"handleMouseUpRegularRegion"),Ne.prototype),We=Object(h.a)(Ne.prototype,"handleMouseUpPolygonRegion",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;let i=ue(e.offsetX,e.offsetY,t,this.props.width,this.props.height);if(t.spatialReference&&(i=Object(D.nb)(t.spatialTransformAST,i,!0)),this.creatingRegion&&this.creatingRegion.regionType===ne.a.RegionType.POLYGON){if(this.creatingRegion.controlPoints.length){const e=this.creatingRegion.controlPoints[this.creatingRegion.controlPoints.length-1];(Math.abs(e.x-i.x)>.01||Math.abs(e.y-i.y)>.01)&&this.creatingRegion.setControlPoints([...this.creatingRegion.controlPoints,i])}}else this.creatingRegion=t.regionSet.addPolygonalRegion([i],!0),this.creatingRegion.beginCreating();this.handlePolygonRegionMouseMove(e)}}}),Ge=Object(h.a)(Ne.prototype,"handlePolygonRegionMouseMove",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.currentCursorPos={x:e.offsetX,y:e.offsetY}}}}),Ve=Object(h.a)(Ne.prototype,"handleStageDoubleClick",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;this.mouseClickDistance>25||t.regionSet.mode===O.L.CREATING&&this.creatingRegion&&this.creatingRegion.regionType===ne.a.RegionType.POLYGON&&(this.creatingRegion.isValid&&this.creatingRegion.controlPoints.length>2?(this.creatingRegion.endCreating(),t.regionSet.selectRegion(this.creatingRegion),this.creatingRegion=null):(t.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null),setTimeout((()=>this.props.frame.regionSet.setMode(O.L.MOVING)),1))}}}),Be=Object(h.a)(Ne.prototype,"onKeyDown",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.props.frame;t&&t.regionSet.mode===O.L.CREATING&&this.creatingRegion&&27===e.keyCode&&(t.regionSet.deleteRegion(this.creatingRegion),this.creatingRegion=null,t.regionSet.setMode(O.L.MOVING))}}}),De=Ne))||De;var qe;i(821);let Ye=Object(g.a)(qe=class extends p.Component{constructor(...e){super(...e),this.canvas=void 0,this.gl=void 0,this.contourWebGLService=void 0,this.updateCanvas=()=>{const e=O.e.Instance,t=e.activeFrame,i=e.contourFrames;if(t&&this.canvas&&this.gl&&this.contourWebGLService.shaderUniforms){this.resizeAndClearCanvas();for(let n=i.length-1;n>=0;--n)this.renderFrameContours(i[n],t);const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.drawImage(this.gl.canvas,0,0,this.canvas.width,this.canvas.height)}},this.renderFrameContours=(e,t)=>{const i=e===t;let n,r;if(t.spatialReference){let i=t.spatialTransform.origin;const o=t.spatialReference.requiredFrameView,s={x:1/(o.xMax-o.xMin),y:1/(o.yMax-o.yMin)},a=Object(D.kb)(t.spatialTransform.origin,Object(D.eb)(Object(D.cb)(t.spatialTransform.origin,t.spatialTransform.rotation),t.spatialTransform.scale)),l={x:(t.spatialTransform.translation.x-o.xMin+a.x)*s.x,y:(t.spatialTransform.translation.y-o.yMin+a.y)*s.y};this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeScale,s.x,s.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeOffset,l.x,l.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RotationOrigin,i.x,i.y),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.RotationAngle,-t.spatialTransform.rotation),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.ScaleAdjustment,t.spatialTransform.scale),n=devicePixelRatio*e.contourConfig.thickness/(t.spatialReference.zoomLevel*t.spatialTransform.scale),r=Object(D.j)(1/t.spatialReference.zoomLevel,3)}else{const i=t.requiredFrameView,o={x:1/(i.xMax-i.xMin),y:1/(i.yMax-i.yMin)},s={x:-i.xMin*o.x,y:-i.yMin*o.y};this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeOffset,s.x,s.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.RangeScale,o.x,o.y),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.RotationAngle,0),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.ScaleAdjustment,1),n=devicePixelRatio*e.contourConfig.thickness/t.zoomLevel,r=Object(D.j)(1/t.zoomLevel,3)}if(i)this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapEnabled,0),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapTexture,0);else{const i=e.getControlMap(t);i?(this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapEnabled,1),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapMin,i.minPoint.x,i.minPoint.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapMax,i.maxPoint.x,i.maxPoint.y),this.gl.uniform2f(this.contourWebGLService.shaderUniforms.ControlMapSize,i.width,i.height)):console.error("Could not generate control map for contours"),this.gl.activeTexture(D.a.TEXTURE1),this.gl.bindTexture(D.a.TEXTURE_2D,i.getTextureX(this.gl)),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.ControlMapTexture,1)}if(this.gl.uniform1f(this.contourWebGLService.shaderUniforms.LineThickness,n),this.gl.uniform1i(this.contourWebGLService.shaderUniforms.CmapEnabled,e.contourConfig.colormapEnabled?1:0),e.contourConfig.colormapEnabled&&(this.gl.uniform1i(this.contourWebGLService.shaderUniforms.CmapIndex,O.O.COLOR_MAPS_ALL.indexOf(e.contourConfig.colormap)),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.Bias,e.contourConfig.colormapBias),this.gl.uniform1f(this.contourWebGLService.shaderUniforms.Contrast,e.contourConfig.colormapContrast)),e.contourStores){const t=[];e.contourStores.forEach(((e,i)=>t.push(i)));const i=Math.min(...t),n=Math.max(...t),o=e.contourConfig.color;o?this.gl.uniform4f(this.contourWebGLService.shaderUniforms.LineColor,o.r/255,o.g/255,o.b/255,o.a||1):this.gl.uniform4f(this.contourWebGLService.shaderUniforms.LineColor,1,1,1,1),e.contourStores.forEach(((t,o)=>{if(e.contourConfig.colormapEnabled){let e;e=i!==n?(o-i)/(n-i):1,this.gl.uniform1f(this.contourWebGLService.shaderUniforms.CmapValue,e)}const s=e.contourConfig.dashMode,a=s===O.o.Dashed||s===O.o.NegativeOnly&&o<0?8:0;this.gl.uniform1f(this.contourWebGLService.shaderUniforms.DashLength,devicePixelRatio*a*r);for(let e=0;e<t.chunkCount;e++){t.bindBuffer(e);const i=t.numGeneratedVertices[e];this.gl.vertexAttribPointer(this.contourWebGLService.vertexPositionAttribute,3,WebGLRenderingContext.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.contourWebGLService.vertexNormalAttribute,2,WebGLRenderingContext.SHORT,!1,16,12),this.gl.drawArrays(WebGLRenderingContext.TRIANGLE_STRIP,0,i)}}))}}}componentDidMount(){this.contourWebGLService=Z.d.Instance,this.gl=this.contourWebGLService.gl,this.canvas&&this.updateCanvas()}componentDidUpdate(){requestAnimationFrame(this.updateCanvas)}resizeAndClearCanvas(){const e=O.e.Instance.activeFrame;if(!e)return;const t=Math.round(Math.max(1,e.renderWidth*devicePixelRatio)),i=Math.round(Math.max(1,e.renderHeight*devicePixelRatio));this.canvas.width===t&&this.canvas.height===i||(this.canvas.width=t,this.canvas.height=i,this.contourWebGLService.setCanvasSize(t,i)),this.gl.clearColor(0,0,0,0);const n=WebGLRenderingContext.COLOR_BUFFER_BIT|WebGLRenderingContext.DEPTH_BUFFER_BIT|WebGLRenderingContext.STENCIL_BUFFER_BIT;this.gl.clear(n)}render(){const e=O.e.Instance,t=e.activeFrame;if(t){t.requiredFrameView}const i=e.contourFrames;for(const o of i){const e=o.contourConfig;e.thickness,e.colormapEnabled?e.colormap:e.color,e.dashMode,e.colormapBias,e.colormapContrast;o.contourStores.forEach((e=>{e.vertexCount}))}const n=e.overlayStore.padding;let r="contour-div";return this.props.docked&&(r+=" docked"),Object(S.jsx)("div",{className:r,children:Object(S.jsx)("canvas",{id:"contour-canvas",className:"contour-canvas",ref:e=>this.canvas=e,style:{top:n.top,left:n.left,width:t&&t.renderWidth||1,height:t&&t.renderHeight||1}})})}})||qe;var Ue,Xe,$e=i(187),Ke=i.n($e),Qe=i(12);i(824);let Ze=Object(g.a)((Xe=class extends p.Component{constructor(...e){super(...e),this.onClick=e=>{if(e&&e.points&&e.points.length>0){const t=O.k.Instance,i=Number(e.points[0].data.name),n=t.catalogProfileStores.get(i),r=t.catalogWidgets.get(i),o=O.U.Instance.catalogWidgets.get(r);if(i&&!o.showSelectedData){t.updateCatalogProfiles(i);let r=[];const s=e.points[0];r.push(s.pointIndex),n.setSelectedPointIndices(r,!1),o.setCatalogTableAutoScroll(!0)}}},this.onWheelCaptured=e=>{if(e&&e.nativeEvent&&"wheel"===e.nativeEvent.type){const t=e.nativeEvent,i=O.e.Instance.activeFrame,n=15,r=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n;if(i.wcsInfo&&this.props.onZoomed){const e=ue(t.offsetX,t.offsetY,i,2*this.props.width,2*this.props.height);this.props.onZoomed(i.getCursorInfo(e),-r)}}}}get unSelectedData(){const e=O.k.Instance;let t=new Map;return e.catalogData.forEach(((e,i)=>{if(!e.showSelectedData){let n={type:"scattergl",mode:"markers",hoverinfo:"none"};n.visible=e.displayed,n.marker={},n.marker.line={},n.x=e.xImageCoords.slice(0),n.y=e.yImageCoords.slice(0),n.name=i.toString(),t.set(i,n)}})),t}get selectedData(){const e=O.k.Instance;let t=new Map;return e.catalogProfileStores.forEach((i=>{const n=i.selectedPointIndices.length,r=i.catalogFileId;let o={};if(n>0){var s;o.type="scattergl",o.mode="markers",o.hoverinfo="none";const i=e.catalogData.get(r);o.visible=i.displayed,(null===i||void 0===i||null===(s=i.xImageCoords)||void 0===s?void 0:s.length)&&(o.x=i.xSelectedCoords.slice(0),o.y=i.ySelectedCoords.slice(0),o.name=r.toString(),o.marker={},o.marker.line={},t.set(r,o))}})),t}onDoubleClick(){const e=O.k.Instance;e.catalogData.size&&e.catalogProfileStores.forEach((e=>{var t;const i=O.k.Instance.catalogWidgets.get(e.catalogFileId);e.setSelectedPointIndices([],!1),null===(t=O.U.Instance.catalogWidgets.get(i))||void 0===t||t.setCatalogTableAutoScroll(!1)}))}render(){const e=O.e.Instance,t=e.activeFrame,i=2*this.props.width,n=2*this.props.height,r=e.overlayStore.padding,o=O.k.Instance;let s="catalog-div";this.props.docked&&(s+=" docked");let a={width:i,height:n,hovermode:"closest",xaxis:{autorange:!1,showgrid:!1,zeroline:!1,showline:!1,showticklabels:!1},yaxis:{autorange:!1,showgrid:!1,zeroline:!1,showline:!1,showticklabels:!1},margin:{l:0,r:0,b:0,t:0,pad:0},showlegend:!1,dragmode:!1};if(t){const e=t.requiredFrameView;a.xaxis.range=[e.xMin,e.xMax],a.yaxis.range=[e.yMin,e.yMax]}let l=[];const c=this.unSelectedData,d=this.selectedData;return c.forEach(((e,t)=>{const i=o.getCatalogWidgetStore(t),n=i.catalogColor;e.marker.color=n,e.marker.line.color=n,e.marker.line.width=4,e.marker.size=2*i.catalogSize,e.marker.symbol=i.catalogShape,l.push(e)})),d&&d.forEach(((e,t)=>{const i=o.getCatalogWidgetStore(t);e.marker.color=i.highlightColor,e.marker.line.color=i.highlightColor,e.marker.line.width=4,e.marker.size=2*i.catalogSize+5;let n=i.catalogShape;n===Qe.b.FullCircle?n=Qe.b.Circle:n===Qe.b.FullStar?n=Qe.b.Star:n===Qe.b.Plus?n="cross-open":n===Qe.b.Cross&&(n="x-open"),e.marker.symbol=n,l.push(e)})),Object(S.jsx)("div",{className:s,style:{left:r.left,top:r.top},onWheelCapture:this.onWheelCaptured,children:Object(S.jsx)(Ke.a,{className:"catalog-plotly",data:l,layout:a,config:{displayModeBar:!1,showTips:!1,doubleClick:!1,displaylogo:!1,scrollZoom:!1,showAxisDragHandles:!1,setBackground:()=>"transparent"},onClick:this.onClick,onDoubleClick:this.onDoubleClick,style:{transform:"scale(0.5)",transformOrigin:"top left"}})})}},Object(h.a)(Xe.prototype,"unSelectedData",[f.i],Object.getOwnPropertyDescriptor(Xe.prototype,"unSelectedData"),Xe.prototype),Object(h.a)(Xe.prototype,"selectedData",[f.i],Object.getOwnPropertyDescriptor(Xe.prototype,"selectedData"),Xe.prototype),Ue=Xe))||Ue;var Je,et,tt;i(825);const it=(e,t="rgba(255, 255, 255, 0)")=>{var i,n,r,o;const s=document.getElementById("raster-canvas"),a=document.getElementById("contour-canvas"),l=document.getElementById("overlay-canvas");if(!s||!a||!l)return null;let c,d,u;const h=q()(".beam-profile-stage").children().children("canvas");h&&h.length&&(d=h[0]);const p=q()(".region-stage").children().children("canvas");p&&p.length&&(c=p[0]);const g=null===(i=q()(".catalog-plotly"))||void 0===i||null===(n=i.children())||void 0===n||null===(r=n.children())||void 0===r||null===(o=r.children(".gl-container"))||void 0===o?void 0:o.children(".gl-canvas-context");g&&g.length&&(u=g[0]);const f=document.createElement("canvas");f.width=l.width,f.height=l.height;const b=f.getContext("2d");return b.fillStyle=t,b.fillRect(0,0,f.width,f.height),b.drawImage(s,e.left*devicePixelRatio,e.top*devicePixelRatio),b.drawImage(a,e.left*devicePixelRatio,e.top*devicePixelRatio),d&&b.drawImage(d,e.left*devicePixelRatio,e.top*devicePixelRatio),c&&b.drawImage(c,e.left*devicePixelRatio,e.top*devicePixelRatio),u&&(1===devicePixelRatio?b.drawImage(u,e.left*devicePixelRatio,e.top*devicePixelRatio,u.width/2,u.height/2):b.drawImage(u,e.left*devicePixelRatio,e.top*devicePixelRatio)),b.setTransform(1,0,0,1,0,0),b.drawImage(l,0,0),f};let nt;!function(e){e.RegionCreating="regionCreating",e.Catalog="catalog",e.RegionMoving="regionMoving"}(nt||(nt={}));let rt=Object(g.a)((et=class extends p.Component{static get WIDGET_CONFIG(){return{id:"image-view",type:"image-view",minWidth:500,minHeight:500,defaultWidth:600,defaultHeight:600,title:"Image view",isCloseable:!1,helpType:O.x.IMAGE_VIEW}}constructor(e){super(e),this.ratioIndicatorTimeoutHandle=void 0,this.cachedImageSize=void 0,Object(u.a)(this,"showRatioIndicator",tt,this),this.activeLayer=void 0,this.onResize=(e,t)=>{e>0&&t>0&&O.e.Instance.setImageViewDimensions(e,t)},this.onClicked=e=>{const t=O.e.Instance.activeFrame;t&&t.setCenter(e.posImageSpace.x,e.posImageSpace.y)},this.onZoomed=(e,t)=>{const i=O.e.Instance.activeFrame;if(i){const n=1+Math.abs(t/750);if(i.spatialReference){const r=i.spatialReference.zoomLevel*(t>0?n:1/n);i.zoomToPoint(e.posImageSpace.x,e.posImageSpace.y,r,!0)}else{const r=i.zoomLevel*(t>0?n:1/n);i.zoomToPoint(e.posImageSpace.x,e.posImageSpace.y,r,!0)}}},this.onMouseEnter=()=>{O.e.Instance.showImageToolbar()},this.onMouseLeave=()=>{O.e.Instance.hideImageToolbar()},this.handleRegionDoubleClicked=e=>{const t=O.e.Instance;if(e){const i=t.getFrame(e.fileId);i&&(i.regionSet.selectRegion(e),t.dialogStore.showRegionDialog())}},Object(f.p)(this),this.activeLayer=O.e.Instance.activeLayer,Object(f.h)((()=>{const e=O.e.Instance.activeFrame;if(e){const t={x:e.renderWidth,y:e.renderHeight};this.cachedImageSize&&this.cachedImageSize.x===t.x&&this.cachedImageSize.y===t.y||(this.cachedImageSize=t,clearTimeout(this.ratioIndicatorTimeoutHandle),Object(f.s)((()=>this.showRatioIndicator=!0)),this.ratioIndicatorTimeoutHandle=setTimeout((()=>Object(f.s)((()=>{this.showRatioIndicator=!1}))),1e3))}}))}render(){const e=O.e.Instance,t=e.overlayStore;let i;if(e.activeFrame&&e.activeFrame.isRenderable&&e.astReady){const n=e.activeFrame.renderWidth*(e.activeFrame.renderHiDPI?devicePixelRatio:1),r=e.activeFrame.renderHeight*(e.activeFrame.renderHiDPI?devicePixelRatio:1),o={x:t.padding.left+t.viewWidth/2,y:t.padding.top+t.viewHeight/2};i=Object(S.jsxs)(p.Fragment,{children:[e.activeFrame.valid&&Object(S.jsx)(U,{frame:e.activeFrame,overlaySettings:t,docked:this.props.docked}),e.activeFrame.cursorInfo&&Object(S.jsx)($,{cursorInfo:e.activeFrame.cursorInfo,cursorValue:e.activeFrame.cursorInfo.isInsideImage?e.activeFrame.cursorValue.value:void 0,isValueCurrent:e.activeFrame.isCursorValueCurrent,spectralInfo:e.activeFrame.spectralInfo,width:t.viewWidth,left:t.padding.left,right:t.padding.right,docked:this.props.docked,unit:e.activeFrame.unit,top:t.padding.top,currentStokes:e.activeFrame.hasStokes?e.activeFrame.stokesInfo[e.activeFrame.requiredStokes]:"",showImage:!0,showWCS:!0,showValue:!0,showChannel:!1,showSpectral:!0,showStokes:!0}),e.activeFrame&&Object(S.jsx)(le,{top:t.padding.top,left:t.padding.left,docked:this.props.docked,padding:10}),e.activeFrame&&Object(S.jsx)(He,{frame:e.activeFrame,width:e.activeFrame.renderWidth,height:e.activeFrame.renderHeight,top:t.padding.top,left:t.padding.left,onClicked:this.onClicked,onRegionDoubleClicked:this.handleRegionDoubleClicked,onZoomed:this.onZoomed,overlaySettings:t,isRegionCornerMode:e.preferenceStore.isRegionCornerMode,dragPanningEnabled:e.preferenceStore.dragPanning,cursorFrozen:e.cursorFrozen,cursorPoint:e.activeFrame.cursorInfo.posImageSpace,docked:this.props.docked&&(this.activeLayer===nt.RegionMoving||this.activeLayer===nt.RegionCreating)}),e.activeFrame&&Object(S.jsx)(Ze,{width:e.activeFrame.renderWidth,height:e.activeFrame.renderHeight,activeLayer:this.activeLayer,docked:this.props.docked&&e.activeLayer===nt.Catalog,onClicked:this.onClicked,onZoomed:this.onZoomed}),Object(S.jsx)(re,{docked:this.props.docked,visible:e.imageToolbarVisible,vertical:!1,onActiveLayerChange:e.updateActiveLayer,activeLayer:this.activeLayer}),Object(S.jsx)("div",{style:{opacity:this.showRatioIndicator?1:0,left:o.x,top:o.y},className:"tag-image-ratio",children:Object(S.jsxs)(b.S,{large:!0,children:[n," x ",r," (",Object(D.mb)(n/r,2),")"]})})]})}else i=e.astReady?Object(S.jsx)(b.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}):Object(S.jsx)(b.C,{icon:Object(S.jsx)(b.O,{className:"astLoadingSpinner"}),title:"Loading AST Library"});return Object(S.jsxs)("div",{className:"image-view-div",onMouseOver:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[Object(S.jsx)(J,{docked:this.props.docked}),Object(S.jsx)(Ye,{docked:this.props.docked}),i,Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},tt=Object(h.a)(et.prototype,"showRatioIndicator",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=et))||Je;var ot,st=i(418),at=i.n(st);i(847);let lt=Object(g.a)(ot=class extends p.Component{constructor(...e){super(...e),this.onClearClicked=()=>{O.A.Instance.clearLog()},this.onTagClicked=e=>{O.A.Instance.toggleTag(e)},this.onLogLevelChanged=e=>{O.A.Instance.setLevel(parseInt(e.currentTarget.value))},this.isTagHidden=e=>-1!==O.A.Instance.hiddenTags.indexOf(e)}static get WIDGET_CONFIG(){return{id:"log",type:"log",minWidth:300,minHeight:150,defaultWidth:425,defaultHeight:200,title:"Log",isCloseable:!0,helpType:O.x.LOG}}colorFromSeverity(e){switch(e){case ne.a.ErrorSeverity.WARNING:return ae.a.ORANGE3;case ne.a.ErrorSeverity.ERROR:case ne.a.ErrorSeverity.CRITICAL:return ae.a.RED3;default:return ae.a.GRAY1}}intentFromSeverity(e){switch(e){case ne.a.ErrorSeverity.WARNING:return"warning";case ne.a.ErrorSeverity.ERROR:case ne.a.ErrorSeverity.CRITICAL:return"danger";default:return"none"}}render(){const e=O.A.Instance,t=e.logEntries,i=e.hiddenTags;let n=[],r=[];for(let s=0;s<t.length;s++){const o=t[s];if(o.level<e.logLevel)continue;let a=[],l=o.tags.filter((e=>-1===i.indexOf(e)));for(let e=0;e<o.tags.length;e++){const t=o.tags[e];a.push(Object(S.jsx)(b.S,{intent:this.intentFromSeverity(o.level),children:o.tags[e]},e)),-1===n.indexOf(t)&&n.push(t)}l.length&&r.push(Object(S.jsxs)("div",{children:[a,Object(S.jsx)(b.h,{style:{color:this.colorFromSeverity(o.level)},children:o.message})]},s))}const o=n.map(((e,t)=>Object(S.jsx)(b.S,{interactive:!0,minimal:this.isTagHidden(e),intent:this.isTagHidden(e)?"none":"primary",className:this.isTagHidden(e)?"tag-hidden":"",onClick:()=>this.onTagClicked(e),children:e},t)));return Object(S.jsxs)("div",{className:"log",children:[r.length?Object(S.jsx)(at.a,{initialScrollBehavior:"auto",debug:!1,className:"log-entry-list",followButtonClassName:"log-entry-follow",children:r}):Object(S.jsx)(b.C,{className:"log-entry-list",icon:"application",title:"No log entries"}),Object(S.jsxs)("div",{className:"log-footer",children:[Object(S.jsx)(b.p,{inline:!0,label:"Log level:",className:"log-level",children:Object(S.jsxs)(b.r,{value:e.logLevel,onChange:this.onLogLevelChanged,style:{color:this.colorFromSeverity(e.logLevel)},children:[Object(S.jsx)("option",{value:ne.a.ErrorSeverity.DEBUG,style:{color:this.colorFromSeverity(ne.a.ErrorSeverity.DEBUG)},children:"Debug"}),Object(S.jsx)("option",{value:ne.a.ErrorSeverity.INFO,style:{color:this.colorFromSeverity(ne.a.ErrorSeverity.INFO)},children:"Info"}),Object(S.jsx)("option",{value:ne.a.ErrorSeverity.WARNING,style:{color:this.colorFromSeverity(ne.a.ErrorSeverity.WARNING)},children:"Warning"}),Object(S.jsx)("option",{value:ne.a.ErrorSeverity.ERROR,style:{color:this.colorFromSeverity(ne.a.ErrorSeverity.ERROR)},children:"Error"}),Object(S.jsx)("option",{value:ne.a.ErrorSeverity.CRITICAL,style:{color:this.colorFromSeverity(ne.a.ErrorSeverity.CRITICAL)},children:"Critical"})]})}),Object(S.jsx)(b.p,{inline:!0,label:"Visible tags:",className:"tag-list",children:Object(S.jsx)("div",{children:o.length>0?o:"None"})}),Object(S.jsx)("div",{className:"log-footer-right",children:Object(S.jsx)(b.e,{minimal:!0,intent:"warning",icon:"trash",onClick:this.onClearClicked})})]})]})}})||ot;var ct,dt,ut,ht,pt,gt,ft,bt=i(250),mt=i(189),yt=i(147),Ot=i(907),jt=i(18),St=i(415);i(848);let xt=Object(g.a)((dt=class extends p.Component{static get WIDGET_CONFIG(){return{id:"layer-list",type:"layer-list",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Image List",isCloseable:!0,helpType:O.x.LAYER_LIST}}constructor(e){super(e),Object(u.a)(this,"width",ut,this),Object(u.a)(this,"height",ht,this),Object(u.a)(this,"columnWidths",pt,this),Object(u.a)(this,"onColumnWidthsChange",gt,this),Object(u.a)(this,"onResize",ft,this),this.handleFileReordered=(e,t,i)=>{e!==t&&O.e.Instance.reorderFrame(e,t,i)},this.rowHeaderCellRenderer=e=>Object(S.jsx)(bt.a,{name:e.toString(),className:e===O.e.Instance.activeFrameIndex?"active-row-cell":""}),this.onFileSelected=(e,t)=>{const i=t.frameInfo.fileId;e.setActiveFrame(i)},this.fileNameRenderer=e=>{const t=O.e.Instance;if(e<0||e>=t.frames.length)return Object(S.jsx)(mt.a,{});const i=t.frames[e];return Object(S.jsx)(mt.a,{className:e===t.activeFrameIndex?"active-row-cell":"",children:Object(S.jsx)(p.Fragment,{children:Object(S.jsx)("div",{className:"name-cell",onClick:()=>this.onFileSelected(t,i),children:i.filename})})})},this.channelRenderer=e=>{const t=O.e.Instance;return e<0||e>=t.frames.length?Object(S.jsx)(mt.a,{}):Object(S.jsx)(mt.a,{className:e===t.activeFrameIndex?"active-row-cell":"",children:t.frames[e].requiredChannel})},this.stokesRenderer=e=>{const t=O.e.Instance;return e<0||e>=t.frames.length?Object(S.jsx)(mt.a,{}):Object(S.jsx)(mt.a,{className:e===t.activeFrameIndex?"active-row-cell":"",children:t.frames[e].requiredStokes})},this.typeRenderer=e=>{const t=O.e.Instance;if(e<0||e>=t.frames.length)return Object(S.jsx)(mt.a,{});const i=t.frames[e];return Object(S.jsx)(mt.a,{className:e===t.activeFrameIndex?"active-row-cell":"",children:Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.W,{position:"bottom",content:Object(S.jsxs)("span",{children:["Raster layer",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Click to ",i.renderConfig.visible?"hide":"show"]})})]}),children:Object(S.jsx)(b.b,{minimal:!0,small:!0,active:i.renderConfig.visible,intent:i.renderConfig.visible?"success":"none",onClick:i.renderConfig.toggleVisibility,children:"R"})}),i.contourConfig.enabled&&Object(S.jsx)(b.W,{position:"bottom",content:Object(S.jsxs)("span",{children:["Contour layer",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Click to ",i.contourConfig.visible?"hide":"show"]})})]}),children:Object(S.jsx)(b.b,{minimal:!0,small:!0,active:i.contourConfig.visible,intent:i.contourConfig.visible?"success":"none",onClick:i.contourConfig.toggleVisibility,children:"C"})})]})})},this.matchingRenderer=e=>{const t=O.e.Instance;if(e<0||e>=t.frames.length)return Object(S.jsx)(mt.a,{});const i=t.frames[e];let n,r,o;if(t.spatialReference){let e;e=i===t.spatialReference?`${i.filename} is the current spatial reference`:`Click to ${i.spatialReference?"disable":"enable"} matching to ${t.spatialReference.filename}`,n=Object(S.jsx)(b.W,{position:"bottom",content:Object(S.jsxs)("span",{children:["Spatial matching",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsx)("small",{children:e})})]}),children:Object(S.jsx)(b.b,{className:i===t.spatialReference?"outlined":"",minimal:!0,small:!0,active:!!i.spatialReference,intent:i.spatialReference?"success":"none",onClick:()=>t.toggleSpatialMatching(i),children:"XY"})})}if(i.frameInfo.fileInfoExtended.depth>1&&t.spectralReference){let e;e=i===t.spectralReference?`${i.filename} is the current spectral reference`:`Click to ${i.spectralReference?"disable":"enable"} matching to ${t.spectralReference.filename}`,r=Object(S.jsx)(b.W,{position:"bottom",content:Object(S.jsxs)("span",{children:["Spectral matching",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsx)("small",{children:e})})]}),children:Object(S.jsx)(b.b,{className:i===t.spectralReference?"outlined":"",minimal:!0,small:!0,active:!!i.spectralReference,intent:i.spectralReference?"success":"none",onClick:()=>t.toggleSpectralMatching(i),children:"Z"})})}if(t.rasterScalingReference){let e;e=i===t.rasterScalingReference?`${i.filename} is the current raster scaling reference`:`Click to ${i.rasterScalingReference?"disable":"enable"} matching to ${t.rasterScalingReference.filename}`,o=Object(S.jsx)(b.W,{position:"bottom",content:Object(S.jsxs)("span",{children:["Raster scaling matching",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsx)("small",{children:e})})]}),children:Object(S.jsx)(b.b,{className:i===t.rasterScalingReference?"outlined":"",minimal:!0,small:!0,active:!!i.rasterScalingReference,intent:i.rasterScalingReference?"success":"none",onClick:()=>t.toggleRasterScalingMatching(i),children:"R"})})}return Object(S.jsx)(mt.a,{className:e===t.activeFrameIndex?"active-row-cell":"",children:Object(S.jsxs)(p.Fragment,{children:[n,r,o]})})},this.columnHeaderRenderer=e=>{let t;switch(e){case 0:t="Image";break;case 1:t="Layers";break;case 2:t="Matching";break;case 3:t="Channel";break;case 4:t="Stokes"}return Object(S.jsx)(yt.a,{name:t,style:{fontSize:"12",fontWeight:"bold"}})},this.contextMenuRenderer=e=>{const t=e.getTarget().rows,i=O.e.Instance;if(t&&t.length&&i.frames[t[0]]){const e=i.frames[t[0]];var n,r;if(e)return Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.A,{title:e.filename}),Object(S.jsx)(b.B,{disabled:i.spatialReference===e,text:"Set as spatial reference",onClick:()=>i.setSpatialReference(e)}),Object(S.jsx)(b.B,{disabled:i.spectralReference===e||e.frameInfo.fileInfoExtended.depth<=1,text:"Set as spectral reference",onClick:()=>i.setSpectralReference(e)}),Object(S.jsx)(b.B,{disabled:i.rasterScalingReference===e,text:"Set as raster scaling reference",onClick:()=>i.setRasterScalingReference(e)}),Object(S.jsx)(b.A,{}),Object(S.jsx)(b.B,{text:"Close image",onClick:()=>i.closeFile(e)}),Object(S.jsx)(b.B,{text:"Close other images",disabled:(null===(n=i.frames)||void 0===n?void 0:n.length)<=1,onClick:()=>i.closeOtherFiles(e)}),Object(S.jsx)(b.B,{text:"Close all images",disabled:(null===(r=i.frames)||void 0===r?void 0:r.length)<=1,onClick:()=>i.closeOtherFiles(null,!1)})]})}return null},Object(f.p)(this)}render(){const e=O.e.Instance,t=e.frameNum;if(t<=0)return Object(S.jsxs)("div",{className:"layer-list-widget",children:[Object(S.jsx)(b.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),";",Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]});e.frameChannels,e.frameStokes,e.activeFrameIndex,e.frames.map((e=>e.renderConfig.visible)),e.frames.map((e=>e.contourConfig.visible&&e.contourConfig.enabled)),e.frames.map((e=>e.spatialReference)),e.frames.map((e=>e.spectralReference)),e.frames.map((e=>e.rasterScalingReference)),e.spectralReference,e.spatialReference,e.rasterScalingReference;return Object(S.jsxs)("div",{className:"layer-list-widget",children:[this.width>0&&Object(S.jsxs)(Ot.a,{numRows:t,rowHeaderCellRenderer:this.rowHeaderCellRenderer,enableRowHeader:!0,enableRowReordering:!0,enableRowResizing:!1,selectionModes:jt.d.ROWS_ONLY,enableMultipleSelection:!0,onRowsReordered:this.handleFileReordered,columnWidths:this.columnWidths,enableColumnResizing:!0,onColumnWidthChanged:this.onColumnWidthsChange,bodyContextMenuRenderer:this.contextMenuRenderer,children:[Object(S.jsx)(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.fileNameRenderer}),Object(S.jsx)(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.typeRenderer}),Object(S.jsx)(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.matchingRenderer}),Object(S.jsx)(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.channelRenderer}),Object(S.jsx)(St.a,{columnHeaderCellRenderer:this.columnHeaderRenderer,cellRenderer:this.stokesRenderer})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},ut=Object(h.a)(dt.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ht=Object(h.a)(dt.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),pt=Object(h.a)(dt.prototype,"columnWidths",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[132,70,110,75,67]}}),gt=Object(h.a)(dt.prototype,"onColumnWidthsChange",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{!Number.isInteger(e)||e<0||e>=this.columnWidths.length||t<=0||(this.columnWidths[e]=t,this.forceUpdate())}}}),ft=Object(h.a)(dt.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),ct=dt))||ct;var Ct,It=i(53);i(850);let wt=Object(g.a)(Ct=class extends p.Component{constructor(...e){super(...e),this.handleRegionTypeClicked=e=>{const t=O.e.Instance;t.activeFrame.regionSet.setNewRegionType(e),t.activeFrame.regionSet.setMode(O.L.CREATING)},this.regionTooltip=e=>{const t=O.e.Instance.preferenceStore.regionCreationMode===Q.RegionCreationMode.CENTER;return Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Click-and-drag to define a region (",t?"center to corner":"corner to corner",").",Object(S.jsx)("br",{}),"Hold Ctrl to define a region (",t?"corner to corner":"center to corner",").",Object(S.jsx)("br",{}),"Change the default creation mode in Preferences.",Object(S.jsx)("br",{}),"Hold shift key to create a ",e,"."]})})]})}}render(){const e=O.e.Instance,t=e.dialogStore;let i="toolbar-menu",n="dialog-toolbar-menu",r="actions-toolbar-menu";e.darkTheme&&(i+=" bp3-dark",n+=" bp3-dark",r+=" bp3-dark");const o=!!e.activeFrame&&e.activeFrame.regionSet.mode===O.L.CREATING,s=e.activeFrame?e.activeFrame.regionSet.newRegionType:ne.a.RegionType.RECTANGLE,a=!e.activeFrame||e.activeLayer===nt.Catalog,l=Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Drag to place docked widget",Object(S.jsx)("br",{}),"Click to place a floating widget"]})})]});return Object(S.jsxs)(p.Fragment,{children:[Object(S.jsxs)(b.f,{className:r,children:[Object(S.jsx)(b.W,{content:Object(S.jsx)("span",{children:"Point"}),children:Object(S.jsx)(b.b,{icon:"symbol-square",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.POINT),active:o&&s===ne.a.RegionType.POINT,disabled:a})}),Object(S.jsx)(b.W,{content:Object(S.jsxs)("span",{children:["Rectangle",this.regionTooltip("square")]}),children:Object(S.jsx)(b.b,{icon:"square",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.RECTANGLE),active:o&&s===ne.a.RegionType.RECTANGLE,disabled:a})}),Object(S.jsx)(b.W,{content:Object(S.jsxs)("span",{children:["Ellipse",this.regionTooltip("circle")]}),children:Object(S.jsx)(b.b,{icon:"circle",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.ELLIPSE),active:o&&s===ne.a.RegionType.ELLIPSE,disabled:a})}),Object(S.jsx)(b.W,{content:Object(S.jsxs)("span",{children:["Polygon",Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Define control points with a series of clicks.",Object(S.jsx)("br",{}),"Double-click to close the loop and finish polygon creation.",Object(S.jsx)("br",{}),"Double-click on a control point to delete it.",Object(S.jsx)("br",{}),"Click on a side to create a new control point."]})})]})]}),children:Object(S.jsx)(b.b,{icon:"polygon-filter",onClick:()=>this.handleRegionTypeClicked(ne.a.RegionType.POLYGON),active:o&&s===ne.a.RegionType.POLYGON,disabled:a})})]}),Object(S.jsx)(b.f,{className:i,children:Array.from(O.U.Instance.CARTAWidgets.keys()).map((e=>{const t=O.U.Instance.CARTAWidgets.get(e),i=e.replace(/\s+/g,"");return Object(S.jsx)(b.W,{content:Object(S.jsxs)("span",{children:[e,l]}),children:Object(S.jsx)(b.b,{icon:t.isCustomIcon?Object(S.jsx)(It.a,{icon:t.icon}):t.icon,id:`${i}Button`,onClick:t.onClick})},`${i}Tooltip`)}))}),Object(S.jsxs)(b.f,{className:n,children:[Object(S.jsx)(b.W,{content:Object(S.jsx)("span",{children:"File Header"}),children:Object(S.jsx)(b.b,{icon:"app-header",onClick:t.showFileInfoDialog,active:t.fileInfoDialogVisible})}),Object(S.jsx)(b.W,{content:Object(S.jsx)("span",{children:"Preferences"}),children:Object(S.jsx)(b.b,{icon:"wrench",onClick:t.showPreferenceDialog,active:t.preferenceDialogVisible})}),Object(S.jsx)(b.W,{content:Object(S.jsx)("span",{children:"Contours"}),children:Object(S.jsx)(b.b,{icon:Object(S.jsx)(It.a,{icon:"contour"}),onClick:t.showContourDialog,active:t.contourDialogVisible})})]})]})}})||Ct;var Tt,vt,At;i(851);let Rt=Object(g.a)((vt=class extends p.Component{constructor(e){super(e),Object(u.a)(this,"documentationAlertVisible",At,this),this.documentationAlertTimeoutHandle=void 0,this.handleDashboardClicked=()=>{window.open(Z.a.RuntimeConfig.dashboardAddress,"_blank")},this.genWidgetsMenu=()=>{const e=O.U.Instance.CARTAWidgets.get(O.T.Region),t=O.U.Instance.CARTAWidgets.get(O.T.ImageList),i=O.U.Instance.CARTAWidgets.get(O.T.Log),n=O.U.Instance.CARTAWidgets.get(O.T.SpatialProfiler),r=O.U.Instance.CARTAWidgets.get(O.T.SpectralProfiler),o=Array.from(O.U.Instance.CARTAWidgets.keys()).filter((e=>![O.T.Region,O.T.ImageList,O.T.Log,O.T.SpatialProfiler,O.T.SpectralProfiler].includes(e)));return Object(S.jsxs)(b.z,{className:"widgets-menu",children:[Object(S.jsxs)(b.z.Item,{text:"Info Panels",icon:"panel-stats",children:[Object(S.jsx)(b.z.Item,{text:O.T.Region,icon:Object(S.jsx)(It.a,{icon:e.icon}),onClick:e.onClick}),Object(S.jsx)(b.z.Item,{text:O.T.ImageList,icon:t.icon,onClick:t.onClick}),Object(S.jsx)(b.z.Item,{text:O.T.Log,icon:i.icon,onClick:i.onClick})]}),Object(S.jsxs)(b.z.Item,{text:"Profiles",icon:"pulse",children:[Object(S.jsx)(b.z.Item,{text:O.T.SpatialProfiler,icon:Object(S.jsx)(It.a,{icon:n.icon}),onClick:n.onClick}),Object(S.jsx)(b.z.Item,{text:O.T.SpectralProfiler,icon:Object(S.jsx)(It.a,{icon:r.icon}),onClick:r.onClick})]}),o.map((e=>{const t=O.U.Instance.CARTAWidgets.get(e),i=e.replace(/\s+/g,"");return Object(S.jsx)(b.z.Item,{text:e,icon:t.isCustomIcon?Object(S.jsx)(It.a,{icon:t.icon}):t.icon,onClick:t.onClick},`${i}Menu`)}))]})},this.handleDocumentationClicked=()=>{window.open("https://carta.readthedocs.io/en/1.4","_blank","width=1024"),"linux"!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET&&"darwin"!==Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET&&(this.documentationAlertVisible=!0,clearTimeout(this.documentationAlertTimeoutHandle),this.documentationAlertTimeoutHandle=setTimeout((()=>this.documentationAlertVisible=!1),1e4))},this.handleAlertDismissed=()=>{this.documentationAlertVisible=!1},this.handleFrameSelect=e=>{const t=O.e.Instance;t.activeFrame&&t.activeFrame.frameInfo.fileId===e||t.setActiveFrame(e)},Object(f.p)(this)}render(){const e=O.e.Instance,t=e.modifierString,i=e.backendService.connectionStatus;let n=[];let r;e.apiService.authenticated&&Z.a.RuntimeConfig.apiAddress&&n.push(Object(S.jsx)(b.z.Item,{text:"Restart Service",disabled:!e.apiService.authenticated,onClick:e.apiService.stopServer},"restart")),(Z.a.RuntimeConfig.logoutAddress||Z.a.RuntimeConfig.googleClientId)&&n.push(Object(S.jsx)(b.z.Item,{text:"Logout",disabled:!e.apiService.authenticated,onClick:e.apiService.logout},"logout")),Z.a.RuntimeConfig.dashboardAddress&&n.push(Object(S.jsx)(b.z.Item,{text:"Dashboard",onClick:this.handleDashboardClicked},"dashboard")),n.length&&(r=Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.z.Divider,{}),Object(S.jsx)(b.z.Item,{text:"Server",children:n})]}));const o=Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.z.Item,{text:"Open image",label:`${t}O`,disabled:i!==Z.c.ACTIVE||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.File,!1)}),Object(S.jsx)(b.z.Item,{text:"Append image",label:`${t}L`,disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.File,!0)}),Object(S.jsx)(b.z.Item,{text:"Save image",label:`${t}S`,disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.SaveFile,!1)}),Object(S.jsx)(b.z.Item,{text:"Close image",label:`${t}W`,disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.closeCurrentFile(!0)}),Object(S.jsx)(b.z.Divider,{}),Object(S.jsx)(b.z.Item,{text:"Import regions",disabled:!e.activeFrame,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.RegionImport,!1)}),Object(S.jsx)(b.z.Item,{text:"Export regions",disabled:!e.activeFrame||!e.activeFrame.regionSet.regions||e.activeFrame.regionSet.regions.length<=1,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.RegionExport,!1)}),Object(S.jsx)(b.z.Divider,{}),Object(S.jsx)(b.z.Item,{text:"Import catalog",label:`${t}G`,disabled:i!==Z.c.ACTIVE||!e.activeFrame||e.fileLoading,onClick:()=>e.fileBrowserStore.showFileBrowser(O.g.Catalog,!1)}),Object(S.jsx)(b.z.Divider,{}),Object(S.jsx)(b.z.Item,{text:"Export image",label:`${t}E`,disabled:!e.activeFrame,onClick:e.exportImage}),Object(S.jsx)(b.z.Item,{text:"Preferences",onClick:e.dialogStore.showPreferenceDialog,disabled:e.preferenceStore.supportsServer&&i!==Z.c.ACTIVE}),r]});let s=e.frames.map((t=>Object(S.jsx)(b.z.Item,{text:t.filename,active:e.activeFrame&&e.activeFrame.frameInfo.fileId===t.frameInfo.fileId,onClick:()=>this.handleFrameSelect(t.frameInfo.fileId)},t.frameInfo.fileId)));const a=Q.PresetLayout.PRESETS,l=e.layoutStore,c=l.userLayoutNames,d=Object(S.jsxs)(b.z,{children:[Object(S.jsxs)(b.z.Item,{text:"Theme",icon:"media",children:[Object(S.jsx)(b.z.Item,{text:"Automatic",icon:"contrast",onClick:e.setAutoTheme}),Object(S.jsx)(b.z.Item,{text:"Light",icon:"flash",onClick:e.setLightTheme}),Object(S.jsx)(b.z.Item,{text:"Dark",icon:"moon",onClick:e.setDarkTheme})]}),Object(S.jsxs)(b.z.Item,{text:"Layouts",icon:"page-layout",disabled:l.supportsServer&&i!==Z.c.ACTIVE,children:[Object(S.jsxs)(b.z.Item,{text:"Existing Layouts",disabled:!a&&!c,children:[a&&a.length>0&&a.map((t=>Object(S.jsx)(b.z.Item,{text:t,active:t===e.layoutStore.currentLayoutName,onClick:()=>e.layoutStore.applyLayout(t)},t))),c&&c.length>0&&Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.A,{}),c.map((t=>Object(S.jsx)(b.z.Item,{text:t,active:t===e.layoutStore.currentLayoutName,onClick:()=>e.layoutStore.applyLayout(t)},t)))]})]}),Object(S.jsx)(b.z.Item,{text:"Save Layout",onClick:e.dialogStore.showSaveLayoutDialog}),Object(S.jsx)(b.z.Item,{text:"Delete Layout",disabled:!c||c.length<=0,children:c&&c.length>0&&c.map((t=>Object(S.jsx)(b.z.Item,{text:t,active:t===e.layoutStore.currentLayoutName,onClick:()=>{e.layoutStore.deleteLayout(t),t===e.preferenceStore.layout&&e.preferenceStore.setPreference(O.G.GLOBAL_LAYOUT,Q.PresetLayout.DEFAULT)}},t)))})]}),s.length>0&&Object(S.jsxs)(b.z.Item,{text:"Images",icon:"multi-select",children:[s,Object(S.jsx)(b.z.Divider,{}),Object(S.jsx)(b.z.Item,{text:"Previous image",icon:"step-backward",disabled:s.length<2,onClick:e.prevFrame}),Object(S.jsx)(b.z.Item,{text:"Next image",icon:"step-forward",disabled:s.length<2,onClick:e.nextFrame})]}),Object(S.jsx)(b.z.Item,{text:"File header",icon:"app-header",disabled:!e.activeFrame,onClick:e.dialogStore.showFileInfoDialog}),Object(S.jsx)(b.z.Item,{text:"Contours",icon:Object(S.jsx)(It.a,{icon:"contour"}),onClick:e.dialogStore.showContourDialog})]}),u=Object(S.jsxs)(b.z,{children:[Object(S.jsx)(b.z.Item,{text:"Online Manual",icon:"manual",onClick:this.handleDocumentationClicked}),Object(S.jsx)(b.z.Item,{text:"Controls and Shortcuts",icon:"key-control",label:"Shift + ?",onClick:e.dialogStore.showHotkeyDialog}),Object(S.jsx)(b.z.Item,{text:"Debug Execution",icon:"console",onClick:e.dialogStore.showDebugExecutionDialog}),Object(S.jsx)(b.z.Item,{text:"About",icon:"info-sign",onClick:e.dialogStore.showAboutDialog})]});let h,g="connectivity-icon";const f=isFinite(e.backendService.endToEndPing)?`${Object(D.mb)(e.backendService.endToEndPing,1)} ms`:"Unknown",y=e.username?` as ${e.username}`:"";switch(i){case Z.c.PENDING:h=Object(S.jsxs)("span",{children:["Connecting to server",y]}),g+=" warning";break;case Z.c.ACTIVE:e.backendService.connectionDropped?(h=Object(S.jsxs)("span",{children:["Reconnected to server ",y," after disconnect. Some errors may occur",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Latency: ",f]})})]}),g+=" warning"):(h=Object(S.jsxs)("span",{children:["Connected to server ",y,Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Latency: ",f,Object(S.jsx)("br",{}),"Session ID: ",e.backendService.sessionId,Object(S.jsx)("br",{}),e.backendService.grpcPort>0&&Object(S.jsxs)("span",{children:["GRPC Port: ",e.backendService.grpcPort]})]})})]}),g+=" online");break;case Z.c.CLOSED:default:h=Object(S.jsx)("span",{children:"Disconnected from server"}),g+=" offline"}const j=e.tileService.remainingTiles>0,x=e.activeFrame&&e.activeFrame.contourProgress>=0&&e.activeFrame.contourProgress<1;let C,I,w="contour-loading-icon";if(j||x){let t,i;j&&(t=Object(S.jsxs)("span",{children:["Streaming image tiles. ",e.tileService.remainingTiles," remaining"]})),x&&(i=Object(S.jsxs)("span",{children:["Streaming contours. ",Object(D.mb)(100*e.activeFrame.contourProgress,1),"% complete"]})),C=Object(S.jsxs)(p.Fragment,{children:[t,x&&j&&Object(S.jsx)("br",{}),i]}),w+=" icon-visible"}return I=C?Object(S.jsx)(b.W,{content:C,children:Object(S.jsx)(b.w,{icon:"cloud-download",className:w})}):Object(S.jsx)(b.w,{icon:"cloud-download",className:w}),Object(S.jsxs)("div",{className:"root-menu",children:[Object(S.jsx)(b.F,{autoFocus:!1,minimal:!0,content:o,position:m.a.BOTTOM_LEFT,children:Object(S.jsx)(b.z,{className:"root-menu-entry",children:Object(S.jsx)(b.z.Item,{text:"File"})})}),Object(S.jsx)(b.F,{autoFocus:!1,minimal:!0,content:d,position:m.a.BOTTOM_LEFT,children:Object(S.jsx)(b.z,{className:"root-menu-entry",children:Object(S.jsx)(b.z.Item,{text:"View"})})}),Object(S.jsx)(b.F,{autoFocus:!1,minimal:!0,content:this.genWidgetsMenu(),position:m.a.BOTTOM_LEFT,children:Object(S.jsx)(b.z,{className:"root-menu-entry",children:Object(S.jsx)(b.z.Item,{text:"Widgets"})})}),Object(S.jsx)(b.F,{autoFocus:!1,minimal:!0,content:u,position:m.a.BOTTOM_LEFT,children:Object(S.jsx)(b.z,{className:"root-menu-entry",children:Object(S.jsx)(b.z.Item,{text:"Help"})})}),Object(S.jsx)(wt,{}),Object(S.jsx)(b.a,{className:e.darkTheme?"bp3-dark":"",isOpen:this.documentationAlertVisible,onClose:this.handleAlertDismissed,canEscapeKeyCancel:!0,canOutsideClickCancel:!0,confirmButtonText:"Dismiss",children:"Documentation will open in a new tab. Please ensure any popup blockers are disabled."}),I,e.preferenceStore.lowBandwidthMode&&Object(S.jsx)(b.W,{content:Object(S.jsxs)("span",{children:["CARTA is running in low bandwidth mode",Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsx)("small",{children:"Image resolution and cursor responsiveness will be reduced"})})]}),children:Object(S.jsx)(b.w,{icon:"feed",className:"connectivity-icon warning"})}),Object(S.jsx)(b.W,{content:h,children:Object(S.jsx)(b.w,{icon:"symbol-circle",className:g})}),Object(S.jsxs)("div",{id:"hidden-status-info",children:[Object(S.jsx)("span",{id:"info-session-id",children:e.backendService.sessionId}),Object(S.jsx)("span",{id:"info-grpc-port",children:e.backendService.grpcPort}),Object(S.jsx)("span",{id:"info-server-url",children:e.backendService.serverUrl})]})]})}},At=Object(h.a)(vt.prototype,"documentationAlertVisible",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt=vt))||Tt;var Pt;i(852);let Et=Object(g.a)(Pt=class extends p.Component{static get WIDGET_CONFIG(){return{id:"placeholder",type:"placeholder",minWidth:225,minHeight:225,defaultWidth:300,defaultHeight:225,title:"Placeholder",isCloseable:!0,helpType:O.x.PLACEHOLDER}}render(){return Object(S.jsx)("div",{className:"placeholder-container",children:Object(S.jsx)("h1",{children:this.props.label})})}})||Pt;var Ft,Mt,kt;const Dt=M.a.ofType();let Nt=Object(g.a)((Mt=class extends p.Component{constructor(e){super(e),Object(u.a)(this,"showCubeHistogramAlert",kt,this),this.renderHistogramSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(S.jsx)(b.B,{text:e?"Per-Cube":"Per-Channel",onClick:t},e?"cube":"channel"),this.handleInvertedChanged=e=>{this.props.renderConfig.setInverted(e.currentTarget.checked)},this.handleHistogramChange=e=>{e&&!this.props.renderConfig.cubeHistogram?this.props.warnOnCubeHistogram?this.showCubeHistogramAlert=!0:this.handleAlertConfirm():this.props.renderConfig.setUseCubeHistogram(e)},this.handleAlertConfirm=()=>{this.props.onCubeHistogramSelected(),this.showCubeHistogramAlert=!1},this.handleAlertCancel=()=>{this.showCubeHistogramAlert=!1},Object(f.p)(this)}render(){if(!this.props.renderConfig)return null;const e=this.props.renderConfig;return Object(S.jsxs)(p.Fragment,{children:[this.props.showHistogramSelect&&Object(S.jsx)(b.p,{label:"Histogram",inline:!0,disabled:this.props.disableHistogramSelect,children:Object(S.jsx)(Dt,{activeItem:e.useCubeHistogram,popoverProps:j.m,filterable:!1,items:[!0,!1],onItemSelect:this.handleHistogramChange,itemRenderer:this.renderHistogramSelectItem,disabled:this.props.disableHistogramSelect,children:Object(S.jsx)(b.e,{text:e.useCubeHistogram?"Per-Cube":"Per-Channel",rightIcon:"double-caret-vertical",alignText:"right",disabled:this.props.disableHistogramSelect})})}),Object(S.jsx)(b.p,{label:"Scaling",inline:!0,children:Object(S.jsx)(j.o,{selectedItem:e.scaling,onItemSelect:e.setScaling})}),Object(S.jsx)(b.p,{label:"Color map",inline:!0,children:Object(S.jsx)(j.d,{inverted:e.inverted,selectedItem:e.colorMap,onItemSelect:e.setColorMap})}),Object(S.jsx)(b.p,{label:"Invert color map",inline:!0,children:Object(S.jsx)(b.P,{checked:e.inverted,onChange:this.handleInvertedChanged})}),(e.scaling===O.u.LOG||e.scaling===O.u.POWER)&&Object(S.jsx)(b.p,{label:"Alpha",inline:!0,children:Object(S.jsx)(j.n,{buttonPosition:"none",value:e.alpha,onValueChange:e.setAlpha})}),e.scaling===O.u.GAMMA&&Object(S.jsx)(b.p,{label:"Gamma",inline:!0,children:Object(S.jsx)(j.n,{min:O.O.GAMMA_MIN,max:O.O.GAMMA_MAX,stepSize:.1,minorStepSize:.01,majorStepSize:.5,value:e.gamma,onValueChange:e.setGamma})}),Object(S.jsx)(b.a,{className:O.e.Instance.darkTheme?"bp3-dark":"",icon:"time",isOpen:this.showCubeHistogramAlert,onCancel:this.handleAlertCancel,onConfirm:this.handleAlertConfirm,cancelButtonText:"Cancel",children:Object(S.jsx)("p",{children:"Calculating a cube histogram may take a long time, depending on the size of the file. Are you sure you want to continue?"})})]})}},kt=Object(h.a)(Mt.prototype,"showCubeHistogramAlert",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=Mt))||Ft;var Lt,_t,zt,Wt,Gt,Vt=i(61);i(873);let Bt=Object(g.a)((_t=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"render-config",type:"render-config",minWidth:250,minHeight:225,defaultWidth:650,defaultHeight:225,title:"Render Configuration",isCloseable:!0,helpType:O.x.RENDER_CONFIG}}get widgetStore(){const e=O.U.Instance;if(e.renderConfigWidgets){const t=e.renderConfigWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.n}get plotData(){const e=O.e.Instance.activeFrame;if(e&&e.renderConfig.histogram&&e.renderConfig.histogram.bins&&e.renderConfig.histogram.bins.length){const t=e.renderConfig.histogram;let i=0,n=t.bins.length-1;this.widgetStore.isAutoScaledX||(i=Math.floor((this.widgetStore.minX-t.firstBinCenter)/t.binWidth),i=Object(D.k)(i,0,t.bins.length-1),n=Math.ceil((this.widgetStore.maxX-t.firstBinCenter)/t.binWidth),n=Object(D.k)(n,0,t.bins.length-1));let r,o=t.firstBinCenter+t.binWidth*i,s=t.firstBinCenter+t.binWidth*n,a=t.bins[i],l=a;const c=n-i;if(c>0&&!isNaN(c)){r=new Array(n-i);for(let e=i;e<=n;e++)r[e-i]={x:t.firstBinCenter+t.binWidth*e,y:t.bins[e]},a=Math.min(a,t.bins[e]),l=Math.max(l,t.bins[e])}return{values:r,xMin:o,xMax:s,yMin:a,yMax:l}}return null}constructor(t){super(t),this.cachedFrame=void 0,this.cachedHistogram=void 0,Object(u.a)(this,"width",zt,this),Object(u.a)(this,"height",Wt,this),this.handleScaleMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=O.e.Instance.activeFrame;i&&isFinite(t)&&t!==i.renderConfig.scaleMinVal&&i.renderConfig.setCustomScale(t,i.renderConfig.scaleMaxVal)},this.handleScaleMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=O.e.Instance.activeFrame;i&&isFinite(t)&&t!==i.renderConfig.scaleMaxVal&&i.renderConfig.setCustomScale(i.renderConfig.scaleMinVal,t)},Object(u.a)(this,"onResize",Gt,this),this.handlePercentileRankClick=e=>{const t=O.e.Instance;t.activeFrame.renderConfig.setPercentileRank(e)||(t.alertStore.showAlert(`Couldn't set percentile of rank ${e}%`),t.logStore.addError(`Couldn't set percentile of rank ${e}%`,["render"]))},this.handlePercentileRankSelectChanged=e=>{O.e.Instance.activeFrame.renderConfig.setPercentileRank(+e.currentTarget.value)},this.setCustomPercentileRank=()=>{O.e.Instance.activeFrame.renderConfig.setPercentileRank(-1)},this.handleCubeHistogramSelected=()=>{const e=O.e.Instance,t=e.activeFrame;t&&t.renderConfig&&(t.renderConfig.setUseCubeHistogram(!0),t.renderConfig.cubeHistogramProgress<1&&e.requestCubeHistogram())},this.handleCubeHistogramCancelled=()=>{const e=O.e.Instance,t=e.activeFrame;t&&t.renderConfig&&t.renderConfig.setUseCubeHistogram(!1),e.cancelCubeHistogramRequest()},this.onMinMoved=e=>{const t=O.e.Instance.activeFrame;t&&t.renderConfig&&e<t.renderConfig.scaleMaxVal&&t.renderConfig.setCustomScale(e,t.renderConfig.scaleMaxVal)},this.onMaxMoved=e=>{const t=O.e.Instance.activeFrame;t&&t.renderConfig&&e>t.renderConfig.scaleMinVal&&t.renderConfig.setCustomScale(t.renderConfig.scaleMinVal,e)},this.onGraphCursorMoved=Y.throttle((e=>{this.widgetStore.setCursor(e)}),100),this.genProfilerInfo=()=>{let e=[];if(void 0!==this.widgetStore.cursorX){let t;t=this.widgetStore.cursorX<.01?Object(D.lb)(this.widgetStore.cursorX,2):Object(D.mb)(this.widgetStore.cursorX,2);const i=O.e.Instance.activeFrame;i.unit&&(t+=` ${i.unit}`),e.push(`Cursor: ${t}`)}return e},Object(f.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.renderConfigWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.renderConfigWidgets.set(this.props.id,new Qe.n));else{const e=i.widgetsStore.addRenderConfigWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(f.h)((()=>{if(i.activeFrame){const e=i.activeFrame.renderConfig.histogram;e!==this.cachedHistogram&&(this.cachedHistogram=e,this.widgetStore.clearXYBounds())}const e=this.widgetStore;if(e){const t=this.plotData;t&&e.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}}))}componentDidUpdate(){const e=O.e.Instance.activeFrame;e!==this.cachedFrame&&(this.cachedFrame=e,this.widgetStore.clearXYBounds())}render(){const e=O.e.Instance,t=e.activeFrame;if(!t||!this.widgetStore)return Object(S.jsx)("div",{className:"render-config-container",children:Object(S.jsx)(b.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});let i="Value";t&&t.unit&&(i=`Value (${t.unit})`);const n=t.filename,r=`channel ${t.channel} histogram`;let o={xLabel:i,darkMode:e.darkTheme,imageName:n,plotName:r,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,showYAxisTicks:!1,showYAxisLabel:!1,graphClicked:this.onMinMoved,graphRightClicked:this.onMaxMoved,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2};if(t.renderConfig.histogram&&t.renderConfig.histogram.bins&&t.renderConfig.histogram.bins.length){const t=this.plotData;if(t){o.data=t.values;let i=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(i=ae.a.BLUE4)),o.lineColor=i,this.widgetStore.isAutoScaledX?(o.xMin=t.xMin,o.xMax=t.xMax):(o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(o.yMin=t.yMin,o.yMax=t.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5)}}t.renderConfig&&(o.markers=[{value:t.renderConfig.scaleMinVal,id:"marker-min",label:this.widgetStore.markerTextVisible?"Min":void 0,draggable:!0,dragCustomBoundary:{xMax:t.renderConfig.scaleMaxVal},dragMove:this.onMinMoved,horizontal:!1},{value:t.renderConfig.scaleMaxVal,id:"marker-max",label:this.widgetStore.markerTextVisible?"Max":void 0,draggable:!0,dragCustomBoundary:{xMin:t.renderConfig.scaleMinVal},dragMove:this.onMaxMoved,horizontal:!1}],this.widgetStore.meanRmsVisible&&t.renderConfig.histogram&&t.renderConfig.histogram.stdDev>0&&(o.markers.push({value:t.renderConfig.histogram.mean,id:"marker-mean",draggable:!1,horizontal:!1,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2,dash:[5]}),o.markers.push({value:t.renderConfig.histogram.mean,id:"marker-rms",draggable:!1,horizontal:!1,width:t.renderConfig.histogram.stdDev,opacity:.2,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2})));const s=this.width>600;let a,l;if(s){const e=O.O.PERCENTILE_RANKS.map((e=>Object(S.jsx)(b.e,{small:!0,onClick:()=>this.handlePercentileRankClick(e),active:t.renderConfig.selectedPercentileVal===e,children:`${e}%`},e)));e.push(Object(S.jsx)(b.e,{small:!0,onClick:this.setCustomPercentileRank,active:-1===t.renderConfig.selectedPercentileVal,children:"Custom"},-1)),a=Object(S.jsx)("div",{className:"percentile-buttons",children:Object(S.jsx)(b.f,{fill:!0,children:e})})}else{const e=O.O.PERCENTILE_RANKS.map((e=>({label:`${e}%`,value:e})));e.push({label:"Custom",value:-1}),l=Object(S.jsx)("div",{className:"percentile-select",children:Object(S.jsx)(b.p,{label:"Clip Percentile",inline:!0,children:Object(S.jsx)(b.r,{options:e,value:t.renderConfig.selectedPercentileVal,onChange:this.handlePercentileRankSelectChanged})})})}return Object(S.jsxs)("div",{className:"render-config-container",children:[this.width>430&&Object(S.jsxs)("div",{className:"histogram-container",children:[s?a:l,Object(S.jsxs)("div",{className:"histogram-plot",children:[Object(S.jsx)(j.f,{...o}),this.width>=430&&Object(S.jsx)(j.l,{info:this.genProfilerInfo()})]})]}),Object(S.jsxs)("div",{className:"colormap-config",children:[Object(S.jsx)(Nt,{darkTheme:e.darkTheme,renderConfig:t.renderConfig,onCubeHistogramSelected:this.handleCubeHistogramSelected,showHistogramSelect:t.frameInfo.fileInfoExtended.depth>1,disableHistogramSelect:e.animatorStore.animationActive,warnOnCubeHistogram:0===(t.frameInfo.fileFeatureFlags&ne.a.FileFeatureFlags.CUBE_HISTOGRAMS)}),Object(S.jsx)(b.p,{label:"Clip Min",inline:!0,children:Object(S.jsx)(j.n,{value:t.renderConfig.scaleMinVal,selectAllOnFocus:!0,buttonPosition:"none",onBlur:this.handleScaleMinChange,onKeyDown:this.handleScaleMinChange})}),Object(S.jsx)(b.p,{label:"Clip Max",inline:!0,children:Object(S.jsx)(j.n,{value:t.renderConfig.scaleMaxVal,selectAllOnFocus:!0,buttonPosition:"none",onBlur:this.handleScaleMaxChange,onKeyDown:this.handleScaleMaxChange})}),this.width<430&&l]}),Object(S.jsx)(Vt.k,{isOpen:t.renderConfig.useCubeHistogram&&t.renderConfig.cubeHistogramProgress<1,progress:t.renderConfig.cubeHistogramProgress,timeRemaining:e.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleCubeHistogramCancelled,text:"Calculating cube histogram"}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle"})]})}},zt=Object(h.a)(_t.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=Object(h.a)(_t.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(_t.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(_t.prototype,"widgetStore"),_t.prototype),Object(h.a)(_t.prototype,"plotData",[f.i],Object.getOwnPropertyDescriptor(_t.prototype,"plotData"),_t.prototype),Gt=Object(h.a)(_t.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Lt=_t))||Lt;var Ht,qt,Yt,Ut,Xt,$t,Kt,Qt;i(874);let Zt=Object(g.a)((Kt=$t=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"region-list",type:"region-list",minWidth:350,minHeight:180,defaultWidth:650,defaultHeight:180,title:"Region List",isCloseable:!0,helpType:O.x.REGION_LIST}}get validRegions(){const e=O.e.Instance.activeFrame;return e?e.regionSet.regions.filter((e=>!e.isTemporary)):[]}constructor(e){super(e),Object(u.a)(this,"width",Yt,this),Object(u.a)(this,"height",Ut,this),Object(u.a)(this,"onResize",Xt,this),this.handleRegionLockClicked=(e,t)=>{t.toggleLock(),e.stopPropagation()},this.handleFocusClicked=(e,t)=>{t.focusCenter(),e.stopPropagation()},this.handleRegionListDoubleClick=()=>{O.r.Instance.showRegionDialog()},Object(f.p)(this)}render(){const t=O.e.Instance,i=t.activeFrame;if(!i)return Object(S.jsxs)("div",{className:"region-list-widget",children:[Object(S.jsx)(b.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"}),";",Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]});const n=11+41*(this.validRegions.length+1),r=isFinite(this.height)?Math.min(n,this.height):n;let o=e.NAME_COLUMN_DEFAULT_WIDTH;const s=this.width-10;let a=2*e.ACTION_COLUMN_DEFAULT_WIDTH+e.TYPE_COLUMN_DEFAULT_WIDTH+e.CENTER_COLUMN_DEFAULT_WIDTH+e.SIZE_COLUMN_DEFAULT_WIDTH+e.ROTATION_COLUMN_DEFAULT_WIDTH;o=s-a;let l=!0,c=!0;o<e.NAME_COLUMN_MIN_WIDTH&&(l=!1,a-=e.SIZE_COLUMN_DEFAULT_WIDTH,s>a&&(o=s-a),o<e.NAME_COLUMN_MIN_WIDTH&&(c=!1,a-=e.ROTATION_COLUMN_DEFAULT_WIDTH,o=s>a?s-a:e.NAME_COLUMN_MIN_WIDTH));const d=i.regionSet.selectedRegion,u=this.validRegions.map((t=>{let n;n=isFinite(t.center.x)&&isFinite(t.center.y)?i.validWcs?Object(S.jsx)(Jt,{region:t,frame:i}):`(${Object(D.mb)(t.center.x,1)}, ${Object(D.mb)(t.center.y,1)})`:"Invalid";const r=Object(S.jsx)("td",{style:{width:e.CENTER_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:n});let s,a,u;if(l){let n;t.size&&(n=i.validWcs?Object(S.jsxs)(p.Fragment,{children:[Object(D.u)(t.wcsSize.x,O.S),Object(S.jsx)("br",{}),Object(D.u)(t.wcsSize.y,O.S)]}):`(${Object(D.mb)(t.size.x,1)}, ${Object(D.mb)(t.size.y,1)})`),s=Object(S.jsx)("td",{style:{width:e.SIZE_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:t.regionType!==ne.a.RegionType.POINT&&Object(S.jsx)(b.W,{content:t.regionType===ne.a.RegionType.ELLIPSE?"Semi-major and semi-minor axes":"Width and height",position:m.a.BOTTOM,children:n})})}return a=t.regionId?Object(S.jsx)("td",{style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleRegionLockClicked(e,t),children:Object(S.jsx)(b.w,{icon:t.locked?"lock":"unlock"})}):Object(S.jsxs)("td",{colSpan:2,style:{width:2*e.ACTION_COLUMN_DEFAULT_WIDTH},children:[Object(S.jsx)(b.w,{icon:"blank"}),Object(S.jsx)(b.w,{icon:"blank"})]}),t.regionId&&(u=Object(S.jsx)("td",{style:{width:e.ACTION_COLUMN_DEFAULT_WIDTH},onClick:e=>this.handleFocusClicked(e,t),children:Object(S.jsx)(It.a,{icon:"center"})})),Object(S.jsxs)("tr",{className:d&&d.regionId===t.regionId?"selected":"",onClick:()=>i.regionSet.selectRegion(t),children:[a,u,Object(S.jsx)("td",{style:{width:o},onDoubleClick:this.handleRegionListDoubleClick,children:t.nameString}),Object(S.jsx)("td",{style:{width:e.TYPE_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:O.N.RegionTypeString(t.regionType)}),r,l&&s,c&&Object(S.jsx)("td",{style:{width:e.ROTATION_COLUMN_DEFAULT_WIDTH},onDoubleClick:this.handleRegionListDoubleClick,children:Object(D.mb)(t.rotation,1)})]},t.regionId)}));return Object(S.jsxs)("div",{className:"region-list-widget",children:[Object(S.jsxs)(b.s,{style:{height:r},children:[Object(S.jsx)("thead",{className:t.darkTheme?"dark-theme":"",children:Object(S.jsxs)("tr",{children:[Object(S.jsxs)("th",{style:{width:2*e.ACTION_COLUMN_DEFAULT_WIDTH},children:[Object(S.jsx)(b.w,{icon:"blank"}),Object(S.jsx)(b.w,{icon:"blank"})]}),Object(S.jsx)("th",{style:{width:o},children:"Name"}),Object(S.jsx)("th",{style:{width:e.TYPE_COLUMN_DEFAULT_WIDTH},children:"Type"}),Object(S.jsx)("th",{style:{width:e.CENTER_COLUMN_DEFAULT_WIDTH},children:i.validWcs?"Center":"Pixel Center"}),l&&Object(S.jsx)("th",{style:{width:e.SIZE_COLUMN_DEFAULT_WIDTH},children:i.validWcs?"Size":"Size (px)"}),c&&Object(S.jsx)("th",{style:{width:e.ROTATION_COLUMN_DEFAULT_WIDTH},children:"P.A. (deg)"})]})}),Object(S.jsx)("tbody",{className:t.darkTheme?"dark-theme":"",children:u})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},$t.ACTION_COLUMN_DEFAULT_WIDTH=25,$t.NAME_COLUMN_MIN_WIDTH=50,$t.NAME_COLUMN_DEFAULT_WIDTH=150,$t.TYPE_COLUMN_DEFAULT_WIDTH=90,$t.CENTER_COLUMN_DEFAULT_WIDTH=140,$t.SIZE_COLUMN_DEFAULT_WIDTH=160,$t.ROTATION_COLUMN_DEFAULT_WIDTH=80,qt=Kt,Object(h.a)(qt.prototype,"validRegions",[f.i],Object.getOwnPropertyDescriptor(qt.prototype,"validRegions"),qt.prototype),Yt=Object(h.a)(qt.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ut=Object(h.a)(qt.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Xt=Object(h.a)(qt.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Ht=qt))||Ht,Jt=Object(g.a)(Qt=class extends p.Component{render(){var e;O.e.Instance.overlayStore.global.explicitSystem,O.e.Instance.overlayStore.numbers.formatTypeX,O.e.Instance.overlayStore.numbers.formatTypeY;const t=this.props.frame,i=this.props.region;if(!i||!i.center||!(isFinite(i.center.x)&&isFinite(i.center.y)&&this.props.frame.validWcs))return null;if(0===i.regionId&&(null===(e=t.cursorInfo)||void 0===e?void 0:e.infoWCS))return Object(S.jsxs)(p.Fragment,{children:[t.cursorInfo.infoWCS.x,Object(S.jsx)("br",{}),t.cursorInfo.infoWCS.y]});const n=Object(D.C)(this.props.frame.wcsInfoForTransformation,i.center);return n?Object(S.jsxs)(p.Fragment,{children:[n.x,Object(S.jsx)("br",{}),n.y]}):null}})||Qt;var ei,ti,ii,ni,ri,oi,si,ai,li=i(58);i(875);let ci=Object(g.a)((ti=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"spatial-profiler",type:"spatial-profiler",minWidth:250,minHeight:225,defaultWidth:650,defaultHeight:225,title:"X Profile: Cursor",isCloseable:!0,helpType:O.x.SPATIAL_PROFILER}}get widgetStore(){const e=O.U.Instance;if(e.spatialProfileWidgets){const t=e.spatialProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.o}get profileStore(){const e=O.e.Instance;if(e.activeFrame){let t={fileId:this.widgetStore.fileId,regionId:this.widgetStore.regionId};-1===this.widgetStore.fileId&&(t.fileId=e.activeFrame.frameInfo.fileId);const i=`${t.fileId}-${t.regionId}`;return e.spatialProfiles.get(i)}}get frame(){return this.widgetStore?O.e.Instance.getFrame(this.widgetStore.fileId):void 0}get plotData(){const e=this.widgetStore.coordinate.indexOf("x")>=0;if(!this.frame||!this.width||!this.profileStore)return null;const t=this.profileStore.profiles.get(this.widgetStore.coordinate);if(t&&t.values&&t.values.length){let i,n;this.widgetStore.isAutoScaledX?(i=this.autoScaleHorizontalMin,n=this.autoScaleHorizontalMax):(i=Object(D.k)(this.widgetStore.minX,0,this.frame.frameInfo.fileInfoExtended.width),n=e?Object(D.k)(this.widgetStore.maxX,0,this.frame.frameInfo.fileInfoExtended.width):Object(D.k)(this.widgetStore.maxX,0,this.frame.frameInfo.fileInfoExtended.height)),i=Math.floor(i),n=Math.floor(n);let r,o,s=Number.MAX_VALUE,a=-Number.MAX_VALUE,l=0,c=0,d=0;const u=Math.floor(Math.min(n-i+1,t.values.length)),h=this.width,p=Math.round(u/h);let g,f;if(u>0){let e=new Array(t.values.length);for(let i=0;i<t.values.length;i++)e[i]=i;if(p<=1||this.widgetStore.plotType===j.j.POINTS){g=new Array(u);for(let e=0;e<u;e++){const r=t.values[e+i],o=t.start+e+i;o>=i&&o<=n&&isFinite(r)&&(s=Math.min(s,r),a=Math.max(a,r),d++,l+=r,c+=r*r),g[e]={x:o,y:r}}}else{for(let e=0;e<u;e++){const n=t.values[e+i];isFinite(n)&&(s=Math.min(s,n),a=Math.max(a,n),d++,l+=n,c+=n*n)}g=this.widgetStore.smoothingStore.getDecimatedPoint2DArray(e,t.values,p,i,n)}f=this.widgetStore.smoothingStore.getSmoothingPoint2DArray(e,t.values,i,n)}if(d>0&&(r=l/d,o=Math.sqrt(c/d-r*r)),s===Number.MAX_VALUE)s=void 0,a=void 0;else{const e=a-s;s-=e*j.y,a+=e*j.y}return{values:g,smoothingValues:f,xMin:i,xMax:n,yMin:s,yMax:a,yMean:r,yRms:o}}return null}get exportHeader(){const e=O.e.Instance,t=[];return t.push(`region (pixel): Point[${Object(D.mb)(e.activeFrame.cursorInfo.posImageSpace.x)}, ${Object(D.mb)(e.activeFrame.cursorInfo.posImageSpace.y)}]`),e.activeFrame.cursorInfo.infoWCS&&t.push(`region (world): Point[${e.activeFrame.cursorInfo.infoWCS.x}, ${e.activeFrame.cursorInfo.infoWCS.y}]`),t}constructor(t){super(t),this.cachedFormattedCoordinates=void 0,Object(u.a)(this,"width",ii,this),Object(u.a)(this,"height",ni,this),Object(u.a)(this,"autoScaleHorizontalMin",ri,this),Object(u.a)(this,"autoScaleHorizontalMax",oi,this),Object(u.a)(this,"setAutoScaleBounds",si,this),Object(u.a)(this,"onResize",ai,this),this.formatProfileAst=(e,t,i)=>this.frame&&this.profileStore?(0===t&&this.calculateFormattedValues(i),this.cachedFormattedCoordinates[t]):e,this.genProfilerInfo=()=>{let e=[];if(this.plotData){const i=this.widgetStore.coordinate.indexOf("x")>=0;if(this.widgetStore.isMouseMoveIntoLinePlots){const t=Object(D.i)(this.plotData.values,this.widgetStore.cursorX);if(null===t||void 0===t?void 0:t.point){const n=i?{x:t.point.x,y:this.profileStore.y}:{x:this.profileStore.x,y:t.point.x},r=this.frame.getCursorInfo(n),o=(null===r||void 0===r?void 0:r.infoWCS)?`WCS: ${i?r.infoWCS.x:r.infoWCS.y}, `:"",s=`Image: ${t.point.x} px, `,a=`${void 0!==t.point.y?Object(D.v)(t.point.y,5):""}`;e.push("Cursor: ("+o+s+a+")")}}else{var t;const n=this.frame.cursorInfo,r=null===(t=this.frame.cursorValue)||void 0===t?void 0:t.value;if(null===n||void 0===n?void 0:n.posImageSpace){const t=(null===n||void 0===n?void 0:n.infoWCS)?`WCS: ${i?n.infoWCS.x:n.infoWCS.y}, `:"",o=`Image: ${Object(D.mb)(i?n.posImageSpace.x:n.posImageSpace.y)} px, `,s=`${void 0!==r?Object(D.v)(r,5):""}`;e.push("Data: ("+t+o+s+")")}}this.widgetStore.meanRmsVisible&&e.push("Mean/RMS: "+(Object(D.v)(this.plotData.yMean,2)+" / "+Object(D.v)(this.plotData.yRms,2)))}return e},this.onGraphCursorMoved=Y.throttle((e=>{this.widgetStore.setCursor(e)}),33),Object(f.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.spatialProfileWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.spatialProfileWidgets.set(this.props.id,new Qe.o));else{const e=i.widgetsStore.addSpatialProfileWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(f.h)((()=>{if(this.widgetStore){const e=this.widgetStore.coordinate,t=this.plotData;if(i&&e){const t=`${e.toUpperCase()} Profile`,n=0===this.widgetStore.regionId?"Cursor":`Region #${this.widgetStore.regionId}`;i.widgetsStore.setWidgetTitle(this.props.id,`${t}: ${n}`)}t&&this.widgetStore.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}else i.widgetsStore.setWidgetTitle(this.props.id,"X Profile: Cursor")})),Object(f.h)((()=>{const e=this.widgetStore.coordinate.indexOf("x")>=0;if(!this.frame||!this.width)return null;e?this.setAutoScaleBounds(Object(D.k)(this.frame.requiredFrameView.xMin,0,this.frame.frameInfo.fileInfoExtended.width),Object(D.k)(this.frame.requiredFrameView.xMax,0,this.frame.frameInfo.fileInfoExtended.width)):this.setAutoScaleBounds(Object(D.k)(this.frame.requiredFrameView.yMin,0,this.frame.frameInfo.fileInfoExtended.height),Object(D.k)(this.frame.requiredFrameView.yMax,0,this.frame.frameInfo.fileInfoExtended.height))}),{delay:100})}calculateFormattedValues(e){if(this.cachedFormattedCoordinates&&this.cachedFormattedCoordinates.length===e.length||(this.cachedFormattedCoordinates=new Array(e.length)),!this.frame||!this.profileStore||!this.widgetStore)return;const t=this.widgetStore.coordinate.indexOf("x")>=0;let i=new O.a;if(i.add("System",O.E.Instance.global.explicitSystem),t)for(let n=0;n<e.length;n++){const t=Object(D.nb)(this.frame.wcsInfo,{x:e[n],y:this.profileStore.y}),r=P.normalizeCoordinates(this.frame.wcsInfo,t.x,t.y);this.cachedFormattedCoordinates[n]=P.getFormattedCoordinates(this.frame.wcsInfo,r.x,void 0,i.toString(),!0).x}else for(let n=0;n<e.length;n++){const t=Object(D.nb)(this.frame.wcsInfo,{x:this.profileStore.x,y:e[n]}),r=P.normalizeCoordinates(this.frame.wcsInfo,t.x,t.y);this.cachedFormattedCoordinates[n]=P.getFormattedCoordinates(this.frame.wcsInfo,void 0,r.y,i.toString(),!0).y}this.trimDecimals()}trimDecimals(){if(!this.cachedFormattedCoordinates||!this.cachedFormattedCoordinates.length)return;if(e.hasRepeats(this.cachedFormattedCoordinates))return;const t=this.cachedFormattedCoordinates[0].indexOf(".");if(-1===t)return;const i=this.cachedFormattedCoordinates[0].length-t;for(let n=i;n>0;n--){let t=this.cachedFormattedCoordinates.slice();for(let e=0;e<t.length;e++)t[e]=t[e].slice(0,-n);if(!e.hasRepeats(t))return void(this.cachedFormattedCoordinates=t);n===i&&n--}}static hasRepeats(e){if(!e||e.length<2)return!1;let t=e[0];for(let i=1;i<e.length;i++){const n=e[i];if(t===n)return!0;t=n}return!1}render(){const e=O.e.Instance;if(!this.widgetStore)return Object(S.jsx)(b.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const t=this.widgetStore.coordinate.indexOf("x")>=0,i=e.activeFrame?e.activeFrame.filename:void 0;let n={xLabel:(t?"X":"Y")+" coordinate",yLabel:"Value",darkMode:e.darkTheme,imageName:i,plotName:(t?"X":"Y")+" profile",plotType:this.widgetStore.plotType,tickTypeY:li.b.Scientific,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,zeroLineWidth:2,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1};if(e.activeFrame&&this.profileStore&&this.frame){this.frame.unit&&(n.yLabel=`Value (${this.frame.unit})`),this.frame.validWcs&&this.widgetStore.wcsAxisVisible?(n.showTopAxis=!0,n.topAxisTickFormatter=this.formatProfileAst):n.showTopAxis=!1;const i=this.plotData;if(i){n.data=i.values;let t=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(t=ae.a.BLUE4)),n.lineColor=t;const r=this.widgetStore.smoothingStore;if(r.type!==j.t.NONE){r.isOverlayOn||(n.lineColor="#00000000");let e={data:i.smoothingValues,type:r.lineType,borderColor:r.lineColor.colorHex,borderWidth:r.lineWidth,pointRadius:r.pointRadius,order:0,exportData:r.exportData};n.multiPlotPropsMap.set("smoothed",e)}this.widgetStore.isAutoScaledX?(n.xMin=i.xMin,n.xMax=i.xMax):(n.xMin=this.widgetStore.minX,n.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(n.yMin=i.yMin,n.yMax=i.yMax):(n.yMin=this.widgetStore.minY,n.yMax=this.widgetStore.maxY),i.values&&i.values.length>1.5*this.width&&(n.plotType=j.j.LINES)}const r={profiler:this.widgetStore.cursorX,image:t?this.profileStore.x:this.profileStore.y,unit:"px"};n.markers=[{value:r.image,id:"marker-image-cursor",draggable:!1,horizontal:!1}],n.markers.push({value:r.profiler,id:"marker-profiler-cursor",draggable:!1,horizontal:!1,color:e.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!0}),this.widgetStore.meanRmsVisible&&i&&isFinite(i.yMean)&&isFinite(i.yRms)&&(n.markers.push({value:i.yMean,id:"marker-mean",draggable:!1,horizontal:!0,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2,dash:[5]}),n.markers.push({value:i.yMean,id:"marker-rms",draggable:!1,horizontal:!0,width:i.yRms,opacity:.2,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2})),e.activeFrame.cursorInfo&&(n.comments=this.exportHeader)}return Object(S.jsxs)("div",{className:"spatial-profiler-widget",children:[Object(S.jsxs)("div",{className:"profile-container",children:[Object(S.jsx)("div",{className:"profile-plot",children:Object(S.jsx)(j.f,{...n})}),Object(S.jsx)(j.l,{info:this.genProfilerInfo()})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},ii=Object(h.a)(ti.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Object(h.a)(ti.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri=Object(h.a)(ti.prototype,"autoScaleHorizontalMin",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=Object(h.a)(ti.prototype,"autoScaleHorizontalMax",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(ti.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(ti.prototype,"widgetStore"),ti.prototype),Object(h.a)(ti.prototype,"profileStore",[f.i],Object.getOwnPropertyDescriptor(ti.prototype,"profileStore"),ti.prototype),Object(h.a)(ti.prototype,"frame",[f.i],Object.getOwnPropertyDescriptor(ti.prototype,"frame"),ti.prototype),Object(h.a)(ti.prototype,"plotData",[f.i],Object.getOwnPropertyDescriptor(ti.prototype,"plotData"),ti.prototype),Object(h.a)(ti.prototype,"exportHeader",[f.i],Object.getOwnPropertyDescriptor(ti.prototype,"exportHeader"),ti.prototype),si=Object(h.a)(ti.prototype,"setAutoScaleBounds",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.autoScaleHorizontalMin=e,this.autoScaleHorizontalMax=t}}}),ai=Object(h.a)(ti.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),ei=ti))||ei;var di,ui,hi,pi,gi,fi,bi,mi,yi=i(91),Oi=i(9),ji=i(67),Si=i(96);i(877);!function(e){e.Name="Name",e.Description="Description",e.Display="Display"}(mi||(mi={}));let xi=Object(g.a)((ui=class extends p.Component{static get WIDGET_CONFIG(){return{id:"spectral-line-query",type:"spectral-line-query",minWidth:500,minHeight:400,defaultWidth:750,defaultHeight:600,title:"Spectral Line Query",isCloseable:!0,helpType:O.x.SPECTRAL_LINE_QUERY}}constructor(e){super(e),Object(u.a)(this,"width",hi,this),Object(u.a)(this,"height",pi,this),Object(u.a)(this,"widgetId",gi,this),Object(u.a)(this,"headerTableColumnWidths",fi,this),this.headerTableRef=void 0,this.resultTableRef=void 0,Object(u.a)(this,"onResize",bi,this),this.onTableResize=()=>{this.headerTableRef&&this.updateTableSize(this.headerTableRef,!1),this.resultTableRef&&this.updateTableSize(this.resultTableRef,!1)},this.handleRedshiftChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.widgetStore.redshiftInput;isFinite(i)&&i!==n&&(this.widgetStore.redshiftType===Qe.j.Z&&i>=0||this.widgetStore.redshiftType===Qe.j.V)?this.widgetStore.setRedshiftInput(i):e.currentTarget.value=n},this.updateHeaderTableColumnSize=(e,t)=>{this.headerTableColumnWidths&&(this.headerTableColumnWidths[e]=t)},this.handleEnterWidgetOption=(e,t)=>{if(t){const i=O.e.Instance.widgetsStore.getSpectralWidgetStoreByID(t);i&&i.setHighlighted(e)}},this.handlePlot=()=>{const e=this.widgetStore,t=O.e.Instance,i=t.activeFrame;if(e.selectedSpectralProfilerID&&i){const i=t.widgetsStore.getSpectralWidgetStoreByID(e.selectedSpectralProfilerID);i&&i.addSpectralLines(e.selectedLines)}},this.handleClear=()=>{const e=this.widgetStore,t=O.e.Instance;if(e.selectedSpectralProfilerID){const i=t.widgetsStore.getSpectralWidgetStoreByID(e.selectedSpectralProfilerID);i&&i.clearSpectralLines()}},Object(f.p)(this),this.headerTableColumnWidths=[150,70,300]}get widgetStore(){const e=O.U.Instance;if(e.spectralLineQueryWidgets){const t=e.spectralLineQueryWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.r}updateTableSize(e,t){const i=e.locator.getViewportRect();e.updateViewportRect(i),t&&e.scrollToRegion(jt.c.column(0))}setHeaderTableColumnWidts(e){this.headerTableColumnWidths=e}renderDataColumn(e,t){return Object(S.jsx)(St.a,{name:e,cellRenderer:(e,i)=>Object(S.jsx)(mt.a,{className:"header-table-cell",interactive:!0,children:t[e]},`cell_${i}_${e}`)},e)}renderSwitchButtonCell(e,t){const i=this.widgetStore,n=i.headerDisplay.get(t);return Object(S.jsx)(mt.a,{className:"header-table-cell",children:Object(S.jsx)(p.Fragment,{children:Object(S.jsx)(b.P,{className:"cell-switch-button",checked:n,onChange:()=>i.setHeaderDisplay(t)},`cell_switch_button_${e}`)})},`cell_switch_${e}`)}renderButtonColumns(e,t){return Object(S.jsx)(St.a,{name:e,cellRenderer:e=>this.renderSwitchButtonCell(e,t[e])},e)}createHeaderTable(){const e=[],t=[];this.widgetStore.formalizedHeaders.forEach((i=>{e.push(i.name),t.push(i.desc)}));const i=[],n=this.renderDataColumn(mi.Name,e);i.push(n);const r=this.renderButtonColumns(mi.Display,e);i.push(r);const o=this.renderDataColumn(mi.Description,t);return i.push(o),Object(S.jsx)(Ot.a,{ref:e=>this.headerTableRef=e,numRows:this.widgetStore.formalizedHeaders.length,enableRowReordering:!1,renderMode:ji.a.BATCH,selectionModes:jt.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,enableGhostCells:!0,numFrozenColumns:1,columnWidths:this.headerTableColumnWidths,onColumnWidthChanged:this.updateHeaderTableColumnSize,enableRowResizing:!1,children:i})}render(){var e,t;const i=O.e.Instance,n=this.widgetStore,r=Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.p,{label:"From",inline:!0,children:Object(S.jsx)(j.n,{value:n.queryRange[0],buttonPosition:"none",onValueChange:e=>n.setQueryRange([e,n.queryRange[1]])})}),Object(S.jsx)(b.p,{label:"To",inline:!0,children:Object(S.jsx)(j.n,{value:n.queryRange[1],buttonPosition:"none",onValueChange:e=>n.setQueryRange([n.queryRange[0],e])})})]}),o=Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.p,{inline:!0,children:Object(S.jsx)(j.n,{value:n.queryRangeByCenter[0],buttonPosition:"none",onValueChange:e=>n.setQueryRangeByCenter([e,n.queryRangeByCenter[1]])})}),Object(S.jsx)(b.p,{label:"\xb1",inline:!0,children:Object(S.jsx)(j.n,{value:n.queryRangeByCenter[1],buttonPosition:"none",onValueChange:e=>n.setQueryRangeByCenter([n.queryRangeByCenter[0],e])})})]}),s=Object(S.jsxs)("div",{className:"query-panel",children:[Object(S.jsxs)("div",{className:"query-panel-input",children:[Object(S.jsx)(b.p,{inline:!0,children:Object(S.jsx)(b.r,{options:[Qe.p.Range,Qe.p.Center],value:n.queryRangeType,onChange:e=>n.setQueryRangeType(e.currentTarget.value)})}),n.queryRangeType===Qe.p.Range?r:o,Object(S.jsx)(b.p,{inline:!0,children:Object(S.jsx)(b.r,{options:Object.values(Qe.q),value:n.queryUnit,onChange:e=>n.setQueryUnit(e.currentTarget.value)})}),Object(S.jsxs)(b.k,{className:"intensity-limit",children:[Object(S.jsx)(b.p,{label:"Intensity Limit",inline:!0,children:Object(S.jsx)(b.P,{checked:n.intensityLimitEnabled,onChange:()=>n.toggleIntensityLimit()})}),n.intensityLimitEnabled&&Object(S.jsx)(b.W,{content:"CDMS/JPL intensity (log)",position:m.a.BOTTOM,children:Object(S.jsx)(j.n,{value:n.intensityLimitValue,buttonPosition:"none",onValueChange:e=>n.setIntensityLimitValue(e)})})]})]}),Object(S.jsx)("div",{children:Object(S.jsx)(b.e,{intent:yi.a.PRIMARY,onClick:n.query,children:"Query"})})]}),a=Object(S.jsxs)("div",{className:"redshift-panel",children:[Object(S.jsx)(b.p,{inline:!0,children:Object(S.jsx)(b.r,{options:[Qe.j.V,Qe.j.Z],value:n.redshiftType,onChange:e=>n.setRedshiftType(e.currentTarget.value)})}),Object(S.jsx)(b.p,{inline:!0,children:Object(S.jsx)(j.n,{value:n.redshiftInput,buttonPosition:"none",onBlur:this.handleRedshiftChange,onKeyDown:this.handleRedshiftChange})})]}),l=n.selectedSpectralProfilerID&&O.e.Instance.widgetsStore.getSpectralWidgetStoreByID(n.selectedSpectralProfilerID),c=Object(S.jsx)(b.F,{content:Object(S.jsx)(b.z,{children:O.e.Instance.widgetsStore.spectralProfilerList.map((e=>Object(S.jsx)(b.B,{text:e,onMouseEnter:()=>this.handleEnterWidgetOption(!0,e),onMouseLeave:()=>this.handleEnterWidgetOption(!1,e),onClick:()=>{this.handleEnterWidgetOption(!1,e),n.setSelectedSpectralProfiler(e)}},e)))}),position:m.a.BOTTOM,minimal:!0,children:Object(S.jsx)(b.e,{disabled:O.e.Instance.widgetsStore.spectralProfilerList.length<=0,rightIcon:"caret-down",children:l?n.selectedSpectralProfilerID:"----"})}),d={type:j.x.Normal,dataset:n.queryResult,columnHeaders:n.displayedColumnHeaders,numVisibleRows:n.numDataRows,manualSelectionProps:{isSelectingAll:n.isSelectingAllLines,isSelectingIndeterminate:n.isSelectingIndeterminatedLines,selectAllLines:n.selectAllLines,selectSingleLine:n.selectSingleLine},manualSelectionData:n.manualSelectionData,sortingInfo:n.sortingInfo,updateTableRef:e=>{this.resultTableRef=e}};let u="spectral-line-query-widget";i.darkTheme&&(u+=" dark-theme");const h=(null===(e=n.selectedLines)||void 0===e?void 0:e.length)<1e3,g=Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:[h?"":"Please select fewer than 1000 lines.",h||l?"":Object(S.jsx)("br",{}),l?"":"Please select one spectral profiler."]})})]}),f=Object(S.jsxs)("span",{children:["Plot lines to selected profiler",g]});return Object(S.jsxs)("div",{className:u,children:[Object(S.jsxs)("div",{className:"bp3-dialog-body",children:[s,Object(S.jsxs)(Si.b,{className:"body-split-pane",split:"horizontal",primary:"second",defaultSize:"60%",minSize:"5%",onChange:this.onTableResize,children:[Object(S.jsx)(Si.a,{className:"header-table-container",children:this.width>0&&this.createHeaderTable()}),Object(S.jsxs)(Si.a,{className:"result-table-container",children:[a,Object(S.jsx)("div",{className:"result-table",children:this.width>0&&Object(S.jsx)(j.w,{...d})})]})]})]}),Object(S.jsxs)("div",{className:"bp3-dialog-footer",children:[Object(S.jsx)("div",{className:"result-table-info",children:Object(S.jsxs)("pre",{children:["Showing ",n.numDataRows," entries.",(null===(t=n.selectedLines)||void 0===t?void 0:t.length)>0?` Selected ${n.selectedLines.length} lines.`:""]})}),Object(S.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(S.jsx)(b.p,{inline:!0,label:this.width<450?"":"Spectral Profiler",children:c}),Object(S.jsx)(b.W,{content:f,position:m.a.BOTTOM,children:Object(S.jsx)(b.b,{text:"Plot",intent:yi.a.PRIMARY,disabled:!i.activeFrame||n.queryResult.size<=0||!l||!h,onClick:this.handlePlot})}),Object(S.jsx)(b.W,{content:"Clear plotted lines",position:m.a.BOTTOM,children:Object(S.jsx)(b.b,{text:"Clear",intent:yi.a.PRIMARY,disabled:!i.activeFrame||!l||n.queryResult.size<=0,onClick:this.handleClear})})]})]}),Object(S.jsx)(b.E,{className:Oi.a.OVERLAY_SCROLL_CONTAINER,autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:n.isQuerying,usePortal:!1,children:Object(S.jsx)("div",{className:"query-loading-overlay",children:Object(S.jsx)(b.O,{intent:yi.a.PRIMARY,size:30,value:null})})}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},hi=Object(h.a)(ui.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pi=Object(h.a)(ui.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gi=Object(h.a)(ui.prototype,"widgetId",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fi=Object(h.a)(ui.prototype,"headerTableColumnWidths",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(ui.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(ui.prototype,"widgetStore"),ui.prototype),bi=Object(h.a)(ui.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t,this.headerTableRef&&this.updateTableSize(this.headerTableRef,this.props.docked),this.resultTableRef&&this.updateTableSize(this.resultTableRef,this.props.docked)}}}),Object(h.a)(ui.prototype,"setHeaderTableColumnWidts",[f.g],Object.getOwnPropertyDescriptor(ui.prototype,"setHeaderTableColumnWidts"),ui.prototype),di=ui))||di;var Ci;i(878);let Ii=Object(g.a)(Ci=class extends p.Component{constructor(...e){super(...e),this.handleStatsChanged=e=>{this.props.widgetStore.setStatsType(parseInt(e.target.value))},this.handleCoordinateChanged=e=>{this.props.widgetStore.setCoordinate(e.target.value)},this.smoothingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(kn.SMOOTHING),O.e.Instance.widgetsStore.createFloatingSettingsWidget(Pi.WIDGET_CONFIG.title,this.props.id,Pi.WIDGET_CONFIG.type)},this.momentsShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(kn.MOMENTS),O.e.Instance.widgetsStore.createFloatingSettingsWidget(Pi.WIDGET_CONFIG.title,this.props.id,Pi.WIDGET_CONFIG.type)},this.handleFrameChanged=e=>{e&&!e.stokesInfo.includes(this.props.widgetStore.coordinate)&&this.props.widgetStore.setCoordinate("z")}}render(){const e=this.props.widgetStore;let t=!1,i=!1,n="unlinked-to-selected",r=0;const o=[{value:"z",label:"Current"}];if(e.effectiveFrame&&e.effectiveFrame.regionSet){r=e.effectiveRegionId;const s=e.effectiveFrame.regionSet.regions.find((e=>e.regionId===r));t=s&&s.isClosedRegion,i=e.effectiveFrame.hasStokes;const a=e.effectiveFrame.stokesInfo;a.forEach((e=>o.push({value:`${e}z`,label:e})));const l="linked-to-selected-stokes";i&&e.matchActiveFrame&&e.coordinate===a[e.effectiveFrame.requiredStokes]+"z"&&(n=O.e.Instance.darkTheme?`${l} dark-theme`:l)}const s=[{value:ne.a.StatsType.Sum,label:Qe.s.StatsTypeString(ne.a.StatsType.Sum)},{value:ne.a.StatsType.Mean,label:Qe.s.StatsTypeString(ne.a.StatsType.Mean)},{value:ne.a.StatsType.FluxDensity,label:Qe.s.StatsTypeString(ne.a.StatsType.FluxDensity)},{value:ne.a.StatsType.Sigma,label:Qe.s.StatsTypeString(ne.a.StatsType.Sigma)},{value:ne.a.StatsType.Min,label:Qe.s.StatsTypeString(ne.a.StatsType.Min)},{value:ne.a.StatsType.Max,label:Qe.s.StatsTypeString(ne.a.StatsType.Max)},{value:ne.a.StatsType.Extrema,label:Qe.s.StatsTypeString(ne.a.StatsType.Extrema)},{value:ne.a.StatsType.RMS,label:Qe.s.StatsTypeString(ne.a.StatsType.RMS)},{value:ne.a.StatsType.SumSq,label:Qe.s.StatsTypeString(ne.a.StatsType.SumSq)}];return Object(S.jsxs)("div",{className:"spectral-profiler-toolbar",children:[Object(S.jsx)(Jn,{widgetStore:e,onFrameChanged:this.handleFrameChanged}),Object(S.jsx)(b.p,{label:"Statistic",inline:!0,disabled:!t,children:Object(S.jsx)(b.r,{value:t?e.statsType:ne.a.StatsType.Mean,options:s,onChange:this.handleStatsChanged,disabled:!t})}),Object(S.jsx)(b.p,{label:"Stokes",inline:!0,disabled:!i,children:Object(S.jsx)(b.r,{className:n,value:e.coordinate,options:o,onChange:this.handleCoordinateChanged,disabled:!i})}),Object(S.jsxs)(b.f,{className:"profile-buttons",children:[Object(S.jsx)(b.W,{content:"Smoothing",children:Object(S.jsx)(b.b,{icon:Object(S.jsx)(It.a,{icon:"smoothing"}),onClick:this.smoothingShortcutClick})}),Object(S.jsx)(b.W,{content:"Moments",children:Object(S.jsx)(b.b,{icon:Object(S.jsx)(It.a,{icon:"moments"}),onClick:this.momentsShortcutClick})})]})]})}})||Ci;var wi,Ti,vi,Ai,Ri;i(879);let Pi=Object(g.a)((Ti=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"spectral-profiler",type:"spectral-profiler",minWidth:250,minHeight:225,defaultWidth:720,defaultHeight:275,title:"Z Profile: Cursor",isCloseable:!0,helpType:O.x.SPECTRAL_PROFILER}}get widgetStore(){const e=O.U.Instance;if(e.spectralProfileWidgets){const t=e.spectralProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.s}get profileStore(){if(this.widgetStore.effectiveFrame){let e=this.widgetStore.effectiveFrame.frameInfo.fileId;const t=this.widgetStore.effectiveRegionId,i=O.e.Instance.spectralProfiles.get(e);if(i)return i.get(t)}return null}get plotData(){const e=this.widgetStore.effectiveFrame;if(!e)return null;let t,i=this.widgetStore.effectiveRegionId;if(e.regionSet){const n=e.regionSet.regions.find((e=>e.regionId===i));n&&this.profileStore&&(t=this.profileStore.getProfile(this.widgetStore.coordinate,n.isClosedRegion?this.widgetStore.statsType:ne.a.StatsType.Sum))}if(t&&t.values&&t.values.length&&e.channelValues&&e.channelValues.length&&t.values.length===e.channelValues.length){const i=e.channelValues;let n=Math.min(i[0],i[i.length-1]),r=Math.max(i[0],i[i.length-1]);if(!this.widgetStore.isAutoScaledX){const e=Object(D.k)(this.widgetStore.minX,n,r),t=Object(D.k)(this.widgetStore.maxX,n,r);n=e,r=t}let o,s,a=Number.MAX_VALUE,l=-Number.MAX_VALUE,c=0,d=0,u=0,h=[];for(let e=0;e<i.length;e++){const o=i[e],s=t.values[e];if(o<n||o>r){if(h.length)break}else h.push({x:o,y:s}),isNaN(s)||(a=Math.min(a,s),l=Math.max(l,s),u++,c+=s,d+=s*s)}let p=this.widgetStore.smoothingStore.getSmoothingPoint2DArray(i,t.values);if(u>0&&(o=c/u,s=Math.sqrt(d/u-o*o)),a===Number.MAX_VALUE)a=void 0,l=void 0;else{const e=l-a;a-=e*j.y,l+=e*j.y}return{values:h,smoothingValues:p,xMin:n,xMax:r,yMin:a,yMax:l,yMean:o,yRms:s,progress:t.progress}}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find((e=>e.regionId===i));0!==i&&e.push(`statistic: ${Qe.s.StatsTypeString(this.widgetStore.statsType)}`),n&&(e.push(n.regionProperties),t.validWcs&&e.push(t.getRegionWcsProperties(n)))}return e}constructor(t){super(t),Object(u.a)(this,"width",vi,this),Object(u.a)(this,"height",Ai,this),Object(u.a)(this,"onResize",Ri,this),this.onChannelChanged=e=>{const t=this.widgetStore.effectiveFrame;if(null===e||void 0===e||!isFinite(e)||O.d.Instance.animationActive)return;const i=t.findChannelIndexByValue(e);t&&isFinite(i)&&i>=0&&i<t.numChannels&&t.setChannels(i,t.requiredStokes,!0)},this.onGraphCursorMoved=Y.throttle((e=>{this.widgetStore.setCursor(e)}),33),this.genProfilerInfo=()=>{let e=[];const t=this.widgetStore.effectiveFrame;if(t&&this.plotData){const i={profiler:this.widgetStore.cursorX,image:this.currentChannelValue,unit:t.spectralUnitStr},n=this.plotData.values,r=Object(D.i)(n,this.widgetStore.isMouseMoveIntoLinePlots?i.profiler:i.image);let o="";if(r&&r.point&&r.index>=0&&r.index<n.length){let e="";const t=r.index-1>=0?Math.abs(r.point.x-n[r.index-1].x):0;e=t>0&&t<1e-6?Object(D.x)(r.point.x):t>=1e-6&&t<.001?Object(D.mb)(r.point.x,6):Object(D.mb)(r.point.x,3);o="("+("Channel"===i.unit?"Channel "+Object(D.mb)(r.point.x):e+" "+i.unit)+", "+Object(D.lb)(r.point.y,2)+")"}e.push(`${this.widgetStore.isMouseMoveIntoLinePlots?"Cursor:":"Data:"} ${o}`),this.widgetStore.meanRmsVisible&&e.push("Mean/RMS: "+(Object(D.v)(this.plotData.yMean,2)+" / "+Object(D.v)(this.plotData.yRms,2)))}return e},this.setSelectedRange=(e,t)=>{isFinite(e)&&isFinite(t)&&(this.widgetStore.isSelectingMomentChannelRange?this.widgetStore.setSelectedChannelRange(e,t):this.widgetStore.isSelectingMomentMaskRange&&this.widgetStore.setSelectedMaskRange(e,t))},this.fillVisibleSpectralLines=()=>{let e=[];const t=this.widgetStore.transformedSpectralLines;if((null===t||void 0===t?void 0:t.length)>0){let i,n;this.plotData&&(i=this.widgetStore.isAutoScaledX?this.plotData.xMin:this.widgetStore.minX,n=this.widgetStore.isAutoScaledX?this.plotData.xMax:this.widgetStore.maxX);for(let r=0;r<t.length;r++){const o=t[r];isFinite(i)&&isFinite(n)&&o&&isFinite(o.value)&&o.value>=i&&o.value<=n&&e.push({value:o.value,id:`spectral-line-${r}`,label:`${o.species} ${o.qn}`,draggable:!1,horizontal:!1,color:O.e.Instance.darkTheme?ae.a.GREEN4:ae.a.GREEN2})}}return e},Object(f.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.spectralProfileWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.addSpectralProfileWidget(this.props.id));else{const e=i.widgetsStore.addSpectralProfileWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(f.h)((()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){const e=this.widgetStore.coordinate,t=this.widgetStore.effectiveFrame;let n="";const r=this.plotData;if(r&&isFinite(r.progress)&&(r.progress<1?(n=`[${Object(D.mb)(100*r.progress)}% complete]`,this.widgetStore.updateStreamingDataStatus(!0)):this.widgetStore.updateStreamingDataStatus(!1)),t&&e){let t;t=2===e.length?`Z Profile (Stokes ${e[0]})`:"Z Profile";const r=this.widgetStore.effectiveRegionId,o=0===r?"Cursor":`Region #${r}`,s=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`${t}: ${o} ${s} ${n}`)}r&&this.widgetStore.initXYBoundaries(r.xMin,r.xMax,r.yMin,r.yMax)}else i.widgetsStore.setWidgetTitle(this.props.id,"Z Profile: Cursor")}))}get currentChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.channel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get requiredChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.requiredChannel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get linePlotSelectingMode(){return this.widgetStore.isSelectingMomentChannelRange?j.g.HORIZONTAL:this.widgetStore.isSelectingMomentMaskRange?j.g.VERTICAL:j.g.BOX}render(){const e=O.e.Instance;if(!this.widgetStore)return Object(S.jsx)(b.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const t=this.widgetStore.effectiveFrame,i=t?t.filename:void 0;let n={xLabel:"Channel",yLabel:"Value",darkMode:e.darkTheme,imageName:i,plotName:"Z profile",plotType:this.widgetStore.plotType,tickTypeY:li.b.Scientific,graphClicked:this.onChannelChanged,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,markers:this.fillVisibleSpectralLines(),mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,selectingMode:this.linePlotSelectingMode,setSelectedRange:this.setSelectedRange,zeroLineWidth:2,order:1,multiPlotPropsMap:new Map};if(this.profileStore&&t){if(t.spectralAxis&&!t.isCoordChannel){const e=t.isSpectralSystemConvertible?t.spectralSystem:`${t.spectralInfo.specsys}`;n.xLabel=`${e&&""!==e?e+", ":""}${t.spectralCoordinate}`}if(t.unit){let e,i="Value",r=`(${t.unit})`;t.regionSet&&(e=t.regionSet.regions.find((e=>e.regionId===this.widgetStore.effectiveRegionId)),e&&e.regionType!==ne.a.RegionType.POINT&&(i=Qe.s.StatsTypeString(this.widgetStore.statsType),this.widgetStore.statsType===ne.a.StatsType.FluxDensity?r="(Jy)":this.widgetStore.statsType===ne.a.StatsType.SumSq&&(r=`(${t.unit})^2`))),n.yLabel=`${i} ${r}`}const i=this.plotData;if(i){n.data=i.values,n.opacity=i.progress<1?.15+i.progress/4:1;let t=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(t=ae.a.BLUE4)),n.lineColor=t;const r=this.widgetStore.smoothingStore;if(r.type!==j.t.NONE){r.isOverlayOn||(n.lineColor="#00000000");let e={data:i.smoothingValues,type:r.lineType,borderColor:r.lineColor.colorHex,borderWidth:r.lineWidth,pointRadius:r.pointRadius,order:0,exportData:r.exportData};n.multiPlotPropsMap.set("smoothed",e)}this.widgetStore.isAutoScaledX?(n.xMin=i.xMin,n.xMax=i.xMax):(n.xMin=this.widgetStore.minX,n.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(n.yMin=i.yMin,n.yMax=i.yMax):(n.yMin=this.widgetStore.minY,n.yMax=this.widgetStore.maxY)}isNaN(this.widgetStore.cursorX)||n.markers.push({value:this.widgetStore.cursorX,id:"marker-profiler-cursor",draggable:!1,horizontal:!1,color:e.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!0}),isNaN(this.currentChannelValue)||n.markers.push({value:this.currentChannelValue,id:"marker-channel-current",opacity:.4,draggable:!1,horizontal:!1}),isNaN(this.requiredChannelValue)||n.markers.push({value:this.requiredChannelValue,id:"marker-channel-required",draggable:!O.d.Instance.animationActive,dragMove:this.onChannelChanged,horizontal:!1}),this.widgetStore.meanRmsVisible&&i&&isFinite(i.yMean)&&isFinite(i.yRms)&&(n.markers.push({value:i.yMean,id:"marker-mean",draggable:!1,horizontal:!0,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2,dash:[5]}),n.markers.push({value:i.yMean,id:"marker-rms",draggable:!1,horizontal:!0,width:i.yRms,opacity:.2,color:e.darkTheme?ae.a.GREEN4:ae.a.GREEN2}));const r=this.widgetStore.selectedRange;r&&isFinite(r.center)&&isFinite(r.width)&&n.markers.push({value:r.center,id:"marker-range",draggable:!1,horizontal:r.isHorizontal,width:r.width/2,opacity:.2,color:e.darkTheme?ae.a.GRAY4:ae.a.GRAY2}),n.comments=this.exportHeaders}let r="spectral-profiler-widget";return this.widgetStore.isHighlighted&&(r+=" linked-to-widget-highlighted"),e.darkTheme&&(r+=" dark-theme"),Object(S.jsxs)("div",{className:r,children:[Object(S.jsxs)("div",{className:"profile-container",children:[Object(S.jsx)("div",{className:"profile-toolbar",children:Object(S.jsx)(Ii,{widgetStore:this.widgetStore,id:this.props.id})}),Object(S.jsx)("div",{className:"profile-plot",children:Object(S.jsx)(j.f,{...n})}),Object(S.jsx)(j.l,{info:this.genProfilerInfo()})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},vi=Object(h.a)(Ti.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ai=Object(h.a)(Ti.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(Ti.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"widgetStore"),Ti.prototype),Object(h.a)(Ti.prototype,"profileStore",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"profileStore"),Ti.prototype),Object(h.a)(Ti.prototype,"plotData",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"plotData"),Ti.prototype),Object(h.a)(Ti.prototype,"exportHeaders",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"exportHeaders"),Ti.prototype),Ri=Object(h.a)(Ti.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Object(h.a)(Ti.prototype,"currentChannelValue",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"currentChannelValue"),Ti.prototype),Object(h.a)(Ti.prototype,"requiredChannelValue",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"requiredChannelValue"),Ti.prototype),Object(h.a)(Ti.prototype,"linePlotSelectingMode",[f.i],Object.getOwnPropertyDescriptor(Ti.prototype,"linePlotSelectingMode"),Ti.prototype),wi=Ti))||wi;var Ei,Fi,Mi,ki,Di,Ni,Li,_i,zi,Wi,Gi=i(126);i(880);let Vi=Object(g.a)((Wi=zi=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"stats",type:"stats",minWidth:300,minHeight:200,defaultWidth:325,defaultHeight:325,title:"Statistics",isCloseable:!0,helpType:O.x.STATS}}get widgetStore(){const e=O.U.Instance;if(e.statsWidgets){const t=e.statsWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.t}get statsData(){const e=O.e.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId,i=this.widgetStore.effectiveRegionId;const n=e.regionStats.get(t);return n?n.get(i):null}return null}constructor(t){super(t),Object(u.a)(this,"width",Mi,this),Object(u.a)(this,"height",ki,this),Object(u.a)(this,"isMouseEntered",Di,this),Object(u.a)(this,"showMouseEnterWidget",Ni,this),Object(u.a)(this,"hideMouseEnterWidget",Li,this),Object(u.a)(this,"onResize",_i,this),this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget()},this.getTableValue=(e,t)=>{var i;let n="",r="";if(this.statsData&&isFinite(e)&&e>=0&&e<(null===(i=this.statsData.statistics)||void 0===i?void 0:i.length)){const i=this.widgetStore.effectiveFrame;if(i&&i.unit){const e=i.unit;t===ne.a.StatsType.NumPixels?r="pixel(s)":t===ne.a.StatsType.SumSq?r=`(${e})^2`:t===ne.a.StatsType.FluxDensity?"Jy/beam"===e&&(r="Jy"):r=e}const o=this.statsData.statistics[e].value;n=Object(D.lb)(o,12),r=isFinite(o)?r:""}return{num:n,unit:r}},this.exportData=()=>{const t=this.widgetStore.effectiveFrame;if(this.statsData&&t){const i=this.widgetStore.effectiveFrame.filename,n="statistics",r=`# ${i} ${n}\n`;let o="",s=this.widgetStore.effectiveRegionId;if(-1!==s){const e=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===s));e&&(o+=`# ${e.regionProperties}\n`,t.validWcs&&(o+=`# ${t.getRegionWcsProperties(e)}\n`))}else o+="# full image\n";let a=`${t.channelInfo?`# channel: ${t.spectralInfo.channel}\n`:""}${t.hasStokes?`# stokes: ${t.stokesInfo[t.requiredStokes]}\n`:""}${o}`;const l="# Statistic\tValue\tUnit\n";let c="";e.STATS_NAME_MAP.forEach(((e,t)=>{var i,n;const r=null===(i=this.statsData.statistics)||void 0===i?void 0:i.findIndex((e=>e.statsType===t));if(r>=0&&r<(null===(n=this.statsData.statistics)||void 0===n?void 0:n.length)){const i=this.getTableValue(r,t);i.unit=""===i.unit?"N/A":i.unit,c+=`${e.padEnd(12)}\t${i.num}\t${i.unit}\n`}})),Object(D.r)(i,n,`${r}${a}${l}${c}`)}},Object(f.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.statsWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.statsWidgets.set(this.props.id,new Qe.t));else{const e=i.widgetsStore.addStatsWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(f.h)((()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){let e="Unknown";const t=this.widgetStore.effectiveRegionId,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";if(-1===t)e="Image";else if(this.widgetStore.effectiveFrame.regionSet){const i=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===t));i&&(e=i.nameString)}i.widgetsStore.setWidgetTitle(this.props.id,`Statistics: ${e} ${n}`)}else i.widgetsStore.setWidgetTitle(this.props.id,"Statistics")}))}render(){const t=O.e.Instance;let i,n=null;if(this.statsData){const r=Math.max(0,this.width-e.NAME_COLUMN_WIDTH);let o=[];e.STATS_NAME_MAP.forEach(((t,i)=>{var n;const s=null===(n=this.statsData.statistics)||void 0===n?void 0:n.findIndex((e=>e.statsType===i));if(s>=0&&s<this.statsData.statistics.length){const n=this.getTableValue(s,i);o.push(Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{style:{width:e.NAME_COLUMN_WIDTH},children:t}),Object(S.jsxs)("td",{style:{width:r},children:[n.num," ",n.unit]})]},i))}})),i=Object(S.jsxs)(b.s,{children:[Object(S.jsx)("thead",{className:t.darkTheme?"dark-theme":"",children:Object(S.jsxs)("tr",{children:[Object(S.jsx)("th",{style:{width:e.NAME_COLUMN_WIDTH},children:"Statistic"}),Object(S.jsx)("th",{style:{width:r},children:"Value"})]})}),Object(S.jsx)("tbody",{className:t.darkTheme?"dark-theme":"",children:o})]}),n=Object(S.jsx)("div",{className:"stats-export-data",children:Object(S.jsx)(Gi.a,{darkMode:t.darkTheme,visible:this.isMouseEntered,exportData:this.exportData})})}else i=Object(S.jsx)(b.C,{icon:"folder-open",title:"No stats data",description:"Select a valid region from the dropdown"});let r="stats-widget";return t.darkTheme&&(r+=" dark-theme"),Object(S.jsxs)("div",{className:r,children:[Object(S.jsx)("div",{className:"stats-toolbar",children:Object(S.jsx)(Jn,{widgetStore:this.widgetStore})}),Object(S.jsxs)("div",{className:"stats-display",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,children:[i,n]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize})]})}},zi.STATS_NAME_MAP=new Map([[ne.a.StatsType.NumPixels,"NumPixels"],[ne.a.StatsType.Sum,"Sum"],[ne.a.StatsType.FluxDensity,"FluxDensity"],[ne.a.StatsType.Mean,"Mean"],[ne.a.StatsType.Sigma,"StdDev"],[ne.a.StatsType.Min,"Min"],[ne.a.StatsType.Max,"Max"],[ne.a.StatsType.Extrema,"Extrema"],[ne.a.StatsType.RMS,"RMS"],[ne.a.StatsType.SumSq,"SumSq"]]),zi.NAME_COLUMN_WIDTH=90,Fi=Wi,Mi=Object(h.a)(Fi.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),ki=Object(h.a)(Fi.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Di=Object(h.a)(Fi.prototype,"isMouseEntered",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(h.a)(Fi.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Fi.prototype,"widgetStore"),Fi.prototype),Object(h.a)(Fi.prototype,"statsData",[f.i],Object.getOwnPropertyDescriptor(Fi.prototype,"statsData"),Fi.prototype),Ni=Object(h.a)(Fi.prototype,"showMouseEnterWidget",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0}}}),Li=Object(h.a)(Fi.prototype,"hideMouseEnterWidget",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1}}}),_i=Object(h.a)(Fi.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Ei=Fi))||Ei;var Bi;i(881);let Hi=Object(g.a)(Bi=class extends p.Component{render(){return Object(S.jsx)("div",{className:"spectral-profiler-toolbar",children:Object(S.jsx)(Jn,{widgetStore:this.props.widgetStore})})}})||Bi;var qi,Yi,Ui,Xi,$i;i(882);let Ki=Object(g.a)((Yi=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"histogram",type:"histogram",minWidth:400,minHeight:225,defaultWidth:650,defaultHeight:225,title:"Histogram",isCloseable:!0,helpType:O.x.HISTOGRAM}}get widgetStore(){const e=O.U.Instance;if(e.histogramWidgets){const t=e.histogramWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.h}get histogramData(){const e=O.e.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId,i=this.widgetStore.effectiveRegionId;const n=e.regionHistograms.get(t);if(!n)return null;const r=n.get(i);if(r&&r.histograms&&r.histograms.length)return r.histograms[0]}return null}get plotData(){const e=this.histogramData;if(e){let t=0,i=e.bins.length-1;this.widgetStore.isAutoScaledX||(t=Math.floor((this.widgetStore.minX-e.firstBinCenter)/e.binWidth),t=Object(D.k)(t,0,e.bins.length-1),i=Math.ceil((this.widgetStore.maxX-e.firstBinCenter)/e.binWidth),i=Object(D.k)(i,0,e.bins.length-1));let n,r=e.firstBinCenter+e.binWidth*t,o=e.firstBinCenter+e.binWidth*i,s=e.bins[t],a=s;const l=i-t;if(l>0&&!isNaN(l)){n=new Array(i-t);for(let r=t;r<=i;r++)n[r-t]={x:e.firstBinCenter+e.binWidth*r,y:e.bins[r]},s=Math.min(s,e.bins[r]),a=Math.max(a,e.bins[r])}return{values:n,xMin:r,xMax:o,yMin:s,yMax:a}}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find((e=>e.regionId===i));n&&e.push(n.regionProperties)}return e}constructor(t){super(t),this.cachedFrame=void 0,Object(u.a)(this,"width",Ui,this),Object(u.a)(this,"height",Xi,this),Object(u.a)(this,"onResize",$i,this),this.onGraphCursorMoved=Y.throttle((e=>{this.widgetStore.setCursor(e)}),100),Object(f.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.histogramWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.histogramWidgets.set(this.props.id,new Qe.h));else{const e=i.widgetsStore.addHistogramWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(f.h)((()=>{if(this.widgetStore&&this.widgetStore.effectiveFrame){let e="Unknown";const t=this.widgetStore.effectiveRegionId;if(-1===t)e="Image";else if(this.widgetStore.effectiveFrame.regionSet){const i=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===t));i&&(e=i.nameString)}const n=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`Histogram: ${e} ${n}`)}else i.widgetsStore.setWidgetTitle(this.props.id,"Histogram");const e=this.widgetStore;if(e){const t=this.plotData;t&&e.initXYBoundaries(t.xMin,t.xMax,t.yMin,t.yMax)}}))}componentDidUpdate(){const e=this.widgetStore.effectiveFrame;e!==this.cachedFrame&&(this.cachedFrame=e,this.widgetStore.clearXYBounds())}render(){const e=O.e.Instance,t=this.widgetStore.effectiveFrame;if(!t||!this.widgetStore)return Object(S.jsx)("div",{className:"histogram-widget",children:Object(S.jsx)(b.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});let i="Value";t&&t.unit&&(i=`Value (${t.unit})`);const n=t.filename,r=`channel ${t.channel} histogram`;let o={xLabel:i,yLabel:"Count",darkMode:e.darkTheme,imageName:n,plotName:r,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,tickTypeY:li.b.Scientific,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,graphCursorMoved:this.onGraphCursorMoved,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2};if(t.renderConfig.histogram&&t.renderConfig.histogram.bins&&t.renderConfig.histogram.bins.length){const t=this.plotData;if(t){o.data=t.values;let i=this.widgetStore.primaryLineColor.colorHex;e.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(i=ae.a.BLUE4)),o.lineColor=i,this.widgetStore.isAutoScaledX?(o.xMin=t.xMin,o.xMax=t.xMax):(o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX),this.widgetStore.isAutoScaledY?(o.yMin=t.yMin,o.yMax=t.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5)}o.comments=this.exportHeaders}let s="histogram-widget";return e.darkTheme&&(s+=" dark-theme"),Object(S.jsxs)("div",{className:s,children:[Object(S.jsxs)("div",{className:"histogram-container",children:[Object(S.jsx)(Hi,{widgetStore:this.widgetStore}),Object(S.jsx)("div",{className:"histogram-plot",children:Object(S.jsx)(j.f,{...o})})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle"})]})}},Ui=Object(h.a)(Yi.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xi=Object(h.a)(Yi.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(Yi.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Yi.prototype,"widgetStore"),Yi.prototype),Object(h.a)(Yi.prototype,"histogramData",[f.i],Object.getOwnPropertyDescriptor(Yi.prototype,"histogramData"),Yi.prototype),Object(h.a)(Yi.prototype,"plotData",[f.i],Object.getOwnPropertyDescriptor(Yi.prototype,"plotData"),Yi.prototype),Object(h.a)(Yi.prototype,"exportHeaders",[f.i],Object.getOwnPropertyDescriptor(Yi.prototype,"exportHeaders"),Yi.prototype),$i=Object(h.a)(Yi.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),qi=Yi))||qi;var Qi;i(883);let Zi=Object(g.a)(Qi=class extends p.Component{constructor(...e){super(...e),this.handleFractionalPolChanged=e=>{this.props.widgetStore.setFractionalPolVisible(e.target.checked)},this.smoothingShortcutClick=()=>{this.props.widgetStore.setSettingsTabId(Tn.SMOOTHING),O.e.Instance.widgetsStore.createFloatingSettingsWidget(an.WIDGET_CONFIG.title,this.props.id,an.WIDGET_CONFIG.type)},this.handleFrameChanged=e=>{!e||!e.regionSet||e.frameInfo.fileInfoExtended.stokes>1||this.props.widgetStore.setFractionalPolVisible(!1)}}render(){const e=this.props.widgetStore;let t=!1;return e.effectiveFrame&&e.effectiveFrame.regionSet&&(t=e.effectiveFrame.frameInfo.fileInfoExtended.stokes>1),Object(S.jsxs)("div",{className:"stokes-analysis-toolbar",children:[Object(S.jsx)(Jn,{widgetStore:this.props.widgetStore,onFrameChanged:this.handleFrameChanged}),Object(S.jsx)(b.p,{label:"Frac. Pol.",inline:!0,disabled:!t,children:Object(S.jsx)(b.P,{checked:e.fractionalPolVisible,onChange:this.handleFractionalPolChanged,disabled:!t})}),Object(S.jsx)(b.f,{className:"profile-buttons",children:Object(S.jsx)(b.W,{content:"Smoothing",children:Object(S.jsx)(b.b,{icon:Object(S.jsx)(It.a,{icon:"smoothing"}),onClick:this.smoothingShortcutClick})})})]})}})||Qi;var Ji,en,tn,nn,rn,on,sn;i(884);let an=Object(g.a)((sn=on=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"stokes",type:"stokes",minWidth:320,minHeight:400,defaultWidth:520,defaultHeight:650,title:"Stokes Analysis",isCloseable:!0,helpType:O.x.STOKES_ANALYSIS}}get widgetStore(){const e=O.U.Instance;if(e.stokesAnalysisWidgets){const t=e.stokesAnalysisWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),new Qe.u}get profileStore(){const e=O.e.Instance;if(this.widgetStore.effectiveFrame){let t=this.widgetStore.effectiveFrame.frameInfo.fileId;const i=this.widgetStore.effectiveRegionId,n=e.spectralProfiles.get(t);if(n)return n.get(i)}return null}get exportHeaders(){let e=[];const t=this.widgetStore.effectiveFrame;if(t&&t.frameInfo&&t.regionSet){const i=this.widgetStore.effectiveRegionId,n=t.regionSet.regions.find((e=>e.regionId===i));n&&(e.push(n.regionProperties),t.validWcs&&e.push(t.getRegionWcsProperties(n)))}return e}get exportQUScatterHeaders(){return this.widgetStore.smoothingStore.type===j.t.NONE?this.exportHeaders:this.exportHeaders.concat(this.widgetStore.smoothingStore.comments)}constructor(t){super(t),this.pointDefaultColor=ae.a.GRAY2,this.opacityOutRange=.1,this.channelBorder=void 0,this.minProgress=0,this.cursorInfo=void 0,this.multicolorLineColorOutRange="hsla(0, 0%, 50%, 0.5)",Object(u.a)(this,"width",tn,this),Object(u.a)(this,"height",nn,this),Object(u.a)(this,"onResize",rn,this),this.onChannelChanged=e=>{const t=this.widgetStore.effectiveFrame;if(!O.d.Instance.animationActive&&t&&t.channelInfo){let i,n=t.channelInfo;if(t.isCoordChannel)i=n.getChannelIndexSimple(e);else if(t.spectralAxis&&!t.spectralAxis.valid||t.isSpectralPropsEqual)i=n.getChannelIndexWCS(e);else{const r=t.convertToNativeWCS(e);isFinite(r)&&(i=n.getChannelIndexWCS(r))}null!==i&&void 0!==i&&t.setChannels(i,t.requiredStokes,!0)}},this.onScatterChannelChanged=(e,t,i)=>{const n=this.widgetStore.effectiveFrame;if(!O.d.Instance.animationActive&&i.length>0&&n&&n.channelInfo){let r=n.channelInfo;const o=this.matchZindex(e,t,i);let s;if(n.isCoordChannel)s=r.getChannelIndexSimple(o);else if(n.isSpectralPropsEqual)s=r.getChannelIndexWCS(o);else{const t=n.convertToNativeWCS(e);isFinite(t)&&(s=r.getChannelIndexWCS(t))}null!==s&&void 0!==s&&n.setChannels(s,n.requiredStokes,!0)}},this.onGraphCursorMoved=Y.throttle((e=>{this.widgetStore.setlinePlotCursorX(e)}),33),this.onScatterGraphCursorMoved=Y.throttle(((e,t)=>{this.widgetStore.setScatterPlotCursor({x:e,y:t})}),33),this.fillProfilerDataInLinePlots=(e,t,i,n,r)=>{const o=Object(D.i)(t,n),s=Object(D.i)(i,n);if(o&&o.point&&s&&s.point){const t=this.matchXYindex(o.point.x,e);r.q=t.x,r.u=t.y,r.channel=t.z,r.pi=o.point.y,r.pa=s.point.y}},this.fillProfilerDataInScatterPlots=(e,t,i,n,r)=>{const o=Object(D.m)(n,e);if(o>=0){const n=e[o];if(n){const e=Object(D.i)(t,n.z),o=Object(D.i)(i,n.z);r.q=n.x,r.u=n.y,e&&e.point&&o&&o.point&&(r.channel=e.point.x,r.pi=e.point.y,r.pa=o.point.y)}}},this.getCursorInfo=(e,t,i,n,r,o,s)=>{let a=null;const l=this.widgetStore.isMouseMoveIntoLinePlots||this.widgetStore.isMouseMoveIntoScatterPlots,c=this.widgetStore.effectiveFrame?this.widgetStore.effectiveFrame.spectralUnitStr:"Channel";if(l){let o={q:NaN,u:NaN,pi:NaN,pa:NaN,channel:NaN};this.widgetStore.isMouseMoveIntoLinePlots&&this.fillProfilerDataInLinePlots(e,t,i,r,o),this.widgetStore.isMouseMoveIntoScatterPlots&&this.fillProfilerDataInScatterPlots(e,t,i,n,o),a={isMouseEntered:l,quValue:{x:o.q,y:o.u},channel:o.channel,pi:o.pi,pa:o.pa,xUnit:c}}else{const e=Object(D.i)(t,s),n=Object(D.i)(i,s);a={isMouseEntered:l,quValue:{x:o?o.x:NaN,y:o?o.y:NaN},channel:s,pi:e&&e.point?e.point.y:NaN,pa:n&&n.point?n.point.y:NaN,xUnit:c}}return a},this.genProfilerInfo=()=>{let e=[];if(!this.cursorInfo||null===this.cursorInfo.quValue.x||null===this.cursorInfo.quValue.y||isNaN(this.cursorInfo.quValue.x)||isNaN(this.cursorInfo.quValue.y))return e;if(this.widgetStore.effectiveFrame&&this.plotData){const t="Channel"===this.cursorInfo.xUnit?"Channel "+Object(D.mb)(this.cursorInfo.channel):Object(D.x)(this.cursorInfo.channel)+" "+this.cursorInfo.xUnit,i=this.widgetStore.fractionalPolVisible,n=i?", U/I: ":", U: ",r=i?", PI/I: ":", PI: ",o="("+t+(i?", Q/I: ":", Q: ")+Object(D.lb)(this.cursorInfo.quValue.x,2)+n+Object(D.lb)(this.cursorInfo.quValue.y,2)+r+Object(D.lb)(this.cursorInfo.pi,2)+", PA: "+Object(D.mb)(this.cursorInfo.pa,2)+")";e.push(`${this.cursorInfo.isMouseEntered?"Cursor:":"Data:"} ${o}`)}return e},Object(f.p)(this);const i=O.e.Instance;if(t.docked||t.id!==e.WIDGET_CONFIG.type)i.widgetsStore.stokesAnalysisWidgets.has(this.props.id)||(console.log(`can't find store for widget with id=${this.props.id}`),i.widgetsStore.stokesAnalysisWidgets.set(this.props.id,new Qe.u));else{const e=i.widgetsStore.addStokesWidget();i.widgetsStore.changeWidgetId(t.id,e)}Object(f.h)((()=>{if(this.widgetStore){const e=this.widgetStore.effectiveFrame;let t="";const n=this.plotData;if(n&&isFinite(n.qProgress)&&isFinite(n.uProgress)){const e=Math.min(n.qProgress,n.uProgress,n.iProgress);e<1&&(t=`[${Object(D.mb)(100*e)}% complete]`),this.minProgress=e}if(e){const e=this.widgetStore.effectiveRegionId,n=0===e?"Cursor":`Region #${e}`,r=this.widgetStore.matchesSelectedRegion?"(Active)":"";i.widgetsStore.setWidgetTitle(this.props.id,`Stokes Analysis : ${n} ${r} ${t}`)}}else i.widgetsStore.setWidgetTitle(this.props.id,"Stokes Analysis: Cursor")}))}getColorMapOrder(e){var t;const i=null===e||void 0===e||null===(t=e.channelInfo)||void 0===t?void 0:t.channelType.code;let n=null!==(null===e||void 0===e?void 0:e.spectralType)?null===e||void 0===e?void 0:e.spectralType:i;switch(n===Q.SpectralType.CHANNEL&&(n=i),n){case Q.SpectralColorMap.FREQ:case Q.SpectralColorMap.ENER:case Q.SpectralColorMap.WAVE:return!0;default:return!1}}get currentChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.channel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}get requiredChannelValue(){const e=this.widgetStore.effectiveFrame;if(!e||!e.channelValues)return null;const t=e.requiredChannel;return t<0||t>=e.channelValues.length?null:e.isCoordChannel?t:e.channelValues[t]}matchZindex(e,t,i){let n=0;for(let r=0;r<i.length;r++){const o=i[r];if(o.x===e&&o.y===t){n=o.z;break}}return n}matchXYindex(e,t){let i=t[0];for(let n=0;n<t.length;n++){const r=t[n];if(r.z===e){i=r;break}}return i}static calculatePA(e,t){let i=[];if(e&&t&&e.length===t.length)for(let n=0;n<e.length;n++)i[n]=Object(D.ab)(e[n],t[n]);return i}static calculatePI(e,t){let i=[];if(e&&t&&e.length===t.length)for(let n=0;n<e.length;n++)i[n]=Object(D.bb)(e[n],t[n]);return i}static calculateFractionalPol(e,t){let i=[];if(e&&t&&e.length===t.length)for(let n=0;n<e.length;n++)i[n]=Object(D.W)(e[n],t[n]);return i}calculateCompositeProfile(t){if(this.profileStore){let i=this.profileStore.getProfile(Qe.v.LinearPolarizationQ,t),n=this.profileStore.getProfile(Qe.v.LinearPolarizationU,t);if(i&&n&&i.values&&n.values){let r=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,i.values),o=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,n.values),s=[],a=[],l=[],c=[],d=[],u=[],h=[],p=[],g=[],f=[];if(s=Array.prototype.slice.call(i.values),a=Array.prototype.slice.call(n.values),l=e.calculatePI(i.values,n.values),c=e.calculatePA(i.values,n.values),this.widgetStore.smoothingStore.type!==j.t.NONE&&(d=Array.prototype.slice.call(r.y),u=Array.prototype.slice.call(o.y),h=r.x,p=o.x,g=e.calculatePI(r.y,o.y),f=e.calculatePA(r.y,o.y)),this.widgetStore.fractionalPolVisible){let r=this.profileStore.getProfile(Qe.v.TotalIntensity,t);if(r&&r.values){if(l=e.calculateFractionalPol(l,r.values),s=e.calculateFractionalPol(s,r.values),a=e.calculateFractionalPol(a,r.values),this.widgetStore.smoothingStore.type!==j.t.NONE){let t=this.widgetStore.smoothingStore.getSmoothingValues(this.widgetStore.effectiveFrame.channelValues,r.values);g=e.calculateFractionalPol(g,t.y),d=e.calculateFractionalPol(d,t.y),u=e.calculateFractionalPol(u,t.y)}return{qProfile:s,qProfileSmoothed:d,qSmoothedX:h,uProfile:a,uProfileSmoothed:u,uSmoothedX:p,piProfile:l,piProfileSmoothed:g,paProfile:c,paProfileSmoothed:f,qProgress:i.progress,uProgress:n.progress,iProgress:r.progress}}}return{qProfile:s,qProfileSmoothed:d,qSmoothedX:h,uProfile:a,uProfileSmoothed:u,uSmoothedX:p,piProfile:l,piProfileSmoothed:g,paProfile:c,paProfileSmoothed:f,qProgress:i.progress,uProgress:n.progress,iProgress:1}}}return null}getChartAreaWH(e){return e&&e.right&&e.bottom?{width:Math.abs(e.right-e.left),height:Math.abs(e.bottom-e.top)}:{width:0,height:0}}resizeScatterData(e,t,i,n){if(!this.widgetStore.equalAxes)return{xMin:e,xMax:t,yMin:i,yMax:n};let r=Math.max(Math.abs(e),Math.abs(t)),o=Math.max(Math.abs(i),Math.abs(n));if(this.widgetStore.scatterChartArea){let e=this.getChartAreaWH(this.widgetStore.scatterChartArea);if(0!==e.width&&0!==e.height){let t=e.width/e.height;t<1&&(o*=1/t),t>1&&(r*=t)}}return{xMin:-r,xMax:r,yMin:-o,yMax:o}}calculateXYborder(e,t,i,n){const r=Object(D.U)(e),o=Object(D.U)(t);let s=r.minVal,a=r.maxVal,l=o.minVal,c=o.maxVal;if(!this.widgetStore.isLinePlotsAutoScaledX&&i){const e=Object(D.k)(this.widgetStore.sharedMinX,s,a),t=Object(D.k)(this.widgetStore.sharedMaxX,s,a);s=e,a=t}if(!this.widgetStore.isQUScatterPlotAutoScaledX&&!i&&n===Qe.v.PolarizationQU){const e=Object(D.k)(this.widgetStore.quScatterMinX,s,a),t=Object(D.k)(this.widgetStore.quScatterMaxX,s,a);s=e,a=t}if(!this.widgetStore.isQUScatterPlotAutoScaledY&&!i&&n===Qe.v.PolarizationQU){const e=Object(D.k)(this.widgetStore.quScatterMinY,l,c),t=Object(D.k)(this.widgetStore.quScatterMaxY,l,c);l=e,c=t}if(l===Number.MAX_VALUE&&(l=void 0,c=void 0),!this.widgetStore.isPolAngleAutoScaledY&&i&&n===Qe.v.PolarizationAngle){const e=Object(D.k)(this.widgetStore.polAngleMinY,l,c),t=Object(D.k)(this.widgetStore.polAngleMaxY,l,c);l=e,c=t}if(!this.widgetStore.isPolIntensityAutoScaledY&&i&&n===Qe.v.PolarizedIntensity){const e=Object(D.k)(this.widgetStore.polIntensityMinY,l,c),t=Object(D.k)(this.widgetStore.polIntensityMaxY,l,c);l=e,c=t}if(this.widgetStore.isQULinePlotAutoScaledY||!i||n!==Qe.v.LinearPolarizationQ&&n!==Qe.v.LinearPolarizationU){if(i){const e=c-l;l-=e*j.y,c+=e*j.y}}else{const e=Object(D.k)(this.widgetStore.quMinY,l,c),t=Object(D.k)(this.widgetStore.quMaxY,l,c);l=e,c=t}return{xMin:s,xMax:a,yMin:l,yMax:c}}assembleLinePlotData(e,t,i){if(e&&e.length&&t&&e.length===t.length){let n=this.calculateXYborder(t,e,!0,i),r=[];for(let i=0;i<t.length;i++){const o=t[i],s=e[i];o<n.xMin||o>n.xMax||s<n.yMin||s>n.yMax?r.push({x:o,y:NaN}):r.push({x:o,y:s})}return{dataset:r,border:n}}return null}assembleScatterPlotData(e,t,i){const n=this.widgetStore.effectiveFrame;if(e&&e.length&&t&&t.length&&n.channelValues&&n.channelValues.length&&e.length===t.length&&(e.length===n.channelValues.length||this.widgetStore.smoothingStore.type===j.t.BINNING)){const r=n.channelValues;let o=this.calculateXYborder(e,t,!1,i),s=[],a=this.resizeScatterData(o.xMin,o.xMax,o.yMin,o.yMax);this.widgetStore.scatterOutRangePointsZIndex=[];for(let i=0;i<r.length;i++){const n=e[i],a=t[i],l=r[i];s.push({x:n,y:a,z:l}),(n<o.xMin||n>o.xMax||a<o.yMin||a>o.yMax)&&this.widgetStore.scatterOutRangePointsZIndex.push(l)}return{dataset:s,border:a}}return null}compareVariable(e,t,i,n){return e===t&&e===i&&e===n&&null!==e}getScatterColor(e,t){const i=this.widgetStore.colorPixel.color,n=this.widgetStore.colorPixel.size;t&&(e=1-e);const r=4*Math.round(e*n),o=this.widgetStore.pointTransparency?this.widgetStore.pointTransparency:1;return`rgba(${i[r]}, ${i[r+1]}, ${i[r+2]}, ${o})`}fillScatterColor(e,t,i){let n=[];const r=this.widgetStore;if(e&&e.length&&i&&t&&r){let i=t;const o=`hsla(0, 0%, 50%, ${this.opacityOutRange})`,s=r.effectiveFrame,a=this.getColorMapOrder(s),l=[];for(let t=0;t<e.length;t++){const n=e[t];n.z>=i.xMin&&n.z<=i.xMax&&l.push(n)}const c=Object(D.V)(l);for(let t=0;t<e.length;t++){const s=e[t];let l=this.pointDefaultColor,d=!0;s.z>=i.xMin&&s.z<=i.xMax&&(d=!1);let u=(s.z-c.minVal)/(c.maxVal-c.minVal);r.invertedColorMap&&(u=1-u),l=d?o:this.getScatterColor(u,a),n.push(l)}}return n}fillLineColor(e,t){let i=[];if(this.widgetStore.plotType!==j.j.POINTS&&i.push(""),e&&e.length&&t)for(let n=0;n<e.length;n++){const r=e[n];this.widgetStore.scatterOutRangePointsZIndex&&this.widgetStore.scatterOutRangePointsZIndex.indexOf(r.x)>=0?i.push(this.multicolorLineColorOutRange):i.push(t)}return i}closestChannel(e,t){for(var i,n=0,r=t.length-1;r-n>1;)t[i=Math.floor((n+r)/2)].z<e?n=i:r=i;return e-t[n].z<=t[r].z-e?t[n].z:t[r].z}getScatterChannel(e,t,i){let n={currentChannel:e[0],hoveredChannel:e[0]};if(e&&e.length&&i&&t){let i=t.channelCurrent,r=t.channelHovered;if(i){let t=i;r&&(t=this.closestChannel(r,e),this.channelBorder&&0!==this.channelBorder.xMin&&(t>this.channelBorder.xMax||t<this.channelBorder.xMin||!this.widgetStore.isMouseMoveIntoLinePlots)&&(t=i));for(let r=0;r<e.length;r++){const o=e[r];o.z===t&&(n.hoveredChannel=o),o.z===i&&(n.currentChannel=o)}}}return n}get plotData(){const e=this.widgetStore.effectiveFrame;if(!e)return null;let t,i=this.widgetStore.effectiveRegionId;if(e.regionSet){const n=e.regionSet.regions.find((e=>e.regionId===i));n&&(t=this.calculateCompositeProfile(n.isClosedRegion?this.widgetStore.statsType:ne.a.StatsType.Sum))}let n=e.channelInfo;if(t&&n){let i=this.assembleScatterPlotData(t.qProfile,t.uProfile,Qe.v.PolarizationQU),n=this.assembleScatterPlotData(t.qProfileSmoothed,t.uProfileSmoothed,Qe.v.PolarizationQU),r=this.assembleLinePlotData(t.piProfile,e.channelValues,Qe.v.PolarizedIntensity),o=this.assembleLinePlotData(t.paProfile,e.channelValues,Qe.v.PolarizationAngle),s=this.assembleLinePlotData(t.qProfile,e.channelValues,Qe.v.LinearPolarizationQ),a=this.assembleLinePlotData(t.uProfile,e.channelValues,Qe.v.LinearPolarizationU),l=this.assembleLinePlotData(t.piProfileSmoothed,t.qSmoothedX,Qe.v.PolarizedIntensity),c=this.assembleLinePlotData(t.paProfileSmoothed,t.qSmoothedX,Qe.v.PolarizationAngle);return{qValues:s,uValues:a,piValues:r,paValues:o,qSmoothedValues:this.assembleLinePlotData(t.qProfileSmoothed,t.qSmoothedX,Qe.v.LinearPolarizationQ),uSmoothedValues:this.assembleLinePlotData(t.uProfileSmoothed,t.uSmoothedX,Qe.v.LinearPolarizationU),piSmoothedValues:l,paSmoothedValues:c,quValues:i,quSmoothedValues:n,qProgress:t.qProgress,uProgress:t.uProgress,iProgress:t.iProgress}}return null}render(){const t=O.e.Instance;if(!this.widgetStore)return Object(S.jsx)(b.C,{icon:"error",title:"Missing profile",description:"Profile not found"});const i=this.widgetStore.effectiveFrame,n=this.widgetStore.effectiveFrame?this.widgetStore.effectiveFrame.filename:void 0;let r={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeY:li.b.Scientific,showXAxisTicks:!1,showXAxisLabel:!1,showLegend:!0,xTickMarkLength:0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setQULinePlotYBounds,graphZoomedXY:this.widgetStore.setQULinePlotsXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,multiColorMultiLinesColors:new Map,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map},o={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeY:li.b.Scientific,showXAxisTicks:!1,showXAxisLabel:!1,xTickMarkLength:0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setPolIntensityYBounds,graphZoomedXY:this.widgetStore.setPolIntensityXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1},s={xLabel:"Channel",yLabel:"Value",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeY:li.b.Integer,showXAxisTicks:!0,showXAxisLabel:!0,graphCursorMoved:this.onGraphCursorMoved,isGroupSubPlot:!0,scrollZoom:!0,graphZoomedX:this.widgetStore.setSharedXBounds,graphZoomedY:this.widgetStore.setPolAngleYBounds,graphZoomedXY:this.widgetStore.setPolAngleXYBounds,graphZoomReset:this.widgetStore.clearLinePlotsXYBounds,graphClicked:this.onChannelChanged,markers:[],mouseEntered:this.widgetStore.setMouseMoveIntoLinePlots,plotType:this.widgetStore.plotType,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,multiPlotPropsMap:new Map,order:1},a={xLabel:"Channel",yLabel:"Channel",darkMode:t.darkTheme,imageName:n,plotName:"profile",tickTypeX:li.b.Scientific,tickTypeY:li.b.Scientific,showXAxisTicks:!0,showXAxisLabel:!0,plotType:j.j.POINTS,zeroLineWidth:2,isGroupSubPlot:!0,colorRangeEnd:240,zIndex:!0,graphCursorMoved:this.onScatterGraphCursorMoved,graphClicked:this.onScatterChannelChanged,graphZoomReset:this.widgetStore.clearScatterPlotXYBounds,mouseEntered:this.widgetStore.setMouseMoveIntoScatterPlots,scrollZoom:!0,graphZoomedXY:this.widgetStore.setQUScatterPlotXYBounds,updateChartArea:this.widgetStore.setScatterChartAres,pointRadius:this.widgetStore.scatterPlotPointSize},l="profile-container-"+e.calculateLayout(this.width,this.height),c={xMin:0,xMax:0};if(this.profileStore&&i){const e={profiler:this.widgetStore.linePlotcursorX,image:this.currentChannelValue,unit:i.spectralUnitStr},n=this.plotData;let l={channelCurrent:0,channelHovered:0};if(n&&n.piValues&&n.paValues&&n.qValues&&n.uValues&&n.quValues){o.data=n.piValues.dataset,s.data=n.paValues.dataset,a.data=this.widgetStore.smoothingStore.type===j.t.NONE?n.quValues.dataset:n.quSmoothedValues.dataset;const l=this.minProgress<1?.15+this.minProgress/4:1;r.opacity=l,o.opacity=l,s.opacity=l,r.opacity=l;let d=this.widgetStore.primaryLineColor.colorHex,u=this.widgetStore.secondaryLineColor.colorHex;t.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(d=ae.a.BLUE4),this.widgetStore.secondaryLineColor.fixed||(u=ae.a.ORANGE4)),o.lineColor=d,s.lineColor=d;let h={data:n.qValues.dataset,type:this.widgetStore.plotType,borderColor:d,order:1},p={data:n.uValues.dataset,type:this.widgetStore.plotType,borderColor:u,order:1};r.multiPlotPropsMap.set(Qe.v.LinearPolarizationQ,h),r.multiPlotPropsMap.set(Qe.v.LinearPolarizationU,p);const g=this.widgetStore.smoothingStore;if(g.type!==j.t.NONE&&n.qSmoothedValues&&n.uSmoothedValues&&n.piSmoothedValues&&n.piSmoothedValues){let e={data:n.qSmoothedValues.dataset,type:g.lineType,borderColor:d,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},t={data:n.uSmoothedValues.dataset,type:g.lineType,borderColor:u,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},i={data:n.piSmoothedValues.dataset,type:g.lineType,borderColor:d,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1},a={data:n.paSmoothedValues.dataset,type:g.lineType,borderColor:g.colorMap.get(Qe.v.PolarizationAngle)?g.colorMap.get(Qe.v.PolarizationAngle).colorHex:d,borderWidth:this.widgetStore.lineWidth+1,pointRadius:this.widgetStore.linePlotPointSize+1};r.multiPlotPropsMap.set(Qe.v.LinearPolarizationQ+"_smoothed",e),r.multiPlotPropsMap.set(Qe.v.LinearPolarizationU+"_smoothed",t),o.multiPlotPropsMap.set("smoothed",i),s.multiPlotPropsMap.set("smoothed",a)}const f=1===n.qProgress&&1===n.uProgress&&1===n.iProgress;let b,m;g.type===j.t.NONE||g.isOverlayOn?(b=f?this.fillLineColor(n.qValues.dataset,d):[],m=f?this.fillLineColor(n.uValues.dataset,u):[],o.multiColorSingleLineColors=f?this.fillLineColor(n.piValues.dataset,d):[],s.multiColorSingleLineColors=f?this.fillLineColor(n.paValues.dataset,d):[]):(b=f?this.fillLineColor(n.qValues.dataset,"#00000000"):[],m=f?this.fillLineColor(n.uValues.dataset,"#00000000"):[],o.multiColorSingleLineColors=f?this.fillLineColor(n.piValues.dataset,"#00000000"):[],s.multiColorSingleLineColors=f?this.fillLineColor(n.paValues.dataset,"#00000000"):[]),r.multiColorMultiLinesColors.set(Qe.v.LinearPolarizationQ,b),r.multiColorMultiLinesColors.set(Qe.v.LinearPolarizationU,m);let y=n.qValues.border,O=n.uValues.border,S=n.piValues.border,x=n.paValues.border,C=n.quValues.border;if(this.compareVariable(y.xMin,O.xMin,S.xMin,x.xMin)&&this.compareVariable(y.xMax,O.xMax,S.xMax,x.xMax)){c={xMin:x.xMin,xMax:x.xMax},this.channelBorder={xMin:x.xMin,xMax:x.xMax},this.widgetStore.isLinePlotsAutoScaledX?(r.xMin=y.xMin,r.xMax=y.xMax,o.xMin=S.xMin,o.xMax=S.xMax,s.xMin=x.xMin,s.xMax=x.xMax):(r.xMin=this.widgetStore.sharedMinX,r.xMax=this.widgetStore.sharedMaxX,o.xMin=this.widgetStore.sharedMinX,o.xMax=this.widgetStore.sharedMaxX,s.xMin=this.widgetStore.sharedMinX,s.xMax=this.widgetStore.sharedMaxX,c={xMin:this.widgetStore.sharedMinX,xMax:this.widgetStore.sharedMaxX});let e=this.fillScatterColor(a.data,c,!0);a.dataBackgroundColor=e,this.widgetStore.isQULinePlotAutoScaledY?(r.yMin=y.yMin<O.yMin?y.yMin:O.yMin,r.yMax=y.yMax>O.yMax?y.yMax:O.yMax):(r.yMin=this.widgetStore.quMinY,r.yMax=this.widgetStore.quMaxY),this.widgetStore.isPolIntensityAutoScaledY?(o.yMin=S.yMin,o.yMax=S.yMax):(o.yMin=this.widgetStore.polIntensityMinY,o.yMax=this.widgetStore.polIntensityMaxY),this.widgetStore.isPolAngleAutoScaledY?(s.yMin=x.yMin,s.yMax=x.yMax):(s.yMin=this.widgetStore.polAngleMinY,s.yMax=this.widgetStore.polAngleMaxY)}this.widgetStore.isQUScatterPlotAutoScaledX?(a.xMin=C.xMin,a.xMax=C.xMax):(a.xMin=this.widgetStore.quScatterMinX,a.xMax=this.widgetStore.quScatterMaxX),this.widgetStore.isQUScatterPlotAutoScaledY?(a.yMin=C.yMin,a.yMax=C.yMax):(a.yMin=this.widgetStore.quScatterMinY,a.yMax=this.widgetStore.quScatterMaxY);let I={profiler:{x:this.widgetStore.scatterPlotCursorX,y:this.widgetStore.scatterPlotCursorY},image:this.matchXYindex(e.image,a.data),unit:i.spectralUnitStr};a.cursorXY=I,this.cursorInfo=this.getCursorInfo(a.data,this.widgetStore.smoothingStore.type===j.t.NONE?n.piValues.dataset:n.piSmoothedValues.dataset,this.widgetStore.smoothingStore.type===j.t.NONE?n.paValues.dataset:n.paSmoothedValues.dataset,I.profiler,e.profiler,I.image,e.image),this.cursorInfo&&this.cursorInfo.quValue&&(a.cursorNearestPoint=this.cursorInfo.quValue)}if(s.yLabel="PA (Degrees)",this.widgetStore.fractionalPolVisible?(r.yLabel="Value (%)",o.yLabel="PI/I (%)",a.xLabel="Q/I (%)",a.yLabel="U/I (%)"):(r.yLabel="Value ("+i.unit+")",o.yLabel="PI ("+i.unit+")",a.xLabel="Stokes Q ("+i.unit+")",a.yLabel="Stokes U ("+i.unit+")"),i.spectralAxis&&!i.isCoordChannel){const e=i.isSpectralSystemConvertible?i.spectralSystem:`${i.spectralInfo.specsys}`;s.xLabel=o.xLabel=r.xLabel=`${e&&""!==e?e+", ":""}${i.spectralCoordinate}`}if(s.markers=[],o.markers=[],r.markers=[],this.cursorInfo&&this.cursorInfo.channel&&this.widgetStore.isMouseMoveIntoScatterPlots){let e={value:this.cursorInfo.channel,id:"marker-profiler-cursor-stokes2",draggable:!1,horizontal:!1,color:t.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!this.widgetStore.isMouseMoveIntoLinePlots,interactionMarker:!0};s.markers.push(e),o.markers.push(e),r.markers.push(e)}if(null!==e.profiler){let i={value:e.profiler,id:"marker-profiler-cursor-stokes",draggable:!1,horizontal:!1,color:t.darkTheme?ae.a.GRAY4:ae.a.GRAY2,opacity:.8,isMouseMove:!this.widgetStore.isMouseMoveIntoLinePlots};s.markers.push(i),o.markers.push(i),r.markers.push(i),i&&i.value&&void 0!==typeof i.value&&(l.channelHovered=i.value)}if(null!==e.image){let t={value:e.image,id:"marker-channel-current",opacity:.4,draggable:!1,horizontal:!1},i={value:this.requiredChannelValue,id:"marker-channel-required",draggable:!O.d.Instance.animationActive,dragMove:this.onChannelChanged,horizontal:!1};s.markers.push(t,i),o.markers.push(t,i),r.markers.push(t,i),t&&t.value&&void 0!==typeof t.value&&(l.channelCurrent=t.value)}if(a.data&&a.data.length&&c){const e=this.getScatterChannel(a.data,l,!0);a.indicatorInteractionChannel={currentChannel:e.currentChannel,hoveredChannel:e.hoveredChannel,start:this.widgetStore.isMouseMoveIntoLinePlots}}s.comments=this.exportHeaders,o.comments=this.exportHeaders,r.comments=this.exportHeaders,a.comments=this.exportQUScatterHeaders}return Object(S.jsxs)("div",{className:"stokes-widget",children:[Object(S.jsxs)("div",{className:l,children:[Object(S.jsx)("div",{className:"profile-plot-toolbar",children:Object(S.jsx)(Zi,{widgetStore:this.widgetStore,id:this.props.id})}),Object(S.jsxs)("div",{className:"profile-plot-qup",children:[Object(S.jsx)("div",{className:"profile-plot-qu",children:Object(S.jsx)(j.f,{...r})}),Object(S.jsx)("div",{className:"profile-plot-pi",children:Object(S.jsx)(j.f,{...o})}),Object(S.jsx)("div",{className:"profile-plot-pa",children:Object(S.jsx)(j.f,{...s})})]}),Object(S.jsx)("div",{className:"profile-plot-qvsu",children:Object(S.jsx)(j.p,{...a})}),Object(S.jsx)(j.l,{info:this.genProfilerInfo()})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},on.layoutRatioCutoffs={vertical:.5,horizontal:2},on.calculateLayout=(e,t)=>{if(e&&t){let i=e/t,n=Math.abs(i-an.layoutRatioCutoffs.vertical),r=Math.abs(i-an.layoutRatioCutoffs.horizontal),o=Math.min(n,r);return o===n?"vertical":o===r?"horizontal":null}return null},en=sn,tn=Object(h.a)(en.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn=Object(h.a)(en.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(en.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"widgetStore"),en.prototype),Object(h.a)(en.prototype,"profileStore",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"profileStore"),en.prototype),Object(h.a)(en.prototype,"exportHeaders",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"exportHeaders"),en.prototype),Object(h.a)(en.prototype,"exportQUScatterHeaders",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"exportQUScatterHeaders"),en.prototype),rn=Object(h.a)(en.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t,this.widgetStore.clearScatterPlotXYBounds()}}}),Object(h.a)(en.prototype,"currentChannelValue",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"currentChannelValue"),en.prototype),Object(h.a)(en.prototype,"requiredChannelValue",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"requiredChannelValue"),en.prototype),Object(h.a)(en.prototype,"plotData",[f.i],Object.getOwnPropertyDescriptor(en.prototype,"plotData"),en.prototype),Ji=en))||Ji;var ln,cn,dn,un,hn,pn,gn,fn,bn,mn,yn,On,jn,Sn=i(107),xn=i(109);i(885);!function(e){e.Name="Name",e.Unit="Unit",e.Type="Type",e.Display="Display",e.Description="Description"}(On||(On={})),function(e){e.Equal="==",e.NotEqual="!=",e.LessorOrEqual="<=",e.Lesser="<",e.GreaterOrEqual=">=",e.Greater=">",e.RangeClosed="...",e.RangeOpen=".."}(jn||(jn={}));let Cn=Object(g.a)((yn=mn=class e extends p.Component{get catalogFileId(){var e;return null===(e=O.k.Instance.catalogProfiles)||void 0===e?void 0:e.get(this.props.id)}static get WIDGET_CONFIG(){return{id:"catalog-overlay",type:"catalog-overlay",minWidth:720,minHeight:400,defaultWidth:720,defaultHeight:400,title:"Catalog",isCloseable:!0,helpType:O.x.CATALOG_OVERLAY,componentId:"catalog-overlay-component"}}get widgetStore(){const e=O.k.Instance.catalogWidgets.get(this.catalogFileId);return O.U.Instance.catalogWidgets.get(e)}get profileStore(){return O.k.Instance.catalogProfileStores.get(this.catalogFileId)}get catalogDataInfo(){const e=this.profileStore,t=this.widgetStore;let i,n=0;return e&&t&&(i=e.catalogData,n=e.numVisibleRows,e.regionSelected&&(t.showSelectedData?(i=e.selectedData,n=e.regionSelected,this.catalogTableRef&&this.scrollToRegion(this.catalogTableRef,jt.c.row(0))):this.catalogTableRef&&t.catalogTableAutoScroll&&this.scrollToRegion(this.catalogTableRef,e.autoScrollRowNumber))),{dataset:i,numVisibleRows:n}}get enablePlotButton(){const e=this.profileStore,t=this.widgetStore;return t.catalogPlotType===Qe.c.Histogram?t.xAxis!==O.i.NONE&&!e.loadingData&&!e.updatingDataStream:t.xAxis!==O.i.NONE&&t.yAxis!==O.i.NONE&&!e.loadingData&&!e.updatingDataStream}constructor(e){super(e),Object(u.a)(this,"catalogTableRef",dn,this),Object(u.a)(this,"height",un,this),Object(u.a)(this,"width",hn,this),this.catalogHeaderTableRef=void 0,this.catalogFileNames=void 0,Object(u.a)(this,"handleCatalogFileChange",pn,this),Object(u.a)(this,"handleFileCloseClick",gn,this),this.scrollToRegion=(e,t)=>{var i,n;const r=e.state,o=null===r||void 0===r?void 0:r.numFrozenColumnsClamped,s=null===r||void 0===r?void 0:r.numFrozenRowsClamped;let a=e.state.viewportRect;a||(a=e.locator.getViewportRect());const l=null===(i=a)||void 0===i?void 0:i.left,c=null===(n=a)||void 0===n?void 0:n.top,{scrollLeft:d,scrollTop:u}=Sn.a(t,l,c,e.grid.getCumulativeWidthBefore,e.grid.getCumulativeHeightBefore,s,o),h=e.shouldDisableHorizontalScroll()?0:d,p=e.shouldDisableVerticalScroll()?0:u;e.quadrantStackInstance.scrollToPosition(h,p)},Object(u.a)(this,"onCatalogDataTableRefUpdated",fn,this),this.onControlHeaderTableRef=e=>{this.catalogHeaderTableRef=e},Object(u.a)(this,"onResize",bn,this),this.renderAxisPopOver=(e,t)=>Object(S.jsx)(b.B,{text:e,onClick:t.handleClick},e),this.filterColumn=(e,t)=>new xn.a([t]).search(e).length>0,this.updateHeaderTableColumnSize=(e,t)=>{const i=this.widgetStore;i.headerTableColumnWidts&&(i.headerTableColumnWidts[e]=t)},this.resetSelectedPointIndices=()=>{const e=this.profileStore,t=this.widgetStore;e.setSelectedPointIndices([],!1),t.setCatalogTableAutoScroll(!1),t.setShowSelectedData(!1)},this.handleFilterRequest=()=>{const e=this.profileStore,t=this.widgetStore,i=O.e.Instance;if(e&&i){e.updateTableStatus(!1),e.resetFilterRequestControlParams(),this.resetSelectedPointIndices(),i.catalogStore.clearImageCoordsData(this.catalogFileId);let n=e.updateRequestDataSize;n.imageBounds.xColumnName=t.xAxis,n.imageBounds.yColumnName=t.yAxis,n.fileId=e.catalogInfo.fileId,n.filterConfigs=this.getUserFilters(),n.columnIndices=e.displayedColumnHeaders.map((e=>e.columnIndex)),i.sendCatalogFilter(n)}},this.updateSortRequest=(e,t)=>{const i=this.profileStore,n=O.e.Instance;if(i&&n){i.resetFilterRequestControlParams(),this.resetSelectedPointIndices(),n.catalogStore.clearImageCoordsData(this.catalogFileId);let r=i.updateRequestDataSize;r.sortColumn=e,r.sortingType=t,i.setSortingInfo(e,t),n.sendCatalogFilter(r)}},this.updateByInfiniteScroll=()=>{const e=this.profileStore,t=this.widgetStore.showSelectedData;if(!1===e.loadingData&&e.updateMode===O.m.TableUpdate&&e.shouldUpdateData&&!t){e.setUpdateMode(O.m.TableUpdate);const t=this.profileStore.updateRequestDataSize;t.columnIndices=e.displayedColumnHeaders.map((e=>e.columnIndex)),O.e.Instance.sendCatalogFilter(t),e.setLoadingDataStatus(!0)}},this.handleResetClick=()=>{const e=this.profileStore,t=O.e.Instance;e&&(e.resetCatalogFilterRequest(),this.resetSelectedPointIndices(),t.catalogStore.clearImageCoordsData(this.catalogFileId),t.sendCatalogFilter(e.catalogFilterRequest))},this.handlePlotClick=()=>{const e=this.profileStore,t=O.e.Instance,i=t.activeFrame,n=O.k.Instance,r=this.widgetStore;switch(r.catalogPlotType){case Qe.c.ImageOverlay:if(e.setUpdateMode(O.m.ViewUpdate),i){const t=e.get2DPlotData(r.xAxis,r.yAxis,e.catalogData),o=i.validWcs?i.wcsInfo:0,s=this.catalogFileId;n.clearImageCoordsData(s),n.updateCatalogData(s,t.wcsX,t.wcsY,o,t.xHeaderInfo.units,t.yHeaderInfo.units,e.catalogCoordinateSystem.system),e.setSelectedPointIndices(e.selectedPointIndices,!1),r.setCatalogTableAutoScroll(!1)}if(e.shouldUpdateData){e.setUpdatingDataStream(!0);let i=e.updateRequestDataSize;t.sendCatalogFilter(i)}break;case Qe.c.D2Scatter:const o={xColumnName:r.xAxis,yColumnName:r.yAxis,plotType:r.catalogPlotType},s=t.widgetsStore.createFloatingCatalogPlotWidget(o);n.setCatalogPlots(s.widgetComponentId,this.catalogFileId,s.widgetStoreId);break;case Qe.c.Histogram:const a={xColumnName:r.xAxis,plotType:r.catalogPlotType},l=t.widgetsStore.createFloatingCatalogPlotWidget(a);n.setCatalogPlots(l.widgetComponentId,this.catalogFileId,l.widgetStoreId)}},this.handlePlotTypeChange=e=>{this.widgetStore.setCatalogPlotType(e)},this.onCatalogTableDataSelected=e=>{const t=this.profileStore,i=this.widgetStore;if(!i.showSelectedData)if(1===e.length){const n=t.selectedPointIndices;let r=!1;1===n.length&&(r=n.includes(e[0])),r?(t.setSelectedPointIndices([],!1),i.setCatalogTableAutoScroll(!1)):(t.setSelectedPointIndices(e,!0),i.setCatalogTableAutoScroll(!1))}else t.setSelectedPointIndices(e,!0),i.setCatalogTableAutoScroll(!1)},this.renderFileIdPopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return Object(S.jsx)(b.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.renderPlotTypePopOver=(e,t)=>Object(S.jsx)(b.B,{text:e,onClick:t.handleClick,active:t.modifiers.active},e),this.onTableResize=e=>{const t=Math.floor(e/(this.height-130)*100);t<=Qe.f.MaxTableSeparatorPosition&&t>=Qe.f.MinTableSeparatorPosition&&(this.widgetStore.setTableSeparatorPosition(`${t}%`),O.H.Instance.setPreference(O.G.CATALOG_TABLE_SEPARATOR_POSITION,`${t}%`));const i=this.profileStore;i&&this.catalogHeaderTableRef&&this.updateTableSize(this.catalogHeaderTableRef,!1),i&&this.catalogTableRef&&this.updateTableSize(this.catalogTableRef,!1)},this.renderSystemPopOver=(e,t)=>{const i=Object(S.jsx)(b.B,{text:this.profileStore.CoordinateSystemName.get(e),onClick:t.handleClick,active:t.modifiers.active},e);switch(e){case O.l.Pixel0:return Object(S.jsx)("div",{children:Object(S.jsx)(b.W,{position:"auto-end",content:Object(S.jsx)("small",{children:"PIX0: 0-based image coordinates"}),children:i})},e);case O.l.Pixel1:return Object(S.jsx)("div",{children:Object(S.jsx)(b.W,{position:"auto-end",content:Object(S.jsx)("small",{children:"PIX1:  1-based image coordinates"}),children:i})},e);default:return i}},Object(f.p)(this),O.k.Instance.catalogProfiles.has(this.props.id)||O.k.Instance.catalogProfiles.set(this.props.id,1),this.catalogFileNames=new Map,Object(f.h)((()=>{const e=O.e.Instance.activeFrame,t=O.k.Instance.activeCatalogFiles,i=this.profileStore;if(i){let n="";const r=i.catalogInfo.fileInfo.name,o=i.progress;o&&isFinite(o)&&o<1&&(n=`[${Object(D.mb)(100*o)}% complete]`),e&&(null===t||void 0===t?void 0:t.length)?O.U.Instance.setWidgetComponentTitle(this.props.id,`Catalog : ${r} ${n}`):O.U.Instance.setWidgetComponentTitle(this.props.id,"Catalog")}else O.U.Instance.setWidgetComponentTitle(this.props.id,"Catalog")}))}updateTableSize(e,t){const i=e.locator.getViewportRect();e.updateViewportRect(i),t&&e.scrollToRegion(jt.c.column(0))}handleHeaderDisplayChange(e,t){const i=this.profileStore,n=this.widgetStore,r=e.target.checked,o=i.catalogControlHeader.get(t);i.setHeaderDisplay(r,t),(!0===r||""!==o.filter&&!1===r)&&this.handleFilterRequest(),n.xAxis===t&&n.setxAxis(O.i.NONE),n.yAxis===t&&n.setyAxis(O.i.NONE)}renderDataColumn(e,t){return Object(S.jsx)(St.a,{name:e,cellRenderer:(e,i)=>Object(S.jsx)(mt.a,{className:"header-table-cell",interactive:!0,children:t[e]},`cell_${i}_${e}`)},e)}renderSwitchButtonCell(e,t){const i=this.profileStore,n=i.catalogControlHeader.get(t).display;let r=i.loadingData;return Object(S.jsx)(mt.a,{className:"header-table-cell",children:Object(S.jsx)(p.Fragment,{children:Object(S.jsx)(b.P,{className:"cell-switch-button",disabled:r,checked:n,onChange:e=>this.handleHeaderDisplayChange(e,t)},`cell_switch_button_${e}`)})},`cell_switch_${e}`)}get axisOption(){const t=this.profileStore;let i=[];return t.catalogControlHeader.forEach(((n,r)=>{const o=t.catalogHeader[n.dataIndex].dataType;e.axisDataType.includes(o)&&n.display&&i.push(r)})),i}get xAxisLable(){switch(this.widgetStore.catalogPlotType){case Qe.c.ImageOverlay:return this.profileStore.activedSystem.x;default:return O.i.X}}get yAxisLable(){switch(this.widgetStore.catalogPlotType){case Qe.c.ImageOverlay:return this.profileStore.activedSystem.y;default:return O.i.Y}}renderButtonColumns(e,t){switch(e){case On.Display:return Object(S.jsx)(St.a,{name:e,cellRenderer:e=>this.renderSwitchButtonCell(e,t[e])},e);default:return Object(S.jsx)(St.a,{name:e},e)}}getDataType(e){switch(e){case ne.a.ColumnType.Bool:return"bool";case ne.a.ColumnType.Int8:case ne.a.ColumnType.Int16:case ne.a.ColumnType.Int32:case ne.a.ColumnType.Int64:return"int";case ne.a.ColumnType.Uint8:case ne.a.ColumnType.Uint16:case ne.a.ColumnType.Uint32:case ne.a.ColumnType.Uint64:return"unsigned int";case ne.a.ColumnType.Double:return"double";case ne.a.ColumnType.Float:return"float";case ne.a.ColumnType.String:return"string";default:return"unsupported"}}createHeaderTable(){const e=[],t=[],i=[],n=[],r=[],o=this.profileStore.catalogHeader,s=o.length;for(let h=0;h<o.length;h++){const e=o[h];t.push(e.name),i.push(e.description),n.push(e.units),r.push(this.getDataType(e.dataType))}const a=this.renderDataColumn(On.Name,t);e.push(a);const l=this.renderDataColumn(On.Unit,n);e.push(l);const c=this.renderDataColumn(On.Type,r);e.push(c);const d=this.renderButtonColumns(On.Display,t);e.push(d);const u=this.renderDataColumn(On.Description,i);return e.push(u),Object(S.jsx)(Ot.a,{ref:e=>this.onControlHeaderTableRef(e),numRows:s,enableRowReordering:!1,renderMode:ji.a.BATCH,selectionModes:jt.d.NONE,defaultRowHeight:30,minRowHeight:20,minColumnWidth:30,enableGhostCells:!0,numFrozenColumns:1,columnWidths:this.widgetStore.headerTableColumnWidts,onColumnWidthChanged:this.updateHeaderTableColumnSize,enableRowResizing:!1,children:e})}getUserFilters(){let t=[];return this.profileStore.catalogControlHeader.forEach(((i,n)=>{if(void 0!==i.filter&&i.display){let r=new ne.a.FilterConfig;const o=this.profileStore.catalogHeader[i.dataIndex].dataType;if(r.columnName=n,o===ne.a.ColumnType.String)r.subString=i.filter,t.push(r);else{const n=e.GetComparisonOperatorAndValue(i.filter);-1!==n.operator&&n.values.length>0&&(r.comparisonOperator=n.operator,n.values.length>1?(r.value=Math.min(n.values[0],n.values[1]),r.secondaryValue=Math.max(n.values[0],n.values[1])):r.value=n.values[0],t.push(r))}}})),t}static GetNumberFromFilter(e){return Number(e.replace(/[^0-9.+-.]+/g,""))}static GetComparisonOperatorAndValue(t){const i=t.replace(/\s/g,"");let n={operator:-1,values:[]};for(const r of Object.keys(jn)){const t=jn[r];if(i.includes(t)){if(t===jn.Equal){const t=e.GetNumberFromFilter(i);return n.operator=ne.a.ComparisonOperator.Equal,n.values.push(t),n}if(t===jn.NotEqual){const t=e.GetNumberFromFilter(i);return n.operator=ne.a.ComparisonOperator.NotEqual,n.values.push(t),n}if(t===jn.Lesser){const t=e.GetNumberFromFilter(i);return n.operator=ne.a.ComparisonOperator.Lesser,n.values.push(t),n}if(t===jn.LessorOrEqual){const t=e.GetNumberFromFilter(i);return n.values.push(t),n.operator=ne.a.ComparisonOperator.LessorOrEqual,n}if(t===jn.Greater){const t=e.GetNumberFromFilter(i);return n.operator=ne.a.ComparisonOperator.Greater,n.values.push(t),n}if(t===jn.GreaterOrEqual){const t=e.GetNumberFromFilter(i);return n.values.push(t),n.operator=ne.a.ComparisonOperator.GreaterOrEqual,n}if(t===jn.RangeOpen){const e=i.split(jn.RangeOpen,2);return n.values.push(Number(e[0])),n.values.push(Number(e[1])),n.operator=ne.a.ComparisonOperator.RangeOpen,n}if(t===jn.RangeClosed){const e=i.split(jn.RangeClosed,2);return n.values.push(Number(e[0])),n.values.push(Number(e[1])),n.operator=ne.a.ComparisonOperator.RangeClosed,n}}}return n}render(){const e=this.widgetStore,t=this.profileStore,i=O.k.Instance.activeCatalogFiles;if(!t||void 0===i||0===(null===i||void 0===i?void 0:i.length)||!e)return Object(S.jsxs)("div",{className:"catalog-overlay",children:[Object(S.jsx)(b.C,{icon:"folder-open",title:"No catalog file loaded",description:"Load a catalog file using the menu"}),";"]});const n=this.catalogDataInfo,r={type:j.x.ColumnFilter,dataset:n.dataset,filter:t.catalogControlHeader,columnHeaders:t.displayedColumnHeaders,numVisibleRows:n.numVisibleRows,columnWidths:t.tableColumnWidts,loadingCell:t.loadingData,selectedDataIndex:t.selectedPointIndices,showSelectedData:e.showSelectedData,updateTableRef:this.onCatalogDataTableRefUpdated,updateColumnFilter:t.setColumnFilter,updateByInfiniteScroll:this.updateByInfiniteScroll,updateTableColumnWidth:t.setTableColumnWidth,updateSelectedRow:this.onCatalogTableDataSelected,updateSortRequest:this.updateSortRequest,sortingInfo:t.sortingInfo,disable:t.loadOntoImage,darkTheme:O.e.Instance.darkTheme,tableHeaders:t.catalogHeader};let o=0;t.numVisibleRows&&(o=1);const s=t.catalogInfo.dataSize,a=t.maxRows,l=n.numVisibleRows;let c=`Showing ${o} to ${l} of total ${s} entries`;t.hasFilter&&isFinite(t.filterDataSize)&&(c=`Showing ${o} to ${l} of ${t.filterDataSize} filtered entries. Total ${s} entries`),a<s&&a>0&&(c=`Showing ${o} to ${l} of top ${a} entries. Total ${s} entries`),a<s&&a>0&&t.hasFilter&&isFinite(t.filterDataSize)&&(c=t.filterDataSize>=a?`Showing ${o} to ${l} of top ${a} entries. Total ${t.filterDataSize} filtered entries. Total ${s} entries`:`Showing ${o} to ${l} of ${t.filterDataSize} filtered entries. Total ${s} entries`);const d=s?Object(S.jsx)("tr",{children:Object(S.jsx)("td",{className:"td-label",children:Object(S.jsx)("pre",{children:c})})}):null;let u=[];i.forEach((e=>{u.push(e)})),this.catalogFileNames=O.k.Instance.getCatalogFileNames(i);let h=[];t.CoordinateSystemName.forEach(((e,t)=>{h.push(t)}));const p=t.CoordinateSystemName.get(t.catalogCoordinateSystem.system),g=e.catalogPlotType===Qe.c.ImageOverlay,f=e.catalogPlotType===Qe.c.Histogram,m=t.loadOntoImage;let x="footer-action-large";this.width<=600&&(x="footer-action-small");const C=Object(S.jsx)(b.B,{disabled:!0,text:"No results"});return Object(S.jsxs)("div",{className:"catalog-overlay",children:[Object(S.jsxs)("div",{className:"catalog-overlay-filter-settings",children:[Object(S.jsx)(b.p,{inline:!0,label:"File",children:Object(S.jsx)(M.a,{className:"bp3-fill",filterable:!1,items:u,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFileIdPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},children:Object(S.jsx)(b.e,{text:this.catalogFileId,rightIcon:"double-caret-vertical"})})}),Object(S.jsx)(b.p,{className:"catalog-system",disabled:!g,inline:!0,label:"System",children:Object(S.jsx)(M.a,{filterable:!1,items:h,activeItem:t.catalogCoordinateSystem.system,onItemSelect:e=>t.setCatalogCoordinateSystem(e),itemRenderer:this.renderSystemPopOver,disabled:!g,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},children:Object(S.jsx)(b.e,{text:p,disabled:!g,rightIcon:"double-caret-vertical"})})})]}),Object(S.jsxs)(Si.b,{className:"catalog-table",split:"horizontal",primary:"second",minSize:`${Qe.f.MinTableSeparatorPosition}%`,maxSize:`${Qe.f.MaxTableSeparatorPosition}%`,size:e.tableSeparatorPosition,onChange:this.onTableResize,children:[Object(S.jsx)(Si.a,{className:"catalog-overlay-column-header-container",children:this.createHeaderTable()}),Object(S.jsx)(Si.a,{className:"catalog-overlay-data-container",children:Object(S.jsx)(j.w,{...r})})]}),Object(S.jsxs)("div",{className:"bp3-dialog-footer",children:[Object(S.jsx)("div",{className:"table-info",children:Object(S.jsx)("table",{className:"info-display",children:Object(S.jsx)("tbody",{children:d})})}),Object(S.jsx)("div",{className:"footer-action-container",children:Object(S.jsxs)("div",{className:x,children:[Object(S.jsx)(M.a,{className:"catalog-type-button",filterable:!1,items:Object.values(Qe.c),activeItem:e.catalogPlotType,onItemSelect:this.handlePlotTypeChange,itemRenderer:this.renderPlotTypePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},children:Object(S.jsx)(b.e,{className:"bp3",text:e.catalogPlotType,rightIcon:"double-caret-vertical"})}),Object(S.jsx)(b.p,{className:"catalog-xaxis",inline:!0,label:this.xAxisLable,disabled:m,children:Object(S.jsx)(M.a,{className:"catalog-xaxis-select",items:this.axisOption,activeItem:null,onItemSelect:t=>e.setxAxis(t),itemRenderer:this.renderAxisPopOver,disabled:m,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},filterable:!0,noResults:C,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(S.jsx)(b.e,{className:"catalog-xaxis-button",text:e.xAxis,disabled:m,rightIcon:"double-caret-vertical"})})}),Object(S.jsx)(b.p,{className:"catalog-yaxis",inline:!0,label:this.yAxisLable,disabled:f||m,children:Object(S.jsx)(M.a,{className:"catalog-yaxis-select",items:this.axisOption,activeItem:null,onItemSelect:t=>e.setyAxis(t),itemRenderer:this.renderAxisPopOver,disabled:f||m,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},filterable:!0,noResults:C,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(S.jsx)(b.e,{className:"catalog-yaxis-button",text:e.yAxis,disabled:f||m,rightIcon:"double-caret-vertical"})})}),Object(S.jsx)(j.b,{className:"catalog-max-rows",label:"Max Rows",value:t.maxRows,onValueChanged:e=>t.setMaxRows(e),onValueCleared:()=>t.setMaxRows(t.catalogInfo.dataSize),displayExponential:!1,updateValueOnKeyDown:!0,disabled:m})]})}),Object(S.jsx)("div",{className:"footer-button-container",children:Object(S.jsxs)("div",{className:"footer-button",children:[Object(S.jsx)(b.W,{content:"Apply filter",children:Object(S.jsx)(b.b,{intent:yi.a.PRIMARY,text:"Update",onClick:this.handleFilterRequest,disabled:m||!t.updateTableView})}),Object(S.jsx)(b.W,{content:"Reset view",children:Object(S.jsx)(b.b,{intent:yi.a.PRIMARY,text:"Reset",onClick:this.handleResetClick,disabled:m})}),Object(S.jsx)(b.W,{content:"Close file",children:Object(S.jsx)(b.b,{intent:yi.a.PRIMARY,text:"Close",onClick:this.handleFileCloseClick,disabled:m})}),Object(S.jsx)(b.W,{content:"Plot data",children:Object(S.jsx)(b.b,{intent:yi.a.PRIMARY,text:"Plot",onClick:this.handlePlotClick,disabled:!this.enablePlotButton})})]})})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},mn.axisDataType=[ne.a.ColumnType.Double,ne.a.ColumnType.Float,ne.a.ColumnType.Int8,ne.a.ColumnType.Uint8,ne.a.ColumnType.Int16,ne.a.ColumnType.Uint16,ne.a.ColumnType.Int32,ne.a.ColumnType.Uint32,ne.a.ColumnType.Int64,ne.a.ColumnType.Uint64],cn=yn,Object(h.a)(cn.prototype,"catalogFileId",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"catalogFileId"),cn.prototype),dn=Object(h.a)(cn.prototype,"catalogTableRef",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){}}),un=Object(h.a)(cn.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),hn=Object(h.a)(cn.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(h.a)(cn.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"widgetStore"),cn.prototype),Object(h.a)(cn.prototype,"profileStore",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"profileStore"),cn.prototype),pn=Object(h.a)(cn.prototype,"handleCatalogFileChange",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{O.k.Instance.catalogProfiles.set(this.props.id,e)}}}),gn=Object(h.a)(cn.prototype,"handleFileCloseClick",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=O.e.Instance,t=O.k.Instance.catalogWidgets.get(this.catalogFileId);e.removeCatalog(this.catalogFileId,t,this.props.id)}}}),Object(h.a)(cn.prototype,"catalogDataInfo",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"catalogDataInfo"),cn.prototype),Object(h.a)(cn.prototype,"enablePlotButton",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"enablePlotButton"),cn.prototype),fn=Object(h.a)(cn.prototype,"onCatalogDataTableRefUpdated",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogTableRef=e}}}),bn=Object(h.a)(cn.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=this.profileStore,n=this.widgetStore;if(this.height=t,this.width=e,i&&this.catalogHeaderTableRef&&(this.updateTableSize(this.catalogHeaderTableRef,this.props.docked),1===i.progress||void 0===i.progress)){const e=i.catalogInfo.fileInfo.name;O.U.Instance.setWidgetComponentTitle(this.props.id,`Catalog : ${e}`)}i&&this.catalogTableRef&&n&&(this.updateTableSize(this.catalogTableRef,this.props.docked),i.regionSelected&&n.catalogTableAutoScroll&&!n.showSelectedData&&this.scrollToRegion(this.catalogTableRef,i.autoScrollRowNumber))}}}),Object(h.a)(cn.prototype,"axisOption",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"axisOption"),cn.prototype),Object(h.a)(cn.prototype,"xAxisLable",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"xAxisLable"),cn.prototype),Object(h.a)(cn.prototype,"yAxisLable",[f.i],Object.getOwnPropertyDescriptor(cn.prototype,"yAxisLable"),cn.prototype),ln=cn))||ln;var In,wn;i(886);let Tn;!function(e){e[e.CONVERSION=0]="CONVERSION",e[e.LINE_PLOT_STYLING=1]="LINE_PLOT_STYLING",e[e.SCATTER_PLOT_STYLING=2]="SCATTER_PLOT_STYLING",e[e.SMOOTHING=3]="SMOOTHING"}(Tn||(Tn={}));let vn=Object(g.a)((wn=class extends p.Component{static get WIDGET_CONFIG(){return{id:"stokes-floating-settings",type:"floating-settings",minWidth:350,minHeight:300,defaultWidth:550,defaultHeight:450,title:"stokes-settings",isCloseable:!0,parentId:"stokes",parentType:"stokes",helpType:[O.x.STOKES_ANALYSIS_SETTINGS_CONVERSION,O.x.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING,O.x.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING,O.x.STOKES_ANALYSIS_SETTINGS_SMOOTHING]}}get widgetStore(){const e=O.U.Instance;if(e.stokesAnalysisWidgets){const t=e.stokesAnalysisWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleEqualAxesValuesChanged=e=>{this.widgetStore.setEqualAxesValue(e.target.checked)},this.handleInvertedColorMapChanged=e=>{this.widgetStore.setInvertedColorMap(e.target.checked)},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=O.e.Instance;Object(f.h)((()=>{if(this.widgetStore){if(this.widgetStore.effectiveFrame){const e=this.widgetStore.effectiveRegionId,i=0===e?"Cursor":`Region #${e}`,n=this.widgetStore.matchesSelectedRegion?"(Active)":"";t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Stokes Analysis Settings: ${i} ${n}`)}}}))}render(){const e=O.e.Instance,t=this.widgetStore,i={darkMode:e.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:t.primaryLineColor,lineWidth:t.lineWidth,plotType:t.plotType,linePlotPointSize:t.linePlotPointSize,setPrimaryLineColor:t.setPrimaryLineColor,setLineWidth:t.setLineWidth,setLinePlotPointSize:t.setLinePlotPointSize,setPlotType:t.setPlotType,secondaryDarkModeLineColor:ae.a.ORANGE4,secondaryLineColor:t.secondaryLineColor,setSecondaryLineColor:t.setSecondaryLineColor},n={colorMap:t.colorMap,scatterPlotPointSize:t.scatterPlotPointSize,pointTransparency:t.pointTransparency,equalAxes:t.equalAxes,setPointTransparency:t.setPointTransparency,setScatterPlotPointSize:t.setScatterPlotPointSize,setColormap:t.setColormap,handleEqualAxesValuesChanged:this.handleEqualAxesValuesChanged,invertedColorMap:t.invertedColorMap,handleInvertedColorMapChanged:this.handleInvertedColorMapChanged},r=t.effectiveFrame&&t.effectiveFrame.hasStokes;return Object(S.jsx)("div",{className:"stokes-settings",children:Object(S.jsxs)(b.R,{id:"spectralSettingTabs",selectedTabId:t.settingsTabId,onChange:this.handleSelectedTabChanged,children:[Object(S.jsx)(b.Q,{id:Tn.CONVERSION,title:"Conversion",panel:Object(S.jsx)(j.u,{widgetStore:t,disable:!r})}),Object(S.jsx)(b.Q,{id:Tn.LINE_PLOT_STYLING,title:"Line Plot Styling",panel:Object(S.jsx)(j.h,{...i})}),Object(S.jsx)(b.Q,{id:Tn.SCATTER_PLOT_STYLING,title:"Scatter Plot Styling",panel:Object(S.jsx)(j.q,{...n})}),Object(S.jsx)(b.Q,{id:Tn.SMOOTHING,title:"Smoothing",panel:Object(S.jsx)(j.s,{smoothingStore:t.smoothingStore,diableStyle:!0,diableDecimation:!0})})]})})}},Object(h.a)(wn.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(wn.prototype,"widgetStore"),wn.prototype),In=wn))||In;var An,Rn=i(906);i(887);const Pn=Rn.a.ofType();let En=Object(g.a)(An=class extends p.Component{constructor(...e){super(...e),this.onChannelFromChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedChannelRange(e,t.channelValueRange[1])},this.onChannelToChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedChannelRange(t.channelValueRange[0],e)},this.handleChannelSelectionClicked=()=>{const e=this.props.widgetStore;e.setMomentRangeSelectingMode(e.isSelectingMomentChannelRange?Qe.i.NONE:Qe.i.CHANNEL)},this.onMaskFromChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedMaskRange(e,t.maskRange[1])},this.onMaskToChanged=e=>{const t=this.props.widgetStore;t.effectiveFrame&&isFinite(e)&&t.setSelectedMaskRange(t.maskRange[0],e)},this.handleMaskSelectionClicked=()=>{const e=this.props.widgetStore;e.setMomentRangeSelectingMode(e.isSelectingMomentMaskRange?Qe.i.NONE:Qe.i.MASK)},this.filterMoment=(e,t,i,n)=>{const r=Q.MOMENT_TEXT.get(t),o=r.tag.toLowerCase(),s=e.toLowerCase();return n?o===s:r.tag.indexOf(s)>=0},this.renderMomentTag=e=>{const t=Q.MOMENT_TEXT.get(e);return t?t.tag:void 0},this.renderMomentSelectItem=(e,{modifiers:t,handleClick:i})=>{const n=Q.MOMENT_TEXT.get(e);return n?Object(S.jsx)(b.B,{text:`${n.tag}: ${n.text}`,onClick:i,icon:this.props.widgetStore.isMomentSelected(e)?"tick":"blank"},e):void 0},this.handleMomentTagRemove=(e,t)=>{this.props.widgetStore.removeMomentByIndex(t)},this.handleMomentsClear=()=>{this.props.widgetStore.clearSelectedMoments()},this.handleRequestMoment=()=>{this.props.widgetStore.requestMoment()},this.handleRequestingMomentCancelled=()=>{this.props.widgetStore.requestingMomentCancelled()}}render(){var e;const t=O.e.Instance,i=this.props.widgetStore,n=i.effectiveFrame,r=Object(S.jsx)(Jn,{widgetStore:this.props.widgetStore,nonClosedDisabled:!0}),o=Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(j.u,{widgetStore:this.props.widgetStore,disable:!1}),n&&n.numChannels>1&&Object(S.jsx)(b.p,{label:"Range",inline:!0,labelInfo:(null===n||void 0===n?void 0:n.spectralUnit)?`(${n.spectralUnit})`:"",children:Object(S.jsxs)("div",{className:"range-select",children:[Object(S.jsx)(b.p,{label:"From",inline:!0,children:Object(S.jsx)(j.n,{value:i.channelValueRange[0],buttonPosition:"none",onValueChange:e=>this.onChannelFromChanged(e)})}),Object(S.jsx)(b.p,{label:"To",inline:!0,children:Object(S.jsx)(j.n,{value:i.channelValueRange[1],buttonPosition:"none",onValueChange:e=>this.onChannelToChanged(e)})}),Object(S.jsx)("div",{className:"cursor-select",children:Object(S.jsx)(b.W,{content:"Use cursor to select channel range in profiler",position:m.a.BOTTOM,children:Object(S.jsx)(b.b,{className:i.isSelectingMomentChannelRange?"bp3-active":"",icon:"select",onClick:this.handleChannelSelectionClicked})})})]})})]}),s=Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.p,{label:"Mask",inline:!0,disabled:!n,children:Object(S.jsx)(b.r,{value:i.momentMask,options:Object.keys(ne.a.MomentMask).map((e=>({label:e,value:ne.a.MomentMask[e]}))),onChange:e=>i.setMomentMask(parseInt(e.currentTarget.value)),disabled:!n})}),n&&n.numChannels>1&&Object(S.jsx)(b.p,{label:"Range",inline:!0,labelInfo:`(${n.unit})`,children:Object(S.jsxs)("div",{className:"range-select",children:[Object(S.jsx)(b.p,{label:"From",inline:!0,children:Object(S.jsx)(j.n,{value:i.maskRange[0],buttonPosition:"none",onValueChange:e=>this.onMaskFromChanged(e)})}),Object(S.jsx)(b.p,{label:"To",inline:!0,children:Object(S.jsx)(j.n,{value:i.maskRange[1],buttonPosition:"none",onValueChange:e=>this.onMaskToChanged(e)})}),Object(S.jsx)("div",{className:"cursor-select",children:Object(S.jsx)(b.W,{content:"Use cursor to select mask range in profiler",position:m.a.BOTTOM,children:Object(S.jsx)(b.b,{className:i.isSelectingMomentMaskRange?"bp3-active":"",icon:"select",onClick:this.handleMaskSelectionClicked})})})]})})]}),a=(null===n||void 0===n||null===(e=n.regionSet)||void 0===e?void 0:e.regions)?n.regionSet.regions.find((e=>e.regionId===i.effectiveRegionId)):null,l=a&&a.isClosedRegion,c=i.regionIdMap.get(i.fileId)!==Qe.k.CURSOR&&0===i.effectiveRegionId,d=n&&n.numChannels>1&&!t.animatorStore.animationActive&&!t.widgetsStore.isSpectralWidgetStreamingData&&(l||c),u=Object(S.jsxs)("span",{children:[Object(S.jsx)("br",{}),Object(S.jsx)("i",{children:Object(S.jsxs)("small",{children:["Please ensure",Object(S.jsx)("br",{}),"1. Animation playback is stopped.",Object(S.jsx)("br",{}),"2. Spectral profile generation is complete.",Object(S.jsx)("br",{}),"3. Cursor or point region is not selected."]})})]}),h=Object(S.jsxs)("span",{children:["Unable to generate moment images",u]}),g=Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.p,{label:"Moments",inline:!0,children:Object(S.jsx)(Pn,{placeholder:"Select...",items:Object.values(ne.a.Moment),itemPredicate:this.filterMoment,itemRenderer:this.renderMomentSelectItem,onItemSelect:e=>i.isMomentSelected(e)?i.deselectMoment(e):i.selectMoment(e),selectedItems:i.selectedMoments,resetOnSelect:!0,fill:!0,popoverProps:{minimal:!0,position:"bottom"},tagRenderer:this.renderMomentTag,tagInputProps:{onRemove:this.handleMomentTagRemove,tagProps:{minimal:!0},rightElement:Object(S.jsx)(b.e,{icon:"cross",minimal:!0,onClick:this.handleMomentsClear})}})}),Object(S.jsx)("div",{className:"moment-generate",children:Object(S.jsx)(b.W,{disabled:d,content:h,position:m.a.BOTTOM,children:Object(S.jsx)(b.b,{intent:"success",onClick:this.handleRequestMoment,disabled:!d,children:"Generate"})})})]});return Object(S.jsxs)("div",{className:"moment-generator",children:[Object(S.jsxs)("div",{className:"moment-panel",children:[r,Object(S.jsx)(b.m,{}),o,Object(S.jsx)(b.m,{}),s,Object(S.jsx)(b.m,{}),g]}),Object(S.jsx)(Vt.k,{isOpen:n&&n.isRequestingMoments&&n.requestingMomentsProgress<1,progress:n?n.requestingMomentsProgress:0,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleRequestingMomentCancelled,text:"Generating moments"})]})}})||An;var Fn,Mn;i(888);let kn;!function(e){e[e.CONVERSION=0]="CONVERSION",e[e.STYLING=1]="STYLING",e[e.SMOOTHING=2]="SMOOTHING",e[e.MOMENTS=3]="MOMENTS"}(kn||(kn={}));let Dn=Object(g.a)((Mn=class extends p.Component{static get WIDGET_CONFIG(){return{id:"spectral-profiler-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:480,defaultHeight:575,title:"spectral-profiler-settings",isCloseable:!0,parentId:"spectal-profiler",parentType:"spectral-profiler",helpType:[O.x.SPECTRAL_PROFILER_SETTINGS_CONVERSION,O.x.SPECTRAL_PROFILER_SETTINGS_STYLING,O.x.SPECTRAL_PROFILER_SETTINGS_SMOOTHING,O.x.SPECTRAL_PROFILER_SETTINGS_MOMENTS]}}get widgetStore(){const e=O.U.Instance;if(e.spectralProfileWidgets){const t=e.spectralProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=O.e.Instance;Object(f.h)((()=>{if(this.widgetStore){const e=this.widgetStore.effectiveFrame,i=this.widgetStore.coordinate;if(e&&i){let e;e=2===i.length?`Z Profile (Stokes ${i[0]})`:"Z Profile";const n=this.widgetStore.effectiveRegionId,r=0===n?"Cursor":`Region #${n}`,o=this.widgetStore.matchesSelectedRegion?"(Active)":"";t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`${e} Settings: ${r} ${o}`)}}}))}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,xMinVal:Object(D.Y)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(D.Y)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(D.Y)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(D.Y)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(S.jsx)("div",{className:"spectral-settings",children:Object(S.jsxs)(b.R,{id:"spectralSettingTabs",selectedTabId:e.settingsTabId,onChange:this.handleSelectedTabChanged,children:[Object(S.jsx)(b.Q,{id:kn.CONVERSION,panelClassName:"conversion-tab-panel",title:"Conversion",panel:Object(S.jsx)(j.u,{widgetStore:e,disable:!1})}),Object(S.jsx)(b.Q,{id:kn.STYLING,panelClassName:"styling-tab-panel",title:"Styling",panel:Object(S.jsx)(j.h,{...t})}),Object(S.jsx)(b.Q,{id:kn.SMOOTHING,title:"Smoothing",panel:Object(S.jsx)(j.s,{smoothingStore:e.smoothingStore})}),Object(S.jsx)(b.Q,{id:kn.MOMENTS,panelClassName:"moment-tab-panel",title:"Moments",panel:Object(S.jsx)(En,{widgetStore:e})})]})})}},Object(h.a)(Mn.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Mn.prototype,"widgetStore"),Mn.prototype),Fn=Mn))||Fn;var Nn,Ln;i(889);let _n;!function(e){e[e.STYLING=0]="STYLING",e[e.SMOOTHING=1]="SMOOTHING"}(_n||(_n={}));let zn=Object(g.a)((Ln=class extends p.Component{static get WIDGET_CONFIG(){return{id:"spatial-profiler-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:400,defaultHeight:450,title:"spatial-profiler-settings",isCloseable:!0,parentId:"spatial-profiler",parentType:"spatial-profiler",helpType:[O.x.SPATIAL_PROFILER_SETTINGS_STYLING,O.x.SPATIAL_PROFILER_SETTINGS_SMOOTHING]}}get widgetStore(){const e=O.U.Instance;if(e.spatialProfileWidgets){const t=e.spatialProfileWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleWcsAxisChanged=e=>{this.widgetStore.setWcsAxisVisible(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleCoordinateChanged=e=>{this.widgetStore.setCoordinate(e.target.value)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))};const t=O.e.Instance;Object(f.h)((()=>{if(this.widgetStore){const e=this.widgetStore.coordinate;if(t&&e){const i=`${e.toUpperCase()} Profile`,n=0===this.widgetStore.regionId?"Cursor":`Region #${this.widgetStore.regionId}`;t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`${i} Settings: ${n}`)}}else t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"X Profile Settings: Cursor")}))}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,showWCSAxis:e.wcsAxisVisible,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,handleWcsAxisChanged:this.handleWcsAxisChanged,setPlotType:e.setPlotType,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,userSelectedCoordinate:e.coordinate,handleCoordinateChanged:this.handleCoordinateChanged,profileCoordinateOptions:[{value:"x",label:"X"},{value:"y",label:"Y"}],xMinVal:Object(D.Y)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(D.Y)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(D.Y)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(D.Y)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(S.jsx)("div",{className:"spatial-profiler-settings",children:Object(S.jsxs)(b.R,{id:"spatialSettingTabs",selectedTabId:e.settingsTabId,onChange:this.handleSelectedTabChanged,children:[Object(S.jsx)(b.Q,{id:_n.STYLING,title:"Styling",panel:Object(S.jsx)(j.h,{...t})}),Object(S.jsx)(b.Q,{id:_n.SMOOTHING,title:"Smoothing",panel:Object(S.jsx)(j.s,{smoothingStore:e.smoothingStore})})]})})}},Object(h.a)(Ln.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Ln.prototype,"widgetStore"),Ln.prototype),Nn=Ln))||Nn;var Wn,Gn;let Vn=Object(g.a)((Gn=class extends p.Component{constructor(...e){super(...e),this.handleLogScaleChanged=e=>{this.widgetStore.setLogScale(e.target.checked)},this.handleMarkerTextChanged=e=>{this.widgetStore.setMarkerTextVisible(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()}}static get WIDGET_CONFIG(){return{id:"render-config-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:300,defaultHeight:375,title:"render-config-settings",isCloseable:!0,parentId:"render-config",parentType:"render-config",helpType:O.x.RENDER_CONFIG_SETTINGS}}get widgetStore(){const e=O.U.Instance;if(e.renderConfigWidgets){const t=e.renderConfigWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,logScaleY:e.logScaleY,handleLogScaleChanged:this.handleLogScaleChanged,markerTextVisible:e.markerTextVisible,handleMarkerTextChanged:this.handleMarkerTextChanged,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,xMinVal:Object(D.Y)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(D.Y)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(D.Y)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(D.Y)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(S.jsx)(j.h,{...t})}},Object(h.a)(Gn.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Gn.prototype,"widgetStore"),Gn.prototype),Wn=Gn))||Wn;var Bn,Hn;let qn=Object(g.a)((Hn=class extends p.Component{static get WIDGET_CONFIG(){return{id:"histogram-floating-settings",type:"floating-settings",minWidth:280,minHeight:225,defaultWidth:300,defaultHeight:320,title:"histogram-settings",isCloseable:!0,parentId:"histogram",parentType:"histogram",helpType:O.x.HISTOGRAM_SETTINGS}}get widgetStore(){const e=O.U.Instance;if(e.histogramWidgets){const t=e.histogramWidgets.get(this.props.id);if(t)return t}return console.log("can't find store for widget"),null}constructor(e){super(e),this.handleLogScaleChanged=e=>{this.widgetStore.setLogScale(e.target.checked)},this.handleMeanRmsChanged=e=>{this.widgetStore.setMeanRmsVisible(e.target.checked)},this.handleXMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==n&&t<r?i.setXBounds(t,r):e.currentTarget.value=n.toString()},this.handleXMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minX,i.linePlotInitXYBoundaries.minXVal),r=Object(D.Y)(i.maxX,i.linePlotInitXYBoundaries.maxXVal);isFinite(t)&&t!==r&&t>n?i.setXBounds(n,t):e.currentTarget.value=r.toString()},this.handleYMinChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==n&&t<r?i.setYBounds(t,r):e.currentTarget.value=n.toString()},this.handleYMaxChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;const t=parseFloat(e.currentTarget.value),i=this.widgetStore,n=Object(D.Y)(i.minY,i.linePlotInitXYBoundaries.minYVal),r=Object(D.Y)(i.maxY,i.linePlotInitXYBoundaries.maxYVal);isFinite(t)&&t!==r&&t>n?i.setYBounds(n,t):e.currentTarget.value=r.toString()},Object(f.h)((()=>{const e=O.e.Instance;if(this.widgetStore&&this.widgetStore.effectiveFrame){let t="Unknown";const i=this.widgetStore.effectiveRegionId;if(-1===i)t="Image";else if(this.widgetStore.effectiveFrame.regionSet){const e=this.widgetStore.effectiveFrame.regionSet.regions.find((e=>e.regionId===i));e&&(t=e.nameString)}const n=this.widgetStore.matchesSelectedRegion?"(Active)":"";e.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Histogram Settings: ${t} ${n}`)}else e.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Histogram Settings")}))}render(){const e=this.widgetStore,t={darkMode:O.e.Instance.darkTheme,primaryDarkModeLineColor:ae.a.BLUE4,primaryLineColor:e.primaryLineColor,lineWidth:e.lineWidth,plotType:e.plotType,linePlotPointSize:e.linePlotPointSize,setPrimaryLineColor:e.setPrimaryLineColor,setLineWidth:e.setLineWidth,setLinePlotPointSize:e.setLinePlotPointSize,setPlotType:e.setPlotType,isAutoScaledX:e.isAutoScaledX,isAutoScaledY:e.isAutoScaledY,clearXYBounds:e.clearXYBounds,logScaleY:e.logScaleY,handleLogScaleChanged:this.handleLogScaleChanged,meanRmsVisible:e.meanRmsVisible,handleMeanRmsChanged:this.handleMeanRmsChanged,xMinVal:Object(D.Y)(e.minX,e.linePlotInitXYBoundaries.minXVal),handleXMinChange:this.handleXMinChange,xMaxVal:Object(D.Y)(e.maxX,e.linePlotInitXYBoundaries.maxXVal),handleXMaxChange:this.handleXMaxChange,yMinVal:Object(D.Y)(e.minY,e.linePlotInitXYBoundaries.minYVal),handleYMinChange:this.handleYMinChange,yMaxVal:Object(D.Y)(e.maxY,e.linePlotInitXYBoundaries.maxYVal),handleYMaxChange:this.handleYMaxChange};return Object(S.jsx)(j.h,{...t})}},Object(h.a)(Hn.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Hn.prototype,"widgetStore"),Hn.prototype),Bn=Hn))||Bn;var Yn,Un=i(188);i(890);let Xn=Object(g.a)(Yn=class extends p.Component{render(){const e=O.e.Instance;let t="splash-screen";return e.darkTheme&&(t+=" bp3-dark"),Object(S.jsx)(b.E,{className:Oi.a.OVERLAY_SCROLL_CONTAINER,autoFocus:!0,canEscapeKeyClose:!1,canOutsideClickClose:!1,isOpen:e.splashScreenVisible,usePortal:!0,children:Object(S.jsxs)("div",{className:t,children:[Object(S.jsx)("div",{className:"image-div",children:Object(S.jsx)("img",{src:Un.a,width:150})}),Object(S.jsxs)("div",{className:"appInfo-div",children:[Object(S.jsxs)("h1",{children:[Q.CARTA_INFO.acronym," ",Q.CARTA_INFO.version," (",Q.CARTA_INFO.date,")"]}),Object(S.jsx)("p",{children:Q.CARTA_INFO.fullName})]}),Object(S.jsx)(b.O,{intent:yi.a.PRIMARY,size:30,value:null}),Object(S.jsx)("div",{className:"loadingInfo-div",children:Object(S.jsx)("p",{children:e.logStore.newestMsg})})]})})}})||Yn;var $n,Kn=i(66);let Qn=Object(g.a)($n=class extends p.Component{render(){return Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(Rt,{}),Object(S.jsx)(Vt.i,{}),Object(S.jsx)(Vt.b,{}),Object(S.jsx)(Vt.g,{}),Object(S.jsx)(Vt.f,{}),Object(S.jsx)(Vt.h,{}),Object(S.jsx)(Vt.j,{}),Object(S.jsx)(Vt.c,{}),Object(S.jsx)(Vt.a,{}),Object(S.jsx)(Vt.e,{}),Object(S.jsx)(qo,{}),Object(S.jsx)(Xn,{})]})}})||$n;var Zn;i(891);let Jn=Object(g.a)(Zn=class extends p.Component{constructor(...e){super(...e),this.handleFrameChanged=e=>{const t=O.e.Instance,i=this.props.widgetStore;if(t.activeFrame){const t=parseInt(e.target.value);i.setFileId(t),i.setRegionId(i.effectiveFrame.frameInfo.fileId,Qe.k.ACTIVE),this.props.onFrameChanged&&this.props.onFrameChanged(i.effectiveFrame)}},this.handleRegionChanged=e=>{const t=O.e.Instance,i=this.props.widgetStore;if(t.activeFrame){const t=i.effectiveFrame.frameInfo.fileId;i.setFileId(t),i.setRegionId(t,parseInt(e.target.value))}}}render(){const e=O.e.Instance,t=this.props.widgetStore;let i=!1,n=Qe.a,r=[{value:Qe.a,label:"Active"}];e.activeFrame&&(r=r.concat(e.frameNames),n=t.fileId,i=!0);let o=!1,s=Qe.k.ACTIVE,a=[{value:Qe.k.ACTIVE,label:"Active"}];if(t.effectiveFrame&&t.effectiveFrame.regionSet){let e;t.type===Qe.m.CLOSED&&(a=a.concat([{value:Qe.k.IMAGE,label:"Image"}]));let i=t.effectiveFrame.regionSet.regions;switch(t.type){case Qe.m.CLOSED:e=i.filter((e=>!e.isTemporary&&e.isClosedRegion));break;case Qe.m.CLOSED_AND_POINT:e=i.filter((e=>!e.isTemporary&&(e.isClosedRegion||e.regionType===ne.a.RegionType.POINT)));break;default:e=i}a=a.concat(e.map((e=>({value:e.regionId,label:e.nameString,disabled:!!this.props.nonClosedDisabled&&!e.isClosedRegion})))),t.type===Qe.m.CLOSED_AND_POINT&&1===a.length&&(a=a.concat([{value:Qe.k.CURSOR,label:"Cursor"}])),s=t.regionIdMap.get(t.effectiveFrame.frameInfo.fileId),o=!0}let l="unlinked-to-selected",c="unlinked-to-selected";const d="linked-to-selected";return t.matchActiveFrame&&t.fileId!==Qe.a&&(l=O.e.Instance.darkTheme?`${d} dark-theme`:d),t.matchesSelectedRegion&&void 0!==s&&s!==Qe.k.ACTIVE&&(c=O.e.Instance.darkTheme?`${d} dark-theme`:d),Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)(b.p,{label:"Image",inline:!0,disabled:!i,children:Object(S.jsx)(b.r,{className:l,value:n,options:r,onChange:this.handleFrameChanged,disabled:!i,style:{width:"100px"}})}),Object(S.jsx)(b.p,{label:"Region",inline:!0,disabled:!o,children:Object(S.jsx)(b.r,{className:c,value:s,options:a,onChange:this.handleRegionChanged,disabled:!o})})]})}})||Zn;class er extends p.Component{render(){const e=O.e.Instance;return Object(S.jsx)("img",{src:e.darkTheme?this.props.dark:this.props.light,style:{width:this.props.width,height:"auto"}})}}var tr=i.p+"static/media/head_contour_button.57f566f7.png",ir=i.p+"static/media/head_contour_button_d.19bb31ae.png";class nr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:tr,dark:ir,width:"90%"})}),Object(S.jsx)("p",{children:'Contour configuration dialogue allows users to generate a contour layer on top of a raster image in the image viewer. Steps to create a contour layer with the "Levels" tab are:'}),Object(S.jsxs)("ol",{children:[Object(S.jsx)("li",{children:Object(S.jsx)("p",{children:'Select an image from the "Data source" dropdown. A per-channel histogram of the current channel and current Stokes as indicated in the animator will be displayed with visualization of mean (in dashed line) and mean +/- one standard deviation (in shaded area). Optionally, users can request per-cube histogram if necessary.'})}),Object(S.jsxs)("li",{children:[Object(S.jsx)("p",{children:"Define a set of contour levels to be calculated and rendered. There are various ways to define levels:"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"Click"})," on the histogram plot to create a level. \xa0",Object(S.jsx)("code",{children:"Right-Click"}),' on a line to remove a level. Numerical values of levels are displayed in the "Levels" field.']}),Object(S.jsx)("li",{children:'Use the level generator. There are four preset generators. The generator will create a set of levels based on the control parameters by clicking the "Generate" button.'}),Object(S.jsx)("li",{children:'Manually input levels in the "Levels" field. Note that this field can be modified at any time, for example, after using the level generator.'})]})]}),Object(S.jsx)("li",{children:Object(S.jsx)("p",{children:'When a set of levels is defined, clicking the "Apply" button will trigger the contour calculations and render in the image viewer.'})})]}),Object(S.jsx)("p",{children:'To remove a contour layer, click the "Clear" button.'}),Object(S.jsx)("p",{children:"Users may use the lock button next to the data source dropdown to disable or enable synchronization of data source with the image slider in the animator."}),Object(S.jsx)("h3",{id:"contour-smoothness",children:"Contour smoothness"}),Object(S.jsx)("p",{children:'By default, image is Gaussian-smoothed with a kernel size of four pixels before calculating contour vertices. This can be customized in the "Configuration" tab. Smoothing mode includes:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"No smoothing"}),Object(S.jsx)("li",{children:"Block (faster, not ideal for compact objects)"}),Object(S.jsx)("li",{children:"Gaussian (default, slower, better appearance)"})]}),Object(S.jsx)("h3",{id:"contour-cosmetics",children:"Contour styling"}),Object(S.jsx)("p",{children:'The styling of contours can be customized with the "Styling" tab. Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Line thickness"}),Object(S.jsx)("li",{children:"Representation of dashed line"}),Object(S.jsx)("li",{children:"Color as constant color or color-mapped"}),Object(S.jsx)("li",{children:"Bias"}),Object(S.jsx)("li",{children:"Contrast"})]}),Object(S.jsx)("p",{children:"Note that changes in styling will be applied immediately if the contour levels set does not change."}),Object(S.jsx)("h3",{id:"customizing-the-contour-configuration-dialogue",children:"Customizing the contour configuration dialogue"}),Object(S.jsx)("p",{children:'The defaults of many options in the contour configuration dialogue are customizable via the "Contour configuration" tab in the preference dialogue.'}),Object(S.jsxs)("p",{children:['Performance related options are included in the "Performance" tab of the preference dialogue. ',Object(S.jsx)("em",{children:"Note that we do not recommend to modify the factory defaults. Change with cautions."})]})]})}}class rr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"File browser allows users to"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Load images in CASA, FITS, MIRIAD, or HDF5-IDIA schema formats as raster"}),Object(S.jsx)("li",{children:"Save images in CASA or FITS formats"}),Object(S.jsx)("li",{children:"Import and export region text files in CASA (.crtf) or ds9 (.reg) formats"}),Object(S.jsx)("li",{children:"Import catalogue files in VOTable or FITS formats"})]}),Object(S.jsx)("h3",{id:"fileFiltering",children:"File filtering"}),Object(S.jsx)("p",{children:"A file filter can be applied to the current directory. Three methods are provided:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Fuzzy search: free typing"}),Object(S.jsx)("li",{children:"Unix-style search: e.g., *.fits"}),Object(S.jsx)("li",{children:"Regular expression search: e.g., colou?r"})]}),Object(S.jsx)("h3",{id:"images",children:"Images"}),Object(S.jsxs)("p",{children:["Images can be loaded as raster via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Load image"}),", or appended as raster via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Append image"}),". All loaded images will be closed if users load an image with ",Object(S.jsx)("strong",{children:"Load image"}),". Image shown in the image viewer can be closed via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Close image"}),". Images can be saved in CASA or FITS format via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Save image"}),". Note that when saving an image, the server side needs to provide write permission (not a problem for the Desktop release)."]}),Object(S.jsx)("p",{children:'When an image file is selected, its basic image properties are summarized in the "File Information" tab on the right-hand side. Full image header is shown in the "Header" tab.'}),Object(S.jsx)("h3",{id:"regions",children:"Regions"}),Object(S.jsxs)("p",{children:["Region files can be imported via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Import regions"}),'. When a region file is selected, its content is shown in the "Region Information" tab. Regions can be exported as region text files via ',Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Export regions"}),". CASA and ds9 region text file definitions in world or image coordinates are supported. Note that when exporting a region text file, the server side needs to provide write permission (not a problem for the Desktop release)."]}),Object(S.jsx)("h3",{id:"catalogs",children:"Catalogs"}),Object(S.jsxs)("p",{children:["Catalogs can be loaded and visualized as tables via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Import catalog"}),'. When a catalog file is selected, its basic catalog properties are summarized in the "Catalog Information" tab on the right-hand side. Full catalog column header is shown in the "Catalog Header" tab.']})]})}}var or=i.p+"static/media/head_fileinfo_button.2ba534d4.png",sr=i.p+"static/media/head_fileinfo_button_d.ed7099e2.png";class ar extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:or,dark:sr,width:"90%"})}),Object(S.jsx)("p",{children:"File header dialogue provides full image header and a summary of the properties of the image in the current image view. To switch to other images, use the image slider in the animator widget, or use the image list widget."})]})}}class lr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"With this dialogue, the current layout can be saved and re-used in the future. The widgets in a layout can be either docked or undocked."}),Object(S.jsx)("h3",{id:"layout-management",children:"Layout management"}),Object(S.jsxs)("p",{children:["Load a preset layout or a custom layout: ",Object(S.jsx)("strong",{children:"View"})," -> ",Object(S.jsx)("strong",{children:"Layouts"})," -> ",Object(S.jsx)("strong",{children:"Existing layouts"})]}),Object(S.jsxs)("p",{children:["Set a layout as the default layout: ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Preferences"})," -> ",Object(S.jsx)("strong",{children:"Global"})," tab -> ",Object(S.jsx)("strong",{children:"Initial layout"}),"."]}),Object(S.jsxs)("p",{children:["Delete a custom layout: ",Object(S.jsx)("strong",{children:"View"})," -> ",Object(S.jsx)("strong",{children:"Layouts"})," -> ",Object(S.jsx)("strong",{children:"Delete layout"}),"."]})]})}}var cr=i.p+"static/media/head_preference_button.46e61f44.png",dr=i.p+"static/media/head_preference_button_d.9c3f5485.png";class ur extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:cr,dark:dr,width:"90%"})}),Object(S.jsx)("p",{children:"The preferences dialogue provides a centralized place to customize the entire graphical user interface and performance control parameters. All settings are recorded and applied to new CARTA sessions. Some settings are effective immediately."}),Object(S.jsx)("h3",{id:"global",children:"Global"}),Object(S.jsx)("p",{children:"This section provides usability customization."}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Theme: the color theme of the graphical user interface (effective immediately)"}),Object(S.jsx)("li",{children:"Auto-launch file browser: launch file browser when CARTA is initialized"}),Object(S.jsx)("li",{children:"Initial layout: the default layout for a new CARTA session"}),Object(S.jsx)("li",{children:"Initial cursor position: fix cursor at the image center or have cursor free to move"}),Object(S.jsx)("li",{children:"Initial zoom level: view full image or view image with one image pixel to one screen pixel ratio"}),Object(S.jsx)("li",{children:"Zoom to: control the focus of zooming with scrolling wheel"}),Object(S.jsx)("li",{children:"Enable drag-to-pan: when enabled, pan action is achieved by click-and-dragging. When disabled, pan action is achieved by a click where the clicked pixel will be centered in the image viewer."}),Object(S.jsx)("li",{children:"WCS matching on append: trigger WCS matching automatically for newly appended images"}),Object(S.jsx)("li",{children:"Spectral matching: spectral convention to be used for spectral matching of image cubes"})]}),Object(S.jsx)("h3",{id:"render-configuration",children:"Render configuration"}),Object(S.jsx)("p",{children:"This section provides customization of how a raster image is rendered by default."}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Default scaling: scaling function to be applied to a colormap"}),Object(S.jsx)("li",{children:"Default colormap: colormap for rendering a raster image"}),Object(S.jsx)("li",{children:"Default percentile ranks: clip level to be applied to the pixel value-to-color mapping"}),Object(S.jsx)("li",{children:"NaN color: color to render a NaN (not a number) pixel"})]}),Object(S.jsx)("h3",{id:"contour-configuration",children:"Contour configuration"}),Object(S.jsx)("p",{children:"This section provides customization of how a contour layer is calculated and rendered by default."}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Generator type: default level generator type"}),Object(S.jsx)("li",{children:"Smoothing mode: smoothing method to be applied before calculating contour vertices"}),Object(S.jsx)("li",{children:"Default smoothing factor: kernel size of the selected smoothing mode"}),Object(S.jsx)("li",{children:"Default contour levels: number of contour levels to be generated"}),Object(S.jsx)("li",{children:"Thickness: contour line thickness"}),Object(S.jsx)("li",{children:"Default color mode: to render contours with constant color or to render color-mapped contours"}),Object(S.jsx)("li",{children:"Default color map: colormap for rendering color-mapped contours"}),Object(S.jsx)("li",{children:"Default color: color for rendering contours with constant color"})]}),Object(S.jsx)("h3",{id:"overlay-configuration",children:"Overlay configuration"}),Object(S.jsx)("p",{children:"This section provides customization of the image overlay in the image viewer."}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"AST color: the default color theme of the grid layers including the coordinate bound box"}),Object(S.jsx)("li",{children:"AST grid visible: grid line rendering"}),Object(S.jsx)("li",{children:"AST label visible: grid x and y labels rendering"}),Object(S.jsx)("li",{children:"WCS format: show world coordinates in degrees or sexagesimal or auto-formatted"}),Object(S.jsx)("li",{children:"Beam visible: beam rendering at the bottom-left corner of the image viewer"}),Object(S.jsx)("li",{children:"Beam color: the color to render a beam element"}),Object(S.jsx)("li",{children:"Beam type: render a beam as open shape or filled shape"}),Object(S.jsx)("li",{children:"Beam width: line width to render an open-shape beam"})]}),Object(S.jsx)("h3",{id:"region",children:"Region"}),Object(S.jsx)("p",{children:"This section provides customization of region rendering properties and region creation interactivity."}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Color: default color to render a region"}),Object(S.jsx)("li",{children:"Line width: default line width to render a region"}),Object(S.jsx)("li",{children:"Dash length: when greater than zero, region is rendered in dashed line"}),Object(S.jsx)("li",{children:"Region type: default region type"}),Object(S.jsx)("li",{children:"Creation mode: the way how rectangle and ellipse regions are created with cursor"})]}),Object(S.jsx)("h3",{id:"performance",children:"Performance"}),Object(S.jsx)("p",{children:'Performance related control parameters are included here. We do not recommend users to change the settings here. If the bandwidth connecting to a CARTA server is limited, users may enable the "low bandwidth mode" which reduces displayed image resolution and cursor responsiveness.'}),Object(S.jsx)("h3",{id:"log-events",children:"Log events"}),Object(S.jsx)("p",{children:"This is for development and debugging purpose. General users should not enable anything here."})]})}}class hr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"The region configuration dialogue allows users to change the appearance of a region, such as"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color"}),Object(S.jsx)("li",{children:"linewidth"}),Object(S.jsx)("li",{children:"line style (solid or dashed)"})]}),Object(S.jsx)("p",{children:"and region properties, such as"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"region name"}),Object(S.jsx)("li",{children:"region location and shape properties in image or world coordinate"})]}),Object(S.jsxs)("p",{children:["Region properties can be defined in world coordinate. If the coordinate reference system is FK4, FK5, or ICRS, the coordinate format is sexagesimal. If the coordinate system is Galactic or Ecliptic, the coordinate format is decimal degree. Region size can be defined in arcsecond with ",Object(S.jsx)("code",{children:'"'}),", in arcminute with ",Object(S.jsx)("code",{children:"'"}),", or in degree with ",Object(S.jsx)("code",{children:"deg"}),"."]}),Object(S.jsx)("br",{}),Object(S.jsx)("h4",{id:"note",children:"NOTE"}),Object(S.jsx)("p",{children:"The displayed image coordinates refer to the spatial reference image as indicated in the title of the dialogue."}),Object(S.jsx)("h4",{id:"tip",children:"TIP"}),Object(S.jsxs)("p",{children:[Object(S.jsx)("code",{children:"Double-Click"})," on a region in the image viewer or on an entry in the region list widget will bring up this region configuration dialogue."]})]})}}var pr=i.p+"static/media/head_animator_button.cfa001f3.png",gr=i.p+"static/media/head_animator_button_d.5f3989e8.png";class fr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:pr,dark:gr,width:"90%"})}),Object(S.jsx)("p",{children:'The animator widget controls which im\bage, which channel (if exists per image file), and which Stokes (if exists per image file) to view in the image viewer. Users may also enable animation playback for image, channel, or Stokes, via the "Play" button. The radio buttons control which one to animate. Playback mode includes'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Forward: with index increasing"}),Object(S.jsx)("li",{children:"Backward: with index decreasing"}),Object(S.jsx)("li",{children:"Bouncing: with index increasing and decreasing so on and so forth between the boundary"}),Object(S.jsx)("li",{children:"Blink: with index jumping between the boundary"})]}),Object(S.jsx)("p",{children:"For channel, users may limit a channel range for animation playback via the double slider."}),Object(S.jsx)("p",{children:"A desired frame rate per second (fps) can be defined in the frame rate spinbox. Note that the real fps depends on computer performance and network performance."}),Object(S.jsxs)("p",{children:['For performance concern and resource management, animation playback will be automatically stopped after 5 minutes by default. This can be customized in the "Performance" tab of the preferences dialogue (',Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Preferences"}),"). Maximum playback time is 30 mins."]})]})}}var br=i.p+"static/media/head_histogram_button.42144255.png",mr=i.p+"static/media/head_histogram_button_d.3a13afc0.png";class yr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:br,dark:mr,width:"90%"})}),Object(S.jsx)("p",{children:"Histogram widget displays a histogram plot derived from a 2D region. When no region is created or selected, it displays a histogram derived from the current full image in the image viewer."}),Object(S.jsx)("h3",{id:"images",children:"Images"}),Object(S.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(S.jsx)("h3",{id:"regions",children:"Regions"}),Object(S.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one in the image viewer, or by clicking a region entry on the region list widget. Histogram plot of the selected region will be updated accordingly.'}),Object(S.jsx)("h3",{id:"interactivity-zoom-and-pan",children:"Interactivity: zoom and pan"}),Object(S.jsx)("p",{children:"The x and y ranges of the histogram plot can be modified by"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(S.jsx)("p",{children:"In addition, the x and y ranges can be explicitly set in the histogram settings dialogue."}),Object(S.jsx)("h3",{id:"exports",children:"Exports"}),Object(S.jsx)("p",{children:"The histogram plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(S.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(S.jsx)("p",{children:"The appearance of the histogram plot is customizable via the histogram settings dialogue (the cog icon). Supported options are:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"}),Object(S.jsx)("li",{children:"display y in logarithmic scale (default)"})]}),Object(S.jsx)("br",{}),Object(S.jsx)("h4",{id:"note",children:"Note"}),Object(S.jsx)("p",{children:"In the current release, the number of histogram bins is automatically derived as the square root of the product of region bound box sizes in x and y. The development team will improve this in future releases."}),Object(S.jsx)("h4",{id:"tip",children:"TIP"}),Object(S.jsx)("p",{children:"Multiple histogram widgets can be created to show histograms for different images with different regions."})]})}}class Or extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"Histogram settings dialogue allows users to customize the appearance of the histogram plot, and set x and y ranges of the plot explicitly."}),Object(S.jsx)("p",{children:"Supported options are:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"}),Object(S.jsx)("li",{children:"display y in logarithmic scale (default)"})]})]})}}var jr=i.p+"static/media/catalogue_selection_button.6c5c75ad.png",Sr=i.p+"static/media/catalogue_selection_button_d.d60042bc.png",xr=i.p+"static/media/contour_button.57f566f7.png",Cr=i.p+"static/media/contour_button_d.19bb31ae.png",Ir=i.p+"static/media/export_png_button.ad3d7040.png",wr=i.p+"static/media/export_png_button_d.3314b4ac.png",Tr=i.p+"static/media/image_info_button.2ba534d4.png",vr=i.p+"static/media/image_info_button_d.ed7099e2.png",Ar=i.p+"static/media/image_tools.3b0bc13d.png",Rr=i.p+"static/media/image_tools_d.86185081.png",Pr=i.p+"static/media/region_button.a95e8b71.png",Er=i.p+"static/media/region_button_d.7533887d.png",Fr=i.p+"static/media/wcs_match_button.0c2c1335.png",Mr=i.p+"static/media/wcs_match_button_d.9bf58e92.png",kr=i.p+"static/media/zoom_button.8cec85be.png",Dr=i.p+"static/media/zoom_button_d.5312a073.png",Nr=i.p+"static/media/head_catalogue_button.89097734.png",Lr=i.p+"static/media/head_catalogue_button_d.b6535928.png";class _r extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"The image viewer widget serves as the core component of CARTA. It allows users to visualize images in rasters and in contours. Region of interests can be defined interactively with the image viewer and subsequent image analysis can be performed with other widgets. Catalogue files can be loaded and visualized in the image viewer with the Catalogue widget."}),Object(S.jsxs)("p",{children:["Images can be loaded via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Open image"})," (will close all loaded image first). Users may load multiple images via ",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Append image"}),". All images are loaded as raster by default. Contour layers can be further generated via the contour configuration dialogue."]}),Object(S.jsxs)("p",{children:["Information of world coordinates and image coordinates at the cursor position is shown at the top of the image viewer. To freeze/unfreeze the cursor position, press ",Object(S.jsx)("code",{children:"F"})," key."]}),Object(S.jsx)("h3",{id:"image-tool-buttons",children:"Image tool buttons"}),Object(S.jsx)("p",{children:"A set of tool buttons is provided at the bottom-right corner when hovering over the image viewer. Users may use these buttons to"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Select a source from catalog overlay"}),Object(S.jsx)("li",{children:"Create regions"}),Object(S.jsx)("li",{children:"Change image zoom scale"}),Object(S.jsx)("li",{children:"Trigger WCS matching"}),Object(S.jsx)("li",{children:"Change grid overlay reference frame"}),Object(S.jsx)("li",{children:"Enable/disable grid lines and coordinate labels"}),Object(S.jsx)("li",{children:"Export image"})]}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Ar,dark:Rr,width:"90%"})}),Object(S.jsx)("h3",{id:"zoom-and-pan",children:"Zoom and pan"}),Object(S.jsx)("p",{children:"Zoom actions can be triggered in different ways. The most common one is to use mouse and scroll wheel. By scrolling up, image is zoomed in, while by scrolling down, image is zoomed out. Alternatively, users may use the tool buttons at the bottom-right corner of the image viewer to zoom in, zoom out, zoom to fit screen resolution, or zoom to fit image view."}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:kr,dark:Dr,width:"70%"})}),Object(S.jsxs)("p",{children:["Pan action is achieved by ",Object(S.jsx)("code",{children:"Click-and-drag"})," as default. This default can be changed via the preferences dialogue (",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Preferences"})," -> ",Object(S.jsx)("strong",{children:"Global"}),"). The alternative mode is ",Object(S.jsx)("code",{children:"Click"})," and the clicked pixel will be centered in the image viewer."]}),Object(S.jsx)("h3",{id:"matching-image-spatially-and-spectrally",children:"Matching image spatially and spectrally"}),Object(S.jsx)("p",{children:'Appended images may be matched in world coordinate spatially and/or spectrally. This can be triggered by the "WCS matching" button. Matching WCS on appending can be enabled in the preferences dialogue.'}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Fr,dark:Mr,width:"70%"})}),Object(S.jsx)("p",{children:"CARTA supports the following matching schemes:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"None: zoom levels of different images are independent. No matching in the spectral domain."}),Object(S.jsx)("li",{children:"Spatial only: images are matched to the reference image in the spatial domain by translation, rotation, and scaling."}),Object(S.jsx)("li",{children:"Spectral only: images are matched to the reference image in the spectral domain with nearest interpolation."}),Object(S.jsx)("li",{children:"Spatial and spectral: images are matched to the reference image both in the spatial domain and spectral domain."})]}),Object(S.jsx)("p",{children:"Note that images are spatially matched by applying translation, rotation, and scaling. Inconsistency may be prominent when attempting to match wide field images or images with different projection types. However, grid lines are still accurate per image. If contour layers exist, they will match the raster image in the current image view with high position accuracy. Spectral matching is performed with nearest interpolation."}),Object(S.jsx)("h3",{id:"contour-layers",children:"Contour layers"}),Object(S.jsx)("p",{children:"A contour layer can be generated via the contour configuration dialogue. Contours of spatially matched image are re-projected to other spatially matched raster image."}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:xr,dark:Cr,width:"85%"})}),Object(S.jsx)("h3",{id:"region-of-interest",children:"Region of interest"}),Object(S.jsx)("p",{children:"Four types of region of interest are supported, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Point"}),Object(S.jsx)("li",{children:"Rectangle (rotatable)"}),Object(S.jsx)("li",{children:"Ellipse (rotatable)"}),Object(S.jsx)("li",{children:"Polygon"})]}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Pr,dark:Er,width:"70%"})}),Object(S.jsx)("p",{children:"The default region type and the default region creation mode are customizable in the preferences dialogue. Region shortcut buttons are available at the top of the CARTA GUI. The tooltip of a region shortcut button provides instructions to create a region."}),Object(S.jsx)("h3",{id:"catalogue-layers",children:"Catalog overlay"}),Object(S.jsx)("p",{children:"A catalog overlay can be generated via the Catalog widget."}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Nr,dark:Lr,width:"85%"})}),Object(S.jsx)("p",{children:"To select a source, use the Catalog selection button. The selected source will be highlighted in the table of the Catalog widget."}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:jr,dark:Sr,width:"70%"})}),Object(S.jsx)("h3",{id:"customizing-the-image-plot",children:"Customizing the image plot"}),Object(S.jsx)("p",{children:" The image overlay can be customized via the image view settings dialogue. Plenty amounts of options are provided."}),Object(S.jsx)("h3",{id:"exports",children:"Exports"}),Object(S.jsx)("p",{children:'What users see in the current image view can be exported as a PNG file with the "Export image" button in the image tool bar.'}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Ir,dark:wr,width:"70%"})}),Object(S.jsx)("h3",{id:"image-information-and-header",children:"Image information and header"}),Object(S.jsx)("p",{children:"Basic image information and full image headers are displayed in the file header dialogue."}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Tr,dark:vr,width:"85%"})})]})}}var zr=i.p+"static/media/image_overlay_demo.abbb3738.png",Wr=i.p+"static/media/image_overlay_demo_d.abbb3738.png";class Gr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"The image view settings dialogue allows users to customize coordinate grid related properties in the image viewer."}),Object(S.jsx)("h3",{id:"global",children:"Global"}),Object(S.jsx)("p",{children:"This section allows users to"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"set a global color theme for the grid overlay"}),Object(S.jsx)("li",{children:"configure grid line rendering accuracy"}),Object(S.jsx)("li",{children:"put coordinate labels inside or outside the image"}),Object(S.jsx)("li",{children:"select a coordinate reference frame to generate the grid overlay"})]}),Object(S.jsx)("h3",{id:"title",children:"Title"}),Object(S.jsx)("p",{children:"A custom title can be added in the image view. Its font type, font size, and color are configurable."}),Object(S.jsx)("h3",{id:"ticks",children:"Ticks"}),Object(S.jsx)("p",{children:"This section allows users to changes the ticks properties, including location, density, color, line width, and length of major and minor ticks"}),Object(S.jsx)("h3",{id:"grid",children:"Grid"}),Object(S.jsx)("p",{children:"The appearance of the coordinate grid lines is customizable, including visibility, color, and line width."}),Object(S.jsx)("h3",{id:"border",children:"Border"}),Object(S.jsx)("p",{children:"This section allows users to change the style of the axis border, including visibility, color, and width."}),Object(S.jsx)("h3",{id:"axes",children:"Axes"}),Object(S.jsx)("p",{children:"This section allows users to adjust the appearance of an interior axis overlay, including visibility, color, and line width."}),Object(S.jsx)("h3",{id:"numbers",children:"Numbers"}),Object(S.jsx)("p",{children:"This sections allows users to customize the appearance of tick values, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"visibility"}),Object(S.jsx)("li",{children:"font type"}),Object(S.jsx)("li",{children:"font size"}),Object(S.jsx)("li",{children:"color"}),Object(S.jsx)("li",{children:"format as sexagesimal or decimal degree"}),Object(S.jsx)("li",{children:"coordinate precision"})]}),Object(S.jsx)("h3",{id:"labels",children:"Labels"}),Object(S.jsx)("p",{children:"This section allows users to modify the styles of the x and y labels, such as font type, font size, and color. A custom label can be defined."}),Object(S.jsx)("h3",{id:"beam",children:"Beam"}),Object(S.jsx)("p",{children:"This section allows users to change the appearance of a beam overlay (color, type, and line width) and adjust its position in the image viewer."}),Object(S.jsx)("h4",{children:"EXAMPLE"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:zr,dark:Wr,width:"90%"})})]})}}var Vr=i.p+"static/media/head_layer_button.8539a494.png",Br=i.p+"static/media/head_layer_button_d.1559fdd2.png";class Hr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Vr,dark:Br,width:"90%"})}),Object(S.jsx)("p",{children:"The image list widget displays loaded images as a list, which includes image name, rendering layers (R as raster and C as contours) and layer visibility state, WCS matching state, channel index, and Stokes index. The channel index and Stokes index are synchronized with the animator."}),Object(S.jsx)("p",{children:'Users may click "R" and/or "C" to hide/show a layer. For example, if users want to generate an image with contours only, users can hide raster layers by clicking "R".'}),Object(S.jsx)("p",{children:'Per image, users can click the "XY" button to enable/disable spatial matching and click "Z" button to enable/disable spectral matching.'}),Object(S.jsxs)("p",{children:["To change reference image, ",Object(S.jsx)("code",{children:"right-click"})," on a row to bring up the menu."]}),Object(S.jsxs)("p",{children:["To close an image (or images), ",Object(S.jsx)("code",{children:"right-click"})," on a row to bring up the menu."]}),Object(S.jsxs)("p",{children:["The list order reflects the order of the image slider in the animator. The order may be modified by selecting an entry by ",Object(S.jsx)("code",{children:"clicking"})," then ",Object(S.jsx)("code",{children:"click-and-dragging"})," to form a desired order."]})]})}}var qr=i.p+"static/media/head_log_button.897ea179.png",Yr=i.p+"static/media/head_log_button_d.cd2866be.png";class Ur extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:qr,dark:Yr,width:"90%"})}),Object(S.jsx)("p",{children:"Log widget provides information for diagnostics when something went wrong. The log levels include:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Debug"}),Object(S.jsx)("li",{children:"Info (default)"}),Object(S.jsx)("li",{children:"Warning"}),Object(S.jsx)("li",{children:"Error"}),Object(S.jsx)("li",{children:"Critical"})]}),Object(S.jsxs)("p",{children:["When users believe there is something wrong, please contact the ",Object(S.jsx)("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw",children:"helpdesk"})," or file an issue on ",Object(S.jsx)("a",{href:"https://github.com/CARTAvis/carta/issues",children:"Github"})," (recommended)."]})]})}}var Xr=i.p+"static/media/under_construction.b72aea0a.png";class $r extends p.Component{render(){return Object(S.jsxs)(p.Fragment,{children:[Object(S.jsx)("p",{children:"To be added."}),Object(S.jsx)("img",{src:Xr,style:{width:"20%",height:"auto"}})]})}}var Kr=i.p+"static/media/head_region_button.b4bd51b5.png",Qr=i.p+"static/media/head_region_button_d.2f9691e6.png";class Zr extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Kr,dark:Qr,width:"90%"})}),Object(S.jsxs)("p",{children:["Region list widget provides users a list of region created via the graphical user interface and/or via region import (",Object(S.jsx)("strong",{children:"File"})," -> ",Object(S.jsx)("strong",{children:"Import regions"}),"). Basic information of a region is shown in an entry in the list. The current active region is highlighted in the list and region control anchors are shown in the image viewer. To unselect a region, press ",Object(S.jsx)("code",{children:"esc"})," key."]}),Object(S.jsxs)("p",{children:[Object(S.jsx)("code",{children:"Double-Click"})," on a list entry or on a region in the image viewer will bring up the region configuration dialogue, where users can adjust region appearance and region properties."]}),Object(S.jsx)("p",{children:'The "lock" button for each region entry is to prevent editing a region accidentally. Locked regions will appear slightly dimmer in the image viewer. The "center" button is to center a region in the current field of view of the image viewer.'}),Object(S.jsxs)("p",{children:["To delete an active (selected) region, press ",Object(S.jsx)("code",{children:"delete"})," key."]})]})}}var Jr=i.p+"static/media/head_renderconfig_button.1c688181.png",eo=i.p+"static/media/head_renderconfig_button_d.2793ba77.png";class to extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Jr,dark:eo,width:"90%"})}),Object(S.jsx)("p",{children:'Render configuration widget controls how a raster image is rendered in color space. The widget equips with a set of clip levels as buttons on the top. The clip boundaries are displayed in the "Clip Min" and "Clip Max" fields. These fields can be manually edited and the clip level will switch to "Custom". The clip boundaries are visualized as two vertical lines (also draggable) in red in the histogram.'}),Object(S.jsx)("p",{children:'As default, a per-channel histogram is shown, and optionally a per-cube histogram can be displayed via the "Histogram" dropdown. Different scaling functions and colormaps can be chosen via the "Scaling" and "Color map" dropdowns, respectively. A color map might be inverted via the "Invert color map" toggle.'}),Object(S.jsx)("p",{children:"The appearance of the histogram plot can be configured through the render configuration settings dialogue, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"}),Object(S.jsx)("li",{children:"display y in logarithmic scale (default)"}),Object(S.jsx)("li",{children:"display mean and RMS"}),Object(S.jsx)("li",{children:"display clip labels"})]}),Object(S.jsx)("h3",{id:"interactivity-zoom-and-pan",children:"Interactivity: zoom and pan"}),Object(S.jsx)("p",{children:"The x and y ranges of the histogram plot can be modified by"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(S.jsx)("p",{children:"In addition, the x and y ranges can be explicitly set in the render configuration settings dialogue."})]})}}class io extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:"The appearance of the histogram plot in the render configuration widget can be customized through this settings dialogue, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"}),Object(S.jsx)("li",{children:"display y in logarithmic scale (default)"}),Object(S.jsx)("li",{children:"display mean and RMS"}),Object(S.jsx)("li",{children:"display clip labels"})]})]})}}var no=i.p+"static/media/head_spatial_button.938f9058.png",ro=i.p+"static/media/head_spatial_button_d.d1c466e7.png";class oo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:no,dark:ro,width:"90%"})}),Object(S.jsxs)("p",{children:["Spatial profiler widget allows users to view a profile from a horizontal cut or a vertical cut at the cursor position in the image viewer. The cursor position may be fixed in the image viewer by pressing ",Object(S.jsx)("code",{children:"F"})," key. Pressing again will unfreeze the cursor."]}),Object(S.jsx)("p",{children:"The cursor position in the image viewer is displayed as a red vertical line in the spatial profile plot."}),Object(S.jsx)("p",{children:"When cursor is in the image viewer, the cursor position and pointed pixel value in image and world coordinates are reported at the bottom-left corner of the spatial profiler widget. When cursor moves into the spatial profile plot, numerical values of the profile at the cursor position (displayed as a grey vertical line) will be reported instead."}),Object(S.jsx)("h3",{id:"profile-mean-and-rms",children:"Profile mean and RMS"}),Object(S.jsx)("p",{children:'As an option in the "Styling" tab of the spatial profiler settings dialogue, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too.'}),Object(S.jsx)("h3",{id:"profile-smoothing",children:"Profile smoothing"}),Object(S.jsx)("p",{children:'The displayed profile can be smoothed via the "Smoothing" tab of the spatial profiler settings dialogue (the cog icon).'}),Object(S.jsx)("h3",{id:"interactivity-zoom-and-pan",children:"Interactivity: zoom and pan"}),Object(S.jsx)("p",{children:"The x and y ranges of the spatial profile plot can be modified by"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(S.jsx)("p",{children:"In addition, the x and y ranges can be explicitly set in the spatial profiler settings dialogue."}),Object(S.jsx)("h3",{id:"exports",children:"Exports"}),Object(S.jsx)("p",{children:"The spatial profile plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(S.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(S.jsx)("p",{children:'The appearance of the spatial profile plot is customizable via the "Styling" tab of the spatial profiler settings dialogue (the cog icon). Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"}),Object(S.jsx)("li",{children:"display alternative horizontal axis in world coordinate"})]}),Object(S.jsx)("br",{}),Object(S.jsx)("h4",{id:"note",children:"NOTE"}),Object(S.jsx)("p",{children:'For performance concerns, a profile is decimated before rendering if the number of points of the profile is greater than the screen resolution of the spatial profiler widget. The kernel size of profile decimation is dynamically adjusted so that profile features are mostly preserved. When decimation is applied, the line style of the profile plot is switched to "line", regardless the setting in the spatial profiler settings dialogue. When no decimation is applied (e.g., at higher profile zoom level, or profile has fewer points than the screen resolution), the line style becomes "step" (as default in the "Styling" tab of the settings dialogue).'})]})}}class so extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Styling"}),Object(S.jsx)("p",{children:"The Styling tab allows users to adjust the appearance of the profile plot, and set x and y ranges of the plot explicitly. In addition, users can select which cut (horizontal or vertical) at cursor to use to generate a spatial profile. Users may also enable visualization of mean and RMS values of the current profile in the plot."}),Object(S.jsx)("p",{children:"Supported options for plot appearance are:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"}),Object(S.jsx)("li",{children:"display alternative horizontal axis in world coordinate"})]})]})}}var ao=i.p+"static/media/smoothing_boxcar.2fe55f1c.png",lo=i.p+"static/media/smoothing_gaussian.dd0ec9a5.png",co=i.p+"static/media/smoothing_hanning.a9ee32b3.png",uo=i.p+"static/media/smoothing_binning.780b507a.png",ho=i.p+"static/media/smoothing_SG.51c7ccc2.png",po=i.p+"static/media/smoothing_decimation.96925a9d.png",go=i.p+"static/media/smoothing_boxcar_d.7beaf6b3.png",fo=i.p+"static/media/smoothing_gaussian_d.1d6a6c39.png",bo=i.p+"static/media/smoothing_hanning_d.068e1feb.png",mo=i.p+"static/media/smoothing_binning_d.22137628.png",yo=i.p+"static/media/smoothing_SG_d.9c0bf41f.png",Oo=i.p+"static/media/smoothing_decimation_d.c27e29ba.png";class jo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Smoothing"}),Object(S.jsx)("p",{children:"Smoothing may be applied to profiles to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Boxcar"}),": convolution with a boxcar function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Gaussian"}),": convolution with a Gaussian function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Hanning"}),": convolution with a Hanning function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Binning"}),": averaging channels with a given width"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Savitzky-Golay"}),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Decimation"}),": min-max decimation with a given width"]})]}),Object(S.jsx)("p",{children:"Optionally, the original profile can be overplotted with the smoothed profile. The appearance of the smoothed profile, including color, style, width, and size, can be customized."}),Object(S.jsx)("p",{children:"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied."}),Object(S.jsx)("h3",{children:"Examples"}),Object(S.jsx)("p",{children:"Boxcar: Kernel = 2"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:ao,dark:go,width:"90%"})}),Object(S.jsx)("p",{children:"Gaussian: Sigma = 1"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:lo,dark:fo,width:"90%"})}),Object(S.jsx)("p",{children:"Hanning: Kernel = 5"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:co,dark:bo,width:"90%"})}),Object(S.jsx)("p",{children:"Binning: Binning width = 3"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:uo,dark:mo,width:"90%"})}),Object(S.jsx)("p",{children:"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:ho,dark:yo,width:"90%"})}),Object(S.jsx)("p",{children:"Decimation: Decimation width = 3"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:po,dark:Oo,width:"90%"})})]})}}var So=i.p+"static/media/head_spectral_button.5dc8cd0c.png",xo=i.p+"static/media/head_spectral_button_d.dd25d4cd.png";class Co extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:So,dark:xo,width:"90%"})}),Object(S.jsx)("p",{children:'The spectral profiler widget allows users to view a region spectral profile of an image cube with a specific statistic (via the "Statistic" dropdown; default as mean). If Stokes axis exists, users may view a specific Stokes via the "Stokes" dropdown.'}),Object(S.jsx)("h3",{id:"images",children:"Images"}),Object(S.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(S.jsx)("h3",{id:"regions",children:"Regions"}),Object(S.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Spectral profile plot of the selected region will be updated accordingly. If no region is selected, "Active" region defaults to cursor.'}),Object(S.jsx)("h3",{id:"responsive-and-progressive-profile-update",children:"Responsive and progressive profile update"}),Object(S.jsx)("p",{children:"When a region spectral profile is requested, depending on the performance of the server, users may see profiles are updated piece by piece in regular interval. This feature provides a visual progress update for better user experience. In addition, if users move a region while its spectral profile is being updating, the old calculations will be terminated immediately and calculations of the new region spectral profile will start and users will see a partial profile in seconds."}),Object(S.jsx)("h3",{id:"spectral-conventions-and-reference-frame",children:"Spectral conventions and reference frame"}),Object(S.jsx)("p",{children:'With the "Conversion" tab of the spectral profiler settings dialogue, users can change the spectral convention, including:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(S.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Channel"})]}),Object(S.jsx)("p",{children:"and spectral reference frame, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(S.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(S.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(S.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(S.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."}),Object(S.jsx)("h3",{id:"profile-smoothing",children:"Profile smoothing"}),Object(S.jsx)("p",{children:'The displayed profile can be smoothed via the "Smoothing" tab of the spectral profiler settings dialogue (the cog icon). A shortcut button of the "Smoothing" tab can be found at the top-right corner of the widget.'}),Object(S.jsx)("h3",{id:"profile-mean-and-rms",children:"Profile mean and RMS"}),Object(S.jsx)("p",{children:'As an option in the "Styling" tab of the spectral profiler settings dialogue, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too.'}),Object(S.jsx)("h3",{id:"moment-image-generator",children:"Moment image generator"}),Object(S.jsx)("p",{children:'Moment images can be generated via the "Moments" tab of the spectral profiler settings dialogue (the cog icon). A shortcut button of the "Moments" tab can be found at the top-right corner of the widget.'}),Object(S.jsx)("h3",{id:"interactivity-zoom-pan-changing-channel",children:"Interactivity: zoom, pan, changing channel"}),Object(S.jsx)("p",{children:"The x and y ranges of the spectral profile plot can be modified by"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(S.jsx)("p",{children:'In addition, the x and y ranges can be explicitly set in the "Styling" tab of the spectral profile settings dialogue.'}),Object(S.jsx)("p",{children:"Users may click on the spectral profile plot to switch to a channel (as indicated by a red vertical line) and view the image in the image viewer. The red line is draggable and acts equivalently like the channel slider in the animator widget."}),Object(S.jsx)("h3",{id:"exports",children:"Exports"}),Object(S.jsx)("p",{children:"The spectral profile plot can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(S.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(S.jsx)("p",{children:'The appearance of the spectral profile plot is customizable via the "Styling" tab of the spectral profile settings dialogue (the cog icon). Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"})]}),Object(S.jsx)("br",{}),Object(S.jsx)("h4",{id:"note",children:"NOTE"}),Object(S.jsx)("p",{children:'For performance concerns, a profile is decimated before rendering if the number of points of the profile is greater than the screen resolution of the spectral profiler widget. The kernel size of profile decimation is dynamically adjusted so that profile features are mostly preserved. When decimation is applied, the line style of the profile plot is switched to "line", regardless the setting in the spectral profiler settings dialogue. When no decimation is applied (e.g., at higher profile zoom level, or profile has fewer points than the screen resolution), the line style becomes "step" (as default in the "Styling" tab of the settings dialogue).'})]})}}class Io extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Conversion"}),Object(S.jsx)("p",{children:'With the "Conversion" tab, users can change the spectral convention, including:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(S.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Channel"})]}),Object(S.jsx)("p",{children:"and spectral reference frame, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(S.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(S.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(S.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(S.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."})]})}}class wo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Styling"}),Object(S.jsx)("p",{children:'The appearance of a spectral profile plot is customizable via the "Styling" tab. Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"})]}),Object(S.jsx)("h4",{children:"Profile mean and RMS"}),Object(S.jsx)("p",{children:"As an option in the spectral profiler settings dialogue, mean and RMS values of the profile can be visualized as a green dashed line and a shaded area in the profile plot. Numerical values are displayed at the bottom-left corner. Note that CARTA includes all data in the current zoom level of the profile plot to perform the calculations. If zoom level changes, mean and RMS values will be updated too."})]})}}class To extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Smoothing"}),Object(S.jsx)("p",{children:"Smoothing may be applied to profiles to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Boxcar"}),": convolution with a boxcar function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Gaussian"}),": convolution with a Gaussian function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Hanning"}),": convolution with a Hanning function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Binning"}),": averaging channels with a given width"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Savitzky-Golay"}),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Decimation"}),": min-max decimation with a given width"]})]}),Object(S.jsx)("p",{children:"Optionally, the original profile can be overplotted with the smoothed profile. The appearance of the smoothed profile, including color, style, width, and size, can be customized."}),Object(S.jsx)("p",{children:"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied."}),Object(S.jsx)("h3",{children:"Examples"}),Object(S.jsx)("p",{children:"Boxcar: Kernel = 2"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:ao,dark:go,width:"90%"})}),Object(S.jsx)("p",{children:"Gaussian: Sigma = 1"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:lo,dark:fo,width:"90%"})}),Object(S.jsx)("p",{children:"Hanning: Kernel = 5"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:co,dark:bo,width:"90%"})}),Object(S.jsx)("p",{children:"Binning: Binning width = 3"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:uo,dark:mo,width:"90%"})}),Object(S.jsx)("p",{children:"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:ho,dark:yo,width:"90%"})}),Object(S.jsx)("p",{children:"Decimation: Decimation width = 3"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:po,dark:Oo,width:"90%"})})]})}}class vo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Moments"}),Object(S.jsx)("p",{children:'Moment images can be generated and viewed with CARTA. The "Moments" tab provides several control parameters to define how moment images are calculated, including:'}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Image"}),': the image file for moment calculations. "Active" refers to the image displayed in the image viewer.']}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Region"}),': a region can be selected so that moment calculations are limited inside the region. "Active" refers to the selected region in the image viewer. If no region is selected, full image is included in the moment calculations.']}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Coordinate, System, and Range"}),": the spectral range (e.g., velocity range) used for moment calculations is defined with these options. The range can be defined either via the text input fields, or via the cursor by dragging horizontally in the spectral profiler widget."]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Mask and Range"}),': these options define a pixel value range used for moment calculations. If mask is "None", all pixels are included. If mask is "Include" or "Exclude", the pixel value range defined in the text input fields is included or excluded, respectively. Alternatively, the pixel value range can be defined via the cursor by dragging vertically in the spectral profiler widget.']}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Moments"}),": which moment images to be calculated are defined here. Supported options are:",Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"-1: Mean value of the spectrum"}),Object(S.jsx)("li",{children:"0: Integrated value of the spectrum"}),Object(S.jsx)("li",{children:"1: Intensity weighted coordinate"}),Object(S.jsx)("li",{children:"2: Intensity weighted dispersion of the coordinate"}),Object(S.jsx)("li",{children:"3: Median value of the spectrum"}),Object(S.jsx)("li",{children:"4: Median coordinate"}),Object(S.jsx)("li",{children:"5: Standard deviation about the mean of the spectrum"}),Object(S.jsx)("li",{children:"6: Root mean square of the spectrum"}),Object(S.jsx)("li",{children:"7: Absolute mean deviation of the spectrum"}),Object(S.jsx)("li",{children:"8: Maximum value of the spectrum"}),Object(S.jsx)("li",{children:"9: Coordinate of the maximum value of the spectrum"}),Object(S.jsx)("li",{children:"10: Minimum value of the spectrum"}),Object(S.jsx)("li",{children:"11: Coordinate of the minimum value of the spectrum"})]})]})]}),Object(S.jsx)("p",{children:'When all the parameters are defined, by clicking the "Generate" button moment calculations will begin. Depending on the file size, moment calculations may take a while. If that happens, users may consider to cancel the calculations and re-define a proper region and/or spectral range.'}),Object(S.jsx)("p",{children:'Once moment images are generated, they will be loaded and displayed in the image viewer. They are named as $image_filename.moment.$keyword. For example, if moment 0, 1 and 2 images are generated from the image M51.fits, they will be named as M51.fits.moment.integrated, M51.fits.moment.weighted_coord, and M51.fits.moment.weighted_dispersion_coord, respectively. These images are kept in RAM per session and if there is a new request of moment calculations, these images will be deleted first. Optionally, calculated moment images can be exported in CASA or FITS format via "File" -> "Save image".'}),Object(S.jsx)("h4",{children:"NOTE"}),Object(S.jsx)("p",{children:'Due to a CASA issue, image of "Median coordinate" cannot be generated. The request of "Median coordinate" is ignored automatically.'})]})}}var Ao=i.p+"static/media/head_statistics_button.6bdac5f7.png",Ro=i.p+"static/media/head_statistics_button_d.6bdcaf7c.png";class Po extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Ao,dark:Ro,width:"90%"})}),Object(S.jsx)("p",{children:"Statistics widget allows users to view statistical quantities over a 2D region. When no region is created or selected, it displays statistical quantities of the full image in the image viewer."}),Object(S.jsx)("h3",{id:"images",children:"Images"}),Object(S.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(S.jsx)("h3",{id:"regions",children:"Regions"}),Object(S.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Statistics of the selected region will be updated accordingly.'}),Object(S.jsx)("h3",{id:"statistic",children:"Statistic"}),Object(S.jsx)("p",{children:"CARTA provides the following statistical quantities:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"NumPixels: number of pixels in a region"}),Object(S.jsx)("li",{children:"Sum: summation of pixel values in a region"}),Object(S.jsx)("li",{children:"FluxDensity: total flux density in a region"}),Object(S.jsx)("li",{children:"Mean: average of pixel values in a region"}),Object(S.jsx)("li",{children:"StdDev: standard deviation of pixel values in a region"}),Object(S.jsx)("li",{children:"Min: minimum pixel value in a region"}),Object(S.jsx)("li",{children:"Max: maximum pixel value in a region"}),Object(S.jsx)("li",{children:"RMS: root mean square of pixel values in a region"}),Object(S.jsx)("li",{children:"SumSq: summation of squared pixel values in a region"})]}),Object(S.jsx)("br",{}),Object(S.jsx)("h4",{id:"tip",children:"TIP"}),Object(S.jsx)("p",{children:"Multiple statistics widgets can be created to show statistics for different images and different regions."})]})}}var Eo=i.p+"static/media/head_stokes_button.554491a0.png",Fo=i.p+"static/media/head_stokes_button_d.7498c691.png";class Mo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Eo,dark:Fo,width:"90%"})}),Object(S.jsx)("p",{children:"The Stokes analysis widget is specifically made for efficient visualization of a Stokes cube. The widget includes plots, such as:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Region spectral profiles for Stokes Q and Stokes U, as absolute or fractional values"}),Object(S.jsx)("li",{children:"Polarized intensity spectral profile, as absolute or fractional values"}),Object(S.jsx)("li",{children:"Linearly polarized angle spectral profile"}),Object(S.jsx)("li",{children:"Stokes Q vs Stokes U scatter plot"})]}),Object(S.jsx)("p",{children:"All these plots are inter-linked so that when zooming profiles, data in the visible range will be highlighted in the scatter plot, and vice versa."}),Object(S.jsx)("h3",{id:"images",children:"Images"}),Object(S.jsx)("p",{children:'The image dropdown defaults to "Active" image which means the current image in the image viewer.'}),Object(S.jsx)("h3",{id:"regions",children:"Regions"}),Object(S.jsx)("p",{children:'The region dropdown defaults to "Active" region which means a selected region in the image viewer. Users can select a region by clicking one on the image viewer, or by clicking a region entry on the region list widget. Stokes profile plot of the selected region will be updated accordingly. If no region is selected, "Active" region defaults to cursor.'}),Object(S.jsx)("h3",{id:"responsive-and-progressive-profile-update",children:"Responsive and progressive profile update"}),Object(S.jsx)("p",{children:"When region Stokes profiles are requested, depending on the performance of the server, users may see profiles are updated piece by piece in regular interval. This feature provides a visual progress update for better user experience. In addition, if users move a region while profiles are being updating, the old calculations will be terminated immediately and calculations of the new region Stokes profiles will start and users will see partial profiles in seconds."}),Object(S.jsx)("h3",{id:"spectral-conventions-and-reference-frame",children:"Spectral conventions and reference frame"}),Object(S.jsx)("p",{children:'With the "Conversion" tab of the Stokes analysis settings dialogue, users can change the spectral convention, including:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(S.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Channel"})]}),Object(S.jsx)("p",{children:"and spectral reference frame, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(S.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(S.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(S.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(S.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."}),Object(S.jsx)("h3",{id:"data-smoothing",children:"Data smoothing"}),Object(S.jsx)("p",{children:'The displayed profiles and the scatter plot can be smoothed via the "Smoothing" tab of the Stokes analysis settings dialogue (the cog icon). A shortcut button of the "Smoothing" tab can be found at the top-right corner of the widget.'}),Object(S.jsx)("h3",{id:"interactivity-zoom-pan-changing-channel",children:"Interactivity: zoom, pan, changing channel"}),Object(S.jsx)("p",{children:"The x and y ranges of the Stokes profile plot can be modified by"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"scrolling wheel"})," (up to zoom in and down to zoom out with respect to the cursor position)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," horizontally to zoom in x"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," vertically to zoom in y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"click-and-drag"})," diagonally to zoom in both x and y"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"double-click"})," to reset x and y ranges"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"shift + click-and-drag"})," to pan in x"]})]}),Object(S.jsx)("p",{children:"Users may click on the Stokes profile plot to switch to a channel (as indicated by a red vertical line) and view the image in the image viewer. The red line is draggable and acts equivalently like the channel slider in the animator widget."}),Object(S.jsx)("h3",{id:"exports",children:"Exports"}),Object(S.jsx)("p",{children:"The Stokes profile plots can be exported as a png file or a text file in tsv format via the buttons at the bottom-right corner (shown when hovering over the plot)."}),Object(S.jsx)("h3",{id:"plot-cosmetics",children:"Plot cosmetics"}),Object(S.jsx)("p",{children:'The appearance of the Stokes profile plot is customizable via the "Line Plot Styling" tab of the Stokes analysis settings dialogue (the cog icon). Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"colors of Stokes Q and Stokes U profiles"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"})]}),Object(S.jsx)("p",{children:'In addition, the appearance of the scatter plot can be customized with the "Scatter Plot Styling" tab too, including:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Colormap"}),Object(S.jsx)("li",{children:"Symbol size"}),Object(S.jsx)("li",{children:"Symbol transparency"}),Object(S.jsx)("li",{children:"Q-to-U scale ratio as unity"})]})]})}}class ko extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Conversion"}),Object(S.jsx)("p",{children:'With the "Conversion" tab, users can change the spectral convention, including:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Radio velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Optical velocity (km/s, m/s)"}),Object(S.jsx)("li",{children:"Frequency (GHz, MHz, kHz, Hz)"}),Object(S.jsx)("li",{children:"Wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Air wavelength (m, mm, um, Angstrom)"}),Object(S.jsx)("li",{children:"Channel"})]}),Object(S.jsx)("p",{children:"and spectral reference frame, including:"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"LSRK: the rest-frame of the kinematical local standard of rest"}),Object(S.jsx)("li",{children:"LSRD: the rest-frame of the dynamical local standard of rest"}),Object(S.jsx)("li",{children:"BARY: barycentric, the rest-frame of the solar-system barycenter"}),Object(S.jsx)("li",{children:"TOPO: topocentric, the observer's rest-frame on Earth"})]}),Object(S.jsx)("p",{children:"Note that depending on the integrity of image headers, some conversions may not be possible."})]})}}class Do extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Line Plot Styling"}),Object(S.jsx)("p",{children:'The appearance of the spectral profile plot is customizable via the "Line Plot Styling" tab. Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"color of the plot"}),Object(S.jsx)("li",{children:"plot styles including steps (default), lines, and dots"}),Object(S.jsx)("li",{children:"line width for steps or lines"}),Object(S.jsx)("li",{children:"point size for dots"})]})]})}}class No extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Scatter Plot Styling"}),Object(S.jsx)("p",{children:'The appearance of the scatter plot is customizable via the "Scatter Plot Styling" tab. Supported options are:'}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"Colormap"}),Object(S.jsx)("li",{children:"Symbol size"}),Object(S.jsx)("li",{children:"Symbol transparency"}),Object(S.jsx)("li",{children:"Q-to-U scale ratio as unity"})]})]})}}class Lo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h3",{children:"Smoothing"}),Object(S.jsx)("p",{children:"Smoothing may be applied to profiles and the scatter plot to enhance signal-to-noise ratio. CARTA provides the following smoothing methods:"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Boxcar"}),": convolution with a boxcar function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Gaussian"}),": convolution with a Gaussian function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Hanning"}),": convolution with a Hanning function"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Binning"}),": averaging channels with a given width"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("b",{children:"Savitzky-Golay"}),": fitting successive sub-sets of adjacent data points with a low-degree polynomial by the method of linear least squares"]})]}),Object(S.jsx)("p",{children:"Optionally, the original profile can be overplotted with the smoothed profile. "}),Object(S.jsx)("p",{children:"The data of the smoothed profile is appended in the exported tsv file if smoothing is applied. The tsv file of the scatter plot only contains the smoothed data if smoothing is applied."}),Object(S.jsx)("h3",{children:"Examples"}),Object(S.jsx)("p",{children:"Boxcar: Kernel = 2"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:ao,dark:go,width:"90%"})}),Object(S.jsx)("p",{children:"Gaussian: Sigma = 1"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:lo,dark:fo,width:"90%"})}),Object(S.jsx)("p",{children:"Hanning: Kernel = 5"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:co,dark:bo,width:"90%"})}),Object(S.jsx)("p",{children:"Binning: Binning width = 3"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:uo,dark:mo,width:"90%"})}),Object(S.jsx)("p",{children:"Savitzky-Golay: Kernel = 5, Degree of fitting = 0"}),Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:ho,dark:yo,width:"90%"})})]})}}class _o extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Nr,dark:Lr,width:"90%"})}),Object(S.jsx)("p",{children:'Source catalogue files in the VOTable or FITS format can be loaded in CARTA (via "File"-> "Import catalog") for visualization as an image overlay, or a 2D scatter plot, or a histogram.'}),Object(S.jsx)("p",{children:"Once a source catalogue file is loaded, the information of each column will be shown in the upper table, while the actual catalogue entries are displayed in the lower table. By default, only the first 10 columns are enabled and displayed. Users may configure it to show or hide certain columns to be displayed in the lower table."}),Object(S.jsx)("p",{children:'Depending on the rendering type defined (via a dropdown) in the top bar, the "Represent As" column allows users to set which columns are used for visualization. If the rendering type is "Image overlay", the content of the dropdown of the "Represent As" column is determined by the "System" dropdown. Users need to tell CARTA which coordinate system the source catalogue file refers to. Source catalogue defined in image coordinate (0-based or 1-based) is also supported. Two numeric columns are required to render the source catalogue as an "Image overlay". If the rendering type is "Histogram", one numeric column is required. If the rendering type is "2D scatter", two numeric columns are needed.'}),Object(S.jsx)("p",{children:"The source catalogue table accepts sub-filters such as partial string match or value range. For numeric columns, supported operators are:"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:">"})," greater than"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:">="})," greater than or equal to"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"<"})," less than"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"<="})," less than or equal to"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"=="})," equal to"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"!="})," not equal to"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:".."})," between (exclusive)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"..."})," between (inclusive)"]})]}),Object(S.jsx)("p",{children:"Examples:"}),Object(S.jsxs)("ul",{children:[Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"< 10"})," (everything less than 10)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"== 1.23"})," (entries equal to 1.23)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"10..50"})," (everything between 10 and 50, exclusive)"]}),Object(S.jsxs)("li",{children:[Object(S.jsx)("code",{children:"10...50"})," (everything between 10 and 50, inclusive)"]})]}),Object(S.jsxs)("p",{children:["For string columns, partial match is adopted. For example, ",Object(S.jsx)("code",{children:"gal"}),' (no quotation) will return entries containing the "gal" string.']}),Object(S.jsx)("p",{children:'Once filters are set, by clicking the "Update" the filters will be applied and a filtered source catalogue will be displayed up to a number of entries defined in the "Max Rows" text input field. When the "Reset" button is clicked, all filters will be removed and the image overlay (if exists) will be removed too. For the histogram plot or the 2D scatter plot, the plot will be reset so that only the first 50 entries are rendered.'}),Object(S.jsx)("p",{children:"The source catalogue table, the image overlay, the 2D scatter plot, and the histogram plot are inter-linked or cross-referenced. This means, for example, selecting a source or a set of source in the catalogue table will trigger source highlight in other places. Or, selecting a source or a set of sources in the 2D scatter plot will trigger source highlight in other plots and in the catalogue table."}),Object(S.jsx)("p",{children:'Multiple catalogue files can be loaded and users may use the "File" dropdown at the top of the widget to switch in between. Multiple catalogue widgets may be launched to display different catalogue files. The "Close" button at the bottom of the widget will close the selected catalogue file in the "File" dropdown.'})]})}}class zo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:'The Catalog histogram plot widget shows a histogram of one numeric column of a catalog file. The available numeric columns are determined by the "Display" column of the upper table in the Catalog widget.'}),Object(S.jsx)("p",{children:'The data used for plotting the histogram is determined by the lower table in the Catalog widget. The table may not show all entries due to the dynamic loading feature. Thus, the histogram plot may not include all entries (after filtering). The "Plot All" button will request a full download of all entries and the histogram plot will then include all entries (after filtering). The number of bins and the scale of the y-axis can be customized.'}),Object(S.jsx)("p",{children:'By clicking on a certain histogram bin, source entries of that bin will be highlighted in the source catalog table, in the 2D scatter plot (if exists), and in the image viewer (if the catalog overlay is enabled). A certain histogram bin will be highlighted if source entries of that bin are selected in the source catalog table, in the 2D scatter plot (if exists), and in the image viewer (if the catalog overlay is enabled). The "Show only selected sources" toggle will update the source catalog table to show only the selected sources.'})]})}}class Wo extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:'The Catalog 2D scatter plot widget shows a 2D scatter plot of two numeric columns of a catalog file. The available numeric columns are determined by the "Display" column of the upper table in the Catalog widget.'}),Object(S.jsx)("p",{children:'The data used for plotting the 2D scatter is determined by the lower table in the Catalog widget. The table may not show all entries due to the dynamic loading feature. Thus, the histogram plot may not include all entries (after filtering). The "Plot All" button will request a full download of all entries and the histogram plot will then include all entries (after filtering).'}),Object(S.jsx)("p",{children:'By clicking on a point or using the selection tools from the top-right corner of the plot, selected sources will be highlighted in the source catalog table, in the histogram plot (if exists), and in the image viewer (if the catalog overlay is enabled). Points on the plot will be highlighted if sources are selected in the source catalog table, in the histogram plot (if exists), and in the image viewer (if the catalog overlay is enabled). The "Show only selected sources" toggle will update the source catalog table to show only the selected sources.'})]})}}var Go,Vo=i.p+"static/media/head_linequery_button.2a49bd33.png",Bo=i.p+"static/media/head_linequery_button_d.3396c139.png";class Ho extends p.Component{render(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("p",{children:Object(S.jsx)(er,{light:Vo,dark:Bo,width:"90%"})}),Object(S.jsx)("p",{children:"CARTA supports an initial implementation of spectral line ID overlay on a spectral profiler widget with a query to the Splatalogue service (https://splatalogue.online). The query is made by defining a spectral range in frequency or wavelength and optionally a lower limit of CDMS/JPL line intensity (log). The spectral range can be defined as from-to or a center with a width."}),Object(S.jsx)("h4",{children:"QUERY LIMITATION"}),Object(S.jsxs)("ul",{children:[Object(S.jsx)("li",{children:"The allowed maximum query range, equivalent in frequency, is 20 GHz."}),Object(S.jsx)("li",{children:"The actual query is made with a frequency range in MHz rounded to integer."}),Object(S.jsx)("li",{children:"When an intensity limit is applied, only the lines from CDMS and JPL catalogues will be returned."}),Object(S.jsx)("li",{children:"Up to 100000 lines are displayed."})]}),Object(S.jsx)("h4",{children:"IMPORTANT NOTE"}),Object(S.jsxs)("p",{children:["Currently, the Splatalogue query service is under active development. Unexpected query results might happen. When users believe there is something wrong, please contact the ",Object(S.jsx)("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw",children:"helpdesk"})," or file an issue on ",Object(S.jsx)("a",{href:"https://github.com/CARTAvis/carta/issues",children:"Github"})," (recommended)."]}),Object(S.jsx)("br",{}),Object(S.jsx)("p",{children:"Once a query is successfully made, the line catalogue will be displayed in the tables. The upper table shows the column information in the catalogue with options to show or hide a specific column. The actual line catalogue is displayed in the lower table."}),Object(S.jsx)("p",{children:'The "Shifted Frequency" column is computed based on the user input of a velocity or a redshift. This "Shifted Frequency" is adopted for line ID overlay on a spectral profiler widget.'}),Object(S.jsx)("p",{children:"Users can use the checkbox to select a set of lines to be overplotted on a spectral profiler widget. The maximum number of line ID overlay is 1000."}),Object(S.jsx)("p",{children:"The sorting and filtering functions in the line table will be available in a future release."}),Object(S.jsx)("p",{children:'The text labels of the line ID overlay are shown dynamically based on the zoom level of a profile. Different line ID overlays (with different velocity shifts) can be created on different spectral profilers widgets via the "Spectral Profiler" dropdown. By clicking the "Clear" button, the line ID overlay on the selected "Spectral Profiler" will be removed.'})]})}}let qo=Object(g.a)(Go=class extends p.Component{constructor(...e){super(...e),this.HELP_MAP=new Map([[O.x.CONTOUR,{title:"Contour Configuration",content:Object(S.jsx)(nr,{})}],[O.x.FILE_Browser,{title:"File Browser",content:Object(S.jsx)(rr,{})}],[O.x.FILE_INFO,{title:"File Header",content:Object(S.jsx)(ar,{})}],[O.x.SAVE_LAYOUT,{title:"Save Layout",content:Object(S.jsx)(lr,{})}],[O.x.PREFERENCES,{title:"Preferences",content:Object(S.jsx)(ur,{})}],[O.x.REGION_DIALOG,{title:"Region Dialog",content:Object(S.jsx)(hr,{})}],[O.x.ANIMATOR,{title:"Animator",content:Object(S.jsx)(fr,{})}],[O.x.HISTOGRAM,{title:"Histogram",content:Object(S.jsx)(yr,{})}],[O.x.HISTOGRAM_SETTINGS,{title:"Histogram Settings",content:Object(S.jsx)(Or,{})}],[O.x.IMAGE_VIEW,{title:"Image View",content:Object(S.jsx)(_r,{})}],[O.x.IMAGE_VIEW_SETTINGS,{title:"Image View Settings",content:Object(S.jsx)(Gr,{})}],[O.x.LAYER_LIST,{title:"Image List",content:Object(S.jsx)(Hr,{})}],[O.x.LOG,{title:"Log",content:Object(S.jsx)(Ur,{})}],[O.x.PLACEHOLDER,{title:"Placeholder",content:Object(S.jsx)($r,{})}],[O.x.REGION_LIST,{title:"Region List",content:Object(S.jsx)(Zr,{})}],[O.x.RENDER_CONFIG,{title:"Render Configuration",content:Object(S.jsx)(to,{})}],[O.x.RENDER_CONFIG_SETTINGS,{title:"Render Configuration Settings",content:Object(S.jsx)(io,{})}],[O.x.SPATIAL_PROFILER,{title:"Spatial Profiler",content:Object(S.jsx)(oo,{})}],[O.x.SPATIAL_PROFILER_SETTINGS_STYLING,{title:"Spatial Profiler Settings",content:Object(S.jsx)(so,{})}],[O.x.SPATIAL_PROFILER_SETTINGS_SMOOTHING,{title:"Spatial Profiler Settings",content:Object(S.jsx)(jo,{})}],[O.x.SPECTRAL_PROFILER,{title:"Spectral Profiler",content:Object(S.jsx)(Co,{})}],[O.x.SPECTRAL_PROFILER_SETTINGS_CONVERSION,{title:"Spectral Profiler Settings",content:Object(S.jsx)(Io,{})}],[O.x.SPECTRAL_PROFILER_SETTINGS_STYLING,{title:"Spectral Profiler Settings",content:Object(S.jsx)(wo,{})}],[O.x.SPECTRAL_PROFILER_SETTINGS_SMOOTHING,{title:"Spectral Profiler Settings",content:Object(S.jsx)(To,{})}],[O.x.SPECTRAL_PROFILER_SETTINGS_MOMENTS,{title:"Spectral Profiler Settings",content:Object(S.jsx)(vo,{})}],[O.x.STATS,{title:"Statistics",content:Object(S.jsx)(Po,{})}],[O.x.STOKES_ANALYSIS,{title:"Stokes Analysis",content:Object(S.jsx)(Mo,{})}],[O.x.STOKES_ANALYSIS_SETTINGS_CONVERSION,{title:"Stokes Settings",content:Object(S.jsx)(ko,{})}],[O.x.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING,{title:"Stokes Settings",content:Object(S.jsx)(Do,{})}],[O.x.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING,{title:"Stokes Settings",content:Object(S.jsx)(No,{})}],[O.x.STOKES_ANALYSIS_SETTINGS_SMOOTHING,{title:"Stokes Settings",content:Object(S.jsx)(Lo,{})}],[O.x.CATALOG_OVERLAY,{title:"Catalog Overlay",content:Object(S.jsx)(_o,{})}],[O.x.CATALOG_HISTOGRAM_PLOT,{title:"Catalog Histogram Plot",content:Object(S.jsx)(zo,{})}],[O.x.CATALOG_SCATTER_PLOT,{title:"Catalog Scatter Plot",content:Object(S.jsx)(Wo,{})}],[O.x.CATALOG_SETTINGS_GOLBAL,{title:"Catalog Settings",content:""}],[O.x.CATALOG_SETTINGS_OVERLAY,{title:"Catalog Settings",content:""}],[O.x.CATALOG_SETTINGS_COLOR,{title:"Catalog Settings",content:""}],[O.x.SPECTRAL_LINE_QUERY,{title:"Spectral Line Query",content:Object(S.jsx)(Ho,{})}]])}render(){let e="help-drawer";O.e.Instance.darkTheme&&(e+=" bp3-dark");const t=O.w.Instance,i={icon:"help",className:e,lazy:!0,isOpen:t.helpVisible,onClose:t.hideHelpDrawer,title:this.HELP_MAP.get(t.type)?this.HELP_MAP.get(t.type).title:"",position:t.position,size:"33%",hasBackdrop:!1};return Object(S.jsx)(b.n,{...i,children:Object(S.jsx)("div",{className:Oi.a.DRAWER_BODY,children:Object(S.jsx)("div",{className:Oi.a.DIALOG_BODY,children:this.HELP_MAP.get(t.type)?this.HELP_MAP.get(t.type).content:""})})})}})||Go;var Yo,Uo,Xo,$o,Ko,Qo,Zo,Jo,es,ts,is;i(892);let ns=Object(g.a)((is=ts=class e extends p.Component{static get WIDGET_CONFIG(){return{id:"catalog-plot",type:"catalog-plot",minWidth:320,minHeight:400,defaultWidth:600,defaultHeight:350,title:"Catalog Plot",isCloseable:!0,componentId:"catalog-plot-component"}}constructor(t){super(t),Object(u.a)(this,"width",Xo,this),Object(u.a)(this,"height",$o,this),Object(u.a)(this,"profileId",Ko,this),Object(u.a)(this,"catalogFileId",Qo,this),Object(u.a)(this,"componentId",Zo,this),this.plotType=void 0,this.histogramY=void 0,this.catalogFileNames=void 0,Object(u.a)(this,"onResize",Jo,this),Object(u.a)(this,"handleCatalogFileChange",es,this),this.addNewWidgetStore=()=>{const t=O.e.Instance,i=O.k.Instance;switch(this.plotType){case Qe.c.D2Scatter:const n={xColumnName:e.emptyColumn,yColumnName:e.emptyColumn,plotType:this.plotType},r=t.widgetsStore.addCatalogPlotWidget(n);return i.setCatalogPlots(this.componentId,this.catalogFileId,r),r;case Qe.c.Histogram:const o={xColumnName:e.emptyColumn,plotType:this.plotType},s=t.widgetsStore.addCatalogPlotWidget(o);return i.setCatalogPlots(this.componentId,this.catalogFileId,s),s;default:return}},this.handleColumnNameChange=(t,i)=>{const n=this.widgetStore;if("x"===t?n.setColumnX(i):"y"===t&&n.setColumnY(i),n.plotType===Qe.c.D2Scatter){if(n.xColumnName===e.emptyColumn||n.yColumnName===e.emptyColumn)return;n.setScatterborder(this.initScatterBorder)}else if(n.plotType===Qe.c.Histogram){if(i===e.emptyColumn)return;n.setHistogramXBorder(this.initHistogramXBorder)}},this.handleShowSelectedDataChanged=e=>{const t=this.widgetStore,i=this.catalogWidgetStore,n=e.target.checked;t&&i&&(i.setShowSelectedData(n),O.k.Instance.updateShowSelectedData(this.catalogFileId,n))},this.handleLogScaleYChanged=e=>{const t=e.target.checked;this.widgetStore.setLogScaleY(t)},this.onHover=e=>{const t=this.widgetStore,i=e.points;if(i.length&&t){const e=i[0];t.setIndicator({x:e.x,y:e.y})}},this.onDoubleClick=()=>{const e=this.widgetStore;e.plotType===Qe.c.D2Scatter?e.setScatterborder(this.initScatterBorder):e.setHistogramXBorder(this.initHistogramXBorder)},this.onRelayout=e=>{const t=this.widgetStore;if(t){if(e.dragmode&&t.setDragmode(e.dragmode),t.plotType===Qe.c.D2Scatter){const i=e["xaxis.range[0]"],n=e["xaxis.range[1]"],r=e["yaxis.range[0]"],o=e["yaxis.range[1]"];if(isFinite(i)||isFinite(r)){const e={xMin:isFinite(i)?i:t.scatterborder.xMin,xMax:isFinite(n)?n:t.scatterborder.xMax,yMin:isFinite(r)?r:t.scatterborder.yMin,yMax:isFinite(o)?o:t.scatterborder.yMax};t.setScatterborder(e)}e["xaxis.autorange"]&&e["yaxis.autorange"]&&t.setScatterborder(this.initScatterBorder)}if(t.plotType===Qe.c.Histogram){const i=e["xaxis.range[0]"],n=e["xaxis.range[1]"];if(isFinite(i)||isFinite(n)){const e={xMin:isFinite(i)?i:t.histogramBorder.xMin,xMax:isFinite(n)?n:t.histogramBorder.xMax};this.widgetStore.setHistogramXBorder(e)}e["xaxis.autorange"]&&t.setHistogramXBorder(this.initHistogramXBorder)}}},this.handlePlotClick=()=>{const e=O.e.Instance,t=this.profileStore;if(null===t||void 0===t?void 0:t.shouldUpdateData){t.setUpdateMode(O.m.PlotsUpdate),t.setUpdatingDataStream(!0);let i=t.updateRequestDataSize;e.sendCatalogFilter(i)}},this.onLassoSelected=e=>{if(e&&e.points&&e.points.length>0){var t;const i=O.k.Instance,n=this.profileStore,r=n.catalogInfo.fileId,o=this.catalogWidgetStore;let s;if(i.updateCatalogProfiles(r),this.widgetStore.plotType===Qe.c.D2Scatter){const t=e.points;s=Array(t.length);for(let e=0;e<t.length;e++)s[e]=t[e].pointIndex}else if(this.widgetStore.plotType===Qe.c.Histogram){const t=e.points;let i=0;for(let e=0;e<t.length;e++){i+=t[e].pointIndices.length}s=Array(i);for(let e=0;e<t.length;e++){const i=t[e].pointIndices,n=i.length;for(let t=0;t<n;t++)s[e*n+t]=i[t]}}(null===(t=s)||void 0===t?void 0:t.length)&&(n.setSelectedPointIndices(s,!0),o.setCatalogTableAutoScroll(!0))}},this.onDeselect=()=>{const e=O.k.Instance,t=this.profileStore,i=this.catalogWidgetStore;e.updateCatalogProfiles(this.catalogFileId),t.setSelectedPointIndices([],!1),i.setCatalogTableAutoScroll(!1),i.setShowSelectedData(!1),e.updateShowSelectedData(this.catalogFileId,!1)},this.onSingleSourceClick=e=>{var t;const i=["select","lasso"].includes(this.widgetStore.dragmode),n=this.profileStore,r=this.catalogWidgetStore;if((null===e||void 0===e||null===(t=e.points)||void 0===t?void 0:t.length)>0&&i){const t=O.k.Instance,i=n.catalogInfo.fileId;t.updateCatalogProfiles(i);let o=[];const s=e.points[0];this.widgetStore.plotType===Qe.c.D2Scatter?o.push(s.pointIndex):this.widgetStore.plotType===Qe.c.Histogram&&s.pointIndices.length&&(o=s.pointIndices),n.setSelectedPointIndices(o,!0),r.setCatalogTableAutoScroll(!0)}},this.renderColumnNamePopOver=(e,t)=>Object(S.jsx)(b.B,{text:e,onClick:t.handleClick,active:t.modifiers.active},e),this.filterColumn=(e,t)=>new xn.a([t]).search(e).length>0,this.updateHistogramYrange=(e,t)=>{if(this.widgetStore.plotType===Qe.c.Histogram){const t=e.layout.yaxis.range;this.histogramY={yMin:t[0],yMax:t[1]}}},this.onNumBinChange=e=>{this.widgetStore.setNumBinsX(e),this.onDeselect()},this.renderFilePopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return Object(S.jsx)(b.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},e)},Object(f.p)(this),this.histogramY={yMin:void 0,yMax:void 0};const i=O.k.Instance.getAssociatedIdByWidgetId(this.props.id);this.componentId=i.catalogPlotComponentId,this.catalogFileId=i.catalogFileId,this.catalogFileNames=new Map,Object(f.h)((()=>{const e=this.profileStore,t=this.widgetStore,i=O.k.Instance.activeCatalogFiles;if(!(null===i||void 0===i?void 0:i.includes(this.catalogFileId))&&(null===i||void 0===i?void 0:i.length)>0&&(this.catalogFileId=i[0]),t&&(this.plotType=t.plotType),e){let t="";const n=e.catalogInfo.fileInfo.name||"",r=O.e.Instance.activeFrame,o=e.progress;o&&isFinite(o)&&o<1&&(t=`[${Object(D.mb)(100*o)}% complete]`),r&&(null===i||void 0===i?void 0:i.length)?O.U.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType} : ${n} ${t}`):O.U.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType}`)}else O.U.Instance.setWidgetTitle(this.props.id,`Catalog ${this.plotType}`)}))}get widgetStore(){const e=O.k.Instance.catalogPlots.get(this.componentId);if(!e)return;let t=e.get(this.catalogFileId);t||(t=this.addNewWidgetStore());return O.U.Instance.catalogPlotWidgets.get(t)}get profileStore(){return O.k.Instance.catalogProfileStores.get(this.catalogFileId)}get catalogWidgetStore(){const e=O.k.Instance.catalogWidgets.get(this.catalogFileId);return O.U.Instance.catalogWidgets.get(e)}getScatterBorder(e,t){const i=Object(D.U)(e),n=Object(D.U)(t);return{xMin:i.minVal,xMax:i.maxVal,yMin:n.minVal,yMax:n.maxVal}}getHistogramXBorder(e){const t=Object(D.U)(e);return{xMin:t.minVal,xMax:t.maxVal}}get initScatterBorder(){const e=this.widgetStore,t=this.profileStore,i=t.get2DPlotData(e.xColumnName,e.yColumnName,t.catalogData);return this.getScatterBorder(i.wcsX,i.wcsY)}get initHistogramXBorder(){const e=this.widgetStore,t=this.profileStore.get1DPlotData(e.xColumnName);return this.getHistogramXBorder(t.wcsData)}get scatterData(){var e,t;const i=this.widgetStore,n=this.profileStore,r=n.get2DPlotData(i.xColumnName,i.yColumnName,n.catalogData);let o=[],s={type:"scattergl",mode:"markers"};s.marker={symbol:"circle",color:ae.a.BLUE2,opacity:1},s.hoverinfo="none",s.x=null===(e=r.wcsX)||void 0===e?void 0:e.slice(0),s.y=null===(t=r.wcsY)||void 0===t?void 0:t.slice(0),o.push(s);return{data:o,border:this.getScatterBorder(r.wcsX,r.wcsY)}}get histogramData(){var e;const t=this.widgetStore,i=this.profileStore.get1DPlotData(t.xColumnName);let n=[],r={};const o=this.getHistogramXBorder(i.wcsData),s=o.xMin,a=t.nBinx?t.nBinx:this.numBinsX,l=s+1.001*(o.xMax-o.xMin),c=(l-s)/a;return r.type="histogram",r.hoverinfo="none",r.x=null===(e=i.wcsData)||void 0===e?void 0:e.slice(0),r.marker={color:ae.a.BLUE2},r.xbins={start:s,size:c,end:l},n.push(r),{data:n,border:o}}get enablePlotButton(){const t=e.emptyColumn,i=this.profileStore,n=this.widgetStore;return(null===n||void 0===n?void 0:n.plotType)===Qe.c.Histogram?n.xColumnName!==t&&!i.loadingData&&!i.updatingDataStream:(null===n||void 0===n?void 0:n.plotType)===Qe.c.D2Scatter&&(n.xColumnName!==t&&n.yColumnName!==t&&!i.loadingData&&!i.updatingDataStream)}get genProfilerInfo(){let e=[];const t=this.widgetStore,i=t.indicatorInfo;return i&&(t.plotType===Qe.c.D2Scatter?e.push(`${t.xColumnName}: ${i.x}, ${t.yColumnName}: ${i.y}`):t.plotType===Qe.c.Histogram&&e.push(`${t.xColumnName}: ${i.x}, Count: ${i.y}`)),e}get numBinsX(){var e;const t=this.widgetStore,i=this.profileStore.get1DPlotData(t.xColumnName);return Math.ceil(Math.sqrt(null===(e=i.wcsData)||void 0===e?void 0:e.length))}render(){const t=this.profileStore,i=this.widgetStore,n=this.catalogWidgetStore,r=O.k.Instance.activeCatalogFiles,o=1/devicePixelRatio;if(!i||!t||!n||void 0===r||0===(null===r||void 0===r?void 0:r.length))return Object(S.jsxs)("div",{className:"catalog-plot",children:[Object(S.jsx)(b.C,{icon:"folder-open",title:"No catalog file loaded",description:"Load a catalog file using the menu"}),";"]});const s=t.displayedColumnHeaders,a=[e.emptyColumn],l=!this.enablePlotButton,c=this.plotType===Qe.c.D2Scatter,d=this.plotType===Qe.c.Histogram,u=c?devicePixelRatio:1,h="'Helvetica Neue', 'Helvetica', 'Arial', sans-serif";let p=ae.a.LIGHT_GRAY5,g=ae.a.GRAY1,f=ae.a.LIGHT_GRAY1,m=ae.a.GRAY2,x="catalog-plotly",C=[];r.forEach((e=>{C.push(e)})),this.catalogFileNames=O.k.Instance.getCatalogFileNames(r);for(let b=0;b<s.length;b++){const t=s[b];e.UnsupportedDataTypes.includes(t.dataType)||a.push(t.name)}const I=Object(S.jsx)(b.B,{disabled:!0,text:"No results"}),w=Object(S.jsx)(b.p,{inline:!0,label:"File",children:Object(S.jsx)(M.a,{className:"bp3-fill",filterable:!1,items:C,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFilePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},children:Object(S.jsx)(b.e,{text:this.catalogFileId,rightIcon:"double-caret-vertical"})})}),T=Object(S.jsx)(b.p,{inline:!0,label:"X",children:Object(S.jsx)(M.a,{className:"bp3-fill",items:a,activeItem:i.xColumnName,onItemSelect:e=>this.handleColumnNameChange("x",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},filterable:!0,noResults:I,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(S.jsx)(b.e,{text:i.xColumnName,rightIcon:"double-caret-vertical"})})}),v=Object(S.jsx)(b.p,{label:"Log Scale",inline:!0,disabled:l,children:Object(S.jsx)(b.P,{checked:i.logScaleY,onChange:this.handleLogScaleYChanged,disabled:l})}),A=Object(S.jsx)(b.p,{inline:!0,label:"Y",children:Object(S.jsx)(M.a,{className:"bp3-fill",items:a,activeItem:i.yColumnName,onItemSelect:e=>this.handleColumnNameChange("y",e),itemRenderer:this.renderColumnNamePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},filterable:!0,noResults:I,itemPredicate:this.filterColumn,resetOnSelect:!0,children:Object(S.jsx)(b.e,{text:i.yColumnName,rightIcon:"double-caret-vertical"})})});if(i.xColumnName===e.emptyColumn||i.yColumnName===e.emptyColumn)return Object(S.jsxs)("div",{className:"catalog-plot",children:[Object(S.jsxs)("div",{className:"catalog-plot-option",children:[w,T,c&&A]}),Object(S.jsx)(b.C,{className:"non-ideal-state",icon:"folder-open",title:"No column selected",description:"Please select columns"}),";"]});O.e.Instance.darkTheme&&(f=ae.a.DARK_GRAY5,g=ae.a.LIGHT_GRAY5,p=ae.a.DARK_GRAY3,m=ae.a.GRAY4,x="catalog-plotly-dark");let R,P={width:this.width*u,height:(this.height-85)*u,paper_bgcolor:p,plot_bgcolor:p,hovermode:"closest",xaxis:{title:i.xColumnName,titlefont:{family:h,size:12*u,color:g},showticklabels:!0,tickfont:{family:h,size:12*u,color:g},tickcolor:f,gridcolor:f,zerolinecolor:f,zerolinewidth:2*u,mirror:!0,linecolor:f,showline:!0,spikemode:"across",spikedash:"solid",spikecolor:m,spikethickness:1*u,tickformat:".2e"},yaxis:{titlefont:{family:h,size:12*u,color:g},showticklabels:!0,tickfont:{family:h,size:12*u,color:g},tickcolor:f,gridcolor:f,zerolinecolor:f,zerolinewidth:2*u,mirror:!0,linecolor:f,showline:!0,spikemode:"across",spikedash:"solid",spikecolor:m,spikethickness:1*u},margin:{t:5*u,b:40*u,l:80*u,r:5*u,pad:0},showlegend:!1,dragmode:i.dragmode};if(i.plotType===Qe.c.D2Scatter){let e;R=this.scatterData.data,R[0].marker.size=5*u,e=i.isScatterAutoScaled?this.scatterData.border:i.scatterborder,P.xaxis.range=[e.xMin,e.xMax],P.yaxis.range=[e.yMin,e.yMax],P.yaxis.title=i.yColumnName,P.yaxis.tickformat=".2e",P.hoverdistance=5}else{var E,F;let e;R=this.histogramData.data,e=i.isHistogramAutoScaledX?this.histogramData.border:i.histogramBorder,P.xaxis.range=[e.xMin,e.xMax],P.yaxis.range=[null===(E=this.histogramY)||void 0===E?void 0:E.yMin,null===(F=this.histogramY)||void 0===F?void 0:F.yMax],P.yaxis.fixedrange=!0,P.yaxis.autorange=!0,P.yaxis.rangemode="tozero",P.yaxis.title="Count",i.logScaleY&&(P.yaxis.type="log")}const k=t.selectedPointIndices;let D=R[0].marker;k.length>0?(R[0].selectedpoints=k,R[0].selected={marker:{color:ae.a.RED2}},R[0].unselected={marker:{opacity:.5}}):(R[0].selectedpoints=[],D.color=ae.a.BLUE2,R[0].unselected={marker:{opacity:1}});const N=Object(S.jsx)(j.b,{className:"catalog-bins",label:"Bins",min:1,integerOnly:!0,value:i.nBinx?i.nBinx:this.numBinsX,onValueChanged:e=>this.onNumBinChange(e),onValueCleared:()=>this.onNumBinChange(this.numBinsX),displayExponential:!1,updateValueOnKeyDown:!0,disabled:l});return Object(S.jsxs)("div",{className:"catalog-plot",children:[Object(S.jsxs)("div",{className:"catalog-plot-option",children:[w,T,d&&N,d&&v,c&&A]}),Object(S.jsx)("div",{className:`${x} ${c&&devicePixelRatio>1?"catalog-scatter":""}`,children:Object(S.jsx)(Ke.a,{data:R,layout:P,config:{displaylogo:!1,scrollZoom:!0,showTips:!1,doubleClick:!1,showAxisDragHandles:!1,modeBarButtonsToRemove:["zoomIn2d","zoomOut2d","resetScale2d","toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]},onHover:this.onHover,onDoubleClick:this.onDoubleClick,onRelayout:this.onRelayout,onSelected:this.onLassoSelected,onDeselect:this.onDeselect,onClick:this.onSingleSourceClick,onInitialized:this.updateHistogramYrange,onUpdate:this.updateHistogramYrange,style:{transform:c?`scale(${o})`:"scale(1)",transformOrigin:"top left"}})}),Object(S.jsxs)("div",{className:"catalog-plot-footer",children:[Object(S.jsx)("div",{className:"scatter-info",children:Object(S.jsx)(j.l,{info:this.genProfilerInfo})}),Object(S.jsxs)("div",{className:"actions",children:[Object(S.jsx)(b.p,{label:"Show only selected sources",inline:!0,disabled:l,children:Object(S.jsx)(b.P,{checked:n.showSelectedData,onChange:this.handleShowSelectedDataChanged,disabled:l})}),Object(S.jsx)(b.W,{className:"plot-button",content:"Update plots with data",children:Object(S.jsx)(b.b,{intent:yi.a.PRIMARY,text:"Plot All",onClick:this.handlePlotClick,disabled:l})})]})]}),Object(S.jsx)(y.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize,refreshMode:"throttle",refreshRate:33})]})}},ts.emptyColumn="None",ts.UnsupportedDataTypes=[ne.a.ColumnType.String,ne.a.ColumnType.Bool,ne.a.ColumnType.UnsupportedType],Uo=is,Xo=Object(h.a)(Uo.prototype,"width",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$o=Object(h.a)(Uo.prototype,"height",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=Object(h.a)(Uo.prototype,"profileId",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=Object(h.a)(Uo.prototype,"catalogFileId",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zo=Object(h.a)(Uo.prototype,"componentId",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jo=Object(h.a)(Uo.prototype,"onResize",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),Object(h.a)(Uo.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"widgetStore"),Uo.prototype),Object(h.a)(Uo.prototype,"profileStore",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"profileStore"),Uo.prototype),Object(h.a)(Uo.prototype,"catalogWidgetStore",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"catalogWidgetStore"),Uo.prototype),es=Object(h.a)(Uo.prototype,"handleCatalogFileChange",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.catalogFileId=e;const t=O.U.Instance,i=O.k.Instance,n=i.catalogPlots.get(this.componentId).get(e);if(n){const e=t.catalogPlotWidgets.get(n),r=i.catalogProfileStores.get(this.catalogFileId),o=e.xColumnName===ns.emptyColumn,s=e.yColumnName===ns.emptyColumn;switch(e.plotType){case Qe.c.D2Scatter:if(!o&&!s&&void 0===e.scatterborder){const t=r.get2DPlotData(e.xColumnName,e.yColumnName,r.catalogData),i=this.getScatterBorder(t.wcsX,t.wcsY);e.setScatterborder(i)}break;case Qe.c.Histogram:if(!o&&void 0===e.histogramBorder){const t=r.get1DPlotData(e.xColumnName),i=this.getHistogramXBorder(t.wcsData);e.setHistogramXBorder(i)}}}else this.addNewWidgetStore()}}}),Object(h.a)(Uo.prototype,"initScatterBorder",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"initScatterBorder"),Uo.prototype),Object(h.a)(Uo.prototype,"initHistogramXBorder",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"initHistogramXBorder"),Uo.prototype),Object(h.a)(Uo.prototype,"scatterData",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"scatterData"),Uo.prototype),Object(h.a)(Uo.prototype,"histogramData",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"histogramData"),Uo.prototype),Object(h.a)(Uo.prototype,"enablePlotButton",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"enablePlotButton"),Uo.prototype),Object(h.a)(Uo.prototype,"genProfilerInfo",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"genProfilerInfo"),Uo.prototype),Object(h.a)(Uo.prototype,"numBinsX",[f.i],Object.getOwnPropertyDescriptor(Uo.prototype,"numBinsX"),Uo.prototype),Yo=Uo))||Yo;var rs,os,ss;i(893);const as=(e,t,i,n=2,r=16)=>{let o=t;return i||(o="none"),Object(S.jsx)("span",{className:"bp3-icon",children:Object(S.jsx)("svg",{"data-icon":"triangle-up-open",width:"16",height:"16",viewBox:`0 0 ${r} ${r}`,style:{stroke:t,fill:o,strokeWidth:n},children:e})})},ls=Object(S.jsx)("path",{d:"M 2 14 L 14 14 L 8 3 Z"}),cs=Object(S.jsx)("path",{d:"M 2 2 L 14 2 L 8 13 Z"}),ds=Object(S.jsx)("path",{d:"M 8 14 L 14 8 L 8 2 L 2 8 Z"}),us=Object(S.jsx)("path",{d:"M 12.33 5.5 L 12.33 10.5 L 8 13 L 3.67 10.5 L 3.67 5.5 L 8 3 Z"}),hs=Object(S.jsx)("path",{d:"M 3 8 L 5.5 3.67 L 10.5 3.67 L 13 8 L 10.5 12.33 L 5.5 12.33 Z"});let ps=Object(g.a)((os=class extends p.Component{static get WIDGET_CONFIG(){return{id:"catalog-overlay-floating-settings",type:"floating-settings",minWidth:350,minHeight:225,defaultWidth:375,defaultHeight:375,title:"catalog-overlay-settings",isCloseable:!0,parentId:"catalog-overlay",parentType:"catalog-overlay",helpType:[O.x.CATALOG_SETTINGS_GOLBAL,O.x.CATALOG_SETTINGS_OVERLAY,O.x.CATALOG_SETTINGS_COLOR]}}get widgetStore(){const e=O.k.Instance.catalogWidgets.get(this.catalogFileId);return O.U.Instance.catalogWidgets.get(e)}get catalogFileId(){var e;return null===(e=O.k.Instance.catalogProfiles)||void 0===e?void 0:e.get(this.props.id)}constructor(e){super(e),this.catalogFileNames=void 0,Object(u.a)(this,"handleCatalogFileChange",ss,this),this.renderFileIdPopOver=(e,t)=>{let i=`${e}: ${this.catalogFileNames.get(e)}`;return Object(S.jsx)(b.B,{text:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.renderShapePopOver=(e,t)=>{const i=this.getCatalogShape(e);return Object(S.jsx)(b.B,{icon:i,onClick:t.handleClick,active:t.modifiers.active},e)},this.handleSelectedTabChanged=e=>{this.widgetStore.setSettingsTabId(Number.parseInt(e.toString()))},this.getCatalogShape=e=>{let t=this.widgetStore.catalogColor;switch(e){case Qe.b.Circle:return Object(S.jsx)(b.w,{icon:"circle",color:t});case Qe.b.FullCircle:return Object(S.jsx)(b.w,{icon:"full-circle",color:t});case Qe.b.Star:return Object(S.jsx)(b.w,{icon:"star-empty",color:t});case Qe.b.FullStar:return Object(S.jsx)(b.w,{icon:"star",color:t});case Qe.b.Square:return Object(S.jsx)(b.w,{icon:"square",color:t});case Qe.b.Plus:return Object(S.jsx)(b.w,{icon:"plus",color:t});case Qe.b.Cross:return Object(S.jsx)(b.w,{icon:"cross",color:t});case Qe.b.TriangleUp:return as(ls,t,!1);case Qe.b.TriangleDown:return as(cs,t,!1);case Qe.b.Diamond:return as(ds,t,!1);case Qe.b.hexagon:return as(us,t,!1);case Qe.b.hexagon2:return as(hs,t,!1);default:return Object(S.jsx)(b.w,{icon:"circle",color:t})}},Object(f.p)(this);const t=O.e.Instance;this.catalogFileNames=new Map,Object(f.h)((()=>{const e=O.k.Instance,i=e.catalogWidgets.get(this.catalogFileId),n=e.activeCatalogFiles;if(i||O.U.Instance.addCatalogWidget(this.catalogFileId),null===n||void 0===n?void 0:n.includes(this.catalogFileId)){const i=e.getCatalogFileNames([this.catalogFileId]).get(this.catalogFileId);i&&t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,`Catalog Settings: ${i}`)}else t.widgetsStore.setWidgetTitle(this.props.floatingSettingsId,"Catalog Settings")}))}render(){const e=O.e.Instance,t=this.widgetStore,i=O.k.Instance.activeCatalogFiles;let n=[];i.forEach((e=>{n.push(e)})),this.catalogFileNames=O.k.Instance.getCatalogFileNames(i);const r=this.catalogFileNames.get(this.catalogFileId);let o="";void 0!==r&&(o=`${this.catalogFileId}: ${r}`);const s=i.length<=0,a=Object(S.jsx)("div",{className:"panel-container",children:Object(S.jsx)(b.p,{inline:!0,label:"Displayed columns",children:Object(S.jsx)(j.n,{placeholder:"Default Displayed Columns",min:1,value:O.H.Instance.catalogDisplayedColumnSize,stepSize:1,onValueChange:e=>O.H.Instance.setPreference(O.G.CATALOG_DISPLAYED_COLUMN_SIZE,e)})})}),l=Object(S.jsxs)("div",{className:"panel-container",children:[Object(S.jsx)(b.p,{className:"file-menu",inline:!0,label:"File",disabled:s,children:Object(S.jsx)(M.a,{className:"bp3-fill",disabled:s,filterable:!1,items:n,activeItem:this.catalogFileId,onItemSelect:this.handleCatalogFileChange,itemRenderer:this.renderFileIdPopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},children:Object(S.jsx)(b.e,{text:o,rightIcon:"double-caret-vertical",disabled:s})})}),Object(S.jsx)(b.p,{label:"Color",inline:!0,disabled:s,children:Object(S.jsx)(j.c,{color:t.catalogColor,presetColors:[...D.e,"transparent"],setColor:e=>{t.setCatalogColor("transparent"===e.hex?"#000000":e.hex)},disableAlpha:!0,darkTheme:e.darkTheme,disabled:s})}),Object(S.jsx)(b.p,{label:"Overlay Highlight",inline:!0,disabled:s,children:Object(S.jsx)(j.c,{color:t.highlightColor,presetColors:[...D.e,"transparent"],setColor:e=>{t.setHighlightColor("transparent"===e.hex?"#000000":e.hex)},disableAlpha:!0,darkTheme:e.darkTheme,disabled:s})}),Object(S.jsx)(b.p,{inline:!0,label:"Shape",disabled:s,children:Object(S.jsx)(M.a,{className:"bp3-fill",disabled:s,filterable:!1,items:Object.values(Qe.b),activeItem:t.catalogShape,onItemSelect:e=>t.setCatalogShape(e),itemRenderer:this.renderShapePopOver,popoverProps:{popoverClassName:"catalog-select",minimal:!0,position:b.H.AUTO_END},children:Object(S.jsx)(b.e,{icon:this.getCatalogShape(t.catalogShape),rightIcon:"double-caret-vertical",disabled:s})})}),Object(S.jsx)(b.p,{inline:!0,label:"Size",labelInfo:"(px)",disabled:s,children:Object(S.jsx)(j.n,{placeholder:"Catalog Size",disabled:s,min:Qe.f.MinOverlaySize,max:Qe.f.MaxOverlaySize,value:t.catalogSize,stepSize:1,onValueChange:e=>t.setCatalogSize(e)})})]});let c="catalog-settings";return e.darkTheme&&(c+=" bp3-dark"),Object(S.jsx)("div",{className:c,children:Object(S.jsxs)(b.R,{id:"catalogSettings",vertical:!1,selectedTabId:t.settingsTabId,onChange:e=>this.handleSelectedTabChanged(e),children:[Object(S.jsx)(b.Q,{id:Qe.e.GLOBAL,title:"Global",panel:a}),Object(S.jsx)(b.Q,{id:Qe.e.IMAGE_OVERLAY,title:"Image Overlay",panel:l,disabled:s})]})})}},Object(h.a)(os.prototype,"widgetStore",[f.i],Object.getOwnPropertyDescriptor(os.prototype,"widgetStore"),os.prototype),Object(h.a)(os.prototype,"catalogFileId",[f.i],Object.getOwnPropertyDescriptor(os.prototype,"catalogFileId"),os.prototype),ss=Object(h.a)(os.prototype,"handleCatalogFileChange",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{O.k.Instance.catalogProfiles.set(this.props.id,e)}}}),rs=os))||rs},144:function(e,t,i){"use strict";i.d(t,"b",(function(){return Fe})),i.d(t,"a",(function(){return ke}));var n,r,o,s,a,l,c,d,u,h,p,g,f,b,m,y,O,j,S,x,C,I,w,T,v,A,R,P,E,F,M,k,D,N,L,_,z,W,G,V,B,H,q,Y,U,X,$,K,Q,Z,J,ee,te,ie,ne,re,oe,se,ae,le,ce,de,ue,he,pe,ge,fe,be,me,ye,Oe,je=i(4),Se=i(2),xe=(i(28),i(1)),Ce=i(74),Ie=i(6),we=i(8),Te=i(62),ve=i(7),Ae=i(43),Re=i.n(Ae),Pe=i(123),Ee=i(13);let Fe;!function(e){e.CurrentZ="z",e.TotalIntensity="Iz",e.LinearPolarizationQ="Qz",e.LinearPolarizationU="Uz",e.CircularPolarization="Vz",e.PolarizedIntensity="PIz",e.PolarizationAngle="PAz",e.PolarizationQU="QvsU"}(Fe||(Fe={}));const Me={fractionalPolVisible:!1,scatterOutRangePointsZIndex:[],primaryLineColor:{colorHex:Ce.a.BLUE2,fixed:!1},secondaryLineColor:{colorHex:Ce.a.ORANGE2,fixed:!1},lineWidth:1,linePlotPointSize:1.5,scatterPlotPointSize:3,equalAxes:!0,colorMap:"jet",pointTransparency:1,invertedColorMap:!1};let ke=(Oe=ye=class e extends Te.c{static requiredCoordinate(t){let i=e.requestDataType,n=i.indexOf(Fe.TotalIntensity);return t.fractionalPolVisible&&n<0&&i.push(Fe.TotalIntensity),i}static addToRequirementsMap(t,i){return i.forEach((i=>{const n=i.effectiveFrame;if(n&&n.hasStokes){const r=n.frameInfo.fileId,o=i.effectiveRegionId,s=e.requiredCoordinate(i);let a=i.statsType;if(!n.regionSet)return;const l=n.regionSet.regions.find((e=>e.regionId===o));if(l){l.regionType===Ie.a.RegionType.POINT&&(a=Ie.a.StatsType.Sum);let e=t.get(r);e||(e=new Map,t.set(r,e));let i=e.get(o);i||(i=new Ie.a.SetSpectralRequirements({regionId:o,fileId:r}),e.set(o,i)),i.spectralProfiles||(i.spectralProfiles=[]),s.forEach((e=>{let t=i.spectralProfiles.find((t=>t.coordinate===e));t?-1===t.statsTypes.indexOf(a)&&t.statsTypes.push(a):i.spectralProfiles.push({coordinate:e,statsTypes:[a]})}))}}})),t}setRegionId(e,t){this.regionIdMap.set(e,t),this.clearLinePlotsXYBounds(),this.clearScatterPlotXYBounds()}constructor(){super(Te.d.CLOSED_AND_POINT),Object(je.a)(this,"sharedMinX",r,this),Object(je.a)(this,"sharedMaxX",o,this),Object(je.a)(this,"quMinY",s,this),Object(je.a)(this,"quMaxY",a,this),Object(je.a)(this,"polIntensityMinY",l,this),Object(je.a)(this,"polIntensityMaxY",c,this),Object(je.a)(this,"polAngleMinY",d,this),Object(je.a)(this,"polAngleMaxY",u,this),Object(je.a)(this,"quScatterMinX",h,this),Object(je.a)(this,"quScatterMaxX",p,this),Object(je.a)(this,"quScatterMinY",g,this),Object(je.a)(this,"quScatterMaxY",f,this),Object(je.a)(this,"linePlotcursorX",b,this),Object(je.a)(this,"channel",m,this),Object(je.a)(this,"scatterPlotCursorX",y,this),Object(je.a)(this,"scatterPlotCursorY",O,this),Object(je.a)(this,"isMouseMoveIntoScatterPlots",j,this),Object(je.a)(this,"isMouseMoveIntoLinePlots",S,this),Object(je.a)(this,"scatterChartArea",x,this),Object(je.a)(this,"statsType",C,this),Object(je.a)(this,"fractionalPolVisible",I,this),this.scatterOutRangePointsZIndex=void 0,Object(je.a)(this,"plotType",w,this),Object(je.a)(this,"primaryLineColor",T,this),Object(je.a)(this,"secondaryLineColor",v,this),Object(je.a)(this,"lineWidth",A,this),Object(je.a)(this,"linePlotPointSize",R,this),Object(je.a)(this,"scatterPlotPointSize",P,this),Object(je.a)(this,"equalAxes",E,this),Object(je.a)(this,"colorMap",F,this),Object(je.a)(this,"colorPixel",M,this),Object(je.a)(this,"pointTransparency",k,this),Object(je.a)(this,"invertedColorMap",D,this),this.smoothingStore=void 0,Object(je.a)(this,"settingsTabId",N,this),Object(je.a)(this,"setScatterChartAres",L,this),Object(je.a)(this,"setMouseMoveIntoScatterPlots",_,this),Object(je.a)(this,"setMouseMoveIntoLinePlots",z,this),Object(je.a)(this,"setStatsType",W,this),Object(je.a)(this,"setSpectralCoordinate",G,this),Object(je.a)(this,"setSpectralSystem",V,this),Object(je.a)(this,"setSharedXBounds",B,this),Object(je.a)(this,"clearSharedXBounds",H,this),Object(je.a)(this,"setPolIntensityYBounds",q,this),Object(je.a)(this,"clearPolIntensityYBounds",Y,this),Object(je.a)(this,"setChannel",U,this),Object(je.a)(this,"setlinePlotCursorX",X,this),Object(je.a)(this,"setScatterPlotCursor",$,this),Object(je.a)(this,"setFractionalPolVisible",K,this),Object(je.a)(this,"setQUScatterPlotXBounds",Q,this),Object(je.a)(this,"setPolAngleYBounds",Z,this),Object(je.a)(this,"setQULinePlotYBounds",J,this),Object(je.a)(this,"setQUScatterPlotYBounds",ee,this),Object(je.a)(this,"clearLinePlotsXYBounds",te,this),Object(je.a)(this,"clearScatterPlotXYBounds",ie,this),Object(je.a)(this,"setQULinePlotsXYBounds",ne,this),Object(je.a)(this,"setPolIntensityXYBounds",re,this),Object(je.a)(this,"setPolAngleXYBounds",oe,this),Object(je.a)(this,"setQUScatterPlotXYBounds",se,this),Object(je.a)(this,"setInvertedColorMap",ae,this),Object(je.a)(this,"setPlotType",le,this),Object(je.a)(this,"setPrimaryLineColor",ce,this),Object(je.a)(this,"setSecondaryLineColor",de,this),Object(je.a)(this,"setLineWidth",ue,this),Object(je.a)(this,"setLinePlotPointSize",he,this),Object(je.a)(this,"setScatterPlotPointSize",pe,this),Object(je.a)(this,"setEqualAxesValue",ge,this),Object(je.a)(this,"setColormap",fe,this),Object(je.a)(this,"setPointTransparency",be,this),Object(je.a)(this,"setSettingsTabId",me,this),this.init=e=>{if(!e)return;const t=Re()(e.primaryLineColor);t.isValid()&&(this.primaryLineColor.colorHex=t.toHexString());const i=Re()(e.secondaryLineColor);i.isValid()&&(this.secondaryLineColor.colorHex=i.toHexString()),"number"===typeof e.lineWidth&&e.lineWidth>=we.i.MIN_WIDTH&&e.lineWidth<=we.i.MAX_WIDTH&&(this.lineWidth=e.lineWidth),"number"===typeof e.linePlotPointSize&&e.linePlotPointSize>=we.i.MIN_POINT_SIZE&&e.linePlotPointSize<=we.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e.linePlotPointSize),"string"!==typeof e.plotType||e.plotType!==we.j.STEPS&&e.plotType!==we.j.LINES&&e.plotType!==we.j.POINTS||(this.plotType=e.plotType),"string"===typeof e.colorMap&&(this.colorMap=e.colorMap),"number"===typeof e.scatterPlotPointSize&&e.scatterPlotPointSize>=we.r.MIN_POINT_SIZE&&e.scatterPlotPointSize<=we.r.MAX_POINT_SIZE&&(this.scatterPlotPointSize=e.scatterPlotPointSize),"number"===typeof e.pointTransparency&&e.pointTransparency>=we.r.MIN_TRANSPARENCY&&e.pointTransparency<=we.r.MAX_TRANSPARENCY&&(this.pointTransparency=e.pointTransparency),"boolean"===typeof e.equalAxes&&(this.equalAxes=e.equalAxes)},this.toConfig=()=>({primaryLineColor:this.primaryLineColor.colorHex,secondaryLineColor:this.secondaryLineColor.colorHex,lineWidth:this.lineWidth,linePlotPointSize:this.linePlotPointSize,plotType:this.plotType,colorMap:this.colorMap,scatterPlotPointSize:this.scatterPlotPointSize,pointTransparency:this.pointTransparency,equalAxes:this.equalAxes}),Object(xe.p)(this),this.colorMap=Me.colorMap,this.colorPixel=Object(ve.A)(Me.colorMap),this.statsType=Ie.a.StatsType.Mean,this.plotType=we.j.STEPS,this.fractionalPolVisible=Me.fractionalPolVisible,this.scatterOutRangePointsZIndex=Me.scatterOutRangePointsZIndex,this.primaryLineColor=Me.primaryLineColor,this.secondaryLineColor=Me.secondaryLineColor,this.lineWidth=Me.lineWidth,this.linePlotPointSize=Me.linePlotPointSize,this.scatterPlotPointSize=Me.scatterPlotPointSize,this.equalAxes=Me.equalAxes,this.pointTransparency=Me.pointTransparency,this.smoothingStore=new Pe.a,this.settingsTabId=Ee.G.CONVERSION,this.invertedColorMap=Me.invertedColorMap}get isLinePlotsAutoScaledX(){return void 0===this.sharedMinX||void 0===this.sharedMaxX}get isQUScatterPlotAutoScaledX(){return void 0===this.quScatterMinX||void 0===this.quScatterMaxX}get isQUScatterPlotAutoScaledY(){return void 0===this.quScatterMinY||void 0===this.quScatterMaxY}get isQULinePlotAutoScaledY(){return void 0===this.quMinY||void 0===this.quMaxY}get isPolIntensityAutoScaledY(){return void 0===this.polIntensityMinY||void 0===this.polIntensityMaxY}get isPolAngleAutoScaledY(){return void 0===this.polAngleMinY||void 0===this.polAngleMaxY}},ye.requestDataType=[Fe.LinearPolarizationQ,Fe.LinearPolarizationU],ye.ValidStatsTypes=[Ie.a.StatsType.Mean],n=Oe,r=Object(Se.a)(n.prototype,"sharedMinX",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(Se.a)(n.prototype,"sharedMaxX",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(Se.a)(n.prototype,"quMinY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(Se.a)(n.prototype,"quMaxY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(Se.a)(n.prototype,"polIntensityMinY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(Se.a)(n.prototype,"polIntensityMaxY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(Se.a)(n.prototype,"polAngleMinY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(Se.a)(n.prototype,"polAngleMaxY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(Se.a)(n.prototype,"quScatterMinX",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(Se.a)(n.prototype,"quScatterMaxX",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(Se.a)(n.prototype,"quScatterMinY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(Se.a)(n.prototype,"quScatterMaxY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(Se.a)(n.prototype,"linePlotcursorX",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(Se.a)(n.prototype,"channel",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(Se.a)(n.prototype,"scatterPlotCursorX",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(Se.a)(n.prototype,"scatterPlotCursorY",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(Se.a)(n.prototype,"isMouseMoveIntoScatterPlots",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Object(Se.a)(n.prototype,"isMouseMoveIntoLinePlots",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=Object(Se.a)(n.prototype,"scatterChartArea",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(Se.a)(n.prototype,"statsType",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(Se.a)(n.prototype,"fractionalPolVisible",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Object(Se.a)(n.prototype,"plotType",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(Se.a)(n.prototype,"primaryLineColor",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Object(Se.a)(n.prototype,"secondaryLineColor",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(Se.a)(n.prototype,"lineWidth",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(Se.a)(n.prototype,"linePlotPointSize",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(Se.a)(n.prototype,"scatterPlotPointSize",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(Se.a)(n.prototype,"equalAxes",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(Se.a)(n.prototype,"colorMap",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(Se.a)(n.prototype,"colorPixel",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(Se.a)(n.prototype,"pointTransparency",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(Se.a)(n.prototype,"invertedColorMap",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(Se.a)(n.prototype,"settingsTabId",[xe.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=Object(Se.a)(n.prototype,"setScatterChartAres",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scatterChartArea=e}}}),_=Object(Se.a)(n.prototype,"setMouseMoveIntoScatterPlots",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoScatterPlots=e}}}),z=Object(Se.a)(n.prototype,"setMouseMoveIntoLinePlots",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isMouseMoveIntoLinePlots=e}}}),W=Object(Se.a)(n.prototype,"setStatsType",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{-1!==ke.ValidStatsTypes.indexOf(e)&&(this.statsType=e)}}}),G=Object(Se.a)(n.prototype,"setSpectralCoordinate",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;if(t&&t.spectralCoordsSupported&&t.spectralCoordsSupported.has(e)){const i=t.spectralCoordsSupported.get(e);t.spectralType=i.type,t.spectralUnit=i.unit,this.clearSharedXBounds()}}}}),V=Object(Se.a)(n.prototype,"setSpectralSystem",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.effectiveFrame;t&&t.spectralSystemsSupported&&t.spectralSystemsSupported.includes(e)&&(t.spectralSystem=e,this.clearSharedXBounds())}}}),B=Object(Se.a)(n.prototype,"setSharedXBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.sharedMinX=e,this.sharedMaxX=t}}}),H=Object(Se.a)(n.prototype,"clearSharedXBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sharedMinX=void 0,this.sharedMaxX=void 0}}}),q=Object(Se.a)(n.prototype,"setPolIntensityYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.polIntensityMinY=e,this.polIntensityMaxY=t}}}),Y=Object(Se.a)(n.prototype,"clearPolIntensityYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.polIntensityMinY=void 0,this.polIntensityMaxY=void 0}}}),U=Object(Se.a)(n.prototype,"setChannel",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channel=e}}}),X=Object(Se.a)(n.prototype,"setlinePlotCursorX",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.linePlotcursorX=e}}}),$=Object(Se.a)(n.prototype,"setScatterPlotCursor",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scatterPlotCursorX=e.x,this.scatterPlotCursorY=e.y}}}),K=Object(Se.a)(n.prototype,"setFractionalPolVisible",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fractionalPolVisible=e,this.clearScatterPlotXYBounds()}}}),Object(Se.a)(n.prototype,"setRegionId",[xe.r],Object.getOwnPropertyDescriptor(n.prototype,"setRegionId"),n.prototype),Q=Object(Se.a)(n.prototype,"setQUScatterPlotXBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quScatterMinX=e,this.quScatterMaxX=t}}}),Z=Object(Se.a)(n.prototype,"setPolAngleYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.polAngleMinY=e,this.polAngleMaxY=t}}}),J=Object(Se.a)(n.prototype,"setQULinePlotYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quMinY=e,this.quMaxY=t}}}),ee=Object(Se.a)(n.prototype,"setQUScatterPlotYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.quScatterMinY=e,this.quScatterMaxY=t}}}),te=Object(Se.a)(n.prototype,"clearLinePlotsXYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.sharedMinX=void 0,this.sharedMaxX=void 0,this.quMinY=void 0,this.quMaxY=void 0,this.polIntensityMinY=void 0,this.polIntensityMaxY=void 0,this.polAngleMinY=void 0,this.polAngleMaxY=void 0}}}),ie=Object(Se.a)(n.prototype,"clearScatterPlotXYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.quScatterMinX=void 0,this.quScatterMaxX=void 0,this.quScatterMinY=void 0,this.quScatterMaxY=void 0,this.scatterOutRangePointsZIndex=[]}}}),ne=Object(Se.a)(n.prototype,"setQULinePlotsXYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.quMinY=i,this.quMaxY=n}}}),re=Object(Se.a)(n.prototype,"setPolIntensityXYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.polIntensityMinY=i,this.polIntensityMaxY=n}}}),oe=Object(Se.a)(n.prototype,"setPolAngleXYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.sharedMinX=e,this.sharedMaxX=t,this.polAngleMinY=i,this.polAngleMaxY=n}}}),se=Object(Se.a)(n.prototype,"setQUScatterPlotXYBounds",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{this.quScatterMinX=e,this.quScatterMaxX=t,this.quScatterMinY=i,this.quScatterMaxY=n}}}),ae=Object(Se.a)(n.prototype,"setInvertedColorMap",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.invertedColorMap=e}}}),le=Object(Se.a)(n.prototype,"setPlotType",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.plotType=e}}}),ce=Object(Se.a)(n.prototype,"setPrimaryLineColor",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.primaryLineColor={colorHex:e,fixed:t}}}}),de=Object(Se.a)(n.prototype,"setSecondaryLineColor",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.secondaryLineColor={colorHex:e,fixed:t}}}}),ue=Object(Se.a)(n.prototype,"setLineWidth",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.i.MIN_WIDTH&&e<=we.i.MAX_WIDTH&&(this.lineWidth=e)}}}),he=Object(Se.a)(n.prototype,"setLinePlotPointSize",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.i.MIN_POINT_SIZE&&e<=we.i.MAX_POINT_SIZE&&(this.linePlotPointSize=e)}}}),pe=Object(Se.a)(n.prototype,"setScatterPlotPointSize",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.r.MIN_POINT_SIZE&&e<=we.r.MAX_POINT_SIZE&&(this.scatterPlotPointSize=e)}}}),ge=Object(Se.a)(n.prototype,"setEqualAxesValue",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.equalAxes=e}}}),fe=Object(Se.a)(n.prototype,"setColormap",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorMap=e,this.colorPixel=Object(ve.A)(e)}}}),be=Object(Se.a)(n.prototype,"setPointTransparency",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=we.r.MIN_TRANSPARENCY&&e<=we.r.MAX_TRANSPARENCY&&(this.pointTransparency=e)}}}),me=Object(Se.a)(n.prototype,"setSettingsTabId",[xe.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.settingsTabId=e}}}),Object(Se.a)(n.prototype,"isLinePlotsAutoScaledX",[xe.i],Object.getOwnPropertyDescriptor(n.prototype,"isLinePlotsAutoScaledX"),n.prototype),Object(Se.a)(n.prototype,"isQUScatterPlotAutoScaledX",[xe.i],Object.getOwnPropertyDescriptor(n.prototype,"isQUScatterPlotAutoScaledX"),n.prototype),Object(Se.a)(n.prototype,"isQUScatterPlotAutoScaledY",[xe.i],Object.getOwnPropertyDescriptor(n.prototype,"isQUScatterPlotAutoScaledY"),n.prototype),Object(Se.a)(n.prototype,"isQULinePlotAutoScaledY",[xe.i],Object.getOwnPropertyDescriptor(n.prototype,"isQULinePlotAutoScaledY"),n.prototype),Object(Se.a)(n.prototype,"isPolIntensityAutoScaledY",[xe.i],Object.getOwnPropertyDescriptor(n.prototype,"isPolIntensityAutoScaledY"),n.prototype),Object(Se.a)(n.prototype,"isPolAngleAutoScaledY",[xe.i],Object.getOwnPropertyDescriptor(n.prototype,"isPolAngleAutoScaledY"),n.prototype),n)},145:function(e,t,i){"use strict";i.d(t,"a",(function(){return N})),i.d(t,"d",(function(){return L})),i.d(t,"c",(function(){return _})),i.d(t,"b",(function(){return z}));var n,r,o,s,a,l,c,d,u,h,p,g,f,b,m,y,O,j,S,x,C,I,w,T,v,A=i(4),R=i(2),P=(i(28),i(1)),E=i(18),F=i(6),M=i(5),k=i(7);let D,N,L,_;!function(e){e.X="X",e.Y="Y",e.PlotSize="Size",e.PlotShape="Shape",e.NONE="None"}(D||(D={})),function(e){e.X="X",e.Y="Y",e.NONE="None",e.RA="RA",e.DEC="DEC",e.GLAT="GLAT",e.GLON="GLON",e.ELON="ELON",e.ELAT="ELAT",e.X0="X0",e.Y0="Y0",e.X1="X1",e.Y1="Y1"}(N||(N={})),function(e){e.TableUpdate="TableUpdate",e.ViewUpdate="ViewUpdate",e.PlotsUpdate="PlotsUpdate"}(L||(L={})),function(e){e.Ecliptic="ECLIPTIC",e.FK4="FK4",e.FK5="FK5",e.Galactic="GALACTIC",e.ICRS="ICRS",e.Pixel0="Pixel0",e.Pixel1="Pixel1"}(_||(_={}));let z=(n=P.g.bound,r=P.g.bound,v=T=class e{constructor(t,i,n){this.CoordinateSystemName=new Map([[_.FK5,"FK5"],[_.FK4,"FK4"],[_.Galactic,"GAL"],[_.Ecliptic,"ECL"],[_.ICRS,"ICRS"],[_.Pixel0,"PIX0"],[_.Pixel1,"PIX1"]]),this.systemCoordinateMap=new Map([[_.FK4,{x:N.RA,y:N.DEC}],[_.FK5,{x:N.RA,y:N.DEC}],[_.ICRS,{x:N.RA,y:N.DEC}],[_.Galactic,{x:N.GLON,y:N.GLAT}],[_.Ecliptic,{x:N.ELON,y:N.ELAT}],[_.Pixel0,{x:N.X0,y:N.Y0}],[_.Pixel1,{x:N.X1,y:N.Y1}]]),this.InitialedColumnsKeyWords=["ANGULAR DISTANCE","MAIN IDENTIFIER","RADIAL VELOCITY","REDSHIFT"],this.InitialedExcludeColumnsKeyWords=["PROPER MOTION","SIGMA"],this.InitialedRAColumnsKeyWords=["RIGHT ASCENSION","RA","R.A"],this.InitialedDECColumnsKeyWords=["DECLINATION","DEC","Dec."],Object(A.a)(this,"progress",s,this),Object(A.a)(this,"catalogInfo",a,this),Object(A.a)(this,"catalogControlHeader",l,this),Object(A.a)(this,"catalogHeader",c,this),Object(A.a)(this,"catalogData",d,this),Object(A.a)(this,"loadingData",u,this),Object(A.a)(this,"numVisibleRows",h,this),Object(A.a)(this,"subsetEndIndex",p,this),Object(A.a)(this,"updatingDataStream",g,this),Object(A.a)(this,"updateMode",f,this),Object(A.a)(this,"catalogFilterRequest",b,this),Object(A.a)(this,"catalogCoordinateSystem",m,this),Object(A.a)(this,"selectedPointIndices",y,this),Object(A.a)(this,"filterDataSize",O,this),Object(A.a)(this,"updateTableView",j,this),Object(A.a)(this,"sortingInfo",S,this),Object(A.a)(this,"maxRows",x,this),Object(A.a)(this,"setColumnFilter",C,this),Object(A.a)(this,"resetCatalogFilterRequest",I,this),Object(A.a)(this,"setSelectedPointIndices",w,this),Object(P.p)(this),this.catalogInfo=t,this.catalogHeader=i.sort(((e,t)=>e.columnIndex-t.columnIndex)),this.catalogData=n,this.catalogControlHeader=this.initCatalogControlHeader,this.loadingData=!1,this.catalogFilterRequest=this.initCatalogFilterRequest,this.updatingDataStream=!1,this.updateMode=L.TableUpdate,this.selectedPointIndices=[],this.filterDataSize=void 0,this.updateTableView=!1,this.sortingInfo={columnName:null,sortingType:null},this.maxRows=t.dataSize;const r=t.fileInfo.coosys[0];if(r){const e=this.getCatalogSystem(r.system);this.catalogCoordinateSystem={system:e,equinox:r.equinox,epoch:r.epoch,coordinate:this.systemCoordinateMap.get(_.ICRS)}}else this.catalogCoordinateSystem={system:_.ICRS,equinox:null,epoch:null,coordinate:this.systemCoordinateMap.get(_.ICRS)};const o=e.InitTableRows;t.dataSize<o?(this.numVisibleRows=t.dataSize,this.subsetEndIndex=t.dataSize):(this.numVisibleRows=o,this.subsetEndIndex=o)}setCatalogCoordinateSystem(e){const t=this.catalogCoordinateSystem;this.catalogCoordinateSystem={system:e,equinox:t.equinox,epoch:t.epoch,coordinate:this.systemCoordinateMap.get(e)}}get activedSystem(){return this.systemCoordinateMap.get(this.catalogCoordinateSystem.system)}setUserFilter(e){this.catalogFilterRequest=e}setProgress(e){this.progress=e}setCatalogHeader(e){this.catalogHeader=e}setUpdateMode(e){this.updateMode=e}setSortingInfo(e,t){this.sortingInfo={columnName:e,sortingType:t}}static FillAllocatedArray(e,t,i,n){const r=t.length;let o;if(e.length===n){o=e;for(let e=0;e<r;e++)o[e+i]=t[e]}else{o=new Array(n);for(let t=0;t<i;t++)o[t]=e[t];for(let e=0;e<r;e++)o[e+i]=t[e]}return o}updateCatalogData(t,i){let n=t.subsetDataSize;const r=t.subsetEndIndex,o=r-n,s=t.requestEndIndex;if(this.filterDataSize=t.filterDataSize,this.subsetEndIndex<=this.filterDataSize){let t=this.numVisibleRows+n;i.forEach(((t,i)=>{let n=this.catalogData.get(i);if(n)if(n.dataType===F.a.ColumnType.String){const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,s)}else if(n.dataType===F.a.ColumnType.Bool){const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,s)}else{if(n.dataType===F.a.ColumnType.UnsupportedType)return;{const i=n.data,r=t.data;n.data=e.FillAllocatedArray(i,r,o,s)}}else this.catalogData.set(i,t)})),this.setNumVisibleRows(t),this.subsetEndIndex=r}}clearData(){this.catalogData.clear()}setHeaderDisplay(e,t){this.catalogControlHeader.get(t).display=e}setTableColumnWidth(e,t){this.catalogControlHeader.get(t).columnWidth=e}updateTableStatus(e){this.updateTableView=e}setNumVisibleRows(e){this.numVisibleRows=e}setSubsetEndIndex(e){this.subsetEndIndex=e}setLoadingDataStatus(e){this.loadingData=e}setUpdatingDataStream(e){this.updatingDataStream=e}resetFilterRequestControlParams(){this.setUpdateMode(L.TableUpdate),this.clearData(),this.setNumVisibleRows(0),this.setSubsetEndIndex(0),this.setLoadingDataStatus(!0)}get loadOntoImage(){return this.loadingData||this.updatingDataStream}get initCatalogControlHeader(){const e=new Map,t=this.catalogHeader;if(t.length)for(let i=0;i<t.length;i++){const n=t[i];let r=!1;i<M.H.Instance.catalogDisplayedColumnSize&&(r=!0);let o={columnIndex:n.columnIndex,dataIndex:i,display:r,filter:"",columnWidth:null};e.set(n.name,o)}return e}resetUserFilters(){this.catalogControlHeader.forEach(((e,t)=>{e.filter=""})),this.filterDataSize=void 0}setMaxRows(e){this.updateTableStatus(!0),this.maxRows=e}get displayedColumnHeaders(){let e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.display&&this.catalogHeader&&e.push(this.catalogHeader[t.dataIndex])})),e}get tableColumnWidts(){const e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.display&&e.push(t.columnWidth)})),e}get initCatalogFilterRequest(){let t=new F.a.CatalogFilterRequest,i=new F.a.CatalogImageBounds,n=e.InitTableRows;return t.fileId=this.catalogInfo.fileId,t.filterConfigs=null,t.columnIndices=this.columnIndices,t.subsetStartIndex=0,t.imageBounds=i,t.regionId=null,t.sortColumn=null,t.sortingType=null,n>this.maxRows&&(n=this.maxRows),this.catalogInfo.dataSize<n?t.subsetDataSize=this.catalogInfo.dataSize:t.subsetDataSize=n,t}get updateRequestDataSize(){if(this.catalogFilterRequest.subsetStartIndex=this.subsetEndIndex,this.maxRows<=this.numVisibleRows)return this.catalogFilterRequest.subsetStartIndex=0,this.catalogFilterRequest.subsetDataSize=this.maxRows,this.catalogFilterRequest;const t=this.maxRows-this.numVisibleRows;if(this.updateMode===L.TableUpdate){let i=e.DataChunkSize;t<i&&t>0&&(i=t),this.catalogFilterRequest.subsetDataSize=i}else this.catalogFilterRequest.subsetDataSize=t;return this.catalogFilterRequest}get shouldUpdateData(){return isFinite(this.filterDataSize)?this.subsetEndIndex<this.filterDataSize&&this.subsetEndIndex<this.maxRows:this.subsetEndIndex<this.catalogInfo.dataSize&&this.subsetEndIndex<this.maxRows}get columnIndices(){let e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.display&&e.push(t.columnIndex)})),e}get hasFilter(){let e=[];return this.catalogControlHeader.forEach(((t,i)=>{t.filter&&e.push(t)})),e.length>0}get selectedData(){let e=this.catalogData;const t=this.selectedPointIndices,i=this.displayedColumnHeaders.map((e=>e.columnIndex));if(t.length>0){const e=new Map;return this.catalogData.forEach(((n,r)=>{i.includes(r)&&e.set(r,Object(k.s)(n,t))})),e}return e}get regionSelected(){return this.selectedPointIndices.length}get autoScrollRowNumber(){let e=E.c.row(0);return this.selectedPointIndices.length>0&&(e=E.c.row(this.selectedPointIndices[0])),e}get catalogFileId(){return this.catalogInfo.fileId}get2DPlotData(e,t,i){const n=this.catalogControlHeader,r=n.get(e),o=n.get(t),s=this.catalogHeader[r.dataIndex],a=this.catalogHeader[o.dataIndex],l=i.get(s.columnIndex),c=i.get(a.columnIndex);if(l&&l.dataType!==F.a.ColumnType.String&&l.dataType!==F.a.ColumnType.Bool&&c&&c.dataType!==F.a.ColumnType.String&&c.dataType!==F.a.ColumnType.Bool){return{wcsX:l.data,wcsY:c.data,xHeaderInfo:s,yHeaderInfo:a}}return{xHeaderInfo:s,yHeaderInfo:a}}get1DPlotData(e){const t=this.catalogControlHeader.get(e),i=this.catalogHeader[t.dataIndex],n=this.catalogData.get(i.columnIndex);if(n&&n.dataType!==F.a.ColumnType.String&&n.dataType!==F.a.ColumnType.Bool){return{wcsData:n.data,headerInfo:i}}return{headerInfo:i}}findKeywords(e){const t=this.InitialedColumnsKeyWords,i=this.InitialedRAColumnsKeyWords,n=this.InitialedDECColumnsKeyWords,r=this.InitialedExcludeColumnsKeyWords,o=e.toUpperCase();for(let s=0;s<t.length;s++){const e=t[s];if(o.includes(e))return!0}if(o.includes(r[0])||o.includes(r[1]))return!1;for(let s=0;s<i.length;s++){const e=i[s];if(o.includes(e))return!0}for(let s=0;s<n.length;s++){const e=n[s];if(o.includes(e))return!0}return!1}getCatalogSystem(e){let t=_.ICRS;return this.CoordinateSystemName.forEach(((i,n)=>{e.toUpperCase().includes(i.toUpperCase())&&(t=n)})),t}isInfinite(t){return!isFinite(t)||t===e.NEGATIVE_INFINITY||t===e.POSITIVE_INFINITY}},T.InitTableRows=50,T.DataChunkSize=50,T.NEGATIVE_INFINITY=-17976931348623157e292,T.POSITIVE_INFINITY=17976931348623157e292,o=v,s=Object(R.a)(o.prototype,"progress",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(R.a)(o.prototype,"catalogInfo",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(R.a)(o.prototype,"catalogControlHeader",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(R.a)(o.prototype,"catalogHeader",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(R.a)(o.prototype,"catalogData",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(R.a)(o.prototype,"loadingData",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(R.a)(o.prototype,"numVisibleRows",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(R.a)(o.prototype,"subsetEndIndex",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(R.a)(o.prototype,"updatingDataStream",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(R.a)(o.prototype,"updateMode",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(R.a)(o.prototype,"catalogFilterRequest",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(R.a)(o.prototype,"catalogCoordinateSystem",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(R.a)(o.prototype,"selectedPointIndices",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(R.a)(o.prototype,"filterDataSize",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(R.a)(o.prototype,"updateTableView",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=Object(R.a)(o.prototype,"sortingInfo",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),x=Object(R.a)(o.prototype,"maxRows",[P.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(R.a)(o.prototype,"setCatalogCoordinateSystem",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setCatalogCoordinateSystem"),o.prototype),Object(R.a)(o.prototype,"activedSystem",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"activedSystem"),o.prototype),Object(R.a)(o.prototype,"setUserFilter",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setUserFilter"),o.prototype),Object(R.a)(o.prototype,"setProgress",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setProgress"),o.prototype),Object(R.a)(o.prototype,"setCatalogHeader",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setCatalogHeader"),o.prototype),Object(R.a)(o.prototype,"setUpdateMode",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setUpdateMode"),o.prototype),Object(R.a)(o.prototype,"setSortingInfo",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setSortingInfo"),o.prototype),Object(R.a)(o.prototype,"updateCatalogData",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"updateCatalogData"),o.prototype),Object(R.a)(o.prototype,"clearData",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"clearData"),o.prototype),Object(R.a)(o.prototype,"setHeaderDisplay",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setHeaderDisplay"),o.prototype),Object(R.a)(o.prototype,"setTableColumnWidth",[n],Object.getOwnPropertyDescriptor(o.prototype,"setTableColumnWidth"),o.prototype),C=Object(R.a)(o.prototype,"setColumnFilter",[P.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=this.catalogControlHeader.get(t),n={columnIndex:i.columnIndex,dataIndex:i.dataIndex,display:i.display,filter:e,columnWidth:i.columnWidth};this.catalogControlHeader.set(t,n),this.updateTableStatus(!0)}}}),Object(R.a)(o.prototype,"updateTableStatus",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"updateTableStatus"),o.prototype),Object(R.a)(o.prototype,"setNumVisibleRows",[r],Object.getOwnPropertyDescriptor(o.prototype,"setNumVisibleRows"),o.prototype),Object(R.a)(o.prototype,"setSubsetEndIndex",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setSubsetEndIndex"),o.prototype),Object(R.a)(o.prototype,"setLoadingDataStatus",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setLoadingDataStatus"),o.prototype),Object(R.a)(o.prototype,"setUpdatingDataStream",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setUpdatingDataStream"),o.prototype),I=Object(R.a)(o.prototype,"resetCatalogFilterRequest",[P.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.resetFilterRequestControlParams(),this.resetUserFilters(),this.loadingData=!1,this.catalogFilterRequest=this.initCatalogFilterRequest,this.updatingDataStream=!1,this.sortingInfo.columnName=null,this.sortingInfo.sortingType=null,this.maxRows=this.catalogInfo.dataSize}}}),Object(R.a)(o.prototype,"resetFilterRequestControlParams",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"resetFilterRequestControlParams"),o.prototype),Object(R.a)(o.prototype,"loadOntoImage",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"loadOntoImage"),o.prototype),Object(R.a)(o.prototype,"initCatalogControlHeader",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"initCatalogControlHeader"),o.prototype),Object(R.a)(o.prototype,"resetUserFilters",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"resetUserFilters"),o.prototype),w=Object(R.a)(o.prototype,"setSelectedPointIndices",[P.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{var i;this.selectedPointIndices=e;const n=M.k.Instance.catalogData.get(this.catalogFileId);if(null===n||void 0===n||null===(i=n.xImageCoords)||void 0===i?void 0:i.length){let i=[],r=[],o=n.xImageCoords,s=n.yImageCoords;for(let t=0;t<e.length;t++){const n=e[t],a=o[n],l=s[n];this.isInfinite(a)||this.isInfinite(l)||(i.push(a),r.push(l))}if(M.k.Instance.updateSelectedPoints(this.catalogFileId,i,r),t){const e=i.length;if(1===e){const e=i[0],t=r[0];M.e.Instance.activeFrame.setCenter(e,t)}if(e>1){const e=Object(k.U)(i),t=Object(k.U)(r),n=e.maxVal-e.minVal,o=t.maxVal-t.minVal;M.e.Instance.activeFrame.setCenter(n/2+e.minVal,o/2+t.minVal);const s=Math.min(M.e.Instance.activeFrame.renderWidth/n,M.e.Instance.activeFrame.renderHeight/o);M.e.Instance.activeFrame.setZoom(s)}}}}}}),Object(R.a)(o.prototype,"setMaxRows",[P.g],Object.getOwnPropertyDescriptor(o.prototype,"setMaxRows"),o.prototype),Object(R.a)(o.prototype,"displayedColumnHeaders",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"displayedColumnHeaders"),o.prototype),Object(R.a)(o.prototype,"tableColumnWidts",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"tableColumnWidts"),o.prototype),Object(R.a)(o.prototype,"initCatalogFilterRequest",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"initCatalogFilterRequest"),o.prototype),Object(R.a)(o.prototype,"updateRequestDataSize",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"updateRequestDataSize"),o.prototype),Object(R.a)(o.prototype,"shouldUpdateData",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"shouldUpdateData"),o.prototype),Object(R.a)(o.prototype,"columnIndices",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"columnIndices"),o.prototype),Object(R.a)(o.prototype,"hasFilter",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"hasFilter"),o.prototype),Object(R.a)(o.prototype,"selectedData",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"selectedData"),o.prototype),Object(R.a)(o.prototype,"regionSelected",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"regionSelected"),o.prototype),Object(R.a)(o.prototype,"autoScrollRowNumber",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"autoScrollRowNumber"),o.prototype),Object(R.a)(o.prototype,"catalogFileId",[P.i],Object.getOwnPropertyDescriptor(o.prototype,"catalogFileId"),o.prototype),o)},169:function(e,t,i){"use strict";i.d(t,"a",(function(){return b})),i.d(t,"b",(function(){return m}));i(3);var n=i(36),r=i(424),o=i(59),s=i(180),a=i(181),l=i(182),c=i(183),d=i(184),u=i(185),h=i(0);const p=new Map([[o.a.LINEAR,s.a],[o.a.LOG,a.a],[o.a.SQRT,l.a],[o.a.SQUARE,c.a],[o.a.GAMMA,d.a],[o.a.POWER,u.a]]),g=r.a.ofType(),f=Array.from(o.b.SCALING_TYPES.keys()),b={minimal:!0,position:"auto-end",popoverClassName:"colormap-select-popover"},m=e=>Object(h.jsx)(g,{activeItem:e.selectedItem,onItemSelect:e.onItemSelect,popoverProps:b,filterable:!1,items:f,itemRenderer:(e,{handleClick:t,modifiers:i,query:r})=>i.matchesPredicate&&o.b.SCALING_TYPES.has(e)?Object(h.jsx)(n.B,{active:i.active,disabled:i.disabled,label:o.b.SCALING_TYPES.get(e),onClick:t,text:Object(h.jsx)("div",{className:"equation-div",style:{backgroundImage:`url(${p.get(e)}`}})},e):null,children:Object(h.jsx)(n.e,{text:o.b.SCALING_TYPES.get(e.selectedItem),rightIcon:"double-caret-vertical",alignText:"right"})})},170:function(e,t,i){"use strict";i.d(t,"a",(function(){return nt}));var n=i(4),r=i(2),o=(i(28),i(33)),s=i(1),a=i(404),l=i(74),c=i(9),d=i(36),u=i(32),h=i(20),p=i(124),g=i(6),f=i(5),b=i(7),m=i(27),y=i(11),O=i(12),j=i(13),S=i(8);var x,C,I,w,T,v,A,R,P,E,F,M,k,D,N,L,_,z,W,G,V,B,H,q,Y,U,X,$,K,Q,Z,J,ee,te,ie,ne,re,oe,se,ae,le,ce,de,ue,he,pe,ge,fe,be,me,ye,Oe,je,Se,xe,Ce,Ie,we,Te,ve,Ae,Re,Pe,Ee,Fe,Me,ke,De,Ne,Le,_e,ze,We,Ge,Ve,Be,He,qe,Ye,Ue,Xe,$e,Ke,Qe,Ze,Je,et,tt,it={logMessage:"a40b98df version bump"};let nt=(tt=et=class e{static get Instance(){return e.staticInstance||new e}get estimatedTaskRemainingTime(){if(this.taskProgress<=0||this.taskProgress>=1)return;const e=this.taskCurrentTime-this.taskStartTime;return e/this.taskProgress-e}get modifierString(){return"linux"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET?"ctrl + ":"darwin"===Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_TARGET?"cmd +":"alt + "}get darkTheme(){return this.preferenceStore.theme===y.Theme.AUTO?this.systemTheme===y.Theme.DARK:this.preferenceStore.theme===y.Theme.DARK}get activeFrameIndex(){return this.activeFrame?this.frames.findIndex((e=>e.frameInfo.fileId===this.activeFrame.frameInfo.fileId)):-1}get frameNum(){return this.frames.length}get frameMap(){const e=new Map;for(const t of this.frames)e.set(t.frameInfo.fileId,t);return e}get catalogNum(){return this.catalogStore.catalogProfileStores.size}get frameNames(){let e=[];return this.frames.forEach(((t,i)=>e.push({label:i+": "+t.filename,value:t.frameInfo.fileId}))),e}get frameChannels(){return this.frames.map((e=>e.requiredChannel))}get frameStokes(){return this.frames.map((e=>e.requiredStokes))}get spatialGroup(){if(!this.frames||!this.frames.length||!this.activeFrame)return[];const e=[];for(const t of this.frames){(t===this.activeFrame||t===this.activeFrame.spatialReference||t.spatialReference===this.activeFrame||t.spatialReference&&t.spatialReference===this.activeFrame.spatialReference)&&e.push(t)}return e}get contourFrames(){return this.spatialGroup.filter((e=>e.contourConfig.enabled&&e.contourConfig.visible))}removeCatalog(t,i,n){if(t>-1&&this.backendService.closeCatalogFile(t)){const r=f.k.Instance;if(r.clearCatalogPlotsByFileId(t),this.catalogStore.catalogWidgets.delete(t),this.widgetsStore.catalogWidgets.delete(i),r.removeCatalog(t),r.catalogProfileStores.delete(t),!this.activeFrame)return;const o=r.activeCatalogFiles,s=e.Instance.activeFrame.frameInfo.fileId;let a=[];o&&(a=o.filter((e=>e!==t)),r.updateImageAssociatedCatalogId(s,a)),n&&a.length&&r.catalogProfiles.forEach(((e,i)=>{e===t&&r.catalogProfiles.set(i,a[0])}))}}sendCatalogFilter(e){this.activeFrame&&this.backendService.setCatalogFilterRequest(e)}constructor(){this.backendService=void 0,this.tileService=void 0,this.scriptingService=void 0,this.apiService=void 0,this.alertStore=void 0,this.animatorStore=void 0,this.catalogStore=void 0,this.dialogStore=void 0,this.fileBrowserStore=void 0,this.helpStore=void 0,this.layoutStore=void 0,this.logStore=void 0,this.overlayStore=void 0,this.preferenceStore=void 0,this.widgetsStore=void 0,Object(n.a)(this,"astReady",C,this),Object(n.a)(this,"cartaComputeReady",I,this),Object(n.a)(this,"frames",w,this),Object(n.a)(this,"activeFrame",T,this),Object(n.a)(this,"contourDataSource",v,this),Object(n.a)(this,"syncContourToFrame",A,this),Object(n.a)(this,"syncFrameToContour",R,this),Object(n.a)(this,"spatialProfiles",P,this),Object(n.a)(this,"spectralProfiles",E,this),Object(n.a)(this,"regionStats",F,this),Object(n.a)(this,"regionHistograms",M,this),Object(n.a)(this,"spatialReference",k,this),Object(n.a)(this,"spectralReference",D,this),Object(n.a)(this,"rasterScalingReference",N,this),Object(n.a)(this,"activeLayer",L,this),Object(n.a)(this,"cursorFrozen",_,this),this.appContainer=void 0,this.fileCounter=0,this.previousConnectionStatus=void 0,this.getAppContainer=()=>this.appContainer,this.setAppContainer=e=>{this.appContainer=e},Object(n.a)(this,"splashScreenVisible",z,this),Object(n.a)(this,"showSplashScreen",W,this),Object(n.a)(this,"hideSplashScreen",G,this),Object(n.a)(this,"setImageViewDimensions",V,this),Object(n.a)(this,"imageToolbarVisible",B,this),Object(n.a)(this,"showImageToolbar",H,this),Object(n.a)(this,"hideImageToolbar",q,this),Object(n.a)(this,"username",Y,this),Object(n.a)(this,"setUsername",U,this),Object(n.a)(this,"connectToServer",X,this),Object(n.a)(this,"handleThemeChange",$,this),Object(n.a)(this,"taskProgress",K,this),Object(n.a)(this,"taskStartTime",Q,this),Object(n.a)(this,"taskCurrentTime",Z,this),Object(n.a)(this,"fileLoading",J,this),Object(n.a)(this,"resumingSession",ee,this),Object(n.a)(this,"restartTaskProgress",te,this),Object(n.a)(this,"updateTaskProgress",ie,this),Object(n.a)(this,"startFileLoading",ne,this),Object(n.a)(this,"endFileLoading",re,this),Object(n.a)(this,"systemTheme",oe,this),Object(n.a)(this,"addFrame",se,this),Object(n.a)(this,"loadFile",ae,this),Object(n.a)(this,"appendFile",le,this),Object(n.a)(this,"openFile",ce,this),Object(n.a)(this,"saveFile",de,this),Object(n.a)(this,"closeFile",ue,this),Object(n.a)(this,"closeCurrentFile",he,this),Object(n.a)(this,"closeOtherFiles",pe,this),Object(n.a)(this,"removeFrame",ge,this),Object(n.a)(this,"removeAllFrames",fe,this),Object(n.a)(this,"shiftFrame",be,this),Object(n.a)(this,"nextFrame",me,this),Object(n.a)(this,"prevFrame",ye,this),Object(n.a)(this,"appendCatalog",Oe,this),Object(n.a)(this,"reorderFrame",je,this),Object(n.a)(this,"importRegion",Se,this),Object(n.a)(this,"exportRegions",xe,this),Object(n.a)(this,"requestCubeHistogram",Ce,this),Object(n.a)(this,"cancelCubeHistogramRequest",Ie,this),Object(n.a)(this,"requestMoment",we,this),Object(n.a)(this,"cancelRequestingMoment",Te,this),Object(n.a)(this,"setDarkTheme",ve,this),Object(n.a)(this,"setLightTheme",Ae,this),Object(n.a)(this,"setAutoTheme",Re,this),Object(n.a)(this,"toggleCursorFrozen",Pe,this),Object(n.a)(this,"updateActiveLayer",Ee,this),this.spectralRequirements=void 0,this.spatialRequirements=void 0,this.statsRequirements=void 0,this.histogramRequirements=void 0,this.pendingChannelHistograms=void 0,this.throttledSetChannels=o.throttle((e=>{e&&e.length&&e.forEach((e=>{const t=e.frame;if(t)if(t.channel=e.channel,t.stokes=e.stokes,t===this.activeFrame){const e=t.requiredFrameView,i={xMin:Math.max(0,e.xMin),xMax:Math.min(t.frameInfo.fileInfoExtended.width,e.xMax),yMin:Math.max(0,e.yMin),yMax:Math.min(t.frameInfo.fileInfoExtended.height,e.yMax),mip:e.mip},n={x:t.frameInfo.fileInfoExtended.width,y:t.frameInfo.fileInfoExtended.height},r=Object(b.b)(i,n,{x:256,y:256}),o={x:(e.xMax+e.xMin)/2,y:(e.yMin+e.yMax)/2},s=256*e.mip,a={x:o.x/s-.5,y:o.y/s-.5};this.tileService.requestTiles(r,t.frameInfo.fileId,t.channel,t.stokes,a,this.preferenceStore.imageCompressionQuality,!0)}else this.tileService.updateInactiveFileChannel(t.frameInfo.fileId,t.channel,t.stokes)}))}),e.ImageChannelThrottleTime),this.throttledSetView=o.throttle(((e,t,i,n,r)=>{this.animatorStore.serverAnimationActive?this.backendService.addRequiredTiles(t,e.map((e=>e.encode())),this.preferenceStore.animationCompressionQuality):this.tileService.requestTiles(e,t,i,n,r,this.preferenceStore.imageCompressionQuality)}),e.ImageChannelThrottleTime),Object(n.a)(this,"handleSpatialProfileStream",Fe,this),this.handleSpectralProfileStream=e=>{if(this.frames.find((t=>t.frameInfo.fileId===e.fileId))){let t=this.spectralProfiles.get(e.fileId);t||(t=new s.b,this.spectralProfiles.set(e.fileId,t));let i=t.get(e.regionId);i||(i=new f.Q(e.fileId,e.regionId),t.set(e.regionId,i)),i.stokes=e.stokes;for(let n of e.profiles)i.setProfile(y.ProtobufProcessing.ProcessSpectralProfile(n,e.progress))}},this.handleRegionHistogramStream=e=>{if(!e)return;let t=this.regionHistograms.get(e.fileId);if(t||(t=new s.b,this.regionHistograms.set(e.fileId,t)),t.set(e.regionId,e),-1===e.regionId)e.histograms.forEach((t=>{const i=`${e.fileId}_${e.stokes}_${t.channel}`;this.pendingChannelHistograms.set(i,e)}));else if(-2===e.regionId){const t=this.getFrame(e.fileId);if(t){const i=e.histograms[0];i&&(t.renderConfig.useCubeHistogram||t.renderConfig.useCubeHistogramContours)&&(t.renderConfig.updateCubeHistogram(i,e.progress),this.updateTaskProgress(e.progress))}}},Object(n.a)(this,"handleTileStream",Me,this),this.handleRegionStatsStream=e=>{if(!e)return;let t=this.regionStats.get(e.fileId);t||(t=new s.b,this.regionStats.set(e.fileId,t)),t.set(e.regionId,e)},this.handleContourImageStream=e=>{const t=this.getFrame(e.fileId);t&&t.updateFromContourData(e)},Object(n.a)(this,"handleCatalogFilterStream",ke,this),this.handleMomentProgressStream=e=>{if(!e)return;const t=this.getFrame(e.fileId);t&&(t.updateRequestingMomentsProgress(e.progress),this.updateTaskProgress(e.progress))},this.handleErrorStream=e=>{if(e){const t={level:e.severity,message:e.message,tags:e.tags.concat(["server-sent"]),title:null};this.logStore.addLog(t)}},this.handleReconnectStream=()=>{this.alertStore.showInteractiveAlert("Do you want to resume your session? Please note that temporary images such as moment images or PV images generated via the GUI will be unloaded.",this.onResumeAlertClosed)},this.handleScriptingRequest=e=>{this.scriptingService.handleScriptingRequest(e).then(this.backendService.sendScriptingResponse)},Object(n.a)(this,"onResumeAlertClosed",De,this),Object(n.a)(this,"onSessionResumed",Ne,this),Object(n.a)(this,"setContourDataSource",Le,this),Object(n.a)(this,"toggleFrameContourLock",_e,this),Object(n.a)(this,"deleteSelectedRegion",ze,this),Object(n.a)(this,"deleteRegion",We,this),this.setCursor=(e,t)=>{const i=this.getFrame(e);null===i||void 0===i||i.updateCursorRegion(t)},Object(n.a)(this,"setSpatialReference",Ge,this),Object(n.a)(this,"clearSpatialReference",Ve,this),Object(n.a)(this,"setSpatialMatchingEnabled",Be,this),Object(n.a)(this,"toggleSpatialMatching",He,this),Object(n.a)(this,"setSpectralReference",qe,this),Object(n.a)(this,"clearSpectralReference",Ye,this),Object(n.a)(this,"setSpectralMatchingEnabled",Ue,this),Object(n.a)(this,"toggleSpectralMatching",Xe,this),Object(n.a)(this,"setRasterScalingReference",$e,this),Object(n.a)(this,"clearRasterScalingReference",Ke,this),Object(n.a)(this,"setRasterScalingMatchingEnabled",Qe,this),Object(n.a)(this,"toggleRasterScalingMatching",Ze,this),Object(n.a)(this,"setMatchingEnabled",Je,this),this.exportImage=()=>{if(this.activeFrame){const e=this.preferenceStore.transparentImageBackground?"rgba(255, 255, 255, 0)":this.darkTheme?l.a.DARK_GRAY3:l.a.LIGHT_GRAY5,t=Object(j.I)(this.overlayStore.padding,e);if(t)return t.toBlob((e=>{const t=document.createElement("a");t.download=`${this.activeFrame.filename}-image-${Object(b.I)()}.png`,t.href=URL.createObjectURL(e),t.dispatchEvent(new MouseEvent("click"))}),"image/png"),!0}return!1},this.getImageDataUrl=e=>{if(this.activeFrame){const t=Object(j.I)(this.overlayStore.padding,e);if(t)return t.toDataURL()}return null},this.waitForImageData=async()=>(await this.delay(25),new Promise((e=>{Object(s.u)((()=>{const e=this.tileService.remainingTiles>0,t=this.activeFrame&&this.activeFrame.contourProgress>=0&&this.activeFrame.contourProgress<1;return!e&&!t}),(async()=>{await this.delay(25),e()}))}))),this.fetchParameter=e=>{if(e&&e instanceof Map){const t={},i=e;for(let[e,n]of i)t[e]=n;return t}return e},this.initRequirements=()=>{this.spectralRequirements=new Map,this.spatialRequirements=new Map,this.statsRequirements=new Map,this.histogramRequirements=new Map},this.recalculateRequirements=()=>{this.recalculateSpatialRequirements(),this.recalculateSpectralRequirements(),this.recalculateStatsRequirements(),this.recalculateHistogramRequirements()},Object(s.p)(this),e.staticInstance=this,this.backendService=m.b.Instance,this.tileService=m.h.Instance,this.scriptingService=m.f.Instance,this.apiService=m.a.Instance,this.alertStore=f.b.Instance,this.animatorStore=f.d.Instance,this.catalogStore=f.k.Instance,this.dialogStore=f.r.Instance,this.fileBrowserStore=f.s.Instance,this.helpStore=f.w.Instance,this.layoutStore=f.z.Instance,this.logStore=f.A.Instance,this.overlayStore=f.E.Instance,this.preferenceStore=f.H.Instance,this.widgetsStore=f.U.Instance,this.astReady=!1,this.cartaComputeReady=!1,this.spatialProfiles=new Map,this.spectralProfiles=new Map,this.regionStats=new Map,this.regionHistograms=new Map,this.pendingChannelHistograms=new Map,this.frames=[],this.activeFrame=null,this.contourDataSource=null,this.syncFrameToContour=!0,this.syncContourToFrame=!0,this.initRequirements(),this.activeLayer=j.l.RegionMoving,h.onReady.then(Object(s.s)((()=>{h.setPalette(this.darkTheme?f.W:f.V),this.astReady=!0,this.logStore.addInfo("AST library loaded",["ast"])}))),p.onReady.then(Object(s.g)((()=>{this.cartaComputeReady=!0,this.logStore.addInfo("Compute module loaded",["compute"])}))),this.logStore.addDebug(`Current frontend version: ${it.logMessage}`,["version"]),this.previousConnectionStatus=m.c.CLOSED,Object(s.h)((()=>{document.body.style.backgroundColor=this.darkTheme?l.a.DARK_GRAY4:l.a.WHITE;const e=this.darkTheme?c.a.DARK:"";Object(d.X)({className:e})}));const t=window.matchMedia("(prefers-color-scheme: dark)");t&&(t.addEventListener?t.addEventListener("change",(e=>this.handleThemeChange(e.matches))):t.addListener&&t.addListener((e=>handleThemeChange(e.matches)))),this.handleThemeChange(t.matches),Object(s.h)((()=>{const e=this.backendService.connectionStatus,t=this.username?` as ${this.username}`:"";switch(e){case m.c.ACTIVE:this.backendService.connectionDropped?S.a.show(Object(S.z)(`Reconnected to server${t}. Some errors may occur`)):S.a.show(Object(S.v)("swap-vertical",`Connected to CARTA server${t}`));break;case m.c.CLOSED:this.previousConnectionStatus===m.c.ACTIVE&&S.a.show(Object(S.e)("Disconnected from server"))}this.previousConnectionStatus=e}));const i=o.throttle(this.setCursor,e.CursorThrottleTimeRotated),r=o.throttle(this.setCursor,e.CursorThrottleTime),a=o.throttle(this.setCursor,2*e.CursorThrottleTime);Object(s.h)((()=>{if(this.activeFrame&&(this.preferenceStore.streamContoursWhileZooming||!this.activeFrame.zooming)){this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout);const e=this.activeFrame.requiredFrameView;let t={xMin:Math.max(0,e.xMin),xMax:Math.min(this.activeFrame.frameInfo.fileInfoExtended.width,e.xMax),yMin:Math.max(0,e.yMin),yMax:Math.min(this.activeFrame.frameInfo.fileInfoExtended.height,e.yMax),mip:e.mip};const i={x:this.activeFrame.frameInfo.fileInfoExtended.width,y:this.activeFrame.frameInfo.fileInfoExtended.height},n=Object(b.b)(t,i,{x:256,y:256}),r={x:(e.xMax+e.xMin)/2,y:(e.yMin+e.yMax)/2},o=256*e.mip,s={x:r.x/o-.5,y:r.y/o-.5};this.throttledSetView(n,this.activeFrame.frameInfo.fileId,this.activeFrame.channel,this.activeFrame.stokes,s)}this.activeFrame||this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout)})),Object(s.h)((()=>{if(this.activeFrame){const e=[],t=this.activeFrame.requiredChannel!==this.activeFrame.channel||this.activeFrame.requiredStokes!==this.activeFrame.stokes;!this.animatorStore.animationActive&&t&&e.push({frame:this.activeFrame,channel:this.activeFrame.requiredChannel,stokes:this.activeFrame.requiredStokes}),this.activeFrame.spectralSiblings.forEach((t=>{(t.requiredChannel!==t.channel||t.requiredStokes!==t.stokes)&&e.push({frame:t,channel:t.requiredChannel,stokes:t.requiredStokes})})),e.length&&this.throttledSetChannels(e)}})),Object(s.h)((()=>{var e,t;if(null===(e=this.activeFrame)||void 0===e||null===(t=e.cursorInfo)||void 0===t?void 0:t.posImageSpace){const e={x:Math.round(this.activeFrame.cursorInfo.posImageSpace.x),y:Math.round(this.activeFrame.cursorInfo.posImageSpace.y)};e.x>=0&&e.x<=this.activeFrame.frameInfo.fileInfoExtended.width-1&&e.y>=0&&e.y<=this.activeFrame.frameInfo.fileInfoExtended.height-1&&(this.preferenceStore.lowBandwidthMode?a(this.activeFrame.frameInfo.fileId,e):this.activeFrame.frameInfo.fileFeatureFlags&g.a.FileFeatureFlags.ROTATED_DATASET?i(this.activeFrame.frameInfo.fileId,e):r(this.activeFrame.frameInfo.fileId,e))}})),Object(s.h)((()=>{this.activeFrame&&this.overlayStore.setDefaultsFromAST(this.activeFrame)})),Object(s.h)((()=>{h.setPalette(this.darkTheme?f.W:f.V)})),setInterval(this.recalculateRequirements,e.RequirementsCheckInterval),this.backendService.spatialProfileStream.subscribe(this.handleSpatialProfileStream),this.backendService.spectralProfileStream.subscribe(this.handleSpectralProfileStream),this.backendService.histogramStream.subscribe(this.handleRegionHistogramStream),this.backendService.contourStream.subscribe(this.handleContourImageStream),this.backendService.catalogStream.subscribe(this.handleCatalogFilterStream),this.backendService.errorStream.subscribe(this.handleErrorStream),this.backendService.statsStream.subscribe(this.handleRegionStatsStream),this.backendService.momentProgressStream.subscribe(this.handleMomentProgressStream),this.backendService.reconnectStream.subscribe(this.handleReconnectStream),this.backendService.scriptingStream.subscribe(this.handleScriptingRequest),this.tileService.tileStream.subscribe(this.handleTileStream);const u=new URL(window.location.href).searchParams.get("token");u&&this.apiService.setToken(u),Object(s.h)((()=>{this.astReady&&this.zfpReady&&this.cartaComputeReady&&this.apiService.authenticated&&this.preferenceStore.fetchPreferences().then((()=>{this.layoutStore.fetchLayouts().then((()=>{this.tileService.setCache(this.preferenceStore.gpuTileCache,this.preferenceStore.systemTileCache),this.layoutStore.applyLayout(this.preferenceStore.layout),this.cursorFrozen=this.preferenceStore.isCursorFrozen,this.connectToServer()}))}))})),Object(s.h)((()=>{this.backendService.connectionStatus===m.c.ACTIVE?setTimeout(this.hideSplashScreen,500):this.showSplashScreen()}))}get zfpReady(){return this.tileService&&this.tileService.workersReady}setActiveFrame(e){if(this.animatorStore.serverAnimationActive)return;this.activeFrame&&this.activeFrame.frameInfo.fileId!==e&&(this.activeFrame.renderType=f.J.NONE);const t=this.getFrame(e);t?this.changeActiveFrame(t):console.log(`Can't find required frame ${e}`)}setActiveFrameByIndex(e){this.animatorStore.serverAnimationActive||(e>=0&&this.frames.length>e?this.changeActiveFrame(this.frames[e]):console.log(`Invalid frame index ${e}`))}changeActiveFrame(e){e!==this.activeFrame&&(this.tileService.clearGPUCache(),this.tileService.clearRequestQueue()),this.activeFrame=e,this.widgetsStore.updateImageWidgetTitle(this.layoutStore.dockedLayout),this.catalogStore.resetActiveCatalogFile(e.frameInfo.fileId),this.syncContourToFrame&&(this.contourDataSource=e)}get frameLockedToContour(){return this.syncFrameToContour&&this.syncContourToFrame}getFrame(e){return-1===e?this.activeFrame:this.frames.find((t=>t.frameInfo.fileId===e))}get selectedRegion(){return this.activeFrame&&this.activeFrame.regionSet&&this.activeFrame.regionSet.selectedRegion&&0!==this.activeFrame.regionSet.selectedRegion.regionId?this.activeFrame.regionSet.selectedRegion:null}delay(e){return new Promise((t=>{setTimeout(t,e)}))}recalculateStatsRequirements(){if(!this.activeFrame)return;const e=O.l.CalculateRequirementsArray(this.widgetsStore.statsWidgets),t=O.t.DiffRequirementsArray(this.statsRequirements,e);if(this.statsRequirements=e,t.length)for(const i of t)this.backendService.setStatsRequirements(i)}recalculateHistogramRequirements(){if(!this.activeFrame)return;const e=O.l.CalculateRequirementsArray(this.widgetsStore.histogramWidgets),t=O.h.DiffRequirementsArray(this.histogramRequirements,e);if(this.histogramRequirements=e,t.length)for(const i of t)this.backendService.setHistogramRequirements(i)}recalculateSpectralRequirements(){if(!this.activeFrame)return;const e=O.s.CalculateRequirementsMap(this.widgetsStore.spectralProfileWidgets);this.widgetsStore.stokesAnalysisWidgets.size>0&&O.u.addToRequirementsMap(e,this.widgetsStore.stokesAnalysisWidgets);const t=O.s.DiffSpectralRequirements(this.spectralRequirements,e);this.spectralRequirements=e,t.length&&t.forEach((e=>this.backendService.setSpectralRequirements(e)))}recalculateSpatialRequirements(){if(!this.activeFrame)return;const e=O.o.CalculateRequirementsMap(this.activeFrame,this.widgetsStore.spatialProfileWidgets),t=O.o.DiffSpatialRequirements(this.spatialRequirements,e);this.spatialRequirements=e,t.length&&t.forEach((e=>this.backendService.setSpatialRequirements(e)))}},et.staticInstance=void 0,et.DEFAULT_STATS_TYPES=[g.a.StatsType.NumPixels,g.a.StatsType.Sum,g.a.StatsType.FluxDensity,g.a.StatsType.Mean,g.a.StatsType.RMS,g.a.StatsType.Sigma,g.a.StatsType.SumSq,g.a.StatsType.Min,g.a.StatsType.Max,g.a.StatsType.Extrema],et.CursorThrottleTime=200,et.CursorThrottleTimeRotated=100,et.ImageChannelThrottleTime=500,et.RequirementsCheckInterval=200,x=tt,C=Object(r.a)(x.prototype,"astReady",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=Object(r.a)(x.prototype,"cartaComputeReady",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=Object(r.a)(x.prototype,"frames",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(r.a)(x.prototype,"activeFrame",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Object(r.a)(x.prototype,"contourDataSource",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(r.a)(x.prototype,"syncContourToFrame",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(r.a)(x.prototype,"syncFrameToContour",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(r.a)(x.prototype,"spatialProfiles",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(r.a)(x.prototype,"spectralProfiles",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(r.a)(x.prototype,"regionStats",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(r.a)(x.prototype,"regionHistograms",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(r.a)(x.prototype,"spatialReference",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=Object(r.a)(x.prototype,"spectralReference",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(r.a)(x.prototype,"rasterScalingReference",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=Object(r.a)(x.prototype,"activeLayer",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=Object(r.a)(x.prototype,"cursorFrozen",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z=Object(r.a)(x.prototype,"splashScreenVisible",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),W=Object(r.a)(x.prototype,"showSplashScreen",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.splashScreenVisible=!0}}}),G=Object(r.a)(x.prototype,"hideSplashScreen",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.splashScreenVisible=!1}}}),V=Object(r.a)(x.prototype,"setImageViewDimensions",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.overlayStore.setViewDimension(e,t)}}}),B=Object(r.a)(x.prototype,"imageToolbarVisible",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=Object(r.a)(x.prototype,"showImageToolbar",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageToolbarVisible=!0}}}),q=Object(r.a)(x.prototype,"hideImageToolbar",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.imageToolbarVisible=!1}}}),Y=Object(r.a)(x.prototype,"username",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),U=Object(r.a)(x.prototype,"setUsername",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.username=e}}}),X=Object(r.a)(x.prototype,"connectToServer",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{let e=window.location.href.replace(window.location.search,"").replace(/^http/,"ws").replace(/\/$/,"");e=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_DEFAULT_ADDRESS_PROD?Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_DEFAULT_ADDRESS:"ws://localhost:3002"}).REACT_APP_DEFAULT_ADDRESS_PROD:e;const t=new URL(window.location.href),i=t.searchParams.get("socketUrl");i?(e=i,console.log(`Connecting to override URL: ${e}`)):console.log(`Connecting to default URL: ${e}`);const n=t.searchParams.get("folder"),r=t.searchParams.get("file");let o=!1;h.onReady.then(Object(s.s)((()=>{h.setPalette(this.darkTheme?f.W:f.V),this.astReady=!0,this.backendService.connectionStatus===m.c.ACTIVE&&!o&&r&&this.loadFile(n,r,"")}))),this.backendService.connect(e).subscribe((t=>{console.log(`Connected with session ID ${t.sessionId}`),this.logStore.addInfo(`Connected to server ${e} with session ID ${t.sessionId}`,["network"]),this.astReady&&r&&(o=!0,this.loadFile(n,r,"")),this.preferenceStore.autoLaunch&&!r&&this.fileBrowserStore.showFileBrowser(f.g.File)}),(e=>console.log(e)))}}}),$=Object(r.a)(x.prototype,"handleThemeChange",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.systemTheme=e?"dark":"light"}}}),K=Object(r.a)(x.prototype,"taskProgress",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Q=Object(r.a)(x.prototype,"taskStartTime",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(r.a)(x.prototype,"taskCurrentTime",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),J=Object(r.a)(x.prototype,"fileLoading",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=Object(r.a)(x.prototype,"resumingSession",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=Object(r.a)(x.prototype,"restartTaskProgress",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.taskProgress=0,this.taskStartTime=performance.now()}}}),ie=Object(r.a)(x.prototype,"updateTaskProgress",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.taskProgress=e,this.taskCurrentTime=performance.now()}}}),Object(r.a)(x.prototype,"estimatedTaskRemainingTime",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"estimatedTaskRemainingTime"),x.prototype),ne=Object(r.a)(x.prototype,"startFileLoading",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileLoading=!0}}}),re=Object(r.a)(x.prototype,"endFileLoading",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileLoading=!1}}}),Object(r.a)(x.prototype,"modifierString",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"modifierString"),x.prototype),oe=Object(r.a)(x.prototype,"systemTheme",[s.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(r.a)(x.prototype,"darkTheme",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"darkTheme"),x.prototype),Object(r.a)(x.prototype,"activeFrameIndex",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"activeFrameIndex"),x.prototype),Object(r.a)(x.prototype,"frameNum",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"frameNum"),x.prototype),Object(r.a)(x.prototype,"frameMap",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"frameMap"),x.prototype),Object(r.a)(x.prototype,"catalogNum",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"catalogNum"),x.prototype),Object(r.a)(x.prototype,"frameNames",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"frameNames"),x.prototype),Object(r.a)(x.prototype,"frameChannels",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"frameChannels"),x.prototype),Object(r.a)(x.prototype,"frameStokes",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"frameStokes"),x.prototype),Object(r.a)(x.prototype,"spatialGroup",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"spatialGroup"),x.prototype),Object(r.a)(x.prototype,"contourFrames",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"contourFrames"),x.prototype),se=Object(r.a)(x.prototype,"addFrame",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(!e)return!1;let n=`${e.fileInfoExtended.width}\xd7${e.fileInfoExtended.height}`;e.fileInfoExtended.dimensions>2&&(n+=`\xd7${e.fileInfoExtended.depth}`,e.fileInfoExtended.dimensions>3&&(n+=` (${e.fileInfoExtended.stokes} Stokes cubes)`)),this.logStore.addInfo(`Loaded file ${e.fileInfo.name} with dimensions ${n}`,["file"]);const r={fileId:e.fileId,directory:t,hdu:i,fileInfo:new g.a.FileInfo(e.fileInfo),fileInfoExtended:new g.a.FileInfoExtended(e.fileInfoExtended),fileFeatureFlags:e.fileFeatureFlags,renderMode:g.a.RenderMode.RASTER,beamTable:e.beamTable};let o=new f.v(r);const s=this.frames.findIndex((t=>t.frameInfo.fileId===e.fileId));-1!==s?(this.frames[s].clearContours(!1),this.frames[s]=o):this.frames.push(o),1===this.frames.length&&(this.setSpatialReference(this.frames[0]),this.setRasterScalingReference(this.frames[0]),this.setContourDataSource(this.frames[0])),o.frameInfo.fileInfoExtended.depth>1&&(1===this.frames.length||!this.spectralReference)&&this.setSpectralReference(o);const a=o.frameInfo.fileId;return this.setActiveFrame(a),this.catalogStore.updateImageAssociatedCatalogId(a,[]),o.frameInfo.fileInfoExtended.depth<=1&&o.frameInfo.fileInfoExtended.stokes<=1?this.animatorStore.setAnimationMode(f.c.FRAME):o.frameInfo.fileInfoExtended.depth>1?this.animatorStore.setAnimationMode(f.c.CHANNEL):o.frameInfo.fileInfoExtended.stokes>1&&this.animatorStore.setAnimationMode(f.c.STOKES),this.frames.length>1&&(this.preferenceStore.autoWCSMatching&y.WCSMatchingType.SPATIAL&&this.spatialReference!==o&&this.setSpatialMatchingEnabled(o,!0),this.preferenceStore.autoWCSMatching&y.WCSMatchingType.SPECTRAL&&this.spectralReference!==o&&o.frameInfo.fileInfoExtended.depth>1&&this.setSpectralMatchingEnabled(o,!0)),this.fileBrowserStore.saveStartingDirectory(o.frameInfo.directory),!0}}}),ae=Object(r.a)(x.prototype,"loadFile",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>new Promise(((n,r)=>{if(this.startFileLoading(),t){if(!e&&t.includes("/")){const i=t.lastIndexOf("/");i>=0&&(e=t.substring(0,i),t=t.substring(i+1))}}else{const i=e.lastIndexOf("/");i>=0&&(t=e.substring(i+1),e=e.substring(0,i))}this.backendService.loadFile(e,t,i,this.fileCounter,g.a.RenderMode.RASTER).subscribe((t=>{this.addFrame(t,e,i)||S.a.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3}),this.endFileLoading(),this.fileBrowserStore.hideFileBrowser(),n(t.fileId)}),(e=>{this.alertStore.showAlert(`Error loading file: ${e}`),this.endFileLoading(),r(e)})),this.fileCounter++}))}}),le=Object(r.a)(x.prototype,"appendFile",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>(this.animatorStore.stopAnimation(),this.catalogNum&&f.k.Instance.resetDisplayedData([]),this.loadFile(e,t,i))}}),ce=Object(r.a)(x.prototype,"openFile",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>(this.removeAllFrames(),this.loadFile(e,t,i))}}),de=Object(r.a)(x.prototype,"saveFile",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(!this.activeFrame)return;const n=this.activeFrame.frameInfo.fileId;this.backendService.saveFile(n,e,t,i).subscribe((()=>{S.a.show({icon:"saved",message:`${t} saved.`,intent:"success",timeout:3e3}),this.fileBrowserStore.hideFileBrowser()}),(e=>{console.error(e),S.a.show({icon:"warning-sign",message:e,intent:"danger",timeout:3e3})}))}}}),ue=Object(r.a)(x.prototype,"closeFile",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{if(!e)return;const i=e.secondarySpatialImages.concat(e.secondarySpectralImages).filter(b.q).length;t&&i?this.alertStore.showInteractiveAlert(`${i} image${i>1?"s that are":" that is"} matched to this image will be unmatched.`,(t=>{t&&this.removeFrame(e)})):this.removeFrame(e)}}}),he=Object(r.a)(x.prototype,"closeCurrentFile",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!0)=>{this.closeFile(this.activeFrame,e)}}}),pe=Object(r.a)(x.prototype,"closeOtherFiles",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!0)=>{const i=this.frames.filter((t=>t!==e));for(const n of i)this.closeFile(n,t)}}}),ge=Object(r.a)(x.prototype,"removeFrame",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){this.animatorStore.stopAnimation();const t=e.secondarySpatialImages.slice();for(const e of t)e.clearSpatialReference();const i=e.secondarySpectralImages.slice();for(const e of i)e.clearSpectralReference();const n=e===this.spatialReference,r=e===this.spectralReference,o=e===this.rasterScalingReference,s=e.frameInfo.fileId;if(f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.statsWidgets,s),f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.histogramWidgets,s),f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.spectralProfileWidgets,s),f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets,s),this.spectralRequirements.delete(s),this.spatialRequirements.delete(s),this.statsRequirements.delete(s),this.histogramRequirements.delete(s),this.tileService.handleFileClosed(s),this.backendService.closeFile(s)){e.clearSpatialReference(),e.clearSpectralReference(),e.clearContours(!1),this.frames=this.frames.filter((e=>e.frameInfo.fileId!==s));const t=this.frames.length?this.frames[0]:null;if(this.activeFrame.frameInfo.fileId===s&&(this.activeFrame=t),this.contourDataSource.frameInfo.fileId===s&&(this.contourDataSource=t),n){const e=t;e?this.setSpatialReference(e):this.clearSpatialReference()}if(r){const e=this.frames.filter((e=>e.frameInfo.fileInfoExtended.depth>1)),t=e.length?e[0]:null;t?this.setSpectralReference(t):this.clearSpectralReference()}if(o){const e=t;e?this.setRasterScalingReference(e):this.clearRasterScalingReference()}this.catalogNum&&(f.k.Instance.closeAssociatedCatalog(s),t&&f.k.Instance.resetActiveCatalogFile(t.frameInfo.fileId))}}}}}),fe=Object(r.a)(x.prototype,"removeAllFrames",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.animatorStore.stopAnimation(),this.backendService.closeFile(-1)&&(this.activeFrame=null,this.tileService.clearCompressedCache(-1),this.frames.forEach((e=>{e.clearContours(!1);const t=e.frameInfo.fileId;this.tileService.handleFileClosed(t),this.catalogNum&&f.k.Instance.closeAssociatedCatalog(t)})),this.frames=[],f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.statsWidgets),f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.histogramWidgets),f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.spectralProfileWidgets),f.U.RemoveFrameFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets))}}}),be=Object(r.a)(x.prototype,"shiftFrame",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.activeFrame&&this.frames.length>1){const t=this.frames.map((e=>e.frameInfo.fileId)),i=t.indexOf(this.activeFrame.frameInfo.fileId),n=(this.frames.length+i+e)%this.frames.length;this.setActiveFrame(t[n])}}}}),me=Object(r.a)(x.prototype,"nextFrame",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.shiftFrame(1)}}}),ye=Object(r.a)(x.prototype,"prevFrame",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.shiftFrame(-1)}}}),Oe=Object(r.a)(x.prototype,"appendCatalog",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>new Promise(((r,o)=>{this.activeFrame||(S.a.show(Object(S.e)("Please load the image file")),o()),n!==g.a.CatalogFileType.VOTable&&(S.a.show(Object(S.e)("`Catalog type not supported")),o()),this.startFileLoading();const a=this.activeFrame,l=this.catalogNum+1;this.backendService.loadCatalogFile(e,t,l,i).subscribe((t=>Object(s.s)((()=>{if(this.endFileLoading(),a&&t.success&&t.dataSize){let i,n={fileId:l,directory:e,fileInfo:t.fileInfo,dataSize:t.dataSize};const s=y.ProtobufProcessing.ProcessCatalogData(t.previewData);let a=[];const c=f.k.Instance,d=c.catalogProfiles.size;let u=c.activeCatalogFiles;if((null===u||void 0===u?void 0:u.length)?a=u:c.catalogProfiles.forEach(((e,t)=>{c.catalogProfiles.set(t,l)})),a.push(l),c.updateImageAssociatedCatalogId(nt.Instance.activeFrame.frameInfo.fileId,a),0===d){const e=this.widgetsStore.createFloatingCatalogWidget(l);i=e.widgetStoreId,c.catalogProfiles.set(e.widgetComponentId,l)}else{i=this.widgetsStore.addCatalogWidget(l);const e=c.catalogProfiles.keys().next().value;c.catalogProfiles.set(e,l)}if(i){this.catalogStore.catalogWidgets.set(l,i),this.catalogStore.addCatalog(l),this.fileBrowserStore.hideFileBrowser();const e=new f.j(n,t.headers,s);c.catalogProfileStores.set(l,e),r(l)}else o()}else o()}))),(e=>{console.error(e),S.a.show(Object(S.e)(e)),this.endFileLoading(),o(e)}))}))}}),Object(r.a)(x.prototype,"removeCatalog",[s.g],Object.getOwnPropertyDescriptor(x.prototype,"removeCatalog"),x.prototype),Object(r.a)(x.prototype,"sendCatalogFilter",[s.g],Object.getOwnPropertyDescriptor(x.prototype,"sendCatalogFilter"),x.prototype),je=Object(r.a)(x.prototype,"reorderFrame",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{!Number.isInteger(e)||e<0||e>=this.frameNum||!Number.isInteger(t)||t<0||t>=this.frameNum||!Number.isInteger(i)||i<=0||i>=this.frameNum||e===t||(this.frames=u.a.reorderArray(this.frames,e,t,i))}}}),Se=Object(r.a)(x.prototype,"importRegion",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(!this.activeFrame||i!==g.a.FileType.CRTF&&i!==g.a.FileType.DS9_REG)return void S.a.show(Object(S.e)("Region type not supported"));const n=this.activeFrame;this.backendService.importRegion(e,t,i,n.frameInfo.fileId).subscribe((e=>{if(n&&e.success&&e.regions){const t=new Map(Object.entries(e.regions)),i=new Map(Object.entries(e.regionStyles));t.forEach(((e,t)=>{const r=i.get(t);n.regionSet.addExistingRegion(e.controlPoints,e.rotation,e.regionType,parseInt(t),null===r||void 0===r?void 0:r.name,null===r||void 0===r?void 0:r.color,null===r||void 0===r?void 0:r.lineWidth,null===r||void 0===r?void 0:r.dashList)}))}this.fileBrowserStore.hideFileBrowser()}),(e=>{console.error(e),S.a.show(Object(S.e)(e))}))}}}),xe=Object(r.a)(x.prototype,"exportRegions",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n)=>{const r=this.activeFrame;if(!r.regionSet.regions||r.regionSet.regions.length<=1)return;const o=new Map;for(const s of r.regionSet.regions)o.set(s.regionId,{name:s.name,color:s.color,lineWidth:s.lineWidth,dashList:s.dashLength?[s.dashLength]:[]});this.backendService.exportRegion(e,t,n,i,r.frameInfo.fileId,o).subscribe((()=>{S.a.show(Object(S.v)("saved",`Exported regions for ${r.filename} using ${i===g.a.CoordinateType.WORLD?"world":"pixel"} coordinates`)),this.fileBrowserStore.hideFileBrowser()}),(e=>{console.error(e),S.a.show(Object(S.e)(e))}))}}}),Ce=Object(r.a)(x.prototype,"requestCubeHistogram",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.renderConfig.cubeHistogramProgress<1&&(this.backendService.setHistogramRequirements({fileId:t.frameInfo.fileId,regionId:-2,histograms:[{channel:-2,numBins:-1}]}),this.restartTaskProgress())}}}),Ie=Object(r.a)(x.prototype,"cancelCubeHistogramRequest",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.renderConfig.cubeHistogramProgress<1&&(t.renderConfig.updateCubeHistogram(null,0),this.backendService.setHistogramRequirements({fileId:t.frameInfo.fileId,regionId:-2,histograms:[]}))}}}),we=Object(r.a)(x.prototype,"requestMoment",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&t&&(this.startFileLoading(),t.momentImages&&t.momentImages.length>0&&t.momentImages.forEach((e=>this.closeFile(e))),t.removeMomentImage(),this.backendService.requestMoment(e).subscribe((e=>{e.success?!e.cancel&&e.openFileAcks&&e.openFileAcks.forEach((e=>{this.addFrame(g.a.OpenFileAck.create(e),this.fileBrowserStore.startingDirectory,"")?(this.fileCounter++,t.addMomentImage(this.frames.find((t=>t.frameInfo.fileId===e.fileId)))):S.a.show({icon:"warning-sign",message:"Load file failed.",intent:"danger",timeout:3e3})})):S.a.show({icon:"warning-sign",message:`Moment generation failed. ${null===e||void 0===e?void 0:e.message}`,intent:"danger",timeout:3e3}),t.resetMomentRequestState(),this.endFileLoading()}),(e=>{t.resetMomentRequestState(),this.endFileLoading(),console.error(e)})),this.restartTaskProgress())}}}),Te=Object(r.a)(x.prototype,"cancelRequestingMoment",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=-1)=>{const t=this.getFrame(e);t&&t.requestingMomentsProgress<1&&this.backendService.cancelRequestingMoment(e)}}}),ve=Object(r.a)(x.prototype,"setDarkTheme",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceStore.setPreference(f.G.GLOBAL_THEME,y.Theme.DARK)}}}),Ae=Object(r.a)(x.prototype,"setLightTheme",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceStore.setPreference(f.G.GLOBAL_THEME,y.Theme.LIGHT)}}}),Re=Object(r.a)(x.prototype,"setAutoTheme",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceStore.setPreference(f.G.GLOBAL_THEME,y.Theme.AUTO)}}}),Pe=Object(r.a)(x.prototype,"toggleCursorFrozen",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.cursorFrozen=!this.cursorFrozen}}}),Ee=Object(r.a)(x.prototype,"updateActiveLayer",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.activeLayer=e}}}),Fe=Object(r.a)(x.prototype,"handleSpatialProfileStream",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.frames.find((t=>t.frameInfo.fileId===e.fileId))){const t=`${e.fileId}-${e.regionId}`;let i=this.spatialProfiles.get(t);i||(i=new f.P(e.fileId,e.regionId),this.spatialProfiles.set(t,i)),i.updateFromStream(e),this.activeFrame&&this.activeFrame.frameInfo.fileId===e.fileId&&0===e.regionId&&this.activeFrame.setCursorValue({x:e.x,y:e.y},e.channel,e.value)}}}}),Me=Object(r.a)(x.prototype,"handleTileStream",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.animatorStore.serverAnimationActive){const t={fileId:e.fileId,animationId:0,receivedFrame:{channel:e.channel,stokes:e.stokes},timestamp:a.fromNumber(Date.now())};this.backendService.sendAnimationFlowControl(t);const i=this.getFrame(e.fileId);i&&(i.setChannels(e.channel,e.stokes,!1),i.channel=e.channel,i.stokes=e.stokes)}const t=`${e.fileId}_${e.stokes}_${e.channel}`,i=this.pendingChannelHistograms.get(t);if(i&&i.histograms&&i.histograms.length){const n=this.getFrame(i.fileId),r=i.histograms.find((e=>e.channel===n.channel));n&&r&&(n.renderConfig.setStokes(i.stokes),n.renderConfig.updateChannelHistogram(r),n.channel=e.channel,n.stokes=e.stokes),this.pendingChannelHistograms.delete(t)}this.activeFrame&&(this.activeFrame.renderType=f.J.TILED)}}}),ke=Object(r.a)(x.prototype,"handleCatalogFilterStream",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.fileId,i=this.catalogStore.catalogProfileStores.get(t),n=this.catalogStore.catalogWidgets.get(t),r=e.progress;if(i){const o=y.ProtobufProcessing.ProcessCatalogData(e.columns);if(i.updateCatalogData(e,o),i.setProgress(r),1===r&&(i.setLoadingDataStatus(!1),i.setUpdatingDataStream(!1)),i.updateMode===f.m.ViewUpdate){const e=this.widgetsStore.catalogWidgets.get(n),r=e.xAxis,s=e.yAxis;if(r&&s){const e=i.get2DPlotData(r,s,o),n=this.activeFrame.validWcs?this.activeFrame.wcsInfo:0;this.catalogStore.updateCatalogData(t,e.wcsX,e.wcsY,n,e.xHeaderInfo.units,e.yHeaderInfo.units,i.catalogCoordinateSystem.system)}}}}}}),De=Object(r.a)(x.prototype,"onResumeAlertClosed",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!e)return;this.animatorStore.stopAnimation(),this.tileService.clearRequestQueue();this.frames.filter((e=>e.frameInfo.fileId>=1e3)).forEach((e=>this.removeFrame(e)));const t=this.frames.map((e=>{const t=e.frameInfo;let i,n=new Map;if(!e.spatialReference){n=new Map;for(const t of e.regionSet.regions)n.set(t.regionId.toFixed(),{regionType:t.regionType,controlPoints:t.controlPoints,rotation:t.rotation})}return e.contourConfig.enabled&&(i={fileId:e.frameInfo.fileId,levels:e.contourConfig.levels,smoothingMode:e.contourConfig.smoothingMode,smoothingFactor:e.contourConfig.smoothingFactor,decimationFactor:this.preferenceStore.contourDecimation,compressionLevel:this.preferenceStore.contourCompressionLevel,contourChunkSize:this.preferenceStore.contourChunkSize}),{file:t.fileInfo.name,directory:t.directory,hdu:t.hdu,fileId:t.fileId,renderMode:t.renderMode,channel:e.requiredChannel,stokes:e.requiredStokes,regions:Object(b.R)(n),contourSettings:i}})),i=[];this.catalogStore.catalogProfileStores.forEach((e=>{const t=e.catalogInfo;i.find((e=>e.fileId===t.fileId))||i.push({fileId:t.fileId,name:t.fileInfo.name,directory:t.directory})})),this.resumingSession=!0,this.backendService.resumeSession({images:t,catalogFiles:i}).subscribe(this.onSessionResumed,(e=>{console.error(e),this.alertStore.showAlert("Error resuming session")}))}}}),Ne=Object(r.a)(x.prototype,"onSessionResumed",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{console.log("Resumed successfully"),this.initRequirements(),this.resumingSession=!1,this.backendService.connectionDropped=!1}}}),Object(r.a)(x.prototype,"zfpReady",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"zfpReady"),x.prototype),Object(r.a)(x.prototype,"setActiveFrame",[s.g],Object.getOwnPropertyDescriptor(x.prototype,"setActiveFrame"),x.prototype),Object(r.a)(x.prototype,"setActiveFrameByIndex",[s.g],Object.getOwnPropertyDescriptor(x.prototype,"setActiveFrameByIndex"),x.prototype),Le=Object(r.a)(x.prototype,"setContourDataSource",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.contourDataSource=e,this.syncFrameToContour&&this.setActiveFrame(e.frameInfo.fileId)}}}),Object(r.a)(x.prototype,"frameLockedToContour",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"frameLockedToContour"),x.prototype),_e=Object(r.a)(x.prototype,"toggleFrameContourLock",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.frameLockedToContour?(this.syncFrameToContour=!1,this.syncContourToFrame=!1):(this.syncContourToFrame=!0,this.syncFrameToContour=!0,this.contourDataSource=this.activeFrame)}}}),Object(r.a)(x.prototype,"selectedRegion",[s.i],Object.getOwnPropertyDescriptor(x.prototype,"selectedRegion"),x.prototype),ze=Object(r.a)(x.prototype,"deleteSelectedRegion",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.activeFrame&&this.activeFrame.regionSet&&this.activeFrame.regionSet.selectedRegion&&!this.activeFrame.regionSet.selectedRegion.locked&&this.deleteRegion(this.activeFrame.regionSet.selectedRegion)}}}),We=Object(r.a)(x.prototype,"deleteRegion",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e){const t=this.getFrame(e.fileId),i=e.regionId;f.U.RemoveRegionFromRegionWidgets(this.widgetsStore.statsWidgets,e.fileId,i),f.U.RemoveRegionFromRegionWidgets(this.widgetsStore.histogramWidgets,e.fileId,i),f.U.RemoveRegionFromRegionWidgets(this.widgetsStore.spectralProfileWidgets,e.fileId,i),f.U.RemoveRegionFromRegionWidgets(this.widgetsStore.stokesAnalysisWidgets,e.fileId,i),t&&t.regionSet.deleteRegion(e)}}}}),Ge=Object(r.a)(x.prototype,"setSpatialReference",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.spatialReference,i=t&&t.secondarySpatialImages.includes(e);this.spatialReference=e,i&&t.setSpatialReference(e);for(const n of this.frames)n===e?n.clearSpatialReference():n.spatialReference&&n.setSpatialReference(e)}}}),Ve=Object(r.a)(x.prototype,"clearSpatialReference",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spatialReference=null;for(const e of this.frames)e.clearSpatialReference()}}}),Be=Object(r.a)(x.prototype,"setSpatialMatchingEnabled",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.spatialReference&&(t?e.setSpatialReference(this.spatialReference)||S.a.show(Object(S.z)(`Could not enable spatial matching of ${e.filename} to reference image ${this.spatialReference.filename}. No valid transform was found`)):e.clearSpatialReference())}}}),He=Object(r.a)(x.prototype,"toggleSpatialMatching",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.spatialReference&&this.setSpatialMatchingEnabled(e,!e.spatialReference)}}}),qe=Object(r.a)(x.prototype,"setSpectralReference",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.spectralReference,i=t&&t.secondarySpectralImages.includes(e);this.spectralReference=e,i&&t.setSpectralReference(e);for(const n of this.frames)n===e?n.clearSpectralReference():n.spectralReference&&n.setSpectralReference(e)}}}),Ye=Object(r.a)(x.prototype,"clearSpectralReference",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralReference=null;for(const e of this.frames)e.clearSpectralReference()}}}),Ue=Object(r.a)(x.prototype,"setSpectralMatchingEnabled",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.spectralReference&&(t?e.setSpectralReference(this.spectralReference)||S.a.show(Object(S.z)(`Could not enable spectral matching (velocity system) of ${e.filename} to reference image ${this.spectralReference.filename}. No valid transform was found`)):e.clearSpectralReference())}}}),Xe=Object(r.a)(x.prototype,"toggleSpectralMatching",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.spectralReference&&this.setSpectralMatchingEnabled(e,!e.spectralReference)}}}),$e=Object(r.a)(x.prototype,"setRasterScalingReference",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.rasterScalingReference,i=t&&t.secondaryRasterScalingImages.includes(e);this.rasterScalingReference=e,i&&t.setRasterScalingReference(e);for(const n of this.frames)n===e?n.clearRasterScalingReference():n.rasterScalingReference&&n.setRasterScalingReference(e)}}}),Ke=Object(r.a)(x.prototype,"clearRasterScalingReference",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.rasterScalingReference=null;for(const e of this.frames)e.clearRasterScalingReference()}}}),Qe=Object(r.a)(x.prototype,"setRasterScalingMatchingEnabled",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&e!==this.rasterScalingReference&&(t?e.setRasterScalingReference(this.rasterScalingReference):e.clearRasterScalingReference())}}}),Ze=Object(r.a)(x.prototype,"toggleRasterScalingMatching",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e!==this.rasterScalingReference&&this.setRasterScalingMatchingEnabled(e,!e.rasterScalingReference)}}}),Je=Object(r.a)(x.prototype,"setMatchingEnabled",[s.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.setSpatialMatchingEnabled(this.activeFrame,e),this.setSpectralMatchingEnabled(this.activeFrame,t)}}}),x)},180:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHQAAAA2CAYAAAAWCr1AAAAABHNCSVQICAgIfAhkiAAAA0JJREFUeJztm+Fx2kAQRl8yLkBJCUoH1EA6oAalA1JChnTgtEA6ICWYdIBLMO6A/DhttFwO3QkEwfC9GWawdBJwq91vd+8MQgghhBBCCCGEEEIIIYQQQgghhBBCCCHuiimwBnbABngceH0NNEA18ve6ZSpgTjfvO2AFzBJja2AJbOlstODAfC/aAdN2QOMuKqF2X2hZeM29MyEYZ9m+t2NmXO9Qs3bsnDDXEGy1aV97Rm0SB72BmoIvt0AGHcKUMFfTxLmKbi5ndIafRGM2btzcTpjh/GDav4cYyIeMkgfgnqkJBkqFVWNFmMs1wXDxnM7p5ntHcCgguHVKKxs3uERL/c3jh+NY7Ifv/tNry3nygSXOAAcwg9r3iIkNWj3QaeWnxAVf3Pt15sN92HgFfmfGl/ICPNFpxqV5PsM9p+3rQ2ac/80/Eue/E+a6An6272lIG8vr5478U+r1c5UZe++UeCccEfHeEwz1LXHOx/a/1u/Be6gM2k9FXsJiA54c8Xz21CfcsJ+Rjamf94zXx5MdJA63OWYDx4s8PiE6uWLwT0dJufKI9HNsvIOcnBD6ejJV9MYki1txNL7+T5UrgxgabqWf43N0x+0hccwnQL8K7hF78Fj1p1ERftRHLt/wfyXUwZ8v/LmjVgxeD0vC57n181Y7RX0M0c8aN+8pD/U3KOmSnLv+fCbfUbkl4o5bzgZfc2N8QpTTw1hvpZ95akLkO1TbD4l4lr/0zruvf3IG8uKt+jNP7AApSfPykkuIFhQsmvgatK9D5FNr1Z9lxA4QNwwWhAhpUbJvTm2xO6vvFd1TcuiGE/5NVFR/5vHOEm8msDmt6Tpvh2pQM2axxNlK+o7g0vbBk/ZvW5iVfg7DnMW2+UCnqVv2EyLz5lU7pmrP236iwfNtG5d8F2hD54l+8Vv6WU5Ft3fLvHBJujyZEgxq0XDNGSPhEunnTeE1NLe8Jq4cr7EKt1dKQ/C6NXnB9bWqstsrJK4p+4pV752lG7DFhYm3A/Zpos96VapcKVbzbOnfjeb7jNpIfcVY56EP78Uy5htgTboZbAvM5sEKs28EM5x1Lh7psln7jydx5bxLHKsJXlgTFlifGH9biTgTfwDNQH5tiO194AAAAABJRU5ErkJggg=="},181:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWMAAAA2CAYAAAAS9vgRAAAABHNCSVQICAgIfAhkiAAAC3hJREFUeJztnf1xGzkSxd9tOYBZZ3C8DHR7GfAyoNcRnJyBXI5gi86AVgR7cgZ0Bms5AymDk5SB7w/Mq3kDYWYADOaDZP+qWPrgzBAEGo1Go9EADMMwDMMwDMMwDMMwDMMwDMMwDLJbugDG2VEB2C5dCMM4Je4AHJcuhHGW3AM4LF0IwzgFjgAeli6EcbZUcPJ1t3RBDGPN3AF4huswhjEVGzg5Mwt5ZWwA7OEahtPjB7jG2i9YrktjD+AnzKdnzMMWTt6uly6I0bCDa5TQy0bOeWAbWH0bsVxj/AzqDk7ursYXxyhJBdfApozn57l+GUYMVKJjI24qOLmzNYqVcoQp4zk5wKaLRhw7OOXJ/lki/PGmftZNgWcZhaFyMGU8PVdw9WyWiaFUcLKxhRukaQn7r1Kx6FTwr9wevxT6AMNYO3vvp2EATgHfw81SD3CK+TOAf0/0eV/qn7cTPd/IxCzjedigqWcLZVueI9YTe7uBU8AbtGWjwjSWcacsmmVsXAIf659fAbwsWRADgHMJrCWq4BHAj/rnHLLxCOBb/Xtr7cKUsXEJUOj/XLQUhvJ26QIsCGcFH/SfpoyNc0enl986rzKM+aAcbiAbj0wZG+cOF2J+wFwUxjp4rF8A8I7/NGVsnDu/1z/NKjbWxI/652/8R0gZb+FCPRiTmbrKv0GZ7YNGPBXcdPwaLqB8h3ILJJv6eTf18/uey1jNm/q+pdEV8r8m/hz97jtMI/9V/Xz2z59wkQmhlf4NmmRI7Mv7icplpEN57OxPe7hG26K9ZTc2UF7DNtYSurJmxoa26cDJOMk9msD1MQmIrvB6UNbOzedW9XvPUgbet3QiHs0FMsXgwBjVn2hy1+r3Pxb83Cu4Or5D04G1jVR+uHtMB8UtXDs+YHmFTNlcM1OFthEmDwr2k2u8bihVrjFbSJkNy5RxHLnKuEKzlfqI7s7F7ZfPSFOMvK9LCNnOzPPgb+98wDpip1UeS0LFRjkPKVwdCIbqfkg5suOGnqNKgzOiZ7QtLubV5XVLb8c1Zdx+fqs9qHR9k/kKacpVp0+2/3+YHGW8QZqy0zaMaRNNYNR3PQeDZ7xWRldwinBpV4Xm/iiFDlRD9al12efeuUe3wmY+3D5lwO95Dycbfrm0zDqrWQpTxo5g3z/4/6i57rph4OElU8VRGLtST079mjIBeaoyVgvnPuFzYq00FcChzqLTrJSyzAnrqlTH1/aK7Zzqsw1BQ6iLOwwrTx10Qt/VV8bmphhmDmVM2TgCwBs0vuF/BC7WoOShDqed/AXNauFYngB8x3JW1uPwJbNxi6Ye/pNw31e478FFnb8jHOb1SX4fij74Lr9f1a9SbV4K1tVTgWft0VicX+DqNIZvcB2Zi3x+vX7oeda2fv068BnaN74E3v8M194VbBfimnhEsxUbQLMI4aP+4pjRVP1zdsBjHCmWsbobcjKPqXXU9VnqV4yZyuqMZY1uqVKWu84sUute6z3k6uvz58dYxUC7n65lm3EfZhk7Wm60X+oP/SNwoX54zGiqAmXKuDzaKXNiZvWertBD3aL6v4hnqsX5z4wyzcUYy7hCO8NWqr9VZ1a+otzBla2rPRmp0of/zLXNToxI3sBNYUKoi2JoTz9zghILsC+PDnY5lrHvbtni9fT4Cfn+xLVNffV7jCnbJ3nWC8JugD603n1X2yc0SYxCxKRxVLmwfndatOTyTcdFG7QFZ8g/5k+zbHQui1+/OcrFv+c9Xrcr/cpAeA3BRy3pNSdtH2MZa9jRfzPu72orbgyJ9T13oQp7rnDSCt0hfSnPyJWZR0yXb3gxupSx76IYQivGRufy+EJfYkEqZAEf0Cj+3wLv+/frM3IU1drx/YQllF0Fp6D36LeKY1nCMn4LJx9jozJylflbNPV4ykTlM34vv8eEXJm/eFp8oS8hhKGOwKgLwLmd+jrb7/I7V+vXhJYnN13je+/vUspuD1fPY61idQ2+YL7In0e4CI+/Zb5Y3tz7f8X65C0HyuULEFbGzHxPhgSwQrtjm2VcHl/wSsSJdgmzznK6joap0CxkfUMZC29KcutL+0EpRbeFc328G7owAh0srN+dHi25DLkpUvO/Tu0vpn+KU5M5eYFzCSztn/LdEiUSc3cplyd5bwdX9x/r/1Vw7X2Lxt9ZQqlMBWNrc+tLjYxSyvgWrs5KWHY2Iz1tKJdPQFgZ68JNTANP7S8u5Z/KhR16yWmRX685deHf05XF7BbONfUZLgTuA9oLLS91ef7A+hdqGVQ/JkKE95b6rikbRoZImcFu4Np1acPCaGjJVpebgsRYA1OPzmP9U2Nfa/BP+Tsa/5XxDH9Brksh7NB07C9w8cOsB/58h/UrYqDZJZi7UKTyXypaJBTTn4O/43Wor36MuMaYDzUQHoGwMn7rX9SDHwJnfqvp0E6ck5rSn8GE2rZPaS09IOWgCjTHOv4+fMkguS6mDZrcyCHUPTRUTqY8WDqLntGgcvAXEFbGKWFTH7y/T8FaOlW+oqlfJpNPQbcr++3m40cRnCoqj0OheiE0lC1nhyHzDafCzHzMTR1KeanRLEMD5Se4WY71z/UQtTg8lMtWH6Z7t20BIZ3UrG2awS5l2pyS9jEmu9spwe+Tm8OXaWFTcyncoEl9qTkI/O3L13hd15rnJdRm+7pcmsS+CyaaXzpTm2K5Kdo5wXsL0UrtFuAKr9NaLp2w+hTRTho7mGndx2xC0CQ3MXkVeEoIFT47/bF+7w5NylVmMhuTnGZbP0vTXR5RbjCgwsrdsKEDYEz98ZAGTfqvbaCKtSuPuA6e/oEPbH8eh9XXoamI15Y86BSUsaaIjW37FNj3B+VSC3JAIwxXaI7YUQE7lWxRS8MORP+dnzv5UL/HlIt9z9G8xqG6Z5KZ1Kxq/qkQsa/QiR99bNAI5AHN99Vydw1QKYo6ygIZQOtbjz3iezu0j54KtQcHuXs0uVweEK4zGkQ8Ao2fQ2tbvz+/H494Yvghj8haY79ckzKmy0/PkAz1TdYxz4LkPbmLw0kWNw8/1I6pwqOJ539mFujS8AewvldMI+3QtM8DGstVp9aph1D6Sjz1RWXTR+/5XzWqqP3ypXRkTQU7VjHR5UBLmQrzCNcfhjqm9qeug0QJN9bojKErH8TWK9c91j1TXZMy9lMFp75yUseq/BdxH+l01vzF8fg5HVLfD6EnOI85HVoPoGWazVBZuOuSJyKrLPD+LmKPgdLrVAHx81Lg4LT0cUOGY03KGGjkPLbfpV7vo7OZIqjPeIrEy8a8UEByTw/WQ1L7FK1ab0PwWWrl9Z0X1wVnJGvOLHdJrE0Zzw37QJF1Ed+5bZw2aoWOncr3KVuNEogRRJ3Ss5y5CpXlWqMP9dK45IExyjC4hhPYrgUhRS2gNfumjDi4el/CWlF/s48u9sVA9wIV+5CftQ9+x7ly/hrdMDLnEqHu7HTR+THDfTGvahVf6uh2blCBlmhPDctS/AidGCi4jN4Ze5YdLe2lDrc1Lhvq2V459o/y7rM+NLrCpnzngUbGjF3dpQL1BU5lLHY25cc8j1WiHBAu1SozloUzvV69qbGYfSvOOXGrxmmQspGki76QtZue97pQeSu1SEwFb4aEMSf0FQ/OCrlTp4+ULbXG6aE7zXISymgMdcjyVUUdqwj7/M+5cFOLudiMuWBsfLSb7R5hq4jJ3Wk5m0VxvvhtHbNh5BrN9Et3jIWenWLl+lvuS8JAf8tiZswBN+REuwDZEbnT54D2AopFTVwOuu2dSvaIJifFEe21gwPiBmm6w/pcIdx5RpnzN35wh+BYaKmbXBtTQpnPMmJ1N9fYJDDG6aM77fwdfjkLarS8/XwUTBj0jHY+FBoEN2g2lpTaSUeFbJuWjCngwrjpUGO18Gw9P1Mbt2D7HNB2nZQkN+ewYfRRwclVtMHyfxz8UZozq4TzAAAAAElFTkSuQmCC"},182:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAA2CAYAAABA8JJzAAAABHNCSVQICAgIfAhkiAAABLFJREFUeJztnfFx2jAUxr/eZQC3I7gbMIO7ATPQDbjrCHQDugLdIBkhZAMyQskG6R/yix6ybMlGlgj+fndcCDFYyM/f+/QkOwAhhBBCCClIA+AM4D3n40uWr0Y+A2cAVelGkGWygVGkU+mGkGVyggnATemGkOWxhgm+c+mGkGVC9SPFoPqRohxhAnBbuiFkeTSg+pGCUP1IMVawsxEsPpPsPMIE3650Q8jyoPqRolD9SDFqUP1IQQ4wwbcv3RCyPLT61YXbQhbIHp9E/RrYIuUJ4xtcw0xs02PcDhXSqF8FU7iW+HiHGdSsPdvWMClfVlmfYAY+g3Gxazds2g3HLlTUMn+IfA+ZH1G/a47JCiaYDu1zeU2CUQvVut12CxvwDUwcndAThBvPH3VAxSzX2YEBeGukUD+ZN24Cn7+GDdSVs81JbdeZ/pNAWzmv66JlTEBpaeb6sttAROFx4vtrmIDypVlBaotHmEBzj/0WlxcjdWqQe/i9nqTgWPOqd+IG81SkA7JeraUen/liHa1OU4/HAeGitQRg3+oaNwA/+vMB1ut997zxp3p+DDRCy/MbgJfA9rH8A/CMcqWD10L7TcGv9ucTph2Ppn18DWynj80fz99/w8REBeBv+/yDDfzBpf1fTOVc+7+pcr90Nkh7oknmmFP9gCsz3xb+/K5lc6z/4xqzcdSw/Zfq5JXjF8pcQzwifELoccL7FfvqoEctQwYUuPQaKf3fEpDrMlL3n6ifb+SaEi1UyTKfm35DuJ1I4hDborNHihKWDB6vUb9Y9AAkWeVjbPqVQif9XxwVbMmiRjeDxHjuIXKpH3DZ5mT+VZ+RMV9isMhIOqzQ7SdZqdJbK4sk5202tP9LdnHT2PRL/5cG18xPtTIiBiHfnoKrZ74ePK/phj9FfIarkKnqf0IF8+W+IX9B+A2mDvkjw75eYPpb9+cWpoYWyxpGQF5h6m1zo9uazHppPxeTTuf2f0uaCZE516lpLfdtNsb4vxqR8aFHNTEyTv+XFt2fY1Jp7tts6JMlZp99070d9AAk5Odcv0j/dz1uSSu2lCLHLZX61eifpADGZT4ZJ0TFh1bA0Bu0CWX9Lx2u5QhVIlLfZsMVFl9m020MDUB2GLGwWdcAh+TfHbWx/pcOd/VIqG9T32bDFRZXVXftPmOmD2VxarSPrmCju++DV+iepfR/aXEHQ30mf46bDOkTwF2kLMe+Rth3SvCNtmbaYO5VA1bt77JAkf5vPlwV6kthYplSCoCIkFyeAVhPeMalJdALXmVWp4G9HmRyXMgFKHpUdoL9onqxKv1femKm5+a8zUYFe42QqNwBfiVuYAJQsuIRGTKinjqi/5uH0PTcom+zoT1gjmmfJeIO9LTXWvRtNtyKPZkPXRbTI1JRx7tRvw3MGXZE2DjqTuHod17ck12WcN2V+rlSP1Q01B3C/6yTB3d6Tn6/+dtsxOIWPoc8ne4Mll7y4Fu2fzfqB9hazhnDnkLP//HC87y4hf+7UT/AVqyH0CrJ4MuPm6Xu7hZrR/gnlWVBqCgk0245Yif/PyUSaFLx3sOOduVOR6QsG5hjcjfez/cPq2sYlathlqQ/I/0ye0IAAP8BHHRs/vN5DEkAAAAASUVORK5CYII="},183:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIYAAAA2BAMAAADwnfzXAAAAMFBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv3aB7AAAAD3RSTlMARM3dmSJmEImrMu+7dlS6miBPAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACyElEQVRIDaWWz2sTQRTHX36su12SNNSzFOJBFCRUwXpLDoKCYvYkSG0b9KaI0YNYrCT/QXP0x6G5B0lVRCrIFop4UEwR8Why9xBNtWpT+3wz2yY7+ysbZg7DzPvxycyb78wGQKal1p9flMmnXOXD9UPmlBwkVgS4g20pyDnKVvC3FAOrlL78T4ah4C9Kb+3IMFS+jU5XhgFPDbaOv1IMnixXD46wNiS3lDgW5QCU3fgjjVDNijQjKqUw6+ebaellJF5KI2C9BDAhhxk7Qvmf5RiPWPpxKUa8m8lksj+kGAVkjb1BE5t5TrpE9Rne1E/4EeCyeboEOkfgdwBt6u4mS1X4qzQUUn+sZ/OpN8bBaVvotZLCr40WihGh3Zd36zU1ZxOosk1rqhIzGuoCzrQBEt1TkETbXYvn4QDmiTGONep5m7E22u9f7TsAHtIwgSvEsD3nZWNvBZO9fuTiSbG963siKzSMYQXgptE3wlWAeSzRfGlnYPQdjVXIZVuxFfh1/1XN2orky0iwX2+g25/bJZuK226Pt8Xji6IwlUCK995JDmtzy2EAKnGVbHFcc3l8DPzzJvqimCZDDDdEs+9Mp6N1tnleovJAHs4Ax9xL0FaJOrZiLx4W9HFiTaB4CbrAD7Vgk0eATok2jgb1VwRukx0t2O+Q4HZNLEGfEexZJgwlnDxm2wB8xaqopiabaqHkoSDt22R/FrQ8dYPWYntphJKHhlugZVjlvpUGABrdJ5tuhpJHEqehPkcXPPVaQEAEz+rnO1gTrZ4z9UV69hksvb39xBn9ILe5ccsmD890y3gvt2pA5H3XU9PLNnkEMAJdJhdJYMgwZyTU0fpSbhwjVyLUsfgxdPxJrkn+mfKLGWZPIqtETpTusCSHX+tV2CNWdJhHmqbYo9Ryv5AjQY4CLPRqI6W4ghdWL/Q8ZeeKDDDMfakFeEO4/gOmeAdS5mBkMwAAAABJRU5ErkJggg=="},184:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIkAAAA2CAYAAADzuLppAAAABHNCSVQICAgIfAhkiAAABDFJREFUeJztnEFy2jAUhr+2WXTp5gjOsjumRyA3yBnoDegROvQGdNdt6Q3oEUKX3ZEjBG6QLuQ3fhZCkik2Dn7fDDNJJMaK9fz069cDMAzDMAzDMAzDMAzDuComwArYAS/AFpgl3lMAm47HZQyEOS4wQq9V5H1LYNH56IyLs6AOiC2wrl479fd54H1F1afoZ5jGpZjggmADlIH2B1wg7AJtCyyLjIItbsmIURLOJpZFRsCEcIYIMacpUGekg8u4AkpcoORQ4LKJZI7G8nRz3nEZA+KpRd991f8T8Oy//90ZB2W8bj4C74F74Afw97LDMYbInNpsa/C2/7EYA2WP2xL/9BssSAxBtMiBA2tBYgi3uGzy22+wIDGEOwJLDYSDZIrbJ4vX39ZUKXFmjLl1+RTUhpacp6xxGsGn5PA0d8H/32+Z9ySL6qLT6qIzNZAcxOJNnS4aNeKMrqjNrwl1wOiHVM5a5tRm1xQ3P1tODxQx06apjrPAhfSkp2oPoHniaEGSZsrxyZGJe8EFhwTTxOuzJX6am8MDTcc1iASDb+PKKWLupOt0mRNUY6bETXpoSRHW1Ke4oSIhv07k1FPbJRmrxZKw9pDlxk97x9ADzj03SCE381jRTNevrk5DV6QnVYJExuHjB8mp44xqzxtq7XEXaP+sfk6JGp0y98CfzAGmeAYeCddD9EGbM5BcptXrQ6Kf/p+/B9q/4e51Afyqfm5LUV0nOr+zIx20HsmJUq1H1m1HOjJysgh0k5l9RBcdnd+3VePXQJteK3OiVGcSC5I4Benl2w+Kc2XmEKdmoYZqjokraCrxLqN+TGi9MciHzl9qUsgWKre/kUaL1kHuFHUU52x9lww86l8h+qG7lGiPov2OpAvHeQwdo0b7U7l1qr3SdqkxPXJ+BuVch2pctUg9ODYO4Geac6vwAnejbun/0HCP82nue77u4HeKWl/kLB1d65FrdVxjtNEjJR0HUiiT6EHluI1dR/0TaWfymvCd69QcfMnoc3a0aE3pC1+/mB5JU+Iy9DHvqU1mFj3Y+33X+/PUxbXAMn8kjf9QhZZzvbSmROuCC33STnskMadVb9PMH8nDf6h8k2yBy+SSzWP3VAqQLlIBKF85EBvkhEMxaf5IGv0A+gVeck9Lagf7mEciAXLR5V1OBl9w6Uz+mUn1uxTLmB5phzyAUiIKtUbZ0RStknXWVZ+iapf61kHcbynO1W7qljpj6IIk0yP5FNS1xJItVoS3ulOaXziz4ZVl7BWmR4wEWpOkSgmMEaI1iy01I2KGyw4b0qJIeymvao00Tsf3PGIGjc4iuR/aMq4AvzQ/pjH0bmcQ2zCjH2RPviNexa3PFQZZUmd0hzh4MXS2sQAZKRvCB0pS9COZxpaYESPBIA7gknoXI59kN0bIm8Df5Ps/S1zRyyPdfjDIGDj/AOS5vYXGcUlSAAAAAElFTkSuQmCC"},185:function(e,t,i){"use strict";t.a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAA2CAYAAAC2nEDCAAAABHNCSVQICAgIfAhkiAAACEpJREFUeJztnetx20YUhU88LgB2CUoHikuQO6BTAt2BMq4gw3SguIJE7oDuIFE6kEow1YHyY3EGVyuAAPYJQOebwVDiA1xi7969r10AQgghhBBCCCGEEEIIIWqzq90AsWoaAFe1G+FxD2BfuxFi+dwCONZuhFg9dwBuajei5RrAU/soxCBHuJlyDVzDtfWpfTyY1xo4RX5qjyOAi9INfOU0cP1yW7sh6OREMiAGocJoajdkhAbOurhFJ9A7OAGn5XoHpyAbdAPxVLaZAq5/TqhrCV7AycZdxTaIhXOAE5KlxW36uEe/K3OE+w0nPLcGb9vnnwBcZm+d8LmCu/a14m+UbcX/RC+0npYSrznHNYZdKirAJ+/5O3SKUcxnj3ivgJNQjQno1H730j0bUQnGydbACcNxHAq6n8BpoKx2KFRcsdevgeuf0vFlWp9K6olebrAu92ConYzzrOm3LJkdugklhQIE6mRiKd+aAMULLtFlUNcO3XjF+ebRwF2vK7iJw8ZL7ZFKgZR2R/l9QryAMbMtWEyc6dfiyi8FWmU8WE50hTwKkAmJEqUxnBSXUIYjFoZ1GbcQHGadl2I987iAswAv8FwOGuRRgCXljtbsGiobRGFoMW1hdrSDdSi+xEEuppFLAQKd55E7FiiPQAySQ7BLsMPLGJ+N/w3N9vdnXhMvyakA98gfe+Z3rKG0SxTGKow1ub+0Wv123w48T3bQKoC55FSA1g3ONSnRylRCTLyAimRtSsGWZVDRXQ48T7gUSwNhHjkVINDFbHNYaGy73F/RCxXGYeyNC8Mvyr2CG0iXeOnyNO1zJ8j1DSG3AmRf5piEmdlejXxfoVuudI/5s8IF0izXeQ1Y9yNn/O8CXW3ZdftdKfrngE6B3+G5cqOry9nfbpYg5pFbAdrym9RQBlL3fRaZPqALUHPWnhMgtQN6CxnN3Nj4Xw7lsEcngNwP7sY8p22p1kFuBWjrDFNa6NQHKRMs2WR6D9dQq0XnLmliYaUU4DTs9UoJ3VH2Q59ATMnWElnzdcmtAKeULoVA+U5xzqwyTUXnB6e5PGuqQqMW3sqKhtwM7ZgSg3Vnxvpgb957LjHhu7eiLLkVIMy5UyZCqLBiJ9DsMk0z8tzJplwY20mpMn3MHD5VOnJuSkoBSZUhs6UpUwcJr+2Qm8LJUdSjhAIc2r0nFBpPsYmVrDL9Fl2s7+eeN342f4/9EGshPAL4b0pLJ/ADwL+oF6t6yHhu/qYfCc51QDc7/gng28TPfYcTLAaVv3uvf55xLrFeHpB2hQ51R4xFWUSmGVT0sfG/KWasjWdpDeg0eL1iZ0kb+5gbcLbuRV+YQ6Ur9SlhAaYOx8TuNFNEpt+0Dfx9oAHkG5xVdw47SKQA5xFjATYAvpr/59ZbWQu3b1nbD7ycQYU4B6tIvmNcb/RRTKbfAvhj4CTW/f1r5Au5jxnRgBnHzowhQkK+mHM9wrkKc7DC4rs/XwD8FtiuGvi7qOTmEXlDJCWJkUGfWPe3ukz77u8Y1lxVwHwa1q2JiZPY6x5ynqG+3mFdm7PaCoSSR4lqhxIusF3DHUvseYrJ9NuBE/ju7xgfzd+y/srhD4QUtZcN3Kx7wLqsvxsAnwC8L/idTNBtgVSWM2UyNHG2CJm2s+mUADjLOZ6gu73P4Vygdgr+lukh9CW7DlAcd0mUsABT3a2PyZTQxFl1mZ7r/vqdo50+phObNbcTT6i76vc3wxla/bEcSijAFDWpKXZ+KSrTfS6wvbhT3Flf06eq/yMN3KzwHuUH5SOcm/Nx7I0R528Q7rbZAG+qYPxXOFcyZVBcLB/KYExFwq/t498R5ygq030K0BZET7FMcsf/3gP4gHoWCZVUDoXA4tPQ38a2AekmnjkFp2I7pJCjFMXPRWX6Tc9zczVw7vq/BwDvAPxU6XiHfNYQA+ih1fe2f1JlbPtqQsW2sRNwqNXFUrgHxCmuojLdpwCtOzZ2MS7wfPAqAzwP28EhVmCKDKTv8pTMooplYPv8n8BzsBwo1nsoKtN9CnBODOCz93/q+N/WsdfrQ8Dnbfb4l4DPX2J9W/GL9NjEZagFmML9BRYg03Yd3blsk90qS+t/w4ktHwotX7huP7PD83WgfhZ/D60Frk3uLDDX8Ydmb5l1TTWZVpXpBuNb4/g3v1H9Xzjs7NBaQLtd2JQ1k9z49ojO7bYreezKhqF9IkVZ7I7NU/t5DlQWoTKYcuNTYAEybS/4jTnpZfs/tazq/+KJnX0B16l2t9xL77Udun47or+v7I1xGNC+hya2kjRwfbVDd68Lux+e73Fdt+/jZ0KTabGWZezOL31Ul+mmfaNfmMgP281SU6wffK3Yos3YSYSmPwXyhG5m3GN8gNj+PmJ9N2pfO34B79wjZF2yNXZCFBhDYblCYIuVabtkRfG/OOgGr+bWgSIbjTlyvN+HHkjoGKaF+upugWFjgLIU4mA4YU27r4htwHEcmuji518VflBWxENBUixVlCJ24qUe2MQdIPdwg/AO44PQppgVJE8Dy482IUxiFXAch7qvDIOt3gP0a/rOFTNa608uW1oYrNXNykVuUty1LbZ6YTHY4ucxjW6zwnLX0rIpl0IsGibeQscw3eeU9xGuhq1FO5eJtDVJry7rUwi6FZpcRC5SKK/YjU8XxQ7jpuycu7OLcBo4K1vhBZEDrvSKcX1TbHy6OO7Q73pxQ1L+YFkm+WFB7CbcC7EoWFQcs2qDiyA2VbdKRXdqH2/QmbknKNtbGsYDdd1FKhjqijViYuOHi4br7LjOcJM/ciVQCa6+zEBUh1Zb7Himd6IQjSiC9uwTsTRwMpSivIo7tWxiUv4fLSq0kQbIMvwAAAAASUVORK5CYII="},188:function(e,t,i){"use strict";t.a=i.p+"static/media/carta_logo.5ec2e273.png"},20:function(e,t,i){(function(t,n,r){var o="undefined"!==typeof o?o:{};o.locateFile=function(e,t){return"./"+e};var s,a={};for(s in o)o.hasOwnProperty(s)&&(a[s]=o[s]);var l=[],c="./this.program",d=!1,u=!1,h=!1,p=!1;d="object"===typeof window,u="function"===typeof importScripts,h="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,p=!d&&!h&&!u;var g,f,b,m,y,O="";function j(e){return o.locateFile?o.locateFile(e,O):O+e}h?(O=u?i(113).dirname(O)+"/":n+"/",g=function(e,t){return m||(m=i(191)),y||(y=i(113)),e=y.normalize(e),m.readFileSync(e,t?null:"utf8")},b=function(e){var t=g(e,!0);return t.buffer||(t=new Uint8Array(t)),R(t.buffer),t},t.argv.length>1&&(c=t.argv[1].replace(/\\/g,"/")),l=t.argv.slice(2),e.exports=o,t.on("uncaughtException",(function(e){if(!(e instanceof wt))throw e})),t.on("unhandledRejection",ue),function(e){t.exit(e)},o.inspect=function(){return"[Emscripten Module object]"}):p?("undefined"!=typeof read&&(g=function(e){return read(e)}),b=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(R("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?l=scriptArgs:"undefined"!=typeof arguments&&(l=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(d||u)&&(u?O=self.location.href:"undefined"!==typeof document&&document.currentScript&&(O=document.currentScript.src),O=0!==O.indexOf("blob:")?O.substr(0,O.lastIndexOf("/")+1):"",g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},u&&(b=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),f=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var S=o.print||console.log.bind(console),x=o.printErr||console.warn.bind(console);for(s in a)a.hasOwnProperty(s)&&(o[s]=a[s]);a=null,o.arguments&&(l=o.arguments),o.thisProgram&&(c=o.thisProgram),o.quit&&o.quit;var C=16;function I(e,t){return t||(t=C),Math.ceil(e/t)*t}var w,T=function(e){e};o.wasmBinary&&(w=o.wasmBinary);var v;o.noExitRuntime;"object"!==typeof WebAssembly&&ue("no native wasm support detected");var A=!1;function R(e,t){e||ue("Assertion failed: "+t)}function P(e){var t=o["_"+e];return R(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function E(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);L(e,t=It(i),i)}return t},array:function(e){var t=It(e.length);return q(e,t),t}};var s=P(e),a=[],l=0;if(n)for(var c=0;c<n.length;c++){var d=o[i[c]];d?(0===l&&(l=xt()),a[c]=d(n[c])):a[c]=n[c]}var u=s.apply(null,a);return u=function(e){return"string"===t?D(e):"boolean"===t?Boolean(e):e}(u),0!==l&&Ct(l),u}function F(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?P(e):function(){return E(e,t,i,arguments)}}var M="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function k(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&M)return M.decode(e.subarray(t,r));for(var o="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function D(e,t){return e?k(G,e,t):""}function N(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-r}function L(e,t,i){return N(e,G,t,i)}function _(e){for(var t=0,i=0;i<e.length;++i){var n=e.charCodeAt(i);n>=55296&&n<=57343&&(n=65536+((1023&n)<<10)|1023&e.charCodeAt(++i)),n<=127?++t:t+=n<=2047?2:n<=65535?3:4}return t}var z,W,G,V,B,H;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function q(e,t){W.set(e,t)}function Y(e,t,i){for(var n=0;n<e.length;++n)W[t++>>0]=e.charCodeAt(n);i||(W[t>>0]=0)}function U(e,t){return e%t>0&&(e+=t-e%t),e}function X(e){z=e,o.HEAP8=W=new Int8Array(e),o.HEAP16=V=new Int16Array(e),o.HEAP32=B=new Int32Array(e),o.HEAPU8=G=new Uint8Array(e),o.HEAPU16=new Uint16Array(e),o.HEAPU32=new Uint32Array(e),o.HEAPF32=new Float32Array(e),o.HEAPF64=H=new Float64Array(e)}o.INITIAL_MEMORY;var $,K=[],Q=[],Z=[],J=[];function ee(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)re(o.preRun.shift());Ie(K)}function te(){!0,o.noFSInit||Me.init.initialized||Me.init(),Pe.init(),Ie(Q)}function ie(){Me.ignorePermissions=!1,Ie(Z)}function ne(){if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)oe(o.postRun.shift());Ie(J)}function re(e){K.unshift(e)}function oe(e){J.unshift(e)}Q.push({func:function(){Ot()}});var se=0,ae=null,le=null;function ce(e){se++,o.monitorRunDependencies&&o.monitorRunDependencies(se)}function de(e){if(se--,o.monitorRunDependencies&&o.monitorRunDependencies(se),0==se&&(null!==ae&&(clearInterval(ae),ae=null),le)){var t=le;le=null,t()}}function ue(e){throw o.onAbort&&o.onAbort(e),x(e+=""),A=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function he(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}o.preloadedImages={},o.preloadedAudios={};var pe="data:application/octet-stream;base64,";function ge(e){return he(e,pe)}var fe="file://";function be(e){return he(e,fe)}var me,ye,Oe="ast_wrapper.wasm";function je(e){try{if(e==Oe&&w)return new Uint8Array(w);if(b)return b(e);throw"both async and sync fetching of the wasm failed"}catch(x){ue(x)}}function Se(){if(!w&&(d||u)){if("function"===typeof fetch&&!be(Oe))return fetch(Oe,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Oe+"'";return e.arrayBuffer()})).catch((function(){return je(Oe)}));if(f)return new Promise((function(e,t){f(Oe,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return je(Oe)}))}function xe(){var e={env:yt,wasi_snapshot_preview1:yt};function t(e,t){var i=e.exports;o.asm=i,X((v=o.asm.memory).buffer),$=o.asm.__indirect_function_table,de()}function i(e){t(e.instance)}function n(t){return Se().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){x("failed to asynchronously prepare wasm: "+e),ue(e)}))}if(ce(),o.instantiateWasm)try{return o.instantiateWasm(e,t)}catch(r){return x("Module.instantiateWasm callback failed with error: "+r),!1}return w||"function"!==typeof WebAssembly.instantiateStreaming||ge(Oe)||be(Oe)||"function"!==typeof fetch?n(i):fetch(Oe,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return x("wasm streaming compile failed: "+e),x("falling back to ArrayBuffer instantiation"),n(i)}))})),{}}ge(Oe)||(Oe=j(Oe));var Ce={1903:function(e){o.gridContext.strokeStyle=o.colors[e],o.gridContext.fillStyle=o.colors[e]},2011:function(e,t){var i=o.fonts[e];i=i.replace("{size}",t*devicePixelRatio+"px"),o.gridContext.font=i},2140:function(e,t){o.gridContext.beginPath(),o.gridContext.moveTo(e,t)},2214:function(e,t){o.gridContext.lineTo(Math.floor(e)+.5,Math.floor(t)+.5)},2283:function(e,t){o.gridContext.lineTo(e,t)},2320:function(){o.gridContext.stroke()},2350:function(){return 2*o.gridContext.measureText("e").width},2404:function(e){o.gridContext.textAlign="center",o.gridContext.textBaseline="middle";var t=Math.max(Math.min(e,o.shapes.length-1),0);o.gridContext.symbolText=o.shapes[t]},2611:function(e,t){o.gridContext.save(),o.gridContext.translate(e,t),o.gridContext.scale(1,-1),o.gridContext.fillText(o.gridContext.symbolText,0,0),o.gridContext.restore()},2809:function(){o.gridContext.textAlign="center"},2850:function(){o.gridContext.textAlign="left"},2889:function(){o.gridContext.textAlign="right"},2961:function(){o.gridContext.textBaseline="top"},3002:function(){o.gridContext.textBaseline="middle"},3046:function(){o.gridContext.textBaseline="bottom"},3090:function(e,t,i,n){o.gridContext.save(),o.gridContext.translate(t,i),o.gridContext.rotate(n),o.gridContext.scale(1,-1),o.gridContext.fillText(D(e),0,0),o.gridContext.restore()},3311:function(e){return o.gridContext.measureText(D(e)).width},3378:function(e){o.gridContext.lineWidth=e},3417:function(){return o.colors.length},3448:function(){return o.fonts.length},3478:function(e){o.gridContext.lineWidth=e*devicePixelRatio,o.gridContext.font=o.fonts[0],o.gridContext.clearRect(0,0,o.gridContext.canvas.width,o.gridContext.canvas.height)}};function Ie(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?$.get(i)():$.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(o)}}function we(e,t){}function Te(e){return B[jt()>>2]=e,e}var ve={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var i=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i;i--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),i="/"===e.substr(-1);return(e=ve.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&i&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=ve.splitPath(e),i=t[0],n=t[1];return i||n?(n&&(n=n.substr(0,n.length-1)),i+n):"."},basename:function(e){if("/"===e)return"/";var t=(e=(e=ve.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return ve.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return ve.normalize(e.join("/"))},join2:function(e,t){return ve.normalize(e+"/"+t)}};function Ae(){if("object"===typeof crypto&&"function"===typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}if(h)try{var t=i(527);return function(){return t.randomBytes(1)[0]}}catch(n){}return function(){ue("randomDevice")}}var Re={resolve:function(){for(var e="",t=!1,i=arguments.length-1;i>=-1&&!t;i--){var n=i>=0?arguments[i]:Me.cwd();if("string"!==typeof n)throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,t="/"===n.charAt(0)}return(t?"/":"")+(e=ve.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."},relative:function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=Re.resolve(e).substr(1),t=Re.resolve(t).substr(1);for(var n=i(e.split("/")),r=i(t.split("/")),o=Math.min(n.length,r.length),s=o,a=0;a<o;a++)if(n[a]!==r[a]){s=a;break}var l=[];for(a=s;a<n.length;a++)l.push("..");return(l=l.concat(r.slice(s))).join("/")}},Pe={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){Pe.ttys[e]={input:[],output:[],ops:t},Me.registerDevice(e,Pe.stream_ops)},stream_ops:{open:function(e){var t=Pe.ttys[e.node.rdev];if(!t)throw new Me.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,i,n,r){if(!e.tty||!e.tty.ops.get_char)throw new Me.ErrnoError(60);for(var o=0,s=0;s<n;s++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(l){throw new Me.ErrnoError(29)}if(void 0===a&&0===o)throw new Me.ErrnoError(6);if(null===a||void 0===a)break;o++,t[i+s]=a}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,i,n,r){if(!e.tty||!e.tty.ops.put_char)throw new Me.ErrnoError(60);try{for(var o=0;o<n;o++)e.tty.ops.put_char(e.tty,t[i+o])}catch(s){throw new Me.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}},default_tty_ops:{get_char:function(e){if(!e.input.length){var i=null;if(h){var n=r.alloc?r.alloc(256):new r(256),o=0;try{o=m.readSync(t.stdin.fd,n,0,256,null)}catch(s){if(-1==s.toString().indexOf("EOF"))throw s;o=0}i=o>0?n.slice(0,o).toString("utf-8"):null}else"undefined"!=typeof window&&"function"==typeof window.prompt?null!==(i=window.prompt("Input: "))&&(i+="\n"):"function"==typeof readline&&null!==(i=readline())&&(i+="\n");if(!i)return null;e.input=bt(i,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(S(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(S(k(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(x(k(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(x(k(e.output,0)),e.output=[])}}};function Ee(e){for(var t=I(e,16384),i=St(t);e<t;)W[i+e++]=0;return i}var Fe={ops_table:null,mount:function(e){return Fe.createNode(null,"/",16895,0)},createNode:function(e,t,i,n){if(Me.isBlkdev(i)||Me.isFIFO(i))throw new Me.ErrnoError(63);Fe.ops_table||(Fe.ops_table={dir:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr,lookup:Fe.node_ops.lookup,mknod:Fe.node_ops.mknod,rename:Fe.node_ops.rename,unlink:Fe.node_ops.unlink,rmdir:Fe.node_ops.rmdir,readdir:Fe.node_ops.readdir,symlink:Fe.node_ops.symlink},stream:{llseek:Fe.stream_ops.llseek}},file:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr},stream:{llseek:Fe.stream_ops.llseek,read:Fe.stream_ops.read,write:Fe.stream_ops.write,allocate:Fe.stream_ops.allocate,mmap:Fe.stream_ops.mmap,msync:Fe.stream_ops.msync}},link:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr,readlink:Fe.node_ops.readlink},stream:{}},chrdev:{node:{getattr:Fe.node_ops.getattr,setattr:Fe.node_ops.setattr},stream:Me.chrdev_stream_ops}});var r=Me.createNode(e,t,i,n);return Me.isDir(r.mode)?(r.node_ops=Fe.ops_table.dir.node,r.stream_ops=Fe.ops_table.dir.stream,r.contents={}):Me.isFile(r.mode)?(r.node_ops=Fe.ops_table.file.node,r.stream_ops=Fe.ops_table.file.stream,r.usedBytes=0,r.contents=null):Me.isLink(r.mode)?(r.node_ops=Fe.ops_table.link.node,r.stream_ops=Fe.ops_table.link.stream):Me.isChrdev(r.mode)&&(r.node_ops=Fe.ops_table.chrdev.node,r.stream_ops=Fe.ops_table.chrdev.stream),r.timestamp=Date.now(),e&&(e.contents[t]=r,e.timestamp=r.timestamp),r},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var i=e.contents?e.contents.length:0;if(!(i>=t)){t=Math.max(t,i*(i<1048576?2:1.125)>>>0),0!=i&&(t=Math.max(t,256));var n=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(n.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var i=e.contents;e.contents=new Uint8Array(t),i&&e.contents.set(i.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=Me.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,Me.isDir(e.mode)?t.size=4096:Me.isFile(e.mode)?t.size=e.usedBytes:Me.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&Fe.resizeFileStorage(e,t.size)},lookup:function(e,t){throw Me.genericErrors[44]},mknod:function(e,t,i,n){return Fe.createNode(e,t,i,n)},rename:function(e,t,i){if(Me.isDir(e.mode)){var n;try{n=Me.lookupNode(t,i)}catch(o){}if(n)for(var r in n.contents)throw new Me.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=i,t.contents[i]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var i=Me.lookupNode(e,t);for(var n in i.contents)throw new Me.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var i in e.contents)e.contents.hasOwnProperty(i)&&t.push(i);return t},symlink:function(e,t,i){var n=Fe.createNode(e,t,41471,0);return n.link=i,n},readlink:function(e){if(!Me.isLink(e.mode))throw new Me.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,i,n,r){var o=e.node.contents;if(r>=e.node.usedBytes)return 0;var s=Math.min(e.node.usedBytes-r,n);if(s>8&&o.subarray)t.set(o.subarray(r,r+s),i);else for(var a=0;a<s;a++)t[i+a]=o[r+a];return s},write:function(e,t,i,n,r,o){if(t.buffer===W.buffer&&(o=!1),!n)return 0;var s=e.node;if(s.timestamp=Date.now(),t.subarray&&(!s.contents||s.contents.subarray)){if(o)return s.contents=t.subarray(i,i+n),s.usedBytes=n,n;if(0===s.usedBytes&&0===r)return s.contents=t.slice(i,i+n),s.usedBytes=n,n;if(r+n<=s.usedBytes)return s.contents.set(t.subarray(i,i+n),r),n}if(Fe.expandFileStorage(s,r+n),s.contents.subarray&&t.subarray)s.contents.set(t.subarray(i,i+n),r);else for(var a=0;a<n;a++)s.contents[r+a]=t[i+a];return s.usedBytes=Math.max(s.usedBytes,r+n),n},llseek:function(e,t,i){var n=t;if(1===i?n+=e.position:2===i&&Me.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new Me.ErrnoError(28);return n},allocate:function(e,t,i){Fe.expandFileStorage(e.node,t+i),e.node.usedBytes=Math.max(e.node.usedBytes,t+i)},mmap:function(e,t,i,n,r,o){if(0!==t)throw new Me.ErrnoError(28);if(!Me.isFile(e.node.mode))throw new Me.ErrnoError(43);var s,a,l=e.node.contents;if(2&o||l.buffer!==z){if((n>0||n+i<l.length)&&(l=l.subarray?l.subarray(n,n+i):Array.prototype.slice.call(l,n,n+i)),a=!0,!(s=Ee(i)))throw new Me.ErrnoError(48);W.set(l,s)}else a=!1,s=l.byteOffset;return{ptr:s,allocated:a}},msync:function(e,t,i,n,r){if(!Me.isFile(e.node.mode))throw new Me.ErrnoError(43);if(2&r)return 0;Fe.stream_ops.write(e,t,0,n,i,!1);return 0}}},Me={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(e,t){if(t=t||{},!(e=Re.resolve(Me.cwd(),e)))return{path:"",node:null};var i={follow_mount:!0,recurse_count:0};for(var n in i)void 0===t[n]&&(t[n]=i[n]);if(t.recurse_count>8)throw new Me.ErrnoError(32);for(var r=ve.normalizeArray(e.split("/").filter((function(e){return!!e})),!1),o=Me.root,s="/",a=0;a<r.length;a++){var l=a===r.length-1;if(l&&t.parent)break;if(o=Me.lookupNode(o,r[a]),s=ve.join2(s,r[a]),Me.isMountpoint(o)&&(!l||l&&t.follow_mount)&&(o=o.mounted.root),!l||t.follow)for(var c=0;Me.isLink(o.mode);){var d=Me.readlink(s);if(s=Re.resolve(ve.dirname(s),d),o=Me.lookupPath(s,{recurse_count:t.recurse_count}).node,c++>40)throw new Me.ErrnoError(32)}}return{path:s,node:o}},getPath:function(e){for(var t;;){if(Me.isRoot(e)){var i=e.mount.mountpoint;return t?"/"!==i[i.length-1]?i+"/"+t:i+t:i}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var i=0,n=0;n<t.length;n++)i=(i<<5)-i+t.charCodeAt(n)|0;return(e+i>>>0)%Me.nameTable.length},hashAddNode:function(e){var t=Me.hashName(e.parent.id,e.name);e.name_next=Me.nameTable[t],Me.nameTable[t]=e},hashRemoveNode:function(e){var t=Me.hashName(e.parent.id,e.name);if(Me.nameTable[t]===e)Me.nameTable[t]=e.name_next;else for(var i=Me.nameTable[t];i;){if(i.name_next===e){i.name_next=e.name_next;break}i=i.name_next}},lookupNode:function(e,t){var i=Me.mayLookup(e);if(i)throw new Me.ErrnoError(i,e);for(var n=Me.hashName(e.id,t),r=Me.nameTable[n];r;r=r.name_next){var o=r.name;if(r.parent.id===e.id&&o===t)return r}return Me.lookup(e,t)},createNode:function(e,t,i,n){var r=new Me.FSNode(e,t,i,n);return Me.hashAddNode(r),r},destroyNode:function(e){Me.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768===(61440&e)},isDir:function(e){return 16384===(61440&e)},isLink:function(e){return 40960===(61440&e)},isChrdev:function(e){return 8192===(61440&e)},isBlkdev:function(e){return 24576===(61440&e)},isFIFO:function(e){return 4096===(61440&e)},isSocket:function(e){return 49152===(49152&e)},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(e){var t=Me.flagModes[e];if("undefined"===typeof t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return Me.ignorePermissions||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){var t=Me.nodePermissions(e,"x");return t||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{Me.lookupNode(e,t);return 20}catch(i){}return Me.nodePermissions(e,"wx")},mayDelete:function(e,t,i){var n;try{n=Me.lookupNode(e,t)}catch(o){return o.errno}var r=Me.nodePermissions(e,"wx");if(r)return r;if(i){if(!Me.isDir(n.mode))return 54;if(Me.isRoot(n)||Me.getPath(n)===Me.cwd())return 10}else if(Me.isDir(n.mode))return 31;return 0},mayOpen:function(e,t){return e?Me.isLink(e.mode)?32:Me.isDir(e.mode)&&("r"!==Me.flagsToPermissionString(t)||512&t)?31:Me.nodePermissions(e,Me.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||Me.MAX_OPEN_FDS;for(var i=e;i<=t;i++)if(!Me.streams[i])return i;throw new Me.ErrnoError(33)},getStream:function(e){return Me.streams[e]},createStream:function(e,t,i){Me.FSStream||(Me.FSStream=function(){},Me.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!==(2097155&this.flags)}},isWrite:{get:function(){return 0!==(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var n=new Me.FSStream;for(var r in e)n[r]=e[r];e=n;var o=Me.nextfd(t,i);return e.fd=o,Me.streams[o]=e,e},closeStream:function(e){Me.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=Me.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new Me.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){Me.devices[e]={stream_ops:t}},getDevice:function(e){return Me.devices[e]},getMounts:function(e){for(var t=[],i=[e];i.length;){var n=i.pop();t.push(n),i.push.apply(i,n.mounts)}return t},syncfs:function(e,t){"function"===typeof e&&(t=e,e=!1),Me.syncFSRequests++,Me.syncFSRequests>1&&x("warning: "+Me.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var i=Me.getMounts(Me.root.mount),n=0;function r(e){return Me.syncFSRequests--,t(e)}function o(e){if(e)return o.errored?void 0:(o.errored=!0,r(e));++n>=i.length&&r(null)}i.forEach((function(t){if(!t.type.syncfs)return o(null);t.type.syncfs(t,e,o)}))},mount:function(e,t,i){var n,r="/"===i,o=!i;if(r&&Me.root)throw new Me.ErrnoError(10);if(!r&&!o){var s=Me.lookupPath(i,{follow_mount:!1});if(i=s.path,n=s.node,Me.isMountpoint(n))throw new Me.ErrnoError(10);if(!Me.isDir(n.mode))throw new Me.ErrnoError(54)}var a={type:e,opts:t,mountpoint:i,mounts:[]},l=e.mount(a);return l.mount=a,a.root=l,r?Me.root=l:n&&(n.mounted=a,n.mount&&n.mount.mounts.push(a)),l},unmount:function(e){var t=Me.lookupPath(e,{follow_mount:!1});if(!Me.isMountpoint(t.node))throw new Me.ErrnoError(28);var i=t.node,n=i.mounted,r=Me.getMounts(n);Object.keys(Me.nameTable).forEach((function(e){for(var t=Me.nameTable[e];t;){var i=t.name_next;-1!==r.indexOf(t.mount)&&Me.destroyNode(t),t=i}})),i.mounted=null;var o=i.mount.mounts.indexOf(n);i.mount.mounts.splice(o,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,i){var n=Me.lookupPath(e,{parent:!0}).node,r=ve.basename(e);if(!r||"."===r||".."===r)throw new Me.ErrnoError(28);var o=Me.mayCreate(n,r);if(o)throw new Me.ErrnoError(o);if(!n.node_ops.mknod)throw new Me.ErrnoError(63);return n.node_ops.mknod(n,r,t,i)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,Me.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,Me.mknod(e,t,0)},mkdirTree:function(e,t){for(var i=e.split("/"),n="",r=0;r<i.length;++r)if(i[r]){n+="/"+i[r];try{Me.mkdir(n,t)}catch(o){if(20!=o.errno)throw o}}},mkdev:function(e,t,i){return"undefined"===typeof i&&(i=t,t=438),t|=8192,Me.mknod(e,t,i)},symlink:function(e,t){if(!Re.resolve(e))throw new Me.ErrnoError(44);var i=Me.lookupPath(t,{parent:!0}).node;if(!i)throw new Me.ErrnoError(44);var n=ve.basename(t),r=Me.mayCreate(i,n);if(r)throw new Me.ErrnoError(r);if(!i.node_ops.symlink)throw new Me.ErrnoError(63);return i.node_ops.symlink(i,n,e)},rename:function(e,t){var i,n,r=ve.dirname(e),o=ve.dirname(t),s=ve.basename(e),a=ve.basename(t);if(i=Me.lookupPath(e,{parent:!0}).node,n=Me.lookupPath(t,{parent:!0}).node,!i||!n)throw new Me.ErrnoError(44);if(i.mount!==n.mount)throw new Me.ErrnoError(75);var l,c=Me.lookupNode(i,s),d=Re.relative(e,o);if("."!==d.charAt(0))throw new Me.ErrnoError(28);if("."!==(d=Re.relative(t,r)).charAt(0))throw new Me.ErrnoError(55);try{l=Me.lookupNode(n,a)}catch(p){}if(c!==l){var u=Me.isDir(c.mode),h=Me.mayDelete(i,s,u);if(h)throw new Me.ErrnoError(h);if(h=l?Me.mayDelete(n,a,u):Me.mayCreate(n,a))throw new Me.ErrnoError(h);if(!i.node_ops.rename)throw new Me.ErrnoError(63);if(Me.isMountpoint(c)||l&&Me.isMountpoint(l))throw new Me.ErrnoError(10);if(n!==i&&(h=Me.nodePermissions(i,"w")))throw new Me.ErrnoError(h);try{Me.trackingDelegate.willMovePath&&Me.trackingDelegate.willMovePath(e,t)}catch(p){x("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+p.message)}Me.hashRemoveNode(c);try{i.node_ops.rename(c,n,a)}catch(p){throw p}finally{Me.hashAddNode(c)}try{Me.trackingDelegate.onMovePath&&Me.trackingDelegate.onMovePath(e,t)}catch(p){x("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+p.message)}}},rmdir:function(e){var t=Me.lookupPath(e,{parent:!0}).node,i=ve.basename(e),n=Me.lookupNode(t,i),r=Me.mayDelete(t,i,!0);if(r)throw new Me.ErrnoError(r);if(!t.node_ops.rmdir)throw new Me.ErrnoError(63);if(Me.isMountpoint(n))throw new Me.ErrnoError(10);try{Me.trackingDelegate.willDeletePath&&Me.trackingDelegate.willDeletePath(e)}catch(o){x("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.rmdir(t,i),Me.destroyNode(n);try{Me.trackingDelegate.onDeletePath&&Me.trackingDelegate.onDeletePath(e)}catch(o){x("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readdir:function(e){var t=Me.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new Me.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=Me.lookupPath(e,{parent:!0}).node,i=ve.basename(e),n=Me.lookupNode(t,i),r=Me.mayDelete(t,i,!1);if(r)throw new Me.ErrnoError(r);if(!t.node_ops.unlink)throw new Me.ErrnoError(63);if(Me.isMountpoint(n))throw new Me.ErrnoError(10);try{Me.trackingDelegate.willDeletePath&&Me.trackingDelegate.willDeletePath(e)}catch(o){x("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+o.message)}t.node_ops.unlink(t,i),Me.destroyNode(n);try{Me.trackingDelegate.onDeletePath&&Me.trackingDelegate.onDeletePath(e)}catch(o){x("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+o.message)}},readlink:function(e){var t=Me.lookupPath(e).node;if(!t)throw new Me.ErrnoError(44);if(!t.node_ops.readlink)throw new Me.ErrnoError(28);return Re.resolve(Me.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var i=Me.lookupPath(e,{follow:!t}).node;if(!i)throw new Me.ErrnoError(44);if(!i.node_ops.getattr)throw new Me.ErrnoError(63);return i.node_ops.getattr(i)},lstat:function(e){return Me.stat(e,!0)},chmod:function(e,t,i){var n;"string"===typeof e?n=Me.lookupPath(e,{follow:!i}).node:n=e;if(!n.node_ops.setattr)throw new Me.ErrnoError(63);n.node_ops.setattr(n,{mode:4095&t|-4096&n.mode,timestamp:Date.now()})},lchmod:function(e,t){Me.chmod(e,t,!0)},fchmod:function(e,t){var i=Me.getStream(e);if(!i)throw new Me.ErrnoError(8);Me.chmod(i.node,t)},chown:function(e,t,i,n){var r;"string"===typeof e?r=Me.lookupPath(e,{follow:!n}).node:r=e;if(!r.node_ops.setattr)throw new Me.ErrnoError(63);r.node_ops.setattr(r,{timestamp:Date.now()})},lchown:function(e,t,i){Me.chown(e,t,i,!0)},fchown:function(e,t,i){var n=Me.getStream(e);if(!n)throw new Me.ErrnoError(8);Me.chown(n.node,t,i)},truncate:function(e,t){if(t<0)throw new Me.ErrnoError(28);var i;"string"===typeof e?i=Me.lookupPath(e,{follow:!0}).node:i=e;if(!i.node_ops.setattr)throw new Me.ErrnoError(63);if(Me.isDir(i.mode))throw new Me.ErrnoError(31);if(!Me.isFile(i.mode))throw new Me.ErrnoError(28);var n=Me.nodePermissions(i,"w");if(n)throw new Me.ErrnoError(n);i.node_ops.setattr(i,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var i=Me.getStream(e);if(!i)throw new Me.ErrnoError(8);if(0===(2097155&i.flags))throw new Me.ErrnoError(28);Me.truncate(i.node,t)},utime:function(e,t,i){var n=Me.lookupPath(e,{follow:!0}).node;n.node_ops.setattr(n,{timestamp:Math.max(t,i)})},open:function(e,t,i,n,r){if(""===e)throw new Me.ErrnoError(44);var s;if(i="undefined"===typeof i?438:i,i=64&(t="string"===typeof t?Me.modeStringToFlags(t):t)?4095&i|32768:0,"object"===typeof e)s=e;else{e=ve.normalize(e);try{s=Me.lookupPath(e,{follow:!(131072&t)}).node}catch(u){}}var a=!1;if(64&t)if(s){if(128&t)throw new Me.ErrnoError(20)}else s=Me.mknod(e,i,0),a=!0;if(!s)throw new Me.ErrnoError(44);if(Me.isChrdev(s.mode)&&(t&=-513),65536&t&&!Me.isDir(s.mode))throw new Me.ErrnoError(54);if(!a){var l=Me.mayOpen(s,t);if(l)throw new Me.ErrnoError(l)}512&t&&Me.truncate(s,0),t&=-131713;var c=Me.createStream({node:s,path:Me.getPath(s),flags:t,seekable:!0,position:0,stream_ops:s.stream_ops,ungotten:[],error:!1},n,r);c.stream_ops.open&&c.stream_ops.open(c),!o.logReadFiles||1&t||(Me.readFiles||(Me.readFiles={}),e in Me.readFiles||(Me.readFiles[e]=1,x("FS.trackingDelegate error on read file: "+e)));try{if(Me.trackingDelegate.onOpenFile){var d=0;1!==(2097155&t)&&(d|=Me.tracking.openFlags.READ),0!==(2097155&t)&&(d|=Me.tracking.openFlags.WRITE),Me.trackingDelegate.onOpenFile(e,d)}}catch(u){x("FS.trackingDelegate['onOpenFile']('"+e+"', flags) threw an exception: "+u.message)}return c},close:function(e){if(Me.isClosed(e))throw new Me.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(t){throw t}finally{Me.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,i){if(Me.isClosed(e))throw new Me.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new Me.ErrnoError(70);if(0!=i&&1!=i&&2!=i)throw new Me.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,i),e.ungotten=[],e.position},read:function(e,t,i,n,r){if(n<0||r<0)throw new Me.ErrnoError(28);if(Me.isClosed(e))throw new Me.ErrnoError(8);if(1===(2097155&e.flags))throw new Me.ErrnoError(8);if(Me.isDir(e.node.mode))throw new Me.ErrnoError(31);if(!e.stream_ops.read)throw new Me.ErrnoError(28);var o="undefined"!==typeof r;if(o){if(!e.seekable)throw new Me.ErrnoError(70)}else r=e.position;var s=e.stream_ops.read(e,t,i,n,r);return o||(e.position+=s),s},write:function(e,t,i,n,r,o){if(n<0||r<0)throw new Me.ErrnoError(28);if(Me.isClosed(e))throw new Me.ErrnoError(8);if(0===(2097155&e.flags))throw new Me.ErrnoError(8);if(Me.isDir(e.node.mode))throw new Me.ErrnoError(31);if(!e.stream_ops.write)throw new Me.ErrnoError(28);e.seekable&&1024&e.flags&&Me.llseek(e,0,2);var s="undefined"!==typeof r;if(s){if(!e.seekable)throw new Me.ErrnoError(70)}else r=e.position;var a=e.stream_ops.write(e,t,i,n,r,o);s||(e.position+=a);try{e.path&&Me.trackingDelegate.onWriteToFile&&Me.trackingDelegate.onWriteToFile(e.path)}catch(l){x("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+l.message)}return a},allocate:function(e,t,i){if(Me.isClosed(e))throw new Me.ErrnoError(8);if(t<0||i<=0)throw new Me.ErrnoError(28);if(0===(2097155&e.flags))throw new Me.ErrnoError(8);if(!Me.isFile(e.node.mode)&&!Me.isDir(e.node.mode))throw new Me.ErrnoError(43);if(!e.stream_ops.allocate)throw new Me.ErrnoError(138);e.stream_ops.allocate(e,t,i)},mmap:function(e,t,i,n,r,o){if(0!==(2&r)&&0===(2&o)&&2!==(2097155&e.flags))throw new Me.ErrnoError(2);if(1===(2097155&e.flags))throw new Me.ErrnoError(2);if(!e.stream_ops.mmap)throw new Me.ErrnoError(43);return e.stream_ops.mmap(e,t,i,n,r,o)},msync:function(e,t,i,n,r){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,i,n,r):0},munmap:function(e){return 0},ioctl:function(e,t,i){if(!e.stream_ops.ioctl)throw new Me.ErrnoError(59);return e.stream_ops.ioctl(e,t,i)},readFile:function(e,t){if((t=t||{}).flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var i,n=Me.open(e,t.flags),r=Me.stat(e).size,o=new Uint8Array(r);return Me.read(n,o,0,r,0),"utf8"===t.encoding?i=k(o,0):"binary"===t.encoding&&(i=o),Me.close(n),i},writeFile:function(e,t,i){(i=i||{}).flags=i.flags||577;var n=Me.open(e,i.flags,i.mode);if("string"===typeof t){var r=new Uint8Array(_(t)+1),o=N(t,r,0,r.length);Me.write(n,r,0,o,void 0,i.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");Me.write(n,t,0,t.byteLength,void 0,i.canOwn)}Me.close(n)},cwd:function(){return Me.currentPath},chdir:function(e){var t=Me.lookupPath(e,{follow:!0});if(null===t.node)throw new Me.ErrnoError(44);if(!Me.isDir(t.node.mode))throw new Me.ErrnoError(54);var i=Me.nodePermissions(t.node,"x");if(i)throw new Me.ErrnoError(i);Me.currentPath=t.path},createDefaultDirectories:function(){Me.mkdir("/tmp"),Me.mkdir("/home"),Me.mkdir("/home/web_user")},createDefaultDevices:function(){Me.mkdir("/dev"),Me.registerDevice(Me.makedev(1,3),{read:function(){return 0},write:function(e,t,i,n,r){return n}}),Me.mkdev("/dev/null",Me.makedev(1,3)),Pe.register(Me.makedev(5,0),Pe.default_tty_ops),Pe.register(Me.makedev(6,0),Pe.default_tty1_ops),Me.mkdev("/dev/tty",Me.makedev(5,0)),Me.mkdev("/dev/tty1",Me.makedev(6,0));var e=Ae();Me.createDevice("/dev","random",e),Me.createDevice("/dev","urandom",e),Me.mkdir("/dev/shm"),Me.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){Me.mkdir("/proc");var e=Me.mkdir("/proc/self");Me.mkdir("/proc/self/fd"),Me.mount({mount:function(){var t=Me.createNode(e,"fd",16895,73);return t.node_ops={lookup:function(e,t){var i=+t,n=Me.getStream(i);if(!n)throw new Me.ErrnoError(8);var r={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return n.path}}};return r.parent=r,r}},t}},{},"/proc/self/fd")},createStandardStreams:function(){o.stdin?Me.createDevice("/dev","stdin",o.stdin):Me.symlink("/dev/tty","/dev/stdin"),o.stdout?Me.createDevice("/dev","stdout",null,o.stdout):Me.symlink("/dev/tty","/dev/stdout"),o.stderr?Me.createDevice("/dev","stderr",null,o.stderr):Me.symlink("/dev/tty1","/dev/stderr");Me.open("/dev/stdin",0),Me.open("/dev/stdout",1),Me.open("/dev/stderr",1)},ensureErrnoError:function(){Me.ErrnoError||(Me.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},Me.ErrnoError.prototype=new Error,Me.ErrnoError.prototype.constructor=Me.ErrnoError,[44].forEach((function(e){Me.genericErrors[e]=new Me.ErrnoError(e),Me.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){Me.ensureErrnoError(),Me.nameTable=new Array(4096),Me.mount(Fe,{},"/"),Me.createDefaultDirectories(),Me.createDefaultDevices(),Me.createSpecialDirectories(),Me.filesystems={MEMFS:Fe}},init:function(e,t,i){Me.init.initialized=!0,Me.ensureErrnoError(),o.stdin=e||o.stdin,o.stdout=t||o.stdout,o.stderr=i||o.stderr,Me.createStandardStreams()},quit:function(){Me.init.initialized=!1;var e=o._fflush;e&&e(0);for(var t=0;t<Me.streams.length;t++){var i=Me.streams[t];i&&Me.close(i)}},getMode:function(e,t){var i=0;return e&&(i|=365),t&&(i|=146),i},findObject:function(e,t){var i=Me.analyzePath(e,t);return i.exists?i.object:null},analyzePath:function(e,t){try{e=(n=Me.lookupPath(e,{follow:!t})).path}catch(r){}var i={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var n=Me.lookupPath(e,{parent:!0});i.parentExists=!0,i.parentPath=n.path,i.parentObject=n.node,i.name=ve.basename(e),n=Me.lookupPath(e,{follow:!t}),i.exists=!0,i.path=n.path,i.object=n.node,i.name=n.node.name,i.isRoot="/"===n.path}catch(r){i.error=r.errno}return i},createPath:function(e,t,i,n){e="string"===typeof e?e:Me.getPath(e);for(var r=t.split("/").reverse();r.length;){var o=r.pop();if(o){var s=ve.join2(e,o);try{Me.mkdir(s)}catch(a){}e=s}}return s},createFile:function(e,t,i,n,r){var o=ve.join2("string"===typeof e?e:Me.getPath(e),t),s=Me.getMode(n,r);return Me.create(o,s)},createDataFile:function(e,t,i,n,r,o){var s=t?ve.join2("string"===typeof e?e:Me.getPath(e),t):e,a=Me.getMode(n,r),l=Me.create(s,a);if(i){if("string"===typeof i){for(var c=new Array(i.length),d=0,u=i.length;d<u;++d)c[d]=i.charCodeAt(d);i=c}Me.chmod(l,146|a);var h=Me.open(l,577);Me.write(h,i,0,i.length,0,o),Me.close(h),Me.chmod(l,a)}return l},createDevice:function(e,t,i,n){var r=ve.join2("string"===typeof e?e:Me.getPath(e),t),o=Me.getMode(!!i,!!n);Me.createDevice.major||(Me.createDevice.major=64);var s=Me.makedev(Me.createDevice.major++,0);return Me.registerDevice(s,{open:function(e){e.seekable=!1},close:function(e){n&&n.buffer&&n.buffer.length&&n(10)},read:function(e,t,n,r,o){for(var s=0,a=0;a<r;a++){var l;try{l=i()}catch(c){throw new Me.ErrnoError(29)}if(void 0===l&&0===s)throw new Me.ErrnoError(6);if(null===l||void 0===l)break;s++,t[n+a]=l}return s&&(e.node.timestamp=Date.now()),s},write:function(e,t,i,r,o){for(var s=0;s<r;s++)try{n(t[i+s])}catch(a){throw new Me.ErrnoError(29)}return r&&(e.node.timestamp=Date.now()),s}}),Me.mkdev(r,o,s)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!==typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!g)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=bt(g(e.url),!0),e.usedBytes=e.contents.length}catch(t){throw new Me.ErrnoError(29)}},createLazyFile:function(e,t,i,n,r){function o(){this.lengthKnown=!1,this.chunks=[]}if(o.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,i=e/this.chunkSize|0;return this.getter(i)[t]}},o.prototype.setDataGetter=function(e){this.getter=e},o.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",i,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+i+". Status: "+e.status);var t,n=Number(e.getResponseHeader("Content-length")),r=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,o=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,s=1048576;r||(s=n);var a=this;a.setDataGetter((function(e){var t=e*s,r=(e+1)*s-1;if(r=Math.min(r,n-1),"undefined"===typeof a.chunks[e]&&(a.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>n-1)throw new Error("only "+n+" bytes available! programmer error!");var r=new XMLHttpRequest;if(r.open("GET",i,!1),n!==s&&r.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(r.responseType="arraybuffer"),r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.send(null),!(r.status>=200&&r.status<300||304===r.status))throw new Error("Couldn't load "+i+". Status: "+r.status);return void 0!==r.response?new Uint8Array(r.response||[]):bt(r.responseText||"",!0)}(t,r)),"undefined"===typeof a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!o&&n||(s=n=1,n=this.getter(0).length,s=n,S("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=n,this._chunkSize=s,this.lengthKnown=!0},"undefined"!==typeof XMLHttpRequest){if(!u)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var s=new o;Object.defineProperties(s,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var a={isDevice:!1,contents:s}}else a={isDevice:!1,url:i};var l=Me.createFile(e,t,a,n,r);a.contents?l.contents=a.contents:a.url&&(l.contents=null,l.url=a.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var c={};return Object.keys(l.stream_ops).forEach((function(e){var t=l.stream_ops[e];c[e]=function(){return Me.forceLoadFile(l),t.apply(null,arguments)}})),c.read=function(e,t,i,n,r){Me.forceLoadFile(l);var o=e.node.contents;if(r>=o.length)return 0;var s=Math.min(o.length-r,n);if(o.slice)for(var a=0;a<s;a++)t[i+a]=o[r+a];else for(a=0;a<s;a++)t[i+a]=o.get(r+a);return s},l.stream_ops=c,l},createPreloadedFile:function(e,t,i,n,r,s,a,l,c,d){Browser.init();var u=t?Re.resolve(ve.join2(e,t)):e;function h(i){function h(i){d&&d(),l||Me.createDataFile(e,t,i,n,r,c),s&&s(),de()}var p=!1;o.preloadPlugins.forEach((function(e){p||e.canHandle(u)&&(e.handle(i,u,h,(function(){a&&a(),de()})),p=!0)})),p||h(i)}ce(),"string"==typeof i?Browser.asyncLoad(i,(function(e){h(e)}),a):h(i)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,i){t=t||function(){},i=i||function(){};var n=Me.indexedDB();try{var r=n.open(Me.DB_NAME(),Me.DB_VERSION)}catch(o){return i(o)}r.onupgradeneeded=function(){S("creating db"),r.result.createObjectStore(Me.DB_STORE_NAME)},r.onsuccess=function(){var n=r.result.transaction([Me.DB_STORE_NAME],"readwrite"),o=n.objectStore(Me.DB_STORE_NAME),s=0,a=0,l=e.length;function c(){0==a?t():i()}e.forEach((function(e){var t=o.put(Me.analyzePath(e).object.contents,e);t.onsuccess=function(){++s+a==l&&c()},t.onerror=function(){a++,s+a==l&&c()}})),n.onerror=i},r.onerror=i},loadFilesFromDB:function(e,t,i){t=t||function(){},i=i||function(){};var n=Me.indexedDB();try{var r=n.open(Me.DB_NAME(),Me.DB_VERSION)}catch(o){return i(o)}r.onupgradeneeded=i,r.onsuccess=function(){var n=r.result;try{var s=n.transaction([Me.DB_STORE_NAME],"readonly")}catch(o){return void i(o)}var a=s.objectStore(Me.DB_STORE_NAME),l=0,c=0,d=e.length;function u(){0==c?t():i()}e.forEach((function(e){var t=a.get(e);t.onsuccess=function(){Me.analyzePath(e).exists&&Me.unlink(e),Me.createDataFile(ve.dirname(e),ve.basename(e),t.result,!0,!0,!0),++l+c==d&&u()},t.onerror=function(){c++,l+c==d&&u()}})),s.onerror=i},r.onerror=i}},ke={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t,i){if("/"===t[0])return t;var n;if(-100===e)n=Me.cwd();else{var r=Me.getStream(e);if(!r)throw new Me.ErrnoError(8);n=r.path}if(0==t.length){if(!i)throw new Me.ErrnoError(44);return n}return ve.join2(n,t)},doStat:function(e,t,i){try{var n=e(t)}catch(r){if(r&&r.node&&ve.normalize(t)!==ve.normalize(Me.getPath(r.node)))return-54;throw r}return B[i>>2]=n.dev,B[i+4>>2]=0,B[i+8>>2]=n.ino,B[i+12>>2]=n.mode,B[i+16>>2]=n.nlink,B[i+20>>2]=n.uid,B[i+24>>2]=n.gid,B[i+28>>2]=n.rdev,B[i+32>>2]=0,ye=[n.size>>>0,(me=n.size,+Math.abs(me)>=1?me>0?(0|Math.min(+Math.floor(me/4294967296),4294967295))>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],B[i+40>>2]=ye[0],B[i+44>>2]=ye[1],B[i+48>>2]=4096,B[i+52>>2]=n.blocks,B[i+56>>2]=n.atime.getTime()/1e3|0,B[i+60>>2]=0,B[i+64>>2]=n.mtime.getTime()/1e3|0,B[i+68>>2]=0,B[i+72>>2]=n.ctime.getTime()/1e3|0,B[i+76>>2]=0,ye=[n.ino>>>0,(me=n.ino,+Math.abs(me)>=1?me>0?(0|Math.min(+Math.floor(me/4294967296),4294967295))>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],B[i+80>>2]=ye[0],B[i+84>>2]=ye[1],0},doMsync:function(e,t,i,n,r){var o=G.slice(e,e+i);Me.msync(t,o,r,i,n)},doMkdir:function(e,t){return"/"===(e=ve.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),Me.mkdir(e,t,0),0},doMknod:function(e,t,i){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return Me.mknod(e,t,i),0},doReadlink:function(e,t,i){if(i<=0)return-28;var n=Me.readlink(e),r=Math.min(i,_(n)),o=W[t+r];return L(n,t,i+1),W[t+r]=o,r},doAccess:function(e,t){if(-8&t)return-28;var i;if(!(i=Me.lookupPath(e,{follow:!0}).node))return-44;var n="";return 4&t&&(n+="r"),2&t&&(n+="w"),1&t&&(n+="x"),n&&Me.nodePermissions(i,n)?-2:0},doDup:function(e,t,i){var n=Me.getStream(i);return n&&Me.close(n),Me.open(e,t,0,i,i).fd},doReadv:function(e,t,i,n){for(var r=0,o=0;o<i;o++){var s=B[t+8*o>>2],a=B[t+(8*o+4)>>2],l=Me.read(e,W,s,a,n);if(l<0)return-1;if(r+=l,l<a)break}return r},doWritev:function(e,t,i,n){for(var r=0,o=0;o<i;o++){var s=B[t+8*o>>2],a=B[t+(8*o+4)>>2],l=Me.write(e,W,s,a,n);if(l<0)return-1;r+=l}return r},varargs:void 0,get:function(){return ke.varargs+=4,B[ke.varargs-4>>2]},getStr:function(e){return D(e)},getStreamFromFD:function(e){var t=Me.getStream(e);if(!t)throw new Me.ErrnoError(8);return t},get64:function(e,t){return e}};function De(e,t,i){ke.varargs=i;try{var n=ke.getStreamFromFD(e);switch(t){case 0:return(r=ke.get())<0?-28:Me.open(n.path,n.flags,0,r).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:var r=ke.get();return n.flags|=r,0;case 12:r=ke.get();return V[r+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return Te(28),-1;default:return-28}}catch(o){return"undefined"!==typeof Me&&o instanceof Me.ErrnoError||ue(o),-o.errno}}function Ne(e,t,i){ke.varargs=i;try{var n=ke.getStreamFromFD(e);switch(t){case 21509:case 21505:return n.tty?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.tty?0:-59;case 21519:if(!n.tty)return-59;var r=ke.get();return B[r>>2]=0,0;case 21520:return n.tty?-28:-59;case 21531:r=ke.get();return Me.ioctl(n,t,r);case 21523:case 21524:return n.tty?0:-59;default:ue("bad ioctl syscall "+t)}}catch(o){return"undefined"!==typeof Me&&o instanceof Me.ErrnoError||ue(o),-o.errno}}function Le(e,t,i){ke.varargs=i;try{var n=ke.getStr(e),r=i?ke.get():0;return Me.open(n,t,r).fd}catch(o){return"undefined"!==typeof Me&&o instanceof Me.ErrnoError||ue(o),-o.errno}}function _e(){ue()}function ze(){return void 0===ze.start&&(ze.start=Date.now()),1e3*(Date.now()-ze.start)|0}function We(e,t){return e-t}function Ge(e,t,i){var n=ht(t,i);return Ce[e].apply(null,n)}function Ve(e,t,i){return Ge(e,t,i)}function Be(e,t,i){G.copyWithin(e,t,t+i)}function He(){return G.length}function qe(e){try{return v.grow(e-z.byteLength+65535>>>16),X(v.buffer),1}catch(t){}}function Ye(e){var t=He(),i=2147483648;if(e>i)return!1;for(var n=1;n<=4;n*=2){var r=t*(1+.2/n);if(r=Math.min(r,e+100663296),qe(Math.min(i,U(Math.max(e,r),65536))))return!0}return!1}var Ue={};function Xe(){return c||"./this.program"}function $e(){if(!$e.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"===typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Xe()};for(var t in Ue)e[t]=Ue[t];var i=[];for(var t in e)i.push(t+"="+e[t]);$e.strings=i}return $e.strings}function Ke(e,t){try{var i=0;return $e().forEach((function(n,r){var o=t+i;B[e+4*r>>2]=o,Y(n,o),i+=n.length+1})),0}catch(n){return"undefined"!==typeof Me&&n instanceof Me.ErrnoError||ue(n),n.errno}}function Qe(e,t){try{var i=$e();B[e>>2]=i.length;var n=0;return i.forEach((function(e){n+=e.length+1})),B[t>>2]=n,0}catch(r){return"undefined"!==typeof Me&&r instanceof Me.ErrnoError||ue(r),r.errno}}function Ze(e){try{var t=ke.getStreamFromFD(e);return Me.close(t),0}catch(i){return"undefined"!==typeof Me&&i instanceof Me.ErrnoError||ue(i),i.errno}}function Je(e,t,i,n){try{var r=ke.getStreamFromFD(e),o=ke.doReadv(r,t,i);return B[n>>2]=o,0}catch(s){return"undefined"!==typeof Me&&s instanceof Me.ErrnoError||ue(s),s.errno}}function et(e,t,i,n,r){try{var o=ke.getStreamFromFD(e),s=4294967296*i+(t>>>0),a=9007199254740992;return s<=-a||s>=a?-61:(Me.llseek(o,s,n),ye=[o.position>>>0,(me=o.position,+Math.abs(me)>=1?me>0?(0|Math.min(+Math.floor(me/4294967296),4294967295))>>>0:~~+Math.ceil((me-+(~~me>>>0))/4294967296)>>>0:0)],B[r>>2]=ye[0],B[r+4>>2]=ye[1],o.getdents&&0===s&&0===n&&(o.getdents=null),0)}catch(l){return"undefined"!==typeof Me&&l instanceof Me.ErrnoError||ue(l),l.errno}}function tt(e,t,i,n){try{var r=ke.getStreamFromFD(e),o=ke.doWritev(r,t,i);return B[n>>2]=o,0}catch(s){return"undefined"!==typeof Me&&s instanceof Me.ErrnoError||ue(s),s.errno}}function it(e){T(0|e)}function nt(e){return e%4===0&&(e%100!==0||e%400===0)}function rt(e,t){for(var i=0,n=0;n<=t;i+=e[n++]);return i}var ot=[31,29,31,30,31,30,31,31,30,31,30,31],st=[31,28,31,30,31,30,31,31,30,31,30,31];function at(e,t){for(var i=new Date(e.getTime());t>0;){var n=nt(i.getFullYear()),r=i.getMonth(),o=(n?ot:st)[r];if(!(t>o-i.getDate()))return i.setDate(i.getDate()+t),i;t-=o-i.getDate()+1,i.setDate(1),r<11?i.setMonth(r+1):(i.setMonth(0),i.setFullYear(i.getFullYear()+1))}return i}function lt(e,t,i,n){var r=B[n+40>>2],o={tm_sec:B[n>>2],tm_min:B[n+4>>2],tm_hour:B[n+8>>2],tm_mday:B[n+12>>2],tm_mon:B[n+16>>2],tm_year:B[n+20>>2],tm_wday:B[n+24>>2],tm_yday:B[n+28>>2],tm_isdst:B[n+32>>2],tm_gmtoff:B[n+36>>2],tm_zone:r?D(r):""},s=D(i),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in a)s=s.replace(new RegExp(l,"g"),a[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=["January","February","March","April","May","June","July","August","September","October","November","December"];function u(e,t,i){for(var n="number"===typeof e?e.toString():e||"";n.length<t;)n=i[0]+n;return n}function h(e,t){return u(e,t,"0")}function p(e,t){function i(e){return e<0?-1:e>0?1:0}var n;return 0===(n=i(e.getFullYear()-t.getFullYear()))&&0===(n=i(e.getMonth()-t.getMonth()))&&(n=i(e.getDate()-t.getDate())),n}function g(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function f(e){var t=at(new Date(e.tm_year+1900,0,1),e.tm_yday),i=new Date(t.getFullYear(),0,4),n=new Date(t.getFullYear()+1,0,4),r=g(i),o=g(n);return p(r,t)<=0?p(o,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var b={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return d[e.tm_mon].substring(0,3)},"%B":function(e){return d[e.tm_mon]},"%C":function(e){return h((e.tm_year+1900)/100|0,2)},"%d":function(e){return h(e.tm_mday,2)},"%e":function(e){return u(e.tm_mday,2," ")},"%g":function(e){return f(e).toString().substring(2)},"%G":function(e){return f(e)},"%H":function(e){return h(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),h(t,2)},"%j":function(e){return h(e.tm_mday+rt(nt(e.tm_year+1900)?ot:st,e.tm_mon-1),3)},"%m":function(e){return h(e.tm_mon+1,2)},"%M":function(e){return h(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return h(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=new Date(e.tm_year+1900,0,1),i=0===t.getDay()?t:at(t,7-t.getDay()),n=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(p(i,n)<0){var r=rt(nt(n.getFullYear())?ot:st,n.getMonth()-1)-31,o=31-i.getDate()+r+n.getDate();return h(Math.ceil(o/7),2)}return 0===p(i,t)?"01":"00"},"%V":function(e){var t,i=new Date(e.tm_year+1900,0,4),n=new Date(e.tm_year+1901,0,4),r=g(i),o=g(n),s=at(new Date(e.tm_year+1900,0,1),e.tm_yday);return p(s,r)<0?"53":p(o,s)<=0?"01":(t=r.getFullYear()<e.tm_year+1900?e.tm_yday+32-r.getDate():e.tm_yday+1-r.getDate(),h(Math.ceil(t/7),2))},"%w":function(e){return e.tm_wday},"%W":function(e){var t=new Date(e.tm_year,0,1),i=1===t.getDay()?t:at(t,0===t.getDay()?1:7-t.getDay()+1),n=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(p(i,n)<0){var r=rt(nt(n.getFullYear())?ot:st,n.getMonth()-1)-31,o=31-i.getDate()+r+n.getDate();return h(Math.ceil(o/7),2)}return 0===p(i,t)?"01":"00"},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,i=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(i?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var l in b)s.indexOf(l)>=0&&(s=s.replace(new RegExp(l,"g"),b[l](o)));var m=bt(s,!1);return m.length>t?0:(q(m,e),m.length-1)}function ct(e,t,i,n){return lt(e,t,i,n)}function dt(e){var t=Date.now()/1e3|0;return e&&(B[e>>2]=t),t}var ut=[];function ht(e,t){var i;for(ut.length=0,t>>=2;i=G[e++];){var n=i<105;n&&1&t&&t++,ut.push(n?H[t++>>1]:B[t]),++t}return ut}var pt=function(e,t,i,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=Me.nextInode++,this.name=t,this.mode=i,this.node_ops={},this.stream_ops={},this.rdev=n},gt=365,ft=146;Object.defineProperties(pt.prototype,{read:{get:function(){return(this.mode&gt)===gt},set:function(e){e?this.mode|=gt:this.mode&=~gt}},write:{get:function(){return(this.mode&ft)===ft},set:function(e){e?this.mode|=ft:this.mode&=~ft}},isFolder:{get:function(){return Me.isDir(this.mode)}},isDevice:{get:function(){return Me.isChrdev(this.mode)}}}),Me.FSNode=pt,Me.staticInit();function bt(e,t,i){var n=i>0?i:_(e)+1,r=new Array(n),o=N(e,r,0,r.length);return t&&(r.length=o),r}var mt,yt={__cxa_atexit:we,__sys_fcntl64:De,__sys_ioctl:Ne,__sys_open:Le,abort:_e,clock:ze,difftime:We,emscripten_asm_const_double:Ve,emscripten_asm_const_int:Ge,emscripten_memcpy_big:Be,emscripten_resize_heap:Ye,environ_get:Ke,environ_sizes_get:Qe,fd_close:Ze,fd_read:Je,fd_seek:et,fd_write:tt,setTempRet0:it,strftime_l:ct,time:dt},Ot=(xe(),o.___wasm_call_ctors=function(){return(Ot=o.___wasm_call_ctors=o.asm.__wasm_call_ctors).apply(null,arguments)}),jt=(o._getLastErrorMessage=function(){return(o._getLastErrorMessage=o.asm.getLastErrorMessage).apply(null,arguments)},o._clearLastErrorMessage=function(){return(o._clearLastErrorMessage=o.asm.clearLastErrorMessage).apply(null,arguments)},o._initFrame=function(){return(o._initFrame=o.asm.initFrame).apply(null,arguments)},o._getSpectralFrame=function(){return(o._getSpectralFrame=o.asm.getSpectralFrame).apply(null,arguments)},o._getSkyFrameSet=function(){return(o._getSkyFrameSet=o.asm.getSkyFrameSet).apply(null,arguments)},o._createTransformedFrameset=function(){return(o._createTransformedFrameset=o.asm.createTransformedFrameset).apply(null,arguments)},o._initDummyFrame=function(){return(o._initDummyFrame=o.asm.initDummyFrame).apply(null,arguments)},o._plotGrid=function(){return(o._plotGrid=o.asm.plotGrid).apply(null,arguments)},o._format=function(){return(o._format=o.asm.format).apply(null,arguments)},o._unformat=function(){return(o._unformat=o.asm.unformat).apply(null,arguments)},o._set=function(){return(o._set=o.asm.set).apply(null,arguments)},o._clear=function(){return(o._clear=o.asm.clear).apply(null,arguments)},o._dump=function(){return(o._dump=o.asm.dump).apply(null,arguments)},o._getString=function(){return(o._getString=o.asm.getString).apply(null,arguments)},o._norm=function(){return(o._norm=o.asm.norm).apply(null,arguments)},o._transform=function(){return(o._transform=o.asm.transform).apply(null,arguments)},o._transform3D=function(){return(o._transform3D=o.asm.transform3D).apply(null,arguments)},o._spectralTransform=function(){return(o._spectralTransform=o.asm.spectralTransform).apply(null,arguments)},o._deleteObject=function(){return(o._deleteObject=o.asm.deleteObject).apply(null,arguments)},o._copy=function(){return(o._copy=o.asm.copy).apply(null,arguments)},o._invert=function(){return(o._invert=o.asm.invert).apply(null,arguments)},o._convert=function(){return(o._convert=o.asm.convert).apply(null,arguments)},o._shiftMap2D=function(){return(o._shiftMap2D=o.asm.shiftMap2D).apply(null,arguments)},o._axDistance=function(){return(o._axDistance=o.asm.axDistance).apply(null,arguments)},o._fillTransformGrid=function(){return(o._fillTransformGrid=o.asm.fillTransformGrid).apply(null,arguments)},o.___errno_location=function(){return(jt=o.___errno_location=o.asm.__errno_location).apply(null,arguments)}),St=(o._free=function(){return(o._free=o.asm.free).apply(null,arguments)},o._malloc=function(){return(St=o._malloc=o.asm.malloc).apply(null,arguments)}),xt=o.stackSave=function(){return(xt=o.stackSave=o.asm.stackSave).apply(null,arguments)},Ct=o.stackRestore=function(){return(Ct=o.stackRestore=o.asm.stackRestore).apply(null,arguments)},It=o.stackAlloc=function(){return(It=o.stackAlloc=o.asm.stackAlloc).apply(null,arguments)};o.dynCall_vidiiiiiiiidijjiiiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidijjiiiiiiiiii=o.asm.dynCall_vidiiiiiiiidijjiiiiiiiiii).apply(null,arguments)},o.dynCall_vidiiiiiiiidijjiiiiiiii=function(){return(o.dynCall_vidiiiiiiiidijjiiiiiiii=o.asm.dynCall_vidiiiiiiiidijjiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidijjiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidijjiiiiiiii=o.asm.dynCall_jiiiiiiiiiidijjiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidiiiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidiiiiiiiiii=o.asm.dynCall_jiiiiiiiiiidiiiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidijiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidijiiiiiiii=o.asm.dynCall_jiiiiiiiiiidijiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiidifiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiidifiiiiiiii=o.asm.dynCall_jiiiiiiiiiidifiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiiiiididiiiiiiii=function(){return(o.dynCall_jiiiiiiiiiididiiiiiiii=o.asm.dynCall_jiiiiiiiiiididiiiiiiii).apply(null,arguments)},o.dynCall_vijiiii=function(){return(o.dynCall_vijiiii=o.asm.dynCall_vijiiii).apply(null,arguments)},o.dynCall_vijiiiiii=function(){return(o.dynCall_vijiiiiii=o.asm.dynCall_vijiiiiii).apply(null,arguments)},o.dynCall_viiiidiiijii=function(){return(o.dynCall_viiiidiiijii=o.asm.dynCall_viiiidiiijii).apply(null,arguments)},o.dynCall_vijijiiijii=function(){return(o.dynCall_vijijiiijii=o.asm.dynCall_vijijiiijii).apply(null,arguments)},o.dynCall_viiiiijiiiijjiii=function(){return(o.dynCall_viiiiijiiiijjiii=o.asm.dynCall_viiiiijiiiijjiii).apply(null,arguments)},o.dynCall_viiiiijiiiidiii=function(){return(o.dynCall_viiiiijiiiidiii=o.asm.dynCall_viiiiijiiiidiii).apply(null,arguments)},o.dynCall_viiiiijiiiifiii=function(){return(o.dynCall_viiiiijiiiifiii=o.asm.dynCall_viiiiijiiiifiii).apply(null,arguments)},o.dynCall_viiiiijiiiiiiii=function(){return(o.dynCall_viiiiijiiiiiiii=o.asm.dynCall_viiiiijiiiiiiii).apply(null,arguments)},o.dynCall_viiiiijiiiijiii=function(){return(o.dynCall_viiiiijiiiijiii=o.asm.dynCall_viiiiijiiiijiii).apply(null,arguments)},o.dynCall_iiijii=function(){return(o.dynCall_iiijii=o.asm.dynCall_iiijii).apply(null,arguments)},o.dynCall_viiiji=function(){return(o.dynCall_viiiji=o.asm.dynCall_viiiji).apply(null,arguments)},o.dynCall_viiijjiijjiii=function(){return(o.dynCall_viiijjiijjiii=o.asm.dynCall_viiijjiijjiii).apply(null,arguments)},o.dynCall_jiiiiiiiii=function(){return(o.dynCall_jiiiiiiiii=o.asm.dynCall_jiiiiiiiii).apply(null,arguments)},o.dynCall_jiiiiiiifi=function(){return(o.dynCall_jiiiiiiifi=o.asm.dynCall_jiiiiiiifi).apply(null,arguments)},o.dynCall_jiiiiiiidi=function(){return(o.dynCall_jiiiiiiidi=o.asm.dynCall_jiiiiiiidi).apply(null,arguments)},o.dynCall_jiiiiiiijji=function(){return(o.dynCall_jiiiiiiijji=o.asm.dynCall_jiiiiiiijji).apply(null,arguments)},o.dynCall_jii=function(){return(o.dynCall_jii=o.asm.dynCall_jii).apply(null,arguments)},o.dynCall_vijiii=function(){return(o.dynCall_vijiii=o.asm.dynCall_vijiii).apply(null,arguments)},o.dynCall_viji=function(){return(o.dynCall_viji=o.asm.dynCall_viji).apply(null,arguments)},o.dynCall_jiji=function(){return(o.dynCall_jiji=o.asm.dynCall_jiji).apply(null,arguments)},o.dynCall_viijii=function(){return(o.dynCall_viijii=o.asm.dynCall_viijii).apply(null,arguments)},o.dynCall_iiiiij=function(){return(o.dynCall_iiiiij=o.asm.dynCall_iiiiij).apply(null,arguments)},o.dynCall_iiiiijj=function(){return(o.dynCall_iiiiijj=o.asm.dynCall_iiiiijj).apply(null,arguments)},o.dynCall_iiiiiijj=function(){return(o.dynCall_iiiiiijj=o.asm.dynCall_iiiiiijj).apply(null,arguments)};function wt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Tt(e){function t(){mt||(mt=!0,o.calledRun=!0,A||(te(),ie(),o.onRuntimeInitialized&&o.onRuntimeInitialized(),ne()))}e=e||l,se>0||(ee(),se>0||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t()))}if(o.ccall=E,o.cwrap=F,o.UTF8ToString=D,le=function e(){mt||Tt(),mt||(le=e)},o.run=Tt,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();Tt(),oe((function(){o.numArrayCoordinates=1,o.xIn=o._malloc(8*o.numArrayCoordinates),o.yIn=o._malloc(8*o.numArrayCoordinates),o.xOut=o._malloc(8*o.numArrayCoordinates),o.yOut=o._malloc(8*o.numArrayCoordinates),o.zIn=o._malloc(8*o.numArrayCoordinates),o.zOut=o._malloc(8*o.numArrayCoordinates),console.log("AST WebAssembly module loaded")})),o.LABEL_EXTERIOR=0,o.LABEL_INTERIOR=1,o.DEFAULT_TOLERANCE=.01,o.DEFAULT_COLOR=2,o.DEFAULT_FONT="20px Arial",o.SYS_ECLIPTIC=0,o.SYS_FK4=1,o.SYS_FK5=2,o.SYS_GALACTIC=3,o.SYS_ICRS=4,o.SYS_J2000=5,o.fonts=["{size} sans-serif","italic {size} sans-serif","bold {size} sans-serif","bold italic {size} sans-serif","{size} times","italic {size} times","bold {size} times","bold italic {size} times","{size} arial","bold {size} arial","italic {size} arial","bold italic {size} arial","{size} palatino","italic {size} palatino","bold {size} palatino","bold italic {size} palatino","{size} courier new","italic {size} courier new","bold {size} courier new","bold italic {size} courier new"],o.colors=["black","white","red","green","blue","cyan","magenta","yellow","grey"],o.shapes=["\u25a1","\u25e6","+","\u26b9","\u25cb","\u2a09","\u25a1","\u25bd","\u2295","\u25a1","\u25c7","\u2606"],o.setPalette=function(e){o.colors=e},o.setFontList=function(e){o.fonts=e},o.setCanvas=function(e){o.gridContext=e.getContext("2d"),o.gridContext.imageSmoothingEnabled=!1,o.gridContext.scale(1,-1),o.gridContext.translate(0,-e.height),o.gridContext.font=o.font},o.plot=o.cwrap("plotGrid","number",["number","number","number","number","number","number","number","number","number","number","number","string"]),o.initFrame=o.cwrap("initFrame","number",["string"]),o.getSpectralFrame=o.cwrap("getSpectralFrame","number",["number"]),o.getSkyFrameSet=o.cwrap("getSkyFrameSet","number",["number"]),o.initDummyFrame=o.cwrap("initDummyFrame","number",[]),o.set=o.cwrap("set","number",["number","string"]),o.clear=o.cwrap("clear","number",["number","string"]),o.getString=o.cwrap("getString","string",["number","string"]),o.dump=o.cwrap("dump",null,["number"]),o.norm=o.cwrap("norm","number",["number","number"]),o.axDistance=o.cwrap("axDistance","number",["number","number","number","number"]),o.format=o.cwrap("format","string",["number","number","number"]),o.unformat=o.cwrap("unformat","number",["number","number","string","number"]),o.transform=o.cwrap("transform","number",["number","number","number","number","number","number","number"]),o.transform3D=o.cwrap("transform3D","number",["number","number","number","number","number","number"]),o.spectralTransform=o.cwrap("spectralTransform","number",["number","string","string","string","number","number","number","number"]),o.getLastErrorMessage=o.cwrap("getLastErrorMessage","string"),o.clearLastErrorMessage=o.cwrap("clearLastErrorMessage",null),o.copy=o.cwrap("copy",null,["number"]),o.delete=o.cwrap("deleteObject",null,["number"]),o.invert=o.cwrap("invert","number",["number"]),o.convert=o.cwrap("convert","number",["number","number","string"]),o.shiftMap2D=o.cwrap("shiftMap2D","number",["number","number"]),o.createTransformedFrameset=o.cwrap("createTransformedFrameset","number",["number","number","number","number","number","number","number","number"]),o.fillTransformGrid=o.cwrap("fillTransformGrid","number",["number","number","number","number","number","number","number","number"]),o.currentFormatStrings=[],o.getFormattedCoordinates=function(e,t,i,n,r){var s,a,l;return r?(s=o.currentFormatStrings[e],o.set(e,n)):n&&o.currentFormatStrings[e]!==n&&(o.set(e,n),o.currentFormatStrings[e]=n),void 0!==t&&(a=o.format(e,1,t)),void 0!==i&&(l=o.format(e,2,i)),r&&o.set(e,s),{x:a,y:l}},o.getWCSValueFromFormattedString=function(e,t){o.unformat(e,1,t.x,o.xOut),o.unformat(e,2,t.y,o.yOut);var i=new Float64Array(o.HEAPF64.buffer,o.xOut,1),n=new Float64Array(o.HEAPF64.buffer,o.yOut,1);return{x:i[0],y:n[0]}},o.transformPointArrays=function(e,t,i,n){if(!(t instanceof Float64Array)||!(i instanceof Float64Array)||t.length!==i.length)return{x:new Float64Array(1),y:new Float64Array(1)};var r=t.length,s=o._malloc(8*r),a=o._malloc(8*r),l=o._malloc(8*r),c=o._malloc(8*r);o.HEAPF64.set(t,s/8),o.HEAPF64.set(i,a/8),o.transform(e,r,s,a,n,l,c);var d=new Float64Array(o.HEAPF64.buffer,l,r),u=new Float64Array(o.HEAPF64.buffer,c,r),h={x:d.slice(0),y:u.slice(0)};return o._free(s),o._free(a),o._free(l),o._free(c),h},o.transformPoint=function(e,t,i,n){void 0===n&&(n=!0);o.HEAPF64.set(new Float64Array([t]),o.xIn/8),o.HEAPF64.set(new Float64Array([i]),o.yIn/8),o.transform(e,1,o.xIn,o.yIn,n,o.xOut,o.yOut);var r=new Float64Array(o.HEAPF64.buffer,o.xOut,1),s=new Float64Array(o.HEAPF64.buffer,o.yOut,1);return{x:r[0],y:s[0]}},o.transform3DPoint=function(e,t,i,n,r){void 0===r&&(r=!0);var s=o._malloc(24);o.transform3D(e,t,i,n,r,s);var a=new Float64Array(o.HEAPF64.buffer,s,3),l={x:a[0],y:a[1],z:a[2]};return o._free(s),l},o.transformSpectralPoint=function(e,t,i,n,r,s){void 0===s&&(s=!0);return o.HEAPF64.set(new Float64Array([r]),o.zIn/8),o.spectralTransform(e,t,i,n,1,o.zIn,s,o.zOut),new Float64Array(o.HEAPF64.buffer,o.zOut,1)[0]},o.normalizeCoordinates=function(e,t,i){o.HEAPF64.set(new Float64Array([t,i]),o.xIn/8),o.norm(e,o.xIn);var n=new Float64Array(o.HEAPF64.buffer,o.xIn,2);return{x:n[0],y:n[1]}},o.getTransformGrid=function(e,t,i,n,r,s,a,l){var c=o.fillTransformGrid(e,t,i,n,r,s,a,l);if(c){var d=new Float32Array(o.HEAPF32.buffer,c,n*a*2).slice();return o._free(c),d}return null},o.onReady=new Promise((function(e){if(o.calledRun)e(o);else{var t=o.onRuntimeInitialized;o.onRuntimeInitialized=function(){t&&t(),e(o)}}})),e.exports=o}).call(this,i(46),"/",i(55).Buffer)},262:function(e,t){},263:function(e,t){},264:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"j",(function(){return r})),i.d(t,"l",(function(){return o})),i.d(t,"d",(function(){return s})),i.d(t,"h",(function(){return a})),i.d(t,"m",(function(){return l})),i.d(t,"e",(function(){return c})),i.d(t,"k",(function(){return d})),i.d(t,"c",(function(){return u})),i.d(t,"i",(function(){return h})),i.d(t,"g",(function(){return p})),i.d(t,"b",(function(){return g})),i.d(t,"f",(function(){return f}));const n=[{code:"FREQ",name:"Frequency",unit:"Hz"},{code:"ENER",name:"Energy",unit:"J"},{code:"WAVN",name:"Wavenumber",unit:"1/m"},{code:"VRAD",name:"Radio velocity",unit:"m/s"},{code:"WAVE",name:"Vacuum wavelength",unit:"m"},{code:"VOPT",name:"Optical velocity",unit:"m/s"},{code:"ZOPT",name:"Redshift",unit:""},{code:"AWAV",name:"Air wavelength",unit:"m"},{code:"VELO",name:"Apparent radial velocity",unit:"m/s"},{code:"BETA",name:"Beta",unit:""}];let r,o;!function(e){e.FREQ="FREQ",e.ENER="ENER",e.WAVE="WAVE"}(r||(r={})),function(e){e.VRAD="VRAD",e.VOPT="VOPT",e.FREQ="FREQ",e.WAVE="WAVE",e.AWAV="AWAV",e.CHANNEL="CHANNEL"}(o||(o={}));const s=e=>e&&e!==o.CHANNEL&&Object.values(o).includes(e),a=[o.VRAD,o.VOPT,o.FREQ,o.CHANNEL];let l;!function(e){e.KMS="km/s",e.MS="m/s",e.GHZ="GHz",e.MHZ="MHz",e.KHZ="kHz",e.HZ="Hz",e.M="m",e.MM="mm",e.UM="um",e.NM="nm",e.ANGSTROM="Angstrom"}(l||(l={}));const c=e=>e&&Object.values(l).includes(e);let d;!function(e){e.LSRK="LSRK",e.LSRD="LSRD",e.BARY="BARYCENT",e.TOPO="TOPOCENT"}(d||(d={}));const u=e=>e&&Object.values(d).includes(e),h=new Map([[o.VRAD,"Radio velocity"],[o.VOPT,"Optical velocity"],[o.FREQ,"Frequency"],[o.WAVE,"Vacuum wavelength"],[o.AWAV,"Air wavelength"],[o.CHANNEL,"Channel"]]),p=new Map([[o.VRAD,l.KMS],[o.VOPT,l.KMS],[o.FREQ,l.GHZ],[o.WAVE,l.MM],[o.AWAV,l.MM]]),g=(e,t)=>`${e?h.get(e):""}${t?" ("+t+")":""}`,f=new Map([[g(o.VRAD,l.KMS),{type:o.VRAD,unit:l.KMS}],[g(o.VRAD,l.MS),{type:o.VRAD,unit:l.MS}],[g(o.VOPT,l.KMS),{type:o.VOPT,unit:l.KMS}],[g(o.VOPT,l.MS),{type:o.VOPT,unit:l.MS}],[g(o.FREQ,l.GHZ),{type:o.FREQ,unit:l.GHZ}],[g(o.FREQ,l.MHZ),{type:o.FREQ,unit:l.MHZ}],[g(o.FREQ,l.KHZ),{type:o.FREQ,unit:l.KHZ}],[g(o.FREQ,l.HZ),{type:o.FREQ,unit:l.HZ}],[g(o.WAVE,l.M),{type:o.WAVE,unit:l.M}],[g(o.WAVE,l.MM),{type:o.WAVE,unit:l.MM}],[g(o.WAVE,l.UM),{type:o.WAVE,unit:l.UM}],[g(o.WAVE,l.NM),{type:o.WAVE,unit:l.NM}],[g(o.WAVE,l.ANGSTROM),{type:o.WAVE,unit:l.ANGSTROM}],[g(o.AWAV,l.M),{type:o.AWAV,unit:l.M}],[g(o.AWAV,l.MM),{type:o.AWAV,unit:l.MM}],[g(o.AWAV,l.UM),{type:o.AWAV,unit:l.UM}],[g(o.AWAV,l.NM),{type:o.AWAV,unit:l.NM}],[g(o.AWAV,l.ANGSTROM),{type:o.AWAV,unit:l.ANGSTROM}],["Channel",{type:o.CHANNEL,unit:null}]])},265:function(e,t){},266:function(e,t,i){"use strict";i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return o}));var n=i(7);class r{constructor(){this.x=void 0,this.y=void 0}static ToString(e,t,i=-1){return e?`(${i<0?e.x:Object(n.mb)(e.x,i)} ${t}, ${i<0?e.y:Object(n.mb)(e.y,i)} ${t})`:""}}class o{constructor(){this.x=void 0,this.y=void 0}static ToString(e){return e?`(${e.x}, ${e.y})`:""}}},267:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(7);class r{constructor(e,t){this.translation=void 0,this.rotation=void 0,this.scale=void 0,this.origin=void 0;const i=Object(n.nb)(e,t,!0),r=Object(n.f)(t,{x:0,y:.5}),o=Object(n.f)(t,{x:0,y:-.5}),s=Object(n.kb)(r,o),a=Object(n.nb)(e,r,!0),l=Object(n.nb)(e,o,!0),c=Object(n.kb)(a,l);this.scale=Object(n.P)(c)/Object(n.P)(s),this.rotation=Math.atan2(c.y,c.x)-Math.atan2(s.y,s.x),this.translation=Object(n.kb)(i,t),this.origin={x:t.x,y:t.y}}transformCoordinate(e,t=!0){if(t){const t=Object(n.fb)(e,this.origin,this.scale,this.rotation);return Object(n.f)(t,this.translation)}{const t=Object(n.kb)(e,this.translation);return Object(n.fb)(t,this.origin,1/this.scale,-this.rotation)}}}},268:function(e,t){},269:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{constructor(e,t,i){this.layer=void 0,this.x=void 0,this.y=void 0,this.x=e,this.y=t,this.layer=i}encode(){return n.EncodeCoordinate(this)}static EncodeCoordinate(e){return e?n.Encode(e.x,e.y,e.layer):-1}static Encode(e,t,i){const n=1<<i;return e<0||t<0||i<0||i>12||e>=n||t>=n?-1:i<<24|t<<12|e}static Decode(e){return new n(4095&e,e>>12&4095,e>>24&127)}static GetLayer(e){return e>>24&127}}},27:function(e,t,i){"use strict";i.d(t,"a",(function(){return O})),i.d(t,"c",(function(){return be})),i.d(t,"b",(function(){return me})),i.d(t,"g",(function(){return Ae})),i.d(t,"h",(function(){return Re})),i.d(t,"i",(function(){return Ee})),i.d(t,"d",(function(){return Fe})),i.d(t,"e",(function(){return Me})),i.d(t,"f",(function(){return ke}));var n,r,o,s,a,l,c=i(4),d=i(2),u=(i(28),i(171)),h=i.n(u),p=i(172),g=i.n(p),f=i(1),b=i(8),m=i(11);const y=i(805);let O=(l=a=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}static SetRuntimeConfig(t){console.log("Setting runtime config"),e.RuntimeConfig=t||{}}get accessToken(){return this._accessToken}get tokenLifetime(){return this._tokenLifetime}get authenticated(){return this._accessToken&&this._tokenLifetime>0}constructor(){Object(c.a)(this,"_accessToken",r,this),this._tokenLifetime=void 0,this._tokenExpiryHandler=void 0,this.axiosInstance=void 0,this.authInstance=void 0,Object(c.a)(this,"setToken",o,this),Object(c.a)(this,"clearToken",s,this),this.onTokenExpired=async()=>{clearTimeout(this._tokenExpiryHandler);if(await this.refreshAccessToken()){console.log("Authenticated");const e=this.tokenLifetime;this._tokenExpiryHandler=setTimeout(this.onTokenExpired,1e3*(e-10))}else this.handleAuthLost()},this.handleAuthLost=()=>{if(e.RuntimeConfig.dashboardAddress){this.clearToken();const t=btoa(window.location.search);window.open(`${e.RuntimeConfig.dashboardAddress}?redirectParams=${t}`,"_self")}else this.clearToken(),b.a.show({icon:"warning-sign",message:"Could not authenticate with server",intent:"danger",timeout:3e3})},this.refreshAccessToken=async()=>{if(e.RuntimeConfig.googleClientId)try{var t;this.authInstance=gapi.auth2.getAuthInstance();const e=null===(t=this.authInstance)||void 0===t?void 0:t.currentUser.get();if(null===e||void 0===e?void 0:e.isSignedIn()){const t=await e.reloadAuthResponse();return this.setToken(t.id_token,t.expires_in)?(console.log("Authenticated with Google"),!0):(console.log("Error parsing Google access token"),!1)}return console.log("Not authenticated!"),this.clearToken(),!1}catch(n){return!1}else{if(!e.RuntimeConfig.tokenRefreshAddress)return!1;try{var i;const t=await this.axiosInstance.post(e.RuntimeConfig.tokenRefreshAddress);return(null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.access_token)?(this.setToken(t.data.access_token,t.data.expires_in||Number.MAX_VALUE),!0):(this.clearToken(),!1)}catch(r){return this.clearToken(),console.log(r),!1}}},this.logout=async()=>{var t;if(this.clearToken(),e.RuntimeConfig.googleClientId)null===(t=this.authInstance)||void 0===t||t.signOut();else if(e.RuntimeConfig.logoutAddress)try{await this.axiosInstance.post(e.RuntimeConfig.logoutAddress)}catch(i){console.log(i)}e.RuntimeConfig.dashboardAddress&&window.open(e.RuntimeConfig.dashboardAddress,"_self")},this.stopServer=async()=>{if(e.RuntimeConfig.apiAddress)try{const t=`${e.RuntimeConfig.apiAddress}/server/stop`;await this.axiosInstance.post(t)}catch(t){b.a.show({icon:"warning-sign",message:"Could not stop CARTA server",intent:"danger",timeout:3e3}),console.log(t)}},this.getPreferences=async()=>{let t;var i;if(e.RuntimeConfig.apiAddress)try{var n;const i=`${e.RuntimeConfig.apiAddress}/database/preferences`,r=await this.axiosInstance.get(i);if(!(null===r||void 0===r||null===(n=r.data)||void 0===n?void 0:n.success))return;t=r.data.preferences}catch(r){return void console.log(r)}else t=null!==(i=JSON.parse(localStorage.getItem("preferences")))&&void 0!==i?i:{};if(!e.PreferenceValidator(t))for(const o of e.PreferenceValidator.errors)o.dataPath&&(console.log(`Removing invalid preference ${o.dataPath}`),delete t[o.dataPath.substring(1)]);return t},this.setPreference=async(e,t)=>{const i={};return i[e]=t,this.setPreferences(i)},this.setPreferences=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/preferences`,r=await this.axiosInstance.put(n,t);return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const i=null!==(n=JSON.parse(localStorage.getItem("preferences")))&&void 0!==n?n:{};for(const e of Object.keys(t))i[e]=t[e];return e.PreferenceValidator(i)||console.log(e.PreferenceValidator.errors),localStorage.setItem("preferences",JSON.stringify(i)),!0}catch(r){return!1}},this.clearPreferences=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/preferences`,r=await this.axiosInstance.delete(n,{data:{keys:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("preferences")))&&void 0!==n?n:{};for(const i of t)delete e[i];return localStorage.setItem("preferences",JSON.stringify(e)),!0}catch(r){return!1}},this.getLayouts=async()=>{let t;if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/layouts`,r=await this.axiosInstance.get(n);if(!(null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success))return;t=r.data.layouts}catch(r){return void console.log(r)}else try{var n;t=null!==(n=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==n?n:{}}catch(r){return void console.log(r)}if(t){const e={};for(const i of Object.keys(t)){const n=t[i];m.LayoutConfig.UpgradeLayout(n);m.LayoutConfig.LayoutValidator(n)?e[i]=n:console.log(m.LayoutConfig.LayoutValidator.errors)}return e}},this.setLayout=async(t,i)=>{if(e.RuntimeConfig.apiAddress)try{var n;const r=`${e.RuntimeConfig.apiAddress}/database/layout`,o=await this.axiosInstance.put(r,{layoutName:t,layout:i});return null===o||void 0===o||null===(n=o.data)||void 0===n?void 0:n.success}catch(o){return console.log(o),!1}else try{var r;const e=null!==(r=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==r?r:{};return e[t]=i,localStorage.setItem("savedLayouts",JSON.stringify(e)),!0}catch(o){return!1}},this.clearLayout=async t=>{if(e.RuntimeConfig.apiAddress)try{var i;const n=`${e.RuntimeConfig.apiAddress}/database/layout`,r=await this.axiosInstance.delete(n,{data:{layoutName:t}});return null===r||void 0===r||null===(i=r.data)||void 0===i?void 0:i.success}catch(r){return console.log(r),!1}else try{var n;const e=null!==(n=JSON.parse(localStorage.getItem("savedLayouts")))&&void 0!==n?n:{};return delete e[t],localStorage.setItem("savedLayouts",JSON.stringify(e)),!0}catch(r){return!1}},Object(f.p)(this),this.axiosInstance=h.a.create(),e.RuntimeConfig.googleClientId?gapi.load("auth2",(()=>{console.log("Google auth loaded");try{gapi.auth2.init({client_id:e.RuntimeConfig.googleClientId,scope:"profile email"}).then(this.onTokenExpired,(e=>{console.log(e),this.handleAuthLost()}))}catch(t){console.log(t),this.handleAuthLost()}})):e.RuntimeConfig.tokenRefreshAddress?this.onTokenExpired():(this._accessToken="no_auth_configured",this._tokenLifetime=Number.MAX_VALUE)}},a.staticInstance=void 0,a.RuntimeConfig=void 0,a.PreferenceValidator=new g.a({strictTypes:!1}).compile(y),n=l,r=Object(d.a)(n.prototype,"_accessToken",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(d.a)(n.prototype,"setToken",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=Number.MAX_VALUE)=>isFinite(t)&&t>0?(t===Number.MAX_VALUE?document.cookie=`carta-auth-token=${e}`:console.log(`Token updated and valid for ${t.toFixed()} seconds`),this._accessToken=e,this.axiosInstance.defaults.headers.common.Authorization=`Bearer ${e}`,this._tokenLifetime=t,!0):(this.clearToken(),!1)}}),s=Object(d.a)(n.prototype,"clearToken",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this._accessToken=void 0,this._tokenLifetime=-1,delete this.axiosInstance.defaults.headers.common.Authorization}}}),Object(d.a)(n.prototype,"authenticated",[f.i],Object.getOwnPropertyDescriptor(n.prototype,"authenticated"),n.prototype),n);var j,S,x,C,I,w,T,v,A,R,P,E,F,M,k,D,N,L,_,z,W,G,V,B,H,q,Y,U,X,$,K,Q,Z,J,ee,te,ie,ne,re,oe,se,ae,le,ce,de=i(6),ue=i(908),he=i(130),pe=i(905),ge=i(5),fe=i(7);let be;!function(e){e[e.CLOSED=0]="CLOSED",e[e.PENDING=1]="PENDING",e[e.ACTIVE=2]="ACTIVE"}(be||(be={}));let me=(j=Object(f.g)("connect"),S=Object(f.g)("file list"),x=Object(f.g)("region list"),C=Object(f.g)("catalog list"),I=Object(f.g)("file info"),w=Object(f.g)("region info"),T=Object(f.g)("catalog info"),v=Object(f.g)("import region"),A=Object(f.g)("export regions"),R=Object(f.g)("load file"),P=Object(f.g)("load catalog file"),E=Object(f.g)("close catalog file"),F=Object(f.g)("save file"),M=Object(f.g)("close file"),k=Object(f.g)("set channels"),D=Object(f.g)("set cursor"),N=Object(f.g)("set region"),L=Object(f.g)("remove region"),_=Object(f.g)("set catalog filter"),z=Object(f.g)("set spatial requirements"),W=Object(f.g)("set spectral requirements"),G=Object(f.g)("set stats requirements"),V=Object(f.g)("set histogram requirements"),B=Object(f.g)("add required tiles"),H=Object(f.g)("remove required tiles"),q=Object(f.g)("start animation"),Y=Object(f.g)("stop animation"),U=Object(f.g)("animation flow control"),X=Object(f.g)("set contour parameters"),$=Object(f.g)("resume session"),K=Object(f.g)("set auth token"),Q=Object(f.g)("request moment"),Z=Object(f.g)("cancel requesting moment"),J=Object(f.g)("request spectral line"),ee=Object(f.g)("send scripting response"),ce=le=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(c.a)(this,"connectionStatus",ie,this),this.loggingEnabled=void 0,Object(c.a)(this,"connectionDropped",ne,this),Object(c.a)(this,"endToEndPing",re,this),this.animationId=void 0,this.sessionId=void 0,this.serverFeatureFlags=void 0,this.grpcPort=void 0,this.serverUrl=void 0,this.connection=void 0,this.lastPingTime=void 0,this.lastPongTime=void 0,this.autoReconnect=void 0,this.observerRequestMap=void 0,this.eventCounter=void 0,this.rasterTileStream=void 0,this.rasterSyncStream=void 0,this.histogramStream=void 0,this.errorStream=void 0,this.spatialProfileStream=void 0,this.spectralProfileStream=void 0,this.statsStream=void 0,this.contourStream=void 0,this.catalogStream=void 0,this.momentProgressStream=void 0,this.reconnectStream=void 0,this.scriptingStream=void 0,this.decoderMap=void 0,this.sendPing=()=>{this.connection&&this.connectionStatus===be.ACTIVE&&(this.lastPingTime=performance.now(),this.connection.send("PING"))},Object(c.a)(this,"updateEndToEndPing",oe,this),Object(c.a)(this,"setAuthToken",se,this),Object(c.a)(this,"sendScriptingResponse",ae,this),Object(f.p)(this),this.loggingEnabled=!0,this.observerRequestMap=new Map,this.eventCounter=1,this.sessionId=0,this.endToEndPing=NaN,this.animationId=-1,this.connectionStatus=be.CLOSED,this.rasterTileStream=new ue.a,this.rasterSyncStream=new ue.a,this.histogramStream=new ue.a,this.errorStream=new ue.a,this.spatialProfileStream=new ue.a,this.spectralProfileStream=new ue.a,this.statsStream=new ue.a,this.contourStream=new ue.a,this.scriptingStream=new ue.a,this.catalogStream=new ue.a,this.momentProgressStream=new ue.a,this.reconnectStream=new ue.a,this.decoderMap=new Map([[de.a.EventType.REGISTER_VIEWER_ACK,{messageClass:de.a.RegisterViewerAck,handler:this.onRegisterViewerAck}],[de.a.EventType.FILE_LIST_RESPONSE,{messageClass:de.a.FileListResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.REGION_LIST_RESPONSE,{messageClass:de.a.RegionListResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.CATALOG_LIST_RESPONSE,{messageClass:de.a.CatalogListResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.FILE_INFO_RESPONSE,{messageClass:de.a.FileInfoResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.REGION_FILE_INFO_RESPONSE,{messageClass:de.a.RegionFileInfoResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.CATALOG_FILE_INFO_RESPONSE,{messageClass:de.a.CatalogFileInfoResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.OPEN_FILE_ACK,{messageClass:de.a.OpenFileAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.SAVE_FILE_ACK,{messageClass:de.a.SaveFileAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.OPEN_CATALOG_FILE_ACK,{messageClass:de.a.OpenCatalogFileAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.IMPORT_REGION_ACK,{messageClass:de.a.ImportRegionAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.EXPORT_REGION_ACK,{messageClass:de.a.ExportRegionAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.SET_REGION_ACK,{messageClass:de.a.SetRegionAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.RESUME_SESSION_ACK,{messageClass:de.a.ResumeSessionAck,handler:this.onSimpleMappedResponse}],[de.a.EventType.START_ANIMATION_ACK,{messageClass:de.a.StartAnimationAck,handler:this.onStartAnimationAck}],[de.a.EventType.RASTER_TILE_DATA,{messageClass:de.a.RasterTileData,handler:this.onStreamedRasterTileData}],[de.a.EventType.REGION_HISTOGRAM_DATA,{messageClass:de.a.RegionHistogramData,handler:this.onStreamedRegionHistogramData}],[de.a.EventType.ERROR_DATA,{messageClass:de.a.ErrorData,handler:this.onStreamedErrorData}],[de.a.EventType.SPATIAL_PROFILE_DATA,{messageClass:de.a.SpatialProfileData,handler:this.onStreamedSpatialProfileData}],[de.a.EventType.SPECTRAL_PROFILE_DATA,{messageClass:de.a.SpectralProfileData,handler:this.onStreamedSpectralProfileData}],[de.a.EventType.REGION_STATS_DATA,{messageClass:de.a.RegionStatsData,handler:this.onStreamedRegionStatsData}],[de.a.EventType.CONTOUR_IMAGE_DATA,{messageClass:de.a.ContourImageData,handler:this.onStreamedContourData}],[de.a.EventType.CATALOG_FILTER_RESPONSE,{messageClass:de.a.CatalogFilterResponse,handler:this.onStreamedCatalogData}],[de.a.EventType.RASTER_TILE_SYNC,{messageClass:de.a.RasterTileSync,handler:this.onStreamedRasterSync}],[de.a.EventType.MOMENT_PROGRESS,{messageClass:de.a.MomentProgress,handler:this.onStreamedMomentProgress}],[de.a.EventType.MOMENT_RESPONSE,{messageClass:de.a.MomentResponse,handler:this.onSimpleMappedResponse}],[de.a.EventType.SCRIPTING_REQUEST,{messageClass:de.a.ScriptingRequest,handler:this.onScriptingRequest}],[de.a.EventType.SPECTRAL_LINE_RESPONSE,{messageClass:de.a.SpectralLineResponse,handler:this.onSimpleMappedResponse}]]),setInterval(this.sendPing,5e3)}connect(t,i=!0){this.connection&&(this.connection.onclose=null,this.connection.close());const n=O.Instance;return this.autoReconnect=i,this.connectionDropped=!1,this.connectionStatus=be.PENDING,this.serverUrl=t,this.connection=new WebSocket(n.accessToken?t+`?token=${n.accessToken}`:t),this.connection.binaryType="arraybuffer",this.connection.onmessage=this.messageHandler.bind(this),this.connection.onclose=e=>Object(f.s)((()=>{this.connectionStatus===be.ACTIVE&&(this.connectionStatus=be.CLOSED),!e.wasClean&&this.autoReconnect&&setTimeout((()=>{const e=new WebSocket(n.accessToken?t+`?token=${n.accessToken}`:t);e.binaryType="arraybuffer",e.onopen=this.connection.onopen,e.onerror=this.connection.onerror,e.onclose=this.connection.onclose,e.onmessage=this.connection.onmessage,this.connection=e}),1e3)})),new he.a((i=>{this.connection.onopen=Object(f.g)((()=>{this.connectionStatus===be.CLOSED&&(this.connectionDropped=!0),this.connectionStatus=be.ACTIVE,this.autoReconnect=!0;const t=de.a.RegisterViewer.create({sessionId:this.sessionId,clientFeatureFlags:e.DefaultFeatureFlags});this.observerRequestMap.clear(),this.eventCounter=1;const n=this.eventCounter;this.logEvent(de.a.EventType.REGISTER_VIEWER,n,t,!1),this.sendEvent(de.a.EventType.REGISTER_VIEWER,de.a.RegisterViewer.encode(t).finish())&&this.observerRequestMap.set(n,i)})),this.connection.onerror=e=>{ge.e.Instance.logStore.addInfo(`Connecting to server ${t} failed. Retrying...`,["network"]),console.log(e)}}))}getFileList(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=de.a.FileListRequest.create({directory:e}),i=this.eventCounter;return this.logEvent(de.a.EventType.FILE_LIST_REQUEST,i,t,!1),this.sendEvent(de.a.EventType.FILE_LIST_REQUEST,de.a.FileListRequest.encode(t).finish())?new he.a((e=>{this.observerRequestMap.set(i,e)})):Object(pe.a)(new Error("Could not send event"))}}getRegionList(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=de.a.RegionListRequest.create({directory:e}),i=this.eventCounter;return this.logEvent(de.a.EventType.REGION_LIST_REQUEST,i,t,!1),this.sendEvent(de.a.EventType.REGION_LIST_REQUEST,de.a.RegionListRequest.encode(t).finish())?new he.a((e=>{this.observerRequestMap.set(i,e)})):Object(pe.a)(new Error("Could not send event"))}}getCatalogList(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=de.a.CatalogListRequest.create({directory:e}),i=this.eventCounter;return this.logEvent(de.a.EventType.CATALOG_LIST_REQUEST,i,t,!1),this.sendEvent(de.a.EventType.CATALOG_LIST_REQUEST,de.a.CatalogListRequest.encode(t).finish())?new he.a((e=>{this.observerRequestMap.set(i,e)})):Object(pe.a)(new Error("Could not send event"))}}getFileInfo(e,t,i){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const n=de.a.FileInfoRequest.create({directory:e,file:t,hdu:i}),r=this.eventCounter;return this.logEvent(de.a.EventType.FILE_INFO_REQUEST,r,n,!1),this.sendEvent(de.a.EventType.FILE_INFO_REQUEST,de.a.FileInfoRequest.encode(n).finish())?new he.a((e=>{this.observerRequestMap.set(r,e)})):Object(pe.a)(new Error("Could not send event"))}}getRegionFileInfo(e,t){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const i=de.a.RegionFileInfoRequest.create({directory:e,file:t}),n=this.eventCounter;return this.logEvent(de.a.EventType.REGION_FILE_INFO_REQUEST,n,i,!1),this.sendEvent(de.a.EventType.REGION_FILE_INFO_REQUEST,de.a.RegionFileInfoRequest.encode(i).finish())?new he.a((e=>{this.observerRequestMap.set(n,e)})):Object(pe.a)(new Error("Could not send event"))}}getCatalogFileInfo(e,t){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const i=de.a.CatalogFileInfoRequest.create({directory:e,name:t}),n=this.eventCounter;return this.logEvent(de.a.EventType.CATALOG_FILE_INFO_REQUEST,n,i,!1),this.sendEvent(de.a.EventType.CATALOG_FILE_INFO_REQUEST,de.a.CatalogFileInfoRequest.encode(i).finish())?new he.a((e=>{this.observerRequestMap.set(n,e)})):Object(pe.a)(new Error("Could not send event"))}}importRegion(e,t,i,n){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const r=de.a.ImportRegion.create({directory:e,file:t,type:i,groupId:n}),o=this.eventCounter;return this.logEvent(de.a.EventType.IMPORT_REGION,o,r,!1),this.sendEvent(de.a.EventType.IMPORT_REGION,de.a.ImportRegion.encode(r).finish())?new he.a((e=>{this.observerRequestMap.set(o,e)})):Object(pe.a)(new Error("Could not send event"))}}exportRegion(e,t,i,n,r,o){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const s=de.a.ExportRegion.create({directory:e,file:t,type:i,fileId:r,regionStyles:Object(fe.R)(o),coordType:n}),a=this.eventCounter;return this.logEvent(de.a.EventType.EXPORT_REGION,a,s,!1),this.sendEvent(de.a.EventType.EXPORT_REGION,de.a.ExportRegion.encode(s).finish())?new he.a((e=>{this.observerRequestMap.set(a,e)})):Object(pe.a)(new Error("Could not send event"))}}loadFile(e,t,i,n,r){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const o=de.a.OpenFile.create({directory:e,file:t,hdu:i,fileId:n,renderMode:r}),s=this.eventCounter;return this.logEvent(de.a.EventType.OPEN_FILE,s,o,!1),this.sendEvent(de.a.EventType.OPEN_FILE,de.a.OpenFile.encode(o).finish())?new he.a((e=>{this.observerRequestMap.set(s,e)})):Object(pe.a)(new Error("Could not send event"))}}loadCatalogFile(e,t,i,n){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const r=de.a.OpenCatalogFile.create({directory:e,name:t,fileId:i,previewDataSize:n}),o=this.eventCounter;return this.logEvent(de.a.EventType.OPEN_CATALOG_FILE,o,r,!1),this.sendEvent(de.a.EventType.OPEN_CATALOG_FILE,de.a.OpenCatalogFile.encode(r).finish())?new he.a((e=>{this.observerRequestMap.set(o,e)})):Object(pe.a)(new Error("Could not send event"))}}closeCatalogFile(e){if(this.connectionStatus===be.ACTIVE){const t=de.a.CloseCatalogFile.create({fileId:e});if(this.logEvent(de.a.EventType.CLOSE_CATALOG_FILE,this.eventCounter,t,!1),this.sendEvent(de.a.EventType.CLOSE_CATALOG_FILE,de.a.CloseCatalogFile.encode(t).finish()))return!0}return!1}saveFile(e,t,i,n){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const r=de.a.SaveFile.create({fileId:e,outputFileDirectory:t,outputFileName:i,outputFileType:n}),o=this.eventCounter;return this.logEvent(de.a.EventType.SAVE_FILE,this.eventCounter,r,!1),this.sendEvent(de.a.EventType.SAVE_FILE,de.a.SaveFile.encode(r).finish())?new he.a((e=>{this.observerRequestMap.set(o,e)})):Object(pe.a)(new Error("Could not send event"))}}closeFile(e){if(this.connectionStatus===be.ACTIVE){const t=de.a.CloseFile.create({fileId:e});if(this.logEvent(de.a.EventType.CLOSE_FILE,this.eventCounter,t,!1),this.sendEvent(de.a.EventType.CLOSE_FILE,de.a.CloseFile.encode(t).finish()))return!0}return!1}setChannels(e,t,i,n){if(this.connectionStatus===be.ACTIVE){const r=de.a.SetImageChannels.create({fileId:e,channel:t,stokes:i,requiredTiles:n});if(this.logEvent(de.a.EventType.SET_IMAGE_CHANNELS,this.eventCounter,r,!1),this.sendEvent(de.a.EventType.SET_IMAGE_CHANNELS,de.a.SetImageChannels.encode(r).finish()))return!0}return!1}setCursor(e,t,i){if(this.connectionStatus===be.ACTIVE){const n=de.a.SetCursor.create({fileId:e,point:{x:t,y:i}});if(this.logEvent(de.a.EventType.SET_CURSOR,this.eventCounter,n,!1),this.sendEvent(de.a.EventType.SET_CURSOR,de.a.SetCursor.encode(n).finish()))return!0}return!1}setRegion(e,t,i){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const n=de.a.SetRegion.create({fileId:e,regionId:t,regionInfo:{regionType:i.regionType,rotation:i.rotation,controlPoints:i.controlPoints.slice()}}),r=this.eventCounter;return this.logEvent(de.a.EventType.SET_REGION,r,n,!1),this.sendEvent(de.a.EventType.SET_REGION,de.a.SetRegion.encode(n).finish())?new he.a((e=>{this.observerRequestMap.set(r,e)})):Object(pe.a)(new Error("Could not send event"))}}removeRegion(e){if(this.connectionStatus===be.ACTIVE){const t=de.a.RemoveRegion.create({regionId:e});if(this.logEvent(de.a.EventType.REMOVE_REGION,this.eventCounter,t,!1),this.sendEvent(de.a.EventType.REMOVE_REGION,de.a.RemoveRegion.encode(t).finish()))return!0}return!1}setCatalogFilterRequest(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.CATALOG_FILTER_REQUEST,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.CATALOG_FILTER_REQUEST,de.a.CatalogFilterRequest.encode(e).finish())))}setSpatialRequirements(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.SET_SPATIAL_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.SET_SPATIAL_REQUIREMENTS,de.a.SetSpatialRequirements.encode(e).finish())))}setSpectralRequirements(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.SET_SPECTRAL_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.SET_SPECTRAL_REQUIREMENTS,de.a.SetSpectralRequirements.encode(e).finish())))}setStatsRequirements(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.SET_STATS_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.SET_STATS_REQUIREMENTS,de.a.SetStatsRequirements.encode(e).finish())))}setHistogramRequirements(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.SET_HISTOGRAM_REQUIREMENTS,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.SET_HISTOGRAM_REQUIREMENTS,de.a.SetHistogramRequirements.encode(e).finish())))}addRequiredTiles(e,t,i){if(this.connectionStatus===be.ACTIVE){const n=de.a.AddRequiredTiles.create({fileId:e,tiles:t,compressionQuality:i,compressionType:de.a.CompressionType.ZFP});if(this.logEvent(de.a.EventType.ADD_REQUIRED_TILES,this.eventCounter,n,!1),this.sendEvent(de.a.EventType.ADD_REQUIRED_TILES,de.a.AddRequiredTiles.encode(n).finish()))return!0}return!1}removeRequiredTiles(e,t){if(this.connectionStatus===be.ACTIVE){const i=de.a.RemoveRequiredTiles.create({fileId:e,tiles:t});if(this.logEvent(de.a.EventType.REMOVE_REQUIRED_TILES,this.eventCounter,i,!1),this.sendEvent(de.a.EventType.REMOVE_REQUIRED_TILES,de.a.RemoveRequiredTiles.encode(i).finish()))return!0}return!1}startAnimation(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=this.eventCounter;return this.logEvent(de.a.EventType.START_ANIMATION,t,e,!1),this.sendEvent(de.a.EventType.START_ANIMATION,de.a.StartAnimation.encode(e).finish())?new he.a((e=>{this.observerRequestMap.set(t,e)})):Object(pe.a)(new Error("Could not send event"))}}stopAnimation(e){return this.animationId=-1,!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.STOP_ANIMATION,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.STOP_ANIMATION,de.a.StopAnimation.encode(e).finish())))}sendAnimationFlowControl(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.ANIMATION_FLOW_CONTROL,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.ANIMATION_FLOW_CONTROL,de.a.AnimationFlowControl.encode(e).finish())))}setContourParameters(e){return!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.SET_CONTOUR_PARAMETERS,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.SET_CONTOUR_PARAMETERS,de.a.SetContourParameters.encode(e).finish())))}resumeSession(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=this.eventCounter;return this.logEvent(de.a.EventType.RESUME_SESSION,t,e,!1),this.sendEvent(de.a.EventType.RESUME_SESSION,de.a.ResumeSession.encode(e).finish())?new he.a((e=>{this.observerRequestMap.set(t,e)})):Object(pe.a)(new Error("Could not send event"))}}requestMoment(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=this.eventCounter;return this.logEvent(de.a.EventType.MOMENT_REQUEST,t,e,!1),this.sendEvent(de.a.EventType.MOMENT_REQUEST,de.a.MomentRequest.encode(e).finish())?new he.a((e=>{this.observerRequestMap.set(t,e)})):Object(pe.a)(new Error("Could not send event"))}}cancelRequestingMoment(e){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const t=de.a.StopMomentCalc.create({fileId:e});return this.logEvent(de.a.EventType.STOP_MOMENT_CALC,this.eventCounter,t,!1),!!this.sendEvent(de.a.EventType.STOP_MOMENT_CALC,de.a.StopMomentCalc.encode(t).finish())||Object(pe.a)(new Error("Could not send event"))}}requestSpectralLine(e,t){if(this.connectionStatus!==be.ACTIVE)return Object(pe.a)(new Error("Not connected"));{const i=de.a.SpectralLineRequest.create({frequencyRange:e,lineIntensityLowerLimit:t}),n=this.eventCounter;return this.logEvent(de.a.EventType.SPECTRAL_LINE_REQUEST,n,i,!1),this.sendEvent(de.a.EventType.SPECTRAL_LINE_REQUEST,de.a.SpectralLineRequest.encode(i).finish())?new he.a((e=>{this.observerRequestMap.set(n,e)})):Object(pe.a)(new Error("Could not send event"))}}serverHasFeature(e){return 0!==(this.serverFeatureFlags&e)}messageHandler(t){if("PONG"===t.data)return this.lastPongTime=performance.now(),void this.updateEndToEndPing();if(t.data.byteLength<8)return void console.log("Unknown event format");const i=new Uint16Array(t.data,0,2),n=new Uint32Array(t.data,4,1),r=new Uint8Array(t.data,8),o=i[0],s=i[1],a=n[0];s!==e.IcdVersion&&console.warn(`Server event has ICD version ${s}, which differs from frontend version ${e.IcdVersion}. Errors may occur`);try{const e=this.decoderMap.get(o);if(e){const t=e.messageClass.decode(r);t?(this.logEvent(o,a,t),e.handler.call(this,a,t)):console.log(`Unsupported event response ${o}`)}}catch(l){console.log(l)}}onSimpleMappedResponse(e,t){const i=this.observerRequestMap.get(e);i?(t.success?i.next(t):i.error(t.message),i.complete(),this.observerRequestMap.delete(e)):console.log(`Can't find observable for request ${e}`)}onRegisterViewerAck(e,t){this.sessionId=t.sessionId,this.serverFeatureFlags=t.serverFeatureFlags,this.grpcPort=t.grpcPort,this.onSimpleMappedResponse(e,t),t.success&&t.sessionType===de.a.SessionType.RESUMED&&this.reconnectStream.next()}onStartAnimationAck(e,t){this.animationId=t.success?t.animationId:-1,this.onSimpleMappedResponse(e,t)}onStreamedRasterTileData(e,t){this.rasterTileStream.next(t)}onStreamedRasterSync(e,t){this.rasterSyncStream.next(t)}onStreamedRegionHistogramData(e,t){this.histogramStream.next(t)}onStreamedErrorData(e,t){this.errorStream.next(t)}onStreamedSpatialProfileData(e,t){this.spatialProfileStream.next(t)}onStreamedSpectralProfileData(e,t){this.spectralProfileStream.next(t)}onStreamedRegionStatsData(e,t){this.statsStream.next(t)}onStreamedContourData(e,t){this.contourStream.next(t)}onScriptingRequest(e,t){this.scriptingStream.next(t)}onStreamedCatalogData(e,t){this.catalogStream.next(t)}onStreamedMomentProgress(e,t){this.momentProgressStream.next(t)}sendEvent(t,i){if(this.connection.readyState===WebSocket.OPEN){const n=new Uint8Array(8+i.byteLength),r=new Uint16Array(n.buffer,0,2),o=new Uint32Array(n.buffer,4,1);return r[0]=t,r[1]=e.IcdVersion,o[0]=this.eventCounter,n.set(i,8),this.connection.send(n),this.eventCounter++,!0}return console.log("Error sending event"),this.eventCounter++,!1}logEvent(e,t,i,n=!0){const r=de.a.EventType[e];this.loggingEnabled&&ge.H.Instance.isEventLoggingEnabled(e)&&(n?0===t?console.log(`<== ${r} [Stream]`):console.log(`<== ${r} [${t}]`):console.log(`${r} [${t}] ==>`),console.log(i),console.log("\n"))}},le.staticInstance=void 0,le.IcdVersion=19,le.DefaultFeatureFlags=de.a.ClientFeatureFlags.WEB_ASSEMBLY|de.a.ClientFeatureFlags.WEB_GL,te=ce,ie=Object(d.a)(te.prototype,"connectionStatus",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=Object(d.a)(te.prototype,"connectionDropped",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),re=Object(d.a)(te.prototype,"endToEndPing",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(te.prototype,"connect",[j],Object.getOwnPropertyDescriptor(te.prototype,"connect"),te.prototype),oe=Object(d.a)(te.prototype,"updateEndToEndPing",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.endToEndPing=this.lastPongTime-this.lastPingTime}}}),Object(d.a)(te.prototype,"getFileList",[S],Object.getOwnPropertyDescriptor(te.prototype,"getFileList"),te.prototype),Object(d.a)(te.prototype,"getRegionList",[x],Object.getOwnPropertyDescriptor(te.prototype,"getRegionList"),te.prototype),Object(d.a)(te.prototype,"getCatalogList",[C],Object.getOwnPropertyDescriptor(te.prototype,"getCatalogList"),te.prototype),Object(d.a)(te.prototype,"getFileInfo",[I],Object.getOwnPropertyDescriptor(te.prototype,"getFileInfo"),te.prototype),Object(d.a)(te.prototype,"getRegionFileInfo",[w],Object.getOwnPropertyDescriptor(te.prototype,"getRegionFileInfo"),te.prototype),Object(d.a)(te.prototype,"getCatalogFileInfo",[T],Object.getOwnPropertyDescriptor(te.prototype,"getCatalogFileInfo"),te.prototype),Object(d.a)(te.prototype,"importRegion",[v],Object.getOwnPropertyDescriptor(te.prototype,"importRegion"),te.prototype),Object(d.a)(te.prototype,"exportRegion",[A],Object.getOwnPropertyDescriptor(te.prototype,"exportRegion"),te.prototype),Object(d.a)(te.prototype,"loadFile",[R],Object.getOwnPropertyDescriptor(te.prototype,"loadFile"),te.prototype),Object(d.a)(te.prototype,"loadCatalogFile",[P],Object.getOwnPropertyDescriptor(te.prototype,"loadCatalogFile"),te.prototype),Object(d.a)(te.prototype,"closeCatalogFile",[E],Object.getOwnPropertyDescriptor(te.prototype,"closeCatalogFile"),te.prototype),Object(d.a)(te.prototype,"saveFile",[F],Object.getOwnPropertyDescriptor(te.prototype,"saveFile"),te.prototype),Object(d.a)(te.prototype,"closeFile",[M],Object.getOwnPropertyDescriptor(te.prototype,"closeFile"),te.prototype),Object(d.a)(te.prototype,"setChannels",[k],Object.getOwnPropertyDescriptor(te.prototype,"setChannels"),te.prototype),Object(d.a)(te.prototype,"setCursor",[D],Object.getOwnPropertyDescriptor(te.prototype,"setCursor"),te.prototype),Object(d.a)(te.prototype,"setRegion",[N],Object.getOwnPropertyDescriptor(te.prototype,"setRegion"),te.prototype),Object(d.a)(te.prototype,"removeRegion",[L],Object.getOwnPropertyDescriptor(te.prototype,"removeRegion"),te.prototype),Object(d.a)(te.prototype,"setCatalogFilterRequest",[_],Object.getOwnPropertyDescriptor(te.prototype,"setCatalogFilterRequest"),te.prototype),Object(d.a)(te.prototype,"setSpatialRequirements",[z],Object.getOwnPropertyDescriptor(te.prototype,"setSpatialRequirements"),te.prototype),Object(d.a)(te.prototype,"setSpectralRequirements",[W],Object.getOwnPropertyDescriptor(te.prototype,"setSpectralRequirements"),te.prototype),Object(d.a)(te.prototype,"setStatsRequirements",[G],Object.getOwnPropertyDescriptor(te.prototype,"setStatsRequirements"),te.prototype),Object(d.a)(te.prototype,"setHistogramRequirements",[V],Object.getOwnPropertyDescriptor(te.prototype,"setHistogramRequirements"),te.prototype),Object(d.a)(te.prototype,"addRequiredTiles",[B],Object.getOwnPropertyDescriptor(te.prototype,"addRequiredTiles"),te.prototype),Object(d.a)(te.prototype,"removeRequiredTiles",[H],Object.getOwnPropertyDescriptor(te.prototype,"removeRequiredTiles"),te.prototype),Object(d.a)(te.prototype,"startAnimation",[q],Object.getOwnPropertyDescriptor(te.prototype,"startAnimation"),te.prototype),Object(d.a)(te.prototype,"stopAnimation",[Y],Object.getOwnPropertyDescriptor(te.prototype,"stopAnimation"),te.prototype),Object(d.a)(te.prototype,"sendAnimationFlowControl",[U],Object.getOwnPropertyDescriptor(te.prototype,"sendAnimationFlowControl"),te.prototype),Object(d.a)(te.prototype,"setContourParameters",[X],Object.getOwnPropertyDescriptor(te.prototype,"setContourParameters"),te.prototype),Object(d.a)(te.prototype,"resumeSession",[$],Object.getOwnPropertyDescriptor(te.prototype,"resumeSession"),te.prototype),se=Object(d.a)(te.prototype,"setAuthToken",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{document.cookie=`CARTA-Authorization=${e}; path=/`}}}),Object(d.a)(te.prototype,"requestMoment",[Q],Object.getOwnPropertyDescriptor(te.prototype,"requestMoment"),te.prototype),Object(d.a)(te.prototype,"cancelRequestingMoment",[Z],Object.getOwnPropertyDescriptor(te.prototype,"cancelRequestingMoment"),te.prototype),Object(d.a)(te.prototype,"requestSpectralLine",[J],Object.getOwnPropertyDescriptor(te.prototype,"requestSpectralLine"),te.prototype),ae=Object(d.a)(te.prototype,"sendScriptingResponse",[ee],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>!(this.connectionStatus!==be.ACTIVE||(this.logEvent(de.a.EventType.SCRIPTING_RESPONSE,this.eventCounter,e,!1),!this.sendEvent(de.a.EventType.SCRIPTING_RESPONSE,de.a.ScriptingResponse.encode(e).finish())))}}),te);var ye,Oe,je,Se,xe,Ce,Ie=i(251),we=i.n(Ie);function Te(){return new Worker(i.p+"static/js/index.a2da4ca9.worker.js")}const ve=4096,Ae=256;let Re=(Ce=xe=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get zfpReady(){return this.workersReady&&this.workersReady.every((e=>e))}GetTileStream(){return this.tileStream}constructor(){this.backendService=void 0,this.persistentTiles=void 0,this.cacheMapCompressedTiles=void 0,this.pendingRequests=void 0,this.pendingDecompressions=void 0,this.channelMap=void 0,this.completedChannels=void 0,this.currentFileId=void 0,this.tileStream=void 0,this.cachedTiles=void 0,this.lruCapacitySystem=void 0,this.textureArray=void 0,this.textureCoordinateQueue=void 0,this.workers=void 0,this.compressionRequestCounter=void 0,this.pendingSynchronisedTiles=void 0,this.receivedSynchronisedTiles=void 0,this.animationEnabled=void 0,this.gl=void 0,Object(c.a)(this,"remainingTiles",Oe,this),Object(c.a)(this,"workersReady",je,this),this.setAnimationEnabled=e=>{this.animationEnabled=e},this.setCache=(e,t)=>{const i=e+85,n=16777216/(Ae*Ae),r=Math.min(Math.ceil(i/n),8);e=r*n-85,console.log(`lruGPU capacity rounded to : ${e}`),this.textureArray=new Array(r),this.initTextures(),this.resetCoordinateQueue(),this.cachedTiles=new we.a(Int32Array,null,e),this.lruCapacitySystem=t},Object(c.a)(this,"updateRemainingTileCount",Se,this),this.clearTile=(e,t)=>{e.data&&delete e.data,this.textureCoordinateQueue.push(e.textureCoordinate)},this.handleStreamSync=e=>{const t=`${e.fileId}_${e.stokes}_${e.channel}`;this.animationEnabled&&e.animationId!==this.backendService.animationId||(this.animationEnabled||0===e.animationId)&&(e.endSync?this.completedChannels.set(t,!0):(this.completedChannels.delete(t),this.pendingDecompressions.set(t,new Map)))},this.handleStreamedTiles=e=>{const t=`${e.fileId}_${e.stokes}_${e.channel}`;e.compressionType!==de.a.CompressionType.NONE&&e.compressionType!==de.a.CompressionType.ZFP&&console.error("Unsupported compression type");const i=this.channelMap.get(e.fileId);if(this.currentFileId!==e.fileId||!this.animationEnabled&&(!i||i.channel!==e.channel||i.stokes!==e.stokes))return void console.log(`Ignoring stale tile for channel=${e.channel} (Current channel=${i?i.channel:void 0})`);if(this.animationEnabled&&e.animationId!==this.backendService.animationId)return void console.log(`Skipping stale tile during animation Message animation_id: ${e.animationId}. Service animation_id: ${this.backendService.animationId}`);if(!this.animationEnabled&&0!==e.animationId)return void console.log(`Skipping stale animation tile outside of animation. Message animation_id: ${e.animationId}. Service animation_id: ${this.backendService.animationId}`);if(this.pendingDecompressions.get(t)){this.animationEnabled&&this.channelMap.set(e.fileId,{channel:e.channel,stokes:e.stokes});for(let t of e.tiles){const i=m.TileCoordinate.Encode(t.x,t.y,t.layer);if(this.pendingRequests.has(i)||this.animationEnabled)if(this.pendingRequests.delete(i),this.updateRemainingTileCount(),e.compressionType===de.a.CompressionType.NONE){const n=new Float32Array(t.imageData.buffer.slice(t.imageData.byteOffset,t.imageData.byteOffset+t.imageData.byteLength));this.updateStream(e.fileId,e.channel,e.stokes,n,t.width,t.height,t.layer,i)}else this.getCompressedCache(e.fileId).set(i,{tile:t,compressionQuality:e.compressionQuality}),this.asyncDecompressTile(e.fileId,e.channel,e.stokes,t,e.compressionQuality,i)}}else console.log(`Missing compression map for key=${t}`)},Object(f.p)(this),this.backendService=me.Instance,this.gl=Ee.Instance.gl,this.channelMap=new Map,this.persistentTiles=new Map,this.pendingRequests=new Map,this.cacheMapCompressedTiles=new Map,this.pendingDecompressions=new Map,this.completedChannels=new Map,this.compressionRequestCounter=0,this.remainingTiles=0,this.animationEnabled=!1,this.tileStream=new ue.a,this.backendService.rasterTileStream.subscribe(this.handleStreamedTiles),this.backendService.rasterSyncStream.subscribe(this.handleStreamSync),this.workers=new Array(Math.min(navigator.hardwareConcurrency||4,4)),this.workersReady=new Array(this.workers.length);for(let e=0;e<this.workers.length;e++)this.workers[e]=new Te,this.workers[e].onmessage=t=>{if("ready"===t.data[0])this.workersReady[e]=!0,console.log(`Tile Worker ${e} ready`);else if("decompress"===t.data[0]){const e=t.data[1],i=t.data[2],n=i.width*i.subsetHeight,r=new Float32Array(e,0,n);this.updateStream(i.fileId,i.channel,i.stokes,r,i.width,i.subsetHeight,i.layer,i.tileCoordinate)}}}resetCoordinateQueue(){const e=16777216/(Ae*Ae),t=this.textureArray.length*e;this.textureCoordinateQueue=new Array(t);for(let i=0;i<t;i++)this.textureCoordinateQueue[i]=t-1-i}getCompressedCache(e){const t=this.cacheMapCompressedTiles.get(e);if(t)return t;{const t=new we.a(Int32Array,null,this.lruCapacitySystem);return this.cacheMapCompressedTiles.set(e,t),t}}getTile(e,t,i,n,r=!1){return m.TileCoordinate.GetLayer(e)<4?this.persistentTiles.get(e):r?this.cachedTiles.peek(e):this.cachedTiles.get(e)}requestTiles(e,t,i,n,r,o,s=!1){let a=this.currentFileId!==t;a&&(this.currentFileId=t,this.pendingSynchronisedTiles=e.map((e=>e.encode())),this.receivedSynchronisedTiles=[],this.clearRequestQueue()),!s&&this.channelMap.has(t)||(this.pendingSynchronisedTiles=e.map((e=>e.encode())),this.receivedSynchronisedTiles=[],this.clearRequestQueue(),this.channelMap.set(t,{channel:i,stokes:n}),this.clearCompressedCache(t));const l=`${t}_${n}_${i}`,c=new Array;for(const d of e){if(d.layer<0)continue;const e=d.encode();if(!(!(s||a)&&(d.layer<4&&this.persistentTiles.has(e)||d.layer>=4&&this.cachedTiles.has(e)))&&!this.pendingRequests.has(e)){const r=!s&&this.getCompressedCache(t).get(e),o=this.pendingDecompressions.get(l),a=o&&o.has(e);r&&!a?(o||this.pendingDecompressions.set(l,new Map),this.asyncDecompressTile(t,i,n,r.tile,r.compressionQuality,e)):r||(this.pendingRequests.set(e,!0),this.updateRemainingTileCount(),c.push(d))}}if(c.length){const e=c.sort(((e,t)=>{const i=r.x-e.x,n=r.y-e.y,o=r.x-t.x,s=r.y-t.y;return i*i+n*n-(o*o+s*s)})).map((e=>e.encode()));s?this.backendService.setChannels(t,i,n,{fileId:t,compressionQuality:o,compressionType:de.a.CompressionType.ZFP,tiles:e}):this.backendService.addRequiredTiles(t,e,o)}else this.completedChannels.set(l,!0)}updateInactiveFileChannel(e,t,i){this.clearCompressedCache(e),this.channelMap.set(e,{channel:t,stokes:i}),this.backendService.setChannels(e,t,i,{})}clearGPUCache(){this.cachedTiles.forEach(this.clearTile),this.cachedTiles.clear(),this.persistentTiles.forEach(this.clearTile),this.persistentTiles.clear()}clearCompressedCache(e){-1===e?this.cacheMapCompressedTiles.clear():this.cacheMapCompressedTiles.delete(e)}clearRequestQueue(){this.pendingRequests.clear(),this.updateRemainingTileCount()}handleFileClosed(e){this.clearCompressedCache(e),this.channelMap.delete(e);const t=`${e}`;this.completedChannels.forEach(((e,i)=>{i.startsWith(t)&&this.completedChannels.delete(i)})),this.pendingDecompressions.forEach(((e,i)=>{i.startsWith(t)&&this.pendingDecompressions.delete(i)}))}initTextures(){console.log(`Creating ${this.textureArray.length} tile textures of size 64 MB each (${64*this.textureArray.length} MB total)`);for(let e=0;e<this.textureArray.length;e++)this.textureArray[e]=Object(fe.p)(this.gl,ve,ve,WebGLRenderingContext.TEXTURE0)}uploadTileToGPU(e){const t=16777216/(Ae*Ae),i=e.textureCoordinate%t,n=Math.floor((e.textureCoordinate-i)/t),r=ve/Ae,o=i%r*Ae,s=Math.floor(i/r)*Ae;Object(fe.o)(this.gl,this.textureArray[n],e.data,WebGLRenderingContext.TEXTURE0,e.width,e.height,o,s)}getTileTextureParameters(e){const t=16777216/(Ae*Ae),i=e.textureCoordinate%t,n=Math.floor((e.textureCoordinate-i)/t),r=ve/Ae,o=i%r*Ae,s=Math.floor(i/r)*Ae;return{texture:this.textureArray[n],offset:{x:o,y:s}}}asyncDecompressTile(e,t,i,n,r,o){const s=n.imageData,a=this.compressionRequestCounter%this.workers.length,l=new Int32Array(n.nanEncodings.slice(0).buffer);let c=new Uint8Array(n.width*n.height*4);c.set(s);const d=`${e}_${i}_${t}`,u=this.pendingDecompressions.get(d);u?(u.set(o,!0),this.workers[a].postMessage(["decompress",c.buffer,{fileId:e,channel:t,stokes:i,width:n.width,subsetHeight:n.height,subsetLength:s.byteLength,compression:r,nanEncodings:l,tileCoordinate:o,layer:n.layer,requestId:this.compressionRequestCounter}],[c.buffer,l.buffer]),this.compressionRequestCounter++):console.log("Problem decompressing tile!")}updateStream(e,t,i,n,r,o,s,a){var l;const c=`${e}_${i}_${t}`,d=this.pendingDecompressions.get(c);if(d)if(this.animationEnabled||(null===(l=this.pendingSynchronisedTiles)||void 0===l?void 0:l.length)){this.pendingSynchronisedTiles=this.pendingSynchronisedTiles.filter((e=>e!==a));const l={width:r,height:o,textureCoordinate:-1,data:n};if(this.receivedSynchronisedTiles||(this.receivedSynchronisedTiles=[]),this.receivedSynchronisedTiles.push({coordinate:a,tile:l}),d.delete(a),!d.size&&this.completedChannels.get(c)){this.completedChannels.delete(c),this.pendingDecompressions.delete(c);const n=this.receivedSynchronisedTiles.length;this.clearGPUCache(),this.animationEnabled&&this.clearCompressedCache(e),this.resetCoordinateQueue();for(const e of this.receivedSynchronisedTiles)if(e.tile.textureCoordinate=this.textureCoordinateQueue.pop(),s<4)this.persistentTiles.set(e.coordinate,e.tile);else{const t=this.cachedTiles.setpop(e.coordinate,e.tile);t&&this.clearTile(t.value,t.key)}this.receivedSynchronisedTiles=[],this.tileStream.next({tileCount:n,fileId:e,channel:t,stokes:i,flush:!0})}}else{const l={width:r,height:o,textureCoordinate:this.textureCoordinateQueue.pop(),data:n};if(s<4)this.persistentTiles.set(a,l);else{const e=this.cachedTiles.setpop(a,l);e&&this.clearTile(e.value,e.key)}d.delete(a),this.tileStream.next({tileCount:1,fileId:e,channel:t,stokes:i,flush:!1})}else console.log(`Problem decompressing tile. Missing pending decompression map ${c}!`)}},xe.staticInstance=void 0,ye=Ce,Oe=Object(d.a)(ye.prototype,"remainingTiles",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=Object(d.a)(ye.prototype,"workersReady",[f.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(d.a)(ye.prototype,"zfpReady",[f.i],Object.getOwnPropertyDescriptor(ye.prototype,"zfpReady"),ye.prototype),Se=Object(d.a)(ye.prototype,"updateRemainingTileCount",[f.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.remainingTiles=this.pendingRequests.size}}}),ye);var Pe=i(81);class Ee{static get Instance(){return Ee.staticInstance||(Ee.staticInstance=new Ee),Ee.staticInstance}initShaders(){this.gl&&(this.shaderProgram=Object(fe.H)(this.gl,"precision highp float;\n\n//Data from bufferData\nattribute vec3 aVertexPosition;\nattribute vec2 aVertexUV;\nvarying vec2 vUV;\nuniform float uCanvasWidth;\nuniform float uCanvasHeight;\nuniform vec2 uRotationOrigin;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\n// Tiling parameters\nuniform vec2 uTileSize;\nuniform vec2 uTileScaling;\nuniform vec2 uTileOffset;\nuniform float uTileTextureSize;\n\nvec2 rotate2D(vec2 vector, float theta) {\n    float sinTheta = sin(theta);\n    float cosTheta = cos(theta);\n    return mat2(cosTheta, -sinTheta, sinTheta, cosTheta) * vector;\n}\n\nvec2 rotateAboutPoint2D(vec2 vector, vec2 origin, float theta) {\n    return rotate2D(vector - origin, theta) + origin;\n}\n\nvec2 scaleAboutPoint2D(vec2 vector, vec2 origin, float scale) {\n    return (vector - origin) * scale + origin;\n}\n\nvoid main(void) {\n    vec2 tilePosition = rotateAboutPoint2D(aVertexPosition.xy * uTileScaling * uTileSize + uTileOffset, uRotationOrigin, uRotationAngle);\n    // adjust based on pixel scales\n    tilePosition = scaleAboutPoint2D(tilePosition, uRotationOrigin, uScaleAdjustment);\n    // convert XY from canvas space to [-1, 1]\n    vec2 adjustedPosition = vec2(tilePosition.x / uCanvasWidth, tilePosition.y / uCanvasHeight) * 2.0 - 1.0;\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, aVertexPosition.z, 1.0);\n    vUV = aVertexUV * uTileSize / uTileTextureSize;\n}","precision highp float;\n\n#define LINEAR 0\n#define LOG 1\n#define SQRT 2\n#define SQUARE 3\n#define POWER 4\n#define GAMMA 5\n#define EXP 6\n#define CUSTOM 7\n\n#define FLT_MAX 3.402823466e+38\n\nvarying vec2 vUV;\n// Textures\nuniform sampler2D uDataTexture;\nuniform sampler2D uCmapTexture;\n// Render parameters\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform int uScaleType;\nuniform int uInverted;\nuniform float uMinVal;\nuniform float uMaxVal;\nuniform float uBias;\nuniform float uContrast;\nuniform float uGamma;\nuniform float uAlpha;\nuniform vec4 uNaNColor;\n\n// Tile texture parameters in pixels\nuniform float uTileBorder;\nuniform vec2 uTileTextureOffset;\nuniform float uTextureSize;\nuniform float uTileTextureSize;\n\n// Some shader compilers have trouble with NaN checks, so we instead use a dummy value of -FLT_MAX\nbool isnan(float val) {\n    return val <= -FLT_MAX;\n}\n\nvoid main(void) {\n    // Tile border\n    if (uTileBorder > 0.0 && (vUV.x < uTileBorder || vUV.y < uTileBorder)) {\n        gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n        return;\n    }\n    vec2 texCoords;\n\n    // Mimic texel fetch in WebGL1\n    vec2 tileCoordsPixel = vUV * uTileTextureSize;\n    // Prevent edge artefacts\n    vec2 texCoordsPixel = clamp(tileCoordsPixel, 0.5, uTileTextureSize - 0.5) + uTileTextureOffset;\n    texCoords = texCoordsPixel / uTextureSize;\n\n    float range = uMaxVal - uMinVal;\n    float rawVal = texture2D(uDataTexture, texCoords).r;\n\n    // Scaling types\n    // LINEAR (Default: uScaleType == LINEAR)\n    float x = clamp((rawVal - uMinVal) / range, 0.0, 1.0);\n    // Other scaling types\n    if (uScaleType == SQUARE) {\n        x = x * x;\n    }\n    else if (uScaleType == SQRT) {\n        x = sqrt(x);\n    }\n    else if (uScaleType == LOG) {\n        x = clamp(log(uAlpha * x + 1.0) / log(uAlpha), 0.0, 1.0);\n    }\n    else if (uScaleType == POWER) {\n        x = (pow(uAlpha, x) -1.0)/uAlpha;\n    }\n    else if (uScaleType == GAMMA) {\n        x = pow(x, uGamma);\n    }\n\n    // bias mod\n    x = clamp(x - uBias, 0.0, 1.0);\n    // contrast mod\n    x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n    // invert mod\n    if (uInverted > 0) {\n        x = 1.0 - x;\n    }\n\n    float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n    vec2 cmapCoords = vec2(x, cmapYVal);\n    gl_FragColor = isnan(rawVal) ? uNaNColor * uNaNColor.a : texture2D(uCmapTexture, cmapCoords);\n}"),this.gl.useProgram(this.shaderProgram),this.vertexPositionAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexPosition"),this.vertexUVAttribute=this.gl.getAttribLocation(this.shaderProgram,"aVertexUV"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.gl.enableVertexAttribArray(this.vertexUVAttribute),this.shaderUniforms={MinVal:this.gl.getUniformLocation(this.shaderProgram,"uMinVal"),MaxVal:this.gl.getUniformLocation(this.shaderProgram,"uMaxVal"),NaNColor:this.gl.getUniformLocation(this.shaderProgram,"uNaNColor"),Bias:this.gl.getUniformLocation(this.shaderProgram,"uBias"),Contrast:this.gl.getUniformLocation(this.shaderProgram,"uContrast"),Gamma:this.gl.getUniformLocation(this.shaderProgram,"uGamma"),Alpha:this.gl.getUniformLocation(this.shaderProgram,"uAlpha"),ScaleType:this.gl.getUniformLocation(this.shaderProgram,"uScaleType"),Inverted:this.gl.getUniformLocation(this.shaderProgram,"uInverted"),DataTexture:this.gl.getUniformLocation(this.shaderProgram,"uDataTexture"),CmapTexture:this.gl.getUniformLocation(this.shaderProgram,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(this.shaderProgram,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(this.shaderProgram,"uCmapIndex"),CanvasWidth:this.gl.getUniformLocation(this.shaderProgram,"uCanvasWidth"),CanvasHeight:this.gl.getUniformLocation(this.shaderProgram,"uCanvasHeight"),ScaleAdjustment:this.gl.getUniformLocation(this.shaderProgram,"uScaleAdjustment"),RotationOrigin:this.gl.getUniformLocation(this.shaderProgram,"uRotationOrigin"),RotationAngle:this.gl.getUniformLocation(this.shaderProgram,"uRotationAngle"),TileSize:this.gl.getUniformLocation(this.shaderProgram,"uTileSize"),TileScaling:this.gl.getUniformLocation(this.shaderProgram,"uTileScaling"),TileOffset:this.gl.getUniformLocation(this.shaderProgram,"uTileOffset"),TileTextureOffset:this.gl.getUniformLocation(this.shaderProgram,"uTileTextureOffset"),TextureSize:this.gl.getUniformLocation(this.shaderProgram,"uTextureSize"),TileTextureSize:this.gl.getUniformLocation(this.shaderProgram,"uTileTextureSize"),TileBorder:this.gl.getUniformLocation(this.shaderProgram,"uTileBorder")},this.gl.uniform1i(this.shaderUniforms.DataTexture,0),this.gl.uniform1i(this.shaderUniforms.CmapTexture,1),this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapIndex,2),this.gl.uniform1f(this.shaderUniforms.MinVal,3.4),this.gl.uniform1f(this.shaderUniforms.MaxVal,5.5),this.gl.uniform1f(this.shaderUniforms.Bias,0),this.gl.uniform1f(this.shaderUniforms.Contrast,1),this.gl.uniform1f(this.shaderUniforms.Gamma,1),this.gl.uniform1f(this.shaderUniforms.Alpha,1e3),this.gl.uniform1i(this.shaderUniforms.Inverted,0),this.gl.uniform1f(this.shaderUniforms.TileBorder,0/Ae),this.gl.uniform2f(this.shaderUniforms.TileSize,1,1),this.gl.uniform2f(this.shaderUniforms.TileScaling,1,1),this.gl.uniform2f(this.shaderUniforms.TileOffset,0,0),this.gl.uniform2f(this.shaderUniforms.TileTextureOffset,0,0),this.gl.uniform1f(this.shaderUniforms.TextureSize,ve),this.gl.uniform1f(this.shaderUniforms.TileTextureSize,Ae),this.gl.uniform4f(this.shaderUniforms.NaNColor,0,0,1,1))}initBuffers(){if(!this.gl)return;this.vertexPositionBuffer=this.gl.createBuffer(),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexPositionBuffer);const e=new Float32Array([0,0,0,1,0,0,0,1,0,1,1,0]);this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,e,WebGLRenderingContext.STATIC_DRAW),this.vertexUVBuffer=this.gl.createBuffer(),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexUVBuffer);const t=new Float32Array([0,0,1,0,0,1,1,1]);this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,t,WebGLRenderingContext.STATIC_DRAW)}constructor(){this.gl=void 0,this.cmapTexture=void 0,this.vertexPositionBuffer=void 0,this.vertexUVBuffer=void 0,this.vertexPositionAttribute=void 0,this.vertexUVAttribute=void 0,this.shaderProgram=void 0,this.shaderUniforms=void 0,this.setCanvasSize=(e,t)=>{this.gl&&(this.gl.canvas.width=e,this.gl.canvas.height=t)},this.gl=Object(fe.M)(),this.gl&&(this.initShaders(),this.initBuffers(),Object(fe.Q)(this.gl,Pe.a,WebGLRenderingContext.TEXTURE1).then((e=>{this.cmapTexture=e})))}}Ee.staticInstance=void 0;class Fe{static get Instance(){return Fe.staticInstance||(Fe.staticInstance=new Fe),Fe.staticInstance}initShaders(){if(!this.gl)return;let e=Object(fe.G)(this.gl,"precision highp float;\n\n//Data from buffers\nattribute vec3 aVertexPosition;\nattribute vec2 aVertexNormal;\n\nuniform vec2 uRangeScale;\nuniform vec2 uRangeOffset;\nuniform vec2 uRotationOrigin;\nuniform float uRotationAngle;\nuniform float uScaleAdjustment;\nuniform float uLineThickness;\n\n// Control-map based transformation\nuniform int uControlMapEnabled;\nuniform vec2 uControlMapMin;\nuniform vec2 uControlMapMax;\nuniform vec2 uControlMapSize;\nuniform highp sampler2D uControlMapTexture;\n\nvarying float vLinePosition;\nvarying float vLineSide;\n\nvec2 rotate2D(vec2 vector, float theta) {\n    float sinTheta = sin(theta);\n    float cosTheta = cos(theta);\n    return mat2(cosTheta, -sinTheta, sinTheta, cosTheta) * vector;\n}\n\nvec2 scaleAndRotate2D(vec2 vector, float theta, float scale) {\n    return rotate2D(vector, theta) * scale;\n}\n\n// Adapted from https://www.shadertoy.com/view/MllSzX to work with non-square vec4 textures of variable size\n\nvec4 cubic(vec4 A, vec4 B, vec4 C, vec4 D, float t) {\n    float t2 = t * t;\n    float t3 = t * t * t;\n    vec4 a = -A / 2.0 + (3.0 * B) / 2.0 - (3.0 * C) / 2.0 + D / 2.0;\n    vec4 b = A - (5.0 * B) / 2.0 + 2.0 * C - D / 2.0;\n    vec4 c = -A / 2.0 + C / 2.0;\n    vec4 d = B;\n\n    return a * t3 + b * t2 + c * t + d;\n}\n\nvec4 bicubicFilter(sampler2D texture, vec2 P) {\n    // Calculate offset and base pixel coordiante\n    vec2 pixelSize = 1.0 / uControlMapSize;\n    vec2 pixel = P * uControlMapSize + 0.5;\n    vec2 frac = fract(pixel);\n    pixel = floor(pixel) / uControlMapSize - pixelSize / 2.0;\n\n    // Texture lookups\n    vec4 C00 = texture2D(texture, pixel + pixelSize * vec2(-1.0, -1.0));\n    vec4 C10 = texture2D(texture, pixel + pixelSize * vec2(0.0, -1.0));\n    vec4 C20 = texture2D(texture, pixel + pixelSize * vec2(1.0, -1.0));\n    vec4 C30 = texture2D(texture, pixel + pixelSize * vec2(2.0, -1.0));\n\n    vec4 C01 = texture2D(texture, pixel + pixelSize * vec2(-1.0, 0.0));\n    vec4 C11 = texture2D(texture, pixel + pixelSize * vec2(0.0, 0.0));\n    vec4 C21 = texture2D(texture, pixel + pixelSize * vec2(1.0, 0.0));\n    vec4 C31 = texture2D(texture, pixel + pixelSize * vec2(2.0, 0.0));\n\n    vec4 C02 = texture2D(texture, pixel + pixelSize * vec2(-1.0, 1.0));\n    vec4 C12 = texture2D(texture, pixel + pixelSize * vec2(0.0, 1.0));\n    vec4 C22 = texture2D(texture, pixel + pixelSize * vec2(1.0, 1.0));\n    vec4 C32 = texture2D(texture, pixel + pixelSize * vec2(2.0, 1.0));\n\n    vec4 C03 = texture2D(texture, pixel + pixelSize * vec2(-1.0, 2.0));\n    vec4 C13 = texture2D(texture, pixel + pixelSize * vec2(0.0, 2.0));\n    vec4 C23 = texture2D(texture, pixel + pixelSize * vec2(1.0, 2.0));\n    vec4 C33 = texture2D(texture, pixel + pixelSize * vec2(2.0, 2.0));\n\n    // Cubic along x\n    vec4 CP0X = cubic(C00, C10, C20, C30, frac.x);\n    vec4 CP1X = cubic(C01, C11, C21, C31, frac.x);\n    vec4 CP2X = cubic(C02, C12, C22, C32, frac.x);\n    vec4 CP3X = cubic(C03, C13, C23, C33, frac.x);\n\n    // Final cubic along y\n    return cubic(CP0X, CP1X, CP2X, CP3X, frac.y);\n}\n\n// end adapted from https://www.shadertoy.com/view/MllSzX\n\nvec2 controlMapLookup(vec2 pos) {\n    vec2 texScale = 1.0 / uControlMapSize;\n    vec2 range = uControlMapMax - uControlMapMin;\n    vec2 shiftedPoint = pos - uControlMapMin;\n    vec2 index = shiftedPoint / range + 0.5 / uControlMapSize;\n    return bicubicFilter(uControlMapTexture, index).ra;\n}\n\nvoid main(void) {\n\n    // Shift by half a pixel to account for position of pixel center\n    vec2 posImageSpace = aVertexPosition.xy - 0.5;\n\n    // Calculate extrusion vector and distance\n    vec2 extrudeOffet = (aVertexNormal / 16384.0) * uLineThickness * 0.5;\n    float extrudeDistance = length(extrudeOffet);\n\n    // If there's a control map, use it to look up location using bilinear filtering\n    if (uControlMapEnabled > 0) {\n        // Use an offset of 10% of the grid spacing to estimate the direction of the normal\n        vec2 deltaVec = 0.1 * (uControlMapMax - uControlMapMin) / uControlMapSize;\n        // Use a minimum of 10% in X and 10% in Y directions\n        float delta = min(deltaVec.x, deltaVec.y);\n        vec2 extrudedPoint = controlMapLookup(posImageSpace + normalize(extrudeOffet) * delta);\n        posImageSpace = controlMapLookup(posImageSpace);\n        vec2 transformedNormal = extrudedPoint - posImageSpace;\n        // Ensure consistent extrusion distance\n        posImageSpace += extrudeDistance * normalize(transformedNormal);\n    } else {\n        // Extrude point along normal\n        posImageSpace += extrudeOffet;\n    }\n\n    // Scale and rotate\n    vec2 posRefSpace = scaleAndRotate2D(posImageSpace, uRotationAngle, uScaleAdjustment);\n    // Convert from image space to GL space [-1, 1]\n    vec2 adjustedPosition = (posRefSpace * uRangeScale + uRangeOffset) * 2.0 - 1.0;\n\n    vLineSide = sign(aVertexPosition.z);\n    vLinePosition = abs(aVertexPosition.z);\n    gl_Position = vec4(adjustedPosition.x, adjustedPosition.y, 0.0, 1.0);\n}",WebGLRenderingContext.VERTEX_SHADER),t=Object(fe.G)(this.gl,"precision highp float;\n\nvarying float vLinePosition;\nvarying float vLineSide;\n\nuniform float uDashLength;\nuniform vec4 uLineColor;\nuniform int uCmapEnabled;\n\nuniform sampler2D uCmapTexture;\nuniform float uCmapValue;\nuniform int uNumCmaps;\nuniform int uCmapIndex;\nuniform float uBias;\nuniform float uContrast;\n\nvoid main(void) {\n    float dashStrength;\n    // Modulate dash strength based on dash length and line position\n    if (uDashLength > 1e-3) {\n        float dashRepeatLength = 2.0 * uDashLength;\n        dashStrength = mod(vLinePosition, dashRepeatLength) / dashRepeatLength <= 0.75 ? 1.0: 0.0;\n        if (dashStrength == 0.0) {\n            discard;\n        }\n    }\n    else {\n        dashStrength = 1.0;\n    }\n\n    vec4 color;\n    if (uCmapEnabled > 0) {\n        // bias mod\n        float x = clamp(uCmapValue - uBias, 0.0, 1.0);\n        // contrast mod\n        x = clamp((x - 0.5) * uContrast + 0.5, 0.0, 1.0);\n        float cmapYVal = (float(uCmapIndex) + 0.5) / float(uNumCmaps);\n        vec2 cmapCoords = vec2(x, cmapYVal);\n        color = texture2D(uCmapTexture, cmapCoords);\n    } else {\n        color = uLineColor;\n    }\n\n    gl_FragColor = dashStrength * color;\n}",WebGLRenderingContext.FRAGMENT_SHADER),i=this.gl.createProgram();this.gl.attachShader(i,e),this.gl.attachShader(i,t),this.gl.linkProgram(i),this.gl.getProgramParameter(i,WebGLRenderingContext.LINK_STATUS)||console.log("Could not initialise shaders"),this.gl.useProgram(i),this.vertexPositionAttribute=this.gl.getAttribLocation(i,"aVertexPosition"),this.gl.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexNormalAttribute=this.gl.getAttribLocation(i,"aVertexNormal"),this.gl.enableVertexAttribArray(this.vertexNormalAttribute),this.shaderUniforms={RangeScale:this.gl.getUniformLocation(i,"uRangeScale"),RangeOffset:this.gl.getUniformLocation(i,"uRangeOffset"),ScaleAdjustment:this.gl.getUniformLocation(i,"uScaleAdjustment"),RotationOrigin:this.gl.getUniformLocation(i,"uRotationOrigin"),RotationAngle:this.gl.getUniformLocation(i,"uRotationAngle"),DashLength:this.gl.getUniformLocation(i,"uDashLength"),LineColor:this.gl.getUniformLocation(i,"uLineColor"),LineThickness:this.gl.getUniformLocation(i,"uLineThickness"),CmapEnabled:this.gl.getUniformLocation(i,"uCmapEnabled"),CmapValue:this.gl.getUniformLocation(i,"uCmapValue"),CmapTexture:this.gl.getUniformLocation(i,"uCmapTexture"),NumCmaps:this.gl.getUniformLocation(i,"uNumCmaps"),CmapIndex:this.gl.getUniformLocation(i,"uCmapIndex"),Contrast:this.gl.getUniformLocation(i,"uContrast"),Bias:this.gl.getUniformLocation(i,"uBias"),ControlMapEnabled:this.gl.getUniformLocation(i,"uControlMapEnabled"),ControlMapSize:this.gl.getUniformLocation(i,"uControlMapSize"),ControlMapMin:this.gl.getUniformLocation(i,"uControlMapMin"),ControlMapMax:this.gl.getUniformLocation(i,"uControlMapMax"),ControlMapTexture:this.gl.getUniformLocation(i,"uControlMapTexture")},this.gl.uniform1i(this.shaderUniforms.NumCmaps,79),this.gl.uniform1i(this.shaderUniforms.CmapTexture,0)}constructor(){this.cmapTexture=void 0,this.gl=void 0,this.shaderUniforms=void 0,this.vertexPositionAttribute=void 0,this.vertexNormalAttribute=void 0,this.setCanvasSize=(e,t)=>{this.gl&&(this.gl.canvas.width=e,this.gl.canvas.height=t,this.gl.viewport(0,0,e,t))},this.gl=Object(fe.M)(),this.gl&&(this.initShaders(),Object(fe.Q)(this.gl,Pe.a,WebGLRenderingContext.TEXTURE0).then((e=>{this.cmapTexture=e})))}}Fe.staticInstance=void 0;class Me{constructor(){this.target=void 0,this.action=void 0,this.parameters=void 0,this.valid=void 0,this.async=void 0,this.mapMacro=e=>{if("object"===typeof e&&e.macroVariable){const t=e.macroTarget?`${e.macroTarget}.${e.macroVariable}`:e.macroVariable;return Me.GetTargetObject(ge.e.Instance,t)}return e}}static FromString(e){const t=new Me;e=e.trim();const i=/^(\+?)((?:[\w[\]]+\.)*)(\w+)\(([^)]*)\);?$/gm.exec(e);return i&&5===i.length&&i[3].length?(t.async=i[1].length>0,i[2].length&&(t.target=i[2].substring(0,i[2].length-1)),t.action=i[3],t.valid=t.parseParameters(i[4],!0)):t.valid=!1,t}static FromScriptingRequest(e){const t=new Me;return t.async=e.async,t.target=e.target,t.action=e.action,t.valid=t.parseParameters(e.parameters,!1),t}parseParameters(e,t){if(!e)return this.parameters=[],!0;try{let i=e.replace(/\$((?:[\w[\]]+\.)*)([\w[\]]+)/gm,((e,t,i)=>`{"macroTarget": "${t.slice(0,-1)}", "macroVariable": "${i}"}`));t&&(i=`[${i}]`),this.parameters=JSON.parse(i)}catch(i){return console.log(i),!1}return!0}async execute(){const e=Me.GetTargetObject(ge.e.Instance,this.target);if(null==e)throw new Error(`Missing target object: ${this.target}`);const t=this.parameters.map(this.mapMacro);let i,n=e[this.action];if(!n||"function"!==typeof n)throw new Error(`Missing action function: ${this.action}`);return n=n.bind(e),i=this.async?n(...t):await n(...t),i}static GetTargetObject(e,t){if(!t)return e;let i=e;const n=t.split(".");console.log(n);for(const r of n){const e=/(\w+)(?:\[(\d+)])?/gm.exec(r);if(e&&3===e.length&&void 0!==e[2]){if(console.log(i),console.log(e),i=i[e[1]],null==i)return null;if(i instanceof Map){const t=JSON.parse(e[2]);i=i.get(t)}else{if(!Array.isArray(i))return null;i=i[e[2]]}}else i=i[r];if(null==i)return null}return i}}class ke{constructor(){this.handleScriptingRequest=async e=>{const t=Me.FromScriptingRequest(e);if(!t.valid)return{scriptingRequestId:e.scriptingRequestId,success:!1,message:"Failed to parse scripting request"};try{let i;return i=t.async?t.execute():await t.execute(),{scriptingRequestId:e.scriptingRequestId,success:!0,response:JSON.stringify(i)}}catch(i){return{scriptingRequestId:e.scriptingRequestId,success:!1,message:i}}},this.executeEntries=async e=>{if(e&&e.length)for(const i of e)try{if(i.async){const e=i.execute();console.log(e)}else{const e=await i.execute();console.log(e),await ke.Delay(10)}}catch(t){console.log(t)}}}static get Instance(){return ke.staticInstance||(ke.staticInstance=new ke),ke.staticInstance}static Delay(e){return new Promise((t=>{setTimeout(t,e)}))}}ke.staticInstance=void 0},270:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.LIGHT="light",n.DARK="dark",n.AUTO="auto",n.isValid=e=>e&&(e===n.LIGHT||e===n.DARK||e===n.AUTO)},271:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.DEFAULT="Default",n.CUBEVIEW="Cube View",n.CUBEANALYSIS="Cube Analysis",n.CONTINUUMANALYSIS="Continuum Analysis",n.PRESETS=[n.DEFAULT,n.CUBEVIEW,n.CUBEANALYSIS,n.CONTINUUMANALYSIS],n.PRESET_CONFIGS=new Map([[n.DEFAULT,{leftBottomContent:{type:"stack",content:[{type:"component",id:"render-config"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"stack",content:[{type:"component",id:"layer-list"},{type:"component",id:"animator"},{type:"component",id:"region-list"}]}]}],[n.CUBEVIEW,{leftBottomContent:{type:"stack",content:[{type:"component",id:"animator"},{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"component",id:"spectral-profiler"}]}],[n.CUBEANALYSIS,{leftBottomContent:{type:"stack",content:[{type:"component",id:"animator"},{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spectral-profiler"},{type:"component",id:"stats"}]}],[n.CONTINUUMANALYSIS,{leftBottomContent:{type:"stack",content:[{type:"component",id:"render-config"},{type:"component",id:"region-list"},{type:"component",id:"animator"},{type:"component",id:"layer-list"}]},rightColumnContent:[{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"x"}},{type:"component",id:"spatial-profiler",widgetSettings:{coordinate:"y"}},{type:"component",id:"stats"}]}]]),n.isPreset=e=>e&&n.PRESETS.includes(e)},272:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.FIXED="fixed",n.TRACKING="tracking",n.isValid=e=>e&&(e===n.FIXED||e===n.TRACKING)},273:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.FIT="fit",n.FULL="full",n.isValid=e=>e&&(e===n.FIT||e===n.FULL)},274:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.CURSOR="cursor",n.CENTER="center",n.isValid=e=>e&&(e===n.CURSOR||e===n.CENTER)},275:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.AUTOMATIC="automatic",n.DEGREES="degrees",n.SEXAGESIMAL="sexagesimal",n.isValid=e=>e&&(e===n.AUTOMATIC||e===n.DEGREES||e===n.SEXAGESIMAL)},276:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.CENTER="center",n.CORNER="corner",n.isValid=e=>e&&(e===n.CENTER||e===n.CORNER)},277:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.IMAGE_MIN=1,n.IMAGE_MAX=32,n.IMAGE_STEP=1,n.IMAGE_DEFAULT=11,n.ANIMATION_MIN=1,n.ANIMATION_MAX=32,n.ANIMATION_STEP=1,n.ANIMATION_DEFAULT=9,n.isImageCompressionQualityValid=e=>isFinite(e)&&e>=n.IMAGE_MIN&&e<=n.IMAGE_MAX,n.isAnimationCompressionQualityValid=e=>isFinite(e)&&e>=n.ANIMATION_MIN&&e<=n.ANIMATION_MAX},278:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));class n{}n.GPU_MIN=512,n.GPU_MAX=8192,n.GPU_STEP=128,n.GPU_DEFAULT=512,n.SYSTEM_MIN=1024,n.SYSTEM_MAX=16384,n.SYSTEM_STEP=256,n.SYSTEM_DEFAULT=4096,n.isGPUTileCacheValid=e=>isFinite(e)&&e>=n.GPU_MIN&&e<=n.GPU_MAX,n.isSystemTileCacheValid=e=>isFinite(e)&&e>=n.SYSTEM_MIN&&e<=n.SYSTEM_MAX},279:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(6),r=i(124);class o{static ProcessSpatialProfile(e){return e.rawValuesFp32&&e.rawValuesFp32.length&&e.rawValuesFp32.length%4===0?{coordinate:e.coordinate,start:e.start,end:e.end,values:new Float32Array(e.rawValuesFp32.slice().buffer)}:{coordinate:e.coordinate,start:e.start,end:e.end,values:null}}static ProcessSpectralProfile(e,t){return e.rawValuesFp64&&e.rawValuesFp64.length&&e.rawValuesFp64.length%8===0?{coordinate:e.coordinate,statsType:e.statsType,values:new Float64Array(e.rawValuesFp64.slice().buffer),progress:t}:e.rawValuesFp32&&e.rawValuesFp32.length&&e.rawValuesFp32.length%4===0?{coordinate:e.coordinate,statsType:e.statsType,values:new Float32Array(e.rawValuesFp32.slice().buffer),progress:t}:{coordinate:e.coordinate,statsType:e.statsType,values:null,progress:0}}static ProcessContourSet(e){let t;if(e.decimationFactor>=1)t=r.Decode(e.rawCoordinates,e.uncompressedCoordinatesSize,e.decimationFactor);else{const i=e.rawCoordinates.slice();t=new Float32Array(i.buffer)}const i=new Int32Array(e.rawStartIndices.buffer.slice(e.rawStartIndices.byteOffset,e.rawStartIndices.byteOffset+e.rawStartIndices.byteLength));return{level:e.level,indexOffsets:i,coordinates:t}}static ProcessContourData(e){return{fileId:e.fileId,channel:e.channel,stokes:e.stokes,imageBounds:e.imageBounds,progress:e.progress,contourSets:e.contourSets?e.contourSets.map((e=>this.ProcessContourSet(e))):null}}static GetProcessedData(e){let t;switch(e.dataType){case n.a.ColumnType.Uint8:t=new Uint8Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Int8:t=new Int8Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Uint16:t=new Uint16Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Int16:t=new Int16Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Uint32:t=new Uint32Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Int32:t=new Int32Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Float:t=new Float32Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Double:t=new Float64Array(e.binaryData.slice().buffer);break;case n.a.ColumnType.Bool:const i=new Uint8Array(e.binaryData.slice().buffer),r=new Array(i.length);for(let e=r.length-1;e>=0;e--)r[e]=0!==i[e];return{dataType:e.dataType,data:r};case n.a.ColumnType.String:return{dataType:e.dataType,data:e.stringData};default:return{dataType:n.a.ColumnType.UnsupportedType,data:[]}}const i=t.length;let r=new Array(i);for(let n=i-1;n>=0;n--)r[n]=t[n];return{dataType:e.dataType,data:r}}static ProcessCatalogData(e){const t=new Map;return new Map(Object.entries(e)).forEach(((e,i)=>{t.set(parseInt(i),o.GetProcessedData(e))})),t}}},280:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(6);class r{}r.EVENT_TYPES=Object.values(n.a.EventType),r.EVENT_NUMBER=r.EVENT_TYPES.length,r.isEventTypeValid=e=>r.EVENT_TYPES.includes(e),r.getEventTypeFromName=e=>n.a.EventType[e],r.getEventNameFromType=e=>n.a.EventType[e]},281:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(89),r=i.n(n);const{version:o}=i(482),s={acronym:"CARTA",version:o,date:r()("2021-03-05T14:09:18.297Z").format("D MMM YYYY"),fullName:"Cube Analysis and Rendering Tool for Astronomy"}},282:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(172),r=i.n(n),o=i(5),s=i(11),a=i(7),l=i(13);const c=i(524),d=new Map([["image-view",{type:"react-component",component:"image-view",title:"No image loaded",height:Object(a.jb)(window.innerHeight,720,1080,65,75),id:"image-view",isClosable:!1}],["render-config",{type:"react-component",component:"render-config",title:"Render Configuration",id:"render-config"}],["region-list",{type:"react-component",component:"region-list",title:"Region List",id:"region-list"}],["animator",{type:"react-component",component:"animator",title:"Animator",id:"animator"}],["spatial-profiler",{type:"react-component",component:"spatial-profiler",id:"spatial-profiler"}],["spectral-profiler",{type:"react-component",component:"spectral-profiler",id:"spectral-profiler",title:"Z Profile: Cursor"}],["stokes",{type:"react-component",component:"stokes",id:"stokes",title:"Stokes Analysis"}],["histogram",{type:"react-component",component:"histogram",title:"Histogram",id:"histogram"}],["stats",{type:"react-component",component:"stats",title:"Statistics",id:"stats"}],["layer-list",{type:"react-component",component:"layer-list",title:"Image List",id:"layer-list"}],["log",{type:"react-component",component:"log",title:"Log",id:"log"}],["catalog-overlay",{type:"react-component",component:"catalog-overlay",title:"Catalog Overlay",id:"catalog-overlay"}],["catalog-plot",{type:"react-component",component:"catalog-plot",title:"Catalog Plot",id:"catalog-plot"}],["spectral-line-query",{type:"react-component",component:"spectral-line-query",title:"Spectral Line Query",id:"spectral-line-query"}]]);class u{}u.LayoutValidator=new r.a({useDefaults:"empty",strictTypes:!1}).compile(c),u.CurrentSchemaVersion=2,u.GetPresetConfig=e=>{if(!e)return null;const t=s.PresetLayout.PRESET_CONFIGS.get(e);return t?{layoutVersion:u.CurrentSchemaVersion,docked:{type:"row",content:[{type:"column",width:60,content:[{type:"component",id:"image-view"},t.leftBottomContent]},{type:"column",content:t.rightColumnContent}]},floating:[]}:null},u.UpgradeLayout=e=>{if(1===e.layoutVersion){const t=Object(a.t)(e,(e=>"spatial-profiler"===e.id));for(const e of t)e.coord&&(e.widgetSettings||(e.widgetSettings={}),e.widgetSettings.coordinate=e.coord,delete e.coord);e.layoutVersion=2}if(e.floating&&Array.isArray(e.floating))for(const t of e.floating)"component"!==t.type&&(t.id=t.type,t.type="component")},u.IsUserLayoutValid=(e,t)=>{if(!e||!t)return!1;if(s.PresetLayout.isPreset(e))return!1;return!!u.LayoutValidator(t)||(console.log(u.LayoutValidator.errors),!1)},u.CreateConfigToSave=(e,t)=>{if(!e||!t||!("type"in t)||!("content"in t))return null;let i={layoutVersion:u.CurrentSchemaVersion,docked:{type:t.type,content:[]},floating:[]};return u.GenSimpleConfigToSave(e,i.docked.content,t.content),e.widgetsStore.floatingWidgets.forEach((t=>{let n,r={type:"component",id:t.type,defaultWidth:t.defaultWidth?t.defaultWidth:"",defaultHeight:t.defaultHeight?t.defaultHeight:"",defaultX:t.defaultX?t.defaultX:"",defaultY:t.defaultY?t.defaultY:""};if(t.type===l.b.WIDGET_CONFIG.type){const i=o.k.Instance.catalogProfiles.get(t.id),r=o.k.Instance.catalogWidgets.get(i);n=e.widgetsStore.toWidgetSettingsConfig(t.type,r)}else n=e.widgetsStore.toWidgetSettingsConfig(t.type,t.id);n&&(r.widgetSettings=n);const s=e.widgetsStore.catalogPlotWidgets.get(t.id);s&&(r.plotType=s.plotType),i.floating.push(r)})),i},u.GenSimpleConfigToSave=(e,t,i)=>{e&&t&&Array.isArray(t)&&i&&Array.isArray(i)&&i.forEach((i=>{if(i.type)if("stack"===i.type||"row"===i.type||"column"===i.type){var n;let r={type:i.type,content:[]};"stack"===i.type&&i.activeItemIndex>=0&&i.activeItemIndex<(null===(n=i.content)||void 0===n?void 0:n.length)&&(r.activeItemIndex=i.activeItemIndex),i.width&&(r.width=i.width),i.height&&(r.height=i.height),t.push(r),i.content&&u.GenSimpleConfigToSave(e,r.content,i.content)}else if("component"===i.type&&i.id){const n=i.id.replace(/(-component)?-\d+$/,"");let r,s={type:i.type,id:n};if(i.width&&(s.width=i.width),i.height&&(s.height=i.height),n===l.b.WIDGET_CONFIG.type){const t=o.k.Instance.catalogProfiles.get(i.id),s=o.k.Instance.catalogWidgets.get(t);r=e.widgetsStore.toWidgetSettingsConfig(n,s)}else r=e.widgetsStore.toWidgetSettingsConfig(n,i.id);r&&(s.widgetSettings=r);const a=e.widgetsStore.catalogPlotWidgets.get(i.id);a&&(s.plotType=a.plotType),t.push(s)}}))},u.CreateConfigToApply=(e,t,i)=>{e&&Array.isArray(e)&&t&&Array.isArray(t)&&t.forEach((t=>{if(t.type)if("stack"===t.type||"row"===t.type||"column"===t.type){var n;let r={type:t.type,content:[]};"stack"===t.type&&t.activeItemIndex>=0&&t.activeItemIndex<(null===(n=t.content)||void 0===n?void 0:n.length)&&(r.activeItemIndex=t.activeItemIndex),t.width&&(r.width=t.width),t.height&&(r.height=t.height),e.push(r),t.content&&u.CreateConfigToApply(r.content,t.content,i)}else if("component"===t.type&&t.id){const n=t.id.replace(/-\d+$/,"");if(d.has(n)){let r=Object.assign({},d.get(n));t.width&&(r.width=t.width),t.height&&(r.height=t.height),"widgetSettings"in t&&(r.widgetSettings=t.widgetSettings),"plotType"in t&&(r.plotType=t.plotType),r.props={appStore:o.e.Instance,id:"",docked:!0},i.push(r),e.push(r)}}}))}},289:function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(20),r=i(7);class o{constructor(e,t,i,o,s){this.source=void 0,this.destination=void 0,this.width=void 0,this.height=void 0,this.minPoint=void 0,this.maxPoint=void 0,this.grid=void 0,this.texture=void 0,this.gl=void 0,this.getTextureX=e=>(e===this.gl&&this.texture||(this.gl=e,this.texture=this.gl.createTexture(),this.gl.activeTexture(r.a.TEXTURE1),this.gl.bindTexture(r.a.TEXTURE_2D,this.texture),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_MIN_FILTER,r.a.NEAREST),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_MAG_FILTER,r.a.NEAREST),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_WRAP_S,r.a.CLAMP_TO_EDGE),this.gl.texParameteri(r.a.TEXTURE_2D,r.a.TEXTURE_WRAP_T,r.a.CLAMP_TO_EDGE),this.gl.texImage2D(r.a.TEXTURE_2D,0,r.a.LUMINANCE_ALPHA,this.width,this.height,0,r.a.LUMINANCE_ALPHA,r.a.FLOAT,this.grid)),this.texture),this.hasTextureForContext=e=>e===this.gl&&this.texture&&e.isTexture(this.texture),this.source=e,this.destination=t,this.width=o,this.height=s;let a=!1;if(i<0){const r=n.copy(e.wcsInfo),o=n.copy(t.wcsInfo);n.invert(r),n.invert(o),i=n.convert(r,o,""),n.delete(r),n.delete(o),a=!0}const l=Math.ceil(e.frameInfo.fileInfoExtended.width/o),c=Math.ceil(e.frameInfo.fileInfoExtended.height/s);this.minPoint={x:-l,y:-c},this.maxPoint={x:l+e.frameInfo.fileInfoExtended.width,y:c+e.frameInfo.fileInfoExtended.height},this.grid=n.getTransformGrid(i,this.minPoint.x,this.maxPoint.x,o,this.minPoint.y,this.maxPoint.y,s,1),a&&n.delete(i)}getTransformedCoordinate(e){const t=Object(r.kb)(this.maxPoint,this.minPoint),i=Object(r.kb)(e,this.minPoint),n={x:this.width*i.x/t.x,y:this.height*i.y/t.y},o=Math.floor(n.x),s=Math.floor(n.y),a=n.x-o,l=n.y-s,c=s*this.width+o,d=(s+1)*this.width+o,u=s*this.width+o+1,h=(s+1)*this.width+o+1,p=this.grid[2*c],g=this.grid[2*c+1],f=this.grid[2*d],b=this.grid[2*d+1],m=this.grid[2*u],y=this.grid[2*u+1];return{x:p*(1-a)*(1-l)+m*a*(1-l)+f*(1-a)*l+this.grid[2*h]*a*l,y:g*(1-a)*(1-l)+y*a*(1-l)+b*(1-a)*l+this.grid[2*h+1]*a*l}}static IsWidthValid(e){return e>=128&&e<=1024}}},342:function(e,t,i){"use strict";let n;i.d(t,"a",(function(){return n})),function(e){e[e.NONE=0]="NONE",e[e.SPATIAL=1]="SPATIAL",e[e.SPECTRAL=2]="SPECTRAL"}(n||(n={}))},343:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(6);const r=new Map([[n.a.Moment.MEAN_OF_THE_SPECTRUM,{tag:"-1",text:"Mean value of the spectrum"}],[n.a.Moment.INTEGRATED_OF_THE_SPECTRUM,{tag:"0",text:"Integrated value of the spectrum"}],[n.a.Moment.INTENSITY_WEIGHTED_COORD,{tag:"1",text:"Intensity weighted coordinate"}],[n.a.Moment.INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD,{tag:"2",text:"Intensity weighted dispersion of the coordinate"}],[n.a.Moment.MEDIAN_OF_THE_SPECTRUM,{tag:"3",text:"Median value of the spectrum"}],[n.a.Moment.MEDIAN_COORDINATE,{tag:"4",text:"Median coordinate"}],[n.a.Moment.STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM,{tag:"5",text:"Standard deviation about the mean of the spectrum"}],[n.a.Moment.RMS_OF_THE_SPECTRUM,{tag:"6",text:"Root mean square of the spectrum"}],[n.a.Moment.ABS_MEAN_DEVIATION_OF_THE_SPECTRUM,{tag:"7",text:"Absolute mean deviation of the spectrum"}],[n.a.Moment.MAX_OF_THE_SPECTRUM,{tag:"8",text:"Maximum value of the spectrum"}],[n.a.Moment.COORD_OF_THE_MAX_OF_THE_SPECTRUM,{tag:"9",text:"Coordinate of the maximum value of the spectrum"}],[n.a.Moment.MIN_OF_THE_SPECTRUM,{tag:"10",text:"Minimum value of the spectrum"}],[n.a.Moment.COORD_OF_THE_MIN_OF_THE_SPECTRUM,{tag:"11",text:"Coordinate of the minimum value of the spectrum"}]])},482:function(e){e.exports=JSON.parse('{"name":"carta-frontend","version":"2.0.0-dev.21.03.05b","repository":"https://github.com/CARTAvis/carta-frontend","description":"The browser-based frontend component of CARTA, a radio-astronomy visualization tool designed for the ALMA, the VLA and the SKA pathfinders.","homepage":"./","devDependencies":{"@blueprintjs/core":"^3.38.2","@blueprintjs/icons":"^3.24.0","@blueprintjs/select":"^3.15.4","@blueprintjs/table":"3.7.1","@testing-library/jest-dom":"^5.11.9","@testing-library/react":"^11.2.5","@testing-library/user-event":"^12.7.1","@types/chart.js":"^2.9.30","@types/gapi":"0.0.39","@types/gapi.auth2":"0.0.52","@types/jest":"^26.0.20","@types/jquery":"^3.5.5","@types/lodash":"^4.14.168","@types/node":"^12.20.1","@types/plotly.js":"^1.54.8","@types/react":"^17.0.2","@types/react-color":"^3.0.1","@types/react-dom":"^17.0.1","@types/react-plotly.js":"^2.2.4","@types/react-virtualized-auto-sizer":"^1.0.0","@types/react-window":"^1.8.2","@types/tinycolor2":"^1.4.2","ajv":"^7.1.1","axios":"^0.21.1","chart.js":"^2.9.3","fuzzy-search":"^3.2.1","glob-to-regexp":"^0.4.1","golden-layout":"^1.5.9","konva":"^7.2.3","lodash":"^4.17.15","mnemonist":"^0.38.1","mobx":"^6.1.7","mobx-react":"^7.1.0","moment":"^2.27.0","node-sass":"^4.14.1","npm-run-all":"^4.1.3","plotly.js":"^1.58.4","preval.macro":"^5.0.0","protobufjs":"6.9.0","raw-loader":"^4.0.2","react":"^17.0.1","react-chartjs-2":"^2.11.1","react-color":"^2.17.3","react-dom":"^17.0.1","react-iframe":"^1.8.0","react-konva":"^17.0.1-3","react-plotly.js":"^2.5.1","react-resize-detector":"^6.6.0","react-rnd":"^9.2.0","react-scripts":"^4.0.2","react-scroll-to-bottom":"^4.1.0","react-split-pane":"^0.1.91","react-virtualized-auto-sizer":"^1.0.4","react-window":"^1.8.6","rxjs":"^6.5.2","source-map-explorer":"^2.5.2","tinycolor2":"^1.4.1","typescript":"^4.1.5","worker-loader":"^3.0.8"},"scripts":{"git-info":"echo const info = {logMessage: \\\\\\"$(git log -1 --oneline)\\\\\\"}\\\\; export default info\\\\; > src/static/gitInfo.ts","analyze":"source-map-explorer build/static/js/main.*","start":"npm run git-info; react-scripts start","build":"npm run git-info; npm-run-all build-wrappers build-protobuf build-ts","build-docker":"npm run git-info; npm-run-all build-wrappers-docker build-protobuf build-ts","build-singularity":"npm run git-info; npm-run-all build-wrappers-singularity build-protobuf build-ts","build-ts":"react-scripts --max_old_space_size=4096 build","build-libs":"./wasm_libs/build_libs.sh","build-libs-docker":"./build_wasm_libs_docker.sh","build-libs-singularity":"./build_wasm_libs_singularity.sh","build-wrappers":"./wasm_src/build_wrappers.sh","build-wrappers-docker":"./build_wasm_wrappers_docker.sh","build-wrappers-singularity":"./build_wasm_wrappers_singularity.sh","build-protobuf":"./protobuf/build_proto.sh","test":"react-scripts test --env=jsdom","eject":"react-scripts eject","prepack":"npm run build-libs-docker; npm run build-docker"},"eslintConfig":{"extends":"react-app","rules":{"no-unused-expressions":"off","@typescript-eslint/no-unused-expressions":"error","import/no-webpack-loader-syntax":"off","no-unused-vars":"off","@typescript-eslint/no-unused-vars":["error",{"args":"none"}],"jsx-a11y/alt-text":"off"}},"browserslist":{"production":["last 2 chrome versions","last 2 firefox versions","last 2 safari versions"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},5:function(e,t,i){"use strict";i.d(t,"b",(function(){return C})),i.d(t,"c",(function(){return H})),i.d(t,"F",(function(){return q})),i.d(t,"d",(function(){return Y})),i.d(t,"e",(function(){return ne.a})),i.d(t,"q",(function(){return se})),i.d(t,"p",(function(){return Fe})),i.d(t,"o",(function(){return Me})),i.d(t,"n",(function(){return ke})),i.d(t,"g",(function(){return xt})),i.d(t,"t",(function(){return Ct})),i.d(t,"s",(function(){return It})),i.d(t,"J",(function(){return _i})),i.d(t,"S",(function(){return zi})),i.d(t,"v",(function(){return Wi})),i.d(t,"A",(function(){return Ui})),i.d(t,"V",(function(){return so})),i.d(t,"W",(function(){return ao})),i.d(t,"y",(function(){return lo})),i.d(t,"R",(function(){return co})),i.d(t,"C",(function(){return uo})),i.d(t,"B",(function(){return ho})),i.d(t,"f",(function(){return po})),i.d(t,"a",(function(){return go})),i.d(t,"D",(function(){return Co})),i.d(t,"E",(function(){return wo})),i.d(t,"u",(function(){return Fo.a})),i.d(t,"O",(function(){return Fo.b})),i.d(t,"P",(function(){return Mo})),i.d(t,"Q",(function(){return zo})),i.d(t,"T",(function(){return ws})),i.d(t,"U",(function(){return vs})),i.d(t,"h",(function(){return da})),i.d(t,"K",(function(){return ua})),i.d(t,"N",(function(){return ha})),i.d(t,"L",(function(){return Ea})),i.d(t,"M",(function(){return Fa})),i.d(t,"G",(function(){return Qa})),i.d(t,"H",(function(){return Ja})),i.d(t,"z",(function(){return pl})),i.d(t,"r",(function(){return ec})),i.d(t,"k",(function(){return uc})),i.d(t,"w",(function(){return xc})),i.d(t,"x",(function(){return Sc})),i.d(t,"I",(function(){return Cc.a})),i.d(t,"i",(function(){return Ic.a})),i.d(t,"m",(function(){return Ic.d})),i.d(t,"l",(function(){return Ic.c})),i.d(t,"j",(function(){return Ic.b}));var n,r,o,s,a,l,c,d,u,h,p,g,f,b,m,y,O,j=i(4),S=i(2),x=(i(28),i(1));let C=(n=Object(x.g)("show_alert"),r=Object(x.g)("dismiss_alert"),o=Object(x.g)("show_alert"),s=Object(x.g)("dismiss_alert"),O=y=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(j.a)(this,"alertVisible",l,this),Object(j.a)(this,"alertText",c,this),Object(j.a)(this,"alertIcon",d,this),Object(j.a)(this,"interactiveAlertVisible",u,this),Object(j.a)(this,"interactiveAlertText",h,this),this.interactiveAlertCallback=void 0,Object(j.a)(this,"showAlert",p,this),Object(j.a)(this,"dismissAlert",g,this),Object(j.a)(this,"showInteractiveAlert",f,this),Object(j.a)(this,"dismissInteractiveAlert",b,this),Object(j.a)(this,"handleInteractiveAlertClosed",m,this),Object(x.p)(this),this.alertVisible=!1,this.interactiveAlertVisible=!1}},y.staticInstance=void 0,a=O,l=Object(S.a)(a.prototype,"alertVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(S.a)(a.prototype,"alertText",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(S.a)(a.prototype,"alertIcon",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(S.a)(a.prototype,"interactiveAlertVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(S.a)(a.prototype,"interactiveAlertText",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(S.a)(a.prototype,"showAlert",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.alertText=e,this.alertIcon=t,this.alertVisible=!0}}}),g=Object(S.a)(a.prototype,"dismissAlert",[r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.alertVisible=!1}}}),f=Object(S.a)(a.prototype,"showInteractiveAlert",[o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.interactiveAlertText=e,this.alertIcon=i,this.interactiveAlertVisible=!0,this.interactiveAlertCallback=t}}}),b=Object(S.a)(a.prototype,"dismissInteractiveAlert",[s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.interactiveAlertVisible=!1}}}),m=Object(S.a)(a.prototype,"handleInteractiveAlertClosed",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.interactiveAlertVisible=!1,this.interactiveAlertCallback&&this.interactiveAlertCallback(e)}}}),a);var I,w,T,v,A,R,P,E,F,M,k,D,N,L,_,z,W,G,V=i(6),B=i(7);let H,q;!function(e){e[e.CHANNEL=0]="CHANNEL",e[e.STOKES=1]="STOKES",e[e.FRAME=2]="FRAME"}(H||(H={})),function(e){e[e.FORWARD=0]="FORWARD",e[e.BACKWARD=1]="BACKWARD",e[e.BOUNCING=2]="BOUNCING",e[e.BLINK=3]="BLINK"}(q||(q={}));let Y=(G=W=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(j.a)(this,"frameRate",w,this),Object(j.a)(this,"maxFrameRate",T,this),Object(j.a)(this,"minFrameRate",v,this),Object(j.a)(this,"step",A,this),Object(j.a)(this,"maxStep",R,this),Object(j.a)(this,"minStep",P,this),Object(j.a)(this,"animationMode",E,this),Object(j.a)(this,"animationActive",F,this),Object(j.a)(this,"playMode",M,this),Object(j.a)(this,"setAnimationMode",k,this),Object(j.a)(this,"setFrameRate",D,this),Object(j.a)(this,"setStep",N,this),Object(j.a)(this,"startAnimation",L,this),Object(j.a)(this,"stopAnimation",_,this),Object(j.a)(this,"animate",z,this),this.animateHandle=void 0,this.stopHandle=void 0,this.genAnimationFrames=e=>{if(!e)return null;let t,i,n,r={channel:e.channel,stokes:e.stokes};switch(this.animationMode===H.CHANNEL?(t={channel:e.animationChannelRange[0],stokes:e.stokes},i={channel:e.animationChannelRange[1],stokes:e.stokes},n={channel:this.step,stokes:0}):this.animationMode===H.STOKES&&(t={channel:e.channel,stokes:0},i={channel:e.channel,stokes:e.frameInfo.fileInfoExtended.stokes-1},n={channel:0,stokes:this.step}),this.playMode){case q.FORWARD:case q.BOUNCING:default:this.animationMode===H.CHANNEL?(r.channel<t.channel||r.channel>i.channel)&&(r.channel=t.channel):this.animationMode===H.STOKES&&(r.stokes<t.stokes||r.stokes>i.stokes)&&(r.stokes=t.stokes);break;case q.BACKWARD:this.animationMode===H.CHANNEL?((r.channel<t.channel||r.channel>i.channel)&&(r.channel=i.channel),n.channel=-1*this.step):this.animationMode===H.STOKES&&((r.stokes<t.stokes||r.stokes>i.stokes)&&(r.stokes=i.stokes),n.stokes=-1*this.step);break;case q.BLINK:this.animationMode===H.CHANNEL?r.channel=t.channel:this.animationMode===H.STOKES&&(r.stokes=t.stokes),this.animationMode===H.CHANNEL?n.channel=Math.abs(t.channel-i.channel):this.animationMode===H.STOKES&&(n.stokes=Math.abs(t.stokes-i.stokes))}return{startFrame:r,firstFrame:t,lastFrame:i,deltaFrame:n}},Object(x.p)(this),this.frameRate=5,this.maxFrameRate=15,this.minFrameRate=1,this.step=1,this.maxStep=50,this.minStep=1,this.animationMode=H.CHANNEL,this.animationActive=!1,this.animateHandle=null,this.playMode=q.FORWARD}get frameInterval(){return 1e3/Object(B.k)(this.frameRate,this.minFrameRate,this.maxFrameRate)}get serverAnimationActive(){return this.animationActive&&this.animationMode!==H.FRAME}},W.staticInstance=void 0,I=G,w=Object(S.a)(I.prototype,"frameRate",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=Object(S.a)(I.prototype,"maxFrameRate",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=Object(S.a)(I.prototype,"minFrameRate",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),A=Object(S.a)(I.prototype,"step",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=Object(S.a)(I.prototype,"maxStep",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),P=Object(S.a)(I.prototype,"minStep",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),E=Object(S.a)(I.prototype,"animationMode",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),F=Object(S.a)(I.prototype,"animationActive",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=Object(S.a)(I.prototype,"playMode",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=Object(S.a)(I.prototype,"setAnimationMode",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.animationActive||(this.animationMode=e)}}}),D=Object(S.a)(I.prototype,"setFrameRate",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.frameRate=e}}}),N=Object(S.a)(I.prototype,"setStep",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.step=e}}}),L=Object(S.a)(I.prototype,"startAnimation",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=ne.a.Instance,t=Ja.Instance,i=e.activeFrame;if(!i)return;if(this.animationMode===H.FRAME)return clearInterval(this.animateHandle),this.animationActive=!0,this.animate(),void(this.animateHandle=setInterval(this.animate,this.frameInterval));const n=this.genAnimationFrames(i);if(!n)return;const r=i.requiredFrameView,o={xMin:Math.max(0,r.xMin),xMax:Math.min(i.frameInfo.fileInfoExtended.width,r.xMax),yMin:Math.max(0,r.yMin),yMax:Math.min(i.frameInfo.fileInfoExtended.height,r.yMax),mip:r.mip},s={x:i.frameInfo.fileInfoExtended.width,y:i.frameInfo.fileInfoExtended.height},a=Object(B.b)(o,s,{x:256,y:256}).map((e=>e.encode())),l={fileId:i.frameInfo.fileId,tiles:a,compressionType:V.a.CompressionType.ZFP,compressionQuality:t.animationCompressionQuality},c=new Map;for(const u of i.spectralSiblings){const e=Object(B.K)(i.wcsInfo3D,u.wcsInfo3D,t.spectralMatchingType,n.firstFrame.channel,n.lastFrame.channel);c.set(u.frameInfo.fileId,{frameNumbers:e})}const d={fileId:i.frameInfo.fileId,startFrame:n.startFrame,firstFrame:n.firstFrame,lastFrame:n.lastFrame,deltaFrame:n.deltaFrame,requiredTiles:l,looping:!0,reverse:this.playMode===q.BOUNCING,frameRate:this.frameRate,matchedFrames:Object(B.R)(c)};e.backendService.startAnimation(d).subscribe((()=>{console.log("Animation started successfully")}),(t=>{console.log(t),e.tileService.setAnimationEnabled(!1)})),e.tileService.setAnimationEnabled(!0),this.animationActive=!0,clearTimeout(this.stopHandle),this.stopHandle=setTimeout(this.stopAnimation,6e4*t.stopAnimationPlaybackMinutes)}}}),_=Object(S.a)(I.prototype,"stopAnimation",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(!this.animationActive)return;const e=ne.a.Instance,t=e.activeFrame;if(t)if(this.animationActive=!1,e.tileService.setAnimationEnabled(!1),this.animationMode===H.FRAME)clearInterval(this.animateHandle);else{const i={channel:t.channel,stokes:t.stokes},n={fileId:t.frameInfo.fileId,endFrame:i};e.backendService.stopAnimation(n),t.setChannels(t.channel,t.stokes,!0);const r=[{frame:t,channel:t.requiredChannel,stokes:t.requiredStokes}];t.spectralSiblings.forEach((e=>{r.push({frame:e,channel:e.requiredChannel,stokes:e.requiredStokes})})),e.throttledSetChannels(r)}}}}),z=Object(S.a)(I.prototype,"animate",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.animationActive&&this.animationMode===H.FRAME&&ne.a.Instance.nextFrame()}}}),Object(S.a)(I.prototype,"frameInterval",[x.i],Object.getOwnPropertyDescriptor(I.prototype,"frameInterval"),I.prototype),Object(S.a)(I.prototype,"serverAnimationActive",[x.i],Object.getOwnPropertyDescriptor(I.prototype,"serverAnimationActive"),I.prototype),I);var U,X,$,K,Q,Z,J,ee,te,ie,ne=i(170),re=i(124),oe=i(27);let se=(ie=te=class{get hasValidData(){return!!this.vertexData&&this.vertexData.length>0}get isComplete(){return this.progress>=1}constructor(){Object(j.a)(this,"progress",X,this),Object(j.a)(this,"numGeneratedVertices",$,this),Object(j.a)(this,"vertexCount",K,this),Object(j.a)(this,"chunkCount",Q,this),this.indexOffsets=void 0,this.vertexData=void 0,this.vertexBuffers=void 0,this.gl=void 0,Object(j.a)(this,"setContourData",Z,this),Object(j.a)(this,"addContourData",J,this),Object(j.a)(this,"clearData",ee,this),Object(x.p)(this),this.gl=oe.d.Instance.gl}generateBuffers(e){this.vertexBuffers||(this.vertexBuffers=[]),this.gl&&this.vertexBuffers.length===e?(this.vertexBuffers.push(this.gl.createBuffer()),this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexBuffers[e]),this.gl.bufferData(WebGLRenderingContext.ARRAY_BUFFER,this.vertexData[e],WebGLRenderingContext.STATIC_DRAW),this.vertexData[e]=null):console.log("WebGL buffer index is incorrect!")}bindBuffer(e){!this.vertexBuffers||e>=this.vertexBuffers.length?console.log("WebGL buffer missing"):this.gl.bindBuffer(WebGLRenderingContext.ARRAY_BUFFER,this.vertexBuffers[e])}},te.VertexDataElements=8,U=ie,X=Object(S.a)(U.prototype,"progress",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$=Object(S.a)(U.prototype,"numGeneratedVertices",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=Object(S.a)(U.prototype,"vertexCount",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Q=Object(S.a)(U.prototype,"chunkCount",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Object(S.a)(U.prototype,"hasValidData",[x.i],Object.getOwnPropertyDescriptor(U.prototype,"hasValidData"),U.prototype),Object(S.a)(U.prototype,"isComplete",[x.i],Object.getOwnPropertyDescriptor(U.prototype,"isComplete"),U.prototype),Z=Object(S.a)(U.prototype,"setContourData",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.clearData(),this.addContourData(e,t,i)}}}),J=Object(S.a)(U.prototype,"addContourData",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{const n=t.length/2;if(!n)return;this.vertexData||(this.vertexData=[]),this.indexOffsets||(this.indexOffsets=[]),this.numGeneratedVertices||(this.numGeneratedVertices=[]);const r=re.GenerateVertexData(t,e);this.vertexData.push(r),this.indexOffsets.push(e),this.progress=i,this.numGeneratedVertices.push(r.length/(se.VertexDataElements/2));const o=this.vertexData.length-1;this.generateBuffers(o),this.vertexCount+=n,this.chunkCount++}}}),ee=Object(S.a)(U.prototype,"clearData",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.indexOffsets=[],this.vertexData=[],this.numGeneratedVertices=[],this.vertexCount=0,this.chunkCount=0,this.gl&&this.vertexBuffers){const e=this.vertexBuffers.length;for(let t=0;t<e;t++)this.gl.deleteBuffer(this.vertexBuffers[t]);this.vertexBuffers=[]}}}}),U);var ae,le,ce,de,ue,he,pe,ge,fe,be,me,ye,Oe,je,Se,xe,Ce,Ie,we,Te,ve,Ae,Re,Pe=i(43),Ee=i.n(Pe);let Fe,Me;!function(e){e.StartStepMultiplier="start-step-multiplier",e.MinMaxNScaling="min-max-scaling",e.PercentagesRefValue="percentages-ref.value",e.MeanSigmaList="mean-sigma-list"}(Fe||(Fe={})),function(e){e[e.None=0]="None",e[e.Dashed=1]="Dashed",e[e.NegativeOnly=2]="NegativeOnly"}(Me||(Me={}));let ke=(ae=class{constructor(e){Object(j.a)(this,"enabled",le,this),Object(j.a)(this,"levels",ce,this),Object(j.a)(this,"smoothingMode",de,this),Object(j.a)(this,"smoothingFactor",ue,this),Object(j.a)(this,"color",he,this),Object(j.a)(this,"colormapEnabled",pe,this),Object(j.a)(this,"colormap",ge,this),Object(j.a)(this,"colormapContrast",fe,this),Object(j.a)(this,"colormapBias",be,this),Object(j.a)(this,"dashMode",me,this),Object(j.a)(this,"thickness",ye,this),Object(j.a)(this,"visible",Oe,this),this.preferenceStore=void 0,Object(j.a)(this,"setContourConfiguration",je,this),Object(j.a)(this,"setColor",Se,this),Object(j.a)(this,"setDashMode",xe,this),Object(j.a)(this,"setThickness",Ce,this),Object(j.a)(this,"setColormap",Ie,this),Object(j.a)(this,"setColormapEnabled",we,this),Object(j.a)(this,"setColormapBias",Te,this),Object(j.a)(this,"setColormapContrast",ve,this),Object(j.a)(this,"setVisible",Ae,this),Object(j.a)(this,"toggleVisibility",Re,this),Object(x.p)(this),this.preferenceStore=e,this.enabled=!1,this.levels=[],this.smoothingMode=this.preferenceStore.contourSmoothingMode,this.smoothingFactor=this.preferenceStore.contourSmoothingFactor,this.color=Ee()(this.preferenceStore.contourColor).toRgb(),this.colormapEnabled=this.preferenceStore.contourColormapEnabled,this.colormap=this.preferenceStore.contourColormap,this.colormapBias=0,this.colormapContrast=1,this.thickness=1,this.dashMode=Me.NegativeOnly,this.visible=!0}setEnabled(e){this.enabled=e}},le=Object(S.a)(ae.prototype,"enabled",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ce=Object(S.a)(ae.prototype,"levels",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),de=Object(S.a)(ae.prototype,"smoothingMode",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ue=Object(S.a)(ae.prototype,"smoothingFactor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=Object(S.a)(ae.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=Object(S.a)(ae.prototype,"colormapEnabled",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ge=Object(S.a)(ae.prototype,"colormap",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fe=Object(S.a)(ae.prototype,"colormapContrast",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be=Object(S.a)(ae.prototype,"colormapBias",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=Object(S.a)(ae.prototype,"dashMode",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye=Object(S.a)(ae.prototype,"thickness",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=Object(S.a)(ae.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(ae.prototype,"setEnabled",[x.g],Object.getOwnPropertyDescriptor(ae.prototype,"setEnabled"),ae.prototype),je=Object(S.a)(ae.prototype,"setContourConfiguration",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{this.levels=e,this.smoothingMode=t,this.smoothingFactor=i}}}),Se=Object(S.a)(ae.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=Ee()(e);t.isValid()&&(this.color=t.toRgb())}}}),xe=Object(S.a)(ae.prototype,"setDashMode",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dashMode=e}}}),Ce=Object(S.a)(ae.prototype,"setThickness",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.thickness=e}}}),Ie=Object(S.a)(ae.prototype,"setColormap",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormap=e}}}),we=Object(S.a)(ae.prototype,"setColormapEnabled",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapEnabled=e}}}),Te=Object(S.a)(ae.prototype,"setColormapBias",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapBias=e}}}),ve=Object(S.a)(ae.prototype,"setColormapContrast",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colormapContrast=e}}}),Ae=Object(S.a)(ae.prototype,"setVisible",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),Re=Object(S.a)(ae.prototype,"toggleVisibility",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),ae);var De,Ne,Le,_e,ze,We,Ge,Ve,Be,He,qe,Ye,Ue,Xe,$e,Ke,Qe,Ze,Je,et,tt,it,nt,rt,ot,st,at,lt,ct,dt,ut,ht,pt,gt,ft,bt,mt,yt,Ot,jt,St=i(13);let xt,Ct;!function(e){e[e.File=0]="File",e[e.SaveFile=1]="SaveFile",e[e.RegionImport=2]="RegionImport",e[e.RegionExport=3]="RegionExport",e[e.Catalog=4]="Catalog"}(xt||(xt={})),function(e){e.Fuzzy="fuzzy",e.Unix="unix",e.Regex="regex"}(Ct||(Ct={}));let It=(jt=Ot=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}selectParent(){const e=this.getfileListByMode;e&&e.parent&&this.getFileList(e.parent)}setSelectedTab(e){this.selectedTab=e}saveStartingDirectory(e){void 0!==e?this.startingDirectory=e:this.browserMode===xt.Catalog?this.startingDirectory=this.catalogFileList.directory:this.startingDirectory=this.fileList.directory}get HDUList(){var e;return this.HDUfileInfoExtended?null===(e=Object.keys(this.HDUfileInfoExtended))||void 0===e?void 0:e.map((e=>{var t,i,n,r;return{label:`${e}${(null===(t=this.HDUfileInfoExtended[e])||void 0===t||null===(i=t.computedEntries)||void 0===i?void 0:i.length)>=3&&"Extension name"===(null===(n=this.HDUfileInfoExtended[e].computedEntries[2])||void 0===n?void 0:n.name)?`: ${null===(r=this.HDUfileInfoExtended[e].computedEntries[2])||void 0===r?void 0:r.value}`:""}`,value:e}})):null}get fileInfoExtended(){return this.HDUfileInfoExtended&&this.selectedHDU in this.HDUfileInfoExtended?this.HDUfileInfoExtended[this.selectedHDU]:null}get fileInfo(){var e;let t="";return(null===(e=this.fileInfoExtended)||void 0===e?void 0:e.computedEntries)&&this.fileInfoExtended.computedEntries.forEach((e=>{t+=`${e.name} = ${e.value}\n`})),t}get headers(){var e;let t="";return(null===(e=this.fileInfoExtended)||void 0===e?void 0:e.headerEntries)&&this.fileInfoExtended.headerEntries.forEach((e=>{"END"===e.name?t+=`${e.name}\n`:t+=`${e.name} = ${e.value}\n`})),t}get getfileListByMode(){switch(this.browserMode){case xt.Catalog:return this.catalogFileList;default:return this.fileList}}get getBrowserMode(){switch(this.browserMode){case xt.File:case xt.SaveFile:return St.e.IMAGE_FILE;case xt.Catalog:return St.e.CATALOG_FILE;default:return St.e.REGION_FILE}}get catalogHeaderDataset(){let e=new Map;const t=[],i=[],n=[],r=[];for(let s=0;s<this.catalogHeaders.length;s++){const e=this.catalogHeaders[s];t.push(e.name),i.push(e.units),n.push(Object(B.B)(e.dataType)),r.push(e.description)}const o=V.a.ColumnType.String;return e.set(0,{dataType:o,data:t}),e.set(1,{dataType:o,data:i}),e.set(2,{dataType:o,data:n}),e.set(3,{dataType:o,data:r}),{columnHeaders:[new V.a.CatalogHeader({name:"Name",dataType:o,columnIndex:0}),new V.a.CatalogHeader({name:"Unit",dataType:o,columnIndex:1}),new V.a.CatalogHeader({name:"Data Type",dataType:o,columnIndex:2}),new V.a.CatalogHeader({name:"Description",dataType:o,columnIndex:3})],columnsData:e}}constructor(){Object(j.a)(this,"browserMode",Ne,this),Object(j.a)(this,"appendingFrame",Le,this),Object(j.a)(this,"fileList",_e,this),Object(j.a)(this,"selectedFile",ze,this),Object(j.a)(this,"selectedHDU",We,this),Object(j.a)(this,"HDUfileInfoExtended",Ge,this),Object(j.a)(this,"regionFileInfo",Ve,this),Object(j.a)(this,"selectedTab",Be,this),Object(j.a)(this,"loadingList",He,this),Object(j.a)(this,"loadingInfo",qe,this),Object(j.a)(this,"fileInfoResp",Ye,this),Object(j.a)(this,"responseErrorMessage",Ue,this),Object(j.a)(this,"startingDirectory",Xe,this),Object(j.a)(this,"exportFilename",$e,this),Object(j.a)(this,"exportCoordinateType",Ke,this),Object(j.a)(this,"exportFileType",Qe,this),Object(j.a)(this,"catalogFileList",Ze,this),Object(j.a)(this,"selectedCatalogFile",Je,this),Object(j.a)(this,"catalogFileInfo",et,this),Object(j.a)(this,"catalogHeaders",tt,this),Object(j.a)(this,"saveFilename",it,this),Object(j.a)(this,"saveFileType",nt,this),Object(j.a)(this,"showFileBrowser",rt,this),Object(j.a)(this,"hideFileBrowser",ot,this),Object(j.a)(this,"getFileList",st,this),Object(j.a)(this,"getFileInfo",at,this),Object(j.a)(this,"getRegionFileInfo",lt,this),Object(j.a)(this,"getCatalogFileInfo",ct,this),Object(j.a)(this,"selectFile",dt,this),Object(j.a)(this,"selectFolder",ut,this),Object(j.a)(this,"selectHDU",ht,this),Object(j.a)(this,"setExportFilename",pt,this),Object(j.a)(this,"setExportCoordinateType",gt,this),Object(j.a)(this,"setExportFileType",ft,this),Object(j.a)(this,"setSaveFilename",bt,this),Object(j.a)(this,"setSaveFileType",mt,this),Object(j.a)(this,"setSortingConfig",yt,this),Object(x.p)(this),this.exportCoordinateType=V.a.CoordinateType.WORLD,this.exportFileType=V.a.FileType.CRTF}},Ot.staticInstance=void 0,De=jt,Ne=Object(S.a)(De.prototype,"browserMode",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return xt.File}}),Le=Object(S.a)(De.prototype,"appendingFrame",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),_e=Object(S.a)(De.prototype,"fileList",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ze=Object(S.a)(De.prototype,"selectedFile",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),We=Object(S.a)(De.prototype,"selectedHDU",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ge=Object(S.a)(De.prototype,"HDUfileInfoExtended",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=Object(S.a)(De.prototype,"regionFileInfo",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=Object(S.a)(De.prototype,"selectedTab",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return St.e.IMAGE_FILE}}),He=Object(S.a)(De.prototype,"loadingList",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),qe=Object(S.a)(De.prototype,"loadingInfo",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ye=Object(S.a)(De.prototype,"fileInfoResp",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ue=Object(S.a)(De.prototype,"responseErrorMessage",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Xe=Object(S.a)(De.prototype,"startingDirectory",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"$BASE"}}),$e=Object(S.a)(De.prototype,"exportFilename",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=Object(S.a)(De.prototype,"exportCoordinateType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qe=Object(S.a)(De.prototype,"exportFileType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ze=Object(S.a)(De.prototype,"catalogFileList",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je=Object(S.a)(De.prototype,"selectedCatalogFile",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),et=Object(S.a)(De.prototype,"catalogFileInfo",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tt=Object(S.a)(De.prototype,"catalogHeaders",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=Object(S.a)(De.prototype,"saveFilename",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),nt=Object(S.a)(De.prototype,"saveFileType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return V.a.FileType.CASA}}),rt=Object(S.a)(De.prototype,"showFileBrowser",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.appendingFrame=t,this.browserMode=e,ec.Instance.showFileBrowserDialog(),this.fileList=null,this.selectedTab=this.getBrowserMode,this.responseErrorMessage="",this.exportFilename="",this.catalogFileList=null,this.getFileList(this.startingDirectory),ne.a.Instance.activeFrame&&e===xt.SaveFile&&(this.saveFilename=ne.a.Instance.activeFrame.frameInfo.fileInfo.name)}}}),ot=Object(S.a)(De.prototype,"hideFileBrowser",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{ec.Instance.hideFileBrowserDialog()}}}),st=Object(S.a)(De.prototype,"getFileList",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=oe.b.Instance;this.loadingList=!0,this.selectedFile=null,this.selectedHDU=null,this.HDUfileInfoExtended=null,this.regionFileInfo=null,this.catalogFileInfo=null,this.browserMode===xt.File||this.browserMode===xt.SaveFile?t.getFileList(e).subscribe((e=>Object(x.s)((()=>{this.fileList=e,this.loadingList=!1}))),(e=>Object(x.s)((()=>{console.log(e),this.loadingList=!1})))):this.browserMode===xt.Catalog?t.getCatalogList(e).subscribe((e=>Object(x.s)((()=>{this.catalogFileList=e,this.loadingList=!1}))),(e=>Object(x.s)((()=>{console.log(e),this.loadingList=!1})))):t.getRegionList(e).subscribe((e=>Object(x.s)((()=>{this.fileList=e,this.loadingList=!1}))),(e=>Object(x.s)((()=>{console.log(e),this.loadingList=!1}))))}}}),at=Object(S.a)(De.prototype,"getFileInfo",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{const n=oe.b.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.HDUfileInfoExtended=null,this.responseErrorMessage="",n.getFileInfo(e,t,i).subscribe((e=>Object(x.s)((()=>{if(e.fileInfo&&this.selectedFile&&e.fileInfo.name===this.selectedFile.name){this.HDUfileInfoExtended=e.fileInfoExtended;const t=Object.keys(this.HDUfileInfoExtended);(null===t||void 0===t?void 0:t.length)>=1&&(this.selectedHDU=t[0]),this.loadingInfo=!1}this.fileInfoResp=!0}))),(e=>Object(x.s)((()=>{console.log(e),this.responseErrorMessage=e,this.fileInfoResp=!1,this.HDUfileInfoExtended=null,this.loadingInfo=!1}))))}}}),lt=Object(S.a)(De.prototype,"getRegionFileInfo",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=oe.b.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.regionFileInfo=null,this.responseErrorMessage="",i.getRegionFileInfo(e,t).subscribe((e=>Object(x.s)((()=>{e.fileInfo&&this.selectedFile&&e.fileInfo.name===this.selectedFile.name&&(this.loadingInfo=!1,this.regionFileInfo=e.contents),this.fileInfoResp=!0}))),(e=>Object(x.s)((()=>{console.log(e),this.responseErrorMessage=e,this.fileInfoResp=!1,this.regionFileInfo=null,this.loadingInfo=!1}))))}}}),ct=Object(S.a)(De.prototype,"getCatalogFileInfo",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=oe.b.Instance;this.loadingInfo=!0,this.fileInfoResp=!1,this.catalogFileInfo=null,this.catalogHeaders=[],this.responseErrorMessage="",i.getCatalogFileInfo(e,t).subscribe((e=>Object(x.s)((()=>{e.fileInfo&&this.selectedFile&&e.fileInfo.name===this.selectedFile.name&&(this.loadingInfo=!1,this.catalogFileInfo=e.fileInfo,this.catalogHeaders=e.headers.sort(((e,t)=>e.columnIndex-t.columnIndex))),this.fileInfoResp=!0}))),(e=>Object(x.s)((()=>{console.log(e),this.responseErrorMessage=e,this.fileInfoResp=!1,this.catalogFileInfo=null,this.loadingInfo=!1}))))}}}),dt=Object(S.a)(De.prototype,"selectFile",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.getfileListByMode;this.selectedFile=e.fileInfo,e.hdu&&(this.selectedHDU=e.hdu),this.browserMode===xt.File?this.getFileInfo(t.directory,e.fileInfo.name,e.hdu):this.browserMode===xt.SaveFile?(this.getFileInfo(t.directory,e.fileInfo.name,e.hdu),this.saveFilename=e.fileInfo.name):this.browserMode===xt.Catalog?this.getCatalogFileInfo(t.directory,e.fileInfo.name):(this.setExportFilename(e.fileInfo.name),this.getRegionFileInfo(t.directory,e.fileInfo.name))}}}),ut=Object(S.a)(De.prototype,"selectFolder",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{if(t)return void this.getFileList(e);const i=this.getfileListByMode;if(".."===e)this.selectParent();else if(i){const t=i.directory;let n=e;!t.length||1===t.length&&"/"===t[0]||(n=`${t}/${e}`),this.getFileList(n)}}}}),Object(S.a)(De.prototype,"selectParent",[x.g],Object.getOwnPropertyDescriptor(De.prototype,"selectParent"),De.prototype),ht=Object(S.a)(De.prototype,"selectHDU",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e in this.HDUfileInfoExtended&&(this.selectedHDU=e)}}}),Object(S.a)(De.prototype,"setSelectedTab",[x.g],Object.getOwnPropertyDescriptor(De.prototype,"setSelectedTab"),De.prototype),Object(S.a)(De.prototype,"saveStartingDirectory",[x.g],Object.getOwnPropertyDescriptor(De.prototype,"saveStartingDirectory"),De.prototype),pt=Object(S.a)(De.prototype,"setExportFilename",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportFilename=e}}}),gt=Object(S.a)(De.prototype,"setExportCoordinateType",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportCoordinateType=e}}}),ft=Object(S.a)(De.prototype,"setExportFileType",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.exportFileType=e}}}),bt=Object(S.a)(De.prototype,"setSaveFilename",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFilename=e}}}),mt=Object(S.a)(De.prototype,"setSaveFileType",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.saveFileType=e}}}),yt=Object(S.a)(De.prototype,"setSortingConfig",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=(t>=0?"+":"-")+e.toLowerCase();Ja.Instance.setPreference(Qa.SILENT_FILE_SORTING_STRING,i)}}}),Object(S.a)(De.prototype,"HDUList",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"HDUList"),De.prototype),Object(S.a)(De.prototype,"fileInfoExtended",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"fileInfoExtended"),De.prototype),Object(S.a)(De.prototype,"fileInfo",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"fileInfo"),De.prototype),Object(S.a)(De.prototype,"headers",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"headers"),De.prototype),Object(S.a)(De.prototype,"getfileListByMode",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"getfileListByMode"),De.prototype),Object(S.a)(De.prototype,"getBrowserMode",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"getBrowserMode"),De.prototype),Object(S.a)(De.prototype,"catalogHeaderDataset",[x.i],Object.getOwnPropertyDescriptor(De.prototype,"catalogHeaderDataset"),De.prototype),De);var wt,Tt,vt,At,Rt,Pt,Et,Ft,Mt,kt,Dt,Nt,Lt,_t,zt,Wt,Gt,Vt,Bt,Ht,qt,Yt,Ut,Xt,$t,Kt,Qt,Zt,Jt,ei,ti,ii,ni,ri,oi,si,ai,li,ci,di,ui,hi,pi,gi,fi,bi,mi,yi,Oi,ji,Si,xi,Ci,Ii,wi,Ti,vi,Ai,Ri,Pi,Ei,Fi,Mi,ki,Di=i(20),Ni=i(11),Li=i(12);let _i;!function(e){e[e.NONE=0]="NONE",e[e.TILED=1]="TILED"}(_i||(_i={}));const zi=10;let Wi=(ki=Mi=class e{get filename(){var e,t,i,n,r,o,s,a,l;const c=(null===(e=this.frameInfo)||void 0===e||null===(t=e.fileInfoExtended)||void 0===t||null===(i=t.computedEntries)||void 0===i?void 0:i.length)>=3&&"Extension name"===(null===(n=this.frameInfo)||void 0===n||null===(r=n.fileInfoExtended)||void 0===r||null===(o=r.computedEntries[2])||void 0===o?void 0:o.name)?`_${null===(s=this.frameInfo.fileInfoExtended.computedEntries[2])||void 0===s?void 0:s.value}`:"";return""!==(null===(a=this.frameInfo)||void 0===a?void 0:a.hdu)&&"0"!==(null===(l=this.frameInfo)||void 0===l?void 0:l.hdu)?`${this.frameInfo.fileInfo.name}.HDU_${this.frameInfo.hdu}${c}`:this.frameInfo.fileInfo.name}get regionSet(){return this.spatialReference?this.spatialReference.regionSet:this.frameRegionSet}get sharedRegions(){return!!this.spatialReference}get requiredFrameView(){if(this.spatialReference){const e=this.spatialReference.requiredFrameView,t=[this.spatialTransform.transformCoordinate({x:e.xMin,y:e.yMin},!1),this.spatialTransform.transformCoordinate({x:e.xMin,y:e.yMax},!1),this.spatialTransform.transformCoordinate({x:e.xMax,y:e.yMax},!1),this.spatialTransform.transformCoordinate({x:e.xMax,y:e.yMin},!1)],{minPoint:i,maxPoint:n}=Object(B.T)(t),r=(Ja.Instance.lowBandwidthMode?2:1)/this.spatialTransform.scale,o=Math.max(1,r/this.spatialReference.zoomLevel),s=Math.log2(o),a=Math.round(s);return{xMin:i.x,xMax:n.x,yMin:i.y,yMax:n.y,mip:Math.pow(2,a)}}{if(this.zoomLevel<=0||!this.isRenderable)return{xMin:0,xMax:1,yMin:0,yMax:1,mip:1};const e=this.renderHiDPI?devicePixelRatio:1,t=e*this.renderWidth/this.zoomLevel,i=e*this.renderHeight/this.zoomLevel,n=Ja.Instance.lowBandwidthMode?2:1,r=Math.max(1,n/this.zoomLevel),o=Math.log2(r),s=Math.round(o),a=Math.pow(2,s);return{xMin:this.center.x-t/2,xMax:this.center.x+t/2,yMin:this.center.y-i/2,yMax:this.center.y+i/2,mip:a}}}get spatialTransform(){if(this.spatialReference&&this.spatialTransformAST){const e=Object(B.nb)(this.spatialTransformAST,this.spatialReference.center,!1);return Object(B.N)(e)?new Ni.Transform2D(this.spatialTransformAST,{x:this.frameInfo.fileInfoExtended.width/2+.5,y:this.frameInfo.fileInfoExtended.height/2+.5}):new Ni.Transform2D(this.spatialTransformAST,e)}return null}get transformedWcsInfo(){if(this.spatialTransform){let e={x:-this.spatialTransform.translation.x/this.spatialTransform.scale,y:-this.spatialTransform.translation.y/this.spatialTransform.scale};return e=Object(B.cb)(e,-this.spatialTransform.rotation),this.cachedTransformedWcsInfo>=0&&Di.delete(this.cachedTransformedWcsInfo),this.cachedTransformedWcsInfo=Di.createTransformedFrameset(this.wcsInfo,e.x,e.y,-this.spatialTransform.rotation,this.spatialTransform.origin.x,this.spatialTransform.origin.y,1/this.spatialTransform.scale,1/this.spatialTransform.scale),this.cachedTransformedWcsInfo}return null}get renderWidth(){return this.overlayStore.renderWidth}get renderHeight(){return this.overlayStore.renderHeight}get isRenderable(){return this.renderWidth>0&&this.renderHeight>0}get unit(){if(this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.headerEntries){const e=this.frameInfo.fileInfoExtended.headerEntries.filter((e=>"BUNIT"===e.name));return e.length?Object(B.ob)(e[0].value):void 0}}get beamProperties(){const e=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CUNIT1"))),t=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CDELT1")));if(e&&t){const i=e.value.trim(),n=Object(B.D)(t);if(isFinite(n)&&("deg"===i||"rad"===i)&&this.frameInfo.beamTable&&this.frameInfo.beamTable.length>0){let e;if(1===this.frameInfo.beamTable.length&&-1===this.frameInfo.beamTable[0].channel&&-1===this.frameInfo.beamTable[0].stokes?e=this.frameInfo.beamTable[0]:this.frameInfo.fileInfoExtended.depth>1&&this.frameInfo.fileInfoExtended.stokes>1?e=this.frameInfo.beamTable.find((e=>e.channel===this.requiredChannel&&e.stokes===this.requiredStokes)):this.frameInfo.fileInfoExtended.depth>1&&this.frameInfo.fileInfoExtended.stokes<=1?e=this.frameInfo.beamTable.find((e=>e.channel===this.requiredChannel)):this.frameInfo.fileInfoExtended.depth<=1&&this.frameInfo.fileInfoExtended.stokes>1&&(e=this.frameInfo.beamTable.find((e=>e.stokes===this.requiredStokes))),e&&isFinite(e.majorAxis)&&e.majorAxis>0&&isFinite(e.minorAxis)&&e.minorAxis>0&&isFinite(e.pa))return{x:e.majorAxis/("deg"===i?3600:648e3/Math.PI)/Math.abs(n),y:e.minorAxis/("deg"===i?3600:648e3/Math.PI)/Math.abs(n),angle:e.pa,overlayBeamSettings:this.overlayBeamSettings}}}return null}get hasVisibleBeam(){var e,t;return null===(e=this.beamProperties)||void 0===e||null===(t=e.overlayBeamSettings)||void 0===t?void 0:t.visible}get channelInfo(){if(!this.frameInfo||!this.frameInfo.fileInfoExtended||this.frameInfo.fileInfoExtended.depth<=1||!this.frameInfo.fileInfoExtended.headerEntries)return;const e=this.frameInfo.fileInfoExtended.depth,t=new Array(e),i=new Array(e),n=new Array(e);let r=t=>{if(!t)return null;if(t<0)return 0;if(t>e-1)return e-1;const i=Math.ceil(t),n=Math.floor(t);return i-t<t-n?i:n};if(this.spectralAxis){const o=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRPIX${this.spectralAxis.dimension}`))),s=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRVAL${this.spectralAxis.dimension}`))),a=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CDELT${this.spectralAxis.dimension}`)));if(o&&s&&a){const l=Object(B.D)(o)-1,c=Object(B.D)(s),d=Object(B.D)(a);if(isFinite(l)&&isFinite(c)&&isFinite(d)){for(let r=0;r<e;r++){const e=r-l;t[r]=r,n[r]=e*d+c,i[r]=n[r]}return{fromWCS:!0,channelType:this.spectralAxis.type,indexes:t,delta:d,values:i,rawValues:n,getChannelIndexWCS:e=>{if(!e)return null;const t=(e-c)/d+l;if(t<0)return 0;if(t>i.length-1)return i.length-1;const n=Math.ceil(t),r=Math.floor(t);return Math.abs(i[n]-e)<Math.abs(e-i[r])?n:r},getChannelIndexSimple:r}}}}for(let o=0;o<e;o++)t[o]=o,i[o]=o,n[o]=o;return{fromWCS:!1,channelType:{code:"",name:"Channel",unit:""},delta:void 0,indexes:t,values:i,rawValues:n,getChannelIndexWCS:null,getChannelIndexSimple:r}}get spectralInfo(){const e={channel:this.channel,channelType:{code:"",name:"Channel",unit:""},specsys:"",spectralString:""};if(this.frameInfo.fileInfoExtended.depth>1){const t=this.channelInfo;if(e.channelType=t.channelType,t.channelType.code){const i=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("SPECSYS")));if(i&&i.value&&(e.specsys=Object(B.ob)(i.value).toUpperCase()),e.spectralString=`${t.channelType.name} (${e.specsys}): ${Object(B.mb)(t.values[this.channel],4)} ${t.channelType.unit}`,"FREQ"===t.channelType.code){const i=t.rawValues[this.channel];if(this.isSpectralCoordinateConvertible&&t.channelType.unit!==Ni.SPECTRAL_DEFAULT_UNIT.get(Ni.SpectralType.FREQ)){const t=this.astSpectralTransform(Ni.SpectralType.FREQ,Ni.SpectralUnit.GHZ,this.spectralSystem,i);isFinite(t)&&(e.spectralString=`Frequency (${this.spectralSystem}): ${Object(B.w)(t)}`)}const n=this.astSpectralTransform(Ni.SpectralType.VRAD,Ni.SpectralUnit.KMS,this.spectralSystem,i);isFinite(n)&&(e.velocityString=`Velocity: ${Object(B.mb)(n,4)} km/s`)}else if("VRAD"===t.channelType.code){const i=t.rawValues[this.channel];if(this.isSpectralCoordinateConvertible&&t.channelType.unit!==Ni.SPECTRAL_DEFAULT_UNIT.get(Ni.SpectralType.VRAD)){const t=this.astSpectralTransform(Ni.SpectralType.VRAD,Ni.SpectralUnit.KMS,this.spectralSystem,i);isFinite(t)&&(e.spectralString=`Velocity (${this.spectralSystem}): ${Object(B.mb)(t,4)} km/s`)}const n=this.astSpectralTransform(Ni.SpectralType.FREQ,Ni.SpectralUnit.GHZ,this.spectralSystem,i);isFinite(n)&&(e.freqString=`Frequency: ${Object(B.w)(n)}`)}}}return e}get simpleSpectralInfo(){var e,t;const i=this.spectralInfo.freqString?this.spectralInfo.freqString:this.spectralInfo.velocityString;return`${null===(e=this.spectralInfo.spectralString)||void 0===e||null===(t=e.replace(/\w+\s\(/,""))||void 0===t?void 0:t.replace(/\):\s/,"\n")}${null===i||void 0===i?void 0:i.replace(/\w+:\s/,"\n")}`}get spectralAxis(){if(!this.frameInfo||!this.frameInfo.fileInfoExtended||this.frameInfo.fileInfoExtended.depth<=1||!this.frameInfo.fileInfoExtended.headerEntries)return;const e=this.frameInfo.fileInfoExtended.headerEntries,t=e.find((e=>e.name.includes("CTYPE3"))),i=e.find((e=>e.name.includes("CTYPE4")));if(!(!t&&!i||t&&t.value.match(/stokes/i)&&!i||!t&&i&&i.value.match(/stokes/i)||t&&t.value.match(/stokes/i)&&i&&i.value.match(/stokes/i))){if(t&&!t.value.match(/stokes/i)){const i=t.value.trim().toUpperCase(),n=Ni.CHANNEL_TYPES.find((e=>i===e.code)),r=e.find((e=>e.name.includes("CUNIT3")));return n?{valid:!0,dimension:3,type:{name:n.name,code:n.code,unit:r?r.value.trim():n.unit}}:{valid:!1,dimension:3,type:{name:i,code:i,unit:r?r.value.trim():void 0}}}if(i&&!i.value.match(/stokes/i)){const t=i.value.trim().toUpperCase(),n=Ni.CHANNEL_TYPES.find((e=>t===e.code)),r=e.find((e=>e.name.includes("CUNIT4")));return n?{valid:!0,dimension:4,type:{name:n.name,code:n.code,unit:r?r.value.trim():n.unit}}:{valid:!1,dimension:4,type:{name:t,code:t,unit:r?r.value.trim():void 0}}}}}get isSpectralCoordinateConvertible(){return!(!this.spectralAxis||this.spectralAxis&&!this.spectralAxis.valid||!this.spectralFrame)&&(Object(Ni.IsSpectralTypeSupported)(this.spectralAxis.type.code)&&Object(Ni.IsSpectralUnitSupported)(this.spectralAxis.type.unit))}get isSpectralSystemConvertible(){return!(!this.spectralInfo||!this.spectralFrame)&&Object(Ni.IsSpectralSystemSupported)(this.spectralInfo.specsys)}get isSpectralPropsEqual(){let e=!1;if(this.spectralInfo&&this.spectralInfo.channelType){const t=this.spectralInfo.channelType.code===this.spectralType,i=this.spectralInfo.channelType.unit===this.spectralUnit,n=this.spectralInfo.specsys===this.spectralSystem;e=t&&i&&n}return e}get isCoordChannel(){return this.spectralType===Ni.SpectralType.CHANNEL}get nativeSpectralCoordinate(){return this.spectralAxis?`${this.spectralAxis.type.name} (${this.spectralAxis.type.unit})`:void 0}get spectralCoordinate(){return this.spectralType||this.spectralUnit?Object(Ni.GenCoordinateLabel)(this.spectralType,this.spectralUnit):this.nativeSpectralCoordinate}get spectralUnitStr(){return!this.spectralAxis||this.spectralType||this.spectralUnit?this.isCoordChannel?Ni.SPECTRAL_TYPE_STRING.get(Ni.SpectralType.CHANNEL):this.spectralUnit:this.spectralAxis.type.unit}get hasStokes(){return this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.stokes>1}get numChannels(){return this.frameInfo.fileInfoExtended.depth}get channelValueBounds(){if(this.numChannels>1&&this.channelValues){const e=this.channelValues[0],t=this.channelValues[this.numChannels-1];return new V.a.FloatBounds(e<=t?{min:e,max:t}:{min:t,max:e})}return null}get spectralSiblings(){if(this.spectralReference){let e=[];return e.push(this.spectralReference),e.push(...this.spectralReference.secondarySpectralImages.slice().filter((e=>e!==this))),e}return this.secondarySpectralImages.slice()}get spatialSiblings(){if(this.spatialReference){let e=[];return e.push(this.spatialReference),e.push(...this.spatialReference.secondarySpatialImages.slice().filter((e=>e!==this))),e}return this.secondarySpatialImages.slice()}get renderConfigSiblings(){if(this.rasterScalingReference){let e=[];return e.push(this.rasterScalingReference),e.push(...this.rasterScalingReference.secondaryRasterScalingImages.slice().filter((e=>e!==this))),e}return this.secondaryRasterScalingImages.slice()}get isCursorValueCurrent(){if(!this.cursorValue||!this.cursorInfo)return!1;const e=Object(B.db)(this.cursorInfo.posImageSpace),t=Object(B.db)(this.cursorValue.position);return this.cursorValue.channel===this.channel&&e.x===t.x&&e.y===t.y}get zoomLevelForFit(){return Math.min(this.calculateZoomX,this.calculateZoomY)}get calculateZoomX(){const e=this.frameInfo.fileInfoExtended.width,t=this.renderHiDPI?devicePixelRatio:1;return e<=0?1:this.renderWidth*t/e}get calculateZoomY(){const e=this.frameInfo.fileInfoExtended.height,t=this.renderHiDPI?devicePixelRatio:1;return e<=0?1:this.renderHeight*t/e}get contourProgress(){if(!this.contourConfig.levels||!this.contourConfig.levels.length||!this.contourConfig.enabled)return-1;if(!this.contourStores||!this.contourStores.size)return 0;let e=0;return this.contourStores.forEach(((t,i)=>{-1!==this.contourConfig.levels.indexOf(i)&&(e+=t.progress)})),e/(this.contourConfig.levels?this.contourConfig.levels.length:1)}get stokesInfo(){if(this.frameInfo&&this.frameInfo.fileInfoExtended&&this.frameInfo.fileInfoExtended.headerEntries){const e=this.frameInfo.fileInfoExtended.headerEntries.find((e=>"STOKES"===e.value.toUpperCase()));if(e&&-1!==e.name.indexOf("CTYPE")){const t=e.name.substring(5),i=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`NAXIS${t}`))),n=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRPIX${t}`))),r=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CRVAL${t}`))),o=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf(`CDELT${t}`)));let s=[];for(let e=0;e<parseInt(i.value);e++){switch(Object(B.D)(r)+(e+1-Object(B.D)(n))*Object(B.D)(o)){case 1:s.push("I");break;case 2:s.push("Q");break;case 3:s.push("U");break;case 4:s.push("V")}}return s}}return[]}constructor(t){this.astFrameSet=void 0,this.spectralFrame=void 0,this.controlMaps=void 0,this.backendService=void 0,this.overlayStore=void 0,this.logStore=void 0,this.spectralTransformAST=void 0,this.cachedTransformedWcsInfo=-1,this.zoomTimeoutHandler=void 0,this.wcsInfo=void 0,this.wcsInfoForTransformation=void 0,this.wcsInfo3D=void 0,this.validWcs=void 0,this.spectralCoordsSupported=void 0,this.spectralSystemsSupported=void 0,this.spatialTransformAST=void 0,Object(j.a)(this,"frameRegionSet",Tt,this),Object(j.a)(this,"frameInfo",vt,this),Object(j.a)(this,"renderHiDPI",At,this),Object(j.a)(this,"spectralType",Rt,this),Object(j.a)(this,"spectralUnit",Pt,this),Object(j.a)(this,"spectralSystem",Et,this),Object(j.a)(this,"channelValues",Ft,this),Object(j.a)(this,"center",Mt,this),Object(j.a)(this,"cursorInfo",kt,this),Object(j.a)(this,"cursorValue",Dt,this),Object(j.a)(this,"zoomLevel",Nt,this),Object(j.a)(this,"stokes",Lt,this),Object(j.a)(this,"channel",_t,this),Object(j.a)(this,"requiredStokes",zt,this),Object(j.a)(this,"requiredChannel",Wt,this),Object(j.a)(this,"animationChannelRange",Gt,this),Object(j.a)(this,"renderType",Vt,this),Object(j.a)(this,"currentFrameView",Bt,this),Object(j.a)(this,"currentCompressionQuality",Ht,this),Object(j.a)(this,"renderConfig",qt,this),Object(j.a)(this,"contourConfig",Yt,this),Object(j.a)(this,"contourStores",Ut,this),Object(j.a)(this,"valid",Xt,this),Object(j.a)(this,"moving",$t,this),Object(j.a)(this,"zooming",Kt,this),Object(j.a)(this,"overlayBeamSettings",Qt,this),Object(j.a)(this,"spatialReference",Zt,this),Object(j.a)(this,"spectralReference",Jt,this),Object(j.a)(this,"rasterScalingReference",ei,this),Object(j.a)(this,"secondarySpatialImages",ti,this),Object(j.a)(this,"secondarySpectralImages",ii,this),Object(j.a)(this,"secondaryRasterScalingImages",ni,this),Object(j.a)(this,"momentImages",ri,this),Object(j.a)(this,"isRequestingMoments",oi,this),Object(j.a)(this,"requestingMomentsProgress",si,this),this.convertSpectral=e=>e&&e.length>0?e.map((e=>this.astSpectralTransform(this.spectralType,this.spectralUnit,this.spectralSystem,e))):null,this.astSpectralTransform=(e,t,i,n)=>{if(this.spectralFrame&&isFinite(n))return Di.transformSpectralPoint(this.spectralFrame,e,t,i,n)},this.initFrame=()=>{const t=this.frameInfo.fileInfoExtended.depth>1?"3":"2";let i="";for(let s of this.frameInfo.fileInfoExtended.headerEntries){let a=s.name;if("2"===t){if(s.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[3-9]/))continue}else{var n,r,o;if(s.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)[5-9]/)||3===(null===(n=this.spectralAxis)||void 0===n?void 0:n.dimension)&&s.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)4/)||4===(null===(r=this.spectralAxis)||void 0===r?void 0:r.dimension)&&s.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)3/))continue;4===(null===(o=this.spectralAxis)||void 0===o?void 0:o.dimension)&&s.name.match(/(CTYPE|CDELT|CRPIX|CRVAL|CUNIT|NAXIS|CROTA)4/)&&(a=s.name.replace("4","3"))}if(!s.value.length)continue;let l=Object(B.ob)(s.value);for("NAXIS"!==s.name.toUpperCase()&&"WCSAXES"!==s.name.toUpperCase()||(l=t),l=s.entryType===V.a.EntryType.STRING?`'${l}'`:e.ShiftASTCoords(s,l);a.length<8;)a+=" ";let c=`${a}=  ${l}`;for(;c.length<80;)c+=" ";i+=c}return Di.initFrame(i)},this.replaceZoomTimeoutHandler=()=>{this.zoomTimeoutHandler&&clearTimeout(this.zoomTimeoutHandler),this.zoomTimeoutHandler=setTimeout((()=>Object(x.s)((()=>{this.zooming=!1}))),e.ZoomInertiaDuration)},this.convertToNativeWCS=e=>{if(this.spectralFrame&&isFinite(e))return Di.transformSpectralPoint(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e,!1)},this.convertFreqMHzToSettingWCS=e=>{if(!this.spectralFrame||!isFinite(e))return;if(this.spectralType===Ni.SpectralType.FREQ&&this.spectralUnit===Ni.SpectralUnit.MHZ)return e;const t=Di.transformSpectralPoint(this.spectralFrame,Ni.SpectralType.FREQ,Ni.SpectralUnit.MHZ,this.spectralSystem,e,!1);if(!isFinite(t))return;const i=this.astSpectralTransform(this.spectralType,this.spectralUnit,this.spectralSystem,t);return isFinite(i)?i:void 0},this.findChannelIndexByValue=e=>{if(null!==e&&void 0!==e&&isFinite(e)&&this.channelInfo){if(this.isCoordChannel)return this.channelInfo.getChannelIndexSimple(e);if(this.spectralAxis&&!this.spectralAxis.valid||this.isSpectralPropsEqual)return this.channelInfo.getChannelIndexWCS(e);{const t=Di.transformSpectralPoint(this.spectralFrame,this.spectralType,this.spectralUnit,this.spectralSystem,e,!1);return this.channelInfo.getChannelIndexWCS(t)}}},Object(j.a)(this,"initSupportedSpectralConversion",ai,this),Object(j.a)(this,"initCenter",li,this),Object(j.a)(this,"updateCursorRegion",ci,this),Object(j.a)(this,"fitZoom",di,this),Object(j.a)(this,"setAnimationRange",ui,this),Object(j.a)(this,"setRasterRenderType",hi,this),Object(j.a)(this,"startMoving",pi,this),Object(j.a)(this,"endMoving",gi,this),Object(j.a)(this,"applyContours",fi,this),Object(j.a)(this,"clearContours",bi,this),Object(j.a)(this,"setSpatialReference",mi,this),Object(j.a)(this,"clearSpatialReference",yi,this),Object(j.a)(this,"addSecondarySpatialImage",Oi,this),Object(j.a)(this,"removeSecondarySpatialImage",ji,this),Object(j.a)(this,"setSpectralReference",Si,this),Object(j.a)(this,"clearSpectralReference",xi,this),Object(j.a)(this,"addSecondarySpectralImage",Ci,this),Object(j.a)(this,"removeSecondarySpectralImage",Ii,this),Object(j.a)(this,"setRasterScalingReference",wi,this),Object(j.a)(this,"addSecondaryRasterScalingImage",Ti,this),Object(j.a)(this,"removeSecondaryRasterScalingImage",vi,this),Object(j.a)(this,"addMomentImage",Ai,this),Object(j.a)(this,"removeMomentImage",Ri,this),Object(j.a)(this,"setIsRequestingMoments",Pi,this),Object(j.a)(this,"updateRequestingMomentsProgress",Ei,this),Object(j.a)(this,"resetMomentRequestState",Fi,this),Object(x.p)(this),this.overlayStore=wo.Instance,this.logStore=Ui.Instance,this.backendService=oe.b.Instance;const i=Ja.Instance;this.astFrameSet=null,this.spectralFrame=null,this.spectralType=null,this.spectralUnit=null,this.spectralSystem=null,this.channelValues=null,this.spectralCoordsSupported=null,this.spectralSystemsSupported=null,this.wcsInfo=null,this.wcsInfoForTransformation=null,this.wcsInfo3D=null,this.validWcs=!1,this.frameInfo=t,this.renderHiDPI=!0,this.center={x:0,y:0},this.stokes=0,this.channel=0,this.requiredStokes=0,this.requiredChannel=0,this.renderConfig=new Fo.b(i,this),this.contourConfig=new ke(i),this.contourStores=new Map,this.renderType=_i.NONE,this.moving=!1,this.zooming=!1,this.overlayBeamSettings=new Co,this.spatialTransformAST=null,this.controlMaps=new Map,this.secondarySpatialImages=[],this.secondarySpectralImages=[],this.secondaryRasterScalingImages=[],this.momentImages=[],this.isRequestingMoments=!1,this.requestingMomentsProgress=0;const n=i.astColor;n!==this.overlayStore.global.color&&this.overlayStore.global.setColor(n);const r=i.astGridVisible;r!==this.overlayStore.grid.visible&&this.overlayStore.grid.setVisible(r);const o=i.astLabelsVisible;o!==this.overlayStore.labels.visible&&this.overlayStore.labels.setVisible(o),this.frameRegionSet=new Fa(this,Ja.Instance,oe.b.Instance),this.valid=!0,this.currentFrameView={xMin:0,xMax:0,yMin:0,yMax:0,mip:999},this.animationChannelRange=[0,t.fileInfoExtended.depth-1],this.astFrameSet=this.initFrame(),this.astFrameSet?(this.spectralAxis&&this.spectralAxis.valid&&(this.spectralFrame=Di.getSpectralFrame(this.astFrameSet)),t.fileInfoExtended.depth>1?(this.wcsInfo3D=Di.copy(this.astFrameSet),this.wcsInfo=Di.getSkyFrameSet(this.astFrameSet)):this.wcsInfo=Di.copy(this.astFrameSet),this.wcsInfo&&(this.wcsInfoForTransformation=Di.copy(this.wcsInfo),Di.set(this.wcsInfoForTransformation,`Format(1)=${ne.a.Instance.overlayStore.numbers.formatTypeX}.${zi}`),Di.set(this.wcsInfoForTransformation,`Format(2)=${ne.a.Instance.overlayStore.numbers.formatTypeY}.${zi}`),this.validWcs=!0,this.overlayStore.setDefaultsFromAST(this))):(this.logStore.addWarning(`Problem processing WCS info in file ${this.filename}`,["ast"]),this.wcsInfo=Di.initDummyFrame()),this.initSupportedSpectralConversion(),this.initCenter(),this.zoomLevel=i.isZoomRAWMode?1:this.zoomLevelForFit,this.spectralAxis&&Object(Ni.IsSpectralTypeSupported)(this.spectralAxis.type.code)&&Object(Ni.IsSpectralUnitSupported)(this.spectralAxis.type.unit)&&(this.spectralType=this.spectralAxis.type.code,this.spectralUnit=Ni.SPECTRAL_DEFAULT_UNIT.get(this.spectralType)),this.isSpectralSystemConvertible&&(this.spectralSystem=this.spectralInfo.specsys),this.cursorInfo=this.getCursorInfo(this.center),this.cursorValue={position:{x:NaN,y:NaN},channel:0,value:NaN},Object(x.h)((()=>{this.isRenderable&&this.zoomLevel<=0&&this.setZoom(this.zoomLevelForFit)})),Object(x.h)((()=>{const e=this.spectralType,t=this.spectralUnit;this.spectralSystem;this.channelInfo&&(e||t?this.isCoordChannel?this.channelValues=this.channelInfo.indexes:this.channelValues=this.isSpectralPropsEqual?this.channelInfo.values:this.convertSpectral(this.channelInfo.values):this.channelValues=this.channelInfo.values)}))}sanitizeChannelNumber(e){return isFinite(e)?Math.round(Object(B.k)(e,0,this.frameInfo.fileInfoExtended.depth-1)):this.requiredChannel}getCursorInfo(t){let i,n;if(this.validWcs){const r=[[0,0],[1,1],[-1,-1]].map((e=>Object(B.nb)(this.wcsInfo,{x:t.x+e[0],y:t.y+e[1]})));i=r[0];const o=r.map((e=>Di.normalizeCoordinates(this.wcsInfo,e.x,e.y)));let s=0,a=0;for(;s<e.CursorInfoMaxPrecision&&a<e.CursorInfoMaxPrecision;){let e=new go;e.add("Format(1)",this.overlayStore.numbers.cursorFormatStringX(s)),e.add("Format(2)",this.overlayStore.numbers.cursorFormatStringY(a)),e.add("System",this.overlayStore.global.explicitSystem);let t=o.map((t=>Di.getFormattedCoordinates(this.wcsInfo,t.x,t.y,e.toString())),!0),[i,r,l]=t;if(!i.x||!i.y||"<bad>"===i.x||"<bad>"===i.y){n=null;break}if(i.x!==r.x&&i.x!==l.x&&i.y!==r.y&&i.y!==l.y){n={x:i.x,y:i.y};break}i.x!==r.x&&i.x!==l.x||(s+=1),i.y!==r.y&&i.y!==l.y||(a+=1)}}const r=Math.round(t.x),o=Math.round(t.y),s=r>=0&&r<this.frameInfo.fileInfoExtended.width&&o>=0&&o<this.frameInfo.fileInfoExtended.height;return{posImageSpace:t,isInsideImage:s,posWCS:i,infoWCS:n}}getControlMap(e){const t=Ja.Instance;let i=this.controlMaps.get(e);if(!i){const n=performance.now();i=new Ni.ControlMap(this,e,-1,t.contourControlMapWidth,t.contourControlMapWidth),this.controlMaps.set(e,i);const r=performance.now()-n;console.log(`Created ${t.contourControlMapWidth}x${t.contourControlMapWidth} transform grid for ${this.frameInfo.fileId} -> ${e.frameInfo.fileId} in ${r} ms`)}return i}removeControlMap(e){const t=oe.d.Instance.gl,i=this.controlMaps.get(e);if(i&&t&&i.hasTextureForContext(t)){const e=i.getTextureX(t);t.deleteTexture(e)}this.controlMaps.delete(e)}getWcsSizeInArcsec(e){const t=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CDELT1"))),i=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CUNIT1")));if(e&&t&&i){const n=Object(B.D)(t),r=i.value.trim();if(isFinite(n)&&("deg"===r||"rad"===r))return{x:e.x*Math.abs(n)*("deg"===r?3600:648e3/Math.PI),y:e.y*Math.abs(n)*("deg"===r?3600:648e3/Math.PI)}}return null}getImageValueFromArcsec(e){const t=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CDELT1"))),i=this.frameInfo.fileInfoExtended.headerEntries.find((e=>-1!==e.name.indexOf("CUNIT1")));if(isFinite(e)&&t&&i){const n=Object(B.D)(t),r=i.value.trim();if(isFinite(n)&&0!==n&&("deg"===r||"rad"===r))return e/Math.abs(n)/("deg"===r?3600:648e3/Math.PI)}return null}getRegionWcsProperties(e){if(!this.validWcs||!isFinite(e.center.x)||!isFinite(e.center.y))return"Invalid";const t=Object(B.C)(this.wcsInfoForTransformation,e.center);if(!t)return"Invalid";const i=e.regionId===Li.k.CURSOR?`${this.cursorInfo.infoWCS.x}, ${this.cursorInfo.infoWCS.y}`:`${t.x}, ${t.y}`,n=this.getWcsSizeInArcsec(e.size),r=n?{x:Object(B.u)(n.x,zi),y:Object(B.u)(n.y,zi)}:null,o=wo.Instance.global.explicitSystem;switch(e.regionType){case V.a.RegionType.POINT:return`Point (wcs:${o}) [${i}]`;case V.a.RegionType.RECTANGLE:return`rotbox(wcs:${o})[[${i}], [${r.x}, ${r.y}], ${Object(B.mb)(e.rotation,6)}deg]`;case V.a.RegionType.ELLIPSE:return`ellipse(wcs:${o})[[${i}], [${r.x}, ${r.y}], ${Object(B.mb)(e.rotation,6)}deg]`;case V.a.RegionType.POLYGON:let t=`poly(wcs:${o})[`;return e.controlPoints.forEach(((i,n)=>{const r=isFinite(i.x)&&isFinite(i.y)?Object(B.C)(this.wcsInfoForTransformation,i):null;t+=r?`[${r.x}, ${r.y}]`:"[Invalid]",t+=n!==e.controlPoints.length-1?", ":"]"})),t;default:return"Not Implemented"}}updateFromContourData(e){const t=Ni.ProtobufProcessing.ProcessContourData(e);this.stokes=t.stokes,this.channel=t.channel;Y.Instance.serverAnimationActive&&(this.requiredChannel=t.channel,this.requiredStokes=t.stokes);for(const i of t.contourSets){let e=this.contourStores.get(i.level);e||(e=new se,this.contourStores.set(i.level,e)),!e.isComplete&&t.progress>0?e.addContourData(i.indexOffsets,i.coordinates,t.progress):e.setContourData(i.indexOffsets,i.coordinates,t.progress)}this.contourStores.forEach(((e,t)=>{-1===this.contourConfig.levels.indexOf(t)&&this.contourStores.delete(t)}))}setChannels(e,t,i){const n=this.sanitizeChannelNumber(e);this.requiredStokes!==t&&(this.renderConfig.setUseCubeHistogram(!1),this.renderConfig.updateCubeHistogram(null,0)),this.requiredChannel=n,this.requiredStokes=t,i&&this.spectralSiblings.forEach((e=>{const t=Object(B.J)(this.wcsInfo3D,e.wcsInfo3D,Ja.Instance.spectralMatchingType,n);e.setChannels(t,e.requiredStokes,!1)}))}incrementChannels(e,t,i=!0){const n=Math.max(1,this.frameInfo.fileInfoExtended.depth),r=Math.max(1,this.frameInfo.fileInfoExtended.stokes);let o=this.requiredChannel+e,s=this.requiredStokes+t;i?(o=(o+n)%n,s=(s+r)%r):(o=Object(B.k)(o,0,n-1),s=Object(B.k)(s,0,r-1)),this.setChannels(o,s,!0)}setZoom(e,t=!1){if(this.spatialReference){const i=t?e:e/this.spatialTransform.scale;this.spatialReference.setZoom(i)}else this.zoomLevel=e,this.replaceZoomTimeoutHandler(),this.zooming=!0}setCenter(e,t){if(this.spatialReference){const i=this.spatialTransform.transformCoordinate({x:e,y:t},!0);this.spatialReference.setCenter(i.x,i.y)}else this.center={x:e,y:t}}setCursorPosition(e){if(this.spatialReference)this.spatialReference.setCursorPosition(Object(B.nb)(this.spatialTransformAST,e,!0));else{this.cursorInfo=this.getCursorInfo(e);for(const t of this.secondarySpatialImages){const i=Object(B.nb)(t.spatialTransformAST,e,!1);t.cursorInfo=t.getCursorInfo(i)}}}setCursorValue(e,t,i){this.cursorValue={position:e,channel:t,value:i}}zoomToPoint(e,t,i,n=!1){if(this.spatialReference){const r=n?i:i/this.spatialTransform.scale,o=Object(B.nb)(this.spatialTransformAST,{x:e,y:t},!0);this.spatialReference.zoomToPoint(o.x,o.y,r)}else Ja.Instance.zoomPoint===Ni.ZoomPoint.CURSOR&&(this.center={x:e+this.zoomLevel/i*(this.center.x-e),y:t+this.zoomLevel/i*(this.center.y-t)}),this.setZoom(i)}clearRasterScalingReference(){this.rasterScalingReference&&(this.rasterScalingReference.removeSecondaryRasterScalingImage(this),this.rasterScalingReference=null)}},Mi.CursorInfoMaxPrecision=25,Mi.ZoomInertiaDuration=250,Mi.ShiftASTCoords=(e,t)=>{if(e.name.match(/CRPIX\d+/)){const t=parseFloat(e.value);if(isFinite(t))return(t-1).toString()}return t},wt=ki,Tt=Object(S.a)(wt.prototype,"frameRegionSet",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Object(S.a)(wt.prototype,"frameInfo",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Object(S.a)(wt.prototype,"renderHiDPI",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rt=Object(S.a)(wt.prototype,"spectralType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=Object(S.a)(wt.prototype,"spectralUnit",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=Object(S.a)(wt.prototype,"spectralSystem",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ft=Object(S.a)(wt.prototype,"channelValues",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mt=Object(S.a)(wt.prototype,"center",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=Object(S.a)(wt.prototype,"cursorInfo",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dt=Object(S.a)(wt.prototype,"cursorValue",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(S.a)(wt.prototype,"zoomLevel",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=Object(S.a)(wt.prototype,"stokes",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=Object(S.a)(wt.prototype,"channel",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=Object(S.a)(wt.prototype,"requiredStokes",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wt=Object(S.a)(wt.prototype,"requiredChannel",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=Object(S.a)(wt.prototype,"animationChannelRange",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=Object(S.a)(wt.prototype,"renderType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bt=Object(S.a)(wt.prototype,"currentFrameView",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ht=Object(S.a)(wt.prototype,"currentCompressionQuality",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qt=Object(S.a)(wt.prototype,"renderConfig",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yt=Object(S.a)(wt.prototype,"contourConfig",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ut=Object(S.a)(wt.prototype,"contourStores",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xt=Object(S.a)(wt.prototype,"valid",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$t=Object(S.a)(wt.prototype,"moving",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kt=Object(S.a)(wt.prototype,"zooming",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qt=Object(S.a)(wt.prototype,"overlayBeamSettings",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zt=Object(S.a)(wt.prototype,"spatialReference",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jt=Object(S.a)(wt.prototype,"spectralReference",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ei=Object(S.a)(wt.prototype,"rasterScalingReference",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=Object(S.a)(wt.prototype,"secondarySpatialImages",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=Object(S.a)(wt.prototype,"secondarySpectralImages",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=Object(S.a)(wt.prototype,"secondaryRasterScalingImages",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri=Object(S.a)(wt.prototype,"momentImages",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oi=Object(S.a)(wt.prototype,"isRequestingMoments",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),si=Object(S.a)(wt.prototype,"requestingMomentsProgress",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(wt.prototype,"filename",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"filename"),wt.prototype),Object(S.a)(wt.prototype,"regionSet",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"regionSet"),wt.prototype),Object(S.a)(wt.prototype,"sharedRegions",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"sharedRegions"),wt.prototype),Object(S.a)(wt.prototype,"requiredFrameView",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"requiredFrameView"),wt.prototype),Object(S.a)(wt.prototype,"spatialTransform",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spatialTransform"),wt.prototype),Object(S.a)(wt.prototype,"transformedWcsInfo",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"transformedWcsInfo"),wt.prototype),Object(S.a)(wt.prototype,"renderWidth",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"renderWidth"),wt.prototype),Object(S.a)(wt.prototype,"renderHeight",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"renderHeight"),wt.prototype),Object(S.a)(wt.prototype,"isRenderable",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"isRenderable"),wt.prototype),Object(S.a)(wt.prototype,"unit",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"unit"),wt.prototype),Object(S.a)(wt.prototype,"beamProperties",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"beamProperties"),wt.prototype),Object(S.a)(wt.prototype,"hasVisibleBeam",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"hasVisibleBeam"),wt.prototype),Object(S.a)(wt.prototype,"channelInfo",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"channelInfo"),wt.prototype),Object(S.a)(wt.prototype,"spectralInfo",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spectralInfo"),wt.prototype),Object(S.a)(wt.prototype,"simpleSpectralInfo",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"simpleSpectralInfo"),wt.prototype),Object(S.a)(wt.prototype,"spectralAxis",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spectralAxis"),wt.prototype),Object(S.a)(wt.prototype,"isSpectralCoordinateConvertible",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"isSpectralCoordinateConvertible"),wt.prototype),Object(S.a)(wt.prototype,"isSpectralSystemConvertible",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"isSpectralSystemConvertible"),wt.prototype),Object(S.a)(wt.prototype,"isSpectralPropsEqual",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"isSpectralPropsEqual"),wt.prototype),Object(S.a)(wt.prototype,"isCoordChannel",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"isCoordChannel"),wt.prototype),Object(S.a)(wt.prototype,"nativeSpectralCoordinate",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"nativeSpectralCoordinate"),wt.prototype),Object(S.a)(wt.prototype,"spectralCoordinate",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spectralCoordinate"),wt.prototype),Object(S.a)(wt.prototype,"spectralUnitStr",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spectralUnitStr"),wt.prototype),Object(S.a)(wt.prototype,"hasStokes",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"hasStokes"),wt.prototype),Object(S.a)(wt.prototype,"numChannels",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"numChannels"),wt.prototype),Object(S.a)(wt.prototype,"channelValueBounds",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"channelValueBounds"),wt.prototype),Object(S.a)(wt.prototype,"spectralSiblings",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spectralSiblings"),wt.prototype),Object(S.a)(wt.prototype,"spatialSiblings",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"spatialSiblings"),wt.prototype),Object(S.a)(wt.prototype,"renderConfigSiblings",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"renderConfigSiblings"),wt.prototype),Object(S.a)(wt.prototype,"isCursorValueCurrent",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"isCursorValueCurrent"),wt.prototype),Object(S.a)(wt.prototype,"zoomLevelForFit",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"zoomLevelForFit"),wt.prototype),Object(S.a)(wt.prototype,"calculateZoomX",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"calculateZoomX"),wt.prototype),Object(S.a)(wt.prototype,"calculateZoomY",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"calculateZoomY"),wt.prototype),Object(S.a)(wt.prototype,"contourProgress",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"contourProgress"),wt.prototype),Object(S.a)(wt.prototype,"stokesInfo",[x.i],Object.getOwnPropertyDescriptor(wt.prototype,"stokesInfo"),wt.prototype),ai=Object(S.a)(wt.prototype,"initSupportedSpectralConversion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.spectralAxis&&!this.spectralAxis.valid)return this.channelValues=this.channelInfo.values,this.spectralCoordsSupported=new Map([[this.nativeSpectralCoordinate,{type:null,unit:null}],[Ni.SPECTRAL_TYPE_STRING.get(Ni.SpectralType.CHANNEL),{type:Ni.SpectralType.CHANNEL,unit:null}]]),void(this.spectralSystemsSupported=[]);if(!this.spectralAxis||!this.spectralFrame)return this.spectralCoordsSupported=null,void(this.spectralSystemsSupported=null);const e=this.frameInfo.fileInfoExtended.headerEntries,t=this.spectralInfo.channelType.code;if(Object(Ni.IsSpectralTypeSupported)(t)){e.find((e=>-1!==e.name.indexOf("RESTFRQ")))?this.spectralCoordsSupported=Ni.SPECTRAL_COORDS_SUPPORTED:(this.spectralCoordsSupported=new Map,Array.from(Ni.SPECTRAL_COORDS_SUPPORTED.keys()).forEach((e=>{const i=Ni.SPECTRAL_COORDS_SUPPORTED.get(e),n=t===Ni.SpectralType.VRAD||t===Ni.SpectralType.VOPT,r=i.type===Ni.SpectralType.VRAD||i.type===Ni.SpectralType.VOPT;n&&r&&this.spectralCoordsSupported.set(e,i),n||r||this.spectralCoordsSupported.set(e,i)})),this.spectralCoordsSupported.set(Ni.SPECTRAL_TYPE_STRING.get(Ni.SpectralType.CHANNEL),{type:Ni.SpectralType.CHANNEL,unit:null}))}else this.spectralCoordsSupported=new Map([[Ni.SPECTRAL_TYPE_STRING.get(Ni.SpectralType.CHANNEL),{type:Ni.SpectralType.CHANNEL,unit:null}]]);const i=this.spectralInfo.specsys;if(Object(Ni.IsSpectralSystemSupported)(i)){const t=e.find((e=>-1!==e.name.indexOf("DATE-OBS"))),n=e.find((e=>-1!==e.name.indexOf("OBSGEO-X"))),r=e.find((e=>-1!==e.name.indexOf("OBSGEO-Y"))),o=e.find((e=>-1!==e.name.indexOf("OBSGEO-Z")));i===Ni.SpectralSystem.LSRK||i===Ni.SpectralSystem.LSRD?this.spectralSystemsSupported=t&&n&&r&&o?[Ni.SpectralSystem.LSRK,Ni.SpectralSystem.LSRD,Ni.SpectralSystem.BARY,Ni.SpectralSystem.TOPO]:!t||n&&r&&o?[Ni.SpectralSystem.LSRK,Ni.SpectralSystem.LSRD]:[Ni.SpectralSystem.LSRK,Ni.SpectralSystem.LSRD,Ni.SpectralSystem.BARY]:i===Ni.SpectralSystem.BARY?this.spectralSystemsSupported=t&&n&&r&&o?[Ni.SpectralSystem.LSRK,Ni.SpectralSystem.LSRD,Ni.SpectralSystem.BARY,Ni.SpectralSystem.TOPO]:!t||n&&r&&o?[Ni.SpectralSystem.BARY]:[Ni.SpectralSystem.LSRK,Ni.SpectralSystem.LSRD,Ni.SpectralSystem.BARY]:this.spectralSystemsSupported=t&&n&&r&&o?[Ni.SpectralSystem.LSRK,Ni.SpectralSystem.LSRD,Ni.SpectralSystem.BARY,Ni.SpectralSystem.TOPO]:[Ni.SpectralSystem.TOPO]}else this.spectralSystemsSupported=[]}}}),li=Object(S.a)(wt.prototype,"initCenter",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.center.x=(this.frameInfo.fileInfoExtended.width-1)/2,this.center.y=(this.frameInfo.fileInfoExtended.height-1)/2}}}),Object(S.a)(wt.prototype,"updateFromContourData",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"updateFromContourData"),wt.prototype),Object(S.a)(wt.prototype,"setChannels",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"setChannels"),wt.prototype),Object(S.a)(wt.prototype,"incrementChannels",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"incrementChannels"),wt.prototype),Object(S.a)(wt.prototype,"setZoom",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"setZoom"),wt.prototype),Object(S.a)(wt.prototype,"setCenter",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"setCenter"),wt.prototype),Object(S.a)(wt.prototype,"setCursorPosition",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"setCursorPosition"),wt.prototype),Object(S.a)(wt.prototype,"setCursorValue",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"setCursorValue"),wt.prototype),ci=Object(S.a)(wt.prototype,"updateCursorRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.spatialReference){const t=Object(B.nb)(this.spatialTransformAST,e,!0);this.spatialReference.updateCursorRegion(t)}else{var t;null===(t=this.frameRegionSet.regions)||void 0===t||t[0].setCenter(e)}for(const n of this.secondarySpatialImages){var i;const t=Object(B.nb)(n.spatialTransformAST,e,!1);null===(i=n.frameRegionSet.regions)||void 0===i||i[0].setCenter(t)}}}}),Object(S.a)(wt.prototype,"zoomToPoint",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"zoomToPoint"),wt.prototype),di=Object(S.a)(wt.prototype,"fitZoom",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.spatialReference){this.initCenter();const e=Object(B.nb)(this.spatialTransformAST,this.center,!0);this.spatialReference.setCenter(e.x,e.y);const t=[this.spatialTransform.transformCoordinate({x:0,y:0},!0),this.spatialTransform.transformCoordinate({x:0,y:this.frameInfo.fileInfoExtended.height},!0),this.spatialTransform.transformCoordinate({x:this.frameInfo.fileInfoExtended.width,y:this.frameInfo.fileInfoExtended.height},!0),this.spatialTransform.transformCoordinate({x:this.frameInfo.fileInfoExtended.width,y:0},!0)],{minPoint:i,maxPoint:n}=Object(B.T)(t),r=n.x-i.x,o=n.y-i.y,s=this.renderHiDPI?devicePixelRatio:1,a=this.spatialReference.renderWidth*s/r,l=this.spatialReference.renderHeight*s/o;this.spatialReference.setZoom(Math.min(a,l),!0)}else this.zoomLevel=this.zoomLevelForFit,this.initCenter()}}}),ui=Object(S.a)(wt.prototype,"setAnimationRange",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.animationChannelRange=e}}}),hi=Object(S.a)(wt.prototype,"setRasterRenderType",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.renderType=e}}}),pi=Object(S.a)(wt.prototype,"startMoving",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.moving=!0}}}),gi=Object(S.a)(wt.prototype,"endMoving",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.moving=!1}}}),fi=Object(S.a)(wt.prototype,"applyContours",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(!this.contourConfig||!this.renderConfig)return;const e=Ja.Instance;this.contourConfig.setEnabled(!0);const t={fileId:this.frameInfo.fileId,referenceFileId:this.frameInfo.fileId,smoothingMode:this.contourConfig.smoothingMode,smoothingFactor:this.contourConfig.smoothingFactor,levels:this.contourConfig.levels,imageBounds:{xMin:0,xMax:this.frameInfo.fileInfoExtended.width,yMin:0,yMax:this.frameInfo.fileInfoExtended.height},decimationFactor:e.contourDecimation,compressionLevel:e.contourCompressionLevel,contourChunkSize:e.contourChunkSize};this.backendService.setContourParameters(t)}}}),bi=Object(S.a)(wt.prototype,"clearContours",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e=!0)=>{if(this.contourStores.forEach((e=>e.clearData())),this.contourStores.clear(),e){const e={fileId:this.frameInfo.fileId,referenceFileId:this.frameInfo.fileId};this.backendService.setContourParameters(e)}this.contourConfig.setEnabled(!1)}}}),mi=Object(S.a)(wt.prototype,"setSpatialReference",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{var t;if(e===this)return console.log("Skipping spatial self-reference"),this.clearSpatialReference(),!1;if(this.validWcs!==e.validWcs)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,!1;console.log(`Setting spatial reference for file ${this.frameInfo.fileId} to ${e.frameInfo.fileId}`),this.spatialReference=e;const i=Di.copy(this.wcsInfo),n=Di.copy(e.wcsInfo);if(Di.invert(i),Di.invert(n),this.spatialTransformAST=Di.convert(i,n,""),Di.delete(i),Di.delete(n),!this.spatialTransformAST)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,!1;this.spatialReference=e;const r=this.spatialTransform;if(!isFinite(r.rotation)||!isFinite(r.scale)||!isFinite(r.translation.x)||!isFinite(r.translation.y)||!isFinite(r.origin.x)||!isFinite(r.origin.y))return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}`),this.spatialReference=null,Di.delete(this.spatialTransformAST),this.spatialTransformAST=null,!1;this.spatialReference.addSecondarySpatialImage(this);const o=null===(t=this.spatialReference.cursorInfo)||void 0===t?void 0:t.posImageSpace;if(o){const e=Object(B.nb)(this.spatialTransformAST,o,!1);this.cursorInfo=this.getCursorInfo(e)}this.spatialReference.frameRegionSet.migrateRegionsFromExistingSet(this.frameRegionSet,this.spatialTransformAST,!0);for(const s of this.frameRegionSet.regions)this.frameRegionSet.deleteRegion(s);return!0}}}),yi=Object(S.a)(wt.prototype,"clearSpatialReference",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spatialReference&&(this.frameRegionSet.migrateRegionsFromExistingSet(this.spatialReference.frameRegionSet,this.spatialTransformAST),this.center=this.spatialTransform.transformCoordinate(this.spatialReference.center,!1),this.zoomLevel=this.spatialReference.zoomLevel*this.spatialTransform.scale,this.spatialReference.removeSecondarySpatialImage(this),this.spatialReference=null),this.spatialTransformAST&&Di.delete(this.spatialTransformAST),this.spatialTransformAST=null;const e=oe.d.Instance.gl;e&&this.controlMaps.forEach((t=>{if(t.hasTextureForContext(e)){const i=t.getTextureX(e);e.deleteTexture(i)}})),this.controlMaps.forEach(((e,t)=>{this.removeControlMap(t)})),this.controlMaps.clear()}}}),Oi=Object(S.a)(wt.prototype,"addSecondarySpatialImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpatialImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))||this.secondarySpatialImages.push(e)}}}),ji=Object(S.a)(wt.prototype,"removeSecondarySpatialImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpatialImages=this.secondarySpatialImages.filter((t=>t.frameInfo.fileId!==e.frameInfo.fileId))}}}),Si=Object(S.a)(wt.prototype,"setSpectralReference",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this)return this.clearSpatialReference(),console.log("Skipping spectral self-reference"),!1;if(console.log(`Setting spectral reference for file ${this.frameInfo.fileId} to ${e.frameInfo.fileId}`),!this.wcsInfo3D||!e.wcsInfo3D)return console.log(`Error creating spectral transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}. One of the files is missing spectral information`),this.spectralReference=null,!1;const t=Di.copy(this.wcsInfo3D),i=Di.copy(e.wcsInfo3D),n=Ja.Instance;if(n.spectralMatchingType!==Ni.SpectralType.CHANNEL&&(Di.set(t,`AlignSystem=${n.spectralMatchingType}`),Di.set(i,`AlignSystem=${n.spectralMatchingType}`)),Di.invert(t),Di.invert(i),this.spectralTransformAST=Di.convert(t,i,""),Di.delete(t),Di.delete(i),!this.spectralTransformAST)return console.log(`Error creating spatial transform between files ${this.frameInfo.fileId} and ${e.frameInfo.fileId}. Could not create AST transform`),this.spectralReference=null,!1;this.spectralReference=e,this.spectralReference.addSecondarySpectralImage(this);const r=Object(B.J)(e.wcsInfo3D,this.wcsInfo3D,n.spectralMatchingType,e.requiredChannel);return this.setChannels(r,this.requiredStokes,!1),!0}}}),xi=Object(S.a)(wt.prototype,"clearSpectralReference",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.spectralReference&&(this.spectralReference.removeSecondarySpectralImage(this),this.spectralReference=null),this.spectralTransformAST&&Di.delete(this.spectralTransformAST),this.spectralTransformAST=null}}}),Ci=Object(S.a)(wt.prototype,"addSecondarySpectralImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpectralImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))||this.secondarySpectralImages.push(e)}}}),Ii=Object(S.a)(wt.prototype,"removeSecondarySpectralImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondarySpectralImages=this.secondarySpectralImages.filter((t=>t.frameInfo.fileId!==e.frameInfo.fileId))}}}),wi=Object(S.a)(wt.prototype,"setRasterScalingReference",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e===this)return this.clearRasterScalingReference(),void console.log("Skipping RenderConfig self-reference");this.rasterScalingReference=e,this.rasterScalingReference.addSecondaryRasterScalingImage(this),this.renderConfig.updateFrom(e.renderConfig)}}}),Object(S.a)(wt.prototype,"clearRasterScalingReference",[x.g],Object.getOwnPropertyDescriptor(wt.prototype,"clearRasterScalingReference"),wt.prototype),Ti=Object(S.a)(wt.prototype,"addSecondaryRasterScalingImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryRasterScalingImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))||this.secondaryRasterScalingImages.push(e)}}}),vi=Object(S.a)(wt.prototype,"removeSecondaryRasterScalingImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.secondaryRasterScalingImages=this.secondaryRasterScalingImages.filter((t=>t.frameInfo.fileId!==e.frameInfo.fileId))}}}),Ai=Object(S.a)(wt.prototype,"addMomentImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&!this.momentImages.find((t=>t.frameInfo.fileId===e.frameInfo.fileId))&&this.momentImages.push(e)}}}),Ri=Object(S.a)(wt.prototype,"removeMomentImage",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.momentImages=[]}}}),Pi=Object(S.a)(wt.prototype,"setIsRequestingMoments",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.isRequestingMoments=e}}}),Ei=Object(S.a)(wt.prototype,"updateRequestingMomentsProgress",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.requestingMomentsProgress=e}}}),Fi=Object(S.a)(wt.prototype,"resetMomentRequestState",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.setIsRequestingMoments(!1),this.updateRequestingMomentsProgress(0)}}}),wt);var Gi,Vi,Bi,Hi,qi,Yi;let Ui=(Yi=qi=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(j.a)(this,"logEntries",Vi,this),Object(j.a)(this,"hiddenTags",Bi,this),Object(j.a)(this,"logLevel",Hi,this),this.logLimit=1e3,Object(x.p)(this),this.logEntries=[],this.hiddenTags=[],this.logLevel=V.a.ErrorSeverity.INFO}get newestMsg(){return this.logEntries.length>0?this.logEntries[this.logEntries.length-1].message:""}addLog(e){this.logEntries.push(e),this.logEntries.length>this.logLimit&&this.logEntries.shift()}addDebug(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.DEBUG})}addInfo(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.INFO})}addWarning(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.WARNING})}addError(e,t=[],i=""){this.addLog({message:e,title:i,tags:t,level:V.a.ErrorSeverity.ERROR})}toggleTag(e){-1===this.hiddenTags.indexOf(e)?this.hiddenTags.push(e):this.hiddenTags=this.hiddenTags.filter((t=>t!==e))}setLevel(e){this.logLevel=e}clearLog(){this.logEntries=[]}},qi.staticInstance=void 0,Gi=Yi,Vi=Object(S.a)(Gi.prototype,"logEntries",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bi=Object(S.a)(Gi.prototype,"hiddenTags",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hi=Object(S.a)(Gi.prototype,"logLevel",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(Gi.prototype,"newestMsg",[x.i],Object.getOwnPropertyDescriptor(Gi.prototype,"newestMsg"),Gi.prototype),Object(S.a)(Gi.prototype,"addLog",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"addLog"),Gi.prototype),Object(S.a)(Gi.prototype,"addDebug",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"addDebug"),Gi.prototype),Object(S.a)(Gi.prototype,"addInfo",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"addInfo"),Gi.prototype),Object(S.a)(Gi.prototype,"addWarning",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"addWarning"),Gi.prototype),Object(S.a)(Gi.prototype,"addError",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"addError"),Gi.prototype),Object(S.a)(Gi.prototype,"toggleTag",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"toggleTag"),Gi.prototype),Object(S.a)(Gi.prototype,"setLevel",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"setLevel"),Gi.prototype),Object(S.a)(Gi.prototype,"clearLog",[x.g],Object.getOwnPropertyDescriptor(Gi.prototype,"clearLog"),Gi.prototype),Gi);var Xi,$i,Ki,Qi,Zi,Ji,en,tn,nn,rn,on,sn,an,ln,cn,dn,un,hn,pn,gn,fn,bn,mn,yn,On,jn,Sn,xn,Cn,In,wn,Tn,vn,An,Rn,Pn,En,Fn,Mn,kn,Dn,Nn,Ln,_n,zn,Wn,Gn,Vn,Bn,Hn,qn,Yn,Un,Xn,$n,Kn,Qn,Zn,Jn,er,tr,ir,nr,rr,or,sr,ar,lr,cr,dr,ur,hr,pr,gr,fr,br,mr,yr,Or,jr,Sr,xr,Cr,Ir,wr,Tr,vr,Ar,Rr,Pr,Er,Fr,Mr,kr,Dr,Nr,Lr,_r,zr,Wr,Gr,Vr,Br,Hr,qr,Yr,Ur,Xr,$r,Kr,Qr,Zr,Jr,eo,to,io,no,ro,oo=i(74);const so=[oo.a.BLACK,oo.a.WHITE,oo.a.RED2,oo.a.FOREST3,oo.a.BLUE2,oo.a.TURQUOISE2,oo.a.VIOLET2,oo.a.GOLD2,oo.a.GRAY2],ao=[oo.a.BLACK,oo.a.WHITE,oo.a.RED4,oo.a.FOREST4,oo.a.BLUE4,oo.a.TURQUOISE4,oo.a.VIOLET4,oo.a.GOLD4,oo.a.GRAY4];let lo,co,uo;!function(e){e.Interior="Interior",e.Exterior="Exterior"}(lo||(lo={})),function(e){e.Auto="AUTO",e.Ecliptic="ECLIPTIC",e.FK4="FK4",e.FK5="FK5",e.Galactic="GALACTIC",e.ICRS="ICRS"}(co||(co={})),function(e){e.HMS="hms",e.DMS="dms",e.Degrees="d"}(uo||(uo={}));const ho=new Map([[uo.HMS,"H:M:S"],[uo.DMS,"D:M:S"],[uo.Degrees,"Degrees"]]);let po;!function(e){e.Open="open",e.Solid="solid"}(po||(po={}));class go{constructor(){this.stringList=void 0,this.stringList=[]}add(e,t,i=!0){if(void 0!==t&&i){let i="boolean"===typeof t?t?1:0:t;this.stringList.push(`${e}=${i}`)}}addSection(e){void 0!==e&&this.stringList.push(e)}toString(){return this.stringList.filter((e=>e.length>0)).join(", ")}}let fo=(Xi=class{get styleString(){let e=new go;return e.add("Labelling",this.labelType),e.add("Color",this.color),e.add("Tol",Object(B.mb)(this.tolerance/100,2),this.tolerance>=.001),e.add("System",this.explicitSystem),e.toString()}get explicitSystem(){if(this.validWcs)return this.system===co.Auto?this.defaultSystem:this.system}constructor(){Object(j.a)(this,"labelType",$i,this),Object(j.a)(this,"color",Ki,this),Object(j.a)(this,"tolerance",Qi,this),Object(j.a)(this,"system",Zi,this),Object(j.a)(this,"defaultSystem",Ji,this),Object(j.a)(this,"validWcs",en,this),Object(j.a)(this,"setColor",tn,this),Object(x.p)(this),this.system=co.Auto,this.labelType=lo.Exterior,this.color=Ja.Instance.astColor,this.tolerance=2,this.defaultSystem=co.Auto,this.validWcs=!1}setTolerance(e){this.tolerance=e}setLabelType(e){this.labelType=e}setSystem(e){this.system=e}setDefaultSystem(e){this.defaultSystem=e}setValidWcs(e){this.validWcs=e}},$i=Object(S.a)(Xi.prototype,"labelType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ki=Object(S.a)(Xi.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qi=Object(S.a)(Xi.prototype,"tolerance",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zi=Object(S.a)(Xi.prototype,"system",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ji=Object(S.a)(Xi.prototype,"defaultSystem",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),en=Object(S.a)(Xi.prototype,"validWcs",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(Xi.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(Xi.prototype,"styleString"),Xi.prototype),Object(S.a)(Xi.prototype,"explicitSystem",[x.i],Object.getOwnPropertyDescriptor(Xi.prototype,"explicitSystem"),Xi.prototype),tn=Object(S.a)(Xi.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(S.a)(Xi.prototype,"setTolerance",[x.g],Object.getOwnPropertyDescriptor(Xi.prototype,"setTolerance"),Xi.prototype),Object(S.a)(Xi.prototype,"setLabelType",[x.g],Object.getOwnPropertyDescriptor(Xi.prototype,"setLabelType"),Xi.prototype),Object(S.a)(Xi.prototype,"setSystem",[x.g],Object.getOwnPropertyDescriptor(Xi.prototype,"setSystem"),Xi.prototype),Object(S.a)(Xi.prototype,"setDefaultSystem",[x.g],Object.getOwnPropertyDescriptor(Xi.prototype,"setDefaultSystem"),Xi.prototype),Object(S.a)(Xi.prototype,"setValidWcs",[x.g],Object.getOwnPropertyDescriptor(Xi.prototype,"setValidWcs"),Xi.prototype),Xi),bo=(nn=class{get styleString(){let e=new go;return e.add("DrawTitle",this.show),e.add("Font(Title)",this.font),e.add("Size(Title)",this.fontSize),e.add("Color(Title)",this.color,this.customColor),e.add("Title",this.customTitleString,this.customText),e.toString()}constructor(){Object(j.a)(this,"visible",rn,this),Object(j.a)(this,"font",on,this),Object(j.a)(this,"fontSize",sn,this),Object(j.a)(this,"customColor",an,this),Object(j.a)(this,"color",ln,this),Object(j.a)(this,"hidden",cn,this),Object(j.a)(this,"customText",dn,this),Object(j.a)(this,"customTitleString",un,this),Object(j.a)(this,"setFont",hn,this),Object(j.a)(this,"setColor",pn,this),Object(j.a)(this,"setCustomText",gn,this),Object(j.a)(this,"setCustomTitleString",fn,this),Object(x.p)(this),this.visible=!1,this.hidden=!1,this.customColor=!1,this.color=4,this.font=2,this.fontSize=18,this.customText=!1,this.customTitleString=""}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setFontSize(e){this.fontSize=e}setCustomColor(e){this.customColor=e}},rn=Object(S.a)(nn.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),on=Object(S.a)(nn.prototype,"font",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sn=Object(S.a)(nn.prototype,"fontSize",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),an=Object(S.a)(nn.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ln=Object(S.a)(nn.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=Object(S.a)(nn.prototype,"hidden",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=Object(S.a)(nn.prototype,"customText",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=Object(S.a)(nn.prototype,"customTitleString",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(nn.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(nn.prototype,"styleString"),nn.prototype),Object(S.a)(nn.prototype,"show",[x.i],Object.getOwnPropertyDescriptor(nn.prototype,"show"),nn.prototype),Object(S.a)(nn.prototype,"setVisible",[x.g],Object.getOwnPropertyDescriptor(nn.prototype,"setVisible"),nn.prototype),Object(S.a)(nn.prototype,"setHidden",[x.g],Object.getOwnPropertyDescriptor(nn.prototype,"setHidden"),nn.prototype),hn=Object(S.a)(nn.prototype,"setFont",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(S.a)(nn.prototype,"setFontSize",[x.g],Object.getOwnPropertyDescriptor(nn.prototype,"setFontSize"),nn.prototype),Object(S.a)(nn.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(nn.prototype,"setCustomColor"),nn.prototype),pn=Object(S.a)(nn.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),gn=Object(S.a)(nn.prototype,"setCustomText",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customText=e}}}),fn=Object(S.a)(nn.prototype,"setCustomTitleString",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customTitleString=e}}}),nn),mo=(bn=class{get styleString(){let e=new go;return e.add("Grid",this.visible),e.add("Color(Grid)",this.color,this.customColor),e.add("Width(Grid)",this.width,this.width>0),e.add("Gap(1)",this.gapX,this.customGap),e.add("Gap(2)",this.gapY,this.customGap),e.toString()}constructor(){Object(j.a)(this,"visible",mn,this),Object(j.a)(this,"customColor",yn,this),Object(j.a)(this,"color",On,this),Object(j.a)(this,"width",jn,this),Object(j.a)(this,"customGap",Sn,this),Object(j.a)(this,"gapX",xn,this),Object(j.a)(this,"gapY",Cn,this),Object(j.a)(this,"setColor",In,this),Object(x.p)(this),this.visible=Ja.Instance.astGridVisible,this.customColor=!1,this.color=4,this.width=1,this.customGap=!1,this.gapX=.2,this.gapY=.2}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}setCustomGap(e=!0){this.customGap=e}setGapX(e){this.gapX=e}setGapY(e){this.gapY=e}},mn=Object(S.a)(bn.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yn=Object(S.a)(bn.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),On=Object(S.a)(bn.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jn=Object(S.a)(bn.prototype,"width",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Sn=Object(S.a)(bn.prototype,"customGap",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xn=Object(S.a)(bn.prototype,"gapX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Cn=Object(S.a)(bn.prototype,"gapY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(bn.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(bn.prototype,"styleString"),bn.prototype),Object(S.a)(bn.prototype,"setVisible",[x.g],Object.getOwnPropertyDescriptor(bn.prototype,"setVisible"),bn.prototype),Object(S.a)(bn.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(bn.prototype,"setCustomColor"),bn.prototype),In=Object(S.a)(bn.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(S.a)(bn.prototype,"setWidth",[x.g],Object.getOwnPropertyDescriptor(bn.prototype,"setWidth"),bn.prototype),Object(S.a)(bn.prototype,"setCustomGap",[x.g],Object.getOwnPropertyDescriptor(bn.prototype,"setCustomGap"),bn.prototype),Object(S.a)(bn.prototype,"setGapX",[x.g],Object.getOwnPropertyDescriptor(bn.prototype,"setGapX"),bn.prototype),Object(S.a)(bn.prototype,"setGapY",[x.g],Object.getOwnPropertyDescriptor(bn.prototype,"setGapY"),bn.prototype),bn),yo=(wn=class{get styleString(){let e=new go;return e.add("Border",this.visible),e.add("Color(Border)",this.color,this.customColor),e.add("Width(Border)",this.width,this.width>0),e.toString()}constructor(){Object(j.a)(this,"visible",Tn,this),Object(j.a)(this,"customColor",vn,this),Object(j.a)(this,"color",An,this),Object(j.a)(this,"width",Rn,this),Object(j.a)(this,"setColor",Pn,this),Object(x.p)(this),this.visible=!0,this.customColor=!1,this.color=4,this.width=1}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}},Tn=Object(S.a)(wn.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vn=Object(S.a)(wn.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An=Object(S.a)(wn.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rn=Object(S.a)(wn.prototype,"width",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(wn.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(wn.prototype,"styleString"),wn.prototype),Object(S.a)(wn.prototype,"setVisible",[x.g],Object.getOwnPropertyDescriptor(wn.prototype,"setVisible"),wn.prototype),Object(S.a)(wn.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(wn.prototype,"setCustomColor"),wn.prototype),Pn=Object(S.a)(wn.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(S.a)(wn.prototype,"setWidth",[x.g],Object.getOwnPropertyDescriptor(wn.prototype,"setWidth"),wn.prototype),wn),Oo=(En=class{get styleString(){let e=new go;return e.add("TickAll",this.drawAll),e.add("MinTick(1)",this.densityX,this.customDensity),e.add("MinTick(2)",this.densityY,this.customDensity),e.add("Color(Ticks)",this.color,this.customColor),e.add("Width(Ticks)",this.width,this.width>0),e.add("MinTickLen",Object(B.mb)(this.length/100,2)),e.add("MajTickLen",Object(B.mb)(this.majorLength/100,2)),e.toString()}constructor(){Object(j.a)(this,"drawAll",Fn,this),Object(j.a)(this,"densityX",Mn,this),Object(j.a)(this,"densityY",kn,this),Object(j.a)(this,"customDensity",Dn,this),Object(j.a)(this,"customColor",Nn,this),Object(j.a)(this,"color",Ln,this),Object(j.a)(this,"width",_n,this),Object(j.a)(this,"length",zn,this),Object(j.a)(this,"majorLength",Wn,this),Object(j.a)(this,"setColor",Gn,this),Object(x.p)(this),this.drawAll=!0,this.customDensity=!1,this.densityX=4,this.densityY=4,this.customColor=!1,this.color=4,this.width=1,this.length=1,this.majorLength=2}setDrawAll(e=!0){this.drawAll=e}setCustomDensity(e=!0){this.customDensity=e}setDensityX(e){this.densityX=e}setDensityY(e){this.densityY=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}setLength(e){this.length=e}setMajorLength(e){this.majorLength=e}},Fn=Object(S.a)(En.prototype,"drawAll",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mn=Object(S.a)(En.prototype,"densityX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kn=Object(S.a)(En.prototype,"densityY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dn=Object(S.a)(En.prototype,"customDensity",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nn=Object(S.a)(En.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Object(S.a)(En.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_n=Object(S.a)(En.prototype,"width",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zn=Object(S.a)(En.prototype,"length",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Wn=Object(S.a)(En.prototype,"majorLength",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(En.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(En.prototype,"styleString"),En.prototype),Object(S.a)(En.prototype,"setDrawAll",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setDrawAll"),En.prototype),Object(S.a)(En.prototype,"setCustomDensity",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setCustomDensity"),En.prototype),Object(S.a)(En.prototype,"setDensityX",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setDensityX"),En.prototype),Object(S.a)(En.prototype,"setDensityY",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setDensityY"),En.prototype),Object(S.a)(En.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setCustomColor"),En.prototype),Gn=Object(S.a)(En.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(S.a)(En.prototype,"setWidth",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setWidth"),En.prototype),Object(S.a)(En.prototype,"setLength",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setLength"),En.prototype),Object(S.a)(En.prototype,"setMajorLength",[x.g],Object.getOwnPropertyDescriptor(En.prototype,"setMajorLength"),En.prototype),En),jo=(Vn=class{constructor(){Object(j.a)(this,"visible",Bn,this),Object(j.a)(this,"customColor",Hn,this),Object(j.a)(this,"color",qn,this),Object(j.a)(this,"width",Yn,this),Object(j.a)(this,"setColor",Un,this),Object(x.p)(this),this.visible=!1,this.customColor=!1,this.color=4,this.width=1}get styleString(){let e=new go;return e.add("DrawAxes",this.visible),e.add("Color(Axes)",this.color,this.customColor),e.add("Width(Axes)",this.width,this.width>0),e.toString()}setVisible(e=!0){this.visible=e}setCustomColor(e){this.customColor=e}setWidth(e){this.width=e}},Bn=Object(S.a)(Vn.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=Object(S.a)(Vn.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qn=Object(S.a)(Vn.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yn=Object(S.a)(Vn.prototype,"width",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(Vn.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(Vn.prototype,"styleString"),Vn.prototype),Object(S.a)(Vn.prototype,"setVisible",[x.g],Object.getOwnPropertyDescriptor(Vn.prototype,"setVisible"),Vn.prototype),Object(S.a)(Vn.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(Vn.prototype,"setCustomColor"),Vn.prototype),Un=Object(S.a)(Vn.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(S.a)(Vn.prototype,"setWidth",[x.g],Object.getOwnPropertyDescriptor(Vn.prototype,"setWidth"),Vn.prototype),Vn),So=(Xn=class{constructor(){Object(j.a)(this,"visible",$n,this),Object(j.a)(this,"hidden",Kn,this),Object(j.a)(this,"font",Qn,this),Object(j.a)(this,"fontSize",Zn,this),Object(j.a)(this,"customColor",Jn,this),Object(j.a)(this,"color",er,this),Object(j.a)(this,"customFormat",tr,this),Object(j.a)(this,"formatX",ir,this),Object(j.a)(this,"formatY",nr,this),Object(j.a)(this,"customPrecision",rr,this),Object(j.a)(this,"precision",or,this),Object(j.a)(this,"defaultFormatX",sr,this),Object(j.a)(this,"defaultFormatY",ar,this),Object(j.a)(this,"validWcs",lr,this),Object(j.a)(this,"setFont",cr,this),Object(j.a)(this,"setColor",dr,this),Object(x.p)(this),this.visible=!0,this.hidden=!1,this.fontSize=12,this.font=0,this.customColor=!1,this.color=4,this.customFormat=!1,this.defaultFormatX=uo.Degrees,this.defaultFormatY=uo.Degrees,this.formatX=uo.Degrees,this.formatY=uo.Degrees,this.customPrecision=!1,this.precision=3,this.validWcs=!1}get formatTypeX(){if(this.validWcs)return this.customFormat?this.formatX:this.defaultFormatX}get formatTypeY(){if(this.validWcs)return this.customFormat?this.formatY:this.defaultFormatY}get formatStringX(){if(!this.validWcs)return;const e=this.customPrecision?this.precision:"*";return`${this.formatTypeX}.${e}`}get formatStringY(){if(!this.validWcs)return;const e=this.customPrecision?this.precision:"*";return`${this.formatTypeY}.${e}`}cursorFormatStringX(e){if(!this.validWcs)return;return`${this.customFormat?this.formatX:this.defaultFormatX}.${e}`}cursorFormatStringY(e){if(!this.validWcs)return;return`${this.customFormat?this.formatY:this.defaultFormatY}.${e}`}get styleString(){let e=new go;return e.add("NumLab",this.show),e.add("Font(NumLab)",this.font),e.add("Size(NumLab)",this.fontSize),e.add("Color(NumLab)",this.color,this.customColor),e.add("Format(1)",this.formatStringX),e.add("Format(2)",this.formatStringY),e.toString()}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setFontSize(e){this.fontSize=e}setCustomColor(e){this.customColor=e}setCustomFormat(e){this.customFormat=e}setFormatX(e){this.formatX=e}setFormatY(e){this.formatY=e}setDefaultFormatX(e){this.defaultFormatX=e}setDefaultFormatY(e){this.defaultFormatY=e}setCustomPrecision(e){this.customPrecision=e}setPrecision(e){this.precision=e}setValidWcs(e){this.validWcs=e}},$n=Object(S.a)(Xn.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kn=Object(S.a)(Xn.prototype,"hidden",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qn=Object(S.a)(Xn.prototype,"font",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zn=Object(S.a)(Xn.prototype,"fontSize",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jn=Object(S.a)(Xn.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),er=Object(S.a)(Xn.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),tr=Object(S.a)(Xn.prototype,"customFormat",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ir=Object(S.a)(Xn.prototype,"formatX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=Object(S.a)(Xn.prototype,"formatY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rr=Object(S.a)(Xn.prototype,"customPrecision",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),or=Object(S.a)(Xn.prototype,"precision",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sr=Object(S.a)(Xn.prototype,"defaultFormatX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ar=Object(S.a)(Xn.prototype,"defaultFormatY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lr=Object(S.a)(Xn.prototype,"validWcs",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(Xn.prototype,"formatTypeX",[x.i],Object.getOwnPropertyDescriptor(Xn.prototype,"formatTypeX"),Xn.prototype),Object(S.a)(Xn.prototype,"formatTypeY",[x.i],Object.getOwnPropertyDescriptor(Xn.prototype,"formatTypeY"),Xn.prototype),Object(S.a)(Xn.prototype,"formatStringX",[x.i],Object.getOwnPropertyDescriptor(Xn.prototype,"formatStringX"),Xn.prototype),Object(S.a)(Xn.prototype,"formatStringY",[x.i],Object.getOwnPropertyDescriptor(Xn.prototype,"formatStringY"),Xn.prototype),Object(S.a)(Xn.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(Xn.prototype,"styleString"),Xn.prototype),Object(S.a)(Xn.prototype,"show",[x.i],Object.getOwnPropertyDescriptor(Xn.prototype,"show"),Xn.prototype),Object(S.a)(Xn.prototype,"setVisible",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setVisible"),Xn.prototype),Object(S.a)(Xn.prototype,"setHidden",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setHidden"),Xn.prototype),cr=Object(S.a)(Xn.prototype,"setFont",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(S.a)(Xn.prototype,"setFontSize",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setFontSize"),Xn.prototype),Object(S.a)(Xn.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setCustomColor"),Xn.prototype),dr=Object(S.a)(Xn.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Object(S.a)(Xn.prototype,"setCustomFormat",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setCustomFormat"),Xn.prototype),Object(S.a)(Xn.prototype,"setFormatX",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setFormatX"),Xn.prototype),Object(S.a)(Xn.prototype,"setFormatY",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setFormatY"),Xn.prototype),Object(S.a)(Xn.prototype,"setDefaultFormatX",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setDefaultFormatX"),Xn.prototype),Object(S.a)(Xn.prototype,"setDefaultFormatY",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setDefaultFormatY"),Xn.prototype),Object(S.a)(Xn.prototype,"setCustomPrecision",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setCustomPrecision"),Xn.prototype),Object(S.a)(Xn.prototype,"setPrecision",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setPrecision"),Xn.prototype),Object(S.a)(Xn.prototype,"setValidWcs",[x.g],Object.getOwnPropertyDescriptor(Xn.prototype,"setValidWcs"),Xn.prototype),Xn),xo=(ur=class{constructor(){Object(j.a)(this,"visible",hr,this),Object(j.a)(this,"hidden",pr,this),Object(j.a)(this,"customColor",gr,this),Object(j.a)(this,"color",fr,this),Object(j.a)(this,"font",br,this),Object(j.a)(this,"fontSize",mr,this),Object(j.a)(this,"customText",yr,this),Object(j.a)(this,"customLabelX",Or,this),Object(j.a)(this,"customLabelY",jr,this),Object(j.a)(this,"setColor",Sr,this),Object(j.a)(this,"setFont",xr,this),Object(j.a)(this,"setCustomText",Cr,this),Object(j.a)(this,"setCustomLabelX",Ir,this),Object(j.a)(this,"setCustomLabelY",wr,this),Object(x.p)(this),this.visible=Ja.Instance.astLabelsVisible,this.hidden=!1,this.fontSize=15,this.font=0,this.customColor=!1,this.color=4,this.customText=!1,this.customLabelX="",this.customLabelY=""}get styleString(){let e=new go;return e.add("TextLab",this.show),e.add("Font(TextLab)",this.font),e.add("Size(TextLab)",this.fontSize),e.add("Color(TextLab)",this.color,this.customColor),e.add("Label(1)",this.customLabelX,this.customText),e.add("Label(2)",this.customLabelY,this.customText),e.toString()}get show(){return this.visible&&!this.hidden}setVisible(e=!0){this.visible=e}setHidden(e){this.hidden=e}setCustomColor(e){this.customColor=e}setFontSize(e){this.fontSize=e}},hr=Object(S.a)(ur.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pr=Object(S.a)(ur.prototype,"hidden",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gr=Object(S.a)(ur.prototype,"customColor",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fr=Object(S.a)(ur.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),br=Object(S.a)(ur.prototype,"font",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mr=Object(S.a)(ur.prototype,"fontSize",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yr=Object(S.a)(ur.prototype,"customText",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Or=Object(S.a)(ur.prototype,"customLabelX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jr=Object(S.a)(ur.prototype,"customLabelY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(ur.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(ur.prototype,"styleString"),ur.prototype),Object(S.a)(ur.prototype,"show",[x.i],Object.getOwnPropertyDescriptor(ur.prototype,"show"),ur.prototype),Object(S.a)(ur.prototype,"setVisible",[x.g],Object.getOwnPropertyDescriptor(ur.prototype,"setVisible"),ur.prototype),Object(S.a)(ur.prototype,"setHidden",[x.g],Object.getOwnPropertyDescriptor(ur.prototype,"setHidden"),ur.prototype),Object(S.a)(ur.prototype,"setCustomColor",[x.g],Object.getOwnPropertyDescriptor(ur.prototype,"setCustomColor"),ur.prototype),Sr=Object(S.a)(ur.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),xr=Object(S.a)(ur.prototype,"setFont",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.font=e}}}),Object(S.a)(ur.prototype,"setFontSize",[x.g],Object.getOwnPropertyDescriptor(ur.prototype,"setFontSize"),ur.prototype),Cr=Object(S.a)(ur.prototype,"setCustomText",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customText=e}}}),Ir=Object(S.a)(ur.prototype,"setCustomLabelX",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customLabelX=e}}}),wr=Object(S.a)(ur.prototype,"setCustomLabelY",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.customLabelY=e}}}),ur),Co=(Tr=class{constructor(){Object(j.a)(this,"visible",vr,this),Object(j.a)(this,"color",Ar,this),Object(j.a)(this,"type",Rr,this),Object(j.a)(this,"width",Pr,this),Object(j.a)(this,"shiftX",Er,this),Object(j.a)(this,"shiftY",Fr,this),Object(j.a)(this,"setVisible",Mr,this),Object(j.a)(this,"setColor",kr,this),Object(j.a)(this,"setType",Dr,this),Object(j.a)(this,"setWidth",Nr,this),Object(j.a)(this,"setShiftX",Lr,this),Object(j.a)(this,"setShiftY",_r,this),Object(x.p)(this);const e=Ja.Instance;this.visible=e.beamVisible,this.color=e.beamColor,this.type=e.beamType,this.width=e.beamWidth,this.shiftX=this.shiftY=0}},vr=Object(S.a)(Tr.prototype,"visible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar=Object(S.a)(Tr.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=Object(S.a)(Tr.prototype,"type",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pr=Object(S.a)(Tr.prototype,"width",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Er=Object(S.a)(Tr.prototype,"shiftX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fr=Object(S.a)(Tr.prototype,"shiftY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mr=Object(S.a)(Tr.prototype,"setVisible",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),kr=Object(S.a)(Tr.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Dr=Object(S.a)(Tr.prototype,"setType",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.type=e}}}),Nr=Object(S.a)(Tr.prototype,"setWidth",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.width=e}}}),Lr=Object(S.a)(Tr.prototype,"setShiftX",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.shiftX=e}}}),_r=Object(S.a)(Tr.prototype,"setShiftY",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.shiftY=e}}}),Tr),Io=(zr=class{constructor(){Object(j.a)(this,"selectedFileId",Wr,this),Object(j.a)(this,"settingsForDisplay",Gr,this),Object(j.a)(this,"setSelectedFrame",Vr,this),Object(x.p)(this),this.selectedFileId=-1,this.settingsForDisplay=null,Object(x.h)((()=>{const e=ne.a.Instance;e.activeFrame&&e.activeFrame.frameInfo&&e.activeFrame.frameInfo.fileInfo&&this.setSelectedFrame(e.activeFrame.frameInfo.fileId)}))}get isSelectedFrameValid(){return this.selectedFileId>=0&&null!==this.settingsForDisplay}},Wr=Object(S.a)(zr.prototype,"selectedFileId",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gr=Object(S.a)(zr.prototype,"settingsForDisplay",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(zr.prototype,"isSelectedFrameValid",[x.i],Object.getOwnPropertyDescriptor(zr.prototype,"isSelectedFrameValid"),zr.prototype),Vr=Object(S.a)(zr.prototype,"setSelectedFrame",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileId=e;const t=ne.a.Instance.getFrame(e);t&&t.overlayBeamSettings&&(this.settingsForDisplay=t.overlayBeamSettings)}}}),zr),wo=(ro=no=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(j.a)(this,"viewWidth",Hr,this),Object(j.a)(this,"viewHeight",qr,this),Object(j.a)(this,"global",Yr,this),Object(j.a)(this,"title",Ur,this),Object(j.a)(this,"grid",Xr,this),Object(j.a)(this,"border",$r,this),Object(j.a)(this,"axes",Kr,this),Object(j.a)(this,"numbers",Qr,this),Object(j.a)(this,"labels",Zr,this),Object(j.a)(this,"ticks",Jr,this),Object(j.a)(this,"beam",eo,this),Object(j.a)(this,"setViewDimension",to,this),Object(j.a)(this,"toggleLabels",io,this),Object(x.p)(this),this.global=new fo,this.title=new bo,this.grid=new mo,this.border=new yo,this.axes=new jo,this.numbers=new So,this.labels=new xo,this.ticks=new Oo,this.beam=new Io,this.viewHeight=1,this.viewWidth=1,Object(x.h)((()=>{this.global.system;this.setFormatsFromSystem();const e=ne.a.Instance.activeFrame;e&&e.wcsInfoForTransformation&&e.validWcs&&Di.set(ne.a.Instance.activeFrame.wcsInfoForTransformation,`System=${this.global.explicitSystem}`)})),Object(x.h)((()=>{this.numbers.formatTypeX;const e=ne.a.Instance.activeFrame;e&&e.wcsInfoForTransformation&&e.validWcs&&Di.set(ne.a.Instance.activeFrame.wcsInfoForTransformation,`Format(1)=${this.numbers.formatTypeX}.${zi}`)})),Object(x.h)((()=>{this.numbers.formatTypeY;const e=ne.a.Instance.activeFrame;e&&e.wcsInfoForTransformation&&e.validWcs&&Di.set(ne.a.Instance.activeFrame.wcsInfoForTransformation,`Format(2)=${this.numbers.formatTypeY}.${zi}`)}))}setFormatsFromSystem(){if(this.global.validWcs)switch(Ja.Instance.wcsType){case Ni.WCSType.DEGREES:this.numbers.setDefaultFormatX(uo.Degrees),this.numbers.setDefaultFormatY(uo.Degrees);break;case Ni.WCSType.SEXAGESIMAL:this.numbers.setDefaultFormatX(uo.HMS),this.numbers.setDefaultFormatY(uo.DMS);break;case Ni.WCSType.AUTOMATIC:default:[co.FK4,co.FK5,co.ICRS].indexOf(this.global.explicitSystem)>-1?(this.numbers.setDefaultFormatX(uo.HMS),this.numbers.setDefaultFormatY(uo.DMS)):(this.numbers.setDefaultFormatX(uo.Degrees),this.numbers.setDefaultFormatY(uo.Degrees))}else this.numbers.setDefaultFormatX(void 0),this.numbers.setDefaultFormatY(void 0);this.numbers.customFormat||(this.numbers.setFormatX(this.numbers.defaultFormatX),this.numbers.setFormatY(this.numbers.defaultFormatY))}setDefaultsFromAST(e){this.global.setValidWcs(e.validWcs),this.numbers.setValidWcs(e.validWcs),this.global.setDefaultSystem(Di.getString(e.wcsInfo,"System")),this.setFormatsFromSystem()}get labelsHidden(){return this.labels.hidden&&this.numbers.hidden&&this.title.hidden}get styleString(){let e=new go;return e.addSection(this.global.styleString),e.addSection(this.title.styleString),e.addSection(this.grid.styleString),e.addSection(this.border.styleString),e.addSection(this.ticks.styleString),e.addSection(this.axes.styleString),e.addSection(this.numbers.styleString),e.addSection(this.labels.styleString),e.add("LabelUp",0),e.add("TitleGap",this.titleGap/this.minSize),e.add("NumLabGap",this.defaultGap/this.minSize),e.add("TextLabGap",this.cumulativeLabelGap/this.minSize),e.add("TextGapType","plot"),e.toString()}get minSize(){return Math.min(this.viewWidth,this.viewHeight)}get showNumbers(){return this.numbers.show&&this.global.labelType===lo.Exterior}get defaultGap(){return 5}get titleGap(){return 2*this.defaultGap}get cumulativeLabelGap(){return(this.showNumbers?this.defaultGap:0)+(this.showNumbers?this.numbers.fontSize:0)+this.defaultGap}get padding(){const e=this.showNumbers?this.defaultGap:0,t=this.showNumbers?this.numbers.fontSize:0,i=this.labels.show?this.defaultGap:0,n=this.labels.show?this.labels.fontSize:0;return{left:5+e+t+i+n,right:5,top:5+(this.title.show?this.titleGap:0)+(this.title.show?this.title.fontSize:0),bottom:5+e+t+i+n}}get renderWidth(){return this.viewWidth-this.padding.left-this.padding.right}get renderHeight(){return this.viewHeight-this.padding.top-this.padding.bottom}},no.staticInstance=void 0,Br=ro,Hr=Object(S.a)(Br.prototype,"viewWidth",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qr=Object(S.a)(Br.prototype,"viewHeight",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yr=Object(S.a)(Br.prototype,"global",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ur=Object(S.a)(Br.prototype,"title",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xr=Object(S.a)(Br.prototype,"grid",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$r=Object(S.a)(Br.prototype,"border",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kr=Object(S.a)(Br.prototype,"axes",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qr=Object(S.a)(Br.prototype,"numbers",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zr=Object(S.a)(Br.prototype,"labels",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jr=Object(S.a)(Br.prototype,"ticks",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),eo=Object(S.a)(Br.prototype,"beam",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),to=Object(S.a)(Br.prototype,"setViewDimension",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.viewWidth=e,this.viewHeight=t}}}),Object(S.a)(Br.prototype,"setFormatsFromSystem",[x.g],Object.getOwnPropertyDescriptor(Br.prototype,"setFormatsFromSystem"),Br.prototype),Object(S.a)(Br.prototype,"setDefaultsFromAST",[x.g],Object.getOwnPropertyDescriptor(Br.prototype,"setDefaultsFromAST"),Br.prototype),io=Object(S.a)(Br.prototype,"toggleLabels",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=!this.labelsHidden;this.labels.setHidden(e),this.numbers.setHidden(e),this.title.setHidden(e)}}}),Object(S.a)(Br.prototype,"labelsHidden",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"labelsHidden"),Br.prototype),Object(S.a)(Br.prototype,"styleString",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"styleString"),Br.prototype),Object(S.a)(Br.prototype,"minSize",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"minSize"),Br.prototype),Object(S.a)(Br.prototype,"showNumbers",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"showNumbers"),Br.prototype),Object(S.a)(Br.prototype,"defaultGap",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"defaultGap"),Br.prototype),Object(S.a)(Br.prototype,"titleGap",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"titleGap"),Br.prototype),Object(S.a)(Br.prototype,"cumulativeLabelGap",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"cumulativeLabelGap"),Br.prototype),Object(S.a)(Br.prototype,"padding",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"padding"),Br.prototype),Object(S.a)(Br.prototype,"renderWidth",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"renderWidth"),Br.prototype),Object(S.a)(Br.prototype,"renderHeight",[x.i],Object.getOwnPropertyDescriptor(Br.prototype,"renderHeight"),Br.prototype),Br);var To,vo,Ao,Ro,Po,Eo,Fo=i(59);let Mo=(To=class{constructor(e=0,t=0){this.regionId=void 0,this.fileId=void 0,Object(j.a)(this,"stokes",vo,this),Object(j.a)(this,"channel",Ao,this),Object(j.a)(this,"x",Ro,this),Object(j.a)(this,"y",Po,this),Object(j.a)(this,"profiles",Eo,this),Object(x.p)(this),this.fileId=e,this.regionId=t,this.profiles=new Map}updateFromStream(e){if(this.channel===e.channel&&this.stokes===e.stokes&&this.x===e.x&&this.y===e.y)for(let t of e.profiles)this.profiles.set(t.coordinate,Ni.ProtobufProcessing.ProcessSpatialProfile(t));else{this.channel=e.channel,this.stokes=e.stokes,this.x=e.x,this.y=e.y;const t=new Map;for(let i of e.profiles)t.set(i.coordinate,Ni.ProtobufProcessing.ProcessSpatialProfile(i));this.profiles=t}}setProfile(e,t){this.profiles.set(e,t)}setProfiles(e){this.profiles=e}},vo=Object(S.a)(To.prototype,"stokes",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ao=Object(S.a)(To.prototype,"channel",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ro=Object(S.a)(To.prototype,"x",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Po=Object(S.a)(To.prototype,"y",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eo=Object(S.a)(To.prototype,"profiles",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(To.prototype,"updateFromStream",[x.g],Object.getOwnPropertyDescriptor(To.prototype,"updateFromStream"),To.prototype),Object(S.a)(To.prototype,"setProfile",[x.g],Object.getOwnPropertyDescriptor(To.prototype,"setProfile"),To.prototype),Object(S.a)(To.prototype,"setProfiles",[x.g],Object.getOwnPropertyDescriptor(To.prototype,"setProfiles"),To.prototype),To);var ko,Do,No,Lo,_o;let zo=(ko=class{constructor(e=0,t=0){this.regionId=void 0,this.fileId=void 0,Object(j.a)(this,"stokes",Do,this),Object(j.a)(this,"x",No,this),Object(j.a)(this,"y",Lo,this),Object(j.a)(this,"profiles",_o,this),Object(x.p)(this),this.fileId=e,this.regionId=t,this.profiles=new Map}getProfile(e,t){let i=this.profiles.get(e);return i?i.get(t):null}clearProfiles(){this.profiles=new Map}setProfile(e){let t=this.profiles.get(e.coordinate);t||(t=new x.b,this.profiles.set(e.coordinate,t)),t.set(e.statsType,e)}},Do=Object(S.a)(ko.prototype,"stokes",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),No=Object(S.a)(ko.prototype,"x",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lo=Object(S.a)(ko.prototype,"y",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_o=Object(S.a)(ko.prototype,"profiles",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(ko.prototype,"clearProfiles",[x.g],Object.getOwnPropertyDescriptor(ko.prototype,"clearProfiles"),ko.prototype),Object(S.a)(ko.prototype,"setProfile",[x.g],Object.getOwnPropertyDescriptor(ko.prototype,"setProfile"),ko.prototype),ko);var Wo,Go,Vo,Bo,Ho,qo,Yo,Uo,Xo,$o,Ko,Qo,Zo,Jo,es,ts,is,ns,rs,os,ss,as,ls,cs,ds,us,hs,ps,gs,fs,bs,ms,ys,Os,js,Ss,xs,Cs=i(82),Is=i.n(Cs);let ws;!function(e){e.Region="Region List Widget",e.Log="Log Widget",e.SpatialProfiler="Spatial Profiler",e.SpectralProfiler="Spectral Profiler",e.Statistics="Statistics Widget",e.Histogram="Histogram Widget",e.Animator="Animator Widget",e.RenderConfig="Render Config Widget",e.StokesAnalysis="Stokes Analysis Widget",e.ImageList="Image List Widget",e.Catalog="Catalog Widget",e.SpectralLineQuery="Spectral Line Query Widget"}(ws||(ws={}));let Ts=(Wo=class{constructor(e,t){this.id=void 0,this.type=void 0,this.minWidth=void 0,this.minHeight=void 0,Object(j.a)(this,"defaultWidth",Go,this),Object(j.a)(this,"defaultHeight",Vo,this),Object(j.a)(this,"defaultX",Bo,this),Object(j.a)(this,"defaultY",Ho,this),this.isCloseable=void 0,Object(j.a)(this,"title",qo,this),this.parentId=void 0,this.parentType=void 0,this.helpType=void 0,this.componentId=void 0,this.zIndex=0,Object(j.a)(this,"setDefaultPosition",Yo,this),Object(j.a)(this,"setDefaultSize",Uo,this),Object(x.p)(this),this.id=e,this.type=t.type,this.minWidth=t.minWidth,this.minHeight=t.minHeight,this.defaultWidth=t.defaultWidth||t.minWidth,this.defaultHeight=t.defaultHeight||t.minHeight,this.defaultX=t.defaultX,this.defaultY=t.defaultY,this.isCloseable=t.isCloseable,this.title=t.title,this.parentId=t.parentId,this.parentType=t.parentType,this.helpType=t.helpType,this.componentId=t.componentId}},Go=Object(S.a)(Wo.prototype,"defaultWidth",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vo=Object(S.a)(Wo.prototype,"defaultHeight",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bo=Object(S.a)(Wo.prototype,"defaultX",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ho=Object(S.a)(Wo.prototype,"defaultY",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),qo=Object(S.a)(Wo.prototype,"title",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Yo=Object(S.a)(Wo.prototype,"setDefaultPosition",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultX=e,this.defaultY=t}}}),Uo=Object(S.a)(Wo.prototype,"setDefaultSize",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.defaultWidth=e,this.defaultHeight=t}}}),Wo);let vs=(xs=Ss=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}static RemoveFrameFromRegionWidgets(e,t=Li.a){t===Li.a?e.forEach((e=>{e.clearRegionMap()})):e.forEach((e=>{e.clearFrameEntry(t),e.fileId===t&&e.setFileId(Li.a)}))}constructor(){Object(j.a)(this,"floatingWidgets",$o,this),Object(j.a)(this,"renderConfigWidgets",Ko,this),Object(j.a)(this,"spatialProfileWidgets",Qo,this),Object(j.a)(this,"spectralProfileWidgets",Zo,this),Object(j.a)(this,"statsWidgets",Jo,this),Object(j.a)(this,"histogramWidgets",es,this),Object(j.a)(this,"layerListWidgets",ts,this),Object(j.a)(this,"logWidgets",is,this),Object(j.a)(this,"regionListWidgets",ns,this),Object(j.a)(this,"animatorWidgets",rs,this),Object(j.a)(this,"stokesAnalysisWidgets",os,this),Object(j.a)(this,"floatingSettingsWidgets",ss,this),Object(j.a)(this,"catalogWidgets",as,this),Object(j.a)(this,"catalogPlotWidgets",ls,this),Object(j.a)(this,"spectralLineQueryWidgets",cs,this),this.widgetsMap=void 0,this.defaultFloatingWidgetOffset=void 0,this.CARTAWidgets=new Map([[ws.Region,{isCustomIcon:!0,icon:"regionList",onClick:()=>e.Instance.createFloatingRegionListWidget(),widgetConfig:St.q.WIDGET_CONFIG}],[ws.Log,{isCustomIcon:!1,icon:"application",onClick:()=>e.Instance.createFloatingLogWidget(),widgetConfig:St.o.WIDGET_CONFIG}],[ws.SpatialProfiler,{isCustomIcon:!0,icon:"spatialProfiler",onClick:()=>e.Instance.createFloatingSpatialProfilerWidget(),widgetConfig:St.v.WIDGET_CONFIG}],[ws.SpectralProfiler,{isCustomIcon:!0,icon:"spectralProfiler",onClick:()=>e.Instance.createFloatingSpectralProfilerWidget(),widgetConfig:St.z.WIDGET_CONFIG}],[ws.Statistics,{isCustomIcon:!1,icon:"calculator",onClick:()=>e.Instance.createFloatingStatsWidget(),widgetConfig:St.D.WIDGET_CONFIG}],[ws.Histogram,{isCustomIcon:!1,icon:"timeline-bar-chart",onClick:()=>e.Instance.createFloatingHistogramWidget(),widgetConfig:St.i.WIDGET_CONFIG}],[ws.Animator,{isCustomIcon:!1,icon:"video",onClick:()=>e.Instance.createFloatingAnimatorWidget(),widgetConfig:St.a.WIDGET_CONFIG}],[ws.RenderConfig,{isCustomIcon:!1,icon:"style",onClick:()=>e.Instance.createFloatingRenderWidget(),widgetConfig:St.s.WIDGET_CONFIG}],[ws.StokesAnalysis,{isCustomIcon:!0,icon:"stokes",onClick:()=>e.Instance.createFloatingStokesWidget(),widgetConfig:St.E.WIDGET_CONFIG}],[ws.ImageList,{isCustomIcon:!1,icon:"layers",onClick:()=>e.Instance.createFloatingLayerListWidget(),widgetConfig:St.n.WIDGET_CONFIG}],[ws.Catalog,{isCustomIcon:!1,icon:"heatmap",onClick:()=>e.Instance.reloadFloatingCatalogWidget(),widgetConfig:St.b.WIDGET_CONFIG}],[ws.SpectralLineQuery,{isCustomIcon:!0,icon:"spectralLineQuery",onClick:()=>e.Instance.createFloatingSpectralLineQueryWidget(),widgetConfig:St.y.WIDGET_CONFIG}]]),this.getNextId=e=>{const t=this.widgetsMap.get(e);if(!t)return null;let i=0;for(;;){const n=`${e}-${i}`;if(!t.has(n))return n;i++}},this.getNextSettingId=(e,t)=>{const i=this.floatingSettingsWidgets;if(!i)return null;let n=!1;if(i.forEach((e=>{e===t&&(n=!0)})),n)return null;let r=0;for(;;){const n=`${t}-${e}-${r}`;if(!i.has(n))return n;r++}},this.getFloatingWidgetOffset=()=>(this.defaultFloatingWidgetOffset+=25,this.defaultFloatingWidgetOffset=(this.defaultFloatingWidgetOffset-100)%300+100,this.defaultFloatingWidgetOffset),this.removeWidget=(e,t)=>{const i=this.widgetsMap.get(t);i&&(this.removeAssociatedFloatingSetting(e),i.delete(e));this.floatingSettingsWidgets.has(e)&&this.floatingSettingsWidgets.delete(e)},this.addWidgetByType=(e,t=null)=>{let i;switch(e){case St.k.WIDGET_CONFIG.type:i=St.k.WIDGET_CONFIG.id;break;case St.s.WIDGET_CONFIG.type:i=this.addRenderConfigWidget(null,t);break;case St.v.WIDGET_CONFIG.type:i=this.addSpatialProfileWidget(null,t);break;case St.z.WIDGET_CONFIG.type:i=this.addSpectralProfileWidget(null,t);break;case St.D.WIDGET_CONFIG.type:i=this.addStatsWidget();break;case St.i.WIDGET_CONFIG.type:i=this.addHistogramWidget(null,t);break;case St.a.WIDGET_CONFIG.type:i=this.addAnimatorWidget();break;case St.n.WIDGET_CONFIG.type:i=this.addLayerListWidget();break;case St.o.WIDGET_CONFIG.type:i=this.addLogWidget();break;case St.q.WIDGET_CONFIG.type:i=this.addRegionListWidget();break;case St.E.WIDGET_CONFIG.type:i=this.addStokesWidget(null,t);break;case St.y.WIDGET_CONFIG.type:i=this.addSpectralLineQueryWidget();break;case St.b.WIDGET_CONFIG.type:i=this.getNextComponentId(St.b.WIDGET_CONFIG),uc.Instance.catalogProfiles.set(i,1),t&&this.addCatalogWidget(t.catalogFileId,null,t);break;case Li.c.D2Scatter:const n={xColumnName:"None",yColumnName:"None",plotType:Li.c.D2Scatter};i=this.addCatalogPlotWidget(n);const r=this.getNextComponentId(St.d.WIDGET_CONFIG);uc.Instance.setCatalogPlots(r,1,i);break;case Li.c.Histogram:const o={xColumnName:"None",yColumnName:void 0,plotType:Li.c.Histogram};i=this.addCatalogPlotWidget(o);const s=this.getNextComponentId(St.d.WIDGET_CONFIG);uc.Instance.setCatalogPlots(s,1,i);break;default:this.floatingWidgets.find((t=>t.id===e))&&this.removeFloatingWidget(e,!0),i=null}return i},this.removeFloatingWidgets=()=>{this.floatingWidgets&&this.floatingWidgets.forEach((e=>this.removeFloatingWidget(e.id)))},this.createFloatingWidget=t=>{if(t.id){let i=t.id;t.plotType&&(i=t.plotType);const n=this.addWidgetByType(i,t.widgetSettings);let r=new Ts(n,e.GetDefaultWidgetConfig(t.id));if(r.setDefaultSize(t.defaultWidth||r.defaultWidth,t.defaultHeight||r.defaultHeight),r.componentId&&(r.componentId=r.id),t.defaultX>0&&t.defaultY>0)r.setDefaultPosition(t.defaultX,t.defaultY);else{const e=this.getFloatingWidgetOffset();r.setDefaultPosition(e,e)}this.floatingWidgets.push(r)}},this.initWidgets=(e,t)=>{e.forEach((e=>{if(e.id&&e.props){let t=e.id;"plotType"in e&&(t=e.plotType);const i=this.addWidgetByType(t,"widgetSettings"in e?e.widgetSettings:null);i&&(e.id=i,e.props.id=i)}})),t.forEach((e=>this.createFloatingWidget(e)))},this.initLayoutWithWidgets=t=>{if(!t)return void console.log("Invalid parameters!");t.registerComponent("placeholder",St.p),t.registerComponent("image-view",St.k),t.registerComponent("spatial-profiler",St.v),t.registerComponent("spectral-profiler",St.z),t.registerComponent("spectral-line-query",St.y),t.registerComponent("stats",St.D),t.registerComponent("histogram",St.i),t.registerComponent("render-config",St.s),t.registerComponent("region-list",St.q),t.registerComponent("layer-list",St.n),t.registerComponent("log",St.o),t.registerComponent("animator",St.a),t.registerComponent("stokes",St.E),t.registerComponent("catalog-overlay",St.b),t.registerComponent("catalog-plot",St.d);const i=["image-view","spatial-profiler","spectral-profiler","histogram","render-config","stokes","catalog-overlay"];this.CARTAWidgets.forEach(((i,n)=>{const r=n.replace(/\s+/g,"")+"Button";e.CreateDragSource(t,i.widgetConfig,r)})),t.on("stackCreated",(t=>{const n=Is()('<li class="lm-pin" title="detach"><span class="bp3-icon-standard bp3-icon-unpin"/></li>');n.on("click",(()=>this.unpinWidget(t.getActiveContentItem()))),t.header.controlsContainer.prepend(n);const r=Is()('<li class="lm-help" title="help"><span class="bp3-icon-standard bp3-icon-help"/></li>');r.on("click",(e=>this.onHelpPinedClick(e,t.getActiveContentItem()))),t.header.controlsContainer.prepend(r),t.on("activeContentItemChanged",(n=>{if(t&&t.config&&t.header.controlsContainer&&t.config.content.length){var r,o;const n=t.getActiveContentItem().config.component,s=t.header.controlsContainer[0];if(n&&i.includes(n)&&(null===s||void 0===s?void 0:s.childElementCount)<5){const i=Is()('<li class="lm_settings" title="settings"><span class="bp3-icon-standard bp3-icon-cog"/></li>');i.on("click",(()=>e.Instance.onCogPinedClick(t.getActiveContentItem()))),t.header.controlsContainer.prepend(i)}else i.includes(n)||5!==(null===s||void 0===s?void 0:s.childElementCount)||s.children[0].remove();null===(r=Is()(s))||void 0===r||null===(o=r.find("li.lm-pin"))||void 0===o||o.attr("style","image-view"===n?"display:none;":"")}}))})),t.on("componentCreated",this.handleItemCreation),t.on("itemDestroyed",this.handleItemRemoval),t.on("stateChanged",this.handleStateUpdates)},this.toWidgetSettingsConfig=(e,t)=>{var i,n;if(!e||!t)return null;let r=null;switch(e){case St.s.WIDGET_CONFIG.type:r=this.renderConfigWidgets.get(t);break;case St.v.WIDGET_CONFIG.type:r=this.spatialProfileWidgets.get(t);break;case St.z.WIDGET_CONFIG.type:r=this.spectralProfileWidgets.get(t);break;case St.i.WIDGET_CONFIG.type:r=this.histogramWidgets.get(t);break;case St.E.WIDGET_CONFIG.type:r=this.stokesAnalysisWidgets.get(t);break;case St.b.WIDGET_CONFIG.type:r=this.catalogWidgets.get(t)}return null===(i=r)||void 0===i||null===(n=i.toConfig)||void 0===n?void 0:n.call(i)},Object(j.a)(this,"onCogPinedClick",ds,this),Object(j.a)(this,"unpinWidget",us,this),Object(j.a)(this,"onHelpPinedClick",hs,this),Object(j.a)(this,"handleItemCreation",ps,this),Object(j.a)(this,"handleItemRemoval",gs,this),Object(j.a)(this,"handleStateUpdates",fs,this),this.createFloatingSpatialProfilerWidget=()=>{this.addFloatingWidget(new Ts(this.addSpatialProfileWidget(),St.v.WIDGET_CONFIG))},this.createFloatingSpectralProfilerWidget=()=>{this.addFloatingWidget(new Ts(this.addSpectralProfileWidget(),St.z.WIDGET_CONFIG))},this.getSpectralWidgetStoreByID=e=>this.spectralProfileWidgets.get(e),this.createFloatingStokesWidget=()=>{this.addFloatingWidget(new Ts(this.addStokesWidget(),St.E.WIDGET_CONFIG))},this.getNextComponentId=e=>{let t=0,i=[];for(e.type===St.d.WIDGET_CONFIG.type?uc.Instance.catalogPlots.forEach(((e,t)=>{i.push(t)})):e.type===St.b.WIDGET_CONFIG.type&&uc.Instance.catalogProfiles.forEach(((e,t)=>{i.push(t)}));;){const n=`${e.componentId}-${t}`;if(!i.includes(n))return n;t++}},this.createFloatingCatalogWidget=e=>{const t=this.addCatalogWidget(e),i=this.getNextComponentId(St.b.WIDGET_CONFIG);let n=new Ts(i,St.b.WIDGET_CONFIG);return n.componentId=i,this.addFloatingWidget(n),{widgetStoreId:t,widgetComponentId:i}},this.reloadFloatingCatalogWidget=()=>{const e=ne.a.Instance.catalogNum,t=this.getNextComponentId(St.b.WIDGET_CONFIG);let i=new Ts(t,St.b.WIDGET_CONFIG);i.componentId=t,e&&uc.Instance.catalogProfiles.set(t,e),this.addFloatingWidget(i)},this.createFloatingCatalogPlotWidget=e=>{const t=St.d.WIDGET_CONFIG,i=this.addCatalogPlotWidget(e),n=this.getNextComponentId(t),r=new Ts(i,t);return r.id=i,r.componentId=n,r.helpType=e.plotType===Li.c.Histogram?Sc.CATALOG_HISTOGRAM_PLOT:Sc.CATALOG_SCATTER_PLOT,this.addFloatingWidget(r),{widgetStoreId:i,widgetComponentId:n}},this.createFloatingSpectralLineQueryWidget=()=>{const e=new Ts(this.addSpectralLineQueryWidget(),St.y.WIDGET_CONFIG);return e.componentId=this.getNextComponentId(e),this.addFloatingWidget(e),e.id},this.createFloatingSettingsWidget=(t,i,n)=>{const r=e.GetDefaultWidgetSettingsConfig(n),o=new Ts(this.addFloatingSettingsWidget(null,i,r.type),r);o.title=t+" Settings",o.parentId=i,o.parentType=n,o.id&&this.addFloatingWidget(o)},this.createFloatingStatsWidget=()=>{this.addFloatingWidget(new Ts(this.addStatsWidget(),St.D.WIDGET_CONFIG))},this.createFloatingHistogramWidget=()=>{this.addFloatingWidget(new Ts(this.addHistogramWidget(),St.i.WIDGET_CONFIG))},this.createFloatingRenderWidget=()=>{this.addFloatingWidget(new Ts(this.addRenderConfigWidget(),St.s.WIDGET_CONFIG))},this.createFloatingLogWidget=()=>{this.addFloatingWidget(new Ts(this.addLogWidget(),St.o.WIDGET_CONFIG))},this.createFloatingAnimatorWidget=()=>{this.addFloatingWidget(new Ts(this.addAnimatorWidget(),St.a.WIDGET_CONFIG))},this.createFloatingRegionListWidget=()=>{this.addFloatingWidget(new Ts(this.addRegionListWidget(),St.q.WIDGET_CONFIG))},this.createFloatingLayerListWidget=()=>{this.addFloatingWidget(new Ts(this.addLayerListWidget(),St.n.WIDGET_CONFIG))},Object(j.a)(this,"selectFloatingWidget",bs,this),Object(j.a)(this,"updateSelectFloatingWidgetzIndex",ms,this),Object(j.a)(this,"addFloatingWidget",ys,this),Object(j.a)(this,"removeFloatingWidget",Os,this),Object(j.a)(this,"removeFloatingWidgetComponent",js,this),this.removeAssociatedFloatingSetting=e=>{var t;if(null===(t=this.floatingSettingsWidgets)||void 0===t?void 0:t.size){let t=null;this.floatingSettingsWidgets.forEach(((i,n)=>{i===e&&(t=n)})),t&&(this.removeFloatingWidget(t,!0),this.floatingSettingsWidgets.delete(t))}},Object(x.p)(this),this.spatialProfileWidgets=new Map,this.spectralProfileWidgets=new Map,this.statsWidgets=new Map,this.histogramWidgets=new Map,this.renderConfigWidgets=new Map,this.animatorWidgets=new Map,this.layerListWidgets=new Map,this.logWidgets=new Map,this.regionListWidgets=new Map,this.stokesAnalysisWidgets=new Map,this.catalogWidgets=new Map,this.floatingSettingsWidgets=new Map,this.catalogPlotWidgets=new Map,this.spectralLineQueryWidgets=new Map,this.widgetsMap=new Map([[St.v.WIDGET_CONFIG.type,this.spatialProfileWidgets],[St.z.WIDGET_CONFIG.type,this.spectralProfileWidgets],[St.D.WIDGET_CONFIG.type,this.statsWidgets],[St.i.WIDGET_CONFIG.type,this.histogramWidgets],[St.s.WIDGET_CONFIG.type,this.renderConfigWidgets],[St.a.WIDGET_CONFIG.type,this.animatorWidgets],[St.n.WIDGET_CONFIG.type,this.layerListWidgets],[St.o.WIDGET_CONFIG.type,this.logWidgets],[St.q.WIDGET_CONFIG.type,this.regionListWidgets],[St.E.WIDGET_CONFIG.type,this.stokesAnalysisWidgets],[St.b.WIDGET_CONFIG.type,this.catalogWidgets],[St.d.WIDGET_CONFIG.type,this.catalogPlotWidgets],[St.y.WIDGET_CONFIG.type,this.spectralLineQueryWidgets]]),this.floatingWidgets=[],this.defaultFloatingWidgetOffset=100}static GetDefaultWidgetConfig(e){switch(e){case St.k.WIDGET_CONFIG.type:return St.k.WIDGET_CONFIG;case St.s.WIDGET_CONFIG.type:return St.s.WIDGET_CONFIG;case St.n.WIDGET_CONFIG.type:return St.n.WIDGET_CONFIG;case St.o.WIDGET_CONFIG.type:return St.o.WIDGET_CONFIG;case St.a.WIDGET_CONFIG.type:return St.a.WIDGET_CONFIG;case St.v.WIDGET_CONFIG.type:return St.v.WIDGET_CONFIG;case St.z.WIDGET_CONFIG.type:return St.z.WIDGET_CONFIG;case St.D.WIDGET_CONFIG.type:return St.D.WIDGET_CONFIG;case St.i.WIDGET_CONFIG.type:return St.i.WIDGET_CONFIG;case St.q.WIDGET_CONFIG.type:return St.q.WIDGET_CONFIG;case St.E.WIDGET_CONFIG.type:return St.E.WIDGET_CONFIG;case St.b.WIDGET_CONFIG.type:return St.b.WIDGET_CONFIG;case St.d.WIDGET_CONFIG.type:return St.d.WIDGET_CONFIG;case St.y.WIDGET_CONFIG.type:return St.y.WIDGET_CONFIG;default:return St.p.WIDGET_CONFIG}}static GetDefaultWidgetSettingsConfig(e){switch(e){case St.k.WIDGET_CONFIG.type:return St.m.WIDGET_CONFIG;case St.E.WIDGET_CONFIG.type:return St.F.WIDGET_CONFIG;case St.z.WIDGET_CONFIG.type:return St.A.WIDGET_CONFIG;case St.v.WIDGET_CONFIG.type:return St.w.WIDGET_CONFIG;case St.s.WIDGET_CONFIG.type:return St.t.WIDGET_CONFIG;case St.i.WIDGET_CONFIG.type:return St.j.WIDGET_CONFIG;case St.b.WIDGET_CONFIG.type:return St.c.WIDGET_CONFIG;default:return St.p.WIDGET_CONFIG}}static CreateDragSource(e,t,i){const n={type:"react-component",component:t.type,title:t.title,id:t.id,isClosable:t.isCloseable,props:{appStore:ne.a.Instance,id:t.id,docked:!0}},r=document.getElementById(i);r&&e.createDragSource(r,n)}updateImageWidgetTitle(e){const t=ne.a.Instance;let i;if(i=t.activeFrame?t.activeFrame.filename:"No image loaded",null===e||void 0===e?void 0:e.root){const t=e.root.getItemsByFilter((e=>e.config.component===St.k.WIDGET_CONFIG.type));t.length&&t[0].config&&t[0].config.title!==i&&t[0].setTitle(i)}const n=this.floatingWidgets.find((e=>e.type===St.k.WIDGET_CONFIG.type));n&&n.title!==i&&this.setWidgetTitle(n.id,i)}setWidgetTitle(e,t){const i=pl.Instance;if(i.dockedLayout&&i.dockedLayout.root){const n=i.dockedLayout.root.getItemsByFilter((t=>t.config.id===e));n.length&&n[0].setTitle(t)}const n=this.floatingWidgets.find((t=>t.id===e));n&&(n.title=t)}setWidgetComponentTitle(e,t){const i=pl.Instance;if(i.dockedLayout&&i.dockedLayout.root){const n=i.dockedLayout.root.getItemsById(e);n.length&&n[0].setTitle(t)}const n=this.floatingWidgets.find((t=>t.componentId===e));n&&(n.title=t)}changeWidgetId(e,t){const i=this.floatingWidgets.find((t=>t.id===e));i&&(i.id=t)}addSpatialProfileWidget(e=null,t=null){if(e||(e=this.getNextId(St.v.WIDGET_CONFIG.type)),e){const i=new Li.o;t&&i.init(t),this.spatialProfileWidgets.set(e,i)}return e}addSpectralProfileWidget(e=null,t=null){if(e||(e=this.getNextId(St.z.WIDGET_CONFIG.type)),e){const i=new Li.s;t&&i.init(t),this.spectralProfileWidgets.set(e,i)}return e}get spectralProfilerList(){return Array.from(this.spectralProfileWidgets.keys())}get hasSpectralProfiler(){return this.spectralProfileWidgets&&this.spectralProfileWidgets.size>0}get isSpectralWidgetStreamingData(){let e=!1;return this.spectralProfileWidgets.forEach((t=>{e=e||t.isStreamingData})),e}addStokesWidget(e=null,t=null){if(e||(e=this.getNextId(St.E.WIDGET_CONFIG.type)),e){const i=new Li.u;t&&i.init(t),this.stokesAnalysisWidgets.set(e,i)}return e}addCatalogWidget(e,t=null,i=null){const n=uc.Instance,r=n.catalogWidgets.get(e);if(r)return r;if(t||(t=this.getNextId(St.b.WIDGET_CONFIG.type)),t){const n=new Li.f(e);i&&n.init(i),this.catalogWidgets.set(t,n)}return n.catalogWidgets.set(e,t),t}addCatalogPlotWidget(e,t=null){return t||(t=this.getNextId(St.d.WIDGET_CONFIG.type)),t&&this.catalogPlotWidgets.set(t,new Li.d(e)),t}addSpectralLineQueryWidget(e=null){return e||(e=this.getNextId(St.y.WIDGET_CONFIG.type)),e&&this.spectralLineQueryWidgets.set(e,new Li.r),e}addFloatingSettingsWidget(e=null,t,i){return e||(e=this.getNextSettingId(i,t)),e&&this.floatingSettingsWidgets.set(e,t),e}addStatsWidget(e=null){return e||(e=this.getNextId(St.D.WIDGET_CONFIG.type)),e&&this.statsWidgets.set(e,new Li.t),e}addHistogramWidget(e=null,t=null){if(e||(e=this.getNextId(St.i.WIDGET_CONFIG.type)),e){const i=new Li.h;t&&i.init(t),this.histogramWidgets.set(e,i)}return e}addRenderConfigWidget(e=null,t=null){if(e||(e=this.getNextId(St.s.WIDGET_CONFIG.type)),e){const i=new Li.n;t&&i.init(t),this.renderConfigWidgets.set(e,i)}return e}addLogWidget(e=null){return e||(e=this.getNextId(St.o.WIDGET_CONFIG.type)),e&&this.logWidgets.set(e,new Li.g),e}addAnimatorWidget(e=null){return e||(e=this.getNextId(St.a.WIDGET_CONFIG.type)),e&&this.animatorWidgets.set(e,new Li.g),e}addRegionListWidget(e=null){return e||(e=this.getNextId(St.q.WIDGET_CONFIG.type)),e&&this.regionListWidgets.set(e,new Li.g),e}addLayerListWidget(e=null){return e||(e=this.getNextId(St.n.WIDGET_CONFIG.type)),e&&this.layerListWidgets.set(e,new Li.g),e}updateFloatingWidgetzIndexOnRemove(e){const t=this.floatingWidgets.length;if(e<t)for(let i=0;i<t;i++){const t=this.floatingWidgets[i].zIndex;t>e&&(this.floatingWidgets[i].zIndex=t-1)}}},Ss.staticInstance=void 0,Ss.RemoveRegionFromRegionWidgets=(e,t,i)=>{e.forEach((e=>{const n=e.regionIdMap.get(t);isFinite(n)&&n===i&&e.clearFrameEntry(t)}))},Xo=xs,$o=Object(S.a)(Xo.prototype,"floatingWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ko=Object(S.a)(Xo.prototype,"renderConfigWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qo=Object(S.a)(Xo.prototype,"spatialProfileWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Zo=Object(S.a)(Xo.prototype,"spectralProfileWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Jo=Object(S.a)(Xo.prototype,"statsWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),es=Object(S.a)(Xo.prototype,"histogramWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ts=Object(S.a)(Xo.prototype,"layerListWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),is=Object(S.a)(Xo.prototype,"logWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ns=Object(S.a)(Xo.prototype,"regionListWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rs=Object(S.a)(Xo.prototype,"animatorWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),os=Object(S.a)(Xo.prototype,"stokesAnalysisWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ss=Object(S.a)(Xo.prototype,"floatingSettingsWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),as=Object(S.a)(Xo.prototype,"catalogWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ls=Object(S.a)(Xo.prototype,"catalogPlotWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cs=Object(S.a)(Xo.prototype,"spectralLineQueryWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ds=Object(S.a)(Xo.prototype,"onCogPinedClick",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=t.component,r=t.title;if(-1===[St.k.WIDGET_CONFIG.type,St.E.WIDGET_CONFIG.type,St.z.WIDGET_CONFIG.type,St.v.WIDGET_CONFIG.type,St.s.WIDGET_CONFIG.type,St.i.WIDGET_CONFIG.type,St.b.WIDGET_CONFIG.type].indexOf(n))return;const o=vs.GetDefaultWidgetSettingsConfig(n);let s=new Ts(this.addFloatingSettingsWidget(null,i,o.type),o);s.title="image-view"===n?"Image View Settings":r+" Settings",s.parentId=i,s.parentType=n,s.id&&this.addFloatingWidget(s)}}}),us=Object(S.a)(Xo.prototype,"unpinWidget",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=t.component,r=t.title;if(n===St.k.WIDGET_CONFIG.type)return;let o=new Ts(i,vs.GetDefaultWidgetConfig(n));o.title=r,n===St.b.WIDGET_CONFIG.type&&(o.componentId=i);const s=e.container;if(s&&s.width&&s.height){o.setDefaultSize(25*Math.round(s.width/25),25*Math.round(s.height/25));const e=s._element[0];o.setDefaultPosition(25*Math.round(e.offsetLeft/25)+5,25*Math.round(e.offsetTop/25)-25)}this.addFloatingWidget(o);e.config.component="floated",e.remove()}}}),hs=Object(S.a)(Xo.prototype,"onHelpPinedClick",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{const i=t.config.component;let n=vs.GetDefaultWidgetConfig(i);if(n.helpType&&!Array.isArray(n.helpType)){const i=t.container;let r=0;i&&i.width&&(r=e.target.getBoundingClientRect().right+36-.5*i.width),xc.Instance.showHelpDrawer(n.helpType,r)}}}}),ps=Object(S.a)(Xo.prototype,"handleItemCreation",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=e.config,i=t.id,n=this.addWidgetByType(i);n&&(t.id=n,t.props.id=n)}}}),gs=Object(S.a)(Xo.prototype,"handleItemRemoval",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if("component"===e.config.type){const t=e.config,i=t.component===St.b.WIDGET_CONFIG.type,n=t.component===St.d.WIDGET_CONFIG.type,r=t.id;"floated"===t.component||i||n||this.removeWidget(r,t.component),i&&(uc.Instance.catalogProfiles.delete(r),this.removeAssociatedFloatingSetting(r)),n&&uc.Instance.clearCatalogPlotsByWidgetId(r)}}}}),fs=Object(S.a)(Xo.prototype,"handleStateUpdates",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(e&&e.origin&&e.origin.isMaximised&&e.origin.header){const t=e.origin.header;if(t.controlsContainer&&t.controlsContainer.length){const e=t.controlsContainer[0];if(e.children&&e.children.length){const t=e.children[e.children.length-1];t&&t.setAttribute("title","restore")}}}}}}),Object(S.a)(Xo.prototype,"updateImageWidgetTitle",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"updateImageWidgetTitle"),Xo.prototype),Object(S.a)(Xo.prototype,"setWidgetTitle",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"setWidgetTitle"),Xo.prototype),Object(S.a)(Xo.prototype,"setWidgetComponentTitle",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"setWidgetComponentTitle"),Xo.prototype),Object(S.a)(Xo.prototype,"changeWidgetId",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"changeWidgetId"),Xo.prototype),Object(S.a)(Xo.prototype,"addSpatialProfileWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addSpatialProfileWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addSpectralProfileWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addSpectralProfileWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"spectralProfilerList",[x.i],Object.getOwnPropertyDescriptor(Xo.prototype,"spectralProfilerList"),Xo.prototype),Object(S.a)(Xo.prototype,"hasSpectralProfiler",[x.i],Object.getOwnPropertyDescriptor(Xo.prototype,"hasSpectralProfiler"),Xo.prototype),Object(S.a)(Xo.prototype,"isSpectralWidgetStreamingData",[x.i],Object.getOwnPropertyDescriptor(Xo.prototype,"isSpectralWidgetStreamingData"),Xo.prototype),Object(S.a)(Xo.prototype,"addStokesWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addStokesWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addCatalogWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addCatalogWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addCatalogPlotWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addCatalogPlotWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addSpectralLineQueryWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addSpectralLineQueryWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addFloatingSettingsWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addFloatingSettingsWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addStatsWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addStatsWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addHistogramWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addHistogramWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addRenderConfigWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addRenderConfigWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addLogWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addLogWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addAnimatorWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addAnimatorWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addRegionListWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addRegionListWidget"),Xo.prototype),Object(S.a)(Xo.prototype,"addLayerListWidget",[x.g],Object.getOwnPropertyDescriptor(Xo.prototype,"addLayerListWidget"),Xo.prototype),bs=Object(S.a)(Xo.prototype,"selectFloatingWidget",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.findIndex((t=>t.id===e)),i=this.floatingWidgets.length;if(i>1&&t>=0&&t<i-1){const e=this.floatingWidgets[t];for(let n=0;n<i-1;n++)n>=t&&(this.floatingWidgets[n]=this.floatingWidgets[n+1]);this.floatingWidgets[i-1]=e}}}}),ms=Object(S.a)(Xo.prototype,"updateSelectFloatingWidgetzIndex",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.findIndex((t=>t.id===e)),i=this.floatingWidgets[t],n=this.floatingWidgets.length;if(n>1&&t>=0&&i.zIndex<n){for(let e=0;e<n;e++){let t=this.floatingWidgets[e].zIndex;t>=i.zIndex&&(this.floatingWidgets[e].zIndex=t-1)}this.floatingWidgets[t].zIndex=this.floatingWidgets.length}}}}),ys=Object(S.a)(Xo.prototype,"addFloatingWidget",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!((null===e||void 0===e?void 0:e.defaultX)>0&&(null===e||void 0===e?void 0:e.defaultY)>0)){const t=this.getFloatingWidgetOffset();e.setDefaultPosition(t,t)}e.zIndex=this.floatingWidgets.length+1,this.floatingWidgets.push(e)}}}),Os=Object(S.a)(Xo.prototype,"removeFloatingWidget",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{const i=this.floatingWidgets.find((t=>t.id===e));if(i){if(this.updateFloatingWidgetzIndexOnRemove(i.zIndex),this.floatingWidgets=this.floatingWidgets.filter((t=>t.id!==e)),t)return;this.removeWidget(e,i.type)}}}}),js=Object(S.a)(Xo.prototype,"removeFloatingWidgetComponent",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=this.floatingWidgets.find((t=>t.componentId===e));t&&(this.updateFloatingWidgetzIndexOnRemove(t.zIndex),this.floatingWidgets=this.floatingWidgets.filter((t=>t.componentId!==e)),this.removeAssociatedFloatingSetting(e))}}}),Xo);var As,Rs,Ps,Es,Fs,Ms,ks,Ds,Ns,Ls,_s,zs,Ws,Gs,Vs,Bs,Hs,qs,Ys,Us,Xs,$s,Ks,Qs,Zs,Js,ea,ta,ia,na,ra,oa,sa,aa,la,ca;const da=0;let ua;!function(e){e.Image="Image",e.World="World"}(ua||(ua={}));let ha=(As=x.q.shallow,ca=la=class e{static RegionTypeString(e){switch(e){case V.a.RegionType.POINT:return"Point";case V.a.RegionType.RECTANGLE:return"Rectangle";case V.a.RegionType.ELLIPSE:return"Ellipse";case V.a.RegionType.POLYGON:return"Polygon";default:return"Not Implemented"}}static IsRegionTypeValid(t){return e.AVAILABLE_REGION_TYPES.has(t)}static IsRegionLineWidthValid(t){return t>=e.MIN_LINE_WIDTH&&t<=e.MAX_LINE_WIDTH}static IsRegionDashLengthValid(t){return t>=0&&t<=e.MAX_DASH_LENGTH}get isTemporary(){return this.regionId<0}get center(){if(!this.isValid)return{x:0,y:0};switch(this.regionType){case V.a.RegionType.POINT:case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:return this.controlPoints[0];case V.a.RegionType.POLYGON:const e=Object(B.T)(this.controlPoints);return Object(B.S)(e.minPoint,e.maxPoint);default:return{x:0,y:0}}}get size(){switch(this.regionType){case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:return this.controlPoints[1];case V.a.RegionType.POLYGON:return this.boundingBox;default:return{x:void 0,y:void 0}}}get wcsSize(){const e=this.activeFrame;return this.size&&(null===e||void 0===e?void 0:e.validWcs)?e.getWcsSizeInArcsec(this.size):{x:void 0,y:void 0}}get boundingBox(){if(!this.isValid)return{x:0,y:0};switch(this.regionType){case V.a.RegionType.RECTANGLE:return this.size;case V.a.RegionType.ELLIPSE:return Object(B.eb)(this.size,2);case V.a.RegionType.POLYGON:const e=Object(B.T)(this.controlPoints);return Object(B.kb)(e.maxPoint,e.minPoint);default:return{x:0,y:0}}}get boundingBoxArea(){const e=this.boundingBox;return e.x*e.y}get isClosedRegion(){switch(this.regionType){case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:case V.a.RegionType.POLYGON:case V.a.RegionType.ANNULUS:return!0;default:return!1}}get isValid(){if(!this.controlPoints||!this.controlPoints.length)return!1;switch(this.regionType){case V.a.RegionType.POINT:return 1===this.controlPoints.length;case V.a.RegionType.RECTANGLE:case V.a.RegionType.ELLIPSE:return 2===this.controlPoints.length&&this.size.x>0&&this.size.y>0;case V.a.RegionType.POLYGON:return this.controlPoints.length>=1;default:return!1}}get nameString(){return this.regionId===da?"Cursor":this.name&&""!==this.name?this.name:`Region ${this.regionId}`}get regionProperties(){const e=this.center,t=isFinite(e.x)&&isFinite(e.y)?`${Object(B.mb)(e.x,6)}pix, ${Object(B.mb)(e.y,6)}pix`:"Invalid";switch(this.regionType){case V.a.RegionType.POINT:return`Point (pixel) [${t}]`;case V.a.RegionType.RECTANGLE:return`rotbox[[${t}], [${Object(B.mb)(this.size.x,6)}pix, ${Object(B.mb)(this.size.y,6)}pix], ${Object(B.mb)(this.rotation,6)}deg]`;case V.a.RegionType.ELLIPSE:return`ellipse[[${t}], [${Object(B.mb)(this.size.x,6)}pix, ${Object(B.mb)(this.size.y,6)}pix], ${Object(B.mb)(this.rotation,6)}deg]`;case V.a.RegionType.POLYGON:let e="poly[";return this.controlPoints.forEach(((t,i)=>{e+=isFinite(t.x)&&isFinite(t.y)?`[${Object(B.mb)(t.x,6)}pix, ${Object(B.mb)(t.y,6)}pix]`:"[Invalid]",e+=i!==this.controlPoints.length-1?", ":"]"})),e;default:return"Not Implemented"}}getRegionApproximation(t){let i=this.regionApproximationMap.get(t);if(!i){if(this.regionType===V.a.RegionType.POINT&&(i=[Object(B.nb)(t,this.center,!1)]),this.regionType===V.a.RegionType.ELLIPSE)i=Object(B.y)(t,this.center,this.size.y,this.size.x,this.rotation,e.TARGET_VERTEX_COUNT);else if(this.regionType===V.a.RegionType.RECTANGLE){let n=this.size.x/2,r=this.size.y/2;const o=this.rotation*Math.PI/180,s=[Object(B.f)(this.center,Object(B.cb)({x:-n,y:-r},o)),Object(B.f)(this.center,Object(B.cb)({x:+n,y:-r},o)),Object(B.f)(this.center,Object(B.cb)({x:+n,y:+r},o)),Object(B.f)(this.center,Object(B.cb)({x:-n,y:+r},o))];i=Object(B.z)(t,s,e.TARGET_VERTEX_COUNT)}else i=Object(B.z)(t,this.controlPoints,e.TARGET_VERTEX_COUNT,!this.creating);this.regionApproximationMap.set(t,i)}return i}constructor(e,t,i,n,r,o=-1,s=oo.a.TURQUOISE5,a=2,l=0,c=0,d=""){this.fileId=void 0,Object(j.a)(this,"regionId",Ps,this),Object(j.a)(this,"name",Es,this),Object(j.a)(this,"color",Fs,this),Object(j.a)(this,"lineWidth",Ms,this),Object(j.a)(this,"dashLength",ks,this),Object(j.a)(this,"regionType",Ds,this),Object(j.a)(this,"coordinate",Ns,this),Object(j.a)(this,"controlPoints",Ls,this),Object(j.a)(this,"rotation",_s,this),Object(j.a)(this,"editing",zs,this),Object(j.a)(this,"creating",Ws,this),Object(j.a)(this,"locked",Gs,this),Object(j.a)(this,"isSimplePolygon",Vs,this),Object(j.a)(this,"activeFrame",Bs,this),this.backendService=void 0,this.regionApproximationMap=void 0,this.modifiedTimestamp=void 0,Object(j.a)(this,"setRegionId",Hs,this),Object(j.a)(this,"setCenter",qs,this),Object(j.a)(this,"setSize",Ys,this),Object(j.a)(this,"setControlPoint",Us,this),Object(j.a)(this,"setControlPoints",Xs,this),Object(j.a)(this,"setRotation",$s,this),Object(j.a)(this,"setName",Ks,this),Object(j.a)(this,"setColor",Qs,this),Object(j.a)(this,"setLineWidth",Zs,this),Object(j.a)(this,"setDashLength",Js,this),Object(j.a)(this,"beginCreating",ea,this),Object(j.a)(this,"endCreating",ta,this),Object(j.a)(this,"beginEditing",ia,this),Object(j.a)(this,"endEditing",na,this),Object(j.a)(this,"toggleLock",ra,this),Object(j.a)(this,"setLocked",oa,this),Object(j.a)(this,"focusCenter",sa,this),Object(j.a)(this,"setCoordinate",aa,this),this.updateRegion=()=>{this.isValid&&(this.regionId===da&&this.regionType===V.a.RegionType.POINT?this.backendService.setCursor(this.fileId,this.center.x,this.center.y):this.backendService.setRegion(this.fileId,this.regionId,this).subscribe((e=>{e.success?console.log("Region updated"):console.log(e.message)})))},Object(x.p)(this),this.fileId=t,this.activeFrame=i,this.controlPoints=n,this.regionType=r,this.regionId=o,this.name=d,this.color=s,this.lineWidth=a,this.dashLength=l,this.rotation=c,this.backendService=e,i.validWcs?this.coordinate=ua.World:this.coordinate=ua.Image,this.regionApproximationMap=new Map,this.simplePolygonTest(),this.modifiedTimestamp=performance.now()}simplePolygonTest(e=-1){const t=this.controlPoints.slice();e>=0&&this.isSimplePolygon?this.isSimplePolygon=Object(B.hb)(t,e)&&Object(B.hb)(t,e-1):this.isSimplePolygon=Object(B.ib)(t)}},la.MIN_LINE_WIDTH=.5,la.MAX_LINE_WIDTH=10,la.MAX_DASH_LENGTH=50,la.TARGET_VERTEX_COUNT=200,la.AVAILABLE_REGION_TYPES=new Map([[V.a.RegionType.POINT,"Point"],[V.a.RegionType.RECTANGLE,"Rectangle"],[V.a.RegionType.ELLIPSE,"Ellipse"],[V.a.RegionType.POLYGON,"Polygon"]]),Rs=ca,Ps=Object(S.a)(Rs.prototype,"regionId",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Es=Object(S.a)(Rs.prototype,"name",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fs=Object(S.a)(Rs.prototype,"color",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ms=Object(S.a)(Rs.prototype,"lineWidth",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ks=Object(S.a)(Rs.prototype,"dashLength",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ds=Object(S.a)(Rs.prototype,"regionType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ns=Object(S.a)(Rs.prototype,"coordinate",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls=Object(S.a)(Rs.prototype,"controlPoints",[As],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_s=Object(S.a)(Rs.prototype,"rotation",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zs=Object(S.a)(Rs.prototype,"editing",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ws=Object(S.a)(Rs.prototype,"creating",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gs=Object(S.a)(Rs.prototype,"locked",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vs=Object(S.a)(Rs.prototype,"isSimplePolygon",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bs=Object(S.a)(Rs.prototype,"activeFrame",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(Rs.prototype,"isTemporary",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"isTemporary"),Rs.prototype),Object(S.a)(Rs.prototype,"center",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"center"),Rs.prototype),Object(S.a)(Rs.prototype,"size",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"size"),Rs.prototype),Object(S.a)(Rs.prototype,"wcsSize",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"wcsSize"),Rs.prototype),Object(S.a)(Rs.prototype,"boundingBox",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"boundingBox"),Rs.prototype),Object(S.a)(Rs.prototype,"boundingBoxArea",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"boundingBoxArea"),Rs.prototype),Object(S.a)(Rs.prototype,"isClosedRegion",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"isClosedRegion"),Rs.prototype),Object(S.a)(Rs.prototype,"isValid",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"isValid"),Rs.prototype),Object(S.a)(Rs.prototype,"nameString",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"nameString"),Rs.prototype),Object(S.a)(Rs.prototype,"regionProperties",[x.i],Object.getOwnPropertyDescriptor(Rs.prototype,"regionProperties"),Rs.prototype),Hs=Object(S.a)(Rs.prototype,"setRegionId",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionId=e}}}),qs=Object(S.a)(Rs.prototype,"setCenter",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.setControlPoint(0,e,t)}}}),Ys=Object(S.a)(Rs.prototype,"setSize",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.setControlPoint(1,e,t)}}}),Us=Object(S.a)(Rs.prototype,"setControlPoint",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i=!1)=>{e>=0&&e<this.controlPoints.length&&!Object(B.N)(t)&&isFinite(null===t||void 0===t?void 0:t.x)&&isFinite(null===t||void 0===t?void 0:t.y)&&(this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.controlPoints[e]=t,this.editing||i||this.updateRegion(),this.regionType===V.a.RegionType.POLYGON&&this.simplePolygonTest(e))}}}),Xs=Object(S.a)(Rs.prototype,"setControlPoints",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1,i=!0)=>{if(e.length){for(const t of e)if(Object(B.N)(t)||!isFinite(null===t||void 0===t?void 0:t.x)||!isFinite(null===t||void 0===t?void 0:t.y))return;this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.controlPoints=e,i&&this.regionType===V.a.RegionType.POLYGON&&this.simplePolygonTest(),this.editing||t||this.updateRegion()}}}}),$s=Object(S.a)(Rs.prototype,"setRotation",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>{this.rotation=(e+360)%360,this.regionApproximationMap.clear(),this.modifiedTimestamp=performance.now(),this.editing||t||this.updateRegion()}}}),Ks=Object(S.a)(Rs.prototype,"setName",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.name=e}}}),Qs=Object(S.a)(Rs.prototype,"setColor",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.color=e}}}),Zs=Object(S.a)(Rs.prototype,"setLineWidth",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.lineWidth=e}}}),Js=Object(S.a)(Rs.prototype,"setDashLength",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.dashLength=e}}}),ea=Object(S.a)(Rs.prototype,"beginCreating",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.creating=!0,this.editing=!0}}}),ta=Object(S.a)(Rs.prototype,"endCreating",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.creating=!1,this.editing=!1,this.regionType!==V.a.RegionType.POINT&&this.backendService.setRegion(this.fileId,-1,this).subscribe((e=>{e.success&&(console.log(`Updating regionID from ${this.regionId} to ${e.regionId}`),this.setRegionId(e.regionId))}))}}}),ia=Object(S.a)(Rs.prototype,"beginEditing",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.editing=!0}}}),na=Object(S.a)(Rs.prototype,"endEditing",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.editing=!1,this.updateRegion()}}}),ra=Object(S.a)(Rs.prototype,"toggleLock",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionId!==da&&(this.locked=!this.locked)}}}),oa=Object(S.a)(Rs.prototype,"setLocked",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionId!==da&&(this.locked=e)}}}),sa=Object(S.a)(Rs.prototype,"focusCenter",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{if(this.activeFrame&&(this.activeFrame.setCenter(this.center.x,this.center.y),this.activeFrame.renderWidth<this.activeFrame.zoomLevel*this.boundingBox.x||this.activeFrame.renderHeight<this.activeFrame.zoomLevel*this.boundingBox.y)){const e=.4*Math.min(this.activeFrame.renderWidth/this.boundingBox.x,this.activeFrame.renderHeight/this.boundingBox.y);this.activeFrame.setZoom(e)}}}}),aa=Object(S.a)(Rs.prototype,"setCoordinate",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&(this.coordinate=e)}}}),Rs);var pa,ga,fa,ba,ma,ya,Oa,ja,Sa,xa,Ca,Ia,wa,Ta,va,Aa,Ra,Pa;let Ea;!function(e){e[e.MOVING=0]="MOVING",e[e.CREATING=1]="CREATING"}(Ea||(Ea={}));let Fa=(pa=class{constructor(e,t,i){Object(j.a)(this,"regions",ga,this),Object(j.a)(this,"selectedRegion",fa,this),Object(j.a)(this,"mode",ba,this),Object(j.a)(this,"newRegionType",ma,this),this.frame=void 0,this.backendService=void 0,this.preference=void 0,this.getTempRegionId=()=>{let e=-1;if(this.regions.length){let t=Math.min(...this.regions.map((e=>e.regionId)));e=Math.min(e,t-1)}return e},Object(j.a)(this,"addPointRegion",ya,this),Object(j.a)(this,"addRectangularRegion",Oa,this),Object(j.a)(this,"addEllipticalRegion",ja,this),Object(j.a)(this,"addPolygonalRegion",Sa,this),Object(j.a)(this,"addExistingRegion",xa,this),Object(j.a)(this,"selectRegion",Ca,this),Object(j.a)(this,"selectRegionByIndex",Ia,this),Object(j.a)(this,"deselectRegion",wa,this),Object(j.a)(this,"deleteRegion",Ta,this),Object(j.a)(this,"setNewRegionType",va,this),Object(j.a)(this,"setMode",Aa,this),Object(j.a)(this,"toggleMode",Ra,this),Object(j.a)(this,"migrateRegionsFromExistingSet",Pa,this),Object(x.p)(this),this.frame=e,this.backendService=i,this.preference=t,this.regions=[],this.newRegionType=t.regionType,this.mode=Ea.MOVING,this.addPointRegion({x:0,y:0},!0),this.selectedRegion=this.regions[0]}addRegion(e,t,i,n=!1,r=this.getTempRegionId(),o=""){const s=new ha(this.backendService,this.frame.frameInfo.fileId,this.frame,e,i,r,this.preference.regionColor,this.preference.regionLineWidth,this.preference.regionDashLength,t,o);return this.regions.push(s),n||this.backendService.setRegion(this.frame.frameInfo.fileId,-1,s).subscribe((e=>{e.success&&(console.log(`Updating regionID from ${s.regionId} to ${e.regionId}`),s.setRegionId(e.regionId))})),s}},ga=Object(S.a)(pa.prototype,"regions",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fa=Object(S.a)(pa.prototype,"selectedRegion",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ba=Object(S.a)(pa.prototype,"mode",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ma=Object(S.a)(pa.prototype,"newRegionType",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ya=Object(S.a)(pa.prototype,"addPointRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion([e],0,V.a.RegionType.POINT,t,t?da:this.getTempRegionId())}}),Oa=Object(S.a)(pa.prototype,"addRectangularRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>this.addRegion([e,{x:t,y:i}],0,V.a.RegionType.RECTANGLE,n)}}),ja=Object(S.a)(pa.prototype,"addEllipticalRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n=!1)=>this.addRegion([e,{x:i,y:t}],0,V.a.RegionType.ELLIPSE,n)}}),Sa=Object(S.a)(pa.prototype,"addPolygonalRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t=!1)=>this.addRegion(e,0,V.a.RegionType.POLYGON,t)}}),xa=Object(S.a)(pa.prototype,"addExistingRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i,n,r,o,s,a)=>{const l=this.addRegion(e,t,i,!0,n,r);return o&&(l.color=o),s&&(l.lineWidth=s),(null===a||void 0===a?void 0:a.length)&&(l.dashLength=a[0]),l}}}),Ca=Object(S.a)(pa.prototype,"selectRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regions.indexOf(e)>=0&&(this.selectedRegion=e)}}}),Ia=Object(S.a)(pa.prototype,"selectRegionByIndex",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e>=0&&e<this.regions.length&&(this.selectedRegion=this.regions[e])}}}),wa=Object(S.a)(pa.prototype,"deselectRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.selectedRegion=null}}}),Ta=Object(S.a)(pa.prototype,"deleteRegion",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e&&e.regionId!==da&&this.regions.length&&(e===this.selectedRegion&&(this.selectedRegion=this.regions[0]),this.regions=this.regions.filter((t=>t!==e)),e.isTemporary||this.backendService.removeRegion(e.regionId))}}}),va=Object(S.a)(pa.prototype,"setNewRegionType",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.newRegionType=e}}}),Aa=Object(S.a)(pa.prototype,"setMode",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.mode=e}}}),Ra=Object(S.a)(pa.prototype,"toggleMode",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.mode=this.mode===Ea.MOVING?Ea.CREATING:Ea.MOVING}}}),Pa=Object(S.a)(pa.prototype,"migrateRegionsFromExistingSet",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i=!1)=>{var n;if((null===e||void 0===e||null===(n=e.regions)||void 0===n?void 0:n.length)<=1)return;let r=-1;for(const o of e.regions){if(!this.regions.find((e=>e.modifiedTimestamp===o.modifiedTimestamp)))if(o.regionId===da){const e=Object(B.nb)(t,o.center,i);this.regions.length&&this.regions[0].regionId===da&&this.regions[0].setCenter(e)}else{let e=[],n=0;if(o.regionType===V.a.RegionType.RECTANGLE||o.regionType===V.a.RegionType.ELLIPSE){const r=Object(B.nb)(t,o.center,i);if(!Object(B.N)(r)){const s=new Ni.Transform2D(t,r),a=Object(B.eb)(o.size,i?s.scale:1/s.scale);n=o.rotation+(i?1:-1)*s.rotation*180/Math.PI,e=[r,a]}}else if(o.regionType===V.a.RegionType.POINT||o.regionType===V.a.RegionType.POLYGON)for(const r of o.controlPoints){const n=Object(B.nb)(t,r,i);Object(B.N)(n)||e.push(n)}if(e.length){let t;o.regionType===V.a.RegionType.POINT?(t=this.addRegion(e,0,V.a.RegionType.POINT),t.setName(o.name),t.setColor(o.color)):(t=this.addExistingRegion(e,n,o.regionType,r,o.name,o.color,o.lineWidth,o.dashLength?[o.dashLength]:[]),t.endCreating()),t.setLocked(o.locked),t.modifiedTimestamp=o.modifiedTimestamp,r--}}}}}}),pa);var Ma,ka,Da,Na,La,_a,za,Wa,Ga,Va,Ba,Ha,qa,Ya,Ua,Xa,$a,Ka;let Qa;!function(e){e.SILENT_FILE_SORTING_STRING="fileSortingString",e.SILENT_FILE_FILTERING_TYPE="fileFilteringType",e.GLOBAL_THEME="theme",e.GLOBAL_AUTOLAUNCH="autoLaunch",e.GLOBAL_LAYOUT="layout",e.GLOBAL_CURSOR_POSITION="cursorPosition",e.GLOBAL_ZOOM_MODE="zoomMode",e.GLOBAL_ZOOM_POINT="zoomPoint",e.GLOBAL_DRAG_PANNING="dragPanning",e.GLOBAL_SPECTRAL_MATCHING_TYPE="spectralMatchingType",e.GLOBAL_AUTO_WCS_MATCHING="autoWCSMatching",e.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND="transparentImageBackground",e.RENDER_CONFIG_SCALING="scaling",e.RENDER_CONFIG_COLORMAP="colormap",e.RENDER_CONFIG_PERCENTILE="percentile",e.RENDER_CONFIG_SCALING_ALPHA="scalingAlpha",e.RENDER_CONFIG_SCALING_GAMMA="scalingGamma",e.RENDER_CONFIG_NAN_COLOR_HEX="nanColorHex",e.RENDER_CONFIG_NAN_ALPHA="nanAlpha",e.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE="contourGeneratorType",e.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE="contourSmoothingMode",e.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR="contourSmoothingFactor",e.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS="contourNumLevels",e.CONTOUR_CONFIG_CONTOUR_THICKNESS="contourThickness",e.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED="contourColormapEnabled",e.CONTOUR_CONFIG_CONTOUR_COLOR="contourColor",e.CONTOUR_CONFIG_CONTOUR_COLORMAP="contourColormap",e.WCS_OVERLAY_AST_COLOR="astColor",e.WCS_OVERLAY_AST_GRID_VISIBLE="astGridVisible",e.WCS_OVERLAY_AST_LABELS_VISIBLE="astLabelsVisible",e.WCS_OVERLAY_WCS_TYPE="wcsType",e.WCS_OVERLAY_BEAM_VISIBLE="beamVisible",e.WCS_OVERLAY_BEAM_COLOR="beamColor",e.WCS_OVERLAY_BEAM_TYPE="beamType",e.WCS_OVERLAY_BEAM_WIDTH="beamWidth",e.REGION_COLOR="regionColor",e.REGION_LINE_WIDTH="regionLineWidth",e.REGION_DASH_LENGTH="regionDashLength",e.REGION_TYPE="regionType",e.REGION_CREATION_MODE="regionCreationMode",e.REGION_SIZE="regionSize",e.PERFORMANCE_IMAGE_COMPRESSION_QUALITY="imageCompressionQuality",e.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY="animationCompressionQuality",e.PERFORMANCE_GPU_TILE_CACHE="GPUTileCache",e.PERFORMANCE_SYSTEM_TILE_CACHE="systemTileCache",e.PERFORMANCE_CONTOUR_DECIMATION="contourDecimation",e.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL="contourCompressionLevel",e.PERFORMANCE_CONTOUR_CHUNK_SIZE="contourChunkSize",e.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH="contourControlMapWidth",e.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING="streamContoursWhileZooming",e.PERFORMANCE_LOW_BAND_WIDTH_MODE="lowBandwidthMode",e.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES="stopAnimationPlaybackMinutes",e.LOG_EVENT="logEventList",e.CATALOG_DISPLAYED_COLUMN_SIZE="catalogDisplayedColumnSize",e.CATALOG_TABLE_SEPARATOR_POSITION="catalogTableSeparatorPosition"}(Qa||(Qa={}));const Za={SILENT:{fileSortingString:"-date",fileFilteringType:Ct.Fuzzy},GLOBAL:{theme:Ni.Theme.AUTO,autoLaunch:!0,layout:Ni.PresetLayout.DEFAULT,cursorPosition:Ni.CursorPosition.TRACKING,zoomMode:Ni.Zoom.FIT,zoomPoint:Ni.ZoomPoint.CURSOR,dragPanning:!0,spectralMatchingType:Ni.SpectralType.VRAD,autoWCSMatching:Ni.WCSMatchingType.NONE,transparentImageBackground:!1},RENDER_CONFIG:{scaling:Fo.a.LINEAR,colormap:"inferno",percentile:99.9,scalingAlpha:1e3,scalingGamma:1,nanColorHex:"#137CBD",nanAlpha:1},CONTOUR_CONFIG:{contourGeneratorType:Fe.StartStepMultiplier,contourSmoothingMode:V.a.SmoothingMode.GaussianBlur,contourSmoothingFactor:4,contourNumLevels:5,contourThickness:1,contourColormapEnabled:!1,contourColor:oo.a.GREEN3,contourColormap:"viridis"},WCS_OVERLAY:{astColor:4,astGridVisible:!1,astLabelsVisible:!0,wcsType:Ni.WCSType.AUTOMATIC,beamVisible:!0,beamColor:oo.a.GRAY3,beamType:po.Open,beamWidth:1},REGION:{regionColor:"#2EE6D6",regionLineWidth:2,regionDashLength:0,regionType:V.a.RegionType.RECTANGLE,regionCreationMode:Ni.RegionCreationMode.CENTER,regionSize:30},PERFORMANCE:{imageCompressionQuality:Ni.CompressionQuality.IMAGE_DEFAULT,animationCompressionQuality:Ni.CompressionQuality.ANIMATION_DEFAULT,GPUTileCache:Ni.TileCache.GPU_DEFAULT,systemTileCache:Ni.TileCache.SYSTEM_DEFAULT,contourDecimation:4,contourCompressionLevel:8,contourChunkSize:1e5,contourControlMapWidth:256,streamContoursWhileZooming:!1,lowBandwidthMode:!1,stopAnimationPlaybackMinutes:5},LOG_EVENT:{eventLoggingEnabled:[]},CATALOG:{catalogDisplayedColumnSize:10,catalogTableSeparatorPosition:"60%"}};let Ja=(Ka=$a=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}get theme(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_THEME))&&void 0!==e?e:Za.GLOBAL.theme}get autoLaunch(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_AUTOLAUNCH))&&void 0!==e?e:Za.GLOBAL.autoLaunch}get fileSortingString(){var e;return null!==(e=this.preferences.get(Qa.SILENT_FILE_SORTING_STRING))&&void 0!==e?e:Za.SILENT.fileSortingString}get fileFilteringType(){var e;return null!==(e=this.preferences.get(Qa.SILENT_FILE_FILTERING_TYPE))&&void 0!==e?e:Za.SILENT.fileFilteringType}get layout(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_LAYOUT))&&void 0!==e?e:Za.GLOBAL.layout}get cursorPosition(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_CURSOR_POSITION))&&void 0!==e?e:Za.GLOBAL.cursorPosition}get zoomMode(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_ZOOM_MODE))&&void 0!==e?e:Za.GLOBAL.zoomMode}get zoomPoint(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_ZOOM_POINT))&&void 0!==e?e:Za.GLOBAL.zoomPoint}get dragPanning(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_DRAG_PANNING))&&void 0!==e?e:Za.GLOBAL.dragPanning}get spectralMatchingType(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_SPECTRAL_MATCHING_TYPE))&&void 0!==e?e:Za.GLOBAL.spectralMatchingType}get autoWCSMatching(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_AUTO_WCS_MATCHING))&&void 0!==e?e:Za.GLOBAL.autoWCSMatching}get transparentImageBackground(){var e;return null!==(e=this.preferences.get(Qa.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND))&&void 0!==e?e:Za.GLOBAL.transparentImageBackground}get scaling(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_SCALING))&&void 0!==e?e:Za.RENDER_CONFIG.scaling}get colormap(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_COLORMAP))&&void 0!==e?e:Za.RENDER_CONFIG.colormap}get percentile(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_PERCENTILE))&&void 0!==e?e:Za.RENDER_CONFIG.percentile}get scalingAlpha(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_SCALING_ALPHA))&&void 0!==e?e:Za.RENDER_CONFIG.scalingAlpha}get scalingGamma(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_SCALING_GAMMA))&&void 0!==e?e:Za.RENDER_CONFIG.scalingGamma}get nanColorHex(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_NAN_COLOR_HEX))&&void 0!==e?e:Za.RENDER_CONFIG.nanColorHex}get nanAlpha(){var e;return null!==(e=this.preferences.get(Qa.RENDER_CONFIG_NAN_ALPHA))&&void 0!==e?e:Za.RENDER_CONFIG.nanAlpha}get contourGeneratorType(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourGeneratorType}get contourColormapEnabled(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourColormapEnabled}get contourColormap(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_COLORMAP))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourColormap}get contourColor(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_COLOR))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourColor}get contourSmoothingMode(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourSmoothingMode}get contourSmoothingFactor(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourSmoothingFactor}get contourNumLevels(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourNumLevels}get contourThickness(){var e;return null!==(e=this.preferences.get(Qa.CONTOUR_CONFIG_CONTOUR_THICKNESS))&&void 0!==e?e:Za.CONTOUR_CONFIG.contourThickness}get contourDecimation(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_CONTOUR_DECIMATION))&&void 0!==e?e:Za.PERFORMANCE.contourDecimation}get contourCompressionLevel(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL))&&void 0!==e?e:Za.PERFORMANCE.contourCompressionLevel}get contourChunkSize(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_CONTOUR_CHUNK_SIZE))&&void 0!==e?e:Za.PERFORMANCE.contourChunkSize}get astColor(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_AST_COLOR))&&void 0!==e?e:Za.WCS_OVERLAY.astColor}get astGridVisible(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_AST_GRID_VISIBLE))&&void 0!==e?e:Za.WCS_OVERLAY.astGridVisible}get astLabelsVisible(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_AST_LABELS_VISIBLE))&&void 0!==e?e:Za.WCS_OVERLAY.astLabelsVisible}get wcsType(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_WCS_TYPE))&&void 0!==e?e:Za.WCS_OVERLAY.wcsType}get beamVisible(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_BEAM_VISIBLE))&&void 0!==e?e:Za.WCS_OVERLAY.beamVisible}get beamColor(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_BEAM_COLOR))&&void 0!==e?e:Za.WCS_OVERLAY.beamColor}get beamType(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_BEAM_TYPE))&&void 0!==e?e:Za.WCS_OVERLAY.beamType}get beamWidth(){var e;return null!==(e=this.preferences.get(Qa.WCS_OVERLAY_BEAM_WIDTH))&&void 0!==e?e:Za.WCS_OVERLAY.beamWidth}get regionColor(){var e;return null!==(e=this.preferences.get(Qa.REGION_COLOR))&&void 0!==e?e:Za.REGION.regionColor}get regionLineWidth(){var e;return null!==(e=this.preferences.get(Qa.REGION_LINE_WIDTH))&&void 0!==e?e:Za.REGION.regionLineWidth}get regionDashLength(){var e;return null!==(e=this.preferences.get(Qa.REGION_DASH_LENGTH))&&void 0!==e?e:Za.REGION.regionDashLength}get regionType(){var e;return null!==(e=this.preferences.get(Qa.REGION_TYPE))&&void 0!==e?e:Za.REGION.regionType}get regionCreationMode(){var e;return null!==(e=this.preferences.get(Qa.REGION_CREATION_MODE))&&void 0!==e?e:Za.REGION.regionCreationMode}get regionSize(){var e;return null!==(e=this.preferences.get(Qa.REGION_SIZE))&&void 0!==e?e:Za.REGION.regionSize}get imageCompressionQuality(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_IMAGE_COMPRESSION_QUALITY))&&void 0!==e?e:Za.PERFORMANCE.imageCompressionQuality}get animationCompressionQuality(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY))&&void 0!==e?e:Za.PERFORMANCE.animationCompressionQuality}get gpuTileCache(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_GPU_TILE_CACHE))&&void 0!==e?e:Za.PERFORMANCE.GPUTileCache}get systemTileCache(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_SYSTEM_TILE_CACHE))&&void 0!==e?e:Za.PERFORMANCE.systemTileCache}get contourControlMapWidth(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH))&&void 0!==e?e:Za.PERFORMANCE.contourControlMapWidth}get streamContoursWhileZooming(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING))&&void 0!==e?e:Za.PERFORMANCE.streamContoursWhileZooming}get lowBandwidthMode(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_LOW_BAND_WIDTH_MODE))&&void 0!==e?e:Za.PERFORMANCE.lowBandwidthMode}get stopAnimationPlaybackMinutes(){var e;return null!==(e=this.preferences.get(Qa.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES))&&void 0!==e?e:Za.PERFORMANCE.stopAnimationPlaybackMinutes}get isSelectingAllLogEvents(){var e;return(null===(e=this.preferences.get(Qa.LOG_EVENT))||void 0===e?void 0:e.length)===Ni.Event.EVENT_NUMBER}get isSelectingIndeterminateLogEvents(){var e;const t=null===(e=this.preferences.get(Qa.LOG_EVENT))||void 0===e?void 0:e.length;return t>0&&t<Ni.Event.EVENT_NUMBER}get isZoomRAWMode(){return this.zoomMode===Ni.Zoom.FULL}get isRegionCornerMode(){return this.regionCreationMode===Ni.RegionCreationMode.CORNER}get isCursorFrozen(){return this.cursorPosition===Ni.CursorPosition.FIXED}get enabledLoggingEventNames(){var e;return null!==(e=this.preferences.get(Qa.LOG_EVENT))&&void 0!==e?e:[]}get catalogDisplayedColumnSize(){var e;return null!==(e=this.preferences.get(Qa.CATALOG_DISPLAYED_COLUMN_SIZE))&&void 0!==e?e:Za.CATALOG.catalogDisplayedColumnSize}get catalogTableSeparatorPosition(){var e;return null!==(e=this.preferences.get(Qa.CATALOG_TABLE_SEPARATOR_POSITION))&&void 0!==e?e:Za.CATALOG.catalogTableSeparatorPosition}constructor(){Object(j.a)(this,"preferences",ka,this),Object(j.a)(this,"supportsServer",Da,this),this.isEventLoggingEnabled=e=>{if(Ni.Event.isEventTypeValid(e)){const t=this.preferences.get(Qa.LOG_EVENT);if(t&&Array.isArray(t))return t.includes(e)}return!1},Object(j.a)(this,"setPreference",Na,this),Object(j.a)(this,"clearPreferences",La,this),Object(j.a)(this,"resetSilentSettings",_a,this),Object(j.a)(this,"resetGlobalSettings",za,this),Object(j.a)(this,"resetRenderConfigSettings",Wa,this),Object(j.a)(this,"resetContourConfigSettings",Ga,this),Object(j.a)(this,"resetOverlayConfigSettings",Va,this),Object(j.a)(this,"resetRegionSettings",Ba,this),Object(j.a)(this,"resetPerformanceSettings",Ha,this),Object(j.a)(this,"selectAllLogEvents",qa,this),Object(j.a)(this,"resetLogEventSettings",Ya,this),Object(j.a)(this,"resetCatalogSettings",Ua,this),Object(j.a)(this,"fetchPreferences",Xa,this),this.getPreferences=async()=>{const e=await oe.a.Instance.getPreferences();if(e){const t=Object.keys(e);for(const i of t){const t=e[i];this.preferences.set(i,t)}}},this.upgradePreferences=async()=>{if(!localStorage.getItem("preferences")){const t=[Qa.GLOBAL_THEME,Qa.GLOBAL_LAYOUT,Qa.GLOBAL_CURSOR_POSITION,Qa.GLOBAL_ZOOM_MODE,Qa.GLOBAL_ZOOM_POINT,Qa.GLOBAL_SPECTRAL_MATCHING_TYPE,Qa.RENDER_CONFIG_COLORMAP,Qa.RENDER_CONFIG_NAN_COLOR_HEX,Qa.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE,Qa.CONTOUR_CONFIG_CONTOUR_COLOR,Qa.CONTOUR_CONFIG_CONTOUR_COLORMAP,Qa.WCS_OVERLAY_WCS_TYPE,Qa.WCS_OVERLAY_BEAM_COLOR,Qa.WCS_OVERLAY_BEAM_TYPE,Qa.REGION_COLOR,Qa.REGION_CREATION_MODE,Qa.CATALOG_TABLE_SEPARATOR_POSITION],i=[Qa.GLOBAL_AUTO_WCS_MATCHING,Qa.RENDER_CONFIG_SCALING,Qa.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE,Qa.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR,Qa.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS,Qa.WCS_OVERLAY_AST_COLOR,Qa.REGION_DASH_LENGTH,Qa.REGION_TYPE,Qa.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,Qa.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,Qa.PERFORMANCE_GPU_TILE_CACHE,Qa.PERFORMANCE_SYSTEM_TILE_CACHE,Qa.PERFORMANCE_CONTOUR_DECIMATION,Qa.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,Qa.PERFORMANCE_CONTOUR_CHUNK_SIZE,Qa.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,Qa.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,Qa.CATALOG_DISPLAYED_COLUMN_SIZE],n=[Qa.RENDER_CONFIG_PERCENTILE,Qa.RENDER_CONFIG_SCALING_ALPHA,Qa.RENDER_CONFIG_SCALING_GAMMA,Qa.RENDER_CONFIG_NAN_ALPHA,Qa.CONTOUR_CONFIG_CONTOUR_THICKNESS,Qa.WCS_OVERLAY_BEAM_WIDTH,Qa.REGION_LINE_WIDTH],r=[Qa.GLOBAL_AUTOLAUNCH,Qa.GLOBAL_DRAG_PANNING,Qa.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND,Qa.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED,Qa.WCS_OVERLAY_AST_GRID_VISIBLE,Qa.WCS_OVERLAY_AST_LABELS_VISIBLE,Qa.WCS_OVERLAY_BEAM_VISIBLE,Qa.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,Qa.PERFORMANCE_LOW_BAND_WIDTH_MODE],o={};for(const e of t){const t=localStorage.getItem(e);t&&(o[e]=t)}for(const e of i){const t=parseInt(localStorage.getItem(e));isFinite(t)&&(o[e]=t)}for(const e of n){const t=parseFloat(localStorage.getItem(e));isFinite(t)&&(o[e]=t)}for(const e of r){localStorage.getItem(e)&&(o[e]=Object(B.X)(localStorage.getItem(e),!1))}const s=localStorage.getItem(Qa.LOG_EVENT);if(s)try{const e=JSON.parse(s);e&&Array.isArray(e)&&(o[Qa.LOG_EVENT]=e)}catch(e){console.log("Problem parsing log events")}o[Qa.WCS_OVERLAY_BEAM_TYPE]&&(o[Qa.WCS_OVERLAY_BEAM_TYPE]=o[Qa.WCS_OVERLAY_BEAM_TYPE].toLowerCase()),"1.0x"===o[Qa.GLOBAL_ZOOM_MODE]&&(o[Qa.GLOBAL_ZOOM_MODE]="full");for(const e of Object.keys(o))this.preferences.set(e,o[e]);o.version=1,await oe.a.Instance.setPreferences(o)}},Object(x.p)(this),this.preferences=new Map}},$a.staticInstance=void 0,Ma=Ka,ka=Object(S.a)(Ma.prototype,"preferences",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Da=Object(S.a)(Ma.prototype,"supportsServer",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(Ma.prototype,"theme",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"theme"),Ma.prototype),Object(S.a)(Ma.prototype,"autoLaunch",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"autoLaunch"),Ma.prototype),Object(S.a)(Ma.prototype,"fileSortingString",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"fileSortingString"),Ma.prototype),Object(S.a)(Ma.prototype,"fileFilteringType",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"fileFilteringType"),Ma.prototype),Object(S.a)(Ma.prototype,"layout",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"layout"),Ma.prototype),Object(S.a)(Ma.prototype,"cursorPosition",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"cursorPosition"),Ma.prototype),Object(S.a)(Ma.prototype,"zoomMode",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"zoomMode"),Ma.prototype),Object(S.a)(Ma.prototype,"zoomPoint",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"zoomPoint"),Ma.prototype),Object(S.a)(Ma.prototype,"dragPanning",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"dragPanning"),Ma.prototype),Object(S.a)(Ma.prototype,"spectralMatchingType",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"spectralMatchingType"),Ma.prototype),Object(S.a)(Ma.prototype,"autoWCSMatching",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"autoWCSMatching"),Ma.prototype),Object(S.a)(Ma.prototype,"transparentImageBackground",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"transparentImageBackground"),Ma.prototype),Object(S.a)(Ma.prototype,"scaling",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"scaling"),Ma.prototype),Object(S.a)(Ma.prototype,"colormap",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"colormap"),Ma.prototype),Object(S.a)(Ma.prototype,"percentile",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"percentile"),Ma.prototype),Object(S.a)(Ma.prototype,"scalingAlpha",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"scalingAlpha"),Ma.prototype),Object(S.a)(Ma.prototype,"scalingGamma",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"scalingGamma"),Ma.prototype),Object(S.a)(Ma.prototype,"nanColorHex",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"nanColorHex"),Ma.prototype),Object(S.a)(Ma.prototype,"nanAlpha",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"nanAlpha"),Ma.prototype),Object(S.a)(Ma.prototype,"contourGeneratorType",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourGeneratorType"),Ma.prototype),Object(S.a)(Ma.prototype,"contourColormapEnabled",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourColormapEnabled"),Ma.prototype),Object(S.a)(Ma.prototype,"contourColormap",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourColormap"),Ma.prototype),Object(S.a)(Ma.prototype,"contourColor",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourColor"),Ma.prototype),Object(S.a)(Ma.prototype,"contourSmoothingMode",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourSmoothingMode"),Ma.prototype),Object(S.a)(Ma.prototype,"contourSmoothingFactor",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourSmoothingFactor"),Ma.prototype),Object(S.a)(Ma.prototype,"contourNumLevels",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourNumLevels"),Ma.prototype),Object(S.a)(Ma.prototype,"contourThickness",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourThickness"),Ma.prototype),Object(S.a)(Ma.prototype,"contourDecimation",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourDecimation"),Ma.prototype),Object(S.a)(Ma.prototype,"contourCompressionLevel",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourCompressionLevel"),Ma.prototype),Object(S.a)(Ma.prototype,"contourChunkSize",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourChunkSize"),Ma.prototype),Object(S.a)(Ma.prototype,"astColor",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"astColor"),Ma.prototype),Object(S.a)(Ma.prototype,"astGridVisible",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"astGridVisible"),Ma.prototype),Object(S.a)(Ma.prototype,"astLabelsVisible",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"astLabelsVisible"),Ma.prototype),Object(S.a)(Ma.prototype,"wcsType",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"wcsType"),Ma.prototype),Object(S.a)(Ma.prototype,"beamVisible",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"beamVisible"),Ma.prototype),Object(S.a)(Ma.prototype,"beamColor",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"beamColor"),Ma.prototype),Object(S.a)(Ma.prototype,"beamType",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"beamType"),Ma.prototype),Object(S.a)(Ma.prototype,"beamWidth",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"beamWidth"),Ma.prototype),Object(S.a)(Ma.prototype,"regionColor",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"regionColor"),Ma.prototype),Object(S.a)(Ma.prototype,"regionLineWidth",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"regionLineWidth"),Ma.prototype),Object(S.a)(Ma.prototype,"regionDashLength",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"regionDashLength"),Ma.prototype),Object(S.a)(Ma.prototype,"regionType",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"regionType"),Ma.prototype),Object(S.a)(Ma.prototype,"regionCreationMode",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"regionCreationMode"),Ma.prototype),Object(S.a)(Ma.prototype,"regionSize",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"regionSize"),Ma.prototype),Object(S.a)(Ma.prototype,"imageCompressionQuality",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"imageCompressionQuality"),Ma.prototype),Object(S.a)(Ma.prototype,"animationCompressionQuality",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"animationCompressionQuality"),Ma.prototype),Object(S.a)(Ma.prototype,"gpuTileCache",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"gpuTileCache"),Ma.prototype),Object(S.a)(Ma.prototype,"systemTileCache",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"systemTileCache"),Ma.prototype),Object(S.a)(Ma.prototype,"contourControlMapWidth",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"contourControlMapWidth"),Ma.prototype),Object(S.a)(Ma.prototype,"streamContoursWhileZooming",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"streamContoursWhileZooming"),Ma.prototype),Object(S.a)(Ma.prototype,"lowBandwidthMode",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"lowBandwidthMode"),Ma.prototype),Object(S.a)(Ma.prototype,"stopAnimationPlaybackMinutes",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"stopAnimationPlaybackMinutes"),Ma.prototype),Object(S.a)(Ma.prototype,"isSelectingAllLogEvents",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"isSelectingAllLogEvents"),Ma.prototype),Object(S.a)(Ma.prototype,"isSelectingIndeterminateLogEvents",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"isSelectingIndeterminateLogEvents"),Ma.prototype),Object(S.a)(Ma.prototype,"isZoomRAWMode",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"isZoomRAWMode"),Ma.prototype),Object(S.a)(Ma.prototype,"isRegionCornerMode",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"isRegionCornerMode"),Ma.prototype),Object(S.a)(Ma.prototype,"isCursorFrozen",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"isCursorFrozen"),Ma.prototype),Object(S.a)(Ma.prototype,"enabledLoggingEventNames",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"enabledLoggingEventNames"),Ma.prototype),Object(S.a)(Ma.prototype,"catalogDisplayedColumnSize",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"catalogDisplayedColumnSize"),Ma.prototype),Object(S.a)(Ma.prototype,"catalogTableSeparatorPosition",[x.i],Object.getOwnPropertyDescriptor(Ma.prototype,"catalogTableSeparatorPosition"),Ma.prototype),Na=Object(S.a)(Ma.prototype,"setPreference",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async(e,t)=>{if(!e)return!1;if(e===Qa.LOG_EVENT){if(!Ni.Event.isEventTypeValid(t))return!1;let e=this.preferences.get(Qa.LOG_EVENT);return e&&Array.isArray(e)||(e=[]),e.includes(t)?e=e.filter((e=>e!==t)):e.push(t),this.preferences.set(Qa.LOG_EVENT,e),await oe.a.Instance.setPreference(Qa.LOG_EVENT,e)}return this.preferences.set(e,t),await oe.a.Instance.setPreference(e,t)}}}),La=Object(S.a)(Ma.prototype,"clearPreferences",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async e=>{for(const t of e)this.preferences.delete(t);await oe.a.Instance.clearPreferences(e)}}}),_a=Object(S.a)(Ma.prototype,"resetSilentSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.SILENT_FILE_SORTING_STRING,Qa.SILENT_FILE_FILTERING_TYPE])}}}),za=Object(S.a)(Ma.prototype,"resetGlobalSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.GLOBAL_THEME,Qa.GLOBAL_AUTOLAUNCH,Qa.GLOBAL_LAYOUT,Qa.GLOBAL_CURSOR_POSITION,Qa.GLOBAL_ZOOM_MODE,Qa.GLOBAL_ZOOM_POINT,Qa.GLOBAL_DRAG_PANNING,Qa.GLOBAL_SPECTRAL_MATCHING_TYPE,Qa.GLOBAL_AUTO_WCS_MATCHING,Qa.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND])}}}),Wa=Object(S.a)(Ma.prototype,"resetRenderConfigSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.RENDER_CONFIG_COLORMAP,Qa.RENDER_CONFIG_NAN_ALPHA,Qa.RENDER_CONFIG_NAN_COLOR_HEX,Qa.RENDER_CONFIG_PERCENTILE,Qa.RENDER_CONFIG_SCALING,Qa.RENDER_CONFIG_SCALING_ALPHA,Qa.RENDER_CONFIG_SCALING_GAMMA])}}}),Ga=Object(S.a)(Ma.prototype,"resetContourConfigSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.CONTOUR_CONFIG_CONTOUR_COLOR,Qa.CONTOUR_CONFIG_CONTOUR_COLORMAP,Qa.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED,Qa.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE,Qa.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS,Qa.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR,Qa.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE,Qa.CONTOUR_CONFIG_CONTOUR_THICKNESS])}}}),Va=Object(S.a)(Ma.prototype,"resetOverlayConfigSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.WCS_OVERLAY_AST_COLOR,Qa.WCS_OVERLAY_AST_GRID_VISIBLE,Qa.WCS_OVERLAY_AST_LABELS_VISIBLE,Qa.WCS_OVERLAY_BEAM_COLOR,Qa.WCS_OVERLAY_BEAM_TYPE,Qa.WCS_OVERLAY_BEAM_VISIBLE,Qa.WCS_OVERLAY_BEAM_WIDTH,Qa.WCS_OVERLAY_WCS_TYPE])}}}),Ba=Object(S.a)(Ma.prototype,"resetRegionSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.REGION_COLOR,Qa.REGION_CREATION_MODE,Qa.REGION_DASH_LENGTH,Qa.REGION_LINE_WIDTH,Qa.REGION_TYPE,Qa.REGION_SIZE])}}}),Ha=Object(S.a)(Ma.prototype,"resetPerformanceSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,Qa.PERFORMANCE_CONTOUR_CHUNK_SIZE,Qa.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,Qa.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,Qa.PERFORMANCE_CONTOUR_DECIMATION,Qa.PERFORMANCE_GPU_TILE_CACHE,Qa.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,Qa.PERFORMANCE_LOW_BAND_WIDTH_MODE,Qa.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,Qa.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,Qa.PERFORMANCE_SYSTEM_TILE_CACHE])}}}),qa=Object(S.a)(Ma.prototype,"selectAllLogEvents",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isSelectingAllLogEvents||this.isSelectingIndeterminateLogEvents?this.resetLogEventSettings():Ni.Event.EVENT_TYPES.forEach((e=>this.setPreference(Qa.LOG_EVENT,e)))}}}),Ya=Object(S.a)(Ma.prototype,"resetLogEventSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.LOG_EVENT])}}}),Ua=Object(S.a)(Ma.prototype,"resetCatalogSettings",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearPreferences([Qa.CATALOG_DISPLAYED_COLUMN_SIZE,Qa.CATALOG_TABLE_SEPARATOR_POSITION])}}}),Xa=Object(S.a)(Ma.prototype,"fetchPreferences",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{await this.upgradePreferences(),await this.getPreferences()}}}),Ma);var el,tl,il,nl,rl,ol,sl,al,ll,cl,dl,ul=i(416),hl=i(8);let pl=(dl=cl=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){this.layoutNameToBeSaved=void 0,Object(j.a)(this,"dockedLayout",tl,this),Object(j.a)(this,"currentLayoutName",il,this),Object(j.a)(this,"layouts",nl,this),Object(j.a)(this,"supportsServer",rl,this),this.layoutExists=e=>e&&this.allLayoutNames.includes(e),this.setLayoutToBeSaved=e=>{this.layoutNameToBeSaved=e||"Empty"},Object(j.a)(this,"fetchLayouts",ol,this),this.initLayoutsFromPresets=()=>{Ni.PresetLayout.PRESETS.forEach((e=>{const t=Ni.LayoutConfig.GetPresetConfig(e);t&&(this.layouts[e]=t)}))},Object(j.a)(this,"applyLayout",sl,this),Object(j.a)(this,"saveLayout",al,this),this.handleSaveResult=t=>{t?(hl.a.show(Object(hl.v)("layout-grid",`Layout ${this.layoutNameToBeSaved} saved successfully.`,e.ToasterTimeout)),this.currentLayoutName=this.layoutNameToBeSaved):(delete this.layouts[this.layoutNameToBeSaved],C.Instance.showAlert("Saving user-defined layout failed! "))},Object(j.a)(this,"deleteLayout",ll,this),this.handleDeleteResult=(t,i)=>{i?(hl.a.show(Object(hl.v)("layout-grid",`Layout ${t} deleted successfully.`,e.ToasterTimeout)),t===this.currentLayoutName&&(this.currentLayoutName="")):C.Instance.showAlert("Deleting user-defined layout failed!")},Object(x.p)(this),this.dockedLayout=null,this.layouts={},this.supportsServer=!1,this.initLayoutsFromPresets()}get allLayoutNames(){return this.layouts?Object.keys(this.layouts):[]}get userLayoutNames(){return this.layouts?Object.keys(this.layouts).filter((e=>!Ni.PresetLayout.isPreset(e))):[]}get orderedLayoutNames(){var e;let t=[...Ni.PresetLayout.PRESETS];return(null===(e=this.userLayoutNames)||void 0===e?void 0:e.length)?t.concat(this.userLayoutNames):t}get numSavedLayouts(){return this.userLayoutNames.length}},cl.staticInstance=void 0,cl.ToasterTimeout=1500,el=dl,tl=Object(S.a)(el.prototype,"dockedLayout",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),il=Object(S.a)(el.prototype,"currentLayoutName",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nl=Object(S.a)(el.prototype,"layouts",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rl=Object(S.a)(el.prototype,"supportsServer",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ol=Object(S.a)(el.prototype,"fetchLayouts",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return async()=>{try{const e=await oe.a.Instance.getLayouts();for(const t of Object.keys(e))t&&(this.layouts[t]=e[t])}catch(e){C.Instance.showAlert("Loading user-defined layout failed!"),console.log(e)}}}}),Object(S.a)(el.prototype,"allLayoutNames",[x.i],Object.getOwnPropertyDescriptor(el.prototype,"allLayoutNames"),el.prototype),Object(S.a)(el.prototype,"userLayoutNames",[x.i],Object.getOwnPropertyDescriptor(el.prototype,"userLayoutNames"),el.prototype),Object(S.a)(el.prototype,"orderedLayoutNames",[x.i],Object.getOwnPropertyDescriptor(el.prototype,"orderedLayoutNames"),el.prototype),Object(S.a)(el.prototype,"numSavedLayouts",[x.i],Object.getOwnPropertyDescriptor(el.prototype,"numSavedLayouts"),el.prototype),sl=Object(S.a)(el.prototype,"applyLayout",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(!e||!this.layoutExists(e))return C.Instance.showAlert(`Applying layout failed! Layout ${e} not found.`),!1;const t=this.layouts[e],i=ne.a.Instance;this.dockedLayout&&(i.widgetsStore.removeFloatingWidgets(),this.dockedLayout.destroy());let n={type:t.docked.type,content:[]},r=[];return Ni.LayoutConfig.CreateConfigToApply(n.content,t.docked.content,r),i.widgetsStore.initWidgets(r,t.floating),this.dockedLayout=new ul({settings:{showPopoutIcon:!1,showCloseIcon:!1},dimensions:{minItemWidth:250,minItemHeight:200,dragProxyWidth:600,dragProxyHeight:270},content:[n]},i.getAppContainer()),i.widgetsStore.initLayoutWithWidgets(this.dockedLayout),this.dockedLayout.init(),this.currentLayoutName=e,!0}}}),al=Object(S.a)(el.prototype,"saveLayout",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{const e=ne.a.Instance;if(!this.layouts||!this.layoutNameToBeSaved||!this.dockedLayout)return void e.alertStore.showAlert("Save layout failed! Empty layouts or name.");if(Ni.PresetLayout.isPreset(this.layoutNameToBeSaved))return void e.alertStore.showAlert("Layout name cannot be the same as system presets.");if(!this.layoutExists(this.layoutNameToBeSaved)&&this.numSavedLayouts>=10)return void e.alertStore.showAlert("Maximum user-defined layout quota exceeded! (10 layouts)");const t=this.dockedLayout.toConfig();if(!t||!t.content||t.content.length<=0)return void e.alertStore.showAlert("Saving layout failed! Something is wrong with current layout.");const i=Ni.LayoutConfig.CreateConfigToSave(e,t.content[0]);i?(this.layouts[this.layoutNameToBeSaved]=i,Ni.PresetLayout.isPreset(this.layoutNameToBeSaved)||e.apiService.setLayout(this.layoutNameToBeSaved,i).then((e=>{this.handleSaveResult(e)}),(e=>{console.log(e),this.handleSaveResult(!1)}))):e.alertStore.showAlert("Saving layout failed! Creat layout configuration for saving failed.")}}}),ll=Object(S.a)(el.prototype,"deleteLayout",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=ne.a.Instance;e&&this.layoutExists(e)?t.apiService.clearLayout(e).then((t=>{t&&(delete this.layouts[e],e===this.currentLayoutName&&(this.currentLayoutName="")),this.handleDeleteResult(e,t)}),(t=>{console.log(t),this.handleDeleteResult(e,!1)})):t.alertStore.showAlert(`Cannot delete layout ${e}! It does not exist.`)}}}),el);var gl,fl,bl,ml,yl,Ol,jl,Sl,xl,Cl,Il,wl,Tl,vl,Al,Rl,Pl,El,Fl,Ml,kl,Dl,Nl,Ll,_l,zl,Wl,Gl,Vl,Bl,Hl,ql,Yl,Ul,Xl,$l,Kl,Ql,Zl,Jl;let ec=(Jl=Zl=class e{constructor(){Object(j.a)(this,"regionDialogVisible",fl,this),Object(j.a)(this,"showRegionDialog",bl,this),Object(j.a)(this,"hideRegionDialog",ml,this),Object(j.a)(this,"hotkeyDialogVisible",yl,this),Object(j.a)(this,"showHotkeyDialog",Ol,this),Object(j.a)(this,"hideHotkeyDialog",jl,this),Object(j.a)(this,"aboutDialogVisible",Sl,this),Object(j.a)(this,"showAboutDialog",xl,this),Object(j.a)(this,"hideAboutDialog",Cl,this),Object(j.a)(this,"preferenceDialogVisible",Il,this),Object(j.a)(this,"showPreferenceDialog",wl,this),Object(j.a)(this,"hidePreferenceDialog",Tl,this),Object(j.a)(this,"saveLayoutDialogVisible",vl,this),Object(j.a)(this,"deleteLayoutDialogVisible",Al,this),Object(j.a)(this,"showSaveLayoutDialog",Rl,this),Object(j.a)(this,"hideSaveLayoutDialog",Pl,this),Object(j.a)(this,"showDeleteLayoutDialog",El,this),Object(j.a)(this,"hideDeleteLayoutDialog",Fl,this),Object(j.a)(this,"fileBrowserDialogVisible",Ml,this),Object(j.a)(this,"showFileBrowserDialog",kl,this),Object(j.a)(this,"hideFileBrowserDialog",Dl,this),Object(j.a)(this,"fileInfoDialogVisible",Nl,this),Object(j.a)(this,"selectedFileInfoDialogTab",Ll,this),Object(j.a)(this,"showFileInfoDialog",_l,this),Object(j.a)(this,"hideFileInfoDialog",zl,this),Object(j.a)(this,"setSelectedFileInfoDialogTab",Wl,this),Object(j.a)(this,"contourDialogVisible",Gl,this),Object(j.a)(this,"showContourDialog",Vl,this),Object(j.a)(this,"hideContourDialog",Bl,this),Object(j.a)(this,"debugExecutionDialogVisible",Hl,this),Object(j.a)(this,"showDebugExecutionDialog",ql,this),Object(j.a)(this,"hideDebugExecutionDialog",Yl,this),Object(j.a)(this,"externalPageDialogVisible",Ul,this),Object(j.a)(this,"externalPageDialogUrl",Xl,this),Object(j.a)(this,"externalPageDialogTitle",$l,this),Object(j.a)(this,"showExternalPageDialog",Kl,this),Object(j.a)(this,"hideExternalPageDialog",Ql,this),Object(x.p)(this)}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}},Zl.staticInstance=void 0,gl=Jl,fl=Object(S.a)(gl.prototype,"regionDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bl=Object(S.a)(gl.prototype,"showRegionDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionDialogVisible=!0}}}),ml=Object(S.a)(gl.prototype,"hideRegionDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionDialogVisible=!1}}}),yl=Object(S.a)(gl.prototype,"hotkeyDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ol=Object(S.a)(gl.prototype,"showHotkeyDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hotkeyDialogVisible=!0}}}),jl=Object(S.a)(gl.prototype,"hideHotkeyDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.hotkeyDialogVisible=!1}}}),Sl=Object(S.a)(gl.prototype,"aboutDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xl=Object(S.a)(gl.prototype,"showAboutDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.aboutDialogVisible=!0}}}),Cl=Object(S.a)(gl.prototype,"hideAboutDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.aboutDialogVisible=!1}}}),Il=Object(S.a)(gl.prototype,"preferenceDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wl=Object(S.a)(gl.prototype,"showPreferenceDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceDialogVisible=!0}}}),Tl=Object(S.a)(gl.prototype,"hidePreferenceDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.preferenceDialogVisible=!1}}}),vl=Object(S.a)(gl.prototype,"saveLayoutDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Al=Object(S.a)(gl.prototype,"deleteLayoutDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rl=Object(S.a)(gl.prototype,"showSaveLayoutDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveLayoutDialogVisible=!0}}}),Pl=Object(S.a)(gl.prototype,"hideSaveLayoutDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.saveLayoutDialogVisible=!1}}}),El=Object(S.a)(gl.prototype,"showDeleteLayoutDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.deleteLayoutDialogVisible=!0}}}),Fl=Object(S.a)(gl.prototype,"hideDeleteLayoutDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.deleteLayoutDialogVisible=!1}}}),Ml=Object(S.a)(gl.prototype,"fileBrowserDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),kl=Object(S.a)(gl.prototype,"showFileBrowserDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileBrowserDialogVisible=!0}}}),Dl=Object(S.a)(gl.prototype,"hideFileBrowserDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileBrowserDialogVisible=!1}}}),Nl=Object(S.a)(gl.prototype,"fileInfoDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ll=Object(S.a)(gl.prototype,"selectedFileInfoDialogTab",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return St.e.IMAGE_HEADER}}),_l=Object(S.a)(gl.prototype,"showFileInfoDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileInfoDialogVisible=!0}}}),zl=Object(S.a)(gl.prototype,"hideFileInfoDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileInfoDialogVisible=!1}}}),Wl=Object(S.a)(gl.prototype,"setSelectedFileInfoDialogTab",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFileInfoDialogTab=e}}}),Gl=Object(S.a)(gl.prototype,"contourDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Vl=Object(S.a)(gl.prototype,"showContourDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contourDialogVisible=!0}}}),Bl=Object(S.a)(gl.prototype,"hideContourDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.contourDialogVisible=!1}}}),Hl=Object(S.a)(gl.prototype,"debugExecutionDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),ql=Object(S.a)(gl.prototype,"showDebugExecutionDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.debugExecutionDialogVisible=!0}}}),Yl=Object(S.a)(gl.prototype,"hideDebugExecutionDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.debugExecutionDialogVisible=!1}}}),Ul=Object(S.a)(gl.prototype,"externalPageDialogVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Xl=Object(S.a)(gl.prototype,"externalPageDialogUrl",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$l=Object(S.a)(gl.prototype,"externalPageDialogTitle",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Kl=Object(S.a)(gl.prototype,"showExternalPageDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.externalPageDialogUrl=e,this.externalPageDialogTitle=t,this.externalPageDialogVisible=!0}}}),Ql=Object(S.a)(gl.prototype,"hideExternalPageDialog",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.externalPageDialogVisible=!1}}}),gl);var tc,ic,nc,rc,oc,sc,ac,lc,cc,dc;let uc=(dc=cc=class e{static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}constructor(){Object(j.a)(this,"catalogData",ic,this),Object(j.a)(this,"imageAssociatedCatalogId",nc,this),Object(j.a)(this,"catalogProfiles",rc,this),Object(j.a)(this,"catalogPlots",oc,this),Object(j.a)(this,"catalogProfileStores",sc,this),Object(j.a)(this,"catalogWidgets",ac,this),Object(j.a)(this,"updateCatalogProfiles",lc,this),Object(x.p)(this),this.catalogData=new x.b,this.imageAssociatedCatalogId=new Map,this.catalogProfiles=new Map,this.catalogPlots=new Map,this.catalogProfileStores=new Map,this.catalogWidgets=new Map}addCatalog(e){this.catalogData.set(e,{xImageCoords:[],yImageCoords:[],xSelectedCoords:[],ySelectedCoords:[],showSelectedData:!1,displayed:!0})}updateCatalogData(t,i,n,r,o,s,a){const l=this.catalogData.get(t);if(l){switch(a){case Ic.c.Pixel0:for(let e=0;e<i.length;e++)l.xImageCoords.push(i[e]),l.yImageCoords.push(n[e]);break;case Ic.c.Pixel1:for(let e=0;e<i.length;e++)l.xImageCoords.push(i[e]-1),l.yImageCoords.push(n[e]-1);break;default:const t=e.TransformCatalogData(i,n,r,o,s,a);for(let e=0;e<t.xImageCoords.length;e++)l.xImageCoords.push(t.xImageCoords[e]),l.yImageCoords.push(t.yImageCoords[e])}this.catalogData.set(t,{xImageCoords:l.xImageCoords,yImageCoords:l.yImageCoords,xSelectedCoords:l.xSelectedCoords,ySelectedCoords:l.ySelectedCoords,showSelectedData:l.showSelectedData,displayed:l.displayed})}}updateSelectedPoints(e,t,i){const n=this.catalogData.get(e);n&&this.catalogData.set(e,{xImageCoords:n.xImageCoords,yImageCoords:n.yImageCoords,xSelectedCoords:t,ySelectedCoords:i,showSelectedData:n.showSelectedData,displayed:n.displayed})}clearImageCoordsData(e){const t=this.catalogData.get(e);t&&(t.xImageCoords=[],t.yImageCoords=[],t.showSelectedData=!1)}removeCatalog(e){this.catalogData.delete(e)}updateShowSelectedData(e,t){const i=this.catalogData.get(e);i&&(i.showSelectedData=t)}updateImageAssociatedCatalogId(e,t){this.imageAssociatedCatalogId.set(e,t)}resetActiveCatalogFile(e){const t=this.imageAssociatedCatalogId.get(e),i=t||[];this.catalogProfiles.size&&(null===i||void 0===i?void 0:i.length)&&this.catalogProfiles.forEach(((e,t)=>{this.catalogProfiles.set(t,i[0])})),this.resetDisplayedData(i)}getImageIdbyCatalog(e){let t;return this.imageAssociatedCatalogId.forEach(((i,n)=>{i.includes(e)&&(t=n)})),t}resetDisplayedData(e){e.length?this.catalogData.forEach(((t,i)=>{let n=!0;e.includes(i)||(n=!1),this.catalogData.set(i,{xImageCoords:t.xImageCoords,yImageCoords:t.yImageCoords,xSelectedCoords:t.xSelectedCoords,ySelectedCoords:t.ySelectedCoords,showSelectedData:t.showSelectedData,displayed:n})})):this.catalogData.forEach(((e,t)=>{this.catalogData.set(t,{xImageCoords:e.xImageCoords,yImageCoords:e.yImageCoords,xSelectedCoords:e.xSelectedCoords,ySelectedCoords:e.ySelectedCoords,showSelectedData:e.showSelectedData,displayed:!1})}))}setCatalogPlots(e,t,i){let n=this.catalogPlots.get(e);n?n.set(t,i):(n=new x.b,n.set(t,i),this.catalogPlots.set(e,n))}clearCatalogPlotsByFileId(e){this.catalogPlots.forEach(((t,i)=>{const n=t.get(e);vs.Instance.catalogPlotWidgets.delete(n),t.delete(e)}))}clearCatalogPlotsByComponentId(e){const t=this.catalogPlots.get(e);t&&(t.forEach(((e,t)=>{vs.Instance.catalogPlotWidgets.delete(e)})),this.catalogPlots.delete(e))}clearCatalogPlotsByWidgetId(e){const t=this.getAssociatedIdByWidgetId(e);t.catalogPlotComponentId&&this.clearCatalogPlotsByComponentId(t.catalogPlotComponentId)}closeAssociatedCatalog(e){const t=this.imageAssociatedCatalogId.get(e);(null===t||void 0===t?void 0:t.length)&&(t.forEach((e=>{const t=this.catalogWidgets.get(e);t&&ne.a.Instance.removeCatalog(e,t)})),this.imageAssociatedCatalogId.delete(e))}get activeCatalogFiles(){const e=ne.a.Instance.activeFrame;if(e){const t=e.frameInfo.fileId;return this.imageAssociatedCatalogId.get(t)}return[]}getAssociatedIdByWidgetId(e){let t,i;return this.catalogPlots.forEach(((n,r)=>{n.forEach(((n,o)=>{n===e&&(t=r,i=o)}))})),{catalogPlotComponentId:t,catalogFileId:i}}getCatalogFileNames(e){let t=new Map;return e.forEach((e=>{const i=this.catalogProfileStores.get(e);if(i){const e=i.catalogInfo;t.set(e.fileId,e.fileInfo.name)}})),t}getCatalogWidgetStore(e){const t=vs.Instance;if(this.catalogWidgets.has(e)){const i=this.catalogWidgets.get(e);return t.catalogWidgets.get(i)}{const i=t.addCatalogWidget(e);return t.catalogWidgets.get(i)}}static GetFractionFromUnit(t){return e.ArcminUnits.includes(t)?Math.PI/10800:e.ArcsecUnits.includes(t)?Math.PI/648e3:Math.PI/180}static TransformCatalogData(t,i,n,r,o,s){if((null===t||void 0===t?void 0:t.length)===(null===i||void 0===i?void 0:i.length)&&(null===t||void 0===t?void 0:t.length)>0){const a=t.length;let l=e.GetFractionFromUnit(r.toLocaleLowerCase()),c=e.GetFractionFromUnit(o.toLocaleLowerCase()),d=Di.copy(n),u="System="+s;Di.set(d,u),s===Ic.c.FK4&&(Di.set(d,"Epoch=B1950"),Di.set(d,"Equinox=1950")),s===Ic.c.FK5&&(Di.set(d,"Epoch=J2000"),Di.set(d,"Equinox=2000"));const h=new Float64Array(a),p=new Float64Array(a);for(let e=0;e<a;e++)h[e]=t[e]*l,p[e]=i[e]*c;const g=Di.transformPointArrays(d,h,p,0);return Di.delete(d),{xImageCoords:g.x,yImageCoords:g.y}}return{xImageCoords:new Float64Array(0),yImageCoords:new Float64Array(0)}}},cc.staticInstance=void 0,cc.DegreeUnits=["deg","degrees"],cc.ArcsecUnits=["arcsec","arcsecond"],cc.ArcminUnits=["arcmin","arcminute"],tc=dc,ic=Object(S.a)(tc.prototype,"catalogData",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nc=Object(S.a)(tc.prototype,"imageAssociatedCatalogId",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rc=Object(S.a)(tc.prototype,"catalogProfiles",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oc=Object(S.a)(tc.prototype,"catalogPlots",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sc=Object(S.a)(tc.prototype,"catalogProfileStores",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ac=Object(S.a)(tc.prototype,"catalogWidgets",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(S.a)(tc.prototype,"addCatalog",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"addCatalog"),tc.prototype),Object(S.a)(tc.prototype,"updateCatalogData",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"updateCatalogData"),tc.prototype),Object(S.a)(tc.prototype,"updateSelectedPoints",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"updateSelectedPoints"),tc.prototype),Object(S.a)(tc.prototype,"clearImageCoordsData",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"clearImageCoordsData"),tc.prototype),Object(S.a)(tc.prototype,"removeCatalog",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"removeCatalog"),tc.prototype),Object(S.a)(tc.prototype,"updateShowSelectedData",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"updateShowSelectedData"),tc.prototype),Object(S.a)(tc.prototype,"updateImageAssociatedCatalogId",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"updateImageAssociatedCatalogId"),tc.prototype),Object(S.a)(tc.prototype,"resetActiveCatalogFile",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"resetActiveCatalogFile"),tc.prototype),lc=Object(S.a)(tc.prototype,"updateCatalogProfiles",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.catalogProfiles.size>0){const t=Array.from(this.catalogProfiles.keys());Array.from(this.catalogProfiles.values()).includes(e)||this.catalogProfiles.set(t[0],e)}}}}),Object(S.a)(tc.prototype,"resetDisplayedData",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"resetDisplayedData"),tc.prototype),Object(S.a)(tc.prototype,"setCatalogPlots",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"setCatalogPlots"),tc.prototype),Object(S.a)(tc.prototype,"clearCatalogPlotsByFileId",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"clearCatalogPlotsByFileId"),tc.prototype),Object(S.a)(tc.prototype,"clearCatalogPlotsByComponentId",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"clearCatalogPlotsByComponentId"),tc.prototype),Object(S.a)(tc.prototype,"clearCatalogPlotsByWidgetId",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"clearCatalogPlotsByWidgetId"),tc.prototype),Object(S.a)(tc.prototype,"closeAssociatedCatalog",[x.g],Object.getOwnPropertyDescriptor(tc.prototype,"closeAssociatedCatalog"),tc.prototype),Object(S.a)(tc.prototype,"activeCatalogFiles",[x.i],Object.getOwnPropertyDescriptor(tc.prototype,"activeCatalogFiles"),tc.prototype),tc);var hc,pc,gc,fc,bc,mc,yc,Oc,jc=i(44);let Sc,xc=(Oc=yc=class e{constructor(){Object(j.a)(this,"type",pc,this),Object(j.a)(this,"helpVisible",gc,this),Object(j.a)(this,"position",fc,this),Object(j.a)(this,"showHelpDrawer",bc,this),Object(j.a)(this,"hideHelpDrawer",mc,this),Object(x.p)(this)}static get Instance(){return e.staticInstance||(e.staticInstance=new e),e.staticInstance}},yc.staticInstance=void 0,hc=Oc,pc=Object(S.a)(hc.prototype,"type",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gc=Object(S.a)(hc.prototype,"helpVisible",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),fc=Object(S.a)(hc.prototype,"position",[x.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return jc.a.RIGHT}}),bc=Object(S.a)(hc.prototype,"showHelpDrawer",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.type=e,this.position=t>.5*document.body.clientWidth?jc.a.LEFT:jc.a.RIGHT,this.helpVisible=!0}}}),mc=Object(S.a)(hc.prototype,"hideHelpDrawer",[x.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.helpVisible=!1}}}),hc);!function(e){e.CONTOUR="contour",e.PREFERENCES="preferences",e.FILE_Browser="file-browser",e.FILE_INFO="file-info",e.SAVE_LAYOUT="save-layout",e.REGION_DIALOG="region-dialog",e.ANIMATOR="animator",e.HISTOGRAM="histogram",e.HISTOGRAM_SETTINGS="histogram-settings",e.IMAGE_VIEW="image-view",e.IMAGE_VIEW_SETTINGS="image-view-settings",e.LAYER_LIST="layer-list",e.LOG="log",e.PLACEHOLDER="placeholder",e.REGION_LIST="region-list",e.RENDER_CONFIG="render-config",e.RENDER_CONFIG_SETTINGS="render-config-settings",e.SPATIAL_PROFILER="spatial-profiler",e.SPATIAL_PROFILER_SETTINGS_STYLING="spatial-profiler-settings-styling",e.SPATIAL_PROFILER_SETTINGS_SMOOTHING="spatial-profiler-settings-smoothing",e.SPECTRAL_PROFILER="spectral-profiler",e.SPECTRAL_PROFILER_SETTINGS_CONVERSION="spectral-profiler-settings-conversion",e.SPECTRAL_PROFILER_SETTINGS_STYLING="spectral-profiler-settings-styling",e.SPECTRAL_PROFILER_SETTINGS_SMOOTHING="spectral-profiler-settings-smoothing",e.SPECTRAL_PROFILER_SETTINGS_MOMENTS="spectral-profiler-settings-moments",e.STATS="stats",e.STOKES_ANALYSIS="stoke-analysis",e.STOKES_ANALYSIS_SETTINGS_CONVERSION="stoke-analysis-settings-conversion",e.STOKES_ANALYSIS_SETTINGS_LINE_PLOT_STYLING="stoke-analysis-settings-line-plot-styling",e.STOKES_ANALYSIS_SETTINGS_SCATTER_PLOT_STYLING="stoke-analysis-settings-scatter-plot-styling",e.STOKES_ANALYSIS_SETTINGS_SMOOTHING="stoke-analysis-settings-smoothing",e.CATALOG_OVERLAY="catalog-overlay",e.CATALOG_HISTOGRAM_PLOT="catalog-histogram-plot",e.CATALOG_SCATTER_PLOT="catalog-scatter-plot",e.CATALOG_SETTINGS_GOLBAL="catalog-settings-golbal",e.CATALOG_SETTINGS_OVERLAY="catalog-settings-overlay",e.CATALOG_SETTINGS_COLOR="catalog-settings-color",e.SPECTRAL_LINE_QUERY="spectral-line-query"}(Sc||(Sc={}));var Cc=i(123),Ic=i(145)},524:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Layout","description":"Schema for CARTA Layout (Version 2)","$id":"carta_layout_2","definitions":{"percentage-value":{"description":"Describes a percentage value from 0 to 100","type":"number","minimum":0,"maximum":100},"plot-type":{"description":"Describes a plot type","enum":["Steps","Lines","Points"]},"line-width":{"description":"Describes a plot line width","type":"number","minimum":0.5,"maximum":10},"point-size":{"description":"Describes a plot point size","type":"number","minimum":0.5,"maximum":10},"opacity":{"description":"Describes an opacity value between zero and one","type":"number","minimum":0,"maximum":1},"spatial-coord":{"description":"Spatial coordinate","type":"string","enum":["x","Ix","Qx","Ux","Vx","y","Iy","Qy","Uy","Vy"]},"spectral-coord":{"description":"Spectral coordinate","type":"string","enum":["z","Iz","Qz","Uz","Vz"]},"basic-widget":{"description":"Widgets that have no associated settings","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"type":"string","enum":["layer-list","log","animator","region-list","image-view","stats","spectral-line-query","catalog-overlay","catalog-plot"]},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"spectral-profiler":{"description":"Spectral profiler widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"spectral-profiler"},"widgetSettings":{"properties":{"coordinate":{"$ref":"#/definitions/spectral-coord"},"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"spatial-profiler":{"description":"Spatial profiler widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"spatial-profiler"},"widgetSettings":{"properties":{"coordinate":{"$ref":"#/definitions/spatial-coord"},"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"wcsAxisVisible":{"type":"boolean"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"coord":{"description":"Legacy V1 entry (replaced by widgetSettings.coordinate","$ref":"#/definitions/spatial-coord"},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"render-config":{"description":"Render config widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"render-config"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"logScaleY":{"type":"boolean"},"markerTextVisible":{"type":"boolean"},"meanRmsVisible":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"histogram":{"description":"Histogram widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"histogram"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"logScaleY":{"type":"boolean"},"plotType":{"$ref":"#/definitions/plot-type"},"minXVal":{"type":"number"},"maxXVal":{"type":"number"},"minYVal":{"type":"number"},"maxYVal":{"type":"number"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"stokes":{"description":"Stokes analysis widgets","required":["type","id"],"properties":{"type":{"const":"component"},"id":{"const":"stokes"},"widgetSettings":{"properties":{"primaryLineColor":{"type":"string"},"secondaryLineColor":{"type":"string"},"lineWidth":{"$ref":"#/definitions/line-width"},"linePlotPointSize":{"$ref":"#/definitions/point-size"},"plotType":{"$ref":"#/definitions/plot-type"},"colorMap":{"type":"string"},"scatterPlotPointSize":{"$ref":"#/definitions/point-size"},"pointTransparency":{"$ref":"#/definitions/opacity"},"equalAxes":{"type":"boolean"}}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"}}},"carta-widget":{"description":"A CARTA widget","oneOf":[{"$ref":"#/definitions/basic-widget"},{"$ref":"#/definitions/spectral-profiler"},{"$ref":"#/definitions/spatial-profiler"},{"$ref":"#/definitions/render-config"},{"$ref":"#/definitions/histogram"},{"$ref":"#/definitions/stokes"}]},"gl-container":{"description":"A GoldenLayout container","type":"object","required":["type","content"],"additionalProperties":false,"properties":{"type":{"enum":["row","column","stack"]},"content":{"type":"array","minItems":1,"items":{"oneOf":[{"$ref":"#/definitions/gl-container"},{"$ref":"#/definitions/carta-widget"}]}},"width":{"$ref":"#/definitions/percentage-value"},"height":{"$ref":"#/definitions/percentage-value"},"activeItemIndex":{"type":"integer","minimum":0}}}},"required":["layoutVersion","docked","floating"],"properties":{"layoutVersion":{"description":"The version of the layout contained","type":"integer","minimum":1,"maximum":2},"docked":{"description":"GoldenLayout widget hierarchy","$ref":"#/definitions/gl-container"},"floating":{"description":"List of floating widgets","type":"array","items":{"allOf":[{"$ref":"#/definitions/carta-widget"},{"properties":{"defaultX":{"type":"number"},"defaultY":{"type":"number"},"defaultWidth":{"type":"number"},"defaultHeight":{"type":"number"}}}]}}}}')},53:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var n=i(3),r=i(36),o=i(5),s=(i(849),i(0));class a extends n.Component{render(){let e="custom-icon bp3-icon";o.e.Instance.darkTheme&&(e+=" dark-theme");const t=(this.props.size?this.props.size:a.SIZE_STANDARD)+"px",i=Object(s.jsx)("span",{className:e,children:Object(s.jsx)("svg",{width:t,height:t,viewBox:"0 0 16 16",children:l[this.props.icon]})});return Object(s.jsx)(r.w,{icon:i})}}a.SIZE_STANDARD=16,a.SIZE_LARGE=20;const l={contour:Object(s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 13.3086,13.326331 A 7.489923,8.4952736 45 0 1 2.0053593,14.037221 7.489923,8.4952736 45 0 1 2.7162497,2.7339802 7.489923,8.4952736 45 0 1 14.01949,2.02309 7.489923,8.4952736 45 0 1 13.3086,13.326331 Z M 13.148613,12.347604 A 6.6468272,7.6124401 40 0 1 3.1636657,13.906573 6.6468272,7.6124401 40 0 1 2.9650831,3.8026076 6.6468272,7.6124401 40 0 1 12.95003,2.2436383 6.6468272,7.6124401 40 0 1 13.148613,12.347604 Z M 10.882979,12.264102 A 4.8685541,5.7219758 50 0 1 3.3702451,12.212588 4.8685541,5.7219758 50 0 1 4.6240863,4.8050444 4.8685541,5.7219758 50 0 1 12.136821,4.8565581 4.8685541,5.7219758 50 0 1 10.882979,12.264102 Z M 10.33713,11.668778 A 4.0524521,4.8181229 50 0 1 4.0413674,11.66145 4.0524521,4.8181229 50 0 1 5.1273981,5.4600614 4.0524521,4.8181229 50 0 1 11.42316,5.4673901 4.0524521,4.8181229 50 0 1 10.33713,11.668778 Z M 7.9142814,10.852556 A 2.047241,2.547725 60 0 1 4.6842662,10.353456 2.047241,2.547725 60 0 1 5.8670405,7.3066306 2.047241,2.547725 60 0 1 9.0970556,7.8057308 2.047241,2.547725 60 0 1 7.9142814,10.852556 Z M 7.5029842,10.217581 A 1.2341059,1.684913 60 0 1 5.426754,9.9912708 1.2341059,1.684913 60 0 1 6.2688783,8.0800472 1.2341059,1.684913 60 0 1 8.3451088,8.3063578 1.2341059,1.684913 60 0 1 7.5029842,10.217581 Z"}),center:Object(s.jsxs)("g",{fillRule:"evenodd",clipRule:"evenodd",children:[Object(s.jsx)("circle",{className:"st0",cx:"8",cy:"8",r:"2"}),Object(s.jsx)("path",{className:"st0",d:"M2.6,4H2C1.4,4,1,4.4,1,5s0.4,1,1,1h3c0.1,0,0.3,0,0.4-0.1c0.2-0.1,0.4-0.3,0.5-0.5C6,5.2,6,5.1,6,5V2 c0-0.6-0.4-1-1-1S4,1.4,4,2v0.6L1.7,0.3c-0.4-0.4-1-0.4-1.4,0s-0.4,1,0,1.4L2.6,4z"}),Object(s.jsx)("path",{className:"st0",d:"M10.1,5.4c0.1,0.2,0.3,0.4,0.5,0.5S10.9,6,11.1,6h3c0.6,0,1-0.4,1-1s-0.4-1-1-1h-0.6l2.3-2.3 c0.4-0.4,0.4-1,0-1.4c-0.4-0.4-1-0.4-1.4,0L12,2.6V2c0-0.6-0.4-1-1-1s-1,0.4-1,1v3C10,5.1,10,5.2,10.1,5.4z"}),Object(s.jsx)("path",{className:"st0",d:"M13.4,12H14c0.6,0,1-0.4,1-1s-0.4-1-1-1h-3c-0.1,0-0.3,0-0.4,0.1c-0.2,0.1-0.4,0.3-0.5,0.5 C10,10.8,10,10.9,10,11v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-0.6l2.3,2.3c0.4,0.4,1,0.4,1.4,0c0.4-0.4,0.4-1,0-1.4L13.4,12z"}),Object(s.jsx)("path",{className:"st0",d:"M5.9,10.6c-0.1-0.2-0.3-0.4-0.5-0.5C5.2,10,5.1,10,4.9,10H2c-0.6,0-1,0.4-1,1s0.4,1,1,1h0.6l-2.3,2.3 c-0.4,0.4-0.4,1,0,1.4c0.4,0.4,1,0.4,1.4,0L4,13.4V14c0,0.6,0.4,1,1,1s1-0.4,1-1v-3C6,10.9,6,10.8,5.9,10.6z"})]}),regionList:Object(s.jsxs)("g",{children:[Object(s.jsx)("g",{id:"Layer_1-2","data-name":"Layer 1",children:Object(s.jsx)("path",{className:"cls-1",d:"M1,6H8A.9448.9448,0,0,0,9,5,.9448.9448,0,0,0,8,4H1A1,1,0,0,0,1,6Zm9,6H1a1,1,0,0,0,0,2h9a1,1,0,0,0,0-2Zm0-4H1a1,1,0,0,0,0,2h9a.9448.9448,0,0,0,1-1A.9448.9448,0,0,0,10,8Z"})}),Object(s.jsx)("path",{d:"M15.6169,5.6628a2.6806,2.6806,0,0,1-.0932-.4019,3.6675,3.6675,0,0,1-.04-.4307q-.0089-.2191-.0244-.43a3.8144,3.8144,0,0,0-.0694-.4062,1.2166,1.2166,0,0,0-.1382-.3533A.8941.8941,0,0,0,15,3.3679a1.0366,1.0366,0,0,0-.4106-.1623V3.1894a1.2325,1.2325,0,0,0,.7676-.5444,1.7581,1.7581,0,0,0,.24-.9262A1.3974,1.3974,0,0,0,15.13.6063,1.9077,1.9077,0,0,0,13.8339.2h-2.73V6h.7722V3.5223h1.8847a1.0267,1.0267,0,0,1,.4549.0852.7677.7677,0,0,1,.2763.2275.9485.9485,0,0,1,.154.3332q.0486.1908.0813.4022a2.9046,2.9046,0,0,1,.049.43q.0078.22.0158.41a2.4616,2.4616,0,0,0,.037.3455A.48.48,0,0,0,14.9386,6H15.8A.9979.9979,0,0,1,15.6169,5.6628ZM14.423,2.6735a1.1087,1.1087,0,0,1-.4264.1583,3.079,3.079,0,0,1-.5117.0406H11.8765V.85h1.9171a1.0026,1.0026,0,0,1,.788.276,1.0431,1.0431,0,0,1,.2433.7149,1.0608,1.0608,0,0,1-.11.516A.8646.8646,0,0,1,14.423,2.6735Z"})]}),spatialProfiler:Object(s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 8.3904279,2.3870306 6.5797618,4.9256964 h 0.961333 L 8.8850944,2.9283637 10.229094,4.9256964 h 1.017333 L 9.3797609,2.3216973 11.041094,0.10036468 h -0.952 L 8.8850944,1.7896974 7.7277615,0.10036468 h -1.017333 z M 13.818489,5.5696962 q -0.14,0.3546665 -0.28,0.5973331 -0.130667,0.2426666 -0.298667,0.3919999 -0.158666,0.1586666 -0.364,0.2239999 -0.196,0.074667 -0.457333,0.074667 -0.14,0 -0.28,-0.018667 -0.14,-0.018667 -0.270666, -0.065333 V 6.045696 q 0.102666,0.046667 0.233333,0.074667 0.14,0.037333 0.233333,0.037333 0.242667,0 0.401333,-0.1213333 0.168,-0.112 0.252,-0.3266666 L 13.314489,4.8976964 11.401156,0.10036468 h 0.896 l 1.409333, 3.94799862 h 0.01867 l 1.353333,-3.94799862 h 0.84 z"}),spectralProfiler:Object(s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 11.225128,5.0020008 v 0.6933355 h 4.650681 V 4.8953338 H 12.355798 L 15.726475,0.79932088 V 0.18065225 h -4.288013 v 0.80000253 h 3.114676 z"}),stokes:Object(s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0 c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563 c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312 c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563 c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M 12.043082,4.1413775 h -0.906669 q 0.02133,0.5120017 0.213334,0.8746695 0.192,0.3520011 0.512001,0.5760018 0.320001,0.213334 0.736003,0.3093343 0.416001,0.096 0.874669,0.096 0.416002,0 0.832003,-0.085334 0.426668,-0.074667 0.757336, -0.2773342 0.341334,-0.2026673 0.544001,-0.533335 0.213334,-0.3306677 0.213334,-0.8320026 0,-0.394668 -0.16,-0.6613355 Q 15.50976,3.341375 15.253759,3.1707078 15.008425,2.9893739 14.677757,2.8827069 14.357756,2.7760399 14.016422, 2.701373 13.696421,2.6267061 13.37642,2.5627059 13.056419,2.488039 12.800418,2.3920387 12.544417,2.2853717 12.37375,2.1360379 q -0.16,-0.1600005 -0.16,-0.3946679 0,-0.213334 0.106667,-0.3413344 0.106667,-0.1386672 0.277334,-0.2133341 0.170667, -0.085334 0.373334,-0.1173337 0.213334,-0.032 0.416002,-0.032 0.224,0 0.437334,0.053334 0.224001,0.042667 0.405335,0.1493338 0.181334,0.1066671 0.298668,0.288001 0.117333,0.1706672 0.138667,0.4373347 H 15.57376 Q 15.54176,1.4640358 15.360426, 1.133368 15.179092,0.79203363 14.869758,0.60003303 14.57109,0.39736572 14.176422,0.32269882 13.781755,0.23736521 13.31242,0.23736521 q -0.362668,0 -0.736003,0.0960003 -0.362667,0.0853336 -0.661335,0.27733421 -0.288001,0.1813339 -0.480002, 0.48000147 -0.181333,0.2986677 -0.181333,0.714669 0,0.533335 0.266667,0.8320026 0.266668,0.2986676 0.661335,0.4693348 0.405335,0.1600005 0.87467,0.2560008 0.469335,0.085334 0.864003,0.2026673 0.405334,0.106667 0.672002,0.2880009 0.266667, 0.1813339 0.266667,0.5333351 0,0.2560008 -0.128,0.426668 -0.128001,0.1600005 -0.330668,0.2453341 -0.192,0.085334 -0.426668,0.1173337 -0.234667,0.032 -0.448001,0.032 -0.277334,0 -0.544002,-0.053334 -0.256001,-0.053333 -0.469335, -0.1706672 -0.202667,-0.1280004 -0.330668,-0.3306677 -0.128,-0.213334 -0.138667,-0.5120017 z"}),spectralLineQuery:Object(s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"m12.773438,9.978644l-1.243281,0l-1.447656,-2.171484l-0.017031,0.008516c-0.153281,-0.229922 -0.400234,-0.391719 -0.698281,-0.391719c-0.366172,0 -0.672734,0.229922 -0.791953,0.553516l-0.008516,0l-1.439141,3.840547l-1.175156,-7.085l-0.017031,0c-0.068125,-0.400234 -0.400234,-0.715313 -0.826016,-0.715313c-0.349141,0 -0.655703,0.212891 -0.783437,0.519453l0,0l0,0c0,0 0,0 0,0l-2.333281,5.441484l-1.141094,0c-0.468359,0 -0.851562,0.383203 -0.851562,0.851563c0,0.468359 0.383203,0.851563 0.851562,0.851563l1.703125,0c0.349141,0 0.655703,-0.212891 0.783438,-0.519453l0,0l0,0c0,0 0,0 0,0l1.405078,-3.287031l1.22625,7.348984l0.017031,0c0.068125,0.400234 0.400234,0.715312 0.826016,0.715312c0.366172,0 0.672734,-0.229922 0.791953,-0.553516l0.008516,0l1.967109,-5.254141l0.783437,1.175156l0.017031,-0.008516c0.144766,0.221406 0.391719,0.383203 0.689766,0.383203l1.703125,0c0.468359,0 0.851563,-0.383203 0.851563,-0.851563c0,-0.468359 -0.383203,-0.851563 -0.851563,-0.851563z M15.766554,6.815244l-1.355908,-1.360986c0.355481,-0.553535 0.563692,-1.208637 0.563692,-1.909443c0,-1.965304 -1.58951,-3.554814 -3.554814,-3.554814s-3.554814,1.58951 -3.554814,3.554814s1.58951,3.554814 3.554814,3.554814c0.705885,0 1.360986,-0.213289 1.909443,-0.563692l1.360986,1.355908c0.137114,0.137114 0.33009,0.223445 0.5383,0.223445c0.421499,0 0.761746,-0.340247 0.761746,-0.761746c0,-0.208211 -0.086331,-0.401186 -0.223445,-0.5383zm-4.34703,-0.731276c-1.401613,0 -2.539153,-1.137541 -2.539153,-2.539153s1.137541,-2.539153 2.539153,-2.539153s2.539153,1.137541 2.539153,2.539153s-1.137541,2.539153 -2.539153,2.539153z"}),smoothing:Object(s.jsx)("path",{strokeWidth:"2.42095",strokeLinecap:"round",fill:"none",d:"M 1.413244,14.6062 H 3.9277429 V 8.378223 H 6.9751347 V 1.4946692 H 9.5085614 L 14.575415,14.576401"}),moments:Object(s.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M 0.81609227,1.2562455 V 14.58427 H 3.5600972 V 5.2322526 h 0.037333 L 6.8641032,14.58427 H 9.1227739 L 12.389446,5.1389191 h 0.03733 V 14.58427 h 2.744005 V 1.2562455 H 11.045444 L 8.0961054,10.421595 H 8.058772 L 4.941433,1.2562455 Z"})}},530:function(e,t){},532:function(e,t){},542:function(e,t){},544:function(e,t){},571:function(e,t){},572:function(e,t){},577:function(e,t){},579:function(e,t){},58:function(e,t,i){"use strict";i.d(t,"b",(function(){return h})),i.d(t,"a",(function(){return g}));var n=i(3),r=i(33),o=i(43),s=i.n(o),a=i(246),l=i(74),c=i(7),d=i(8),u=i(0);let h;!function(e){e[e.Automatic=0]="Automatic",e[e.Scientific=1]="Scientific",e[e.Integer=2]="Integer"}(h||(h={}));const p=i(246).Chart;p.defaults.multicolorLine=p.defaults.line,p.controllers.multicolorLine=p.controllers.line.extend({draw:function(e){let t=0;const i=this.getMeta(),n=i.data||[],r=this.getDataset().multicolorLineColors,o=this.chart.chartArea,s=i.dataset._children.filter((function(e){return!0}));if(r){for(let n=2;n<=r.length;n++)r[n-1]!==r[n]&&(a=r[n-1],i.dataset._view.borderColor=a,i.dataset._children=s.slice(t,n),i.dataset.draw(e),t=n-1);var a;for(let e=0;e<n.length;e++){n[e].draw(o)}}else p.controllers.line.prototype.draw.call(this,e)}});class g extends n.Component{constructor(...e){super(...e),this.plotRef=void 0,this.chartArea=void 0,this.afterChartLayout=e=>{if(this.props.isGroupSubPlot){var t=e.scales["x-axis-0"],i=e.scales["y-axis-0"];const n=e.width;e.chartArea.left=85,e.chartArea.right=n-1,t.left=85,t.right=n-1,t.width=t.right-t.left,t._startPixel=t.left,t._length=t.width,e.chartArea.left=85,e.chartArea.right=n-1,i.right=t.left,i.width=i.right-i.left}r.isEqual(e.chartArea,this.chartArea)||(this.chartArea=e.chartArea,this.props.chartAreaUpdated&&this.props.chartAreaUpdated(this.chartArea))},this.onRef=e=>{e!==this.plotRef&&(this.plotRef=e,this.props.plotRefUpdated&&this.props.plotRefUpdated(this.plotRef))},this.filterLogTicks=(e,t)=>{if(t&&t.length){let e=t.filter((e=>{const t=Math.floor(Math.log10(e)),i=e*Math.pow(10,t);return Math.abs(i%1)<1e-6}));return e.length>8&&(e=t.filter((e=>Math.abs(Math.log10(e)%1)<.001||Math.abs(Math.log10(e/2)%1)<.001)),e.length>8&&(e=t.filter((e=>Math.abs(Math.log10(e)%1)<.001)))),e}return null},this.filterLinearTicks=(e,t)=>{let i=!1,n=!1;if(t&&t.length>=4){const e=Math.abs(t[2]-t[1]);Math.abs(t[1]-t[0])<.999*e&&(i=!0),Math.abs(t[t.length-1]-t[t.length-2])<.999*e&&(n=!0);const r=t.length>3?t[2]-t[1]:t[1]-t[0];for(let i=1;i<t.length-1;i++){const e=t[i];if(t[i-1]*t[i+1]<0&&Math.abs(e)<Math.abs(.001*r)){t[i]=0;break}}}return t.slice(i?1:0,n?-1:void 0)}}static GetCallbackForTickType(e){switch(e){case h.Scientific:return g.FormatTicksScientific;case h.Integer:return g.FormatTicksInteger;default:return g.FormatTicksAutomatic}}shouldComponentUpdate(e){const t=this.props;if(t.width!==e.width)return!0;if(t.height!==e.height)return!0;if(t.lineColor!==e.lineColor)return!0;if(t.opacity!==e.opacity)return!0;if(t.tickTypeX!==e.tickTypeX)return!0;if(t.tickTypeY!==e.tickTypeY)return!0;if(t.darkMode!==e.darkMode)return!0;if(t.logY!==e.logY)return!0;if(t.xLabel!==e.xLabel)return!0;if(t.xMin!==e.xMin)return!0;if(t.xMax!==e.xMax)return!0;if(t.yMin!==e.yMin)return!0;if(t.yMax!==e.yMax)return!0;if(t.yLabel!==e.yLabel)return!0;if(t.showTopAxis!==e.showTopAxis)return!0;if(t.topAxisTickFormatter!==e.topAxisTickFormatter)return!0;if(t.showXAxisTicks!==e.showXAxisTicks)return!0;if(t.showXAxisLabel!==e.showXAxisLabel)return!0;if(t.xZeroLineColor!==e.xZeroLineColor)return!0;if(t.yZeroLineColor!==e.yZeroLineColor)return!0;if(t.showLegend!==e.showLegend)return!0;if(t.xTickMarkLength!==e.xTickMarkLength)return!0;if(t.plotType!==e.plotType)return!0;if(t.dataBackgroundColor!==e.dataBackgroundColor)return!0;if(t.isGroupSubPlot!==e.isGroupSubPlot)return!0;if(t.pointRadius!==e.pointRadius)return!0;if(t.zeroLineWidth!==e.zeroLineWidth)return!0;if(t.borderWidth!==e.borderWidth)return!0;if(!t.data||!e.data||t.data.length!==e.data.length)return!0;for(let i=0;i<t.data.length;i++)if(t.data[i].x!==e.data[i].x||t.data[i].y!==e.data[i].y)return!0;if(!t.multiColorSingleLineColors||!e.multiColorSingleLineColors||t.multiColorSingleLineColors.length!==e.multiColorSingleLineColors.length)return!0;for(let i=0;i<t.multiColorSingleLineColors.length;i++)if(t.multiColorSingleLineColors[i]!==e.multiColorSingleLineColors[i])return!0;return!r.isEqual(t.multiPlotPropsMap,e.multiPlotPropsMap)}render(){const e=this.props.darkMode?l.a.LIGHT_GRAY4:l.a.GRAY1,t=this.props.darkMode?l.a.DARK_GRAY5:l.a.LIGHT_GRAY1;let i=this.props.lineColor||(this.props.darkMode?l.a.BLUE4:l.a.BLUE2);const n=Object(c.k)(this.props.opacity||1,0,1);n<1&&(i=s()(i).setAlpha(n).toRgbString());let r={maintainAspectRatio:!1,events:["mousedown","mouseup","mousemove","dblclick"],legend:{display:void 0!==this.props.showLegend&&this.props.showLegend},scales:{xAxes:[{id:"x-axis-0",position:"bottom",afterBuildTicks:this.filterLinearTicks,scaleLabel:{fontColor:e,display:void 0===this.props.showXAxisLabel||this.props.showXAxisLabel,labelString:this.props.xLabel},ticks:{display:void 0===this.props.showXAxisTicks||this.props.showXAxisTicks,minor:{fontColor:e},maxRotation:0,min:this.props.xMin,max:this.props.xMax,callback:g.GetCallbackForTickType(this.props.tickTypeX)},gridLines:{drawBorder:!1,color:t,zeroLineColor:this.props.xZeroLineColor?this.props.xZeroLineColor:t,zeroLineWidth:this.props.zeroLineWidth?this.props.zeroLineWidth:1,tickMarkLength:0===this.props.xTickMarkLength?this.props.xTickMarkLength:10}},{id:"x-axis-1",position:"top",afterBuildTicks:this.filterLinearTicks,type:"linear",display:this.props.showTopAxis,ticks:{minor:{fontColor:e},maxRotation:0,min:this.props.xMin,max:this.props.xMax}}],yAxes:[{id:"y-axis-0",scaleLabel:{fontColor:e,display:void 0===this.props.showYAxisLabel||this.props.showYAxisLabel,labelString:this.props.yLabel},ticks:{minor:{fontColor:e},display:void 0===this.props.showYAxisTicks||this.props.showYAxisTicks,min:this.props.yMin,max:this.props.yMax,callback:g.GetCallbackForTickType(this.props.tickTypeY)},gridLines:{drawBorder:!1,color:t,zeroLineColor:this.props.yZeroLineColor?this.props.yZeroLineColor:t,zeroLineWidth:this.props.zeroLineWidth?this.props.zeroLineWidth:1}}]},animation:{duration:0}};this.props.topAxisTickFormatter&&(r.scales.xAxes[1].ticks.callback=this.props.topAxisTickFormatter),this.props.logY?(r.scales.yAxes[0].afterBuildTicks=this.filterLogTicks,r.scales.yAxes[0].type="logarithmic"):(r.scales.yAxes[0].afterBuildTicks=this.filterLinearTicks,r.scales.yAxes[0].type="linear");let o=[];if(this.props.data&&this.props.data.length){const e={label:"LineGraph",type:"line",data:this.props.data,fill:!1,lineTension:0,order:this.props.order?this.props.order:0};this.props.plotType===d.j.POINTS?(e.showLine=!1,e.borderWidth=0,e.borderColor="rgba(0, 0, 0, 0)",e.pointRadius=this.props.pointRadius?this.props.pointRadius:1,e.pointBackgroundColor=i):(e.pointRadius=0,e.showLine=!0,e.steppedLine=this.props.plotType===d.j.STEPS&&"middle",e.borderWidth=this.props.borderWidth?this.props.borderWidth:1,e.borderColor=i),this.props.multiColorSingleLineColors&&this.props.multiColorSingleLineColors.length&&(this.props.plotType===d.j.POINTS?e.pointBackgroundColor=this.props.multiColorSingleLineColors:(e.pointRadius=.5,e.pointStyle="line",e.type="multicolorLine",e.multicolorLineColors=this.props.multiColorSingleLineColors)),this.props.dataBackgroundColor&&(e.pointBackgroundColor=this.props.dataBackgroundColor),o.push(e)}this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0&&this.props.multiPlotPropsMap.forEach(((e,t)=>{let r=e.borderColor?e.borderColor:i;n<1&&(r=s()(r).setAlpha(n).toRgbString());const a={type:"line",label:t,data:e.data,fill:!1,lineTension:0,backgroundColor:r,order:e.order?e.order:0};this.props.multiColorMultiLinesColors&&this.props.multiColorMultiLinesColors.size&&(e.type===d.j.POINTS?(a.pointBackgroundColor=this.props.multiColorMultiLinesColors.get(t),a.borderColor=r,a.pointBorderColor="rgba(0, 0, 0, 0)"):a.multicolorLineColors=this.props.multiColorMultiLinesColors.get(t));let l=e.pointRadius?e.pointRadius:this.props.pointRadius,c=e.borderWidth?e.borderWidth:this.props.borderWidth;e.type===d.j.POINTS?(a.showLine=!1,a.pointStyle="circle",a.pointRadius=l||1,a.borderWidth=0):e.type!==d.j.LINES&&e.type!==d.j.STEPS||(a.showLine=!0,a.pointRadius=.5,a.pointStyle="line",a.steppedLine=e.type===d.j.STEPS&&"middle",a.borderWidth=c||1,a.type="multicolorLine",a.borderColor=r),o.push(a)}));let h=[{afterLayout:this.afterChartLayout}];return Object(u.jsx)(a.Scatter,{data:{datasets:o},options:r,plugins:h,ref:this.onRef})}}g.FormatTicksScientific=(e,t,i)=>Object(c.lb)(e,2),g.FormatTicksInteger=(e,t,i)=>Object(c.mb)(e),g.FormatTicksAutomatic=(e,t,i)=>e},586:function(e,t){},59:function(e,t,i){"use strict";i.d(t,"a",(function(){return H})),i.d(t,"b",(function(){return q}));var n,r,o,s,a,l,c,d,u,h,p,g,f,b,m,y,O,j,S,x,C,I,w,T,v,A,R,P,E,F,M,k,D,N,L,_,z,W=i(4),G=i(2),V=(i(28),i(1)),B=i(7);let H;!function(e){e[e.LINEAR=0]="LINEAR",e[e.LOG=1]="LOG",e[e.SQRT=2]="SQRT",e[e.SQUARE=3]="SQUARE",e[e.POWER=4]="POWER",e[e.GAMMA=5]="GAMMA",e[e.EXP=6]="EXP",e[e.CUSTOM=7]="CUSTOM"}(H||(H={}));let q=(z=_=class e{constructor(e,t){this.preference=e,Object(W.a)(this,"scaling",r,this),Object(W.a)(this,"colorMapIndex",o,this),Object(W.a)(this,"contrast",s,this),Object(W.a)(this,"bias",a,this),Object(W.a)(this,"gamma",l,this),Object(W.a)(this,"alpha",c,this),Object(W.a)(this,"inverted",d,this),Object(W.a)(this,"channelHistogram",u,this),Object(W.a)(this,"cubeHistogram",h,this),Object(W.a)(this,"useCubeHistogram",p,this),Object(W.a)(this,"useCubeHistogramContours",g,this),Object(W.a)(this,"cubeHistogramProgress",f,this),Object(W.a)(this,"selectedPercentile",b,this),Object(W.a)(this,"stokes",m,this),Object(W.a)(this,"scaleMin",y,this),Object(W.a)(this,"scaleMax",O,this),Object(W.a)(this,"visible",j,this),this.frame=void 0,Object(W.a)(this,"setStokes",S,this),Object(W.a)(this,"setUseCubeHistogram",x,this),Object(W.a)(this,"setUseCubeHistogramContours",C,this),Object(W.a)(this,"setPercentileRank",I,this),Object(W.a)(this,"updateChannelHistogram",w,this),Object(W.a)(this,"updateCubeHistogram",T,this),Object(W.a)(this,"setCustomScale",v,this),Object(W.a)(this,"setColorMapIndex",A,this),Object(W.a)(this,"setColorMap",R,this),Object(W.a)(this,"setScaling",P,this),Object(W.a)(this,"setGamma",E,this),Object(W.a)(this,"setAlpha",F,this),Object(W.a)(this,"setInverted",M,this),Object(W.a)(this,"setVisible",k,this),Object(W.a)(this,"toggleVisibility",D,this),Object(W.a)(this,"updateSiblings",N,this),Object(W.a)(this,"updateFrom",L,this),Object(V.p)(this),this.frame=t;const i=e.percentile;this.selectedPercentile=[i,i,i,i],this.bias=0,this.contrast=1,this.alpha=e.scalingAlpha,this.gamma=e.scalingGamma,this.scaling=e.scaling,this.inverted=!1,this.cubeHistogramProgress=0,this.setColorMap(e.colormap),this.stokes=0,this.scaleMin=[0,0,0,0],this.scaleMax=[1,1,1,1],this.visible=!0}static IsScalingValid(t){return e.SCALING_TYPES.has(t)}static IsGammaValid(t){return t>=e.GAMMA_MIN&&t<=e.GAMMA_MAX}static IsColormapValid(t){return e.COLOR_MAPS_SELECTED.includes(t)}static IsPercentileValid(t){return e.PERCENTILE_RANKS.includes(t)}get colorMap(){return this.colorMapIndex>=0&&this.colorMapIndex<=e.COLOR_MAPS_ALL.length-1?e.COLOR_MAPS_ALL[this.colorMapIndex]:"Unknown"}get scalingName(){const t=e.SCALING_TYPES.get(this.scaling);return t||"Unknown"}get histogram(){return this.useCubeHistogram&&this.cubeHistogram?this.cubeHistogram:this.channelHistogram}get contourHistogram(){return this.useCubeHistogramContours&&this.cubeHistogram?this.cubeHistogram:this.channelHistogram}get scaleMinVal(){return this.scaleMin[this.stokes]}get scaleMaxVal(){return this.scaleMax[this.stokes]}get selectedPercentileVal(){return this.selectedPercentile[this.stokes]}get histogramMin(){if(this.histogram)return this.histogram.firstBinCenter-.5*this.histogram.binWidth}get histogramMax(){if(this.histogram)return this.histogram.firstBinCenter+(this.histogram.bins.length+.5)*this.histogram.binWidth}},_.SCALING_TYPES=new Map([[H.LINEAR,"Linear"],[H.LOG,"Log"],[H.SQRT,"Square root"],[H.SQUARE,"Squared"],[H.GAMMA,"Gamma"],[H.POWER,"Power"]]),_.COLOR_MAPS_ALL=["accent","afmhot","autumn","binary","Blues","bone","BrBG","brg","BuGn","BuPu","bwr","CMRmap","cool","coolwarm","copper","cubehelix","dark2","flag","gist_earth","gist_gray","gist_heat","gist_ncar","gist_rainbow","gist_stern","gist_yarg","GnBu","gnuplot","gnuplot2","gray","greens","greys","hot","hsv","inferno","jet","magma","nipy_spectral","ocean","oranges","OrRd","paired","pastel1","pastel2","pink","PiYG","plasma","PRGn","prism","PuBu","PuBuGn","PuOr","PuRd","purples","rainbow","RdBu","RdGy","RdPu","RdYlBu","RdYlGn","reds","seismic","set1","set2","set3","spectral","spring","summer","tab10","tab20","tab20b","tab20c","terrain","viridis","winter","Wistia","YlGn","YlGnBu","YlOrBr","YlOrRd"],_.COLOR_MAPS_SELECTED=["afmhot","Blues","coolwarm","cubehelix","gist_heat","gist_stern","gnuplot","gnuplot2","gray","greens","greys","hot","inferno","jet","magma","nipy_spectral","plasma","rainbow","RdBu","RdGy","reds","seismic","spectral","tab10","viridis"],_.PERCENTILE_RANKS=[90,95,99,99.5,99.9,99.95,99.99,100],_.GAMMA_MIN=0,_.GAMMA_MAX=2,n=z,r=Object(G.a)(n.prototype,"scaling",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(G.a)(n.prototype,"colorMapIndex",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(G.a)(n.prototype,"contrast",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(G.a)(n.prototype,"bias",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=Object(G.a)(n.prototype,"gamma",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=Object(G.a)(n.prototype,"alpha",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=Object(G.a)(n.prototype,"inverted",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=Object(G.a)(n.prototype,"channelHistogram",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(G.a)(n.prototype,"cubeHistogram",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=Object(G.a)(n.prototype,"useCubeHistogram",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=Object(G.a)(n.prototype,"useCubeHistogramContours",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=Object(G.a)(n.prototype,"cubeHistogramProgress",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),b=Object(G.a)(n.prototype,"selectedPercentile",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=Object(G.a)(n.prototype,"stokes",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y=Object(G.a)(n.prototype,"scaleMin",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=Object(G.a)(n.prototype,"scaleMax",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=Object(G.a)(n.prototype,"visible",[V.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(G.a)(n.prototype,"colorMap",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"colorMap"),n.prototype),Object(G.a)(n.prototype,"scalingName",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"scalingName"),n.prototype),Object(G.a)(n.prototype,"histogram",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"histogram"),n.prototype),Object(G.a)(n.prototype,"contourHistogram",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"contourHistogram"),n.prototype),Object(G.a)(n.prototype,"scaleMinVal",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"scaleMinVal"),n.prototype),Object(G.a)(n.prototype,"scaleMaxVal",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"scaleMaxVal"),n.prototype),Object(G.a)(n.prototype,"selectedPercentileVal",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"selectedPercentileVal"),n.prototype),S=Object(G.a)(n.prototype,"setStokes",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.stokes=e}}}),x=Object(G.a)(n.prototype,"setUseCubeHistogram",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{e!==this.useCubeHistogram&&(this.useCubeHistogram=e,this.selectedPercentile[this.stokes]>0&&this.setPercentileRank(this.selectedPercentile[this.stokes]))}}}),C=Object(G.a)(n.prototype,"setUseCubeHistogramContours",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.useCubeHistogramContours=e}}}),Object(G.a)(n.prototype,"histogramMin",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"histogramMin"),n.prototype),Object(G.a)(n.prototype,"histogramMax",[V.i],Object.getOwnPropertyDescriptor(n.prototype,"histogramMax"),n.prototype),I=Object(G.a)(n.prototype,"setPercentileRank",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{if(this.selectedPercentile[this.stokes]=e,100===e)return this.scaleMin[this.stokes]=this.histogramMin,this.scaleMax[this.stokes]=this.histogramMax,this.updateSiblings(),!0;if(e<0||e>100)return!1;const t=100-e,i=Object(B.E)(this.histogram,[t,e]);return 2===i.length&&(this.scaleMin[this.stokes]=i[0],this.scaleMax[this.stokes]=i[1],this.updateSiblings(),!0)}}}),w=Object(G.a)(n.prototype,"updateChannelHistogram",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.channelHistogram=e,this.selectedPercentile[this.stokes]>0&&!this.useCubeHistogram&&this.setPercentileRank(this.selectedPercentile[this.stokes])}}}),T=Object(G.a)(n.prototype,"updateCubeHistogram",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.cubeHistogram=e,this.cubeHistogramProgress=t,this.selectedPercentile[this.stokes]>0&&this.useCubeHistogram&&this.setPercentileRank(this.selectedPercentile[this.stokes])}}}),v=Object(G.a)(n.prototype,"setCustomScale",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.scaleMin[this.stokes]=e,this.scaleMax[this.stokes]=t,this.selectedPercentile[this.stokes]=-1,this.updateSiblings()}}}),A=Object(G.a)(n.prototype,"setColorMapIndex",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.colorMapIndex=Object(B.k)(e,0,q.COLOR_MAPS_ALL.length-1)}}}),R=Object(G.a)(n.prototype,"setColorMap",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{const t=q.COLOR_MAPS_ALL.indexOf(e);t>=0&&this.setColorMapIndex(t)}}}),P=Object(G.a)(n.prototype,"setScaling",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{q.SCALING_TYPES.has(e)&&(this.scaling=e,this.updateSiblings())}}}),E=Object(G.a)(n.prototype,"setGamma",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.gamma=e,this.updateSiblings()}}}),F=Object(G.a)(n.prototype,"setAlpha",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.alpha=e,this.updateSiblings()}}}),M=Object(G.a)(n.prototype,"setInverted",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.inverted=e}}}),k=Object(G.a)(n.prototype,"setVisible",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.visible=e}}}),D=Object(G.a)(n.prototype,"toggleVisibility",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.visible=!this.visible}}}),N=Object(G.a)(n.prototype,"updateSiblings",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{var e;const t=null===(e=this.frame)||void 0===e?void 0:e.renderConfigSiblings;for(const i of t)i.renderConfig.updateFrom(this)}}}),L=Object(G.a)(n.prototype,"updateFrom",[V.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.scaling=e.scaling,this.alpha=e.alpha,this.gamma=e.gamma,this.scaleMin[this.stokes]=e.scaleMinVal,this.scaleMax[this.stokes]=e.scaleMaxVal,this.selectedPercentile[this.stokes]=-1}}}),n)},6:function(e,t,i){"use strict";i.d(t,"a",(function(){return l}));var n=i(21);const r=n.Reader,o=n.Writer,s=n.util,a=n.roots.default||(n.roots.default={}),l=a.CARTA=(()=>{const e={};return e.Point=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.x=0,e.prototype.y=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(13).float(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(21).float(e.y),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.Point;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.x=e.float();break;case 2:n.y=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.x&&e.hasOwnProperty("x")&&"number"!==typeof e.x?"x: number expected":null!=e.y&&e.hasOwnProperty("y")&&"number"!==typeof e.y?"y: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.Point)return e;let t=new a.CARTA.Point;return null!=e.x&&(t.x=Number(e.x)),null!=e.y&&(t.y=Number(e.y)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.x=0,i.y=0),null!=e.x&&e.hasOwnProperty("x")&&(i.x=t.json&&!isFinite(e.x)?String(e.x):e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=t.json&&!isFinite(e.y)?String(e.y):e.y),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfo=function(){function e(e){if(this.HDUList=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.type=0,e.prototype.size=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.HDUList=s.emptyArray,e.prototype.date=s.Long?s.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.size&&Object.hasOwnProperty.call(e,"size")&&t.uint32(25).sfixed64(e.size),null!=e.HDUList&&e.HDUList.length)for(let i=0;i<e.HDUList.length;++i)t.uint32(34).string(e.HDUList[i]);return null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(41).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FileInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.type=e.int32();break;case 3:n.size=e.sfixed64();break;case 4:n.HDUList&&n.HDUList.length||(n.HDUList=[]),n.HDUList.push(e.string());break;case 5:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.size&&e.hasOwnProperty("size")&&!s.isInteger(e.size)&&!(e.size&&s.isInteger(e.size.low)&&s.isInteger(e.size.high)))return"size: integer|Long expected";if(null!=e.HDUList&&e.hasOwnProperty("HDUList")){if(!Array.isArray(e.HDUList))return"HDUList: array expected";for(let t=0;t<e.HDUList.length;++t)if(!s.isString(e.HDUList[t]))return"HDUList: string[] expected"}return null==e.date||!e.hasOwnProperty("date")||s.isInteger(e.date)||e.date&&s.isInteger(e.date.low)&&s.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.CARTA.FileInfo)return e;let t=new a.CARTA.FileInfo;switch(null!=e.name&&(t.name=String(e.name)),e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}if(null!=e.size&&(s.Long?(t.size=s.Long.fromValue(e.size)).unsigned=!1:"string"===typeof e.size?t.size=parseInt(e.size,10):"number"===typeof e.size?t.size=e.size:"object"===typeof e.size&&(t.size=new s.LongBits(e.size.low>>>0,e.size.high>>>0).toNumber())),e.HDUList){if(!Array.isArray(e.HDUList))throw TypeError(".CARTA.FileInfo.HDUList: array expected");t.HDUList=[];for(let i=0;i<e.HDUList.length;++i)t.HDUList[i]=String(e.HDUList[i])}return null!=e.date&&(s.Long?(t.date=s.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new s.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.HDUList=[]),t.defaults){if(i.name="",i.type=t.enums===String?"CASA":0,s.Long){let e=new s.Long(0,0,!1);i.size=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.size=t.longs===String?"0":0;if(s.Long){let e=new s.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0}if(null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?a.CARTA.FileType[e.type]:e.type),null!=e.size&&e.hasOwnProperty("size")&&("number"===typeof e.size?i.size=t.longs===String?String(e.size):e.size:i.size=t.longs===String?s.Long.prototype.toString.call(e.size):t.longs===Number?new s.LongBits(e.size.low>>>0,e.size.high>>>0).toNumber():e.size),e.HDUList&&e.HDUList.length){i.HDUList=[];for(let t=0;t<e.HDUList.length;++t)i.HDUList[t]=e.HDUList[t]}return null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?s.Long.prototype.toString.call(e.date):t.longs===Number?new s.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfoExtended=function(){function e(e){if(this.stokesVals=[],this.headerEntries=[],this.computedEntries=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dimensions=0,e.prototype.width=0,e.prototype.height=0,e.prototype.depth=0,e.prototype.stokes=0,e.prototype.stokesVals=s.emptyArray,e.prototype.headerEntries=s.emptyArray,e.prototype.computedEntries=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.dimensions&&Object.hasOwnProperty.call(e,"dimensions")&&t.uint32(13).sfixed32(e.dimensions),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(21).sfixed32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(29).sfixed32(e.height),null!=e.depth&&Object.hasOwnProperty.call(e,"depth")&&t.uint32(37).sfixed32(e.depth),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(45).sfixed32(e.stokes),null!=e.stokesVals&&e.stokesVals.length)for(let i=0;i<e.stokesVals.length;++i)t.uint32(50).string(e.stokesVals[i]);if(null!=e.headerEntries&&e.headerEntries.length)for(let i=0;i<e.headerEntries.length;++i)a.CARTA.HeaderEntry.encode(e.headerEntries[i],t.uint32(58).fork()).ldelim();if(null!=e.computedEntries&&e.computedEntries.length)for(let i=0;i<e.computedEntries.length;++i)a.CARTA.HeaderEntry.encode(e.computedEntries[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FileInfoExtended;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.dimensions=e.sfixed32();break;case 2:n.width=e.sfixed32();break;case 3:n.height=e.sfixed32();break;case 4:n.depth=e.sfixed32();break;case 5:n.stokes=e.sfixed32();break;case 6:n.stokesVals&&n.stokesVals.length||(n.stokesVals=[]),n.stokesVals.push(e.string());break;case 7:n.headerEntries&&n.headerEntries.length||(n.headerEntries=[]),n.headerEntries.push(a.CARTA.HeaderEntry.decode(e,e.uint32()));break;case 8:n.computedEntries&&n.computedEntries.length||(n.computedEntries=[]),n.computedEntries.push(a.CARTA.HeaderEntry.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.dimensions&&e.hasOwnProperty("dimensions")&&!s.isInteger(e.dimensions))return"dimensions: integer expected";if(null!=e.width&&e.hasOwnProperty("width")&&!s.isInteger(e.width))return"width: integer expected";if(null!=e.height&&e.hasOwnProperty("height")&&!s.isInteger(e.height))return"height: integer expected";if(null!=e.depth&&e.hasOwnProperty("depth")&&!s.isInteger(e.depth))return"depth: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.stokesVals&&e.hasOwnProperty("stokesVals")){if(!Array.isArray(e.stokesVals))return"stokesVals: array expected";for(let t=0;t<e.stokesVals.length;++t)if(!s.isString(e.stokesVals[t]))return"stokesVals: string[] expected"}if(null!=e.headerEntries&&e.hasOwnProperty("headerEntries")){if(!Array.isArray(e.headerEntries))return"headerEntries: array expected";for(let t=0;t<e.headerEntries.length;++t){let i=a.CARTA.HeaderEntry.verify(e.headerEntries[t]);if(i)return"headerEntries."+i}}if(null!=e.computedEntries&&e.hasOwnProperty("computedEntries")){if(!Array.isArray(e.computedEntries))return"computedEntries: array expected";for(let t=0;t<e.computedEntries.length;++t){let i=a.CARTA.HeaderEntry.verify(e.computedEntries[t]);if(i)return"computedEntries."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.FileInfoExtended)return e;let t=new a.CARTA.FileInfoExtended;if(null!=e.dimensions&&(t.dimensions=0|e.dimensions),null!=e.width&&(t.width=0|e.width),null!=e.height&&(t.height=0|e.height),null!=e.depth&&(t.depth=0|e.depth),null!=e.stokes&&(t.stokes=0|e.stokes),e.stokesVals){if(!Array.isArray(e.stokesVals))throw TypeError(".CARTA.FileInfoExtended.stokesVals: array expected");t.stokesVals=[];for(let i=0;i<e.stokesVals.length;++i)t.stokesVals[i]=String(e.stokesVals[i])}if(e.headerEntries){if(!Array.isArray(e.headerEntries))throw TypeError(".CARTA.FileInfoExtended.headerEntries: array expected");t.headerEntries=[];for(let i=0;i<e.headerEntries.length;++i){if("object"!==typeof e.headerEntries[i])throw TypeError(".CARTA.FileInfoExtended.headerEntries: object expected");t.headerEntries[i]=a.CARTA.HeaderEntry.fromObject(e.headerEntries[i])}}if(e.computedEntries){if(!Array.isArray(e.computedEntries))throw TypeError(".CARTA.FileInfoExtended.computedEntries: array expected");t.computedEntries=[];for(let i=0;i<e.computedEntries.length;++i){if("object"!==typeof e.computedEntries[i])throw TypeError(".CARTA.FileInfoExtended.computedEntries: object expected");t.computedEntries[i]=a.CARTA.HeaderEntry.fromObject(e.computedEntries[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stokesVals=[],i.headerEntries=[],i.computedEntries=[]),t.defaults&&(i.dimensions=0,i.width=0,i.height=0,i.depth=0,i.stokes=0),null!=e.dimensions&&e.hasOwnProperty("dimensions")&&(i.dimensions=e.dimensions),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),null!=e.depth&&e.hasOwnProperty("depth")&&(i.depth=e.depth),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.stokesVals&&e.stokesVals.length){i.stokesVals=[];for(let t=0;t<e.stokesVals.length;++t)i.stokesVals[t]=e.stokesVals[t]}if(e.headerEntries&&e.headerEntries.length){i.headerEntries=[];for(let n=0;n<e.headerEntries.length;++n)i.headerEntries[n]=a.CARTA.HeaderEntry.toObject(e.headerEntries[n],t)}if(e.computedEntries&&e.computedEntries.length){i.computedEntries=[];for(let n=0;n<e.computedEntries.length;++n)i.computedEntries[n]=a.CARTA.HeaderEntry.toObject(e.computedEntries[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.HeaderEntry=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.value="",e.prototype.entryType=0,e.prototype.numericValue=0,e.prototype.comment="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),null!=e.entryType&&Object.hasOwnProperty.call(e,"entryType")&&t.uint32(24).int32(e.entryType),null!=e.numericValue&&Object.hasOwnProperty.call(e,"numericValue")&&t.uint32(33).double(e.numericValue),null!=e.comment&&Object.hasOwnProperty.call(e,"comment")&&t.uint32(42).string(e.comment),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.HeaderEntry;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.value=e.string();break;case 3:n.entryType=e.int32();break;case 4:n.numericValue=e.double();break;case 5:n.comment=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name))return"name: string expected";if(null!=e.value&&e.hasOwnProperty("value")&&!s.isString(e.value))return"value: string expected";if(null!=e.entryType&&e.hasOwnProperty("entryType"))switch(e.entryType){default:return"entryType: enum value expected";case 0:case 1:case 2:}return null!=e.numericValue&&e.hasOwnProperty("numericValue")&&"number"!==typeof e.numericValue?"numericValue: number expected":null!=e.comment&&e.hasOwnProperty("comment")&&!s.isString(e.comment)?"comment: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.HeaderEntry)return e;let t=new a.CARTA.HeaderEntry;switch(null!=e.name&&(t.name=String(e.name)),null!=e.value&&(t.value=String(e.value)),e.entryType){case"STRING":case 0:t.entryType=0;break;case"FLOAT":case 1:t.entryType=1;break;case"INT":case 2:t.entryType=2}return null!=e.numericValue&&(t.numericValue=Number(e.numericValue)),null!=e.comment&&(t.comment=String(e.comment)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.name="",i.value="",i.entryType=t.enums===String?"STRING":0,i.numericValue=0,i.comment=""),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.value&&e.hasOwnProperty("value")&&(i.value=e.value),null!=e.entryType&&e.hasOwnProperty("entryType")&&(i.entryType=t.enums===String?a.CARTA.EntryType[e.entryType]:e.entryType),null!=e.numericValue&&e.hasOwnProperty("numericValue")&&(i.numericValue=t.json&&!isFinite(e.numericValue)?String(e.numericValue):e.numericValue),null!=e.comment&&e.hasOwnProperty("comment")&&(i.comment=e.comment),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.IntBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(13).sfixed32(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(21).sfixed32(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.IntBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.sfixed32();break;case 2:n.max=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&!s.isInteger(e.min)?"min: integer expected":null!=e.max&&e.hasOwnProperty("max")&&!s.isInteger(e.max)?"max: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.IntBounds)return e;let t=new a.CARTA.IntBounds;return null!=e.min&&(t.min=0|e.min),null!=e.max&&(t.max=0|e.max),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FloatBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(13).float(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(21).float(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FloatBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.float();break;case 2:n.max=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&"number"!==typeof e.min?"min: number expected":null!=e.max&&e.hasOwnProperty("max")&&"number"!==typeof e.max?"max: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.FloatBounds)return e;let t=new a.CARTA.FloatBounds;return null!=e.min&&(t.min=Number(e.min)),null!=e.max&&(t.max=Number(e.max)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=t.json&&!isFinite(e.min)?String(e.min):e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=t.json&&!isFinite(e.max)?String(e.max):e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.DoubleBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.min&&Object.hasOwnProperty.call(e,"min")&&t.uint32(9).double(e.min),null!=e.max&&Object.hasOwnProperty.call(e,"max")&&t.uint32(17).double(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.DoubleBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.min=e.double();break;case 2:n.max=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&"number"!==typeof e.min?"min: number expected":null!=e.max&&e.hasOwnProperty("max")&&"number"!==typeof e.max?"max: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.DoubleBounds)return e;let t=new a.CARTA.DoubleBounds;return null!=e.min&&(t.min=Number(e.min)),null!=e.max&&(t.max=Number(e.max)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.min=0,i.max=0),null!=e.min&&e.hasOwnProperty("min")&&(i.min=t.json&&!isFinite(e.min)?String(e.min):e.min),null!=e.max&&e.hasOwnProperty("max")&&(i.max=t.json&&!isFinite(e.max)?String(e.max):e.max),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImageBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.xMin=0,e.prototype.xMax=0,e.prototype.yMin=0,e.prototype.yMax=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.xMin&&Object.hasOwnProperty.call(e,"xMin")&&t.uint32(13).sfixed32(e.xMin),null!=e.xMax&&Object.hasOwnProperty.call(e,"xMax")&&t.uint32(21).sfixed32(e.xMax),null!=e.yMin&&Object.hasOwnProperty.call(e,"yMin")&&t.uint32(29).sfixed32(e.yMin),null!=e.yMax&&Object.hasOwnProperty.call(e,"yMax")&&t.uint32(37).sfixed32(e.yMax),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ImageBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.xMin=e.sfixed32();break;case 2:n.xMax=e.sfixed32();break;case 3:n.yMin=e.sfixed32();break;case 4:n.yMax=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.xMin&&e.hasOwnProperty("xMin")&&!s.isInteger(e.xMin)?"xMin: integer expected":null!=e.xMax&&e.hasOwnProperty("xMax")&&!s.isInteger(e.xMax)?"xMax: integer expected":null!=e.yMin&&e.hasOwnProperty("yMin")&&!s.isInteger(e.yMin)?"yMin: integer expected":null!=e.yMax&&e.hasOwnProperty("yMax")&&!s.isInteger(e.yMax)?"yMax: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ImageBounds)return e;let t=new a.CARTA.ImageBounds;return null!=e.xMin&&(t.xMin=0|e.xMin),null!=e.xMax&&(t.xMax=0|e.xMax),null!=e.yMin&&(t.yMin=0|e.yMin),null!=e.yMax&&(t.yMax=0|e.yMax),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.xMin=0,i.xMax=0,i.yMin=0,i.yMax=0),null!=e.xMin&&e.hasOwnProperty("xMin")&&(i.xMin=e.xMin),null!=e.xMax&&e.hasOwnProperty("xMax")&&(i.xMax=e.xMax),null!=e.yMin&&e.hasOwnProperty("yMin")&&(i.yMin=e.yMin),null!=e.yMax&&e.hasOwnProperty("yMax")&&(i.yMax=e.yMax),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.AnimationFrame=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.stokes=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(21).sfixed32(e.stokes),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.AnimationFrame;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.stokes=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes)?"stokes: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.AnimationFrame)return e;let t=new a.CARTA.AnimationFrame;return null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.stokes=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpatialProfile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.start=0,e.prototype.end=0,e.prototype.rawValuesFp32=s.newBuffer([]),e.prototype.coordinate="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.start&&Object.hasOwnProperty.call(e,"start")&&t.uint32(13).sfixed32(e.start),null!=e.end&&Object.hasOwnProperty.call(e,"end")&&t.uint32(21).sfixed32(e.end),null!=e.rawValuesFp32&&Object.hasOwnProperty.call(e,"rawValuesFp32")&&t.uint32(26).bytes(e.rawValuesFp32),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(34).string(e.coordinate),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SpatialProfile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.start=e.sfixed32();break;case 2:n.end=e.sfixed32();break;case 3:n.rawValuesFp32=e.bytes();break;case 4:n.coordinate=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.start&&e.hasOwnProperty("start")&&!s.isInteger(e.start)?"start: integer expected":null!=e.end&&e.hasOwnProperty("end")&&!s.isInteger(e.end)?"end: integer expected":null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&!(e.rawValuesFp32&&"number"===typeof e.rawValuesFp32.length||s.isString(e.rawValuesFp32))?"rawValuesFp32: buffer expected":null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!s.isString(e.coordinate)?"coordinate: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SpatialProfile)return e;let t=new a.CARTA.SpatialProfile;return null!=e.start&&(t.start=0|e.start),null!=e.end&&(t.end=0|e.end),null!=e.rawValuesFp32&&("string"===typeof e.rawValuesFp32?s.base64.decode(e.rawValuesFp32,t.rawValuesFp32=s.newBuffer(s.base64.length(e.rawValuesFp32)),0):e.rawValuesFp32.length&&(t.rawValuesFp32=e.rawValuesFp32)),null!=e.coordinate&&(t.coordinate=String(e.coordinate)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.start=0,i.end=0,t.bytes===String?i.rawValuesFp32="":(i.rawValuesFp32=[],t.bytes!==Array&&(i.rawValuesFp32=s.newBuffer(i.rawValuesFp32))),i.coordinate=""),null!=e.start&&e.hasOwnProperty("start")&&(i.start=e.start),null!=e.end&&e.hasOwnProperty("end")&&(i.end=e.end),null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&(i.rawValuesFp32=t.bytes===String?s.base64.encode(e.rawValuesFp32,0,e.rawValuesFp32.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp32):e.rawValuesFp32),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralProfile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsType=0,e.prototype.rawValuesFp32=s.newBuffer([]),e.prototype.rawValuesFp64=s.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsType&&Object.hasOwnProperty.call(e,"statsType")&&t.uint32(16).int32(e.statsType),null!=e.rawValuesFp32&&Object.hasOwnProperty.call(e,"rawValuesFp32")&&t.uint32(26).bytes(e.rawValuesFp32),null!=e.rawValuesFp64&&Object.hasOwnProperty.call(e,"rawValuesFp64")&&t.uint32(34).bytes(e.rawValuesFp64),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SpectralProfile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:n.statsType=e.int32();break;case 3:n.rawValuesFp32=e.bytes();break;case 4:n.rawValuesFp64=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!s.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsType&&e.hasOwnProperty("statsType"))switch(e.statsType){default:return"statsType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}return null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&!(e.rawValuesFp32&&"number"===typeof e.rawValuesFp32.length||s.isString(e.rawValuesFp32))?"rawValuesFp32: buffer expected":null!=e.rawValuesFp64&&e.hasOwnProperty("rawValuesFp64")&&!(e.rawValuesFp64&&"number"===typeof e.rawValuesFp64.length||s.isString(e.rawValuesFp64))?"rawValuesFp64: buffer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SpectralProfile)return e;let t=new a.CARTA.SpectralProfile;switch(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsType){case"NumPixels":case 0:t.statsType=0;break;case"NanCount":case 1:t.statsType=1;break;case"Sum":case 2:t.statsType=2;break;case"FluxDensity":case 3:t.statsType=3;break;case"Mean":case 4:t.statsType=4;break;case"RMS":case 5:t.statsType=5;break;case"Sigma":case 6:t.statsType=6;break;case"SumSq":case 7:t.statsType=7;break;case"Min":case 8:t.statsType=8;break;case"Max":case 9:t.statsType=9;break;case"Extrema":case 10:t.statsType=10;break;case"Blc":case 11:t.statsType=11;break;case"Trc":case 12:t.statsType=12;break;case"MinPos":case 13:t.statsType=13;break;case"MaxPos":case 14:t.statsType=14;break;case"Blcf":case 15:t.statsType=15;break;case"Trcf":case 16:t.statsType=16;break;case"MinPosf":case 17:t.statsType=17;break;case"MaxPosf":case 18:t.statsType=18}return null!=e.rawValuesFp32&&("string"===typeof e.rawValuesFp32?s.base64.decode(e.rawValuesFp32,t.rawValuesFp32=s.newBuffer(s.base64.length(e.rawValuesFp32)),0):e.rawValuesFp32.length&&(t.rawValuesFp32=e.rawValuesFp32)),null!=e.rawValuesFp64&&("string"===typeof e.rawValuesFp64?s.base64.decode(e.rawValuesFp64,t.rawValuesFp64=s.newBuffer(s.base64.length(e.rawValuesFp64)),0):e.rawValuesFp64.length&&(t.rawValuesFp64=e.rawValuesFp64)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.coordinate="",i.statsType=t.enums===String?"NumPixels":0,t.bytes===String?i.rawValuesFp32="":(i.rawValuesFp32=[],t.bytes!==Array&&(i.rawValuesFp32=s.newBuffer(i.rawValuesFp32))),t.bytes===String?i.rawValuesFp64="":(i.rawValuesFp64=[],t.bytes!==Array&&(i.rawValuesFp64=s.newBuffer(i.rawValuesFp64)))),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),null!=e.statsType&&e.hasOwnProperty("statsType")&&(i.statsType=t.enums===String?a.CARTA.StatsType[e.statsType]:e.statsType),null!=e.rawValuesFp32&&e.hasOwnProperty("rawValuesFp32")&&(i.rawValuesFp32=t.bytes===String?s.base64.encode(e.rawValuesFp32,0,e.rawValuesFp32.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp32):e.rawValuesFp32),null!=e.rawValuesFp64&&e.hasOwnProperty("rawValuesFp64")&&(i.rawValuesFp64=t.bytes===String?s.base64.encode(e.rawValuesFp64,0,e.rawValuesFp64.length):t.bytes===Array?Array.prototype.slice.call(e.rawValuesFp64):e.rawValuesFp64),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StatisticsValue=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.statsType=0,e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.statsType&&Object.hasOwnProperty.call(e,"statsType")&&t.uint32(8).int32(e.statsType),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.StatisticsValue;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.statsType=e.int32();break;case 2:n.value=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.statsType&&e.hasOwnProperty("statsType"))switch(e.statsType){default:return"statsType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value?"value: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.StatisticsValue)return e;let t=new a.CARTA.StatisticsValue;switch(e.statsType){case"NumPixels":case 0:t.statsType=0;break;case"NanCount":case 1:t.statsType=1;break;case"Sum":case 2:t.statsType=2;break;case"FluxDensity":case 3:t.statsType=3;break;case"Mean":case 4:t.statsType=4;break;case"RMS":case 5:t.statsType=5;break;case"Sigma":case 6:t.statsType=6;break;case"SumSq":case 7:t.statsType=7;break;case"Min":case 8:t.statsType=8;break;case"Max":case 9:t.statsType=9;break;case"Extrema":case 10:t.statsType=10;break;case"Blc":case 11:t.statsType=11;break;case"Trc":case 12:t.statsType=12;break;case"MinPos":case 13:t.statsType=13;break;case"MaxPos":case 14:t.statsType=14;break;case"Blcf":case 15:t.statsType=15;break;case"Trcf":case 16:t.statsType=16;break;case"MinPosf":case 17:t.statsType=17;break;case"MaxPosf":case 18:t.statsType=18}return null!=e.value&&(t.value=Number(e.value)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.statsType=t.enums===String?"NumPixels":0,i.value=0),null!=e.statsType&&e.hasOwnProperty("statsType")&&(i.statsType=t.enums===String?a.CARTA.StatsType[e.statsType]:e.statsType),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Histogram=function(){function e(e){if(this.bins=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.numBins=0,e.prototype.binWidth=0,e.prototype.firstBinCenter=0,e.prototype.bins=s.emptyArray,e.prototype.mean=0,e.prototype.stdDev=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.numBins&&Object.hasOwnProperty.call(e,"numBins")&&t.uint32(21).sfixed32(e.numBins),null!=e.binWidth&&Object.hasOwnProperty.call(e,"binWidth")&&t.uint32(25).double(e.binWidth),null!=e.firstBinCenter&&Object.hasOwnProperty.call(e,"firstBinCenter")&&t.uint32(33).double(e.firstBinCenter),null!=e.bins&&e.bins.length){t.uint32(42).fork();for(let i=0;i<e.bins.length;++i)t.sfixed32(e.bins[i]);t.ldelim()}return null!=e.mean&&Object.hasOwnProperty.call(e,"mean")&&t.uint32(49).double(e.mean),null!=e.stdDev&&Object.hasOwnProperty.call(e,"stdDev")&&t.uint32(57).double(e.stdDev),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.Histogram;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.numBins=e.sfixed32();break;case 3:n.binWidth=e.double();break;case 4:n.firstBinCenter=e.double();break;case 5:if(n.bins&&n.bins.length||(n.bins=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.bins.push(e.sfixed32())}else n.bins.push(e.sfixed32());break;case 6:n.mean=e.double();break;case 7:n.stdDev=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.numBins&&e.hasOwnProperty("numBins")&&!s.isInteger(e.numBins))return"numBins: integer expected";if(null!=e.binWidth&&e.hasOwnProperty("binWidth")&&"number"!==typeof e.binWidth)return"binWidth: number expected";if(null!=e.firstBinCenter&&e.hasOwnProperty("firstBinCenter")&&"number"!==typeof e.firstBinCenter)return"firstBinCenter: number expected";if(null!=e.bins&&e.hasOwnProperty("bins")){if(!Array.isArray(e.bins))return"bins: array expected";for(let t=0;t<e.bins.length;++t)if(!s.isInteger(e.bins[t]))return"bins: integer[] expected"}return null!=e.mean&&e.hasOwnProperty("mean")&&"number"!==typeof e.mean?"mean: number expected":null!=e.stdDev&&e.hasOwnProperty("stdDev")&&"number"!==typeof e.stdDev?"stdDev: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.Histogram)return e;let t=new a.CARTA.Histogram;if(null!=e.channel&&(t.channel=0|e.channel),null!=e.numBins&&(t.numBins=0|e.numBins),null!=e.binWidth&&(t.binWidth=Number(e.binWidth)),null!=e.firstBinCenter&&(t.firstBinCenter=Number(e.firstBinCenter)),e.bins){if(!Array.isArray(e.bins))throw TypeError(".CARTA.Histogram.bins: array expected");t.bins=[];for(let i=0;i<e.bins.length;++i)t.bins[i]=0|e.bins[i]}return null!=e.mean&&(t.mean=Number(e.mean)),null!=e.stdDev&&(t.stdDev=Number(e.stdDev)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.bins=[]),t.defaults&&(i.channel=0,i.numBins=0,i.binWidth=0,i.firstBinCenter=0,i.mean=0,i.stdDev=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.numBins&&e.hasOwnProperty("numBins")&&(i.numBins=e.numBins),null!=e.binWidth&&e.hasOwnProperty("binWidth")&&(i.binWidth=t.json&&!isFinite(e.binWidth)?String(e.binWidth):e.binWidth),null!=e.firstBinCenter&&e.hasOwnProperty("firstBinCenter")&&(i.firstBinCenter=t.json&&!isFinite(e.firstBinCenter)?String(e.firstBinCenter):e.firstBinCenter),e.bins&&e.bins.length){i.bins=[];for(let t=0;t<e.bins.length;++t)i.bins[t]=e.bins[t]}return null!=e.mean&&e.hasOwnProperty("mean")&&(i.mean=t.json&&!isFinite(e.mean)?String(e.mean):e.mean),null!=e.stdDev&&e.hasOwnProperty("stdDev")&&(i.stdDev=t.json&&!isFinite(e.stdDev)?String(e.stdDev):e.stdDev),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionInfo=function(){function e(e){if(this.controlPoints=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.regionType=0,e.prototype.controlPoints=s.emptyArray,e.prototype.rotation=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.regionType&&Object.hasOwnProperty.call(e,"regionType")&&t.uint32(8).int32(e.regionType),null!=e.controlPoints&&e.controlPoints.length)for(let i=0;i<e.controlPoints.length;++i)a.CARTA.Point.encode(e.controlPoints[i],t.uint32(18).fork()).ldelim();return null!=e.rotation&&Object.hasOwnProperty.call(e,"rotation")&&t.uint32(29).float(e.rotation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.regionType=e.int32();break;case 2:n.controlPoints&&n.controlPoints.length||(n.controlPoints=[]),n.controlPoints.push(a.CARTA.Point.decode(e,e.uint32()));break;case 3:n.rotation=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.regionType&&e.hasOwnProperty("regionType"))switch(e.regionType){default:return"regionType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.controlPoints&&e.hasOwnProperty("controlPoints")){if(!Array.isArray(e.controlPoints))return"controlPoints: array expected";for(let t=0;t<e.controlPoints.length;++t){let i=a.CARTA.Point.verify(e.controlPoints[t]);if(i)return"controlPoints."+i}}return null!=e.rotation&&e.hasOwnProperty("rotation")&&"number"!==typeof e.rotation?"rotation: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionInfo)return e;let t=new a.CARTA.RegionInfo;switch(e.regionType){case"POINT":case 0:t.regionType=0;break;case"LINE":case 1:t.regionType=1;break;case"POLYLINE":case 2:t.regionType=2;break;case"RECTANGLE":case 3:t.regionType=3;break;case"ELLIPSE":case 4:t.regionType=4;break;case"ANNULUS":case 5:t.regionType=5;break;case"POLYGON":case 6:t.regionType=6}if(e.controlPoints){if(!Array.isArray(e.controlPoints))throw TypeError(".CARTA.RegionInfo.controlPoints: array expected");t.controlPoints=[];for(let i=0;i<e.controlPoints.length;++i){if("object"!==typeof e.controlPoints[i])throw TypeError(".CARTA.RegionInfo.controlPoints: object expected");t.controlPoints[i]=a.CARTA.Point.fromObject(e.controlPoints[i])}}return null!=e.rotation&&(t.rotation=Number(e.rotation)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.controlPoints=[]),t.defaults&&(i.regionType=t.enums===String?"POINT":0,i.rotation=0),null!=e.regionType&&e.hasOwnProperty("regionType")&&(i.regionType=t.enums===String?a.CARTA.RegionType[e.regionType]:e.regionType),e.controlPoints&&e.controlPoints.length){i.controlPoints=[];for(let n=0;n<e.controlPoints.length;++n)i.controlPoints[n]=a.CARTA.Point.toObject(e.controlPoints[n],t)}return null!=e.rotation&&e.hasOwnProperty("rotation")&&(i.rotation=t.json&&!isFinite(e.rotation)?String(e.rotation):e.rotation),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionStyle=function(){function e(e){if(this.dashList=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.color="",e.prototype.lineWidth=0,e.prototype.dashList=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.color&&Object.hasOwnProperty.call(e,"color")&&t.uint32(18).string(e.color),null!=e.lineWidth&&Object.hasOwnProperty.call(e,"lineWidth")&&t.uint32(29).sfixed32(e.lineWidth),null!=e.dashList&&e.dashList.length){t.uint32(34).fork();for(let i=0;i<e.dashList.length;++i)t.sfixed32(e.dashList[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionStyle;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.color=e.string();break;case 3:n.lineWidth=e.sfixed32();break;case 4:if(n.dashList&&n.dashList.length||(n.dashList=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.dashList.push(e.sfixed32())}else n.dashList.push(e.sfixed32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name))return"name: string expected";if(null!=e.color&&e.hasOwnProperty("color")&&!s.isString(e.color))return"color: string expected";if(null!=e.lineWidth&&e.hasOwnProperty("lineWidth")&&!s.isInteger(e.lineWidth))return"lineWidth: integer expected";if(null!=e.dashList&&e.hasOwnProperty("dashList")){if(!Array.isArray(e.dashList))return"dashList: array expected";for(let t=0;t<e.dashList.length;++t)if(!s.isInteger(e.dashList[t]))return"dashList: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionStyle)return e;let t=new a.CARTA.RegionStyle;if(null!=e.name&&(t.name=String(e.name)),null!=e.color&&(t.color=String(e.color)),null!=e.lineWidth&&(t.lineWidth=0|e.lineWidth),e.dashList){if(!Array.isArray(e.dashList))throw TypeError(".CARTA.RegionStyle.dashList: array expected");t.dashList=[];for(let i=0;i<e.dashList.length;++i)t.dashList[i]=0|e.dashList[i]}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.dashList=[]),t.defaults&&(i.name="",i.color="",i.lineWidth=0),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.color&&e.hasOwnProperty("color")&&(i.color=e.color),null!=e.lineWidth&&e.hasOwnProperty("lineWidth")&&(i.lineWidth=e.lineWidth),e.dashList&&e.dashList.length){i.dashList=[];for(let t=0;t<e.dashList.length;++t)i.dashList[t]=e.dashList[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFileInfo=function(){function e(e){if(this.coosys=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.type=0,e.prototype.fileSize=s.Long?s.Long.fromBits(0,0,!1):0,e.prototype.description="",e.prototype.coosys=s.emptyArray,e.prototype.date=s.Long?s.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.fileSize&&Object.hasOwnProperty.call(e,"fileSize")&&t.uint32(25).sfixed64(e.fileSize),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(34).string(e.description),null!=e.coosys&&e.coosys.length)for(let i=0;i<e.coosys.length;++i)a.CARTA.Coosys.encode(e.coosys[i],t.uint32(42).fork()).ldelim();return null!=e.date&&Object.hasOwnProperty.call(e,"date")&&t.uint32(49).sfixed64(e.date),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogFileInfo;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.type=e.int32();break;case 3:n.fileSize=e.sfixed64();break;case 4:n.description=e.string();break;case 5:n.coosys&&n.coosys.length||(n.coosys=[]),n.coosys.push(a.CARTA.Coosys.decode(e,e.uint32()));break;case 6:n.date=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name))return"name: string expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:}if(null!=e.fileSize&&e.hasOwnProperty("fileSize")&&!s.isInteger(e.fileSize)&&!(e.fileSize&&s.isInteger(e.fileSize.low)&&s.isInteger(e.fileSize.high)))return"fileSize: integer|Long expected";if(null!=e.description&&e.hasOwnProperty("description")&&!s.isString(e.description))return"description: string expected";if(null!=e.coosys&&e.hasOwnProperty("coosys")){if(!Array.isArray(e.coosys))return"coosys: array expected";for(let t=0;t<e.coosys.length;++t){let i=a.CARTA.Coosys.verify(e.coosys[t]);if(i)return"coosys."+i}}return null==e.date||!e.hasOwnProperty("date")||s.isInteger(e.date)||e.date&&s.isInteger(e.date.low)&&s.isInteger(e.date.high)?null:"date: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogFileInfo)return e;let t=new a.CARTA.CatalogFileInfo;switch(null!=e.name&&(t.name=String(e.name)),e.type){case"FITSTable":case 0:t.type=0;break;case"VOTable":case 1:t.type=1}if(null!=e.fileSize&&(s.Long?(t.fileSize=s.Long.fromValue(e.fileSize)).unsigned=!1:"string"===typeof e.fileSize?t.fileSize=parseInt(e.fileSize,10):"number"===typeof e.fileSize?t.fileSize=e.fileSize:"object"===typeof e.fileSize&&(t.fileSize=new s.LongBits(e.fileSize.low>>>0,e.fileSize.high>>>0).toNumber())),null!=e.description&&(t.description=String(e.description)),e.coosys){if(!Array.isArray(e.coosys))throw TypeError(".CARTA.CatalogFileInfo.coosys: array expected");t.coosys=[];for(let i=0;i<e.coosys.length;++i){if("object"!==typeof e.coosys[i])throw TypeError(".CARTA.CatalogFileInfo.coosys: object expected");t.coosys[i]=a.CARTA.Coosys.fromObject(e.coosys[i])}}return null!=e.date&&(s.Long?(t.date=s.Long.fromValue(e.date)).unsigned=!1:"string"===typeof e.date?t.date=parseInt(e.date,10):"number"===typeof e.date?t.date=e.date:"object"===typeof e.date&&(t.date=new s.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.coosys=[]),t.defaults){if(i.name="",i.type=t.enums===String?"FITSTable":0,s.Long){let e=new s.Long(0,0,!1);i.fileSize=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.fileSize=t.longs===String?"0":0;if(i.description="",s.Long){let e=new s.Long(0,0,!1);i.date=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.date=t.longs===String?"0":0}if(null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?a.CARTA.CatalogFileType[e.type]:e.type),null!=e.fileSize&&e.hasOwnProperty("fileSize")&&("number"===typeof e.fileSize?i.fileSize=t.longs===String?String(e.fileSize):e.fileSize:i.fileSize=t.longs===String?s.Long.prototype.toString.call(e.fileSize):t.longs===Number?new s.LongBits(e.fileSize.low>>>0,e.fileSize.high>>>0).toNumber():e.fileSize),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),e.coosys&&e.coosys.length){i.coosys=[];for(let n=0;n<e.coosys.length;++n)i.coosys[n]=a.CARTA.Coosys.toObject(e.coosys[n],t)}return null!=e.date&&e.hasOwnProperty("date")&&("number"===typeof e.date?i.date=t.longs===String?String(e.date):e.date:i.date=t.longs===String?s.Long.prototype.toString.call(e.date):t.longs===Number?new s.LongBits(e.date.low>>>0,e.date.high>>>0).toNumber():e.date),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Coosys=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.equinox="",e.prototype.epoch="",e.prototype.system="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.equinox&&Object.hasOwnProperty.call(e,"equinox")&&t.uint32(10).string(e.equinox),null!=e.epoch&&Object.hasOwnProperty.call(e,"epoch")&&t.uint32(18).string(e.epoch),null!=e.system&&Object.hasOwnProperty.call(e,"system")&&t.uint32(26).string(e.system),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.Coosys;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.equinox=e.string();break;case 2:n.epoch=e.string();break;case 3:n.system=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.equinox&&e.hasOwnProperty("equinox")&&!s.isString(e.equinox)?"equinox: string expected":null!=e.epoch&&e.hasOwnProperty("epoch")&&!s.isString(e.epoch)?"epoch: string expected":null!=e.system&&e.hasOwnProperty("system")&&!s.isString(e.system)?"system: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.Coosys)return e;let t=new a.CARTA.Coosys;return null!=e.equinox&&(t.equinox=String(e.equinox)),null!=e.epoch&&(t.epoch=String(e.epoch)),null!=e.system&&(t.system=String(e.system)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.equinox="",i.epoch="",i.system=""),null!=e.equinox&&e.hasOwnProperty("equinox")&&(i.equinox=e.equinox),null!=e.epoch&&e.hasOwnProperty("epoch")&&(i.epoch=e.epoch),null!=e.system&&e.hasOwnProperty("system")&&(i.system=e.system),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogHeader=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.name="",e.prototype.dataType=0,e.prototype.columnIndex=0,e.prototype.description="",e.prototype.units="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(10).string(e.name),null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(16).int32(e.dataType),null!=e.columnIndex&&Object.hasOwnProperty.call(e,"columnIndex")&&t.uint32(29).sfixed32(e.columnIndex),null!=e.description&&Object.hasOwnProperty.call(e,"description")&&t.uint32(42).string(e.description),null!=e.units&&Object.hasOwnProperty.call(e,"units")&&t.uint32(50).string(e.units),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogHeader;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.name=e.string();break;case 2:n.dataType=e.int32();break;case 3:n.columnIndex=e.sfixed32();break;case 5:n.description=e.string();break;case 6:n.units=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name))return"name: string expected";if(null!=e.dataType&&e.hasOwnProperty("dataType"))switch(e.dataType){default:return"dataType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}return null!=e.columnIndex&&e.hasOwnProperty("columnIndex")&&!s.isInteger(e.columnIndex)?"columnIndex: integer expected":null!=e.description&&e.hasOwnProperty("description")&&!s.isString(e.description)?"description: string expected":null!=e.units&&e.hasOwnProperty("units")&&!s.isString(e.units)?"units: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogHeader)return e;let t=new a.CARTA.CatalogHeader;switch(null!=e.name&&(t.name=String(e.name)),e.dataType){case"UnsupportedType":case 0:t.dataType=0;break;case"String":case 1:t.dataType=1;break;case"Uint8":case 2:t.dataType=2;break;case"Int8":case 3:t.dataType=3;break;case"Uint16":case 4:t.dataType=4;break;case"Int16":case 5:t.dataType=5;break;case"Uint32":case 6:t.dataType=6;break;case"Int32":case 7:t.dataType=7;break;case"Uint64":case 8:t.dataType=8;break;case"Int64":case 9:t.dataType=9;break;case"Float":case 10:t.dataType=10;break;case"Double":case 11:t.dataType=11;break;case"Bool":case 12:t.dataType=12}return null!=e.columnIndex&&(t.columnIndex=0|e.columnIndex),null!=e.description&&(t.description=String(e.description)),null!=e.units&&(t.units=String(e.units)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.name="",i.dataType=t.enums===String?"UnsupportedType":0,i.columnIndex=0,i.description="",i.units=""),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.dataType&&e.hasOwnProperty("dataType")&&(i.dataType=t.enums===String?a.CARTA.ColumnType[e.dataType]:e.dataType),null!=e.columnIndex&&e.hasOwnProperty("columnIndex")&&(i.columnIndex=e.columnIndex),null!=e.description&&e.hasOwnProperty("description")&&(i.description=e.description),null!=e.units&&e.hasOwnProperty("units")&&(i.units=e.units),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ColumnData=function(){function e(e){if(this.stringData=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.dataType=0,e.prototype.stringData=s.emptyArray,e.prototype.binaryData=s.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.dataType&&Object.hasOwnProperty.call(e,"dataType")&&t.uint32(8).int32(e.dataType),null!=e.stringData&&e.stringData.length)for(let i=0;i<e.stringData.length;++i)t.uint32(18).string(e.stringData[i]);return null!=e.binaryData&&Object.hasOwnProperty.call(e,"binaryData")&&t.uint32(26).bytes(e.binaryData),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ColumnData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.dataType=e.int32();break;case 2:n.stringData&&n.stringData.length||(n.stringData=[]),n.stringData.push(e.string());break;case 3:n.binaryData=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.dataType&&e.hasOwnProperty("dataType"))switch(e.dataType){default:return"dataType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}if(null!=e.stringData&&e.hasOwnProperty("stringData")){if(!Array.isArray(e.stringData))return"stringData: array expected";for(let t=0;t<e.stringData.length;++t)if(!s.isString(e.stringData[t]))return"stringData: string[] expected"}return null!=e.binaryData&&e.hasOwnProperty("binaryData")&&!(e.binaryData&&"number"===typeof e.binaryData.length||s.isString(e.binaryData))?"binaryData: buffer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ColumnData)return e;let t=new a.CARTA.ColumnData;switch(e.dataType){case"UnsupportedType":case 0:t.dataType=0;break;case"String":case 1:t.dataType=1;break;case"Uint8":case 2:t.dataType=2;break;case"Int8":case 3:t.dataType=3;break;case"Uint16":case 4:t.dataType=4;break;case"Int16":case 5:t.dataType=5;break;case"Uint32":case 6:t.dataType=6;break;case"Int32":case 7:t.dataType=7;break;case"Uint64":case 8:t.dataType=8;break;case"Int64":case 9:t.dataType=9;break;case"Float":case 10:t.dataType=10;break;case"Double":case 11:t.dataType=11;break;case"Bool":case 12:t.dataType=12}if(e.stringData){if(!Array.isArray(e.stringData))throw TypeError(".CARTA.ColumnData.stringData: array expected");t.stringData=[];for(let i=0;i<e.stringData.length;++i)t.stringData[i]=String(e.stringData[i])}return null!=e.binaryData&&("string"===typeof e.binaryData?s.base64.decode(e.binaryData,t.binaryData=s.newBuffer(s.base64.length(e.binaryData)),0):e.binaryData.length&&(t.binaryData=e.binaryData)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stringData=[]),t.defaults&&(i.dataType=t.enums===String?"UnsupportedType":0,t.bytes===String?i.binaryData="":(i.binaryData=[],t.bytes!==Array&&(i.binaryData=s.newBuffer(i.binaryData)))),null!=e.dataType&&e.hasOwnProperty("dataType")&&(i.dataType=t.enums===String?a.CARTA.ColumnType[e.dataType]:e.dataType),e.stringData&&e.stringData.length){i.stringData=[];for(let t=0;t<e.stringData.length;++t)i.stringData[t]=e.stringData[t]}return null!=e.binaryData&&e.hasOwnProperty("binaryData")&&(i.binaryData=t.bytes===String?s.base64.encode(e.binaryData,0,e.binaryData.length):t.bytes===Array?Array.prototype.slice.call(e.binaryData):e.binaryData),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FilterConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.columnName="",e.prototype.comparisonOperator=0,e.prototype.value=0,e.prototype.secondaryValue=0,e.prototype.subString="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.columnName&&Object.hasOwnProperty.call(e,"columnName")&&t.uint32(10).string(e.columnName),null!=e.comparisonOperator&&Object.hasOwnProperty.call(e,"comparisonOperator")&&t.uint32(16).int32(e.comparisonOperator),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(25).double(e.value),null!=e.secondaryValue&&Object.hasOwnProperty.call(e,"secondaryValue")&&t.uint32(33).double(e.secondaryValue),null!=e.subString&&Object.hasOwnProperty.call(e,"subString")&&t.uint32(42).string(e.subString),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FilterConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.columnName=e.string();break;case 2:n.comparisonOperator=e.int32();break;case 3:n.value=e.double();break;case 4:n.secondaryValue=e.double();break;case 5:n.subString=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.columnName&&e.hasOwnProperty("columnName")&&!s.isString(e.columnName))return"columnName: string expected";if(null!=e.comparisonOperator&&e.hasOwnProperty("comparisonOperator"))switch(e.comparisonOperator){default:return"comparisonOperator: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value?"value: number expected":null!=e.secondaryValue&&e.hasOwnProperty("secondaryValue")&&"number"!==typeof e.secondaryValue?"secondaryValue: number expected":null!=e.subString&&e.hasOwnProperty("subString")&&!s.isString(e.subString)?"subString: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.FilterConfig)return e;let t=new a.CARTA.FilterConfig;switch(null!=e.columnName&&(t.columnName=String(e.columnName)),e.comparisonOperator){case"Equal":case 0:t.comparisonOperator=0;break;case"NotEqual":case 1:t.comparisonOperator=1;break;case"Lesser":case 2:t.comparisonOperator=2;break;case"Greater":case 3:t.comparisonOperator=3;break;case"LessorOrEqual":case 4:t.comparisonOperator=4;break;case"GreaterOrEqual":case 5:t.comparisonOperator=5;break;case"RangeOpen":case 6:t.comparisonOperator=6;break;case"RangeClosed":case 7:t.comparisonOperator=7}return null!=e.value&&(t.value=Number(e.value)),null!=e.secondaryValue&&(t.secondaryValue=Number(e.secondaryValue)),null!=e.subString&&(t.subString=String(e.subString)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.columnName="",i.comparisonOperator=t.enums===String?"Equal":0,i.value=0,i.secondaryValue=0,i.subString=""),null!=e.columnName&&e.hasOwnProperty("columnName")&&(i.columnName=e.columnName),null!=e.comparisonOperator&&e.hasOwnProperty("comparisonOperator")&&(i.comparisonOperator=t.enums===String?a.CARTA.ComparisonOperator[e.comparisonOperator]:e.comparisonOperator),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),null!=e.secondaryValue&&e.hasOwnProperty("secondaryValue")&&(i.secondaryValue=t.json&&!isFinite(e.secondaryValue)?String(e.secondaryValue):e.secondaryValue),null!=e.subString&&e.hasOwnProperty("subString")&&(i.subString=e.subString),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogImageBounds=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.xColumnName="",e.prototype.yColumnName="",e.prototype.imageBounds=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.xColumnName&&Object.hasOwnProperty.call(e,"xColumnName")&&t.uint32(10).string(e.xColumnName),null!=e.yColumnName&&Object.hasOwnProperty.call(e,"yColumnName")&&t.uint32(18).string(e.yColumnName),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&a.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogImageBounds;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.xColumnName=e.string();break;case 2:n.yColumnName=e.string();break;case 3:n.imageBounds=a.CARTA.ImageBounds.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.xColumnName&&e.hasOwnProperty("xColumnName")&&!s.isString(e.xColumnName))return"xColumnName: string expected";if(null!=e.yColumnName&&e.hasOwnProperty("yColumnName")&&!s.isString(e.yColumnName))return"yColumnName: string expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=a.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogImageBounds)return e;let t=new a.CARTA.CatalogImageBounds;if(null!=e.xColumnName&&(t.xColumnName=String(e.xColumnName)),null!=e.yColumnName&&(t.yColumnName=String(e.yColumnName)),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.CatalogImageBounds.imageBounds: object expected");t.imageBounds=a.CARTA.ImageBounds.fromObject(e.imageBounds)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.xColumnName="",i.yColumnName="",i.imageBounds=null),null!=e.xColumnName&&e.hasOwnProperty("xColumnName")&&(i.xColumnName=e.xColumnName),null!=e.yColumnName&&e.hasOwnProperty("yColumnName")&&(i.yColumnName=e.yColumnName),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=a.CARTA.ImageBounds.toObject(e.imageBounds,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MatchedFrameList=function(){function e(e){if(this.frameNumbers=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.frameNumbers=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.frameNumbers&&e.frameNumbers.length){t.uint32(10).fork();for(let i=0;i<e.frameNumbers.length;++i)t.float(e.frameNumbers[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.MatchedFrameList;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:if(n.frameNumbers&&n.frameNumbers.length||(n.frameNumbers=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.frameNumbers.push(e.float())}else n.frameNumbers.push(e.float());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.frameNumbers&&e.hasOwnProperty("frameNumbers")){if(!Array.isArray(e.frameNumbers))return"frameNumbers: array expected";for(let t=0;t<e.frameNumbers.length;++t)if("number"!==typeof e.frameNumbers[t])return"frameNumbers: number[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.MatchedFrameList)return e;let t=new a.CARTA.MatchedFrameList;if(e.frameNumbers){if(!Array.isArray(e.frameNumbers))throw TypeError(".CARTA.MatchedFrameList.frameNumbers: array expected");t.frameNumbers=[];for(let i=0;i<e.frameNumbers.length;++i)t.frameNumbers[i]=Number(e.frameNumbers[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.frameNumbers=[]),e.frameNumbers&&e.frameNumbers.length){i.frameNumbers=[];for(let n=0;n<e.frameNumbers.length;++n)i.frameNumbers[n]=t.json&&!isFinite(e.frameNumbers[n])?String(e.frameNumbers[n]):e.frameNumbers[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.Beam=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.stokes=0,e.prototype.majorAxis=0,e.prototype.minorAxis=0,e.prototype.pa=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(21).sfixed32(e.stokes),null!=e.majorAxis&&Object.hasOwnProperty.call(e,"majorAxis")&&t.uint32(29).float(e.majorAxis),null!=e.minorAxis&&Object.hasOwnProperty.call(e,"minorAxis")&&t.uint32(37).float(e.minorAxis),null!=e.pa&&Object.hasOwnProperty.call(e,"pa")&&t.uint32(45).float(e.pa),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.Beam;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.stokes=e.sfixed32();break;case 3:n.majorAxis=e.float();break;case 4:n.minorAxis=e.float();break;case 5:n.pa=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes)?"stokes: integer expected":null!=e.majorAxis&&e.hasOwnProperty("majorAxis")&&"number"!==typeof e.majorAxis?"majorAxis: number expected":null!=e.minorAxis&&e.hasOwnProperty("minorAxis")&&"number"!==typeof e.minorAxis?"minorAxis: number expected":null!=e.pa&&e.hasOwnProperty("pa")&&"number"!==typeof e.pa?"pa: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.Beam)return e;let t=new a.CARTA.Beam;return null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.majorAxis&&(t.majorAxis=Number(e.majorAxis)),null!=e.minorAxis&&(t.minorAxis=Number(e.minorAxis)),null!=e.pa&&(t.pa=Number(e.pa)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.stokes=0,i.majorAxis=0,i.minorAxis=0,i.pa=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.majorAxis&&e.hasOwnProperty("majorAxis")&&(i.majorAxis=t.json&&!isFinite(e.majorAxis)?String(e.majorAxis):e.majorAxis),null!=e.minorAxis&&e.hasOwnProperty("minorAxis")&&(i.minorAxis=t.json&&!isFinite(e.minorAxis)?String(e.minorAxis):e.minorAxis),null!=e.pa&&e.hasOwnProperty("pa")&&(i.pa=t.json&&!isFinite(e.pa)?String(e.pa):e.pa),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.EventType=function(){const e={},t=Object.create(e);return t[e[0]="EMPTY_EVENT"]=0,t[e[1]="REGISTER_VIEWER"]=1,t[e[2]="FILE_LIST_REQUEST"]=2,t[e[3]="FILE_INFO_REQUEST"]=3,t[e[4]="OPEN_FILE"]=4,t[e[6]="SET_IMAGE_CHANNELS"]=6,t[e[7]="SET_CURSOR"]=7,t[e[8]="SET_SPATIAL_REQUIREMENTS"]=8,t[e[9]="SET_HISTOGRAM_REQUIREMENTS"]=9,t[e[10]="SET_STATS_REQUIREMENTS"]=10,t[e[11]="SET_REGION"]=11,t[e[12]="REMOVE_REGION"]=12,t[e[13]="CLOSE_FILE"]=13,t[e[14]="SET_SPECTRAL_REQUIREMENTS"]=14,t[e[15]="START_ANIMATION"]=15,t[e[16]="START_ANIMATION_ACK"]=16,t[e[17]="STOP_ANIMATION"]=17,t[e[18]="REGISTER_VIEWER_ACK"]=18,t[e[19]="FILE_LIST_RESPONSE"]=19,t[e[20]="FILE_INFO_RESPONSE"]=20,t[e[21]="OPEN_FILE_ACK"]=21,t[e[22]="SET_REGION_ACK"]=22,t[e[23]="REGION_HISTOGRAM_DATA"]=23,t[e[25]="SPATIAL_PROFILE_DATA"]=25,t[e[26]="SPECTRAL_PROFILE_DATA"]=26,t[e[27]="REGION_STATS_DATA"]=27,t[e[28]="ERROR_DATA"]=28,t[e[29]="ANIMATION_FLOW_CONTROL"]=29,t[e[30]="ADD_REQUIRED_TILES"]=30,t[e[31]="REMOVE_REQUIRED_TILES"]=31,t[e[32]="RASTER_TILE_DATA"]=32,t[e[33]="REGION_LIST_REQUEST"]=33,t[e[34]="REGION_LIST_RESPONSE"]=34,t[e[35]="REGION_FILE_INFO_REQUEST"]=35,t[e[36]="REGION_FILE_INFO_RESPONSE"]=36,t[e[37]="IMPORT_REGION"]=37,t[e[38]="IMPORT_REGION_ACK"]=38,t[e[39]="EXPORT_REGION"]=39,t[e[40]="EXPORT_REGION_ACK"]=40,t[e[45]="SET_CONTOUR_PARAMETERS"]=45,t[e[46]="CONTOUR_IMAGE_DATA"]=46,t[e[47]="RESUME_SESSION"]=47,t[e[48]="RESUME_SESSION_ACK"]=48,t[e[49]="RASTER_TILE_SYNC"]=49,t[e[50]="CATALOG_LIST_REQUEST"]=50,t[e[51]="CATALOG_LIST_RESPONSE"]=51,t[e[52]="CATALOG_FILE_INFO_REQUEST"]=52,t[e[53]="CATALOG_FILE_INFO_RESPONSE"]=53,t[e[54]="OPEN_CATALOG_FILE"]=54,t[e[55]="OPEN_CATALOG_FILE_ACK"]=55,t[e[56]="CLOSE_CATALOG_FILE"]=56,t[e[57]="CATALOG_FILTER_REQUEST"]=57,t[e[58]="CATALOG_FILTER_RESPONSE"]=58,t[e[59]="SCRIPTING_REQUEST"]=59,t[e[60]="SCRIPTING_RESPONSE"]=60,t[e[61]="MOMENT_REQUEST"]=61,t[e[62]="MOMENT_RESPONSE"]=62,t[e[63]="MOMENT_PROGRESS"]=63,t[e[64]="STOP_MOMENT_CALC"]=64,t[e[65]="SAVE_FILE"]=65,t[e[66]="SAVE_FILE_ACK"]=66,t[e[67]="SPECTRAL_LINE_REQUEST"]=67,t[e[68]="SPECTRAL_LINE_RESPONSE"]=68,t}(),e.SessionType=function(){const e={},t=Object.create(e);return t[e[0]="NEW"]=0,t[e[1]="RESUMED"]=1,t}(),e.FileType=function(){const e={},t=Object.create(e);return t[e[0]="CASA"]=0,t[e[1]="CRTF"]=1,t[e[2]="DS9_REG"]=2,t[e[3]="FITS"]=3,t[e[4]="HDF5"]=4,t[e[5]="MIRIAD"]=5,t[e[6]="UNKNOWN"]=6,t}(),e.RenderMode=function(){const e={},t=Object.create(e);return t[e[0]="RASTER"]=0,t[e[1]="CONTOUR"]=1,t}(),e.CompressionType=function(){const e={},t=Object.create(e);return t[e[0]="NONE"]=0,t[e[1]="ZFP"]=1,t[e[2]="SZ"]=2,t}(),e.RegionType=function(){const e={},t=Object.create(e);return t[e[0]="POINT"]=0,t[e[1]="LINE"]=1,t[e[2]="POLYLINE"]=2,t[e[3]="RECTANGLE"]=3,t[e[4]="ELLIPSE"]=4,t[e[5]="ANNULUS"]=5,t[e[6]="POLYGON"]=6,t}(),e.SmoothingMode=function(){const e={},t=Object.create(e);return t[e[0]="NoSmoothing"]=0,t[e[1]="BlockAverage"]=1,t[e[2]="GaussianBlur"]=2,t}(),e.StatsType=function(){const e={},t=Object.create(e);return t[e[0]="NumPixels"]=0,t[e[1]="NanCount"]=1,t[e[2]="Sum"]=2,t[e[3]="FluxDensity"]=3,t[e[4]="Mean"]=4,t[e[5]="RMS"]=5,t[e[6]="Sigma"]=6,t[e[7]="SumSq"]=7,t[e[8]="Min"]=8,t[e[9]="Max"]=9,t[e[10]="Extrema"]=10,t[e[11]="Blc"]=11,t[e[12]="Trc"]=12,t[e[13]="MinPos"]=13,t[e[14]="MaxPos"]=14,t[e[15]="Blcf"]=15,t[e[16]="Trcf"]=16,t[e[17]="MinPosf"]=17,t[e[18]="MaxPosf"]=18,t}(),e.ErrorSeverity=function(){const e={},t=Object.create(e);return t[e[0]="DEBUG"]=0,t[e[1]="INFO"]=1,t[e[2]="WARNING"]=2,t[e[3]="ERROR"]=3,t[e[4]="CRITICAL"]=4,t}(),e.EntryType=function(){const e={},t=Object.create(e);return t[e[0]="STRING"]=0,t[e[1]="FLOAT"]=1,t[e[2]="INT"]=2,t}(),e.ClientFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="CLIENT_FEATURE_NONE"]=0,t[e[1]="WEB_GL"]=1,t[e[2]="WEB_GL_2"]=2,t[e[4]="WEB_ASSEMBLY"]=4,t[e[8]="WEB_ASSEMBLY_THREADS"]=8,t[e[16]="OFFSCREEN_CANVAS"]=16,t}(),e.ServerFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="SERVER_FEATURE_NONE"]=0,t[e[1]="SZ_COMPRESSION"]=1,t[e[2]="HEVC_COMPRESSION"]=2,t[e[4]="NVENC_COMPRESSION"]=4,t[e[8]="REGION_WRITE_ACCESS"]=8,t[e[16]="USER_PREFERENCES"]=16,t[e[32]="USER_LAYOUTS"]=32,t[e[64]="GRPC_SCRIPTING"]=64,t}(),e.FileFeatureFlags=function(){const e={},t=Object.create(e);return t[e[0]="FILE_FEATURE_NONE"]=0,t[e[1]="ROTATED_DATASET"]=1,t[e[2]="CHANNEL_HISTOGRAMS"]=2,t[e[4]="CUBE_HISTOGRAMS"]=4,t[e[8]="CHANNEL_STATS"]=8,t[e[16]="MEAN_IMAGE"]=16,t[e[32]="MIP_DATASET"]=32,t}(),e.CoordinateType=function(){const e={},t=Object.create(e);return t[e[0]="PIXEL"]=0,t[e[1]="WORLD"]=1,t}(),e.CatalogFileType=function(){const e={},t=Object.create(e);return t[e[0]="FITSTable"]=0,t[e[1]="VOTable"]=1,t}(),e.ColumnType=function(){const e={},t=Object.create(e);return t[e[0]="UnsupportedType"]=0,t[e[1]="String"]=1,t[e[2]="Uint8"]=2,t[e[3]="Int8"]=3,t[e[4]="Uint16"]=4,t[e[5]="Int16"]=5,t[e[6]="Uint32"]=6,t[e[7]="Int32"]=7,t[e[8]="Uint64"]=8,t[e[9]="Int64"]=9,t[e[10]="Float"]=10,t[e[11]="Double"]=11,t[e[12]="Bool"]=12,t}(),e.ComparisonOperator=function(){const e={},t=Object.create(e);return t[e[0]="Equal"]=0,t[e[1]="NotEqual"]=1,t[e[2]="Lesser"]=2,t[e[3]="Greater"]=3,t[e[4]="LessorOrEqual"]=4,t[e[5]="GreaterOrEqual"]=5,t[e[6]="RangeOpen"]=6,t[e[7]="RangeClosed"]=7,t}(),e.SortingType=function(){const e={},t=Object.create(e);return t[e[0]="Ascending"]=0,t[e[1]="Descending"]=1,t}(),e.Moment=function(){const e={},t=Object.create(e);return t[e[0]="MEAN_OF_THE_SPECTRUM"]=0,t[e[1]="INTEGRATED_OF_THE_SPECTRUM"]=1,t[e[2]="INTENSITY_WEIGHTED_COORD"]=2,t[e[3]="INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD"]=3,t[e[4]="MEDIAN_OF_THE_SPECTRUM"]=4,t[e[5]="MEDIAN_COORDINATE"]=5,t[e[6]="STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM"]=6,t[e[7]="RMS_OF_THE_SPECTRUM"]=7,t[e[8]="ABS_MEAN_DEVIATION_OF_THE_SPECTRUM"]=8,t[e[9]="MAX_OF_THE_SPECTRUM"]=9,t[e[10]="COORD_OF_THE_MAX_OF_THE_SPECTRUM"]=10,t[e[11]="MIN_OF_THE_SPECTRUM"]=11,t[e[12]="COORD_OF_THE_MIN_OF_THE_SPECTRUM"]=12,t}(),e.MomentAxis=function(){const e={},t=Object.create(e);return t[e[0]="SPECTRAL"]=0,t[e[1]="STOKES"]=1,t}(),e.MomentMask=function(){const e={},t=Object.create(e);return t[e[0]="None"]=0,t[e[1]="Include"]=1,t[e[2]="Exclude"]=2,t}(),e.StartAnimation=function(){function e(e){if(this.matchedFrames={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.firstFrame=null,e.prototype.startFrame=null,e.prototype.lastFrame=null,e.prototype.deltaFrame=null,e.prototype.frameRate=0,e.prototype.looping=!1,e.prototype.reverse=!1,e.prototype.requiredTiles=null,e.prototype.matchedFrames=s.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.firstFrame&&Object.hasOwnProperty.call(e,"firstFrame")&&a.CARTA.AnimationFrame.encode(e.firstFrame,t.uint32(18).fork()).ldelim(),null!=e.startFrame&&Object.hasOwnProperty.call(e,"startFrame")&&a.CARTA.AnimationFrame.encode(e.startFrame,t.uint32(26).fork()).ldelim(),null!=e.lastFrame&&Object.hasOwnProperty.call(e,"lastFrame")&&a.CARTA.AnimationFrame.encode(e.lastFrame,t.uint32(34).fork()).ldelim(),null!=e.deltaFrame&&Object.hasOwnProperty.call(e,"deltaFrame")&&a.CARTA.AnimationFrame.encode(e.deltaFrame,t.uint32(42).fork()).ldelim(),null!=e.frameRate&&Object.hasOwnProperty.call(e,"frameRate")&&t.uint32(53).sfixed32(e.frameRate),null!=e.looping&&Object.hasOwnProperty.call(e,"looping")&&t.uint32(56).bool(e.looping),null!=e.reverse&&Object.hasOwnProperty.call(e,"reverse")&&t.uint32(64).bool(e.reverse),null!=e.requiredTiles&&Object.hasOwnProperty.call(e,"requiredTiles")&&a.CARTA.AddRequiredTiles.encode(e.requiredTiles,t.uint32(74).fork()).ldelim(),null!=e.matchedFrames&&Object.hasOwnProperty.call(e,"matchedFrames"))for(let i=Object.keys(e.matchedFrames),n=0;n<i.length;++n)t.uint32(82).fork().uint32(13).sfixed32(i[n]),a.CARTA.MatchedFrameList.encode(e.matchedFrames[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.StartAnimation;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.fileId=e.sfixed32();break;case 2:o.firstFrame=a.CARTA.AnimationFrame.decode(e,e.uint32());break;case 3:o.startFrame=a.CARTA.AnimationFrame.decode(e,e.uint32());break;case 4:o.lastFrame=a.CARTA.AnimationFrame.decode(e,e.uint32());break;case 5:o.deltaFrame=a.CARTA.AnimationFrame.decode(e,e.uint32());break;case 6:o.frameRate=e.sfixed32();break;case 7:o.looping=e.bool();break;case 8:o.reverse=e.bool();break;case 9:o.requiredTiles=a.CARTA.AddRequiredTiles.decode(e,e.uint32());break;case 10:e.skip().pos++,o.matchedFrames===s.emptyObject&&(o.matchedFrames={}),i=e.sfixed32(),e.pos++,o.matchedFrames[i]=a.CARTA.MatchedFrameList.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.firstFrame&&e.hasOwnProperty("firstFrame")){let t=a.CARTA.AnimationFrame.verify(e.firstFrame);if(t)return"firstFrame."+t}if(null!=e.startFrame&&e.hasOwnProperty("startFrame")){let t=a.CARTA.AnimationFrame.verify(e.startFrame);if(t)return"startFrame."+t}if(null!=e.lastFrame&&e.hasOwnProperty("lastFrame")){let t=a.CARTA.AnimationFrame.verify(e.lastFrame);if(t)return"lastFrame."+t}if(null!=e.deltaFrame&&e.hasOwnProperty("deltaFrame")){let t=a.CARTA.AnimationFrame.verify(e.deltaFrame);if(t)return"deltaFrame."+t}if(null!=e.frameRate&&e.hasOwnProperty("frameRate")&&!s.isInteger(e.frameRate))return"frameRate: integer expected";if(null!=e.looping&&e.hasOwnProperty("looping")&&"boolean"!==typeof e.looping)return"looping: boolean expected";if(null!=e.reverse&&e.hasOwnProperty("reverse")&&"boolean"!==typeof e.reverse)return"reverse: boolean expected";if(null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")){let t=a.CARTA.AddRequiredTiles.verify(e.requiredTiles);if(t)return"requiredTiles."+t}if(null!=e.matchedFrames&&e.hasOwnProperty("matchedFrames")){if(!s.isObject(e.matchedFrames))return"matchedFrames: object expected";let t=Object.keys(e.matchedFrames);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"matchedFrames: integer key{k:sfixed32} expected";{let n=a.CARTA.MatchedFrameList.verify(e.matchedFrames[t[i]]);if(n)return"matchedFrames."+n}}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.StartAnimation)return e;let t=new a.CARTA.StartAnimation;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.firstFrame){if("object"!==typeof e.firstFrame)throw TypeError(".CARTA.StartAnimation.firstFrame: object expected");t.firstFrame=a.CARTA.AnimationFrame.fromObject(e.firstFrame)}if(null!=e.startFrame){if("object"!==typeof e.startFrame)throw TypeError(".CARTA.StartAnimation.startFrame: object expected");t.startFrame=a.CARTA.AnimationFrame.fromObject(e.startFrame)}if(null!=e.lastFrame){if("object"!==typeof e.lastFrame)throw TypeError(".CARTA.StartAnimation.lastFrame: object expected");t.lastFrame=a.CARTA.AnimationFrame.fromObject(e.lastFrame)}if(null!=e.deltaFrame){if("object"!==typeof e.deltaFrame)throw TypeError(".CARTA.StartAnimation.deltaFrame: object expected");t.deltaFrame=a.CARTA.AnimationFrame.fromObject(e.deltaFrame)}if(null!=e.frameRate&&(t.frameRate=0|e.frameRate),null!=e.looping&&(t.looping=Boolean(e.looping)),null!=e.reverse&&(t.reverse=Boolean(e.reverse)),null!=e.requiredTiles){if("object"!==typeof e.requiredTiles)throw TypeError(".CARTA.StartAnimation.requiredTiles: object expected");t.requiredTiles=a.CARTA.AddRequiredTiles.fromObject(e.requiredTiles)}if(e.matchedFrames){if("object"!==typeof e.matchedFrames)throw TypeError(".CARTA.StartAnimation.matchedFrames: object expected");t.matchedFrames={};for(let i=Object.keys(e.matchedFrames),n=0;n<i.length;++n){if("object"!==typeof e.matchedFrames[i[n]])throw TypeError(".CARTA.StartAnimation.matchedFrames: object expected");t.matchedFrames[i[n]]=a.CARTA.MatchedFrameList.fromObject(e.matchedFrames[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.matchedFrames={}),t.defaults&&(n.fileId=0,n.firstFrame=null,n.startFrame=null,n.lastFrame=null,n.deltaFrame=null,n.frameRate=0,n.looping=!1,n.reverse=!1,n.requiredTiles=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.firstFrame&&e.hasOwnProperty("firstFrame")&&(n.firstFrame=a.CARTA.AnimationFrame.toObject(e.firstFrame,t)),null!=e.startFrame&&e.hasOwnProperty("startFrame")&&(n.startFrame=a.CARTA.AnimationFrame.toObject(e.startFrame,t)),null!=e.lastFrame&&e.hasOwnProperty("lastFrame")&&(n.lastFrame=a.CARTA.AnimationFrame.toObject(e.lastFrame,t)),null!=e.deltaFrame&&e.hasOwnProperty("deltaFrame")&&(n.deltaFrame=a.CARTA.AnimationFrame.toObject(e.deltaFrame,t)),null!=e.frameRate&&e.hasOwnProperty("frameRate")&&(n.frameRate=e.frameRate),null!=e.looping&&e.hasOwnProperty("looping")&&(n.looping=e.looping),null!=e.reverse&&e.hasOwnProperty("reverse")&&(n.reverse=e.reverse),null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")&&(n.requiredTiles=a.CARTA.AddRequiredTiles.toObject(e.requiredTiles,t)),e.matchedFrames&&(i=Object.keys(e.matchedFrames)).length){n.matchedFrames={};for(let r=0;r<i.length;++r)n.matchedFrames[i[r]]=a.CARTA.MatchedFrameList.toObject(e.matchedFrames[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StartAnimationAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.animationId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(29).sfixed32(e.animationId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.StartAnimationAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.animationId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null!=e.animationId&&e.hasOwnProperty("animationId")&&!s.isInteger(e.animationId)?"animationId: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.StartAnimationAck)return e;let t=new a.CARTA.StartAnimationAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.animationId&&(t.animationId=0|e.animationId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.animationId=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.AnimationFlowControl=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.receivedFrame=null,e.prototype.animationId=0,e.prototype.timestamp=s.Long?s.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.receivedFrame&&Object.hasOwnProperty.call(e,"receivedFrame")&&a.CARTA.AnimationFrame.encode(e.receivedFrame,t.uint32(18).fork()).ldelim(),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(29).sfixed32(e.animationId),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(33).sfixed64(e.timestamp),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.AnimationFlowControl;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.receivedFrame=a.CARTA.AnimationFrame.decode(e,e.uint32());break;case 3:n.animationId=e.sfixed32();break;case 4:n.timestamp=e.sfixed64();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.receivedFrame&&e.hasOwnProperty("receivedFrame")){let t=a.CARTA.AnimationFrame.verify(e.receivedFrame);if(t)return"receivedFrame."+t}return null!=e.animationId&&e.hasOwnProperty("animationId")&&!s.isInteger(e.animationId)?"animationId: integer expected":null==e.timestamp||!e.hasOwnProperty("timestamp")||s.isInteger(e.timestamp)||e.timestamp&&s.isInteger(e.timestamp.low)&&s.isInteger(e.timestamp.high)?null:"timestamp: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.CARTA.AnimationFlowControl)return e;let t=new a.CARTA.AnimationFlowControl;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.receivedFrame){if("object"!==typeof e.receivedFrame)throw TypeError(".CARTA.AnimationFlowControl.receivedFrame: object expected");t.receivedFrame=a.CARTA.AnimationFrame.fromObject(e.receivedFrame)}return null!=e.animationId&&(t.animationId=0|e.animationId),null!=e.timestamp&&(s.Long?(t.timestamp=s.Long.fromValue(e.timestamp)).unsigned=!1:"string"===typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"===typeof e.timestamp?t.timestamp=e.timestamp:"object"===typeof e.timestamp&&(t.timestamp=new s.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let i={};if(t.defaults)if(i.fileId=0,i.receivedFrame=null,i.animationId=0,s.Long){let e=new s.Long(0,0,!1);i.timestamp=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.timestamp=t.longs===String?"0":0;return null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.receivedFrame&&e.hasOwnProperty("receivedFrame")&&(i.receivedFrame=a.CARTA.AnimationFrame.toObject(e.receivedFrame,t)),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"===typeof e.timestamp?i.timestamp=t.longs===String?String(e.timestamp):e.timestamp:i.timestamp=t.longs===String?s.Long.prototype.toString.call(e.timestamp):t.longs===Number?new s.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StopAnimation=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.endFrame=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.endFrame&&Object.hasOwnProperty.call(e,"endFrame")&&a.CARTA.AnimationFrame.encode(e.endFrame,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.StopAnimation;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.endFrame=a.CARTA.AnimationFrame.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.endFrame&&e.hasOwnProperty("endFrame")){let t=a.CARTA.AnimationFrame.verify(e.endFrame);if(t)return"endFrame."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.StopAnimation)return e;let t=new a.CARTA.StopAnimation;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.endFrame){if("object"!==typeof e.endFrame)throw TypeError(".CARTA.StopAnimation.endFrame: object expected");t.endFrame=a.CARTA.AnimationFrame.fromObject(e.endFrame)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.endFrame=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.endFrame&&e.hasOwnProperty("endFrame")&&(i.endFrame=a.CARTA.AnimationFrame.toObject(e.endFrame,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.AddRequiredTiles=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.tiles=s.emptyArray,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.tiles&&e.tiles.length){t.uint32(18).fork();for(let i=0;i<e.tiles.length;++i)t.sfixed32(e.tiles[i]);t.ldelim()}return null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(24).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(37).float(e.compressionQuality),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.AddRequiredTiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.tiles&&n.tiles.length||(n.tiles=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.tiles.push(e.sfixed32())}else n.tiles.push(e.sfixed32());break;case 3:n.compressionType=e.int32();break;case 4:n.compressionQuality=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t)if(!s.isInteger(e.tiles[t]))return"tiles: integer[] expected"}if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}return null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality?"compressionQuality: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.AddRequiredTiles)return e;let t=new a.CARTA.AddRequiredTiles;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.AddRequiredTiles.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i)t.tiles[i]=0|e.tiles[i]}switch(e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}return null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.tiles&&e.tiles.length){i.tiles=[];for(let t=0;t<e.tiles.length;++t)i.tiles[t]=e.tiles[t]}return null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?a.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RemoveRequiredTiles=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.tiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.tiles&&e.tiles.length){t.uint32(18).fork();for(let i=0;i<e.tiles.length;++i)t.sfixed32(e.tiles[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RemoveRequiredTiles;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.tiles&&n.tiles.length||(n.tiles=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.tiles.push(e.sfixed32())}else n.tiles.push(e.sfixed32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t)if(!s.isInteger(e.tiles[t]))return"tiles: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.RemoveRequiredTiles)return e;let t=new a.CARTA.RemoveRequiredTiles;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.RemoveRequiredTiles.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i)t.tiles[i]=0|e.tiles[i]}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.tiles&&e.tiles.length){i.tiles=[];for(let t=0;t<e.tiles.length;++t)i.tiles[t]=e.tiles[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CloseFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CloseFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.CloseFile)return e;let t=new a.CARTA.CloseFile;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetContourParameters=function(){function e(e){if(this.levels=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.referenceFileId=0,e.prototype.imageBounds=null,e.prototype.levels=s.emptyArray,e.prototype.smoothingMode=0,e.prototype.smoothingFactor=0,e.prototype.decimationFactor=0,e.prototype.compressionLevel=0,e.prototype.contourChunkSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).fixed32(e.fileId),null!=e.referenceFileId&&Object.hasOwnProperty.call(e,"referenceFileId")&&t.uint32(21).fixed32(e.referenceFileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&a.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.levels&&e.levels.length){t.uint32(34).fork();for(let i=0;i<e.levels.length;++i)t.double(e.levels[i]);t.ldelim()}return null!=e.smoothingMode&&Object.hasOwnProperty.call(e,"smoothingMode")&&t.uint32(40).int32(e.smoothingMode),null!=e.smoothingFactor&&Object.hasOwnProperty.call(e,"smoothingFactor")&&t.uint32(48).int32(e.smoothingFactor),null!=e.decimationFactor&&Object.hasOwnProperty.call(e,"decimationFactor")&&t.uint32(56).int32(e.decimationFactor),null!=e.compressionLevel&&Object.hasOwnProperty.call(e,"compressionLevel")&&t.uint32(64).int32(e.compressionLevel),null!=e.contourChunkSize&&Object.hasOwnProperty.call(e,"contourChunkSize")&&t.uint32(72).int32(e.contourChunkSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetContourParameters;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.fixed32();break;case 2:n.referenceFileId=e.fixed32();break;case 3:n.imageBounds=a.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:if(n.levels&&n.levels.length||(n.levels=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.levels.push(e.double())}else n.levels.push(e.double());break;case 5:n.smoothingMode=e.int32();break;case 6:n.smoothingFactor=e.int32();break;case 7:n.decimationFactor=e.int32();break;case 8:n.compressionLevel=e.int32();break;case 9:n.contourChunkSize=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&!s.isInteger(e.referenceFileId))return"referenceFileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=a.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.levels&&e.hasOwnProperty("levels")){if(!Array.isArray(e.levels))return"levels: array expected";for(let t=0;t<e.levels.length;++t)if("number"!==typeof e.levels[t])return"levels: number[] expected"}if(null!=e.smoothingMode&&e.hasOwnProperty("smoothingMode"))switch(e.smoothingMode){default:return"smoothingMode: enum value expected";case 0:case 1:case 2:}return null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&!s.isInteger(e.smoothingFactor)?"smoothingFactor: integer expected":null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&!s.isInteger(e.decimationFactor)?"decimationFactor: integer expected":null!=e.compressionLevel&&e.hasOwnProperty("compressionLevel")&&!s.isInteger(e.compressionLevel)?"compressionLevel: integer expected":null!=e.contourChunkSize&&e.hasOwnProperty("contourChunkSize")&&!s.isInteger(e.contourChunkSize)?"contourChunkSize: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SetContourParameters)return e;let t=new a.CARTA.SetContourParameters;if(null!=e.fileId&&(t.fileId=e.fileId>>>0),null!=e.referenceFileId&&(t.referenceFileId=e.referenceFileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.SetContourParameters.imageBounds: object expected");t.imageBounds=a.CARTA.ImageBounds.fromObject(e.imageBounds)}if(e.levels){if(!Array.isArray(e.levels))throw TypeError(".CARTA.SetContourParameters.levels: array expected");t.levels=[];for(let i=0;i<e.levels.length;++i)t.levels[i]=Number(e.levels[i])}switch(e.smoothingMode){case"NoSmoothing":case 0:t.smoothingMode=0;break;case"BlockAverage":case 1:t.smoothingMode=1;break;case"GaussianBlur":case 2:t.smoothingMode=2}return null!=e.smoothingFactor&&(t.smoothingFactor=0|e.smoothingFactor),null!=e.decimationFactor&&(t.decimationFactor=0|e.decimationFactor),null!=e.compressionLevel&&(t.compressionLevel=0|e.compressionLevel),null!=e.contourChunkSize&&(t.contourChunkSize=0|e.contourChunkSize),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.levels=[]),t.defaults&&(i.fileId=0,i.referenceFileId=0,i.imageBounds=null,i.smoothingMode=t.enums===String?"NoSmoothing":0,i.smoothingFactor=0,i.decimationFactor=0,i.compressionLevel=0,i.contourChunkSize=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&(i.referenceFileId=e.referenceFileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=a.CARTA.ImageBounds.toObject(e.imageBounds,t)),e.levels&&e.levels.length){i.levels=[];for(let n=0;n<e.levels.length;++n)i.levels[n]=t.json&&!isFinite(e.levels[n])?String(e.levels[n]):e.levels[n]}return null!=e.smoothingMode&&e.hasOwnProperty("smoothingMode")&&(i.smoothingMode=t.enums===String?a.CARTA.SmoothingMode[e.smoothingMode]:e.smoothingMode),null!=e.smoothingFactor&&e.hasOwnProperty("smoothingFactor")&&(i.smoothingFactor=e.smoothingFactor),null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&(i.decimationFactor=e.decimationFactor),null!=e.compressionLevel&&e.hasOwnProperty("compressionLevel")&&(i.compressionLevel=e.compressionLevel),null!=e.contourChunkSize&&e.hasOwnProperty("contourChunkSize")&&(i.contourChunkSize=e.contourChunkSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ExportRegion=function(){function e(e){if(this.regionStyles={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.type=0,e.prototype.coordType=0,e.prototype.fileId=0,e.prototype.regionStyles=s.emptyObject,e.prototype.directory="",e.prototype.file="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.coordType&&Object.hasOwnProperty.call(e,"coordType")&&t.uint32(16).int32(e.coordType),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.regionStyles&&Object.hasOwnProperty.call(e,"regionStyles"))for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).sfixed32(i[n]),a.CARTA.RegionStyle.encode(e.regionStyles[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(42).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(50).string(e.file),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.ExportRegion;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.type=e.int32();break;case 2:o.coordType=e.int32();break;case 3:o.fileId=e.sfixed32();break;case 4:e.skip().pos++,o.regionStyles===s.emptyObject&&(o.regionStyles={}),i=e.sfixed32(),e.pos++,o.regionStyles[i]=a.CARTA.RegionStyle.decode(e,e.uint32());break;case 5:o.directory=e.string();break;case 6:o.file=e.string();break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.coordType&&e.hasOwnProperty("coordType"))switch(e.coordType){default:return"coordType: enum value expected";case 0:case 1:}if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionStyles&&e.hasOwnProperty("regionStyles")){if(!s.isObject(e.regionStyles))return"regionStyles: object expected";let t=Object.keys(e.regionStyles);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"regionStyles: integer key{k:sfixed32} expected";{let n=a.CARTA.RegionStyle.verify(e.regionStyles[t[i]]);if(n)return"regionStyles."+n}}}return null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!s.isString(e.file)?"file: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ExportRegion)return e;let t=new a.CARTA.ExportRegion;switch(e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}switch(e.coordType){case"PIXEL":case 0:t.coordType=0;break;case"WORLD":case 1:t.coordType=1}if(null!=e.fileId&&(t.fileId=0|e.fileId),e.regionStyles){if("object"!==typeof e.regionStyles)throw TypeError(".CARTA.ExportRegion.regionStyles: object expected");t.regionStyles={};for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n){if("object"!==typeof e.regionStyles[i[n]])throw TypeError(".CARTA.ExportRegion.regionStyles: object expected");t.regionStyles[i[n]]=a.CARTA.RegionStyle.fromObject(e.regionStyles[i[n]])}}return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regionStyles={}),t.defaults&&(n.type=t.enums===String?"CASA":0,n.coordType=t.enums===String?"PIXEL":0,n.fileId=0,n.directory="",n.file=""),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?a.CARTA.FileType[e.type]:e.type),null!=e.coordType&&e.hasOwnProperty("coordType")&&(n.coordType=t.enums===String?a.CARTA.CoordinateType[e.coordType]:e.coordType),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),e.regionStyles&&(i=Object.keys(e.regionStyles)).length){n.regionStyles={};for(let r=0;r<i.length;++r)n.regionStyles[i[r]]=a.CARTA.RegionStyle.toObject(e.regionStyles[i[r]],t)}return null!=e.directory&&e.hasOwnProperty("directory")&&(n.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(n.file=e.file),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ExportRegionAck=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.contents=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(26).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ExportRegionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!s.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.ExportRegionAck)return e;let t=new a.CARTA.ExportRegionAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.ExportRegionAck.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImportRegion=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.groupId=0,e.prototype.type=0,e.prototype.directory="",e.prototype.file="",e.prototype.contents=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.groupId&&Object.hasOwnProperty.call(e,"groupId")&&t.uint32(13).sfixed32(e.groupId),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(16).int32(e.type),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(34).string(e.file),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(42).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ImportRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.groupId=e.sfixed32();break;case 2:n.type=e.int32();break;case 3:n.directory=e.string();break;case 4:n.file=e.string();break;case 5:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!s.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}if(null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!s.isString(e.file))return"file: string expected";if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!s.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.ImportRegion)return e;let t=new a.CARTA.ImportRegion;switch(null!=e.groupId&&(t.groupId=0|e.groupId),e.type){case"CASA":case 0:t.type=0;break;case"CRTF":case 1:t.type=1;break;case"DS9_REG":case 2:t.type=2;break;case"FITS":case 3:t.type=3;break;case"HDF5":case 4:t.type=4;break;case"MIRIAD":case 5:t.type=5;break;case"UNKNOWN":case 6:t.type=6}if(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.ImportRegion.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.groupId=0,i.type=t.enums===String?"CASA":0,i.directory="",i.file=""),null!=e.groupId&&e.hasOwnProperty("groupId")&&(i.groupId=e.groupId),null!=e.type&&e.hasOwnProperty("type")&&(i.type=t.enums===String?a.CARTA.FileType[e.type]:e.type),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImportRegionAck=function(){function e(e){if(this.regions={},this.regionStyles={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.regions=s.emptyObject,e.prototype.regionStyles=s.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.regions&&Object.hasOwnProperty.call(e,"regions"))for(let i=Object.keys(e.regions),n=0;n<i.length;++n)t.uint32(26).fork().uint32(13).sfixed32(i[n]),a.CARTA.RegionInfo.encode(e.regions[i[n]],t.uint32(18).fork()).ldelim().ldelim();if(null!=e.regionStyles&&Object.hasOwnProperty.call(e,"regionStyles"))for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).sfixed32(i[n]),a.CARTA.RegionStyle.encode(e.regionStyles[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.ImportRegionAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:e.skip().pos++,o.regions===s.emptyObject&&(o.regions={}),i=e.sfixed32(),e.pos++,o.regions[i]=a.CARTA.RegionInfo.decode(e,e.uint32());break;case 4:e.skip().pos++,o.regionStyles===s.emptyObject&&(o.regionStyles={}),i=e.sfixed32(),e.pos++,o.regionStyles[i]=a.CARTA.RegionStyle.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.regions&&e.hasOwnProperty("regions")){if(!s.isObject(e.regions))return"regions: object expected";let t=Object.keys(e.regions);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"regions: integer key{k:sfixed32} expected";{let n=a.CARTA.RegionInfo.verify(e.regions[t[i]]);if(n)return"regions."+n}}}if(null!=e.regionStyles&&e.hasOwnProperty("regionStyles")){if(!s.isObject(e.regionStyles))return"regionStyles: object expected";let t=Object.keys(e.regionStyles);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"regionStyles: integer key{k:sfixed32} expected";{let n=a.CARTA.RegionStyle.verify(e.regionStyles[t[i]]);if(n)return"regionStyles."+n}}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.ImportRegionAck)return e;let t=new a.CARTA.ImportRegionAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.regions){if("object"!==typeof e.regions)throw TypeError(".CARTA.ImportRegionAck.regions: object expected");t.regions={};for(let i=Object.keys(e.regions),n=0;n<i.length;++n){if("object"!==typeof e.regions[i[n]])throw TypeError(".CARTA.ImportRegionAck.regions: object expected");t.regions[i[n]]=a.CARTA.RegionInfo.fromObject(e.regions[i[n]])}}if(e.regionStyles){if("object"!==typeof e.regionStyles)throw TypeError(".CARTA.ImportRegionAck.regionStyles: object expected");t.regionStyles={};for(let i=Object.keys(e.regionStyles),n=0;n<i.length;++n){if("object"!==typeof e.regionStyles[i[n]])throw TypeError(".CARTA.ImportRegionAck.regionStyles: object expected");t.regionStyles[i[n]]=a.CARTA.RegionStyle.fromObject(e.regionStyles[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regions={},n.regionStyles={}),t.defaults&&(n.success=!1,n.message=""),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),e.regions&&(i=Object.keys(e.regions)).length){n.regions={};for(let r=0;r<i.length;++r)n.regions[i[r]]=a.CARTA.RegionInfo.toObject(e.regions[i[r]],t)}if(e.regionStyles&&(i=Object.keys(e.regionStyles)).length){n.regionStyles={};for(let r=0;r<i.length;++r)n.regionStyles[i[r]]=a.CARTA.RegionStyle.toObject(e.regionStyles[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenCatalogFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.name="",e.prototype.fileId=0,e.prototype.previewDataSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.previewDataSize&&Object.hasOwnProperty.call(e,"previewDataSize")&&t.uint32(37).sfixed32(e.previewDataSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.OpenCatalogFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.name=e.string();break;case 3:n.fileId=e.sfixed32();break;case 4:n.previewDataSize=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name)?"name: string expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null!=e.previewDataSize&&e.hasOwnProperty("previewDataSize")&&!s.isInteger(e.previewDataSize)?"previewDataSize: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.OpenCatalogFile)return e;let t=new a.CARTA.OpenCatalogFile;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.name&&(t.name=String(e.name)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.previewDataSize&&(t.previewDataSize=0|e.previewDataSize),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.name="",i.fileId=0,i.previewDataSize=0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.previewDataSize&&e.hasOwnProperty("previewDataSize")&&(i.previewDataSize=e.previewDataSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenCatalogFileAck=function(){function e(e){if(this.headers=[],this.previewData={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileId=0,e.prototype.fileInfo=null,e.prototype.dataSize=0,e.prototype.headers=s.emptyArray,e.prototype.previewData=s.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(29).sfixed32(e.fileId),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&a.CARTA.CatalogFileInfo.encode(e.fileInfo,t.uint32(34).fork()).ldelim(),null!=e.dataSize&&Object.hasOwnProperty.call(e,"dataSize")&&t.uint32(45).sfixed32(e.dataSize),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)a.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(50).fork()).ldelim();if(null!=e.previewData&&Object.hasOwnProperty.call(e,"previewData"))for(let i=Object.keys(e.previewData),n=0;n<i.length;++n)t.uint32(58).fork().uint32(13).fixed32(i[n]),a.CARTA.ColumnData.encode(e.previewData[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.OpenCatalogFileAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:o.fileId=e.sfixed32();break;case 4:o.fileInfo=a.CARTA.CatalogFileInfo.decode(e,e.uint32());break;case 5:o.dataSize=e.sfixed32();break;case 6:o.headers&&o.headers.length||(o.headers=[]),o.headers.push(a.CARTA.CatalogHeader.decode(e,e.uint32()));break;case 7:e.skip().pos++,o.previewData===s.emptyObject&&(o.previewData={}),i=e.fixed32(),e.pos++,o.previewData[i]=a.CARTA.ColumnData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=a.CARTA.CatalogFileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.dataSize&&e.hasOwnProperty("dataSize")&&!s.isInteger(e.dataSize))return"dataSize: integer expected";if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=a.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}if(null!=e.previewData&&e.hasOwnProperty("previewData")){if(!s.isObject(e.previewData))return"previewData: object expected";let t=Object.keys(e.previewData);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"previewData: integer key{k:fixed32} expected";{let n=a.CARTA.ColumnData.verify(e.previewData[t[i]]);if(n)return"previewData."+n}}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.OpenCatalogFileAck)return e;let t=new a.CARTA.OpenCatalogFileAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.OpenCatalogFileAck.fileInfo: object expected");t.fileInfo=a.CARTA.CatalogFileInfo.fromObject(e.fileInfo)}if(null!=e.dataSize&&(t.dataSize=0|e.dataSize),e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.OpenCatalogFileAck.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.OpenCatalogFileAck.headers: object expected");t.headers[i]=a.CARTA.CatalogHeader.fromObject(e.headers[i])}}if(e.previewData){if("object"!==typeof e.previewData)throw TypeError(".CARTA.OpenCatalogFileAck.previewData: object expected");t.previewData={};for(let i=Object.keys(e.previewData),n=0;n<i.length;++n){if("object"!==typeof e.previewData[i[n]])throw TypeError(".CARTA.OpenCatalogFileAck.previewData: object expected");t.previewData[i[n]]=a.CARTA.ColumnData.fromObject(e.previewData[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.headers=[]),(t.objects||t.defaults)&&(n.previewData={}),t.defaults&&(n.success=!1,n.message="",n.fileId=0,n.fileInfo=null,n.dataSize=0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(n.fileInfo=a.CARTA.CatalogFileInfo.toObject(e.fileInfo,t)),null!=e.dataSize&&e.hasOwnProperty("dataSize")&&(n.dataSize=e.dataSize),e.headers&&e.headers.length){n.headers=[];for(let i=0;i<e.headers.length;++i)n.headers[i]=a.CARTA.CatalogHeader.toObject(e.headers[i],t)}if(e.previewData&&(i=Object.keys(e.previewData)).length){n.previewData={};for(let r=0;r<i.length;++r)n.previewData[i[r]]=a.CARTA.ColumnData.toObject(e.previewData[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CloseCatalogFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CloseCatalogFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.CloseCatalogFile)return e;let t=new a.CARTA.CloseCatalogFile;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.fileId=0,e.prototype.renderMode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(37).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(40).int32(e.renderMode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.OpenFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;case 4:n.fileId=e.sfixed32();break;case 5:n.renderMode=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!s.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!s.isString(e.hdu))return"hdu: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof a.CARTA.OpenFile)return e;let t=new a.CARTA.OpenFile;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu="",i.fileId=0,i.renderMode=t.enums===String?"RASTER":0),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(i.renderMode=t.enums===String?a.CARTA.RenderMode[e.renderMode]:e.renderMode),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.OpenFileAck=function(){function e(e){if(this.beamTable=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.fileId=0,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.fileInfoExtended=null,e.prototype.fileFeatureFlags=0,e.prototype.beamTable=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(21).sfixed32(e.fileId),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&a.CARTA.FileInfo.encode(e.fileInfo,t.uint32(34).fork()).ldelim(),null!=e.fileInfoExtended&&Object.hasOwnProperty.call(e,"fileInfoExtended")&&a.CARTA.FileInfoExtended.encode(e.fileInfoExtended,t.uint32(42).fork()).ldelim(),null!=e.fileFeatureFlags&&Object.hasOwnProperty.call(e,"fileFeatureFlags")&&t.uint32(53).fixed32(e.fileFeatureFlags),null!=e.beamTable&&e.beamTable.length)for(let i=0;i<e.beamTable.length;++i)a.CARTA.Beam.encode(e.beamTable[i],t.uint32(58).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.OpenFileAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.fileId=e.sfixed32();break;case 3:n.message=e.string();break;case 4:n.fileInfo=a.CARTA.FileInfo.decode(e,e.uint32());break;case 5:n.fileInfoExtended=a.CARTA.FileInfoExtended.decode(e,e.uint32());break;case 6:n.fileFeatureFlags=e.fixed32();break;case 7:n.beamTable&&n.beamTable.length||(n.beamTable=[]),n.beamTable.push(a.CARTA.Beam.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=a.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")){let t=a.CARTA.FileInfoExtended.verify(e.fileInfoExtended);if(t)return"fileInfoExtended."+t}if(null!=e.fileFeatureFlags&&e.hasOwnProperty("fileFeatureFlags")&&!s.isInteger(e.fileFeatureFlags))return"fileFeatureFlags: integer expected";if(null!=e.beamTable&&e.hasOwnProperty("beamTable")){if(!Array.isArray(e.beamTable))return"beamTable: array expected";for(let t=0;t<e.beamTable.length;++t){let i=a.CARTA.Beam.verify(e.beamTable[t]);if(i)return"beamTable."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.OpenFileAck)return e;let t=new a.CARTA.OpenFileAck;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.OpenFileAck.fileInfo: object expected");t.fileInfo=a.CARTA.FileInfo.fromObject(e.fileInfo)}if(null!=e.fileInfoExtended){if("object"!==typeof e.fileInfoExtended)throw TypeError(".CARTA.OpenFileAck.fileInfoExtended: object expected");t.fileInfoExtended=a.CARTA.FileInfoExtended.fromObject(e.fileInfoExtended)}if(null!=e.fileFeatureFlags&&(t.fileFeatureFlags=e.fileFeatureFlags>>>0),e.beamTable){if(!Array.isArray(e.beamTable))throw TypeError(".CARTA.OpenFileAck.beamTable: array expected");t.beamTable=[];for(let i=0;i<e.beamTable.length;++i){if("object"!==typeof e.beamTable[i])throw TypeError(".CARTA.OpenFileAck.beamTable: object expected");t.beamTable[i]=a.CARTA.Beam.fromObject(e.beamTable[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.beamTable=[]),t.defaults&&(i.success=!1,i.fileId=0,i.message="",i.fileInfo=null,i.fileInfoExtended=null,i.fileFeatureFlags=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=a.CARTA.FileInfo.toObject(e.fileInfo,t)),null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")&&(i.fileInfoExtended=a.CARTA.FileInfoExtended.toObject(e.fileInfoExtended,t)),null!=e.fileFeatureFlags&&e.hasOwnProperty("fileFeatureFlags")&&(i.fileFeatureFlags=e.fileFeatureFlags),e.beamTable&&e.beamTable.length){i.beamTable=[];for(let n=0;n<e.beamTable.length;++n)i.beamTable[n]=a.CARTA.Beam.toObject(e.beamTable[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetRegion=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.regionInfo=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.regionInfo&&Object.hasOwnProperty.call(e,"regionInfo")&&a.CARTA.RegionInfo.encode(e.regionInfo,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.regionInfo=a.CARTA.RegionInfo.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.regionInfo&&e.hasOwnProperty("regionInfo")){let t=a.CARTA.RegionInfo.verify(e.regionInfo);if(t)return"regionInfo."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetRegion)return e;let t=new a.CARTA.SetRegion;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.regionInfo){if("object"!==typeof e.regionInfo)throw TypeError(".CARTA.SetRegion.regionInfo: object expected");t.regionInfo=a.CARTA.RegionInfo.fromObject(e.regionInfo)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.regionId=0,i.regionInfo=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.regionInfo&&e.hasOwnProperty("regionInfo")&&(i.regionInfo=a.CARTA.RegionInfo.toObject(e.regionInfo,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetRegionAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.regionId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(29).sfixed32(e.regionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetRegionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.regionId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId)?"regionId: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SetRegionAck)return e;let t=new a.CARTA.SetRegionAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.regionId&&(t.regionId=0|e.regionId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message="",i.regionId=0),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RemoveRegion=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.regionId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(13).sfixed32(e.regionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RemoveRegion;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.regionId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId)?"regionId: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RemoveRegion)return e;let t=new a.CARTA.RemoveRegion;return null!=e.regionId&&(t.regionId=0|e.regionId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.regionId=0),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetStatsRequirements=function(){function e(e){if(this.stats=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stats=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stats&&e.stats.length){t.uint32(26).fork();for(let i=0;i<e.stats.length;++i)t.int32(e.stats[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetStatsRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:if(n.stats&&n.stats.length||(n.stats=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.stats.push(e.int32())}else n.stats.push(e.int32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stats&&e.hasOwnProperty("stats")){if(!Array.isArray(e.stats))return"stats: array expected";for(let t=0;t<e.stats.length;++t)switch(e.stats[t]){default:return"stats: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetStatsRequirements)return e;let t=new a.CARTA.SetStatsRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.stats){if(!Array.isArray(e.stats))throw TypeError(".CARTA.SetStatsRequirements.stats: array expected");t.stats=[];for(let i=0;i<e.stats.length;++i)switch(e.stats[i]){default:case"NumPixels":case 0:t.stats[i]=0;break;case"NanCount":case 1:t.stats[i]=1;break;case"Sum":case 2:t.stats[i]=2;break;case"FluxDensity":case 3:t.stats[i]=3;break;case"Mean":case 4:t.stats[i]=4;break;case"RMS":case 5:t.stats[i]=5;break;case"Sigma":case 6:t.stats[i]=6;break;case"SumSq":case 7:t.stats[i]=7;break;case"Min":case 8:t.stats[i]=8;break;case"Max":case 9:t.stats[i]=9;break;case"Extrema":case 10:t.stats[i]=10;break;case"Blc":case 11:t.stats[i]=11;break;case"Trc":case 12:t.stats[i]=12;break;case"MinPos":case 13:t.stats[i]=13;break;case"MaxPos":case 14:t.stats[i]=14;break;case"Blcf":case 15:t.stats[i]=15;break;case"Trcf":case 16:t.stats[i]=16;break;case"MinPosf":case 17:t.stats[i]=17;break;case"MaxPosf":case 18:t.stats[i]=18}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.stats=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.stats&&e.stats.length){i.stats=[];for(let n=0;n<e.stats.length;++n)i.stats[n]=t.enums===String?a.CARTA.StatsType[e.stats[n]]:e.stats[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetHistogramRequirements=function(){function e(e){if(this.histograms=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.histograms=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.histograms&&e.histograms.length)for(let i=0;i<e.histograms.length;++i)a.CARTA.SetHistogramRequirements.HistogramConfig.encode(e.histograms[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetHistogramRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.histograms&&n.histograms.length||(n.histograms=[]),n.histograms.push(a.CARTA.SetHistogramRequirements.HistogramConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.histograms&&e.hasOwnProperty("histograms")){if(!Array.isArray(e.histograms))return"histograms: array expected";for(let t=0;t<e.histograms.length;++t){let i=a.CARTA.SetHistogramRequirements.HistogramConfig.verify(e.histograms[t]);if(i)return"histograms."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetHistogramRequirements)return e;let t=new a.CARTA.SetHistogramRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.histograms){if(!Array.isArray(e.histograms))throw TypeError(".CARTA.SetHistogramRequirements.histograms: array expected");t.histograms=[];for(let i=0;i<e.histograms.length;++i){if("object"!==typeof e.histograms[i])throw TypeError(".CARTA.SetHistogramRequirements.histograms: object expected");t.histograms[i]=a.CARTA.SetHistogramRequirements.HistogramConfig.fromObject(e.histograms[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.histograms=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.histograms&&e.histograms.length){i.histograms=[];for(let n=0;n<e.histograms.length;++n)i.histograms[n]=a.CARTA.SetHistogramRequirements.HistogramConfig.toObject(e.histograms[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.HistogramConfig=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.channel=0,e.prototype.numBins=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(13).sfixed32(e.channel),null!=e.numBins&&Object.hasOwnProperty.call(e,"numBins")&&t.uint32(21).sfixed32(e.numBins),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetHistogramRequirements.HistogramConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.channel=e.sfixed32();break;case 2:n.numBins=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel)?"channel: integer expected":null!=e.numBins&&e.hasOwnProperty("numBins")&&!s.isInteger(e.numBins)?"numBins: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SetHistogramRequirements.HistogramConfig)return e;let t=new a.CARTA.SetHistogramRequirements.HistogramConfig;return null!=e.channel&&(t.channel=0|e.channel),null!=e.numBins&&(t.numBins=0|e.numBins),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.channel=0,i.numBins=0),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.numBins&&e.hasOwnProperty("numBins")&&(i.numBins=e.numBins),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e}(),e.SetSpatialRequirements=function(){function e(e){if(this.spatialProfiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.spatialProfiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.spatialProfiles&&e.spatialProfiles.length)for(let i=0;i<e.spatialProfiles.length;++i)t.uint32(26).string(e.spatialProfiles[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetSpatialRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.spatialProfiles&&n.spatialProfiles.length||(n.spatialProfiles=[]),n.spatialProfiles.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spatialProfiles&&e.hasOwnProperty("spatialProfiles")){if(!Array.isArray(e.spatialProfiles))return"spatialProfiles: array expected";for(let t=0;t<e.spatialProfiles.length;++t)if(!s.isString(e.spatialProfiles[t]))return"spatialProfiles: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetSpatialRequirements)return e;let t=new a.CARTA.SetSpatialRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.spatialProfiles){if(!Array.isArray(e.spatialProfiles))throw TypeError(".CARTA.SetSpatialRequirements.spatialProfiles: array expected");t.spatialProfiles=[];for(let i=0;i<e.spatialProfiles.length;++i)t.spatialProfiles[i]=String(e.spatialProfiles[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.spatialProfiles=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.spatialProfiles&&e.spatialProfiles.length){i.spatialProfiles=[];for(let t=0;t<e.spatialProfiles.length;++t)i.spatialProfiles[t]=e.spatialProfiles[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetSpectralRequirements=function(){function e(e){if(this.spectralProfiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.spectralProfiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.spectralProfiles&&e.spectralProfiles.length)for(let i=0;i<e.spectralProfiles.length;++i)a.CARTA.SetSpectralRequirements.SpectralConfig.encode(e.spectralProfiles[i],t.uint32(26).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetSpectralRequirements;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.spectralProfiles&&n.spectralProfiles.length||(n.spectralProfiles=[]),n.spectralProfiles.push(a.CARTA.SetSpectralRequirements.SpectralConfig.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spectralProfiles&&e.hasOwnProperty("spectralProfiles")){if(!Array.isArray(e.spectralProfiles))return"spectralProfiles: array expected";for(let t=0;t<e.spectralProfiles.length;++t){let i=a.CARTA.SetSpectralRequirements.SpectralConfig.verify(e.spectralProfiles[t]);if(i)return"spectralProfiles."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetSpectralRequirements)return e;let t=new a.CARTA.SetSpectralRequirements;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.spectralProfiles){if(!Array.isArray(e.spectralProfiles))throw TypeError(".CARTA.SetSpectralRequirements.spectralProfiles: array expected");t.spectralProfiles=[];for(let i=0;i<e.spectralProfiles.length;++i){if("object"!==typeof e.spectralProfiles[i])throw TypeError(".CARTA.SetSpectralRequirements.spectralProfiles: object expected");t.spectralProfiles[i]=a.CARTA.SetSpectralRequirements.SpectralConfig.fromObject(e.spectralProfiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.spectralProfiles=[]),t.defaults&&(i.fileId=0,i.regionId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),e.spectralProfiles&&e.spectralProfiles.length){i.spectralProfiles=[];for(let n=0;n<e.spectralProfiles.length;++n)i.spectralProfiles[n]=a.CARTA.SetSpectralRequirements.SpectralConfig.toObject(e.spectralProfiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e.SpectralConfig=function(){function e(e){if(this.statsTypes=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.coordinate="",e.prototype.statsTypes=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.coordinate&&Object.hasOwnProperty.call(e,"coordinate")&&t.uint32(10).string(e.coordinate),null!=e.statsTypes&&e.statsTypes.length){t.uint32(18).fork();for(let i=0;i<e.statsTypes.length;++i)t.int32(e.statsTypes[i]);t.ldelim()}return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetSpectralRequirements.SpectralConfig;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.coordinate=e.string();break;case 2:if(n.statsTypes&&n.statsTypes.length||(n.statsTypes=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.statsTypes.push(e.int32())}else n.statsTypes.push(e.int32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.coordinate&&e.hasOwnProperty("coordinate")&&!s.isString(e.coordinate))return"coordinate: string expected";if(null!=e.statsTypes&&e.hasOwnProperty("statsTypes")){if(!Array.isArray(e.statsTypes))return"statsTypes: array expected";for(let t=0;t<e.statsTypes.length;++t)switch(e.statsTypes[t]){default:return"statsTypes: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetSpectralRequirements.SpectralConfig)return e;let t=new a.CARTA.SetSpectralRequirements.SpectralConfig;if(null!=e.coordinate&&(t.coordinate=String(e.coordinate)),e.statsTypes){if(!Array.isArray(e.statsTypes))throw TypeError(".CARTA.SetSpectralRequirements.SpectralConfig.statsTypes: array expected");t.statsTypes=[];for(let i=0;i<e.statsTypes.length;++i)switch(e.statsTypes[i]){default:case"NumPixels":case 0:t.statsTypes[i]=0;break;case"NanCount":case 1:t.statsTypes[i]=1;break;case"Sum":case 2:t.statsTypes[i]=2;break;case"FluxDensity":case 3:t.statsTypes[i]=3;break;case"Mean":case 4:t.statsTypes[i]=4;break;case"RMS":case 5:t.statsTypes[i]=5;break;case"Sigma":case 6:t.statsTypes[i]=6;break;case"SumSq":case 7:t.statsTypes[i]=7;break;case"Min":case 8:t.statsTypes[i]=8;break;case"Max":case 9:t.statsTypes[i]=9;break;case"Extrema":case 10:t.statsTypes[i]=10;break;case"Blc":case 11:t.statsTypes[i]=11;break;case"Trc":case 12:t.statsTypes[i]=12;break;case"MinPos":case 13:t.statsTypes[i]=13;break;case"MaxPos":case 14:t.statsTypes[i]=14;break;case"Blcf":case 15:t.statsTypes[i]=15;break;case"Trcf":case 16:t.statsTypes[i]=16;break;case"MinPosf":case 17:t.statsTypes[i]=17;break;case"MaxPosf":case 18:t.statsTypes[i]=18}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statsTypes=[]),t.defaults&&(i.coordinate=""),null!=e.coordinate&&e.hasOwnProperty("coordinate")&&(i.coordinate=e.coordinate),e.statsTypes&&e.statsTypes.length){i.statsTypes=[];for(let n=0;n<e.statsTypes.length;++n)i.statsTypes[n]=t.enums===String?a.CARTA.StatsType[e.statsTypes[n]]:e.statsTypes[n]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e}(),e.RegisterViewer=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sessionId=0,e.prototype.apiKey="",e.prototype.clientFeatureFlags=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(13).fixed32(e.sessionId),null!=e.apiKey&&Object.hasOwnProperty.call(e,"apiKey")&&t.uint32(18).string(e.apiKey),null!=e.clientFeatureFlags&&Object.hasOwnProperty.call(e,"clientFeatureFlags")&&t.uint32(29).fixed32(e.clientFeatureFlags),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegisterViewer;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.sessionId=e.fixed32();break;case 2:n.apiKey=e.string();break;case 3:n.clientFeatureFlags=e.fixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!s.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.apiKey&&e.hasOwnProperty("apiKey")&&!s.isString(e.apiKey)?"apiKey: string expected":null!=e.clientFeatureFlags&&e.hasOwnProperty("clientFeatureFlags")&&!s.isInteger(e.clientFeatureFlags)?"clientFeatureFlags: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RegisterViewer)return e;let t=new a.CARTA.RegisterViewer;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.apiKey&&(t.apiKey=String(e.apiKey)),null!=e.clientFeatureFlags&&(t.clientFeatureFlags=e.clientFeatureFlags>>>0),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.sessionId=0,i.apiKey="",i.clientFeatureFlags=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(i.sessionId=e.sessionId),null!=e.apiKey&&e.hasOwnProperty("apiKey")&&(i.apiKey=e.apiKey),null!=e.clientFeatureFlags&&e.hasOwnProperty("clientFeatureFlags")&&(i.clientFeatureFlags=e.clientFeatureFlags),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegisterViewerAck=function(){function e(e){if(this.userPreferences={},this.userLayouts={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.sessionId=0,e.prototype.success=!1,e.prototype.message="",e.prototype.sessionType=0,e.prototype.serverFeatureFlags=0,e.prototype.userPreferences=s.emptyObject,e.prototype.userLayouts=s.emptyObject,e.prototype.grpcPort=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(13).fixed32(e.sessionId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.sessionType&&Object.hasOwnProperty.call(e,"sessionType")&&t.uint32(32).int32(e.sessionType),null!=e.serverFeatureFlags&&Object.hasOwnProperty.call(e,"serverFeatureFlags")&&t.uint32(45).fixed32(e.serverFeatureFlags),null!=e.userPreferences&&Object.hasOwnProperty.call(e,"userPreferences"))for(let i=Object.keys(e.userPreferences),n=0;n<i.length;++n)t.uint32(50).fork().uint32(10).string(i[n]).uint32(18).string(e.userPreferences[i[n]]).ldelim();if(null!=e.userLayouts&&Object.hasOwnProperty.call(e,"userLayouts"))for(let i=Object.keys(e.userLayouts),n=0;n<i.length;++n)t.uint32(58).fork().uint32(10).string(i[n]).uint32(18).string(e.userLayouts[i[n]]).ldelim();return null!=e.grpcPort&&Object.hasOwnProperty.call(e,"grpcPort")&&t.uint32(69).fixed32(e.grpcPort),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.RegisterViewerAck;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.sessionId=e.fixed32();break;case 2:o.success=e.bool();break;case 3:o.message=e.string();break;case 4:o.sessionType=e.int32();break;case 5:o.serverFeatureFlags=e.fixed32();break;case 6:e.skip().pos++,o.userPreferences===s.emptyObject&&(o.userPreferences={}),i=e.string(),e.pos++,o.userPreferences[i]=e.string();break;case 7:e.skip().pos++,o.userLayouts===s.emptyObject&&(o.userLayouts={}),i=e.string(),e.pos++,o.userLayouts[i]=e.string();break;case 8:o.grpcPort=e.fixed32();break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!s.isInteger(e.sessionId))return"sessionId: integer expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.sessionType&&e.hasOwnProperty("sessionType"))switch(e.sessionType){default:return"sessionType: enum value expected";case 0:case 1:}if(null!=e.serverFeatureFlags&&e.hasOwnProperty("serverFeatureFlags")&&!s.isInteger(e.serverFeatureFlags))return"serverFeatureFlags: integer expected";if(null!=e.userPreferences&&e.hasOwnProperty("userPreferences")){if(!s.isObject(e.userPreferences))return"userPreferences: object expected";let t=Object.keys(e.userPreferences);for(let i=0;i<t.length;++i)if(!s.isString(e.userPreferences[t[i]]))return"userPreferences: string{k:string} expected"}if(null!=e.userLayouts&&e.hasOwnProperty("userLayouts")){if(!s.isObject(e.userLayouts))return"userLayouts: object expected";let t=Object.keys(e.userLayouts);for(let i=0;i<t.length;++i)if(!s.isString(e.userLayouts[t[i]]))return"userLayouts: string{k:string} expected"}return null!=e.grpcPort&&e.hasOwnProperty("grpcPort")&&!s.isInteger(e.grpcPort)?"grpcPort: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RegisterViewerAck)return e;let t=new a.CARTA.RegisterViewerAck;switch(null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.sessionType){case"NEW":case 0:t.sessionType=0;break;case"RESUMED":case 1:t.sessionType=1}if(null!=e.serverFeatureFlags&&(t.serverFeatureFlags=e.serverFeatureFlags>>>0),e.userPreferences){if("object"!==typeof e.userPreferences)throw TypeError(".CARTA.RegisterViewerAck.userPreferences: object expected");t.userPreferences={};for(let i=Object.keys(e.userPreferences),n=0;n<i.length;++n)t.userPreferences[i[n]]=String(e.userPreferences[i[n]])}if(e.userLayouts){if("object"!==typeof e.userLayouts)throw TypeError(".CARTA.RegisterViewerAck.userLayouts: object expected");t.userLayouts={};for(let i=Object.keys(e.userLayouts),n=0;n<i.length;++n)t.userLayouts[i[n]]=String(e.userLayouts[i[n]])}return null!=e.grpcPort&&(t.grpcPort=e.grpcPort>>>0),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.userPreferences={},n.userLayouts={}),t.defaults&&(n.sessionId=0,n.success=!1,n.message="",n.sessionType=t.enums===String?"NEW":0,n.serverFeatureFlags=0,n.grpcPort=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(n.sessionId=e.sessionId),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.sessionType&&e.hasOwnProperty("sessionType")&&(n.sessionType=t.enums===String?a.CARTA.SessionType[e.sessionType]:e.sessionType),null!=e.serverFeatureFlags&&e.hasOwnProperty("serverFeatureFlags")&&(n.serverFeatureFlags=e.serverFeatureFlags),e.userPreferences&&(i=Object.keys(e.userPreferences)).length){n.userPreferences={};for(let t=0;t<i.length;++t)n.userPreferences[i[t]]=e.userPreferences[i[t]]}if(e.userLayouts&&(i=Object.keys(e.userLayouts)).length){n.userLayouts={};for(let t=0;t<i.length;++t)n.userLayouts[i[t]]=e.userLayouts[i[t]]}return null!=e.grpcPort&&e.hasOwnProperty("grpcPort")&&(n.grpcPort=e.grpcPort),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ImageProperties=function(){function e(e){if(this.regions={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.prototype.fileId=0,e.prototype.renderMode=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.regions=s.emptyObject,e.prototype.contourSettings=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(37).sfixed32(e.fileId),null!=e.renderMode&&Object.hasOwnProperty.call(e,"renderMode")&&t.uint32(40).int32(e.renderMode),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(53).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(61).sfixed32(e.stokes),null!=e.regions&&Object.hasOwnProperty.call(e,"regions"))for(let i=Object.keys(e.regions),n=0;n<i.length;++n)t.uint32(66).fork().uint32(13).sfixed32(i[n]),a.CARTA.RegionInfo.encode(e.regions[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.contourSettings&&Object.hasOwnProperty.call(e,"contourSettings")&&a.CARTA.SetContourParameters.encode(e.contourSettings,t.uint32(74).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.ImageProperties;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.directory=e.string();break;case 2:o.file=e.string();break;case 3:o.hdu=e.string();break;case 4:o.fileId=e.sfixed32();break;case 5:o.renderMode=e.int32();break;case 6:o.channel=e.sfixed32();break;case 7:o.stokes=e.sfixed32();break;case 8:e.skip().pos++,o.regions===s.emptyObject&&(o.regions={}),i=e.sfixed32(),e.pos++,o.regions[i]=a.CARTA.RegionInfo.decode(e,e.uint32());break;case 9:o.contourSettings=a.CARTA.SetContourParameters.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory))return"directory: string expected";if(null!=e.file&&e.hasOwnProperty("file")&&!s.isString(e.file))return"file: string expected";if(null!=e.hdu&&e.hasOwnProperty("hdu")&&!s.isString(e.hdu))return"hdu: string expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.renderMode&&e.hasOwnProperty("renderMode"))switch(e.renderMode){default:return"renderMode: enum value expected";case 0:case 1:}if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.regions&&e.hasOwnProperty("regions")){if(!s.isObject(e.regions))return"regions: object expected";let t=Object.keys(e.regions);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"regions: integer key{k:sfixed32} expected";{let n=a.CARTA.RegionInfo.verify(e.regions[t[i]]);if(n)return"regions."+n}}}if(null!=e.contourSettings&&e.hasOwnProperty("contourSettings")){let t=a.CARTA.SetContourParameters.verify(e.contourSettings);if(t)return"contourSettings."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.ImageProperties)return e;let t=new a.CARTA.ImageProperties;switch(null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),null!=e.fileId&&(t.fileId=0|e.fileId),e.renderMode){case"RASTER":case 0:t.renderMode=0;break;case"CONTOUR":case 1:t.renderMode=1}if(null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.regions){if("object"!==typeof e.regions)throw TypeError(".CARTA.ImageProperties.regions: object expected");t.regions={};for(let i=Object.keys(e.regions),n=0;n<i.length;++n){if("object"!==typeof e.regions[i[n]])throw TypeError(".CARTA.ImageProperties.regions: object expected");t.regions[i[n]]=a.CARTA.RegionInfo.fromObject(e.regions[i[n]])}}if(null!=e.contourSettings){if("object"!==typeof e.contourSettings)throw TypeError(".CARTA.ImageProperties.contourSettings: object expected");t.contourSettings=a.CARTA.SetContourParameters.fromObject(e.contourSettings)}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.regions={}),t.defaults&&(n.directory="",n.file="",n.hdu="",n.fileId=0,n.renderMode=t.enums===String?"RASTER":0,n.channel=0,n.stokes=0,n.contourSettings=null),null!=e.directory&&e.hasOwnProperty("directory")&&(n.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(n.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(n.hdu=e.hdu),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.renderMode&&e.hasOwnProperty("renderMode")&&(n.renderMode=t.enums===String?a.CARTA.RenderMode[e.renderMode]:e.renderMode),null!=e.channel&&e.hasOwnProperty("channel")&&(n.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(n.stokes=e.stokes),e.regions&&(i=Object.keys(e.regions)).length){n.regions={};for(let r=0;r<i.length;++r)n.regions[i[r]]=a.CARTA.RegionInfo.toObject(e.regions[i[r]],t)}return null!=e.contourSettings&&e.hasOwnProperty("contourSettings")&&(n.contourSettings=a.CARTA.SetContourParameters.toObject(e.contourSettings,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ResumeSession=function(){function e(e){if(this.images=[],this.catalogFiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.images=s.emptyArray,e.prototype.catalogFiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.images&&e.images.length)for(let i=0;i<e.images.length;++i)a.CARTA.ImageProperties.encode(e.images[i],t.uint32(10).fork()).ldelim();if(null!=e.catalogFiles&&e.catalogFiles.length)for(let i=0;i<e.catalogFiles.length;++i)a.CARTA.OpenCatalogFile.encode(e.catalogFiles[i],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ResumeSession;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.images&&n.images.length||(n.images=[]),n.images.push(a.CARTA.ImageProperties.decode(e,e.uint32()));break;case 2:n.catalogFiles&&n.catalogFiles.length||(n.catalogFiles=[]),n.catalogFiles.push(a.CARTA.OpenCatalogFile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.images&&e.hasOwnProperty("images")){if(!Array.isArray(e.images))return"images: array expected";for(let t=0;t<e.images.length;++t){let i=a.CARTA.ImageProperties.verify(e.images[t]);if(i)return"images."+i}}if(null!=e.catalogFiles&&e.hasOwnProperty("catalogFiles")){if(!Array.isArray(e.catalogFiles))return"catalogFiles: array expected";for(let t=0;t<e.catalogFiles.length;++t){let i=a.CARTA.OpenCatalogFile.verify(e.catalogFiles[t]);if(i)return"catalogFiles."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.ResumeSession)return e;let t=new a.CARTA.ResumeSession;if(e.images){if(!Array.isArray(e.images))throw TypeError(".CARTA.ResumeSession.images: array expected");t.images=[];for(let i=0;i<e.images.length;++i){if("object"!==typeof e.images[i])throw TypeError(".CARTA.ResumeSession.images: object expected");t.images[i]=a.CARTA.ImageProperties.fromObject(e.images[i])}}if(e.catalogFiles){if(!Array.isArray(e.catalogFiles))throw TypeError(".CARTA.ResumeSession.catalogFiles: array expected");t.catalogFiles=[];for(let i=0;i<e.catalogFiles.length;++i){if("object"!==typeof e.catalogFiles[i])throw TypeError(".CARTA.ResumeSession.catalogFiles: object expected");t.catalogFiles[i]=a.CARTA.OpenCatalogFile.fromObject(e.catalogFiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.images=[],i.catalogFiles=[]),e.images&&e.images.length){i.images=[];for(let n=0;n<e.images.length;++n)i.images[n]=a.CARTA.ImageProperties.toObject(e.images[n],t)}if(e.catalogFiles&&e.catalogFiles.length){i.catalogFiles=[];for(let n=0;n<e.catalogFiles.length;++n)i.catalogFiles[n]=a.CARTA.OpenCatalogFile.toObject(e.catalogFiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ResumeSessionAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ResumeSessionAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ResumeSessionAck)return e;let t=new a.CARTA.ResumeSessionAck;return null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.success=!1,i.message=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetCursor=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.point=null,e.prototype.spatialRequirements=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.point&&Object.hasOwnProperty.call(e,"point")&&a.CARTA.Point.encode(e.point,t.uint32(18).fork()).ldelim(),null!=e.spatialRequirements&&Object.hasOwnProperty.call(e,"spatialRequirements")&&a.CARTA.SetSpatialRequirements.encode(e.spatialRequirements,t.uint32(26).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetCursor;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.point=a.CARTA.Point.decode(e,e.uint32());break;case 3:n.spatialRequirements=a.CARTA.SetSpatialRequirements.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.point&&e.hasOwnProperty("point")){let t=a.CARTA.Point.verify(e.point);if(t)return"point."+t}if(null!=e.spatialRequirements&&e.hasOwnProperty("spatialRequirements")){let t=a.CARTA.SetSpatialRequirements.verify(e.spatialRequirements);if(t)return"spatialRequirements."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetCursor)return e;let t=new a.CARTA.SetCursor;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.point){if("object"!==typeof e.point)throw TypeError(".CARTA.SetCursor.point: object expected");t.point=a.CARTA.Point.fromObject(e.point)}if(null!=e.spatialRequirements){if("object"!==typeof e.spatialRequirements)throw TypeError(".CARTA.SetCursor.spatialRequirements: object expected");t.spatialRequirements=a.CARTA.SetSpatialRequirements.fromObject(e.spatialRequirements)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.point=null,i.spatialRequirements=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.point&&e.hasOwnProperty("point")&&(i.point=a.CARTA.Point.toObject(e.point,t)),null!=e.spatialRequirements&&e.hasOwnProperty("spatialRequirements")&&(i.spatialRequirements=a.CARTA.SetSpatialRequirements.toObject(e.spatialRequirements,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SetImageChannels=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.requiredTiles=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.requiredTiles&&Object.hasOwnProperty.call(e,"requiredTiles")&&a.CARTA.AddRequiredTiles.encode(e.requiredTiles,t.uint32(34).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SetImageChannels;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.requiredTiles=a.CARTA.AddRequiredTiles.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")){let t=a.CARTA.AddRequiredTiles.verify(e.requiredTiles);if(t)return"requiredTiles."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SetImageChannels)return e;let t=new a.CARTA.SetImageChannels;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.requiredTiles){if("object"!==typeof e.requiredTiles)throw TypeError(".CARTA.SetImageChannels.requiredTiles: object expected");t.requiredTiles=a.CARTA.AddRequiredTiles.fromObject(e.requiredTiles)}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.requiredTiles=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.requiredTiles&&e.hasOwnProperty("requiredTiles")&&(i.requiredTiles=a.CARTA.AddRequiredTiles.toObject(e.requiredTiles,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralLineRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.frequencyRange=null,e.prototype.lineIntensityLowerLimit=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.frequencyRange&&Object.hasOwnProperty.call(e,"frequencyRange")&&a.CARTA.DoubleBounds.encode(e.frequencyRange,t.uint32(10).fork()).ldelim(),null!=e.lineIntensityLowerLimit&&Object.hasOwnProperty.call(e,"lineIntensityLowerLimit")&&t.uint32(17).double(e.lineIntensityLowerLimit),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SpectralLineRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.frequencyRange=a.CARTA.DoubleBounds.decode(e,e.uint32());break;case 2:n.lineIntensityLowerLimit=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.frequencyRange&&e.hasOwnProperty("frequencyRange")){let t=a.CARTA.DoubleBounds.verify(e.frequencyRange);if(t)return"frequencyRange."+t}return null!=e.lineIntensityLowerLimit&&e.hasOwnProperty("lineIntensityLowerLimit")&&"number"!==typeof e.lineIntensityLowerLimit?"lineIntensityLowerLimit: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SpectralLineRequest)return e;let t=new a.CARTA.SpectralLineRequest;if(null!=e.frequencyRange){if("object"!==typeof e.frequencyRange)throw TypeError(".CARTA.SpectralLineRequest.frequencyRange: object expected");t.frequencyRange=a.CARTA.DoubleBounds.fromObject(e.frequencyRange)}return null!=e.lineIntensityLowerLimit&&(t.lineIntensityLowerLimit=Number(e.lineIntensityLowerLimit)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.frequencyRange=null,i.lineIntensityLowerLimit=0),null!=e.frequencyRange&&e.hasOwnProperty("frequencyRange")&&(i.frequencyRange=a.CARTA.DoubleBounds.toObject(e.frequencyRange,t)),null!=e.lineIntensityLowerLimit&&e.hasOwnProperty("lineIntensityLowerLimit")&&(i.lineIntensityLowerLimit=t.json&&!isFinite(e.lineIntensityLowerLimit)?String(e.lineIntensityLowerLimit):e.lineIntensityLowerLimit),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralLineResponse=function(){function e(e){if(this.headers=[],this.spectralLineData={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.dataSize=0,e.prototype.headers=s.emptyArray,e.prototype.spectralLineData=s.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.dataSize&&Object.hasOwnProperty.call(e,"dataSize")&&t.uint32(29).sfixed32(e.dataSize),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)a.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(34).fork()).ldelim();if(null!=e.spectralLineData&&Object.hasOwnProperty.call(e,"spectralLineData"))for(let i=Object.keys(e.spectralLineData),n=0;n<i.length;++n)t.uint32(42).fork().uint32(13).fixed32(i[n]),a.CARTA.ColumnData.encode(e.spectralLineData[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.SpectralLineResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:o.dataSize=e.sfixed32();break;case 4:o.headers&&o.headers.length||(o.headers=[]),o.headers.push(a.CARTA.CatalogHeader.decode(e,e.uint32()));break;case 5:e.skip().pos++,o.spectralLineData===s.emptyObject&&(o.spectralLineData={}),i=e.fixed32(),e.pos++,o.spectralLineData[i]=a.CARTA.ColumnData.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.dataSize&&e.hasOwnProperty("dataSize")&&!s.isInteger(e.dataSize))return"dataSize: integer expected";if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=a.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}if(null!=e.spectralLineData&&e.hasOwnProperty("spectralLineData")){if(!s.isObject(e.spectralLineData))return"spectralLineData: object expected";let t=Object.keys(e.spectralLineData);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"spectralLineData: integer key{k:fixed32} expected";{let n=a.CARTA.ColumnData.verify(e.spectralLineData[t[i]]);if(n)return"spectralLineData."+n}}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SpectralLineResponse)return e;let t=new a.CARTA.SpectralLineResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.dataSize&&(t.dataSize=0|e.dataSize),e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.SpectralLineResponse.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.SpectralLineResponse.headers: object expected");t.headers[i]=a.CARTA.CatalogHeader.fromObject(e.headers[i])}}if(e.spectralLineData){if("object"!==typeof e.spectralLineData)throw TypeError(".CARTA.SpectralLineResponse.spectralLineData: object expected");t.spectralLineData={};for(let i=Object.keys(e.spectralLineData),n=0;n<i.length;++n){if("object"!==typeof e.spectralLineData[i[n]])throw TypeError(".CARTA.SpectralLineResponse.spectralLineData: object expected");t.spectralLineData[i[n]]=a.CARTA.ColumnData.fromObject(e.spectralLineData[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.arrays||t.defaults)&&(n.headers=[]),(t.objects||t.defaults)&&(n.spectralLineData={}),t.defaults&&(n.success=!1,n.message="",n.dataSize=0),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.dataSize&&e.hasOwnProperty("dataSize")&&(n.dataSize=e.dataSize),e.headers&&e.headers.length){n.headers=[];for(let i=0;i<e.headers.length;++i)n.headers[i]=a.CARTA.CatalogHeader.toObject(e.headers[i],t)}if(e.spectralLineData&&(i=Object.keys(e.spectralLineData)).length){n.spectralLineData={};for(let r=0;r<i.length;++r)n.spectralLineData[i[r]]=a.CARTA.ColumnData.toObject(e.spectralLineData[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.StopMomentCalc=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.StopMomentCalc;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.StopMomentCalc)return e;let t=new a.CARTA.StopMomentCalc;return null!=e.fileId&&(t.fileId=0|e.fileId),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.name="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.name&&Object.hasOwnProperty.call(e,"name")&&t.uint32(18).string(e.name),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogFileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.name=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null!=e.name&&e.hasOwnProperty("name")&&!s.isString(e.name)?"name: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogFileInfoRequest)return e;let t=new a.CARTA.CatalogFileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.name&&(t.name=String(e.name)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.name=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.name&&e.hasOwnProperty("name")&&(i.name=e.name),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFileInfoResponse=function(){function e(e){if(this.headers=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.headers=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&a.CARTA.CatalogFileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.headers&&e.headers.length)for(let i=0;i<e.headers.length;++i)a.CARTA.CatalogHeader.encode(e.headers[i],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogFileInfoResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.fileInfo=a.CARTA.CatalogFileInfo.decode(e,e.uint32());break;case 4:n.headers&&n.headers.length||(n.headers=[]),n.headers.push(a.CARTA.CatalogHeader.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=a.CARTA.CatalogFileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.headers&&e.hasOwnProperty("headers")){if(!Array.isArray(e.headers))return"headers: array expected";for(let t=0;t<e.headers.length;++t){let i=a.CARTA.CatalogHeader.verify(e.headers[t]);if(i)return"headers."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogFileInfoResponse)return e;let t=new a.CARTA.CatalogFileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.CatalogFileInfoResponse.fileInfo: object expected");t.fileInfo=a.CARTA.CatalogFileInfo.fromObject(e.fileInfo)}if(e.headers){if(!Array.isArray(e.headers))throw TypeError(".CARTA.CatalogFileInfoResponse.headers: array expected");t.headers=[];for(let i=0;i<e.headers.length;++i){if("object"!==typeof e.headers[i])throw TypeError(".CARTA.CatalogFileInfoResponse.headers: object expected");t.headers[i]=a.CARTA.CatalogHeader.fromObject(e.headers[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.headers=[]),t.defaults&&(i.success=!1,i.message="",i.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=a.CARTA.CatalogFileInfo.toObject(e.fileInfo,t)),e.headers&&e.headers.length){i.headers=[];for(let n=0;n<e.headers.length;++n)i.headers[n]=a.CARTA.CatalogHeader.toObject(e.headers[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogListRequest)return e;let t=new a.CARTA.CatalogListRequest;return null!=e.directory&&(t.directory=String(e.directory)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=s.emptyArray,e.prototype.subdirectories=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)a.CARTA.CatalogFileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)t.uint32(50).string(e.subdirectories[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(a.CARTA.CatalogFileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!s.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=a.CARTA.CatalogFileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t)if(!s.isString(e.subdirectories[t]))return"subdirectories: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogListResponse)return e;let t=new a.CARTA.CatalogListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.CatalogListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.CatalogListResponse.files: object expected");t.files[i]=a.CARTA.CatalogFileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.CatalogListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i)t.subdirectories[i]=String(e.subdirectories[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=a.CARTA.CatalogFileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let t=0;t<e.subdirectories.length;++t)i.subdirectories[t]=e.subdirectories[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.prototype.hdu="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),null!=e.hdu&&Object.hasOwnProperty.call(e,"hdu")&&t.uint32(26).string(e.hdu),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;case 3:n.hdu=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!s.isString(e.file)?"file: string expected":null!=e.hdu&&e.hasOwnProperty("hdu")&&!s.isString(e.hdu)?"hdu: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.FileInfoRequest)return e;let t=new a.CARTA.FileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),null!=e.hdu&&(t.hdu=String(e.hdu)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file="",i.hdu=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),null!=e.hdu&&e.hasOwnProperty("hdu")&&(i.hdu=e.hdu),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileInfoResponse=function(){function e(e){if(this.fileInfoExtended={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.fileInfoExtended=s.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&a.CARTA.FileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.fileInfoExtended&&Object.hasOwnProperty.call(e,"fileInfoExtended"))for(let i=Object.keys(e.fileInfoExtended),n=0;n<i.length;++n)t.uint32(34).fork().uint32(10).string(i[n]),a.CARTA.FileInfoExtended.encode(e.fileInfoExtended[i[n]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.FileInfoResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.success=e.bool();break;case 2:o.message=e.string();break;case 3:o.fileInfo=a.CARTA.FileInfo.decode(e,e.uint32());break;case 4:e.skip().pos++,o.fileInfoExtended===s.emptyObject&&(o.fileInfoExtended={}),i=e.string(),e.pos++,o.fileInfoExtended[i]=a.CARTA.FileInfoExtended.decode(e,e.uint32());break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=a.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.fileInfoExtended&&e.hasOwnProperty("fileInfoExtended")){if(!s.isObject(e.fileInfoExtended))return"fileInfoExtended: object expected";let t=Object.keys(e.fileInfoExtended);for(let i=0;i<t.length;++i){let n=a.CARTA.FileInfoExtended.verify(e.fileInfoExtended[t[i]]);if(n)return"fileInfoExtended."+n}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.FileInfoResponse)return e;let t=new a.CARTA.FileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.FileInfoResponse.fileInfo: object expected");t.fileInfo=a.CARTA.FileInfo.fromObject(e.fileInfo)}if(e.fileInfoExtended){if("object"!==typeof e.fileInfoExtended)throw TypeError(".CARTA.FileInfoResponse.fileInfoExtended: object expected");t.fileInfoExtended={};for(let i=Object.keys(e.fileInfoExtended),n=0;n<i.length;++n){if("object"!==typeof e.fileInfoExtended[i[n]])throw TypeError(".CARTA.FileInfoResponse.fileInfoExtended: object expected");t.fileInfoExtended[i[n]]=a.CARTA.FileInfoExtended.fromObject(e.fileInfoExtended[i[n]])}}return t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.fileInfoExtended={}),t.defaults&&(n.success=!1,n.message="",n.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(n.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(n.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(n.fileInfo=a.CARTA.FileInfo.toObject(e.fileInfo,t)),e.fileInfoExtended&&(i=Object.keys(e.fileInfoExtended)).length){n.fileInfoExtended={};for(let r=0;r<i.length;++r)n.fileInfoExtended[i[r]]=a.CARTA.FileInfoExtended.toObject(e.fileInfoExtended[i[r]],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FileListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.FileListRequest)return e;let t=new a.CARTA.FileListRequest;return null!=e.directory&&(t.directory=String(e.directory)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.FileListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=s.emptyArray,e.prototype.subdirectories=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)a.CARTA.FileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)t.uint32(50).string(e.subdirectories[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.FileListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(a.CARTA.FileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!s.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=a.CARTA.FileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t)if(!s.isString(e.subdirectories[t]))return"subdirectories: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.FileListResponse)return e;let t=new a.CARTA.FileListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.FileListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.FileListResponse.files: object expected");t.files[i]=a.CARTA.FileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.FileListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i)t.subdirectories[i]=String(e.subdirectories[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=a.CARTA.FileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let t=0;t<e.subdirectories.length;++t)i.subdirectories[t]=e.subdirectories[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MomentRequest=function(){function e(e){if(this.moments=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.moments=s.emptyArray,e.prototype.axis=0,e.prototype.regionId=0,e.prototype.spectralRange=null,e.prototype.mask=0,e.prototype.pixelRange=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.moments&&e.moments.length){t.uint32(18).fork();for(let i=0;i<e.moments.length;++i)t.int32(e.moments[i]);t.ldelim()}return null!=e.axis&&Object.hasOwnProperty.call(e,"axis")&&t.uint32(24).int32(e.axis),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(37).sfixed32(e.regionId),null!=e.spectralRange&&Object.hasOwnProperty.call(e,"spectralRange")&&a.CARTA.IntBounds.encode(e.spectralRange,t.uint32(42).fork()).ldelim(),null!=e.mask&&Object.hasOwnProperty.call(e,"mask")&&t.uint32(48).int32(e.mask),null!=e.pixelRange&&Object.hasOwnProperty.call(e,"pixelRange")&&a.CARTA.FloatBounds.encode(e.pixelRange,t.uint32(58).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.MomentRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.moments&&n.moments.length||(n.moments=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.moments.push(e.int32())}else n.moments.push(e.int32());break;case 3:n.axis=e.int32();break;case 4:n.regionId=e.sfixed32();break;case 5:n.spectralRange=a.CARTA.IntBounds.decode(e,e.uint32());break;case 6:n.mask=e.int32();break;case 7:n.pixelRange=a.CARTA.FloatBounds.decode(e,e.uint32());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.moments&&e.hasOwnProperty("moments")){if(!Array.isArray(e.moments))return"moments: array expected";for(let t=0;t<e.moments.length;++t)switch(e.moments[t]){default:return"moments: enum value[] expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:}}if(null!=e.axis&&e.hasOwnProperty("axis"))switch(e.axis){default:return"axis: enum value expected";case 0:case 1:}if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.spectralRange&&e.hasOwnProperty("spectralRange")){let t=a.CARTA.IntBounds.verify(e.spectralRange);if(t)return"spectralRange."+t}if(null!=e.mask&&e.hasOwnProperty("mask"))switch(e.mask){default:return"mask: enum value expected";case 0:case 1:case 2:}if(null!=e.pixelRange&&e.hasOwnProperty("pixelRange")){let t=a.CARTA.FloatBounds.verify(e.pixelRange);if(t)return"pixelRange."+t}return null},e.fromObject=function(e){if(e instanceof a.CARTA.MomentRequest)return e;let t=new a.CARTA.MomentRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.moments){if(!Array.isArray(e.moments))throw TypeError(".CARTA.MomentRequest.moments: array expected");t.moments=[];for(let i=0;i<e.moments.length;++i)switch(e.moments[i]){default:case"MEAN_OF_THE_SPECTRUM":case 0:t.moments[i]=0;break;case"INTEGRATED_OF_THE_SPECTRUM":case 1:t.moments[i]=1;break;case"INTENSITY_WEIGHTED_COORD":case 2:t.moments[i]=2;break;case"INTENSITY_WEIGHTED_DISPERSION_OF_THE_COORD":case 3:t.moments[i]=3;break;case"MEDIAN_OF_THE_SPECTRUM":case 4:t.moments[i]=4;break;case"MEDIAN_COORDINATE":case 5:t.moments[i]=5;break;case"STD_ABOUT_THE_MEAN_OF_THE_SPECTRUM":case 6:t.moments[i]=6;break;case"RMS_OF_THE_SPECTRUM":case 7:t.moments[i]=7;break;case"ABS_MEAN_DEVIATION_OF_THE_SPECTRUM":case 8:t.moments[i]=8;break;case"MAX_OF_THE_SPECTRUM":case 9:t.moments[i]=9;break;case"COORD_OF_THE_MAX_OF_THE_SPECTRUM":case 10:t.moments[i]=10;break;case"MIN_OF_THE_SPECTRUM":case 11:t.moments[i]=11;break;case"COORD_OF_THE_MIN_OF_THE_SPECTRUM":case 12:t.moments[i]=12}}switch(e.axis){case"SPECTRAL":case 0:t.axis=0;break;case"STOKES":case 1:t.axis=1}if(null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.spectralRange){if("object"!==typeof e.spectralRange)throw TypeError(".CARTA.MomentRequest.spectralRange: object expected");t.spectralRange=a.CARTA.IntBounds.fromObject(e.spectralRange)}switch(e.mask){case"None":case 0:t.mask=0;break;case"Include":case 1:t.mask=1;break;case"Exclude":case 2:t.mask=2}if(null!=e.pixelRange){if("object"!==typeof e.pixelRange)throw TypeError(".CARTA.MomentRequest.pixelRange: object expected");t.pixelRange=a.CARTA.FloatBounds.fromObject(e.pixelRange)}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.moments=[]),t.defaults&&(i.fileId=0,i.axis=t.enums===String?"SPECTRAL":0,i.regionId=0,i.spectralRange=null,i.mask=t.enums===String?"None":0,i.pixelRange=null),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.moments&&e.moments.length){i.moments=[];for(let n=0;n<e.moments.length;++n)i.moments[n]=t.enums===String?a.CARTA.Moment[e.moments[n]]:e.moments[n]}return null!=e.axis&&e.hasOwnProperty("axis")&&(i.axis=t.enums===String?a.CARTA.MomentAxis[e.axis]:e.axis),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.spectralRange&&e.hasOwnProperty("spectralRange")&&(i.spectralRange=a.CARTA.IntBounds.toObject(e.spectralRange,t)),null!=e.mask&&e.hasOwnProperty("mask")&&(i.mask=t.enums===String?a.CARTA.MomentMask[e.mask]:e.mask),null!=e.pixelRange&&e.hasOwnProperty("pixelRange")&&(i.pixelRange=a.CARTA.FloatBounds.toObject(e.pixelRange,t)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MomentResponse=function(){function e(e){if(this.openFileAcks=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.openFileAcks=s.emptyArray,e.prototype.cancel=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.openFileAcks&&e.openFileAcks.length)for(let i=0;i<e.openFileAcks.length;++i)a.CARTA.OpenFileAck.encode(e.openFileAcks[i],t.uint32(26).fork()).ldelim();return null!=e.cancel&&Object.hasOwnProperty.call(e,"cancel")&&t.uint32(32).bool(e.cancel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.MomentResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.openFileAcks&&n.openFileAcks.length||(n.openFileAcks=[]),n.openFileAcks.push(a.CARTA.OpenFileAck.decode(e,e.uint32()));break;case 4:n.cancel=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.openFileAcks&&e.hasOwnProperty("openFileAcks")){if(!Array.isArray(e.openFileAcks))return"openFileAcks: array expected";for(let t=0;t<e.openFileAcks.length;++t){let i=a.CARTA.OpenFileAck.verify(e.openFileAcks[t]);if(i)return"openFileAcks."+i}}return null!=e.cancel&&e.hasOwnProperty("cancel")&&"boolean"!==typeof e.cancel?"cancel: boolean expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.MomentResponse)return e;let t=new a.CARTA.MomentResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),e.openFileAcks){if(!Array.isArray(e.openFileAcks))throw TypeError(".CARTA.MomentResponse.openFileAcks: array expected");t.openFileAcks=[];for(let i=0;i<e.openFileAcks.length;++i){if("object"!==typeof e.openFileAcks[i])throw TypeError(".CARTA.MomentResponse.openFileAcks: object expected");t.openFileAcks[i]=a.CARTA.OpenFileAck.fromObject(e.openFileAcks[i])}}return null!=e.cancel&&(t.cancel=Boolean(e.cancel)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.openFileAcks=[]),t.defaults&&(i.success=!1,i.message="",i.cancel=!1),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),e.openFileAcks&&e.openFileAcks.length){i.openFileAcks=[];for(let n=0;n<e.openFileAcks.length;++n)i.openFileAcks[n]=a.CARTA.OpenFileAck.toObject(e.openFileAcks[n],t)}return null!=e.cancel&&e.hasOwnProperty("cancel")&&(i.cancel=e.cancel),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.MomentProgress=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(21).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.MomentProgress;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.MomentProgress)return e;let t=new a.CARTA.MomentProgress;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionFileInfoRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.prototype.file="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),null!=e.file&&Object.hasOwnProperty.call(e,"file")&&t.uint32(18).string(e.file),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionFileInfoRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;case 2:n.file=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null!=e.file&&e.hasOwnProperty("file")&&!s.isString(e.file)?"file: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionFileInfoRequest)return e;let t=new a.CARTA.RegionFileInfoRequest;return null!=e.directory&&(t.directory=String(e.directory)),null!=e.file&&(t.file=String(e.file)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory="",i.file=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.file&&e.hasOwnProperty("file")&&(i.file=e.file),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionFileInfoResponse=function(){function e(e){if(this.contents=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.fileInfo=null,e.prototype.contents=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.fileInfo&&Object.hasOwnProperty.call(e,"fileInfo")&&a.CARTA.FileInfo.encode(e.fileInfo,t.uint32(26).fork()).ldelim(),null!=e.contents&&e.contents.length)for(let i=0;i<e.contents.length;++i)t.uint32(34).string(e.contents[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionFileInfoResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.fileInfo=a.CARTA.FileInfo.decode(e,e.uint32());break;case 4:n.contents&&n.contents.length||(n.contents=[]),n.contents.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.fileInfo&&e.hasOwnProperty("fileInfo")){let t=a.CARTA.FileInfo.verify(e.fileInfo);if(t)return"fileInfo."+t}if(null!=e.contents&&e.hasOwnProperty("contents")){if(!Array.isArray(e.contents))return"contents: array expected";for(let t=0;t<e.contents.length;++t)if(!s.isString(e.contents[t]))return"contents: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionFileInfoResponse)return e;let t=new a.CARTA.RegionFileInfoResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.fileInfo){if("object"!==typeof e.fileInfo)throw TypeError(".CARTA.RegionFileInfoResponse.fileInfo: object expected");t.fileInfo=a.CARTA.FileInfo.fromObject(e.fileInfo)}if(e.contents){if(!Array.isArray(e.contents))throw TypeError(".CARTA.RegionFileInfoResponse.contents: array expected");t.contents=[];for(let i=0;i<e.contents.length;++i)t.contents[i]=String(e.contents[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contents=[]),t.defaults&&(i.success=!1,i.message="",i.fileInfo=null),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.fileInfo&&e.hasOwnProperty("fileInfo")&&(i.fileInfo=a.CARTA.FileInfo.toObject(e.fileInfo,t)),e.contents&&e.contents.length){i.contents=[];for(let t=0;t<e.contents.length;++t)i.contents[t]=e.contents[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionListRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.directory="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(10).string(e.directory),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionListRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.directory=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory)?"directory: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionListRequest)return e;let t=new a.CARTA.RegionListRequest;return null!=e.directory&&(t.directory=String(e.directory)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.directory=""),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionListResponse=function(){function e(e){if(this.files=[],this.subdirectories=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.success=!1,e.prototype.message="",e.prototype.directory="",e.prototype.parent="",e.prototype.files=s.emptyArray,e.prototype.subdirectories=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(8).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),null!=e.directory&&Object.hasOwnProperty.call(e,"directory")&&t.uint32(26).string(e.directory),null!=e.parent&&Object.hasOwnProperty.call(e,"parent")&&t.uint32(34).string(e.parent),null!=e.files&&e.files.length)for(let i=0;i<e.files.length;++i)a.CARTA.FileInfo.encode(e.files[i],t.uint32(42).fork()).ldelim();if(null!=e.subdirectories&&e.subdirectories.length)for(let i=0;i<e.subdirectories.length;++i)t.uint32(50).string(e.subdirectories[i]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionListResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.success=e.bool();break;case 2:n.message=e.string();break;case 3:n.directory=e.string();break;case 4:n.parent=e.string();break;case 5:n.files&&n.files.length||(n.files=[]),n.files.push(a.CARTA.FileInfo.decode(e,e.uint32()));break;case 6:n.subdirectories&&n.subdirectories.length||(n.subdirectories=[]),n.subdirectories.push(e.string());break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success)return"success: boolean expected";if(null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message))return"message: string expected";if(null!=e.directory&&e.hasOwnProperty("directory")&&!s.isString(e.directory))return"directory: string expected";if(null!=e.parent&&e.hasOwnProperty("parent")&&!s.isString(e.parent))return"parent: string expected";if(null!=e.files&&e.hasOwnProperty("files")){if(!Array.isArray(e.files))return"files: array expected";for(let t=0;t<e.files.length;++t){let i=a.CARTA.FileInfo.verify(e.files[t]);if(i)return"files."+i}}if(null!=e.subdirectories&&e.hasOwnProperty("subdirectories")){if(!Array.isArray(e.subdirectories))return"subdirectories: array expected";for(let t=0;t<e.subdirectories.length;++t)if(!s.isString(e.subdirectories[t]))return"subdirectories: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionListResponse)return e;let t=new a.CARTA.RegionListResponse;if(null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.directory&&(t.directory=String(e.directory)),null!=e.parent&&(t.parent=String(e.parent)),e.files){if(!Array.isArray(e.files))throw TypeError(".CARTA.RegionListResponse.files: array expected");t.files=[];for(let i=0;i<e.files.length;++i){if("object"!==typeof e.files[i])throw TypeError(".CARTA.RegionListResponse.files: object expected");t.files[i]=a.CARTA.FileInfo.fromObject(e.files[i])}}if(e.subdirectories){if(!Array.isArray(e.subdirectories))throw TypeError(".CARTA.RegionListResponse.subdirectories: array expected");t.subdirectories=[];for(let i=0;i<e.subdirectories.length;++i)t.subdirectories[i]=String(e.subdirectories[i])}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.files=[],i.subdirectories=[]),t.defaults&&(i.success=!1,i.message="",i.directory="",i.parent=""),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.directory&&e.hasOwnProperty("directory")&&(i.directory=e.directory),null!=e.parent&&e.hasOwnProperty("parent")&&(i.parent=e.parent),e.files&&e.files.length){i.files=[];for(let n=0;n<e.files.length;++n)i.files[n]=a.CARTA.FileInfo.toObject(e.files[n],t)}if(e.subdirectories&&e.subdirectories.length){i.subdirectories=[];for(let t=0;t<e.subdirectories.length;++t)i.subdirectories[t]=e.subdirectories[t]}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SaveFile=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.outputFileDirectory="",e.prototype.outputFileName="",e.prototype.outputFileType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.outputFileDirectory&&Object.hasOwnProperty.call(e,"outputFileDirectory")&&t.uint32(18).string(e.outputFileDirectory),null!=e.outputFileName&&Object.hasOwnProperty.call(e,"outputFileName")&&t.uint32(26).string(e.outputFileName),null!=e.outputFileType&&Object.hasOwnProperty.call(e,"outputFileType")&&t.uint32(32).int32(e.outputFileType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SaveFile;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.outputFileDirectory=e.string();break;case 3:n.outputFileName=e.string();break;case 4:n.outputFileType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.outputFileDirectory&&e.hasOwnProperty("outputFileDirectory")&&!s.isString(e.outputFileDirectory))return"outputFileDirectory: string expected";if(null!=e.outputFileName&&e.hasOwnProperty("outputFileName")&&!s.isString(e.outputFileName))return"outputFileName: string expected";if(null!=e.outputFileType&&e.hasOwnProperty("outputFileType"))switch(e.outputFileType){default:return"outputFileType: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SaveFile)return e;let t=new a.CARTA.SaveFile;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.outputFileDirectory&&(t.outputFileDirectory=String(e.outputFileDirectory)),null!=e.outputFileName&&(t.outputFileName=String(e.outputFileName)),e.outputFileType){case"CASA":case 0:t.outputFileType=0;break;case"CRTF":case 1:t.outputFileType=1;break;case"DS9_REG":case 2:t.outputFileType=2;break;case"FITS":case 3:t.outputFileType=3;break;case"HDF5":case 4:t.outputFileType=4;break;case"MIRIAD":case 5:t.outputFileType=5;break;case"UNKNOWN":case 6:t.outputFileType=6}return t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.outputFileDirectory="",i.outputFileName="",i.outputFileType=t.enums===String?"CASA":0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.outputFileDirectory&&e.hasOwnProperty("outputFileDirectory")&&(i.outputFileDirectory=e.outputFileDirectory),null!=e.outputFileName&&e.hasOwnProperty("outputFileName")&&(i.outputFileName=e.outputFileName),null!=e.outputFileType&&e.hasOwnProperty("outputFileType")&&(i.outputFileType=t.enums===String?a.CARTA.FileType[e.outputFileType]:e.outputFileType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SaveFileAck=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.success=!1,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SaveFileAck;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.success=e.bool();break;case 3:n.message=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.SaveFileAck)return e;let t=new a.CARTA.SaveFileAck;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.success=!1,i.message=""),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ScriptingRequest=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.scriptingRequestId=0,e.prototype.target="",e.prototype.action="",e.prototype.parameters="",e.prototype.async=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.scriptingRequestId&&Object.hasOwnProperty.call(e,"scriptingRequestId")&&t.uint32(13).sfixed32(e.scriptingRequestId),null!=e.target&&Object.hasOwnProperty.call(e,"target")&&t.uint32(18).string(e.target),null!=e.action&&Object.hasOwnProperty.call(e,"action")&&t.uint32(26).string(e.action),null!=e.parameters&&Object.hasOwnProperty.call(e,"parameters")&&t.uint32(34).string(e.parameters),null!=e.async&&Object.hasOwnProperty.call(e,"async")&&t.uint32(40).bool(e.async),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ScriptingRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.scriptingRequestId=e.sfixed32();break;case 2:n.target=e.string();break;case 3:n.action=e.string();break;case 4:n.parameters=e.string();break;case 5:n.async=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&!s.isInteger(e.scriptingRequestId)?"scriptingRequestId: integer expected":null!=e.target&&e.hasOwnProperty("target")&&!s.isString(e.target)?"target: string expected":null!=e.action&&e.hasOwnProperty("action")&&!s.isString(e.action)?"action: string expected":null!=e.parameters&&e.hasOwnProperty("parameters")&&!s.isString(e.parameters)?"parameters: string expected":null!=e.async&&e.hasOwnProperty("async")&&"boolean"!==typeof e.async?"async: boolean expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ScriptingRequest)return e;let t=new a.CARTA.ScriptingRequest;return null!=e.scriptingRequestId&&(t.scriptingRequestId=0|e.scriptingRequestId),null!=e.target&&(t.target=String(e.target)),null!=e.action&&(t.action=String(e.action)),null!=e.parameters&&(t.parameters=String(e.parameters)),null!=e.async&&(t.async=Boolean(e.async)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.scriptingRequestId=0,i.target="",i.action="",i.parameters="",i.async=!1),null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&(i.scriptingRequestId=e.scriptingRequestId),null!=e.target&&e.hasOwnProperty("target")&&(i.target=e.target),null!=e.action&&e.hasOwnProperty("action")&&(i.action=e.action),null!=e.parameters&&e.hasOwnProperty("parameters")&&(i.parameters=e.parameters),null!=e.async&&e.hasOwnProperty("async")&&(i.async=e.async),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ScriptingResponse=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.scriptingRequestId=0,e.prototype.success=!1,e.prototype.message="",e.prototype.response="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.scriptingRequestId&&Object.hasOwnProperty.call(e,"scriptingRequestId")&&t.uint32(13).sfixed32(e.scriptingRequestId),null!=e.success&&Object.hasOwnProperty.call(e,"success")&&t.uint32(16).bool(e.success),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.response&&Object.hasOwnProperty.call(e,"response")&&t.uint32(34).string(e.response),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ScriptingResponse;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.scriptingRequestId=e.sfixed32();break;case 2:n.success=e.bool();break;case 3:n.message=e.string();break;case 4:n.response=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&!s.isInteger(e.scriptingRequestId)?"scriptingRequestId: integer expected":null!=e.success&&e.hasOwnProperty("success")&&"boolean"!==typeof e.success?"success: boolean expected":null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null!=e.response&&e.hasOwnProperty("response")&&!s.isString(e.response)?"response: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ScriptingResponse)return e;let t=new a.CARTA.ScriptingResponse;return null!=e.scriptingRequestId&&(t.scriptingRequestId=0|e.scriptingRequestId),null!=e.success&&(t.success=Boolean(e.success)),null!=e.message&&(t.message=String(e.message)),null!=e.response&&(t.response=String(e.response)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.scriptingRequestId=0,i.success=!1,i.message="",i.response=""),null!=e.scriptingRequestId&&e.hasOwnProperty("scriptingRequestId")&&(i.scriptingRequestId=e.scriptingRequestId),null!=e.success&&e.hasOwnProperty("success")&&(i.success=e.success),null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.response&&e.hasOwnProperty("response")&&(i.response=e.response),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFilterRequest=function(){function e(e){if(this.columnIndices=[],this.filterConfigs=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.columnIndices=s.emptyArray,e.prototype.filterConfigs=s.emptyArray,e.prototype.subsetDataSize=0,e.prototype.subsetStartIndex=0,e.prototype.imageBounds=null,e.prototype.imageFileId=0,e.prototype.regionId=0,e.prototype.sortColumn="",e.prototype.sortingType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.columnIndices&&e.columnIndices.length){t.uint32(18).fork();for(let i=0;i<e.columnIndices.length;++i)t.int32(e.columnIndices[i]);t.ldelim()}if(null!=e.filterConfigs&&e.filterConfigs.length)for(let i=0;i<e.filterConfigs.length;++i)a.CARTA.FilterConfig.encode(e.filterConfigs[i],t.uint32(26).fork()).ldelim();return null!=e.subsetDataSize&&Object.hasOwnProperty.call(e,"subsetDataSize")&&t.uint32(37).sfixed32(e.subsetDataSize),null!=e.subsetStartIndex&&Object.hasOwnProperty.call(e,"subsetStartIndex")&&t.uint32(45).sfixed32(e.subsetStartIndex),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&a.CARTA.CatalogImageBounds.encode(e.imageBounds,t.uint32(50).fork()).ldelim(),null!=e.imageFileId&&Object.hasOwnProperty.call(e,"imageFileId")&&t.uint32(61).sfixed32(e.imageFileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(69).sfixed32(e.regionId),null!=e.sortColumn&&Object.hasOwnProperty.call(e,"sortColumn")&&t.uint32(74).string(e.sortColumn),null!=e.sortingType&&Object.hasOwnProperty.call(e,"sortingType")&&t.uint32(80).int32(e.sortingType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.CatalogFilterRequest;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:if(n.columnIndices&&n.columnIndices.length||(n.columnIndices=[]),2===(7&t)){let t=e.uint32()+e.pos;for(;e.pos<t;)n.columnIndices.push(e.int32())}else n.columnIndices.push(e.int32());break;case 3:n.filterConfigs&&n.filterConfigs.length||(n.filterConfigs=[]),n.filterConfigs.push(a.CARTA.FilterConfig.decode(e,e.uint32()));break;case 4:n.subsetDataSize=e.sfixed32();break;case 5:n.subsetStartIndex=e.sfixed32();break;case 6:n.imageBounds=a.CARTA.CatalogImageBounds.decode(e,e.uint32());break;case 7:n.imageFileId=e.sfixed32();break;case 8:n.regionId=e.sfixed32();break;case 9:n.sortColumn=e.string();break;case 10:n.sortingType=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.columnIndices&&e.hasOwnProperty("columnIndices")){if(!Array.isArray(e.columnIndices))return"columnIndices: array expected";for(let t=0;t<e.columnIndices.length;++t)if(!s.isInteger(e.columnIndices[t]))return"columnIndices: integer[] expected"}if(null!=e.filterConfigs&&e.hasOwnProperty("filterConfigs")){if(!Array.isArray(e.filterConfigs))return"filterConfigs: array expected";for(let t=0;t<e.filterConfigs.length;++t){let i=a.CARTA.FilterConfig.verify(e.filterConfigs[t]);if(i)return"filterConfigs."+i}}if(null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&!s.isInteger(e.subsetDataSize))return"subsetDataSize: integer expected";if(null!=e.subsetStartIndex&&e.hasOwnProperty("subsetStartIndex")&&!s.isInteger(e.subsetStartIndex))return"subsetStartIndex: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=a.CARTA.CatalogImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&!s.isInteger(e.imageFileId))return"imageFileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.sortColumn&&e.hasOwnProperty("sortColumn")&&!s.isString(e.sortColumn))return"sortColumn: string expected";if(null!=e.sortingType&&e.hasOwnProperty("sortingType"))switch(e.sortingType){default:return"sortingType: enum value expected";case 0:case 1:}return null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogFilterRequest)return e;let t=new a.CARTA.CatalogFilterRequest;if(null!=e.fileId&&(t.fileId=0|e.fileId),e.columnIndices){if(!Array.isArray(e.columnIndices))throw TypeError(".CARTA.CatalogFilterRequest.columnIndices: array expected");t.columnIndices=[];for(let i=0;i<e.columnIndices.length;++i)t.columnIndices[i]=0|e.columnIndices[i]}if(e.filterConfigs){if(!Array.isArray(e.filterConfigs))throw TypeError(".CARTA.CatalogFilterRequest.filterConfigs: array expected");t.filterConfigs=[];for(let i=0;i<e.filterConfigs.length;++i){if("object"!==typeof e.filterConfigs[i])throw TypeError(".CARTA.CatalogFilterRequest.filterConfigs: object expected");t.filterConfigs[i]=a.CARTA.FilterConfig.fromObject(e.filterConfigs[i])}}if(null!=e.subsetDataSize&&(t.subsetDataSize=0|e.subsetDataSize),null!=e.subsetStartIndex&&(t.subsetStartIndex=0|e.subsetStartIndex),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.CatalogFilterRequest.imageBounds: object expected");t.imageBounds=a.CARTA.CatalogImageBounds.fromObject(e.imageBounds)}switch(null!=e.imageFileId&&(t.imageFileId=0|e.imageFileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.sortColumn&&(t.sortColumn=String(e.sortColumn)),e.sortingType){case"Ascending":case 0:t.sortingType=0;break;case"Descending":case 1:t.sortingType=1}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.columnIndices=[],i.filterConfigs=[]),t.defaults&&(i.fileId=0,i.subsetDataSize=0,i.subsetStartIndex=0,i.imageBounds=null,i.imageFileId=0,i.regionId=0,i.sortColumn="",i.sortingType=t.enums===String?"Ascending":0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),e.columnIndices&&e.columnIndices.length){i.columnIndices=[];for(let t=0;t<e.columnIndices.length;++t)i.columnIndices[t]=e.columnIndices[t]}if(e.filterConfigs&&e.filterConfigs.length){i.filterConfigs=[];for(let n=0;n<e.filterConfigs.length;++n)i.filterConfigs[n]=a.CARTA.FilterConfig.toObject(e.filterConfigs[n],t)}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&(i.subsetDataSize=e.subsetDataSize),null!=e.subsetStartIndex&&e.hasOwnProperty("subsetStartIndex")&&(i.subsetStartIndex=e.subsetStartIndex),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=a.CARTA.CatalogImageBounds.toObject(e.imageBounds,t)),null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&(i.imageFileId=e.imageFileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.sortColumn&&e.hasOwnProperty("sortColumn")&&(i.sortColumn=e.sortColumn),null!=e.sortingType&&e.hasOwnProperty("sortingType")&&(i.sortingType=t.enums===String?a.CARTA.SortingType[e.sortingType]:e.sortingType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.CatalogFilterResponse=function(){function e(e){if(this.columns={},e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.imageFileId=0,e.prototype.regionId=0,e.prototype.columns=s.emptyObject,e.prototype.subsetDataSize=0,e.prototype.subsetEndIndex=0,e.prototype.progress=0,e.prototype.filterDataSize=0,e.prototype.requestEndIndex=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.imageFileId&&Object.hasOwnProperty.call(e,"imageFileId")&&t.uint32(21).sfixed32(e.imageFileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(29).sfixed32(e.regionId),null!=e.columns&&Object.hasOwnProperty.call(e,"columns"))for(let i=Object.keys(e.columns),n=0;n<i.length;++n)t.uint32(34).fork().uint32(13).fixed32(i[n]),a.CARTA.ColumnData.encode(e.columns[i[n]],t.uint32(18).fork()).ldelim().ldelim();return null!=e.subsetDataSize&&Object.hasOwnProperty.call(e,"subsetDataSize")&&t.uint32(45).sfixed32(e.subsetDataSize),null!=e.subsetEndIndex&&Object.hasOwnProperty.call(e,"subsetEndIndex")&&t.uint32(53).sfixed32(e.subsetEndIndex),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(61).float(e.progress),null!=e.filterDataSize&&Object.hasOwnProperty.call(e,"filterDataSize")&&t.uint32(69).sfixed32(e.filterDataSize),null!=e.requestEndIndex&&Object.hasOwnProperty.call(e,"requestEndIndex")&&t.uint32(77).sfixed32(e.requestEndIndex),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i,n=void 0===t?e.len:e.pos+t,o=new a.CARTA.CatalogFilterResponse;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:o.fileId=e.sfixed32();break;case 2:o.imageFileId=e.sfixed32();break;case 3:o.regionId=e.sfixed32();break;case 4:e.skip().pos++,o.columns===s.emptyObject&&(o.columns={}),i=e.fixed32(),e.pos++,o.columns[i]=a.CARTA.ColumnData.decode(e,e.uint32());break;case 5:o.subsetDataSize=e.sfixed32();break;case 6:o.subsetEndIndex=e.sfixed32();break;case 7:o.progress=e.float();break;case 8:o.filterDataSize=e.sfixed32();break;case 9:o.requestEndIndex=e.sfixed32();break;default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&!s.isInteger(e.imageFileId))return"imageFileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.columns&&e.hasOwnProperty("columns")){if(!s.isObject(e.columns))return"columns: object expected";let t=Object.keys(e.columns);for(let i=0;i<t.length;++i){if(!s.key32Re.test(t[i]))return"columns: integer key{k:fixed32} expected";{let n=a.CARTA.ColumnData.verify(e.columns[t[i]]);if(n)return"columns."+n}}}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&!s.isInteger(e.subsetDataSize)?"subsetDataSize: integer expected":null!=e.subsetEndIndex&&e.hasOwnProperty("subsetEndIndex")&&!s.isInteger(e.subsetEndIndex)?"subsetEndIndex: integer expected":null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null!=e.filterDataSize&&e.hasOwnProperty("filterDataSize")&&!s.isInteger(e.filterDataSize)?"filterDataSize: integer expected":null!=e.requestEndIndex&&e.hasOwnProperty("requestEndIndex")&&!s.isInteger(e.requestEndIndex)?"requestEndIndex: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.CatalogFilterResponse)return e;let t=new a.CARTA.CatalogFilterResponse;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.imageFileId&&(t.imageFileId=0|e.imageFileId),null!=e.regionId&&(t.regionId=0|e.regionId),e.columns){if("object"!==typeof e.columns)throw TypeError(".CARTA.CatalogFilterResponse.columns: object expected");t.columns={};for(let i=Object.keys(e.columns),n=0;n<i.length;++n){if("object"!==typeof e.columns[i[n]])throw TypeError(".CARTA.CatalogFilterResponse.columns: object expected");t.columns[i[n]]=a.CARTA.ColumnData.fromObject(e.columns[i[n]])}}return null!=e.subsetDataSize&&(t.subsetDataSize=0|e.subsetDataSize),null!=e.subsetEndIndex&&(t.subsetEndIndex=0|e.subsetEndIndex),null!=e.progress&&(t.progress=Number(e.progress)),null!=e.filterDataSize&&(t.filterDataSize=0|e.filterDataSize),null!=e.requestEndIndex&&(t.requestEndIndex=0|e.requestEndIndex),t},e.toObject=function(e,t){t||(t={});let i,n={};if((t.objects||t.defaults)&&(n.columns={}),t.defaults&&(n.fileId=0,n.imageFileId=0,n.regionId=0,n.subsetDataSize=0,n.subsetEndIndex=0,n.progress=0,n.filterDataSize=0,n.requestEndIndex=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(n.fileId=e.fileId),null!=e.imageFileId&&e.hasOwnProperty("imageFileId")&&(n.imageFileId=e.imageFileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(n.regionId=e.regionId),e.columns&&(i=Object.keys(e.columns)).length){n.columns={};for(let r=0;r<i.length;++r)n.columns[i[r]]=a.CARTA.ColumnData.toObject(e.columns[i[r]],t)}return null!=e.subsetDataSize&&e.hasOwnProperty("subsetDataSize")&&(n.subsetDataSize=e.subsetDataSize),null!=e.subsetEndIndex&&e.hasOwnProperty("subsetEndIndex")&&(n.subsetEndIndex=e.subsetEndIndex),null!=e.progress&&e.hasOwnProperty("progress")&&(n.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),null!=e.filterDataSize&&e.hasOwnProperty("filterDataSize")&&(n.filterDataSize=e.filterDataSize),null!=e.requestEndIndex&&e.hasOwnProperty("requestEndIndex")&&(n.requestEndIndex=e.requestEndIndex),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ContourImageData=function(){function e(e){if(this.contourSets=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.referenceFileId=0,e.prototype.imageBounds=null,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.contourSets=s.emptyArray,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.referenceFileId&&Object.hasOwnProperty.call(e,"referenceFileId")&&t.uint32(21).fixed32(e.referenceFileId),null!=e.imageBounds&&Object.hasOwnProperty.call(e,"imageBounds")&&a.CARTA.ImageBounds.encode(e.imageBounds,t.uint32(26).fork()).ldelim(),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(37).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(45).sfixed32(e.stokes),null!=e.contourSets&&e.contourSets.length)for(let i=0;i<e.contourSets.length;++i)a.CARTA.ContourSet.encode(e.contourSets[i],t.uint32(50).fork()).ldelim();return null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(57).double(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ContourImageData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.referenceFileId=e.fixed32();break;case 3:n.imageBounds=a.CARTA.ImageBounds.decode(e,e.uint32());break;case 4:n.channel=e.sfixed32();break;case 5:n.stokes=e.sfixed32();break;case 6:n.contourSets&&n.contourSets.length||(n.contourSets=[]),n.contourSets.push(a.CARTA.ContourSet.decode(e,e.uint32()));break;case 7:n.progress=e.double();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&!s.isInteger(e.referenceFileId))return"referenceFileId: integer expected";if(null!=e.imageBounds&&e.hasOwnProperty("imageBounds")){let t=a.CARTA.ImageBounds.verify(e.imageBounds);if(t)return"imageBounds."+t}if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.contourSets&&e.hasOwnProperty("contourSets")){if(!Array.isArray(e.contourSets))return"contourSets: array expected";for(let t=0;t<e.contourSets.length;++t){let i=a.CARTA.ContourSet.verify(e.contourSets[t]);if(i)return"contourSets."+i}}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ContourImageData)return e;let t=new a.CARTA.ContourImageData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.referenceFileId&&(t.referenceFileId=e.referenceFileId>>>0),null!=e.imageBounds){if("object"!==typeof e.imageBounds)throw TypeError(".CARTA.ContourImageData.imageBounds: object expected");t.imageBounds=a.CARTA.ImageBounds.fromObject(e.imageBounds)}if(null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.contourSets){if(!Array.isArray(e.contourSets))throw TypeError(".CARTA.ContourImageData.contourSets: array expected");t.contourSets=[];for(let i=0;i<e.contourSets.length;++i){if("object"!==typeof e.contourSets[i])throw TypeError(".CARTA.ContourImageData.contourSets: object expected");t.contourSets[i]=a.CARTA.ContourSet.fromObject(e.contourSets[i])}}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.contourSets=[]),t.defaults&&(i.fileId=0,i.referenceFileId=0,i.imageBounds=null,i.channel=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.referenceFileId&&e.hasOwnProperty("referenceFileId")&&(i.referenceFileId=e.referenceFileId),null!=e.imageBounds&&e.hasOwnProperty("imageBounds")&&(i.imageBounds=a.CARTA.ImageBounds.toObject(e.imageBounds,t)),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.contourSets&&e.contourSets.length){i.contourSets=[];for(let n=0;n<e.contourSets.length;++n)i.contourSets[n]=a.CARTA.ContourSet.toObject(e.contourSets[n],t)}return null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ContourSet=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.level=0,e.prototype.decimationFactor=0,e.prototype.rawCoordinates=s.newBuffer([]),e.prototype.rawStartIndices=s.newBuffer([]),e.prototype.uncompressedCoordinatesSize=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.level&&Object.hasOwnProperty.call(e,"level")&&t.uint32(9).double(e.level),null!=e.decimationFactor&&Object.hasOwnProperty.call(e,"decimationFactor")&&t.uint32(16).int32(e.decimationFactor),null!=e.rawCoordinates&&Object.hasOwnProperty.call(e,"rawCoordinates")&&t.uint32(26).bytes(e.rawCoordinates),null!=e.rawStartIndices&&Object.hasOwnProperty.call(e,"rawStartIndices")&&t.uint32(34).bytes(e.rawStartIndices),null!=e.uncompressedCoordinatesSize&&Object.hasOwnProperty.call(e,"uncompressedCoordinatesSize")&&t.uint32(40).int32(e.uncompressedCoordinatesSize),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ContourSet;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.level=e.double();break;case 2:n.decimationFactor=e.int32();break;case 3:n.rawCoordinates=e.bytes();break;case 4:n.rawStartIndices=e.bytes();break;case 5:n.uncompressedCoordinatesSize=e.int32();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.level&&e.hasOwnProperty("level")&&"number"!==typeof e.level?"level: number expected":null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&!s.isInteger(e.decimationFactor)?"decimationFactor: integer expected":null!=e.rawCoordinates&&e.hasOwnProperty("rawCoordinates")&&!(e.rawCoordinates&&"number"===typeof e.rawCoordinates.length||s.isString(e.rawCoordinates))?"rawCoordinates: buffer expected":null!=e.rawStartIndices&&e.hasOwnProperty("rawStartIndices")&&!(e.rawStartIndices&&"number"===typeof e.rawStartIndices.length||s.isString(e.rawStartIndices))?"rawStartIndices: buffer expected":null!=e.uncompressedCoordinatesSize&&e.hasOwnProperty("uncompressedCoordinatesSize")&&!s.isInteger(e.uncompressedCoordinatesSize)?"uncompressedCoordinatesSize: integer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ContourSet)return e;let t=new a.CARTA.ContourSet;return null!=e.level&&(t.level=Number(e.level)),null!=e.decimationFactor&&(t.decimationFactor=0|e.decimationFactor),null!=e.rawCoordinates&&("string"===typeof e.rawCoordinates?s.base64.decode(e.rawCoordinates,t.rawCoordinates=s.newBuffer(s.base64.length(e.rawCoordinates)),0):e.rawCoordinates.length&&(t.rawCoordinates=e.rawCoordinates)),null!=e.rawStartIndices&&("string"===typeof e.rawStartIndices?s.base64.decode(e.rawStartIndices,t.rawStartIndices=s.newBuffer(s.base64.length(e.rawStartIndices)),0):e.rawStartIndices.length&&(t.rawStartIndices=e.rawStartIndices)),null!=e.uncompressedCoordinatesSize&&(t.uncompressedCoordinatesSize=0|e.uncompressedCoordinatesSize),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.level=0,i.decimationFactor=0,t.bytes===String?i.rawCoordinates="":(i.rawCoordinates=[],t.bytes!==Array&&(i.rawCoordinates=s.newBuffer(i.rawCoordinates))),t.bytes===String?i.rawStartIndices="":(i.rawStartIndices=[],t.bytes!==Array&&(i.rawStartIndices=s.newBuffer(i.rawStartIndices))),i.uncompressedCoordinatesSize=0),null!=e.level&&e.hasOwnProperty("level")&&(i.level=t.json&&!isFinite(e.level)?String(e.level):e.level),null!=e.decimationFactor&&e.hasOwnProperty("decimationFactor")&&(i.decimationFactor=e.decimationFactor),null!=e.rawCoordinates&&e.hasOwnProperty("rawCoordinates")&&(i.rawCoordinates=t.bytes===String?s.base64.encode(e.rawCoordinates,0,e.rawCoordinates.length):t.bytes===Array?Array.prototype.slice.call(e.rawCoordinates):e.rawCoordinates),null!=e.rawStartIndices&&e.hasOwnProperty("rawStartIndices")&&(i.rawStartIndices=t.bytes===String?s.base64.encode(e.rawStartIndices,0,e.rawStartIndices.length):t.bytes===Array?Array.prototype.slice.call(e.rawStartIndices):e.rawStartIndices),null!=e.uncompressedCoordinatesSize&&e.hasOwnProperty("uncompressedCoordinatesSize")&&(i.uncompressedCoordinatesSize=e.uncompressedCoordinatesSize),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.ErrorData=function(){function e(e){if(this.tags=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.severity=0,e.prototype.tags=s.emptyArray,e.prototype.message="",e.prototype.data="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.severity&&Object.hasOwnProperty.call(e,"severity")&&t.uint32(8).int32(e.severity),null!=e.tags&&e.tags.length)for(let i=0;i<e.tags.length;++i)t.uint32(18).string(e.tags[i]);return null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).string(e.message),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).string(e.data),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.ErrorData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.severity=e.int32();break;case 2:n.tags&&n.tags.length||(n.tags=[]),n.tags.push(e.string());break;case 3:n.message=e.string();break;case 4:n.data=e.string();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.severity&&e.hasOwnProperty("severity"))switch(e.severity){default:return"severity: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.tags&&e.hasOwnProperty("tags")){if(!Array.isArray(e.tags))return"tags: array expected";for(let t=0;t<e.tags.length;++t)if(!s.isString(e.tags[t]))return"tags: string[] expected"}return null!=e.message&&e.hasOwnProperty("message")&&!s.isString(e.message)?"message: string expected":null!=e.data&&e.hasOwnProperty("data")&&!s.isString(e.data)?"data: string expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.ErrorData)return e;let t=new a.CARTA.ErrorData;switch(e.severity){case"DEBUG":case 0:t.severity=0;break;case"INFO":case 1:t.severity=1;break;case"WARNING":case 2:t.severity=2;break;case"ERROR":case 3:t.severity=3;break;case"CRITICAL":case 4:t.severity=4}if(e.tags){if(!Array.isArray(e.tags))throw TypeError(".CARTA.ErrorData.tags: array expected");t.tags=[];for(let i=0;i<e.tags.length;++i)t.tags[i]=String(e.tags[i])}return null!=e.message&&(t.message=String(e.message)),null!=e.data&&(t.data=String(e.data)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tags=[]),t.defaults&&(i.severity=t.enums===String?"DEBUG":0,i.message="",i.data=""),null!=e.severity&&e.hasOwnProperty("severity")&&(i.severity=t.enums===String?a.CARTA.ErrorSeverity[e.severity]:e.severity),e.tags&&e.tags.length){i.tags=[];for(let t=0;t<e.tags.length;++t)i.tags[t]=e.tags[t]}return null!=e.message&&e.hasOwnProperty("message")&&(i.message=e.message),null!=e.data&&e.hasOwnProperty("data")&&(i.data=e.data),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RasterTileSync=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.animationId=0,e.prototype.endSync=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(37).sfixed32(e.animationId),null!=e.endSync&&Object.hasOwnProperty.call(e,"endSync")&&t.uint32(40).bool(e.endSync),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RasterTileSync;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.animationId=e.sfixed32();break;case 5:n.endSync=e.bool();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId)?"fileId: integer expected":null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel)?"channel: integer expected":null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes)?"stokes: integer expected":null!=e.animationId&&e.hasOwnProperty("animationId")&&!s.isInteger(e.animationId)?"animationId: integer expected":null!=e.endSync&&e.hasOwnProperty("endSync")&&"boolean"!==typeof e.endSync?"endSync: boolean expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RasterTileSync)return e;let t=new a.CARTA.RasterTileSync;return null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.animationId&&(t.animationId=0|e.animationId),null!=e.endSync&&(t.endSync=Boolean(e.endSync)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.animationId=0,i.endSync=!1),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),null!=e.endSync&&e.hasOwnProperty("endSync")&&(i.endSync=e.endSync),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RasterTileData=function(){function e(e){if(this.tiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.compressionType=0,e.prototype.compressionQuality=0,e.prototype.animationId=0,e.prototype.tiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(21).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.compressionType&&Object.hasOwnProperty.call(e,"compressionType")&&t.uint32(32).int32(e.compressionType),null!=e.compressionQuality&&Object.hasOwnProperty.call(e,"compressionQuality")&&t.uint32(45).float(e.compressionQuality),null!=e.animationId&&Object.hasOwnProperty.call(e,"animationId")&&t.uint32(53).sfixed32(e.animationId),null!=e.tiles&&e.tiles.length)for(let i=0;i<e.tiles.length;++i)a.CARTA.TileData.encode(e.tiles[i],t.uint32(58).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RasterTileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.channel=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.compressionType=e.int32();break;case 5:n.compressionQuality=e.float();break;case 6:n.animationId=e.sfixed32();break;case 7:n.tiles&&n.tiles.length||(n.tiles=[]),n.tiles.push(a.CARTA.TileData.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.compressionType&&e.hasOwnProperty("compressionType"))switch(e.compressionType){default:return"compressionType: enum value expected";case 0:case 1:case 2:}if(null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&"number"!==typeof e.compressionQuality)return"compressionQuality: number expected";if(null!=e.animationId&&e.hasOwnProperty("animationId")&&!s.isInteger(e.animationId))return"animationId: integer expected";if(null!=e.tiles&&e.hasOwnProperty("tiles")){if(!Array.isArray(e.tiles))return"tiles: array expected";for(let t=0;t<e.tiles.length;++t){let i=a.CARTA.TileData.verify(e.tiles[t]);if(i)return"tiles."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.RasterTileData)return e;let t=new a.CARTA.RasterTileData;switch(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.compressionType){case"NONE":case 0:t.compressionType=0;break;case"ZFP":case 1:t.compressionType=1;break;case"SZ":case 2:t.compressionType=2}if(null!=e.compressionQuality&&(t.compressionQuality=Number(e.compressionQuality)),null!=e.animationId&&(t.animationId=0|e.animationId),e.tiles){if(!Array.isArray(e.tiles))throw TypeError(".CARTA.RasterTileData.tiles: array expected");t.tiles=[];for(let i=0;i<e.tiles.length;++i){if("object"!==typeof e.tiles[i])throw TypeError(".CARTA.RasterTileData.tiles: object expected");t.tiles[i]=a.CARTA.TileData.fromObject(e.tiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.tiles=[]),t.defaults&&(i.fileId=0,i.channel=0,i.stokes=0,i.compressionType=t.enums===String?"NONE":0,i.compressionQuality=0,i.animationId=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.compressionType&&e.hasOwnProperty("compressionType")&&(i.compressionType=t.enums===String?a.CARTA.CompressionType[e.compressionType]:e.compressionType),null!=e.compressionQuality&&e.hasOwnProperty("compressionQuality")&&(i.compressionQuality=t.json&&!isFinite(e.compressionQuality)?String(e.compressionQuality):e.compressionQuality),null!=e.animationId&&e.hasOwnProperty("animationId")&&(i.animationId=e.animationId),e.tiles&&e.tiles.length){i.tiles=[];for(let n=0;n<e.tiles.length;++n)i.tiles[n]=a.CARTA.TileData.toObject(e.tiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.TileData=function(){function e(e){if(e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.layer=0,e.prototype.x=0,e.prototype.y=0,e.prototype.width=0,e.prototype.height=0,e.prototype.imageData=s.newBuffer([]),e.prototype.nanEncodings=s.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.layer&&Object.hasOwnProperty.call(e,"layer")&&t.uint32(13).sfixed32(e.layer),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(21).sfixed32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(29).sfixed32(e.y),null!=e.width&&Object.hasOwnProperty.call(e,"width")&&t.uint32(37).sfixed32(e.width),null!=e.height&&Object.hasOwnProperty.call(e,"height")&&t.uint32(45).sfixed32(e.height),null!=e.imageData&&Object.hasOwnProperty.call(e,"imageData")&&t.uint32(50).bytes(e.imageData),null!=e.nanEncodings&&Object.hasOwnProperty.call(e,"nanEncodings")&&t.uint32(58).bytes(e.nanEncodings),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.TileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.layer=e.sfixed32();break;case 2:n.x=e.sfixed32();break;case 3:n.y=e.sfixed32();break;case 4:n.width=e.sfixed32();break;case 5:n.height=e.sfixed32();break;case 6:n.imageData=e.bytes();break;case 7:n.nanEncodings=e.bytes();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.layer&&e.hasOwnProperty("layer")&&!s.isInteger(e.layer)?"layer: integer expected":null!=e.x&&e.hasOwnProperty("x")&&!s.isInteger(e.x)?"x: integer expected":null!=e.y&&e.hasOwnProperty("y")&&!s.isInteger(e.y)?"y: integer expected":null!=e.width&&e.hasOwnProperty("width")&&!s.isInteger(e.width)?"width: integer expected":null!=e.height&&e.hasOwnProperty("height")&&!s.isInteger(e.height)?"height: integer expected":null!=e.imageData&&e.hasOwnProperty("imageData")&&!(e.imageData&&"number"===typeof e.imageData.length||s.isString(e.imageData))?"imageData: buffer expected":null!=e.nanEncodings&&e.hasOwnProperty("nanEncodings")&&!(e.nanEncodings&&"number"===typeof e.nanEncodings.length||s.isString(e.nanEncodings))?"nanEncodings: buffer expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.TileData)return e;let t=new a.CARTA.TileData;return null!=e.layer&&(t.layer=0|e.layer),null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.width&&(t.width=0|e.width),null!=e.height&&(t.height=0|e.height),null!=e.imageData&&("string"===typeof e.imageData?s.base64.decode(e.imageData,t.imageData=s.newBuffer(s.base64.length(e.imageData)),0):e.imageData.length&&(t.imageData=e.imageData)),null!=e.nanEncodings&&("string"===typeof e.nanEncodings?s.base64.decode(e.nanEncodings,t.nanEncodings=s.newBuffer(s.base64.length(e.nanEncodings)),0):e.nanEncodings.length&&(t.nanEncodings=e.nanEncodings)),t},e.toObject=function(e,t){t||(t={});let i={};return t.defaults&&(i.layer=0,i.x=0,i.y=0,i.width=0,i.height=0,t.bytes===String?i.imageData="":(i.imageData=[],t.bytes!==Array&&(i.imageData=s.newBuffer(i.imageData))),t.bytes===String?i.nanEncodings="":(i.nanEncodings=[],t.bytes!==Array&&(i.nanEncodings=s.newBuffer(i.nanEncodings)))),null!=e.layer&&e.hasOwnProperty("layer")&&(i.layer=e.layer),null!=e.x&&e.hasOwnProperty("x")&&(i.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=e.y),null!=e.width&&e.hasOwnProperty("width")&&(i.width=e.width),null!=e.height&&e.hasOwnProperty("height")&&(i.height=e.height),null!=e.imageData&&e.hasOwnProperty("imageData")&&(i.imageData=t.bytes===String?s.base64.encode(e.imageData,0,e.imageData.length):t.bytes===Array?Array.prototype.slice.call(e.imageData):e.imageData),null!=e.nanEncodings&&e.hasOwnProperty("nanEncodings")&&(i.nanEncodings=t.bytes===String?s.base64.encode(e.nanEncodings,0,e.nanEncodings.length):t.bytes===Array?Array.prototype.slice.call(e.nanEncodings):e.nanEncodings),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionHistogramData=function(){function e(e){if(this.histograms=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stokes=0,e.prototype.histograms=s.emptyArray,e.prototype.progress=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.histograms&&e.histograms.length)for(let i=0;i<e.histograms.length;++i)a.CARTA.Histogram.encode(e.histograms[i],t.uint32(34).fork()).ldelim();return null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(45).float(e.progress),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionHistogramData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.histograms&&n.histograms.length||(n.histograms=[]),n.histograms.push(a.CARTA.Histogram.decode(e,e.uint32()));break;case 5:n.progress=e.float();break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.histograms&&e.hasOwnProperty("histograms")){if(!Array.isArray(e.histograms))return"histograms: array expected";for(let t=0;t<e.histograms.length;++t){let i=a.CARTA.Histogram.verify(e.histograms[t]);if(i)return"histograms."+i}}return null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress?"progress: number expected":null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionHistogramData)return e;let t=new a.CARTA.RegionHistogramData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.stokes&&(t.stokes=0|e.stokes),e.histograms){if(!Array.isArray(e.histograms))throw TypeError(".CARTA.RegionHistogramData.histograms: array expected");t.histograms=[];for(let i=0;i<e.histograms.length;++i){if("object"!==typeof e.histograms[i])throw TypeError(".CARTA.RegionHistogramData.histograms: object expected");t.histograms[i]=a.CARTA.Histogram.fromObject(e.histograms[i])}}return null!=e.progress&&(t.progress=Number(e.progress)),t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.histograms=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.histograms&&e.histograms.length){i.histograms=[];for(let n=0;n<e.histograms.length;++n)i.histograms[n]=a.CARTA.Histogram.toObject(e.histograms[n],t)}return null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.RegionStatsData=function(){function e(e){if(this.statistics=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.statistics=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(29).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(37).sfixed32(e.stokes),null!=e.statistics&&e.statistics.length)for(let i=0;i<e.statistics.length;++i)a.CARTA.StatisticsValue.encode(e.statistics[i],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.RegionStatsData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.channel=e.sfixed32();break;case 4:n.stokes=e.sfixed32();break;case 5:n.statistics&&n.statistics.length||(n.statistics=[]),n.statistics.push(a.CARTA.StatisticsValue.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.statistics&&e.hasOwnProperty("statistics")){if(!Array.isArray(e.statistics))return"statistics: array expected";for(let t=0;t<e.statistics.length;++t){let i=a.CARTA.StatisticsValue.verify(e.statistics[t]);if(i)return"statistics."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.RegionStatsData)return e;let t=new a.CARTA.RegionStatsData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),e.statistics){if(!Array.isArray(e.statistics))throw TypeError(".CARTA.RegionStatsData.statistics: array expected");t.statistics=[];for(let i=0;i<e.statistics.length;++i){if("object"!==typeof e.statistics[i])throw TypeError(".CARTA.RegionStatsData.statistics: object expected");t.statistics[i]=a.CARTA.StatisticsValue.fromObject(e.statistics[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.statistics=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.channel=0,i.stokes=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),e.statistics&&e.statistics.length){i.statistics=[];for(let n=0;n<e.statistics.length;++n)i.statistics[n]=a.CARTA.StatisticsValue.toObject(e.statistics[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpatialProfileData=function(){function e(e){if(this.profiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.x=0,e.prototype.y=0,e.prototype.channel=0,e.prototype.stokes=0,e.prototype.value=0,e.prototype.profiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.x&&Object.hasOwnProperty.call(e,"x")&&t.uint32(29).sfixed32(e.x),null!=e.y&&Object.hasOwnProperty.call(e,"y")&&t.uint32(37).sfixed32(e.y),null!=e.channel&&Object.hasOwnProperty.call(e,"channel")&&t.uint32(45).sfixed32(e.channel),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(53).sfixed32(e.stokes),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(61).float(e.value),null!=e.profiles&&e.profiles.length)for(let i=0;i<e.profiles.length;++i)a.CARTA.SpatialProfile.encode(e.profiles[i],t.uint32(66).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SpatialProfileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.x=e.sfixed32();break;case 4:n.y=e.sfixed32();break;case 5:n.channel=e.sfixed32();break;case 6:n.stokes=e.sfixed32();break;case 7:n.value=e.float();break;case 8:n.profiles&&n.profiles.length||(n.profiles=[]),n.profiles.push(a.CARTA.SpatialProfile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.x&&e.hasOwnProperty("x")&&!s.isInteger(e.x))return"x: integer expected";if(null!=e.y&&e.hasOwnProperty("y")&&!s.isInteger(e.y))return"y: integer expected";if(null!=e.channel&&e.hasOwnProperty("channel")&&!s.isInteger(e.channel))return"channel: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.value&&e.hasOwnProperty("value")&&"number"!==typeof e.value)return"value: number expected";if(null!=e.profiles&&e.hasOwnProperty("profiles")){if(!Array.isArray(e.profiles))return"profiles: array expected";for(let t=0;t<e.profiles.length;++t){let i=a.CARTA.SpatialProfile.verify(e.profiles[t]);if(i)return"profiles."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SpatialProfileData)return e;let t=new a.CARTA.SpatialProfileData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.x&&(t.x=0|e.x),null!=e.y&&(t.y=0|e.y),null!=e.channel&&(t.channel=0|e.channel),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.value&&(t.value=Number(e.value)),e.profiles){if(!Array.isArray(e.profiles))throw TypeError(".CARTA.SpatialProfileData.profiles: array expected");t.profiles=[];for(let i=0;i<e.profiles.length;++i){if("object"!==typeof e.profiles[i])throw TypeError(".CARTA.SpatialProfileData.profiles: object expected");t.profiles[i]=a.CARTA.SpatialProfile.fromObject(e.profiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.profiles=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.x=0,i.y=0,i.channel=0,i.stokes=0,i.value=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.x&&e.hasOwnProperty("x")&&(i.x=e.x),null!=e.y&&e.hasOwnProperty("y")&&(i.y=e.y),null!=e.channel&&e.hasOwnProperty("channel")&&(i.channel=e.channel),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.value&&e.hasOwnProperty("value")&&(i.value=t.json&&!isFinite(e.value)?String(e.value):e.value),e.profiles&&e.profiles.length){i.profiles=[];for(let n=0;n<e.profiles.length;++n)i.profiles[n]=a.CARTA.SpatialProfile.toObject(e.profiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e.SpectralProfileData=function(){function e(e){if(this.profiles=[],e)for(let t=Object.keys(e),i=0;i<t.length;++i)null!=e[t[i]]&&(this[t[i]]=e[t[i]])}return e.prototype.fileId=0,e.prototype.regionId=0,e.prototype.stokes=0,e.prototype.progress=0,e.prototype.profiles=s.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.fileId&&Object.hasOwnProperty.call(e,"fileId")&&t.uint32(13).sfixed32(e.fileId),null!=e.regionId&&Object.hasOwnProperty.call(e,"regionId")&&t.uint32(21).sfixed32(e.regionId),null!=e.stokes&&Object.hasOwnProperty.call(e,"stokes")&&t.uint32(29).sfixed32(e.stokes),null!=e.progress&&Object.hasOwnProperty.call(e,"progress")&&t.uint32(37).float(e.progress),null!=e.profiles&&e.profiles.length)for(let i=0;i<e.profiles.length;++i)a.CARTA.SpectralProfile.encode(e.profiles[i],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let i=void 0===t?e.len:e.pos+t,n=new a.CARTA.SpectralProfileData;for(;e.pos<i;){let t=e.uint32();switch(t>>>3){case 1:n.fileId=e.sfixed32();break;case 2:n.regionId=e.sfixed32();break;case 3:n.stokes=e.sfixed32();break;case 4:n.progress=e.float();break;case 5:n.profiles&&n.profiles.length||(n.profiles=[]),n.profiles.push(a.CARTA.SpectralProfile.decode(e,e.uint32()));break;default:e.skipType(7&t)}}return n},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.fileId&&e.hasOwnProperty("fileId")&&!s.isInteger(e.fileId))return"fileId: integer expected";if(null!=e.regionId&&e.hasOwnProperty("regionId")&&!s.isInteger(e.regionId))return"regionId: integer expected";if(null!=e.stokes&&e.hasOwnProperty("stokes")&&!s.isInteger(e.stokes))return"stokes: integer expected";if(null!=e.progress&&e.hasOwnProperty("progress")&&"number"!==typeof e.progress)return"progress: number expected";if(null!=e.profiles&&e.hasOwnProperty("profiles")){if(!Array.isArray(e.profiles))return"profiles: array expected";for(let t=0;t<e.profiles.length;++t){let i=a.CARTA.SpectralProfile.verify(e.profiles[t]);if(i)return"profiles."+i}}return null},e.fromObject=function(e){if(e instanceof a.CARTA.SpectralProfileData)return e;let t=new a.CARTA.SpectralProfileData;if(null!=e.fileId&&(t.fileId=0|e.fileId),null!=e.regionId&&(t.regionId=0|e.regionId),null!=e.stokes&&(t.stokes=0|e.stokes),null!=e.progress&&(t.progress=Number(e.progress)),e.profiles){if(!Array.isArray(e.profiles))throw TypeError(".CARTA.SpectralProfileData.profiles: array expected");t.profiles=[];for(let i=0;i<e.profiles.length;++i){if("object"!==typeof e.profiles[i])throw TypeError(".CARTA.SpectralProfileData.profiles: object expected");t.profiles[i]=a.CARTA.SpectralProfile.fromObject(e.profiles[i])}}return t},e.toObject=function(e,t){t||(t={});let i={};if((t.arrays||t.defaults)&&(i.profiles=[]),t.defaults&&(i.fileId=0,i.regionId=0,i.stokes=0,i.progress=0),null!=e.fileId&&e.hasOwnProperty("fileId")&&(i.fileId=e.fileId),null!=e.regionId&&e.hasOwnProperty("regionId")&&(i.regionId=e.regionId),null!=e.stokes&&e.hasOwnProperty("stokes")&&(i.stokes=e.stokes),null!=e.progress&&e.hasOwnProperty("progress")&&(i.progress=t.json&&!isFinite(e.progress)?String(e.progress):e.progress),e.profiles&&e.profiles.length){i.profiles=[];for(let n=0;n<e.profiles.length;++n)i.profiles[n]=a.CARTA.SpectralProfile.toObject(e.profiles[n],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,n.util.toJSONOptions)},e}(),e})()},60:function(e,t,i){(function(t,n){var r="undefined"!==typeof r?r:{};r.locateFile=function(e,t){return"./"+e};var o,s={};for(o in r)r.hasOwnProperty(o)&&(s[o]=r[o]);var a=[],l=!1,c=!1,d=!1,u=!1;l="object"===typeof window,c="function"===typeof importScripts,d="object"===typeof t&&"object"===typeof t.versions&&"string"===typeof t.versions.node,u=!l&&!d&&!c;var h,p,g,f,b,m="";function y(e){return r.locateFile?r.locateFile(e,m):m+e}d?(m=c?i(113).dirname(m)+"/":n+"/",h=function(e,t){return f||(f=i(191)),b||(b=i(113)),e=b.normalize(e),f.readFileSync(e,t?null:"utf8")},g=function(e){var t=h(e,!0);return t.buffer||(t=new Uint8Array(t)),w(t.buffer),t},t.argv.length>1&&t.argv[1].replace(/\\/g,"/"),a=t.argv.slice(2),e.exports=r,t.on("uncaughtException",(function(e){if(!(e instanceof Pe))throw e})),t.on("unhandledRejection",ne),function(e){t.exit(e)},r.inspect=function(){return"[Emscripten Module object]"}):u?("undefined"!=typeof read&&(h=function(e){return read(e)}),g=function(e){var t;return"function"===typeof readbuffer?new Uint8Array(readbuffer(e)):(w("object"===typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?a=scriptArgs:"undefined"!=typeof arguments&&(a=arguments),"function"===typeof quit&&function(e){quit(e)},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),console.log=print,console.warn=console.error="undefined"!==typeof printErr?printErr:print)):(l||c)&&(c?m=self.location.href:"undefined"!==typeof document&&document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",h=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},c&&(g=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),p=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)});var O=r.print||console.log.bind(console),j=r.printErr||console.warn.bind(console);for(o in s)s.hasOwnProperty(o)&&(r[o]=s[o]);s=null,r.arguments&&(a=r.arguments),r.thisProgram&&r.thisProgram,r.quit&&r.quit;var S,x=function(e){e};r.wasmBinary&&(S=r.wasmBinary);var C;r.noExitRuntime;"object"!==typeof WebAssembly&&ne("no native wasm support detected");var I=!1;function w(e,t){e||ne("Assertion failed: "+t)}function T(e){var t=r["_"+e];return w(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function v(e,t,i,n,r){var o={string:function(e){var t=0;if(null!==e&&void 0!==e&&0!==e){var i=1+(e.length<<2);M(e,t=Re(i),i)}return t},array:function(e){var t=Re(e.length);return _(e,t),t}};var s=T(e),a=[],l=0;if(n)for(var c=0;c<n.length;c++){var d=o[i[c]];d?(0===l&&(l=ve()),a[c]=d(n[c])):a[c]=n[c]}var u=s.apply(null,a);return u=function(e){return"string"===t?E(e):"boolean"===t?Boolean(e):e}(u),0!==l&&Ae(l),u}function A(e,t,i,n){var r=(i=i||[]).every((function(e){return"number"===e}));return"string"!==t&&r&&!n?T(e):function(){return v(e,t,i,arguments)}}var R="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function P(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&R)return R.decode(e.subarray(t,r));for(var o="";t<r;){var s=e[t++];if(128&s){var a=63&e[t++];if(192!=(224&s)){var l=63&e[t++];if((s=224==(240&s)?(15&s)<<12|a<<6|l:(7&s)<<18|a<<12|l<<6|63&e[t++])<65536)o+=String.fromCharCode(s);else{var c=s-65536;o+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else o+=String.fromCharCode((31&s)<<6|a)}else o+=String.fromCharCode(s)}return o}function E(e,t){return e?P(N,e,t):""}function F(e,t,i,n){if(!(n>0))return 0;for(var r=i,o=i+n-1,s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a>=55296&&a<=57343)a=65536+((1023&a)<<10)|1023&e.charCodeAt(++s);if(a<=127){if(i>=o)break;t[i++]=a}else if(a<=2047){if(i+1>=o)break;t[i++]=192|a>>6,t[i++]=128|63&a}else if(a<=65535){if(i+2>=o)break;t[i++]=224|a>>12,t[i++]=128|a>>6&63,t[i++]=128|63&a}else{if(i+3>=o)break;t[i++]=240|a>>18,t[i++]=128|a>>12&63,t[i++]=128|a>>6&63,t[i++]=128|63&a}}return t[i]=0,i-r}function M(e,t,i){return F(e,N,t,i)}var k,D,N,L;"undefined"!==typeof TextDecoder&&new TextDecoder("utf-16le");function _(e,t){D.set(e,t)}function z(e,t){return e%t>0&&(e+=t-e%t),e}function W(e){k=e,r.HEAP8=D=new Int8Array(e),r.HEAP16=new Int16Array(e),r.HEAP32=L=new Int32Array(e),r.HEAPU8=N=new Uint8Array(e),r.HEAPU16=new Uint16Array(e),r.HEAPU32=new Uint32Array(e),r.HEAPF32=new Float32Array(e),r.HEAPF64=new Float64Array(e)}r.INITIAL_MEMORY;var G,V=[],B=[],H=[],q=[];function Y(){if(r.preRun)for("function"==typeof r.preRun&&(r.preRun=[r.preRun]);r.preRun.length;)K(r.preRun.shift());pe(V)}function U(){!0,pe(B)}function X(){pe(H)}function $(){if(r.postRun)for("function"==typeof r.postRun&&(r.postRun=[r.postRun]);r.postRun.length;)Q(r.postRun.shift());pe(q)}function K(e){V.unshift(e)}function Q(e){q.unshift(e)}B.push({func:function(){Te()}});var Z=0,J=null,ee=null;function te(e){Z++,r.monitorRunDependencies&&r.monitorRunDependencies(Z)}function ie(e){if(Z--,r.monitorRunDependencies&&r.monitorRunDependencies(Z),0==Z&&(null!==J&&(clearInterval(J),J=null),ee)){var t=ee;ee=null,t()}}function ne(e){throw r.onAbort&&r.onAbort(e),j(e+=""),I=!0,1,e="abort("+e+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(e)}function re(e,t){return String.prototype.startsWith?e.startsWith(t):0===e.indexOf(t)}r.preloadedImages={},r.preloadedAudios={};var oe="data:application/octet-stream;base64,";function se(e){return re(e,oe)}var ae="file://";function le(e){return re(e,ae)}var ce="gsl_wrapper.wasm";function de(e){try{if(e==ce&&S)return new Uint8Array(S);if(g)return g(e);throw"both async and sync fetching of the wasm failed"}catch(j){ne(j)}}function ue(){if(!S&&(l||c)){if("function"===typeof fetch&&!le(ce))return fetch(ce,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+ce+"'";return e.arrayBuffer()})).catch((function(){return de(ce)}));if(p)return new Promise((function(e,t){p(ce,(function(t){e(new Uint8Array(t))}),t)}))}return Promise.resolve().then((function(){return de(ce)}))}function he(){var e={env:we,wasi_snapshot_preview1:we};function t(e,t){var i=e.exports;r.asm=i,W((C=r.asm.memory).buffer),G=r.asm.__indirect_function_table,ie()}function i(e){t(e.instance)}function n(t){return ue().then((function(t){return WebAssembly.instantiate(t,e)})).then(t,(function(e){j("failed to asynchronously prepare wasm: "+e),ne(e)}))}if(te(),r.instantiateWasm)try{return r.instantiateWasm(e,t)}catch(o){return j("Module.instantiateWasm callback failed with error: "+o),!1}return S||"function"!==typeof WebAssembly.instantiateStreaming||se(ce)||le(ce)||"function"!==typeof fetch?n(i):fetch(ce,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(e){return j("wasm streaming compile failed: "+e),j("falling back to ArrayBuffer instantiation"),n(i)}))})),{}}function pe(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"===typeof i?void 0===t.arg?G.get(i)():G.get(i)(t.arg):i(void 0===t.arg?null:t.arg)}else t(r)}}function ge(){ne()}function fe(e,t,i){N.copyWithin(e,t,t+i)}function be(){return N.length}function me(e){try{return C.grow(e-k.byteLength+65535>>>16),W(C.buffer),1}catch(t){}}function ye(e){var t=be(),i=2147483648;if(e>i)return!1;for(var n=1;n<=4;n*=2){var r=t*(1+.2/n);if(r=Math.min(r,e+100663296),me(Math.min(i,z(Math.max(e,r),65536))))return!0}return!1}se(ce)||(ce=y(ce));var Oe={mappings:{},buffers:[null,[],[]],printChar:function(e,t){var i=Oe.buffers[e];0===t||10===t?((1===e?O:j)(P(i,0)),i.length=0):i.push(t)},varargs:void 0,get:function(){return Oe.varargs+=4,L[Oe.varargs-4>>2]},getStr:function(e){return E(e)},get64:function(e,t){return e}};function je(e){return 0}function Se(e,t,i,n,r){}function xe(e,t,i,n){for(var r=0,o=0;o<i;o++){for(var s=L[t+8*o>>2],a=L[t+(8*o+4)>>2],l=0;l<a;l++)Oe.printChar(e,N[s+l]);r+=a}return L[n>>2]=r,0}function Ce(e){x(0|e)}var Ie,we={abort:ge,emscripten_memcpy_big:fe,emscripten_resize_heap:ye,fd_close:je,fd_seek:Se,fd_write:xe,setTempRet0:Ce},Te=(he(),r.___wasm_call_ctors=function(){return(Te=r.___wasm_call_ctors=r.asm.__wasm_call_ctors).apply(null,arguments)}),ve=(r._filterBoxcar=function(){return(r._filterBoxcar=r.asm.filterBoxcar).apply(null,arguments)},r._filterGaussian=function(){return(r._filterGaussian=r.asm.filterGaussian).apply(null,arguments)},r._filterHanning=function(){return(r._filterHanning=r.asm.filterHanning).apply(null,arguments)},r._filterDecimation=function(){return(r._filterDecimation=r.asm.filterDecimation).apply(null,arguments)},r._filterBinning=function(){return(r._filterBinning=r.asm.filterBinning).apply(null,arguments)},r._filterSavitzkyGolay=function(){return(r._filterSavitzkyGolay=r.asm.filterSavitzkyGolay).apply(null,arguments)},r._malloc=function(){return(r._malloc=r.asm.malloc).apply(null,arguments)},r._free=function(){return(r._free=r.asm.free).apply(null,arguments)},r.___errno_location=function(){return(r.___errno_location=r.asm.__errno_location).apply(null,arguments)},r.stackSave=function(){return(ve=r.stackSave=r.asm.stackSave).apply(null,arguments)}),Ae=r.stackRestore=function(){return(Ae=r.stackRestore=r.asm.stackRestore).apply(null,arguments)},Re=r.stackAlloc=function(){return(Re=r.stackAlloc=r.asm.stackAlloc).apply(null,arguments)};r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.dynCall_jiji).apply(null,arguments)};function Pe(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Ee(e){function t(){Ie||(Ie=!0,r.calledRun=!0,I||(U(),X(),r.onRuntimeInitialized&&r.onRuntimeInitialized(),$()))}e=e||a,Z>0||(Y(),Z>0||(r.setStatus?(r.setStatus("Running..."),setTimeout((function(){setTimeout((function(){r.setStatus("")}),1),t()}),1)):t()))}if(r.ccall=v,r.cwrap=A,ee=function e(){Ie||Ee(),Ie||(ee=e)},r.run=Ee,r.preInit)for("function"==typeof r.preInit&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();Ee(),r.filterBoxcar=r.cwrap("filterBoxcar","number",["number","number","number","number"]),r.filterGaussian=r.cwrap("filterGaussian","number",["number","number","number","number","number"]),r.filterHanning=r.cwrap("filterHanning","number",["number","number","number","number"]),r.filterDecimation=r.cwrap("filterDecimation","number",["number","number","number","number","number"]),r.filterBinning=r.cwrap("filterBinning","number",["number","number","number","number"]),r.filterSavitzkyGolay=r.cwrap("filterSavitzkyGolay","number",["number","number","number","number","number","number"]),r.boxcarSmooth=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.yIn=r._malloc(8*i),r.yOut=r._malloc(8*i),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterBoxcar(r.yIn,i,r.yOut,t);var n=new Float64Array(r.HEAPF64.buffer,r.yOut,i).slice();return r._free(r.yIn),r._free(r.yOut),n},r.gaussianSmooth=function(e,t,i){if(!e)return new Float64Array(1);var n=e.length;r.yIn=r._malloc(8*n),r.yOut=r._malloc(8*n),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterGaussian(r.yIn,n,r.yOut,t,i);var o=new Float64Array(r.HEAPF64.buffer,r.yOut,n).slice();return r._free(r.yIn),r._free(r.yOut),o},r.hanningSmooth=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.yIn=r._malloc(8*i),r.yOut=r._malloc(8*i),r.HEAPF64.set(new Float64Array(e),r.yIn/8),r.filterHanning(r.yIn,i,r.yOut,t);var n=new Float64Array(r.HEAPF64.buffer,r.yOut,i).slice();return r._free(r.yIn),r._free(r.yOut),n},r.decimation=function(e,t,i){if(!t)return new Float64Array(1);var n=t.length;r.xIn=r._malloc(8*n),r.yIn=r._malloc(8*n);var o=n%i===1?2*Math.ceil(n/i)-1:2*Math.ceil(n/i);r.xOut=r._malloc(8*o),r.yOut=r._malloc(8*o),r.HEAPF64.set(new Float64Array(e),r.xIn/8),r.HEAPF64.set(new Float64Array(t),r.yIn/8),r.filterDecimation(r.xIn,r.yIn,n,r.xOut,r.yOut,o,i);var s=new Float64Array(r.HEAPF64.buffer,r.xOut,o).slice(),a=new Float64Array(r.HEAPF64.buffer,r.yOut,o).slice();return r._free(r.xIn),r._free(r.yIn),r._free(r.xOut),r._free(r.yOut),{x:s,y:a}},r.binning=function(e,t){if(!e)return new Float64Array(1);var i=e.length;r.input=r._malloc(8*i);var n=Math.ceil(i/t);r.output=r._malloc(8*n),r.HEAPF64.set(new Float64Array(e),r.input/8),r.filterBinning(r.input,i,r.output,t);var o=new Float64Array(r.HEAPF64.buffer,r.output,n).slice();return r._free(r.input),r._free(r.output),o},r.savitzkyGolaySmooth=function(e,t,i,n){if(!e||!t||n>=i)return new Float64Array(1);var o=e.length;r.xIn=r._malloc(8*o),r.yIn=r._malloc(8*o),r.yOut=r._malloc(8*o),r.HEAPF64.set(new Float64Array(e),r.xIn/8),r.HEAPF64.set(new Float64Array(t),r.yIn/8),r.filterSavitzkyGolay(r.xIn,r.yIn,o,r.yOut,i,n);var s=new Float64Array(r.HEAPF64.buffer,r.yOut,o).slice();return r._free(r.xIn),r._free(r.yIn),r._free(r.yOut),s},e.exports=r}).call(this,i(46),"/")},605:function(e,t){},61:function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"d",(function(){return b})),i.d(t,"e",(function(){return O})),i.d(t,"f",(function(){return ce})),i.d(t,"k",(function(){return ue})),i.d(t,"i",(function(){return He})),i.d(t,"h",(function(){return it})),i.d(t,"j",(function(){return st})),i.d(t,"g",(function(){return lt})),i.d(t,"b",(function(){return Kt})),i.d(t,"c",(function(){return ri}));var n,r=i(3),o=i(15),s=i(9),a=i(36),l=i(91),c=i(5),d=i(11),u=(i(853),i(188)),h=i(0);let p=Object(o.a)(n=class extends r.Component{render(){const e=c.r.Instance,t={icon:"info-sign",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!0,lazy:!0,isOpen:e.aboutDialogVisible,onClose:e.hideAboutDialog,className:"about-dialog",canEscapeKeyClose:!0,title:"About CARTA"};return Object(h.jsxs)(b,{dialogProps:t,defaultWidth:620,defaultHeight:700,enableResizing:!1,children:[Object(h.jsxs)("div",{className:s.a.DIALOG_BODY,children:[Object(h.jsxs)("div",{className:"image-div",children:[Object(h.jsx)("img",{src:u.a,width:80}),Object(h.jsxs)("h3",{children:[d.CARTA_INFO.acronym," ",d.CARTA_INFO.version," (",d.CARTA_INFO.date,")"]}),Object(h.jsx)("p",{children:d.CARTA_INFO.fullName})]}),Object(h.jsx)("h3",{children:"Development team:"}),Object(h.jsx)("p",{children:"The development of the CARTA project is a joint effort from:"}),Object(h.jsxs)("ul",{children:[Object(h.jsx)("li",{children:Object(h.jsx)("a",{href:"https://www.asiaa.sinica.edu.tw/",rel:"noopener noreferrer",target:"_blank",children:"Academia Sinica, Institute of Astronomy and Astrophysics (ASIAA)"})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{href:"https://idia.ac.za/",rel:"noopener noreferrer",target:"_blank",children:"Inter-University Institute for Data Intensive Astronomy (IDIA)"})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{href:"https://science.nrao.edu/",rel:"noopener noreferrer",target:"_blank",children:"National Radio Astronomy Observatory (NRAO)"})}),Object(h.jsx)("li",{children:Object(h.jsx)("a",{href:"https://www.ualberta.ca/physics",rel:"noopener noreferrer",target:"_blank",children:"Department of Physics, University of Alberta"})})]}),Object(h.jsx)("h3",{children:"Useful links:"}),Object(h.jsxs)("ul",{children:[Object(h.jsxs)("li",{children:["Source code for CARTA is available on ",Object(h.jsx)("a",{href:"https://github.com/cartavis",rel:"noopener noreferrer",target:"_blank",children:"GitHub"})]}),Object(h.jsxs)("li",{children:["Please report bugs or suggestions to the ",Object(h.jsx)("a",{href:"mailto:carta_helpdesk@asiaa.sinica.edu.tw",rel:"noopener noreferrer",target:"_blank",children:"CARTA helpdesk"})," or file a ",Object(h.jsx)("a",{href:"https://github.com/CARTAvis/carta/issues",rel:"noopener noreferrer",target:"_blank",children:"GitHub issue"})]}),Object(h.jsxs)("li",{children:["Documentation is available ",Object(h.jsx)("a",{href:"https://carta.readthedocs.io/en/1.4",rel:"noopener noreferrer",target:"_blank",children:"online"})]})]}),Object(h.jsx)("h3",{children:"License"}),Object(h.jsxs)("p",{className:s.a.TEXT_SMALL,children:["Copyright (C) 2018-2021 ASIAA, IDIA, NRAO, and Department of Physics, University of Alberta. This program is free software; you can redistribute it and/or modify it under the terms of the\xa0",Object(h.jsx)("a",{href:"http://www.gnu.org/copyleft/gpl.html",rel:"noopener noreferrer",target:"_blank",children:"GNU General Public License version 3"}),"\xa0 as published by the Free Software Foundation."]})]}),Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER,children:Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER_ACTIONS,children:Object(h.jsx)(a.b,{intent:l.a.NONE,onClick:e.hideAboutDialog,text:"Close"})})})]})}})||n;var g=i(40),f=i(186);i(854);class b extends r.Component{constructor(...e){super(...e),this.dd=void 0,this.rnd=void 0,this.onClickHelpButton=()=>{const e=this.rnd.draggable.state.x+.5*this.rnd.resizable.size.width;c.w.Instance.showHelpDrawer(this.props.helpType,e)}}componentDidUpdate(){const e=this.dd.getElementsByClassName("bp3-dialog-header");if(this.props.helpType&&e.length>0&&0===this.dd.getElementsByClassName("help-button").length){const t=Object(h.jsx)(a.e,{icon:"help",minimal:!0,onClick:this.onClickHelpButton}),i=document.createElement("div");i.setAttribute("class","help-button"),g.render(t,i);const n=this.dd.getElementsByClassName("bp3-dialog-close-button");n.length>0?n[0].before(i):e[0].append(i)}}render(){const e=window,t=document,i=t.documentElement,n=t.getElementsByTagName("body")[0],r=e.innerWidth||i.clientWidth||n.clientWidth,o=e.innerHeight||i.clientHeight||n.clientHeight,s=this.props.enableResizing,l={top:s,bottom:s,left:s,right:s,topLeft:s,topRight:s,bottomLeft:s,bottomRight:s};return Object(h.jsx)("div",{className:"draggable-dialog",ref:e=>this.dd=e,children:this.props.dialogProps.isOpen&&Object(h.jsx)(f.a,{enableResizing:l,bounds:".gl-container-app",dragGrid:[1,1],resizeGrid:[25,25],default:{x:Math.floor(Math.max((r-this.props.defaultWidth)/2,0)),y:Math.floor(Math.max((o-this.props.defaultHeight)/2,0)),width:Math.min(this.props.defaultWidth,r),height:Math.min(this.props.defaultHeight,o)},minWidth:this.props.minWidth,minHeight:this.props.minHeight,dragHandleClassName:"bp3-dialog-header",ref:e=>{this.rnd=e},children:Object(h.jsx)(a.l,{hasBackdrop:!1,usePortal:!1,enforceFocus:!1,autoFocus:!0,...this.props.dialogProps,children:this.props.children})})})}}var m,y=i(419);i(855);let O=Object(o.a)(m=class extends r.Component{render(){const e=c.e.Instance;let t="iframe-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"info-sign",className:t,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.externalPageDialogVisible,onClose:e.dialogStore.hideExternalPageDialog,title:e.dialogStore.externalPageDialogTitle};return Object(h.jsx)(b,{dialogProps:i,minWidth:400,minHeight:400,defaultWidth:800,defaultHeight:600,enableResizing:!0,children:Object(h.jsx)("div",{className:"bp3-dialog-body",children:Object(h.jsx)(y.a,{url:e.dialogStore.externalPageDialogUrl})})})}})||m;var j,S,x,C,I,w,T,v,A,R=i(4),P=i(2),E=(i(28),i(33)),F=i(1),M=i(44),k=i(6),D=i(66),N=i(147),L=i(189),_=i(18),z=i(907),W=i(67),G=i(415),V=i(421),B=i.n(V),H=i(89),q=i.n(H),Y=i(109),U=i(7);i(857);let X=Object(o.a)((A=v=class e extends r.Component{static GetFileTypeDisplay(t){return e.FileTypeMap.get(t)||{type:"Unknown",description:"An unknown file format"}}static GeCatalogFileTypeDisplay(t){return e.CatalogFileTypeMap.get(t)||{type:"Unknown",description:"An unknown file format"}}static GetFileSizeDisplay(e){return e>=1e12?`${Object(U.mb)(e/1e12,2)} TB`:e>=1e9?`${Object(U.mb)(e/1e9,1)} GB`:e>=1e6?`${Object(U.mb)(e/1e6,1)} MB`:e>=1e3?`${Object(U.mb)(e/1e3,1)} kB`:`${e} B`}get tableEntries(){var t,i;const n=this.props.listResponse;if(!n)return[];const r=this.props.fileBrowserMode;let o=null===n||void 0===n||null===(t=n.subdirectories)||void 0===t?void 0:t.slice(),s=null===n||void 0===n||null===(i=n.files)||void 0===i?void 0:i.slice();const a=this.props.filterString,l=this.props.filterType;if(a)try{let e;if(l===c.t.Fuzzy){o=new Y.a(o).search(a);s=new Y.a(s,["name"]).search(a)}else if(l===c.t.Unix){var d,u;e=RegExp(B()(a.toLowerCase())),o=null===(d=o)||void 0===d?void 0:d.filter((t=>t.toLowerCase().match(e))),s=null===(u=s)||void 0===u?void 0:u.filter((t=>t.name.toLowerCase().match(e)))}else{var h,p;e=RegExp(a),o=null===(h=o)||void 0===h?void 0:h.filter((t=>t.match(e))),s=null===(p=s)||void 0===p?void 0:p.filter((t=>t.name.match(e)))}}catch(b){"SyntaxError"!==b.name&&console.log(b)}const g=[],f={direction:this.props.sortingString.startsWith("+")?1:-1,columnName:this.props.sortingString.substring(1).toLowerCase()};if(o&&o.length){"filename"===(null===f||void 0===f?void 0:f.columnName)&&o.sort(((e,t)=>f.direction*(e.toLowerCase()<t.toLowerCase()?-1:1)));for(const e of o)g.push({filename:e,isDirectory:!0})}if(s&&s.length){switch(null===f||void 0===f?void 0:f.columnName){case"filename":s.sort(((e,t)=>f.direction*(e.name.toLowerCase()<t.name.toLowerCase()?-1:1)));break;case"type":s.sort(((e,t)=>f.direction*(e.type<t.type?-1:1)));break;case"size":s.sort(((e,t)=>f.direction*(e.size<t.size?-1:1)));break;case"date":s.sort(((e,t)=>f.direction*(e.date<t.date?-1:1)))}if(r===c.g.Catalog)for(const t of s)g.push({filename:t.name,typeInfo:e.GeCatalogFileTypeDisplay(t.type),size:t.fileSize,date:t.date,fileInfo:t});else if(r===c.g.File)for(const t of s)for(const i of t.HDUList){const n=t.HDUList.length>1?`${t.name}: HDU ${i}`:t.name;g.push({filename:n,typeInfo:e.GetFileTypeDisplay(t.type),size:t.size,date:t.date,fileInfo:t,hdu:i})}else for(const t of s)g.push({filename:t.name,typeInfo:e.GetFileTypeDisplay(t.type),size:t.size,date:t.date,fileInfo:t})}return g}get selectedFiles(){var e,t;if(!(null===(e=this.tableEntries)||void 0===e?void 0:e.length)||!(null===(t=this.selectedRegions)||void 0===t?void 0:t.length))return[];const i=[];for(const n of this.selectedRegions)for(let e=n.rows[0];e<=n.rows[1];e++)if(e>=0&&e<this.tableEntries.length){const t=this.tableEntries[e];i.push(t)}return i}constructor(t){super(t),Object(R.a)(this,"selectedRegions",x,this),Object(R.a)(this,"columnWidths",C,this),this.tableRef=void 0,this.cachedFilterString=void 0,this.cachedSortingString=void 0,this.cachedFileResponse=void 0,this.rowPivotIndex=-1,Object(R.a)(this,"selectEntry",I,this),Object(R.a)(this,"handleColumnWidthChanged",w,this),this.renderColumnHeader=(e,t)=>{const i={direction:this.props.sortingString.startsWith("+")?1:-1,columnName:this.props.sortingString.substring(1).toLowerCase()},n=e.toLowerCase()===(null===i||void 0===i?void 0:i.columnName),r=(null===i||void 0===i?void 0:i.direction)<0;return Object(h.jsx)(N.a,{className:"column-name",nameRenderer:()=>n?Object(h.jsx)("div",{className:"sort-label",onClick:()=>this.props.onSortingChanged(e,-i.direction),children:Object(h.jsxs)(a.y,{className:"bp3-inline label",children:[Object(h.jsx)(a.w,{className:"sort-icon",icon:r?"sort-desc":"sort-asc"}),e]})}):Object(h.jsx)("div",{className:"sort-label",onClick:()=>this.props.onSortingChanged(e,1),children:Object(h.jsxs)(a.y,{className:"bp3-inline label",children:[Object(h.jsx)(a.w,{className:"sort-icon inactive",icon:"sort"}),e]})})})},this.renderFilenames=e=>{const t=this.tableEntries[e];return t?Object(h.jsx)(L.a,{className:t.isDirectory?"folder-cell":"filename-cell",tooltip:null===t||void 0===t?void 0:t.filename,children:Object(h.jsx)(r.Fragment,{children:Object(h.jsxs)("div",{onClick:i=>this.handleEntryClicked(i,t,e),onDoubleClick:()=>this.handleEntryDoubleClicked(t),children:[(null===t||void 0===t?void 0:t.isDirectory)&&Object(h.jsx)(a.w,{icon:"folder-close"}),Object(h.jsx)("span",{className:"cell-text",children:null===t||void 0===t?void 0:t.filename})]})})}):Object(h.jsx)(L.a,{loading:!0})},this.renderTypes=e=>{var t,i;const n=this.tableEntries[e];return n?Object(h.jsx)(L.a,{tooltip:null===(t=n.typeInfo)||void 0===t?void 0:t.description,children:Object(h.jsx)(r.Fragment,{children:Object(h.jsx)("div",{onClick:t=>this.handleEntryClicked(t,n,e),onDoubleClick:()=>this.handleEntryDoubleClicked(n),children:null===(i=n.typeInfo)||void 0===i?void 0:i.type})})}):Object(h.jsx)(L.a,{loading:!0})},this.renderSizes=t=>{const i=this.tableEntries[t];if(!i)return Object(h.jsx)(L.a,{loading:!0});const n=null===i||void 0===i?void 0:i.size;return Object(h.jsx)(L.a,{children:Object(h.jsx)(r.Fragment,{children:Object(h.jsx)("div",{onClick:e=>this.handleEntryClicked(e,i,t),onDoubleClick:()=>this.handleEntryDoubleClicked(i),children:isFinite(n)&&e.GetFileSizeDisplay(n)})})})},this.renderDates=e=>{const t=this.tableEntries[e];if(!t)return Object(h.jsx)(L.a,{loading:!0});const i=t.date;let n;if(i>0){const e=q.a.unix(i);n=0===q()(0,"HH").diff(e,"days")?e.format("HH:mm"):e.format("D MMM YYYY")}return Object(h.jsx)(L.a,{className:"time-cell",children:Object(h.jsx)(r.Fragment,{children:Object(h.jsx)("div",{onClick:i=>this.handleEntryClicked(i,t,e),onDoubleClick:()=>this.handleEntryDoubleClicked(t),children:n})})})},this.handleEntryDoubleClicked=e=>{(null===e||void 0===e?void 0:e.isDirectory)||this.props.onFileDoubleClicked(e)},Object(R.a)(this,"handleEntryClicked",T,this),Object(F.p)(this),Object(F.h)((()=>{const e=this.props.listResponse,t=this.props.sortingString,i=this.props.filterString;e===this.cachedFileResponse&&t===this.cachedSortingString&&i===this.cachedFilterString||(this.cachedSortingString=t,this.cachedFilterString=i,this.cachedFileResponse=e,Object(F.s)((()=>this.selectedRegions=[])),this.rowPivotIndex=-1,this.props.onSelectionChanged([]),setTimeout((()=>{var e;return null===(e=this.tableRef)||void 0===e?void 0:e.scrollToRegion(_.c.row(0,0))}),20))}))}render(){var t,i;const n=this.props.listResponse,r=(this.props.sortingString,["browser-table"]);this.props.darkTheme&&r.push("bp3-dark");const o=this.tableEntries.length;return((null===n||void 0===n||null===(t=n.files)||void 0===t?void 0:t.length)||0)+((null===n||void 0===n||null===(i=n.subdirectories)||void 0===i?void 0:i.length)||0)?o?Object(h.jsxs)(z.a,{ref:e=>this.tableRef=e,className:r.join(" "),enableRowReordering:!1,renderMode:W.a.NONE,selectionModes:_.d.NONE,enableGhostCells:!1,columnWidths:this.columnWidths,minColumnWidth:80,enableMultipleSelection:!0,enableRowResizing:!1,defaultRowHeight:e.RowHeight,onColumnWidthChanged:this.handleColumnWidthChanged,selectedRegions:this.selectedRegions,enableRowHeader:!1,numRows:this.tableEntries.length,loadingOptions:this.props.loading?[_.e.CELLS]:[],children:[Object(h.jsx)(G.a,{name:"Filename",columnHeaderCellRenderer:()=>this.renderColumnHeader("Filename"),cellRenderer:this.renderFilenames}),Object(h.jsx)(G.a,{name:"Type",columnHeaderCellRenderer:()=>this.renderColumnHeader("Type"),cellRenderer:this.renderTypes}),Object(h.jsx)(G.a,{name:"Size",columnHeaderCellRenderer:()=>this.renderColumnHeader("Size"),cellRenderer:this.renderSizes}),Object(h.jsx)(G.a,{name:"Date",columnHeaderCellRenderer:()=>this.renderColumnHeader("Date"),cellRenderer:this.renderDates})]}):Object(h.jsx)(a.C,{icon:"search",title:"No results",description:"There are no files or subdirectories matching the filter expression"}):Object(h.jsx)(a.C,{icon:"folder-open",title:"Empty folder",description:"There are no files or subdirectories in this folder"})}},v.RowHeight=22,v.FileTypeMap=new Map([[k.a.FileType.CASA,{type:"CASA",description:"CASA Image"}],[k.a.FileType.CRTF,{type:"CRTF",description:"CASA Region Text Format"}],[k.a.FileType.DS9_REG,{type:"DS9",description:"DS9 Region Format"}],[k.a.FileType.FITS,{type:"FITS",description:"Flexible Image Transport System"}],[k.a.FileType.HDF5,{type:"HDF5",description:"HDF5 File (IDIA Schema)"}],[k.a.FileType.MIRIAD,{type:"Miriad",description:"Miriad Image"}]]),v.CatalogFileTypeMap=new Map([[k.a.CatalogFileType.FITSTable,{type:"FITS",description:"Flexible Image Transport System"}],[k.a.CatalogFileType.VOTable,{type:"VOTable",description:"XML-Based Table Format"}]]),S=A,x=Object(P.a)(S.prototype,"selectedRegions",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=Object(P.a)(S.prototype,"columnWidths",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[350,80,90,95]}}),Object(P.a)(S.prototype,"tableEntries",[F.i],Object.getOwnPropertyDescriptor(S.prototype,"tableEntries"),S.prototype),Object(P.a)(S.prototype,"selectedFiles",[F.i],Object.getOwnPropertyDescriptor(S.prototype,"selectedFiles"),S.prototype),I=Object(P.a)(S.prototype,"selectEntry",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e&&(e.isDirectory?(this.props.onFolderClicked(e.filename),this.selectedRegions=void 0,this.rowPivotIndex=-1,this.props.onSelectionChanged([])):(this.props.onFileClicked(e),this.selectedRegions=[_.c.row(t)],this.rowPivotIndex=t,this.props.onSelectionChanged(this.selectedFiles)))}}}),w=Object(P.a)(S.prototype,"handleColumnWidthChanged",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{e>=0&&e<this.columnWidths.length&&(this.columnWidths[e]=t)}}}),T=Object(P.a)(S.prototype,"handleEntryClicked",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t,i)=>{if(t)if(t.isDirectory)this.props.onFolderClicked(t.filename),this.selectedRegions=[],this.rowPivotIndex=-1;else{var n;if((e.ctrlKey||e.metaKey)&&this.selectedRegions.length){const e=_.c.row(i),t=_.c.findMatchingRegion(this.selectedRegions,e);-1===t?(this.selectedRegions.push(e),this.selectedRegions=this.selectedRegions.slice()):(this.selectedRegions=this.selectedRegions.filter((e=>e!==this.selectedRegions[t])),this.selectedRegions.length||(this.selectedRegions=[_.c.row(i)]))}else if(e.shiftKey&&this.selectedRegions.length){const e=_.c.row(this.rowPivotIndex,i);this.selectedRegions=[];for(let t=e.rows[0];t<=e.rows[1];t++)this.selectedRegions.push(_.c.row(t))}else this.selectedRegions=[_.c.row(i)],this.rowPivotIndex=i;1===(null===(n=this.selectedRegions)||void 0===n?void 0:n.length)&&this.props.onFileClicked(this.tableEntries[this.selectedRegions[0].rows[0]])}this.props.onSelectionChanged(this.selectedFiles)}}}),j=S))||j;var $,K,Q,Z,J,ee,te,ie,ne,re,oe,se,ae,le=i(8);i(858);let ce=Object(o.a)((K=class e extends r.Component{constructor(e){super(e),Object(R.a)(this,"overwriteExistingFileAlertVisible",Q,this),Object(R.a)(this,"fileFilterString",Z,this),Object(R.a)(this,"debouncedFilterString",J,this),Object(R.a)(this,"selectedFiles",ee,this),this.handleTabChange=e=>{c.s.Instance.setSelectedTab(e)},Object(R.a)(this,"handleSelectionChanged",te,this),this.loadSelectedFiles=async()=>{const e=c.s.Instance;if(this.selectedFiles.length>1)for(let i=0;i<this.selectedFiles.length;i++)try{await this.loadFile(this.selectedFiles[i],i>0)}catch(t){console.log(t)}else await this.loadFile({fileInfo:e.selectedFile,hdu:e.selectedHDU})},this.loadFile=async(e,t=!1)=>{const i=c.e.Instance,n=i.fileBrowserStore;if(n.browserMode!==c.g.RegionExport){if(n.browserMode===c.g.File){const r=i.frames;(t||n.appendingFrame)&&r.length?await i.appendFile(n.fileList.directory,e.fileInfo.name,e.hdu):await i.openFile(n.fileList.directory,e.fileInfo.name,e.hdu)}else n.browserMode===c.g.Catalog?await i.appendCatalog(n.catalogFileList.directory,e.fileInfo.name,c.j.InitTableRows,k.a.CatalogFileType.VOTable):await i.importRegion(n.fileList.directory,e.fileInfo.name,e.fileInfo.type);n.saveStartingDirectory()}},this.handleSaveFileClicked=()=>{const e=c.e.Instance,t=c.s.Instance,i=t.saveFilename.trim();t.fileList&&t.fileList.files&&t.fileList.files.find((e=>e.name.trim()===i))?this.overwriteExistingFileAlertVisible=!0:e.saveFile(t.fileList.directory,i,t.saveFileType)},this.handleSaveFileNameChanged=e=>{c.s.Instance.setSaveFilename(e.target.value)},this.handleExportRegionsClicked=()=>{const e=c.s.Instance,t=e.exportFilename.trim();e.fileList&&e.fileList.files&&e.fileList.files.find((e=>e.name.trim()===t))?this.overwriteExistingFileAlertVisible=!0:this.exportRegion(e.fileList.directory,t)},this.handleOverwriteAlertConfirmed=()=>{this.overwriteExistingFileAlertVisible=!1;const e=c.s.Instance;if(e.browserMode===c.g.RegionExport){const t=e.exportFilename.trim();this.exportRegion(e.fileList.directory,t)}else if(e.browserMode===c.g.SaveFile){const t=c.e.Instance,i=e.saveFilename.trim();t.saveFile(e.fileList.directory,i,e.saveFileType)}},this.handleOverwriteAlertDismissed=()=>{this.overwriteExistingFileAlertVisible=!1},this.handleExportInputChanged=e=>{c.s.Instance.setExportFilename(e.target.value)},Object(R.a)(this,"handleFilterStringInputChanged",ie,this),this.setFilterString=E.debounce((e=>Object(F.s)((()=>{this.debouncedFilterString=e}))),500),Object(R.a)(this,"clearFilterString",ne,this),Object(R.a)(this,"handleFolderClicked",re,this),Object(R.a)(this,"handleBreadcrumbClicked",oe,this),Object(R.a)(this,"setFilterType",se,this),Object(R.a)(this,"refreshFileList",ae,this),this.renderBreadcrumb=e=>Object(h.jsxs)(a.c,{onClick:e.onClick,className:"folder-breadcrumb",children:[e.icon&&Object(h.jsx)(a.w,{iconSize:14,icon:e.icon}),e.text]}),Object(F.p)(this)}exportRegion(e,t){if(!t||!e)return;t=t.trim();const i=c.e.Instance,n=c.s.Instance;i.exportRegions(e,t,n.exportCoordinateType,n.exportFileType),console.log(`Exporting all regions to ${e}/${t}`)}static ValidateFilename(e){return e&&e.length&&!e.match(/(\.\.)|(\\)+/gm)}renderActionButton(t,i){const n=c.e.Instance,r=n.fileBrowserStore;var o,s;if(t===c.g.File)return i?Object(h.jsx)(a.W,{content:"Append this image while keeping other images open",children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo,onClick:this.loadSelectedFiles,text:(null===(o=this.selectedFiles)||void 0===o?void 0:o.length)>1?"Append selected":"Append"})}):Object(h.jsx)(a.W,{content:"Close any existing images and load this image",children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo,onClick:this.loadSelectedFiles,text:(null===(s=this.selectedFiles)||void 0===s?void 0:s.length)>1?"Load selected":"Load"})});if(t===c.g.SaveFile)return Object(h.jsx)(a.W,{content:"Save this file",children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||r.loadingInfo,onClick:this.handleSaveFileClicked,text:"Save"})});if(t===c.g.RegionImport)return Object(h.jsx)(a.W,{content:"Load a region file for the currently active image",children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo||!n.activeFrame,onClick:this.loadSelectedFiles,text:"Load Region"})});if(t===c.g.Catalog)return Object(h.jsx)(a.W,{content:"Load a catalog file for the currently active image",children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,disabled:n.fileLoading||!r.selectedFile||!r.fileInfoResp||r.loadingInfo||!n.activeFrame,onClick:this.loadSelectedFiles,text:"Load Catalog"})});{const t=n.activeFrame;return Object(h.jsx)(a.W,{content:"Export all regions for the currently active image",children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,disabled:!e.ValidateFilename(r.exportFilename)||!t||t.regionSet.regions.length<=1,onClick:this.handleExportRegionsClicked,text:"Export Regions"})})}}renderExportFilenameInput(){const e=c.s.Instance,t=Object(h.jsx)(a.F,{content:Object(h.jsxs)(a.z,{children:[Object(h.jsx)(a.B,{text:"World Coordinates",onClick:()=>e.setExportCoordinateType(k.a.CoordinateType.WORLD)}),Object(h.jsx)(a.B,{text:"Pixel Coordinates",onClick:()=>e.setExportCoordinateType(k.a.CoordinateType.PIXEL)})]}),position:M.a.BOTTOM_RIGHT,children:Object(h.jsx)(a.e,{minimal:!0,rightIcon:"caret-down",children:e.exportCoordinateType===k.a.CoordinateType.WORLD?"World":"Pixel"})}),i=Object(h.jsx)(a.F,{minimal:!0,content:Object(h.jsxs)(a.z,{children:[Object(h.jsx)(a.B,{text:"CRTF Region File",onClick:()=>e.setExportFileType(k.a.FileType.CRTF)}),Object(h.jsx)(a.B,{text:"DS9 Region File",onClick:()=>e.setExportFileType(k.a.FileType.DS9_REG)})]}),position:M.a.BOTTOM_RIGHT,children:Object(h.jsx)(a.e,{minimal:!0,rightIcon:"caret-down",children:e.exportFileType===k.a.FileType.CRTF?"CRTF":"DS9"})});let n=Object(h.jsxs)("div",{children:[i,t]});return Object(h.jsx)(a.x,{autoFocus:!0,placeholder:"Enter file name",value:e.exportFilename,onChange:this.handleExportInputChanged,rightElement:n})}renderSaveFilenameInput(){const e=c.s.Instance,t=Object(h.jsx)(a.F,{minimal:!0,content:Object(h.jsxs)(a.z,{children:[Object(h.jsx)(a.B,{text:"CASA",onClick:()=>e.setSaveFileType(k.a.FileType.CASA)}),Object(h.jsx)(a.B,{text:"FITS",onClick:()=>e.setSaveFileType(k.a.FileType.FITS)})]}),position:M.a.BOTTOM_RIGHT,children:Object(h.jsx)(a.e,{minimal:!0,rightIcon:"caret-down",children:e.saveFileType===k.a.FileType.CASA?"CASA":"FITS"})});return Object(h.jsx)(a.x,{autoFocus:!0,placeholder:"Enter file name",value:e.saveFilename,onChange:this.handleSaveFileNameChanged,rightElement:t})}renderOpenFilenameInput(){const e=c.H.Instance;let t,i;e.fileFilteringType===c.t.Fuzzy?(t="Fuzzy search",i="Filter by filename with fuzzy search"):e.fileFilteringType===c.t.Unix?(t="Unix pattern",i="Filter by filename using unix-style pattern"):(t="Regular expression",i="Filter by filename using regular expression");const n=Object(h.jsx)(a.F,{minimal:!0,content:Object(h.jsxs)(a.z,{children:[Object(h.jsx)(a.B,{text:"Fuzzy search",onClick:()=>this.setFilterType(c.t.Fuzzy)}),Object(h.jsx)(a.B,{text:"Unix pattern",onClick:()=>this.setFilterType(c.t.Unix)}),Object(h.jsx)(a.B,{text:"Regular expression",onClick:()=>this.setFilterType(c.t.Regex)})]}),position:M.a.BOTTOM_RIGHT,children:Object(h.jsx)(a.e,{minimal:!0,icon:"filter",rightIcon:"caret-down",children:t})});return Object(h.jsx)(a.x,{autoFocus:!1,placeholder:i,value:this.fileFilterString,onChange:this.handleFilterStringInputChanged,leftIcon:"search",rightElement:n})}render(){const t=c.e.Instance,i=t.fileBrowserStore;let n="file-browser-dialog";t.darkTheme&&(n+=" bp3-dark");const o={icon:"folder-open",className:n,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.fileBrowserDialogVisible,onClose:i.hideFileBrowser,onOpened:this.refreshFileList,title:"File Browser"},s=this.renderActionButton(i.browserMode,i.appendingFrame);let d;d=i.browserMode===c.g.SaveFile?this.renderSaveFilenameInput():i.browserMode===c.g.RegionExport?this.renderExportFilenameInput():this.renderOpenFilenameInput();let u=null;if(i.browserMode===c.g.Catalog&&i.catalogHeaders&&i.catalogHeaders.length){const e=i.catalogHeaderDataset;u={type:le.x.Normal,dataset:e.columnsData,columnHeaders:e.columnHeaders,numVisibleRows:i.catalogHeaders.length}}const p=i.getfileListByMode;return Object(h.jsxs)(b,{dialogProps:o,helpType:c.x.FILE_Browser,minWidth:400,minHeight:400,defaultWidth:1200,defaultHeight:600,enableResizing:!0,children:[Object(h.jsx)("div",{className:"file-path",children:this.pathItems&&Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.W,{content:"Refresh current directory",children:Object(h.jsx)(a.b,{className:"refresh-button",icon:"repeat",onClick:()=>i.selectFolder(p.directory,!0),minimal:!0})}),Object(h.jsx)(a.d,{className:"path-breadcrumbs",breadcrumbRenderer:this.renderBreadcrumb,items:this.pathItems})]})}),Object(h.jsxs)("div",{className:"bp3-dialog-body",children:[Object(h.jsxs)("div",{className:"file-panes",children:[Object(h.jsx)("div",{className:"file-list",children:Object(h.jsx)(X,{darkTheme:t.darkTheme,loading:i.loadingList,listResponse:i.getfileListByMode,fileBrowserMode:i.browserMode,selectedFile:i.selectedFile,selectedHDU:i.selectedHDU,filterString:this.debouncedFilterString,filterType:t.preferenceStore.fileFilteringType,sortingString:t.preferenceStore.fileSortingString,onSortingChanged:i.setSortingConfig,onFileClicked:i.selectFile,onSelectionChanged:this.handleSelectionChanged,onFileDoubleClicked:this.loadFile,onFolderClicked:this.handleFolderClicked})}),Object(h.jsx)("div",{className:"file-info-pane",children:Object(h.jsx)(D.a,{infoTypes:e.GetFileInfoTypes(i.browserMode),HDUOptions:{HDUList:i.HDUList,handleSelectedHDUChange:i.selectHDU},fileInfoExtended:i.fileInfoExtended,regionFileInfo:i.regionFileInfo?i.regionFileInfo.join("\n"):"",catalogFileInfo:i.catalogFileInfo,selectedTab:i.selectedTab,handleTabChange:this.handleTabChange,isLoading:i.loadingInfo,errorMessage:i.responseErrorMessage,catalogHeaderTable:u})})]}),d]}),Object(h.jsx)("div",{className:"bp3-dialog-footer",children:Object(h.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(h.jsx)(a.b,{intent:l.a.NONE,onClick:i.hideFileBrowser,disabled:t.fileLoading,text:"Close"}),s]})}),Object(h.jsx)(a.a,{className:t.darkTheme?"bp3-dark":"",isOpen:this.overwriteExistingFileAlertVisible,confirmButtonText:"Yes",cancelButtonText:"Cancel",intent:l.a.DANGER,onConfirm:this.handleOverwriteAlertConfirmed,onCancel:this.handleOverwriteAlertDismissed,canEscapeKeyCancel:!0,children:"This file exists. Are you sure to overwrite it?"})]})}static GetFileInfoTypes(e){switch(e){case c.g.File:case c.g.SaveFile:return[D.b.IMAGE_FILE,D.b.IMAGE_HEADER];case c.g.Catalog:return[D.b.CATALOG_FILE,D.b.CATALOG_HEADER];default:return[D.b.REGION_FILE]}}get pathItems(){let e=[{icon:"desktop",onClick:()=>this.handleBreadcrumbClicked("")}];const t=c.s.Instance.getfileListByMode;if(t){const i=t.directory;if(i&&"."!==i){const t=i.split("/");let n="";if(t.length)for(const i of t){if(!i)continue;n+=`/${i}`;const t=n;e.push({text:i,onClick:()=>this.handleBreadcrumbClicked(t)})}}}return e}},Q=Object(P.a)(K.prototype,"overwriteExistingFileAlertVisible",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Z=Object(P.a)(K.prototype,"fileFilterString",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),J=Object(P.a)(K.prototype,"debouncedFilterString",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ee=Object(P.a)(K.prototype,"selectedFiles",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),te=Object(P.a)(K.prototype,"handleSelectionChanged",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedFiles=e}}}),ie=Object(P.a)(K.prototype,"handleFilterStringInputChanged",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileFilterString=e.target.value,this.setFilterString(this.fileFilterString)}}}),ne=Object(P.a)(K.prototype,"clearFilterString",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.fileFilterString="",this.debouncedFilterString=""}}}),re=Object(P.a)(K.prototype,"handleFolderClicked",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),c.e.Instance.fileBrowserStore.selectFolder(e)}}}),oe=Object(P.a)(K.prototype,"handleBreadcrumbClicked",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),c.e.Instance.fileBrowserStore.selectFolder(e,!0)}}}),se=Object(P.a)(K.prototype,"setFilterType",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.clearFilterString(),c.H.Instance.setPreference(c.G.SILENT_FILE_FILTERING_TYPE,e)}}}),ae=Object(P.a)(K.prototype,"refreshFileList",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.clearFilterString();const e=c.s.Instance;switch(e.browserMode){case c.g.Catalog:e.catalogFileList={...e.catalogFileList};break;default:e.fileList={...e.fileList}}}}}),Object(P.a)(K.prototype,"pathItems",[F.i],Object.getOwnPropertyDescriptor(K.prototype,"pathItems"),K.prototype),$=K))||$;var de;let ue=Object(o.a)(de=class extends r.Component{render(){let e,t=this.props.text;if(this.props.timeRemaining){const i=.001*this.props.timeRemaining;if(i>60){const t=Math.floor(i/60),n=Math.floor(i-60*t);e=`${t}m${n>=10?Object(U.mb)(n):`0${Object(U.mb)(n)}`}s`}else{const t=Math.floor(i);e=`${t>=10?Object(U.mb)(t):`0${Object(U.mb)(t)}`}s`}t=`${this.props.text} (${e} left)`}let i="task-progress-dialog";return c.e.Instance.darkTheme&&(i+=" bp3-dark"),Object(h.jsxs)(a.l,{className:i,icon:"time",canEscapeKeyClose:!1,canOutsideClickClose:!1,isCloseButtonShown:!1,title:t,isOpen:this.props.isOpen,children:[Object(h.jsx)("div",{className:s.a.DIALOG_BODY,children:Object(h.jsx)(a.J,{value:this.props.progress,animate:!isFinite(this.props.progress),stripes:!isFinite(this.props.progress),intent:"primary"})}),this.props.cancellable&&Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER,children:Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER_ACTIONS,children:Object(h.jsx)(a.W,{content:"Cancel the current task",children:Object(h.jsx)(a.b,{onClick:this.props.onCancel,children:"Cancel"})})})})]})}})||de;var he;i(859);let pe=Object(o.a)(he=class extends r.Component{render(){const e=this.props.region;return Object(h.jsxs)("div",{className:"coordinate-panel",children:[Object(h.jsxs)(a.L,{inline:!0,onChange:t=>e.setCoordinate(t.currentTarget.value),selectedValue:e.coordinate,disabled:this.props.disableCooridnate,children:[Object(h.jsx)(a.K,{label:c.K.Image,value:c.K.Image}),Object(h.jsx)(a.K,{label:c.K.World,value:c.K.World})]}),Object(h.jsx)(a.r,{options:Object.keys(c.R).map((e=>({label:e,value:c.R[e]}))),value:c.e.Instance.overlayStore.global.system,onChange:e=>c.e.Instance.overlayStore.global.setSystem(e.currentTarget.value)})]})}})||he;var ge,fe,be;i(860);let me=Object(o.a)((be=fe=class e extends r.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.C)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Object(U.O)(n,c.e.Instance.overlayStore.numbers.formatTypeX)){const t=Object(U.F)(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Object(U.l)(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&13!==t.keyCode)return;const i=Object(U.C)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Object(U.O)(n,c.e.Instance.overlayStore.numbers.formatTypeY)){const t=Object(U.F)(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Object(U.l)(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}}}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||i.regionType!==k.a.RegionType.POINT)return null;const n=i.center,r=Object(U.C)(this.props.wcsInfo,n);let o,l;i.coordinate===c.K.Image?(o=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),l=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(o=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(e)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),l=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(t)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const u=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(r)}`:`Image: ${d.Point2D.ToString(n,"px",3)}`,p=i.coordinate===c.K.Image?Object(h.jsx)("span",{className:s.a.TEXT_MUTED,children:"(px)"}):"";return Object(h.jsxs)("div",{className:"form-section point-region-form",children:[Object(h.jsx)(a.q,{children:"Properties"}),Object(h.jsx)("div",{className:"form-contents",children:Object(h.jsx)("table",{children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Region Name"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(a.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Coordinate"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(pe,{region:i,disableCooridnate:!this.props.wcsInfo})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Center ",p]}),Object(h.jsx)("td",{children:o}),Object(h.jsx)("td",{children:l}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:u})})]})]})})})]})}},fe.REGION_PIXEL_EPS=.001,ge=be))||ge;var ye,Oe,je,Se;i(861);const xe=13;let Ce=Object(o.a)((Se=je=class e extends r.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=Object(U.C)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Object(U.O)(n,c.e.Instance.overlayStore.numbers.formatTypeX)){const t=Object(U.F)(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Object(U.l)(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=Object(U.C)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Object(U.O)(n,c.e.Instance.overlayStore.numbers.formatTypeY)){const t=Object(U.F)(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Object(U.l)(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleWidthChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=r},this.handleWidthWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.x)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.L)(i)),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=this.sizeWCS.x},this.handleHeightChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=r},this.handleHeightWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.y)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.L)(i)),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=this.sizeWCS.y},this.handleLeftValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.x+n.x/2,o={x:(t+r)/2,y:i.y},s={x:Math.abs(t-r),y:n.y};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleLeftChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.bottomLeftPoint.x;this.handleLeftValueChange(i,n)||(e.currentTarget.value=n)},this.handleLeftWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=Object(U.C)(this.props.wcsInfo,this.bottomLeftPoint),i=e.currentTarget.value;if(i!==t.x){if(Object(U.O)(i,c.e.Instance.overlayStore.numbers.formatTypeX)){const e=Object(U.F)(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.bottomLeftPoint.x;if(this.handleLeftValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleBottomValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.y+n.y/2,o={x:i.x,y:(t+r)/2},s={x:n.x,y:Math.abs(t-r)};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleBottomChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.bottomLeftPoint.y;this.handleBottomValueChange(i,n)||(e.currentTarget.value=n)},this.handleBottomWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=Object(U.C)(this.props.wcsInfo,this.bottomLeftPoint),i=e.currentTarget.value;if(i!==t.y){if(Object(U.O)(i,c.e.Instance.overlayStore.numbers.formatTypeY)){const e=Object(U.F)(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.bottomLeftPoint.y;if(this.handleBottomValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRightValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.x-n.x/2,o={x:(t+r)/2,y:i.y},s={x:Math.abs(t-r),y:n.y};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleRightChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.topRightPoint.x;this.handleRightValueChange(i,n)||(e.currentTarget.value=n)},this.handleRightWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=Object(U.C)(this.props.wcsInfo,this.topRightPoint),i=e.currentTarget.value;if(i!==t.x){if(Object(U.O)(i,c.e.Instance.overlayStore.numbers.formatTypeX)){const e=Object(U.F)(this.props.wcsInfo,{x:i,y:t.y}).x,n=this.topRightPoint.x;if(this.handleRightValueChange(e,n))return}e.currentTarget.value=t.x}},this.handleTopValueChange=(t,i)=>{if(isFinite(t)&&isFinite(i)&&!Object(U.l)(t,i,e.REGION_PIXEL_EPS)){const e=this.props.region,i=e.center,n=e.size,r=i.y-n.y/2,o={x:i.x,y:(t+r)/2},s={x:n.x,y:Math.abs(t-r)};if(s.x>0&&s.y>0)return e.setControlPoints([o,s]),!0}return!1},this.handleTopChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=e.currentTarget.value,i=parseFloat(t),n=this.topRightPoint.y;this.handleTopValueChange(i,n)||(e.currentTarget.value=n)},this.handleTopWCSChange=e=>{if("keydown"===e.type&&e.keyCode!==xe)return;const t=Object(U.C)(this.props.wcsInfo,this.topRightPoint),i=e.currentTarget.value;if(i!==t.y){if(Object(U.O)(i,c.e.Instance.overlayStore.numbers.formatTypeY)){const e=Object(U.F)(this.props.wcsInfo,{x:t.x,y:i}).y,n=this.topRightPoint.y;if(this.handleTopValueChange(e,n))return}e.currentTarget.value=t.y}},this.handleRotationChange=t=>{if("keydown"===t.type&&t.keyCode!==xe)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get topRightPoint(){const e=this.props.region;if(!e||2!==e.controlPoints.length)return{x:NaN,y:NaN};const t=e.center,i=e.size;return{x:t.x+i.x/2,y:t.y+i.y/2}}get bottomLeftPoint(){const e=this.props.region;if(!e||2!==e.controlPoints.length)return{x:NaN,y:NaN};const t=e.center,i=e.size;return{x:t.x-i.x/2,y:t.y-i.y/2}}get sizeWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?{x:Object(U.u)(i.x,c.S),y:Object(U.u)(i.y,c.S)}:null}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||2!==i.controlPoints.length||i.regionType!==k.a.RegionType.RECTANGLE)return null;const n=i.center,r=Object(U.C)(this.props.wcsInfo,n);let o,l;i.coordinate===c.K.Image?(o=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),l=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(o=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(e)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),l=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(t)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const u=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(r)}`:`Image: ${d.Point2D.ToString(n,"px",3)}`,p=Math.abs(i.rotation)>.001,g=Object(U.C)(this.props.wcsInfo,this.bottomLeftPoint);let f,b;i.coordinate===c.K.Image?(f=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.bottomLeftPoint.x,onBlur:this.handleLeftChange,onKeyDown:this.handleLeftChange,disabled:p}),b=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.bottomLeftPoint.y,onBlur:this.handleBottomChange,onKeyDown:this.handleBottomChange,disabled:p})):(f=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(e)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!g||p,value:g?g.x:"",onBlur:this.handleLeftWCSChange,onKeyDown:this.handleLeftWCSChange})}),b=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(t)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!g||p,value:g?g.y:"",onBlur:this.handleBottomWCSChange,onKeyDown:this.handleBottomWCSChange})}));const m=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(g)}`:`Image: ${d.Point2D.ToString(this.bottomLeftPoint,"px",3)}`,y=Object(U.C)(this.props.wcsInfo,this.topRightPoint);let O,j;i.coordinate===c.K.Image?(O=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:this.topRightPoint.x,onBlur:this.handleRightChange,onKeyDown:this.handleRightChange,disabled:p}),j=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:this.topRightPoint.y,onBlur:this.handleTopChange,onKeyDown:this.handleTopChange,disabled:p})):(O=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(e)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!y||p,value:y?y.x:"",onBlur:this.handleRightWCSChange,onKeyDown:this.handleRightWCSChange})}),j=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(t)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!y||p,value:y?y.y:"",onBlur:this.handleTopWCSChange,onKeyDown:this.handleTopWCSChange})}));const S=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(y)}`:`Image: ${d.Point2D.ToString(this.topRightPoint,"px",3)}`,x=i.size;let C,I;i.coordinate===c.K.Image?(C=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Width",value:x.x,onBlur:this.handleWidthChange,onKeyDown:this.handleWidthChange}),I=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Height",value:x.y,onBlur:this.handleHeightChange,onKeyDown:this.handleHeightChange})):(C=Object(h.jsx)(a.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Width",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.x:"",onBlur:this.handleWidthWCSChange,onKeyDown:this.handleWidthWCSChange})}),I=Object(h.jsx)(a.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Height",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.y:"",onBlur:this.handleHeightWCSChange,onKeyDown:this.handleHeightWCSChange})}));const w=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(this.sizeWCS)}`:`Image: ${d.Point2D.ToString(x,"px",3)}`,T=i.coordinate===c.K.Image?Object(h.jsx)("span",{className:s.a.TEXT_MUTED,children:"(px)"}):"";return Object(h.jsxs)("div",{className:"form-section rectangular-region-form",children:[Object(h.jsx)(a.q,{children:"Properties"}),Object(h.jsx)("div",{className:"form-contents",children:Object(h.jsx)("table",{children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Region Name"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(a.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Coordinate"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(pe,{region:i,disableCooridnate:!this.props.wcsInfo})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Center ",T]}),Object(h.jsx)("td",{children:o}),Object(h.jsx)("td",{children:l}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:u})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Size ",T]}),Object(h.jsx)("td",{children:C}),Object(h.jsx)("td",{children:I}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:w})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Bottom Left ",T]}),Object(h.jsx)("td",{children:f}),Object(h.jsx)("td",{children:b}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:m})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Top Right ",T]}),Object(h.jsx)("td",{children:O}),Object(h.jsx)("td",{children:j}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:S})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["P.A. ",Object(h.jsx)("span",{className:s.a.TEXT_MUTED,children:"(deg)"})]}),Object(h.jsx)("td",{children:Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:i.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})})]})]})})})]})}},je.REGION_PIXEL_EPS=.001,Oe=Se,Object(P.a)(Oe.prototype,"topRightPoint",[F.i],Object.getOwnPropertyDescriptor(Oe.prototype,"topRightPoint"),Oe.prototype),Object(P.a)(Oe.prototype,"bottomLeftPoint",[F.i],Object.getOwnPropertyDescriptor(Oe.prototype,"bottomLeftPoint"),Oe.prototype),Object(P.a)(Oe.prototype,"sizeWCS",[F.i],Object.getOwnPropertyDescriptor(Oe.prototype,"sizeWCS"),Oe.prototype),ye=Oe))||ye;var Ie,we,Te,ve;i(862);const Ae=13;let Re=Object(o.a)((ve=Te=class e extends r.Component{constructor(...t){super(...t),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handleCenterXChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.x;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:n,y:this.props.region.center.y})},this.handleCenterYChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.center.y;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setCenter({x:this.props.region.center.x,y:n})},this.handleCenterWCSXChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=Object(U.C)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.x){if(Object(U.O)(n,c.e.Instance.overlayStore.numbers.formatTypeX)){const t=Object(U.F)(this.props.wcsInfo,{x:n,y:i.y}),r=this.props.region.center.x;if(t&&isFinite(t.x)&&!Object(U.l)(t.x,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.x}},this.handleCenterWCSYChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=Object(U.C)(this.props.wcsInfo,this.props.region.center);if(!i)return;const n=t.currentTarget.value;if(n!==i.y){if(Object(U.O)(n,c.e.Instance.overlayStore.numbers.formatTypeY)){const t=Object(U.F)(this.props.wcsInfo,{x:i.x,y:n}),r=this.props.region.center.y;if(t&&isFinite(t.y)&&!Object(U.l)(t.y,r,e.REGION_PIXEL_EPS))return void this.props.region.setCenter(t)}t.currentTarget.value=i.y}},this.handleMajorAxisChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=r},this.handleMajorAxisWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.x)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.L)(i)),r=this.props.region.size.x;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:n,y:this.props.region.size.y}):t.currentTarget.value=this.sizeWCS.x},this.handleMinorAxisChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=r},this.handleMinorAxisWCSChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;if(!this.sizeWCS)return;const i=t.currentTarget.value;if(i===this.sizeWCS.y)return;const n=this.props.frame.getImageValueFromArcsec(Object(U.L)(i)),r=this.props.region.size.y;isFinite(n)&&n>0&&!Object(U.l)(n,r,e.REGION_PIXEL_EPS)?this.props.region.setSize({x:this.props.region.size.x,y:n}):t.currentTarget.value=this.sizeWCS.y},this.handleRotationChange=t=>{if("keydown"===t.type&&t.keyCode!==Ae)return;const i=t.currentTarget.value,n=parseFloat(i),r=this.props.region.rotation;!isFinite(n)||Object(U.l)(n,r,e.REGION_PIXEL_EPS)?t.currentTarget.value=r:this.props.region.setRotation(n)}}get sizeWCS(){const e=this.props.region;if(!e||2!==e.controlPoints.length||!e.size||!this.props.frame)return null;const t=this.props.region.size,i=this.props.frame.getWcsSizeInArcsec(t);return i?{x:Object(U.u)(i.x,c.S),y:Object(U.u)(i.y,c.S)}:null}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||2!==i.controlPoints.length||i.regionType!==k.a.RegionType.ELLIPSE)return null;const n=i.center,r=Object(U.C)(this.props.wcsInfo,n);let o,l;i.coordinate===c.K.Image?(o=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:n.x,onBlur:this.handleCenterXChange,onKeyDown:this.handleCenterXChange}),l=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:n.y,onBlur:this.handleCenterYChange,onKeyDown:this.handleCenterYChange})):(o=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(e)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.x:"",onBlur:this.handleCenterWCSXChange,onKeyDown:this.handleCenterWCSXChange})}),l=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(t)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!r,value:r?r.y:"",onBlur:this.handleCenterWCSYChange,onKeyDown:this.handleCenterWCSYChange})}));const u=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(r)}`:`Image: ${d.Point2D.ToString(n,"px",3)}`,p=i.size;let g,f;i.coordinate===c.K.Image?(g=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Semi-major",value:p.x,onBlur:this.handleMajorAxisChange,onKeyDown:this.handleMajorAxisChange}),f=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Semi-minor",value:p.y,onBlur:this.handleMinorAxisChange,onKeyDown:this.handleMinorAxisChange})):(g=Object(h.jsx)(a.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Semi-major",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.x:"",onBlur:this.handleMajorAxisWCSChange,onKeyDown:this.handleMajorAxisWCSChange})}),f=Object(h.jsx)(a.W,{content:"Format: arcsec(\"), arcmin('), or degrees(deg)",position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Semi-minor",disabled:!this.props.wcsInfo,value:this.sizeWCS?this.sizeWCS.y:"",onBlur:this.handleMinorAxisWCSChange,onKeyDown:this.handleMinorAxisWCSChange})}));const b=i.coordinate===c.K.Image?`(Semi-major, Semi-minor): ${d.WCSPoint2D.ToString(this.sizeWCS)}`:`Image: ${d.Point2D.ToString(p,"px",3)}`,m=i.coordinate===c.K.Image?Object(h.jsx)("span",{className:s.a.TEXT_MUTED,children:"(px)"}):"";return Object(h.jsxs)("div",{className:"form-section elliptical-region-form",children:[Object(h.jsx)(a.q,{children:"Properties"}),Object(h.jsx)("div",{className:"form-contents",children:Object(h.jsx)("table",{children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Region Name"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(a.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Coordinate"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(pe,{region:i,disableCooridnate:!this.props.wcsInfo})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Center ",m]}),Object(h.jsx)("td",{children:o}),Object(h.jsx)("td",{children:l}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:u})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Axes ",m]}),Object(h.jsx)("td",{children:g}),Object(h.jsx)("td",{children:f}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:b})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["P.A. ",Object(h.jsx)("span",{className:s.a.TEXT_MUTED,children:"(deg)"})]}),Object(h.jsx)("td",{children:Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"P.A.",value:i.rotation,onBlur:this.handleRotationChange,onKeyDown:this.handleRotationChange})})]})]})})})]})}},Te.REGION_PIXEL_EPS=.001,we=ve,Object(P.a)(we.prototype,"sizeWCS",[F.i],Object.getOwnPropertyDescriptor(we.prototype,"sizeWCS"),we.prototype),Ie=we))||Ie;var Pe,Ee,Fe;i(863);let Me=Object(o.a)((Fe=Ee=class e extends r.Component{constructor(...t){super(...t),this.handleLineWidthChange=E.throttle((e=>{this.props.region&&this.props.region.setLineWidth(Math.max(c.N.MIN_LINE_WIDTH,Math.min(c.N.MAX_LINE_WIDTH,e)))}),e.APPEARANCE_CHANGE_DELAY),this.handleDashLengthChange=E.throttle((e=>{this.props.region&&this.props.region.setDashLength(Math.max(0,Math.min(c.N.MAX_DASH_LENGTH,e)))}),e.APPEARANCE_CHANGE_DELAY)}render(){const e=this.props.region;return e&&e.isValid?Object(h.jsxs)("div",{className:"form-section appearance-form",children:[Object(h.jsx)(a.q,{children:"Appearance"}),Object(h.jsxs)("div",{className:"form-contents",children:[Object(h.jsx)(a.p,{label:"Color",inline:!0,children:Object(h.jsx)(le.c,{color:e.color,presetColors:U.e,setColor:t=>e.setColor(t.hex),disableAlpha:!0,darkTheme:this.props.darkTheme})}),e.regionType!==k.a.RegionType.POINT&&Object(h.jsx)(a.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(h.jsx)(le.n,{placeholder:"Line Width",min:c.N.MIN_LINE_WIDTH,max:c.N.MAX_LINE_WIDTH,value:e.lineWidth,stepSize:.5,onValueChange:this.handleLineWidthChange})}),e.regionType!==k.a.RegionType.POINT&&Object(h.jsx)(a.p,{inline:!0,label:"Dash Length",labelInfo:"(px)",children:Object(h.jsx)(le.n,{placeholder:"Dash Length",min:0,max:c.N.MAX_DASH_LENGTH,value:e.dashLength,stepSize:1,onValueChange:this.handleDashLengthChange})})]})]}):null}},Ee.APPEARANCE_CHANGE_DELAY=100,Pe=Fe))||Pe;var ke,De,Ne,Le,_e;i(864);let ze=Object(o.a)((_e=Le=class e extends r.Component{constructor(t){super(t),Object(R.a)(this,"displayColorPicker",Ne,this),this.handleNameChange=e=>{this.props.region.setName(e.currentTarget.value)},this.handlePointChange=(t,i,n)=>{if("keydown"===n.type&&13!==n.keyCode)return;const r=this.props.region,o=n.currentTarget.value,s=parseFloat(o),a=i?r.controlPoints[t].x:r.controlPoints[t].y;!isFinite(s)||Object(U.l)(s,a,e.REGION_PIXEL_EPS)?n.currentTarget.value=a:i?this.props.region.setControlPoint(t,{x:s,y:this.props.region.controlPoints[t].y}):this.props.region.setControlPoint(t,{x:this.props.region.controlPoints[t].x,y:s})},this.handleWCSPointChange=(t,i,n)=>{if("keydown"===n.type&&13!==n.keyCode)return;const r=this.props.region,o=Object(U.C)(this.props.wcsInfo,r.controlPoints[t]);if(!o)return;const s=n.currentTarget.value;if(s!==(i?o.x:o.y)){if(Object(U.O)(s,i?c.e.Instance.overlayStore.numbers.formatTypeX:c.e.Instance.overlayStore.numbers.formatTypeY)){const n=Object(U.F)(this.props.wcsInfo,i?{x:s,y:o.y}:{x:o.x,y:s});if(!n)return;const a=i?n.x:n.y,l=i?r.controlPoints[t].x:r.controlPoints[t].y;if(isFinite(a)&&!Object(U.l)(a,l,e.REGION_PIXEL_EPS))return void this.props.region.setControlPoint(t,n)}n.currentTarget.value=i?o.x:o.y}},Object(F.p)(this)}render(){c.e.Instance.overlayStore.global.explicitSystem;const e=c.e.Instance.overlayStore.numbers.formatTypeX,t=c.e.Instance.overlayStore.numbers.formatTypeY,i=this.props.region;if(!i||!i.isValid||i.regionType!==k.a.RegionType.POLYGON)return null;const n=i.coordinate===c.K.Image?Object(h.jsx)("span",{className:s.a.TEXT_MUTED,children:"(px)"}):"",r=i.controlPoints.map(((r,o)=>{const s=Object(U.C)(this.props.wcsInfo,r);let l,u;i.coordinate===c.K.Image?(l=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"X Coordinate",value:r.x,onBlur:e=>this.handlePointChange(o,!0,e),onKeyDown:e=>this.handlePointChange(o,!0,e)}),u=Object(h.jsx)(le.n,{selectAllOnFocus:!0,buttonPosition:"none",placeholder:"Y Coordinate",value:r.y,onBlur:e=>this.handlePointChange(o,!1,e),onKeyDown:e=>this.handlePointChange(o,!1,e)})):(l=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(e)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"X WCS Coordinate",disabled:!this.props.wcsInfo||!s,value:s?s.x:"",onBlur:e=>this.handleWCSPointChange(o,!0,e),onKeyDown:e=>this.handleWCSPointChange(o,!0,e)})}),u=Object(h.jsx)(a.W,{content:`Format: ${c.B.get(t)}`,position:M.a.BOTTOM,hoverOpenDelay:300,children:Object(h.jsx)(le.n,{allowNumericCharactersOnly:!1,buttonPosition:"none",placeholder:"Y WCS Coordinate",disabled:!this.props.wcsInfo||!s,value:s?s.y:"",onBlur:e=>this.handleWCSPointChange(o,!1,e),onKeyDown:e=>this.handleWCSPointChange(o,!1,e)})}));const p=i.coordinate===c.K.Image?`WCS: ${d.WCSPoint2D.ToString(s)}`:`Image: ${d.Point2D.ToString(r,"px",3)}`;return Object(h.jsxs)("tr",{children:[Object(h.jsxs)("td",{children:["Point ",o," ",n]}),Object(h.jsx)("td",{children:l}),Object(h.jsx)("td",{children:u}),Object(h.jsx)("td",{children:Object(h.jsx)("span",{className:"info-string",children:p})})]},o)}));return Object(h.jsxs)("div",{className:"form-section polygon-region-form",children:[Object(h.jsx)(a.q,{children:"Properties"}),Object(h.jsx)("div",{className:"form-contents",children:Object(h.jsx)("table",{children:Object(h.jsxs)("tbody",{children:[Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Region Name"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(a.x,{placeholder:"Enter a region name",value:i.name,onChange:this.handleNameChange})})]}),Object(h.jsxs)("tr",{children:[Object(h.jsx)("td",{children:"Coordinate"}),Object(h.jsx)("td",{colSpan:2,children:Object(h.jsx)(pe,{region:i,disableCooridnate:!this.props.wcsInfo})})]}),r]})})})]})}},Le.REGION_PIXEL_EPS=.001,De=_e,Ne=Object(P.a)(De.prototype,"displayColorPicker",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke=De))||ke;var We,Ge,Ve,Be=i(53);i(865);let He=Object(o.a)((Ve=Ge=class e extends r.Component{constructor(...e){super(...e),this.handleDeleteClicked=()=>{const e=c.e.Instance;e.dialogStore.hideRegionDialog(),e.activeFrame&&e.activeFrame.regionSet.selectedRegion&&e.deleteRegion(e.activeFrame.regionSet.selectedRegion)},this.handleFocusClicked=()=>c.e.Instance.activeFrame.regionSet.selectedRegion.focusCenter()}render(){const t=c.e.Instance,i={icon:"info-sign",backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!0,lazy:!0,isOpen:t.dialogStore.regionDialogVisible,onClose:t.dialogStore.hideRegionDialog,className:"region-dialog",canEscapeKeyClose:!0,title:"No region selected"};let n,o,d=!1;if(t.activeFrame&&t.activeFrame.regionSet.selectedRegion)if(0===t.activeFrame.regionSet.selectedRegion.regionId)n=e.InvalidRegionNode;else{var u;o=t.activeFrame.regionSet.selectedRegion;const s=null!==(u=t.activeFrame.spatialReference)&&void 0!==u?u:t.activeFrame;switch(i.title=`Editing ${o.nameString} (${s.filename})`,o.regionType){case k.a.RegionType.POINT:n=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(Me,{region:o,darkTheme:t.darkTheme}),Object(h.jsx)(me,{region:o,wcsInfo:s.validWcs?s.wcsInfoForTransformation:0})]}),d=!0;break;case k.a.RegionType.RECTANGLE:n=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(Me,{region:o,darkTheme:t.darkTheme}),Object(h.jsx)(Ce,{region:o,frame:s,wcsInfo:s.validWcs?s.wcsInfoForTransformation:0})]}),d=!0;break;case k.a.RegionType.ELLIPSE:n=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(Me,{region:o,darkTheme:t.darkTheme}),Object(h.jsx)(Re,{region:o,frame:s,wcsInfo:s.validWcs?s.wcsInfoForTransformation:0})]}),d=!0;break;case k.a.RegionType.POLYGON:n=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(Me,{region:o,darkTheme:t.darkTheme}),Object(h.jsx)(ze,{region:o,wcsInfo:s.validWcs?s.wcsInfoForTransformation:0})]}),d=!0;break;default:n=e.InvalidRegionNode}}else n=e.MissingRegionNode;let p=o&&0!==o.regionId&&Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.W,{content:"Region is "+(o.locked?"locked":"unlocked"),children:Object(h.jsx)(a.b,{intent:l.a.WARNING,minimal:!0,icon:o.locked?"lock":"unlock",onClick:o.toggleLock})}),Object(h.jsx)(a.W,{content:"Focus",children:Object(h.jsx)(a.b,{intent:l.a.WARNING,minimal:!0,icon:Object(h.jsx)(Be.a,{icon:"center"}),onClick:this.handleFocusClicked})})]});return Object(h.jsxs)(b,{dialogProps:i,helpType:c.x.REGION_DIALOG,defaultWidth:775,defaultHeight:475,minHeight:300,minWidth:400,enableResizing:!0,children:[Object(h.jsx)("div",{className:s.a.DIALOG_BODY,children:n}),Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER,children:Object(h.jsxs)("div",{className:s.a.DIALOG_FOOTER_ACTIONS,children:[p,d&&Object(h.jsx)(a.b,{intent:l.a.DANGER,icon:"trash",text:"Delete",onClick:this.handleDeleteClicked}),Object(h.jsx)(a.b,{intent:l.a.NONE,onClick:t.dialogStore.hideRegionDialog,text:"Close"})]})})]})}},Ge.MissingRegionNode=Object(h.jsx)(a.C,{icon:"folder-open",title:"No region selected",description:"Select a region using the list or image view"}),Ge.InvalidRegionNode=Object(h.jsx)(a.C,{icon:"error",title:"Region not supported",description:"The selected region does not have any editable properties"}),We=Ve))||We;var qe,Ye,Ue,Xe,$e,Ke=i(43),Qe=i.n(Ke),Ze=i(424),Je=i(169),et=i(75);i(866);!function(e){e[e.GLOBAL=0]="GLOBAL",e[e.RENDER_CONFIG=1]="RENDER_CONFIG",e[e.CONTOUR_CONFIG=2]="CONTOUR_CONFIG",e[e.OVERLAY_CONFIG=3]="OVERLAY_CONFIG",e[e.REGION=4]="REGION",e[e.PERFORMANCE=5]="PERFORMANCE",e[e.LOG_EVENT=6]="LOG_EVENT",e[e.CATALOG=7]="CATALOG"}($e||($e={}));const tt=Ze.a.ofType();let it=Object(o.a)((Ye=class extends r.Component{constructor(e){super(e),Object(R.a)(this,"selectedTab",Ue,this),Object(R.a)(this,"setSelectedTab",Xe,this),this.renderPercentileSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(h.jsx)(a.B,{text:e+"%",onClick:t},e),this.handleImageCompressionQualityChange=E.throttle((e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_IMAGE_COMPRESSION_QUALITY,e)}),100),this.handleAnimationCompressionQualityChange=E.throttle((e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_ANIMATION_COMPRESSION_QUALITY,e)}),100),this.handleGPUTileCacheChange=E.throttle((e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_GPU_TILE_CACHE,e)}),100),this.handleSystemTileCacheChange=E.throttle((e=>{c.H.Instance.setPreference(c.G.PERFORMANCE_SYSTEM_TILE_CACHE,e)}),100),this.reset=()=>{const e=c.H.Instance;switch(this.selectedTab){case $e.RENDER_CONFIG:e.resetRenderConfigSettings();break;case $e.CONTOUR_CONFIG:e.resetContourConfigSettings();break;case $e.OVERLAY_CONFIG:e.resetOverlayConfigSettings();break;case $e.REGION:e.resetRegionSettings();break;case $e.PERFORMANCE:e.resetPerformanceSettings();break;case $e.LOG_EVENT:e.resetLogEventSettings();break;case $e.CATALOG:e.resetCatalogSettings();break;case $e.GLOBAL:default:e.resetGlobalSettings()}},Object(F.p)(this)}render(){const e=c.e.Instance,t=e.preferenceStore,i=e.layoutStore,n=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.p,{inline:!0,label:"Theme",children:Object(h.jsxs)(a.r,{value:t.theme,onChange:t=>e.preferenceStore.setPreference(c.G.GLOBAL_THEME,t.currentTarget.value),children:[Object(h.jsx)("option",{value:d.Theme.AUTO,children:"Automatic"}),Object(h.jsx)("option",{value:d.Theme.LIGHT,children:"Light"}),Object(h.jsx)("option",{value:d.Theme.DARK,children:"Dark"})]})}),Object(h.jsx)(a.p,{inline:!0,label:"Auto-launch File Browser",children:Object(h.jsx)(a.P,{checked:t.autoLaunch,onChange:e=>t.setPreference(c.G.GLOBAL_AUTOLAUNCH,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"Initial Layout",children:Object(h.jsx)(a.r,{value:t.layout,onChange:e=>t.setPreference(c.G.GLOBAL_LAYOUT,e.currentTarget.value),children:i.orderedLayoutNames.map((e=>Object(h.jsx)("option",{value:e,children:e},e)))})}),Object(h.jsx)(a.p,{inline:!0,label:"Initial Cursor Position",children:Object(h.jsxs)(a.L,{selectedValue:t.cursorPosition,onChange:e=>t.setPreference(c.G.GLOBAL_CURSOR_POSITION,e.currentTarget.value),inline:!0,children:[Object(h.jsx)(a.K,{label:"Fixed",value:d.CursorPosition.FIXED}),Object(h.jsx)(a.K,{label:"Tracking",value:d.CursorPosition.TRACKING})]})}),Object(h.jsx)(a.p,{inline:!0,label:"Initial Zoom Level",children:Object(h.jsxs)(a.L,{selectedValue:t.zoomMode,onChange:e=>t.setPreference(c.G.GLOBAL_ZOOM_MODE,e.currentTarget.value),inline:!0,children:[Object(h.jsx)(a.K,{label:"Zoom to fit",value:d.Zoom.FIT}),Object(h.jsx)(a.K,{label:"Zoom to 1.0x",value:d.Zoom.FULL})]})}),Object(h.jsx)(a.p,{inline:!0,label:"Zoom to",children:Object(h.jsxs)(a.L,{selectedValue:t.zoomPoint,onChange:e=>t.setPreference(c.G.GLOBAL_ZOOM_POINT,e.currentTarget.value),inline:!0,children:[Object(h.jsx)(a.K,{label:"Cursor",value:d.ZoomPoint.CURSOR}),Object(h.jsx)(a.K,{label:"Current Center",value:d.ZoomPoint.CENTER})]})}),Object(h.jsx)(a.p,{inline:!0,label:"Enable drag-to-pan",children:Object(h.jsx)(a.P,{checked:t.dragPanning,onChange:e=>t.setPreference(c.G.GLOBAL_DRAG_PANNING,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"WCS matching on append",children:Object(h.jsxs)(a.r,{value:t.autoWCSMatching,onChange:e=>t.setPreference(c.G.GLOBAL_AUTO_WCS_MATCHING,Number(e.currentTarget.value)),children:[Object(h.jsx)("option",{value:d.WCSMatchingType.NONE,children:"None"}),Object(h.jsx)("option",{value:d.WCSMatchingType.SPATIAL,children:"Spatial Only"}),Object(h.jsx)("option",{value:d.WCSMatchingType.SPECTRAL,children:"Spectral Only"}),Object(h.jsx)("option",{value:d.WCSMatchingType.SPATIAL|d.WCSMatchingType.SPECTRAL,children:"Spatial and Spectral"})]})}),Object(h.jsx)(a.p,{inline:!0,label:"Spectral Matching",children:Object(h.jsx)(a.r,{value:t.spectralMatchingType,onChange:e=>t.setPreference(c.G.GLOBAL_SPECTRAL_MATCHING_TYPE,e.currentTarget.value),children:d.SPECTRAL_MATCHING_TYPES.map((e=>Object(h.jsx)("option",{value:e,children:d.SPECTRAL_TYPE_STRING.get(e)},e)))})}),Object(h.jsx)(a.p,{inline:!0,label:"Tranparent Image Background",children:Object(h.jsx)(a.P,{checked:t.transparentImageBackground,onChange:e=>t.setPreference(c.G.GLOBAL_TRANSPARENT_IMAGE_BACKGROUND,e.currentTarget.checked)})})]}),o=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.p,{inline:!0,label:"Default Scaling",children:Object(h.jsx)(Je.b,{selectedItem:t.scaling,onItemSelect:e=>t.setPreference(c.G.RENDER_CONFIG_SCALING,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Color Map",children:Object(h.jsx)(le.d,{inverted:!1,selectedItem:t.colormap,onItemSelect:e=>t.setPreference(c.G.RENDER_CONFIG_COLORMAP,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Percentile Ranks",children:Object(h.jsx)(tt,{activeItem:t.percentile.toString(10),onItemSelect:e=>t.setPreference(c.G.RENDER_CONFIG_PERCENTILE,Number(e)),popoverProps:{minimal:!0,position:"auto"},filterable:!1,items:c.O.PERCENTILE_RANKS.map(String),itemRenderer:this.renderPercentileSelectItem,children:Object(h.jsx)(a.e,{text:t.percentile.toString(10)+"%",rightIcon:"double-caret-vertical",alignText:"right"})})}),(t.scaling===c.u.LOG||t.scaling===c.u.POWER)&&Object(h.jsx)(a.p,{label:"Alpha",inline:!0,children:Object(h.jsx)(le.n,{buttonPosition:"none",value:t.scalingAlpha,onValueChange:e=>t.setPreference(c.G.RENDER_CONFIG_SCALING_ALPHA,e)})}),t.scaling===c.u.GAMMA&&Object(h.jsx)(a.p,{label:"Gamma",inline:!0,children:Object(h.jsx)(le.n,{min:c.O.GAMMA_MIN,max:c.O.GAMMA_MAX,stepSize:.1,minorStepSize:.01,majorStepSize:.5,value:t.scalingGamma,onValueChange:e=>t.setPreference(c.G.RENDER_CONFIG_SCALING_GAMMA,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"NaN Color",children:Object(h.jsx)(le.c,{color:Qe()(t.nanColorHex).setAlpha(t.nanAlpha).toRgb(),presetColors:[...U.e,"transparent"],setColor:e=>{t.setPreference(c.G.RENDER_CONFIG_NAN_COLOR_HEX,"transparent"===e.hex?"#000000":e.hex),t.setPreference(c.G.RENDER_CONFIG_NAN_ALPHA,e.rgb.a)},disableAlpha:!1,darkTheme:e.darkTheme})})]}),s=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.p,{inline:!0,label:"Generator Type",children:Object(h.jsx)(a.r,{value:t.contourGeneratorType,options:Object.keys(c.p).map((e=>({label:c.p[e],value:c.p[e]}))),onChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_GENERATOR_TYPE,e.currentTarget.value)})}),Object(h.jsx)(a.p,{inline:!0,label:"Smoothing Mode",children:Object(h.jsxs)(a.r,{value:t.contourSmoothingMode,onChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_SMOOTHING_MODE,Number(e.currentTarget.value)),children:[Object(h.jsx)("option",{value:k.a.SmoothingMode.NoSmoothing,children:"No Smoothing"},k.a.SmoothingMode.NoSmoothing),Object(h.jsx)("option",{value:k.a.SmoothingMode.BlockAverage,children:"Block"},k.a.SmoothingMode.BlockAverage),Object(h.jsx)("option",{value:k.a.SmoothingMode.GaussianBlur,children:"Gaussian"},k.a.SmoothingMode.GaussianBlur)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Smoothing Factor",children:Object(h.jsx)(le.n,{placeholder:"Default Smoothing Factor",min:1,max:33,value:t.contourSmoothingFactor,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_SMOOTHING_FACTOR,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Contour Levels",children:Object(h.jsx)(le.n,{placeholder:"Default Contour Levels",min:1,max:15,value:t.contourNumLevels,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_NUM_LEVELS,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Thickness",children:Object(h.jsx)(le.n,{placeholder:"Thickness",min:.5,max:10,value:t.contourThickness,majorStepSize:.5,stepSize:.5,onValueChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_THICKNESS,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Color Mode",children:Object(h.jsxs)(a.r,{value:t.contourColormapEnabled?1:0,onChange:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_COLORMAP_ENABLED,parseInt(e.currentTarget.value)>0),children:[Object(h.jsx)("option",{value:0,children:"Constant Color"},0),Object(h.jsx)("option",{value:1,children:"Color-mapped"},1)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Color Map",children:Object(h.jsx)(le.d,{inverted:!1,selectedItem:t.contourColormap,onItemSelect:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_COLORMAP,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Default Color",children:Object(h.jsx)(le.c,{color:t.contourColor,presetColors:U.e,setColor:e=>t.setPreference(c.G.CONTOUR_CONFIG_CONTOUR_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})})]}),u=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.p,{inline:!0,label:"AST Color",children:Object(h.jsx)(et.a,{selectedItem:t.astColor,onItemSelect:e=>t.setPreference(c.G.WCS_OVERLAY_AST_COLOR,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"AST Grid Visible",children:Object(h.jsx)(a.P,{checked:t.astGridVisible,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_AST_GRID_VISIBLE,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"AST Label Visible",children:Object(h.jsx)(a.P,{checked:t.astLabelsVisible,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_AST_LABELS_VISIBLE,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"WCS Format",children:Object(h.jsx)(a.r,{options:[d.WCSType.AUTOMATIC,d.WCSType.DEGREES,d.WCSType.SEXAGESIMAL],value:t.wcsType,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_WCS_TYPE,e.currentTarget.value)})}),Object(h.jsx)(a.p,{inline:!0,label:"Beam Visible",children:Object(h.jsx)(a.P,{checked:t.beamVisible,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_VISIBLE,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"Beam Color",children:Object(h.jsx)(le.c,{color:Qe()(t.beamColor).toRgb(),presetColors:U.e,setColor:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})}),Object(h.jsx)(a.p,{inline:!0,label:"Beam Type",children:Object(h.jsxs)(a.r,{value:t.beamType,onChange:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_TYPE,e.currentTarget.value),children:[Object(h.jsx)("option",{value:c.f.Open,children:"Open"},0),Object(h.jsx)("option",{value:c.f.Solid,children:"Solid"},1)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Beam Width",labelInfo:"(px)",children:Object(h.jsx)(le.n,{placeholder:"Beam Width",min:.5,max:10,value:t.beamWidth,stepSize:.5,minorStepSize:.1,majorStepSize:1,onValueChange:e=>t.setPreference(c.G.WCS_OVERLAY_BEAM_WIDTH,e)})})]});let p=[];c.N.AVAILABLE_REGION_TYPES.forEach(((e,t)=>{p.push(Object(h.jsx)("option",{value:t,children:e},t))}));const g=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.p,{inline:!0,label:"Color",children:Object(h.jsx)(le.c,{color:t.regionColor,presetColors:U.e,setColor:e=>t.setPreference(c.G.REGION_COLOR,e.hex),disableAlpha:!0,darkTheme:e.darkTheme})}),Object(h.jsx)(a.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(h.jsx)(le.n,{placeholder:"Line Width",min:c.N.MIN_LINE_WIDTH,max:c.N.MAX_LINE_WIDTH,value:t.regionLineWidth,stepSize:.5,onValueChange:e=>t.setPreference(c.G.REGION_LINE_WIDTH,Math.max(c.N.MIN_LINE_WIDTH,Math.min(c.N.MAX_LINE_WIDTH,e)))})}),Object(h.jsx)(a.p,{inline:!0,label:"Dash Length",labelInfo:"(px)",children:Object(h.jsx)(le.n,{placeholder:"Dash Length",min:0,max:c.N.MAX_DASH_LENGTH,value:t.regionDashLength,stepSize:1,onValueChange:e=>t.setPreference(c.G.REGION_DASH_LENGTH,Math.max(0,Math.min(c.N.MAX_DASH_LENGTH,e)))})}),Object(h.jsx)(a.p,{inline:!0,label:"Region Type",children:Object(h.jsx)(a.r,{value:t.regionType,onChange:e=>t.setPreference(c.G.REGION_TYPE,Number(e.currentTarget.value)),children:p})}),Object(h.jsx)(a.p,{inline:!0,label:"Region size",labelInfo:"(px)",children:Object(h.jsx)(le.n,{placeholder:"Region size",min:1,value:t.regionSize,stepSize:1,onValueChange:e=>t.setPreference(c.G.REGION_SIZE,Math.max(1,e))})}),Object(h.jsx)(a.p,{inline:!0,label:"Creation Mode",children:Object(h.jsxs)(a.L,{selectedValue:t.regionCreationMode,onChange:e=>t.setPreference(c.G.REGION_CREATION_MODE,e.currentTarget.value),children:[Object(h.jsx)(a.K,{label:"Center to corner",value:d.RegionCreationMode.CENTER}),Object(h.jsx)(a.K,{label:"Corner to corner",value:d.RegionCreationMode.CORNER})]})})]}),f=Object(h.jsxs)(r.Fragment,{children:[Object(h.jsx)(a.p,{inline:!0,label:"Low bandwidth mode",children:Object(h.jsx)(a.P,{checked:t.lowBandwidthMode,onChange:e=>t.setPreference(c.G.PERFORMANCE_LOW_BAND_WIDTH_MODE,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"Compression Quality",labelInfo:"(Images)",children:Object(h.jsx)(le.n,{placeholder:"Compression Quality",min:d.CompressionQuality.IMAGE_MIN,max:d.CompressionQuality.IMAGE_MAX,value:t.imageCompressionQuality,stepSize:d.CompressionQuality.IMAGE_STEP,onValueChange:this.handleImageCompressionQualityChange})}),Object(h.jsx)(a.p,{inline:!0,label:"Compression Quality",labelInfo:"(Animation)",children:Object(h.jsx)(le.n,{placeholder:"Compression Quality",min:d.CompressionQuality.ANIMATION_MIN,max:d.CompressionQuality.ANIMATION_MAX,value:t.animationCompressionQuality,stepSize:d.CompressionQuality.ANIMATION_STEP,onValueChange:this.handleAnimationCompressionQualityChange})}),Object(h.jsx)(a.p,{inline:!0,label:"GPU Tile Cache Size",children:Object(h.jsx)(le.n,{placeholder:"GPU Tile Cache Size",min:d.TileCache.GPU_MIN,max:d.TileCache.GPU_MAX,value:t.gpuTileCache,majorStepSize:d.TileCache.GPU_STEP,stepSize:d.TileCache.GPU_STEP,onValueChange:this.handleGPUTileCacheChange})}),Object(h.jsx)(a.p,{inline:!0,label:"System Tile Cache Size",children:Object(h.jsx)(le.n,{placeholder:"System Tile Cache Size",min:d.TileCache.SYSTEM_MIN,max:d.TileCache.SYSTEM_MAX,value:t.systemTileCache,majorStepSize:d.TileCache.SYSTEM_STEP,stepSize:d.TileCache.SYSTEM_STEP,onValueChange:this.handleSystemTileCacheChange})}),Object(h.jsx)(a.p,{inline:!0,label:"Contour Rounding Factor",children:Object(h.jsx)(le.n,{placeholder:"Contour Rounding Factor",min:1,max:32,value:t.contourDecimation,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_DECIMATION,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Contour Compression Level",children:Object(h.jsx)(le.n,{placeholder:"Contour Compression Level",min:0,max:19,value:t.contourCompressionLevel,majorStepSize:1,stepSize:1,onValueChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_COMPRESSION_LEVEL,e)})}),Object(h.jsx)(a.p,{inline:!0,label:"Contour Chunk Size",children:Object(h.jsxs)(a.r,{value:t.contourChunkSize,onChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_CHUNK_SIZE,parseInt(e.currentTarget.value)),children:[Object(h.jsx)("option",{value:25e3,children:"25K"},0),Object(h.jsx)("option",{value:5e4,children:"50K"},1),Object(h.jsx)("option",{value:1e5,children:"100K"},2),Object(h.jsx)("option",{value:25e4,children:"250K"},3),Object(h.jsx)("option",{value:5e5,children:"500K"},4),Object(h.jsx)("option",{value:1e6,children:"1M"},5)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Contour Control Map Resolution",children:Object(h.jsxs)(a.r,{value:t.contourControlMapWidth,onChange:e=>t.setPreference(c.G.PERFORMANCE_CONTOUR_CONTROL_MAP_WIDTH,parseInt(e.currentTarget.value)),children:[Object(h.jsx)("option",{value:128,children:"128\xd7128 (128 KB)"},0),Object(h.jsx)("option",{value:256,children:"256\xd7256 (512 KB)"},1),Object(h.jsx)("option",{value:512,children:"512\xd7512 (2 MB)"},2),Object(h.jsx)("option",{value:1024,children:"1024\xd71024 (8 MB)"},3)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Stream image tiles while zooming",children:Object(h.jsx)(a.P,{checked:t.streamContoursWhileZooming,onChange:e=>t.setPreference(c.G.PERFORMANCE_STREAM_CONTOURS_WHILE_ZOOMING,e.currentTarget.checked)})}),Object(h.jsx)(a.p,{inline:!0,label:"Stop animation playback in",children:Object(h.jsxs)(a.r,{value:t.stopAnimationPlaybackMinutes,onChange:e=>t.setPreference(c.G.PERFORMANCE_STOP_ANIMATION_PLAYBACK_MINUTES,parseInt(e.currentTarget.value)),children:[Object(h.jsx)("option",{value:5,children:"5 minutes"},0),Object(h.jsx)("option",{value:10,children:"10 minutes"},1),Object(h.jsx)("option",{value:15,children:"15 minutes"},2),Object(h.jsx)("option",{value:20,children:"20 minutes"},3),Object(h.jsx)("option",{value:30,children:"30 minutes"},4)]})})]}),m=Object(h.jsxs)("div",{className:"log-event-panel",children:[Object(h.jsx)(a.p,{inline:!0,label:"Enable logged event type",className:"log-event-header",children:Object(h.jsx)(a.g,{label:"Select all",checked:t.isSelectingAllLogEvents,indeterminate:t.isSelectingIndeterminateLogEvents,onChange:()=>t.selectAllLogEvents()})}),Object(h.jsx)(a.p,{inline:!1,className:"log-event-list",children:d.Event.EVENT_TYPES.map((e=>Object(h.jsx)(a.g,{className:"log-event-checkbox",checked:t.isEventLoggingEnabled(e),label:d.Event.getEventNameFromType(e),onChange:()=>t.setPreference(c.G.LOG_EVENT,e)},e)))})]}),y=Object(h.jsx)("div",{className:"panel-container",children:Object(h.jsx)(a.p,{inline:!0,label:"Displayed columns",children:Object(h.jsx)(le.n,{placeholder:"Default Displayed Columns",min:1,value:t.catalogDisplayedColumnSize,stepSize:1,onValueChange:e=>t.setPreference(c.G.CATALOG_DISPLAYED_COLUMN_SIZE,e)})})});let O="preference-dialog";e.darkTheme&&(O+=" bp3-dark");const j={icon:"wrench",backdropClassName:"minimal-dialog-backdrop",className:O,canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.preferenceDialogVisible,onClose:e.dialogStore.hidePreferenceDialog,title:"Preferences"};return Object(h.jsxs)(b,{dialogProps:j,helpType:c.x.PREFERENCES,minWidth:450,minHeight:300,defaultWidth:775,defaultHeight:500,enableResizing:!0,children:[Object(h.jsx)("div",{className:"bp3-dialog-body",children:Object(h.jsxs)(a.R,{id:"preferenceTabs",vertical:!0,selectedTabId:this.selectedTab,onChange:this.setSelectedTab,children:[Object(h.jsx)(a.Q,{id:$e.GLOBAL,title:"Global",panel:n}),Object(h.jsx)(a.Q,{id:$e.RENDER_CONFIG,title:"Render Configuration",panel:o}),Object(h.jsx)(a.Q,{id:$e.CONTOUR_CONFIG,title:"Contour Configuration",panel:s}),Object(h.jsx)(a.Q,{id:$e.OVERLAY_CONFIG,title:"Overlay Configuration",panel:u}),Object(h.jsx)(a.Q,{id:$e.CATALOG,title:"Catalog",panel:y}),Object(h.jsx)(a.Q,{id:$e.REGION,title:"Region",panel:g}),Object(h.jsx)(a.Q,{id:$e.PERFORMANCE,title:"Performance",panel:f}),Object(h.jsx)(a.Q,{id:$e.LOG_EVENT,title:"Log Events",panel:m})]})}),Object(h.jsx)("div",{className:"bp3-dialog-footer",children:Object(h.jsxs)("div",{className:"bp3-dialog-footer-actions",children:[Object(h.jsx)(a.W,{content:"Apply to current tab only.",position:M.a.TOP,children:Object(h.jsx)(a.b,{intent:l.a.WARNING,icon:"refresh",onClick:this.reset,text:"Restore defaults"})}),Object(h.jsx)(a.e,{intent:l.a.NONE,onClick:e.dialogStore.hidePreferenceDialog,text:"Close"})]})})]})}},Ue=Object(P.a)(Ye.prototype,"selectedTab",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return $e.GLOBAL}}),Xe=Object(P.a)(Ye.prototype,"setSelectedTab",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.selectedTab=e}}}),qe=Ye))||qe;var nt,rt,ot;i(867);let st=Object(o.a)((rt=class extends r.Component{constructor(e){super(e),Object(R.a)(this,"layoutName",ot,this),this.handleInput=e=>{this.layoutName=e.currentTarget.value},this.clearInput=()=>{this.layoutName=""},this.handleKeyDown=e=>{13!==e.keyCode||this.isEmpty||this.saveLayout()},this.saveLayout=()=>{const e=c.e.Instance;e.dialogStore.hideSaveLayoutDialog(),e.layoutStore.setLayoutToBeSaved(this.layoutName),e.layoutStore.layoutExists(this.layoutName)?d.PresetLayout.isPreset(this.layoutName)?e.alertStore.showAlert("Layout name cannot be the same as system presets."):e.alertStore.showInteractiveAlert(`Are you sure to overwrite the existing layout ${this.layoutName}?`,(t=>{t&&e.layoutStore.saveLayout()})):e.layoutStore.saveLayout(),this.clearInput()},Object(F.p)(this)}get isEmpty(){return!this.layoutName}render(){const e=c.e.Instance;let t="preference-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"layout-grid",backdropClassName:"minimal-dialog-backdrop",className:t,canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.saveLayoutDialogVisible,onClose:e.dialogStore.hideSaveLayoutDialog,title:"Save Layout"};return Object(h.jsxs)(b,{dialogProps:i,helpType:c.x.SAVE_LAYOUT,defaultWidth:400,defaultHeight:185,enableResizing:!0,children:[Object(h.jsx)("div",{className:s.a.DIALOG_BODY,children:Object(h.jsx)(a.p,{inline:!0,label:"Save current layout as:",children:Object(h.jsx)(a.x,{className:"layout-name-input",placeholder:"Enter layout name",value:this.layoutName,autoFocus:!0,onChange:this.handleInput,onKeyDown:this.handleKeyDown})})}),Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER,children:Object(h.jsxs)("div",{className:s.a.DIALOG_FOOTER_ACTIONS,children:[Object(h.jsx)(a.W,{content:"Layout name cannot be empty!",disabled:!this.isEmpty,children:Object(h.jsx)(a.b,{intent:l.a.PRIMARY,onClick:this.saveLayout,text:"Save",disabled:this.isEmpty})}),Object(h.jsx)(a.e,{intent:l.a.NONE,text:"Close",onClick:()=>{e.dialogStore.hideSaveLayoutDialog(),this.clearInput()}})]})})]})}},ot=Object(P.a)(rt.prototype,"layoutName",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(P.a)(rt.prototype,"isEmpty",[F.i],Object.getOwnPropertyDescriptor(rt.prototype,"isEmpty"),rt.prototype),nt=rt))||nt;var at;i(868);let lt=Object(o.a)(at=class extends r.Component{render(){const e=c.e.Instance;let t="file-info-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"app-header",className:t,backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:e.dialogStore.fileInfoDialogVisible,onClose:e.dialogStore.hideFileInfoDialog,title:"File Header"};return Object(h.jsx)(b,{dialogProps:i,helpType:c.x.FILE_INFO,minWidth:400,minHeight:400,defaultWidth:800,defaultHeight:600,enableResizing:!0,children:Object(h.jsx)("div",{className:"bp3-dialog-body",children:Object(h.jsx)(D.a,{infoTypes:[D.b.IMAGE_FILE,D.b.IMAGE_HEADER],fileInfoExtended:e.activeFrame?e.activeFrame.frameInfo.fileInfoExtended:null,regionFileInfo:"",catalogFileInfo:null,selectedTab:e.dialogStore.selectedFileInfoDialogTab,handleTabChange:e.dialogStore.setSelectedFileInfoDialogTab,isLoading:!1,errorMessage:""})})})}})||at;var ct,dt=i(74);i(869);const ut=Ze.a.ofType();let ht=Object(o.a)(ct=class extends r.Component{constructor(...e){super(...e),this.renderDashModeSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(h.jsx)(a.B,{text:c.o[e],onClick:t},e)}render(){const e=this.props.frame;return Object(h.jsxs)("div",{className:"contour-style-panel",children:[Object(h.jsx)(a.p,{inline:!0,label:"Thickness",children:Object(h.jsx)(le.n,{placeholder:"Thickness",min:.5,max:10,value:e.contourConfig.thickness,majorStepSize:.5,stepSize:.5,onValueChange:e.contourConfig.setThickness})}),Object(h.jsx)(a.p,{inline:!0,label:"Dashes",children:Object(h.jsx)(ut,{activeItem:e.contourConfig.dashMode,onItemSelect:e.contourConfig.setDashMode,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:[c.o.None,c.o.Dashed,c.o.NegativeOnly],itemRenderer:this.renderDashModeSelectItem,children:Object(h.jsx)(a.e,{text:c.o[e.contourConfig.dashMode],rightIcon:"double-caret-vertical",alignText:"right"})})}),Object(h.jsx)(a.p,{inline:!0,label:"Color Mode",children:Object(h.jsxs)(a.r,{value:e.contourConfig.colormapEnabled?1:0,onChange:t=>e.contourConfig.setColormapEnabled(parseInt(t.currentTarget.value)>0),children:[Object(h.jsx)("option",{value:0,children:"Constant Color"},0),Object(h.jsx)("option",{value:1,children:"Color-mapped"},1)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Color Map",disabled:!e.contourConfig.colormapEnabled,children:Object(h.jsx)(le.d,{inverted:!1,disabled:!e.contourConfig.colormapEnabled,selectedItem:e.contourConfig.colormap,onItemSelect:e.contourConfig.setColormap})}),Object(h.jsx)(a.p,{inline:!0,label:"Bias",disabled:!e.contourConfig.colormapEnabled,children:Object(h.jsx)(le.n,{disabled:!e.contourConfig.colormapEnabled,placeholder:"Bias",min:-1,max:1,value:e.contourConfig.colormapBias,majorStepSize:.1,stepSize:.1,onValueChange:e.contourConfig.setColormapBias})}),Object(h.jsx)(a.p,{inline:!0,label:"Contrast",disabled:!e.contourConfig.colormapEnabled,children:Object(h.jsx)(le.n,{disabled:!e.contourConfig.colormapEnabled,placeholder:"Contrast",min:0,max:3,value:e.contourConfig.colormapContrast,majorStepSize:.1,stepSize:.1,onValueChange:e.contourConfig.setColormapContrast})}),Object(h.jsx)(a.p,{inline:!0,label:"Color",disabled:e.contourConfig.colormapEnabled,children:Object(h.jsx)(le.c,{color:e.contourConfig.color,presetColors:U.e,setColor:t=>e.contourConfig.setColor(t.rgb),disableAlpha:!0,disabled:e.contourConfig.colormapEnabled,darkTheme:this.props.darkTheme})})]})}})||ct;var pt,gt,ft,bt,mt,yt,Ot,jt,St,xt,Ct,It,wt,Tt,vt,At,Rt,Pt;i(870);const Et=Ze.a.ofType();let Ft=Object(o.a)((gt=class extends r.Component{get minValue(){return void 0===this.enteredMinValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Object(U.E)(this.props.frame.renderConfig.contourHistogram,[.1])[0]:this.enteredMinValue}get maxValue(){return void 0===this.enteredMaxValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Object(U.E)(this.props.frame.renderConfig.contourHistogram,[99.9])[0]:this.enteredMaxValue}constructor(e){super(e),Object(R.a)(this,"generator",ft,this),Object(R.a)(this,"numLevels",bt,this),Object(R.a)(this,"enteredMinValue",mt,this),Object(R.a)(this,"enteredMaxValue",yt,this),Object(R.a)(this,"scalingType",Ot,this),this.generateMinMaxLevels=()=>{if(isFinite(this.minValue)&&isFinite(this.maxValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[(this.maxValue+this.minValue)/2];{const e=this.maxValue-this.minValue,t=this.numLevels-1,i=[];for(let n=0;n<this.numLevels;n++){const r=Object(U.gb)(n/t,this.scalingType);i.push(this.minValue+e*r)}return i}}return[]},Object(R.a)(this,"enteredStartValue",jt,this),Object(R.a)(this,"enteredStepValue",St,this),Object(R.a)(this,"multiplierValue",xt,this),this.generateStartStepLevels=()=>{if(isFinite(this.startValue)&&isFinite(this.stepValue)&&isFinite(this.multiplierValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[this.startValue];{let e=this.stepValue,t=this.startValue;const i=[];for(let n=0;n<this.numLevels;n++)i.push(t),t+=e,e*=this.multiplierValue;return i}}return[]},Object(R.a)(this,"enteredRefValue",Ct,this),Object(R.a)(this,"lowerPercentage",It,this),Object(R.a)(this,"upperPercentage",wt,this),this.generatePercentageRefLevels=()=>{if(isFinite(this.upperPercentage)&&isFinite(this.lowerPercentage)&&isFinite(this.refValue)&&isFinite(this.numLevels)){if(this.numLevels<=1)return[this.refValue];{const e=(this.upperPercentage-this.lowerPercentage)/(this.numLevels-1),t=[];for(let i=0;i<this.numLevels;i++)t.push(this.refValue*(this.lowerPercentage+e*i)/100);return t}}return[]},Object(R.a)(this,"enteredMeanValue",Tt,this),Object(R.a)(this,"enteredSigmaValue",vt,this),Object(R.a)(this,"sigmaLevels",At,this),Object(R.a)(this,"handleLevelAdded",Rt,this),Object(R.a)(this,"handleLevelRemoved",Pt,this),this.generateMeanSigmaLevels=()=>this.sigmaLevels.map((e=>this.meanValue+this.sigmaValue*e)).filter((e=>isFinite(e))),this.renderGeneratorSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(h.jsx)(a.B,{text:e,onClick:t},e),this.generateLevels=()=>{switch(this.generator){case c.p.MinMaxNScaling:this.props.onLevelsGenerated(this.generateMinMaxLevels());break;case c.p.StartStepMultiplier:this.props.onLevelsGenerated(this.generateStartStepLevels());break;case c.p.PercentagesRefValue:this.props.onLevelsGenerated(this.generatePercentageRefLevels());break;case c.p.MeanSigmaList:this.props.onLevelsGenerated(this.generateMeanSigmaLevels())}},Object(F.p)(this)}renderMinMaxParameterRow(){return this.props.frame?Object(h.jsxs)("div",{className:"parameter-container",children:[Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(le.b,{label:"Min",value:this.minValue,onValueChanged:e=>this.enteredMinValue=e,onValueCleared:()=>this.enteredMinValue=void 0,displayExponential:!0}),Object(h.jsx)(le.b,{label:"Max",value:this.maxValue,onValueChanged:e=>this.enteredMaxValue=e,onValueCleared:()=>this.enteredMaxValue=void 0,displayExponential:!0})]}),Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(a.p,{label:"N",inline:!0,children:Object(h.jsx)(le.n,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})}),Object(h.jsx)(a.p,{label:"Scaling",inline:!0,children:Object(h.jsx)(le.o,{selectedItem:this.scalingType,onItemSelect:e=>this.scalingType=e})})]})]}):null}get startValue(){return void 0===this.enteredStartValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.mean+5*this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredStartValue}get stepValue(){return void 0===this.enteredStepValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?4*this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredStepValue}renderStartStepParameterRow(){return this.props.frame?Object(h.jsxs)("div",{className:"parameter-container",children:[Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(le.b,{label:"Start",value:this.startValue,onValueChanged:e=>this.enteredStartValue=e,onValueCleared:()=>this.enteredStartValue=void 0,displayExponential:!0}),Object(h.jsx)(le.b,{label:"Step",value:this.stepValue,onValueChanged:e=>this.enteredStepValue=e,onValueCleared:()=>this.enteredStepValue=void 0,displayExponential:!0})]}),Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(a.p,{label:"N",inline:!0,children:Object(h.jsx)(le.n,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})}),Object(h.jsx)(a.p,{label:"Multiplier",inline:!0,children:Object(h.jsx)(le.n,{value:this.multiplierValue,min:.1,stepSize:1,className:"narrow",onValueChange:e=>this.multiplierValue=e})})]})]}):null}get refValue(){return void 0===this.enteredRefValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram?Object(U.E)(this.props.frame.renderConfig.contourHistogram,[99.9])[0]:this.enteredRefValue}renderPercentageRefParameterRow(){return this.props.frame?Object(h.jsxs)("div",{className:"parameter-container",children:[Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(le.b,{label:"Reference",value:this.refValue,onValueChanged:e=>this.enteredRefValue=e,onValueCleared:()=>this.enteredRefValue=void 0,displayExponential:!0}),Object(h.jsx)(a.p,{label:"N",inline:!0,children:Object(h.jsx)(le.n,{value:this.numLevels,min:1,max:20,stepSize:1,className:"narrow",onValueChange:e=>this.numLevels=Math.floor(e)})})]}),Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(a.p,{label:"Upper (%)",inline:!0,children:Object(h.jsx)(le.n,{value:this.upperPercentage,min:0,max:100,stepSize:1,className:"narrow",onValueChange:e=>this.upperPercentage=e})}),Object(h.jsx)(a.p,{label:"Lower (%)",inline:!0,children:Object(h.jsx)(le.n,{value:this.lowerPercentage,min:0,max:100,stepSize:1,className:"narrow",onValueChange:e=>this.lowerPercentage=e})})]})]}):null}get meanValue(){return void 0===this.enteredMeanValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.mean:this.enteredMeanValue}get sigmaValue(){return void 0===this.enteredSigmaValue&&this.props.frame&&this.props.frame.renderConfig.contourHistogram&&this.props.frame.renderConfig.contourHistogram.stdDev>0?this.props.frame.renderConfig.contourHistogram.stdDev:this.enteredSigmaValue}renderMeanSigmaParameterRow(){return this.props.frame?Object(h.jsxs)("div",{className:"parameter-container",children:[Object(h.jsxs)("div",{className:"parameter-line",children:[Object(h.jsx)(le.b,{label:"Mean",value:this.meanValue,onValueChanged:e=>this.enteredMeanValue=e,onValueCleared:()=>this.enteredMeanValue=void 0,displayExponential:!0}),Object(h.jsx)(le.b,{label:"Sigma",value:this.sigmaValue,onValueChanged:e=>this.enteredSigmaValue=e,onValueCleared:()=>this.enteredSigmaValue=void 0,displayExponential:!0})]}),Object(h.jsx)("div",{className:"parameter-line",children:Object(h.jsx)(a.p,{label:"Sigma List",inline:!0,children:Object(h.jsx)(a.T,{addOnBlur:!0,fill:!0,tagProps:{minimal:!0},onAdd:this.handleLevelAdded,onRemove:this.handleLevelRemoved,values:this.sigmaLevels.map((e=>e.toString()))})})})]}):null}render(){if(!this.props.frame)return null;let e;switch(this.generator){case c.p.MinMaxNScaling:e=this.renderMinMaxParameterRow();break;case c.p.StartStepMultiplier:e=this.renderStartStepParameterRow();break;case c.p.PercentagesRefValue:e=this.renderPercentageRefParameterRow();break;case c.p.MeanSigmaList:e=this.renderMeanSigmaParameterRow()}return Object(h.jsxs)("div",{className:"contour-generator-panel",children:[Object(h.jsxs)("div",{className:"generator-select-row",children:[Object(h.jsx)(a.p,{label:"Generator",inline:!0,children:Object(h.jsx)(Et,{activeItem:this.generator,popoverProps:le.m,filterable:!1,items:[c.p.StartStepMultiplier,c.p.MinMaxNScaling,c.p.PercentagesRefValue,c.p.MeanSigmaList],onItemSelect:e=>this.generator=e,itemRenderer:this.renderGeneratorSelectItem,children:Object(h.jsx)(a.e,{text:this.generator,rightIcon:"double-caret-vertical",alignText:"right"})})}),Object(h.jsx)(a.e,{intent:"success",className:"generate-button",onClick:this.generateLevels,children:"Generate"})]}),Object(h.jsx)("div",{className:"generator-parameters-row",children:Object(h.jsx)(a.p,{label:"Parameters",inline:!0,children:e})})]})}},ft=Object(P.a)(gt.prototype,"generator",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return this.props.generatorType?this.props.generatorType:c.p.StartStepMultiplier}}),bt=Object(P.a)(gt.prototype,"numLevels",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),mt=Object(P.a)(gt.prototype,"enteredMinValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yt=Object(P.a)(gt.prototype,"enteredMaxValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ot=Object(P.a)(gt.prototype,"scalingType",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c.u.LINEAR}}),Object(P.a)(gt.prototype,"minValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"minValue"),gt.prototype),Object(P.a)(gt.prototype,"maxValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"maxValue"),gt.prototype),jt=Object(P.a)(gt.prototype,"enteredStartValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St=Object(P.a)(gt.prototype,"enteredStepValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xt=Object(P.a)(gt.prototype,"multiplierValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Object(P.a)(gt.prototype,"startValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"startValue"),gt.prototype),Object(P.a)(gt.prototype,"stepValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"stepValue"),gt.prototype),Ct=Object(P.a)(gt.prototype,"enteredRefValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=Object(P.a)(gt.prototype,"lowerPercentage",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 20}}),wt=Object(P.a)(gt.prototype,"upperPercentage",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 100}}),Object(P.a)(gt.prototype,"refValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"refValue"),gt.prototype),Tt=Object(P.a)(gt.prototype,"enteredMeanValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=Object(P.a)(gt.prototype,"enteredSigmaValue",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=Object(P.a)(gt.prototype,"sigmaLevels",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[-5,5,9,13,17]}}),Object(P.a)(gt.prototype,"meanValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"meanValue"),gt.prototype),Object(P.a)(gt.prototype,"sigmaValue",[F.i],Object.getOwnPropertyDescriptor(gt.prototype,"sigmaValue"),gt.prototype),Rt=Object(P.a)(gt.prototype,"handleLevelAdded",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{try{for(const t of e){const e=parseFloat(t);isFinite(e)&&this.sigmaLevels.push(e)}}catch(t){console.log(t)}}}}),Pt=Object(P.a)(gt.prototype,"handleLevelRemoved",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.sigmaLevels=this.sigmaLevels.filter(((e,i)=>i!==t))}}}),pt=gt))||pt;var Mt,kt,Dt,Nt,Lt,_t,zt,Wt,Gt,Vt,Bt,Ht,qt,Yt,Ut=i(12);i(871);!function(e){e[e.Levels=0]="Levels",e[e.Configuration=1]="Configuration",e[e.Styling=2]="Styling"}(Yt||(Yt={}));const Xt=Ze.a.ofType(),$t=Ze.a.ofType();let Kt=Object(o.a)((qt=Ht=class e extends r.Component{constructor(e){super(e),Object(R.a)(this,"showCubeHistogramAlert",Dt,this),Object(R.a)(this,"currentTab",Nt,this),Object(R.a)(this,"levels",Lt,this),Object(R.a)(this,"smoothingMode",_t,this),Object(R.a)(this,"smoothingFactor",zt,this),this.widgetStore=void 0,this.cachedFrame=void 0,this.cachedHistogram=void 0,this.renderDataSourceSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>e?Object(h.jsx)(a.B,{text:e.filename,onClick:t},e.frameInfo.fileId):null,this.renderHistogramSelectItem=(e,{handleClick:t,modifiers:i,query:n})=>Object(h.jsx)(a.B,{text:e?"Per-Cube":"Per-Channel",onClick:t},e?"cube":"channel"),this.handleHistogramChange=e=>{const t=c.e.Instance;t&&t.contourDataSource&&(e&&!t.contourDataSource.renderConfig.cubeHistogram?t.contourDataSource.frameInfo.fileFeatureFlags&k.a.FileFeatureFlags.CUBE_HISTOGRAMS?this.handleAlertConfirm():this.showCubeHistogramAlert=!0:t.contourDataSource.renderConfig.setUseCubeHistogramContours(e))},this.handleAlertConfirm=()=>{const e=c.e.Instance,t=e.contourDataSource;t&&t.renderConfig&&(t.renderConfig.setUseCubeHistogramContours(!0),t.renderConfig.cubeHistogramProgress<1&&e.requestCubeHistogram(t.frameInfo.fileId)),this.showCubeHistogramAlert=!1},this.handleAlertCancel=()=>{this.showCubeHistogramAlert=!1},this.handleCubeHistogramCancelled=()=>{const e=c.e.Instance,t=e.contourDataSource;t&&t.renderConfig&&t.renderConfig.setUseCubeHistogramContours(!1),e.cancelCubeHistogramRequest(t.frameInfo.fileId)},this.handleApplyContours=()=>{const e=c.e.Instance.contourDataSource;e&&(e.contourConfig.setContourConfiguration(this.levels.slice(),this.smoothingMode,this.smoothingFactor),e.applyContours())},this.handleClearContours=()=>{const e=c.e.Instance;e.contourDataSource&&e.contourDataSource.clearContours()},this.handleGraphClicked=e=>{this.levels.push(e)},this.handleGraphRightClicked=e=>{let t=-1,i=Number.MAX_VALUE;for(let n=0;n<this.levels.length;n++){const r=Math.abs(e-this.levels[n]);r<i&&(i=r,t=n)}t>=0&&(this.levels=this.levels.filter(((e,i)=>i!==t)))},Object(R.a)(this,"handleLevelAdded",Wt,this),Object(R.a)(this,"handleLevelRemoved",Gt,this),Object(R.a)(this,"handleLevelDragged",Vt,this),Object(R.a)(this,"handleLevelsGenerated",Bt,this),Object(F.p)(this),this.widgetStore=new Ut.n,this.setDefaultContourParameters(),Object(F.h)((()=>{const e=c.e.Instance;if(e.contourDataSource){const t=e.contourDataSource.renderConfig.contourHistogram;t!==this.cachedHistogram&&(this.cachedHistogram=t,this.widgetStore.clearXYBounds())}const t=this.widgetStore;if(t){const e=this.plotData;e&&t.initXYBoundaries(e.xMin,e.xMax,e.yMin,e.yMax)}}))}setDefaultContourParameters(){const e=c.e.Instance,t=e.contourDataSource;t?(this.levels=t.contourConfig.levels.slice(),this.smoothingMode=t.contourConfig.smoothingMode,this.smoothingFactor=t.contourConfig.smoothingFactor):(this.levels=[],this.smoothingMode=e.preferenceStore.contourSmoothingMode,this.smoothingFactor=e.preferenceStore.contourSmoothingFactor)}componentDidUpdate(){const e=c.e.Instance;e.contourDataSource!==this.cachedFrame&&(this.cachedFrame=e.contourDataSource,this.widgetStore.clearXYBounds(),this.setDefaultContourParameters())}get contourConfigChanged(){const e=c.e.Instance.contourDataSource;if(e){const t=this.levels.length;if(e.contourConfig.smoothingMode!==this.smoothingMode)return!0;if(e.contourConfig.smoothingFactor!==this.smoothingFactor)return!0;if(e.contourConfig.levels.length!==t)return!0;for(let i=0;i<t;i++)if(e.contourConfig.levels[i]!==this.levels[i])return!0}return!1}get plotData(){const e=c.e.Instance.contourDataSource;if(e&&e.renderConfig.contourHistogram&&e.renderConfig.contourHistogram.bins&&e.renderConfig.contourHistogram.bins.length){const t=e.renderConfig.contourHistogram;let i=0,n=t.bins.length-1;this.widgetStore.isAutoScaledX||(i=Math.floor((this.widgetStore.minX-t.firstBinCenter)/t.binWidth),i=Object(U.k)(i,0,t.bins.length-1),n=Math.ceil((this.widgetStore.maxX-t.firstBinCenter)/t.binWidth),n=Object(U.k)(n,0,t.bins.length-1));let r,o=t.firstBinCenter+t.binWidth*i,s=t.firstBinCenter+t.binWidth*n,a=t.bins[i],l=a;const c=n-i;if(c>0&&!isNaN(c)){r=new Array(n-i);for(let e=i;e<=n;e++)r[e-i]={x:t.firstBinCenter+t.binWidth*e,y:t.bins[e]},a=Math.min(a,t.bins[e]),l=Math.max(l,t.bins[e])}return{values:r,xMin:o,xMax:s,yMin:a,yMax:l}}return null}render(){const t=c.e.Instance,i={icon:Object(h.jsx)(Be.a,{icon:"contour",size:Be.a.SIZE_LARGE}),backdropClassName:"minimal-dialog-backdrop",canOutsideClickClose:!1,lazy:!0,isOpen:t.dialogStore.contourDialogVisible,onClose:t.dialogStore.hideContourDialog,className:"contour-dialog",canEscapeKeyClose:!0,title:"Contour Configuration"};if(!t||!t.contourDataSource)return Object(h.jsx)(b,{dialogProps:i,helpType:c.x.CONTOUR,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:Object(h.jsx)(a.C,{icon:"folder-open",title:"No file loaded",description:"Load a file using the menu"})});const n=t.contourDataSource;let r="Value";n.unit&&(r=`Value (${n.unit})`);const o={xLabel:r,darkMode:t.darkTheme,logY:this.widgetStore.logScaleY,plotType:this.widgetStore.plotType,showYAxisTicks:!1,showYAxisLabel:!1,graphClicked:this.handleGraphClicked,graphRightClicked:this.handleGraphRightClicked,graphZoomedX:this.widgetStore.setXBounds,graphZoomedY:this.widgetStore.setYBounds,graphZoomedXY:this.widgetStore.setXYBounds,graphZoomReset:this.widgetStore.clearXYBounds,scrollZoom:!0,borderWidth:this.widgetStore.lineWidth,pointRadius:this.widgetStore.linePlotPointSize,zeroLineWidth:2},d=this.plotData;if(d){let e=this.widgetStore.primaryLineColor.colorHex;if(t.darkTheme&&(this.widgetStore.primaryLineColor.fixed||(e=dt.a.BLUE4)),o.lineColor=e,this.widgetStore.isAutoScaledX){const e=Math.min(d.xMin,...this.levels),t=Math.max(d.xMax,...this.levels),i=t-e;o.xMin=e-.01*i,o.xMax=t+.01*i}else o.xMin=this.widgetStore.minX,o.xMax=this.widgetStore.maxX;this.widgetStore.isAutoScaledY?(o.yMin=d.yMin,o.yMax=d.yMax):(o.yMin=this.widgetStore.minY,o.yMax=this.widgetStore.maxY),this.widgetStore.logScaleY&&o.yMin<=0&&(o.yMin=.5),o.data=d.values}const u=this.levels&&this.levels.filter((e=>isFinite(e))).length;o.markers=u?this.levels.map(((e,t)=>({value:e,id:`marker-${t}`,draggable:!0,dragMove:this.handleLevelDragged(t),horizontal:!1}))):[],this.widgetStore.meanRmsVisible&&n.renderConfig.contourHistogram&&n.renderConfig.contourHistogram.stdDev>0&&(o.markers.push({value:n.renderConfig.contourHistogram.mean,id:"marker-mean",draggable:!1,horizontal:!1,color:t.darkTheme?dt.a.GREEN4:dt.a.GREEN2,dash:[5]}),o.markers.push({value:n.renderConfig.contourHistogram.mean,id:"marker-rms",draggable:!1,horizontal:!1,width:n.renderConfig.contourHistogram.stdDev,opacity:.2,color:t.darkTheme?dt.a.GREEN4:dt.a.GREEN2}));let p=this.levels.slice().sort(((e,t)=>e-t)).map((e=>Math.abs(e)<.1?Object(U.lb)(e,2):Object(U.mb)(e,2)));const g=Object(h.jsxs)("div",{className:"contour-level-panel",children:[n.frameInfo.fileInfoExtended.depth>1&&Object(h.jsx)(a.p,{label:"Histogram",inline:!0,children:Object(h.jsx)($t,{activeItem:n.renderConfig.useCubeHistogramContours,popoverProps:le.m,filterable:!1,items:[!0,!1],onItemSelect:this.handleHistogramChange,itemRenderer:this.renderHistogramSelectItem,children:Object(h.jsx)(a.e,{text:n.renderConfig.useCubeHistogramContours?"Per-Cube":"Per-Channel",rightIcon:"double-caret-vertical",alignText:"right"})})}),Object(h.jsx)("div",{className:"histogram-plot",children:Object(h.jsx)(le.f,{...o})}),Object(h.jsx)(Ft,{frame:n,generatorType:t.preferenceStore.contourGeneratorType,onLevelsGenerated:this.handleLevelsGenerated}),Object(h.jsx)("div",{className:"contour-level-panel-levels",children:Object(h.jsx)(a.p,{label:"Levels",inline:!0,children:Object(h.jsx)(a.T,{addOnBlur:!0,fill:!0,tagProps:{minimal:!0},onAdd:this.handleLevelAdded,onRemove:this.handleLevelRemoved,values:p})})})]}),f=Object(h.jsxs)("div",{className:"contour-config-panel",children:[Object(h.jsx)(a.p,{inline:!0,label:"Smoothing Mode",children:Object(h.jsxs)(a.r,{value:this.smoothingMode,onChange:e=>this.smoothingMode=Number(e.currentTarget.value),children:[Object(h.jsx)("option",{value:k.a.SmoothingMode.NoSmoothing,children:"No Smoothing"},k.a.SmoothingMode.NoSmoothing),Object(h.jsx)("option",{value:k.a.SmoothingMode.BlockAverage,children:"Block"},k.a.SmoothingMode.BlockAverage),Object(h.jsx)("option",{value:k.a.SmoothingMode.GaussianBlur,children:"Gaussian"},k.a.SmoothingMode.GaussianBlur)]})}),Object(h.jsx)(a.p,{inline:!0,label:"Smoothing Factor",children:Object(h.jsx)(le.n,{placeholder:"Smoothing Factor",min:1,max:33,value:this.smoothingFactor,majorStepSize:1,stepSize:1,onValueChange:e=>Object(F.s)((()=>{this.smoothingFactor=e}))})})]});return Object(h.jsxs)(b,{dialogProps:i,helpType:c.x.CONTOUR,defaultWidth:e.DefaultWidth,defaultHeight:e.DefaultHeight,enableResizing:!0,children:[Object(h.jsxs)("div",{className:s.a.DIALOG_BODY,children:[Object(h.jsxs)(a.p,{inline:!0,label:"Data Source",children:[Object(h.jsx)(Xt,{activeItem:n,onItemSelect:t.setContourDataSource,popoverProps:{minimal:!0,position:"bottom"},filterable:!1,items:t.frames,itemRenderer:this.renderDataSourceSelectItem,disabled:t.animatorStore.animationActive,children:Object(h.jsx)(a.e,{text:n.filename,rightIcon:"double-caret-vertical",alignText:"right",disabled:t.animatorStore.animationActive})}),Object(h.jsx)(a.W,{content:t.frameLockedToContour?"Data source is locked to active image":"Data source is independent of active image",children:Object(h.jsx)(a.b,{className:"lock-button",icon:t.frameLockedToContour?"lock":"unlock",minimal:!0,onClick:t.toggleFrameContourLock})})]}),Object(h.jsxs)(a.R,{defaultSelectedTabId:Yt.Levels,renderActiveTabPanelOnly:!1,children:[Object(h.jsx)(a.Q,{id:Yt.Levels,title:"Levels",panel:g,panelClassName:"contour-level-panel"}),Object(h.jsx)(a.Q,{id:Yt.Configuration,title:"Configuration",panel:f,panelClassName:"contour-config-panel"}),Object(h.jsx)(a.Q,{id:Yt.Styling,title:"Styling",panel:Object(h.jsx)(ht,{frame:n,darkTheme:t.darkTheme})})]})]}),Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER,children:Object(h.jsxs)("div",{className:s.a.DIALOG_FOOTER_ACTIONS,children:[Object(h.jsx)(a.b,{intent:l.a.WARNING,onClick:this.handleClearContours,disabled:!n.contourConfig.enabled,text:"Clear"}),Object(h.jsx)(a.b,{intent:l.a.SUCCESS,onClick:this.handleApplyContours,disabled:!u||!this.contourConfigChanged&&n.contourConfig.enabled,text:"Apply"}),Object(h.jsx)(a.b,{intent:l.a.NONE,onClick:t.dialogStore.hideContourDialog,text:"Close"})]})}),Object(h.jsx)(a.a,{className:t.darkTheme?"bp3-dark":"",icon:"time",isOpen:this.showCubeHistogramAlert,onCancel:this.handleAlertCancel,onConfirm:this.handleAlertConfirm,cancelButtonText:"Cancel",children:Object(h.jsx)("p",{children:"Calculating a cube histogram may take a long time, depending on the size of the file. Are you sure you want to continue?"})}),Object(h.jsx)(ue,{isOpen:n.renderConfig.useCubeHistogramContours&&n.renderConfig.cubeHistogramProgress<1,progress:n.renderConfig.cubeHistogramProgress,timeRemaining:t.estimatedTaskRemainingTime,cancellable:!0,onCancel:this.handleCubeHistogramCancelled,text:"Calculating cube histogram"})]})}},Ht.DefaultWidth=600,Ht.DefaultHeight=660,kt=qt,Dt=Object(P.a)(kt.prototype,"showCubeHistogramAlert",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nt=Object(P.a)(kt.prototype,"currentTab",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Yt.Levels}}),Lt=Object(P.a)(kt.prototype,"levels",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_t=Object(P.a)(kt.prototype,"smoothingMode",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=Object(P.a)(kt.prototype,"smoothingFactor",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Object(P.a)(kt.prototype,"setDefaultContourParameters",[F.g],Object.getOwnPropertyDescriptor(kt.prototype,"setDefaultContourParameters"),kt.prototype),Object(P.a)(kt.prototype,"contourConfigChanged",[F.i],Object.getOwnPropertyDescriptor(kt.prototype,"contourConfigChanged"),kt.prototype),Object(P.a)(kt.prototype,"plotData",[F.i],Object.getOwnPropertyDescriptor(kt.prototype,"plotData"),kt.prototype),Wt=Object(P.a)(kt.prototype,"handleLevelAdded",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{try{for(const t of e){const e=parseFloat(t);isFinite(e)&&this.levels.push(e)}}catch(t){console.log(t)}}}}),Gt=Object(P.a)(kt.prototype,"handleLevelRemoved",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.levels=this.levels.filter(((e,i)=>i!==t))}}}),Vt=Object(P.a)(kt.prototype,"handleLevelDragged",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>t=>{e>=0&&e<this.levels.length&&(this.levels[e]=t)}}}),Bt=Object(P.a)(kt.prototype,"handleLevelsGenerated",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.levels=e.slice()}}}),Mt=kt))||Mt;var Qt,Zt,Jt,ei,ti,ii,ni=i(27);i(872);let ri=Object(o.a)((Zt=class extends r.Component{get executionEntries(){let e=this.inputString.split("\n"),t=new Array;for(let i of e){if(!i||!i.length||i.startsWith("//"))continue;const e=ni.e.FromString(i);if(!e.valid)return[];t.push(e)}return t}constructor(e){super(e),Object(R.a)(this,"inputString",Jt,this),Object(R.a)(this,"isExecuting",ei,this),Object(R.a)(this,"errorString",ti,this),Object(R.a)(this,"handleActionInput",ii,this),this.onExecuteClicked=async()=>{this.isExecuting=!0,await ni.f.Instance.executeEntries(this.executionEntries),localStorage.setItem("debugString",this.inputString),this.isExecuting=!1},Object(F.p)(this)}render(){const e=c.e.Instance;let t="debug-execution-dialog";e.darkTheme&&(t+=" bp3-dark");const i={icon:"console",className:t,canEscapeKeyClose:!0,canOutsideClickClose:!1,isOpen:e.dialogStore.debugExecutionDialogVisible,onClose:e.dialogStore.hideDebugExecutionDialog,isCloseButtonShown:!0,title:"Execute a command"},n=this.executionEntries&&this.executionEntries.length;return Object(h.jsxs)(b,{dialogProps:i,defaultWidth:700,defaultHeight:400,enableResizing:!0,children:[Object(h.jsx)("div",{className:s.a.DIALOG_BODY,children:Object(h.jsx)(a.o,{className:"input-text",onChange:this.handleActionInput,value:this.inputString,minLines:5,intent:n?"success":"warning",placeholder:"Enter execution string",multiline:!0})}),Object(h.jsx)("div",{className:s.a.DIALOG_FOOTER,children:Object(h.jsxs)("div",{className:s.a.DIALOG_FOOTER_ACTIONS,children:[Object(h.jsx)(a.b,{intent:l.a.PRIMARY,onClick:this.onExecuteClicked,disabled:!n||this.isExecuting,text:"Execute"}),Object(h.jsx)(a.b,{intent:l.a.WARNING,onClick:()=>e.backendService.scriptingStream.next(JSON.parse(this.inputString)),text:"DebugTest"}),Object(h.jsx)(a.b,{intent:l.a.NONE,onClick:e.dialogStore.hideDebugExecutionDialog,text:"Close"})]})})]})}},Jt=Object(P.a)(Zt.prototype,"inputString",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e;return null!==(e=localStorage.getItem("debugString"))&&void 0!==e?e:""}}),ei=Object(P.a)(Zt.prototype,"isExecuting",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=Object(P.a)(Zt.prototype,"errorString",[F.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Object(P.a)(Zt.prototype,"executionEntries",[F.i],Object.getOwnPropertyDescriptor(Zt.prototype,"executionEntries"),Zt.prototype),ii=Object(P.a)(Zt.prototype,"handleActionInput",[F.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.inputString=e}}}),Qt=Zt))||Qt},62:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return f})),i.d(t,"d",(function(){return b})),i.d(t,"c",(function(){return m}));var n,r,o,s,a,l,c,d=i(4),u=i(2),h=(i(28),i(1)),p=i(170);const g=-1;let f,b;!function(e){e[e.ACTIVE=-3]="ACTIVE",e[e.IMAGE=-1]="IMAGE",e[e.CURSOR=0]="CURSOR"}(f||(f={})),function(e){e[e.CLOSED=0]="CLOSED",e[e.CLOSED_AND_POINT=1]="CLOSED_AND_POINT"}(b||(b={}));let m=(n=class{constructor(e){this.appStore=void 0,Object(d.a)(this,"fileId",r,this),Object(d.a)(this,"regionIdMap",o,this),Object(d.a)(this,"type",s,this),Object(d.a)(this,"clearFrameEntry",a,this),Object(d.a)(this,"clearRegionMap",l,this),Object(d.a)(this,"setFileId",c,this),Object(h.p)(this),this.appStore=p.a.Instance,this.fileId=g,this.type=e,this.regionIdMap=new Map}setRegionId(e,t){this.regionIdMap.set(e,t)}get effectiveFrame(){return this.appStore.activeFrame&&this.appStore.frames&&this.appStore.frames.length>0?this.fileId!==g&&this.appStore.getFrame(this.fileId)?this.appStore.getFrame(this.fileId):this.appStore.activeFrame:null}get matchActiveFrame(){return this.effectiveFrame&&this.appStore.activeFrame.frameInfo.fileId===this.effectiveFrame.frameInfo.fileId}get effectiveRegionId(){if(this.effectiveFrame){const e=this.regionIdMap.get(this.fileId);if(e!==f.ACTIVE&&void 0!==e)return e;{const e=this.effectiveFrame.regionSet.selectedRegion;if(e)return this.type!==b.CLOSED||e.isClosedRegion?e.regionId:f.IMAGE}}return this.type===b.CLOSED?f.IMAGE:f.CURSOR}get matchesSelectedRegion(){if(this.matchActiveFrame){if(this.appStore.selectedRegion)return this.effectiveRegionId===this.appStore.selectedRegion.regionId;if(this.effectiveRegionId===f.CURSOR||this.effectiveRegionId===f.IMAGE)return!0}return!1}static CalculateRequirementsArray(e){const t=new Map;return e.forEach((e=>{const i=e.effectiveFrame;if(!i||!i.regionSet)return;const n=i.frameInfo.fileId,r=e.effectiveRegionId,o=i.regionSet.regions.find((e=>e.regionId===r));if(-1===r||o&&o.isClosedRegion){let e=t.get(n);e||(e=[],t.set(n,e)),-1===e.indexOf(r)&&e.push(r)}})),t}},r=Object(u.a)(n.prototype,"fileId",[h.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=Object(u.a)(n.prototype,"regionIdMap",[h.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=Object(u.a)(n.prototype,"type",[h.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=Object(u.a)(n.prototype,"clearFrameEntry",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.regionIdMap.delete(e)}}}),l=Object(u.a)(n.prototype,"clearRegionMap",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.regionIdMap.clear()}}}),Object(u.a)(n.prototype,"setRegionId",[h.g],Object.getOwnPropertyDescriptor(n.prototype,"setRegionId"),n.prototype),c=Object(u.a)(n.prototype,"setFileId",[h.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.fileId=e}}}),Object(u.a)(n.prototype,"effectiveFrame",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"effectiveFrame"),n.prototype),Object(u.a)(n.prototype,"matchActiveFrame",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"matchActiveFrame"),n.prototype),Object(u.a)(n.prototype,"effectiveRegionId",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"effectiveRegionId"),n.prototype),Object(u.a)(n.prototype,"matchesSelectedRegion",[h.i],Object.getOwnPropertyDescriptor(n.prototype,"matchesSelectedRegion"),n.prototype),n)},66:function(e,t,i){"use strict";i.d(t,"b",(function(){return u})),i.d(t,"a",(function(){return h}));var n,r=i(3),o=i(15),s=i(36),a=i(423),l=i(420),c=i(8),d=(i(856),i(0));let u;!function(e){e.IMAGE_FILE="image-file",e.IMAGE_HEADER="image-header",e.REGION_FILE="region-file",e.CATALOG_FILE="catalog-file",e.CATALOG_HEADER="catalog-header"}(u||(u={}));let h=Object(o.a)(n=class extends r.Component{constructor(...e){super(...e),this.renderInfoTabs=()=>{const e=this.props.infoTypes.map((e=>u.IMAGE_FILE===e?Object(d.jsx)(s.Q,{id:e,title:"File Information"},e):u.IMAGE_HEADER===e?Object(d.jsx)(s.Q,{id:e,title:"Header"},e):u.CATALOG_FILE===e?Object(d.jsx)(s.Q,{id:e,title:"Catalog Information"},e):u.CATALOG_HEADER===e?Object(d.jsx)(s.Q,{id:e,title:"Catalog Header"},e):Object(d.jsx)(s.Q,{id:e,title:"Region Information"},e)));return Object(d.jsx)(s.R,{id:"file-info-tabs",onChange:e=>this.props.handleTabChange(e),selectedTabId:this.props.selectedTab,children:e})},this.renderHDUList=()=>{var e;return this.props.HDUOptions&&(null===(e=this.props.HDUOptions.HDUList)||void 0===e?void 0:e.length)>1?Object(d.jsxs)(s.k,{vertical:!1,children:[Object(d.jsx)(s.m,{}),Object(d.jsx)(s.p,{inline:!0,label:"HDU",children:Object(d.jsx)(s.r,{options:this.props.HDUOptions.HDUList,onChange:e=>this.props.HDUOptions.handleSelectedHDUChange(e.currentTarget.value)})})]}):void 0},this.renderInfoPanel=()=>{if(this.props.isLoading)return Object(d.jsx)(s.C,{className:"non-ideal-state-file",icon:Object(d.jsx)(s.O,{className:"astLoadingSpinner"}),title:"Loading file info..."});if(this.props.errorMessage)return Object(d.jsx)(s.C,{className:"non-ideal-state-file",icon:"document",title:"Cannot open file!",description:this.props.errorMessage+" Select another file from the folder."});if(!this.props.fileInfoExtended&&!this.props.regionFileInfo&&!this.props.catalogFileInfo)return Object(d.jsx)(s.C,{className:"non-ideal-state-file",icon:"document",title:"No file selected.",description:"Select a file from the folder."});switch(this.props.selectedTab){case u.IMAGE_FILE:return this.renderImageHeaderList(this.props.fileInfoExtended.computedEntries);case u.IMAGE_HEADER:return this.renderImageHeaderList(this.props.fileInfoExtended.headerEntries);case u.REGION_FILE:return Object(d.jsx)(s.I,{className:"file-info-pre",children:this.props.regionFileInfo});case u.CATALOG_FILE:return Object(d.jsx)(s.I,{className:"file-info-pre",children:Object(d.jsx)(s.U,{children:this.props.catalogFileInfo.description})});case u.CATALOG_HEADER:return this.props.catalogHeaderTable?Object(d.jsx)(s.I,{className:"file-header-table",children:Object(d.jsx)(c.w,{...this.props.catalogHeaderTable})}):"";default:return""}}}renderImageHeaderList(e){const t=({index:t,style:i})=>{if(t<0||t>=(null===e||void 0===e?void 0:e.length))return null;const n=e[t];return"END"===n.name?Object(d.jsx)("div",{style:i,className:"header-name",children:`${n.name}`}):Object(d.jsxs)("div",{style:i,className:"header-entry",children:[Object(d.jsx)("span",{className:"header-name",children:n.name}),Object(d.jsxs)("span",{className:"header-value",children:[" = ",`${n.value}`]}),n.comment&&Object(d.jsxs)("span",{className:"header-comment",children:[" / ",n.comment," "]})]})},i=(null===e||void 0===e?void 0:e.length)||0;return Object(d.jsx)(l.a,{children:({height:e,width:n})=>Object(d.jsx)(a.a,{className:"header-list bp3-code-block",itemCount:i,itemSize:18,height:e,width:n,children:t})})}render(){return Object(d.jsxs)("div",{className:"file-info",children:[Object(d.jsxs)("div",{className:"file-info-panel-top",children:[this.renderInfoTabs(),this.renderHDUList()]}),this.renderInfoPanel()]})}})||n},7:function(e,t,i){"use strict";function n(e,t){if(!e||0===e.length||null===t||void 0===t||!isFinite(t))return null;const i=e.length,n=e[0].x<=e[i-1].x;if(n){if(t<=e[0].x)return{point:e[0],index:0};if(t>=e[i-1].x)return{point:e[i-1],index:i-1}}else{if(t>=e[0].x)return{point:e[0],index:0};if(t<=e[i-1].x)return{point:e[i-1],index:i-1}}let r=0,o=i-1;for(;r<=o;){let i=Math.floor((r+o)/2);if(t===e[i].x)return{point:e[i],index:i};n?t<e[i].x?o=i-1:r=i+1:t>e[i].x?o=i-1:r=i+1}if(r>=e.length||r<0||o>=e.length||o<0)return null;const s=Math.abs(e[r].x-t)<Math.abs(t-e[o].x)?r:o;return{point:e[s],index:s}}i.d(t,"i",(function(){return n})),i.d(t,"q",(function(){return r})),i.d(t,"e",(function(){return l})),i.d(t,"A",(function(){return u})),i.d(t,"jb",(function(){return h})),i.d(t,"k",(function(){return p})),i.d(t,"l",(function(){return g})),i.d(t,"bb",(function(){return f})),i.d(t,"ab",(function(){return b})),i.d(t,"W",(function(){return m})),i.d(t,"E",(function(){return y})),i.d(t,"gb",(function(){return O})),i.d(t,"j",(function(){return j})),i.d(t,"U",(function(){return S})),i.d(t,"f",(function(){return I})),i.d(t,"kb",(function(){return w})),i.d(t,"S",(function(){return T})),i.d(t,"eb",(function(){return v})),i.d(t,"P",(function(){return A})),i.d(t,"h",(function(){return E})),i.d(t,"cb",(function(){return F})),i.d(t,"fb",(function(){return M})),i.d(t,"T",(function(){return k})),i.d(t,"V",(function(){return D})),i.d(t,"n",(function(){return N})),i.d(t,"ib",(function(){return _})),i.d(t,"hb",(function(){return z})),i.d(t,"Z",(function(){return G})),i.d(t,"m",(function(){return V})),i.d(t,"g",(function(){return B})),i.d(t,"db",(function(){return H})),i.d(t,"X",(function(){return Y})),i.d(t,"Y",(function(){return U})),i.d(t,"ob",(function(){return X})),i.d(t,"R",(function(){return $})),i.d(t,"t",(function(){return K})),i.d(t,"c",(function(){return Z})),i.d(t,"b",(function(){return J})),i.d(t,"d",(function(){return ee})),i.d(t,"lb",(function(){return te})),i.d(t,"mb",(function(){return ie})),i.d(t,"x",(function(){return ne})),i.d(t,"v",(function(){return re})),i.d(t,"w",(function(){return oe})),i.d(t,"u",(function(){return se})),i.d(t,"pb",(function(){return ae})),i.d(t,"L",(function(){return le})),i.d(t,"a",(function(){return pe})),i.d(t,"G",(function(){return ge})),i.d(t,"H",(function(){return fe})),i.d(t,"Q",(function(){return be})),i.d(t,"p",(function(){return me})),i.d(t,"o",(function(){return ye})),i.d(t,"M",(function(){return Oe})),i.d(t,"O",(function(){return xe})),i.d(t,"D",(function(){return Ce})),i.d(t,"nb",(function(){return Ie})),i.d(t,"C",(function(){return we})),i.d(t,"F",(function(){return Te})),i.d(t,"J",(function(){return ve})),i.d(t,"K",(function(){return Ae})),i.d(t,"N",(function(){return Pe})),i.d(t,"y",(function(){return Ee})),i.d(t,"z",(function(){return Fe})),i.d(t,"B",(function(){return Me})),i.d(t,"s",(function(){return ke})),i.d(t,"I",(function(){return Le})),i.d(t,"r",(function(){return _e}));const r=(e,t,i)=>i.indexOf(e)===t;var o=i(81),s=i(74),a=i(5);const l=[s.a.BLUE3,s.a.GREEN3,s.a.ORANGE3,s.a.RED3,s.a.VERMILION3,s.a.ROSE3,s.a.VIOLET3,s.a.INDIGO3,s.a.COBALT3,s.a.TURQUOISE3,s.a.FOREST3,s.a.LIME3,s.a.GOLD3,s.a.SEPIA3,s.a.BLACK,s.a.DARK_GRAY3,s.a.GRAY3,s.a.LIGHT_GRAY3,s.a.WHITE];let c;const d=new Image;function u(e){const t=a.O.COLOR_MAPS_ALL.indexOf(e);if(c){var i;const e=null===(i=c)||void 0===i?void 0:i.getImageData(0,5*t+2,d.width-1,1);return{color:null===e||void 0===e?void 0:e.data,size:null===e||void 0===e?void 0:e.width}}return{color:new Uint8ClampedArray([0,0,0,0]),size:1}}function h(e,t,i,n,r){return n+(r-n)*function(e,t,i){return(e=p((e-t)/(i-t),0,1))*e*(3-2*e)}(e,t,i)}function p(e,t,i){return Math.min(i,Math.max(t,e))}function g(e,t,i=1e-6){return Math.abs(e-t)<i}function f(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))}function b(e,t){return.5*Math.atan2(t,e)*180/Math.PI}function m(e,t){return e/t*100}function y(e,t){if(!t||!t.length||!e||!e.bins.length)return[];const i=e.firstBinCenter-e.binWidth/2,n=e.binWidth,r=e.bins;let o=t.slice(),s=0,a=0;for(let c=0;c<r.length;c++)a+=r[c];if(0===a)return[];let l=[];for(let c=0;c<r.length&&o.length;c++){const e=s/a,t=(s+r[c])/a;let d=o[0]/100;for(;t>=d&&o.length;){const r=(d-e)/(t-e);l.push(i+n*(c+r)),o.shift(),d=o[0]/100}s+=r[c]}return l}function O(e,t,i=1e3,n=1.5){switch(t){case a.u.SQUARE:return e*e;case a.u.SQRT:return Math.sqrt(e);case a.u.LOG:return p(Math.log(i*e+1)/Math.log(i),0,1);case a.u.POWER:return(Math.pow(i,e)-1)/i;case a.u.GAMMA:return Math.pow(e,n);default:return e}}function j(e,t){return Math.pow(t,Math.ceil(Math.log(e)/Math.log(t)))}function S(e){if(e&&e.length){let t=-Number.MAX_VALUE,i=Number.MAX_VALUE;for(let n=e.length-1;n>=0;n--){const r=e[n];isNaN(r)||(r>t&&(t=r),r<i&&(i=r))}if(t!==-Number.MAX_VALUE&&i!==Number.MAX_VALUE)return{maxVal:t,minVal:i}}return{minVal:NaN,maxVal:NaN}}function x(e,t){return e.x*t.x+e.y*t.y}function C(e,t){return e.x*t.y-e.y*t.x}function I(e,t){return{x:e.x+t.x,y:e.y+t.y}}function w(e,t){return{x:e.x-t.x,y:e.y-t.y}}function T(e,t){return{x:.5*(e.x+t.x),y:.5*(e.y+t.y)}}function v(e,t){return{x:e.x*t,y:e.y*t}}function A(e){return Math.sqrt(x(e,e))}function R(e){const t=A(e);return{x:e.x/t,y:e.y/t}}function P(e){const t=A(e);return{mag:t,dir:{x:e.x/t,y:e.y/t}}}function E(e){let t={x:0,y:0};for(const i of e)t=I(t,i);return v(t,1/e.length)}function F(e,t){const i=Math.sin(t),n=Math.cos(t);return{x:n*e.x-i*e.y,y:i*e.x+n*e.y}}function M(e,t,i,n){return I(v(F(w(e,t),n),i),t)}function k(e){let t={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE},i={x:Number.MAX_VALUE,y:Number.MAX_VALUE};for(const n of e)!n||isNaN(n.x)||isNaN(n.y)||(t.x=Math.max(t.x,n.x),t.y=Math.max(t.y,n.y),i.x=Math.min(i.x,n.x),i.y=Math.min(i.y,n.y));return{maxPoint:t,minPoint:i}}function D(e){let t=-Number.MAX_VALUE,i=Number.MAX_VALUE;for(const n of e)n&&!isNaN(n.z)&&(t=Math.max(t,n.z),i=Math.min(i,n.z));return{maxVal:t,minVal:i}}function N(e,t,i){const n=w(i,t),r=R(n),o=x(w(e,t),r),s=I(t,v(r,o));return{point:s,bounded:o>=0&&o<=A(n),distance:A(w(e,s))}}function L(e,t,i,n){const r=w(n,i);if(C(r,w(e,n))*C(r,w(t,n))<0){const r=w(t,e);return C(r,w(i,t))*C(r,w(n,t))<0}return!1}function _(e){if(e.length<4)return!0;for(let t=0;t<e.length;t++){const i=e[t],n=e[(t+1)%e.length];for(let r=t+2;r<e.length;r++){if(L(i,n,e[r],e[(r+1)%e.length]))return!1}}return!0}function z(e,t){if(e.length<4)return!0;let i=e[(t+e.length)%e.length],n=e[(t+e.length+1)%e.length];for(let r=1;r<e.length;r++){if(L(i,n,e[(r+t)%e.length],e[(r+t+1)%e.length]))return!1}return!0}function W(e,t){const i=w(e,t);return Math.sqrt(i.x*i.x+i.y*i.y)}function G(e,t){const i=w(e,t);return i.x*i.x+i.y*i.y}function V(e,t){let i=Number.MAX_VALUE,n=0;for(let r=0;r<t.length;r++){const o=G(e,t[r]);o<i&&(i=o,n=r)}return n}function B(e,t){return e=R(e),t=R(t),Math.asin(C(e,t))}function H(e){return{x:Math.round(e.x),y:Math.round(e.y)}}d.src=o.a,d.onload=()=>{c=function(e,t){const i=document.createElement("canvas");return i.width=e,i.height=t,i.getContext("2d")}(d.width,d.height),c.drawImage(d,0,0,d.width,d.height,0,0,d.width,d.height)};var q=i(33);function Y(e,t){return"true"===e||"false"!==e&&t}function U(e,t){return isFinite(e)?e:t}function X(e){return e?e.replace(/\s\/\s?.*$/,""):""}function $(e){const t={};return e.forEach(((e,i)=>{t[i.toString()]=e})),t}function K(e,t){return t(e)?[e]:q.flatten(q.map(e,(e=>"object"===typeof e?K(e,t):[])))}var Q=i(11);function Z(e,t,i){const n=Math.ceil(t.x/i.x),r=Math.ceil(t.y/i.y),o=Math.max(n,r),s=Math.ceil(Math.log2(o));return Math.pow(2,s-e)}function J(e,t,i){if(!e||!isFinite(e.xMin)||!isFinite(e.xMax)||!isFinite(e.yMin)||!isFinite(e.yMax)||!isFinite(e.mip))return[];if(e.xMin>=e.xMax||e.yMin>=e.yMax||e.mip<=0)return[];if(!t||!i||!isFinite(t.x)||!isFinite(t.y)||!isFinite(i.x)||!isFinite(i.y))return[];if(i.x<=0||i.y<=0||t.x<=0||t.y<=0)return[];if(e.xMax<0||e.xMin>t.x||e.yMax<0||e.yMin>t.y)return[];const n=function(e,t,i){const n=Math.ceil(t.x/i.x),r=Math.ceil(t.y/i.y),o=Math.max(n,r);return Math.ceil(Math.log2(o))-Math.ceil(Math.log2(e))}(e.mip,t,i);if(n<0)return[new Q.TileCoordinate(0,0,0)];const r=Math.max(0,e.xMin),o=Math.min(e.xMax,t.x),s=Math.max(0,e.yMin),a=Math.min(e.yMax,t.y),l=(e.mip,e.mip*i.x),c=e.mip*i.y,d=Math.floor(r/l),u=Math.ceil(o/l),h=Math.floor(s/c),p=Math.ceil(a/c),g=new Array((u-d)*(p-h));for(let f=d,b=0;f<u;f++)for(let e=h;e<p;e++,b++)g[b]=new Q.TileCoordinate(f,e,n);return g}const ee=299792458;function te(e,t=0){return isFinite(e)&&isFinite(t)&&t>=0&&t<=20?e.toExponential(t):String(e)}function ie(e,t=0){return isFinite(e)&&isFinite(t)&&t>=0&&t<=20?e.toFixed(t):String(e)}function ne(e){return null===e||isNaN(e)?null:e<.01?te(e,2):ie(e,2)}function re(e,t,i="",n=!0,r=!1){let o=te(e,t);return n&&(o=o.replace(/0+e/,"e"),o=o.replace(".e",".0e"),o=o.replace("e+0","")),r&&e>=0&&(o=" "+o),i&&i.length&&(o=`${o} ${i}`),o}function oe(e){if(!isFinite(e))return null;let t="";return t=e<3?`${ie(1e3*e,4)} MHz`:e>=3&&e<1e3?`${ie(e,4)} GHz`:`${ie(e/1e3,4)} THz`,t}function se(e,t=-1){if(!isFinite(e))return null;let i="";return i=e<120?`${ie(e,t<0?6:t)}"`:e>=120&&e<7200?`${ie(e/60,t<0?3:t)}'`:`${ie(e/3600,t<0?3:t)} deg`,i}function ae(e){if(isFinite(e)&&0!==e&&null!==e)return ee/e}function le(e){const t=null===e||void 0===e?void 0:e.trim();if(!t)return null;return/^(\d+(\.\d+)?)"?$/.test(t)?parseFloat(RegExp.$1):/^(\d+(\.\d+)?)'$/.test(t)?60*parseFloat(RegExp.$1):/^(\d+(\.\d+)?)\s*deg(ree)?$/i.test(t)?3600*parseFloat(RegExp.$1):null}var ce=i(3),de=i.n(ce),ue=i(0);const he={WebGLErrorMessage:Object(ue.jsxs)(de.a.Fragment,{children:[Object(ue.jsx)("p",{children:Object(ue.jsx)("b",{children:"Could not load WebGL. Images will not be displayed properly."})}),Object(ue.jsx)("p",{children:Object(ue.jsx)("small",{children:" If you are using CARTA through a browser, please ensure your browser supports WebGL. If you are using the CARTA standalone app, please ensure you are not running in a remote desktop. "})})]})},pe=WebGLRenderingContext;function ge(e,t,i){if(!e||!t||i!==pe.VERTEX_SHADER&&i!==pe.FRAGMENT_SHADER)return null;let n=e.createShader(i);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,pe.COMPILE_STATUS)?n:(console.log(e.getShaderInfoLog(n)),null)}function fe(e,t,i){if(!e)return null;let n=ge(e,t,pe.VERTEX_SHADER),r=ge(e,i,pe.FRAGMENT_SHADER),o=e.createProgram();return e.attachShader(o,n),e.attachShader(o,r),e.linkProgram(o),e.getProgramParameter(o,pe.LINK_STATUS)?o:(console.log("Could not initialise shaders"),null)}function be(e,t,i){return new Promise(((n,r)=>{e||r();const o=new Image;o.onload=()=>{const t=e.createTexture();e.activeTexture(i),e.bindTexture(pe.TEXTURE_2D,t),e.texImage2D(pe.TEXTURE_2D,0,pe.RGB,pe.RGB,pe.UNSIGNED_BYTE,o),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_S,pe.CLAMP_TO_EDGE),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_T,pe.CLAMP_TO_EDGE),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MIN_FILTER,pe.NEAREST),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MAG_FILTER,pe.NEAREST),n(t)},o.onerror=()=>r(`Error loading image ${t}`),o.src=t}))}function me(e,t,i,n,r=pe.NEAREST){if(!e)return null;const o=e.createTexture();return e.activeTexture(n),e.bindTexture(pe.TEXTURE_2D,o),e.texImage2D(pe.TEXTURE_2D,0,pe.LUMINANCE,t,i,0,pe.LUMINANCE,pe.FLOAT,new Float32Array(t*i)),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MIN_FILTER,r),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MAG_FILTER,r),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_S,pe.CLAMP_TO_EDGE),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_T,pe.CLAMP_TO_EDGE),o}function ye(e,t,i,n,r,o,s,a){e&&(e.bindTexture(pe.TEXTURE_2D,t),e.activeTexture(n),e.texSubImage2D(pe.TEXTURE_2D,0,s,a,r,o,pe.LUMINANCE,pe.FLOAT,i),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MIN_FILTER,pe.NEAREST),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MAG_FILTER,pe.NEAREST),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_S,pe.CLAMP_TO_EDGE),e.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_T,pe.CLAMP_TO_EDGE))}function Oe(){const e=document.createElement("canvas").getContext("webgl"),t=null===e||void 0===e?void 0:e.getExtension("OES_texture_float");return e&&t?e:(a.b.Instance.showAlert(he.WebGLErrorMessage,"issue"),null)}var je=i(6),Se=i(20);function xe(e,t){if(!e||!t)return!1;const i=/^-?\d{0,2}:\d{0,2}:(\d{1,2}(\.\d+)?)?$/,n=/^-?\d*:\d{0,2}:(\d{1,2}(\.\d+)?)?$/;return t===a.C.HMS?i.test(e):t===a.C.DMS?n.test(e):/^-?\d+(\.\d+)?$/.test(e)}function Ce(e){return e?e.entryType===je.a.EntryType.FLOAT||e.entryType===je.a.EntryType.INT?e.numericValue:parseFloat(e.value):NaN}function Ie(e,t,i=!0){return Se.transformPoint(e,t.x,t.y,i)}function we(e,t){if(e){const i=Ie(e,t),n=Se.normalizeCoordinates(e,i.x,i.y),r=Se.getFormattedCoordinates(e,n.x,n.y);if(r)return r}return null}function Te(e,t){if(e){return Ie(e,Se.getWCSValueFromFormattedString(e,t),!1)}return null}function ve(e,t,i,n){if(i===Q.SpectralType.CHANNEL)return n;const r=Q.SPECTRAL_DEFAULT_UNIT.get(i);if(!r)return NaN;Se.set(e,`System=${i}, StdOfRest=Helio, Unit=${r}`),Se.set(t,`System=${i}, StdOfRest=Helio, Unit=${r}`);const o=Se.transform3DPoint(e,0,0,n,!0);if(!o||!isFinite(o.z))return NaN;const s=Se.transform3DPoint(t,0,0,0,!0),a=Se.transform3DPoint(t,s.x,s.y,o.z,!1);return a&&isFinite(a.z)?a.z:NaN}function Ae(e,t,i,n,r){if(i===Q.SpectralType.CHANNEL||n>r)return[];const o=Q.SPECTRAL_DEFAULT_UNIT.get(i);if(!o)return[];Se.set(e,`System=${i}, StdOfRest=Helio, Unit=${o}`),Se.set(t,`System=${i}, StdOfRest=Helio, Unit=${o}`);const s=r-n+1,a=new Array(s);for(let l=0;l<s;l++){const i=Se.transform3DPoint(e,1,1,n+l+1,!0);if(!i||!isFinite(i.z)||Re(i.z)){a[l]=NaN;continue}const r=Se.transform3DPoint(t,1,1,1,!0),o=Se.transform3DPoint(t,r.x,r.y,i.z,!1);o&&isFinite(o.z)&&!Re(i.z)?a[l]=o.z-1:a[l]=NaN}return a}function Re(e){return!isFinite(e)||e===-Number.MAX_VALUE}function Pe(e){return!e||Re(e.x)||Re(e.y)}function Ee(e,t,i,n,r,o){const s=2*Math.PI/o,a=new Float64Array(o),l=new Float64Array(o);for(let u=0;u<o;u++){const e=u*s,o=I(t,F({x:i*Math.cos(e),y:n*Math.sin(e)},r*Math.PI/180));a[u]=o.x,l[u]=o.y}const c=Se.transformPointArrays(e,a,l,0),d=new Array(o);for(let u=0;u<o;u++)d[u]={x:c.x[u],y:c.y[u]};return d}function Fe(e,t,i,n=!0){const r=function(e,t=!0){let i=0;const n=e.length;for(let r=1;r<n;r++)i+=W(e[r],e[r-1]);return t&&(i+=W(e[n-1],e[0])),i}(t,n)/i,o=t.length+(n?1:0),s=new Array;for(let l=1;l<o;l++){const e=t[l%t.length],i=t[l-1],{mag:n,dir:o}=P(w(e,i)),a=Math.round(n/r),c=n/a;s.push(i);for(let t=1;t<a;t++){const e=I(i,v(o,t*c));s.push(e)}}const a=s.length;if(a){const t=new Float64Array(a),i=new Float64Array(a);for(let e=0;e<a;e++)t[e]=s[e].x,i[e]=s[e].y;const n=Se.transformPointArrays(e,t,i,0),r=new Array(a);for(let e=0;e<a;e++)r[e]={x:n.x[e],y:n.y[e]};return r}return[]}function Me(e){switch(e){case je.a.ColumnType.String:return"string";case je.a.ColumnType.Uint8:return"uint8";case je.a.ColumnType.Int8:return"int8";case je.a.ColumnType.Uint16:return"uint16";case je.a.ColumnType.Int16:return"int16";case je.a.ColumnType.Uint32:return"uint32";case je.a.ColumnType.Int32:return"int32";case je.a.ColumnType.Uint64:return"uint64";case je.a.ColumnType.Int64:return"int64";case je.a.ColumnType.Float:return"float";case je.a.ColumnType.Double:return"double";case je.a.ColumnType.Bool:return"bool";default:return"unsupported"}}function ke(e,t){const i=t.length;let n;if(e.dataType===je.a.ColumnType.String){const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}else if(e.dataType===je.a.ColumnType.Bool){const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}else{if(e.dataType===je.a.ColumnType.UnsupportedType)return{dataType:je.a.ColumnType.UnsupportedType,data:[]};{const r=e.data;n=new Array(i);for(let e=0;e<i;e++)n[e]=r[t[e]]}}return{dataType:e.dataType,data:n}}var De=i(89),Ne=i.n(De);function Le(e="YYYY-MM-DD-HH-mm-ss"){return Ne()(new Date).format(e)}function _e(e,t,i){const n=encodeURI(`data:text/tab-separated-values;charset=utf-8,${i}\n`).replace(/#/g,"%23"),r=document.createElement("a");return r.href=n,r.download=`${e}-${t.replace(" ","-")}-${Le()}.tsv`,r.dispatchEvent(new MouseEvent("click")),null}},75:function(e,t,i){"use strict";i.d(t,"a",(function(){return c}));i(3);var n=i(20),r=i(36),o=i(424),s=(i(813),i(0));const a=o.a.ofType(),l={minimal:!0,position:"auto-end",popoverClassName:"colorselect"},c=e=>{const t=e.selectedItem>=0&&e.selectedItem<n.colors.length?e.selectedItem:4,i=e=>Object(s.jsx)("div",{className:"dropdown-color",style:{background:e},children:"\xa0"});return Object(s.jsx)(a,{activeItem:n.colors[t],onItemSelect:t=>e.onItemSelect(n.colors.indexOf(t)),popoverProps:l,filterable:!1,items:n.colors,itemRenderer:(e,{handleClick:t,modifiers:n,query:o})=>Object(s.jsx)(r.B,{active:n.active,disabled:n.disabled,onClick:t,text:i(e)},e),children:Object(s.jsx)(r.e,{className:"colorselect",text:i(n.colors[t]),rightIcon:"double-caret-vertical"})})}},750:function(e,t,i){},796:function(e,t,i){},797:function(e,t,i){},798:function(e,t,i){},799:function(e,t,i){},8:function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),i.d(t,"v",(function(){return s})),i.d(t,"e",(function(){return a})),i.d(t,"z",(function(){return l})),i.d(t,"c",(function(){return T})),i.d(t,"d",(function(){return F})),i.d(t,"g",(function(){return le})),i.d(t,"y",(function(){return ue})),i.d(t,"f",(function(){return pe})),i.d(t,"j",(function(){return he})),i.d(t,"k",(function(){return ge})),i.d(t,"l",(function(){return fe})),i.d(t,"p",(function(){return Pe})),i.d(t,"i",(function(){return Fe})),i.d(t,"h",(function(){return Me})),i.d(t,"r",(function(){return De})),i.d(t,"q",(function(){return Ne})),i.d(t,"x",(function(){return qe})),i.d(t,"w",(function(){return Ye})),i.d(t,"m",(function(){return Je.a})),i.d(t,"o",(function(){return Je.b})),i.d(t,"b",(function(){return et})),i.d(t,"u",(function(){return it})),i.d(t,"n",(function(){return nt})),i.d(t,"t",(function(){return ot})),i.d(t,"s",(function(){return st}));var n=i(36),r=i(44);const o=n.V.create({className:"app-toaster",position:r.a.BOTTOM});function s(e,t,i){return{icon:e,intent:"success",message:t,timeout:i||0===i?i:3e3}}function a(e){return{icon:"error",intent:"danger",message:e,timeout:3e4,action:{onClick:()=>{var t;return null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e)},icon:"clipboard"}}}function l(e){return{icon:"warning-sign",intent:"warning",message:e,timeout:3e4,action:{onClick:()=>{var t;return null===(t=navigator.clipboard)||void 0===t?void 0:t.writeText(e)},icon:"clipboard"}}}var c,d,u,h,p,g,f,b=i(4),m=i(2),y=(i(28),i(3)),O=i(33),j=i(1),S=i(15),x=i(43),C=i.n(x),I=i(422),w=(i(750),i(0));let T=Object(S.a)((f=g=class e extends y.Component{constructor(t){super(t),Object(b.a)(this,"displayColorPicker",u,this),Object(b.a)(this,"handleColorClick",h,this),Object(b.a)(this,"handleColorClose",p,this),this.handleColorChange=O.throttle((e=>{this.props.setColor&&this.props.setColor(e)}),e.CHANGE_DELAY),Object(j.p)(this)}render(){let e="color-picker-popup";this.props.darkTheme&&(e+=" bp3-dark");const t=C()(this.props.color).toString();return Object(w.jsxs)(n.F,{isOpen:this.displayColorPicker,onClose:this.handleColorClose,position:n.H.RIGHT,popoverClassName:e,children:[Object(w.jsx)(n.e,{onClick:this.handleColorClick,className:"color-swatch-button",disabled:this.props.disabled,children:Object(w.jsx)("div",{style:{backgroundColor:t}})}),Object(w.jsx)(I.a,{color:this.props.color,onChange:this.handleColorChange,disableAlpha:this.props.disableAlpha,presetColors:this.props.presetColors})]})}},g.CHANGE_DELAY=100,d=f,u=Object(m.a)(d.prototype,"displayColorPicker",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=Object(m.a)(d.prototype,"handleColorClick",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.displayColorPicker=!0}}}),p=Object(m.a)(d.prototype,"handleColorClose",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.displayColorPicker=!1}}}),c=d))||c;var v=i(424),A=i(59),R=i(81);const P=v.a.ofType(),E={minimal:!0,position:"auto-end",popoverClassName:"colormap-select-popover"},F=e=>{const t=t=>{const i=A.b.COLOR_MAPS_ALL.length,n=A.b.COLOR_MAPS_ALL.indexOf(t);return Object(w.jsx)("div",{className:"colormap-block",style:{transform:`scaleX(${e.inverted?-1:1})`,height:"15px",backgroundImage:`url(${R.a})`,backgroundSize:`100% calc(300% * ${i})`,backgroundPosition:`0 calc(300% * -${n} - 15px)`}})};return Object(w.jsx)(P,{disabled:e.disabled,activeItem:e.selectedItem,popoverProps:E,filterable:!1,items:A.b.COLOR_MAPS_SELECTED,onItemSelect:e.onItemSelect,itemRenderer:(e,{handleClick:i,modifiers:r,query:o})=>r.matchesPredicate?Object(w.jsx)(n.B,{active:r.active,disabled:r.disabled,label:e,onClick:i,text:t(e)},e):null,children:Object(w.jsx)(n.e,{disabled:e.disabled,text:t(e.selectedItem),rightIcon:"double-caret-vertical",alignText:"right"})})};var M,k,D,N,L,_,z,W,G,V,B,H,q,Y,U,X,$,K,Q=i(176),Z=i(74),J=i(42),ee=i(24),te=i(58),ie=i(126),ne=i(144),re=i(7),oe=i(5);i(797);let se,ae,le;!function(e){e[e.NONE=0]="NONE",e[e.X=1]="X",e[e.Y=2]="Y",e[e.XY=3]="XY"}(se||(se={})),function(e){e[e.NONE=0]="NONE",e[e.SELECTING=1]="SELECTING",e[e.PANNING=2]="PANNING"}(ae||(ae={})),function(e){e[e.BOX=0]="BOX",e[e.HORIZONTAL=1]="HORIZONTAL",e[e.VERTICAL=2]="VERTICAL"}(le||(le={}));const ce=16,de=20,ue=.05;let he,pe=Object(S.a)((k=class extends y.Component{get isSelecting(){return this.interactionMode===ae.SELECTING}get isPanning(){return this.interactionMode===ae.PANNING}get zoomMode(){const e=Math.abs(this.selectionBoxEnd.x-this.selectionBoxStart.x),t=Math.abs(this.selectionBoxEnd.y-this.selectionBoxStart.y);return e>de&&t>de&&this.props.graphZoomedXY?se.XY:this.props.graphZoomedX&&this.props.graphZoomedY?e>t?se.X:se.Y:this.props.graphZoomedX?se.X:this.props.graphZoomedY?se.Y:se.NONE}get cursorShape(){const e=void 0!==this.hoveredMarker&&!this.isSelecting;return this.isPanning||e?"move":this.props.selectingMode===le.HORIZONTAL?"ew-resize":this.props.selectingMode===le.VERTICAL?"ns-resize":"crosshair"}constructor(e){super(e),this.plotRef=void 0,this.stageRef=void 0,this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.panPrevious=void 0,this.previousClickTime=void 0,this.pendingClickHandle=void 0,Object(b.a)(this,"chartArea",D,this),Object(b.a)(this,"hoveredMarker",N,this),Object(b.a)(this,"width",L,this),Object(b.a)(this,"height",_,this),Object(b.a)(this,"interactionMode",z,this),Object(b.a)(this,"panStart",W,this),Object(b.a)(this,"selectionBoxStart",G,this),Object(b.a)(this,"selectionBoxEnd",V,this),Object(b.a)(this,"isMouseEntered",B,this),Object(b.a)(this,"isMarkerDragging",H,this),this.onPlotRefUpdated=e=>{this.plotRef=e},Object(b.a)(this,"updateChart",q,this),Object(b.a)(this,"resize",Y,this),Object(b.a)(this,"showMouseEnterWidget",U,this),Object(b.a)(this,"hideMouseEnterWidget",X,this),this.dragBoundsFuncVertical=(e,t)=>{let i=this.chartArea.left,n=this.chartArea.right;return t.dragCustomBoundary&&t.dragCustomBoundary.xMin&&(i=this.getCanvasSpaceX(t.dragCustomBoundary.xMin)),t.dragCustomBoundary&&t.dragCustomBoundary.xMax&&(n=this.getCanvasSpaceX(t.dragCustomBoundary.xMax)),{x:Object(re.k)(e.x,i,n),y:0}},this.dragBoundsFuncHorizontal=(e,t)=>{let i=this.chartArea.top,n=this.chartArea.bottom;return t.dragCustomBoundary&&t.dragCustomBoundary.yMin&&(i=this.getCanvasSpaceY(t.dragCustomBoundary.yMin)),t.dragCustomBoundary&&t.dragCustomBoundary.yMax&&(n=this.getCanvasSpaceY(t.dragCustomBoundary.yMax)),{x:0,y:Object(re.k)(e.y,i,n)}},Object(b.a)(this,"onMarkerDragStart",$,this),Object(b.a)(this,"onMarkerDragEnd",K,this),this.onMarkerDragged=(e,t)=>{if(this.props.markers&&t&&t.dragMove){let i;i=t.horizontal?this.getValueForPixelY(Object(re.k)(e.evt.offsetY,this.chartArea.top,this.chartArea.bottom),this.props.logY):this.getValueForPixelX(Object(re.k)(e.evt.offsetX,this.chartArea.left,this.chartArea.right)),t.dragMove(i)}if(this.props.graphCursorMoved){const t=this.getValueForPixelX(e.evt.offsetX);this.props.graphCursorMoved(t)}},this.onStageMouseDown=e=>{const t=e.evt;this.stageClickStartX=t.offsetX,this.stageClickStartY=t.offsetY;const i=t.ctrlKey||t.shiftKey||t.altKey;void 0!==this.hoveredMarker||i?i&&this.startPanning(t.offsetX):this.startSelection(t.offsetX,t.offsetY)},this.onStageMouseUp=e=>{const t=e.evt,i=Math.abs(t.offsetX-this.stageClickStartX),n=Math.abs(t.offsetY-this.stageClickStartY);if(i<3&&n<3)this.onStageClick(e);else if((this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0)&&(this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.isSelecting&&this.zoomMode!==se.NONE)){let e=Math.min(this.selectionBoxStart.x,this.selectionBoxEnd.x),t=Math.max(this.selectionBoxStart.x,this.selectionBoxEnd.x),i=this.getValueForPixelX(e),n=this.getValueForPixelX(t);e=Math.min(this.selectionBoxStart.y,this.selectionBoxEnd.y),t=Math.max(this.selectionBoxStart.y,this.selectionBoxEnd.y);let r=this.getValueForPixelY(t,this.props.logY),o=this.getValueForPixelY(e,this.props.logY);this.props.setSelectedRange&&this.props.selectingMode===le.HORIZONTAL?this.props.setSelectedRange(i,n):this.props.setSelectedRange&&this.props.selectingMode===le.VERTICAL?this.props.setSelectedRange(r,o):(this.zoomMode===se.X&&this.props.graphZoomedX(i,n),this.zoomMode===se.Y?this.props.graphZoomedY(r,o):this.zoomMode===se.XY&&this.props.graphZoomedXY(i,n,r,o))}this.endInteractions()},this.onStageMouseMove=e=>{if(this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0){const t=e.evt,i=this.chartArea;let n=Object(re.k)(t.offsetX,i.left-1,i.right+1),r=Object(re.k)(t.offsetY,i.top-1,i.bottom+1);if(this.isSelecting)this.updateSelection(n,r);else if(this.isPanning&&this.props.graphZoomedX){const e=n,t=this.getValueForPixelX(this.panPrevious),i=this.getValueForPixelX(e)-t;this.updatePan(e),this.props.graphZoomedX(this.props.xMin-i,this.props.xMax-i)}if(this.interactionMode===ae.NONE&&this.props.graphCursorMoved){const e=this.getValueForPixelX(n);this.props.graphCursorMoved(e)}}},this.onStageClick=e=>{const t={x:e.evt.offsetX,y:e.evt.offsetY},i=e.evt.button,n=performance.now(),r=n-this.previousClickTime;if(this.previousClickTime=n,r<300)return this.onStageDoubleClick(),void clearTimeout(this.pendingClickHandle);this.pendingClickHandle=setTimeout((()=>{const e=Math.abs(t.x-this.stageClickStartX),n=Math.abs(t.y-this.stageClickStartY);if(!(e>1||n>1))if(this.props.graphClicked&&0===i){const e=t.x,i=this.getValueForPixelX(e);this.props.graphClicked(i)}else if(this.props.graphRightClicked&&2===i){const e=t.x,i=this.getValueForPixelX(e);this.props.graphRightClicked(i)}}),300)},this.onStageRightClick=e=>{this.props.graphRightClicked&&e.evt.preventDefault()},this.onStageDoubleClick=()=>{this.props.graphZoomReset&&this.props.graphZoomReset()},this.onStageWheel=e=>{if((this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0)&&this.props.scrollZoom&&this.props.graphZoomedX&&this.chartArea){const t=e.evt,i=this.chartArea,n=15,r=.001;if(t.offsetX>i.right||t.offsetX<i.left)return;const o=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n,s=this.props.xMax-this.props.xMin,a=(t.offsetX-i.left)/(i.right-i.left),l=r*o*s,c=this.props.xMin-l*a,d=this.props.xMax+l*(1-a);c<d&&this.props.graphZoomedX(c,d)}},this.onKeyDown=e=>{this.isSelecting&&e.keyCode===Q.ESCAPE&&this.endInteractions()},this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseMove=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget()},this.exportImage=()=>{const e=this.plotRef,t=this.showPlotxAxes();t&&this.exportSubPlotImage(!0);const i=e.chartInstance.canvas,n=this.props.plotName||"unknown",r=this.props.imageName||"unknown",o=document.createElement("canvas");o.width=i.width,o.height=i.height;const s=o.getContext("2d");s.fillStyle=oe.e.Instance.preferenceStore.transparentImageBackground?"rgba(255, 255, 255, 0.0)":this.props.darkMode?Z.a.DARK_GRAY3:Z.a.LIGHT_GRAY5,s.fillRect(0,0,o.width,o.height),s.drawImage(i,0,0);const a=this.genChartBorder();a&&(s.beginPath(),s.strokeStyle=this.props.darkMode?Z.a.DARK_GRAY5:Z.a.LIGHT_GRAY1,s.lineWidth=1,s.rect(a.x,a.y,a.width,a.height),s.stroke());const l=this.genMeanRMSForPngPlot();(null===l||void 0===l?void 0:l.mean)&&(s.beginPath(),s.setLineDash([l.mean.dash]),s.strokeStyle=l.mean.color,s.lineWidth=1,s.moveTo(l.mean.xLeft,l.mean.y),s.lineTo(l.mean.xRight,l.mean.y),s.stroke()),(null===l||void 0===l?void 0:l.RMS)&&(s.fillStyle=l.RMS.color,s.globalAlpha=l.RMS.opacity,s.fillRect(l.RMS.xLeft,l.RMS.yTop,l.RMS.width,l.RMS.height),s.globalAlpha=1);const c=this.genSpectralLinesForPngPlot();null===c||void 0===c||c.forEach((e=>{s.beginPath(),s.strokeStyle=e.color,s.lineWidth=1,s.moveTo(e.x,e.yBottom),s.lineTo(e.x,e.yTop),s.stroke(),s.save(),s.font="12px Arial",s.translate(e.x,e.yBottom),s.rotate(-Math.PI/2),s.fillStyle=e.color,s.fillText(e.text,0,10),s.restore()})),o.toBlob((e=>{const t=document.createElement("a");t.download=`${r}-${n.replace(" ","-")}-${Object(re.I)()}.png`,t.href=URL.createObjectURL(e),t.dispatchEvent(new MouseEvent("click"))}),"image/png"),t&&this.exportSubPlotImage(!1)},this.exportData=()=>{const e=this.props.plotName||"unknown",t=this.props.imageName||"unknown";let i=`# ${t} ${e}`;this.props.xLabel&&(i+=`\n# xLabel: ${this.props.xLabel}`),this.props.yLabel&&(i+=`\n# yLabel: ${this.props.yLabel}`),this.props.comments&&this.props.comments.length&&(i+="\n"+this.props.comments.map((e=>"# "+e)).join("\n"));let n=[];"histogram"===e?n=this.props.data.map((e=>`${Object(re.lb)(e.x,10)}\t${Object(re.lb)(e.y,10)}`)):(this.props.data&&this.props.data.length&&(n=this.props.tickTypeX===te.b.Scientific?this.props.data.map((e=>`${Object(re.lb)(e.x,10)}\t${Object(re.lb)(e.y,10)}`)):this.props.data.map((e=>`${e.x}\t${Object(re.lb)(e.y,10)}`))),this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size&&this.props.multiPlotPropsMap.forEach(((e,t)=>{t===ne.b.LinearPolarizationQ||t===ne.b.LinearPolarizationU?n.push(`# ${t}\t`):t.indexOf("smoothed")>-1&&(e.exportData&&e.exportData.forEach(((e,t)=>{n.push(`# ${t}: ${e}\t`)})),n.push("# smoothed_x\tsmoothed_y")),e.data&&e.data.forEach((e=>{n.push(`${e.x}\t${Object(re.lb)(e.y,10)}`)}))}))),Object(re.r)(t,e,`${i}\n# x\ty\n${n.join("\n")}\n`)},this.calcMarkerBox=e=>{if(!e)return;const t=this.chartArea,i=this.getPixelForValueY(e.value-e.width/2,this.props.logY)-this.getPixelForValueY(e.value+e.width/2,this.props.logY),n=this.getCanvasSpaceY(e.value),r=Object(re.k)(n-i,t.top,t.bottom);return{lowerBound:r,height:Object(re.k)(n+i,t.top,t.bottom)-r}},this.genHorizontalLine=(e,t,i,n,r)=>{const o=this.chartArea,s=o.right-o.left,a=t&&this.hoveredMarker.id===e.id,l=(o.left+o.right)/2;let c=null;if(e.width||!(r<Math.floor(o.top-1)||r>Math.ceil(o.bottom+1))){if(a){const t=10.666666666666666,r=3;c=[Object(w.jsx)(ee.f,{listening:!1,points:[o.left,0,o.right,0],strokeWidth:1,stroke:i,opacity:n,dash:e.dash},0),Object(w.jsx)(ee.a,{listening:!1,x:l,y:0,points:[0,-r,0,-r-t],pointerLength:t,pointerWidth:t,opacity:n,fill:i},1),Object(w.jsx)(ee.a,{listening:!1,x:l,y:0,points:[0,r,0,r+t],pointerLength:t,pointerWidth:t,opacity:n,fill:i},2)]}else if(e.width){const t=this.calcMarkerBox(e),a=(null===t||void 0===t?void 0:t.lowerBound)-r;c=[Object(w.jsx)(ee.g,{listening:!1,x:o.left,y:a,width:s,height:null===t||void 0===t?void 0:t.height,fill:i,opacity:n},0)]}else c=[Object(w.jsx)(ee.f,{listening:!1,points:[o.left,0,o.right,0],strokeWidth:1,stroke:i,opacity:n,dash:e.dash},0)];return e.label&&c.push(Object(w.jsx)(ee.j,{align:"left",fill:i,text:e.label,x:o.left,y:0},c.length)),e.draggable?Object(w.jsxs)(ee.d,{x:0,y:r,draggable:!0,dragBoundFunc:t=>this.dragBoundsFuncHorizontal(t,e),onDragMove:t=>this.onMarkerDragged(t,e),children:[Object(w.jsx)(ee.g,{x:o.left,y:-8,width:s,height:ce,onMouseEnter:()=>this.setHoveredMarker(e),onMouseLeave:()=>this.setHoveredMarker(void 0)}),c]},e.id+"-draggable"):Object(w.jsx)(ee.d,{x:0,y:r,children:c},e.id)}},this.genVerticalLine=(e,t,i,n,r,o)=>{const s=this.chartArea,a=s.bottom-s.top,l=t&&this.hoveredMarker.id===e.id,c=(s.top+s.bottom)/2;let d=null;if(e.width||!(r<Math.floor(s.left-1)||r>Math.ceil(s.right+1))){if(l){const e=10.666666666666666,t=3;d=[Object(w.jsx)(ee.f,{listening:!1,points:[0,s.top,0,s.bottom],strokeWidth:1,stroke:i,opacity:n},0),Object(w.jsx)(ee.a,{listening:!1,x:0,y:c,points:[-t,0,-t-e,0],pointerLength:e,pointerWidth:e,opacity:n,fill:i},1),Object(w.jsx)(ee.a,{listening:!1,x:0,y:c,points:[t,0,t+e,0],pointerLength:e,pointerWidth:e,opacity:n,fill:i},2)]}else if(e.width){const t=this.getPixelForValueX(e.value+e.width/2)-this.getPixelForValueX(e.value-e.width/2);let o=Object(re.k)(r-t,s.left,s.right),l=Object(re.k)(r+t,s.left,s.right)-o;d=[Object(w.jsx)(ee.g,{listening:!1,x:o-r,y:s.top,width:l,height:a,fill:i,opacity:n},0)]}else d=[Object(w.jsx)(ee.f,{listening:!1,points:[0,s.top,0,s.bottom],strokeWidth:1,stroke:i,opacity:n,dash:e.dash},0)];return o&&e.label&&d.push(Object(w.jsx)(ee.j,{align:"left",fill:i,text:e.label,rotation:-90,x:0,y:s.bottom},d.length)),e.draggable?Object(w.jsxs)(ee.d,{x:r,y:0,draggable:!0,dragBoundFunc:t=>this.dragBoundsFuncVertical(t,e),onDragStart:this.onMarkerDragStart,onDragEnd:this.onMarkerDragEnd,onDragMove:t=>this.onMarkerDragged(t,e),children:[Object(w.jsx)(ee.g,{x:-8,y:s.top,width:ce,height:a,onMouseEnter:()=>this.setHoveredMarker(e),onMouseLeave:()=>this.setHoveredMarker(void 0)}),d]},e.id+"-draggable"):Object(w.jsx)(ee.d,{x:r,y:0,children:d},e.id)}},this.genLines=()=>{const e=this.chartArea,t=void 0!==this.hoveredMarker&&!this.isSelecting;let i=[];if(this.props.markers&&this.props.markers.length&&e){const n=Math.abs(e.right-e.left),r=12*this.props.markers.length/2<n;for(let e=0;e<this.props.markers.length;e++){const n=this.props.markers[e],o=n.color||(this.props.darkMode?Z.a.RED4:Z.a.RED2),s=!n.isMouseMove||this.isMouseEntered&&!this.isMarkerDragging?n.opacity||1:0;if(n.horizontal){let e=this.getCanvasSpaceY(n.value);if(isNaN(e))continue;i.push(this.genHorizontalLine(n,t,o,s,e))}else{let e=this.getCanvasSpaceX(n.value);if(isNaN(e))continue;if(n.interactionMarker){const r=!n.isMouseMove&&this.isMouseEntered?0:n.opacity||1;i.push(this.genVerticalLine(n,t,o,r,e))}else i.push(this.genVerticalLine(n,t,o,s,e,r))}}}return i},this.genSelectionRect=()=>{let e=null;const t=this.chartArea,i=this.selectionBoxStart,n=this.selectionBoxEnd,r={x:n.x-i.x,y:n.y-i.y},o=Math.abs(r.x),s=Math.abs(r.y);if(this.isSelecting&&(o>3||s>3)&&t){const o=t.right-t.left,s=t.bottom-t.top;if(this.zoomMode===se.X){const o=Object(re.k)(de,0,i.y-t.top),a=Object(re.k)(de,0,t.bottom-i.y);e=[Object(w.jsx)(ee.g,{fill:Z.a.GRAY3,opacity:.2,x:i.x,y:t.top,width:r.x,height:s},0),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},1),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:n.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},2)]}else if(this.zoomMode===se.Y){const s=Object(re.k)(de,0,i.x-t.left),a=Object(re.k)(de,0,t.right-i.x);e=[Object(w.jsx)(ee.g,{fill:Z.a.GRAY3,opacity:.2,x:t.left,y:i.y,width:o,height:r.y},0),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:i.y,points:[-s,0,a,0],strokeWidth:3},1),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:n.y,points:[-s,0,a,0],strokeWidth:3},2)]}else this.zoomMode===se.XY&&(e=[Object(w.jsx)(ee.g,{fill:Z.a.GRAY3,opacity:.2,x:i.x,y:i.y,width:r.x,height:r.y},0),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:i.y,points:[0,10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},1),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:n.x,y:i.y,points:[0,10,0,0,-10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},2),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:n.y,points:[0,-10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},3),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:n.x,y:n.y,points:[-10,0,0,0,0,-10],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},4)])}return e},this.genChartBorder=()=>{const e=this.chartArea;let t;return e&&(t={x:(Math.floor(e.left)-.5)*devicePixelRatio,y:(Math.floor(e.top)-.5)*devicePixelRatio,width:Math.ceil(e.right-e.left+1)*devicePixelRatio,height:Math.ceil(e.bottom-e.top+1)*devicePixelRatio}),t},this.genBorderRect=()=>{const e=this.chartArea;let t=null;return e&&(t=Object(w.jsx)(ee.g,{x:Math.floor(e.left)-.5*devicePixelRatio,y:Math.floor(e.top)-.5*devicePixelRatio,width:Math.ceil(e.right-e.left+1),height:Math.ceil(e.bottom-e.top+1),listening:!1,stroke:this.props.darkMode?Z.a.DARK_GRAY5:Z.a.LIGHT_GRAY1,strokeWidth:1})),t},this.genMeanRMSForPngPlot=()=>{var e;let t={mean:void 0,RMS:void 0};const i=this.chartArea;return null===(e=this.props.markers)||void 0===e||e.forEach((e=>{const n=this.getCanvasSpaceY(e.value);if((null===e||void 0===e?void 0:e.id.match(/^marker-mean/))&&!isNaN(n)&&(t.mean={color:null===e||void 0===e?void 0:e.color,dash:e.dash,y:n*devicePixelRatio,xLeft:i.left*devicePixelRatio,xRight:i.right*devicePixelRatio}),(null===e||void 0===e?void 0:e.id.match(/^marker-rms/))&&!isNaN(n)){const n=this.calcMarkerBox(e);t.RMS={color:null===e||void 0===e?void 0:e.color,opacity:null===e||void 0===e?void 0:e.opacity,xLeft:i.left*devicePixelRatio,yTop:(null===n||void 0===n?void 0:n.lowerBound)*devicePixelRatio,width:(i.right-i.left)*devicePixelRatio,height:(null===n||void 0===n?void 0:n.height)*devicePixelRatio}}})),t},this.genSpectralLinesForPngPlot=()=>{var e;let t=[];const i=this.chartArea;return null===(e=this.props.markers)||void 0===e||e.forEach((e=>{const n=this.getCanvasSpaceX(e.value);(null===e||void 0===e?void 0:e.id.match(/^spectral-line-/))&&!isNaN(n)&&t.push({color:null===e||void 0===e?void 0:e.color,text:null===e||void 0===e?void 0:e.label,x:n,yBottom:i.bottom,yTop:i.top})})),t},Object(j.p)(this)}getValueForPixelX(e){if(!this.chartArea)return;return(e-this.chartArea.left)/(this.chartArea.right-this.chartArea.left)*(this.props.xMax-this.props.xMin)+this.props.xMin}getValueForPixelY(e,t=!1){if(this.chartArea){if(t){let t=this.chartArea.bottom-e;return t/=this.chartArea.bottom-this.chartArea.top,t*=Math.log10(this.props.yMax/this.props.yMin),Math.pow(10,Math.log10(this.props.yMin)+t)}return(this.chartArea.bottom-e)/(this.chartArea.bottom-this.chartArea.top)*(this.props.yMax-this.props.yMin)+this.props.yMin}}getPixelForValueX(e){if(!this.chartArea)return;return(e-this.props.xMin)/(this.props.xMax-this.props.xMin)*(this.chartArea.right-this.chartArea.left)+this.chartArea.left}getPixelForValueY(e,t=!1){if(!this.chartArea)return;let i;return i=t?(Math.log(this.props.yMax)-Math.log(e))/(Math.log(this.props.yMax)-Math.log(this.props.yMin)):(this.props.yMax-e)/(this.props.yMax-this.props.yMin),i*(this.chartArea.bottom-this.chartArea.top)+this.chartArea.top}getCanvasSpaceX(e){return Math.floor(this.getPixelForValueX(e))+.5*devicePixelRatio}getCanvasSpaceY(e){return Math.floor(this.getPixelForValueY(e,this.props.logY))+.5*devicePixelRatio}setHoveredMarker(e){this.hoveredMarker=e}startSelection(e,t){this.interactionMode=ae.SELECTING,this.selectionBoxStart={x:e,y:t},this.selectionBoxEnd={x:e,y:t}}startPanning(e){this.interactionMode=ae.PANNING,this.panPrevious=e}endInteractions(){this.interactionMode=ae.NONE}updateSelection(e,t){this.selectionBoxEnd={x:e,y:t}}updatePan(e){this.panPrevious=e}exportSubPlotImage(e){const t=this.plotRef.chartInstance;t.config.options.scales.xAxes[0].ticks.display=e,t.config.options.scales.xAxes[0].ticks.major.display=e,t.config.options.scales.xAxes[0].ticks.minor.display=e;let i=10;e||(i=0),t.options.scales.xAxes[0].gridLines.tickMarkLength=i,t.options.scales.xAxes[0].scaleLabel.display=e,t.update()}showPlotxAxes(){const e=this.plotRef.chartInstance;return!(!0!==this.props.isGroupSubPlot||!e||!1!==e.options.scales.xAxes[0].ticks.display)}render(){return Object(w.jsxs)("div",{className:"line-plot-component",style:{cursor:this.cursorShape},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,tabIndex:0,children:[Object(w.jsx)(J.a,{handleWidth:!0,handleHeight:!0,onResize:this.resize,refreshMode:"throttle",refreshRate:33}),this.width>0&&this.height>0&&Object(w.jsx)(te.a,{...this.props,plotRefUpdated:this.onPlotRefUpdated,chartAreaUpdated:this.updateChart,width:this.width,height:this.height}),this.width>0&&this.height>0&&Object(w.jsx)(ee.i,{className:"annotation-stage",ref:e=>this.stageRef=e,width:this.width,height:this.height,onMouseDown:this.onStageMouseDown,onMouseUp:this.onStageMouseUp,onContextMenu:this.onStageRightClick,onMouseMove:this.onStageMouseMove,onWheel:this.onStageWheel,children:Object(w.jsxs)(ee.e,{children:[this.genLines(),this.genSelectionRect(),this.genBorderRect()]})}),Object(w.jsx)(ie.a,{darkMode:this.props.darkMode,visible:this.isMouseEntered&&(void 0!==this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0),exportImage:this.exportImage,exportData:this.exportData})]})}},D=Object(m.a)(k.prototype,"chartArea",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=Object(m.a)(k.prototype,"hoveredMarker",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),L=Object(m.a)(k.prototype,"width",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),_=Object(m.a)(k.prototype,"height",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),z=Object(m.a)(k.prototype,"interactionMode",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ae.NONE}}),W=Object(m.a)(k.prototype,"panStart",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),G=Object(m.a)(k.prototype,"selectionBoxStart",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),V=Object(m.a)(k.prototype,"selectionBoxEnd",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),B=Object(m.a)(k.prototype,"isMouseEntered",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),H=Object(m.a)(k.prototype,"isMarkerDragging",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(m.a)(k.prototype,"isSelecting",[j.i],Object.getOwnPropertyDescriptor(k.prototype,"isSelecting"),k.prototype),Object(m.a)(k.prototype,"isPanning",[j.i],Object.getOwnPropertyDescriptor(k.prototype,"isPanning"),k.prototype),Object(m.a)(k.prototype,"zoomMode",[j.i],Object.getOwnPropertyDescriptor(k.prototype,"zoomMode"),k.prototype),Object(m.a)(k.prototype,"cursorShape",[j.i],Object.getOwnPropertyDescriptor(k.prototype,"cursorShape"),k.prototype),q=Object(m.a)(k.prototype,"updateChart",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chartArea=e}}}),Y=Object(m.a)(k.prototype,"resize",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),U=Object(m.a)(k.prototype,"showMouseEnterWidget",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0,this.props.mouseEntered&&this.props.mouseEntered(!0)}}}),X=Object(m.a)(k.prototype,"hideMouseEnterWidget",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1,this.props.mouseEntered&&this.props.mouseEntered(!1)}}}),$=Object(m.a)(k.prototype,"onMarkerDragStart",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMarkerDragging=!0}}}),K=Object(m.a)(k.prototype,"onMarkerDragEnd",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMarkerDragging=!1}}}),Object(m.a)(k.prototype,"setHoveredMarker",[j.g],Object.getOwnPropertyDescriptor(k.prototype,"setHoveredMarker"),k.prototype),Object(m.a)(k.prototype,"startSelection",[j.g],Object.getOwnPropertyDescriptor(k.prototype,"startSelection"),k.prototype),Object(m.a)(k.prototype,"startPanning",[j.g],Object.getOwnPropertyDescriptor(k.prototype,"startPanning"),k.prototype),Object(m.a)(k.prototype,"endInteractions",[j.g],Object.getOwnPropertyDescriptor(k.prototype,"endInteractions"),k.prototype),Object(m.a)(k.prototype,"updateSelection",[j.g],Object.getOwnPropertyDescriptor(k.prototype,"updateSelection"),k.prototype),Object(m.a)(k.prototype,"updatePan",[j.g],Object.getOwnPropertyDescriptor(k.prototype,"updatePan"),k.prototype),M=k))||M;!function(e){e.STEPS="Steps",e.LINES="Lines",e.POINTS="Points"}(he||(he={}));class ge extends y.Component{constructor(...e){super(...e),this.plotTypeButton=e=>Object(w.jsx)(n.W,{content:e,children:Object(w.jsx)(n.b,{icon:ge.getIconForType(e),active:this.props.value===e,onClick:()=>this.props.onValueChanged(e)})})}static getIconForType(e){switch(e){case he.STEPS:return"step-chart";case he.LINES:return"timeline-line-chart";default:return"scatter-plot"}}render(){return Object(w.jsxs)(n.f,{className:"plot-type-selector",children:[this.plotTypeButton(he.STEPS),this.plotTypeButton(he.LINES),this.plotTypeButton(he.POINTS)]})}}i(798);y.Component;i(799);const fe=e=>{var t;let i="";return null===(t=e.info)||void 0===t||t.forEach(((e,t)=>{i=0===t?e:i+", "+e})),Object(w.jsx)("div",{className:"profiler-info",children:Object(w.jsx)("pre",{children:i})})};var be,me,ye,Oe,je,Se,xe,Ce,Ie,we,Te,ve,Ae;i(800);const Re=20;let Pe=Object(S.a)((me=class extends y.Component{get isSelecting(){return this.interactionMode===ae.SELECTING}get isPanning(){return this.interactionMode===ae.PANNING}constructor(e){super(e),this.markerOpacity=.8,this.plotRef=void 0,this.previousClickTime=void 0,this.pendingClickHandle=void 0,this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.panPrevious=void 0,Object(b.a)(this,"selectionBoxStart",ye,this),Object(b.a)(this,"selectionBoxEnd",Oe,this),Object(b.a)(this,"chartArea",je,this),Object(b.a)(this,"width",Se,this),Object(b.a)(this,"height",xe,this),Object(b.a)(this,"isMouseEntered",Ce,this),Object(b.a)(this,"interactionMode",Ie,this),this.onPlotRefUpdated=e=>{this.plotRef=e},Object(b.a)(this,"updateChart",we,this),Object(b.a)(this,"resize",Te,this),Object(b.a)(this,"showMouseEnterWidget",ve,this),Object(b.a)(this,"hideMouseEnterWidget",Ae,this),this.onMouseEnter=()=>{this.showMouseEnterWidget()},this.onMouseMove=()=>{this.showMouseEnterWidget()},this.onMouseLeave=()=>{this.hideMouseEnterWidget(),this.props.mouseEntered&&this.props.mouseEntered(!1)},this.onKeyDown=e=>{this.isSelecting&&e.keyCode===Q.ESCAPE&&this.endInteractions()},this.genBorderRect=()=>{const e=this.chartArea;let t=null;return this.chartArea&&(t=Object(w.jsx)(ee.g,{x:Math.floor(e.left)-.5*devicePixelRatio,y:Math.floor(e.top)-.5*devicePixelRatio,width:Math.ceil(e.right-e.left+1),height:Math.ceil(e.bottom-e.top+1),listening:!1,stroke:this.props.darkMode?Z.a.DARK_GRAY5:Z.a.LIGHT_GRAY1,strokeWidth:1})),t},this.genIndicator=()=>{const e=this.chartArea;let t=[];const i=this.props.indicatorInteractionChannel,n=this.markerOpacity;if(e&&i&&i.hoveredChannel&&!isNaN(i.hoveredChannel.x)&&!isNaN(i.hoveredChannel.y)&&!this.isMouseEntered&&i.start){const e=this.props.indicatorInteractionChannel.hoveredChannel,i=this.props.darkMode?Z.a.GRAY4:Z.a.GRAY2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){let n=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0)),r=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1));t.push(this.genCircle("scatter-indicator-y-hovered-interaction-circle",i,n,r))}}if(e&&i&&i.currentChannel&&!isNaN(i.currentChannel.x)&&!isNaN(i.currentChannel.y)){const e=this.props.indicatorInteractionChannel.currentChannel,i=this.props.darkMode?Z.a.RED4:Z.a.RED2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){let r=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0)),o=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1));t.push(this.genXline("scatter-indicator-x-current-interactive",i,n,r)),t.push(this.genYline("scatter-indicator-y-current-interactive",i,n,o))}}if(this.isMouseEntered&&this.props.cursorNearestPoint){const e=this.props.cursorNearestPoint,i=this.props.darkMode?Z.a.GRAY4:Z.a.GRAY2;if(e.x>=this.props.xMin&&e.x<=this.props.xMax&&e.y>=this.props.yMin&&e.y<=this.props.yMax){const n=Math.floor(this.getPixelValue(e.x,this.props.xMin,this.props.xMax,!0))+.5*devicePixelRatio,r=Math.floor(this.getPixelValue(e.y,this.props.yMin,this.props.yMax,!1))+.5*devicePixelRatio;t.push(this.genCircle("scatter-indicator-y-hovered-circle",i,n,r))}}return t},this.exportImage=()=>{const e=this.plotRef.chartInstance.canvas,t=this.props.plotName||"unknown",i=this.props.imageName||"unknown",n=document.createElement("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.fillStyle=oe.e.Instance.preferenceStore.transparentImageBackground?"rgba(255, 255, 255, 0.0)":this.props.darkMode?Z.a.DARK_GRAY3:Z.a.LIGHT_GRAY5,r.fillRect(0,0,n.width,n.height),r.drawImage(e,0,0),n.toBlob((e=>{const n=document.createElement("a");n.download=`${i}-${t.replace(" ","-")}-${Object(re.I)()}.png`,n.href=URL.createObjectURL(e),n.dispatchEvent(new MouseEvent("click"))}),"image/png")},this.exportData=()=>{const e=this.props.plotName||"unknown",t=this.props.imageName||"unknown";let i=`# ${t} ${e}`;this.props.xLabel&&(i+=`\n# xLabel: ${this.props.xLabel}`),this.props.yLabel&&(i+=`\n# yLabel: ${this.props.yLabel}`),this.props.comments&&this.props.comments.length&&(i+="\n"+this.props.comments.map((e=>"# "+e)).join("\n"));let n=[];"histogram"===e?n=this.props.data.map((e=>`${Object(re.lb)(e.x,10)}\t${Object(re.lb)(e.y,10)}`)):this.props.data&&this.props.data.length&&(n=this.props.tickTypeX===te.b.Scientific?this.props.data.map((e=>`${Object(re.lb)(e.x,10)}\t${Object(re.lb)(e.y,10)}`)):this.props.data.map((e=>`${e.x}\t${Object(re.lb)(e.y,10)}`))),Object(re.r)(t,e,`${i}\n# x\ty\n${n.join("\n")}\n`)},this.onStageMouseMove=e=>{var t;if(this.props.data||(null===(t=this.props.multiPlotPropsMap)||void 0===t?void 0:t.size)>0){const t=e.evt,i=this.chartArea;let n=Object(re.k)(t.offsetX,i.left-1,i.right+1),r=Object(re.k)(t.offsetY,i.top-1,i.bottom+1);if(this.interactionMode===ae.NONE&&this.props.graphCursorMoved){const e=this.getValueForPixelX(n),t=this.getValueForPixelY(r);this.props.graphCursorMoved(e,t)}if(this.isPanning&&this.props.graphZoomedXY){const e=n,t=r,i=this.getValueForPixelX(this.panPrevious.x),o=this.getValueForPixelX(e)-i,s=this.getValueForPixelY(this.panPrevious.y),a=this.getValueForPixelY(t)-s;this.updatePan(e,t);const l=this.props.xMin-o,c=this.props.xMax-o,d=this.props.yMin-a,u=this.props.yMax-a;this.props.graphZoomedXY(l,c,d,u)}this.isSelecting&&this.updateSelection(n,r)}},this.onStageMouseDown=e=>{const t=e.evt;this.stageClickStartX=t.offsetX,this.stageClickStartY=t.offsetY;const i=t.ctrlKey||t.shiftKey||t.altKey;i?i&&this.startPanning(t.offsetX,t.offsetY):this.startSelection(t.offsetX,t.offsetY)},this.onStageDoubleClick=()=>{this.props.graphZoomReset&&this.props.graphZoomReset()},this.onStageClick=e=>{const t=e.evt.offsetX,i=e.evt.offsetY,n=e.evt.button,r=performance.now(),o=r-this.previousClickTime;if(this.previousClickTime=r,o<300)return this.onStageDoubleClick(),void clearTimeout(this.pendingClickHandle);this.pendingClickHandle=setTimeout((()=>{const e=Math.abs(t-this.stageClickStartX),r=Math.abs(i-this.stageClickStartY);e>1||r>1||this.props.graphClicked&&0===n&&this.props.cursorNearestPoint&&this.props.graphClicked(this.props.cursorNearestPoint.x,this.props.cursorNearestPoint.y,this.props.data)}),300)},this.onStageMouseUp=e=>{const t=e.evt,i=Math.abs(t.offsetX-this.stageClickStartX),n=Math.abs(t.offsetY-this.stageClickStartY);if(i<3&&n<3)this.onStageClick(e);else if(this.props.data&&(this.stageClickStartX=void 0,this.stageClickStartY=void 0,this.isSelecting&&this.zoomMode!==se.NONE)){let e=Math.min(this.selectionBoxStart.x,this.selectionBoxEnd.x),t=Math.max(this.selectionBoxStart.x,this.selectionBoxEnd.x),i=this.getValueForPixelX(e),n=this.getValueForPixelX(t);e=Math.min(this.selectionBoxStart.y,this.selectionBoxEnd.y),t=Math.max(this.selectionBoxStart.y,this.selectionBoxEnd.y);let r=this.getValueForPixelY(t),o=this.getValueForPixelY(e);this.zoomMode===se.X&&this.props.graphZoomedX(i,n),this.zoomMode===se.Y?this.props.graphZoomedY(r,o):this.zoomMode===se.XY&&this.props.graphZoomedXY(i,n,r,o)}this.endInteractions()},this.onStageWheel=e=>{if(this.props.data&&this.props.scrollZoom&&this.props.graphZoomedXY&&this.chartArea){const t=e.evt,i=this.chartArea,n=15,r=.001;if(t.offsetX>i.right||t.offsetX<i.left||t.offsetY>i.bottom||t.offsetY<i.top)return;const o=t.deltaMode===WheelEvent.DOM_DELTA_PIXEL?t.deltaY:t.deltaY*n;let s=this.props.xMax-this.props.xMin;const a=(t.offsetX-i.left)/(i.right-i.left),l=r*o*s;let c=this.props.yMax-this.props.yMin;const d=(t.offsetY-i.top)/(i.bottom-i.top),u=r*o*c,h=this.props.xMin-l*a,p=this.props.xMax+l*(1-a),g=this.props.yMin-u*(1-d),f=this.props.yMax+u*d;h<p&&g<f&&this.props.graphZoomedXY(h,p,g,f)}},this.genSelectionRect=()=>{let e=null;const t=this.chartArea,i=this.selectionBoxStart,n=this.selectionBoxEnd,r={x:n.x-i.x,y:n.y-i.y},o=Math.abs(r.x),s=Math.abs(r.y);if(this.isSelecting&&(o>3||s>3)&&t){const o=t.right-t.left,s=t.bottom-t.top;if(this.zoomMode===se.X){const o=Object(re.k)(Re,0,i.y-t.top),a=Object(re.k)(Re,0,t.bottom-i.y);e=[Object(w.jsx)(ee.g,{fill:Z.a.GRAY3,opacity:.2,x:i.x,y:t.top,width:r.x,height:s},0),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},1),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:n.x,y:i.y,points:[0,-o,0,a],strokeWidth:3},2)]}else if(this.zoomMode===se.Y){const s=Object(re.k)(Re,0,i.x-t.left),a=Object(re.k)(Re,0,t.right-i.x);e=[Object(w.jsx)(ee.g,{fill:Z.a.GRAY3,opacity:.2,x:t.left,y:i.y,width:o,height:r.y},0),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:i.y,points:[-s,0,a,0],strokeWidth:3},1),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:n.y,points:[-s,0,a,0],strokeWidth:3},2)]}else this.zoomMode===se.XY&&(e=[Object(w.jsx)(ee.g,{fill:Z.a.GRAY3,opacity:.2,x:i.x,y:i.y,width:r.x,height:r.y},0),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:i.y,points:[0,10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},1),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:n.x,y:i.y,points:[0,10,0,0,-10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},2),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:i.x,y:n.y,points:[0,-10,0,0,10,0],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},3),Object(w.jsx)(ee.f,{stroke:Z.a.GRAY3,x:n.x,y:n.y,points:[-10,0,0,0,0,-10],strokeWidth:3,scaleX:Math.sign(r.x),scaleY:Math.sign(r.y)},4)])}return e},Object(j.p)(this)}endInteractions(){this.interactionMode=ae.NONE}getPixelValue(e,t,i,n){if(!this.chartArea)return;let r=(e-t)/(i-t);return n?r*(this.chartArea.right-this.chartArea.left)+this.chartArea.left:(r=1-r,r*(this.chartArea.bottom-this.chartArea.top)+this.chartArea.top)}getValueForPixelX(e){if(!this.chartArea)return;return(e-this.chartArea.left)/(this.chartArea.right-this.chartArea.left)*(this.props.xMax-this.props.xMin)+this.props.xMin}getValueForPixelY(e){if(!this.chartArea)return;return(this.chartArea.bottom-e)/(this.chartArea.bottom-this.chartArea.top)*(this.props.yMax-this.props.yMin)+this.props.yMin}genXline(e,t,i,n){const r=this.chartArea;let o=[];return r&&o.push(Object(w.jsx)(ee.f,{listening:!1,points:[0,r.top,0,r.bottom],strokeWidth:1,stroke:t,opacity:i},0)),Object(w.jsx)(ee.d,{x:n,y:0,children:o},e)}genYline(e,t,i,n){const r=this.chartArea;let o=[];return r&&o.push(Object(w.jsx)(ee.f,{listening:!1,points:[r.left,0,r.right,0],strokeWidth:1,stroke:t,opacity:i},0)),Object(w.jsx)(ee.d,{x:0,y:n,children:o},e)}genCircle(e,t,i,n){let r=.5,o=3;return this.props&&this.props.pointRadius&&(r=this.props.pointRadius-1<=0?.5:this.props.pointRadius-1,o=this.props.pointRadius+2.5),Object(w.jsx)(ee.d,{x:i,y:n,children:Object(w.jsx)(ee.h,{innerRadius:r,outerRadius:o,fill:t})},e)}startSelection(e,t){this.interactionMode=ae.SELECTING,this.selectionBoxStart={x:e,y:t},this.selectionBoxEnd={x:e,y:t}}startPanning(e,t){this.interactionMode=ae.PANNING,this.panPrevious={x:e,y:t}}updateSelection(e,t){this.selectionBoxEnd={x:e,y:t}}updatePan(e,t){this.panPrevious={x:e,y:t}}get zoomMode(){const e=Math.abs(this.selectionBoxEnd.x-this.selectionBoxStart.x),t=Math.abs(this.selectionBoxEnd.y-this.selectionBoxStart.y);return e>Re&&t>Re&&this.props.graphZoomedXY?se.XY:this.props.graphZoomedX&&this.props.graphZoomedY?e>t?se.X:se.Y:this.props.graphZoomedX?se.X:this.props.graphZoomedY?se.Y:se.NONE}render(){return Object(w.jsxs)("div",{className:"scatter-plot-component",style:{cursor:this.isPanning?"move":"crosshair"},onKeyDown:this.onKeyDown,onMouseEnter:this.onMouseEnter,onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,tabIndex:0,children:[Object(w.jsx)(J.a,{handleWidth:!0,handleHeight:!0,onResize:this.resize,refreshMode:"throttle",refreshRate:33}),this.width>0&&this.height>0&&Object(w.jsx)(te.a,{...this.props,plotRefUpdated:this.onPlotRefUpdated,chartAreaUpdated:this.updateChart,width:this.width,height:this.height}),this.width>0&&this.height>0&&Object(w.jsx)(ee.i,{className:"annotation-stage",width:this.width,height:this.height,onMouseMove:this.onStageMouseMove,onMouseDown:this.onStageMouseDown,onMouseUp:this.onStageMouseUp,onWheel:this.onStageWheel,children:Object(w.jsxs)(ee.e,{children:[this.genIndicator(),this.genBorderRect(),this.genSelectionRect()]})}),Object(w.jsx)(ie.a,{darkMode:this.props.darkMode,visible:this.isMouseEntered&&(void 0!==this.props.data||this.props.multiPlotPropsMap&&this.props.multiPlotPropsMap.size>0),exportImage:this.exportImage,exportData:this.exportData})]})}},ye=Object(m.a)(me.prototype,"selectionBoxStart",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),Oe=Object(m.a)(me.prototype,"selectionBoxEnd",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{x:0,y:0}}}),je=Object(m.a)(me.prototype,"chartArea",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Se=Object(m.a)(me.prototype,"width",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),xe=Object(m.a)(me.prototype,"height",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ce=Object(m.a)(me.prototype,"isMouseEntered",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ie=Object(m.a)(me.prototype,"interactionMode",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return ae.NONE}}),Object(m.a)(me.prototype,"isSelecting",[j.i],Object.getOwnPropertyDescriptor(me.prototype,"isSelecting"),me.prototype),Object(m.a)(me.prototype,"isPanning",[j.i],Object.getOwnPropertyDescriptor(me.prototype,"isPanning"),me.prototype),we=Object(m.a)(me.prototype,"updateChart",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return e=>{this.chartArea=e,this.props.updateChartArea&&this.props.updateChartArea(e)}}}),Te=Object(m.a)(me.prototype,"resize",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return(e,t)=>{this.width=e,this.height=t}}}),ve=Object(m.a)(me.prototype,"showMouseEnterWidget",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!0,this.props.mouseEntered&&this.props.mouseEntered(!0)}}}),Ae=Object(m.a)(me.prototype,"hideMouseEnterWidget",[j.g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return()=>{this.isMouseEntered=!1}}}),Object(m.a)(me.prototype,"endInteractions",[j.g],Object.getOwnPropertyDescriptor(me.prototype,"endInteractions"),me.prototype),Object(m.a)(me.prototype,"startSelection",[j.g],Object.getOwnPropertyDescriptor(me.prototype,"startSelection"),me.prototype),Object(m.a)(me.prototype,"startPanning",[j.g],Object.getOwnPropertyDescriptor(me.prototype,"startPanning"),me.prototype),Object(m.a)(me.prototype,"updateSelection",[j.g],Object.getOwnPropertyDescriptor(me.prototype,"updateSelection"),me.prototype),Object(m.a)(me.prototype,"updatePan",[j.g],Object.getOwnPropertyDescriptor(me.prototype,"updatePan"),me.prototype),Object(m.a)(me.prototype,"zoomMode",[j.i],Object.getOwnPropertyDescriptor(me.prototype,"zoomMode"),me.prototype),be=me))||be;var Ee;i(801);let Fe;!function(e){e[e.MIN_WIDTH=.5]="MIN_WIDTH",e[e.MAX_WIDTH=10]="MAX_WIDTH",e[e.MIN_POINT_SIZE=.5]="MIN_POINT_SIZE",e[e.MAX_POINT_SIZE=10]="MAX_POINT_SIZE",e[e.POINT_SIZE_STEP_SIZE=.5]="POINT_SIZE_STEP_SIZE",e[e.LINE_WIDTH_STEP_SIZE=.5]="LINE_WIDTH_STEP_SIZE"}(Fe||(Fe={}));let Me=Object(S.a)(Ee=class extends y.Component{getThemeDefaultColor(e,t){return this.props.darkMode&&!t.fixed?e:t.colorHex}render(){const e=this.props;return Object(w.jsx)("div",{className:"line-settings-panel",children:Object(w.jsxs)(y.Fragment,{children:[e.userSelectedCoordinate&&e.handleCoordinateChanged&&Object(w.jsx)(n.p,{label:"Coordinate",inline:!0,children:Object(w.jsx)(n.r,{value:e.userSelectedCoordinate,options:e.profileCoordinateOptions,onChange:e.handleCoordinateChanged})}),Object(w.jsx)(n.p,{inline:!0,label:"Primary Color",children:Object(w.jsx)(T,{color:this.getThemeDefaultColor(e.primaryDarkModeLineColor,e.primaryLineColor),presetColors:[...re.e,"transparent"],setColor:t=>{e.setPrimaryLineColor("transparent"===t.hex?"#000000":t.hex,!0)},disableAlpha:!0,darkTheme:e.darkMode})}),e.secondaryDarkModeLineColor&&e.secondaryLineColor&&e.setSecondaryLineColor&&Object(w.jsx)(n.p,{inline:!0,label:"Secondary Color",children:Object(w.jsx)(T,{color:this.getThemeDefaultColor(e.secondaryDarkModeLineColor,e.secondaryLineColor),presetColors:[...re.e,"transparent"],setColor:t=>{e.setSecondaryLineColor("transparent"===t.hex?"#000000":t.hex,!0)},disableAlpha:!0,darkTheme:e.darkMode})}),Object(w.jsx)(n.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(w.jsx)(nt,{placeholder:"Line Width",min:Fe.MIN_WIDTH,max:Fe.MAX_WIDTH,value:e.lineWidth,stepSize:Fe.LINE_WIDTH_STEP_SIZE,disabled:e.plotType===he.POINTS,onValueChange:t=>e.setLineWidth(t)})}),Object(w.jsx)(n.p,{inline:!0,label:"Point Size",labelInfo:"(px)",children:Object(w.jsx)(nt,{placeholder:"Point Size",min:Fe.MIN_POINT_SIZE,max:Fe.MAX_POINT_SIZE,value:e.linePlotPointSize,stepSize:Fe.POINT_SIZE_STEP_SIZE,disabled:e.plotType!==he.POINTS,onValueChange:t=>e.setLinePlotPointSize(t)})}),"undefined"!==typeof e.logScaleY&&e.handleLogScaleChanged&&Object(w.jsx)(n.p,{inline:!0,label:"Log Scale",children:Object(w.jsx)(n.P,{checked:e.logScaleY,onChange:e.handleLogScaleChanged})}),"undefined"!==typeof e.markerTextVisible&&e.handleMarkerTextChanged&&Object(w.jsx)(n.p,{inline:!0,label:"Show Labels",children:Object(w.jsx)(n.P,{checked:e.markerTextVisible,onChange:e.handleMarkerTextChanged})}),"undefined"!==typeof e.useWcsValues&&e.handleWcsValuesChanged&&Object(w.jsx)(n.p,{inline:!0,label:"Use WCS Values",children:Object(w.jsx)(n.P,{checked:e.useWcsValues,onChange:e.handleWcsValuesChanged})}),"undefined"!==typeof e.showWCSAxis&&e.handleWcsAxisChanged&&Object(w.jsx)(n.p,{inline:!0,label:"Show WCS Axis",children:Object(w.jsx)(n.P,{checked:e.showWCSAxis,onChange:e.handleWcsAxisChanged})}),"undefined"!==typeof e.meanRmsVisible&&e.handleMeanRmsChanged&&Object(w.jsx)(n.p,{inline:!0,label:"Show Mean/RMS",children:Object(w.jsx)(n.P,{checked:e.meanRmsVisible,onChange:e.handleMeanRmsChanged})}),Object(w.jsx)(n.p,{inline:!0,label:"Line Style",children:Object(w.jsx)(ge,{value:e.plotType,onValueChanged:e.setPlotType})}),"undefined"!==typeof e.xMinVal&&e.handleXMinChange&&Object(w.jsx)(n.p,{label:"X Min",inline:!0,children:Object(w.jsx)(nt,{className:"line-boundary",value:e.xMinVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleXMinChange,onKeyDown:e.handleXMinChange})}),"undefined"!==typeof e.xMaxVal&&e.handleXMaxChange&&Object(w.jsx)(n.p,{label:"X Max",inline:!0,children:Object(w.jsx)(nt,{className:"line-boundary",value:e.xMaxVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleXMaxChange,onKeyDown:e.handleXMaxChange})}),"undefined"!==typeof e.yMinVal&&e.handleYMinChange&&Object(w.jsx)(n.p,{label:"Y Min",inline:!0,children:Object(w.jsx)(nt,{className:"line-boundary",asyncControl:!0,value:e.yMinVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleYMinChange,onKeyDown:e.handleYMinChange})}),"undefined"!==typeof e.yMaxVal&&e.handleYMaxChange&&Object(w.jsx)(n.p,{label:"Y Max",inline:!0,children:Object(w.jsx)(nt,{className:"line-boundary",asyncControl:!0,value:e.yMaxVal,selectAllOnFocus:!0,buttonPosition:"none",allowNumericCharactersOnly:!0,onBlur:e.handleYMaxChange,onKeyDown:e.handleYMaxChange})}),"undefined"!==typeof e.isAutoScaledX&&"undefined"!==typeof e.isAutoScaledY&&e.clearXYBounds&&Object(w.jsx)(n.p,{inline:!0,className:"reset-range-content",children:Object(w.jsx)(n.e,{className:"reset-range-button",icon:"zoom-to-fit",small:!0,disabled:e.isAutoScaledX&&e.isAutoScaledY,onClick:e.clearXYBounds,children:"Reset Range"})})]})})}})||Ee;var ke;i(802);let De;!function(e){e[e.MIN_POINT_SIZE=.5]="MIN_POINT_SIZE",e[e.MAX_POINT_SIZE=10]="MAX_POINT_SIZE",e[e.MIN_TRANSPARENCY=.1]="MIN_TRANSPARENCY",e[e.MAX_TRANSPARENCY=1]="MAX_TRANSPARENCY",e[e.POINT_SIZE_STEP_SIZE=.5]="POINT_SIZE_STEP_SIZE",e[e.TRANSPARENCY_STEP_SIZE=.1]="TRANSPARENCY_STEP_SIZE"}(De||(De={}));let Ne=Object(S.a)(ke=class extends y.Component{render(){const e=this.props;return Object(w.jsx)("div",{className:"scatter-settings-panel",children:Object(w.jsxs)(y.Fragment,{children:[Object(w.jsx)(n.p,{inline:!0,label:"Color Map",children:Object(w.jsx)(F,{inverted:e.invertedColorMap,selectedItem:e.colorMap,onItemSelect:t=>{e.setColormap(t)}})}),Object(w.jsx)(n.p,{label:"Invert Color Map",inline:!0,children:Object(w.jsx)(n.P,{checked:e.invertedColorMap,onChange:e.handleInvertedColorMapChanged})}),Object(w.jsx)(n.p,{inline:!0,label:"Symbol Size",labelInfo:"(px)",children:Object(w.jsx)(nt,{placeholder:"Symbol Size",min:De.MIN_POINT_SIZE,max:De.MAX_POINT_SIZE,value:e.scatterPlotPointSize,stepSize:De.POINT_SIZE_STEP_SIZE,onValueChange:t=>e.setScatterPlotPointSize(t)})}),Object(w.jsx)(n.p,{inline:!0,label:"Transparency",children:Object(w.jsx)(nt,{placeholder:"transparency",min:De.MIN_TRANSPARENCY,max:De.MAX_TRANSPARENCY,value:e.pointTransparency,stepSize:De.TRANSPARENCY_STEP_SIZE,onValueChange:t=>e.setPointTransparency(t)})}),Object(w.jsx)(n.p,{inline:!0,label:"Equal Axes",children:Object(w.jsx)(n.P,{checked:e.equalAxes,onChange:e.handleEqualAxesValuesChanged})})]})})}})||ke;var Le,_e=i(415),ze=i(147),We=i(189),Ge=i(907),Ve=i(67),Be=i(18),He=i(6);i(803);let qe;!function(e){e[e.Normal=0]="Normal",e[e.ColumnFilter=1]="ColumnFilter"}(qe||(qe={}));let Ye=Object(S.a)(Le=class extends y.Component{constructor(...e){super(...e),this.SortingTypelinkedList={head:{value:null,next:{value:He.a.SortingType.Ascending,next:{value:He.a.SortingType.Descending,next:null}}}},this.renderManualSelectionColumn=(e,t)=>{if(!e||!t||t.length<=0)return null;const i="select";return Object(w.jsx)(_e.a,{name:i,columnHeaderCellRenderer:()=>Object(w.jsx)(ze.a,{children:Object(w.jsx)(y.Fragment,{children:Object(w.jsx)(n.g,{indeterminate:e.isSelectingIndeterminate,checked:e.isSelectingAll,inline:!0,onChange:e.selectAllLines})})}),cellRenderer:(i,r)=>Object(w.jsx)(We.a,{interactive:!1,children:Object(w.jsx)(y.Fragment,{children:Object(w.jsx)(n.g,{checked:t[i]||!1,onChange:()=>e.selectSingleLine(i)})})},`cell_${r}_${i}`)},i)},this.getfilterSyntax=e=>{switch(e){case He.a.ColumnType.String||He.a.ColumnType.Bool:return Object(w.jsxs)("div",{className:"column-popover-content",children:[Object(w.jsx)("small",{children:"Filter by substring"}),Object(w.jsx)("br",{}),Object(w.jsx)("small",{children:'e.g. gal (no quotation, entries contain the "gal" string)'})]});default:return Object(w.jsxs)("div",{className:"column-popover-content",children:[Object(w.jsxs)("small",{children:["Operators: ",">",", ",">=",", ","<",", ","<=",", ","==",", ","!=",", ","..",", ","..."]}),Object(w.jsx)("br",{}),Object(w.jsxs)("small",{children:["e.g. ","<"," 10 (everything less than 10) "]}),Object(w.jsx)("br",{}),Object(w.jsx)("small",{children:"e.g. == 1.23 (entries equal to 1.23) "}),Object(w.jsx)("br",{}),Object(w.jsx)("small",{children:"e.g. 10..50 (everything between 10 and 50, exclusive)) "}),Object(w.jsx)("br",{}),Object(w.jsx)("small",{children:"e.g. 10...50 (everything between 10 and 50, inclusive) "})]})}},this.renderDataColumnWithFilter=(e,t)=>Object(w.jsx)(_e.a,{name:e.name,columnHeaderCellRenderer:t=>this.renderColumnHeaderCell(t,e),cellRenderer:(null===t||void 0===t?void 0:t.length)?(e,i)=>this.renderCell(e,i,t):void 0},e.name),this.renderCell=(e,t,i)=>{const n=this.props.selectedDataIndex;return n&&n.includes(e)&&!this.props.showSelectedData?Object(w.jsx)(We.a,{intent:"danger",loading:this.isLoading(e),interactive:!1,children:i[e]},`cell_${t}_${e}`):Object(w.jsx)(We.a,{loading:this.isLoading(e),interactive:!1,children:i[e]},`cell_${t}_${e}`)},this.getNextSortingType=()=>{const e=this.props.sortingInfo;let t=this.SortingTypelinkedList.head;for(;t.next;){if(t.value===e.sortingType)return t.next.value;t=t.next}return null},this.renderColumnHeaderCell=(e,t)=>{if(!isFinite(e)||!t)return null;const i=this.props.filter.get(t.name),r=this.getfilterSyntax(t.dataType),o=this.props.sortingInfo,s=o.columnName===t.name;let a=!1;""!==i.filter&&(a=!0);const l=this.props.tableHeaders[i.dataIndex].description,c=this.props.disable;let d=this.props.darkTheme?"column-popover-dark":"column-popover";return Object(w.jsxs)(ze.a,{children:[Object(w.jsx)(ze.a,{className:"column-name",nameRenderer:()=>{let e="sort",i="sort-icon inactive",r=0;return s&&(r=this.getNextSortingType(),o.sortingType===He.a.SortingType.Descending?(e="sort-desc",i="sort-icon"):o.sortingType===He.a.SortingType.Ascending&&(e="sort-asc",i="sort-icon")),Object(w.jsx)("div",{className:"sort-label",onClick:()=>c?null:this.props.updateSortRequest(t.name,r),children:Object(w.jsxs)(n.y,{disabled:c,className:"bp3-inline label",children:[Object(w.jsx)(n.w,{className:i,icon:e}),Object(w.jsx)(n.F,{hoverOpenDelay:250,hoverCloseDelay:0,className:"column-popover",popoverClassName:d,content:l||"Description not avaliable",interactionKind:n.G.HOVER,children:t.name})]})})}}),Object(w.jsx)(ze.a,{isActive:a,children:Object(w.jsx)(n.F,{hoverOpenDelay:250,hoverCloseDelay:0,className:"column-popover",popoverClassName:d,content:r,interactionKind:n.G.HOVER,children:Object(w.jsx)(n.x,{small:!0,placeholder:"Click to filter",value:i&&i.filter?i.filter:"",onChange:e=>this.props.updateColumnFilter(e.currentTarget.value,t.name)},"column-popover-"+e)})})]})},this.infiniteScroll=e=>{const t=e.rowIndexEnd+1;e.rowIndexEnd>0&&t>=this.props.numVisibleRows&&!this.props.loadingCell&&!this.props.showSelectedData&&this.props.updateByInfiniteScroll(e.rowIndexEnd)},this.updateTableColumnWidth=(e,t)=>{const i=this.props.columnHeaders[e];i&&this.props.updateTableColumnWidth&&this.props.updateTableColumnWidth(t,i.name)},this.onRowIndexSelection=e=>{if(e.length>0){let t=[];for(let i=0;i<e.length;i++){const n=e[i],r=n.rows[0],o=n.rows[1];if(r===o)t.push(r);else for(let e=r;e<=o;e++)t.push(e)}this.props.updateSelectedRow(t)}}}isLoading(e){return!!(this.props.loadingCell&&e+4>this.props.numVisibleRows)}renderDataColumn(e,t){return Object(w.jsx)(_e.a,{name:e,cellRenderer:(e,i)=>Object(w.jsx)(We.a,{interactive:!0,children:e<(null===t||void 0===t?void 0:t.length)?t[e]:void 0},`cell_${i}_${e}`)},e)}render(){var e,t;const i=this.props,n=[],r=i.dataset;let o=i.columnWidths?i.columnWidths:new Array(null===(e=i.columnHeaders)||void 0===e?void 0:e.length).fill(150);if(i.manualSelectionProps&&(null===(t=i.manualSelectionData)||void 0===t?void 0:t.length)>0){const e=this.renderManualSelectionColumn(i.manualSelectionProps,i.manualSelectionData);n.push(e),o.splice(0,0,50)}for(let a=0;a<i.columnHeaders.length;a++){var s;const e=i.columnHeaders[a],t=e.columnIndex;let o=null===(s=r.get(t))||void 0===s?void 0:s.data;if(i.type===qe.ColumnFilter){const t=this.renderDataColumnWithFilter(e,o);n.push(t)}else if(i.type===qe.Normal){const t=this.renderDataColumn(e.name,o);n.push(t)}}return i.type===qe.ColumnFilter?Object(w.jsx)(Ge.a,{className:"column-filter-table",ref:i.updateTableRef?e=>i.updateTableRef(e):null,numRows:i.numVisibleRows,renderMode:Ve.a.BATCH,enableRowReordering:!1,selectionModes:Be.d.ROWS_AND_CELLS,onVisibleCellsChange:this.infiniteScroll,onColumnWidthChanged:this.updateTableColumnWidth,enableGhostCells:!0,onSelection:this.onRowIndexSelection,enableMultipleSelection:!0,enableRowResizing:!1,columnWidths:o,children:n}):Object(w.jsx)(Ge.a,{ref:i.updateTableRef?e=>i.updateTableRef(e):null,numRows:i.numVisibleRows,renderMode:Ve.a.NONE,enableRowReordering:!1,selectionModes:Be.d.NONE,enableGhostCells:!0,enableRowResizing:!1,columnWidths:o,children:n})}})||Le;var Ue,Xe,$e,Ke,Qe,Ze,Je=i(169);let et=Object(S.a)((Ze=Qe=class e extends y.Component{constructor(e){super(e),this.defaulteValue=void 0,Object(b.a)(this,"value",$e,this),Object(b.a)(this,"isFocused",Ke,this),this.handleChange=e=>{if("keydown"===e.type&&13!==e.keyCode)return;isFinite(parseFloat(this.value))||this.setValue(this.defaulteValue);const t=parseFloat(this.validation(this.value));this.props.onValueChanged(t)},this.handleOnFocus=()=>{this.props.displayExponential&&this.setFocused(!0)},this.handleOnBlur=e=>{this.handleChange(e),this.props.displayExponential&&this.setFocused(!1)},this.handleOnValueChange=(e,t)=>{this.setValue(this.validation(t))},this.handelOnValueCleared=()=>{this.setValue(this.defaulteValue),this.props.onValueCleared()},this.validation=e=>{const t=parseFloat(e);let i=e;if(this.props.integerOnly){const e=Math.round(t);isFinite(e)&&(i=e.toString())}return this.props.min&&t<this.props.min&&(i=this.props.min.toString()),this.props.max&&t>this.props.max&&(i=this.props.max.toString()),i},Object(j.p)(this),this.value=this.props.value.toString(),this.defaulteValue=this.props.value.toString()}setValue(e){this.value=e}setFocused(e){this.isFocused=e}render(){let t=this.props.displayExponential&&!this.isFocused?Object(re.lb)(Number(this.props.value),3):this.props.value;return Object(w.jsx)(n.p,{className:this.props.className,label:this.props.label,inline:!0,disabled:this.props.disabled,children:Object(w.jsx)(n.D,{asyncControl:!0,stepSize:this.props.stepSize,value:t,minorStepSize:this.props.minorStepSize?this.props.minorStepSize:e.minorStepSize,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onKeyDown:this.handleChange,onValueChange:this.handleOnValueChange,buttonPosition:"none",disabled:this.props.disabled,rightElement:Object(w.jsx)(n.W,{content:"Reset value to default",children:Object(w.jsx)(n.b,{icon:"refresh",minimal:!0,onClick:this.handelOnValueCleared,disabled:this.props.disabled})})})})}},Qe.minorStepSize=.001,Xe=Ze,$e=Object(m.a)(Xe.prototype,"value",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke=Object(m.a)(Xe.prototype,"isFocused",[j.q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Object(m.a)(Xe.prototype,"setValue",[j.g],Object.getOwnPropertyDescriptor(Xe.prototype,"setValue"),Xe.prototype),Object(m.a)(Xe.prototype,"setFocused",[j.g],Object.getOwnPropertyDescriptor(Xe.prototype,"setFocused"),Xe.prototype),Ue=Xe))||Ue;var tt;let it=Object(S.a)(tt=class extends y.Component{render(){const e=this.props.widgetStore.effectiveFrame,t=e?e.nativeSpectralCoordinate:void 0,i=this.props.widgetStore,r=e&&e.spectralCoordsSupported?Array.from(e.spectralCoordsSupported.keys()).map((e=>({value:e,label:e===t?e+" (Native WCS)":e}))):[],o=e&&e.spectralSystemsSupported?e.spectralSystemsSupported.map((e=>({value:e,label:e}))):[],s=e&&(e.isSpectralCoordinateConvertible||e.spectralAxis&&!e.spectralAxis.valid),a=this.props.disable||!s,l=this.props.disable||!e||!e.isSpectralSystemConvertible;return Object(w.jsxs)(y.Fragment,{children:[Object(w.jsx)(n.p,{label:"Coordinate",inline:!0,disabled:a,children:Object(w.jsx)(n.r,{disabled:a,value:e&&e.spectralCoordinate?e.spectralCoordinate:"",options:r,onChange:e=>i.setSpectralCoordinate(e.currentTarget.value)})}),Object(w.jsx)(n.p,{label:"System",inline:!0,disabled:l,children:Object(w.jsx)(n.r,{disabled:l,value:e&&e.spectralSystem?e.spectralSystem:"",options:o,onChange:e=>i.setSpectralSystem(e.currentTarget.value)})})]})}})||tt;class nt extends y.Component{constructor(...e){super(...e),this.safeHandleValueChanged=(e,t,i)=>{if(this.props.intOnly){const n=Math.ceil(e);isFinite(n)&&(e=n,t=n.toString(),i.value=n.toString())}this.props.onValueChange&&isFinite(e)&&(!this.props.min||this.props.min<=e)&&(!this.props.max||this.props.max>=e)&&this.props.onValueChange(e,t,i)}}render(){const{intOnly:e,...t}=this.props;return Object(w.jsx)(n.D,{...t,asyncControl:!0,minorStepSize:this.props.minorStepSize?this.props.minorStepSize:e?1:nt.minorStepSize,onValueChange:this.safeHandleValueChanged})}}nt.minorStepSize=.001;var rt;i(804);let ot;!function(e){e.NONE="None",e.HANNING="Hanning",e.BOXCAR="Boxcar",e.GAUSSIAN="Gaussian",e.DECIMATION="Decimation",e.BINNING="Binning",e.SAVITZKY_GOLAY="Savitzky-Golay"}(ot||(ot={}));let st=Object(S.a)(rt=class extends y.Component{constructor(...e){super(...e),this.handleSelectedLineChanged=e=>{this.props.smoothingStore.setSelectedLine(e.target.value)}}render(){const e=this.props.smoothingStore,t=[{value:ot.NONE,label:"None"},{value:ot.BOXCAR,label:"Boxcar"},{value:ot.GAUSSIAN,label:"Gaussian"},{value:ot.HANNING,label:"Hanning"},{value:ot.BINNING,label:"Binning"},{value:ot.SAVITZKY_GOLAY,label:"Savitzky-Golay"}];this.props.diableDecimation||t.push({value:ot.DECIMATION,label:"Decimation"});let i=[];return e.colorMap.size>0&&e.colorMap.forEach(((e,t)=>{i=i.concat({value:t,label:t})})),Object(w.jsxs)("div",{className:"smoothing-settings-panel",children:[Object(w.jsx)(n.p,{label:"Method",inline:!0,children:Object(w.jsx)(n.r,{value:e&&e.type?e.type:ot.NONE,options:t,onChange:t=>e.setType(t.currentTarget.value)})}),e.type!==ot.NONE&&!this.props.diableStyle&&Object(w.jsxs)(y.Fragment,{children:[Object(w.jsxs)(n.p,{inline:!0,label:"Color",children:[e.colorMap.size>0&&Object(w.jsx)(n.r,{value:e.selectedLine,options:i,onChange:this.handleSelectedLineChanged}),Object(w.jsx)(T,{color:e.selectedLine&&e.colorMap.get(e.selectedLine)?e.colorMap.get(e.selectedLine).colorHex:e.lineColor.colorHex,presetColors:re.e,setColor:t=>{e.selectedLine&&e.colorMap.get(e.selectedLine)?e.setColorMap(e.selectedLine,{colorHex:t.hex,fixed:!0}):e.setLineColor(t.hex,!0)},disableAlpha:!0,darkTheme:oe.e.Instance.darkTheme})]}),Object(w.jsx)(n.p,{inline:!0,label:"Line Style",children:Object(w.jsx)(ge,{value:e.lineType,onValueChanged:e.setLineType})}),Object(w.jsx)(n.p,{inline:!0,label:"Line Width",labelInfo:"(px)",children:Object(w.jsx)(nt,{placeholder:"Line Width",min:Fe.MIN_WIDTH,max:Fe.MAX_WIDTH,value:e.lineWidth,stepSize:1,disabled:e.lineType===he.POINTS,onValueChange:t=>e.setLineWidth(t)})}),Object(w.jsx)(n.p,{inline:!0,label:"Point Size",labelInfo:"(px)",children:Object(w.jsx)(nt,{placeholder:"Point Size",min:Fe.MIN_POINT_SIZE,max:Fe.MAX_POINT_SIZE,value:e.pointRadius,stepSize:Fe.POINT_SIZE_STEP_SIZE,disabled:e.lineType!==he.POINTS,onValueChange:t=>e.setPointRadius(t)})})]}),e.type!==ot.NONE&&Object(w.jsx)(n.p,{label:"Overlay",inline:!0,children:Object(w.jsx)(n.P,{checked:e.isOverlayOn,onChange:t=>e.setIsOverlayOn(t.currentTarget.checked)})}),e.type===ot.BOXCAR&&Object(w.jsx)(n.p,{label:"Kernel",inline:!0,children:Object(w.jsx)(nt,{value:e.boxcarSize,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setBoxcarSize(Math.round(t))})}),e.type===ot.GAUSSIAN&&Object(w.jsx)(n.p,{label:"Sigma",inline:!0,children:Object(w.jsx)(nt,{value:e.gaussianSigma,min:1,className:"narrow",onValueChange:t=>e.setGaussianSigma(t)})}),e.type===ot.HANNING&&Object(w.jsx)(n.p,{label:"Kernel",inline:!0,children:Object(w.jsx)(nt,{value:e.hanningSize,min:3,stepSize:2,className:"narrow",onValueChange:t=>e.setHanningSize(Math.round(t))})}),e.type===ot.DECIMATION&&Object(w.jsx)(n.p,{label:"Decimation Width",inline:!0,children:Object(w.jsx)(nt,{value:e.decimationWidth,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setDecimationWidth(Math.round(t))})}),e.type===ot.BINNING&&Object(w.jsx)(n.p,{label:"Binning Width",inline:!0,children:Object(w.jsx)(nt,{value:e.binWidth,min:2,stepSize:1,className:"narrow",onValueChange:t=>e.setBinWidth(Math.round(t))})}),e.type===ot.SAVITZKY_GOLAY&&Object(w.jsxs)(y.Fragment,{children:[Object(w.jsx)(n.p,{label:"Kernel",inline:!0,children:Object(w.jsx)(nt,{value:e.savitzkyGolaySize,min:5,stepSize:2,className:"narrow",onValueChange:t=>e.setSavitzkyGolaySize(Math.round(t))})}),Object(w.jsx)(n.p,{label:"Degree of Fitting",inline:!0,children:Object(w.jsx)(nt,{value:e.savitzkyGolayOrder,min:0,max:4,stepSize:2,className:"narrow",onValueChange:t=>e.setSavitzkyGolayOrder(Math.round(t))})})]})]})}})||rt},800:function(e,t,i){},801:function(e,t,i){},802:function(e,t,i){},803:function(e,t,i){},804:function(e,t,i){},805:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","title":"Preferences","description":"Schema for CARTA Preferences (Version 1)","$id":"carta_preferences_1","required":["version"],"properties":{"version":{"type":"integer","minimum":1},"username":{"type":"string","minLength":1},"theme":{"type":"string","enum":["auto","light","dark"]},"autoLaunch":{"type":"boolean"},"fileSortingString":{"type":"string","pattern":"^([+\\\\-])(date|filename|type|size)$"},"fileFilteringType":{"type":"string","enum":["fuzzy","unix","regex"]},"layout":{"type":"string"},"cursorPosition":{"type":"string","enum":["fixed","tracking"]},"zoomMode":{"type":"string","enum":["fit","full"]},"zoomPoint":{"type":"string","enum":["cursor","center"]},"dragPanning":{"type":"boolean"},"spectralMatchingType":{"type":"string","enum":["VRAD","VOPT","FREQ","WAVE","AWAV","CHANNEL"]},"wcsMatchingType":{"type":"integer","minimum":0,"maximum":3},"transparentImageBackground":{"type":"boolean"},"scaling":{"type":"integer","minimum":0,"maximum":7},"colormap":{"type":"string"},"percentile":{"type":"number","exclusiveMaximum":100,"exclusiveMinimum":0},"scalingAlpha":{"type":"number","minimum":1},"scalingGamma":{"type":"number","exclusiveMinimum":0},"nanColorHex":{"type":"string","description":"TODO: validate color string"},"nanAlpha":{"type":"number","minimum":0,"maximum":1},"contourGeneratorType":{"type":"string","enum":["start-step-multiplier","min-max-scaling","percentages-ref.value","mean-sigma-list"]},"contourSmoothingMode":{"type":"integer","minimum":0,"maximum":2},"contourSmoothingFactor":{"type":"integer","minimum":0},"contourNumLevels":{"type":"integer","minimum":1},"contourThickness":{"type":"number","minimum":0},"contourColormapEnabled":{"type":"boolean"},"contourColor":{"type":"string","description":"TODO: validate color string"},"contourColormap":{"type":"string"},"astColor":{"type":"integer","minimum":0},"astGridVisible":{"type":"boolean"},"astLabelsVisible":{"type":"boolean"},"wcsType":{"type":"string","enum":["automatic","degrees","sexagesimal"]},"beamVisible":{"type":"boolean"},"beamColor":{"type":"string"},"beamType":{"type":"string","enum":["open","solid"]},"beamWidth":{"type":"number","minimum":0},"regionColor":{"type":"string","description":"TODO: validate color string"},"regionLineWidth":{"type":"number","minimum":0},"regionDashLength":{"type":"integer","minimum":0},"regionType":{"type":"integer","minimum":0,"maximum":6},"regionCreationMode":{"type":"string","enum":["center","corner"]},"regionSize":{"type":"number","minimum":1},"imageCompressionQuality":{"type":"integer","minimum":4,"maximum":32},"animationCompressionQuality":{"type":"integer","minimum":4,"maximum":32},"GPUTileCache":{"type":"integer","multipleOf":128,"minimum":512},"systemTileCache":{"type":"integer","multipleOf":128,"minimum":1024},"contourDecimation":{"type":"integer","minimum":1,"maximum":32},"contourCompressionLevel":{"type":"integer","minimum":0,"maximum":19},"contourChunkSize":{"type":"integer","multipleOf":25000,"minimum":25000,"maximum":1000000},"contourControlMapWidth":{"type":"integer","multipleOf":128,"minimum":128,"maximum":1024},"streamContoursWhileZooming":{"type":"boolean"},"lowBandwidthMode":{"type":"boolean"},"stopAnimationPlayback":{"type":"integer","minimum":5,"maximum":30}}}')},808:function(e,t,i){},81:function(e,t,i){"use strict";t.a=i.p+"static/media/allmaps.ac43eb19.png"},812:function(e,t,i){},813:function(e,t,i){},814:function(e,t,i){},815:function(e,t,i){},816:function(e,t,i){},817:function(e,t,i){},818:function(e,t,i){},819:function(e,t,i){},820:function(e,t,i){},821:function(e,t,i){},824:function(e,t,i){},825:function(e,t,i){},847:function(e,t,i){},848:function(e,t,i){},849:function(e,t,i){},850:function(e,t,i){},851:function(e,t,i){},852:function(e,t,i){},853:function(e,t,i){},854:function(e,t,i){},855:function(e,t,i){},856:function(e,t,i){},857:function(e,t,i){},858:function(e,t,i){},859:function(e,t,i){},860:function(e,t,i){},861:function(e,t,i){},862:function(e,t,i){},863:function(e,t,i){},864:function(e,t,i){},865:function(e,t,i){},866:function(e,t,i){},867:function(e,t,i){},868:function(e,t,i){},869:function(e,t,i){},870:function(e,t,i){},871:function(e,t,i){},872:function(e,t,i){},873:function(e,t,i){},874:function(e,t,i){},875:function(e,t,i){},877:function(e,t,i){},878:function(e,t,i){},879:function(e,t,i){},880:function(e,t,i){},881:function(e,t,i){},882:function(e,t,i){},883:function(e,t,i){},884:function(e,t,i){},885:function(e,t,i){},886:function(e,t,i){},887:function(e,t,i){},888:function(e,t,i){},889:function(e,t,i){},890:function(e,t,i){},891:function(e,t,i){},892:function(e,t,i){},893:function(e,t,i){},894:function(e,t,i){},895:function(e,t,i){},896:function(e,t,i){},897:function(e,t,i){},899:function(e,t,i){"use strict";i.r(t);var n,r,o,s=i(3),a=i(40),l=i(171),c=i.n(l),d=i(909),u=i(15),h=i(42),p=i(36),g=i(91),f=i(13),b=i(61),m=i(5),y=i(9),O=i(0);let j=Object(u.a)((o=r=class e extends s.Component{render(){const t=m.e.Instance;let i="bp3-hotkey-dialog";return t.darkTheme&&(i+=" bp3-dark"),Object(O.jsx)(p.l,{isOpen:t.dialogStore.hotkeyDialogVisible,className:i,canEscapeKeyClose:!0,canOutsideClickClose:!0,onClose:t.dialogStore.hideHotkeyDialog,children:Object(O.jsx)("div",{className:y.a.DIALOG_BODY,children:e.RenderHotkeys()})})}static RenderHotkeys(){const t=m.e.Instance,i=t.modifierString,n="1) Navigation",r="2) Regions",o="3) Frame controls",s="4) File controls",a="5) Other",l=[Object(O.jsx)(p.t,{group:n,global:!0,combo:"click",label:"Pan image"},0),Object(O.jsx)(p.t,{group:n,global:!0,combo:"middle-click",label:"Pan image (inside region)"},1),Object(O.jsx)(p.t,{group:n,global:!0,combo:"mod+click",label:"Pan image (inside region)"},2),Object(O.jsx)(p.t,{group:n,global:!0,combo:"mouse-wheel",label:"Zoom image"},3)],c=[Object(O.jsx)(p.t,{group:r,global:!0,combo:"c",label:"Toggle region creation mode",onKeyDown:e.ToggleCreateMode},0),Object(O.jsx)(p.t,{group:r,global:!0,combo:"l",label:"Toggle current region lock",onKeyDown:e.ToggleRegionLock},1),Object(O.jsx)(p.t,{group:r,global:!0,combo:"shift + l",label:"Unlock all regions",onKeyDown:e.UnlockAllRegions},2),Object(O.jsx)(p.t,{group:r,global:!0,combo:"del",label:"Delete selected region",onKeyDown:t.deleteSelectedRegion},3),Object(O.jsx)(p.t,{group:r,global:!0,combo:"backspace",label:"Delete selected region",onKeyDown:t.deleteSelectedRegion},4),Object(O.jsx)(p.t,{group:r,global:!0,combo:"esc",label:"Deselect region/Cancel region creation",onKeyDown:e.HandleRegionEsc},5),Object(O.jsx)(p.t,{group:r,global:!0,combo:"mod",label:"Switch region creation mode"},6),Object(O.jsx)(p.t,{group:r,global:!0,combo:"shift",label:"Symmetric region creation"},7),Object(O.jsx)(p.t,{group:r,global:!0,combo:"double-click",label:"Region properties"},8)],d=[Object(O.jsx)(p.t,{group:o,global:!0,combo:`${i}]`,label:"Next image",onKeyDown:t.nextFrame},0),Object(O.jsx)(p.t,{group:o,global:!0,combo:`${i}[`,label:"Previous image",onKeyDown:t.prevFrame},1),Object(O.jsx)(p.t,{group:o,global:!0,combo:`${i}up`,label:"Next channel",onKeyDown:e.NextChannel},2),Object(O.jsx)(p.t,{group:o,global:!0,combo:`${i}down`,label:"Previous channel",onKeyDown:e.PrevChannel},3),Object(O.jsx)(p.t,{group:o,global:!0,combo:`${i}shift + up`,label:"Next Stokes cube",onKeyDown:e.NextStokes},4),Object(O.jsx)(p.t,{group:o,global:!0,combo:`${i}shift + down`,label:"Previous Stokes cube",onKeyDown:e.PrevStokes},5)],u=[Object(O.jsx)(p.t,{group:s,global:!0,combo:`${i}O`,label:"Open image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(m.g.File)},0),Object(O.jsx)(p.t,{group:s,global:!0,combo:`${i}L`,label:"Append image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(m.g.File,!0)},1),Object(O.jsx)(p.t,{group:s,global:!0,combo:`${i}W`,label:"Close image",onKeyDown:()=>t.closeCurrentFile(!0)},2),Object(O.jsx)(p.t,{group:s,global:!0,combo:`${i}S`,label:"Save image",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(m.g.SaveFile,!1)},3),Object(O.jsx)(p.t,{group:s,global:!0,combo:`${i}G`,label:"Import catalog",onKeyDown:()=>t.fileBrowserStore.showFileBrowser(m.g.Catalog,!1)},4),Object(O.jsx)(p.t,{group:s,global:!0,combo:`${i}E`,label:"Export image",onKeyDown:t.exportImage},5)],h=[Object(O.jsx)(p.t,{group:a,global:!0,combo:"shift + D",label:"Toggle light/dark theme",onKeyDown:e.ToggleDarkTheme},0),Object(O.jsx)(p.t,{group:a,global:!0,combo:"F",label:"Freeze/unfreeze cursor position",onKeyDown:t.toggleCursorFrozen},1)];return Object(O.jsxs)(p.u,{children:[c,l,d,u,h]})}},r.NextChannel=()=>{const e=m.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(1,0)},r.PrevChannel=()=>{const e=m.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(-1,0)},r.NextStokes=()=>{const e=m.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(0,1)},r.PrevStokes=()=>{const e=m.e.Instance;e.activeFrame&&e.activeFrame.incrementChannels(0,-1)},r.ToggleDarkTheme=()=>{const e=m.e.Instance;e.darkTheme?e.setLightTheme():e.setDarkTheme()},r.ToggleCreateMode=()=>{const e=m.e.Instance;e.activeFrame&&e.activeFrame.regionSet.toggleMode()},r.ToggleRegionLock=()=>{const e=m.e.Instance;if(e.activeFrame){const t=e.activeFrame.regionSet;t.selectedRegion&&t.selectedRegion.toggleLock()}},r.UnlockAllRegions=()=>{const e=m.e.Instance;if(e.activeFrame){const t=e.activeFrame.regionSet;for(const e of t.regions)e.setLocked(!1)}},r.HandleRegionEsc=()=>{const e=m.e.Instance;if(e.activeFrame&&e.activeFrame.regionSet){const t=e.activeFrame.regionSet;t.selectedRegion?t.deselectRegion():t.mode===m.L.CREATING&&t.setMode(m.L.MOVING)}},n=o))||n;function S(){}S.prototype=Object.create(j.prototype),S.prototype.renderHotkeys=j.RenderHotkeys;const x=Object(p.v)(S);var C;i(894),i(895),i(896);let I=Object(u.a)(C=class extends s.Component{constructor(...e){super(...e),this.onContainerResize=(e,t)=>{const i=m.e.Instance;i.layoutStore.dockedLayout&&i.layoutStore.dockedLayout.updateSize(e,t)}}render(){const e=m.e.Instance;let t="App",i="gl-container-app";return e.darkTheme&&(t+=" bp3-dark",i+=" dark-theme"),Object(O.jsxs)("div",{className:t,children:[Object(O.jsx)(f.H,{}),Object(O.jsx)(p.a,{icon:e.alertStore.alertIcon,className:e.darkTheme?"bp3-dark":"",isOpen:e.alertStore.alertVisible,onClose:e.alertStore.dismissAlert,canEscapeKeyCancel:!0,children:Object(O.jsx)("p",{children:e.alertStore.alertText})}),Object(O.jsx)(p.a,{icon:e.alertStore.alertIcon,className:e.darkTheme?"bp3-dark":"",isOpen:e.alertStore.interactiveAlertVisible,confirmButtonText:"OK",cancelButtonText:"Cancel",intent:g.a.DANGER,onClose:e.alertStore.handleInteractiveAlertClosed,canEscapeKeyCancel:!0,children:Object(O.jsx)("p",{children:e.alertStore.interactiveAlertText})}),Object(O.jsx)(b.k,{progress:void 0,timeRemaining:0,isOpen:e.resumingSession,cancellable:!1,text:"Resuming session..."}),Object(O.jsx)("div",{className:i,ref:t=>e.setAppContainer(t),children:Object(O.jsx)(h.a,{handleWidth:!0,handleHeight:!0,onResize:this.onContainerResize,refreshMode:"throttle",refreshRate:200})}),Object(O.jsx)(x,{}),Object(O.jsx)(f.g,{})]})}})||C;var w=i(27),T=(i(897),i(81)),v=i(180),A=i(181),R=i(182),P=i(183),E=i(184),F=i(185);for(const M of[T.a,v.a,A.a,R.a,P.a,E.a,F.a])(new Image).src=M;d.a.onlyShowFocusOnTabs(),window.React=s,window.ReactDOM=a,async function(){const e=window.location.href.replace(window.location.search,""),t=e+(e.endsWith("/")?"":"/")+"config";try{const e=await c.a.get(t);w.a.SetRuntimeConfig(null===e||void 0===e?void 0:e.data)}catch(i){console.log("No runtime config provided. Using default configuration"),w.a.SetRuntimeConfig({})}if(w.a.RuntimeConfig.googleClientId){const e=document.createElement("script");e.src="https://apis.google.com/js/client.js",e.onload=()=>{a.render(Object(O.jsx)(I,{}),document.getElementById("root"))},document.body.appendChild(e)}else a.render(Object(O.jsx)(I,{}),document.getElementById("root"))}().then((()=>{console.log("Configuration complete. Rendering frontend")}))}},[[899,1,2]]]);